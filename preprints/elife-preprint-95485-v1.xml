<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">95485</article-id>
<article-id pub-id-type="doi">10.7554/eLife.95485</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.95485.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>CausalXtract: a flexible pipeline to extract causal effects from live-cell time-lapse imaging data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Simon</surname>
<given-names>Franck</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">‡</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Comes</surname>
<given-names>Maria Colomba</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">‡</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Tocci</surname>
<given-names>Tiziana</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">‡</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Dupuis</surname>
<given-names>Louise</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Cabeli</surname>
<given-names>Vincent</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lagrange</surname>
<given-names>Nikita</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Mencattini</surname>
<given-names>Arianna</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7082-9792</contrib-id>
<name>
<surname>Parrini</surname>
<given-names>Maria Carla</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Martinelli</surname>
<given-names>Eugenio</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9638-8545</contrib-id>
<name>
<surname>Isambert</surname>
<given-names>Hervé</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>CNRS UMR168, Institut Curie, Université PSL, Sorbonne Université</institution>, Paris, <country>France</country></aff>
<aff id="a2"><label>2</label><institution>Department of Electronic Engineering, University of Rome Tor Vergata</institution>, Rome, <country>Italy</country></aff>
<aff id="a3"><label>3</label><institution>INSERM U830, Institut Curie, Université PSL</institution>, Paris, <country>France</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Postovit</surname>
<given-names>Lynne-Marie</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Queens University</institution>
</institution-wrap>
<city>Kingston</city>
<country>Canada</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Postovit</surname>
<given-names>Lynne-Marie</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Queens University</institution>
</institution-wrap>
<city>Kingston</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>corresponding authors: <email>herve.isambert@curie.fr</email>, <email>martinelli@ing.uniroma2.it</email></corresp>
<fn id="n1" fn-type="equal"><label>‡</label><p>these authors contributed equally to this work</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-09-17">
<day>17</day>
<month>09</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP95485</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-02-05">
<day>05</day>
<month>02</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-02-08">
<day>08</day>
<month>02</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.02.06.579177"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Simon et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Simon et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-95485-v1.pdf"/>
<abstract>
<p>Live-cell microscopy routinely provides massive amount of time-lapse images of complex cellular systems under various physiological or therapeutic conditions. However, this wealth of data remains difficult to interpret in terms of causal effects. Here, we describe CausalXtract, a flexible computational pipeline that discovers causal and possibly time-lagged effects from morphodynamic features and cell-cell interactions in live-cell imaging data. CausalXtract methodology combines network-based and information-based frameworks, which is shown to discover causal effects overlooked by classical Granger and Schreiber causality approaches. We showcase the use of CausalXtract to uncover novel causal effects in a tumor-on-chip cellular ecosystem under therapeutically relevant conditions. In particular, we find that cancer associated fibroblasts directly inhibit cancer cell apoptosis, independently from anti-cancer treatment. CausalXtract uncovers also multiple antagonistic effects at different time delays. Hence, CausalXtract provides a unique computational tool to interpret live-cell imaging data for a range of fundamental and translational research applications.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
</notes>
</front>
<body>
<p>Live-cell imaging microscopy commonly produces extensive amounts of time-lapse images of cellular systems, which can be segmented to extract morphodynamic features and interactions of individual cells under increasingly complex and physiologically relevant conditions. However, this wealth of information remains largely under-exploited due to a lack of methods and tools able to discover causal effects from spatio-temporal correlations under well-controlled experimental conditions.</p>
<p>CausalXtract addresses this need by integrating an advanced live-cell image feature extraction tool with a reliable and scalable causal discovery method, <xref rid="fig1" ref-type="fig">Fig. 1</xref>, in order to learn temporal causal networks from live-cell time-lapse imaging data, <xref rid="fig2" ref-type="fig">Fig. 2</xref>.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1:</label>
<caption><title>CausalXtract pipeline.</title>
<p><bold>a</bold>, Live-cell tumor ecosystem reconstituted <italic>ex vivo</italic><sup><xref ref-type="bibr" rid="c1">1</xref></sup> using the tumor-on-chip technology (Methods). <bold>b</bold>, CausalXtract’s live-cell image feature extraction module (CellHunter+). The tracking of cancer and immune cells and of their mutual interactions is illustrated in Supplementary Movies 1-3, in absence or presence of cell division and apoptosis event. <bold>c</bold>, CausalXtract’s temporal causal discovery module (tMIIC) learns a temporal causal network from the features extracted in (b). See Methods for CausalXtract’s implementation details and theoretical foundations. A step-by-step notebook of CausalXtract pipeline is provided with the source code.</p></caption>
<graphic xlink:href="579177v1_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig. 2:</label>
<caption><title>Application of CausalXtract to time-lapse images of tumor ecosystems reconstituted ex vivo<sup><xref ref-type="bibr" rid="c1">1</xref></sup>.</title>
<p><bold>a</bold>, Summary causal network inferred by CausalXtract. The underlying time-unfolded causal network is shown on <xref rid="figS7" ref-type="fig">Supplementary Fig. 7</xref>. Red (resp. blue) edges correspond to positive (resp. negative) associations. Bidirected dashed edges represent the effect of unobserved (latent) common causes. Annotations on edges correspond to time delays in time-steps (1 ts = 2 min). The inferred network is largely robust to variations in sampling rate (<italic>δτ</italic>) and maximum lag (<italic>τ</italic>), <xref rid="figS8" ref-type="fig">Supplementary Fig. 8</xref>. Here <italic>δτ</italic> = 7 ts and <italic>τ</italic> = 84 ts are chosen automatically by CausalXtract, <xref rid="figS8" ref-type="fig">Supplementary Fig. 8b</xref>. <bold>b</bold>, The CAF presence subnetwork highlighting the direct causal effects of CAFs on cancer cells. In particular, CausalXtract uncovers that CAFs directly inhibit cancer cell apoptosis independently from treatment, which has not been reported so far. <bold>c</bold>, The treatment subnetwork highlighting the direct causal effects of treament on cancer cells. In particular, CausalXtract uncovers that treatment increases cancer cell perimeter, which has not been reported either. <bold>d</bold>, The eccentricity-area subnetwork highlighting multiple direct and possibly antagonistic time-lagged effects, notably, between cell division and eccentricity and between cell apoptosis and area, as discussed in main text.</p></caption>
<graphic xlink:href="579177v1_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<sec id="s1">
<title>Results and Discussion</title>
<sec id="s1a">
<title>CausalXtract feature extraction and causal discovery modules</title>
<p>CausalXtract’s live-cell image feature extraction module (Cell-Hunter+), <xref rid="fig1" ref-type="fig">Fig. 1b</xref>, is based on CellHunter software<sup><xref ref-type="bibr" rid="c1">1</xref></sup> and consists in three steps: detection, tracking and feature extraction of live cells within time-lapse video images. First, automatic localization/segmentation of cells (<italic>e</italic>.<italic>g</italic>. tumor and immune cells) is performed with the Circular Hough Transform (CHT) algorithm<sup><xref ref-type="bibr" rid="c2">2</xref></sup> to estimate the cell centers and radii. Second, cell trajectories along the frames are constructed by linking the positions detected at the previous time step through Munkres’ algorithm for Optimal sub-pattern Assignment Problems (OAPs)<sup><xref ref-type="bibr" rid="c3">3</xref></sup>. Finally, relevant descriptors related to the shape, motility, and state of the cells, as well as cell-cell interactions are quantified from each cell trajectory (Methods).</p>
<p>CausalXtract’s temporal causal discovery module (tMIIC), <xref rid="fig1" ref-type="fig">Fig. 1c</xref>, is adapted from the causal discovery method, MIIC<sup><xref ref-type="bibr" rid="c4">4</xref>–<xref ref-type="bibr" rid="c6">6</xref></sup>, which learns contemporaneous causal networks (<italic>i</italic>.<italic>e</italic>. when temporal information is not available) for a broad range of biological or biomedical data, from single-cell transcriptomic and genomic alteration data<sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c7">7</xref></sup> to medical records of patients<sup><xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c6">6</xref></sup>. Live-cell time-lapse imaging data contain, however, information about cellular dynamics, which can in principle facilitate the discovery of novel cause-effect functional processes, based on the assumption that future events cannot cause past ones. To this end, CausalXtract’s discovery module, tMIIC, reconstructs time-unfolded causal networks, where each variable is represented by several nodes at different relative time points<sup><xref ref-type="bibr" rid="c9">9</xref></sup>, <xref rid="fig1" ref-type="fig">Fig. 1c</xref>. Such a time-unfolded network framework<sup><xref ref-type="bibr" rid="c10">10</xref>–<xref ref-type="bibr" rid="c13">13</xref></sup> is required to account for the temporal correlation between successive time steps in time series data. We benchmarked tMIIC on synthetic datasets resembling the real-world data of interest analyzed in this study (<italic>i</italic>.<italic>e</italic>. number of time steps, network size and degree distribution) and found that it matches or outperforms state-of-the-art methods, while running order of magnitudes faster on datasets of biologically relevant size including tens to hundreds of thousands time steps, <xref rid="figS1" ref-type="fig">Supplementary Figs. 1</xref>-<xref rid="figS4" ref-type="fig">4</xref>.</p>
<p>CausalXtract’s temporal network framework goes beyond the seminal concept of temporal causality originally proposed by Granger<sup><xref ref-type="bibr" rid="c14">14</xref></sup> for linear time series without reference to graphical models and later extended to non-linear dynamics by Schreiber<sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c16">16</xref></sup>. In particular, Granger-Schreiber causality is in fact too restrictive and may overlook actual causal effects, that can be uncovered by graph-based causal discovery methods, <xref rid="figS5" ref-type="fig">Supplementary Fig. 5</xref> (Methods, Theorem 1). In addition, Granger-Schreiber causality has long been known to infer spurious causal associations based on time delays, by excluding the presence of latent common causes <italic>a priori</italic><sup><xref ref-type="bibr" rid="c9">9</xref></sup>. CausalXtract circumvents these limitations by combining graph-based and information-based approaches (Methods), while including contemporary and time-delayed effects of unobserved latent variables, that are ubiquitous in cell biology data (<italic>e</italic>.<italic>g</italic>. the latent effects of cell cycle phases on cellular features and responses).</p>
</sec>
<sec id="s1b">
<title>Application to tumor-on-chip cellular ecosystems</title>
<p>We showcase CausalXtract with the analysis of time-lapse images of a tumor ecosystem reconstituted <italic>ex vivo</italic> using the tumor-on-chip technology, <xref rid="fig1" ref-type="fig">Fig. 1a</xref>. These live-cell time-lapse images come from a proof-of-concept study<sup><xref ref-type="bibr" rid="c1">1</xref></sup> which demonstrated the effects of an anti-cancer drug (the monoclonal antibodies trastuzumab, brand name Herceptin, used to treat HER2+ breast cancers) on a reconstituted tumor microenvironment including cancer cells, immune cells, cancer-associated fibroblasts (CAF), and endothelial cells (Methods). However, a comprehensive extraction and analysis of cellular morphodynamic features and interactions remained unexplored.</p>
<p>To this end, cellular features such as cell geometry, velocity, division, apoptosis, cell-cell transient interactions and persistent contacts were first extracted from the raw images using CausalXtract’s feature extraction module, <xref rid="fig1" ref-type="fig">Fig. 1b</xref> and <xref rid="figS6" ref-type="fig">Supplementary Fig. 6</xref>. Then, a time-unfolded causal network, <xref rid="figS7" ref-type="fig">Supplementary Fig. 7</xref>, and the corresponding summary causal network, <xref rid="fig2" ref-type="fig">Fig. 2a</xref>, were reconstructed between extracted cellular features, cell-cell interactions and therapeutic conditions using CausalXtract’s temporal causal discovery module, <xref rid="fig1" ref-type="fig">Fig. 1c</xref>.</p>
<p>CausalXtract inferred network, <xref rid="fig2" ref-type="fig">Fig. 2a</xref>, uncovers novel biologically relevant findings, in addition to confirming known results fxrom earlier studies. In particular, CausalXtract discovers that CAFs directly inhibit cancer cell apoptosis, independently from anti-cancer treatment, <xref rid="fig2" ref-type="fig">Fig. 2b</xref>, while earlier studies reported that CAFs merely reduced the effect of treatment<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. CausalXtract also discovers that treatment increases cancer cell perimeter, <xref rid="fig2" ref-type="fig">Fig. 2c</xref>, which has not been reported so far either. In addition, CausalXtract confirms known results from earlier studies. In particular, it recovers that treatment increases cancer cell apoptosis and the number of cancer-immune interactions, as well as decreases the division rate of cancer cells, <xref rid="fig2" ref-type="fig">Fig. 2c</xref>. Likewise, CausalXtract recovers that CAFs stimulate cancer cell migration and increase their area, <xref rid="fig2" ref-type="fig">Fig. 2b</xref>.</p>
<p>Interestingly, CausalXtract identifies also multiple and possibly antagonistic effects with different time delays. For instance, CausalXtract recovers several antagonistic relations between morphodynamic features such as cell division and eccentricity or cell apoptosis and area, <xref rid="fig2" ref-type="fig">Fig. 2d</xref>. Indeed, the late phases of cell division are associated to a marked increase in eccentricity (red edge) but preceded by a net decrease in eccentricity, two to three hours before cytokinesis (blue edges), once the decision to divide has been made (<italic>i</italic>.<italic>e</italic>. the probable latent cause) and the cell is actually duplicating its biological materials (prophase), <xref rid="fig2" ref-type="fig">Fig. 2d</xref>. Likewise, the area change upon apoptosis is predicted to first decrease soon after apoptosis (blue edge) before eventually increasing upon cell lysis (red edge), <xref rid="fig2" ref-type="fig">Fig. 2d</xref>. These results are robust to variations in sampling rate, <xref rid="figS8" ref-type="fig">Supplementary Fig. 8</xref>.</p>
<p>All in all, CausalXtract is a flexible pipeline which uncovers novel and possibly time-lagged causal relations between cellular features under controlled conditions (<italic>e</italic>.<italic>g</italic>. drug). CausalXtract uniquely combines live-cell feature extraction with information theory and causal discovery approaches. It consists of two independent computational modules, conceived to warrant interoperability with alternative live-cell segmentation and tracking methods or alternative temporal causal discovery methods.</p>
<p>CausalXtract opens up new avenues to analyze live-cell imaging data for a range a fundamental and translational research applications, such as the use of tumor-on-chips to screen immunotherapy responses on patient-derived tumor samples. With the advent of virtually unlimited live-cell image data, flexible hypothesis-free interpretation methods are much needed<sup><xref ref-type="bibr" rid="c17">17</xref></sup> and we believe that CausalXtract can bring unique insights based on causal discovery to interpret such informationrich live-cell imaging data.</p>
</sec>
</sec>
<sec id="s2">
<title>Materials and Methods</title>
<sec id="s2a">
<title>Tumor-on-chip preparation and live-cell microscopy</title>
<p>Videos analyzed in the present study refer to biological experiments emulating a 3D breast tumor ecosystem<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. All tumor-on-chip experiments have a central endothelium compartment containing endothelial cells (primary human umbilical vein endothelial cells, HUVECs) and two lateral chambers filled with biomimetic hydrogel (collagen type I at 2.3 mg/mL) seeded with cancer cells (HER2+ breast cancer BT474 cell line) and immune cells (peripheral blood mononuclear cells, PBMCs) from healthy donors, <xref rid="fig1" ref-type="fig">Fig. 1a</xref>. Four experimental conditions were considered depending on the presence or absence of breast cancer-associated fibroblasts (CAF cell line Hs578T) and drug treatment (trastuzumab, Herceptin). Videos were acquired by inverted motorized Leica microscopes with a frame rate of 2 minutes for up to 48h (1440 frames). <xref rid="fig1" ref-type="fig">Fig. 1b</xref> shows a crop frame with cancer cells, PBMCs and CAFs. Each video was cropped into multiple small 300<italic>×</italic>300 pixel videos (referred to as crops in the following), each of which represented a field of view at subsequent time frames containing a “main” cancer cell (MCC) initially placed at the center of the image, some PBMC immune cells, other cancer cells and possibly CAFs within the surrounding of the MCC depending on the experimental conditions. 36 video crops of up to 1440 frames were analyzed (46,935 frames in total) corresponding to 9 video crops per experimental conditions.</p>
</sec>
<sec id="s2b">
<title>CausalXtract’s live-cell image feature extraction module</title>
<p>The live-cell image feature extraction module (CellHunter+), <xref rid="fig1" ref-type="fig">Fig. 1b</xref>, extends the CellHunter software<sup><xref ref-type="bibr" rid="c1">1</xref></sup> and consists in three steps: detection, tracking and feature extraction of live cells within timelapse video images. First, cell detection is based on the segmentation of circular-shaped objects using CHT<sup><xref ref-type="bibr" rid="c2">2</xref></sup> with radii set around the theoretical radii of the two cell populations (<italic>r</italic><sub>im</sub> = 4 px for immune cells and <italic>r</italic><sub>ca</sub> = 14 px for MCCs with a pixel resolution 1 px = 0.645 <italic>μ</italic>m<sup>1</sup>). Then, cell tracking is performed by linking cells detected at the <italic>i</italic><sup><italic>th</italic></sup> frame to cells located at the (<italic>i</italic> + 1)<sup><italic>th</italic></sup> frame within a maximum distance from the detected cell candidate. While the motions of both MCCs and immune cells ressemble random walks with time-varying drift and volatility, these two cell types exhibit different motility characteristics<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Hence, different maximum distances are considered for the two cell populations: it was set to 40 px for MCCs and to 20 px for immune cells. For each cell population, an OAP using the Munkres algorithm<sup><xref ref-type="bibr" rid="c3">3</xref></sup> is solved: the globally best possible pairing among located objects is based on an assignment cost equal to the inverse of the distance between pairs of cell candidates at the <italic>i</italic><sup><italic>th</italic></sup> and (<italic>i</italic> + 1)<sup><italic>th</italic></sup> frames. Cell appearing/disappearing and cell overlaps due to projection errors of the 3D scene in the 2D domain are also handled. Finally, cellular morphodynamic features and cell-cell interaction features are extracted at successive positions along each trajectory. For each MCC, 15 descriptors were extracted, <xref rid="figS6" ref-type="fig">Supplementary Fig. 6</xref>, and classified into four main categories: cell shape, motility, state, and interaction descriptors.</p>
<sec id="s2b1">
<title>Shape descriptors</title>
<p>The active contour algorithm implemented in Matlab<sup><xref ref-type="bibr" rid="c18">18</xref></sup> was used to segment the MCC boundaries on each video crop frame. Taking as input a frame representing the <italic>i</italic><sup><italic>th</italic></sup> snapshot of the <italic>t</italic><sup><italic>th</italic></sup> MCC, it returns a binary image, where the MCC is represented by a white region. From the binary image, the shape properties of the region occupied by each MCC were extracted using the Matlab <italic>regionprops</italic> algorithm. The resulting descriptors of the extracted shape are listed below:</p>
<list list-type="bullet">
<list-item><p><italic>area</italic> indicates the number of pixels composing the region. The equivalent diameter of the <italic>t</italic><sup><italic>th</italic></sup> MCC in the <italic>i</italic><sup><italic>th</italic></sup> frame is defined as<inline-formula><inline-graphic xlink:href="579177v1_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p></list-item>
<list-item><p><italic>perimeter</italic> represents the distance along the MCC boundary.</p></list-item>
<list-item><p><italic>circularity</italic> is defined as 4 <italic>· area · π/perimeter</italic><sup><xref ref-type="bibr" rid="c2">2</xref></sup>, which is equal to 1 when the region is perfectly circular.</p></list-item>
<list-item><p><italic>eccentricity</italic> denotes the eccentricity of the ellipse with the same second moments as the region. The value is equal to 1 when the region is a line and to 0 when the region is a circle.</p></list-item>
<list-item><p><italic>instantaneous shape change</italic> is defined as, <inline-formula><inline-graphic xlink:href="579177v1_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, corresponding to the difference in absolute value of the equivalent diameters between the <italic>i</italic><sup><italic>th</italic></sup> and (<italic>i −</italic> 1)<sup><italic>th</italic></sup> frames of the <italic>t</italic><sup><italic>th</italic></sup> MCC.</p></list-item>
</list>
</sec>
<sec id="s2b2">
<title>Motility descriptors</title>
<p>The positions <inline-formula><inline-graphic xlink:href="579177v1_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="579177v1_inline3a.gif" mime-subtype="gif" mimetype="image"/></inline-formula> of the <italic>t</italic><sup><italic>th</italic></sup> MCC in the <italic>i</italic><sup><italic>th</italic></sup> and (<italic>i −</italic> 1)<sup><italic>th</italic></sup> frames were compared using the Euclidean distance <italic>d</italic>(<italic>·</italic>) to define the following motility parameters:</p>
<list list-type="bullet">
<list-item><p><italic>instantaneous cancer velocity</italic><sup><xref ref-type="bibr" rid="c19">19</xref></sup> is defined as<inline-formula><inline-graphic xlink:href="579177v1_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where Δ<italic>t</italic> is the time interval between two consecutive frames.</p></list-item>
<list-item><p><italic>net displacement</italic><sup><xref ref-type="bibr" rid="c19">19</xref></sup> indicates the resultant distance between the initial and current positions of the <italic>t</italic><sup><italic>th</italic></sup> MCC,<inline-formula><inline-graphic xlink:href="579177v1_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p></list-item>
<list-item><p><italic>directionality</italic><sup><xref ref-type="bibr" rid="c19">19</xref></sup> is defined as the ratio of net displacement, <inline-formula><inline-graphic xlink:href="579177v1_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and curvilinear distance,<inline-formula><inline-graphic xlink:href="579177v1_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. It measures the persistence of motion and ranges from 0 for confined cells to 1 for cells moving perfectly straight in one direction.</p></list-item>
</list>
</sec>
<sec id="s2b3">
<title>State descriptors</title>
<p>They record apoptosis or division events:</p>
<list list-type="bullet">
<list-item><p><italic>apoptosis</italic> indicates if the MCC has died during the experiment. It is set to ‘No’ as long as the cell has not died and becomes ‘Yes’ for the remaining frames after the cell undergoes apoptosis.</p></list-item>
<list-item><p><italic>division</italic> indicates if the MCC has divided during the experiment. It is set to ‘No’ as long as the cell has not divided and becomes ‘Yes’ for the remaining frames after the cell divides.</p></list-item>
</list>
</sec>
<sec id="s2b4">
<title>Interaction descriptors</title>
<p>Interactions between MCCs and immune cells were defined with respect to two radii around each MCC, <italic>r</italic><sub>1</sub> = <italic>r</italic><sub>im</sub> + <italic>r</italic><sub>ca</sub> + 2 = 20 px and <italic>r</italic><sub>2</sub> = 2 <italic>×</italic> (<italic>r</italic><sub>im</sub> + <italic>r</italic><sub>ca</sub>) = 36 px<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Hence, <italic>r</italic><sub>1</sub> refers to MCC and immune cells in actual physical contact, while <italic>r</italic><sub>2</sub> refers to MCC and immune cells in close vicinity. Then, for each sample the following interaction features were defined:</p>
<list list-type="bullet">
<list-item><p><italic>number of cancer-immune interactions (r</italic><sub>2</sub><italic>)</italic> corresponds to the number of immune cells within the interaction radius <italic>r</italic><sub>2</sub> around the MCC on that frame.</p></list-item>
<list-item><p><italic>number of cancer-immune interactions (r</italic><sub>1</sub><italic>)</italic> corresponds to the number of immune cells in close contact with the MCC on that frame.</p></list-item>
<list-item><p><italic>minimal cancer-immune distance (r</italic><sub>2</sub><italic>)</italic> is the minimum distance between the MCC and the immune cells within a radius <italic>r</italic><sub>2</sub>.</p></list-item>
<list-item><p><italic>mean immune velocity (r</italic><sub>2</sub><italic>)</italic> is the mean instantaneous velocity norm of the immune cells within the interaction radius <italic>r</italic><sub>2</sub> around the MCC.</p></list-item>
<list-item><p><italic>mean immune velocity (r</italic><sub>1</sub><italic>)</italic> is the mean instantaneous velocity norm of the immune cells in close contact with the MCC.</p></list-item>
</list>
</sec>
</sec>
<sec id="s2c">
<title>Overview of causal discovery methods for non-temporal data</title>
<p>Traditional causal discovery methods<sup><xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c21">21</xref></sup> aim to learn causal networks from datasets of independent samples by proceeding through successive steps. They first learn structural constraints in the form of unconditional or conditional independence between variables and remove the corresponding edges from an initial fully connected network. The second step then consists in orienting some of the retained edges based on the signature of causality in observational data. This corresponds to orienting three-variable “v-structure” motifs as, <italic>X → Z ← Y</italic>, whenever the edge <italic>X − Y</italic> has been removed without conditioning on the variable <italic>Z</italic>, which implies that <italic>Z</italic> cannot be a cause of <italic>X</italic> nor <italic>Y</italic>. This does not guarantee, however, that <italic>X</italic> (or <italic>Y</italic>) is an actual cause of <italic>Z</italic>, which also requires to rule out the possibility that the edge between <italic>X</italic> and <italic>Z</italic> (or <italic>Y</italic> and <italic>Z</italic>) might originate from a latent common cause, <italic>L</italic>, unobserved in the dataset, <italic>i</italic>.<italic>e. X ⤎ L ⤏ Z</italic>. In addition, classical causal discovery methods are prone to spurious conditional independences, which lead to many false negative edges and limit the accuracy of inferred orientations. The recent causal discovery method, MIIC<sup><xref ref-type="bibr" rid="c4">4</xref>–<xref ref-type="bibr" rid="c6">6</xref></sup>, which combines constraint-based and information-based principles, learns more robust causal graphical models by first collecting iteratively significant information contributors before assessing conditional independences. In practice, MIIC’s strategy limits spurious conditional independences which improves its edge sensitivity and orientation reliability compared to traditional constraint-based methods<sup><xref ref-type="bibr" rid="c4">4</xref>–<xref ref-type="bibr" rid="c6">6</xref></sup>. In addition, MIIC can handle missing data<sup><xref ref-type="bibr" rid="c5">5</xref></sup> and also heterogeneous multimodal data, by analyzing continuous and categorical variables on the same footing, based on a mutual information supremum principle for finite dataset<sup><xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c6">6</xref></sup>. Last, MIIC distinguishes genuine causal relations from putative and latent causal effects<sup><xref ref-type="bibr" rid="c6">6</xref></sup>, that are ubiquitous in real-world applications.</p>
</sec>
<sec id="s2d">
<title>CausalXtract’s causal discovery module for time series data</title>
<p>In order to analyze time series datasets, CausalXtract’s causal discovery module (tMIIC) aims to learn a time-unfolded graph, <italic>G</italic><sub><italic>t</italic></sub>, where each variable is represented by a series of nodes associated to its value at different relative time points, <xref rid="fig1" ref-type="fig">Fig. 1c</xref>. Such a timeunfolded network framework<sup><xref ref-type="bibr" rid="c10">10</xref>–<xref ref-type="bibr" rid="c13">13</xref></sup> is required to account for the temporal correlation between successive samples in time series data. Assuming that the dynamics can be considered stationary (see Benchmarking of CausalXtract’s causal discovery module section, below), the time-unfolded graph, <italic>𝒢</italic><sub><italic>t</italic></sub>, should be translationally invariant over time and can be assigned a periodic structure <italic>a priori</italic>. In addition, <italic>G</italic><sub><italic>t</italic></sub> can be restricted to a few time steps from the running time, <italic>t</italic>, back to a maximum time lag, <italic>t ′ τ</italic>, since nodes at future time points (<italic>t</italic><sup><italic>’</italic></sup> <italic>&gt; t</italic>) cannot <italic>a priori</italic> influence the observed data at current or previous time points (<italic>t’⩽ t</italic>), <xref rid="fig1" ref-type="fig">Fig. 1c</xref>. The maximum time lag <italic>τ</italic> should be chosen so as to have little effect on the final graphical model, which can be achieved for instance by setting <italic>τ</italic> to twice the average relaxation time of the variables of the dataset. In practice, we may also limit the number of time points <italic>ν</italic> in <italic>G</italic><sub><italic>t</italic></sub> by introducing a time increment <italic>δτ</italic> between consecutive time points, which leads to <italic>ν</italic> = <italic>τ/δτ</italic> time-lagged layers in <italic>𝒢</italic><sub><italic>t</italic></sub>.</p>
<p>Such a compact periodic graphical representation over a sliding temporal window is learned with tMIIC, which extends MIIC causal discovery method to analyze time series data. First, tMIIC identifies all necessary edges involving at least one contemporaneous node at time <italic>t</italic>, <xref rid="fig1" ref-type="fig">Fig. 1c</xref>. Once these time-lagged and contemporaneous necessary edges have been identified, they are simply duplicated at earlier time points to enforce the translational invariance of <italic>𝒢</italic><sub><italic>t</italic></sub> skeleton. Time-lagged edges are then pre-oriented with a first arrowhead pointing towards the future, considering that current time points cannot cause earlier events. Then, contemporaneous and time-lagged edges can be further oriented using MIIC orientation probability scores applied to <italic>𝒢</italic><sub><italic>t</italic></sub>, which may also uncover a second arrowhead (backward in time) for time-lagged edges. This corresponds to time-lagged latent causal effects from unobserved common causes, <xref rid="fig1" ref-type="fig">Fig. 1c</xref>.</p>
<p>Learning such structural models including latent variables from time series data was first proposed for time-lagged effects<sup><xref ref-type="bibr" rid="c10">10</xref></sup> and subsequently extended to contemporaneous effects<sup><xref ref-type="bibr" rid="c11">11</xref></sup> by adapting the constraint-based FCI method allowing for latent variables<sup><xref ref-type="bibr" rid="c21">21</xref></sup>. While traditional constraint-based methods suffer from poor recall, the recent PCMCI<sup><xref ref-type="bibr" rid="c12">12</xref></sup> / PCMCI+<sup><xref ref-type="bibr" rid="c22">22</xref></sup> method improves recall by introducing ad hoc conditioning rules for auto-correlated time series. By contrast, tMIIC does not require any ad hoc conditioning rules, as it relies on the same robust information-theoretic strategy as MIIC to limit spurious independence and improve edge recall. tMIIC also captures time-lagged and contemporaneous effects due to latent variables.</p>
</sec>
<sec id="s2e">
<title>Relation to Granger-Schreiber temporal causality</title>
<p>The concept of temporal causality was originally formulated by Granger<sup><xref ref-type="bibr" rid="c14">14</xref></sup> without reference to any graphical model by comparing linear autoregression with or without past values of possible causal variables. This was later extended to non-linear relations by Schreiber<sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c16">16</xref></sup> using the notion of Transfer Entropy, <italic>T</italic><sub><italic>X→Y</italic></sub>, which can be expressed in terms of multivariate conditional information,
<disp-formula id="eqn1">
<graphic xlink:href="579177v1_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="579177v1_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="579177v1_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula> denote the sets of variables, <inline-formula><inline-graphic xlink:href="579177v1_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and<inline-formula><inline-graphic xlink:href="579177v1_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, taken at earlier time points <italic>t</italic><sup><italic>’</italic></sup> than <italic>t</italic>.</p>
<p>While <xref ref-type="disp-formula" rid="eqn1">Eq. 1</xref> is asymmetric upon <italic>X</italic>/<italic>Y</italic> permutation, a simple comparison of Transfer Entropy asymmetry (<italic>e</italic>.<italic>g. T</italic><sub><italic>X→Y</italic></sub> <italic>&gt; T</italic><sub><italic>Y → ⩾</italic></sub> 0) does not necessarily translate into causal direction as this asymmetry is also expected for non-causal relations. Interestingly, this is in fact the absence of Transfer Entropy in one direction (<italic>e</italic>.<italic>g. T</italic><sub><italic>Z→X</italic></sub> <italic>≈</italic> 0) which suggests the possibility of a causal relation in the opposite direction, <italic>X → Z</italic>, as in the case of v-structures in graph-based causal discovery methods, provided that a latent common cause can be excluded between the two variables (as discussed above).</p>
<p>We clarify in Theorem 1 below this relation between temporal causality without reference to any structural model (<xref ref-type="disp-formula" rid="eqn1">Eq. 1</xref>) and structural causality entailed by time-unfolded causal graphical models (<italic>𝒢</italic> <sub><italic>t</italic></sub>). This highlights the common foundations of temporal and structural causalities beyond their seemingly unrelated definitions.</p>
<statement id="alg1">
<label>Theorem 1.</label>
<p>[<italic>T</italic><sub><italic>Y →X</italic></sub> = 0 implies temporal (2 <italic>var</italic> + <italic>t</italic>) v-structures] If <italic>X</italic><sub><italic>t</italic></sub> is adjacent to <italic>Y</italic><sub><italic>t</italic></sub> in <italic>𝒢</italic> <sub><italic>t</italic></sub> and<inline-formula><inline-graphic xlink:href="579177v1_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, then for all <inline-formula><inline-graphic xlink:href="579177v1_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula> adjacent to <italic>Y</italic><sub><italic>t</italic></sub> in <italic>𝒢</italic> <sub><italic>t</italic></sub>, with <italic>t</italic><sup><italic>’</italic></sup> <italic>&lt; t</italic>, there is a temporal (2 <italic>var</italic>+<italic>t</italic>) v-structure, <inline-formula><inline-graphic xlink:href="579177v1_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, in <italic>𝒢</italic> <sub><italic>t</italic></sub>, <xref rid="figS5" ref-type="fig">Supplementary Fig. 5a</xref>.</p>
    <p><bold><italic>Proof</italic></bold> : if<inline-formula><inline-graphic xlink:href="579177v1_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, then all pairs <inline-formula><inline-graphic xlink:href="579177v1_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula> should be unconnected (assuming ‘faithfulness’, <italic>i</italic>.<italic>e</italic>. no coincidental cancellation of effects) and all unshielded triples <inline-formula><inline-graphic xlink:href="579177v1_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula> should be temporal v-structures, <inline-formula><inline-graphic xlink:href="579177v1_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, as <inline-formula><inline-graphic xlink:href="579177v1_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in <italic>T</italic><sub><italic>Y →X</italic></sub>◻</p>
</statement>
<p>Note, however, that the converse of Theorem 1 is not true: a temporal v-structure does not imply a vanishing Transfer Entropy, as shown with the counterexample in <xref rid="figS5" ref-type="fig">Supplementary Fig. 5b</xref>. As a result, the presence of a temporal v-structure, <inline-formula><inline-graphic xlink:href="579177v1_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in <italic>𝒢</italic> <sub><italic>t</italic></sub>, does not necessarily imply a vanishing transfer entropy, <italic>T</italic><sub><italic>Y →X</italic></sub> = 0, as long as there remains an edge between any <inline-formula><inline-graphic xlink:href="579177v1_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>X</italic><sub><italic>t</italic></sub>, as in the example in <xref rid="figS5" ref-type="fig">Supplementary Fig. 5b</xref>. Hence, Granger-Schreiber causality is in fact too restrictive and may miss actual causal effects, which can be uncovered by structural causal discovery methods like tMIIC. In addition, Granger-Schreiber causality is also known to infer spurious causal associations by excluding the presence of latent common causes <italic>a priori</italic>. By constrast, CausalXtract’s causal discovery module includes time-delayed as well as synchronous effects originating from unobserved latent variables, as discussed above.</p>
</sec>
<sec id="s2f">
<title>Benchmarking of CausalXtract’s causal discovery module</title>
<p>The performance of CausalXtract’s causal discovery module (tMIIC) has been assessed using Tigramite package<sup><xref ref-type="bibr" rid="c22">22</xref></sup>, which provides different methods to learn temporal causal networks from time series data. We compared tMIIC to two methods capable of orienting contemporaneous edges (PC and PCMCI+) and tested three different kernels for estimating mutual information (Parcorr, GPDC and KNN).</p>
<p>Benchmark networks and datasets have been chosen to resemble the real-world data analyzed in this study (<italic>i</italic>.<italic>e</italic>. similar number of time steps, network size and degree distribution) and include a large range of linear and non-linear relations between variables.</p>
<p>A first series of datasets was generated for a 15 node benchmark network (<xref rid="figS1" ref-type="fig">Supplementary Fig. 1a</xref>) with linear combinations of contributions inspired by the Tigramite package, <xref rid="tblS1" ref-type="table">Supplementary Table 1</xref>. Running times and scores (Precision, Recall, F-score) have been averaged over 10 datasets (<xref rid="figS1" ref-type="fig">Supplementary Fig. 1b</xref>) and show that tMIIC scores are at par with PC and PCMCI+ using GPDC or KNN kernels but that tMIIC runs orders of magnitude faster, which enables to use tMIIC on much larger datasets of biological interest including a few tens or hundreds of thousands samples. Only PC or PCMCI+ using ParCorr kernel match tMIIC running speed but with significantly lower scores, as Fscores level off around 0.6-0.7 at large sample size, while tMIIC Fscore exceeds 0.9 (<xref rid="figS1" ref-type="fig">Supplementary Fig. 1b</xref>).</p>
<p>Importantly, increasing the number of time-lagged layers from <italic>τ</italic> = 2 (as in the actual model, <xref rid="figS1" ref-type="fig">Supplementary Fig. 1a</xref>) to 5 or 10 layers in the inferred time-unfolded network (<xref rid="figS2" ref-type="fig">Supplementary Fig. 2</xref>) leads to very similar network reconstructions for simulated stationary data. This demonstrates tMIIC insensitivity to an overestimated maximum lag for the reconstituted network. Interestingly, however, when the generated data is no longer stationary, increasing the number of layers leads to multiple self-loops at non-stationary variables, whilst the rest of the network remains relatively unaffected (<xref rid="figS3" ref-type="fig">Supplementary Fig. 3</xref>). It demonstrates that CausalXtract’s causal discovery module is robust to the presence of non-stationary variables but requires long-time range interactions, and therefore multiple timelagged layers, to account for these non-stationary dynamics at specific variables. This striking observation on benchmark networks is also consistent with the multiple self-loops observed for a number of non-stationary variables in the real-world application on cellular ecosystems, <xref rid="fig2" ref-type="fig">Fig. 2a</xref> and <xref rid="figS6" ref-type="fig">Supplementary Fig. 6</xref>.</p>
<p>A second series of more complex datasets was also generated for another 15 node benchmark network (<xref rid="figS4" ref-type="fig">Supplementary Fig. 4a</xref>) with non-linear combinations of contributors, <xref rid="tblS2" ref-type="table">Supplementary Table 2</xref>. Here, tMIIC tends to outperform both PC and PCMCI+, in terms of Recall and Fscores, while remaining orders of magnitude faster compared to GPDC and KNN kernels. Only PC or PCMCI+ using ParCorr kernel match tMIIC running speed but with significantly lower scores (<italic>i</italic>.<italic>e</italic>. Fscores level off around 0.4-0.5 at large sample size, while tMIIC Fscore exceeds 0.8). This demonstrates that CausalXtract’s causal discovery module (tMIIC) is both a reliable and scalable method to discover complex temporal causal relations in very large time series datasets including a few hundred thousand samples.</p>
</sec>
</sec>
</body>
<back>
<sec id="s3">
<title>Data availability</title>
<p>The original live-cell time-lapse image data and extracted crops are available at: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7755699">https://doi.org/10.5281/zenodo.7755699</ext-link>.</p>
</sec>
<sec id="s4">
<title>Code availability</title>
<p>The source code of the CausalXtract pipeline is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/miicTeam/CausalXtract">https://github.com/miicTeam/CausalXtract</ext-link>. It includes a demo R markdown notebook of CausalXtract pipeline, which reproduces step-by-step the results reported in the manuscript, <xref rid="fig2" ref-type="fig">Fig. 2</xref>, starting from the original live-cell time-lapse images of the tumor-on-chip ecosystem, <xref rid="fig1" ref-type="fig">Fig. 1a</xref>. Tigramite package used for benchmark comparison is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/jakobrunge/tigramite">https://github.com/jakobrunge/tigramite</ext-link></p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>This work was supported by ITMO Cancer (grant No 20CM106) and the European Union’s Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie grant agreement No 847718. LD acknowledges support from AMX PhD fellowship, VC from ARC foundation and NL from CNRS-Imperial College joint PhD programme.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Dissecting Effects of Anti-cancer Drugs and Cancer-Associated Fibroblasts by On-Chip Reconstitution of Immunocompetent Tumor Microenvironments</article-title>. <source>Cell Reports</source> <volume>25</volume>, <fpage>3884</fpage>–<lpage>3893.e3</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Davies</surname>, <given-names>E.</given-names></string-name></person-group> <source>Machine vision 3rd</source> ed. (<publisher-name>Morgan Kaufmann</publisher-name>, <year>2004</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Munkres</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Algorithms for the assignment and transportation problems</article-title>. <source>J. Soc. Ind. Appl. Math</source>. <volume>5</volume>, <fpage>32</fpage>–<lpage>38</lpage> (<year>1957</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Verny</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Sella</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Affeldt</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Singh</surname>, <given-names>P. P.</given-names></string-name> &amp; <string-name><surname>Isambert</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Learning causal networks with latent variables from multivariate information in genomic data</article-title>. <source>PLoS Comput. Biol</source>. <volume>13</volume>, <fpage>e1005662</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cabeli</surname>, <given-names>V.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Learning clinical networks from medical records based on information estimates in mixed-type data</article-title>. <source>PLoS Comput. Biol</source>. <volume>16</volume>, <fpage>e1007866</fpage> (<year>2020</year>).</mixed-citation></ref>
    <ref id="c6"><label>6.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Da Câmara Ribeiro-Dantas</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Learning interpretable causal networks from very large datasets, application to 400,000 medical records of breast cancer patients</article-title>. <source>arXiv</source>, <pub-id pub-id-type="doi">10.48550/arXiv.2303.06423</pub-id> (<year>2023</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Desterke</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Inferring Gene Networks in Bone Marrow Hematopoietic Stem Cell-Supporting Stromal Niche Populations</article-title>. <source>iScience</source> <volume>23</volume>, <fpage>101222</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sella</surname>, <given-names>N.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Interactive exploration of a global clinical network from a large breast cancer cohort</article-title>. <source>npj Digital Med</source> <volume>5</volume>, <fpage>113</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Assaad</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Devijver</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Gaussier</surname>, <given-names>E.</given-names></string-name></person-group> <article-title>Survey and Evaluation of Causal Discovery Methods for Time Series</article-title>. <source>Journal of Artificial Intelligence Research</source> <volume>73</volume>, <fpage>767</fpage>–<lpage>819</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Entner</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Hoyer</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>On Causal Discovery from Time Series Data using FCI</article-title>. <conf-name>Proceedings of the 5th European Workshop on Probabilistic Graphical Models</conf-name>, (<year>2010</year>).</mixed-citation></ref>
    <ref id="c11"><label>11.</label><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Malinsky</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Spirtes</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>Causal Structure Learning from Multivariate Time Series in Settings with Unmeasured Confounding</article-title>, <conf-name>Proceedings of 2018 ACM SIGKDD Workshop on Causal Disocvery</conf-name>, <volume>92</volume> (<year>2018</year>), <fpage>23</fpage>–<lpage>47</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Runge</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Nowack</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Kretschmer</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Flaxman</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Sejdinovic</surname>, <given-names>D.</given-names></string-name></person-group> <article-title>Detecting and quantifying causal associations in large nonlinear time series datasets</article-title>. <source>Science Advances</source> <volume>5</volume> (<year>2019</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Runge</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Inferring causation from time series in Earth system sciences</article-title>. <source>en. Nat. Commun</source>. <volume>10</volume>, <fpage>2553</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Granger</surname>, <given-names>C. W. J.</given-names></string-name></person-group> <article-title>Investigating causal relations by econometric models and cross-spectral methods</article-title>. <source>Econometrica</source> <volume>37</volume>, <fpage>424</fpage> (<year>1969</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schreiber</surname>, <given-names>T.</given-names></string-name></person-group> <article-title>Measuring Information Transfer</article-title>. <source>Physical Review Letters</source> <volume>85</volume>, <fpage>461</fpage>–<lpage>464</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barnett</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Barrett</surname>, <given-names>A. B.</given-names></string-name> &amp; <string-name><surname>Seth</surname>, <given-names>A. K.</given-names></string-name></person-group> <article-title>Granger Causality and Transfer Entropy Are Equivalent for Gaussian Variables</article-title>. <source>Physical Review Letters</source> <volume>103</volume> (<year>2009</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Driscoll</surname>, <given-names>M. K.</given-names></string-name> &amp; <string-name><surname>Zaritsky</surname>, <given-names>A.</given-names></string-name></person-group> <article-title>Data science in cell imaging</article-title>. <source>Journal of Cell Science</source> <volume>134</volume>, <fpage>jcs254292</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chan</surname>, <given-names>T. F.</given-names></string-name> &amp; <string-name><surname>Vese</surname>, <given-names>L. A.</given-names></string-name></person-group> <article-title>Active contours without edges</article-title>. <source>IEEE Trans. Image Process</source>. <volume>10</volume>, <fpage>266</fpage>–<lpage>277</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Masuzzo</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Van Troys</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Ampe</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Martens</surname>, <given-names>L.</given-names></string-name></person-group> <article-title>Taking aim at moving targets in computational cell migration</article-title>. <source>Trends Cell Biol</source>. <volume>26</volume>, <fpage>88</fpage>–<lpage>110</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Pearl</surname>, <given-names>J.</given-names></string-name></person-group> <source>Causality</source> (<publisher-name>Cambridge university press</publisher-name>, <year>2009</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Spirtes</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Glymour</surname>, <given-names>C. N.</given-names></string-name>, <string-name><surname>Scheines</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Heckerman</surname>, <given-names>D.</given-names></string-name></person-group> <source>Causation, prediction, and search</source> (<publisher-name>MIT press</publisher-name>, <year>2000</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Runge</surname>, <given-names>J.</given-names></string-name></person-group>, <article-title>Discovering contemporaneous and lagged causal relations in autocorrelated nonlinear time series datasets</article-title>, <conf-name>Proceedings of the 36th Conference on Uncertainty in Artificial Intelligence</conf-name>. <volume>124</volume> (<year>2020</year>), <fpage>1388</fpage>–<lpage>1397</lpage>.</mixed-citation></ref>
</ref-list>
<sec>
<fig id="figS1" position="float" fig-type="figure">
<label>Supplementary Fig. 1:</label>
<caption><title>Benchmark assessment of CausalXtract’s causal discovery module (tMIIC) using generated time series datasets.</title>
<p><bold>a</bold>, Example of a 15 node causal network to generate benchmark time series datasets based on linear combinations of contributions, <xref rid="tblS1" ref-type="table">Supplementary Table 1</xref>. Examples of temporal causal networks reconstructed by tMIIC based on 100, 1,000 or 10,000 simulated time steps. <bold>b</bold>, Running times and scores (Precision, Recall, Fscore) averaged over 10 datasets and compared to PC and PCMCI+ methods using different kernels (GPDC, KNN, ParCorr); tMIIC is at par with PC and PCMCI+ scores using GPDC and KNN kernels but runs orders of magnitude faster. Only ParCorr kernel matches tMIIC running speed but with significantly lower scores at large sample size, see Methods.</p></caption>
<graphic xlink:href="579177v1_figS1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Supplementary Fig. 2:</label>
<caption><title>CausalXtract insensitivity to an overestimated maximum lag <italic>τ</italic>.</title>
<p><bold>a</bold>, Example of a temporal causal network model with a maximum lag <italic>τ</italic> = 2. Corresponding temporal causal networks inferred by CausalXtract’s causal discovery module (tMIIC), from 1,000 time step stationary time series (<xref rid="tblS1" ref-type="table">Supplementary Table 1</xref>), while assuming different maximum lags <italic>τ</italic> = 2, 5 or 10. <bold>b</bold>, Running times and scores (Precision, Recall, Fscore) of tMIIC temporal causal network reconstructions for <italic>τ</italic> = 2, 5 or 10, averaged over ten stationary time series of 10 to 10<sup>5</sup> time steps. Overestimating the maximum lag <italic>τ</italic> has little impact on the reconstructed networks, as long as the time series are stationary, as demonstrated in <xref rid="figS3" ref-type="fig">Supplementary Fig. 3</xref>.</p></caption>
<graphic xlink:href="579177v1_figS2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Supplementary Fig. 3:</label>
<caption><title>CausalXtract sensitivity to non-stationary variables.</title>
<p><bold>a</bold>, Example of a temporal causal network model (<italic>τ</italic> = 2) with a low frequency periodic input (<italic>T</italic> = 100) applied to X8 and a time-linear trend applied to X13. Corresponding temporal causal networks inferred by tMIIC from 1,000 time step time series (<xref rid="tblS1" ref-type="table">Supplementary Table 1</xref>) including non-stationary inputs to X8 and X13. Increasing the maximum lag from <italic>τ</italic> = 2 to <italic>τ</italic> = 5 or 10 leads to the appearence of multiple self-loops, which result from the non-stationary dynamics of X8 and X13, whilst the rest of the network remains largely unaffected. <bold>b</bold>, Running times and scores (Precision, Recall, Fscore ignoring X8 and X13 self-loops) of tMIIC causal network reconstructions for <italic>τ</italic> = 2, 5 or 10, averaged over ten time series of 10 to 10<sup>5</sup> time steps.</p></caption>
<graphic xlink:href="579177v1_figS3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Supplementary Fig. 4:</label>
<caption><title>Benchmark assessment of CausalXtract’s causal discovery module (tMIIC) using more complex time series datasets.</title>
<p><bold>a</bold>, Example of a 15 node causal network to generate more complex benchmark time series datasets based on non-linear combinations of contributions, <xref rid="tblS2" ref-type="table">Supplementary Table 2</xref>. Examples of temporal causal networks reconstructed by tMIIC based on 100, 1,000 or 10,000 simulated time steps. <bold>b</bold>, Running times and scores (Precision, Recall, Fscore) averaged over 10 datasets and compared to PC and PCMCI+ methods using different kernels (GPDC, KNN, ParCorr); tMIIC outperforms both PC and PCMCI+, in terms of Recall and Fscores, while running orders of magnitude faster, except for the ParCorr kernel, which leads, however, to significantly lower scores at large sample size.</p></caption>
<graphic xlink:href="579177v1_figS4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Supplementary Fig. 5:</label>
<caption><title>Time-unfolded causal network framework and relation to Granger-Schreiber temporal causality.</title>
<p><bold>a</bold>, A vanishing Transfer Entropy, <italic>i</italic>.<italic>e</italic>.<inline-formula><inline-graphic xlink:href="579177v1_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, implies <italic>i)</italic> the absence of (dashed) edge between <italic>X</italic><sub><italic>t</italic></sub> and any<inline-formula><inline-graphic xlink:href="579177v1_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, with <italic>t</italic><sup><italic>’</italic></sup> <italic>&lt; t</italic>, and <italic>ii)</italic> if <italic>X</italic><sub><italic>t</italic></sub> is adjacent to <italic>Y</italic><sub><italic>t</italic></sub>, the presence of temporal (2-variable + time) v-structures, <inline-formula><inline-graphic xlink:href="579177v1_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, for all <inline-formula><inline-graphic xlink:href="579177v1_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula> adjacent to <italic>Y</italic><sub><italic>t</italic></sub>, with <italic>t</italic><sup><italic>’</italic></sup> <italic>&lt; t</italic> (Methods, Theorem 1). These results can be readily extended to include the presence of other observed variables, <inline-formula><inline-graphic xlink:href="579177v1_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, by redefining Transfer Entropy as, <inline-formula><inline-graphic xlink:href="579177v1_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, which discards contributions from indirect paths through other observed variables, <inline-formula><inline-graphic xlink:href="579177v1_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, By contrast, the presence of a temporal (2-variable + time) v-structure, <inline-formula><inline-graphic xlink:href="579177v1_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula> does not imply a vanishing Transfer Entropy, as long as there remains an edge between any <inline-formula><inline-graphic xlink:href="579177v1_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>X</italic><sub><italic>t</italic></sub>. It implies that Granger-Schreiber temporal causality is in fact too restrictive and may overlook actual causal effects, which can be uncovered by graph-based causal discovery methods like CausalXtract’s causal discovery module (tMIIC). Hence, CausalXtract’s time-unfolded network framework, combining graph-based and information-based approaches, sheds light on the common foundations of the seemingly unrelated graph-based causality and Granger-Schreiber temporal causality, while clarifying their actual differences and limitations.</p></caption>
<graphic xlink:href="579177v1_figS5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Supplementary Fig. 6:</label>
<caption><title>Time series of cellular features extracted from the tumor ecosystems.</title>
<p>Example of time series of cellular features extracted by CausalXtract’s feature extraction module (CellHunter+) from the tumor ecosystems analyzed in this study, <xref rid="fig1" ref-type="fig">Fig. 1a</xref>. It includes two experimental control parameters (<italic>i</italic>.<italic>e</italic>. treatment and CAF presence) and 15 cellular features extracted every 2 minutes over a period of two days. Continuous features are highlighted for one trajectory (traj.18), while categorical features are shown for all trajectories.</p></caption>
<graphic xlink:href="579177v1_figS6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS7" position="float" fig-type="figure">
<label>Supplementary Fig. 7:</label>
<caption><title>Time-unfolded causal network inferred by CausalXtract.</title>
<p><bold>a</bold>, Time-unfolded causal network assuming stationary dynamics of cellular ecosystems implying translational time invariance of the inferred causal network. <bold>b</bold>, Only edges involving at least one contemporaneous variables (<italic>i</italic>.<italic>e</italic>. at time t) need to be tested for conditional independence by tMIIC and the remaining edges are then duplicated at all previous time steps before assigning orientations when time-lagged latent variables are taken into account, <xref rid="fig1" ref-type="fig">Fig. 1c</xref>. Variables retaining multiple self-loops with different time-delays correspond to non-stationary variables in <xref rid="figS6" ref-type="fig">Supplementary Fig. 6</xref>, in agreement with benchmarks from simulated data including non-stationary variables, <xref rid="figS3" ref-type="fig">Supplementary Fig. 3</xref>.</p></caption>
<graphic xlink:href="579177v1_figS7.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS8" position="float" fig-type="figure">
<label>Supplementary Fig. 8:</label>
<caption><title>Robustness of CausalXtract’s temporal causal networks to variations in sampling rate.</title>
<p>Summary causal networks inferred by CausalXtract using different sampling rates (<italic>δτ</italic>). <bold>a</bold>, <italic>δτ</italic> = 8 ts and <italic>τ</italic> = 80 ts, in time step units (1 ts = 2 min). <bold>b</bold>, <italic>δτ</italic> = 7 ts, and <italic>τ</italic> = 84 ts, as chosen automatically by CausalXtract based on the average relaxation time across the 15 monitored variables, <italic>τ</italic><sub><italic>R</italic></sub> = 40 ts, which defines a maximum lag <italic>τ</italic> = 2 <italic>τ</italic><sub><italic>R</italic></sub> = 80 ts. Given a total number of (time-lagged and -unlagged) nodes, chosen to be around 200 nodes for computational efficiency, it leads to 13 temporal layers (<italic>ν</italic> + 1 = 200<italic>/</italic>15 <italic>≃</italic> 13) and a lag increment <italic>δτ</italic> = <italic>τ/ν ≃</italic> 7 ts. This summary causal network corresponds to <xref rid="fig2" ref-type="fig">Fig. 2a</xref>. <bold>c</bold>, <italic>δτ</italic> = 5 ts and <italic>τ</italic> = 60 ts, corresponding to <italic>τ</italic> = <italic>ν · δτ</italic> with <italic>ν</italic> + 1 = 13 temporal layers, as in (b).</p></caption>
<graphic xlink:href="579177v1_figS8.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<table-wrap id="tblS1" orientation="portrait" position="float">
<label>Supplementary Table 1:</label>
<caption><title>15 nodes model.</title></caption>
<graphic xlink:href="579177v1_tblS1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<table-wrap id="tblS2" orientation="portrait" position="float">
<label>Supplementary Table 2:</label>
<caption><title>15 nodes model with combinations.</title></caption>
<graphic xlink:href="579177v1_tblS2.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95485.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Postovit</surname>
<given-names>Lynne-Marie</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Queens University</institution>
</institution-wrap>
<city>Kingston</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Fundamental</kwd>
</kwd-group>
</front-stub>
<body>
<p>In this <bold>fundamental</bold> study, the authors describe a new data processing pipeline that can be used to discover causal interactions from time-lapse imaging data. The utility of this pipeline was <bold>convincingly</bold> illustrated using tumor-on-chip ecosystem data. The newly developed pipeline could be used to better understand cell-cell interactions and could also be applied to perform temporal causal discovery in other areas of science, meaning this work could potentially have a wide range of applications.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95485.1.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This paper presents a data processing pipeline to discover causal interactions from time-lapse imaging data, and convicingly illustrates it on a challenging application for the analysis of tumor-on-chip ecosystem data.</p>
<p>The core of the discovery module is the original tMIIC method of the authors, which is shown in supplementary material to compare favourably to two state-of-the-art methods on synthetic temporal data on a 15 nodes network.</p>
<p>Strengths:</p>
<p>This paper tackles the problem of learning causal interactions from temporal data which is an open problem in presence of latent variables.</p>
<p>The core of the method tMIIC of the authors is nicely presented in connection to Granger-Schreiber causality and to the novel graphical conditions used to infer latent variables and based on a theorem about transfer entropy.</p>
<p>tMIIC compares favourably to PC and PCMCI+ methods using different kernels on synthetic datasets generated from a network of 15 nodes.</p>
<p>A full application to tumor-on-chip cellular ecosystems data including cancer cells, immune cells, cancer-associated fibroblasts, endothelial cells and anti cancer drugs, with convincing inference results with respect to both known and novel effects between those components and their contact.</p>
<p>The code and dataset are available online for the reproducibility of the results.</p>
<p>Weaknesses:</p>
<p>The references to &quot;state-of-the-art methods&quot; concerning the inference of causal networks should be more precise by giving citations in the main text, and better discussed in general terms, both in the first section and in the section of presentation of CausalXtract. It is only in the legend of the figures of the supplementary material that we get information.</p>
<p>Of course, comparison on our own synthetic datasets can always be criticized but this is rather due to the absence of common benchmark and I would recommend the authors to explicitly propose their datasets as benchmark to the community.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95485.1.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors propose a methodology to perform causal (temporal) discovery. The approach appears to be robust and is tested in the different scenarios: one related with live-cell imaging data, and another one using synthetic (mathematically defined) time series data. They compare the performance of their findings against another well-know method by using metrics like F-score, precision and recall,</p>
<p>Strengths:</p>
<p>Performance, robustness, the text is clear and concise, The authors provide the code to review.</p>
<p>Weaknesses:</p>
<p>One concern could be the applicability of the method in other areas like climate, economy. For those areas, public data are available and might be interesting to test how the method performs with this kind of data.</p>
</body>
</sub-article>
</article>