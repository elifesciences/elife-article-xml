<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">88794</article-id>
<article-id pub-id-type="doi">10.7554/eLife.88794</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.88794.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Barcode-free multiplex plasmid sequencing using Bayesian analysis and nanopore sequencing</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0197-8401</contrib-id>
<name>
<surname>Uematsu</surname>
<given-names>Masaaki</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2939-3138</contrib-id>
<name>
<surname>Baskin</surname>
<given-names>Jeremy M.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Weill Institute for Cell and Molecular Biology, Cornell University</institution>, Ithaca, NY, 14853, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>Department of Chemistry and Chemical Biology, Cornell University</institution>, Ithaca, NY 14853, <country>USA</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Zambrano</surname>
<given-names>María Mercedes</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>CorpoGen</institution>
</institution-wrap>
<city>Bogotá</city>
<country>Colombia</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Weigel</surname>
<given-names>Detlef</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Biology Tübingen</institution>
</institution-wrap>
<city>Tübingen</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>Correspondence: <email>mu84@cornell.edu</email>; <email>jeremy.baskin@cornell.edu</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-08-15">
<day>15</day>
<month>08</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP88794</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-05-07">
<day>07</day>
<month>05</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-04-21">
<day>21</day>
<month>04</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.04.12.536413"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Uematsu &amp; Baskin</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Uematsu &amp; Baskin</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-88794-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Plasmid construction is central to life science research, and sequence verification is arguably its costliest step. Long-read sequencing has emerged as a competitor to Sanger sequencing, with the principal benefit that whole plasmids can be sequenced in a single run. Nevertheless, the current cost of nanopore sequencing is still prohibitive for routine sequencing during plasmid construction. We develop a computational approach termed Simple Algorithm for Very Efficient Multiplexing of Oxford Nanopore Experiments for You (SAVEMONEY) that guides researchers to mix multiple plasmids and subsequently computationally de-mixes the resultant sequences. SAVEMONEY defines optimal mixtures in a pre-survey step, and following sequencing, executes a post-analysis workflow involving sequence classification, alignment, and consensus determination. By using Bayesian analysis with prior probability of expected plasmid construction error rate, high-confidence sequences can be obtained for each plasmid in the mixture. Plasmids differing by as little as two bases can be mixed for submission as a single sample for nanopore sequencing, and routine multiplexing of even six plasmids can still maintain high accuracy of consensus sequencing. SAVEMONEY should further democratize whole-plasmid sequencing by nanopore and related technologies, driving down the effective cost of whole-plasmid sequencing to lower than that of a single Sanger sequencing run.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Minor grammatical edits to the abstract and main text.</p></fn>
</fn-group>
<fn-group content-type="external-links">
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://colab.research.google.com/github/MasaakiU/MultiplexNanopore/blob/master/colab/MultiplexNanopore.ipynb">https://colab.research.google.com/github/MasaakiU/MultiplexNanopore/blob/master/colab/MultiplexNanopore.ipynb</ext-link>
</p></fn>
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://github.com/MasaakiU/MultiplexNanopore">https://github.com/MasaakiU/MultiplexNanopore</ext-link>
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Plasmid construction is a core technique in life science research. Conventionally, it is performed by ligation or assembly of DNA fragments typically generated by PCR amplification or solid-phase oligonucleotide synthesis into a linearized vector<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Because errors can be introduced at the PCR amplification, chemical synthesis, ligation, or assembly steps, the final products must be confirmed by a sequencing method. Classically, Sanger sequencing is used, and it involves synthesis of a complementary DNA strand in a polymerase-catalyzed reaction doped with chain-terminating, dideoxynucleotides bearing one of four different fluorescent dyes<sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c3">3</xref></sup>.</p>
<p>Stochastic chain termination produces a series of fluorescent products whose lengths and fluorescence properties are measured by capillary electrophoresis, allowing the base calling at each position. Sanger sequencing is highly accurate. The quality of its base calling is typically accessed by using the Phred score, <italic>Q</italic>, calculated using the following equation<sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c5">5</xref></sup>:
<disp-formula id="ueqn1">
<alternatives><graphic xlink:href="536413v2_ueqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>E</italic> represents the probability of the base calling error. Phred scores are used to characterize the quality of DNA sequences and filter out low-quality data to ensure the reliability of sequencing results.</p>
<p>Recently, long-read sequencing has emerged as an alternative method to Sanger sequencing for verifying plasmid sequences. Notable among these methods is nanopore sequencing, which uses nanometer-sized holes in polymer membranes<sup><xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c7">7</xref></sup>. When an electric current is applied across the pore, the passage of DNA molecules through the pore decreases the flux of ions to produce an electrical signal. These changes can be used to determine the sequence of the DNA molecule. Nanopore sequencing offers several advantages over other sequencing technologies, including the ability to sequence long reads, the ability to detect modifications to the DNA molecule, and the potential for real-time sequencing. Another advantage of nanopore sequencing is that it can reduce costs through barcode introduction during library preparation, enabling multiplexing<sup><xref ref-type="bibr" rid="c8">8</xref>–<xref ref-type="bibr" rid="c10">10</xref></sup>. Barcoding can be introduced into sheared DNA either by PCR or PCR-free methods such as blunt/TA ligation or barcoded transposase complexes. The barcoded libraries are pooled, and the DNA is delivered to the nanopores on the flow cell by attaching sequencing adaptors containing motor proteins.</p>
<p>A disadvantage of nanopore sequencing is its relatively high error rate, which arises because the signal is sensitive to factors including sample quality and the speed of DNA movement through the pore<sup><xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c12">12</xref></sup>. In addition, changes in current are elicited not by movement of single bases through the pore but rather five-nucleotide “words” known as <italic>k</italic>-mers<sup><xref ref-type="bibr" rid="c13">13</xref></sup>. Therefore, changes in current do not correspond directly with bases, making the base calling and error correction difficult. To compensate for its high error rate, consensus sequencing is typically employed, wherein multiple reads from different pores are aligned to generate a high-quality sequence.</p>
<p>In the Sanger sequencing era, and even still today with the advent of nanopore sequencing, it is common practice to not sequence entire plasmids but rather only the insert regions. This shortcut persists because insert regions are more prone to mutation than plasmid backbones due to the nature of their generation. Nevertheless, the probability of mutagenesis in the vector backbone is non-zero, and some plasmids can form dimers or multimers<sup><xref ref-type="bibr" rid="c14">14</xref></sup>. In addition, as plasmid construction efforts have become increasingly complex in recent years, nanopore sequencing is desirable when inserts are long or contain repetitive sequences. Thus, it is most rigorous to sequence entire plasmids, which is impractical using Sanger sequencing but feasible using nanopore sequencing, rather than simply sequencing inserts. However, in most cases Sanger sequencing is still chosen due to its lower cost. For example, Sanger sequencing currently costs ∼$4–5 (USD) per reaction, which produces ∼900–1000 bases of high-quality data, whereas nanopore sequencing currently costs ∼$15 (USD) per plasmid. Therefore, although nanopore is a powerful and cutting-edge technology, it has not yet advanced to the point of replacing Sanger sequencing.</p>
<p>Theoretically, mixing samples and submitting them in one tube would greatly reduce costs, but such mixing also reduces the quality of the analysis because of two reasons: (1) it is unknown from which sample each nanopore read is derived, and (2) the number of reads per sample will diminish. Typically, in large-scale sequencing such as whole genome sequencing performed by laboratories that own sequencers, barcoding is used to determine the origin of each read. In addition, each read is aligned against a reference sequence to increase the quality of the analysis. In contrast, in the context of plasmid construction, most users outsource sequencing to core facilities or companies. In this case, it is the third party that performs library preparation for nanopore sequencing; therefore, users typically cannot include barcodes. Finally, whereas reference sequences are not updated frequently in genome sequencing, a new reference plasmid sequence must be used for each analysis in plasmid construction, making it difficult to take advantage of existing platforms for pooling and multiplexing samples.</p>
<p>Here, we have developed a barcode-free, easy-to-use computational approach termed Simple Algorithm for Very Efficient Multiplexing of Oxford Nanopore Experiments for You (SAVEMONEY) that guides users to pool samples for nanopore sequencing and effectively reduces sequencing costs to below those of Sanger sequencing. Our approach involves submitting samples with multiple different plasmids mix in a single tube and deconvolving the obtained sequencing results while maintaining the quality of the analysis. Instead of using additional barcodes, SAVEMONEY leverages plasmid blueprints (maps), which are in most cases already made by researchers prior to plasmid construction. We found that reads from plasmids that differ by as little as two bases in their sequences can be accurately deconvolved without any additional barcoding. Further, we used Bayesian analysis to increase the quality of analysis from a lower number of reads per sample, adopting strategies commonly used in the analysis of single nucleotide polymorphisms (SNPs)<sup><xref ref-type="bibr" rid="c15">15</xref></sup>. To make our method widely available, we implemented SAVEMONEY on GoogleColab and have made code available on GitHub. Thus, SAVEMONEY is a straightforward and robust approach for experimental multiplexing and computational de-multiplexing of nanopore plasmid sequencing to accelerate democratization of this powerful technology.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Overview of the algorithm</title>
<p>In most cases of plasmid construction, the correct (i.e., expected) sequence is known because the process starts with making blueprint or map of the plasmid. In addition, typically only plasmids confirmed to have been largely constructed correctly by rapid and inexpensive restriction enzyme digestion or similar laboratory assays are submitted to sequencing analysis. These pieces of a priori information — “knowledge of correct, expected sequence of the plasmid” and “certainty that construction largely proceeded correctly” — can be used to classify the mixed sequence reads and to improve the quality of base calling. Therefore, it should be possible to attain comparable accuracy using a smaller number of reads than that provided in a typical commercial nanopore sequencing sample, enabling barcode-free multiplexing.</p>
<p>The outline of our procedure is as follows: (1) pre-survey, (2) sample submission, and (3) post-analysis (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). The pre-survey step determines the optimal combination of plasmids suitable for mixing prior to submitting to nanopore sequencing. If the sequences of two plasmids are similar, it becomes more difficult to classify reads from each plasmid a posteriori even with the presence of prior information. Therefore, these kinds of plasmids should be submitted in separate samples. For example, multiple colonies from the same plasmid construction effort cannot be submitted together, because they are expected to have the same sequence (i.e., they share an identical blueprint/map). Therefore, our pre-survey algorithm examines the blueprints of the plasmids and generates recommended groupings as outputs, so that similar ones do not fall into the same group.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1</label>
<caption><title>Workflow for Simple Algorithm for Very Efficient Multiplexing of Oxford Nanopore Experiments for You (SAVEMONEY).</title>
<p>The algorithm consists of three steps: pre-survey, sample submission, and post-analysis. The pre-survey step identifies the optimal combination of plasmids that will permit suitable accuracy for the classification step of the post-analysis. Plasmids with divergent sequences are grouped together, and those with very similar sequences are classified into different groups. After sample submission and sequencing, the post-analysis component, which consists of three different steps, is performed to deconvolve the obtained results. Reads (query sequences) are first classified based on its similarity to the plasmid blueprint/map (reference sequence). Reads are then aligned against reference sequences. Finally, consensus sequences and quality scores are calculated based on base calling, quality score from each read, and reference sequence, using Bayesian analysis.</p></caption>
<graphic xlink:href="536413v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>One key variable that our pre-survey does not explicitly determine is the maximum number of plasmids that may be safely grouped together. Because read quality, assessed by examining quality score distributions, is typically stable, the main variable affecting multiplexing ability is the overall coverage per plasmid. Having too many plasmids in one group will result in too few reads per plasmid and lower quality scores for the final consensus sequence, but this shortcoming can be compensated if the nanopore flow cell produces higher coverage. However, coverage varies from ∼100–1000 and is difficult to predict because each nanopore flow cell has different properties. Therefore, it is not possible to determine the maximum number of plasmids too few reads per plasmid and lower quality scores for the final consensus sequence, but this shortcoming can be compensated if the nanopore flow cell produces higher coverage. However, coverage varies from ∼100–1000 and is difficult to predict because each nanopore flow cell has different properties. Therefore, it is not possible to determine the maximum number of plasmids that can be mixed in the pre-survey process. Instead, we project that the theoretical minimum number of reads that is required for the reliable consensus calculation is 30 reads per plasmid (discussed in detail later in “Maximum number of plasmids that can be mixed” section). In practice, we typically obtain high-quality results by mixing up to six plasmids when submitting samples for sequencing at the Plasmidsaurus service certified by Oxford Nanopore Technologies, which currently typically provides ∼200 or more reads per sample.</p>
<p>Based on the grouping determined in the pre-survey step, the plasmids classified into the same group are then mixed at equal concentrations. If plasmid concentrations are not equal, the coverage of the plasmids with lower concentrations is lower, affecting the reliability of the results. Following mixing of plasmids according to the grouping, samples are submitted for nanopore sequencing according to specific vendor instructions.</p>
<p>After obtaining results from each nanopore sequencing run, deconvolution is then performed as a post-analysis to obtain consensus sequences for each plasmid. The post-analysis uses the following files as inputs: blueprints of the mixed plasmids (reference sequences) and an output FASTQ file of nanopore sequencing results containing base calling and quality scores of each read (query sequences). The algorithm is divided into three steps: (1) classification of reads, (2) alignment of the classified reads, and (3) calculation of the consensus sequence and quality score (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). In each step, reference sequences are used as prior information to increase accuracy and quality. The outputs of the post-analysis are FASTQ files containing consensus sequences and quality scores. Two types of FASTQ files are produced: FASTQ files that use arbitrarily set prior probability of error during the plasmid construction at the last step of the post-analysis and those that did not. Results without prior probability are calculated based on an unbiased analysis, whereas results with prior probability are statistically biased toward the blueprint of the plasmid map based on the prior probability (i.e., an arbitrarily set error rate during PCR, ligation, or assembly). The latter option can be considered as analogous to the case where the peak shape of a base within a Sanger sequencing chromatogram is not clear enough for the automatic base calling and is subsequently (and typically manually) compared to the blueprint of the plasmid to determine the identity of the base. Apart from two FASTQ files, a summary GIF file is also provided, showing the composition of reads matched, mismatched, or determined to be deletions or insertions at each position of the plasmid. Because post-analysis is designed assuming that there are no significant differences (insertions or deletions) between blueprints and the actual samples, it is recommended to always check this summary GIF file to confirm that if sample meets that assumption.</p>
<p>The pre-survey and the post-analysis algorithms are implemented with Python, and they are available via a ready-to-execute Jupyter Notebook on GoogleColab (<ext-link ext-link-type="uri" xlink:href="https://colab.research.google.com/github/MasaakiU/MultiplexNanopore/blob/master/colab/MultiplexNanopore.ipynb">https://colab.research.google.com/github/MasaakiU/MultiplexNanopore/blob/master/colab/MultiplexNanopore.ipynb</ext-link>) or locally executable scripts on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/MasaakiU/MultiplexNanopore">https://github.com/MasaakiU/MultiplexNanopore</ext-link>). In the GoogleColab version, a function is also included to visualize the classified query sequence along with the reference sequence and the consensus sequence.</p>
</sec>
<sec id="s2b">
<title>The pre-survey algorithm</title>
<p>The pre-survey algorithm determines the combination of plasmids that are appropriate to mix. Its initial step is a series of pairwise alignments of each plasmid, wherein one plasmid is arbitrarily regarded as “reference” and the other as “query”. Although in principle any alignment algorithm can be used, we chose to use the classical Smith–Waterman algorithm to ensure the accuracy by dynamic programming<sup><xref ref-type="bibr" rid="c16">16</xref></sup>. The following parameters were used:
<disp-formula id="ueqn2">
<alternatives><graphic xlink:href="536413v2_ueqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Next, the distance between each plasmid pair <italic>p</italic><sub><italic>i</italic></sub>, <italic>p</italic><sub><italic>j</italic></sub> was calculated based on the obtained alignment. Assuming <italic>p</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>j</italic></sub> are reference and query, respectively, the distance <inline-formula><alternatives><inline-graphic xlink:href="536413v2_inline1.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> was calculated as follows:
<disp-formula id="ueqn3">
<alternatives><graphic xlink:href="536413v2_ueqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where len(<italic>p</italic><sub><italic>i</italic></sub>) indicates the length of the plasmid <italic>p</italic><sub><italic>i</italic></sub>, and match<italic>(p</italic><sub><italic>i</italic></sub>, <italic>p</italic><sub><italic>j</italic></sub><italic>)</italic> and del<italic>(p</italic><sub><italic>i</italic></sub>, <italic>p</italic><sub><italic>j</italic></sub><italic>)</italic> represent the number of matched and deleted bases after the alignment of the plasmid pair, respectively. The intermediate value <inline-formula><alternatives><inline-graphic xlink:href="536413v2_inline2.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> indicates the number of bases that have to be replaced, deleted, or inserted against the query to obtain the same sequence as the reference. Using this framework, the alignment of a plasmid to itself will yield a distance of 0. Calculation of the distances between all plasmid pairs afforded a distance matrix of plasmids.</p>
<p>Plasmids with smaller distances were classified into the same cluster, which we note is different from the final output of the grouping. Hierarchical clustering was adopted using the distance matrix obtained in the previous step (<xref rid="fig2" ref-type="fig">Fig. 2</xref>). Clusters were defined according to a user-defined parameter, <italic>threshold</italic> (<italic>pre</italic>), which represents the minimum number of bases that has to be differ between plasmids in the same group. In practice, lower <italic>threshold</italic> (<italic>pre</italic>) values result in allowing plasmids that are more similar to one another to be classified into different clusters, producing fewer total groups of plasmids for sample submission and thus lowering sequencing costs at the expense of a higher risk of errors during the classification step of the post-analysis algorithm.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig. 2</label>
<caption><title>Examples of the pre-survey outputs.</title>
<p>Sequences of 14 different plasmids were analyzed with <italic>threshold</italic> (<italic>pre</italic>) values of either 6 (a), 10 (b) or 20 (c). The number of bases that differ between each plasmid pair is displayed in heatmaps. These scores were used to generate the distance matrix and subsequently to generate the dendrograms displayed on the right side of the heatmap. The dotted red lines in the dendrogram represent the <italic>threshold</italic> (<italic>pre</italic>) values, enabling visualization of the results of clustering, i.e., plasmids with distances less than the red lines were classified in the same cluster. Based on this clustering results of similar plasmids, plasmids were classified into groups for sequencing submission, with groups are displayed in red and blue (a), red, blue, and magenta (b), or red, blue, magenta, and cyan (c). The numbers of bases that differ between each plasmid are also emphasized by the colored frames within each group, and plasmids classified into the same cluster are grouped in different groups. Note that P1–P14 here are different from example plasmids used in <xref ref-type="fig" rid="fig3">Fig. 3</xref> and <xref ref-type="fig" rid="fig4">Fig. 4</xref>.</p></caption>
<graphic xlink:href="536413v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Finally, plasmids were classified into groups for sample submission such that plasmids from the same cluster do not fall into the same group. First, all plasmids in the cluster with the highest number of elements were classified into separate groups. This separation is the basis of the final grouping. We represented the set of groups after the distribution of the first cluster as <italic>G</italic><sub>1</sub>. In this case, |<italic>X</italic>| = 1 holds true for all <italic>X</italic> ∈ <italic>G</italic><sub>1</sub>, where |<italic>X</italic>| represents the number of elements (plasmids in this case) in a set <italic>X</italic> (one of the groups in this case). The plasmids in the cluster with the second highest number of elements were next distributed to the existing groups, using a score <italic>S</italic><sub><italic>X</italic></sub> for group <italic>X</italic> that was defined when |<italic>X</italic>| &gt; 1 as follows:
<disp-formula id="ueqn4">
<alternatives><graphic xlink:href="536413v2_ueqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
The set of groups after distributing the plasmids in the second cluster, <italic>G</italic><sub><italic>2</italic></sub>, was determined as follows:
<disp-formula id="ueqn5">
<alternatives><graphic xlink:href="536413v2_ueqn5.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Plasmids in the third and subsequent clusters are distributed in the same manner to obtain the final grouping result. In practice, there are typically many suitable solutions to the grouping problem. Though this algorithm does not guarantee the optimal grouping; its output guarantees groupings that are appropriate for mixing, and in practice it is highly reliable (see below).</p>
<p>Examples of the pre-survey results against 14 plasmids are displayed in <xref rid="fig2" ref-type="fig">Fig. 2</xref>, together with the dendrogram used during the step of hierarchical clustering. When <italic>threshold</italic> (<italic>pre</italic>) values of 6, 10, and 20 were applied, plasmids were classified into groups of two, three, and four, respectively, and the minimum distance within a group was also 6, 10, and 20. These results show that lower <italic>threshold</italic> (<italic>pre</italic>) values reduce the total number of groups, leading to reduced sequencing costs. Conversely, the results also imply that plasmids with higher degrees of similarity will be incorporated into the same group, which will reduce the reliability of the post-analysis. However, we found that <italic>threshold</italic> (<italic>pre</italic>) values can be set down to 2 based on the post-analysis of sequencing data, which will be discussed later (see “Maximum similarity allowed for mixing” section for details).</p>
</sec>
<sec id="s2c">
<title>The post-analysis algorithm</title>
<p>To classify reads from each pore, the alignment was first performed against reference plasmid <italic>p</italic><sub><italic>i</italic></sub> and the query sequence <italic>q</italic><sub><italic>k</italic></sub> from each pore using the same parameters as described in the pre-survey algorithm. Then, the normalized alignment score, <inline-formula><alternatives><inline-graphic xlink:href="536413v2_inline3.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, was calculated by dividing the alignment score by the length of <italic>p</italic><sub><italic>i</italic></sub>. The plasmid to which the query is assigned, <inline-formula><alternatives><inline-graphic xlink:href="536413v2_inline4.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, was determined as follows:
<disp-formula id="ueqn6">
<alternatives><graphic xlink:href="536413v2_ueqn6.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>P</italic> indicates the set of reference plasmids that were mixed. However, if <inline-formula><alternatives><inline-graphic xlink:href="536413v2_inline5.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> was lower than <italic>threshold</italic> (<italic>post</italic>), a user-defined value that represents a cutoff for short reads (see below), the read <italic>q</italic><sub><italic>k</italic></sub> was excluded to increase the quality of subsequent post-analysis. Furthermore, the read <italic>q</italic><sub><italic>k</italic></sub> showing the same normalized alignment score against more than one plasmid was also omitted, because such read does not contain enough information to determine the plasmid from which they originated. Lastly, the read <italic>q</italic><sub><italic>k</italic></sub> more than two times longer than the length of the assigned reference plasmid <inline-formula><alternatives><inline-graphic xlink:href="536413v2_inline6.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, and that showed higher normalized alignment score than 1 was excluded to omit the read from plasmid multimer.</p>
<p>Four examples of the results from four different groups of plasmids are displayed in <xref rid="fig3" ref-type="fig">Fig. 3</xref> (Group I) and <xref rid="fig4" ref-type="fig">Fig. 4</xref> (Groups II, III, and IV). Group I involves multiplex sequencing of six plasmids of only modest similarity, and Groups II–IV contain two plasmids each with high similarity. (Note that for <xref rid="fig2" ref-type="fig">Figs. 2</xref>–<xref ref-type="fig" rid="fig4">4</xref>, we have elected to name the plasmids similarly (e.g., P1, P2, etc.) for simplicity; however, they are all distinct, i.e., P1 from <xref rid="fig2" ref-type="fig">Fig. 2</xref> is different from P1 in <xref rid="fig3" ref-type="fig">Fig. 3</xref>.) The pre-survey results for Group I are shown in <xref rid="fig3" ref-type="fig">Fig. 3a</xref>, indicating two clusters of four (P1– P4) and two (P5–P6) similar plasmids. In reality, each cluster contains plasmids that share a common vector, illustrating how plasmids sharing common vector backbones but different inserts are moderately similar but still suitable for multiplexing, as their distances are far greater than 20, which is a very safe, quality-oriented cutoff value shown in <xref rid="fig2" ref-type="fig">Fig. 2c</xref>. These six plasmids were mixed and analyzed as a single sample by nanopore sequencing. <xref rid="fig3" ref-type="fig">Fig. 3b</xref> represents the general quality check of the results for each plasmid: distributions of read length and quality scores.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Fig. 3</label>
<caption><title>Example results after the classification step for a set of six moderately related plasmids.</title>
<p><bold>(a)</bold> Results of the pre-survey against plasmid sets used in (b–c). <bold>(b)</bold> Read length and the quality score distributions. <bold>(c)</bold> Scatter plots of normalized alignment scores. Normalized alignment scores were calculated for each read over all reference plasmids and displayed as scatter plots. Density plots of the normalized alignment scores are also displayed for each reference plasmid in the diagonal panel, which is the projection of each scatter plots against horizontal axes. The y-axis ranges of these diagonal panels are shared. The vertical and the horizontal positions of dashed lines correspond to <italic>threshold</italic> (<italic>post</italic>) values. These data depict results of classification performed with a <italic>threshold</italic> (<italic>post</italic>) value of 0.5. Note that P1–P6 here are different from example plasmids used in <xref ref-type="fig" rid="fig2">Fig. 2</xref> and <xref ref-type="fig" rid="fig4">Fig. 4</xref>.</p></caption>
<graphic xlink:href="536413v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig4" position="float" fig-type="figure">
<label>Fig. 4</label>
<caption><title>Example results after the classification step for closely related plasmids. (a, e, i)</title>
<p>Results of the pre-survey against plasmid sets used in (b–d, f–h, j–l). <bold>(b, f, j)</bold> Scatter plots of normalized alignment scores against the plasmid pairs. Density plots of the normalized alignment scores against P1, P3, and P5 are also displayed on the upper panel, which is the projection of each scatter plots against horizontal axes. The vertical and the horizontal positions of dashed lines correspond to <italic>threshold</italic> (<italic>post</italic>) values. These data depict results of classification performed with a <italic>threshold</italic> (<italic>post</italic>) value of 0.5. <bold>(c, g, k)</bold> Magnified view of the bottom panels in (b, f, j). <bold>(d, h, l)</bold> Histogram displaying distribution of reads based on the distance from y=x lines in the bottom panels in (b, f, j). Note that P1–P6 here are different from example plasmids used in <xref ref-type="fig" rid="fig2">Fig. 2</xref> and <xref ref-type="fig" rid="fig3">Fig. 3</xref>.</p></caption>
<graphic xlink:href="536413v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Reads assigned to each reference plasmid showed sharp read length distributions, indicating the accurate classification of the reads. In addition, the quality score distributions of reads assigned to each reference plasmid are very similar, indicating that each plasmid was sequenced with almost the same quality. Note, however, that the number of reads was not identical for each plasmid, which is reflected by the total histogram area of each colored portion in the read length distribution graphs. Scatter plots of normalized alignment score, <inline-formula><alternatives><inline-graphic xlink:href="536413v2_inline7.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, for each reference plasmid pair are shown in <xref rid="fig3" ref-type="fig">Fig. 3c</xref>, which is useful to adjusted <italic>threshold</italic> (<italic>post</italic>). From the graphs, it is apparent that if <italic>threshold</italic> (<italic>post</italic>) is set higher, the classification accuracy would increase, at the expense of lowering the number of reads assigned to each reference plasmid. For typical experiments, we have found 0.5 to be a reasonable value for <italic>threshold</italic> (<italic>post</italic>), but users can fine tune this parameter to make the most out of the acquired data. For example, if the total number of reads was small but each plasmid was sufficiently different, the threshold can be lowered to increase the number of reads that are passed on to the next step of analysis. Conversely, if the total number of reads is large and the plasmids are highly similar with each other, the quality of subsequent analysis can be improved by raising the threshold. <xref rid="fig3" ref-type="fig">Fig. 3c</xref> shows the well separated scatter plots of each read against each reference plasmid, indicating successful classification of reads. In this experiment, a sufficient number of reads (90, 154, 57, 165, 73, 107, and 50 each for P1, P2, P3, P4, P5, P6, and unassigned, respectively) were obtained for each plasmid, which ensures reliability in the subsequent calculation of the consensus sequence. Note that unassigned gray dots that appear at the top-right corner of some panels represent reads from plasmid dimers or multimers.</p>
<p>The results of different combinations of plasmids with high sequence similarity are displayed in <xref rid="fig4" ref-type="fig">Fig. 4</xref>. First, we mixed and submitted as a single sample two plasmids (P1 and P2) with a distance of only 1, i.e., plasmids with only a single base difference between them (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>). The corresponding results after the classification step of the post-analysis are displayed in <xref rid="fig4" ref-type="fig">Fig. 4b</xref>. Because the plasmids are almost identical, most of the data points are nearly overlapping the y=x line in the scatter plot of the normalized alignment score (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>, bottom), showing almost indistinguishable peak top in the density plot of normalized alignment score against P1 (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>, top). However, a magnified view clearly shows the deviation of data points from y=x line, indicating that reliable separation of many reads can be achieved. A histogram illustrating reads based on their distance from the y=x line shows this separation more clearly (<xref rid="fig4" ref-type="fig">Fig. 4d</xref>). The histogram also shows reads that exceed the <italic>threshold</italic> (<italic>post</italic>) value but were not assigned to either because the normalized alignment scores for P1 or P2 were the same (dark gray bar in <xref rid="fig4" ref-type="fig">Fig. 4d</xref>). The number of such reads was 21, which is relatively small compared to the reads assigned to P1 (blue bar in <xref rid="fig4" ref-type="fig">Fig. 4d</xref>) or P2 (orange bar in <xref rid="fig4" ref-type="fig">Fig. 4d</xref>). These results indicate that a low percentage of reads that were originally derived from P1 but were incorrectly classified to P2, and vice versa. More specifically, these values can be estimated by solving the following simultaneous equations:
<disp-formula id="ueqn7">
<alternatives><graphic xlink:href="536413v2_ueqn7.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xlink:href="536413v2_inline8.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="536413v2_inline9.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> represents the number of reads that originally derived from P<sub>1</sub> and P<sub>2</sub>, respectively, and <italic>E</italic> represents the probability of nanopore making an incorrect base calling event. For simplicity, we approximate that the probability of a nanopore-based base-calling error is the same independent of the identity of the base (e.g., when errors occur for true base A, the probability of base calling being T, G, or C is one over 3 for each) and that there are no deletion or insertion errors in base calling. As a result, the number of reads classified under a reference plasmid that differs from their actual origin were calculated as follows:
<disp-formula id="ueqn8">
<alternatives><graphic xlink:href="536413v2_ueqn8.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
These results indicate that reads with incorrect classification were about 2.1% and 10.1% of those assigned to P1 and P2, respectively; however, if insertions and deletions are considered, the value would be much lower. Similar calculations were performed for plasmid pairs differing by two bases (<xref rid="fig4" ref-type="fig">Fig. 4e–h</xref>) and by three bases (<xref rid="fig4" ref-type="fig">Fig. 4i–l</xref>), showing that 0.28%, 0.22%, 1.19%, and 1.33% of reads assigned to P3, P4, P5, and P6, were estimated to be incorrectly derived from P4, P3, P6, and P5, respectively. Of note, the probability of incorrect base calling event <italic>E</italic> was calculated as approximately 12.9%, 6.6%, and 17.5% for plasmid pairs differing by one, two, and three bases, respectively. These results indicate that the nanopore base calling error negligibly affects the classification step, especially for plasmid pairs differing by more than two bases, transforming the base calling error ratio of 6.6% (for two base differing pair), and 17.5% (for three base differing pair) into the incorrect classification ratio of 0.22%–0.28%, and 1.19– 1.33%, respectively.</p>
<p>Based on these results, plasmids that differ even by a single base could be classified to a sufficient confidence level that subsequent analysis to obtain consensus base calling would not be affected. However, we recommend mixing plasmids that differ by at least two bases, i.e., the <italic>threshold</italic> (<italic>pre</italic>) value should be at least 2, due to the following reasons. First, although this low percentage of incorrect assignment is unlikely to affect the consensus base calling even with plasmids with 1 base difference, it does affect the consensus quality score, and our algorithm does not make any correction for it. Second, although the average error rate of current nanopore technology is low, it can be increased to up to ∼40% for a few specific sequences, and this number could result in incorrect consensus base calling. Third, if only one base differs, that base is the only piece of information that can correctly classify reads, indicating that an unexpected mutation in that position during the plasmid construction would ruin the classification. Therefore, we set the minimum <italic>threshold</italic> (<italic>pre</italic>) value to 2 in the pre-survey, and we recommend setting it a higher score when possible.</p>
<p>After the classification step, each read is aligned against the corresponding reference sequence, and then a final post-analysis step is executed to obtain the consensus sequence and quality score. Here, the aligned query sequences, quality score of each read, and prior information are combined using Bayesian analysis, similar to previously reported methods to detect SNPs<sup><xref ref-type="bibr" rid="c15">15</xref></sup>. When generating consensus sequences in SAVEMONEY, two types of prior information are used: (1) the error rate during plasmid construction (i.e., an arbitrarily set error rate during PCR, ligation, or assembly), and (2) the characteristics of the nanopore reads, i.e., error rate and distribution of quality score for each base. For example, assume that the correct base at a specific position in the blueprint of the plasmid is A, and that 10 reads were obtained for the corresponding part, of which base-calling of eight reads were A and the other two reads were G. In this case, the following cases can be considered:</p>
<list list-type="order">
<list-item><p>True base is A, and error happened for 2 reads returning G.</p></list-item>
<list-item><p>True base is T, and error happened for all 10 reads.</p></list-item>
<list-item><p>True base is C, and error happened for all 10 reads.</p></list-item>
<list-item><p>True base is G, and error happened for 8 reads returning A.</p></list-item>
</list>
<p>By using prior information, each of the above probabilities can be calculated. It is reasonable to adopt the case with the highest probability among them and use it as the consensus base calling. Note that the possibility of deletion and insertion is not considered in the above example to make the example simple, but they are implemented in the actual script.</p>
<p>Although quality scores of each read from Oxford Nanopore Technologies do not exactly follow Phred scores, they are approaching Phred scores in recent years<sup><xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c17">17</xref></sup>. Therefore, for practical purposes, we elected to consider the quality scores as Phred scores, while accepting some small error in the calculation of consensus quality score to some extent. Based on this assumption, the error rate, <italic>E</italic><sub><italic>basecall</italic>=<italic>B</italic></sub>, when the consensus base calling is <italic>B</italic> at a specific location, can be calculated as follows using Bayes’ theorem:
<disp-formula id="ueqn9">
<alternatives><graphic xlink:href="536413v2_ueqn9.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>P</italic> (<italic>B</italic>) represents the probability that the true base is <italic>B</italic> at the specific location of the plasmid, and <italic>D</italic><sub><italic>k</italic></sub> represents the data obtained from pore <italic>k</italic>. The prior probability <italic>P</italic> (<italic>B</italic>) can be arbitrarily set from the error ratio during plasmid construction, which corresponds to the first piece of prior information. Here, the likelihood <italic>P</italic> (<italic>D</italic><sub>1</sub>, <italic>D</italic><sub>2</sub>, … |<italic>B</italic>) and the probability of obtaining the data <italic>P</italic> (<italic>D</italic><sub>1</sub>, <italic>D</italic><sub>2</sub>, …) can be calculated as follows:
<disp-formula id="ueqn10">
<alternatives><graphic xlink:href="536413v2_ueqn10.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
This conversion is guaranteed under the condition that the data obtained by each pore is independent if the true base is known. Further, the likelihood <italic>P</italic> (<italic>D</italic><sub><italic>k</italic></sub>|<italic>B</italic>) can be converted as follows:
<disp-formula id="ueqn11">
<alternatives><graphic xlink:href="536413v2_ueqn11.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>b</italic><sub><italic>k</italic></sub> and <italic>Q</italic><sub><italic>k</italic></sub> represents the base calling and the quality score obtained from pore <italic>k</italic>. Here, <italic>P</italic> (<italic>Q</italic><sub><italic>k</italic></sub>|<italic>b</italic><sub><italic>k</italic></sub>, <italic>B</italic>) and <italic>P</italic> (<italic>b</italic><sub><italic>k</italic></sub> |<italic>B</italic>) can be calculated based on the quality score distribution and the error ratio of the nanopore sequencing, respectively, which corresponds to a second piece of prior information. These characteristics can be obtained from nanopore sequencing data of plasmids with known sequences, or, in practice, with unknown sequences by considering the consensus sequence as a known sequence. Although these characteristics change depending on the types of flow cell and library preparation chemistry, in this paper we proceed based on the characteristics of R10.4.1 flow cells with V14 library preparation chemistry by Oxford Nanopore Technologies that are currently used for sequencing via the Plasmidsaurus service, but the principle should be the same with other long-read sequencers. The representative quality score distribution and the error ratio we obtained by analyzing one plasmid by nanopore sequencing is displayed in <xref rid="fig5" ref-type="fig">Fig. 5</xref>. Thus, the final consensus base calling, <italic>B</italic><sub><italic>consensus</italic></sub>, and the consensus Phred score, <italic>Q</italic><sub><italic>consensus</italic></sub>, can be calculated as follows:</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Fig. 5</label>
<caption><title>Characteristics of base calling used for prior information.</title>
<p><bold>(a)</bold> Grid showing error ratios for each base calling event. Based on the results obtained from samples analyzed by R10.4.1 flow cells with V14 library preparation chemistry by Oxford Nanopore Technologies via the Plasmidsaurus service, the frequency was analyzed for base calling of each pore (column labels) and the results of the consensus sequence (row labels) at each position. In the context of base-calling, “–” represents bases that were base-called in the consensus sequence but skipped in the reads from each pore. In the context of consensus sequencing, “–” represents bases that do not appear in the consensus sequence but were base-called from pores. Color of the diagonal panels is saturated because of the contrast range focusing on subtle differences of the non-diagonal panels. Of note, the sum of the rows is 1, but the sum of the displayed numbers may be slightly different from 1 because the fourth decimal place is rounded in the grid. <bold>(b)</bold> Quality score distributions for each base calling event. The base calling of each pore (column labels) and the results of the consensus sequence (row labels) at each position were classified, and probability density plots and quality scores were calculated and displayed. The y-axis is shared by all panels and is scaled to focus on panels in which the true base and base calling are not the same (incorrect base calling, blue). Therefore, the density of maximum quality score is out of the range of the display area in the diagonal panels (correct base calling, orange), and full-size plots are provided at right. Note that there are no density plots when base calling was skipped in the reads from each pore (column corresponding to the label “–” in (a)).</p></caption>
<graphic xlink:href="536413v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>
<disp-formula id="ueqn12">
<alternatives><graphic xlink:href="536413v2_ueqn12.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
</p>
</sec>
<sec id="s2d">
<title>Maximum similarity allowed for mixing</title>
<p>The extent to which similar plasmids can be mixed (i.e., how low the <italic>threshold</italic> (<italic>pre</italic>) value can be in the pre-survey step) is greatly affected by the resolution of the “classification” in the post-analysis. In this step, the use of prior information is important. Assuming that two plasmids, <italic>p</italic><sub>1</sub>and <italic>p</italic><sub>2</sub>, with different sequences, are mixed and analyzed by nanopore sequencing. If the data from one read from one pore returns a sequence similar to <italic>p</italic><sup><xref ref-type="bibr" rid="c1">1</xref></sup>, the following two cases are possible:</p>
<list list-type="order">
<list-item><p>The DNA that passed through the pore was derived from <italic>p</italic><sup>1</sup> and returned a sequence similar to <italic>p</italic><sup>1</sup>.</p></list-item>
<list-item><p>The DNA that passed through the pore was derived from plasmid <italic>p</italic><sub>2</sub>, but the pore was inaccurate and base calling error occurred frequently. By chance, it returned a sequence that is similar to <italic>p</italic><sup>1</sup>.</p></list-item>
</list>
<p>Intuitively, case 1 is the correct answer, but a more precise expression is that the probability of case 2 is extremely low if plasmid <italic>p</italic><sup><xref ref-type="bibr" rid="c1">1</xref></sup> and <italic>p</italic><sub>2</sub> or more plasmids are “sufficiently different”, so it is safe to consider only the possibility of case 1 in practice. This example implies that the prior information of known plasmid sequences in samples improves the accuracy of the classification of the reads from each pore. It is difficult to perform such a classification process with versatility and high accuracy in the absence of prior information.</p>
<p>To specifically determine what kinds of plasmid pairs are “sufficiently different”, detailed analysis was performed. First, the percentage of reads with correct base calling was calculated for each position of plasmids and the distribution was obtained (<xref rid="fig6" ref-type="fig">Fig. 6a</xref>). More than 98% of positions exhibited a correct base calling rate over 0.9, but a small number (0.1%) of them showed low correct rates below 0.7. Averaged quality score distribution of high (&gt;0.9) and low (&lt;0.7) correct rate are displayed in <xref rid="fig6" ref-type="fig">Fig. 6b</xref>. In the former case, most reads showed the maximum quality score, whereas in the latter case, the percentage is lower. The rate of correct base calling, incorrect base calling, and base calling of deletion was 67.1%, 19.0%, and 13.9%, respectively. <xref rid="fig6" ref-type="fig">Fig. 6c</xref> shows the bases that were enriched around 5-mers of positions that showed correct rates lower than 0.7 in the “worst-case scenario” indicated in <xref rid="fig6" ref-type="fig">Fig. 6a</xref>. Using this “worst-case scenario”, the probability of incorrect classification when data from one read is classified to <italic>p</italic><sup><xref ref-type="bibr" rid="c1">1</xref></sup>was calculated as follows:</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Fig. 6</label>
<caption><title>Analysis for the maximum similarity between plasmids that can be mixed and the minimum number of required reads.</title>
<p><bold>(a)</bold> Density plot of the rate of reads with correct base calling. The rate was calculated at each position of plasmids and displayed using representative nanopore sequencing results. <bold>(b)</bold> Averaged quality score distribution of reads with correct rate of less than 0.7 (upper panel) and more than 0.9 (bottom panel). The corresponding regions are displayed with dashed red frames in (a). Of note, “omitted” represents reads that did not cover the focused position. <bold>(c)</bold> Probability logo plot. Statistical significance (−log<sub>10</sub>[P value]) was calculated for a 5-mer around the positions that showed correct rate lower than 0.7 in (a) using those that showed more than 0.9 as a background. Enriched residues are stacked on the top, whereas depleted residues are stacked on the bottom. <bold>(d)</bold> Estimated probability of incorrect classification. Based on the match/mismatch/deletion ratio of reads obtained in the “worst-case scenario”, i.e., top panel in (b), the probability of incorrect classification of read was calculated assuming that two plasmids that differ by indicated base(s) were mixed. <bold>(e)</bold> Estimated probability of correct/incorrect consensus base calling. Based on the quality score distribution obtained in the “worst-case scenario”, i.e., top panel in (b), the indicated number of reads were generated in silico, and the consensus base calling was calculated using SAVEMONEY. The simulation was performed 10,000 times for each condition to calculate the probability of correct/incorrect consensus base calling.</p></caption>
<graphic xlink:href="536413v2_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>
<disp-formula id="ueqn13">
<alternatives><graphic xlink:href="536413v2_ueqn13.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>P</italic> (<italic>D</italic> = <italic>p</italic><sup><xref ref-type="bibr" rid="c1">1</xref></sup>) represents the probability that one read was classified as <italic>p</italic><sup><xref ref-type="bibr" rid="c1">1</xref></sup>, i.e., normalized alignment score of the read was higher for <italic>p</italic><sup><xref ref-type="bibr" rid="c1">1</xref></sup> than <italic>p</italic><sub>2</sub>. The denominator <italic>P</italic> (<italic>D</italic> = <italic>p</italic><sup><xref ref-type="bibr" rid="c1">1</xref></sup>) can be transformed as follows:
<disp-formula id="ueqn14">
<alternatives><graphic xlink:href="536413v2_ueqn14.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Therefore, the plot of <italic>P</italic> (<italic>p</italic><sub>2</sub> | <italic>D</italic> = <italic>p</italic><sub>1</sub>) can be calculated and the results are displayed in <xref rid="fig6" ref-type="fig">Fig. 6d</xref>, which varies the number of bases that are different between the plasmids.</p>
<p>When <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> differ by only one base, the percentage of incorrect classification was estimated to be 39% in this rarely occurring (0.1% frequency) “worst-case scenario”. When the sequence differs by two bases, this percentage drops to 22%. This value is sufficiently smaller than 50% and can be considered to have no effect on the consensus sequence. Also, this percentage is calculated assuming that the two bases are both the “worst-case scenario”, i.e., the 0.1% case shown in <xref rid="fig6" ref-type="fig">Fig. 6a</xref>. That means the chance of this happening for two bases that differ in <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> is 10<sup>−6</sup>, which we consider to be small enough to not be a cause for concern. Thus, in most cases, the percentage of incorrect classification will be much lower even if there are only two base differences between <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub>. In fact, the percentage of misclassified plasmids was estimated as less than 0.3% at the highest for two nucleotide difference from experimental data in <xref rid="fig4" ref-type="fig">Fig. 4e–h</xref>. Therefore, we ascertain that a <italic>threshold</italic> (<italic>pre</italic>) value of 2 or more during the pre-survey is sufficient for reliable post-analysis.</p>
</sec>
<sec id="s2e">
<title>Maximum number of plasmids that can be mixed</title>
<p>The question of how many plasmids can be safely mixed together can be partially replaced by the question of how many reads are required at minimum to obtain a reliable consensus sequence. To answer this question, detailed analysis was performed again using the “worst-case scenario”. We simulated nanopore base calling according to quality score distribution when the correct rate was less than 0.7 (<xref rid="fig6" ref-type="fig">Fig. 6b</xref>, top panel). For a simulation with 20 reads, as an example, 20 sets of quality scores and read types (match, mismatch, deletion, omitted) were generated according to the distribution, and the consensus base calling and quality scores were calculated using SAVEMONEY. Sampling of 10000 events were performed in each condition over 1 to 40 reads to calculate the probability of correct/incorrect consensus base calling (<xref rid="fig6" ref-type="fig">Fig. 6e</xref>). The consensus was calculated in three ways: (1) without prior probability for the unbiased base calling (blue), (2) with prior probability to incorporate an arbitrarily set plasmid construction error rate (orange), and (3) with wrong prior probability for testing error detection (green). The first two conditions correspond to the two outputs from SAVEMONEY, and the last condition indicates the sensitivity of “with prior probability” analysis to detect errors when the reference sequence differs from the actual plasmid.</p>
<p>The results show that ratio of incorrect base calling decreases exponentially (i.e., linearly on the logarithmic plot), and all three lines reach an error rate of less than 0.01 after more than 30 reads. This analysis shows that, even in the “worst-case scenario”, which occurs with a frequency of ∼0.1% (<xref rid="fig6" ref-type="fig">Fig. 6a</xref>), the probability of incorrect base calling is less than 0.1%, indicating that the net probability is ∼10<sup>−6</sup>. This value is small enough to be negligible even considering the size of usual plasmids (on the order of 10<sup>4</sup> bases). Therefore, when samples are submitted to a nanopore sequencing service such as Plasmidsaurus, which typically provides a minimum number of ∼200 reads per sample, we have found that mixing of up to six plasmids is routinely possible. These conditions bring down the current sequencing cost per plasmid for users to lower than a single Sanger sequencing run. Further savings and efficiency come from the costs associated with multiple Sanger sequencing runs for inserts longer than 1 kb and reanalysis of occasional failed Sanger sequencing runs. For operators of long-read sequencing, such analysis may enable conservation of expensive reagents. Overall, we expect that the principles underlying our computational approach will accelerate widespread adoption of whole-plasmid sequencing.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>In this study, we developed a versatile pipeline that allows end users to easily prepare optimal pooling of plasmids and perform computational de-multiplexing of long-read sequencing results of multiplexed samples. During plasmid construction, a restriction enzyme digestion test can typically be used to confirm that the plasmid construction was largely successful, but such verification by test digestion is not 100% accurate, necessitating sequencing for ultimate verification of the plasmid sequence. Using Sanger sequencing, Phred scores drop as the read lengths approach ∼1000 bases, and accurate base calling becomes difficult without any information. However, in many cases, higher confidence can be obtained by comparing raw data of peak patterns with the sequences in the plasmid blueprint/map. In other words, the use of prior probability (i.e., the low error rate during the plasmid construction in this case) can improve the posterior probability of correct base calling. Thus, high-quality sequencing data is not actually needed for the first ∼700 bases, but researchers have had no choice but to obtain data with higher purity than necessary, because Sanger sequencing cannot balance data quality and cost (or read length). However, with nanopore sequencing, it is possible to accept a lower quality of data by reducing the number of reads per sample, with the benefit of lower cost. Here we reduce this idea to practice, showing that the use of prior probability can prevent the quality of sequencing from falling too low, ensuring both low cost and high confidence of sequencing results. Using our approach, sufficient multiplexing is possible that the cost of whole-plasmid sequencing can drop to below that of a single Sanger sequencing run.</p>
<p>The outputs of SAVEMONEY are two FASTQ files: one that uses prior probability of the error during the plasmid construction at the last step of the post-analysis and one that does not. If a high number of reads is obtained, it does not matter which output file to use because they will return the same consensus. The problem occurs when the number of reads is low and these two consensus sequences do not match. Simulations in <xref rid="fig6" ref-type="fig">Fig. 6e</xref> shows that “with prior” has lower error rate than “without prior”, whereas “with wrong prior” has higher error rate. This trend indicates that the use of prior probability increased the specificity at the expense of sensitivity in the context of detecting errors (i.e., bases that differ between the blueprint and the actual plasmid). There is no clear standard for the extent to which “with prior” results should be trusted, just as there is no clear standard for the manual inspection of an ambiguous position in a chromatogram of Sanger sequencing. However, even if an error is detected in “without prior”, there is a high probability that there is no error if indicated by the “with prior” result. Therefore, in this instance, it would be advisable to re-sequence the plasmid without discarding it, as it is not fully rigorous to claim the absolute correctness of either the “with prior” results indicating that there is an error or the “without prior” results indicating that there is no error. This process is similar to what is typically done in Sanger sequencing, where the decision of whether to accept the sample, discard it, or sequence it again can be made when manually examining ambiguous regions of Sanger sequencing chromatograms. The two outputs of SAVEMONEY allow for flexible data interpretation, which has been difficult to achieve with conventional analysis of nanopore sequence outputs.</p>
<p>The prior information of known mixtures of plasmids allows for the classification of raw reads from each pore and speeds up processing of generating a multiple sequence alignment, which are otherwise be inherently difficult tasks. Because of this feature of our algorithm, computational cost is low, and de-multiplexing of sequence reads can be performed on a consumer-grade laptop computer. For example, in a case where five plasmids with sizes of 9999, 7958, 8627, 9325, and 10086 bases were mixed and 653 reads were obtained from nanopore sequencing, it took 65 minutes to process deconvolution using a MacBook Air (2020, Apple M1 processor, 16 GB RAM). Although the speed of the algorithm is already not rate-limiting compared to the time required to obtain sequencing results, it could be further reduced by executing time-consuming dynamic programming only for some query-reference pairs that necessitate high levels of accuracy and by introducing parallel computing.</p>
<p>Other methods/algorithms for multiplexing plasmids have been proposed to reduce costs. For example, by using barcoded primers, pooled amplicons can be sequenced even if the original sequences are exactly the same<sup><xref ref-type="bibr" rid="c14">14</xref></sup>. However, this approach requires additional primers, increases the number of procedures, and makes it impossible to sequence the entire plasmid. There is also an algorithm to mix plasmids in a barcode-free manner and unmix them <italic>in silico</italic><sup><xref ref-type="bibr" rid="c18">18</xref></sup>. Although this algorithm is fast and useful, it is optimally designed for users with medium-throughput sequencing capability, such as those who own sequencers and prepare libraries by themselves, and it is not clear whether it is suitable for end users who outsource sequencing to commercial services. In fact, as this approach does not use Bayesian analysis when obtaining consensus sequences to consider prior information, hundreds of reads per plasmid are needed for reliable sequencing<sup><xref ref-type="bibr" rid="c18">18</xref></sup>. With a number this high, it is difficult to mix plasmids to the extent possible with SAVEMONEY when outsourcing with services such as Plasmidsaurus, which occasionally returns fewer than 200 reads per sample. In addition, the pipeline did not contain a pre-survey step, and making it unclear for researchers to determine suitable combinations of plasmids to be mixed for outsourcing<sup><xref ref-type="bibr" rid="c18">18</xref></sup>. In contrast, we have shown that plasmids with differences of as little as two bases can be pooled and reliably de-mixed by SAVEMONEY, by using accurate classification of reads by dynamic programing and reliable consensus calculation using Bayesian analysis. We have also implemented a pre-survey step as part of the pipeline to guide researchers to find appropriate combinations of plasmids to be mixed. This step greatly reduces the work involved in mixing plasmids and will help to spread nanopore sequencing as an attractive alternative to Sanger sequencing.</p>
<p>A limitation of our approach is that not all plasmids can be mixed. As described in the pre-survey algorithm section, plasmids from multiple colonies in the same plasmid construction procedure cannot be mixed because their expected sequences are identical. Nevertheless, our algorithm allows users to experimentally mix together plasmids that differ by as low as two bases. This number should be sufficient to mix most plasmids as long as they are different, such as those containing introduced mutations that substitute single amino acids or confer resistance to RNAi or CRISPR guide RNAs. Another limitation of SAVEMONEY is that it calculates consensus base calling and quality scores independently for each nucleotide. However, the quality scores of neighboring bases are not in principle independent, because the number of bases producing current changes by moving through the pore is 5-mers<sup><xref ref-type="bibr" rid="c13">13</xref></sup>. Going forward, incorporation of a model that can take base calling of neighboring nucleotides into account, such as a Hidden Markov Model, might further improve the quality of base calling<sup><xref ref-type="bibr" rid="c19">19</xref></sup>.</p>
<p>There is still room for improvement in the maximum number of plasmids that can be mixed. Currently, the number of reads returned from the Plasmidsaurus service varies widely from hundreds to thousands, depending on the quality of the sample and/or variance of nanopore flow cells. If these unstable factors decrease and, for example, results with at least 1000 reads can be obtained every time, it will be possible to mix more than 30 plasmids, because we have calculated that the minimum required number of reads is 30 per plasmid. On the other hand, it is also challenging to prepare so many different plasmids. In practice, taking fully advantage of our algorithm might involve coordination between multiple colleagues in a lab who are constructing plasmids with different expected sequences. By enabling the mixing together of even a handful of plasmids, SAVEMONEY should dramatically drive down the costs for nanopore and other long-read sequencing technologies, further democratizing these powerful techniques for whole-plasmid and other long sequencing applications.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>This work was supported by the National Institutes of Health (R01GM143367 to J.M.B.). M.U. was supported by an Overseas Research Fellowship from the Japan Society for the Promotion of Science and a Long-Term Fellowship from the Human Frontiers Science Program. We thank Xiaofu Cao, Shiying Huang, Po-Hsun Brian Chen, and Julia Li for providing their plasmids and sequencing data, and we thank Haiyuan Yu for helpful discussions.</p>
</ack>
<sec id="s4">
<title>Author Contributions</title>
<p>M.U. conceived of the idea, designed experiments, wrote all the code, and performed all experiments. M.U. and J.M.B. analyzed results and wrote the manuscript.</p>
</sec>
<sec id="s5">
<title>Declaration of Interest</title>
<p>The authors declare no conflicts of interest.</p>
</sec>
<sec id="s6">
<title>Data Availability</title>
<p>SAVEMONEY is available through Google Colaboratory (<ext-link ext-link-type="uri" xlink:href="https://colab.research.google.com/github/MasaakiU/MultiplexNanopore/blob/master/colab/MultiplexNanopore.ipynb">https://colab.research.google.com/github/MasaakiU/MultiplexNanopore/blob/master/colab/MultiplexNanopore.ipynb</ext-link>). Locally executable scripts are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/MasaakiU/MultiplexNanopore">https://github.com/MasaakiU/MultiplexNanopore</ext-link>).</p>
</sec>
<sec id="s7">
<title>Materials and methods</title>
<sec id="s7a">
<title>Plasmid preparation and sequencing</title>
<p>All plasmids were either purchased or constructed by Gibson Assembly<sup><xref ref-type="bibr" rid="c20">20</xref></sup> or cut and paste cloning techniques. Restriction enzyme digestion tests were performed for those constructed before submitting to sequencing. All sequencing were performed by the Plasmidsaurus service certified by Oxford Nanopore Sequencing Technology.</p>
</sec>
<sec id="s7b">
<title>Software packages used in SAVEMONEY scripts</title>
<p>All analyses were performed by using Google Colaboratory or local environment (Python 3.10.0). The following packages were used: parasail<sup><xref ref-type="bibr" rid="c21">21</xref></sup>, kpLogo<sup><xref ref-type="bibr" rid="c22">22</xref></sup>, Numpy<sup><xref ref-type="bibr" rid="c23">23</xref></sup>, SnapGene Reader<sup><xref ref-type="bibr" rid="c24">24</xref></sup>, BioPython<sup><xref ref-type="bibr" rid="c25">25</xref></sup>, Pandas<sup><xref ref-type="bibr" rid="c26">26</xref></sup>, and Scipy<sup><xref ref-type="bibr" rid="c27">27</xref></sup>.</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Chao</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Yuan</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Zhao</surname>, <given-names>H.</given-names></string-name> <article-title>Recent advances in DNA assembly technologies</article-title>. <source>FEMS Yeast Res</source>. <volume>15</volume>, <fpage>1</fpage>–<lpage>9</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Sanger</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Nicklen</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Coulson</surname>, <given-names>A. R.</given-names></string-name> <article-title>DNA sequencing with chain-terminating inhibitors</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>74</volume>, <fpage>5463</fpage>–<lpage>7</lpage> (<year>1977</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Smith</surname>, <given-names>L. M.</given-names></string-name> <etal>et al.</etal> <article-title>Fluorescence detection in automated DNA sequence analysis</article-title>. <source>Nature</source> <volume>321</volume>, <fpage>674</fpage>–<lpage>9</lpage> (<year>1986</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Ewing</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Hillier</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Wendl</surname>, <given-names>M. C.</given-names></string-name> &amp; <string-name><surname>Green</surname>, <given-names>P.</given-names></string-name> <article-title>Base-calling of automated sequencer traces using phred. I. Accuracy assessment</article-title>. <source>Genome Res</source>. <volume>8</volume>, <fpage>175</fpage>–<lpage>85</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Ewing</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Green</surname>, <given-names>P.</given-names></string-name> <article-title>Base-calling of automated sequencer traces using phred. II. Error probabilities</article-title>. <source>Genome Res</source>. <volume>8</volume>, <fpage>186</fpage>–<lpage>94</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Wang</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Zhao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Bollas</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Au</surname>, <given-names>K. F.</given-names></string-name> <article-title>Nanopore sequencing technology, bioinformatics and applications</article-title>. <source>Nat. Biotechnol</source>. <volume>39</volume>, <fpage>1348</fpage>–<lpage>1365</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="other"><string-name><surname>Agah</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Zheng</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Pasquali</surname>, <given-names>M.</given-names></string-name> <source>DNA sequencing by nanopores : advances and challenges</source>. (<year>2016</year>) doi:<pub-id pub-id-type="doi">10.1088/0022-3727/49/41/413001</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Philpott</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Nanopore sequencing of single-cell transcriptomes with scCOLOR-seq</article-title>. <source>Nat. Biotechnol</source>. <volume>39</volume>, <fpage>1517</fpage>–<lpage>1520</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Bayliss</surname>, <given-names>S. C.</given-names></string-name>, <string-name><surname>Hunt</surname>, <given-names>V. L.</given-names></string-name>, <string-name><surname>Yokoyama</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Thorpe</surname>, <given-names>H. A.</given-names></string-name> &amp; <string-name><surname>Feil</surname>, <given-names>E. J.</given-names></string-name> <article-title>The use of Oxford Nanopore native barcoding for complete genome assembly</article-title>. <source>Gigascience</source> <volume>6</volume>, <fpage>1</fpage>–<lpage>6</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Whitford</surname>, <given-names>W.</given-names></string-name> <etal>et al.</etal> <article-title>Proof of concept for multiplex amplicon sequencing for mutation identification using the MinION nanopore sequencer</article-title>. <source>Sci. Rep</source>. <volume>12</volume>, <fpage>8572</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Delahaye</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Nicolas</surname>, <given-names>J.</given-names></string-name> <article-title>Sequencing DNA with nanopores: Troubles and biases</article-title>. <source>PLoS One</source> <volume>16</volume>, <fpage>e0257521</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="other"><string-name><surname>Sahlin</surname>, <given-names>K.</given-names></string-name> <article-title>Error correction enables use of Oxford Nanopore analysis</article-title>. <source>Nat. Commun</source>. <fpage>1</fpage>–<lpage>13</lpage> doi:<pub-id pub-id-type="doi">10.1038/s41467-020-20340-8</pub-id>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Jain</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Improved data analysis for the MinION nanopore sequencer</article-title>. <source>Nat. Methods</source> <volume>12</volume>, <fpage>351</fpage>–<lpage>6</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Currin</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Highly multiplexed, fast and accurate nanopore sequencing for verification of synthetic DNA constructs and sequence libraries</article-title>. <source>Synth. Biol. (Oxford, England)</source> <volume>4</volume>, <fpage>1</fpage>–<lpage>8</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title>SNP detection for massively parallel whole-genome resequencing</article-title>. <source>Genome Res</source>. <volume>19</volume>, <fpage>1124</fpage>–<lpage>1132</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Smith</surname>, <given-names>T. F.</given-names></string-name> &amp; <string-name><surname>Waterman</surname>, <given-names>M. S.</given-names></string-name> <article-title>Identification of common molecular subsequences</article-title>. <source>J. Mol. Biol</source>. <volume>147</volume>, <fpage>195</fpage>–<lpage>7</lpage> (<year>1981</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Laver</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal> <article-title>Assessing the performance of the Oxford Nanopore Technologies MinION</article-title>. <source>Biomol. Detect. Quantif</source>. <volume>3</volume>, <fpage>1</fpage>–<lpage>8</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="web"><string-name><surname>Mumm</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>On-Ramp: A tool for rapid, multiplexed validation of plasmids using nanopore sequencing</article-title>. <source>bioRxiv</source> (<year>2022</year>). doi: <pub-id pub-id-type="doi">10.1101/2022.03.15.484480</pub-id>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Loman</surname>, <given-names>N. J.</given-names></string-name>, <string-name><surname>Quick</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Simpson</surname>, <given-names>J. T.</given-names></string-name> <article-title>A complete bacterial genome assembled de novo using only nanopore sequencing data</article-title>. <source>Nat. Methods</source> <volume>12</volume>, <fpage>733</fpage>–<lpage>735</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Gibson</surname>, <given-names>D. G.</given-names></string-name> <etal>et al.</etal> <article-title>Enzymatic assembly of DNA molecules up to several hundred kilobases</article-title>. <source>Nat. Methods</source> <volume>6</volume>, <fpage>343</fpage>–<lpage>5</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Daily</surname>, <given-names>J.</given-names></string-name> <article-title>Parasail: SIMD C library for global, semi-global, and local pairwise sequence alignments</article-title>. <source>BMC Bioinformatics</source> <volume>17</volume>, <fpage>1</fpage>–<lpage>11</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>X.</given-names></string-name> &amp; <string-name><surname>Bartel</surname>, <given-names>D. P.</given-names></string-name> <article-title>kpLogo: positional k-mer analysis reveals hidden specificity in biological sequences</article-title>. <source>Nucleic Acids Res</source>. <volume>45</volume>, <fpage>W534</fpage>–<lpage>W538</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Harris</surname>, <given-names>C. R.</given-names></string-name> <etal>et al.</etal> <article-title>Array programming with NumPy</article-title>. <source>Nature</source> <volume>585</volume>, <fpage>357</fpage>–<lpage>362</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="web"><collab>SnapGene Reader</collab>. <ext-link ext-link-type="uri" xlink:href="https://github.com/IsaacLuo/SnapGeneFileReader">https://github.com/IsaacLuo/SnapGeneFileReader</ext-link>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Chapman</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Chang</surname>, <given-names>J</given-names></string-name>. <source>Biopython. ACM SIGBIO Newsl</source>. <volume>20</volume>, <fpage>15</fpage>–<lpage>19</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="web"><collab>Pandas</collab>. <pub-id pub-id-type="doi">10.5281/zenodo.7549438</pub-id>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Virtanen</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal> <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nat. Methods</source> <volume>17</volume>, <fpage>261</fpage>–<lpage>272</lpage> (<year>2020</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88794.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Zambrano</surname>
<given-names>María Mercedes</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>CorpoGen</institution>
</institution-wrap>
<city>Bogotá</city>
<country>Colombia</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study provides a <bold>valuable</bold> computational tool for analyzing and deconvoluting a pool of plasmids sequenced without barcoding using nanopore long-read sequencing. While the authors provide <bold>convincing</bold> validation, this tool might still present limitations concerning practical applications. The work will be of interest to researchers in need of rapid and cost-effective verification of plasmid sequences.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88794.1.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This manuscript presents SAVEMONEY, a computational tool designed to enhance the utilization of Oxford Nanopore Technologies (ONT) long-read sequencing for the design and analysis of plasmid sequencing experiments. In the past few years, with the improvement in both sequencing length and accuracy, ONT sequencing is being rapidly extended to almost all omics analyses which are dominated by short-read sequencing (e.g., Illumina). However, relatively higher sequencing errors of long-read sequencing techniques including PacBio and ONT is still a major obstacle for plasmid/clone-based sequencing service that aims to achieve single base/nucleotide accuracy. This work provides a guideline for sequencing multiple plasmids together using the same ONT run without molecular barcoding, followed by data deconvolution. The whole algorithm framework is well-designed, and some real data and simulation data are utilized to support the conclusions. The tool SAVEMONEY is proposed to target users who have their own ONT sequencers and perform library preparation and sequencing by themselves, rather than relying on commercial services. As we know and discussed by the authors, in the real world, to ensure accuracy, the researchers will routinely pick up multiple colonies in the same plasmid construction and submit for Sanger sequencing. However, SAVEMONEY is not able to support the simultaneous analysis of multiple colonies in the same run, as compared to the barcoding-based approaches. This is a major limitation in the significance of this work. Encouraging computational efforts in ONT data debarcoding for mixed-plasmid or even single-cell sequencing would be more valuable in the field.</p>
<p>1. To provide more comprehensive information for users who care about the cost, the Introduction section should include a cost comparison between Sanger and ONT, with more details, such as different ONT platforms (MinION, PromethION, FlongIe), chemistries (flow cells) and kits. This additional information will be more helpful and informative for the users who have their own sequencers and are the target audience for SAVEMONEY.</p>
<p>2. In &quot;Overview of the algorithm&quot; (Pages 3-4) under the Results section, instead of stating &quot;However, coverage varies from ~100-1000 and is difficult to predict because each nanopore flow cell has different properties.&quot;, it will be beneficial to provide more detailed information, such as sequencing length, yield/read count per flow cell of different platforms. This information will assist users in designing their own experiments effectively.</p>
<p>3. While this study optimized and evaluated the tool using a total of 14 plasmids, it may not provide sufficient power to represent the diversity of the plasmid world. Consideration should be given to expanding the dataset to include a broader range of plasmids in future studies to enhance the robustness and generalizability of the tool.</p>
<p>4. If applicable and feasible, including a comparison or benchmark of SAVEMONEY against other similar tools would further strengthen the manuscript. This comparison would allow users to evaluate the advantages and disadvantages of different tools for their specific needs.</p>
<p>5. The importance of pre-filtering raw sequencing reads should be emphasized as noisy reads can significantly impact the overall performance of the tool. It is essential to clarify whether any pre-filtering steps were performed in this study, such as filtering based on quality scores, read length, or other relevant factors.</p>
<p>6. The statement regarding the number of required reads per plasmid (20-30) and the maximum number of plasmids (up to six) that can be mixed in a single run may become outdated due to the rapid advancements in ONT technology. In the Discussion section, instead of assuming specific numbers, it would be more beneficial to provide information based on the current state of ONT sequencing, such as the number of reads per MinION flow cell that can be produced.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88794.1.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The authors developed an algorithm that allows for deconvoluting of plasmid sequences from a mixture of plasmids that have been sequenced by nanopore long read technology. As library preparations and barcoding of individual samples increase sequencing costs, the algorithm bypasses this need and thus decreases time on sample prep and sequencing costs. In the first step, the tool assesses which of the plasmid constructions can be mixed in a single library preparation by calculating a distance matrix between the reference plasmid and the constructions producing sequence clusters. The user is given groups of plasmids, from different clusters, to be pooled together for sequencing. After sequencing, the algorithm deconvolutes the reads by classifying them based on alignments to the reference sequence. A Bayesian analysis approach is used to obtain a consensus sequence and quality scores.</p>
<p>Strengths</p>
<p>
The authors exploit one of the main advantages of long-read sequencing which is to accurately resolve regions of high complexity, as regularly found in plasmids, and developed a tool that can validate plasmid constructions by reducing sequencing costs. Multiple plasmids (up to six) can be analyzed simultaneously in a single library without the need for sample barcoding, also reducing sample preparation time. Although inserts must be different, just 2 bases difference would be enough for a correct assignation. It maximizes cost-efficiency for projects that require large amounts of plasmid constructions and high-throughput validation.</p>
<p>Weaknesses</p>
<p>
The method proposed by the authors requires prior knowledge of plasmid sequences (i.e., blueprints or plasmid reference) and is not suitable for small experiments. The plasmid inserts or backbones must be different e.g., multiple colonies from the same plasmid construction effort cannot be submitted together.</p>
</body>
</sub-article>
</article>