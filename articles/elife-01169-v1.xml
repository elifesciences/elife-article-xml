<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">01169</article-id><article-id pub-id-type="doi">10.7554/eLife.01169</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Ecology</subject></subj-group><subj-group subj-group-type="heading"><subject>Genomics and Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Spatial dilemmas of diffusible public goods</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-4603"><name><surname>Allen</surname><given-names>Benjamin</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="aff" rid="aff2"/><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-6"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-6428"><name><surname>Gore</surname><given-names>Jeff</given-names></name><xref ref-type="aff" rid="aff3"/><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="other" rid="par-4"/><xref ref-type="other" rid="par-5"/><xref ref-type="other" rid="par-7"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-4515"><name><surname>Nowak</surname><given-names>Martin A</given-names></name><xref ref-type="aff" rid="aff2"/><xref ref-type="aff" rid="aff4"/><xref ref-type="aff" rid="aff5"/><xref ref-type="other" rid="par-6"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution content-type="dept">Department of Mathematics</institution>, <institution>Emmanuel College</institution>, <addr-line><named-content content-type="city">Boston</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><institution content-type="dept">Program for Evolutionary Dynamics</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><institution content-type="dept">Department of Physics</institution>, <institution>Massachusetts Institute of Technology</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><institution content-type="dept">Department of Mathematics</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><institution content-type="dept">Department of Organismic and Evolutionary Biology</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bergstrom</surname><given-names>Carl T</given-names></name><role>Reviewing editor</role><aff><institution>University of Washington</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>benjcallen@gmail.com</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>17</day><month>12</month><year>2013</year></pub-date><pub-date pub-type="collection"><year>2013</year></pub-date><volume>2</volume><elocation-id>e01169</elocation-id><history><date date-type="received"><day>03</day><month>07</month><year>2013</year></date><date date-type="accepted"><day>03</day><month>11</month><year>2013</year></date></history><permissions><copyright-statement>© 2013, Allen et al</copyright-statement><copyright-year>2013</copyright-year><copyright-holder>Allen et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/3.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-01169-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.01169.001</object-id><p>The emergence of cooperation is a central question in evolutionary biology. Microorganisms often cooperate by producing a chemical resource (a public good) that benefits other cells. The sharing of public goods depends on their diffusion through space. Previous theory suggests that spatial structure can promote evolution of cooperation, but the diffusion of public goods introduces new phenomena that must be modeled explicitly. We develop an approach where colony geometry and public good diffusion are described by graphs. We find that the success of cooperation depends on a simple relation between the benefits and costs of the public good, the amount retained by a producer, and the average amount retained by each of the producer’s neighbors. These quantities are derived as analytic functions of the graph topology and diffusion rate. In general, cooperation is favored for small diffusion rates, low colony dimensionality, and small rates of decay of the public good.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.01169.001">http://dx.doi.org/10.7554/eLife.01169.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.01169.002</object-id><title>eLife digest</title><p>The natural world is often thought of as a cruel place, with most living things ruthlessly competing for space or resources as they struggle to survive. However, from two chimps picking the fleas off each other to thousands of worker ants toiling for the good of the colony, cooperation is fairly widespread in nature. Surprisingly, even single-celled microbes cooperate.</p><p>Individual bacterial and yeast cells often produce molecules that are used by others. Whilst many cells share the benefits of these ‘public goods’, at least some cells have to endure the costs involved in producing them. As such, selfish individuals can benefit from molecules made by others, without making their own. However, if everyone cheated in this way, the public good would be lost completely: this is called the ‘public goods dilemma’.</p><p>Allen et al. have developed a mathematical model of a public goods dilemma within a microbial colony, in which the public good travels from its producers to other cells by diffusion. The fate of cooperation in this ‘diffusible public goods dilemma’ depends on the spatial arrangement of cells, which in turn depends on their shape and the spacing between them. Other important factors include rates of diffusion and decay of the public good—both of which affect how widely the public good is shared.</p><p>The model predicts that cooperation is favored when the diffusion rate is small, when the colonies are flatter, and when the public goods decay slowly. These conditions maximize the benefit of the public goods enjoyed by the cell producing them and its close neighbors, which are also likely to be producers. Public goods dilemmas are common in nature and society, so there is much interest in identifying general principles that promote cooperation.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.01169.002">http://dx.doi.org/10.7554/eLife.01169.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>cooperation</kwd><kwd>microbial evolution</kwd><kwd>evolutionary graph theory</kwd><kwd>social multiplier</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>S. cerevisiae</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>NIH R00 GM085279-02</award-id><principal-award-recipient><name><surname>Gore</surname><given-names>Jeff</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution>National Science Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Gore</surname><given-names>Jeff</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution>Alfred P Sloan Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Gore</surname><given-names>Jeff</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution>Pew Scholars Program</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Gore</surname><given-names>Jeff</given-names></name></principal-award-recipient></award-group><award-group id="par-5"><funding-source><institution-wrap><institution>Allen Investigator Program</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Gore</surname><given-names>Jeff</given-names></name></principal-award-recipient></award-group><award-group id="par-6"><funding-source><institution-wrap><institution>John Templeton Foundation–Foundational Questions in Evolutionary Biology</institution></institution-wrap></funding-source><award-id>RFP-12-02</award-id><principal-award-recipient><name><surname>Allen</surname><given-names>Benjamin</given-names></name><name><surname>Nowak</surname><given-names>Martin A</given-names></name></principal-award-recipient></award-group><award-group id="par-7"><funding-source><institution-wrap><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>NIH DP2</award-id><principal-award-recipient><name><surname>Gore</surname><given-names>Jeff</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A simple model reveals the roles of colony geometry and diffusion rate in allowing microbes to cooperate by sharing public goods.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Public goods dilemmas are frequently observed in microbes. For example, the budding yeast <italic>Saccharomyces cerevisiae</italic> cooperates by producing the enzyme invertase, which hydrolyzes sucrose into monosaccharides, when yeast colonies are grown in glucose-limited media (<xref ref-type="bibr" rid="bib15">Greig and Travisano, 2004</xref>; <xref ref-type="bibr" rid="bib14">Gore et al., 2009</xref>). Other examples include the production of chemical agents that scavenge iron (<xref ref-type="bibr" rid="bib16">Griffin et al., 2004</xref>; <xref ref-type="bibr" rid="bib6">Buckling et al., 2007</xref>; <xref ref-type="bibr" rid="bib9">Cordero et al., 2012</xref>; <xref ref-type="bibr" rid="bib18">Julou et al., 2013</xref>), enable biofilm formation (<xref ref-type="bibr" rid="bib32">Rainey and Rainey, 2003</xref>), eliminate competition (<xref ref-type="bibr" rid="bib22">Le Gac and Doebeli, 2010</xref>), induce antibiotic resistance (<xref ref-type="bibr" rid="bib8">Chuang et al., 2009</xref>; <xref ref-type="bibr" rid="bib23">Lee et al., 2010</xref>), or facilitate infection of a host (<xref ref-type="bibr" rid="bib33">Raymond et al., 2012</xref>).</p><p>In many cases, the benefits of public goods go primarily to cells other than the producer. For example, in a <italic>S. cerevisiae</italic> population subject to continuous mixing, only ∼1% of monosaccharides are imported into the cell that hydrolyzes them, with the remainder diffusing away (<xref ref-type="bibr" rid="bib14">Gore et al., 2009</xref>). Furthermore, production of public goods typically involves a metabolic cost, which may exceed the direct benefit to the producer. In this case, absent some mechanism to support cooperation (<xref ref-type="bibr" rid="bib28">Nowak, 2006</xref>), public goods production is expected to disappear under competition from cheaters, resulting in the tragedy of the commons (<xref ref-type="bibr" rid="bib17">Hardin, 1968</xref>).</p><p>There is growing evidence from experiments (<xref ref-type="bibr" rid="bib16">Griffin et al., 2004</xref>; <xref ref-type="bibr" rid="bib19">Kümmerli et al., 2009</xref>; <xref ref-type="bibr" rid="bib18">Julou et al., 2013</xref>; <xref ref-type="bibr" rid="bib26">Momeni et al., 2013</xref>) and simulations (<xref ref-type="bibr" rid="bib3">Allison, 2005</xref>; <xref ref-type="bibr" rid="bib25">Misevic et al., 2012</xref>) that spatial or group clustering can support cooperation in microbial public goods dilemmas, although this effect depends on the nature of competition for space and resources (<xref ref-type="bibr" rid="bib16">Griffin et al., 2004</xref>; <xref ref-type="bibr" rid="bib6">Buckling et al., 2007</xref>). These findings agree with insights from mathematical models (<xref ref-type="bibr" rid="bib29">Nowak and May, 1992</xref>; <xref ref-type="bibr" rid="bib11">Durrett and Levin, 1994</xref>; <xref ref-type="bibr" rid="bib36">Santos and Pacheco, 2005</xref>; <xref ref-type="bibr" rid="bib30">Ohtsuki et al., 2006</xref>; <xref ref-type="bibr" rid="bib38">Szabó and Fáth, 2007</xref>; <xref ref-type="bibr" rid="bib39">Taylor et al., 2007</xref>; <xref ref-type="bibr" rid="bib31">Perc and Szolnoki, 2008</xref>; <xref ref-type="bibr" rid="bib12">Fletcher and Doebeli, 2009</xref>; <xref ref-type="bibr" rid="bib20">Korolev and Nelson, 2011</xref>) suggesting that spatial structure can promote cooperation by facilitating clustering and benefit-sharing among cooperators. However, these mathematical results focus largely on pairwise interactions rather than diffusible public goods. On the other hand, previous theoretical works that specifically explore microbial cooperation (<xref ref-type="bibr" rid="bib42">West and Buckling, 2003</xref>; <xref ref-type="bibr" rid="bib34">Ross-Gillespie et al., 2007</xref>; <xref ref-type="bibr" rid="bib10">Driscoll and Pepper, 2010</xref>) use a relatedness parameter in place of an explicit spatial model, obscuring the important roles of colony geometry and spatial diffusion in determining the success of cooperation.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>Here we present a simple spatial model of a diffusible public goods dilemma. Our model is inspired by the quasi-regular arrangements of cells in many microbial colonies (<xref ref-type="fig" rid="fig1">Figure 1A,B</xref>). The geometry of these arrangements depends on the shapes of cells and the dimensionality of the environment. For example, approximately spherical organisms such as <italic>S. cerevisiae</italic> arrange themselves in a hexagonal lattice-like structure when the colony is constrained to a two-dimensional plane (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). This differs from the arrangements of rod-shaped organisms such as the bacterium <italic>Escherichia coli</italic> (<xref ref-type="fig" rid="fig1">Figure 1B</xref>).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.01169.003</object-id><label>Figure 1.</label><caption><title>Colony geometry and public goods sharing in microbes of different shapes.</title><p>(<bold>A</bold>) A two-dimensional colony of <italic>S. cerevisiae</italic> self-organizes into approximate hexagonal geometry due to the spherical shape of yeast cells. (<bold>B</bold>) A two-dimensional colony of <italic>E. coli</italic>, expressing green fluorescent protein, exhibits transient regular-graph-like structure. Panels <bold>C</bold> and <bold>D</bold> show idealized graph representations of colony spatial structure, and the consequent sharing of public goods, for sphere-shaped and rod-shaped organisms, respectively. Background colors show the stationary distributions <italic>ψ</italic><sub><italic>i</italic></sub> of public goods resulting from a single cooperator (center). In each case, the diffusion parameter is set as <italic>λ</italic> = 3. (<bold>C</bold>) Two-dimensional colonies of spherical organisms can be represented by triangular lattices with uniform edge weights. (<bold>D</bold>) Two-dimensional colonies of rod-shaped organisms can be represented using a triangular lattice with unequal weights. In this case, the weights are chosen as 0.1, 0.15 and 0.25, roughly proportional to the shared surface area between <italic>E. coli</italic> cells when arranged as shown.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.01169.003">http://dx.doi.org/10.7554/eLife.01169.003</ext-link></p></caption><graphic xlink:href="elife-01169-fig1-v1"/></fig></p><p>To allow for a maximum variety of possible arrangements, we represent space as a weighted graph <italic>G</italic> (<xref ref-type="fig" rid="fig1">Figure 1C,D</xref>; <xref ref-type="bibr" rid="bib24">Lieberman et al., 2005</xref>). Edges join cells to their neighbors, with edge weights <italic>e</italic><sub><italic>ij</italic></sub> proportional to the frequency of diffusion between neighboring cells. The graph structure thereby captures all features of cell arrangement that are relevant to the diffusion of public goods. The edge weights are normalized to satisfy Σ<sub><italic>j</italic></sub> <italic>e</italic><sub><italic>ij</italic></sub> = 1, so that they represent relative frequencies of diffusion to each neighbor. Since we are modeling intercellular diffusion, we set <italic>e</italic><sub><italic>ii</italic></sub> = 0 for each <italic>i</italic>. We also suppose that <italic>G</italic> has bi-transitive symmetry (<xref ref-type="bibr" rid="bib39">Taylor et al., 2007</xref>), which implies that space is homogeneous (i.e., that the colony looks the same from each cell). Our model therefore applies primarily to the interiors of colonies rather than their boundaries. Bi-transitive symmetry also requires that pairwise relationships are symmetric—in particular <italic>e</italic><sub><italic>ij</italic></sub> = <italic>e</italic><sub><italic>ji</italic></sub> for every pair <italic>i</italic> and <italic>j</italic>. This captures the reasonable assumption that public goods diffuse as frequently from cell <italic>i</italic> to cell <italic>j</italic> as they do from <italic>j</italic> to <italic>i</italic>.</p><p>To characterize local structure, we introduce the <italic>Simpson degree</italic> <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> This quantity can be understood as the Simpson diversity (<xref ref-type="bibr" rid="bib37">Simpson, 1949</xref>) of neighbors per cell, and coincides with the usual notion of degree on regular unweighted graphs. By symmetry, <italic>κ</italic> does not depend on which vertex <italic>i</italic> is used in the above sum.</p><p>We consider two cells types: cooperators, <italic>C</italic>, that produce the public good, and defectors, <italic>D</italic>, that do not. These traits are passed to offspring upon reproduction. Production of the public good inflicts a cost <italic>c</italic> on its producer, and generates a total benefit <italic>b</italic> that is distributed among cells according to a diffusion process described below. Because our model is inspired by public goods that directly increase cell growth rate (such as hydrolyzed monosaccharides) it is less applicable to public goods with indirect benefits, such as quorum-sensing molecules (<xref ref-type="bibr" rid="bib41">Waters and Bassler, 2005</xref>).</p><p>Cooperators produce one unit of public good per unit time. The public goods in the vicinity of a given cell either are utilized for the benefit of this cell or diffuse toward neighboring cells in proportion to edge weight. (The possibility of public goods decay is discussed below.) We quantify diffusion by the ratio <italic>λ</italic> of the diffusion rate to the utilization rate. The dynamics of the local public goods concentration <italic>ψ</italic><sub><italic>i</italic></sub> at each node <italic>i</italic> ∈ <italic>G</italic> are given by<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ψ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Above, <italic>s</italic><sub><italic>i</italic></sub> = 0,1 indicates the current type, <italic>D</italic> or <italic>C</italic> respectively, of cell <italic>i</italic>. The term <italic>s</italic><sub><italic>i</italic></sub> in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> represents public goods production, −<italic>ψ</italic><sub><italic>i</italic></sub> represents utilization, −<italic>λψ</italic><sub><italic>i</italic></sub> represents diffusion outward, and the remaining term represents diffusion inward.</p><p><xref ref-type="disp-formula" rid="equ1">Equation 1</xref> is equivalent to supposing that each particle of public good performs a random walk among cells (with step probabilities equal to edge weights), and has probability 1/(1+<italic>λ</italic>) of being utilized at each cell it encounters, including its producer. In this interpretation, <italic>λ</italic> equals the expected number of steps a particle travels before being utilized.</p><p>For most empirical systems, diffusion and utilization occur much faster than cell division. We therefore suppose that the local public goods concentrations <italic>ψ</italic><sub><italic>i</italic></sub> reach stationary equilibrium levels between reproductive events (‘Materials and methods’).</p><p>Two key quantities in our analysis are the fractions, <italic>ϕ</italic><sub>0</sub> and <italic>ϕ</italic><sub>1</sub>, of public goods that are retained by its producer and the producer’s immediate neighbors, respectively (<xref ref-type="fig" rid="fig2">Figure 2</xref>). For a state in which only a single cell, <italic>i</italic>, is a cooperator, we have <italic>ϕ</italic><sub>0</sub> = <italic>ψ</italic><sub><italic>i</italic></sub> and <italic>ϕ</italic><sub>1</sub> = Σ<sub><italic>j</italic></sub><sub>∈<italic>G</italic></sub> <italic>e</italic><sub><italic>ij</italic></sub> <italic>ψ</italic><sub><italic>j</italic></sub>.<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.01169.004</object-id><label>Figure 2.</label><caption><title>The success of cooperation depends on the amounts of public good retained by a cooperator and its neighbors.</title><p>Of the public good that a cooperator produces, a fraction <italic>ϕ</italic><sub>0</sub> is retained by the producer, a fraction <italic>ϕ</italic><sub>1</sub> is absorbed by each of the cooperator’s nearest neighbors, and the remainder diffuses to cells further away. (For graphs with unequal edge weights, <italic>ϕ</italic><sub>1</sub> is the edge-weighted average fraction received by each neighbor.) Cooperation is favored if <italic>b/c</italic> &gt; 1/(<italic>ϕ</italic><sub>0</sub> + <italic>ϕ</italic><sub>1</sub>), that is, if the benefit <italic>b</italic><italic>ϕ</italic><sub>0</sub> received by producer, plus the average benefit <italic>b</italic><italic>ϕ</italic><sub>1</sub> received by each neighbor, exceeds the cost <italic>c</italic> of production. This figure shows a triangular lattice with equal edge weights and diffusion parameter <italic>λ</italic> = 3.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.01169.004">http://dx.doi.org/10.7554/eLife.01169.004</ext-link></p></caption><graphic xlink:href="elife-01169-fig2-v1"/></fig></p><p>Turning now to the dynamics of evolution, we suppose that the fecundity (reproductive rate) of cell <italic>i</italic> is given by <italic>F</italic><sub><italic>i</italic></sub> = 1 + <italic>bψ</italic><sub><italic>i</italic></sub> − <italic>cs</italic><sub><italic>i</italic></sub>. In words, each individual has baseline fitness 1, plus the benefit, <italic>bψ</italic><sub><italic>i</italic></sub>, of public goods utilization, minus the cost, <italic>cs</italic><sub><italic>i</italic></sub> of public goods production. We suppose <italic>b &gt;</italic> 0 and 0 &lt; <italic>c</italic> &lt; 1, so that benefits, costs, and overall fecundity are always positive. Some of our results apply to all such <italic>b</italic> and <italic>c</italic> values, while others apply only in the weak selection regime, <italic>b, c</italic> ≪ 1/<italic>κ</italic>.</p><p>Reproductions and deaths follow the Death–Birth update rule (<xref ref-type="bibr" rid="bib30">Ohtsuki et al., 2006</xref>). At each time step, a cell is selected randomly to die, with uniform probability. A neighbor of the now-vacant position is randomly selected to reproduce, with probability proportional to fecundity times edge weight. The new offspring fills the vacancy. For the moment, we suppose that reproduction follows the same edge weights as diffusion (we will relax this assumption later). We also consider other update rules in <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>.</p><p>We quantify the evolutionary success of cooperation in terms of the fixation probabilities <italic>ρ</italic><sub><italic>C</italic></sub> and <italic>ρ</italic><sub><italic>D</italic></sub>, defined as the probability that the cooperator or defector type, respectively, will fix, upon starting from a single mutant in a population initially of the opposite type. Cooperation is favored if <italic>ρ</italic><sub><italic>C</italic></sub> &gt; <italic>ρ</italic><sub><italic>D</italic></sub>. This is equivalent to the condition that, for small mutation rates, cooperators have greater time-averaged frequency than would be expected from mutational equilibrium alone (<xref ref-type="bibr" rid="bib1">Allen and Tarnita, 2012</xref>).</p><p>The assortment of cell types due to local reproduction can be studied using coalescing random walks (<xref ref-type="bibr" rid="bib40">Wakeley, 2009</xref>; <xref ref-type="bibr" rid="bib2">Allen et al., 2012</xref>), which represent the ancestral lineages of chosen individuals as the coalesce into the most recent common ancestor. By applying random walk theory to both diffusion and assortment, we are able to obtain exact conditions for the success of cooperation (‘Materials and methods’; <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>).</p><p>We find that public goods cooperation is favored, for any graph and diffusion rate, if and only if<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mfrac><mml:mi>b</mml:mi><mml:mi>c</mml:mi></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In words, cooperation is favored if, of the public goods a cooperator produces, the benefits received by the producer, <italic>b</italic><italic>ϕ</italic><sub>0</sub>, plus the (edge-weighted) average benefits received by each neighbor, <italic>b</italic><italic>ϕ</italic><sub>1</sub>, outweigh the cost <italic>c</italic> of production (<xref ref-type="fig" rid="fig2">Figure 2</xref>). This result is strikingly simple, given the complex patterns of public goods sharing that result from diffusion (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Condition (<xref ref-type="disp-formula" rid="equ2">2</xref>) holds for arbitrary selection strength on complete graphs and one-dimensional lattices, and for weak selection on other graphs. This condition also holds for a variety of other diffusion processes (<xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>)—including diffusion that follows a different graph structure from reproduction. (In this case, the neighbor average <italic>ϕ</italic><sub>1</sub> is computed using the weights for the reproduction graph.)</p><p>Condition (<xref ref-type="disp-formula" rid="equ2">2</xref>) can alternatively be expressed as <italic>b/c</italic> &gt; λ/[<italic>ϕ</italic><sub>0</sub> (1 + 2λ) − 1] (‘Materials and methods’), showing how the success of cooperation depends on the relationship between the retention fraction <italic>ϕ</italic><sub>0</sub> and the diffusion parameter <italic>λ</italic>. We have derived this relationship exactly for simple graph structures (<xref ref-type="table" rid="tbl1">Table 1</xref>), and present a general method for obtaining this relationship in the ‘Materials and methods’. <xref ref-type="fig" rid="fig3">Figure 3A,B</xref> illustrates how the critical <italic>b/c</italic> ratios vary with the diffusion parameter <italic>λ</italic> and the graph topology.<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.01169.005</object-id><label>Table 1.</label><caption><p>Fraction of public goods retained by producer for different graph structures and diffusion rates</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.01169.005">http://dx.doi.org/10.7554/eLife.01169.005</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Graph structure<xref ref-type="table-fn" rid="tblfn1">*</xref></th><th>Fraction <italic>ϕ</italic><sub>0</sub> of public goods retained</th></tr></thead><tbody><tr><td>Complete (well-mixed)</td><td align="center"><inline-formula><mml:math id="inf2"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula></td></tr><tr><td>1D lattice</td><td align="center"><inline-formula><mml:math id="inf3"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>λ</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula></td></tr><tr><td>2D square lattice<xref ref-type="table-fn" rid="tblfn2">†</xref></td><td align="center"><inline-formula><mml:math id="inf4"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mtext>agm</mml:mtext><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula></td></tr><tr><td><italic>n</italic>-dimensional lattice (general)<xref ref-type="table-fn" rid="tblfn3">‡</xref></td><td align="center"><inline-formula><mml:math id="inf5"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mi>π</mml:mi></mml:msubsup><mml:mo>⋯</mml:mo></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mi>π</mml:mi></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo> </mml:mo><mml:mi>χ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula></td></tr><tr><td><italic>k</italic>-Bethe lattice<xref ref-type="table-fn" rid="tblfn4">§</xref></td><td align="center"><inline-formula><mml:math id="inf6"><mml:mrow><mml:mfrac><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msqrt><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula></td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><label>*</label><p>These results are for large populations. Corrections for finite population size are given in <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>.</p></fn><fn id="tblfn2"><label>†</label><p>agm denotes the arithmetic-geometric mean.</p></fn><fn id="tblfn3"><label>‡</label><p>This result applies to any mathematical lattice, including triangular and von Neumann lattices. <italic>χ</italic>(<bold>y</bold>) denotes the structure function of the lattice in question, defined in the ‘Materials and methods’.</p></fn><fn id="tblfn4"><label>§</label><p>A Bethe lattice (a.k.a. infinite Cayley tree), is an infinite regular graph with no cycles. In the formula, <italic>k</italic> denotes the graph degree.</p></fn></table-wrap-foot></table-wrap><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.01169.006</object-id><label>Figure 3.</label><caption><title>Cooperation becomes harder to achieve with increasing <italic>λ</italic>, graph degree and dimensionality, and public goods decay rate.</title><p>(<bold>A</bold>) The critical <italic>b/c</italic> ratio for public goods production to be favored for various graph structures, plotted against the diffusion rate <italic>λ</italic>. These results are derived from <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> and the expressions for <italic>ϕ</italic><sub>0</sub> in <xref ref-type="table" rid="tbl1">Table 1</xref>. For a well-mixed population (complete graph), cooperation is favored if and only if <italic>b/c</italic> &gt; 1 + <italic>λ</italic>; for other graph structures, the critical <italic>b/c</italic> ratio is a increasing, convex function of <italic>λ</italic>. In general, the conditions for cooperation become increasingly stringent with both the degree and the dimensionality of the graph. (<bold>B</bold>) Our results are confirmed by simulations on a 15 × 15 periodic triangular lattice with uniform edge weights and cost <italic>c</italic> = 5%. The critical <italic>b/c</italic> threshold from <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> is plotted in black. A plus (+) indicates that the frequency of cooperator fixation exceeded the frequency of defector fixation (<italic>ρ</italic><sub><italic>C</italic></sub> &gt; <italic>ρ</italic><sub><italic>D</italic></sub>), while a minus (−) indicates the opposite. In all cases the results were statistically significant (two-proportion pooled <italic>z</italic>-test, p&lt;0.05). (<bold>C</bold>) Adding decay of rate <italic>d</italic> effectively reduces both <italic>λ</italic> and <italic>b</italic> by the factor 1/(1 + <italic>d</italic>), reflecting greater locality in sharing but reduced overall concentration of public good. On a graph of <italic>b/c</italic> versus <italic>λ</italic>, this moves each point (<italic>b/c</italic>, <italic>λ</italic>) along a straight line toward the origin. Since the increase in the critical <italic>b/c</italic> ratio with <italic>λ</italic> is in all cases sublinear, this change always hinders cooperation. The critical <italic>b/c</italic> ratio for a planar triangular lattice is plotted in black. Adding a decay rate equal to the utilization rate (<italic>d</italic> = 1) changes favorable (<italic>b/c</italic>, <italic>λ</italic>) combinations (marked by circles) to unfavorable ones (arrowheads).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.01169.006">http://dx.doi.org/10.7554/eLife.01169.006</ext-link></p></caption><graphic xlink:href="elife-01169-fig3-v1"/></fig></p><p>Above, we have assumed that diffusion and replacement are both described by the same graph structure. However, this may not be the case for all microbes. In <italic>E. coli</italic> colonies, for example, it is reasonable to conjecture that diffusion occurs more frequently among cells that have a long side in common, whereas replacement may occur more frequently among end-to-end neighbors (<xref ref-type="fig" rid="fig1">Figure 1A,C</xref>). Additionally, some systems may follow a public goods diffusion process other than that modeled by <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. To account for these variations, we consider a more general model in which diffusion is described by the fractions <italic>ϕ</italic><sub><italic>ij</italic></sub> of public goods which, if produced by cell <italic>i</italic>, would be utilized by cell <italic>j</italic>. Probabilities of replacement are described by a graph with edge weights <italic>e</italic><sub><italic>ij</italic></sub> as before. The diffusion fractions <italic>ϕ</italic><sub><italic>ij</italic></sub> are normalized so that ∑<sub><italic>j</italic></sub> <italic>ϕ</italic><sub><italic>ij</italic></sub> = 1 for each <italic>i</italic>, and they have the same symmetries as the replacement graph; within these restrictions, they may be specified arbitrarily. Remarkably, our main result, <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, remains valid in this generalized setting, with the neighbor average <italic>ϕ</italic><sub>1</sub> defined as <italic>ϕ</italic><sub>1</sub> = ∑<sub><italic>j</italic></sub> <italic>e</italic><sub><italic>ij</italic></sub> <italic>ϕ</italic><sub><italic>ij</italic></sub>.</p></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Our results suggest three qualitative regimes for diffusible public goods scenarios. For <italic>λ</italic> ≪ 1, the benefits are almost all retained by producer, and production is favored whenever <italic>b/c</italic> &gt; 1. Conversely, for <italic>λ</italic> ≪ 1, public goods are shared indiscriminately, and production is favored only if public goods are essential for survival, in which case <italic>b</italic> is effectively infinite. Between these extremes, public goods are shared locally, and the spatial arrangement of cells plays a critical role in the success of cooperation (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). At the smaller end of this critical regime, the expansion <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>b</mml:mi><mml:mo>/</mml:mo><mml:mi>c</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>κ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>κ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="script">O</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> of condition (<xref ref-type="disp-formula" rid="equ2">2</xref>), derived in <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>, shows how the difficulty of cooperation increases with the diffusion parameter <italic>λ</italic> and the Simpson degree <italic>κ</italic>. For the hydrolysis of monosaccharides in <italic>S. cerevisiae</italic>, we estimate <italic>λ</italic> ∼ 3 (‘Materials and methods’); thus we expect the success of invertase production to be strongly affected by colony geometry. Interestingly, this diffusion length is of the same order of magnitude as those reported in other recent experiments with diffusible public goods (<xref ref-type="bibr" rid="bib18">Julou et al., 2013</xref>; <xref ref-type="bibr" rid="bib26">Momeni et al., 2013</xref>).</p><p>Our model predicts that the advantage of cooperation decreases with colony dimensionality; for example, less cooperation would be expected in three-dimensional structures than in flat (2D) colonies (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). It also predicts that cooperation becomes more successful with increased viscosity of the environment and/or rate of public goods utilization, both of which would decrease <italic>λ</italic>.</p><p>A more subtle question is how cooperation is affected if the public good may decay (or equivalently, escape the colony) instead of being utilized. Decay reduces the absolute amount of public goods to be shared, but also restricts this sharing to a smaller circle of neighbors; thus the net effect on cooperation is at first glance ambiguous. We show in the ‘Materials and methods’ that incorporating decay effectively decreases <italic>λ</italic> by a factor 1/(1 + <italic>d</italic>), reflecting the smaller neighborhood of sharing, and also effectively decreases <italic>b</italic> by the same factor, reflecting the diminished absolute amount of public goods. Here <italic>d</italic> represents the ratio of the decay rate to the utilization rate. Since the critical benefit-to-cost ratio always increases sublinearly with <italic>λ</italic>, the net effect is to make cooperation more difficult (see <xref ref-type="fig" rid="fig3">Figure 3C</xref>). Thus decay of the public good has a purely negative effect on cooperation.</p><p>Our results help elucidate recent emiprical results on microbial cooperation in viscous environments. For example, <xref ref-type="bibr" rid="bib19">Kümmerli et al. (2009)</xref> found that increased viscosity promotes the evolution of siderophore production in <italic>Pseudomonas aeruginosa</italic>, while <xref ref-type="bibr" rid="bib22">Le Gac and Doebeli (2010)</xref> found that viscosity had no effect on the evolution of colicin production in <italic>E. coli</italic>. In both cases, increased viscosity restricted cell movement, effectively leading to fewer neighbors per cell (lower graph degree). The crucial difference lies in the effect on public goods diffusion. In the study of <xref ref-type="bibr" rid="bib19">Kümmerli et al. (2009)</xref>, the diffusion rate decreased significantly as viscosity increased, while for <xref ref-type="bibr" rid="bib22">Le Gac and Doebeli (2010)</xref>, the diffusion rate remained large even with high viscosity. Thus the divergent outcomes can be understood as a consequence of differences in the diffusion rate, captured in our model by <italic>λ</italic>.</p><p>Here we have considered homotypic cooperation—cooperation within a single population. <xref ref-type="bibr" rid="bib26">Momeni et al. (2013)</xref>, published previously in <italic>eLife</italic>, investigate heterotypic cooperation between distinct populations of <italic>S. cerevisiae</italic>, in the form of exchange of essential metabolites. Type <italic>R</italic> produces adenine and requires lysine, type <italic>G</italic> produces lysine and requires adenine, and type <italic>C</italic> (a cheater) requires adenine but does not produce adenine. While such heterotypic cooperation is not incorporated in our model, the results are qualitatively similar, in that spatial structure promoted the cooperative strategies <italic>G</italic> and <italic>R</italic> over the cheater <italic>C</italic>. This similarity can be understood by noting that heterotypic cooperation also entails a form of second-order homotypic cooperation. For example, <italic>G</italic>-cells aid nearby <italic>R</italic>-cells, which in turn aid nearby <italic>G</italic>-cells, so the benefit produced by a <italic>G</italic>-cell indirectly aids other <italic>G</italic>-cells nearby. Thus the conclusion that spatial structure aids cooperative strategies can apply to heterotypic cooperation as well.</p><p>Finally, our model can also represent the spread of behaviors via imitation on social networks (<xref ref-type="bibr" rid="bib4">Bala and Goyal, 1998</xref>; <xref ref-type="bibr" rid="bib5">Bramoullé and Kranton, 2007</xref>; <xref ref-type="bibr" rid="bib7">Christakis and Fowler, 2007</xref>). Suppose an action generates a benefit <italic>b</italic><sub>0</sub> for the actor, and additionally generates further benefits that radiate outward according to some multiplier <italic>m</italic>, so that first neighbors receive a combined benefit <italic>mb</italic><sub>0</sub>, second neighbors receive <italic>m</italic><sup>2</sup><italic>b</italic><sub>0</sub>, and so on. Education, for example, exhibits this kind of social multiplier in its effect on wages (<xref ref-type="bibr" rid="bib13">Glaeser et al., 2003</xref>). This effect can be captured using the parameter change <italic>b</italic> = <italic>b</italic><sub>0</sub>/(1 − <italic>m</italic>), <italic>λ</italic> = <italic>m</italic>/(1 − <italic>m</italic>). For non-well-mixed social networks, the action becomes more likely to spread as the multiplier increases, and can spread even if there is a net cost to the actor (<xref ref-type="fig" rid="fig4">Figure 4</xref>).<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.01169.007</object-id><label>Figure 4.</label><caption><title>The spread of behaviors on social networks increases with their social multipliers.</title><p>In an alternate interpretation of our model, an action has benefits that radiate outward from the actor according to some multiplier <italic>m</italic>. Individual receiving a large amount of benefit are more likely to be imitated by social contacts. The likelihood of the action to spread—and the benefits to the network as a whole—both increase with the multiplier <italic>m</italic>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.01169.007">http://dx.doi.org/10.7554/eLife.01169.007</ext-link></p></caption><graphic xlink:href="elife-01169-fig4-v1"/></fig></p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Stationary public goods distribution</title><p>We obtain a recurrence relation for the stationary public goods distribution in a given state by setting <inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ψ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. This yields<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In particular, for a state in which only cell <italic>i</italic> is a cooperator, we have (1 + <italic>λ</italic>)<italic>ϕ</italic><sub>0</sub> = 1 + <italic>λ</italic><italic>ϕ</italic><sub>1</sub>. Combining this identity with (<xref ref-type="disp-formula" rid="equ2">2</xref>) yields the equivalent condition <italic>b</italic>/<italic>c</italic> &gt; <italic>λ</italic>/[<italic>ϕ</italic><sub>0</sub> (1 + 2<italic>λ</italic>) − 1].</p></sec><sec id="s4-2"><title>Generating function analysis of random walks</title><p>We analyze the distribution of public goods and the assortment of cell types using the generating function for random walks (<xref ref-type="bibr" rid="bib27">Montroll and Weiss, 1965</xref>; <xref ref-type="bibr" rid="bib21">Lawler and Limic, 2010</xref>). For a given graph <italic>G</italic>, this generating function is given by the power series<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Above, <inline-formula><mml:math id="inf9"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the probability that a random walk of <italic>n</italic> steps starting at <italic>i</italic> will terminate at <italic>j</italic>.</p><p>We prove in <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref> that the stationary concentration of public goods in a particular state are given by<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In particular, the fraction <italic>ϕ</italic><sub>0</sub> that a cooperator retains of its own public good can be written<disp-formula id="equ6"><label>(4)</label><mml:math id="m6"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Spatial assortment of types can be quantified using identity-by-descent IBD probabilities (<xref ref-type="bibr" rid="bib35">Rousset and Billiard, 2000</xref>; <xref ref-type="bibr" rid="bib39">Taylor et al., 2007</xref>). For this, we introduce a small probability <italic>u</italic> that each new offspring is a mutant. Then, two given cells are IBD if no mutation separates them from their most recent common ancestor. Based on the theory of coalescing random walks (<xref ref-type="bibr" rid="bib2">Allen et al., 2012</xref>), the probability that <italic>i</italic> and <italic>j</italic> are IBD can be written<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Considering the dynamics of Death–Birth updating, and applying established properties of generating functions, we derive (<xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>) the success condition (2).</p><p>To obtain the expressions in <xref ref-type="table" rid="tbl1">Table 1</xref>, we combine (4) with previously established expressions for <inline-formula><mml:math id="inf10"><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> on the graphs in question. A general expression is available for a lattice of any dimension. Such a lattice is defined by a finite collection of vectors <bold>v</bold><sub>1</sub>,…,<bold>v</bold><sub><italic>k</italic></sub> ∈ <bold>R</bold><sup><italic>n</italic></sup> with associated weights <italic>w</italic><sub>1</sub>,…,<italic>w</italic><sub><italic>k</italic></sub>. The nodes of the lattice are all points of the form <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="bold">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>m</italic><sub>1</sub>,…,<italic>m</italic><sub><italic>k</italic></sub> are integers. The edges from a node <inline-formula><mml:math id="inf12"><mml:mi mathvariant="bold">x</mml:mi></mml:math></inline-formula> consist of the vectors <inline-formula><mml:math id="inf13"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, positioned to start at the point <inline-formula><mml:math id="inf14"><mml:mi mathvariant="bold">x</mml:mi></mml:math></inline-formula>, with weights given by <inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, respectively. The generating function of a random walk on such a lattice, starting from the lattice origin <bold>0</bold>, can be expressed as (<xref ref-type="bibr" rid="bib27">Montroll and Weiss, 1965</xref>)<disp-formula id="equ8"><label>(5)</label><mml:math id="m8"><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mi>π</mml:mi></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mi>π</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo> </mml:mo><mml:mi>χ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Above, <italic>χ</italic>(<bold>y</bold>) is the ‘structure function’ of the lattice, defined as<disp-formula id="equ9"><label>(6)</label><mml:math id="m9"><mml:mrow><mml:mi>χ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The argument <bold>y</bold> = (<italic>y</italic><sub>1</sub>,…,<italic>y</italic><sub><italic>n</italic></sub>) of <italic>χ</italic>(<bold>y</bold>) is a vector in <bold>R</bold><sup><italic>n</italic></sup>. For example, for an <italic>n</italic>-dimensional square lattice, we have<disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mi>χ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mtext>cos</mml:mtext><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For a two-dimensional triangular lattice,<disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:mi>χ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>cos</mml:mtext><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mtext>cos</mml:mtext><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mtext>cos</mml:mtext><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Similar expressions for other lattices, including the square lattice with von Neumann neighbors and lattices with unequal edge weights (e.g., <xref ref-type="fig" rid="fig1">Figure 1B</xref>), can be readily obtained from (6).</p></sec><sec id="s4-3"><title>Estimation of diffusion parameter for <italic>S. cerevisiae</italic></title><p>We suppose that glucose uptake follows Michaelis–Menten kinetics, so that the uptake rate is given by <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mi>ψ</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic>ψ</italic> is the concentration of glucose, <italic>V</italic><sub>max</sub> is the maximal uptake rate, and <italic>K</italic> is the concentration at which the uptake rate reaches half of its maximum. We treat fructose as equivalent to glucose. Since we are interested in the case that glucose is limited, we assume <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>≪</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>, and the uptake rate therefore simplifies to <inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mi>ψ</mml:mi><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>. <xref ref-type="bibr" rid="bib14">Gore et al. (2009)</xref> estimated the uptake kinetics to be <italic>V</italic><sub>max</sub> ∼ 2 × 10<sup>7</sup> molecules per second and <italic>K</italic> ∼ 1mM.</p><p>We calculate the lifetime <italic>L</italic> of a glucose molecule prior to absorption as the reciprocal of the fraction of glucose absorbed per unit time:<disp-formula id="equ12"><mml:math id="m12"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mo> </mml:mo><mml:mtext>glucose</mml:mtext><mml:mo> </mml:mo><mml:mtext>molecules</mml:mtext><mml:mo> </mml:mo><mml:mtext>per</mml:mtext><mml:mo> </mml:mo><mml:mtext>unit</mml:mtext><mml:mo> </mml:mo><mml:mtext>excluded</mml:mtext><mml:mo> </mml:mo><mml:mtext>volume</mml:mtext></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtext>Uptake</mml:mtext><mml:mo> </mml:mo><mml:mtext>rate</mml:mtext><mml:mo> </mml:mo><mml:mtext>per</mml:mtext><mml:mo> </mml:mo><mml:mtext>cell</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>#</mml:mo><mml:mo> </mml:mo><mml:mtext>cells</mml:mtext><mml:mo> </mml:mo><mml:mtext>per</mml:mtext><mml:mo> </mml:mo><mml:mtext>unit</mml:mtext><mml:mo> </mml:mo><mml:mtext>excluded</mml:mtext><mml:mo> </mml:mo><mml:mtext>volume</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where ‘excluded volume’ refers to the volume of water excluded by the yeast cells. Supposing that each yeast cell has volume <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∼</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, and that yeast cells in a tightly-packed colony occupy approximately half of the available volume, we obtain<disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>ψ</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mi>ψ</mml:mi><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mtext>sec</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The diffusion length before uptake is calculated as <inline-formula><mml:math id="inf20"><mml:mrow><mml:msqrt><mml:mrow><mml:mi>D</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, where <italic>D</italic> is the diffusion constant, which we estimate as 100 <italic>μ</italic>m<sup>2</sup>/sec in the colony environment. Combining with the above calculation of <italic>L</italic> gives a diffusion length of ∼10 <italic>μ</italic>m, which is ∼3 cell lengths. We therefore estimate <italic>λ</italic> = 3 for this system.</p></sec><sec id="s4-4"><title>Decay of the public good</title><p>Decay or escape of the public good can be incorporated into our model by adding a decay term to the right-hand side of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. This yields<disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ψ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Above, <italic>d</italic> represents the ratio of the decay rate to the utilization rate. Setting <inline-formula><mml:math id="inf21"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ψ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and rearranging, we obtain<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Defining the effective quantities <inline-formula><mml:math id="inf22"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ψ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf23"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, we recover the recurrence relation (<xref ref-type="disp-formula" rid="equ3">3</xref>). All of our results then carry forward using these effective quantities, except that <italic>b</italic> must also be reduced by the factor 1 + <italic>d</italic> to compensate for the rescaling of <italic>ψ</italic><sub><italic>i</italic></sub> by this same factor.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Andrea Velenich for obtaining images of <italic>E. coli</italic> and <italic>S. cerevisiae</italic> colonies. This work was supported by an NIH R00 Pathways to Independence Award (NIH R00 GM085279-02), an NIH New Innovator Award (NIH DP2), an NSF CAREER Award, a Sloan Research Fellowship, the Pew Scholars Program and the Allen Investigator Program. The Foundational Questions in Evolutionary Biology initiative at Harvard University is supported by a grant from the John Templeton Foundation.</p></ack><sec sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>BA, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>JG, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>MAN, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><sec sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.01169.008</object-id><label>Supplementary file 1.</label><caption><title>This file contains mathematical proofs of several results.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.01169.008">http://dx.doi.org/10.7554/eLife.01169.008</ext-link></p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-01169-supp1-v1.pdf"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>B</given-names></name><name><surname>Tarnita</surname><given-names>C</given-names></name></person-group><year>2012</year><article-title>Measures of success in a class of evolutionary models with fixed population size and structure</article-title><source>Journal of Mathematical Biology</source><fpage>1</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1007/s00285-012-0622-x</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>B</given-names></name><name><surname>Traulsen</surname><given-names>A</given-names></name><name><surname>Tarnita</surname><given-names>CE</given-names></name><name><surname>Nowak</surname><given-names>MA</given-names></name></person-group><year>2012</year><article-title>How mutation affects evolutionary games on graphs</article-title><source>Journal of Theoretical Biology</source><volume>299</volume><fpage>97</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2011.03.034</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allison</surname><given-names>S</given-names></name></person-group><year>2005</year><article-title>Cheaters, diffusion and nutrients constrain decomposition by microbial enzymes in spatially structured environments</article-title><source>Ecology Letters</source><volume>8</volume><fpage>626</fpage><lpage>635</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2005.00756.x</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bala</surname><given-names>V</given-names></name><name><surname>Goyal</surname><given-names>S</given-names></name></person-group><year>1998</year><article-title>Learning from neighbours</article-title><source>The Review of Economic Studies</source><volume>65</volume><fpage>595</fpage><lpage>621</lpage><pub-id pub-id-type="doi">10.1111/1467-937X.00059</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bramoullé</surname><given-names>Y</given-names></name><name><surname>Kranton</surname><given-names>R</given-names></name></person-group><year>2007</year><article-title>Public goods in networks</article-title><source>Journal of Economic Theory</source><volume>135</volume><fpage>478</fpage><lpage>494</lpage><pub-id pub-id-type="doi">10.1016/j.jet.2006.06.006</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buckling</surname><given-names>A</given-names></name><name><surname>Harrison</surname><given-names>F</given-names></name><name><surname>Vos</surname><given-names>M</given-names></name><name><surname>Brockhurst</surname><given-names>MA</given-names></name><name><surname>Gardner</surname><given-names>A</given-names></name><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Griffin</surname><given-names>A</given-names></name></person-group><year>2007</year><article-title>Siderophore-mediated cooperation and virulence in <italic>Pseudomonas aeruginosa</italic></article-title><source>FEMS Microbiology Ecology</source><volume>62</volume><fpage>135</fpage><lpage>141</lpage><pub-id pub-id-type="doi">10.1111/j.1574-6941.2007.00388.x</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christakis</surname><given-names>NA</given-names></name><name><surname>Fowler</surname><given-names>JH</given-names></name></person-group><year>2007</year><article-title>The spread of obesity in a large social network over 32 years</article-title><source>New England Journal of Medicine</source><volume>357</volume><fpage>370</fpage><lpage>379</lpage><pub-id pub-id-type="doi">10.1056/NEJMsa066082</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chuang</surname><given-names>JS</given-names></name><name><surname>Rivoire</surname><given-names>O</given-names></name><name><surname>Leibler</surname><given-names>S</given-names></name></person-group><year>2009</year><article-title>Simpson’s paradox in a synthetic microbial system</article-title><source>Science</source><volume>323</volume><fpage>272</fpage><lpage>275</lpage><pub-id pub-id-type="doi">10.1126/science.1166739</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cordero</surname><given-names>OX</given-names></name><name><surname>Ventouras</surname><given-names>L-A.</given-names></name><name><surname>DeLong</surname><given-names>EF</given-names></name><name><surname>Polz</surname><given-names>MF</given-names></name></person-group><year>2012</year><article-title>Public good dynamics drive evolution of iron acquisition strategies in natural bacterioplankton populations</article-title><source>Proceedings of the National Academy of Sciences USA</source><volume>109</volume><fpage>20059</fpage><lpage>20064</lpage><pub-id pub-id-type="doi">10.1073/pnas.1213344109</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Driscoll</surname><given-names>WW</given-names></name><name><surname>Pepper</surname><given-names>JW</given-names></name></person-group><year>2010</year><article-title>Theory for the evolution of diffusible external goods</article-title><source>Evolution</source><volume>64</volume><fpage>2682</fpage><lpage>2687</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2010.01002.x</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durrett</surname><given-names>R</given-names></name><name><surname>Levin</surname><given-names>S</given-names></name></person-group><year>1994</year><article-title>The importance of being discrete (and spatial)</article-title><source>Theoretical Population Biology</source><volume>46</volume><fpage>363</fpage><lpage>394</lpage><pub-id pub-id-type="doi">10.1006/tpbi.1994.1032</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fletcher</surname><given-names>JA</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year>2009</year><article-title>A simple and general explanation for the evolution of altruism</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>276</volume><fpage>13</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1098/rspb.2008.0829</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaeser</surname><given-names>EL</given-names></name><name><surname>Sacerdote</surname><given-names>BI</given-names></name><name><surname>Scheinkman</surname><given-names>JA</given-names></name></person-group><year>2003</year><article-title>The social multiplier</article-title><source>Journal of the European Economic Association</source><volume>1</volume><fpage>345</fpage><lpage>353</lpage><pub-id pub-id-type="doi">10.1162/154247603322390982</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gore</surname><given-names>J</given-names></name><name><surname>Youk</surname><given-names>H</given-names></name><name><surname>Van Oudenaarden</surname><given-names>A</given-names></name></person-group><year>2009</year><article-title>Snowdrift game dynamics and facultative cheating in yeast</article-title><source>Nature</source><volume>459</volume><fpage>253</fpage><lpage>256</lpage><pub-id pub-id-type="doi">10.1038/nature07921</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greig</surname><given-names>D</given-names></name><name><surname>Travisano</surname><given-names>M</given-names></name></person-group><year>2004</year><article-title>The prisoner’s dilemma and polymorphism in yeast suc genes</article-title><source>Proceedings of the Royal Society of London. Series B: Biological Sciences</source><volume>271</volume><supplement>Suppl 3</supplement><fpage>S25</fpage><lpage>S26</lpage><pub-id pub-id-type="doi">10.1098/rsbl.2003.0083</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griffin</surname><given-names>A.</given-names></name><name><surname>West</surname><given-names>S.</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name></person-group><year>2004</year><article-title>Cooperation and competition in pathogenic bacteria</article-title><source>Nature</source><volume>430</volume><fpage>1024</fpage><lpage>1027</lpage><pub-id pub-id-type="doi">10.1038/nature02744</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardin</surname><given-names>G</given-names></name></person-group><year>1968</year><article-title>The tragedy of the commons</article-title><source>Science</source><volume>162</volume><fpage>1243</fpage><lpage>1248</lpage><pub-id pub-id-type="doi">10.1126/science.162.3859.1243</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Julou</surname><given-names>T</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Guillon</surname><given-names>L</given-names></name><name><surname>Croquette</surname><given-names>V</given-names></name><name><surname>Schalk</surname><given-names>IJ</given-names></name><name><surname>Bensimon</surname><given-names>D</given-names></name><name><surname>Desprat</surname><given-names>N</given-names></name></person-group><year>2013</year><article-title>Cell–cell contacts confine public goods diffusion inside <italic>Pseudomonas aeruginosa</italic> clonal microcolonies</article-title><source>Proceedings of the National Academy of Sciences USA</source><volume>110</volume><fpage>12577</fpage><lpage>12582</lpage><pub-id pub-id-type="doi">10.1073/pnas.1301428110</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kümmerli</surname><given-names>R</given-names></name><name><surname>Griffin</surname><given-names>AS</given-names></name><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name><name><surname>Harrison</surname><given-names>F</given-names></name></person-group><year>2009</year><article-title>Viscous medium promotes cooperation in the pathogenic bacterium <italic>Pseudomonas aeruginosa</italic></article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>276</volume><fpage>3531</fpage><lpage>3538</lpage><pub-id pub-id-type="doi">10.1098/rspb.2009.0861</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korolev</surname><given-names>KS</given-names></name><name><surname>Nelson</surname><given-names>DR</given-names></name></person-group><year>2011</year><article-title>Competition and cooperation in one-dimensional stepping-stone models</article-title><source>Physical Review Letters</source><volume>107</volume><fpage>088103</fpage></element-citation></ref><ref id="bib21"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lawler</surname><given-names>G</given-names></name><name><surname>Limic</surname><given-names>V</given-names></name></person-group><year>2010</year><source>Random walk: a modern introduction</source><publisher-loc>New York</publisher-loc><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Gac</surname><given-names>M</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year>2010</year><article-title>Environmental viscosity does not affect the evolution of cooperation during experimental evolution of colicigenic bacteria</article-title><source>Evolution</source><volume>64</volume><fpage>522</fpage><lpage>533</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2009.00814.x</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>HH</given-names></name><name><surname>Molla</surname><given-names>MN</given-names></name><name><surname>Cantor</surname><given-names>CR</given-names></name><name><surname>Collins</surname><given-names>JJ</given-names></name></person-group><year>2010</year><article-title>Bacterial charity work leads to population-wide resistance</article-title><source>Nature</source><volume>467</volume><fpage>82</fpage><lpage>85</lpage><pub-id pub-id-type="doi">10.1038/nature09354</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lieberman</surname><given-names>E</given-names></name><name><surname>Hauert</surname><given-names>C</given-names></name><name><surname>Nowak</surname><given-names>M</given-names></name></person-group><year>2005</year><article-title>Evolutionary dynamics on graphs</article-title><source>Nature</source><volume>433</volume><fpage>312</fpage><lpage>316</lpage><pub-id pub-id-type="doi">10.1038/nature03204</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Misevic</surname><given-names>D</given-names></name><name><surname>Frenoy</surname><given-names>A</given-names></name><name><surname>Parsons</surname><given-names>DP</given-names></name><name><surname>Taddei</surname><given-names>F</given-names></name></person-group><year>2012</year><article-title>Effects of public good properties on the evolution of cooperation</article-title><source>Artificial Life</source><volume>13</volume><fpage>218</fpage><lpage>225</lpage></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Momeni</surname><given-names>B</given-names></name><name><surname>Waite</surname><given-names>A</given-names></name><name><surname>shou</surname><given-names>W</given-names></name></person-group><year>2013</year><article-title>Spatial self-organization favors heterotypic cooperation over cheating</article-title><source>eLife</source><volume>2</volume><fpage>e00960</fpage><pub-id pub-id-type="doi">10.7554/eLife.00960</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montroll</surname><given-names>E</given-names></name><name><surname>Weiss</surname><given-names>G</given-names></name></person-group><year>1965</year><article-title>Random walks on lattices. II</article-title><source>Journal of Mathematical Physics</source><volume>6</volume><fpage>167</fpage><pub-id pub-id-type="doi">10.1063/1.1704269</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nowak</surname><given-names>MA</given-names></name></person-group><year>2006</year><article-title>Five rules for the evolution of cooperation</article-title><source>Science</source><volume>314</volume><fpage>1560</fpage><lpage>1563</lpage><pub-id pub-id-type="doi">10.1126/science.1133755</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nowak</surname><given-names>MA</given-names></name><name><surname>May</surname><given-names>RM</given-names></name></person-group><year>1992</year><article-title>Evolutionary games and spatial chaos</article-title><source>Nature</source><volume>359</volume><fpage>826</fpage><lpage>829</lpage><pub-id pub-id-type="doi">10.1038/359826a0</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohtsuki</surname><given-names>H</given-names></name><name><surname>Hauert</surname><given-names>C</given-names></name><name><surname>Lieberman</surname><given-names>E</given-names></name><name><surname>Nowak</surname><given-names>MA</given-names></name></person-group><year>2006</year><article-title>A simple rule for the evolution of cooperation on graphs and social networks</article-title><source>Nature</source><volume>441</volume><fpage>502</fpage><lpage>505</lpage><pub-id pub-id-type="doi">10.1038/nature04605</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perc</surname><given-names>M</given-names></name><name><surname>Szolnoki</surname><given-names>A</given-names></name></person-group><year>2008</year><article-title>Social diversity and promotion of cooperation in the spatial prisoner’s dilemma game</article-title><source>Physical Review E</source><volume>77</volume><fpage>011904</fpage></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rainey</surname><given-names>PB</given-names></name><name><surname>Rainey</surname><given-names>K</given-names></name></person-group><year>2003</year><article-title>Evolution of cooperation and conflict in experimental bacterial populations</article-title><source>Nature</source><volume>425</volume><fpage>72</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1038/nature01906</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raymond</surname><given-names>B</given-names></name><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Griffin</surname><given-names>AS</given-names></name><name><surname>Bonsall</surname><given-names>MB</given-names></name></person-group><year>2012</year><article-title>The dynamics of cooperative bacterial virulence in the field</article-title><source>Science</source><volume>337</volume><fpage>85</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.1126/science.1218196</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ross-Gillespie</surname><given-names>A</given-names></name><name><surname>Gardner</surname><given-names>A</given-names></name><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Griffin</surname><given-names>AS</given-names></name></person-group><year>2007</year><article-title>Frequency dependence and cooperation: theory and a test with bacteria</article-title><source>The American Naturalist</source><volume>170</volume><fpage>331</fpage><lpage>342</lpage><pub-id pub-id-type="doi">10.1086/519860</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rousset</surname><given-names>F</given-names></name><name><surname>Billiard</surname><given-names>S</given-names></name></person-group><year>2000</year><article-title>A theoretical basis for measures of kin selection in subdivided populations: finite populations and localized dispersal</article-title><source>Journal of Evolutionary Biology</source><volume>13</volume><fpage>814</fpage><lpage>825</lpage><pub-id pub-id-type="doi">10.1046/j.1420-9101.2000.00219.x</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santos</surname><given-names>FC</given-names></name><name><surname>Pacheco</surname><given-names>JM</given-names></name></person-group><year>2005</year><article-title>Scale-free networks provide a unifying framework for the emergence of cooperation</article-title><source>Physical Review Letters</source><volume>95</volume><fpage>98104</fpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.95.098104</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simpson</surname><given-names>EH</given-names></name></person-group><year>1949</year><article-title>Measurement of diversity</article-title><source>Nature</source><volume>163</volume><fpage>688</fpage><pub-id pub-id-type="doi">10.1038/163688a0</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szabó</surname><given-names>G</given-names></name><name><surname>Fáth</surname><given-names>G</given-names></name></person-group><year>2007</year><article-title>Evolutionary games on graphs</article-title><source>Physics Reports</source><volume>446</volume><fpage>97</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1016/j.physrep.2007.04.004</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>PD</given-names></name><name><surname>Day</surname><given-names>T</given-names></name><name><surname>Wild</surname><given-names>G</given-names></name></person-group><year>2007</year><article-title>Evolution of cooperation in a finite homogeneous graph</article-title><source>Nature</source><volume>447</volume><fpage>469</fpage><lpage>472</lpage><pub-id pub-id-type="doi">10.1038/nature05784</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wakeley</surname><given-names>J</given-names></name></person-group><year>2009</year><source>Coalescent theory: an introduction</source><publisher-loc>Greenwood Village, CO</publisher-loc><publisher-name>Roberts &amp; Company Publishers</publisher-name></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waters</surname><given-names>CM</given-names></name><name><surname>Bassler</surname><given-names>BL</given-names></name></person-group><year>2005</year><article-title>Quorum sensing: cell-to-cell communication in bacteria</article-title><source>Annual Review of Cell and Developmental Biology</source><volume>21</volume><fpage>319</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1146/annurev.cellbio.21.012704.131001</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name></person-group><year>2003</year><article-title>Cooperation, virulence and siderophore production in bacterial parasites</article-title><source>Proceedings of the Royal Society of London. Series B: Biological Sciences</source><volume>270</volume><fpage>37</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1098/rspb.2002.2209</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.01169.009</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bergstrom</surname><given-names>Carl T</given-names></name><role>Reviewing editor</role><aff><institution>University of Washington</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elife.elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for sending your work entitled “Spatial dilemmas of diffusible public goods” for consideration at <italic>eLife</italic>. Your article has been favorably evaluated by a Senior editor and 3 reviewers, one of whom, Carl Bergstrom, is a member of our Board of Reviewing Editors.</p><p>The editors and the reviewers discussed their comments before we reached this decision, and the Senior editor has assembled the following comments to help you prepare a revised submission.</p><p>Microbes frequently face public goods dilemmas and often these dilemmas involve the production of diffusible products secreted into the extracellular environment. It is an interesting and open question to determine when and how such behavior will be favored by natural selection. The manuscript provides a technically sound and elegant mathematical analysis of the problem based on an implicit graphical structure in the spatial organization of cells that make up a colony. The main mathematical result, which is inequality (2), is nice in its simplicity and how it incorporates the three different factors within a single representation.</p><p>The reviewers had two major concerns that need to be addressed before the manuscript can be accepted:</p><p>A) Whether the paper is of sufficient biological interest to merit publication in <italic>eLife</italic>. To this concern the following four comments/suggestions were provided by the reviewers:</p><p>1) While graphs provide a nice means of modeling some types of structure, one reviewer was less convinced that they are a natural way to model the structure of diffusing public goods. This approach that the authors have developed extensively over the years appears forced upon the biology of the problem rather than being an natural way to model natural interactions.</p><p>2) Do the results tell us much beyond what we already know in terms of the biological problem? For example, similar effects of the diffusion rate are already known from other models of public goods (some of which are cited), and the colony dimension results (which sounds really interesting at first) is also pretty obvious once it becomes clear what is meant by colony dimension. The main new insight about biology provided by the results is the role of the decay rate of the public good. To my knowledge at least, this idea has not previously been explored and it is clear that the tension between the various ways that decay rate enters the problem requires the sort of quantitative analysis presented here. Regardless, the result does seem like a rather modest advance in our understanding of the evolutionary interplay between public goods, diffusion, cooperation, etc.</p><p>3) The authors might also want to delve more deeply into the literature on public goods to better position their results within the existing literature. For example, there is good work by Brown, Taylor, Buckling, West, and others. Some of this is cited but not discussed in a very thorough way, and some is not even cited. A none-exhaustive list of other potentially useful papers include:</p><p>Buckling, A, Harrison, F, Vos, M, Brockhurst, MA, Gardner, A, West, SA &amp; Griffin, AS. 2007 Siderophore-mediated cooperation and virulence in Pseudomonas aeruginosa. FEMS Microbiolol. Ecol. 62, 135-141. doi:10.1111/j.1574-6941.2007.00388.x</p><p>West, SA &amp; Buckling, A. 2003 Cooperation, virulence and siderophore production in bacterial parasites. Proc. R. Soc. Lond. B 270, 37-44. doi:10.1098/rspb.2002.2209</p><p>Bramoulle, Y &amp; Kranton, R. Public goods in networks. Journal of Economic Theory. 135 (1), 478-494</p><p>4) You may also be able to address this concern by referencing and coordinating the text of your paper with the parallel submission by Shou et al.</p><p>B) Avoid confusion about the use of the term “Bethe Lattice”. A reviewer provided the following commentary/suggestions:</p><p>“In order to avoid later confusion I suggest substituting the expression “Bethe lattice” or “locally Cayley tree structure” for “Cayley tree” through the whole text. For finite Cayley trees a relevant portion of the nodes are located on the periphery where each node has only one neighbor. This is the reason why the behavior of the Ising model on the Cayley tree is similar to those observed on the one-dimensional chain (no magnetic ordering at finite temperatures). On the contrary, the Ising model on Bethe lattice exhibits a mean-field type order-disorder phase transition (when increasing the temperature) that can be described exactly by several methods, e.g., by the cavity method or pair approximation [for details see the review by Dorogovtsev et al., Rev. Mod. Phys. 80 (2008) 1275-1335]. The concept of Bethe lattice neglects the effects of periphery and involves equivalence between the nodes, as it is assumed in the present work, too.”</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.01169.010</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>The reviewers had two major concerns that need to be addressed before the manuscript can be accepted</italic>:</p><p><italic>A) Whether the paper is of sufficient biological interest to merit publication in eLife. To this concern the following four comments/suggestions were provided by the reviewers</italic>:</p><p><italic>1) While graphs provide a nice means of modeling some types of structure, one reviewer was less convinced that they are a natural way to model the structure of diffusing public goods. This approach that the authors have developed extensively over the years appears forced upon the biology of the problem rather than being an natural way to model natural interactions</italic>.</p><p>While they may have an abstract “flavor”, graphs are a very natural tool for representing a wide variety of spatial relationships. Compared, for example, to lattice models (an accepted tool of the field), graphs have more flexibility to represent the distinct patterns of cell arrangement that occur in microbial colonies. In this study we use weighted graphs to allow for different diffusion rates between different kinds of neighbors (e.g., lateral versus end-to-end). The symmetry assumptions correspond to the quasi-regular structures that are often found in colony interiors.</p><p><italic>2) Do the results tell us much beyond what we already know in terms of the biological problem? For example, similar effects of the diffusion rate are already known from other models of public goods (some of which are cited), and the colony dimension results (which sounds really interesting at first) is also pretty obvious once it becomes clear what is meant by colony dimension. The main new insight about biology provided by the results is the role of the decay rate of the public good. To my knowledge at least, this idea has not previously been explored and it is clear that the tension between the various ways that decay rate enters the problem requires the sort of quantitative analysis presented here. Regardless, the result does seem like a rather modest advance in our understanding of the evolutionary interplay between public goods, diffusion, cooperation, etc</italic>.</p><p>In addition to our results on the effects of the decay rate, our model makes the unexpected prediction that the success of cooperation depends only on the amounts of public goods received by a cell and its immediate neighbors. Thus, even though public goods may be shared at arbitrarily large distances, the success of this behavior can be understood by examining neighbors at distance one.</p><p><italic>3) The authors might also want to delve more deeply into the literature on public goods to better position their results within the existing literature. For example, there is good work by Brown, Taylor, Buckling, West, and others. Some of this is cited but not discussed in a very thorough way, and some is not even cited</italic>.</p><p>We thank the reviewers for the suggestions. We have incorporated the suggested references, along with others that have appeared recently. We now discuss these contributions in greater detail in the last paragraph of the Introduction. We have also incorporated a recent study of diffusible public goods by <xref ref-type="bibr" rid="bib18">Julou et al. (2013)</xref> into our references and Discussion.</p><p><italic>4) You may also be able to address this concern by referencing and coordinating the text of your paper with the parallel submission by Shou et al</italic>.</p><p>We have added an exploration of the parallels of our work with that of <xref ref-type="bibr" rid="bib26">Momeni et al. (2013)</xref> at the second-to-last paragraph of the Discussion. Although the work of <xref ref-type="bibr" rid="bib26">Momeni et al. (2013)</xref> concerns heterotypic cooperation—which is not directly represented in our model—we present a new argument that heterotypic cooperation in space also entails a kind of second-order homotypic cooperation, so that results from models like ours can also shed light on heterotypic cooperation, as investigated by <xref ref-type="bibr" rid="bib26">Momeni et al. (2013)</xref>.</p><p><italic>B) Avoid confusion about the use of the term “Bethe Lattice”. A reviewer provided the following commentary/suggestions</italic>:</p><p><italic>“In order to avoid later confusion I suggest substituting the expression “Bethe lattice” or “locally Cayley tree structure” for “Cayley tree” through the whole text. For finite Cayley trees a relevant portion of the nodes are located on the periphery where each node has only one neighbor. This is the reason why the behavior of the Ising model on the Cayley tree is similar to those observed on the one-dimensional chain (no magnetic ordering at finite temperatures). On the contrary, the Ising model on Bethe lattice exhibits a mean-field type order-disorder phase transition (when increasing the temperature) that can be described exactly by several methods, e.g., by the cavity method or pair approximation [for details see the review by Dorogovtsev et al., Rev. Mod. Phys. 80 (2008) 1275-1335]. The concept of Bethe lattice neglects the effects of periphery and involves equivalence between the nodes, as it is assumed in the present work, too.</italic>”</p><p>We apologize for this confusion. We now use the term Bethe lattice throughout.</p></body></sub-article></article>