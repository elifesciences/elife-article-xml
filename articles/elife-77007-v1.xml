<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">77007</article-id><article-id pub-id-type="doi">10.7554/eLife.77007</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Stem Cells and Regenerative Medicine</subject></subj-group></article-categories><title-group><article-title>Robotic search for optimal cell culture in regenerative medicine</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-266738"><name><surname>Kanda</surname><given-names>Genki N</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6372-241X</contrib-id><email>genki.kanda@riken.jp</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-268072"><name><surname>Tsuzuki</surname><given-names>Taku</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-276915"><name><surname>Terada</surname><given-names>Motoki</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf3"/></contrib><contrib contrib-type="author" id="author-276916"><name><surname>Sakai</surname><given-names>Noriko</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf3"/></contrib><contrib contrib-type="author" id="author-269453"><name><surname>Motozawa</surname><given-names>Naohiro</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf4"/></contrib><contrib contrib-type="author" id="author-276917"><name><surname>Masuda</surname><given-names>Tomohiro</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf3"/></contrib><contrib contrib-type="author" id="author-276918"><name><surname>Nishida</surname><given-names>Mitsuhiro</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf3"/></contrib><contrib contrib-type="author" id="author-268078"><name><surname>Watanabe</surname><given-names>Chihaya T</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-268079"><name><surname>Higashi</surname><given-names>Tatsuki</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-268080"><name><surname>Horiguchi</surname><given-names>Shuhei A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8459-1914</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-268081"><name><surname>Kudo</surname><given-names>Taku</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf5"/></contrib><contrib contrib-type="author" id="author-268082"><name><surname>Kamei</surname><given-names>Motohisa</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con12"/><xref ref-type="fn" rid="conf5"/></contrib><contrib contrib-type="author" id="author-120081"><name><surname>Sunagawa</surname><given-names>Genshiro A</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con13"/><xref ref-type="fn" rid="conf6"/></contrib><contrib contrib-type="author" id="author-268083"><name><surname>Matsukuma</surname><given-names>Kenji</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con14"/><xref ref-type="fn" rid="conf7"/></contrib><contrib contrib-type="author" id="author-268084"><name><surname>Sakurada</surname><given-names>Takeshi</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con15"/><xref ref-type="fn" rid="conf8"/></contrib><contrib contrib-type="author" corresp="yes" id="author-268085"><name><surname>Ozawa</surname><given-names>Yosuke</given-names></name><email>ozawaysk@epistra.jp</email><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con16"/><xref ref-type="fn" rid="conf8"/></contrib><contrib contrib-type="author" id="author-276919"><name><surname>Takahashi</surname><given-names>Masayo</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con17"/><xref ref-type="fn" rid="conf9"/></contrib><contrib contrib-type="author" corresp="yes" id="author-268087"><name><surname>Takahashi</surname><given-names>Koichi</given-names></name><email>ktakahashi@riken.jp</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="aff" rid="aff9">9</xref><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con18"/><xref ref-type="fn" rid="conf10"/></contrib><contrib contrib-type="author" corresp="yes" id="author-268088"><name><surname>Natsume</surname><given-names>Tohru</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1510-2582</contrib-id><email>t-natsume@aist.go.jp</email><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff10">10</xref><xref ref-type="fn" rid="con19"/><xref ref-type="fn" rid="conf7"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/023rffy11</institution-id><institution>Laboratory for Retinal Regeneration, RIKEN Center for Biosystems Dynamics Research</institution></institution-wrap><addr-line><named-content content-type="city">Kobe</named-content></addr-line><country>Japan</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/023rffy11</institution-id><institution>Laboratory for Biologically Inspired Computing, RIKEN Center for Biosystems Dynamics Research</institution></institution-wrap><addr-line><named-content content-type="city">Osaka</named-content></addr-line><country>Japan</country></aff><aff id="aff3"><label>3</label><institution>Robotic Biology Institute Inc.</institution><addr-line><named-content content-type="city">Tokyo</named-content></addr-line><country>Japan</country></aff><aff id="aff4"><label>4</label><institution>Epistra Inc.</institution><addr-line><named-content content-type="city">Tokyo</named-content></addr-line><country>Japan</country></aff><aff id="aff5"><label>5</label><institution>VCCT Inc.</institution><addr-line><named-content content-type="city">Kobe</named-content></addr-line><country>Japan</country></aff><aff id="aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/023rffy11</institution-id><institution>Laboratory for Molecular Biology of Aging, RIKEN Center for Biosystems Dynamics Research</institution></institution-wrap><addr-line><named-content content-type="city">Kobe</named-content></addr-line><country>Japan</country></aff><aff id="aff7"><label>7</label><institution>Vision Care Inc.</institution><addr-line><named-content content-type="city">Kobe</named-content></addr-line><country>Japan</country></aff><aff id="aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02kn6nx58</institution-id><institution>Graduate School of Media and Governance, Keio University</institution></institution-wrap><addr-line><named-content content-type="city">Fujisawa</named-content></addr-line><country>Japan</country></aff><aff id="aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/035t8zc32</institution-id><institution>Graduate School of Frontier Biosciences, Osaka University</institution></institution-wrap><addr-line><named-content content-type="city">Suita</named-content></addr-line><country>Japan</country></aff><aff id="aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01703db54</institution-id><institution>Department of Life Science and Biotechnology, Cellular and Molecular Biotechnology Research Institute, National Institute of Advanced Industrial Science and Technology</institution></institution-wrap><addr-line><named-content content-type="city">Tokyo</named-content></addr-line><country>Japan</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Méndez-Ferrer</surname><given-names>Simón</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Zaidi</surname><given-names>Mone</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04a9tmd77</institution-id><institution>Icahn School of Medicine at Mount Sinai</institution></institution-wrap><addr-line><named-content content-type="city">Mount Sinai</named-content></addr-line><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>28</day><month>06</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e77007</elocation-id><history><date date-type="received" iso-8601-date="2022-01-12"><day>12</day><month>01</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2022-05-17"><day>17</day><month>05</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2020-11-27"><day>27</day><month>11</month><year>2020</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2020.11.25.392936"/></event></pub-history><permissions><copyright-statement>© 2022, Kanda, Tsuzuki et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Kanda, Tsuzuki et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-77007-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-77007-figures-v1.pdf"/><related-article related-article-type="commentary" ext-link-type="doi" xlink:href="10.7554/elife.80609" id="ra1"/><abstract><p>Induced differentiation is one of the most experience- and skill-dependent experimental processes in regenerative medicine, and establishing optimal conditions often takes years. We developed a robotic AI system with a batch Bayesian optimization algorithm that autonomously induces the differentiation of induced pluripotent stem cell-derived retinal pigment epithelial (iPSC-RPE) cells. From 200 million possible parameter combinations, the system performed cell culture in 143 different conditions in 111 days, resulting in 88% better iPSC-RPE production than that obtained by the pre-optimized culture in terms of the pigmentation scores. Our work demonstrates that the use of autonomous robotic AI systems drastically accelerates systematic and unbiased exploration of experimental search space, suggesting immense use in medicine and research.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>laboratory automation</kwd><kwd>LabDroid</kwd><kwd>bayesian optimization</kwd><kwd>regenerative medicine</kwd><kwd>iPS cell</kwd><kwd>retinal pigment epithelium</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100009619</institution-id><institution>Japan Agency for Medical Research and Development</institution></institution-wrap></funding-source><award-id>JP20bm0204002</award-id><principal-award-recipient><name><surname>Takahashi</surname><given-names>Masayo</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003051</institution-id><institution>New Energy and Industrial Technology Development Organization</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Takahashi</surname><given-names>Masayo</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002241</institution-id><institution>Japan Science and Technology Agency</institution></institution-wrap></funding-source><award-id>JPMJMI18G4</award-id><principal-award-recipient><name><surname>Takahashi</surname><given-names>Koichi</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002241</institution-id><institution>Japan Science and Technology Agency</institution></institution-wrap></funding-source><award-id>JPMJMI20G7</award-id><principal-award-recipient><name><surname>Takahashi</surname><given-names>Koichi</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100006264</institution-id><institution>RIKEN</institution></institution-wrap></funding-source><award-id>Engineering Network</award-id><principal-award-recipient><name><surname>Takahashi</surname><given-names>Masayo</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100006264</institution-id><institution>RIKEN</institution></institution-wrap></funding-source><award-id>Junior Research Associate Program</award-id><principal-award-recipient><name><surname>Motozawa</surname><given-names>Naohiro</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Robotic AI system automated discovery of optimum cell culture protocol, a most experience-dependent process in regenerative medicine.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Automating scientific discovery is one of the grandest challenges of the 21st century (<xref ref-type="bibr" rid="bib17">Kitano, 2021</xref>; <xref ref-type="bibr" rid="bib16">Kitano, 2016</xref>). A promising approach involves creating a closed loop of computation and experimentation by combining AI and robotics (<xref ref-type="bibr" rid="bib12">King et al., 2009</xref>). A relatively simple form of autonomous knowledge discovery involves searching for optimal experimental procedures and parameter sets through repeated experimentation and result validation, according to a predefined validation method. For example, in material science, the parameters associated with the growth of carbon nanotubes have been explored using an autonomous closed-loop learning system (<xref ref-type="bibr" rid="bib24">Nikolaev et al., 2016</xref>). In experimental physics, Bayesian optimization has been used to identify the optimal evaporation ramp conditions for Bose–Einstein condensate production (<xref ref-type="bibr" rid="bib37">Wigley et al., 2016</xref>). In 2019, a promoter-combination search in molecular biology was automated using an optimization algorithm-driven robotic system (<xref ref-type="bibr" rid="bib7">HamediRad et al., 2019</xref>). Some robotic systems for cell culture have already been developed (<xref ref-type="bibr" rid="bib2">dos Santos et al., 2013</xref>; <xref ref-type="bibr" rid="bib13">Kino-Oka et al., 2009</xref>; <xref ref-type="bibr" rid="bib18">Konagaya et al., 2015</xref>; <xref ref-type="bibr" rid="bib20">Liu et al., 2010</xref>; <xref ref-type="bibr" rid="bib22">Matsumoto et al., 2019</xref>; <xref ref-type="bibr" rid="bib25">Nishimura et al., 2019</xref>; <xref ref-type="bibr" rid="bib26">Ochiai et al., 2021</xref>; <xref ref-type="bibr" rid="bib32">Soares et al., 2014</xref>; <xref ref-type="bibr" rid="bib33">Thomas et al., 2008</xref>); however, many of these fixed-process automation apparatuses lack the flexibility and precision necessary to execute comprehensive parameter searching.</p><p>Here, we report the development of a robotic search system that autonomously and efficiently searches for the optimal conditions for inducing iPS cell differentiation into retinal pigment epithelial (RPE) cells (iPSC-RPE cells). The system replaces the manual operations involved in cell culture with robotic arms. Cell culture is probably one of the most delicate procedures in two respects. First, the parameters related to physical manipulation can greatly affect the outcome of the experiment (<xref ref-type="bibr" rid="bib10">Kanie et al., 2019</xref>). Secondly, it takes a long time to execute a series of protocols. For example, cells artificially differentiated from embryonic stem cells or induced pluripotent stem cells (ES/iPS cells) need to be processed using hundreds of experimental procedures that typically last for weeks or months before they can be used for transplantation in regenerative medicine.</p><p>During these processes, cells are given chemical perturbations (e.g. type, dose, and timing of reagents) and physical perturbations (e.g. strength of pipetting, vibration during handling of plates, timing of transfer from/to CO<sub>2</sub> incubator, and accompanying changes in factors such as temperature, humidity, and CO<sub>2</sub> concentration). Due to the heterogeneous and complex internal states of cells, suitable culture conditions must be determined for each strain and/or lot (<xref ref-type="bibr" rid="bib15">Kino-Oka and Sakai, 2019</xref>). A small difference in a single chemical stimulus or physical procedure can lead to failure of differentiation or poor quality of the produced cells, and such consequences can often become experimentally detectable only days or weeks after the input is given (<xref ref-type="bibr" rid="bib14">Kino-oka et al., 2019</xref>). Therefore, the use of robotic arms is a great addition in the search for optimal cell culture conditions because robots can repeatedly perform the same operation with high precision. Moreover, they hardly make any errors, which are logged when committed.</p><p>It is advantageous to utilize high-accuracy and programmable robotic arms for the search of optimal cell culture parameters. Unlike human hands, robotic arms can repeatedly perform the same procedure. They ensure reproducibility by keeping all parameters related to physical procedures constant. Furthermore, the actual operations are logged by the software along with sensor information when they are deviated from the established programs. Thus, robotization provides an ideal parameterization of experimental procedures. Some automated cell culture machines have already been proposed (<xref ref-type="bibr" rid="bib30">Regent et al., 2019</xref>); however, proper formulation of an autonomous search for optimal culture conditions has not yet been determined.</p><p>In this study, we combined a Maholo LabDroid (<xref ref-type="bibr" rid="bib38">Yachie et al., 2017</xref>) and an AI system that independently evaluates the experimental results and plans the next experiments to realize an autonomous robotic search for optimal culture conditions. We first created a digital representation of the regenerative medical cell culture protocol used for iPS cell differentiation into retinal pigment epithelial (RPE) cells (iPSC-RPE cells) (<xref ref-type="bibr" rid="bib21">Mandai et al., 2017</xref>), which can be executed by the robot and used as a template for an AI-driven parameter search (<xref ref-type="video" rid="fig2video1">Figure 2—video 1</xref>). We then implemented the experimental protocol on a LabDroid, which is a versatile humanoid robot that can perform a broad range of experimental procedures. Its flexibility allows frequent changes in protocols and protocol parameters, making it suitable for use in experimental parameter searches. The robot has an integrated microscope that provides data for image-processing through AI, which evaluates the quality of growing cells. The search process was mathematically formulated as a type of experimental design problem, and a batch Bayesian optimization (BBO; <xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>) technique was employed as a solver. Finally, we demonstrated that iPSC-RPE cells generated by LabDroid satisfy the cell biological criteria for regenerative medicine research applications.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Robotic search for optimal experimental conditions.</title><p>(<bold>A</bold>) Overall workflow for the optimization of experimental procedures using combined experimental robotics and Bayesian optimization. The user defines the target experimental protocol, subject parameters of the protocol, and the validation function. In this study, we chose the differentiation procedure from iPS to RPE cells as a target protocol and selected the reagent concentration, administration period, and five other parameters (details are shown in <xref ref-type="table" rid="table1">Table 1</xref>). We defined the pigmented area in a culture well, which represents the degree of RPE differentiation induction, as the validation function. The optimization program presented multiple parameter candidates; the LabDroid performed the experiment, and then an evaluation value for each candidate was obtained. Subsequently, the Bayesian optimization presented a plurality of parameter candidates predicted to produce higher validation values. The optimal parameters were searched by repeating candidate presentation, experiment execution, validation, and prediction. The detailed components are shown in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>. (<bold>B</bold>) Workflows performed in this study. First, robotization of the iPSC-RPE protocol was performed as a baseline. Next, the optimization process was conducted in three rounds, followed by statistical and biological validation. The figure numbers in parentheses represent the results shown in the figure.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Schematic diagram of iPSC-RPE transplantation.</title><p>(<bold>A</bold>) Schematic diagram of the process from iPSC stock to iPSC-derived RPE cell transplantation. The steps are roughly divided into iPSC culture, iPSC-RPE differentiation, purification, storage, recovery culture, and surgery. Arrows indicate daily operations, and thick gray lines indicate multi-day operations. (<bold>B</bold>) Timeline of the baseline and optimization and validation experiments. The baseline and optimization experiments were completed with scoring. The validation experiments, however, were performed by generating an iPSC-RPE stock through a purification process and carrying out a cell biological analysis. The arrows represent the figure number in which the result from that process is displayed.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>System components.</title><p>The system platform. The robotic search using this system starts with the provision of queries for round 1 from the optimizer to the protocol compiler and the provision of the base protocol from the user to the protocol compiler. Each rectangle represents a system component. Solid lines represent the movement of data (including cells), and dotted lines represent physical interactions.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig1-figsupp2-v1.tif"/></fig></fig-group></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Robotization of the iPSC-RPE differentiation protocol</title><p>An overview of the iPSC-RPE differentiation protocol used for optimization is shown in <xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. It consists of five steps: seeding, preconditioning, passage, RPE differentiation (induction), and RPE maintenance culture. The day on which the passage was performed was defined as differentiation day (DDay) 0, and the cultured cells were sampled and validated on DDays 33 and 34. To implement this protocol using LabDroid, the necessary peripheral devices were installed on and around LabDroid’s workbench (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). We designed the system to work simultaneously with eight 6-well plates per batch, for a total of 48 cell-containing wells. LabDroid was programmed for three types of operations: seeding, medium exchange, and passage (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplements 2</xref>–<xref ref-type="fig" rid="fig2s7">7</xref>; <xref ref-type="supplementary-material" rid="fig2sdata3">Figure 2—source data 3</xref>; <xref ref-type="video" rid="fig2video1">Figure 2—video 1</xref>). The steps for the preconditioning and induction, which correspond to the preparation of reagents, were named medium exchange type I, and the step for RPE maintenance culture, which does not involve reagent preparation, was named medium exchange type II (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Robotization of iPSC-RPE differentiation protocols.</title><p>(<bold>A</bold>) Schematic diagram of the standard iPSC-RPE differentiation procedures. DDay indicates the differentiation day. Filled circles represent days when the robot operated, solid circles represent days with human operations only, and dashed line circles represent days when no operations were conducted. F stands for FGF receptor inhibitor; Y for Y-27632, a Rho-kinase inhibitor; SB for SB431542, a TGF-β/Activin/Nodal signal inhibitor; CKI for a CKI-7, Wnt signal inhibitor; and MX for medium exchange. (<bold>B</bold>) The LabDroid Maholo including peripheral equipment. (<bold>C</bold>) Plate numbering and the orders of seeding, passage, and medium exchange operations. Eight 6-well plates were used for each experiment. (<bold>D</bold>) Well numbering. (<bold>E</bold>) Scores of the first trial. iPSC-RPE differentiation was conducted under six different trypsin treatment times using the LabDroid. Yellow bars represent the pigmented cell area score of each well. The bold black lines and the shaded area around the lines represent the mean score and SEM of eight samples operated at the same trypsin time, respectively. The raw values are shown in <xref ref-type="supplementary-material" rid="fig2sdata2">Figure 2—source data 2</xref>.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Acquired pigmented images of the baseline experiment.</title><p>Images acquired on Day 34 of the baseline experiment; images of the bottom of the well with cultured cells, cropped to the size of the well. These 8-bit images were adjusted to a minimum and maximum contrast value of 100 and 150, respectively. IDs on the bottom indicate 'B (baseline) - Plate No. - Well No.'.</p></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-77007-fig2-data1-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig2sdata2"><label>Figure 2—source data 2.</label><caption><title>Executed parameters and scores of the baseline experiment.</title><p>Related to <xref ref-type="fig" rid="fig2">Figure 2E</xref>. Raw values of the parameter candidates and pigmentation scores in the baseline experiment. *KSR concentration was lowered in a systematic fashion, unlike the <italic>KP</italic> parameter. Specific values: DDays 1–3, 20% KSR; DDays 4–7, 15% KSR; from DDay 8, 10% KSR.</p></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-77007-fig2-data2-v1.xlsx"/></supplementary-material></p><p><supplementary-material id="fig2sdata3"><label>Figure 2—source data 3.</label><caption><title>Pipetting volume and pipette combination.</title><p>Related to <xref ref-type="fig" rid="fig2">Figure 2</xref>. Given the limitations of the LabDroid, setting the micropipette to an arbitrary volume was difficult. Therefore, we pseudo-implemented a fine volume setting for the transfer of 0–1000 µL by combining nine micropipettes with pre-set volumes (3000, 1000, 450, 300, 200, 80, 30, 10, and 5 µL). The number of combinations was limited to three or fewer. The numbers in the table indicate the micropipettes and the number of times they had to be used to achieve the desired volumes. For example, 260 µL indicates that the 200 and 30 µL micropipettes had to be used once and twice, respectively.</p></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-77007-fig2-data3-v1.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>LabDroid Maholo booth.</title><p>(<bold>A</bold>) Exterior photograph of the LabDroid booth. The LabDroid consists of an acrylic box of W2500 x D2000 x H2200 (mm). (<bold>B</bold>) Plan view of the LabDroid booth (3D-CAD) and layout of the equipment. (<bold>C–D</bold>) Front view photograph of the LabDroid booth and schematic drawing of the equipment (these panels are identical to those in <xref ref-type="fig" rid="fig2">Figure 2B</xref>). (<bold>E</bold>) Top view photograph of the LabDroid booth. (<bold>F</bold>) A back view photograph of the LabDroid booth. Components: (1) dual-arm humanoid; (2) CO<sub>2</sub> incubator; (3) micropipettes; (4) pipette tips; (5) tip sensor; (6) dustbin; (7) aspirator; (8) tube racks; (9) plate racks; (10) dry bath; and (11) microscope.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Workflows of the experimental operation.</title><p>(<bold>A</bold>) Seeding (DDay −7). (<bold>B</bold>) Medium exchange type I for preconditioning (DDays −6 to −1) and the first part of RPE induction (DDays 1–19). (<bold>C</bold>) Medium exchange type II for the second part of RPE induction (DDays 20–25), and RPE maintenance (DDays 26–32). (<bold>D</bold>) Passage (DDay 0). The dashed line rectangles represent the operations carried out by humans, and solid line rectangles represent the operations carried out by the robot.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Representative LabDroid execution of a seeding experiment (round 3, DDay −7).</title><p>(<bold>A</bold>) Entire image. (<bold>B</bold>) Enlarged image of the dotted rectangle from panel (<bold>A</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Representative LabDroid execution of a preconditioning experiment (round 3, DDay −6, 1st run).</title><p>(<bold>A</bold>) Entire image. (<bold>B</bold>) Enlarged image of the dotted rectangle from panel (<bold>A</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig2-figsupp4-v1.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Representative LabDroid execution of a passage experiment (round 3, DDay 0, 1st run).</title><p>(<bold>A</bold>) Entire image. (<bold>B</bold>) Enlarged image of the dotted rectangle from panel (<bold>A</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig2-figsupp5-v1.tif"/></fig><fig id="fig2s6" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 6.</label><caption><title>Representative LabDroid execution of an RPE differentiation experiment (round 3, DDay 10, 1st run).</title><p>(<bold>A</bold>) Entire image. (<bold>B</bold>) Enlarged image of the dotted rectangle from panel (<bold>A</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig2-figsupp6-v1.tif"/></fig><fig id="fig2s7" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 7.</label><caption><title>Representative LabDroid execution of an RPE maintenance experiment (round 3, DDay 32, 1st run).</title><p>(<bold>A</bold>) Entire image. (<bold>B</bold>) Enlarged image of the dotted rectangle from panel (<bold>A</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig2-figsupp7-v1.tif"/></fig><fig id="fig2s8" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 8.</label><caption><title>Image processing to calculate the pigmentation scores.</title><p>(<bold>A–C</bold>) The 6-well plates were placed on top of a white LED lighting plate and photographed with a camera fixed to the mount (<bold>A</bold>). The raw images acquired (<bold>B</bold>) were cropped in a circle to the size of the bottom of the well (<bold>C</bold>). (<bold>D</bold>) Workflow of image processing performed using ImageJ/Fiji macro. The background was removed in steps 1–3, binarization in step 4, and noise in steps 5 and 6. Since it is empirically known that differentiation-inducing cells are less likely to grow near the sides of the wells, only the central portion was cropped (step 7) and the scores were subsequently calculated. (<bold>E–J</bold>) Examples of processed images. The images shown are samples from well 1 of plate 1 in the baseline experiment. Images after Gaussian blur (<bold>E</bold>), background subtraction (<bold>F</bold>), sharpening (<bold>G</bold>), binarization by thresholding (<bold>H</bold>), mathematical morphology processing (<bold>I</bold>), crop, and clear outside (<bold>J</bold>) processing. The orange circle in panel (<bold>I</bold>) represents the crop area in step 7. The pigmentation score was calculated as the area of the black region in panel (<bold>J</bold>). (<bold>K</bold>) Merged image of the image before processing (corresponding to panel <bold>C</bold>) and the area determined to be pigmented (corresponding to panel (<bold>J</bold>), red frame). All images shown in this figure have been contrast-optimized to facilitate the visualization of the examples, but the actual values were used when processing the images for quantification.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig2-figsupp8-v1.tif"/></fig><media mimetype="video" mime-subtype="mp4" xlink:href="elife-77007-fig2-video1.mp4" id="fig2video1"><label>Figure 2—video 1.</label><caption><title>Representative LabDroid movements.</title><p>Example of LabDroid movements extracted from actual cell culture operation: handling of a 50 mL tube, aspirator, micropipette, microscope, and CO<sub>2</sub> incubator. The speed factor was 100%.</p></caption></media></fig-group><p>First, we used LabDroid to perform baseline experiments involving the induction of iPSC-RPE cell differentiation under the same conditions as the typical manual operations. Because of the differences in structure and experimental environment between the LabDroid and humans, some operations and movements, such as the use of a centrifuge, the presence or absence of cell counting at the time of passage, and the speed of movement, differed from those of humans. For example, achieving the same time interval for trypsin treatment in all wells of a single plate during cell detachment using LabDroid is difficult. Therefore, the passage operation was performed at six separate time intervals. The cells differentiating into RPE cells produce melanin, which causes them to turn brown. Therefore, the area ratio of the total number of pigmented cells on DDay 34 was used to estimate the differentiation induction efficiency and obtain evaluation scores, following the example of previous studies (<xref ref-type="bibr" rid="bib19">Kuroda et al., 2019</xref>; <xref ref-type="bibr" rid="bib30">Regent et al., 2019</xref>; <xref ref-type="fig" rid="fig2s8">Figure 2—figure supplement 8</xref>). These validation scores were used to simplify the validation process and do not reflect the entire quality of the RPE.</p><p>Baseline experiments were conducted and validated using six trypsin conditions and eight plates (<xref ref-type="fig" rid="fig2">Figure 2C–E</xref>; <xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref> and <xref ref-type="supplementary-material" rid="fig2sdata2">Figure 2—source data 2</xref>). The highest scoring was obtained when trypsin treatment was conducted for 20 min at 37 °C, followed by 14 min incubation at room temperature (RT, approximately 25 °C), with an eight-plate score of 0.44±0.03 (mean ± SEM, n=8). The lowest scoring was obtained when trypsin treatment was conducted for 20 min at 37 °C, followed by 23 min at RT, with an eight-plate score of 0.33±0.02 (mean ± SEM, n=8). LabDroid successfully performed the iPSC-RPE protocol, as evidenced by the detection of pigmented cells in all 48 wells and the lack of errors in the operating process. However, in the naive transplantation of the manual protocol to the robot, the induction efficiency was insufficient. This suggests that it is inherently difficult to describe physical parameters, including unrecorded human movements. Therefore, we attempted to optimize the protocol parameters to further improve the scores using a robotic search.</p></sec><sec id="s2-2"><title>Parameterization of the protocol</title><p>To improve the pigmentation score, we selected seven parameters for optimization: two from the preconditioning step, three from the passage step, and two from the induction step. Search domains were set for each parameter (<xref ref-type="table" rid="table1">Table 1</xref>; <xref ref-type="fig" rid="fig3">Figure 3A and B</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Optimization module.</title><p>(<bold>A</bold>) Definition of the target parameters and corresponding steps in the protocol: <italic>PC</italic>, preconditioning concentration; <italic>PP</italic>, preconditioning period; <italic>DP</italic>, detachment trypsin period; <italic>DS</italic>, detachment pipetting strength; <italic>DL</italic>, detachment pipetting length; <italic>KP</italic>, KSR concentration reducing period; and <italic>3P</italic>, three chemical (Y, SB, CKI) supplement administration period. (<bold>B</bold>) Ranges and stepping of the parameters. (<bold>C</bold>) The Bayesian optimization module consists of two components: a Model updater and a Query generator. The Model updater updates the Gaussian process posterior on the experiment using all available data <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, where x indicates experimental parameter, and y indicates corresponding evaluation score. The Query generator calculates the acquisition function <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for an experiment parameter <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> with the posterior distribution <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, and generates the experiment parameter set <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for the next 48 points using the policy function with <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>D and E</bold>) Test of the query generation process using a two-dimensional toy acquisition function. (<bold>D</bold>) Values of the toy acquisition function given an experimental parameter set. The horizontal axis represents the input values of <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (contextual parameter), whereas the vertical axis represents the input values of the other six remaining context-free parameters <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">3</mml:mtext></mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, which are collapsed into a single axis. The color of the heatmap indicates the value of the acquisition function. In the heat map, the acquisition value is higher in places where the color is closer to red and lower in places where the color is closer to blue. (<bold>E</bold>) Test of the query generation process for the experimental parameter set <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in the next experiment using a batch contextual local penalization policy (BCLP). The heat maps in the upper row show the (penalized) acquisition function values, and the lower row shows the penalization values for the acquisition function. The queries <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for 48 wells (right side figure) were iteratively generated from the maximization-penalization loop on the acquisition function.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Demonstration of how Gaussian process regression updates a Bayesian posterior.</title><p>Test of a Bayesian posterior updated in a Gaussian process (GP). (<bold>A</bold>) Sample paths from the zero-mean GP prior. (<bold>B</bold>) Sample paths from the GP posterior after executing some experiments (indicated by black dots). The gray shaded area represents the pointwise mean plus and minus twice the standard deviation for each input value.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Demonstration of Bayesian optimization generation of experimental parameters.</title><p>Sequential Bayesian optimization was tested by determining the maximum of a one-dimensional toy objective function. This figure illustrates the Bayesian optimization procedure over several iterations. The objective function is indicated by a purple dashed curve on the left side of each plot. The past experimental results are indicated by dots, and the newest experimental results are indicated by white dots. The GP posterior mean function is indicated by a black line, and covariance intervals are indicated by purple shaded areas. The plots on the right side show the acquisition functions in the orange curves. The value of the acquisition function is high where the model predicts a high objective (exploitation) and where the prediction uncertainty is high (exploration). The black vertical dashed lines show the place of acquisition max, a factor of importance to be tested in a subsequent experiment.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig3-figsupp2-v1.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Toy testing function based on domain knowledge.</title><p>An approximate prediction of how much the value of each variable affects the score based on domain knowledge before performing a series of optimizations. The toy testing function was simply multiplied by the predicted function for each of the variables below, <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (<bold>A</bold>) Prediction of preconditioning (FGFRi) concentration (<italic>PC</italic>) response. It increased from 0 nM, reached a maximum at 100 nM, decreased after 100 nM, and approached 0.5. (<bold>B</bold>) Prediction of the preconditioning period (<italic>PP</italic>) response: on Day 1 it was 0, it increased monotonically thereafter, and reached a maximum value on Day 6. (<bold>C</bold>) Prediction of the detachment trypsin period (<italic>DP</italic>) response: an optimal value between 13 and 20 min was expected. (<bold>D</bold>) Prediction of the detachment pipetting strength (<italic>DS</italic>) response: it achieved a maximum value at 10 mm/s and then decreased monotonically. Although an important parameter, the detachment pipetting length (<italic>DL</italic>) is always assumed to be 1 because of the difficulty of prediction. (<bold>E</bold>) Prediction of the KSR period (<italic>KP</italic>) response: it was expected to increase monotonically until Day 8, and to be stationary thereafter. (<bold>F</bold>) Prediction of the three-supplement period (<italic>3P</italic>) response: it was expected to take a non-zero value and increase monotonically from around Day 3 onwards.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig3-figsupp3-v1.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 4.</label><caption><title>Preliminary testing of the Bayesian optimization under different conditions.</title><p>The vertical axis shows the value, and the horizontal axis shows the number of circles. The blue horizontal line represents the ground truth (optimal value). In each series, three experiments were conducted independently, and the score of the query with the highest evaluation score in the true function among the queries that had appeared in a certain round was plotted. The error bars represent the standard error (SEM) in each round. (<bold>A</bold>) The red series shows the results of batch Bayesian optimization (BCLP) with no observation noise. The yellow series shows the results of BCLP with a Gaussian noise SD=0.064. The green series shows the BCLP results with a high Gaussian noise SD=0.4. The black series represents the results of random sampling. Compared to random sampling, Bayesian optimization improved the convergence performance and converged to the optimal solution when the observation noise was sufficiently small. Black, random; green, BCLP (SD=0.4); orange, BCLP (SD=0.064); red, BCLP (SD=0). The shaded area represents the SEM image. (<bold>B</bold>) Comparison of BCLP performance when the batch size was changed. For the benchmark function (noise SD=0.064), optimization was performed using a different number of plates (Np) per round. The blue series represents Np=2, the green series represents Np=4, the orange series represents Np=8, and the red series represents Np=16. As the number of plates (the batch size) increased, batch Bayesian optimization tended to converge to an optimal solution with fewer rounds. Blue, Np=2; green, Np=4; orange, Np=8; red, Np=16. The shaded area represents the SEM image.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig3-figsupp4-v1.tif"/></fig></fig-group><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Definition of optimized parameters.</title><p>Parameter names, parameter name codes, description, parameter ranges, parameter units, correspondence between experimental procedure and parameters used (related to <xref ref-type="fig" rid="fig2">Figures 2A</xref>, <xref ref-type="fig" rid="fig3">3A and B</xref>).</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Parameter name</th><th align="left" valign="bottom">Code</th><th align="left" valign="bottom">Description</th><th align="left" valign="bottom">Range</th><th align="left" valign="bottom">Unit</th><th align="left" valign="bottom">Protocol step</th></tr></thead><tbody><tr><td align="left" valign="bottom">Preconditioning concentration</td><td align="left" valign="bottom"><italic>PC</italic></td><td align="left" valign="bottom">FGFRi concentration in medium</td><td align="left" valign="bottom">0–505</td><td align="left" valign="bottom">nM</td><td align="left" valign="bottom">Preconditioning</td></tr><tr><td align="left" valign="bottom">Preconditioning period</td><td align="left" valign="bottom"><italic>PP</italic></td><td align="left" valign="bottom">FGFRi duration in medium</td><td align="left" valign="bottom">1–6</td><td align="left" valign="bottom">day</td><td align="left" valign="bottom">Preconditioning</td></tr><tr><td align="left" valign="bottom">Detachment trypsin period</td><td align="left" valign="bottom"><italic>DP</italic></td><td align="left" valign="bottom">Trypsin incubation duration at room temperature after incubation at 37 °C, 20 min.</td><td align="left" valign="bottom">5, 8, 11, 14, 17, 20, 23</td><td align="left" valign="bottom">min</td><td align="left" valign="bottom">Passage</td></tr><tr><td align="left" valign="bottom">Detachment pipetting strength</td><td align="left" valign="bottom"><italic>DS</italic></td><td align="left" valign="bottom">Pipetting strength during cell detachment</td><td align="left" valign="bottom">10–100</td><td align="left" valign="bottom">mm/s</td><td align="left" valign="bottom">Passage</td></tr><tr><td align="left" valign="bottom">Detachment pipetting length</td><td align="left" valign="bottom"><italic>DL</italic></td><td align="left" valign="bottom">Bottom surface area to be pipetted</td><td align="left" valign="bottom">short / long</td><td align="left" valign="bottom">N/A</td><td align="left" valign="bottom">Passage</td></tr><tr><td align="left" valign="bottom">KSR period</td><td align="left" valign="bottom"><italic>KP</italic></td><td align="left" valign="bottom">KSR concentration and duration in medium:<break/>KSR concentration is decreased linearly every day so that KSR becomes 10% on DDday of KP value</td><td align="left" valign="bottom">1–19</td><td align="left" valign="bottom">day</td><td align="left" valign="bottom">RPE differentiation</td></tr><tr><td align="left" valign="bottom">Three supplements period</td><td align="char" char="." valign="bottom"><italic>3P</italic></td><td align="left" valign="bottom">Three chemical supplements duration</td><td align="left" valign="bottom">3–19</td><td align="left" valign="bottom">day</td><td align="left" valign="bottom">RPE differentiation</td></tr></tbody></table></table-wrap><p>From the preconditioning step on DDays −1 to −6, we selected two parameters for optimization: the concentration of fibroblast growth factor receptor inhibitor (FGFRi) in the medium (<italic>PC</italic>, preconditioning concentration), and the duration of addition (<italic>PP</italic>, preconditioning period). From the passage step performed on DDay 0, we selected three parameters to optimize: the pipetting strength during cell detachment (<italic>DS</italic>, detachment pipetting strength), the area of the bottom surface to be pipetted (<italic>DL</italic>, detachment pipetting length), and trypsin processing time (<italic>DP</italic>, detachment trypsin period) of a passage. <italic>DP</italic> is a contextual parameter that can only be used to perform experiments at fixed values, owing to the specifications of the experimental system. In this case, <italic>DP</italic> is allowed to take different fixed values at three-minute intervals, corresponding to the number of wells in the plate. From the induction step on DDays 1–25, we selected two parameters to optimize: the concentration of KnockOut Serum Replacement (KSR) in the medium (<italic>KP</italic>, KSR period), and the duration of exposure period of the three chemical supplements (<italic>3P</italic>, three supplement period).</p></sec><sec id="s2-3"><title>Optimization of the protocol</title><p>To improve the optimization performance, 48 conditions (eight plates × six wells, as shown in <xref ref-type="fig" rid="fig2">Figure 2C</xref>) were executed in parallel in each batch. The 48 conditions were selected from the search space using the Bayesian optimization module to maximize the acquisition function calculated from the past experimental data. In general, solving a high-dimensional, expensive black-box optimization problem such as the present one with a limited number of rounds is challenging. In our case, some 200 million possible parameter combinations existed in the search space, and the point where the pigmented score was optimal in three rounds (144 queries) had to be determined, because one experiment round took 40–45 days. In recent studies, BBO has shown excellent performance in real-world black-box optimization problems (<xref ref-type="bibr" rid="bib1">Burger et al., 2020</xref>; <xref ref-type="bibr" rid="bib4">Gongora et al., 2020</xref>; <xref ref-type="bibr" rid="bib7">HamediRad et al., 2019</xref>). We integrated an experimental design module based on BBO to effectively search for the optimal experimental parameters that maximize the pigmentation scores in the search space defined in <xref ref-type="fig" rid="fig3">Figure 3B</xref>.</p><p>The Bayesian optimization module generates queries using two components: the Model updater, which updates the surrogate model that captures the relationship between parameters and the scores using Bayesian inference (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>); the Query generator, which generates the next experimental parameters <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> using an acquisition function and a policy function (<xref ref-type="fig" rid="fig3">Figure 3C</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>; Algorithm 1–3). In the Query generator, the acquisition function estimates the expected progress toward the optimal experimental parameter at a given experimental parameter (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Then, using the acquisition function, the policy function generates the next 48 experimental parameters <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> considering the context of trypsin processing time <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3E</xref>).</p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Algorithm 1. Batch Bayesian Optimization for iPSC-RPE differentiation protocol.</th></tr></thead><tbody><tr><td align="left" valign="bottom">Input: The search space <inline-formula><mml:math id="inf15"><mml:mi>χ</mml:mi></mml:math></inline-formula>, GP prior <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, number of rounds <italic>M</italic>, number of Plates <italic>P</italic>, number of Wells <italic>W</italic>, Dataset<inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula><break/>for <italic>t=</italic>1 <italic>to M</italic> do<break/> 1. Construct GP posterior <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> using <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.<break/> 2. Get the acquisition function <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.<break/> 3. Generate a experiment parameter set <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> using the policy function.<break/> Execute the experiments <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> .<break/> Append the experiment results to past data <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>∪</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.<break/> 4. Compute optimal context <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> on Detatch trypsin Period in the next experiment.<break/>end</td></tr></tbody></table></table-wrap><table-wrap id="inlinetable2" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Algorithm 2. The policy function for the iPSC-RPE differentiation protocol.</th></tr></thead><tbody><tr><td align="left" valign="bottom">Input: The acquisition function <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, number of Plates <italic>P</italic>, number of Wells <italic>W</italic><break/>Output: The next experiment parameter set <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>1. Calculate utility functions from the acquisition function  <break/> <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>2. Generate next experiment parameters <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> in Maximization-Penalization loop <break/><break/>for <italic>P=</italic>1 <italic>to P</italic> do<break/>  for <italic>w=1 to W</italic> do<break/>   1. maximization-step: <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∈</mml:mo></mml:msub><mml:mi>χ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>   2. penalization-step: <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mi>φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/> end<break/>end</td></tr></tbody></table></table-wrap><table-wrap id="inlinetable3" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Algorithm 3. Detachment trypsin period adjustment on the iPSC-RPE differentiation protocol.</th></tr></thead><tbody><tr><td align="left" valign="bottom">Input: The acquisition function <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, current <italic>DP</italic> context <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, context shift width <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>Output: The next <italic>DP</italic> context <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>1. Candidates of <italic>DP</italic> context ranges for the next round. (In this study, <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 3 min)<break/><inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msubsup><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>c</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>c</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula><break/>2. Calculate values <inline-formula><mml:math id="inf37"><mml:mi>V</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf38"><mml:msup><mml:mi>V</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf39"><mml:msup><mml:mi>V</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula> that accumulate <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> on each context ranges <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/><inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msub><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>V</mml:mi><mml:mo>−</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msub><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>V</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msub><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>3. Calculate ratios <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> between each values defined above.<break/><inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mo>−</mml:mo></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>V</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>V</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>4. Choose the next <italic>DP</italic> context <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in following rules.<break/>if (<inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mn>1.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) then<break/> <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula><break/>end<break/>else if (<inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) then  <break/> <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula><break/>end<break/>else if (<inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo>≤</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) then<break/> <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula><break/>end</td></tr></tbody></table></table-wrap><p>To test the performance of the Bayesian optimization module in our case, we executed a preliminary performance validation using a toy testing function constructed on domain knowledge (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplements 3</xref> and <xref ref-type="fig" rid="fig3s4">4</xref>).</p></sec><sec id="s2-4"><title>Robotic optimization drastically improved the pigmentation score</title><p>In this study, three successive experiments were conducted to optimize the target protocol. In each round, 48 conditions were generated using the Bayesian optimization module and translated into LabDroid operating programs. The robot performed 40 days of iPSC-RPE induction culture under each condition, and we obtained the rate of pigmented cells in the dish as an evaluation score (pigmentation score) for each condition. In accordance with the experimental design, we incorporated the two highest-scoring conditions from the previous experiment (<xref ref-type="fig" rid="fig2">Figure 2E</xref>) as control conditions, performed differentiation-inducing cultures with the LabDroid, and validated the area of the colored cells. In round 1, although one condition was found to be experimentally deficient, the other 47 conditions were validated. The highest score was 0.86 (<xref ref-type="fig" rid="fig4">Figure 4A</xref>; <xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref>, <xref ref-type="supplementary-material" rid="fig4sdata4">Figure 4—source data 4</xref>), yielding five conditions that exceeded the mean value (0.39) for all wells in the baseline experiment (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). In round 2, 46 conditions were generated, and the two highest-scoring conditions in round 1 were incorporated as control conditions. The highest score was 0.83 (<xref ref-type="fig" rid="fig4">Figure 4B</xref>; <xref ref-type="supplementary-material" rid="fig4sdata2">Figure 4—source data 2</xref>, <xref ref-type="supplementary-material" rid="fig4sdata4">Figure 4—source data 4</xref>). In round 3, 48 experiments were conducted, yielding an improved highest score of 0.91. We obtained 26 other conditions that were better than the highest in round 2 (<xref ref-type="fig" rid="fig4">Figure 4C</xref>; <xref ref-type="supplementary-material" rid="fig4sdata3">Figure 4—source data 3</xref>, <xref ref-type="supplementary-material" rid="fig4sdata4">Figure 4—source data 4</xref>). A visualization diagram of a two-dimensional partial least squares regression (PLS) clearly revealed that the overall experimental parameters tended to converge in a higher pigmented score direction from rounds 1 to 3 (<xref ref-type="fig" rid="fig4">Figure 4D</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Robotic search for optimal parameters in iPSC-RPE differentiation.</title><p>(<bold>A–C</bold>) Parameter candidates sorted in order of the pigmentation score in optimization rounds 1 (<bold>A</bold>), 2 (<bold>B</bold>), and 3 (<bold>C</bold>). The ID label on the left represents 'Round No. - Plate No. - Well No.'. For example, ‘1-2-3’ means ‘(Round) 1-(Plate) 2-(Well) 3’. The parameter values and resulting pigmentation scores are plotted as horizontal bars. The parameter candidate with black frames (1-1-3) in (<bold>A</bold>) is the standard condition. Arrows indicate the control experiments; the top two conditions in round 1 were included in round 2, and the top two conditions in round 2 were implemented in round 3. The raw values are shown in <xref ref-type="supplementary-material" rid="fig4sdata4">Figure 4—source data 4</xref>. (<bold>D</bold>) Visualization of the parameter set and the pigmentation score distributions using partial least squares regression (PLS) in each round. The horizontal axis PC1 shows the values of the parameter candidates that are projected onto the first component of the PLS. The vertical axis shows the pigmentation score for each candidate parameter. As the rounds progressed, the overall score tended to converge in a higher direction. A full visualization of the experimental results using a parallel coordinate plot (PCP) is shown in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Acquired pigmented images of the round 1 experiment.</title><p>Images acquired on Day 34 of the round 1 experiment; images of the bottom of the well with cultured cells, cropped to the size of the well. These 8-bit images were adjusted to a minimum and maximum contrast value of 100 and 150, respectively. ID labeling on the bottom indicates '1 (round 1) - Plate No. - Well No.'.</p></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-77007-fig4-data1-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig4sdata2"><label>Figure 4—source data 2.</label><caption><title>Acquired pigmented images of the round 2 experiment.</title><p>Images acquired on Day 34 of the round 2 experiment; images of the bottom of the well with cultured cells, cropped to the size of the well. These 8-bit images were adjusted to a minimum and maximum contrast value of 100 and 150, respectively. ID labeling on the bottom indicates '2 (round 2) - Plate No. - Well No.'.</p></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-77007-fig4-data2-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig4sdata3"><label>Figure 4—source data 3.</label><caption><title>Acquired pigmented images of the round 3 experiment.</title><p>Images acquired on Day 34 of the round 3 experiment: images of the bottom of the well with cultured cells, cropped to the size of the well. These 8-bit images were adjusted to a minimum and maximum contrast value of 100 and 150, respectively. ID labeling on the bottom indicates '3 (round 3) - Plate No. - Well No.'.</p></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-77007-fig4-data3-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig4sdata4"><label>Figure 4—source data 4.</label><caption><title>Executed parameters and scores of the optimization experiments.</title><p>Related to <xref ref-type="fig" rid="fig4">Figure 4</xref>. Raw values of the parameter candidates and pigmentation scores in the experiments from rounds 1 to 3.</p></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-77007-fig4-data4-v1.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Parallel coordinate plot (PCP) of the robotic search experimental results.</title><p>The experimental results were visualized in rounds 1–3 using a parallel coordinate plot (PCP) and represented in 8-dimensional space (seven-dimensional parameters +pigmentation scores) as a colored line with vertices on the parallel axes; the position of the vertex on the i-th axis corresponds to the i-th coordinate of the parameter. The color of the line represents the pigmented score: blue lines represent lower pigmentation scores, and the closer to red, the higher the pigmented score.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig4-figsupp1-v1.tif"/></fig><media mimetype="video" mime-subtype="mp4" xlink:href="elife-77007-fig4-video1.mp4" id="fig4video1"><label>Figure 4—video 1.</label><caption><title>Seeding operation.</title><p>Video recording an example of a seeding operation (round 3, DDay −7). The speed factor was 6000%.</p></caption></media><media mimetype="video" mime-subtype="mp4" xlink:href="elife-77007-fig4-video2.mp4" id="fig4video2"><label>Figure 4—video 2.</label><caption><title>Preconditioning operation.</title><p>Video recording an example of a preconditioning operation (round 3, DDay −6, 1st run). The speed factor was 6000%.</p></caption></media><media mimetype="video" mime-subtype="mp4" xlink:href="elife-77007-fig4-video3.mp4" id="fig4video3"><label>Figure 4—video 3.</label><caption><title>Passaging operation.</title><p>Video recording an example of a passage operation (round 3, DDay 0, 1st run). The speed factor was 6000%.</p></caption></media><media mimetype="video" mime-subtype="mp4" xlink:href="elife-77007-fig4-video4.mp4" id="fig4video4"><label>Figure 4—video 4.</label><caption><title>RPE differentiation operation.</title><p>Video recording an example of an RPE differentiation operation (round 3, DDay 10, 1st run). The speed factor was 6000%.</p></caption></media><media mimetype="video" mime-subtype="mp4" xlink:href="elife-77007-fig4-video5.mp4" id="fig4video5"><label>Figure 4—video 5.</label><caption><title>RPE maintenance operation.</title><p>Video recording an example of an RPE maintenance operation (round 3, DDay 32, 1st run). The speed factor was 6000%.</p></caption></media></fig-group><p>To determine whether the optimized conditions were statistically improved over the pre-optimized conditions, an additional multi-well validation experiment was conducted after round 3 using the top five conditions in round 3 and the pre-optimized conditions. The validation values, ordered by place, were 0.71±0.06, 0.72±0.03, 0.76±0.02, 0.79±0.02, and 0.81±0.02 (mean ± SEM, n=3 each). All scores after optimization were statistically significantly higher than the pre-optimization scores (0.43±0.02; mean ± SEM, n=3) (<xref ref-type="fig" rid="fig5">Figure 5A and B</xref>; <xref ref-type="supplementary-material" rid="fig5sdata1">Figure 5—source data 1</xref>, <xref ref-type="supplementary-material" rid="fig5sdata2">Figure 5—source data 2</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Quality evaluation of robot-induced RPE cells.</title><p>(<bold>A</bold>) The pigmentation score evaluation of the pre-optimized conditions (n=3) and the top five conditions from round 3. Error bars represent the standard error of the mean (SEM). The numbers 1–5 in the optimized group represent the first to fifth place conditions for round 3 (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Circles represent an individual score, bars represent the mean score, and error bars represent the SEM. Statistical significance was examined using two-way ANOVA and SNK <italic>post-hoc</italic> tests. p&lt;0.05 was considered significant. ***p&lt;0.001 versus pre-optimized. In all other combinations, no statistical significance was detected. Raw values are shown in <xref ref-type="supplementary-material" rid="fig5sdata2">Figure 5—source data 2</xref>. (<bold>B</bold>) Representative pigmented images of the pre-optimized and five optimized iPSC-RPE cells. Images acquired on DDay 34. ID labeling on the bottom reads 'V (validation) - Plate No. - Well No.'. The other images are shown in <xref ref-type="supplementary-material" rid="fig5sdata1">Figure 5—source data 1</xref>. (<bold>C–F</bold>) Cell biological validation of the robot-induced RPE cells. After DDay 34, cells were purified, stocked, initiated, maintained for four weeks, and analyzed (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>). (<bold>C</bold>) Representative marker gene expression in RPE cells by RT-PCR. iPSC, undifferentiated iPSC; H-RPE (Lonza), Clonetics H-RPE (Lot #493461, Lonza, USA); pre-optimized and optimized LabDroid-induced RPE. (<bold>D–E</bold>) Quantification of representative secreted proteins from iPSC-RPE cells using ELISA. The supernatants were collected and the amount of VEGF (<bold>D</bold>) and PEDF (<bold>E</bold>) in the culture medium was analyzed 24 hr after medium exchange (n=3 wells each). Circles represent individual scores, bars represent the mean score, and error bars represent SEM. n.d.=not detected. The raw values are shown in <xref ref-type="supplementary-material" rid="fig5sdata3">Figure 5—source data 3</xref>. (<bold>F</bold>) Co-staining of ZO-1 (green) and MITF (magenta) using immunohistochemistry. Nuclei were stained with DAPI. The scale bars represent 20 µm.</p><p><supplementary-material id="fig5sdata1"><label>Figure 5—source data 1.</label><caption><title>Acquired pigmented images of the validation experiment.</title><p>Images acquired on Day 34 of the validation experiment: images of the bottom of the well with cultured cells, cropped to the size of the well. These 8-bit images were adjusted to a minimum and maximum contrast value of 80 and 125, respectively. Sample names on the top correspond to <xref ref-type="fig" rid="fig5">Figure 5A</xref>. ID labeling on the bottom indicates 'V (validation) - Plate No. - Well No.'. Wells 2, 5, and 6 were not subjected to the validation experiments. Plates 1 and 5 were used for cell biological analysis and were not evaluated using images.</p></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-77007-fig5-data1-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig5sdata2"><label>Figure 5—source data 2.</label><caption><title>Executed parameters and scores of the validation experiment.</title><p>Related to <xref ref-type="fig" rid="fig4">Figure 4</xref>. Raw values of the parameter candidates and pigmentation scores in the validation experiments. The sample names on the top correspond to <xref ref-type="fig" rid="fig5">Figure 5A</xref>. Well numbers 2, 5, and 6 were not subjected to the validation experiments. *Plate numbers 1 and 5 were used for cell biological analysis and were not validated using images.</p></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-77007-fig5-data2-v1.xlsx"/></supplementary-material></p><p><supplementary-material id="fig5sdata3"><label>Figure 5—source data 3.</label><caption><title>ELISA scores.</title><p>Related to <xref ref-type="fig" rid="fig5">Figure 5D and E</xref>. Raw values of ELISA scores from the validation experiments.</p></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-77007-fig5-data3-v1.xlsx"/></supplementary-material></p><p><supplementary-material id="fig5sdata4"><label>Figure 5—source data 4.</label><caption><title>Immunohistochemistry images.</title><p>Related to <xref ref-type="fig" rid="fig5">Figure 5F</xref>. Images without contrast processing. TIFF files with three channels merged for each sample image: channel 1, MITF (magenta); channel 2, ZO-1 (green); channel 3, DAPI (gray).</p></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-77007-fig5-data4-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig5sdata5"><label>Figure 5—source data 5.</label><caption><title>Robot log.</title><p>List of job names, start times, end times, time required, number of commands, and errors (if any) for all experiments performed by the LabDroid in this study.</p></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-77007-fig5-data5-v1.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Video monitoring.</title><p>Example pictures of the monitoring cameras. (<bold>A–B</bold>) Wide-angle cameras for 24×7 monitoring. Front camera (<bold>A</bold>) and back camera (<bold>B</bold>). (<bold>C–D</bold>) Magnifying cameras that record only when the robot is running. Right camera (<bold>C</bold>) and left camera (<bold>D</bold>). (<bold>E</bold>) Live streaming camera (available to research contributors only, no recordings).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig5-figsupp1-v1.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Errors in the robotic operations.</title><p>Robotic experiments were conducted for 185 days, with a total robot operating time of 995 hr, 39 min, and 21 s (<xref ref-type="supplementary-material" rid="fig5sdata5">Figure 5—source data 5</xref>). Each round consisted of 73 jobs, and five rounds were performed, including baseline and validation. The total number of jobs executed by the LabDroid was 365, of which 343 were successful on the first try; 22 required human intervention at least once. The job success rate was 93.973%. One job consisted of multiple commands. The total number of commands that the LabDroid was ordered to execute was 75039, of which 75,011 were successful on the first try, 25 required human intervention at least once, and 3 were aborted. The command success rate was 99.963%. The reasons for the errors included micropipette tip loading error, 4 commands; micropipette tip ejection error, 7 commands; microscope and its control PC-derived errors, 13 commands (including 3 aborted commands); defective labware, 1 command; and human error, 3 commands. The errors occurred on the following dates: 2019 Feb (baseline), 11 commands; 2019 Apr (round 1), 11 (including three aborted commands); 2019 Jul (round 2), 4; 2020 Jan (round 3), 0; and 2020 Mar (validation), 2. The number of motions requiring the use of micropipettes that the LabDroid was ordered to execute was 39421; the rate of failure of either tip loading or ejection was 0.0279%. The vertical and horizontal axes represent the causes and error timing of the errors that occurred during the robotic experiments, respectively. Each circle represents one error.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77007-fig5-figsupp2-v1.tif"/></fig></fig-group><p>In summary, we conducted 216 40-day cell culture experiments with a total experimentation time of 8640 days. We accelerated the search using a BBO technique, compressing the search time to 185 days with a cumulative robot operating time of 995 hr (<xref ref-type="supplementary-material" rid="fig5sdata5">Figure 5—source data 5</xref>; <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplements 1</xref> and <xref ref-type="fig" rid="fig5s2">2</xref>; <xref ref-type="video" rid="fig4video1 fig4video2 fig4video3 fig4video4 fig4video5">Figure 4—videos 1–5</xref>).</p><p>In this study, we succeeded in replacing part of the process of iPS cell differentiation into RPE cells for transplantation using robots, and demonstrated an effective optimization method (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). However, it was unclear whether robot-manufactured RPE cells would have the characteristics required for transplantation. Therefore, we purified the cells of the validation round, prepared them for transplantation, and performed a biological quality evaluation (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>). The analyzed iPSC-RPE cells expressed <italic>BEST1</italic>, <italic>RPE65</italic>, and <italic>CRALBP</italic> (<xref ref-type="fig" rid="fig5">Figure 5C</xref>), which are characteristic marker genes of RPE cells. In addition, we observed secretion of VEGF and PEDF into the culture medium, a characteristic of RPE cells (<xref ref-type="fig" rid="fig5">Figure 5D and E</xref>; <xref ref-type="supplementary-material" rid="fig5sdata3">Figure 5—source data 3</xref>). The expression of tight junction-associated factor ZO-1 was examined using immunohistochemistry, and a ZO-1-derived fluorescence signal was observed in microphthalmia-associated transcription factor (MITF)-positive cells, which play a central role in RPE cell function (<xref ref-type="fig" rid="fig5">Figure 5F</xref>). These results indicated that the robot-manufactured iPSC-RPE cells had the characteristics of RPE cells, and fulfilled the criteria for use in regenerative medicine research using the type of analysis measured in a previous clinical study (<xref ref-type="bibr" rid="bib21">Mandai et al., 2017</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we proposed a robotic search system to autonomously search for optimal cell culture conditions, bringing together experimental robotics and BBO. Our robotic search system autonomously discovered the optimal combination of seven parameters comprising the iPSC-RPE induction process (target process) required to increase the number of pigmented cells (pigmentation score). Our approach can be applied to cell culture protocols other than iPSC-RPE induction; however, it may not be optimal even when implemented with a completely identical hardware-software setup. Below, we discuss some considerations and potential limitations for tailoring the components of our robotic search system (robots, parameters, and evaluation scores) to other targets.</p><p>Robots: the requirements depend on the nature of the target process. The search parameters must be changeable (flexibility), non-search parameters must remain stable or change only within the range of the specifications (reliability), and the operation must be sufficiently repeatable (accuracy). In addition, the storage capacity for CO<sub>2</sub> incubators and refrigerators needs to be set in accordance with the number of cell plates that are to be cultured concurrently. For target processes that require long-term culture (i.e. processes that have high retry costs) such as cell differentiation induction, the robots and peripheral equipment need to have low error rates. In target processes that have low retry costs, a lower priority on low error rates is required. We chose LabDroid for this research, as it meets these requirements and has good future operational extensibility.</p><p>Parameters: the number and range of searchable parameters is constrained by the number of experiments that can be performed. The more parameters to be searched, the greater the number of experiments required for sufficient optimization. The available experimental resources (number of iterations or parallel cultures) should be considered in advance for appropriate parameter optimization. Here, we limited the scope of our search to just seven parameters (<xref ref-type="table" rid="table1">Table 1</xref>). However, a myriad of potential parameter candidates, including other chemicals, culture media, and order of manipulations, can be considered. During parameter selection, we referred to previous cell culture studies and expert opinions, as well as preliminary simulations, to confirm that optimization was sufficiently feasible with our resources (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). The search ranges for the seven parameters were carefully selected for our target process; different appropriate search ranges should be selected in case of other target processes, including the induction of differentiation into other types of tissues.</p><p>Evaluation scores: since the optimization is performed on the evaluation scores, designing the evaluation function is critical. Here, we used the pigmentation score as the evaluation score because of the following reasons: when preparing iPSC-RPE cells for transplantation in clinical research, a clinical team evaluates the rate of pigmented cells, gene expression, and secretory substances in cells subjected to differentiation induction followed by purification (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). This quality assessment is not based on a total score, and only those cells that satisfy all the criteria in all items are suitable for transplantation (<xref ref-type="bibr" rid="bib19">Kuroda et al., 2019</xref>; <xref ref-type="bibr" rid="bib21">Mandai et al., 2017</xref>; <xref ref-type="bibr" rid="bib30">Regent et al., 2019</xref>). Because cell pigmentation is one of the criteria for the assessment, cell pigmentation alone is not sufficient to determine cell quality, but can be a requirement. It should be noted that the pigmentation score does not reflect the degree of pigmentation in individual cells, but indicates the number of cells in the dish whose pigmentation is above the threshold. Since pigmented cells and non-pigmented cells are mixed in the dishes at the end of the induction (i.e. before purification), single-cell omics analysis is needed to accurately evaluate the quality of individual cells. For example, in stem cells, a value (stemness index) has been proposed to evaluate stemness from single-cell mRNA-seq information (<xref ref-type="bibr" rid="bib6">Gulati et al., 2020</xref>). We believe that if a similar index for iPSC-RPE cells indicating cell quality from transcriptome data is established, this could replace the pigmentation score that we used, and would make the process we have developed even more ideal.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reagent type (species) or resource</th><th align="left" valign="bottom">Designation</th><th align="left" valign="bottom">Source or reference</th><th align="left" valign="bottom">Identifiers</th><th align="left" valign="bottom">Additional information</th></tr></thead><tbody><tr><td align="left" valign="bottom">Cell line (<italic>Homo-sapiens</italic>)</td><td align="left" valign="bottom">hiPSC 253G1</td><td align="left" valign="bottom">RIKEN BRC</td><td align="left" valign="bottom">HPS0002</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Antibody</td><td align="left" valign="bottom">Anti-ZO-1 (Rabbit polyclonal)</td><td align="left" valign="bottom">Thermo Fisher Scientific Inc.</td><td align="left" valign="bottom">61–7300</td><td align="left" valign="bottom">IHC (1:500)</td></tr><tr><td align="left" valign="bottom">Antibody</td><td align="left" valign="bottom">Anti-MITF (Mouse monoclonal)</td><td align="left" valign="bottom">Abcam plc.</td><td align="left" valign="bottom">ab80651</td><td align="left" valign="bottom">IHC (1:1000)</td></tr><tr><td align="left" valign="bottom">Antibody</td><td align="left" valign="bottom">Alexa Fluor 488 Goat Anti-rabbit IgG (Goat polyclonal)</td><td align="left" valign="bottom">Thermo Fisher Scientific Inc.</td><td align="left" valign="bottom">A-11034</td><td align="left" valign="bottom">IHC (1:1000)</td></tr><tr><td align="left" valign="bottom">Antibody</td><td align="left" valign="bottom">Alexa Fluor 546 Goat Anti-mouse IgG (Goat polyclonal)</td><td align="left" valign="bottom">Thermo Fisher Scientific Inc.</td><td align="left" valign="bottom">A-11030</td><td align="left" valign="bottom">IHC (1:1000)</td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">BEST1 (+)</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">RT-PCR primers</td><td align="left" valign="bottom">TAGAACCATCAGCGCCGTC</td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">BEST1 (−)</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">RT-PCR primers</td><td align="left" valign="bottom">TGAGTGTAGTGTGTATGTTGG</td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">RPE65 (+)</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">RT-PCR primers</td><td align="left" valign="bottom">TCCCCAATACAACTGCCACT</td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">RPE65 (−)</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">RT-PCR primers</td><td align="left" valign="bottom">CCTTGGCATTCAGAATCAGG</td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">CRALBP (+)</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">RT-PCR primers</td><td align="left" valign="bottom">GAGGGTGCAAGAGAAGGACA</td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">CRALBP (−)</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">RT-PCR primers</td><td align="left" valign="bottom">TGCAGAAGCCATTGATTTGA</td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">GAPDH (+)</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">RT-PCR primers</td><td align="left" valign="bottom">ACCACAGTCCATGCCATCAC</td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">GAPDH (−)</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">RT-PCR primers</td><td align="left" valign="bottom">TCCACCACCCTGTTGCTGTA</td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">RNeasy Micro Kit</td><td align="left" valign="bottom">QIAGEN</td><td align="left" valign="bottom">74004</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">SuperScript III</td><td align="left" valign="bottom">Thermo Fisher Scientific Inc.</td><td align="left" valign="bottom">18080–044</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">VEGF Human ELISA Kit</td><td align="left" valign="bottom">Thermo Fisher Scientific Inc.</td><td align="left" valign="bottom">BMS277-2</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">PEDF Human ELISA Kit</td><td align="left" valign="bottom">BioVendor</td><td align="left" valign="bottom">RD191114200R</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">PD 173074</td><td align="left" valign="bottom">Merck &amp; Co., Inc.</td><td align="left" valign="bottom">P2499-5MG</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">CultureSure Y-27632</td><td align="left" valign="bottom">FUJIFILM Wako Pure Chemical Corporation</td><td align="left" valign="bottom">036–24023</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">SB 431542 hydrate</td><td align="left" valign="bottom">Merck &amp; Co., Inc.</td><td align="left" valign="bottom">S4317-5MG</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">CKI-7 dihydrochloride</td><td align="left" valign="bottom">Merck &amp; Co., Inc.</td><td align="left" valign="bottom">C0742-5MG</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">LabDroid_optimizer</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Available at our Github (see Data and code availability)</td></tr><tr><td align="left" valign="bottom">Other</td><td align="left" valign="bottom">StemFit AK02N</td><td align="left" valign="bottom">Ajinomoto Co., Inc.</td><td align="left" valign="bottom">AK02N</td><td align="left" valign="bottom">see Materials and Methods &gt;Reagents</td></tr><tr><td align="left" valign="bottom">Other</td><td align="left" valign="bottom">knockOut serum replacement (KSR)</td><td align="left" valign="bottom">Thermo Fisher Scientific Inc.</td><td align="left" valign="bottom">10828028</td><td align="left" valign="bottom">see Materials and Methods &gt;Reagents</td></tr><tr><td align="left" valign="bottom">Other</td><td align="left" valign="bottom">FBS</td><td align="left" valign="bottom">Nichirei Corporation</td><td align="left" valign="bottom">12007C</td><td align="left" valign="bottom">see Materials and Methods &gt;Reagents</td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Guidelines</title><p>All experiments that involved the use of human-derived samples were reviewed and approved by the institutional review board of the Institutional Committee of RIKEN Kobe Branch (#Kobe1 2019–05 (3)).</p></sec><sec id="s4-2"><title>Reagents</title><p>hiPSC maintenance medium: 80% StemFit Basal Solution A and 20% StemFit iPS Expansion Solution B (#AK02N, Ajinomoto Co., Inc, Japan).</p><p>RPE differentiation medium (20% KSR): 0.10 mM MEM non-essential amino acids solution (NEAA) (#11140050, Thermo Fisher Scientific Inc, MA, USA), 1.0 mM sodium pyruvate (#S8636, Merck &amp; Co., Inc, NJ, USA), 19% knockOut serum replacement (KSR) (#10828028, Thermo Fisher Scientific Inc, MA, USA), 0.0007% 2-mercaptoethanol (#139–06861, FUJIFILM Wako Pure Chemical Corporation, Japan), 78 U/mL benzylpenicillin sodium, and 78 µg/mL streptomycin sulfate (#15140122, Thermo Fisher Scientific Inc, MA, USA). All diluted in GMEM (#11710035, Thermo Fisher Scientific Inc, MA, USA).</p><p>RPE differentiation medium (15% KSR): 0.10 mM MEM NEAA (#11140050, Thermo Fisher Scientific Inc, MA, USA), 0.99 mM sodium pyruvate (#S8636, Merck &amp; Co., Inc, NJ, USA), 15% KSR (#10828028, Thermo Fisher Scientific Inc, MA, USA), 0.0007% 2-mercaptoethanol (#139–06861, FUJIFILM Wako Pure Chemical Corporation, Japan), 82 U/mL benzylpenicillin sodium, and 82 µg/mL streptomycin sulfate (#15140122, Thermo Fisher Scientific Inc, MA, USA). All diluted in GMEM (#11710035, Thermo Fisher Scientific Inc, MA, USA).</p><p>RPE differentiation medium (10% KSR): 0.094 mM MEM NEAA (#11140050, Thermo Fisher Scientific Inc, MA, USA), 0.94 mM sodium pyruvate (#S8636, Merck &amp; Co., Inc, NJ, USA), 10% KSR (#10828028, Thermo Fisher Scientific Inc, MA, USA), 0.0007% 2-mercaptoethanol (#139–06861, FUJIFILM Wako Pure Chemical Corporation, Japan), 85 U/mL benzylpenicillin sodium, and 85 µg/mL streptomycin sulfate (#15140122, Thermo Fisher Scientific Inc, MA, USA). All diluted in GMEM (#11710035, Thermo Fisher Scientific Inc, MA, USA).</p><p>RPE maintenance medium: 29% Nutrient Mixture F-12 (#N6658, Merck &amp; Co., Inc, NJ, USA), 1.9 mM L-glutamine (#G7513, Merck &amp; Co., Inc, NJ, USA), 1.9% B-27 supplement, serum free (#17504044, Thermo Fisher Scientific Inc, MA, USA), 96 U/mL benzylpenicillin sodium, and 96 µg/mL streptomycin sulfate (#15140122, Thermo Fisher Scientific Inc, MA, USA). All diluted in DMEM (Low glucose) (#D6046, Merck &amp; Co., Inc, NJ, USA).</p><p>FGF receptor inhibitor (FGFRi) stock: PD 173074 (#P2499-5MG, Merck &amp; Co., Inc, NJ, USA) diluted in DMSO (#D2650−5X5ML, Merck &amp; Co., Inc, NJ, USA).</p><p>Rho-kinase inhibitor (Y) stock (8–10 mM): CultureSure Y-27632 (#036–24023, FUJIFILM Wako Pure Chemical Corporation, Japan) diluted in distilled water (Otsuka Pharmaceutical Factory, Japan) to a final 10 µM concentration when added to the cell culture medium.</p><p>TGF-β/Activin/Nodal signal inhibitor (SB) stock (4–5 mM): SB 431542 hydrate (#S4317-5MG, Merck &amp; Co., Inc, NJ, USA) diluted in DMSO (#D2650−5X5ML, Merck &amp; Co., Inc, NJ, USA) to a final 5 µM concentration when added to the cell culture medium.</p><p>Wnt signal inhibitor (CKI) stock (2.4–3 mM): CKI-7 dihydrochloride (#C0742-5MG, Merck &amp; Co., Inc, NJ, USA) diluted in distilled water (Otsuka Pharmaceutical Factory, Japan) to a final 3 µM concentration when added to the cell culture medium.</p><p>RPE adhesion medium: DMEM/F12 (D8437, Merck &amp; Co., Inc, NJ, USA), 10% FBS (12,007C, Nichirei Corporation, Japan).</p><p>RPE washing solution: 98% DMEM/F12 (D8437, Merck &amp; Co., Inc, NJ, USA), 1 mM sodium pyruvate (S8636, Merck &amp; Co., Inc, NJ, USA), 2 mM L-glutamine (G7513, Merck &amp; Co., Inc, NJ, USA).</p></sec><sec id="s4-3"><title>Labware</title><p>For human use: micropipette tip, 2140-05-HR/2149P-05/61849, Thermo Fisher Scientific Inc (MA, USA); micropipette tip, 30389165, Mettler Toledo (OH, USA); micropipette tip, 737251, Greiner Bio-One International GmbH (Germany); disposable pipette, 356507, Corning Incorporated (NY, USA); disposable pipette, 606160/607160/760160/768160, Greiner Bio-One International GmbH (Germany); filtration, SLGVJ13SL, Merck &amp; Co., Inc (NJ, USA); filtration, SS-10LZ, Terumo Corporation (Japan); filtration, 431096/430281/431097/430282, Corning Incorporated (NY, USA); 1.5 mL tube, 72.692MS, Sarstedt K.K. (Japan); 15 mL tube, 352096, Corning Incorporated (NY, USA); 50 mL tube, 352070, Corning Incorporated (NY, USA).</p><p>For LabDroid use: 6-well plate, 353046, Corning Incorporated (NY, USA); 50 mL tube, MS-58500, Sumitomo Bakelite Co., Ltd. (Japan); micropipette tip, 3511-05-HR/3512-05-HR/94410313/94410713/94052550, Thermo Fisher Scientific Inc (MA, USA).</p></sec><sec id="s4-4"><title>LabDroid Maholo booth</title><p>LabDroid including peripheral equipment were placed inside a booth made of acrylic walls and a stainless steel frame with three fan-filter-units (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). The LabDroid booth included a dual-arm humanoid (Robotic Biology Institute Inc, Japan), a CO<sub>2</sub> incubator (APC-30D, ASTEC Co., Ltd., Japan), micropipettes (4641110N/4641030N/4641230N/4641210N, Thermo Fisher Scientific Inc, MA, USA), a tube rack (Robotic Biology Institute Inc, Japan), a plate rack (Robotic Biology Institute Inc, Japan), a dry bath (EC-40RA, AS ONE Corporation, Japan), a tip sensor (Robotic Biology Institute Inc, Japan), an aspirator (SP-30, Air Liquide, Italy), a dust bin (EPD3S, Sekisui Techno Moulding Co., Ltd., Japan), and a microscope (EVOS FL Auto 2, Thermo Fisher Scientific Inc, MA, USA).</p></sec><sec id="s4-5"><title>hiPSC culture — initiation and preparation of cell suspensions (human part)</title><p>The hiPSC line 253G1 (<xref ref-type="bibr" rid="bib23">Nakagawa et al., 2008</xref>), made from human dermal fibroblasts, was obtained from RIKEN BRC (HPS0002). The hiPSCs were cultured and differentiated using the method previously described (<xref ref-type="bibr" rid="bib8">Haruta et al., 2004</xref>; <xref ref-type="bibr" rid="bib11">Kawasaki et al., 2002</xref>; <xref ref-type="bibr" rid="bib27">Osakada et al., 2008</xref>). Mycoplasma contamination tests were performed periodically during the study and the results were always negative.</p><p>On DDay −14, frozen hiPSCs were initiated using the following procedures: first, laminin-coated 6-well plates were prepared. A final concentration of 0.5 µg/cm<sup>2</sup> iMatrix-511 (Matrixome Inc, Japan) diluted in PBS (-) was then added to each well of the four 6-well plates and incubated for a minimum of 60 min at 37 °C and 5% CO<sub>2</sub>, after which 0.75 mL/well of hiPSC maintenance medium was added. The supernatant was then removed. Next, 1 mL/well of hiPSC maintenance medium containing Rho-kinase inhibitor (final 10 µM concentration) was added, and the coated plates were incubated at 37 °C and 5% CO<sub>2</sub> until further use.</p><p>For hiPSC initiation, frozen vials of hiPSCs stored in liquid nitrogen were thawed in a water bath set at 37 °C, and the cells were subsequently suspended in 5 mL of hiPSC maintenance medium. After centrifugation (160×<italic>g</italic>, 22 °C, 4 min), the supernatant was removed and an appropriate volume of hiPSC maintenance medium with a final 10 µM Rho-kinase inhibitor concentration was added. After counting the cells with a hemocytometer, the cells were seeded into laminin-coated 6-well plates at 43,300–45,000 cells/1.5 mL medium/well.</p><p>On DDay −13, the medium was replaced with hiPSC maintenance medium without Rho-kinase inhibitor. On DDays −12 to −8, the medium was replaced with the same medium composition at 24–72 hr intervals. On DDay −7, cells were collected from the plate, and cell suspensions were delivered to the LabDroid booth. The medium was aspirated and 2 mL/well of PBS (-) was gently added and then aspirated for washing, followed by addition of 1 mL of 0.5 x TrypLE Select CTS (#A12859-01, Thermo Fisher Scientific Inc, MA, USA) diluted in 0.5 mM EDTA/PBS (-) and incubated at 37 °C and 5% CO<sub>2</sub> for 10–20 min. Then, cells were detached by pipetting and collected into a 50 mL tube, to which 1 mL of hiPSC maintenance medium and 3 mL of PBS (-) were added. After centrifugation (160×<italic>g</italic>, 22 °C, 4 min), the supernatant was removed, 0.75 mL of hiPSC maintenance medium with 10 µM Rho-kinase inhibitor was added, and the cells were resuspended. The cell suspension was filtered through a 40 µm cell strainer (#352340, Corning Incorporated, USA) with an additional 0.75 mL of hiPSC maintenance medium. After counting the cells with a hemocytometer, the cell suspension was set to 133,400 cells/20 mL with hiPSC maintenance medium containing 10 µM Rho-kinase inhibitor in eight 50 mL tubes. To prepare the cell suspensions, eight 6-well plates coated with laminin were prepared. A final concentration of 0.5 µg/cm<sup>2</sup> of iMatrix-511 (Matrixome Inc, Japan) diluted in PBS (-) was added to each well of four 6-well plates and incubated for a minimum of 60 min at 37 °C and 5% CO<sub>2</sub>.</p></sec><sec id="s4-6"><title>iPSC-RPE differentiation (LabDroid part)</title><p>On DDay −7, the hiPSC suspension was seeded into eight 6-well plates by coating eight 6-well plates with laminin, and placing eight tubes of the iPSC suspension and labware in the appropriate positions. The task of seeding was initiated, and the robotic operation was performed by LabDroid (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplements 2A</xref> and <xref ref-type="fig" rid="fig2s3">3</xref>; <xref ref-type="video" rid="fig4video1">Figure 4—video 1</xref>). After the robotic operation, the eight cell-seeded plates were exported and incubated in a CO<sub>2</sub> incubator outside the LabDroid booth.</p><p>On DDay −6, the eight seeded plates were imported into the CO<sub>2</sub> incubator of the LabDroid booth. The users prepared eight 50 mL tubes of hiPSC maintenance medium with a final 10 µM Rho-kinase inhibitor concentration and two 50 mL tubes of hiPSC maintenance medium with final 5 µM FGFRi and 10 µM Rho-kinase inhibitor concentrations. The reagents and labware were placed in the appropriate positions. The task of preconditioning was then initiated, and the robotic operation was performed by LabDroid (medium exchange type I; <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplements 2B</xref> and <xref ref-type="fig" rid="fig2s4">4</xref>; <xref ref-type="video" rid="fig4video2">Figure 4—video 2</xref>).</p><p>On DDays −5 to −1, the users prepared eight 50 mL tubes of hiPSC maintenance medium without Rho-kinase inhibitor and two 50 mL tubes of hiPSC maintenance medium with a final 5 µM FGFRi concentration. The reagents and labware were placed in the appropriate positions. The task of preconditioning was initiated, and the robotic operation was performed by LabDroid (medium exchange type I; <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplements 2B</xref> and <xref ref-type="fig" rid="fig2s4">4</xref>; <xref ref-type="video" rid="fig4video2">Figure 4—video 2</xref>).</p><p>On DDay 0, the following procedure was used for the operation of four plates: the users prepared four 6-well plates coated with laminin. A final 0.5 µg/cm<sup>2</sup> concentration of iMatrix-511 (Matrixome Inc, Japan) diluted in PBS (-) was added to each well of the four 6-well plates and then the plates were incubated for a minimum of 60 min at 37 °C and 5% CO<sub>2</sub>. The users also prepared two 50 mL tubes of PBS (-), two 50 mL tubes of 0.5 x TrypLE Select CTS (#A12859-01, Thermo Fisher Scientific Inc, MA, USA) diluted in 0.5 mM EDTA/PBS (-), and four plates with RPE differentiation medium (20% KSR) with final 10 µM Rho-kinase inhibitor/3 µM Wnt signal inhibitor/5 µM TGF-β/Activin/Nodal signal inhibitor (4 mL/well each) concentration. The cell plates, laminin-coated plates, plates with medium, reagents, and labware were placed in the appropriate positions. The task of passage was initiated, and robotic operations were performed by LabDroid (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplements 2D</xref> and <xref ref-type="fig" rid="fig2s5">5</xref>; <xref ref-type="video" rid="fig4video3">Figure 4—video 3</xref>). After performing this operation twice (four plates each), the eight cell-passaged plates were exported and incubated in a CO<sub>2</sub> incubator outside the LabDroid booth.</p><p>On DDay 1, the eight cell-passaged plates were imported into the CO<sub>2</sub> incubator of the LabDroid booth. Users prepared eight 50 mL tubes of RPE differentiation medium (10% KSR), two 50 mL tubes of 100% KSR, one 50 mL tube of 4 mM Rho-kinase inhibitor stock/1.2 mM Wnt signal inhibitor stock, and one 50 mL tube of 4 mM TGF-β/Activin/Nodal signal inhibitor stock. The reagents and labware were placed in the appropriate positions. The task of RPE differentiation was initiated, and the robotic operation was performed by LabDroid (medium exchange type I; <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplements 2B</xref> and <xref ref-type="fig" rid="fig2s6">6</xref>; <xref ref-type="video" rid="fig4video4">Figure 4—video 4</xref>).</p><p>On DDays 2–19, the users prepared eight 50 mL tubes of RPE differentiation medium (10% KSR), two 50 mL tubes of 100% KSR, one 50 mL tube of 4 mM Rho-kinase inhibitor stock/1.2 mM Wnt signal inhibitor, and one 50 mL tube of 4 mM TGF-β/Activin/Nodal signal inhibitor. The reagents and labware were placed in the appropriate positions. The task of RPE differentiation was initiated, and the robotic operation was performed by LabDroid (medium exchange type I; <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplements 2B</xref> and <xref ref-type="fig" rid="fig2s6">6</xref>; <xref ref-type="video" rid="fig4video4">Figure 4—video 4</xref>).</p><p>On DDays 20–32, the users prepared eight 50 mL tubes of RPE differentiation medium (10% KSR; DDays 10–25) or RPE maintenance medium (DDays 26–32). The reagents and labware were placed in the appropriate positions. RPE differentiation and maintenance were initiated and the robotic operations were performed by LabDroid (medium exchange type II; <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplements 2C</xref> and <xref ref-type="fig" rid="fig2s7">7</xref>; <xref ref-type="video" rid="fig4video5">Figure 4—video 5</xref>).</p></sec><sec id="s4-7"><title>Scoring — sampling (human part)</title><p>On DDay 33, the cell plates were exported and the cell culture medium was replaced with fresh RPE maintenance medium. After 24 hr (DDay 34), the medium was collected for ELISA analysis. The remaining media were aspirated and 2 mL of PBS (-) were added and then aspirated for washing. After that, photographic images were acquired for the calculation of scoring values.</p></sec><sec id="s4-8"><title>Scoring — image analysis (human part)</title><p>Images were acquired using a digital camera (PSG7X MARKII, Canon Inc, Japan): ISO 500; focal length <italic>F</italic>=9.00, 50 mm; exposure time, 1/1250 s. The camera was set in the same position throughout all experiments. The acquired images were automatically processed by filtering with Gaussian blur, subtracting the background, binarizing by thresholding with a constant value, and cropping with a constant pixel value. The colored cell area was then calculated (<xref ref-type="fig" rid="fig2s8">Figure 2—figure supplement 8</xref>).</p></sec><sec id="s4-9"><title>Purification and storage (human part)</title><p>Purification of iPSC-RPE cells was conducted using the same protocol described in a study previously reported (<xref ref-type="bibr" rid="bib21">Mandai et al., 2017</xref>). When the RPE colonies reached an appropriate size, the cells were suspended in RPE maintenance medium and kept as a floating culture for about 10 days in a low cell adhesion plate (MS-90600Z, Sumitomo Bakelite Co., Ltd., Japan). Under the microscope, colonies consisting only of black RPE cells were selected. Then, they were transferred to 12-well plates coated with iMatrix, and cultured in RPE adhesion medium/RPE maintenance medium (1:1). Once the RPE cell colonies became attached to the dish, they were cultured in RPE maintenance medium with basic fibroblast growth factor (bFGF), which was changed every 2–3 days.</p><p>After 10–12 days of cell selection, unsuitable cells were removed, and the cells were passaged. The medium was aspirated and 1 mL of RPE washing solution was added and aspirated again for washing. Then, 0.5 mL of RPE washing solution was added and atypical cells were eliminated using micropipette tips under microscope observation. After the removal process, the medium was aspirated, 1 mL/well of PBS (-) was added and aspirated for washing, and then 0.5 mL of Trypsin-EDTA solution (203–20251, FUJIFILM Wako Pure Chemical Corporation, Japan) was added, followed by incubation at RT and 5% CO<sub>2</sub> for 8–10 min. Cells were detached by pipetting and collected into a 50 mL tube. After centrifugation (280×<italic>g</italic>, 25 °C, 4 min), the supernatant was removed, and the pellet was resuspended in 1 mL/plate of RPE adhesion medium/RPE maintenance medium (1:1) and filtered through a 40 μm cell strainer (352340, Corning Incorporated, NY, U.S.A.). After counting the cells with a hemocytometer, the cells were seeded into 12-well plates. The medium was changed to RPE maintenance medium with bFGF.</p><p>After 1–3 days of cell passage, the medium was aspirated, the cells were washed with 0.5 mL of RPE maintenance medium, and 1 mL of RPE maintenance medium containing 10 ng/mL bFGF and 0.5 µM SB431542 was added. This medium was exchanged every 2–3 days.</p><p>The cells were stored when they formed hexagonal shapes after sufficient confluency. For that, the medium was aspirated, 1 mL/well of PBS (-) was added and then aspirated for washing, and 0.5 mL of Trypsin-EDTA solution (203–20251, FUJIFILM Wako Pure Chemical Corporation, Japan) was added, followed by incubation at 37 °C and 5% CO<sub>2</sub> for 10–15 min. After adding &gt;0.5 mL of RPE adhesion medium, the cells were detached using a cell scraper (MS-93100, Sumitomo Bakelite Co., Ltd., Japan). The cell suspension was filtered through a 40 μm cell strainer (352340, Corning Incorporated, NY, USA) and then centrifuged for 4 min at 280×<italic>g</italic> to obtain a cell pellet. The pellet was resuspended in 1 mL of RPE adhesion medium/RPE maintenance medium (1:1) and filtered through a 40 μm cell strainer. After counting the cells with a hemocytometer, the cell suspension was centrifuged for 4 min at 280×<italic>g</italic> to obtain a cell pellet. Then, STEM-CELLBANKER (CB047, Zenoaq Resource Co., Ltd., Japan) was added until a cell concentration of 500,000 cells/0.5 mL/tube, and the cell suspensions were dispensed into cryovials. The cryotubes were placed in a cell freezing container at −80 °C for 3–24 hr, and then stored at −150 °C.</p></sec><sec id="s4-10"><title>Initiation of iPSC-RPE stock and recovery culture (human part)</title><p>Frozen vials of RPE cells were thawed in a 37 °C water bath and suspended in 4.5 mL of RPE adhesion medium. After centrifugation (280×<italic>g</italic>, 25 °C, 4 min), the supernatant was removed and RPE adhesion medium/RPE maintenance medium (1:1) was added. After counting the cells with a hemocytometer, the cells were seeded into 24-well plates (0.5 mL/well).</p><p>After 1–3 days of cell seeding, the medium was aspirated, the cells were washed with 0.25 mL of RPE maintenance medium, and 0.5 mL/well of RPE maintenance medium containing 10 ng/mL bFGF and 0.5 µM SB431542 was added. This same type of medium was exchanged every 2–3 days.</p><p>Two weeks after seeding, the RPE cells were passaged. Two weeks after cell passage, the RPE cells were used for cell biological validation processes (RT-PCR, ELISA, and immunohistochemistry).</p></sec><sec id="s4-11"><title>Validation — RT-PCR (human part)</title><p>Total RNA was extracted from transfected cells using RNeasy Micro Kit (#74004, QIAGEN, Germany). First-strand cDNA synthesis was performed on 500–1000 ng of total RNA, using SuperScript III (#18080–044, Thermo Fisher Scientific Inc, MA, USA) according to the manufacturer’s instructions. Each mRNA transcript was amplified using PCR with the following primers:</p><list list-type="simple"><list-item><p><italic>BEST1</italic> (+), 5′-<named-content content-type="sequence">dTAGAACCATCAGCGCCGTC</named-content></p></list-item><list-item><p><italic>BEST1</italic> (−), 5′-<named-content content-type="sequence">dTGAGTGTAGTGTGTATGTTGG</named-content></p></list-item><list-item><p><italic>RPE65</italic> (+), 5′-<named-content content-type="sequence">dTCCCCAATACAACTGCCACT</named-content></p></list-item><list-item><p><italic>RPE65</italic> (−), 5′-<named-content content-type="sequence">dCCTTGGCATTCAGAATCAGG</named-content></p></list-item><list-item><p><italic>CRALBP</italic> (+), 5′-<named-content content-type="sequence">dGAGGGTGCAAGAGAAGGACA</named-content></p></list-item><list-item><p><italic>CRALBP</italic> (−), 5′-<named-content content-type="sequence">dTGCAGAAGCCATTGATTTGA</named-content></p></list-item><list-item><p><italic>GAPDH</italic> (+), 5′-<named-content content-type="sequence">dACCACAGTCCATGCCATCAC</named-content></p></list-item><list-item><p><italic>GAPDH</italic> (−), 5′-<named-content content-type="sequence">dTCCACCACCCTGTTGCTGTA</named-content></p></list-item></list></sec><sec id="s4-12"><title>Validation — ELISA (human part)</title><p>The collected media were centrifuged (90×<italic>g</italic>, 4 °C, 1 min), and the supernatant was collected and stored at −80 °C. The amount of VEGF contained in the thawed medium was measured using the protocols and reagents from the VEGF Human ELISA Kit (BMS277-2, Thermo Fisher Scientific, USA), and the amounts of PEDF were measured using a Human ELISA Kit (RD191114200R, BioVendor, Czech Republic).</p></sec><sec id="s4-13"><title>Validation — Immunohistochemistry (human part)</title><p>Cells were washed with PBS (-), fixed in 15% paraformaldehyde for 1 hr at RT (approximately 25 °C), and stored at 4 °C after removal of PFA and addition of PBS (-). After removal of the solutions, cells were treated with 50 µL/well of 0.2% Triton X-100/PBS (-), incubated for 30 min at RT, washed with PBS (-), blocked with 50 µL of Blocking One (03953–95, Nacalai Tesque Inc, Japan), and incubated for 1 h at RT. After removal of the solutions, cells were stained at 4 °C o/n in 50 µL of the 1st antibody diluent (rabbit anti-ZO-1, 61–7300, Thermo Fisher Scientific Inc, MA, USA; anti-MITF, mouse anti-MiTF, ab80651, Abcam plc., Britain; antibody diluent, S2022, Agilent Technologies Inc, USA). After removal of the solutions, cells were washed with PBS (-) and then stained at RT for 1 hr in 50 µL of the 2nd antibody diluent (Alexa Fluor 546 Goat Anti-mouse IgG, A-11030, Thermo Fisher Scientific Inc, MA, USA; Alexa Fluor 488 Goat Anti-rabbit IgG, A-11034, Thermo Fisher Scientific Inc, MA, USA; antibody diluent, S2022, Agilent Technologies Inc, USA) with DAPI (1 µg/mL, D1206, Thermo Fisher Scientific Inc, MA, USA). After removal of the solutions, cells were washed with PBS (-), and then 50 µL of PBS (-) was added. Images of immunohistochemistry samples were acquired using an IX73 inverted microscope (Olympus, Japan).</p></sec><sec id="s4-14"><title>Bayesian optimization module</title><p>When no prior experimental results exist, the Bayesian optimization module generates the next query from random uniform sampling. When past experimental results are available, the Bayesian optimization module generates queries using two components: the Model updater and the Query generator (<xref ref-type="fig" rid="fig3">Figure 3C</xref>).</p><p>The Model updater updates the surrogate model to predict the experimental results given past experimental results: <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>. We adopted Gaussian process regression (GPR, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) with the ARD-RBF kernel as the surrogate model to estimate the expected score and confidence level for all unevaluated experimental parameters. Based on the experimental results shown in <xref ref-type="fig" rid="fig2">Figure 2E</xref>, the observation noise was assumed to follow a zero-mean Gaussian noise with a variance of 0.0039 at all points in the search space. By using the surrogate model, the Query generator generates the next queries in two steps. In step 1, the Query generator constructs an acquisition function that estimates the expected progress toward the optimal experimental parameter at a given experimental parameter <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in the search space. We adopted the Expected improvement (EI) (<xref ref-type="bibr" rid="bib9">Jones et al., 1998</xref>), a commonly used acquisition function in BO. EI estimates how much improvement over the current best score is expected from each point in the search space. In step 2, by using the acquisition function, the Query generator decides where to evaluate next, and our problem required the simultaneous performance of 48 experiments corresponding to 8 plates x 6 wells in each round. In addition, because the <italic>DP</italic> is a batch contextual parameter as described herein, a policy function that generates parameter sets taking such structural context into account must be incorporated. Therefore, we developed the Batch Contextual Local Penalization (BCLP) as a policy function to generate multiple points with context in parallel. The BCLP is a batch generation policy that extends the local penalization (<xref ref-type="bibr" rid="bib5">Gonzalez et al., 2016</xref>) to be applied to cases where complex structural context parameters exist. As shown in <xref ref-type="fig" rid="fig3">Figure 3E</xref>, for each value of the contextual parameter <italic>DP</italic> in ascending order, BCLP iteratively generated the parameter by maximizing and penalizing the acquisition function 48 times to obtain the next experimental parameters <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for each subsequent well (Algorithm 1, 2). In addition, after each round, the more promising <italic>KP</italic> intervals were reconfigured by calculating the integral value of the acquisition function (Algorithm 3). We also replaced the queries that corresponded to the place of the top two pigmentation scores in the previous experiments with the parameter of the top two pigmentation scores in the previous experiments as a positive control. For more information about the optimization module, see the <bold>Appendix</bold>.</p></sec><sec id="s4-15"><title>Statistical analysis</title><p>Statistical analyses were performed by Wolfram Mathematica version 11.2.0.0. In this study, p&lt;0.05 was considered significant (*p&lt;0.05, **p&lt;0.01, ***p&lt;0.001, and n.s.=not significant).</p></sec><sec id="s4-16"><title>Data and code availability</title><p>All code that supports the findings of this study is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/labauto/LabDroid_optimizer">https://github.com/labauto/LabDroid_optimizer</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:3f85e86ba5c1c36e82ffde539874f84549015426;origin=https://github.com/labauto/LabDroid_optimizer;visit=swh:1:snp:28fe0ad527ddcd8f281e465de5e57c2b9fcf9c6c;anchor=swh:1:rev:661ef792d4b7568a2e673178d9f1e6ed3c84ab1b">swh:1:rev:661ef792d4b7568a2e673178d9f1e6ed3c84ab1b</ext-link>, <xref ref-type="bibr" rid="bib34">Tsuzuki, 2022</xref>). This code is based on GPyOpt (<italic>GPyOpt: Gaussian Process Optimization using GPy</italic>).</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>A stakeholder of Robotic Biology Institute, Inc</p></fn><fn fn-type="COI-statement" id="conf2"><p>An employee of Epistra Inc</p></fn><fn fn-type="COI-statement" id="conf3"><p>An employee of VCCT Inc</p></fn><fn fn-type="COI-statement" id="conf4"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf5"><p>An employee of Robotic Biology Institute, Inc</p></fn><fn fn-type="COI-statement" id="conf6"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf7"><p>An executive of Robotic Biology Institute, Inc</p></fn><fn fn-type="COI-statement" id="conf8"><p>An executive of Epistra Inc</p></fn><fn fn-type="COI-statement" id="conf9"><p>An executive of Vision Care Inc and VCCT Inc</p></fn><fn fn-type="COI-statement" id="conf10"><p>A shareholder of Epistra Inc</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Investigation, Methodology, Project administration, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Formal analysis, Methodology, Software, Validation, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con8"><p>Software, Writing – review and editing</p></fn><fn fn-type="con" id="con9"><p>Software, Writing – review and editing</p></fn><fn fn-type="con" id="con10"><p>Software, Writing – review and editing</p></fn><fn fn-type="con" id="con11"><p>Resources, Writing – review and editing</p></fn><fn fn-type="con" id="con12"><p>Resources, Writing – review and editing</p></fn><fn fn-type="con" id="con13"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con14"><p>Funding acquisition, Resources, Writing – review and editing</p></fn><fn fn-type="con" id="con15"><p>Project administration, Software, Writing – review and editing</p></fn><fn fn-type="con" id="con16"><p>Funding acquisition, Software, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con17"><p>Funding acquisition, Resources, Supervision, Writing – review and editing</p></fn><fn fn-type="con" id="con18"><p>Conceptualization, Funding acquisition, Writing – review and editing, Supervision, Writing – original draft</p></fn><fn fn-type="con" id="con19"><p>Conceptualization, Funding acquisition, Supervision, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Human subjects: All experiments that involved the use of human-derived samples were reviewed and approved by the institutional review board of the Institutional Committee of RIKEN Kobe Branch (#Kobe1 2019-05 (3)).</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media xlink:href="elife-77007-transrepform1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting file. All code that supports the findings of this study is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/labauto/LabDroid_optimizer">https://github.com/labauto/LabDroid_optimizer</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:3f85e86ba5c1c36e82ffde539874f84549015426;origin=https://github.com/labauto/LabDroid_optimizer;visit=swh:1:snp:28fe0ad527ddcd8f281e465de5e57c2b9fcf9c6c;anchor=swh:1:rev:661ef792d4b7568a2e673178d9f1e6ed3c84ab1b">swh:1:rev:661ef792d4b7568a2e673178d9f1e6ed3c84ab1b</ext-link>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank T Iwata, T Mitsuyama, H Ozaki, and N Yachie for their insightful comments; H Hirabayashi and E Takagi for research support; A Kato and H Uchida for illustrations; and J Freeman for carefully proofreading the manuscript. We also thank all the laboratory members at RIKEN BDR, in particular, N Koide, Y Shibata, A Maeda, and T Maeda for their kind help in the preparation of the materials, their support in the experiments, and their insightful discussions.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burger</surname><given-names>B</given-names></name><name><surname>Maffettone</surname><given-names>PM</given-names></name><name><surname>Gusev</surname><given-names>VV</given-names></name><name><surname>Aitchison</surname><given-names>CM</given-names></name><name><surname>Bai</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Alston</surname><given-names>BM</given-names></name><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Clowes</surname><given-names>R</given-names></name><name><surname>Rankin</surname><given-names>N</given-names></name><name><surname>Harris</surname><given-names>B</given-names></name><name><surname>Sprick</surname><given-names>RS</given-names></name><name><surname>Cooper</surname><given-names>AI</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A mobile robotic chemist</article-title><source>Nature</source><volume>583</volume><fpage>237</fpage><lpage>241</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2442-2</pub-id><pub-id pub-id-type="pmid">32641813</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>dos Santos</surname><given-names>FF</given-names></name><name><surname>Andrade</surname><given-names>PZ</given-names></name><name><surname>da Silva</surname><given-names>CL</given-names></name><name><surname>Cabral</surname><given-names>JMS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Bioreactor design for clinical-grade expansion of stem cells</article-title><source>Biotechnology Journal</source><volume>8</volume><fpage>644</fpage><lpage>654</lpage><pub-id pub-id-type="doi">10.1002/biot.201200373</pub-id><pub-id pub-id-type="pmid">23625834</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Frazier</surname><given-names>PI</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Bayesian Optimization for Materials Design</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1506.01349">https://arxiv.org/abs/1506.01349</ext-link></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gongora</surname><given-names>AE</given-names></name><name><surname>Xu</surname><given-names>B</given-names></name><name><surname>Perry</surname><given-names>W</given-names></name><name><surname>Okoye</surname><given-names>C</given-names></name><name><surname>Riley</surname><given-names>P</given-names></name><name><surname>Reyes</surname><given-names>KG</given-names></name><name><surname>Morgan</surname><given-names>EF</given-names></name><name><surname>Brown</surname><given-names>KA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A Bayesian experimental autonomous researcher for mechanical design</article-title><source>Science Advances</source><volume>6</volume><elocation-id>eaaz1708</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.aaz1708</pub-id><pub-id pub-id-type="pmid">32300652</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Gonzalez</surname><given-names>J</given-names></name><name><surname>Dai</surname><given-names>Z</given-names></name><name><surname>Hennig</surname><given-names>P</given-names></name><name><surname>Lawrence</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Batch Bayesian Optimization via Local Penalization</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1505.08052">https://arxiv.org/abs/1505.08052</ext-link></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gulati</surname><given-names>GS</given-names></name><name><surname>Sikandar</surname><given-names>SS</given-names></name><name><surname>Wesche</surname><given-names>DJ</given-names></name><name><surname>Manjunath</surname><given-names>A</given-names></name><name><surname>Bharadwaj</surname><given-names>A</given-names></name><name><surname>Berger</surname><given-names>MJ</given-names></name><name><surname>Ilagan</surname><given-names>F</given-names></name><name><surname>Kuo</surname><given-names>AH</given-names></name><name><surname>Hsieh</surname><given-names>RW</given-names></name><name><surname>Cai</surname><given-names>S</given-names></name><name><surname>Zabala</surname><given-names>M</given-names></name><name><surname>Scheeren</surname><given-names>FA</given-names></name><name><surname>Lobo</surname><given-names>NA</given-names></name><name><surname>Qian</surname><given-names>D</given-names></name><name><surname>Yu</surname><given-names>FB</given-names></name><name><surname>Dirbas</surname><given-names>FM</given-names></name><name><surname>Clarke</surname><given-names>MF</given-names></name><name><surname>Newman</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Single-cell transcriptional diversity is a hallmark of developmental potential</article-title><source>Science (New York, N.Y.)</source><volume>367</volume><fpage>405</fpage><lpage>411</lpage><pub-id pub-id-type="doi">10.1126/science.aax0249</pub-id><pub-id pub-id-type="pmid">31974247</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>HamediRad</surname><given-names>M</given-names></name><name><surname>Chao</surname><given-names>R</given-names></name><name><surname>Weisberg</surname><given-names>S</given-names></name><name><surname>Lian</surname><given-names>J</given-names></name><name><surname>Sinha</surname><given-names>S</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Towards a fully automated algorithm driven platform for biosystems design</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>5150</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-13189-z</pub-id><pub-id pub-id-type="pmid">31723141</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haruta</surname><given-names>M</given-names></name><name><surname>Sasai</surname><given-names>Y</given-names></name><name><surname>Kawasaki</surname><given-names>H</given-names></name><name><surname>Amemiya</surname><given-names>K</given-names></name><name><surname>Ooto</surname><given-names>S</given-names></name><name><surname>Kitada</surname><given-names>M</given-names></name><name><surname>Suemori</surname><given-names>H</given-names></name><name><surname>Nakatsuji</surname><given-names>N</given-names></name><name><surname>Ide</surname><given-names>C</given-names></name><name><surname>Honda</surname><given-names>Y</given-names></name><name><surname>Takahashi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>In vitro and in vivo characterization of pigment epithelial cells differentiated from primate embryonic stem cells</article-title><source>Investigative Ophthalmology &amp; Visual Science</source><volume>45</volume><fpage>1020</fpage><lpage>1025</lpage><pub-id pub-id-type="doi">10.1167/iovs.03-1034</pub-id><pub-id pub-id-type="pmid">14985325</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>DR</given-names></name><name><surname>Schonlau</surname><given-names>M</given-names></name><name><surname>Welch</surname><given-names>WJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Efficient Global Optimization of Expensive Black-Box Functions</article-title><source>Journal of Global Optimization</source><volume>13</volume><fpage>455</fpage><lpage>492</lpage><pub-id pub-id-type="doi">10.1023/A:1008306431147</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanie</surname><given-names>K</given-names></name><name><surname>Sakai</surname><given-names>T</given-names></name><name><surname>Imai</surname><given-names>Y</given-names></name><name><surname>Yoshida</surname><given-names>K</given-names></name><name><surname>Sugimoto</surname><given-names>A</given-names></name><name><surname>Makino</surname><given-names>H</given-names></name><name><surname>Kubo</surname><given-names>H</given-names></name><name><surname>Kato</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Effect of mechanical vibration stress in cell culture on human induced pluripotent stem cells</article-title><source>Regenerative Therapy</source><volume>12</volume><fpage>27</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1016/j.reth.2019.05.002</pub-id><pub-id pub-id-type="pmid">31890764</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawasaki</surname><given-names>H</given-names></name><name><surname>Suemori</surname><given-names>H</given-names></name><name><surname>Mizuseki</surname><given-names>K</given-names></name><name><surname>Watanabe</surname><given-names>K</given-names></name><name><surname>Urano</surname><given-names>F</given-names></name><name><surname>Ichinose</surname><given-names>H</given-names></name><name><surname>Haruta</surname><given-names>M</given-names></name><name><surname>Takahashi</surname><given-names>M</given-names></name><name><surname>Yoshikawa</surname><given-names>K</given-names></name><name><surname>Nishikawa</surname><given-names>SI</given-names></name><name><surname>Nakatsuji</surname><given-names>N</given-names></name><name><surname>Sasai</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Generation of dopaminergic neurons and pigmented epithelia from primate ES cells by stromal cell-derived inducing activity</article-title><source>PNAS</source><volume>99</volume><fpage>1580</fpage><lpage>1585</lpage><pub-id pub-id-type="doi">10.1073/pnas.032662199</pub-id><pub-id pub-id-type="pmid">11818560</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>King</surname><given-names>RD</given-names></name><name><surname>Rowland</surname><given-names>J</given-names></name><name><surname>Oliver</surname><given-names>SG</given-names></name><name><surname>Young</surname><given-names>M</given-names></name><name><surname>Aubrey</surname><given-names>W</given-names></name><name><surname>Byrne</surname><given-names>E</given-names></name><name><surname>Liakata</surname><given-names>M</given-names></name><name><surname>Markham</surname><given-names>M</given-names></name><name><surname>Pir</surname><given-names>P</given-names></name><name><surname>Soldatova</surname><given-names>LN</given-names></name><name><surname>Sparkes</surname><given-names>A</given-names></name><name><surname>Whelan</surname><given-names>KE</given-names></name><name><surname>Clare</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The automation of science</article-title><source>Science (New York, N.Y.)</source><volume>324</volume><fpage>85</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1126/science.1165620</pub-id><pub-id pub-id-type="pmid">19342587</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kino-Oka</surname><given-names>M</given-names></name><name><surname>Chowdhury</surname><given-names>SR</given-names></name><name><surname>Muneyuki</surname><given-names>Y</given-names></name><name><surname>Manabe</surname><given-names>M</given-names></name><name><surname>Saito</surname><given-names>A</given-names></name><name><surname>Sawa</surname><given-names>Y</given-names></name><name><surname>Taya</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Automating the expansion process of human skeletal muscle myoblasts with suppression of myotube formation</article-title><source>Tissue Engineering. Part C, Methods</source><volume>15</volume><fpage>717</fpage><lpage>728</lpage><pub-id pub-id-type="doi">10.1089/ten.TEC.2008.0429</pub-id><pub-id pub-id-type="pmid">19284306</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kino-oka</surname><given-names>M</given-names></name><name><surname>Mizutani</surname><given-names>M</given-names></name><name><surname>Medcalf</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Cell manufacturability</article-title><source>Cell and Gene Therapy Insights</source><volume>5</volume><fpage>1347</fpage><lpage>1359</lpage><pub-id pub-id-type="doi">10.18609/cgti.2019.140</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kino-Oka</surname><given-names>M</given-names></name><name><surname>Sakai</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Preface of the special issue “Cell Manufacturability.”</article-title><source>Regenerative Therapy</source><volume>12</volume><elocation-id>1</elocation-id><pub-id pub-id-type="doi">10.1016/j.reth.2019.07.001</pub-id><pub-id pub-id-type="pmid">31890759</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kitano</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Artificial Intelligence to Win the Nobel Prize and Beyond: Creating the Engine for Scientific Discovery</article-title><source>AI Magazine</source><volume>37</volume><fpage>39</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1609/aimag.v37i1.2642</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kitano</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Nobel Turing Challenge: creating the engine for scientific discovery</article-title><source>NPJ Systems Biology and Applications</source><volume>7</volume><elocation-id>29</elocation-id><pub-id pub-id-type="doi">10.1038/s41540-021-00189-3</pub-id><pub-id pub-id-type="pmid">34145287</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Konagaya</surname><given-names>S</given-names></name><name><surname>Ando</surname><given-names>T</given-names></name><name><surname>Yamauchi</surname><given-names>T</given-names></name><name><surname>Suemori</surname><given-names>H</given-names></name><name><surname>Iwata</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Long-term maintenance of human induced pluripotent stem cells by automated cell culture system</article-title><source>Scientific Reports</source><volume>5</volume><elocation-id>16647</elocation-id><pub-id pub-id-type="doi">10.1038/srep16647</pub-id><pub-id pub-id-type="pmid">26573336</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuroda</surname><given-names>T</given-names></name><name><surname>Ando</surname><given-names>S</given-names></name><name><surname>Takeno</surname><given-names>Y</given-names></name><name><surname>Kishino</surname><given-names>A</given-names></name><name><surname>Kimura</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Robust induction of retinal pigment epithelium cells from human induced pluripotent stem cells by inhibiting FGF/MAPK signaling</article-title><source>Stem Cell Research</source><volume>39</volume><elocation-id>101514</elocation-id><pub-id pub-id-type="doi">10.1016/j.scr.2019.101514</pub-id><pub-id pub-id-type="pmid">31376722</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Hourd</surname><given-names>P</given-names></name><name><surname>Chandra</surname><given-names>A</given-names></name><name><surname>Williams</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Human cell culture process capability: a comparison of manual and automated production</article-title><source>Journal of Tissue Engineering and Regenerative Medicine</source><volume>4</volume><fpage>45</fpage><lpage>54</lpage><pub-id pub-id-type="doi">10.1002/term.217</pub-id><pub-id pub-id-type="pmid">19842115</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mandai</surname><given-names>M</given-names></name><name><surname>Watanabe</surname><given-names>A</given-names></name><name><surname>Kurimoto</surname><given-names>Y</given-names></name><name><surname>Hirami</surname><given-names>Y</given-names></name><name><surname>Morinaga</surname><given-names>C</given-names></name><name><surname>Daimon</surname><given-names>T</given-names></name><name><surname>Fujihara</surname><given-names>M</given-names></name><name><surname>Akimaru</surname><given-names>H</given-names></name><name><surname>Sakai</surname><given-names>N</given-names></name><name><surname>Shibata</surname><given-names>Y</given-names></name><name><surname>Terada</surname><given-names>M</given-names></name><name><surname>Nomiya</surname><given-names>Y</given-names></name><name><surname>Tanishima</surname><given-names>S</given-names></name><name><surname>Nakamura</surname><given-names>M</given-names></name><name><surname>Kamao</surname><given-names>H</given-names></name><name><surname>Sugita</surname><given-names>S</given-names></name><name><surname>Onishi</surname><given-names>A</given-names></name><name><surname>Ito</surname><given-names>T</given-names></name><name><surname>Fujita</surname><given-names>K</given-names></name><name><surname>Kawamata</surname><given-names>S</given-names></name><name><surname>Go</surname><given-names>MJ</given-names></name><name><surname>Shinohara</surname><given-names>C</given-names></name><name><surname>Hata</surname><given-names>KI</given-names></name><name><surname>Sawada</surname><given-names>M</given-names></name><name><surname>Yamamoto</surname><given-names>M</given-names></name><name><surname>Ohta</surname><given-names>S</given-names></name><name><surname>Ohara</surname><given-names>Y</given-names></name><name><surname>Yoshida</surname><given-names>K</given-names></name><name><surname>Kuwahara</surname><given-names>J</given-names></name><name><surname>Kitano</surname><given-names>Y</given-names></name><name><surname>Amano</surname><given-names>N</given-names></name><name><surname>Umekage</surname><given-names>M</given-names></name><name><surname>Kitaoka</surname><given-names>F</given-names></name><name><surname>Tanaka</surname><given-names>A</given-names></name><name><surname>Okada</surname><given-names>C</given-names></name><name><surname>Takasu</surname><given-names>N</given-names></name><name><surname>Ogawa</surname><given-names>S</given-names></name><name><surname>Yamanaka</surname><given-names>S</given-names></name><name><surname>Takahashi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Autologous Induced Stem-Cell-Derived Retinal Cells for Macular Degeneration</article-title><source>The New England Journal of Medicine</source><volume>376</volume><fpage>1038</fpage><lpage>1046</lpage><pub-id pub-id-type="doi">10.1056/NEJMoa1608368</pub-id><pub-id pub-id-type="pmid">28296613</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsumoto</surname><given-names>E</given-names></name><name><surname>Koide</surname><given-names>N</given-names></name><name><surname>Hanzawa</surname><given-names>H</given-names></name><name><surname>Kiyama</surname><given-names>M</given-names></name><name><surname>Ohta</surname><given-names>M</given-names></name><name><surname>Kuwabara</surname><given-names>J</given-names></name><name><surname>Takeda</surname><given-names>S</given-names></name><name><surname>Takahashi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Fabricating retinal pigment epithelial cell sheets derived from human induced pluripotent stem cells in an automated closed culture system for regenerative medicine</article-title><source>PLOS ONE</source><volume>14</volume><elocation-id>e0212369</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0212369</pub-id><pub-id pub-id-type="pmid">30865653</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakagawa</surname><given-names>M</given-names></name><name><surname>Koyanagi</surname><given-names>M</given-names></name><name><surname>Tanabe</surname><given-names>K</given-names></name><name><surname>Takahashi</surname><given-names>K</given-names></name><name><surname>Ichisaka</surname><given-names>T</given-names></name><name><surname>Aoi</surname><given-names>T</given-names></name><name><surname>Okita</surname><given-names>K</given-names></name><name><surname>Mochiduki</surname><given-names>Y</given-names></name><name><surname>Takizawa</surname><given-names>N</given-names></name><name><surname>Yamanaka</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Generation of induced pluripotent stem cells without Myc from mouse and human fibroblasts</article-title><source>Nature Biotechnology</source><volume>26</volume><fpage>101</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1038/nbt1374</pub-id><pub-id pub-id-type="pmid">18059259</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nikolaev</surname><given-names>P</given-names></name><name><surname>Hooper</surname><given-names>D</given-names></name><name><surname>Webber</surname><given-names>F</given-names></name><name><surname>Rao</surname><given-names>R</given-names></name><name><surname>Decker</surname><given-names>K</given-names></name><name><surname>Krein</surname><given-names>M</given-names></name><name><surname>Poleski</surname><given-names>J</given-names></name><name><surname>Barto</surname><given-names>R</given-names></name><name><surname>Maruyama</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Autonomy in materials research: a case study in carbon nanotube growth</article-title><source>Npj Computational Materials</source><volume>2</volume><fpage>1</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1038/npjcompumats.2016.31</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nishimura</surname><given-names>A</given-names></name><name><surname>Nakajima</surname><given-names>R</given-names></name><name><surname>Takagi</surname><given-names>R</given-names></name><name><surname>Zhou</surname><given-names>G</given-names></name><name><surname>Suzuki</surname><given-names>D</given-names></name><name><surname>Kiyama</surname><given-names>M</given-names></name><name><surname>Nozaki</surname><given-names>T</given-names></name><name><surname>Owaki</surname><given-names>T</given-names></name><name><surname>Takahara</surname><given-names>T</given-names></name><name><surname>Nagai</surname><given-names>S</given-names></name><name><surname>Nakamura</surname><given-names>T</given-names></name><name><surname>Sugaya</surname><given-names>M</given-names></name><name><surname>Terada</surname><given-names>K</given-names></name><name><surname>Igarashi</surname><given-names>Y</given-names></name><name><surname>Hanzawa</surname><given-names>H</given-names></name><name><surname>Okano</surname><given-names>T</given-names></name><name><surname>Shimizu</surname><given-names>T</given-names></name><name><surname>Yamato</surname><given-names>M</given-names></name><name><surname>Takeda</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Fabrication of tissue-engineered cell sheets by automated cell culture equipment</article-title><source>Journal of Tissue Engineering and Regenerative Medicine</source><volume>13</volume><fpage>2246</fpage><lpage>2255</lpage><pub-id pub-id-type="doi">10.1002/term.2968</pub-id><pub-id pub-id-type="pmid">31677247</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ochiai</surname><given-names>K</given-names></name><name><surname>Motozawa</surname><given-names>N</given-names></name><name><surname>Terada</surname><given-names>M</given-names></name><name><surname>Horinouchi</surname><given-names>T</given-names></name><name><surname>Masuda</surname><given-names>T</given-names></name><name><surname>Kudo</surname><given-names>T</given-names></name><name><surname>Kamei</surname><given-names>M</given-names></name><name><surname>Tsujikawa</surname><given-names>A</given-names></name><name><surname>Matsukuma</surname><given-names>K</given-names></name><name><surname>Natsume</surname><given-names>T</given-names></name><name><surname>Kanda</surname><given-names>GN</given-names></name><name><surname>Takahashi</surname><given-names>M</given-names></name><name><surname>Takahashi</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A Variable Scheduling Maintenance Culture Platform for Mammalian Cells</article-title><source>SLAS Technology</source><volume>26</volume><fpage>209</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1177/2472630320972109</pub-id><pub-id pub-id-type="pmid">33269985</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Osakada</surname><given-names>F</given-names></name><name><surname>Ikeda</surname><given-names>H</given-names></name><name><surname>Mandai</surname><given-names>M</given-names></name><name><surname>Wataya</surname><given-names>T</given-names></name><name><surname>Watanabe</surname><given-names>K</given-names></name><name><surname>Yoshimura</surname><given-names>N</given-names></name><name><surname>Akaike</surname><given-names>A</given-names></name><name><surname>Akaike</surname><given-names>A</given-names></name><name><surname>Sasai</surname><given-names>Y</given-names></name><name><surname>Takahashi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Toward the generation of rod and cone photoreceptors from mouse, monkey and human embryonic stem cells</article-title><source>Nature Biotechnology</source><volume>26</volume><fpage>215</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1038/nbt1384</pub-id><pub-id pub-id-type="pmid">18246062</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Osakada</surname><given-names>F</given-names></name><name><surname>Jin</surname><given-names>ZB</given-names></name><name><surname>Hirami</surname><given-names>Y</given-names></name><name><surname>Ikeda</surname><given-names>H</given-names></name><name><surname>Danjyo</surname><given-names>T</given-names></name><name><surname>Watanabe</surname><given-names>K</given-names></name><name><surname>Sasai</surname><given-names>Y</given-names></name><name><surname>Takahashi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>In vitro differentiation of retinal cells from human pluripotent stem cells by small-molecule induction</article-title><source>Journal of Cell Science</source><volume>122</volume><fpage>3169</fpage><lpage>3179</lpage><pub-id pub-id-type="doi">10.1242/jcs.050393</pub-id><pub-id pub-id-type="pmid">19671662</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rasmussen</surname><given-names>CE</given-names></name><name><surname>Williams</surname><given-names>CKI</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Gaussian Processes for Machine Learning</source><publisher-loc>Cambridge, MA</publisher-loc><publisher-name>MIT press</publisher-name><pub-id pub-id-type="doi">10.7551/mitpress/3206.001.0001</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Regent</surname><given-names>F</given-names></name><name><surname>Morizur</surname><given-names>L</given-names></name><name><surname>Lesueur</surname><given-names>L</given-names></name><name><surname>Habeler</surname><given-names>W</given-names></name><name><surname>Plancheron</surname><given-names>A</given-names></name><name><surname>Ben M’Barek</surname><given-names>K</given-names></name><name><surname>Monville</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Automation of human pluripotent stem cell differentiation toward retinal pigment epithelial cells for large-scale productions</article-title><source>Scientific Reports</source><volume>9</volume><elocation-id>10646</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-47123-6</pub-id><pub-id pub-id-type="pmid">31337830</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shahriari</surname><given-names>B</given-names></name><name><surname>Swersky</surname><given-names>K</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Adams</surname><given-names>RP</given-names></name><name><surname>de Freitas</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Taking the Human Out of the Loop: A Review of Bayesian Optimization</article-title><source>Proceedings of the IEEE</source><volume>104</volume><fpage>148</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1109/JPROC.2015.2494218</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soares</surname><given-names>FAC</given-names></name><name><surname>Chandra</surname><given-names>A</given-names></name><name><surname>Thomas</surname><given-names>RJ</given-names></name><name><surname>Pedersen</surname><given-names>RA</given-names></name><name><surname>Vallier</surname><given-names>L</given-names></name><name><surname>Williams</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Investigating the feasibility of scale up and automation of human induced pluripotent stem cells cultured in aggregates in feeder free conditions</article-title><source>Journal of Biotechnology</source><volume>173</volume><fpage>53</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1016/j.jbiotec.2013.12.009</pub-id><pub-id pub-id-type="pmid">24440272</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>RJ</given-names></name><name><surname>Chandra</surname><given-names>A</given-names></name><name><surname>Hourd</surname><given-names>PC</given-names></name><name><surname>Williams</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Cell Culture Automation and Quality Engineering: A Necessary Partnership to Develop Optimized Manufacturing Processes for Cell-Based Therapies</article-title><source>JALA</source><volume>13</volume><fpage>152</fpage><lpage>158</lpage><pub-id pub-id-type="doi">10.1016/j.jala.2007.12.003</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Tsuzuki</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>LabDroid_optimizer</data-title><version designator="swh:1:rev:661ef792d4b7568a2e673178d9f1e6ed3c84ab1b">swh:1:rev:661ef792d4b7568a2e673178d9f1e6ed3c84ab1b</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:3f85e86ba5c1c36e82ffde539874f84549015426;origin=https://github.com/labauto/LabDroid_optimizer;visit=swh:1:snp:28fe0ad527ddcd8f281e465de5e57c2b9fcf9c6c;anchor=swh:1:rev:661ef792d4b7568a2e673178d9f1e6ed3c84ab1b">https://archive.softwareheritage.org/swh:1:dir:3f85e86ba5c1c36e82ffde539874f84549015426;origin=https://github.com/labauto/LabDroid_optimizer;visit=swh:1:snp:28fe0ad527ddcd8f281e465de5e57c2b9fcf9c6c;anchor=swh:1:rev:661ef792d4b7568a2e673178d9f1e6ed3c84ab1b</ext-link></element-citation></ref><ref id="bib35"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wall</surname><given-names>IB</given-names></name><name><surname>Davie</surname><given-names>N.</given-names></name></person-group><year iso-8601-date="2013">2013</year><chapter-title>8 - Quality control in cell and tissue engineering In</chapter-title><person-group person-group-type="editor"><name><surname>Salih</surname><given-names>V</given-names></name></person-group><source>Standardisation in Cell and Tissue Engineering</source><publisher-name>Woodhead Publishing</publisher-name><fpage>148</fpage><lpage>165</lpage></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watanabe</surname><given-names>K</given-names></name><name><surname>Ueno</surname><given-names>M</given-names></name><name><surname>Kamiya</surname><given-names>D</given-names></name><name><surname>Nishiyama</surname><given-names>A</given-names></name><name><surname>Matsumura</surname><given-names>M</given-names></name><name><surname>Wataya</surname><given-names>T</given-names></name><name><surname>Takahashi</surname><given-names>JB</given-names></name><name><surname>Nishikawa</surname><given-names>S</given-names></name><name><surname>Nishikawa</surname><given-names>S</given-names></name><name><surname>Muguruma</surname><given-names>K</given-names></name><name><surname>Sasai</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A ROCK inhibitor permits survival of dissociated human embryonic stem cells</article-title><source>Nature Biotechnology</source><volume>25</volume><fpage>681</fpage><lpage>686</lpage><pub-id pub-id-type="doi">10.1038/nbt1310</pub-id><pub-id pub-id-type="pmid">17529971</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wigley</surname><given-names>PB</given-names></name><name><surname>Everitt</surname><given-names>PJ</given-names></name><name><surname>van den Hengel</surname><given-names>A</given-names></name><name><surname>Bastian</surname><given-names>JW</given-names></name><name><surname>Sooriyabandara</surname><given-names>MA</given-names></name><name><surname>McDonald</surname><given-names>GD</given-names></name><name><surname>Hardman</surname><given-names>KS</given-names></name><name><surname>Quinlivan</surname><given-names>CD</given-names></name><name><surname>Manju</surname><given-names>P</given-names></name><name><surname>Kuhn</surname><given-names>CCN</given-names></name><name><surname>Petersen</surname><given-names>IR</given-names></name><name><surname>Luiten</surname><given-names>AN</given-names></name><name><surname>Hope</surname><given-names>JJ</given-names></name><name><surname>Robins</surname><given-names>NP</given-names></name><name><surname>Hush</surname><given-names>MR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fast machine-learning online optimization of ultra-cold-atom experiments</article-title><source>Scientific Reports</source><volume>6</volume><elocation-id>25890</elocation-id><pub-id pub-id-type="doi">10.1038/srep25890</pub-id><pub-id pub-id-type="pmid">27180805</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yachie</surname><given-names>N</given-names></name><collab>Robotic Biology Consortium</collab><name><surname>Natsume</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Robotic crowd biology with Maholo LabDroids</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>310</fpage><lpage>312</lpage><pub-id pub-id-type="doi">10.1038/nbt.3758</pub-id><pub-id pub-id-type="pmid">28398329</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>1. Details about parameterization of the iPSC-RPE protocol</title><p>The addition of FGFRi to the medium during preconditioning significantly increased the efficiency of induction of differentiation into RPE cells (<xref ref-type="bibr" rid="bib19">Kuroda et al., 2019</xref>). The unit of <italic>PC</italic> is nM, and it takes values from 0 to 505, while <italic>PP</italic> is the number of days FGFRi is added, taking values from 1 to 6. For example, <italic>PC</italic>=300 and <italic>PP</italic>=2 indicates that 300 nM of FGFRi is added to DDays –2 and –1, and not from DDays –6 to –3.</p><p><italic>DS</italic> was adopted because shear stress affects cell properties (<xref ref-type="bibr" rid="bib35">Wall and Davie, 2013</xref>), and <italic>DL</italic> was adopted because the number of cells at passage is empirically known to contribute to the efficiency of differentiation induction. <italic>DS</italic> takes integer values from 10 to 100, indicating the speed at which the micropipette syringe is pressed (unit: mm/sec); <italic>DL</italic> takes two integer values, one long and one short, indicating the bottom surface area to be pipetted. We adopted <italic>DP</italic> at passage because of the constraints in the configuration of the LabDroid, which required different fixed values. <italic>DP</italic> takes integer values of 5, 8, 11, 14, 17, 20, and 23 to indicate the number of minutes that the trypsin solution was added and incubated at room temperature after incubation at 37 °C for 20 min.</p><p>The three chemical supplements are Rho-kinase inhibitor, TGF-β/Activin/Nodal signal inhibitor, and Wnt signal inhibitor, all of which are known to affect the culture and differentiation of iPS cells (<xref ref-type="bibr" rid="bib28">Osakada et al., 2009</xref>; <xref ref-type="bibr" rid="bib36">Watanabe et al., 2007</xref>). KSR was added to the medium at a 20% concentration on DDay 0 and was progressively reduced to 10%. Under baseline conditions, KSR is added in the following manner: 20% on DDays 0–4, 15% on DDays 5–7, and 10% from DDay 8, suggesting that this rate of reduction is important for the induction of RPE differentiation (<xref ref-type="bibr" rid="bib19">Kuroda et al., 2019</xref>). The <italic>KP</italic> takes values from 1 to 19 and the concentration of KSR is decreased linearly daily until KSR becomes 10% on the DDay of the <italic>KP</italic> value. For example, when <italic>KP</italic>=4, KSR will be 20% on DDay 0, 17.5% on DDay 1, 15.0% on DDay 2, 12.5% on DDay 3, and 10% on DDay 4. <italic>3P</italic> takes integer values from 3 to 19, and indicates the day in which the three chemical supplements are included in the differentiation-inducing medium from DDay 0 to the DDay of that <italic>3P</italic> value.</p></sec><sec sec-type="appendix" id="s9"><title>2. Gaussian process overview</title><p>In Bayesian optimization, the Gaussian process (GP) <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is typically used as the surrogate model to approximate the I/O of the objective function <inline-formula><mml:math id="inf59"><mml:mi>f</mml:mi></mml:math></inline-formula>. The GP is characterized by three components: a mean function µ, a variance function <inline-formula><mml:math id="inf60"><mml:mi>σ</mml:mi></mml:math></inline-formula> and a kernel function (positive-value covariance function) <inline-formula><mml:math id="inf61"><mml:mi>k</mml:mi></mml:math></inline-formula>. In case of past experimental data <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> of <inline-formula><mml:math id="inf63"><mml:mi>n</mml:mi></mml:math></inline-formula> observations, and Gaussian prior <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, Gaussian Posterior is then given in <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where<disp-formula id="equ1"><mml:math id="m1"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>§k</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>is the mean of Gaussian process posterior function, and <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the variance of Gaussian process posterior function. In this work, we assume that the kernel function <inline-formula><mml:math id="inf68"><mml:mi>k</mml:mi></mml:math></inline-formula> is stationary. <inline-formula><mml:math id="inf69"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is the observation noise of the experiment.</p><p><xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> shows an example of a Gaussian process prior to being updated to a Gaussian posterior using observations. The uncertainty of GP distribution decreases around the observed points and increases further away from observations. For a more comprehensive explanation of Gaussian process regression, see <xref ref-type="bibr" rid="bib29">Rasmussen and Williams, 2006</xref>.</p></sec><sec sec-type="appendix" id="s10"><title>3. Bayesian optimization overview</title><p>Bayesian optimization is a common black-box optimization method used to determine the input parameter <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, which maximizes the objective function <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> with as few executions as possible using iterative experiment-observation loops.<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:mo>⁡</mml:mo><mml:munder><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> shows a toy example of how sequential Bayesian optimization generates the next experimental parameter. Bayesian optimization iteratively generates the following experimental parameters in three steps: construction of a surrogate model (e.g., Gaussian process regression) for past experimental results (left column), definition of an acquisition function <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (e.g., expected Improvement), and optimization of the acquisition function to obtain the next experimental parameter (right column). For a more comprehensive explanation and application of Bayesian optimization, see <xref ref-type="bibr" rid="bib3">Frazier and Wang, 2015</xref> and <xref ref-type="bibr" rid="bib31">Shahriari et al., 2016</xref>.</p></sec><sec sec-type="appendix" id="s11"><title>4. Bayesian optimization for the iPSC-RPE protocol</title><p>In the batch Bayesian optimization for the iPSC-RPE differentiation protocol, we generated the next experimental queries for each round in four steps (Algorithm 1). First, we constructed a Gaussian process posterior using a past experimental dataset. When no prior experimental results existed, we generated the next query from random uniform sampling. Next, using the Gaussian process posterior, we obtained an acquisition function. In this study, we used the expected improvement (<xref ref-type="bibr" rid="bib9">Jones et al., 1998</xref>) as the acquisition function. Third, using the acquisition function, we generated a next experimental parameter set <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> using a policy function. In this study, we used batch contextual local penalization (BCLP) as the batch generation policy. Finally, after executing experiments on the parameter set <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, we computed the optimal context for the Detach trypsin Period <inline-formula><mml:math id="inf75"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for the next round.</p><p>In Gaussian process regression, we assume the ARD-RBF kernel function <inline-formula><mml:math id="inf76"><mml:mi>k</mml:mi></mml:math></inline-formula> as follows:<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>represents d-dimensional length scale hyper-parameters that were optimized using the maximum-likelihood estimation in every GP fitting.</p><p>Based on the experimental results in <xref ref-type="fig" rid="fig2">Figure 2E</xref>, the observation noise was assumed to follow a normal distribution with a variance of 0.039, at all points in the search space.</p><p>In this work, we used the expected improvement as an acquisition function. The expected improvement estimates how much improvement over the current best score <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is expected from each one of the input parameters <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in the search space, as shown in the following form:<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>is the set of the past experimental results. <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the standard normal cumulative distribution function, and <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the standard normal probability density function.</p><p>In the policy function (see <xref ref-type="fig" rid="fig3">Figure 3E</xref>), BCLP iteratively generated the parameter for each value of the contextual parameter <italic>DP</italic> in ascending order by maximizing and penalizing the acquisition function 48 times to obtain the next experimental parameters <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Here we show the algorithm that generates <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). Starting from plate1, well1, BCLP fixes the value of the <italic>DP</italic> corresponding to a given well number and then maximizes the acquisition function to generate an experimental parameter for the well. The penalization of the acquisition function is then performed using a hammer function to the point where the experimental parameter is generated. Similarly, for the next well, an experimental parameter is generated by maximizing the penalized acquisition function and is penalized using the hammer function. By repeating such maximization-penalization loops, BCLP generates the next experimental parameters for each subsequent well.</p><p>In Algorithm 2, the function <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is a local penalizer of <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> at <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> such that:<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>φ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>for <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the complementary error function, <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the best score in the past experiments and <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mi>χ</mml:mi></mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">∇</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is an approximated Lipschitz constant. Both <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> were calculated in each round. We used <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> when the acquisition function <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> was positive and the <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> elsewhere (<xref ref-type="bibr" rid="bib5">Gonzalez et al., 2016</xref>).</p><p>For the contextual parameter <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, contexts on a fixed trypsin processing time <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are assigned for each well depending on the round number <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and the well number <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, because of the implementation constraints of the protocol. After each round, the context on the <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is reconfigured as a variable. In the initial state (round <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), trypsin treatment time was assigned to the smallest well number (well 1) for eight minutes, and then it increased by three minutes for each additional well number.<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>:=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mn>11</mml:mn><mml:mo>,</mml:mo><mml:mn>14</mml:mn><mml:mo>,</mml:mo><mml:mn>17</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>23</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In the next round, the context on <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> was allowed to move back and forth <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> in parallel while maintaining a three minute interval processing time between the different wells. Thus, the context in round 2 <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> will be <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> as follows:<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>:=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mn>11</mml:mn><mml:mo>,</mml:mo><mml:mn>14</mml:mn><mml:mo>,</mml:mo><mml:mn>17</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>23</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>:=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mn>11</mml:mn><mml:mo>,</mml:mo><mml:mn>14</mml:mn><mml:mo>,</mml:mo><mml:mn>17</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>:=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>11</mml:mn><mml:mo>,</mml:mo><mml:mn>14</mml:mn><mml:mo>,</mml:mo><mml:mn>17</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>23</mml:mn><mml:mo>,</mml:mo><mml:mn>26</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using the flow shown in Algorithm 3 in each round, we could choose whether the context in the next round <inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> will be <inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, based on the past experimental data.</p><p>We performed a regression with GPR in each round and defined the acquisition function EI based on the regressions, deriving the integral value of the EI for <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for each different candidate interval of <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (either at 5 min, 8 min, or 11 min start), respectively. When any derived integrals were improved by 5% or more compared to the integrals in the interval used in the current round, the interval for the <italic>DP</italic> for the next round was run in the interval that showed the largest integral value among the candidate intervals.</p></sec><sec sec-type="appendix" id="s12"><title>5. Testing optimization in simulation</title><p>Bayesian optimization was tested by optimizing the seven dimensional toy testing function shown in <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref> under different conditions. <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4A</xref> shows a comparison between the performance of batch Bayesian optimization and that of random search when the scale of the observation noise on the testing function was changed. The testing function with different noise (SD=0.000, 0.064, 0.400) was optimized using batch Bayesian optimization with batch contextual local penalization (BCLP) and uniform random sampling, using 8 plates × 6 wells=48 queries per round. In each condition, we performed 18 independent experiments. When the observation noise was not present (SD=0.000) or was sufficiently small (SD=0.064), as in the proposed system shown in <xref ref-type="fig" rid="fig2">Figure 2E</xref>, BCLP shows better convergence performance compared to the random search. When the scale of the observation noise was relatively large (SD=0.400), the performance of BCLP was only as good as that of the random search case.</p><p><xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4B</xref> compares the performances of BCLP when the batch size was changed. For the benchmark function (noise SD=0.064), optimization was performed using a different number of plates (Np) per round. In each condition, we performed n=18 independent experiments and showed that the convergence performance improved as the number of plates (the batch size) increased.</p></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.77007.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Méndez-Ferrer</surname><given-names>Simón</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United Kingdom</country></aff></contrib></contrib-group><related-object id="sa0ro1" link-type="continued-by" object-id="10.1101/2020.11.25.392936" object-id-type="id" xlink:href="https://sciety.org/articles/activity/10.1101/2020.11.25.392936"/></front-stub><body><p>The manuscript by Kanda GN, Natsume T et al. describes a robotic artificial intelligence system with a batch Bayesian optimization algorithm that allows to optimise and reliably repeat cell culture protocols. The authors utilise induced pluripotent stem cell-derived retinal pigment epithelial cells as a model culture system of broad interest in regenerative medicine. They demonstrate that the robotic system with a Bayesian algorithm accelerates the optimisation of cell culture protocols and increases the quality and quantity of cell products, compared with manual operations – these results will likely inform and strongly impact modern cell culture strategies in regenerative medicine. The manuscript clearly explains the parameters analysed, the methods and analyses performed, current limitations and possible broader future use beyond the system tested.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.77007.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Méndez-Ferrer</surname><given-names>Simón</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Méndez-Ferrer</surname><given-names>Simón</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United Kingdom</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Sebastian</surname><given-names>Sujith</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0227qpa16</institution-id><institution>Clinical Biotechnology Centre, NHSBT</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Monville</surname><given-names>Christelle</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04g9rt435</institution-id><institution>Institut des Cellules Souches pour le Traitement et l'Étude des Maladies Monogéniques</institution></institution-wrap><country>France</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2020.11.25.392936">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.11.25.392936v2">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Robotic Search for Optimal Cell Culture in Regenerative Medicine&quot; for consideration by <italic>eLife</italic>, and apologies for the protracted review process. Your article has been positively reviewed by 3 peer reviewers, including Simón Méndez-Ferrer as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by a Reviewing Editor and Mone Zaidi as the Senior Editor. The following individuals involved in the review of your submission have agreed to reveal their identity: Sujith Sebastian (Reviewer #2); Christelle Monville (Reviewer #3).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Given the potentially strong impact of this study on future automation of cell culture processes, it would be helpful to rephrase some general sentences to more specifically describe the results (the relevance is appreciated in any case) and more precisely indicate the cell culture parameters tested/optimised in the current model, and those amenable to be subsequently tested in future applications. Similarly, a clear description of potential limitations (such as necessary manual optimisation or certain conditions or complex protocols less amenable to be automated) would be helpful in order to inform the readership on the potential implications of these results, beyond induced pluripotent stem cell-derived retinal pigment epithelial cells.</p><p>2) The authors take the simple &quot;pigmentation&quot; criteria as the optimisation's read-out. I would suggest describing a little more how they define the pigmentation score and how they judge that it is relevant to good cell quality. They have assessed the function and phenotype of the cells by the measure of classical markers (by qPCR, IF and Elisa) but they should correlate &quot;pigmentation score&quot; and those results.</p><p>Moreover, I would suggest discussing if this approach is robot-dependant or if it would be suitable for any type of culture automate.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.77007.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Given the potentially strong impact of this study on future automation of cell culture processes, it would be helpful to rephrase some general sentences to more specifically describe the results (the relevance is appreciated in any case) and more precisely indicate the cell culture parameters tested/optimised in the current model, and those amenable to be subsequently tested in future applications.</p></disp-quote><p>We agree with the reviewers that a more precise description of the elucidation of the parameters makes the manuscript more “self-contained.” In this study, we focused on the seven parameters shown in Table 1 and described in &quot;Parameterization of the protocol&quot; in the Results. The iPSC-RPE induction protocol (target process) has many other potential parameters, including other chemicals, culture media, and the order of manipulation. Due to computational combination limits and the practical limits on the number of physical attempts that can be performed by a robot, we searched for an appropriate set of parameters based on previous cell culture studies and expert opinions. The seven parameters are search ranges carefully selected for the current target process. Thus, different appropriate parameters should be selected as search ranges for other target processes, including induction of differentiation into other tissue types. We have explained this in the Discussion.</p><disp-quote content-type="editor-comment"><p>Similarly, a clear description of potential limitations (such as necessary manual optimisation or certain conditions or complex protocols less amenable to be automated) would be helpful in order to inform the readership on the potential implications of these results, beyond induced pluripotent stem cell-derived retinal pigment epithelial cells.</p></disp-quote><p>We have modified the Discussion to include this point.</p><disp-quote content-type="editor-comment"><p>2) The authors take the simple &quot;pigmentation&quot; criteria as the optimisation's read-out. I would suggest describing a little more how they define the pigmentation score and how they judge that it is relevant to good cell quality. They have assessed the function and phenotype of the cells by the measure of classical markers (by qPCR, IF and Elisa) but they should correlate &quot;pigmentation score&quot; and those results.</p></disp-quote><p>In this study, we demonstrated that robotic search can be applied to search conditions for transplanted cells by first screening with the pigmented cell rate (score) as an evaluation indicator and then evaluating other criteria (RT-PCR, ELISA, IHC) in purified cells according to previous studies (Kuroda et al., 2019; Mandai et al., 2017; Regent et al., 2019). When preparing iPSC-RPE cells for transplantation in clinical research, a clinical team evaluates the rate of pigmented cells, gene expression, and secretory substances in cells subjected to differentiation induction followed by purification. This quality assessment is not based on a total score, and only those that satisfy all the criteria in all items are suitable for transplantation. Because cell pigmentation is one of the criteria for the assessment, cell pigmentation is not a sufficient condition for cell quality, but can be a requirement. For this reason, rates of pigmented cells are usually used as an indicator of differentiation induction efficiency.</p><p>The pigmentation score used in this study does not reflect the degree of pigmentation in individual cells, but indicates how many cells in the dish have pigmentation above the threshold. It is important to note that, since pigmented and unpigmented cells are mixed in the dish at the time when induction ends (before the purification process), single-cell RNA-seq is required to correctly evaluate the correlation between pigmentation and internal state (transcriptome) in individual cells; its implementation is a future challenge for us. Even in the case of evaluating cell quality by single-cell RNA-seq, cell quality (iPSC-RPE-ness) must be expressed as a one-dimensional value to apply the BBO algorithm adopted in this paper. To our knowledge, there is currently no way of defining a single value as “iPSC-RPE-ness” from transcriptome data. Hence, the development of the method is out of the scope of this study. In the future, the development of an evaluation value of “iPSC-RPE-ness” will allow us to replace the cell pigmentation rate used as the score in this paper. We believe that this will further improve our developed process.</p><p>To provide appropriate information to the reader, we have added explanatory text in the Discussion.</p><disp-quote content-type="editor-comment"><p>Moreover, I would suggest discussing if this approach is robot-dependant or if it would be suitable for any type of culture automate.</p></disp-quote><p>Our approach is not robot-dependent. However, the results of many types of cell culture experiments can be affected by subtle changes in operations, and require careful design and calibration of the hardware. In this study, we chose LabDroid Maholo because of its flexibility, reliability, and accuracy, which are characteristics required for the iPSC-RPE induction process. Our architecture and computational algorithms should work well with other types of culture automation hardware (or even humans) if these exhibit sufficient accuracy and reliability. We emphasized this in the Discussion.</p></body></sub-article></article>