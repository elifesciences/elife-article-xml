<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">71968</article-id><article-id pub-id-type="doi">10.7554/eLife.71968</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>The evolution of division of labour in structured and unstructured groups</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-228475"><name><surname>Cooper</surname><given-names>Guy Alexander</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1748-8183</contrib-id><email>guy.cooper@zoo.ox.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-245594"><name><surname>Frost</surname><given-names>Hadleigh</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-245595"><name><surname>Liu</surname><given-names>Ming</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5170-8688</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-42516"><name><surname>West</surname><given-names>Stuart Andrew</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2152-3153</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>St John's College</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution>Department of Zoology, University of Oxford</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution>Mathematical Institute, University of Oxford</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Goldstein</surname><given-names>Raymond E</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Senior Editor</role><aff><institution>Max Planck Institute for Developmental Biology</institution><country>Germany</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>29</day><month>10</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e71968</elocation-id><history><date date-type="received" iso-8601-date="2021-07-06"><day>06</day><month>07</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-10-26"><day>26</day><month>10</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Cooper et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Cooper et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-71968-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="commentary" xlink:href="10.7554/eLife.75243"/><abstract><p>Recent theory has overturned the assumption that accelerating returns from individual specialisation are required to favour the evolution of division of labour. Yanni et al., 2020, showed that topologically constrained groups, where cells cooperate with only direct neighbours such as for filaments or branching growths, can evolve a reproductive division of labour even with diminishing returns from individual specialisation. We develop a conceptual framework and specific models to investigate the factors that can favour the initial evolution of reproductive division of labour. We find that selection for division of labour in topologically constrained groups: (1) is not a single mechanism to favour division of labour—depending upon details of the group structure, division of labour can be favoured for different reasons; (2) always involves an efficiency benefit at the level of group fitness; and (3) requires a mechanism of coordination to determine which individuals perform which tasks. Given that such coordination must evolve prior to or concurrently with division of labour, this could limit the extent to which topological constraints favoured the initial evolution of division of labour. We conclude by suggesting experimental designs that could determine why division of labour is favoured in the natural world.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>specialisation</kwd><kwd>phenotypic heterogeneity</kwd><kwd>synergy</kwd><kwd>cooperation</kwd><kwd>division of labour</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010663</institution-id><institution>H2020 European Research Council</institution></institution-wrap></funding-source><award-id>834164</award-id><principal-award-recipient><name><surname>West</surname><given-names>Stuart Andrew</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The evolution of division of labour with non-accelerating returns from specialisation can occur for several reasons, including but not limited to topologically constrained group structures, but there must always be a group efficiency benefit and a coordination mechanism is required.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Division of labour, where cooperating individuals specialise to carry out distinct tasks, plays a key role at all levels of biology (<xref ref-type="bibr" rid="bib3">Bourke, 2011</xref>; <xref ref-type="bibr" rid="bib28">Queller, 1997</xref>; <xref ref-type="bibr" rid="bib21">Maynard Smith and Szathmáry, 1995</xref>; <xref ref-type="bibr" rid="bib40">West et al., 2015</xref>). Cells are built by genes carrying out different functions (<xref ref-type="bibr" rid="bib3">Bourke, 2011</xref>; <xref ref-type="bibr" rid="bib17">Levin and West, 2017</xref>). In clonal groups of bacteria, cells specialise to produce and secrete different factors that facilitate growth (<xref ref-type="bibr" rid="bib7">Dragoš et al., 2018a</xref>; <xref ref-type="bibr" rid="bib39">Veening et al., 2008</xref>; <xref ref-type="bibr" rid="bib41">West and Cooper, 2016</xref>). Pathogens rely on division of labour for protection from the host immune response and competitors (<xref ref-type="bibr" rid="bib1">Ackermann et al., 2008</xref>; <xref ref-type="bibr" rid="bib6">Diard et al., 2013</xref>). Multicellular organisms are composed of reproductive germ cells and sterile somatic cells that are not passed to the next generation (<xref ref-type="bibr" rid="bib3">Bourke, 2011</xref>; <xref ref-type="bibr" rid="bib21">Maynard Smith and Szathmáry, 1995</xref>). The ecological dominance of the social insects arises from division of labour between queens and the different types of workers (castes) (<xref ref-type="bibr" rid="bib13">Hölldobler and Wilson, 1990</xref>; <xref ref-type="bibr" rid="bib25">Oster and Wilson, 1978</xref>).</p><p>It has long been established that the evolution of division of labour requires an efficiency benefit from individual specialisation (<xref ref-type="fig" rid="fig1">Figure 1A and B</xref> for reproductive division of labour) (<xref ref-type="bibr" rid="bib3">Bourke, 2011</xref>; <xref ref-type="bibr" rid="bib4">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib14">Ispolatov et al., 2012</xref>; <xref ref-type="bibr" rid="bib23">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib25">Oster and Wilson, 1978</xref>; <xref ref-type="bibr" rid="bib31">Schiessl et al., 2019</xref>; <xref ref-type="bibr" rid="bib2">Biggart, 1776</xref>; <xref ref-type="bibr" rid="bib21">Maynard Smith and Szathmáry, 1995</xref>; <xref ref-type="bibr" rid="bib32">Solari et al., 2013</xref>). In particular, that there is an accelerating (convex) return when individuals commit more effort to a particular task, such that twice the investment more than doubles the return (<xref ref-type="bibr" rid="bib3">Bourke, 2011</xref>; <xref ref-type="bibr" rid="bib4">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib14">Ispolatov et al., 2012</xref>; <xref ref-type="bibr" rid="bib23">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib32">Solari et al., 2013</xref>). An accelerating return from individual investment can exist for several reasons. A task could become more effective as more effort is put into it, or it could be carried out with diminishing costs. This could occur if there are large upfront costs from performing a task. For instance, any reproduction by a cell in Volvocine groups first requires individual growth to the size of a daughter colony (<xref ref-type="bibr" rid="bib23">Michod, 2006</xref>). Alternatively, there could be a disruptive cost to carrying out multiple tasks at the same time if the tasks do not mix well. For instance, in cyanobacteria the enzymes that fix environmental nitrogen are degraded by oxygen, a bi-product of photosynthesis (<xref ref-type="bibr" rid="bib11">Flores and Herrero, 2010</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Division of labour is favoured by accelerating returns from individual specialisation.</title><p>(<bold>A</bold>) Theory has shown that either a linear or diminishing return from more cooperation (or reproduction) favours uniform cooperation, with all individuals investing the same amount of effort into cooperation and reproduction (i.e. no division of labour) (<xref ref-type="bibr" rid="bib4">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib23">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib31">Schiessl et al., 2019</xref>). (<bold>B</bold>) In contrast, an accelerating return from more cooperation (or reproduction) favours reproductive division of labour, with some individuals specialising in high levels of cooperation (helpers) and others in low levels of cooperation (reproductives) (<xref ref-type="bibr" rid="bib4">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib23">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib31">Schiessl et al., 2019</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-fig1-v2.tif"/></fig><p>In contrast, Yanni et al. found that division of labour between helpers and reproductives can sometimes be favoured even when there are diminishing (concave) returns from individual specialisation (<xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>). Specifically, reproductive division of labour could arise in topologically constrained groups—where each cell in a spatially structured group shares cooperative benefits with only their direct neighbours (<xref ref-type="bibr" rid="bib33">Staps and Tarnita, 2020</xref>; <xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>). Their analyses suggested that this is particularly likely to occur in sparsely structured groups, where cells have a small number of neighbours (<xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>). This is a novel result. Diminishing returns means that specialised individuals are inefficient, and earlier work suggested that division of labour could not be favoured in this situation (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, <xref ref-type="bibr" rid="bib4">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib23">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib31">Schiessl et al., 2019</xref>). Consequently, this result has the potential to overturn our understanding of the factors that favour the evolution of division of labour.</p><p>However, there are several issues that still need to be resolved with how topological constraints can favour division of labour. Why exactly do the predictions of this new theory differ from previous theory? Are special group structures the only way to alter the predictions of the previous theory, or is this an example of a more general phenomenon (<xref ref-type="bibr" rid="bib30">Rueffler et al., 2012</xref>)? Do these findings rely upon implicit assumptions, which may not be reasonable during the initial evolution of division of labour? Answering these questions is not only of theoretical importance: it is also key for planning future empirical studies. Quantifying the shape of the returns from individual specialisation has been assumed to be a fundamental step in determining why division of labour was favoured in some species, but not others (<xref ref-type="bibr" rid="bib6">Diard et al., 2013</xref>; <xref ref-type="bibr" rid="bib7">Dragoš et al., 2018a</xref>; <xref ref-type="bibr" rid="bib11">Flores and Herrero, 2010</xref>; <xref ref-type="bibr" rid="bib16">Koufopanou, 1994</xref>; <xref ref-type="bibr" rid="bib24">Mridha and Kummerli, 2021</xref>; <xref ref-type="bibr" rid="bib34">Strassmann et al., 2000</xref>; <xref ref-type="bibr" rid="bib39">Veening et al., 2008</xref>).</p><p>We first use the methodology developed by <xref ref-type="bibr" rid="bib30">Rueffler et al., 2012</xref>, to derive the general conditions that favour the initial evolution of reproductive division of labour between helpers and reproductives. We then use this framework to examine when and why topological constraints can favour division of labour. More specifically, we determine the ultimate cause of division of labour in specific topologically constrained groups, such as filaments and branching growths, as well as in a general analysis of arbitrary group structures. We then ask whether division of labour without an accelerating return from individual specialisation could arise in groups without topological constraints. To test our hypothesis that between-individual coordination is required for division of labour in these cases, we re-examine our models while assuming that cells adopt helper and reproductive roles randomly (no coordination). We finish by suggesting experimental designs for determining why division of labour has evolved in specific species.</p></sec><sec id="s2" sec-type="results|discussion"><title>Results and discussion</title><sec id="s2-1"><title>General invasion analysis</title><p>We follow previous studies by assuming that individual fitness is the product of individual viability, which is the chance of surviving to maturity, and individual fecundity, which is proportional to the number of offspring if the individual reaches maturity (<xref ref-type="bibr" rid="bib4">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib23">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>). We examine the specific case of reproductive division of labour between helpers and reproductives, where helpers are more cooperative, contributing to a higher viability for group members, and reproductives are less cooperative, contributing to higher individual fecundity.</p><p>We consider an initial population of clonal groups each containing <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> individuals, in which all individuals cooperate at the evolutionarily stable (ES) level (<inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>), which is the level that cannot be outcompeted by a mutant strain that uses a different level of uniform cooperation across the group (<xref ref-type="bibr" rid="bib20">Maynard Smith, 1982</xref>). We then ask when this population of uniform cooperators can be invaded by a mutant strain that employs a reproductive division of labour.</p><p>Without loss of generality, we assume that the mutant strain is composed of <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> helpers that invest <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> into cooperation and <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> reproductives that invest <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> into cooperation (where <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>). We set individual fitness as the product of individual fecundity, <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and individual viability, where helpers and reproductives may in principle have different viability functions, <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (but see Appendix C.2) (<xref ref-type="bibr" rid="bib23">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>). The fitness of the clonal group is given by the sum of individual fitness:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where the first term on the right-hand side is the total fitness of the prospective helpers and the second term on the right-hand side is the total fitness of the prospective reproductives.</p><p>Fecundity is determined by an individual’s investment in cooperation (<inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf13"><mml:mi>z</mml:mi></mml:math></inline-formula> is the focal individual’s level of cooperation) and viability is determined by the level of cooperation at the level of the group (<inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). We assume that there is a tradeoff between fecundity and viability such that higher individual cooperation leads to lower individual fecundity (<inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), but that more cooperation leads to a higher viability for all individuals (i.e. <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, where superscripts denote partial derivatives). We assume that viability selection occurs just prior to reproduction. This is consistent with previous models and ensures that there there is no feedback between a cell’s viability and its ability to produce cooperative benefits for the group (<xref ref-type="bibr" rid="bib4">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib23">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>).</p><p>We determine the invadability conditions that favour reproductive division of labour by applying the general approach of <xref ref-type="bibr" rid="bib30">Rueffler et al., 2012</xref>. The key step is to approximate the relative fitness of a reproductive division of labour mutant by taking a second-order Taylor expansion of fitness, centred on the resident strategy of uniform cooperation, <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ3"><label>(2)</label><mml:math id="m3"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="1em"/><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="1em"/><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> captures the change in the level of cooperation for mutant helpers and reproductives, respectively, which we assume are small in magnitude. The superscripts represent first- and second-order partial derivatives, where all partial derivatives are evaluated at the resident strategy of uniform cooperation (<inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>). If a mutant strain exists such that <xref ref-type="disp-formula" rid="equ3">Equation 2</xref> is positive (<inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), then division of labour between helpers and reproductives is favoured to evolve. Conversely, if for all possible mutant strains, <xref ref-type="disp-formula" rid="equ3">Equation 2</xref> is negative (<inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), then uniform cooperation is evolutionarily stable.</p></sec><sec id="s2-2"><title>The three pathways to division of labour</title><p>We found that reproductive division of labour could be favoured for three distinct reasons, corresponding to different subsets of terms on the right-hand side of <xref ref-type="disp-formula" rid="equ3">Equation 2</xref>. Our results for reproductive division of labour, where fitness is partitioned as the product of fecundity and viability, align with those found by <xref ref-type="bibr" rid="bib30">Rueffler et al., 2012</xref>, for division of labour more generally. We now go through these three distinct scenarios.</p><sec id="s2-2-1"><title>Scenario 1: Accelerating returns from individual specialisation</title><p>The first and most studied scenario that can favour division of labour is when there are accelerating returns from individual specialisation. This occurs if there is an accelerating fitness return from either helper specialisation in cooperation or reproductive specialisation in fecundity (<xref ref-type="fig" rid="fig1">Figure 1</xref>; <xref ref-type="bibr" rid="bib4">Cooper and West, 2018</xref>; <xref ref-type="bibr" rid="bib23">Michod, 2006</xref>; <xref ref-type="bibr" rid="bib25">Oster and Wilson, 1978</xref>).</p><p>Mathematically, this scenario is a consequence of the third and fourth terms of the Taylor expansion (<inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), which capture the second-order fitness effect of a small, unilateral change in cooperation by either prospective helpers or reproductives, respectively. Division of labour is favoured to evolve whenever at least one of <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is greater than zero (<inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), and where we have assumed that the first two terms are both zero (<inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; see between-individual differences below; <xref ref-type="fig" rid="fig2">Figure 2A</xref>). In either scenario, an efficiency benefit to group fitness arises from individual specialisation because the more effort that each individual puts into a task, the better they can perform that task. Rueffler et al. termed these kinds of scenario as ‘accelerating performance functions’ (<xref ref-type="bibr" rid="bib30">Rueffler et al., 2012</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Division of labour is favoured by between-individual differences.</title><p>Division of labour is favoured if some individuals are predisposed to being reproductives or helpers. (<bold>A</bold>) In the absence of another mechanism, if there are no differences between individuals (black and grey lines), then division of labour is not favoured. (<bold>B</bold>) If some individuals can produce larger viability benefits than others (black line), or if some individuals can access greater fecundity benefits than others (grey line), then this predisposition favours division of labour.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-fig2-v2.tif"/></fig></sec><sec id="s2-2-2"><title>Scenario 2: Between-individual differences</title><p>The second scenario that can favour reproductive division of labour is when there are pre-existing differences between individuals in the group, such that some individuals are predisposed to one task or the other. For example, if some individuals can secure larger viability benefits for the group at the same fecundity cost as others (<xref ref-type="fig" rid="fig2">Figure 2B</xref>).</p><p>This scenario is captured by the first two terms of the Taylor expansion <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mtext>and</mml:mtext><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> , which are the first-order fitness effects from a small, unilateral change in the level of cooperation by prospective helpers or reproductives. If the direct fitness effects are non-zero (positive or negative) at the resident strategy of uniform cooperation (<inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), then division of labour can invade independently of any higher-order effects (the remaining terms in <xref ref-type="disp-formula" rid="equ3">Equation 2</xref>).</p><p>We term this scenario ‘between-individual differences’ because it requires that there is pre-existing phenotypic or environmental variation between individuals in the group. For the within-species case, ancestral groups are usually composed of clonal or highly related individuals, who will be phenotypically similar or identical. Consequently, this mechanism could be less important for the division of labour except when there are consistent differences in the microenvironment experienced by different individuals (<xref ref-type="bibr" rid="bib36">Tverskoi et al., 2018</xref>; <xref ref-type="bibr" rid="bib37">Tverskoi and Gavrilets, 2021</xref>). In contrast, this scenario is likely to be widespread in the evolution of non-reproductive division of labour between species, such as for mutualisms or symbioses (<xref ref-type="bibr" rid="bib15">Kiers et al., 2011</xref>; <xref ref-type="bibr" rid="bib30">Rueffler et al., 2012</xref>; <xref ref-type="bibr" rid="bib42">Wyatt et al., 2014</xref>). Individuals of different species often differ in their abilities to perform certain tasks (<xref ref-type="bibr" rid="bib15">Kiers et al., 2011</xref>). Rueffler et al. termed this scenario ‘positional’, but we avoid that term to prevent confusion with topological position (<xref ref-type="bibr" rid="bib30">Rueffler et al., 2012</xref>).</p><p>Between-individual differences provide a first-order fitness benefit to dividing labour, and so it does not matter whether the subsequent benefits of increased cooperation or fecundity are accelerating or diminishing (<xref ref-type="fig" rid="fig1">Figure 1</xref>), so long as these benefits are different for different individuals (<xref ref-type="fig" rid="fig2">Figure 2</xref>). When some individuals are predisposed to being either helpers or reproductives, then individual specialisation provides an efficiency benefit to group fitness by capitalising on these inherent differences.</p></sec><sec id="s2-2-3"><title>Scenario 3: Reciprocal specialisation</title><p>The final scenario that can favour division of labour is when reciprocal specialisation by both helpers and reproductives provides a fitness benefit to the group (<xref ref-type="fig" rid="fig3">Figure 3</xref>). This scenario requires two key conditions. First, simultaneous specialisation, where some individuals invest more in cooperation (more viability benefits for the group), and others invest less in cooperation (greater individual fecundity; but see below). Second, this reciprocal specialisation must provide a group-level fitness benefit, because the increased benefits of cooperation are preferentially directed towards reproductives.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Division of labour is favoured by reciprocal specialisation.</title><p>We assume that there are diminishing returns from specialisation in either viability or fecundity (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). (<bold>A</bold>) In this case, a unilateral increase in cooperation by helpers or a unilateral decrease in cooperation by reproductives leads to a diminishing fitness benefits to the group, which favours uniform cooperation (no division of labour). (<bold>B</bold>) In contrast, a reciprocal increase in cooperation by helpers (more viability benefits provided by helpers) and a decrease in cooperation by reproductives (larger reproductive fecundity) can produce an accelerating return to the fitness of the group if the benefits of increased cooperation are preferentially directed to reproductives. Thus, reciprocal specialisation can still favour division of labour, even though the returns from individual specialisation are diminishing. In the middle plots of (<bold>A</bold>) and (<bold>B</bold>), only the shape of the benefits from increased specialisation is plotted.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-fig3-v2.tif"/></fig><p>Mathematically, this scenario involves the last term of the Taylor expansion (<inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>). This term is generated by a between-individual, second-order fitness effect, capturing how increased investment in viability by some individuals affects the returns from increased investment in fecundity by others, and vice versa. Rueffler et al. referred to this as a ‘synergistic benefit’ to division of labour (<xref ref-type="bibr" rid="bib27">Queller, 1985</xref>; <xref ref-type="bibr" rid="bib29">Queller, 2011</xref>; <xref ref-type="bibr" rid="bib30">Rueffler et al., 2012</xref>).</p><p>Critically, this scenario still involves an efficiency benefit to specialisation, but at the level of group fitness rather than in each fitness component separately (Appendix C.1). By this we mean that there is an accelerating fitness benefit to the group when helpers and reproductives reciprocally specialise, leading to a higher group fitness than in groups with uniform cooperation (generalists). This occurs if the increased help given to reproductives is sufficiently amplified by the increased fecundity of reproductives (<xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>). This synergistic efficiency benefit can favour division of labour even if there are diminishing returns from individual specialisation.</p><p>Division of labour by reciprocal specialisation can also evolve without a joint mutation in the level of cooperation of both helpers and reproductives (no simultaneous specialisation). In this case, the chance invasion (to fixation) of a slightly deleterious mutant that specialises in only one phenotype can destabilise uniform cooperation, creating a selection pressure for the other phenotype to also specialise that is greater than the selection pressure to purge the initial mutant. In this two-step scenario, it is nevertheless the synergistic benefit from reciprocal specialisation that makes division of labour more efficient.</p></sec></sec><sec id="s2-3"><title>Group structure in the general framework</title><p>Our above analysis has shown that reproductive division of labour can be favoured for three reasons: (1) accelerating returns make individual specialisation more efficient; (2) between-individual differences make individual specialisation more efficient; and (3) there is a synergistic efficiency benefit from reciprocal specialisation. These results agree with previous analyses by <xref ref-type="bibr" rid="bib30">Rueffler et al., 2012</xref>.</p><p>We now use this framework to examine how and why topological constraints can favour division of labour in the absence of an accelerating return from individual specialisation (i.e. when scenario 1 does not hold). We ask three questions. First, can topological constraints favour division of labour by between-individual differences (scenario 2), and/or by reciprocal specialisation (scenario 3)? Second, are topological constraints the only way to evolve a division of labour without an accelerating return from individual specialisation? Third, does the evolution of division of labour by between-individual differences (scenario 2) and reciprocal specialisation (scenario 3) require coordination between individuals to determine which cells become helpers or reproductives?</p><sec id="s2-3-1"><title>Question 1: How do topological constraints favour division of labour?</title><p>We consider two spatial models, based on the group structures proposed by Yanni et al., to examine whether topologically constrained groups favour division of labour by: (a) between-individual differences and/or (b) reciprocal specialisation (<xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>).</p><sec id="s2-3-1-1"><title>Can topological constrains lead to division of labour by between-individual differences?</title><p>Consider a group in which cells alternately have either two or three neighbours, in a branching structure (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Such a group structure might have occurred for some early forms of multicellular life (<xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>). We term cells with three neighbours ‘node’ cells and cells with two neighbours ‘edge’ cells. We assume that cells investing an amount <inline-formula><mml:math id="inf35"><mml:mi>z</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> into cooperation produce an amount <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of a public good. We assume non-accelerating returns from individual specialisation (i.e. <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). The cell keeps a fraction <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of the public good that it produces, and the remaining fraction <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is shared equally between its direct neighbours (the ‘shareability’ of cooperation: <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>λ</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). We assume that the viability of a cell is equal to the sum of the public good that it absorbs.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>The impact of topological constraints on the division of labour.</title><p>We show here different scenarios in which division of labour can evolve (non-white shades) and the size of its fitness benefit if so (darker shades). We consider three specific spatial models, including: a branching structure (A and D); a filament structure (B and E); and a well-mixed group (C and F). We consider when cells know their location in the group when specialising (with coordination; <bold>A–C</bold>) and when they do not (without coordination; <bold>D–F</bold>), in which case cells specialise randomly. (<bold>A</bold>) In a branching group structure with coordination, division of labour with diminishing returns from specialisation (<inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) can be favoured by between-individual differences whenever the benefits of cooperation are shared (<inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). (<bold>B</bold>) In a filament structure with coordination, division of labour with diminishing returns from specialisation (<inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) can be favoured by reciprocal specialisation when cells share a sufficient majority of the public good they produce with neighbours (e.g. when linear returns: <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>). (<bold>C</bold>) In a well-mixed group with coordination, division of labour with diminishing returns from specialisation (<inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) can be favoured by reciprocal specialisation if cells share an even larger proportion of the public good they produce with neighbours (e.g. when linear returns: <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>). (<bold>D–F</bold>) When cells specialise randomly (no coordination) across all three spatial models, then division of labour can only evolve if there is an accelerating return from specialisation (<inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). Throughout, we have assumed a linear return from fecundity specialisation, <inline-formula><mml:math id="inf49"><mml:mi>F</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:math></inline-formula>, and allow for a non-linear return from investment in cooperation, <inline-formula><mml:math id="inf50"><mml:mi>H</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> , where <inline-formula><mml:math id="inf51"><mml:mi>α</mml:mi></mml:math></inline-formula> controls the shape of the return.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-fig4-v2.tif"/></fig><p>For this model, we find that for all social traits (<inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), reproductive division of labour by between-individual differences can evolve (<xref ref-type="fig" rid="fig4">Figure 4A</xref>; Appendix A.1). This occurs because different cells have different viability-fecundity tradeoffs depending on their position in the group. Edge cells receive relatively less public good from their (fewer) neighbours, and so pay a smaller opportunity cost from decreased fecundity (increased cooperation). In contrast, node cells receive relatively more public good from their (more numerous) neighbours, and so pay a larger opportunity cost from decreased fecundity (increased cooperation). Consequently, this between-cell difference favours node cells to specialise in fecundity (reproductives) and edge cells to specialise in increased cooperation (helpers). Importantly, because this pathway to division of labour is driven entirely by a first-order effect (2a and 2b), it does not require a second-order efficiency benefit from specialisation (2c, 2d, or 2e).</p><p>More generally, a formal analysis of arbitrary group structures reveals that division of labour by between-individual differences can always evolve whenever the number of neighbours varies for different cells in the group (Appendix A.2).</p></sec><sec id="s2-3-1-2"><title>Can topological constraints lead to division of labour by reciprocal specialisation?</title><p>Consider a one-dimensional chain of cells, as examined by Yanni et al. Chains are found in species like cyanobacteria that form filaments of cells, and such structures might have been important at the onset of the evolution of multicellularity (<xref ref-type="fig" rid="fig4">Figure 4</xref>, <xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>). We assume arbitrarily that ‘odd’ cells along the filament are putative helpers and ‘even’ cells are putative reproductives. We otherwise make the same assumptions as for the branching structure model: there is a non-accelerating return from individual specialisation (i.e. <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, and the cell keeps a fraction <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of the public good that it produces, with the remaining fraction <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> being shared equally by its direct neighbours.</p><p>If the amount of public good shared with neighbours is sufficiently large (high <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), then we find that division of labour via reciprocal specialisation can evolve (<xref ref-type="fig" rid="fig4">Figure 4B</xref>; Appendix A. 3). For instance, in the case of linear fecundity and public good returns (<inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), division of labour by reciprocal specialisation can evolve if helpers share more of the public good that they produce with their neighbours than they keep for themselves (<inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>). If there are diminishing returns from specialisation (<inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), then division of labour can still be favoured but then the amount of the public good preferentially shared with neighbours must be even greater still (higher <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> <xref ref-type="fig" rid="fig4">Figure 4E</xref>).</p><p>For an arbitrary group structure, our analysis in the previous section implies that division of labour can evolve by between-individual differences, unless every cell in the group has the same number of neighbours. Consider a group in which every cell has exactly d neighbours. In this case, we show (Appendix A.5) that division of labour can still be favoured due to reciprocal specialisation if:<disp-formula id="equ4"><label>(3)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>λ is the shareability of cooperation as defined previously and <italic>μ</italic> captures how easily the group can be ‘bi-partitioned’. That is, <italic>μ</italic> is a measure of the extent that the group can be divided into two classes of cells such that cells are neighbours with many cells of the opposing class and few neighbours of their own class. Thus, reciprocal specialisation can favour division of labour if: (1) groups are more sparse (low <italic>d</italic>); (2) groups are structured such that helpers can be neighbours with reproductives more than with other helpers, and vice versa (high <italic>μ</italic>); and/or (3) when the benefits of cooperation are preferentially shared with neighbours (high <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). In combination, these three factors amplify the synergistic benefits of reciprocal helper and reproductive specialisation, which can produce an accelerating fitness return for the group, even when there are non-accelerating returns from individual specialisation (Appendix C.1).</p><p>If one or two of these factors are particularly favourable for reciprocal specialisation, then the condition(s) on the remaining factor(s) can be relaxed. For instance, cells in a filament have only two neighbours (<inline-formula><mml:math id="inf64"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>), and the potential alternation of helpers and reproductives in the filament means that helpers can share their cooperative public goods with reproductives exclusively (maximal <inline-formula><mml:math id="inf65"><mml:mi>μ</mml:mi><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:math></inline-formula> Consequently, reciprocal specialisation is possible even when the shareability of cooperation is reasonably low (e.g. <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> for linear benefits).</p><p>To conclude, topological constraints are not a single explanation for division of labour, in that they can favour division of labour for two different biological reasons. Different group structures can lead to either between-individual differences favouring division of labour (scenario 2) or reciprocal specialisation favouring division of labour (scenario 3). In all cases, there is an efficiency benefit from specialisation at the level of group fitness even if the returns from individual specialisation are non-accelerating.</p></sec></sec></sec><sec id="s2-4"><title>Question 2: Are topological constraints required for division of labour without accelerating returns from individual specialisation?</title><p>We considered a well-mixed social group of <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> cells, where all cells share the benefits of cooperation with one another, and so there are no topological constraints (<xref ref-type="fig" rid="fig4">Figure 4</xref>). We then examined whether division of labour could be favoured by: (a) between-individual differences; and/or (b) reciprocal specialisation. In both cases, we assume that when a cell invests <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> into cooperation, it produces an amount <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of a public good. A cell keeps a fraction <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of the public good that it produces and the remaining fraction <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is shared by the rest of the social group members equally. We again consider the case where there is a non-accelerating return from individual specialisation (<inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><sec id="s2-4-1"><title>Can between-individual differences favour division of labour without a topological constraint?</title><p>In the well-mixed group of identical cells, we find that division of labour cannot arise by between-individual differences (Appendix A.4). This is because all cells have the same number of neighbours, which we have shown more generally can never produce between-individual differences. This prediction could be violated if one of our assumptions do not hold: for instance, if there are consistent differences in the microenvironment that predispose some cells to one task or the other (<xref ref-type="bibr" rid="bib36">Tverskoi et al., 2018</xref>; <xref ref-type="bibr" rid="bib37">Tverskoi and Gavrilets, 2021</xref>; <xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>).</p></sec><sec id="s2-4-2"><title>Can reciprocal specialisation favour division of labour without a topological constraint?</title><p>In the well-mixed group of identical cells, if the amount of public good shared with neighbours is sufficiently large (high <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), then we find that division of labour via reciprocal specialisation can evolve (<xref ref-type="fig" rid="fig4">Figure 4F</xref>; Appendix A.4). If there are linear returns from increased specialisation (<inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), then division of labour can evolve when the public good produced by an individual benefits an average group member more than the producer (<inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>; <xref ref-type="fig" rid="fig4">Figure 4C</xref>). These results are like those found for a filament of cells (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). In both cases, more generous sharing (higher <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) means that the synergistic benefits of reciprocal specialisation can be great enough to compensate for the non-accelerating returns from individual specialisation. In well-mixed groups, very generous sharing (<inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) also compensates for the fact that helpers are neighbours with all other helpers (no sparsity and minimally ‘bi-partionable’).</p><p>To conclude, the well-mixed model shows that a topological constraint is not required for the evolution of division of labour with non-accelerating returns from individual specialisation. This result is in direct contradiction to that of <xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>. This difference arises because helpers in their model always benefit at least as much as any of its neighbours from its own public good production (<inline-formula><mml:math id="inf79"><mml:mi>λ</mml:mi><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>). Our model allows for biological scenarios where the public good benefits an average neighbour more than the producer (<inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>). For instance, reproductive cells in cyanobacteria may absorb more of the fixed nitrogen produced by helpers than helpers do to meet the large energetic requirements of cell duplication and division (<xref ref-type="bibr" rid="bib11">Flores and Herrero, 2010</xref>; <xref ref-type="bibr" rid="bib12">Herrero et al., 2016</xref>; <xref ref-type="bibr" rid="bib22">Meeks and Elhai, 2002</xref>). At the extreme, the public good can be an ‘others-only’ trait that benefits neighbours but not the producer at all (<inline-formula><mml:math id="inf81"><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib26">Pepper, 2000</xref>). An example of this are the dispersal benefits provided by stalk cells in <italic>Dyctiostelium discodeum</italic> fruiting bodies or the self-sacrificing behaviour of helper cells in <italic>Salmonella enterica</italic> infections (<xref ref-type="bibr" rid="bib1">Ackermann et al., 2008</xref>; <xref ref-type="bibr" rid="bib35">Strmecki et al., 2005</xref>). Consequently, our model allows for a wider spectrum of biologically realistic scenarios. Critically, division of labour can be favoured in a group of well-mixed cells because it provides an efficiency benefit at the group level, via reciprocal specialisation (scenario 3), in an analogous way to our model with a one-dimensional chain of cells (question 1b).</p></sec></sec><sec id="s2-5"><title>Question 3: Is coordination required to favour division of labour without accelerating returns from individual specialisation?</title><p>We hypothesised that the benefits of between-individual differences (scenario 2) or reciprocal specialisation (scenario 3) rely on the implicit assumption that cells are coordinating which individuals specialise to become reproductive and helpers. This matters because mechanisms for coordinating division of labour, such as between cell signalling, might not be expected to exist before division of labour has evolved (<xref ref-type="bibr" rid="bib5">Cooper et al., 2022</xref>; <xref ref-type="bibr" rid="bib18">Liu et al., 2021</xref>). Consequently, if coordination was required, then this could limit the extent to which topological constrains favour the initial evolution of division of labour.</p><p>We investigated this hypothesis by repeating our above analyses, while assuming that cells do not have access to information that allows them to coordinate their phenotypes. Specifically, cells do not know if they are ‘odd’ or ‘even’, or if they are ‘edge’ or ‘node’. We assumed instead that a reproductive division of labour mutant induces each cell in the group to adopt the role of a helper or reproductive with a uniform probability (random specialisation). Random specialisation has been observed in a number of microbes (<xref ref-type="bibr" rid="bib1">Ackermann et al., 2008</xref>; <xref ref-type="bibr" rid="bib6">Diard et al., 2013</xref>; <xref ref-type="bibr" rid="bib39">Veening et al., 2008</xref>). For filaments, branching group structures, and well-mixed groups, we found that division of labour can no longer evolve with non-accelerating returns from individual specialisation (<xref ref-type="fig" rid="fig4">Figure 4D–E</xref>; Appendices B.1 and B.2). In Appendix B.3, we have shown that this result holds for any group structure.</p><p>Consequently, for division of labour to evolve with non-accelerating returns from individual specialisation, there must exist some mechanism to coordinate which cells specialise to perform which tasks. It is possible that the mechanism need not produce a perfect allocation of labour across the group as analysed in our models (<xref ref-type="bibr" rid="bib18">Liu et al., 2021</xref>). However, because division of labour cannot be favoured to evolve if role allocation is fully random, at least some degree of even imperfect between-cell coordination will be required.</p><p>A clear example of coordinated division of labour in topologically constrained groups is the use of between-cell signalling in some cyanobacteria filaments to determine which cells become sterile nitrogen fixing heterocysts and which cells become reproductive photosynthesisers (<xref ref-type="bibr" rid="bib11">Flores and Herrero, 2010</xref>; <xref ref-type="bibr" rid="bib22">Meeks and Elhai, 2002</xref>). However, a signal to coordinate distinct phenotypes must exist prior to or concurrently with the emergence of division of labour, and so a topological constraint is less likely to have favoured the initial evolution of division of labour in cyanobacteria. Alternatively, division of labour could have been favoured by an accelerating return from individual specialisation (scenario 1), with coordination only being favoured to evolve subsequently. Empirically, an accelerating return seems likely, as the key tasks performed by reproductives and helpers do not mix well (photosynthesis and nitrogen fixation) (<xref ref-type="bibr" rid="bib11">Flores and Herrero, 2010</xref>; <xref ref-type="bibr" rid="bib22">Meeks and Elhai, 2002</xref>).</p><p>These analyses do not suggest that topological constraints could never favour the initial evolution of division of labour. For instance, a pre-existing cue could allow division of labour to initially evolve with a metabolically cheaper form of coordination. More specifically, phenotype could be determined in response to the number of neighbours or the local concentration of some resource. Further, if there are pre-existing differences between individuals due to a pre-existing mechanism of coordination, then this mechanism can be co-opted to coordinate division of labour. However, the biological plausibility of any pre-existing mechanism would need to be explicitly justified and modelled on a case-by-case basis (<xref ref-type="bibr" rid="bib9">Duarte et al., 2011</xref>). This would include modelling the metabolic cost, benefits and effectiveness of the mechanism (<xref ref-type="bibr" rid="bib5">Cooper et al., 2022</xref>; <xref ref-type="bibr" rid="bib10">Duarte et al., 2012</xref>; <xref ref-type="bibr" rid="bib18">Liu et al., 2021</xref>). Empirically, while between-cell coordination has evolved in several labour-dividing microbial species, further studies—such as ancestral-state reconstructions—are needed to show whether coordination evolved prior to, concurrently with, or subsequent to division of labour in individual species.</p><p>In contrast, an accelerating return from individual specialisation depends on non-adaptive factors such as the physics, chemistry, or external constraints associated with the public good and its production. For instance, an accelerating return can arise if some intermediate products associated with cooperation and fecundity do not ‘mix-well’ on a chemical level. Consequently, no additional adaptive or pre-adaptation argument is needed to explain this pathway to division of labour.</p></sec><sec id="s2-6"><title>Distinguishing the ultimate causes of division of labour in the wild</title><p>How can we distinguish empirically which of the different scenarios favoured real-world examples of division of labour (<xref ref-type="fig" rid="fig5">Figure 5</xref>)? We suggest experimental designs for microbial systems, where mixtures of helper and reproductive cells are grown together, and which make use of methods to genetically manipulate and measure the relative levels of cooperation and reproduction of each phenotype (<xref ref-type="bibr" rid="bib1">Ackermann et al., 2008</xref>; <xref ref-type="bibr" rid="bib6">Diard et al., 2013</xref>; <xref ref-type="bibr" rid="bib7">Dragoš et al., 2018a</xref>; <xref ref-type="bibr" rid="bib8">Dragoš et al., 2018b</xref>; <xref ref-type="bibr" rid="bib19">Mavridou et al., 2018</xref>; <xref ref-type="bibr" rid="bib24">Mridha and Kummerli, 2021</xref>; <xref ref-type="bibr" rid="bib38">van Gestel et al., 2015</xref>). These are rough suggestions for the kind of experiments required, as details and possibilities will vary system from system, depending upon factors such as the degree of specialisation, the mechanism by which labour is divided, and what manipulations are possible. In addition, these experiments would need to follow from key first steps, such as demonstrating division of labour and a tradeoff between reproduction and cooperation (<xref ref-type="bibr" rid="bib6">Diard et al., 2013</xref>; <xref ref-type="bibr" rid="bib7">Dragoš et al., 2018a</xref>; <xref ref-type="bibr" rid="bib8">Dragoš et al., 2018b</xref>; <xref ref-type="bibr" rid="bib39">Veening et al., 2008</xref>; <xref ref-type="bibr" rid="bib44">Zhang et al., 2020</xref>; <xref ref-type="fig" rid="fig5">Figure 5</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Experimental guidelines to distinguish the causes of division of labour.</title><p>(<bold>A</bold>) To test whether division of labour is favoured by an accelerating return from individual specialisation, we must separately determine whether an increase in helper cooperation or a decrease in reproductive cooperation leads to an accelerating increase in group fitness. (<bold>B</bold>) To test whether division of labour is favoured by between-individual differences, we must determine whether an increase in cooperation by helpers produces a different group fitness benefit than an increase in cooperation by reproductives. (<bold>C</bold>) To test whether division of labour is favoured by reciprocal specialisation, we must determine whether there exists at least one relative degree of helper-to-reproductive specialisation for which group fitness is greater than the fitness of uniform cooperation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-fig5-v2.tif"/></fig><p>Testing for accelerating returns from individual specialisation (scenario 1): In at least three treatments, vary the level of cooperation performed by the helpers (<xref ref-type="fig" rid="fig5">Figure 5A</xref> top-left), to test whether the benefits of increased cooperation are accelerating (<xref ref-type="fig" rid="fig5">Figure 5A</xref> right). Across at least three other treatments, vary the level of reproduction by the reproductives (<xref ref-type="fig" rid="fig5">Figure 5A</xref> bottom-left), to test whether the benefits of increased fecundity are accelerating (<xref ref-type="fig" rid="fig5">Figure 5A</xref> right). At least three treatments are required to be able to test for non-linear (accelerating) benefits.</p><p>Testing for between-individual differences (scenario 2): In some treatments, vary the level of cooperation of helpers (<xref ref-type="fig" rid="fig5">Figure 5B</xref> top-left). In other treatments vary the level of cooperation of reproductives (<xref ref-type="fig" rid="fig5">Figure 5B</xref> bottom-left). If division of labour evolves in this system by between-individual differences, then we should observe that group fitness varies differently depending on whether it is helpers or reproductives that are cooperating at a higher rate (<xref ref-type="fig" rid="fig5">Figure 5B</xref> right).</p><p>Testing for reciprocal specialisation (scenario 3): Use a classic <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> factorial experiment where the level of cooperation performed by helpers and the level of reproduction performed by reproductives are both varied (<xref ref-type="fig" rid="fig5">Figure 5C</xref> left). Division of labour is favoured by reciprocal specialisation if there is a significant interaction term between these two factors, with at least one treatment that produces a group fitness larger than that for uniformly cooperating cells (<xref ref-type="fig" rid="fig5">Figure 5C</xref> right).</p></sec><sec id="s2-7"><title>Conclusion</title><p>Division of labour can be favoured to evolve without accelerating returns from individual specialisation. Nevertheless, for this to occur requires: (a) between-individual differences in task-efficiency or synergistic benefits from reciprocal specialisation and (b) a mechanism to coordinate which individuals perform which tasks. In contrast, accelerating returns can favour division of labour without a mechanism to coordinate task allocation, possibly making it more likely to favour the initial evolution of division of labour. Ultimately, determining the relative importance of these different pathways to division of labour is an empirical question, requiring experimental studies of the type we have outlined above.</p></sec></sec><sec id="s3" sec-type="materials|methods"><title>Materials and methods</title><sec id="s3-1"><title>Resident strategy of uniform cooperation</title><p>We start by solving for the ESS strategy where both types of individuals invest the same amount in cooperation (<inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; uniform cooperation). This is the level of uniform investment in cooperation, <inline-formula><mml:math id="inf84"><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> , for which there is no selection for a uniform change in the amount of cooperation by all individuals in the group:<disp-formula id="equ5">.<mml:math id="m5"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>More explicitly, we can write this as:<disp-formula id="equ6"><label>(4)</label><mml:math id="m6"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>where we have suppressed the functional dependencies for ease of presentation. The first term gives the group fitness change due to a marginal increase in ‘helper’ cooperation, and the second term gives the group fitness change due to a marginal increase in ‘reproductive’ cooperation. So, at the uniform strategy, <inline-formula><mml:math id="inf85"><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> , any increase in the fitness caused by the increased cooperation of one subgroup of the population is balanced by a commensurate decrease in fitness caused by the same increase in cooperation for the other subgroup <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>The constrained optimum, <inline-formula><mml:math id="inf87"><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math></inline-formula> computed using <xref ref-type="disp-formula" rid="equ6">Equation 4</xref> does not necessarily correspond to a critical point of <inline-formula><mml:math id="inf88"><mml:mi>W</mml:mi></mml:math></inline-formula>, that is, the first derivates <inline-formula><mml:math id="inf89"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>W</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="inf90"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>W</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> might not vanish at this point. However, if the functions <inline-formula><mml:math id="inf91"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf92"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are symmetrical, in the sense that<disp-formula id="equ7"><label>(5)</label><mml:math id="m7"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula></p><p>then the fitness function satisfies <inline-formula><mml:math id="inf93"><mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, and it can be seen that this implies that the point <inline-formula><mml:math id="inf94"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> is actually a critical point of <inline-formula><mml:math id="inf95"><mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>.</p><sec id="s3-1-1"><title>Division of labour by between-individual differences</title><p>Division of labour by between-individual differences occurs if either of the first two terms of the Taylor expansion (<xref ref-type="disp-formula" rid="equ3">Equation 2</xref>) is non-zero (<inline-formula><mml:math id="inf96"><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>≠</mml:mo><mml:mi> </mml:mi><mml:mn>0</mml:mn></mml:math></inline-formula> or <inline-formula><mml:math id="inf97"><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>≠</mml:mo><mml:mi> </mml:mi><mml:mn>0</mml:mn></mml:math></inline-formula>). In this case, directional selection will increase or decrease the level of cooperation of one of the individual types. We give here the associated partial differentials of fitness (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>):<disp-formula id="equ8">.<label>(6)</label><mml:math id="m8"><mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>W</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>`</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math></disp-formula><disp-formula id="equ9">.<label>(7)</label><mml:math id="m9"><mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>W</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>`</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math></disp-formula></p><p>These expressions capture the fitness consequences of a marginal increase in cooperation by helpers and reproductives, respectively. The first term of each captures the fecundity cost to own type of producing more public good, whereas the second term and third term are the viability benefits that accrue to both types from this increased cooperation. If directional selection in both traits is zero (<inline-formula><mml:math id="inf98"><mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>W</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf99"><mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>W</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>), then <inline-formula><mml:math id="inf100"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is a critical point, and <xref ref-type="disp-formula" rid="equ8">Equations 6</xref> and <xref ref-type="disp-formula" rid="equ9">7</xref> imply that<disp-formula id="equ10">.<label>(8)</label><mml:math id="m10"><mml:mrow><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula><disp-formula id="equ11">.<label>(9)</label><mml:math id="m11"><mml:mrow><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>These equations mean that, if <inline-formula><mml:math id="inf101"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is a critical point, then any marginal viability benefit to the group of increased cooperation by one subgroup is cancelled by the fecundity cost to that same subgroup. Moreover, <xref ref-type="disp-formula" rid="equ10">Equations 8</xref> and <xref ref-type="disp-formula" rid="equ11">9</xref> together imply that<disp-formula id="equ12"><label>(10)</label><mml:math id="m12"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>If this equation does not hold, then <inline-formula><mml:math id="inf102"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is not a critical point, that is, there is a difference in the viability-fecundity tradeoffs between subgroups such that some individuals (without loss of generality, helpers) can secure larger benefits for the group at the same fecundity cost as others (reproductives). This gives our first condition for division of labour being able to evolve:</p><p>The between-individual differences condition for division of labour<disp-formula id="equ13"><label>(11)</label><mml:math id="m13"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>If individuals are indistinguishable when both types invest equally in cooperation (<inline-formula><mml:math id="inf103"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi></mml:math></inline-formula>), then the viability functions satisfy <inline-formula><mml:math id="inf104"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. In this case, Condition 11 can be restated as:<disp-formula id="equ14">.<label>(12)</label><mml:math id="m14"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>This says that the contribution to total viability from the increased specialisation of helper individuals is strictly larger than the contribution to total viability from the increased specialisation of reproductives. As a result, helpers are predisposed to become more helper-like as they can gain larger viability gains for the group than the other type of individual.</p></sec></sec><sec id="s3-2"><title>Division of labour by an accelerating return from individual specialisation</title><p>Division of labour by an accelerating return from individual specialisation can occur if either of the third or fourth terms in the Taylor expansion (<xref ref-type="disp-formula" rid="equ3">Equation 2</xref>) are positive in value (<inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). Taking the second derivative of fitness (<xref ref-type="disp-formula" rid="equ26">Equation 24</xref>) with respect to each trait and evaluating at the critical point of uniform cooperation <inline-formula><mml:math id="inf107"><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> gives:<disp-formula id="equ15">.<label>(13)</label><mml:math id="m15"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula><disp-formula id="equ16">.<label>(14)</label><mml:math id="m16"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>The terms of <xref ref-type="disp-formula" rid="equ13 equ14">Equations 13 and 14</xref> capture the second-order effects of increased investment in cooperation. The first term of each captures the decline in the fitness benefit of increased cooperation due to the cross-interaction between fecundity and viability. For instance, as a helper invests more in cooperation (higher <inline-formula><mml:math id="inf108"><mml:mi>x</mml:mi></mml:math></inline-formula>), it increases its own viability (higher <inline-formula><mml:math id="inf109"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), but its fecundity declines as well (lower <inline-formula><mml:math id="inf110"><mml:mi>F</mml:mi></mml:math></inline-formula>) and so the relative benefit of this increased viability is lessened (the cross term <inline-formula><mml:math id="inf111"><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>`</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula> is negative). This represents a kind of decelerating return from cooperation. The second term of each captures the second-order effect of decreased investment in fecundity. If this term is positive, then this means that there is a diminishing fecundity cost to increased investment in cooperation, which can favour division of labour. The third and fourth terms capture the second-order effect of increased investment in viability, that is, does each successive investment in the public good lead to a larger or smaller increase in viability than the previous investment of the same size? The return on investment (ROI) in viability is accelerating if <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. The ROI is diminishing if these second derivates are negative: <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Thus if either <xref ref-type="disp-formula" rid="equ15">Equation 13</xref> or <xref ref-type="disp-formula" rid="equ16">Equation 14</xref> is positive, then division of labour is favoured to evolve. This gives the second condition for division of labour.</p><p>The accelerating returns from individual specialisation condition for division of labour<disp-formula id="equ17"><label>(15)</label><mml:math id="m17"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:msup><mml:mi/><mml:mo>″</mml:mo></mml:msup></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:mfrac><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ18"><label>(16)</label><mml:math id="m18"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:msup><mml:mi/><mml:mo>″</mml:mo></mml:msup></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:mfrac><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math></disp-formula></p><p>Fixing our attention on just <xref ref-type="disp-formula" rid="equ17">Equation 15</xref> (or equivalently on 16), this condition states that the sum of the second-order viability effect from increased cooperation (first term on left-hand side) and the second-order fecundity effect of increased cooperation (second term on left-hand side) must be larger than the marginal fecundity cost of increased investment in viability (third term on left-hand side). Note that the third term on left-hand side is always negative because increased investment in viability decreases the value of increased investment in fecundity. Therefore, division of labour by a single-trait mutation can only happen if there is an accelerating ROI in at least one of fecundity, <inline-formula><mml:math id="inf120"><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>; helper viability, <inline-formula><mml:math id="inf121"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>; or reproductive viability, <inline-formula><mml:math id="inf122"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>.</p></sec><sec id="s3-3"><title>Division of labour by reciprocal specialisation</title><p>The last remaining scenario for division of labour is that the resident strategy of uniform cooperation is unstable to mutations in both traits, which can occur depending on the value of the last term of the Taylor expansion (<xref ref-type="disp-formula" rid="equ3">Equation 2</xref>; <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>). This kind of instability can arise if there is a joint mutation that affects the level of cooperation of both helpers and reproductives at the same time (<inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). However, it could also occur if a slightly deleterious mutation in one trait invades by drift and destabilises the other trait so much that the population evolves away from the critical point. In either case, it will be found that same condition must be satisfied in order for division of labour to evolve. In the rest of this section, we give the general analysis of whether <inline-formula><mml:math id="inf126"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> is unstable to two-trait mutations, and then consider a simplifying special case to clarify the biological interpretation of this analysis.</p><p>Suppose that the resident strategy of uniform cooperation (<inline-formula><mml:math id="inf127"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>) is stable against single-trait mutations (i.e. Conditions 15 and 16 not satisfied). Then the resident strategy is unstable to two-trait mutations if and only if the determinant of the Hessian is negative:<disp-formula id="equ19"><label>(17)</label><mml:math id="m19"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This condition is satisfied if the strength of directional selection pushing the population back to the critical point along either of the trait-value directions is less than the strength of directional selection on a trait when moved off of the critical point along the other trait direction. To evaluate the Hessian condition, we first compute the second-order cross derivatives:<disp-formula id="equ20">.<label>(18)</label><mml:math id="m20"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>​</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>​</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Here, we have used that <inline-formula><mml:math id="inf128"><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula> . Substituting this, and <xref ref-type="disp-formula" rid="equ13 equ14">Equations 13 and 14</xref>, into the Hessian condition gives:</p><p>The reciprocal specialisation condition for division of labour<disp-formula id="equ21"><label>(19)</label><mml:math id="m21"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mo>§quot;</mml:mo></mml:mrow><mml:mi>F</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mfrac><mml:msubsup><mml:mi>V</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mo>§quot;</mml:mo></mml:mrow><mml:mi>F</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mfrac><mml:msubsup><mml:mi>V</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Assume that neither Condition 15 nor 16 is satisfied, that is, the individual ROI is non-accelerating. Then the left-hand side of the inequality is strictly positive, which means that Condition 19 is nontrivial. We will see in examples that Condition 19 can be satisfied, which means that division of labour can evolve by reciprocal specialisation even when the individual ROI is diminishing.</p><p>To clarify further the biological meaning of Condition 19, consider a simple family of models in which viability and fecundity are linear functions. In this case, all second derivates are zero, and so we get the simplified condition:</p><p>Simplified reciprocal specialisation condition for division of labour<disp-formula id="equ22">.<label>(20)</label><mml:math id="m22"><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>​</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>​</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>In the case that the viability functions are (<xref ref-type="disp-formula" rid="equ7">Equation 5</xref>) this condition further simplifies to:<disp-formula id="equ23"><label>(21)</label><mml:math id="m23"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>​</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>​</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This inequality is satisfied if the viability of reproductives increases faster with increased cooperation from helpers, than it does from increased cooperation from reproductives. This makes clear that reciprocal specialisation can evolve if reproductives stand to gain more from help from helpers than they would gain by helping themselves.</p></sec></sec></body><back><sec id="s4" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Formal analysis, Writing – original draft, Writing – review and editing</p></fn></fn-group></sec><sec id="s5" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-71968-transrepform1-v2.pdf"/></supplementary-material></sec><sec id="s6" sec-type="data-availability"><title>Data availability</title><p>The Matlab (R2020b) source code used to generate Figures 4D-F is available at <ext-link ext-link-type="uri" xlink:href="https://osf.io/nw8gz/">https://osf.io/nw8gz/</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Cooper</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Does the evolution of division of labour require accelerating returns from individual specialisation?</data-title><source>Open Science Framework</source><pub-id pub-id-type="doi">10.17605/OSF.IO/NW8GZ</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Thomas Scott and Zheren Zhang for their helpful comments and suggestions; St John’s College, Oxford (GAC), and the ERC (Horizon 2020 Advanced Grant 834164; SAW) for funding.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ackermann</surname><given-names>M</given-names></name><name><surname>Stecher</surname><given-names>B</given-names></name><name><surname>Freed</surname><given-names>NE</given-names></name><name><surname>Songhet</surname><given-names>P</given-names></name><name><surname>Hardt</surname><given-names>WD</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Self-destructive cooperation mediated by phenotypic noise</article-title><source>Nature</source><volume>454</volume><fpage>987</fpage><lpage>990</lpage><pub-id pub-id-type="doi">10.1038/nature07067</pub-id><pub-id pub-id-type="pmid">18719588</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Biggart</surname><given-names>NW</given-names></name></person-group><year iso-8601-date="1776">1776</year><source>Readings in Economic Sociology</source><publisher-loc>Oxford, UK</publisher-loc><publisher-name>Methuen</publisher-name><pub-id pub-id-type="doi">10.1002/9780470755679</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bourke</surname><given-names>AFG</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Principles of Social Evolution</source><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name><pub-id pub-id-type="doi">10.1093/acprof:oso/9780199231157.001.0001</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cooper</surname><given-names>GA</given-names></name><name><surname>West</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Division of labour and the evolution of extreme specialization</article-title><source>Nature Ecology &amp; Evolution</source><volume>2</volume><fpage>1161</fpage><lpage>1167</lpage><pub-id pub-id-type="doi">10.1038/s41559-018-0564-9</pub-id><pub-id pub-id-type="pmid">29807994</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cooper</surname><given-names>GA</given-names></name><name><surname>Liu</surname><given-names>M</given-names></name><name><surname>Peña</surname><given-names>J</given-names></name><name><surname>West</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The evolution of mechanisms to produce phenotypic heterogeneity in microorganisms</article-title><source>Nature Communications</source><comment>In press</comment></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diard</surname><given-names>M</given-names></name><name><surname>Garcia</surname><given-names>V</given-names></name><name><surname>Maier</surname><given-names>L</given-names></name><name><surname>Remus-Emsermann</surname><given-names>MNP</given-names></name><name><surname>Regoes</surname><given-names>RR</given-names></name><name><surname>Ackermann</surname><given-names>M</given-names></name><name><surname>Hardt</surname><given-names>WD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Stabilization of cooperative virulence by the expression of an avirulent phenotype</article-title><source>Nature</source><volume>494</volume><fpage>353</fpage><lpage>356</lpage><pub-id pub-id-type="doi">10.1038/nature11913</pub-id><pub-id pub-id-type="pmid">23426324</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoš</surname><given-names>A</given-names></name><name><surname>Kiesewalter</surname><given-names>H</given-names></name><name><surname>Martin</surname><given-names>M</given-names></name><name><surname>Hartmann</surname><given-names>R</given-names></name><name><surname>Wechsler</surname><given-names>T</given-names></name><name><surname>Eriksen</surname><given-names>C</given-names></name><name><surname>Brix</surname><given-names>S</given-names></name><name><surname>Drescher</surname><given-names>K</given-names></name><name><surname>Stanley-Wall</surname><given-names>N</given-names></name><name><surname>Kümmerli</surname><given-names>R</given-names></name><name><surname>Kovács</surname><given-names>ÁT</given-names></name></person-group><year iso-8601-date="2018">2018a</year><article-title>Division of Labor during Biofilm Matrix Production</article-title><source>Current Biology</source><volume>28</volume><fpage>1903</fpage><lpage>1913</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.04.046</pub-id><pub-id pub-id-type="pmid">29887307</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoš</surname><given-names>Anna</given-names></name><name><surname>Martin</surname><given-names>M</given-names></name><name><surname>Falcón García</surname><given-names>C</given-names></name><name><surname>Kricks</surname><given-names>L</given-names></name><name><surname>Pausch</surname><given-names>P</given-names></name><name><surname>Heimerl</surname><given-names>T</given-names></name><name><surname>Bálint</surname><given-names>B</given-names></name><name><surname>Maróti</surname><given-names>G</given-names></name><name><surname>Bange</surname><given-names>G</given-names></name><name><surname>López</surname><given-names>D</given-names></name><name><surname>Lieleg</surname><given-names>O</given-names></name><name><surname>Kovács</surname><given-names>ÁT</given-names></name></person-group><year iso-8601-date="2018">2018b</year><article-title>Collapse of genetic division of labour and evolution of autonomy in pellicle biofilms</article-title><source>Nature Microbiology</source><volume>3</volume><fpage>1451</fpage><lpage>1460</lpage><pub-id pub-id-type="doi">10.1038/s41564-018-0263-y</pub-id><pub-id pub-id-type="pmid">30297741</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duarte</surname><given-names>A</given-names></name><name><surname>Weissing</surname><given-names>FJ</given-names></name><name><surname>Pen</surname><given-names>I</given-names></name><name><surname>Keller</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>An Evolutionary Perspective on Self-Organized Division of Labor in Social Insects</article-title><source>Annual Review of Ecology, Evolution, and Systematics</source><volume>42</volume><fpage>91</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1146/annurev-ecolsys-102710-145017</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duarte</surname><given-names>A</given-names></name><name><surname>Pen</surname><given-names>I</given-names></name><name><surname>Keller</surname><given-names>L</given-names></name><name><surname>Weissing</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Evolution of self-organized division of labor in a response threshold model</article-title><source>Behavioral Ecology and Sociobiology</source><volume>66</volume><fpage>947</fpage><lpage>957</lpage><pub-id pub-id-type="doi">10.1007/s00265-012-1343-2</pub-id><pub-id pub-id-type="pmid">22661824</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flores</surname><given-names>E</given-names></name><name><surname>Herrero</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Compartmentalized function through cell differentiation in filamentous cyanobacteria</article-title><source>Nature Reviews. Microbiology</source><volume>8</volume><fpage>39</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2242</pub-id><pub-id pub-id-type="pmid">19966815</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herrero</surname><given-names>A</given-names></name><name><surname>Stavans</surname><given-names>J</given-names></name><name><surname>Flores</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The multicellular nature of filamentous heterocyst-forming cyanobacteria</article-title><source>FEMS Microbiology Reviews</source><volume>40</volume><fpage>831</fpage><lpage>854</lpage><pub-id pub-id-type="doi">10.1093/femsre/fuw029</pub-id><pub-id pub-id-type="pmid">28204529</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hölldobler</surname><given-names>B</given-names></name><name><surname>Wilson</surname><given-names>EO</given-names></name></person-group><year iso-8601-date="1990">1990</year><source>The Ants</source><publisher-loc>United States</publisher-loc><publisher-name>Harvard University Press</publisher-name></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ispolatov</surname><given-names>I</given-names></name><name><surname>Ackermann</surname><given-names>M</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Division of labour and the evolution of multicellularity</article-title><source>Proceedings. Biological Sciences</source><volume>279</volume><fpage>1768</fpage><lpage>1776</lpage><pub-id pub-id-type="doi">10.1098/rspb.2011.1999</pub-id><pub-id pub-id-type="pmid">22158952</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiers</surname><given-names>ET</given-names></name><name><surname>Duhamel</surname><given-names>M</given-names></name><name><surname>Beesetty</surname><given-names>Y</given-names></name><name><surname>Mensah</surname><given-names>JA</given-names></name><name><surname>Franken</surname><given-names>O</given-names></name><name><surname>Verbruggen</surname><given-names>E</given-names></name><name><surname>Fellbaum</surname><given-names>CR</given-names></name><name><surname>Kowalchuk</surname><given-names>GA</given-names></name><name><surname>Hart</surname><given-names>MM</given-names></name><name><surname>Bago</surname><given-names>A</given-names></name><name><surname>Palmer</surname><given-names>TM</given-names></name><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Vandenkoornhuyse</surname><given-names>P</given-names></name><name><surname>Jansa</surname><given-names>J</given-names></name><name><surname>Bücking</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Reciprocal Rewards Stabilize Cooperation in the Mycorrhizal Symbiosis</article-title><source>Science</source><volume>333</volume><fpage>880</fpage><lpage>882</lpage><pub-id pub-id-type="doi">10.1126/science.1208473</pub-id><pub-id pub-id-type="pmid">21836016</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koufopanou</surname><given-names>V</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>The Evolution of Soma in the Volvocales</article-title><source>The American Naturalist</source><volume>143</volume><fpage>907</fpage><lpage>931</lpage><pub-id pub-id-type="doi">10.1086/285639</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levin</surname><given-names>SR</given-names></name><name><surname>West</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The evolution of cooperation in simple molecular replicators</article-title><source>Proceedings of the Royal Society B</source><volume>284</volume><elocation-id>20171967</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2017.1967</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>M</given-names></name><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Cooper</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The evolution of mechanisms to divide labour in non-clonal populations</article-title><source>Ecology and Evolution</source><volume>11</volume><fpage>14475</fpage><lpage>14489</lpage><pub-id pub-id-type="doi">10.1002/ece3.8067</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mavridou</surname><given-names>DAI</given-names></name><name><surname>Gonzalez</surname><given-names>D</given-names></name><name><surname>Kim</surname><given-names>W</given-names></name><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Bacteria Use Collective Behavior to Generate Diverse Combat Strategies</article-title><source>Current Biology</source><volume>28</volume><fpage>345</fpage><lpage>355</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.12.030</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Maynard Smith</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1982">1982</year><source>Evolution and the Theory of Games</source><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511806292</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Maynard Smith</surname><given-names>J</given-names></name><name><surname>Szathmáry</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1995">1995</year><source>The Major Transitions in Evolution</source><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meeks</surname><given-names>JC</given-names></name><name><surname>Elhai</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Regulation of Cellular Differentiation in Filamentous Cyanobacteria in Free-Living and Plant-Associated Symbiotic Growth States</article-title><source>Microbiology and Molecular Biology Reviews</source><volume>66</volume><fpage>94</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1128/MMBR.66.1.94-121.2002</pub-id><pub-id pub-id-type="pmid">11875129</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michod</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The group covariance effect and fitness trade-offs during evolutionary transitions in individuality</article-title><source>PNAS</source><volume>103</volume><fpage>9113</fpage><lpage>9117</lpage><pub-id pub-id-type="doi">10.1073/pnas.0601080103</pub-id><pub-id pub-id-type="pmid">16751277</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Mridha</surname><given-names>S</given-names></name><name><surname>Kummerli</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Enforced Specialization Fosters Mutual Cheating and Not Division of Labour in the Bacterium <italic>Pseudomonas aeruginosa</italic>.</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.06.26.450018</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Oster</surname><given-names>GF</given-names></name><name><surname>Wilson</surname><given-names>EO</given-names></name></person-group><year iso-8601-date="1978">1978</year><source>Caste and Ecology in the Social Insects</source><publisher-loc>United States</publisher-loc><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pepper</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Relatedness in trait group models of social evolution</article-title><source>Journal of Theoretical Biology</source><volume>206</volume><fpage>355</fpage><lpage>368</lpage><pub-id pub-id-type="doi">10.1006/jtbi.2000.2132</pub-id><pub-id pub-id-type="pmid">10988021</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Queller</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Kinship, reciprocity and synergism in the evolution of social behaviour</article-title><source>Nature</source><volume>318</volume><fpage>366</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1038/318366a0</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Queller</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Cooperators since life began</article-title><source>The Quarterly Review of Biology</source><volume>72</volume><fpage>184</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1086/419766</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Queller</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Expanded social fitness and Hamilton’s rule for kin, kith, and kind</article-title><source>PNAS</source><volume>108 Suppl 2</volume><fpage>10792</fpage><lpage>10799</lpage><pub-id pub-id-type="doi">10.1073/pnas.1100298108</pub-id><pub-id pub-id-type="pmid">21690389</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rueffler</surname><given-names>C</given-names></name><name><surname>Hermisson</surname><given-names>J</given-names></name><name><surname>Wagner</surname><given-names>GP</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Evolution of functional specialization and division of labor</article-title><source>PNAS</source><volume>109</volume><fpage>326</fpage><lpage>335</lpage><pub-id pub-id-type="doi">10.1073/pnas.1110521109</pub-id><pub-id pub-id-type="pmid">22308336</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiessl</surname><given-names>KT</given-names></name><name><surname>Ross-Gillespie</surname><given-names>A</given-names></name><name><surname>Cornforth</surname><given-names>DM</given-names></name><name><surname>Weigert</surname><given-names>M</given-names></name><name><surname>Bigosch</surname><given-names>C</given-names></name><name><surname>Brown</surname><given-names>SP</given-names></name><name><surname>Ackermann</surname><given-names>M</given-names></name><name><surname>Kümmerli</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Individual- versus group-optimality in the production of secreted bacterial compounds</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>73</volume><fpage>675</fpage><lpage>688</lpage><pub-id pub-id-type="doi">10.1111/evo.13701</pub-id><pub-id pub-id-type="pmid">30793292</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solari</surname><given-names>CA</given-names></name><name><surname>Kessler</surname><given-names>JO</given-names></name><name><surname>Goldstein</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A General Allometric and Life-History Model for Cellular Differentiation in the Transition to Multicellularity</article-title><source>The American Naturalist</source><volume>181</volume><fpage>369</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1086/669151</pub-id><pub-id pub-id-type="pmid">23448886</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Staps</surname><given-names>M</given-names></name><name><surname>Tarnita</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Evolution: How geometry shapes division of labor</article-title><source>eLife</source><volume>9</volume><elocation-id>e63328</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.63328</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strassmann</surname><given-names>JE</given-names></name><name><surname>Zhu</surname><given-names>Y</given-names></name><name><surname>Queller</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Altruism and social cheating in the social amoeba <italic>Dictyostelium</italic> discoideum</article-title><source>Nature</source><volume>408</volume><fpage>965</fpage><lpage>967</lpage><pub-id pub-id-type="doi">10.1038/35050087</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strmecki</surname><given-names>L</given-names></name><name><surname>Greene</surname><given-names>DM</given-names></name><name><surname>Pears</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Developmental decisions in <italic>Dictyostelium</italic> discoideum</article-title><source>Developmental Biology</source><volume>284</volume><fpage>25</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2005.05.011</pub-id><pub-id pub-id-type="pmid">15964562</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tverskoi</surname><given-names>D</given-names></name><name><surname>Makarenkov</surname><given-names>V</given-names></name><name><surname>Aleskerov</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Modeling functional specialization of a cell colony under different fecundity and viability rates and resource constraint</article-title><source>PLOS ONE</source><volume>13</volume><elocation-id>0201446</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0201446</pub-id><pub-id pub-id-type="pmid">30089142</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Tverskoi</surname><given-names>D</given-names></name><name><surname>Gavrilets</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The Evolution of Germ-Soma Specialization under Different Genetic and Environmental Effects</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.04.02.438224</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Gestel</surname><given-names>J</given-names></name><name><surname>Vlamakis</surname><given-names>H</given-names></name><name><surname>Kolter</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Division of Labor in Biofilms: the Ecology of Cell Differentiation</article-title><source>Microbiology Spectrum</source><volume>3</volume><elocation-id>2014</elocation-id><pub-id pub-id-type="doi">10.1128/microbiolspec.MB-0002-2014</pub-id><pub-id pub-id-type="pmid">26104716</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Veening</surname><given-names>JW</given-names></name><name><surname>Igoshin</surname><given-names>OA</given-names></name><name><surname>Eijlander</surname><given-names>RT</given-names></name><name><surname>Nijland</surname><given-names>R</given-names></name><name><surname>Hamoen</surname><given-names>LW</given-names></name><name><surname>Kuipers</surname><given-names>OP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Transient heterogeneity in extracellular protease production by <italic>Bacillus subtilis</italic></article-title><source>Molecular Systems Biology</source><volume>4</volume><elocation-id>184</elocation-id><pub-id pub-id-type="doi">10.1038/msb.2008.18</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Fisher</surname><given-names>RM</given-names></name><name><surname>Gardner</surname><given-names>A</given-names></name><name><surname>Kiers</surname><given-names>ET</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Major evolutionary transitions in individuality</article-title><source>PNAS</source><volume>112</volume><fpage>10112</fpage><lpage>10119</lpage><pub-id pub-id-type="doi">10.1073/pnas.1421402112</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Cooper</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Division of labour in microorganisms: An evolutionary perspective</article-title><source>Nature Reviews. Microbiology</source><volume>14</volume><fpage>716</fpage><lpage>723</lpage><pub-id pub-id-type="doi">10.1038/nrmicro.2016.111</pub-id><pub-id pub-id-type="pmid">27640757</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wyatt</surname><given-names>GAK</given-names></name><name><surname>Kiers</surname><given-names>ET</given-names></name><name><surname>Gardner</surname><given-names>A</given-names></name><name><surname>West</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A biological market analysis of the plant-mycorrhizal symbiosis</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>68</volume><fpage>2603</fpage><lpage>2618</lpage><pub-id pub-id-type="doi">10.1111/evo.12466</pub-id><pub-id pub-id-type="pmid">24909843</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yanni</surname><given-names>D</given-names></name><name><surname>Jacobeen</surname><given-names>S</given-names></name><name><surname>Márquez-Zacarías</surname><given-names>P</given-names></name><name><surname>Weitz</surname><given-names>JS</given-names></name><name><surname>Ratcliff</surname><given-names>WC</given-names></name><name><surname>Yunker</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Topological constraints in early multicellularity favor reproductive division of labor</article-title><source>eLife</source><volume>9</volume><elocation-id>e54348</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.54348</pub-id><pub-id pub-id-type="pmid">32940598</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Du</surname><given-names>C</given-names></name><name><surname>de Barsy</surname><given-names>F</given-names></name><name><surname>Liem</surname><given-names>M</given-names></name><name><surname>Liakopoulos</surname><given-names>A</given-names></name><name><surname>van Wezel</surname><given-names>GP</given-names></name><name><surname>Choi</surname><given-names>YH</given-names></name><name><surname>Claessen</surname><given-names>D</given-names></name><name><surname>Rozen</surname><given-names>DE</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Antibiotic production in Streptomyces is organized by a division of labor through terminal genomic differentiation</article-title><source>Science Advances</source><volume>6</volume><elocation-id>eaay5781</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.aay5781</pub-id><pub-id pub-id-type="pmid">31998842</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s7" sec-type="appendix"><title>A Group structure models</title><p>We now consider models that have specified spatial (or ‘network’) structures. We apply the division of labour scenarios outlined in the Materials and methods to study division of labour in these graph models. We find simple, general conditions on the graph for when division of labour can invade.</p><sec id="s7-1" sec-type="appendix"><title>A.1 Division of labour by between-individual differences: stars and branching groups</title><p>Consider a star of <inline-formula><mml:math id="inf129"><mml:mi>n</mml:mi></mml:math></inline-formula> cells, with 1 focal cell, and <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> peripheral cells (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). Assume that some function, <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, determines the amount of a shared resource produced by a cell with level of cooperation <inline-formula><mml:math id="inf132"><mml:mi>z</mml:mi></mml:math></inline-formula>. And let <inline-formula><mml:math id="inf133"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> be the proportion of benefits produced by an individual that it keeps for itself, so that <inline-formula><mml:math id="inf134"><mml:mi>λ</mml:mi></mml:math></inline-formula> is the proportion of benefits that is shared equally by a cell’s neighbours. If the peripheral cells in the star have phenotype <italic>z</italic><sub><italic>h</italic></sub> and the focal cell has phenotype <italic>z</italic><sub><italic>r</italic></sub>, then<disp-formula id="equ24"><label>(22)</label><mml:math id="m24"><mml:mrow><mml:mtable columnalign="center left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>λ</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>A star.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-app1-fig1-v2.tif"/></fig><p>The viability of a peripheral cell is <inline-formula><mml:math id="inf135"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and the viability of the focal cell is <inline-formula><mml:math id="inf136"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ14">Equation 12</xref> then gives the following condition for division of labour by between-individual differences:<disp-formula id="equ25"><label>(23)</label><mml:math id="m25"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which holds for every positive <inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>In a similar vein, consider a group with a branching structure, where alternating cells have either <inline-formula><mml:math id="inf138"><mml:mi>a</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf139"><mml:mi>b</mml:mi></mml:math></inline-formula> neighbours, with <inline-formula><mml:math id="inf140"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. We term the cells with <inline-formula><mml:math id="inf141"><mml:mi>a</mml:mi></mml:math></inline-formula> neighbours as edge cells and cells with <inline-formula><mml:math id="inf142"><mml:mi>b</mml:mi></mml:math></inline-formula> neighbours as node cells. (In order to avoid edge effects, we assume that the group eventually wraps around on itself, creating the shape of a regular polyhedron: in the case of <inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, this would be the dodecahedron, with <inline-formula><mml:math id="inf145"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> edge cells and <inline-formula><mml:math id="inf146"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> node cells.) This gives the following expected fitness:<disp-formula id="equ26"><label>(24)</label><mml:math id="m26"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>λ</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>λ</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where <italic>n</italic><sub><italic>h</italic></sub> is the number of edge cells and <italic>n</italic><sub><italic>r</italic></sub> is the number of node cells. Note that for any graph in which <italic>n</italic><sub><italic>h</italic></sub> cells have degree <inline-formula><mml:math id="inf147"><mml:mi>a</mml:mi></mml:math></inline-formula>, and <italic>n</italic><sub><italic>r</italic></sub> cells have degree <inline-formula><mml:math id="inf148"><mml:mi>b</mml:mi></mml:math></inline-formula>, we have that <inline-formula><mml:math id="inf149"><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>/</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The viability of an edge cell is <inline-formula><mml:math id="inf150"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and the viability of a node cell is <inline-formula><mml:math id="inf151"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>/</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ14">Equation 12</xref> then gives the following condition for division of labour by between-individual differences:<disp-formula id="equ27"><label>(25)</label><mml:math id="m27"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:mfrac><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:mfrac><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>So, since <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, we find that division of labour by between-individual differences occurs for all values of <inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (any social trait).</p><p>In order to calculate the benefit of division of labour in <xref ref-type="fig" rid="fig4">Figure 4</xref> of the main text, we evaluate <inline-formula><mml:math id="inf154"><mml:mrow><mml:mtext>max</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where we approximate fitness using a first-order Taylor expansion and setting <inline-formula><mml:math id="inf155"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s7-2" sec-type="appendix"><title>A.2 General graph analysis: between-individual differences</title><p>Consider a graph with vertices <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, each vertex with degree <italic>d</italic><sub><italic>i</italic></sub>. Let <inline-formula><mml:math id="inf157"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> be the matrix of adjacencies: <inline-formula><mml:math id="inf158"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if there is no edge <inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and for every edge <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> we have <inline-formula><mml:math id="inf161"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Moreover, <inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, for each <inline-formula><mml:math id="inf163"><mml:mi>i</mml:mi></mml:math></inline-formula>. Notice that the column sums of the matrix <inline-formula><mml:math id="inf164"><mml:mi>A</mml:mi></mml:math></inline-formula> are zero:<disp-formula id="equ28"><label>(26)</label><mml:math id="m28"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The fitness function of the group associated with this graph is<disp-formula id="equ29"><label>(27)</label><mml:math id="m29"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mstyle><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:munder></mml:mstyle><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <italic>z</italic><sub><italic>i</italic></sub> is the level of cooperation of the individual at vertex <inline-formula><mml:math id="inf165"><mml:mi>i</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf166"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> and 0 otherwise. The uniform cooperation strategy, <inline-formula><mml:math id="inf168"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>z</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, has fitness<disp-formula id="equ30"><label>(28)</label><mml:math id="m30"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which is maximised for some <inline-formula><mml:math id="inf169"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> between 0 and 1, by our assumption that <italic>F</italic> is decreasing in <inline-formula><mml:math id="inf170"><mml:mi>z</mml:mi></mml:math></inline-formula> and <italic>H</italic> is increasing in <inline-formula><mml:math id="inf171"><mml:mi>z</mml:mi></mml:math></inline-formula>.</p><p>We now restrict to the ‘marginal’ case that <inline-formula><mml:math id="inf172"><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf173"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are both linear functions. In this case we can, without loss of generality, take <inline-formula><mml:math id="inf174"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf175"><mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula>. The uniform cooperation strategy is given by <inline-formula><mml:math id="inf176"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. The first derivatives of <inline-formula><mml:math id="inf177"><mml:mi>W</mml:mi></mml:math></inline-formula> at the uniform strategy are given by:<disp-formula id="equ31"><label>(29)</label><mml:math id="m31"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mo>∂</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>⁡</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo fence="true">|</mml:mo></mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:munder></mml:mstyle><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Notice that, for fixed <italic>i</italic>,<disp-formula id="equ32"><label>(30)</label><mml:math id="m32"><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:munder></mml:mstyle><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="+3.3pt"><mml:mtext>edges</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>If all the vertices of the graph have the <italic>same degree</italic>, <inline-formula><mml:math id="inf178"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula>, then <inline-formula><mml:math id="inf179"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and so the first derivatives all vanish. If one or more of the vertices, <inline-formula><mml:math id="inf180"><mml:mi>j</mml:mi></mml:math></inline-formula>, connected to <inline-formula><mml:math id="inf181"><mml:mi>i</mml:mi></mml:math></inline-formula>, does not have the degree <italic>d</italic><sub><italic>i</italic></sub>, then the sum, <xref ref-type="disp-formula" rid="equ32">Equation 30</xref>, does not vanish. In this case, the uniform strategy is not stable, and division of labour can invade.</p><p>For example, consider the branching tree with seven cells, shown in <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>. The <inline-formula><mml:math id="inf182"><mml:mi>A</mml:mi></mml:math></inline-formula> matrix of this tree is:<disp-formula id="equ33"><label>(31)</label><mml:math id="m33"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">A</mml:mi></mml:mrow><mml:mo mathvariant="italic">=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Using <xref ref-type="disp-formula" rid="equ31">Equation 29</xref>, it follows that<disp-formula id="equ34"><label>(32)</label><mml:math id="m34"><mml:mrow><mml:msub><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>W</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>7</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>So vertices 2 and 3 are ‘predisposed’ towards helping less, whereas the more peripheral vertices (<italic>i</italic> = 1, 4, 5, 6, 7) are predisposed towards helping more. The vertices with the fewest neighbours (<italic>i</italic> = 1, 4, 5, 6, 7) are also the most predisposed towards helping more.</p><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>A tree.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-app1-fig2-v2.tif"/></fig></sec><sec id="s7-3" sec-type="appendix"><title>A.3 A ring of cells</title><p>Let us assume that the group is composed of <inline-formula><mml:math id="inf183"><mml:mi>n</mml:mi></mml:math></inline-formula> cells that form a one-dimensional filament wrapped into a ring, where <inline-formula><mml:math id="inf184"><mml:mi>n</mml:mi></mml:math></inline-formula> is an even number (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>). Label the cells 1 through <inline-formula><mml:math id="inf185"><mml:mi>n</mml:mi></mml:math></inline-formula>, and assume that 1 is neighbours with <inline-formula><mml:math id="inf186"><mml:mi>n</mml:mi></mml:math></inline-formula>. We assume that each cell in the filament shares social benefits with only its direct neighbours. Suppose that ‘odd’ cells are putative helper cells, and ‘even’ cells are reproductives. This gives the following fitness for the group:<disp-formula id="equ35">.<label>(33)</label><mml:math id="m35"><mml:mrow><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>A ring of cells.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-app1-fig3-v2.tif"/></fig><p>The viability of helpers is <inline-formula><mml:math id="inf187"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and the viability of reproductives is <inline-formula><mml:math id="inf188"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. We now consider each of the possible routes by which division of labour can evolve.</p><p>Using <xref ref-type="disp-formula" rid="equ8">Equations 6</xref> and <xref ref-type="disp-formula" rid="equ9">7</xref>, we find that <inline-formula><mml:math id="inf189"><mml:mrow><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>/</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>/</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> at the resident strategy of uniform cooperation for both helpers and reproductives and therefore that the condition for division of labour by between-individual differences (<xref ref-type="disp-formula" rid="equ13">Equation 11</xref>) can never hold.</p><p>Assume that <inline-formula><mml:math id="inf190"><mml:mi>F</mml:mi></mml:math></inline-formula> is a linear function. If the returns from cooperation are non-increasing (<inline-formula><mml:math id="inf191"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), then we use Condition 17 (<xref ref-type="fig" rid="fig5">Figure 5a</xref>), to find that division of labour is favoured if and only if<disp-formula id="equ36"><label>(34)</label><mml:math id="m36"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In the case that <inline-formula><mml:math id="inf192"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, division of labour is favoured only if <inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. If <inline-formula><mml:math id="inf194"><mml:msup><mml:mi>H</mml:mi><mml:mo>′′</mml:mo></mml:msup></mml:math></inline-formula> is less than zero, then the ROIs are <italic>decelerating</italic>, and <inline-formula><mml:math id="inf195"><mml:mi>λ</mml:mi></mml:math></inline-formula> must be larger than <inline-formula><mml:math id="inf196"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> in order for division of labour to be favoured.</p><p>In order to calculate the fitness benefit of division of labour in <xref ref-type="fig" rid="fig4">Figure 4</xref> of the main text, we evaluate <inline-formula><mml:math id="inf197"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi><mml:mo>≤</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where we approximate fitness using a second-order Taylor expansion and setting <inline-formula><mml:math id="inf198"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>. In this case, we can show analytically that the direction of mutation giving the maximal increase in fitness satisfies <inline-formula><mml:math id="inf199"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Some tessellation patterns, and the associated ranges of <italic>λ</italic> for which reciprocal specialisation is possible in each case.</title><p>Each figure should be regarded as showing just a few cells of the infinite tesselation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-app1-fig4-v2.tif"/></fig></sec><sec id="s7-4" sec-type="appendix"><title>A.4 A well-mixed group of cells</title><p>We now consider a group that is ‘well mixed’ such that cells share the benefits of cooperation with all other group members. That is, we let <inline-formula><mml:math id="inf200"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> be the amount of benefits produced by an individual that it keeps for itself and <inline-formula><mml:math id="inf201"><mml:mi>λ</mml:mi></mml:math></inline-formula> is the amount of benefits that is shared equally by all other cells in the group. This produces the following expected fitness function:<disp-formula id="equ37"><label>(35)</label><mml:math id="m37"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf202"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and we have that the viability of a helper is <inline-formula><mml:math id="inf203"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and the viability of a reproductive is <inline-formula><mml:math id="inf204"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Plugging these into <xref ref-type="disp-formula" rid="equ13">Equation 11</xref>, we find that division of labour cannot evolve by between-individual differences as both sides are equal to <inline-formula><mml:math id="inf205"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>/</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></inline-formula>, and thus helpers and reproductives face the same viability-fecundity tradeoff.</p><p>If the returns from cooperation and fecundity are linear (<inline-formula><mml:math id="inf206"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), then we can evaluate condition 20 directly to find that division of labour by reciprocal specialisation can evolve if (<xref ref-type="fig" rid="fig5">Figure 5c</xref>)<disp-formula id="equ38"><label>(36)</label><mml:math id="m38"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Otherwise, if the returns from cooperation are diminishing (say, <inline-formula><mml:math id="inf207"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, with <inline-formula><mml:math id="inf208"><mml:mi>F</mml:mi></mml:math></inline-formula> linear), then we can use the general condition 17 to find,<disp-formula id="equ39"><label>(37)</label><mml:math id="m39"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mtext>where</mml:mtext><mml:mtext> </mml:mtext><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Notice that, for diminishing returns (<inline-formula><mml:math id="inf209"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), we have that <inline-formula><mml:math id="inf210"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and in this case it follows that<disp-formula id="equ40"><label>(38)</label><mml:math id="m40"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mn>1.</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In other words, if <inline-formula><mml:math id="inf211"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, then <inline-formula><mml:math id="inf212"><mml:mi>λ</mml:mi></mml:math></inline-formula> must be <italic>even higher</italic> for division of labour to be favoured, than when <inline-formula><mml:math id="inf213"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>In order to calculate the fitness benefit of division of labour in <xref ref-type="fig" rid="fig4">Figure 4</xref> of the main text, we evaluate <inline-formula><mml:math id="inf214"><mml:mrow><mml:mrow><mml:msub><mml:mtext>max</mml:mtext><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi><mml:mo>≤</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where we approximate fitness using a second-order Taylor expansion and setting <inline-formula><mml:math id="inf215"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s7-5" sec-type="appendix"><title>A.5 General graph analysis: reciprocal specialisation</title><p>We now return to the case of a general graph model, and consider when division of labour is possible via reciprocal specialisation. Once again, fix some graph <inline-formula><mml:math id="inf216"><mml:mi>G</mml:mi></mml:math></inline-formula>. Assume that the first derivatives, <inline-formula><mml:math id="inf217"><mml:mrow><mml:msub><mml:mo>∂</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>⁡</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:math></inline-formula>, vanish at the strategy of uniform cooperation (<inline-formula><mml:math id="inf218"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>). Recall (<xref ref-type="disp-formula" rid="equ31">Equation 29</xref>) that this is equivalent to assuming that all the vertices of the graph <inline-formula><mml:math id="inf219"><mml:mi>G</mml:mi></mml:math></inline-formula> have the same degree, <inline-formula><mml:math id="inf220"><mml:mi>d</mml:mi></mml:math></inline-formula>. The matrix of second derivatives of <inline-formula><mml:math id="inf221"><mml:mi>W</mml:mi></mml:math></inline-formula> is<disp-formula id="equ41"><label>(39)</label><mml:math id="m41"><mml:mrow><mml:mrow><mml:mtext>Hess</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo fence="true">|</mml:mo></mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf222"><mml:mi>M</mml:mi></mml:math></inline-formula> is a symmetrised version of the <inline-formula><mml:math id="inf223"><mml:mi>A</mml:mi></mml:math></inline-formula> matrix:<disp-formula id="equ42"><label>(40)</label><mml:math id="m42"><mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>All vertices have the same degree, say <inline-formula><mml:math id="inf224"><mml:mi>d</mml:mi></mml:math></inline-formula>, so that the matrix <inline-formula><mml:math id="inf225"><mml:mi>M</mml:mi></mml:math></inline-formula> is given by:<disp-formula id="equ43"><label>(41)</label><mml:math id="m43"><mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>d</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf226"><mml:mi>L</mml:mi></mml:math></inline-formula> is the <italic>Laplacian</italic> matrix:<disp-formula id="equ44"><label>(42)</label><mml:math id="m44"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mi>d</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mtext>if </mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>,</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mpadded lspace="40pt" width="+40pt"><mml:mrow><mml:mtext>if </mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext> is an edge,</mml:mtext></mml:mrow></mml:mpadded></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mpadded lspace="9.9pt" width="+9.9pt"><mml:mtext>otherwise.</mml:mtext></mml:mpadded></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The uniform strategy (<inline-formula><mml:math id="inf227"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>) is <italic>unstable</italic> if and only if the matrix Hess has one or more positive eigenvalues. When <inline-formula><mml:math id="inf228"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf229"><mml:mrow><mml:mtext>Hess</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf230"><mml:mi>I</mml:mi></mml:math></inline-formula> is the identity. So all eigenvalues of Hess for <inline-formula><mml:math id="inf231"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> are negative, and the uniform strategy is stable. This agrees with the biological intuition: when <inline-formula><mml:math id="inf232"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the group is not interacting socially, and so division of labour cannot evolve. We would like to find <inline-formula><mml:math id="inf233"><mml:msup><mml:mi>λ</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> (if it exists), such that division of labour is possible for <inline-formula><mml:math id="inf234"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. This corresponds to the smallest value of <inline-formula><mml:math id="inf235"><mml:mi>λ</mml:mi></mml:math></inline-formula> for which <inline-formula><mml:math id="inf236"><mml:mrow><mml:mo>det</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Hess</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> vanishes. We can explicitly evaluate the determinant as:<disp-formula id="equ45"><label>(43)</label><mml:math id="m45"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo form="prefix" movablelimits="true">det</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>Hess</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>λ</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>λ</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the <italic>characteristic polynomial</italic> <inline-formula><mml:math id="inf237"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is a degree <inline-formula><mml:math id="inf238"><mml:mi>n</mml:mi></mml:math></inline-formula> polynomial defined by:<disp-formula id="equ46"><label>(44)</label><mml:math id="m46"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">det</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The roots of <inline-formula><mml:math id="inf239"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> are all non-negative (this is because <inline-formula><mml:math id="inf240"><mml:mi>L</mml:mi></mml:math></inline-formula> is a symmetric matrix). Moreover, <inline-formula><mml:math id="inf241"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is a root of <inline-formula><mml:math id="inf242"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Let <italic>μ</italic> be the largest root of <inline-formula><mml:math id="inf243"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, that is, <italic>μ</italic> is the largest <italic>eigenvalue</italic> of <inline-formula><mml:math id="inf244"><mml:mi>L</mml:mi></mml:math></inline-formula>. Then the smallest value of <inline-formula><mml:math id="inf245"><mml:mi>λ</mml:mi></mml:math></inline-formula> for which <inline-formula><mml:math id="inf246"><mml:mrow><mml:mo>det</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Hess</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> vanishes is <inline-formula><mml:math id="inf247"><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. It follows that division of labour can evolve if and only if<disp-formula id="equ47"><label>(45)</label><mml:math id="m47"><mml:mrow><mml:mi>λ</mml:mi><mml:mi>μ</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>d</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Recall that <inline-formula><mml:math id="inf248"><mml:mi>d</mml:mi></mml:math></inline-formula> is the number of neighbours that an individual cell has in the graph. The eigenvalue μ can be thought of (see below) as a measure of how ‘bipartitionable’ the graph is. The inequality can then be interpreted loosely as follows: if the graph is made ‘more bipartite’, <inline-formula><mml:math id="inf249"><mml:mi>λ</mml:mi></mml:math></inline-formula> can decrease. If the number of neighbours, <inline-formula><mml:math id="inf250"><mml:mi>d</mml:mi></mml:math></inline-formula>, is increased, <inline-formula><mml:math id="inf251"><mml:mi>λ</mml:mi></mml:math></inline-formula> must increase.</p><p>To further understand <italic>μ</italic>, a useful property of <inline-formula><mml:math id="inf252"><mml:mi>L</mml:mi></mml:math></inline-formula> is that, for any vector of numbers <inline-formula><mml:math id="inf253"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ48"><label>(46)</label><mml:math id="m48"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>L</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnspacing="0em" displaystyle="false" rowspacing="0.1em"><mml:mtr><mml:mtd><mml:mtext>edges</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The largest eigenvalue of <inline-formula><mml:math id="inf254"><mml:mi>L</mml:mi></mml:math></inline-formula> is<disp-formula id="equ49"><label>(47)</label><mml:math id="m49"><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mi>max</mml:mi><mml:mi>x</mml:mi></mml:munder><mml:mo>⁡</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>On the other hand,<disp-formula id="equ50"><label>(48)</label><mml:math id="m50"><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mtable class="ltx_align_c" rowspacing="0.0pt"><mml:mtr><mml:mtd><mml:mtext>edges</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder></mml:mstyle><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>≤</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mtable class="ltx_align_c" rowspacing="0.0pt"><mml:mtr><mml:mtd><mml:mtext>edges</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover></mml:mstyle><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>It follows that<disp-formula id="equ51"><mml:math id="m51"><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>≤</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Moreover, if the graph is bipartite, choose any bipartite colouring of its vertices. Then, assigning <inline-formula><mml:math id="inf255"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> to vertices of one colour, and <inline-formula><mml:math id="inf256"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> to vertices of the other colour, we find that<disp-formula id="equ52"><label>(49)</label><mml:math id="m52"><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mtable class="ltx_align_c" rowspacing="0.0pt"><mml:mtr><mml:mtd><mml:mtext>edges</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder></mml:mstyle><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mtext>edges</mml:mtext></mml:munder></mml:mstyle><mml:mn>4</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This means that <italic>μ</italic> achieves its maximum value, <inline-formula><mml:math id="inf257"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, for bipartite graphs. It can be shown that <inline-formula><mml:math id="inf258"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> if and only if the graph is bipartite. <italic>μ</italic> can be regarded, therefore, as a measure of ‘how bipartite’ a given graph is. Some representative examples for small (<inline-formula><mml:math id="inf259"><mml:mrow><mml:mi>N</mml:mi><mml:mo>≤</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>) graphs are given in <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>, <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>, <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>, <xref ref-type="fig" rid="app1fig7">Appendix 1—figure 7</xref>. The rest of this section applies the above analysis to several basic families of examples.</p><fig id="app1fig5" position="float"><label>Appendix 1—figure 5.</label><caption><title>Values of <italic>μ</italic> for different filament (<italic>d</italic> = 2) graphs.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-app1-fig5-v2.tif"/></fig><fig id="app1fig6" position="float"><label>Appendix 1—figure 6.</label><caption><title>Values of <italic>μ</italic> for different trivalent (<italic>d</italic> = 3) graphs.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-app1-fig6-v2.tif"/></fig><fig id="app1fig7" position="float"><label>Appendix 1—figure 7.</label><caption><title>Values of <italic>μ</italic> for different <italic>d</italic> = 4 graphs.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71968-app1-fig7-v2.tif"/></fig><sec id="s7-5-1" sec-type="appendix"><title>Filaments of cells</title><p>A ring of <inline-formula><mml:math id="inf260"><mml:mi>n</mml:mi></mml:math></inline-formula> cells has degree <inline-formula><mml:math id="inf261"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, and the largest eigenvalue of the Laplacian matrix depends on whether <inline-formula><mml:math id="inf262"><mml:mi>N</mml:mi></mml:math></inline-formula> is even or odd:<disp-formula id="equ53"><label>(50)</label><mml:math id="m53"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>4</mml:mn></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mrow/><mml:mtext> </mml:mtext><mml:mrow/><mml:mi>n</mml:mi><mml:mrow><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>n</mml:mi><mml:mrow><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For <inline-formula><mml:math id="inf263"><mml:mi>n</mml:mi></mml:math></inline-formula> even, division of labour is possible if <inline-formula><mml:math id="inf264"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. For large odd <inline-formula><mml:math id="inf265"><mml:mi>n</mml:mi></mml:math></inline-formula>, <italic>μ</italic> is approximately 4, and so division of labour is again possible for <inline-formula><mml:math id="inf266"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. However, for small odd <inline-formula><mml:math id="inf267"><mml:mi>n</mml:mi></mml:math></inline-formula>, <italic>μ</italic> is less than 4. This means that, for small <inline-formula><mml:math id="inf268"><mml:mi>n</mml:mi></mml:math></inline-formula>, division of labour is ‘easier’ for even numbers of cells than for odd numbers of cells. For some examples, see <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>.</p></sec><sec id="s7-5-2" sec-type="appendix"><title>Complete graphs</title><p>The complete graph with <inline-formula><mml:math id="inf269"><mml:mi>n</mml:mi></mml:math></inline-formula> cells has degree is <inline-formula><mml:math id="inf270"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and the largest eigenvalue is (In terms of <xref ref-type="disp-formula" rid="equ49">Equation 47</xref>, a possible vector that achieves the maximum is <inline-formula><mml:math id="inf271"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf272"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf273"><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. For this vector, <inline-formula><mml:math id="inf274"><mml:mrow><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf275"><mml:mrow><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>.)<disp-formula id="equ54"><label>(51)</label><mml:math id="m54"><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>So reciprocal specialisation is possible only if <inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s7-5-3" sec-type="appendix"><title>Tessellations</title><p>We can carry out similar computations for (infinitely extended) tessellation patterns. There are many bipartite tessellations, in both two and three dimensions. All of these have the maximum possible <italic>μ</italic>, that is, <inline-formula><mml:math id="inf277"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Examples of this include the hexagonal lattice, the square lattice, and the 3D cube lattice: <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4(a), (b), and (e)</xref>. Reciprocal specialisation is also possible in many tessellations which are not bipartite. An example with <inline-formula><mml:math id="inf278"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> is shown in <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4(c)</xref>, which has <inline-formula><mml:math id="inf279"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>. Finally, there are tessellations which are so far from being bipartite that reciprocal specialisation is not possible. An example with <inline-formula><mml:math id="inf280"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula> is shown in <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4(d)</xref>, which has <inline-formula><mml:math id="inf281"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>. The condition <inline-formula><mml:math id="inf282"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mi>μ</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> cannot be satisfied with <inline-formula><mml:math id="inf283"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula>, since <inline-formula><mml:math id="inf284"><mml:mi>λ</mml:mi></mml:math></inline-formula> is at most 1.</p></sec></sec></sec><sec id="s8" sec-type="appendix"><title>B Random role allocation</title><p>We repeat the above analyses where we now assume that individuals adopt their phenotypes with a particular probability, independent of other individuals in the group. We find that, with random role allocation, division of labour is not possible (in the absence of accelerating individual ROIs).</p><sec id="s8-1" sec-type="appendix"><title>B.1 A ring of cells</title><p>Let p be the probability of adopting the role of a helper and investing <inline-formula><mml:math id="inf285"><mml:mi>x</mml:mi></mml:math></inline-formula> in cooperation and <inline-formula><mml:math id="inf286"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> as the probability of adopting the role of a reproductive and investing <inline-formula><mml:math id="inf287"><mml:mi>y</mml:mi></mml:math></inline-formula> in cooperation. In the case of a ring of cells, the number of helpers among a given cell’s two neighbours is a binomial random variable, <inline-formula><mml:math id="inf288"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This gives the expected fitness:<disp-formula id="equ55"><label>(52)</label><mml:math id="m55"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>W</mml:mi><mml:mo>⟩</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mfrac linethickness="0"><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mfrac linethickness="0"><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>The first term is the expected fitness if the focal cell adopts the role of a helper and the second term is the expected fitness if the focal cell adopts the role of a reproductive. We can simplify the above fitness equation to:<disp-formula id="equ56"><label>(53)</label><mml:math id="m56"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>W</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>If we multiply the fitness equation by <inline-formula><mml:math id="inf289"><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> and approximate <inline-formula><mml:math id="inf290"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf291"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, then we arrive at the final fitness equation:<disp-formula id="equ57"><label>(54)</label><mml:math id="m57"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>W</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where we now have that the expected viability of a helper is <inline-formula><mml:math id="inf292"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and the expected viability of a reproductive is <inline-formula><mml:math id="inf293"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>The function, <xref ref-type="disp-formula" rid="equ56">Equation 53</xref>, can be analysed using the results of Section B. We find (as expected) that division of labour by between-individual differences is not possible for this function:<disp-formula id="equ58"><label>(55)</label><mml:math id="m58"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Moreover, we can evaluate Condition 20 directly to find that division of labour by reciprocal specialisation can only evolve if (for linear functions <inline-formula><mml:math id="inf294"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf295"><mml:mi>H</mml:mi></mml:math></inline-formula>)<disp-formula id="equ59"><label>(56)</label><mml:math id="m59"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>It is impossible to satisfy this inequality for <inline-formula><mml:math id="inf296"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Thus, assuming linear or decelerating ROIs, we find that division of labour cannot evolve by reciprocal specialisation.</p><p>In order to calculate the fitness benefit of division of labour in <xref ref-type="fig" rid="fig4">Figure 4</xref> of the main text, we evaluate <inline-formula><mml:math id="inf297"><mml:mrow><mml:mrow><mml:msub><mml:mtext>max</mml:mtext><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi><mml:mo>≤</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where we approximate fitness using a second-order Taylor expansion and setting <inline-formula><mml:math id="inf298"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>. In this case, the above expression must now be maximised over two variables. This is done numerically to produce the main text figure.</p></sec><sec id="s8-2" sec-type="appendix"><title>B.2 A branching group of cells</title><p>We approximate the fitness of the group as the expected fitness of a randomly chosen cell in the branching group. With probability <inline-formula><mml:math id="inf299"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> we choose an ‘edge cell’ with <inline-formula><mml:math id="inf300"><mml:mi>a</mml:mi></mml:math></inline-formula> neighbours and with probability <inline-formula><mml:math id="inf301"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, we choose a ‘node’ cell with <inline-formula><mml:math id="inf302"><mml:mi>b</mml:mi></mml:math></inline-formula> neighbours (here <inline-formula><mml:math id="inf303"><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf305"><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>/</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>). If the cell is an edge cell, the number of neighbouring cells that are helpers is a binomial random variable <inline-formula><mml:math id="inf306"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. If the cell is a node cell, the number of neighbouring cells that are helpers is a binomial random variable <inline-formula><mml:math id="inf307"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Again, we let p be the probability that the cell adopts the role of a helper. Similar to the process above, we can derive a fitness equation of the form:<disp-formula id="equ60"><label>(57)</label><mml:math id="m60"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where we have approximated <inline-formula><mml:math id="inf308"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf309"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. We thus have that the viability of a helper is <inline-formula><mml:math id="inf310"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <inline-formula><mml:math id="inf311"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <inline-formula><mml:math id="inf312"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and the viability of a reproductive is <inline-formula><mml:math id="inf313"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <inline-formula><mml:math id="inf314"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <inline-formula><mml:math id="inf315"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. For the particular case of <inline-formula><mml:math id="inf316"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf317"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> (a branching filament), we can use <xref ref-type="disp-formula" rid="equ13">Equation 11</xref> to show that division of labour by between-individual differences can never evolve.</p><p>Moreover, if the returns from cooperation and fecundity are linear (<inline-formula><mml:math id="inf318"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), then we can evaluate Condition 20 directly to find that division of labour by reciprocal specialisation can only evolve if <inline-formula><mml:math id="inf319"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, which is outside the physically permissible range of the parameter. Thus, division of labour can only evolve in this scenario if there are individual efficiency benefits from specialisation.</p><p>In order to calculate the fitness benefit of division of labour in <xref ref-type="fig" rid="fig4">Figure 4</xref> of the main text, we evaluate <inline-formula><mml:math id="inf320"><mml:mrow><mml:mrow><mml:msub><mml:mtext>max</mml:mtext><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi><mml:mo>≤</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where we approximate fitness using a second-order Taylor expansion and setting <inline-formula><mml:math id="inf321"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>. In this case, the above expression must now be maximised over two variables. This is done numerically to produce the main text figure.</p></sec><sec id="s8-3" sec-type="appendix"><title>B.3 General graph analysis: random allocation</title><p>In general, suppose that the assignment of phenotype is done randomly, according to a probability density function <inline-formula><mml:math id="inf322"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, such that <inline-formula><mml:math id="inf323"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>z</mml:mi><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Write <inline-formula><mml:math id="inf324"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>z</mml:mi><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for the average, and <inline-formula><mml:math id="inf325"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>z</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> for the variance of the distribution. The expected fitness for an arbitrary graph model (<xref ref-type="disp-formula" rid="equ29">Equation 27</xref>) is<disp-formula id="equ61"><label>(58)</label><mml:math id="m61"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>W</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Putting <inline-formula><mml:math id="inf326"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf327"><mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula>, this becomes<disp-formula id="equ62"><label>(59)</label><mml:math id="m62"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>W</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where we have used that<disp-formula id="equ63"><label>(60)</label><mml:math id="m63"><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This calculation shows that the expected fitness of the group, <inline-formula><mml:math id="inf328"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>W</mml:mi><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, is independent of the group’s graph structure. Moreover, notice that <inline-formula><mml:math id="inf329"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>W</mml:mi><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is largest (for fixed <italic>z</italic><sub>0</sub>) if the distribution is chosen so that <inline-formula><mml:math id="inf330"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, that is, the state of uniform cooperation. Division of labour would correspond to <inline-formula><mml:math id="inf331"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. So <italic>division of labour cannot be favoured</italic> (absent accelerating returns) if phenotypes are assigned randomly.</p><p>To see this in greater detail, consider the distribution<disp-formula id="equ64"><label>(61)</label><mml:math id="m64"><mml:mrow><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>-</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Under this distribution, cells become a helper (phenotype <italic>z</italic><sub><italic>h</italic></sub>) with probability <inline-formula><mml:math id="inf332"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>, and a reproductive (phenotype <italic>z</italic><sub><italic>r</italic></sub>), with probability <inline-formula><mml:math id="inf333"><mml:mi>p</mml:mi></mml:math></inline-formula>. Then <inline-formula><mml:math id="inf334"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and<disp-formula id="equ65"><label>(62)</label><mml:math id="m65"><mml:mrow><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The total expected fitness is then<disp-formula id="equ66"><label>(63)</label><mml:math id="m66"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>W</mml:mi><mml:mo>&gt;=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf335"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≤</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, the function has a critical point at <inline-formula><mml:math id="inf336"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where its first derivatives vanish. We compute that the determinant of the Hessian of <inline-formula><mml:math id="inf337"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>W</mml:mi><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> at the critical point is<disp-formula id="equ67"><label>(64)</label><mml:math id="m67"><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which is positive. So<disp-formula id="equ68"><label>(65)</label><mml:math id="m68"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>is a maximum of <inline-formula><mml:math id="inf338"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>W</mml:mi><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, for all choices of p, and <inline-formula><mml:math id="inf339"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. If <inline-formula><mml:math id="inf340"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≥</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, then <inline-formula><mml:math id="inf341"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>W</mml:mi><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is maximised for <inline-formula><mml:math id="inf342"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. In either case, division of labour is not favoured.</p></sec></sec><sec id="s9" sec-type="appendix"><title>C Additional questions</title><sec id="s9-1" sec-type="appendix"><title>C.1 Does division of labour by reciprocal specialisation produce an accelerating fitness benefit?</title><p>We consider a population of uniform cooperators with ESS level of cooperation <inline-formula><mml:math id="inf343"><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. We consider a mutation where both helpers and reproductives specialise in their respective functions such that <inline-formula><mml:math id="inf344"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf345"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is the degree to which reproductives specialise more than helpers (<inline-formula><mml:math id="inf346"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) or less than helpers (<inline-formula><mml:math id="inf347"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). This gives the fitness of a mutant with reciprocal specialisation as:<disp-formula id="equ69"><label>(66)</label><mml:math id="m69"><mml:mrow><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where we have assumed that there are no between-individual differences and so <inline-formula><mml:math id="inf348"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> at the ESS strategy of uniform cooperation, <inline-formula><mml:math id="inf349"><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. What is the shape of the return from increased specialisation in this case? We solve for the second derivative of mutant fitness with respect to the degree of specialisation <inline-formula><mml:math id="inf350"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ70"><label>(67)</label><mml:math id="m70"><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>If this expression is positive, then the group fitness returns from reciprocal specialisation are accelerating. In contrast, if this expression is negative, then the group fitness returns from reciprocal specialisation are diminishing.</p><p>Let us now assume that the mutant has a higher fitness than the resident strategy of uniform cooperation, such that division of labour by reciprocal specialisation evolves (<inline-formula><mml:math id="inf351"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>). This means that the second term on the right-hand side of <xref ref-type="disp-formula" rid="equ69">Equation 66</xref> is strictly positive, which occurs when <inline-formula><mml:math id="inf352"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Importantly, this is the exact same condition as for an accelerating fitness return from reciprocal specialisation. Consequently, division of labour by reciprocal specialisation evolves if and only if the group fitness return from reciprocal specialisation is accelerating.</p></sec><sec id="s9-2" sec-type="appendix"><title>C.2 Does division of labour without accelerating returns from individual specialisation require that individuals have different viabilities?</title><p>In many cases, it makes more sense to consider the viability of the group as a whole rather than the viabilities of the individual cells in the group. For instance, in Volvocine algae, sterile flagella beaters provide a benefit to the group by keeping it afloat at the appropriate height in the water column for light absorption. In this instance, individuals literally sink or swim as a whole group and so all individuals have the same viability. Here, we go through the general framework where we now assume that <inline-formula><mml:math id="inf353"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>Considering <xref ref-type="disp-formula" rid="equ13">Equation 11</xref>, we find that division of labour by between-individual differences occurs when:<disp-formula id="equ71"><label>(68)</label><mml:math id="m71"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This specifies that the average contribution by helpers to group viability by a small increase in cooperation is greater than the average contribution by reproductives to group viability by a small increase in cooperation. Thus, putative helpers are predisposed to cooperation.</p><p>Let us now assume that there are no between-individual differences (<inline-formula><mml:math id="inf354"><mml:mrow><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>). Considering <xref ref-type="disp-formula" rid="equ15 equ16">Equations 15 and 16</xref>, we find that division of labour by an accelerating return from individual specialisation can arise if:<disp-formula id="equ72"><label>(69)</label><mml:math id="m72"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>V</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:mfrac><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mi>V</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mtext>or </mml:mtext></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ73"><label>(70)</label><mml:math id="m73"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>V</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>F</mml:mi></mml:mfrac><mml:mfrac><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mi>V</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We thus find that division of labour can evolve if <inline-formula><mml:math id="inf355"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf356"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. We now assume that there is a non-accelerating return from individual specialisation <inline-formula><mml:math id="inf357"><mml:mrow><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf358"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Considering <xref ref-type="disp-formula" rid="equ22">Equation 20</xref>, we find that the condition for division of labour by reciprocal specialisation is: <inline-formula><mml:math id="inf359"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. However, this contradicts our assumption that there are no between-individual differences (<inline-formula><mml:math id="inf360"><mml:mrow><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>), and so reciprocal specialisation is not a pathway to division of labour. Consequently, if we assume that all individuals in the group have the same viability (<inline-formula><mml:math id="inf361"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>), then division of labour evolves by either: (1) between-individual differences or (2) an accelerating return from individual specialisation.</p><p>In our main analysis, where different individuals may have different viabilities, the consequence to the fitness of the group when helpers have a lower viability is not modelled. Indeed, a helper produces the same amount of public good for the group regardless of its expected viability. This approximation is also made in the <xref ref-type="bibr" rid="bib43">Yanni et al., 2020</xref>, models and in earlier models by <xref ref-type="bibr" rid="bib23">Michod, 2006</xref>. More realistically, helpers with a lower viability may be expected to produce a smaller total amount of public good over the course of the group life cycle. This in principle could limit the efficiency benefits of between-individual differences and of synergistic reciprocal specialisation. Capturing this feedback between cooperation and viability with a formal model would require additional assumptions, which we leave to future work.</p></sec><sec id="s9-3" sec-type="appendix"><title>C.3 What happens if the fitness costs and benefits of cooperation are additive?</title><p>In the main analysis, we have assumed that cooperation provides a viability benefit at a personal cost to fecundity, where individual fitness is the product of viability and fecundity. Here, we assume instead that the benefits and costs of cooperation are additive, such that increased cooperation leads to an increase in group fecundity at a cost to personal fecundity. For ease of comparison, we maintain the notation <inline-formula><mml:math id="inf362"><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf363"><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, which now correspond to the fecundity benefit provided to helpers and reproductives by the cooperation of group members.</p><p>This gives the following fitness of the group:<disp-formula id="equ74"><label>(71)</label><mml:math id="m74"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="160%" minsize="160%">(</mml:mo><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="160%" minsize="160%">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="160%" minsize="160%">(</mml:mo><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="160%" minsize="160%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>We can employ the Taylor expansion of fitness (<xref ref-type="disp-formula" rid="equ3">Equation 2</xref>) to determine the three conditions leading to division of labour. First, we find that division of labour by between-individual differences can arise if:<disp-formula id="equ75"><label>(72)</label><mml:math id="m75"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This shows that division of labour can evolve if some individuals (helpers) can provide larger fecundity benefits for the group at the same fecundity cost as others (reproductives). Division of labour by an accelerating return from individual specialisation can arise if:<disp-formula id="equ76"><label>(73)</label><mml:math id="m76"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mtext>or </mml:mtext></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ77"><label>(74)</label><mml:math id="m77"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This shows that division of labour by an accelerating return from individual specialisation can arise if there is an accelerating return from decreased cooperation due to increased personal fecundity <inline-formula><mml:math id="inf364"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, or an accelerating return from increased cooperation due to increased viability of the group (<inline-formula><mml:math id="inf365"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). If none of the above hold, we find that reciprocal specialisation can evolve if:<disp-formula id="equ78"><label>(75)</label><mml:math id="m78"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where we have assumed that <inline-formula><mml:math id="inf366"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. This states that there is interference between the cooperative efforts of helpers and reproductives such that increased cooperation by helpers leads to larger relative fecundity benefits for the group when reproductives cooperate less (<inline-formula><mml:math id="inf367"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). There is an analogous effect when fitness is the product of fecundity and viability (first term in small brackets on right-hand side of Condition 17).</p></sec></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71968.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Goldstein</surname><given-names>Raymond E</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><p>This manuscript presents a theoretical study of the evolution of division of labor, exploring the impact of topology, the convexity and concavity of fitness returns on investment, and different biological modes through which division of labor may arise. This is a difficult topic to study as division of labor evolved long ago, and many theoretical predictions have proven difficult to directly test. The results presented here may provide the next step necessary to produce truly testable hypotheses on how division of labor evolves, and will be of interest to evolutionary biologists, mathematical biologists, and biophysicists.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71968.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Goldstein</surname><given-names>Raymond E</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Yunker</surname><given-names>Peter J</given-names></name><role>Reviewer</role><aff><institution>Georgia Institute of Technology</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Does the evolution of division of labour require accelerating returns from individual specialisation?&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Detlef Weigel as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Peter J Yunker (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) I don't think that the title adequately reflect the novelty of the paper. The work by Rueffler et al. 2012 and Yanni et al. 2020 already provide an answer to this question. We know that accelerating returns are not required. The in-depth analysis on the role of topological constraints and coordination are the key novelties and this should be reflected in the title.</p><p>2) Figure 4 and the conclusion on the efficiency benefits at the group level (lines 355-357) are central to the argumentation of the paper. However, the actual group benefits as a function of λ and individual return functions are nowhere shown in the paper. I think it would be very beneficial if the authors add additional panels to Figure 4, perhaps in the form of heat maps, showing how the group benefit is affected by the two main parameters altered.</p><p>3) The contradiction with Yanni et al. 2020 boils down to whether λ &gt; (n-1)/n is a realistic scenario or not. Can the authors provide biological examples where this condition could be fulfilled?</p><p>4) The findings on lines 431-434 are very important, but the data is not presented in a visual form. I recommend to add an additional figure displaying the actual results, again together with group productivity effects as mentioned in my comment 3. above.</p><p>5) It is shown that division of labor can evolve with concave returns on investment if an optimal pattern is produced. Further, it is shown that if specialists are randomly distributed on a graph, specialization can only evolve if returns on investment are convex. This is a very nice result. However, while I really like this result, the discussion of it overstates what has been learned. In particular, perfect realizations of patterning and completely random distributions of specialists represent the two extreme cases. While the authors are likely correct that mechanisms that perfectly reproduce patterns are unlikely to evolve prior to division of labor, mechanisms that produce patterns with random errors very well are different. Single celled organisms have many mechanisms through which they modify behavior based on interactions with their environment and each other. Further, alternating patterns are common in biology and physics, and can emerge from simple low-level rules. So, the possibility of producing a pattern of alternating specialists – with errors – is plausible. The question then becomes, for a given topological structure, how precise must the pattern be reproduced? If perfect (or nearly perfect) patterning is required, then concave specialization via topology seems unlikely. However, if <italic>nearly</italic> random patterns favor concave specialization, this barrier would be significantly reduced. The 'error tolerance' of a given topological structure seems likely to depend on its fitness advantage over generalists. While a thorough analysis of this question would be fantastic to see, I do not think it is necessary for publication. Instead, I think it would be sufficient to expand the discussion of this topic to reflect these uncertainties.</p><p>In a related vein, &quot;between individual differences&quot; share some similarities with these imperfect patterns. It is unlikely that between individual differences would arise via sophisticated intercellular communication/interactions. But simple mechanisms, such as stochastic switches or persistent environmental interactions can lead to phenotypic differences. If these phenotypic differences arise via spatial interactions, then a pattern emerges as well.</p><p>6) I wonder if the way sharing is modeled here is too generous. If a cell shares all of its viability, shouldn't it be dead? Either (1) the viability that is being shared is not all of that individual's viability, in which case the fitness written is not the actual fitness of the organism, (2) this sharing is a one-time act after which the altruistic cell is dead, (3) or there is some other reason why this scenario is reasonable which needs to be further explained.</p><p>7) Line 408 These results do not seem contradictory to me. Different assumptions produce different models, which, in turn, produce different results. For example, if I construct a model with no sharing, division of labor will not evolve, even for accelerating returns. This does not contradict models that include sharing, but is the result of a different assumption / scenario. It can, of course, be discussed which approach is applicable in different scenarios, and which may be more broadly applicable.</p><p>8) Line 453 &quot;However, the biological plausibility of any mechanism based on pre-existing cues would need to be explicitly justified and modelled…&quot;</p><p>Line 458 &quot;further studies-such as ancestral-state reconstructions-are needed to show whether coordination preceded division of labour in individual species&quot;</p><p>These are true statements. However, similarly true statements can be made about nearly any mechanism that facilitates the evolution of division of labor. For example, accelerating returns. Placing all of these mechanisms within this context, or presenting the evidence that exists for some but not others, would be helpful.</p><p>9) Equation 3 was another very nice result. However, I think the discussion here could also be clarified. This model appears likely to hold as long as the standard deviation of d is small compared to the mean d. Consider an organism that has 1000 somatic cells that each only connect to one central germ cell; consider also a linear return on investment. Equation 3 suggests that λ must be greater than 0.5. In this absurd case, specialists should produce a higher fitness than generalists even if λ is less than 0.5. Again, while additional work determining the exact limits in which Equation 3 applies would be nice, I do not think they are necessary. Instead, appropriate caveats could be added to this effect.</p><p><italic>Reviewer #1:</italic></p><p>The paper consists of two parts.</p><p>The first part deals with &quot;the three pathways to division of labour&quot;. It builds on a mathematical model showing that division of labour can evolve when (1) there are accelerating returns for individuals from specialisation, (2) there are pre-existing differences between individuals such that some individuals are predisposed for one task or the other, and (3) there is reciprocal specialisation leading to synergistic efficiency benefits at the group level. This model recovers the findings by Rueffler et al. 2012. This part is very well written and reads more like a review, bringing specialised and non-specialised readers onto the same page.</p><p>The second part focusses on pathways (2) and (3), where individual returns can be diminishing, and thus the evolution of division of labour is more difficult to explain. This part is motivated by a recent paper by Yanni et al. 2020 in <italic>eLife</italic> showing that topological constraints (e.g. small network of individuals, limited number of neighbours) are essential to favour division of labour with diminishing returns. The authors challenge this view and provide an in-depth analysis on topological constraints. They show that such constraints in combination with pre-existing differences between individuals and reciprocal specialisation are indeed conducive for the evolution of division of labour, but not essential. They show that when the benefit of cooperation is larger for neighbours than for the co-operator than division of labour can evolve with diminishing returns even in the absence of topological constraints. This is a key new insight. But perhaps even more important, the authors highlight that pathways (2) and (3) rely on the assumption that individuals have access to information from neighbours to coordinate their actions at the group level. The authors show that division of labour cannot evolve with diminishing returns when such information is absent. And because mechanisms of information collection and coordination are likely to only evolve once division of labour is already in place, the authors argue that topological constraints might play a minor role in driving the initial evolutionary steps towards division of labour.</p><p>In brief, this is a very insightful paper and significantly advances our theoretical and conceptual understanding of division of labour. It will spur future theoretical and empirical work in the field, and for the latter, the authors present guidelines of how to test the theory.</p><p><italic>Reviewer #2:</italic></p><p>This is a very interesting paper on the evolution of division of labor. In particular, the authors explore the impact of topology, the convexity and concavity of fitness returns on investment, and different biological 'modalities' through which division of labor may arise. This is a difficult topic to study as, in most lineages, division of labor evolved long ago, and thus cannot be directly studied in the lab. Further, many theoretical predictions have proven difficult to directly test. This manuscript furthers our understanding of the underlying theory of the evolution of division of labor, and presents a means to test which modality is responsible for the emergence of division of labor in different cases.</p><p>However, there are a few caveats worth mentioning. Comparisons to previous works are not always clear. Different models built with different assumptions can produce different predictions; however, that does not mean they disagree, only that they describe different scenarios. Further, the model used here allows an entity to give away all of its 'viability,' making it unclear how it continues to live and function. Finally, the order in which division of labor and 'patterning' evolve is presented as definitive, when it is ultimately a postulate.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71968.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) I don't think that the title adequately reflect the novelty of the paper. The work by Rueffler et al. 2012 and Yanni et al. 2020 already provide an answer to this question. We know that accelerating returns are not required. The in-depth analysis on the role of topological constraints and coordination are the key novelties and this should be reflected in the title.</p></disp-quote><p>We have changed the title. There are several novel results in the analysis and so we have chosen a title that we think captures its scope, without focus on any one particular result or use of any jargon.</p><disp-quote content-type="editor-comment"><p>2) Figure 4 and the conclusion on the efficiency benefits at the group level (lines 355-357) are central to the argumentation of the paper. However, the actual group benefits as a function of λ and individual return functions are nowhere shown in the paper. I think it would be very beneficial if the authors add additional panels to Figure 4, perhaps in the form of heat maps, showing how the group benefit is affected by the two main parameters altered.</p></disp-quote><p>This is a really nice idea. We have replaced the relevant panels in Figure 4 with heat maps as suggested. This now shows both when division of labour is favoured to invade (non-white shading) and the relative fitness benefit of division of labour when it does (relative darkness of shading).</p><disp-quote content-type="editor-comment"><p>3) The contradiction with Yanni et al. 2020 boils down to whether λ &gt; (n-1)/n is a realistic scenario or not. Can the authors provide biological examples where this condition could be fulfilled?</p></disp-quote><p>We have expanded discussion of this point, highlighting why there are differences in the predictions of each model, and giving biological examples of cooperation that benefits neighbours more than producers. Lines 420-438.</p><disp-quote content-type="editor-comment"><p>4) The findings on lines 431-434 are very important, but the data is not presented in a visual form. I recommend to add an additional figure displaying the actual results, again together with group productivity effects as mentioned in my comment 3. above.</p></disp-quote><p>Thank you for the suggestion, we have expanded Figure 4 to include new panels that show when division of labour is favoured to evolve under fully random specialisation. These illustrate that an accelerating return form specialisation is required in all three models.</p><disp-quote content-type="editor-comment"><p>5) It is shown that division of labor can evolve with concave returns on investment if an optimal pattern is produced. Further, it is shown that if specialists are randomly distributed on a graph, specialization can only evolve if returns on investment are convex. This is a very nice result. However, while I really like this result, the discussion of it overstates what has been learned. In particular, perfect realizations of patterning and completely random distributions of specialists represent the two extreme cases. While the authors are likely correct that mechanisms that perfectly reproduce patterns are unlikely to evolve prior to division of labor, mechanisms that produce patterns with random errors very well are different. Single celled organisms have many mechanisms through which they modify behavior based on interactions with their environment and each other. Further, alternating patterns are common in biology and physics, and can emerge from simple low-level rules. So, the possibility of producing a pattern of alternating specialists – with errors – is plausible. The question then becomes, for a given topological structure, how precise must the pattern be reproduced? If perfect (or nearly perfect) patterning is required, then concave specialization via topology seems unlikely. However, if nearly random patterns favor concave specialization, this barrier would be significantly reduced. The 'error tolerance' of a given topological structure seems likely to depend on its fitness advantage over generalists. While a thorough analysis of this question would be fantastic to see, I do not think it is necessary for publication. Instead, I think it would be sufficient to expand the discussion of this topic to reflect these uncertainties.</p></disp-quote><p>We have expanded the discussion in the section to highlight that a perfect allocation of labour may not in principle be required, but simply that cell specialisation cannot be fully random (Lines 461-466).</p><disp-quote content-type="editor-comment"><p>In a related vein, &quot;between individual differences&quot; share some similarities with these imperfect patterns. It is unlikely that between individual differences would arise via sophisticated intercellular communication/interactions. But simple mechanisms, such as stochastic switches or persistent environmental interactions can lead to phenotypic differences. If these phenotypic differences arise via spatial interactions, then a pattern emerges as well.</p></disp-quote><p>We have expanded the discussion of this point to include the possibility that the mechanism that produces between individual differences may be co-opted to coordinate division of labour (Lines 484486).</p><disp-quote content-type="editor-comment"><p>6) I wonder if the way sharing is modeled here is too generous. If a cell shares all of its viability, shouldn't it be dead? Either (1) the viability that is being shared is not all of that individual's viability, in which case the fitness written is not the actual fitness of the organism, (2) this sharing is a one-time act after which the altruistic cell is dead, (3) or there is some other reason why this scenario is reasonable which needs to be further explained.</p></disp-quote><p>This is a good point, which we had discussed in supplementary section C.2. Our assumptions align with scenario (2) above and are consistent with the modelling assumptions of the Yanni et al. (2020) paper and Michod (2006<italic>)</italic> paper. We have added a description of this assumption in the main text (Lines 135138) and expanded the discussion in the supplementary information (section C.2).</p><disp-quote content-type="editor-comment"><p>7) Line 408 These results do not seem contradictory to me. Different assumptions produce different models, which, in turn, produce different results. For example, if I construct a model with no sharing, division of labor will not evolve, even for accelerating returns. This does not contradict models that include sharing, but is the result of a different assumption / scenario. It can, of course, be discussed which approach is applicable in different scenarios, and which may be more broadly applicable.</p></disp-quote><p>We have expanded discussion of the assumptions made in the different models. Please see our response to revision point (3) above.</p><disp-quote content-type="editor-comment"><p>8) Line 453 &quot;However, the biological plausibility of any mechanism based on pre-existing cues would need to be explicitly justified and modelled…&quot;</p><p>Line 458 &quot;further studies-such as ancestral-state reconstructions-are needed to show whether coordination preceded division of labour in individual species&quot;</p><p>These are true statements. However, similarly true statements can be made about nearly any mechanism that facilitates the evolution of division of labor. For example, accelerating returns. Placing all of these mechanisms within this context, or presenting the evidence that exists for some but not others, would be helpful.</p></disp-quote><p>We have added a paragraph to highlight why we think that a larger burden of evidence is needed for between-cell coordination then for accelerating returns from individual specialisation (Lines 495-500). In short, coordination requires an adaptive argument for why such between-cell behaviour will have evolved prior to or concurrently with the emergence of division of labour. In contrast, the shape of the return from more investment is simply an inherent aspect of the biotic or abiotic environment and so does not require an adaptive justification.</p><disp-quote content-type="editor-comment"><p>9) Equation 3 was another very nice result. However, I think the discussion here could also be clarified. This model appears likely to hold as long as the standard deviation of d is small compared to the mean d. Consider an organism that has 1000 somatic cells that each only connect to one central germ cell; consider also a linear return on investment. Equation 3 suggests that λ must be greater than 0.5. In this absurd case, specialists should produce a higher fitness than generalists even if λ is less than 0.5. Again, while additional work determining the exact limits in which Equation 3 applies would be nice, I do not think they are necessary. Instead, appropriate caveats could be added to this effect.</p></disp-quote><p>We have added text to clarify this point (Lines 332-336). Equation 3 is arrived at by assuming that all cells have the same number of neighbours (standard deviation of d is zero). If this is not the case, then different cells have different numbers of neighbours and therefore division of labour by between individual differences will evolve (as established in the section just prior to this one). If that is the case, the second order analysis that goes into deriving Equation 3 is inconsequential to whether division of labour can evolve.</p></body></sub-article></article>