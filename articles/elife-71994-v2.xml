<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">71994</article-id><article-id pub-id-type="doi">10.7554/eLife.71994</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Short Report</subject></subj-group><subj-group subj-group-type="heading"><subject>Cancer Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Signature-scoring methods developed for bulk samples are not adequate for cancer single-cell RNA sequencing data</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-248259"><name><surname>Noureen</surname><given-names>Nighat</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7495-8201</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-248260"><name><surname>Ye</surname><given-names>Zhenqing</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-30616"><name><surname>Chen</surname><given-names>Yidong</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-248261"><name><surname>Wang</surname><given-names>Xiaojing</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-220225"><name><surname>Zheng</surname><given-names>Siyuan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1031-9424</contrib-id><email>zhengs3@uthscsa.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Greehey Children’s Cancer Research Institute, UT Health San Antonio</institution><addr-line><named-content content-type="city">San Antonio</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Department of Population Health Sciences, UT Health San Antonio</institution><addr-line><named-content content-type="city">San Antonio</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Robles-Espinoza</surname><given-names>C Daniela</given-names></name><role>Reviewing Editor</role><aff><institution>International Laboratory for Human Genome Research</institution><country>Mexico</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Barkai</surname><given-names>Naama</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0316ej306</institution-id><institution>Weizmann Institute of Science</institution></institution-wrap><country>Israel</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>25</day><month>02</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e71994</elocation-id><history><date date-type="received" iso-8601-date="2021-07-06"><day>06</day><month>07</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-02-25"><day>25</day><month>02</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2021-07-01"><day>01</day><month>07</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.06.29.450404"/></event></pub-history><permissions><copyright-statement>© 2022, Noureen et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Noureen et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-71994-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-71994-figures-v2.pdf"/><abstract><p>Quantifying the activity of gene expression signatures is common in analyses of single-cell RNA sequencing data. Methods originally developed for bulk samples are often used for this purpose without accounting for contextual differences between bulk and single-cell data. More broadly, few attempts have been made to benchmark these methods. Here, we benchmark five such methods, including single sample gene set enrichment analysis (ssGSEA), Gene Set Variation Analysis (GSVA), AUCell, Single Cell Signature Explorer (SCSE), and a new method we developed, Jointly Assessing Signature Mean and Inferring Enrichment (JASMINE). Using cancer as an example, we show cancer cells consistently express more genes than normal cells. This imbalance leads to bias in performance by bulk-sample-based ssGSEA in gold standard tests and down sampling experiments. In contrast, single-cell-based methods are less susceptible. Our results suggest caution should be exercised when using bulk-sample-based methods in single-cell data analyses, and cellular contexts should be taken into consideration when designing benchmarking strategies.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>single cell RNA sequencing</kwd><kwd>signature scoring</kwd><kwd>benchmarking</kwd><kwd>gene counts</kwd><kwd>cancer stemness</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004917</institution-id><institution>Cancer Prevention and Research Institute of Texas</institution></institution-wrap></funding-source><award-id>RR170055</award-id><principal-award-recipient><name><surname>Zheng</surname><given-names>Siyuan</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004917</institution-id><institution>Cancer Prevention and Research Institute of Texas</institution></institution-wrap></funding-source><award-id>RP170345</award-id><principal-award-recipient><name><surname>Noureen</surname><given-names>Nighat</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Dropouts in single cell RNA sequencing data are associated with cell states and can affect gene signature scoring if methods do not account for them.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Single-cell RNA sequencing (scRNA-seq) is a powerful technology to study the ecosystems of normal and disease tissues. Gene expression signatures can be used to interrogate single cells for cell identities and other cellular properties (<xref ref-type="bibr" rid="bib19">Noureen et al., 2021a</xref>) using signature-scoring methods. A key consideration for these methods is how to account for the variability of expression within the signature, a characteristic often associated with the overall expression variability of the interrogated sample. Despite widespread use and their benchmarking on certain applications (<xref ref-type="bibr" rid="bib13">Holland et al., 2020</xref>; <xref ref-type="bibr" rid="bib27">Zhang et al., 2020</xref>), limitations of these methods, including some initially developed for bulk samples, are incompletely understood in scRNA-seq analysis.</p><p>Compared with bulk-sample RNAseq, scRNA-seq data have high dropout rates (<xref ref-type="bibr" rid="bib12">Hicks et al., 2018</xref>). Dropout rates are the opposite of gene counts, that is, the number of genes detected in a cell, a feature that is associated with cell differentiation status (<xref ref-type="bibr" rid="bib9">Gulati et al., 2020</xref>). Variability in gene counts may cause imbalanced representation of non-expressed genes in gene signatures, resulting in scoring bias. Thus, we reason that in contexts where cells differ in differentiation status, failing to account for this variability may lead to misleading signature scores.</p><p>Cancer cells exhibit stem-cell like properties <xref ref-type="bibr" rid="bib16">Malta et al., 2018</xref>; thus, cancer may represent such a context. To test this, we benchmark five signature-scoring methods in cancer single-cell datasets. The five methods included bulk-sample-based methods single sample gene set enrichment analysis (ssGSEA) and Gene Set Variation Analysis (GSVA) (implemented in the R GSVA package <xref ref-type="bibr" rid="bib10">Hänzelmann et al., 2013</xref>) and three single-cell-based methods, AUCell (<xref ref-type="bibr" rid="bib1">Aibar et al., 2017</xref>), Single-Cell Signature Explorer (SCSE) (<xref ref-type="bibr" rid="bib21">Pont et al., 2019</xref>), and Jointly Assessing Signature Mean and Inferring Enrichment (JASMINE), a new method we developed. We show that cancer cells consistently express more genes than normal cells, and this imbalance significantly biases results from ssGSEA and GSVA but largely spares single-cell-based methods. Our results caution against the use of bulk-sample-based methods in scRNA-seq analyses.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Cancer cells demonstrate higher gene counts than normal cells</title><p>Several recent studies showed that gene counts of single cells are associated with cell differentiation status and cell identity (<xref ref-type="bibr" rid="bib9">Gulati et al., 2020</xref>; <xref ref-type="bibr" rid="bib23">Qiu, 2020</xref>). Specifically, cells higher in the differentiation hierarchy express more genes. To examine if cancer and normal cells demonstrate similar imbalances, we collected 10 scRNA-seq datasets across different cancer types, technological platforms and sequencing coverage (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). We also obtained cell type annotations from the original studies. We found that the average number of detected genes was significantly higher in tumor cells than in normal cells across all datasets (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, p &lt; 2.2e-16). This imbalance persisted when we separated normal cells into different cell populations (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). However, cancer-associated cells, including cancer-associated fibroblasts (CAF), tumor-associated macrophages (TAM), and tumor-related endothelial cells (TEC) had higher gene counts than other normal cell types, sometimes even comparable to malignant cells (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Gene count imbalances affect signature scoring.</title><p>(<bold>A</bold>) The number of detected genes in tumor and normal cell populations in 10 single cell cancer RNAseq datasets. The height of each bar represents average, and whiskers represent standard deviation. In all cases, the difference is statistically significant (student t test, p &lt; 2.2e-16). (<bold>B</bold>) Percentage of up and down regulated gene signatures in cancer cells relative to normal cells based on Cohen’s d. Dot size corresponds to the percentage of all signatures tested (<italic>n</italic> = 7503). (<bold>C</bold>) Spearman correlation coefficients of Cohen’s d with signature sizes across the datasets and methods. Asterisk (*) in each cell indicates p-value &lt; 0.01. Color of the heatmap represents correlation coefficient. (<bold>D</bold>) Scores of a cell cycle gene set (GO:0007049) calculated using four methods along with MKI67 expression, gene counts, and cell cycle phases predicted by Seurat in Tumor and normal cell populations of HNSC dataset (GSE103322). The red box highlights non-cycling tumor cells that exhibit higher scores than non-cycling normal cells.</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig1">Figure 1</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-71994-fig1-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Bias in gene counts.</title><p>Number of genes expressed in tumor and normal cell types across five single cell data sets including colorectal cancer (CRC), liver cancer (LIHC), head and neck cancer (HNSC), melanoma, and clear cell renal carcinoma (ccRCC). Maroon colors represent tumor cell populations in each data set while blue represents normal cell populations across the datasets. Note that in the LIHC dataset, CAF, TAM, and TEC are cancer-associated fibroblasts, tumor-associated macrophages, and tumor-related endothelial cells, respectively.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Patterns of up and down regulated signatures.</title><p>Comparing tumor and normal cell populations across six additional datasets, including (<bold>A</bold>) colorectal, (<bold>B</bold>) head and neck cancer, (<bold>C</bold>) astrocytoma, (<bold>D</bold>) IDHwt GBM, (<bold>E</bold>) liver, and (<bold>F</bold>) melanoma. The size of each dot represents the percentage of up or down signatures over all signatures tested (<italic>n</italic> = 7503).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>GSVA and ssGSEA comparison.</title><p>Comparison of effect size (Cohen’s d) for ssGSEA (x-axis) and GSVA (y-axis) in four datasets: colorectal cancer (CRC) , head and neck cancer, melanoma, and clear cell renal carcinoma. Red line represents X = Y and black line is the regression line. Correlation is calculated using Spearman method.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig1-figsupp3-v2.tif"/></fig></fig-group></sec><sec id="s2-2"><title>Bias of ssGSEA signature scores in cancer datasets</title><p>The reliability of signature-scoring methods is measured by their ability to identify the quantitative differences between two groups of samples at the gene-signature level. Here, we compare signature scores between tumor and normal cells. One issue is that scores from these methods differ in range and variance, thus making direct comparison challenging. To overcome this challenge, we used Cohen’s d (<xref ref-type="bibr" rid="bib6">Cohen, 1988</xref>), a measurement that normalizes mean differences with standard deviation, thus generating unitless contrast that can be compared across methods. For simplicity, we defined Cohen’s d greater than one as upregulated, and less than –1 as down regulated. These criteria were used throughout this work.</p><p>We assembled 7503 gene sets from MSigDB that each has at least 20 genes (The term ‘gene set’ is used interchangeably with ‘gene signature’; Methods). On average, single-cell methods reported similar proportions of up- and down-regulated gene sets (9% vs 12% of all input gene sets) (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). In contrast, ssGSEA and GSVA reported 25 and 23% of the input gene sets as upregulated but only 6 and 5% as down regulated. In six out of the 10 datasets, ssGSEA and GSVA estimated more than twice as many upregulated gene sets than down gene sets. This pattern remained when we divided normal cells into different populations (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). Notably, in cell types with high gene counts such as TEC, TAM, and CAF, we did not observe significantly more upregulated gene sets by ssGSEA and GSVA (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2E,F</xref>). These results collectively suggest ssGSEA and GSVA are sensitive to variability of gene counts common to scRNA-seq data.</p><p>We also found that Cohen’s d from ssGSEA and GSVA showed consistent positive correlation with gene set sizes (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Single-cell methods did not demonstrate this pattern.</p><p>We observed that GSVA was slower than other methods. For instance, running the head and neck dataset with 200 threads on a 2.5 GHz Xeon processor took more than 3 days to complete. Because GSVA outputs were highly consistent with those of ssGSEA (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>), and its running speed would not likely scale up to single cell datasets, we dropped GSVA from subsequent analyses.</p><p>We next use an example to illustrate how gene counts may affect signature scores and data interpretation. We scored the cell cycle gene signature from Gene Ontology (GO:0007049) in the head and neck cancer (HNSC) dataset (<xref ref-type="bibr" rid="bib22">Puram et al., 2017</xref>). For comparison, we used Seurat (<xref ref-type="bibr" rid="bib4">Butler et al., 2018</xref>) to identify cycling cells at G2M and S phases and also included the expression of KI67, a proliferation marker expressed by cycling cells. We observed all four methods reported a higher score in cycling cells (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). However, ssGSEA scores were significantly higher in non-cycling cancer cells than in normal cells although neither are cycling (Student’s <italic>t</italic> test, p &lt; 2.2e-16). In contrast, the single-cell-based methods did not show this difference.</p></sec><sec id="s2-3"><title>Sensitivity and specificity</title><p>We next generated gold standard up- and down-regulated gene sets at various sizes to benchmark detection sensitivity. To simulate real-world scenario, we added noises to each gene set so that higher noise levels attenuate more of their signals (Method).</p><p>We found gene set size had negligible impacts on detection rates (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Noise levels, on the other hand, had a much bigger impact. For up gene sets, all methods were able to detect 50% of the gene sets on average even at the 80% noise level (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). However, for down gene sets, ssGSEA performed worse than other methods (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Without noise, it only detected about 85% of the gene sets. At 80% noise level, it detected around 30% of the gene sets, compared to 70–80% by single-cell methods.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Sensitivity, specificity and accuracy.</title><p>(<bold>A</bold>) Recovery rate for up gene signatures across five noise levels by the four methods. Each dot represents one dataset. At each noise level, average of all datasets is used to represent the performance of each method. (<bold>B</bold>) Similarly, for down signatures. (<bold>C</bold>) Percentages of false up and down signatures. The size of the dots corresponds to the percentages of all the signatures tested. Because the contrasting groups are generated by down sampling, no signatures are expected to be identified. The numbers below the heatmap are the average percentage. (<bold>D</bold>) Accuracy of the three methods, separated into up and down signatures. Accuracy is calculated as the agreement with consensus calls by at least two methods.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig2">Figure 2</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-71994-fig2-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Benchmarking sensitivity using simulated gene signatures.</title><p>We simulated four gene set sizes (50, 100, 150, 200, and 300), each with five levels of noise (0, 20, 40, 60, and 80%). For each size/noise combination, we randomly generated 1000 signatures. The results shown in this figure are percentage of the 1000 random signatures. (<bold>A</bold>) Detection sensitivity for up gene signatures. Deeper color indicates lower recovery rates (thus more misses). (<bold>B</bold>) Detection sensitivity for down signatures.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Coefficient of Variance.</title><p>Average coefficient of variance between the original datasets and the 50% down-sampled datasets. Each dot represents one dataset.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Comparison of calling results from the four methods across the seven datasets.</title><p>In heatmap, each column represents one signature. Blue, down signature; red, up signature.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Consistency with consensus and pairwise comparison.</title><p>(<bold>A</bold>) Sensitivity and false positive benchmarked against the consensus calls (signatures called by at least two methods). (<bold>B</bold>) Spearman correlation of Cohen’s d broken down to each dataset. (<bold>C</bold>) Consistency between three methods, numbers are Spearman correlation coefficients.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig2-figsupp4-v2.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Evaluation of computing cost.</title><p>(<bold>A</bold>) Average time consumption for completing 50 gene signatures using a 2.2 GHz, 32 GB memory CPU. (<bold>B</bold>) Memory cost for completing 50 gene signatures using a 2.2 GHz, 32 GB memory CPU.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig2-figsupp5-v2.tif"/></fig></fig-group><p>To benchmark detection specificity, we generated null datasets by randomly choosing 100 cancer cells from each dataset. We down sampled each cell to 50% coverage, resulting in lower gene counts. These cells were then normalized to the same total coverage. Because the down-sampled cells were the same cells with the original, no up or down gene sets were expected between the two groups.</p><p>We found AUCell and JASMINE outperformed SCSE and ssGSEA in specificity (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). On average, AUCell detected 7.5 and 1.2% of the input gene sets as up and down; JASMINE detected 4 and 1%. In four datasets, SCSE overestimated down regulated gene sets (average 25.4%). ssGSEA grossly overestimated both up- and down regulated gene sets in all datasets (average 11 and 46%, respectively).</p><p>Next, we estimated how changes in gene count affected score stability. For each gene signature, we calculated coefficient of variance (CV) (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). We observed that single-cell methods were robust to our down sampling, with little changes in CV. However, in three datasets, ssGSEA had a higher CV in down-sampled cells than in original cells.</p></sec><sec id="s2-4"><title>Comparing with consensus and computational efficiency</title><p>We next compared the three single-cell-based methods against consensus—gene sets that were identified as up- or down regulated by at least two methods. JASMINE aligned better with the consensus in most datasets (<xref ref-type="fig" rid="fig2">Figure 2D</xref> and <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). AUCell overall had lower accuracies against the consensus, particularly for down regulated gene sets, likely because it is designed to score marker signatures (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). When breaking down to sensitivity and specificity, AUCell showed higher false positive rates (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>). The three tools showed comparable sensitivity. Across the 10 datasets, SCSE and JASMINE showed better correlation (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4B,C</xref>), thus explaining their relatively better alignment with the consensus.</p><p>Finally, we tested computing efficiency of the four methods. We randomly generated gene sets of various sizes and analyzed each gene set in a dataset consisting of 2000 cells. <xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref> shows the time and memory use averaged over 50 iterations for one gene set under the same hardware configuration (2.20 GHz CPU, 32 GB memory). Overall, SCSE was the most efficient computationally. JASMINE was the second fastest algorithm but required a memory similar to that of ssGSEA. AUCell was slightly faster than ssGSEA but required the most memory. Their performances were robust across signature sizes.</p></sec><sec id="s2-5"><title>Dropouts affect ssGSEA scores</title><p>To further show the impact of dropouts on ssGSEA scores, we re-ran the down sampling experiment by setting down sampling rates to 20, 40, 60, and 80%. A down sampling rate of 80% indicates that the total sequencing depth of the down sampled cell is at 80% of the original cell. A lower down sampling rate creates more dropouts. We observed that as the down sampling rate shifted from low to high, the pattern of deregulated gene sets by ssGSEA also shifted from more up gene sets towards more down gene sets (<xref ref-type="fig" rid="fig3">Figure 3A</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). This observation strongly associates dropouts with ssGSEA scores. In <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, we provide an example using real data to show how ssGSEA scores change when limited to cells with comparable gene counts.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Impact of dropouts on ssGSEA signature scoring.</title><p>(<bold>A</bold>) Percentages of up and down regulated gene signatures in original cells relative to down sampled cells for four levels of down sampling (20, 40, 60, and 80%) based on Cohen’s d. Dot size corresponds to the percentage of all signatures tested (<italic>n</italic> = 7503) in Head and Neck (<xref ref-type="bibr" rid="bib22">Puram et al., 2017</xref>). (<bold>B</bold>) Effect of dropouts on ssGSEA scoring using a dummy expression matrix. The black line denotes the cell without any dropouts, and the blue line denotes the same cell with a 60% dropout rate. Note that for the gene signature, the first 99 genes are fixed. The x axis reflects the position of the last signature gene. When the gene is at rank &lt;4000. The two cells give identical scores. However, after entering dropout zone, the scores start to deviate.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig3">Figure 3</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-71994-fig3-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Down sampling levels affect signature scoring.</title><p>Percentage of up and down regulated gene signatures in original cells relative to down sampled cells for four levels of down sampling (20, 40, 60, and 80%) based on Cohen’s d. Dot size corresponds to the percentage of all signatures tested (<italic>n</italic> = 7503) (<bold>A</bold>) in astrocytoma, (<bold>B</bold>) melanoma, (<bold>C</bold>) colorectal cancer, and (<bold>D</bold>) in glioblastoma data.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>An example showing ssGSEA score changes.</title><p>(<bold>A</bold>) Comparing scores of a gene signature (‘ZNF597_TARGET_GENES’) between JASMINE and other tools in all tumor and normal cells using the head and neck data. (<bold>B</bold>) The same comparison but limited to cells with the number of expressed genes between 4000 and 5000.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71994-fig3-figsupp2-v2.tif"/></fig></fig-group><p>To understand how dropouts may affect ssGSEA scoring, we simulated a dummy expression profile of a cell with 10,000 genes. We then set different dropout rates to the cell ranging from no dropout to 80% dropout. Genes were ranked from high to low expression to mimic ssGSEA calculation and the gene rankings were identical at each dropout rate. We then assembled a gene signature of 100 genes. The first 99 genes were drawn from the top 1000 genes, and the last gene was added to the signature from the 1001st gene onward to the bottom of the list. This way, the signature consists of 99 highly expressed genes and a floating gene. As the floating gene moves toward the dropout zone, we can observe how the signature score changes, especially around the dropout zone. The codes to reproduce these data can be found at our Github repository (Methods). <xref ref-type="fig" rid="fig3">Figure 3B</xref> shows the result at the 60% dropout rate. Before entering the dropout zone, the signature score was identical between the no-dropout cell and the 60%-dropout cell. However, when the floating gene was between ranks 4000 and 7000, the signature was scored higher in the dropout cell; when moving further toward ranks 7000–10,000, the signature was scored lower in the dropout cell. Thus, the scores teetered around the tie rank of dropout genes, that is, 7000. This simple experiment demonstrates that though tedious, dropouts are sufficient to change ssGSEA scores in unintended ways.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we benchmarked five signature-scoring methods, including two that were developed for bulk sample RNAseq analysis (ssGSEA and GSVA), and three that were developed for scRNA-seq analysis (AUCell, SCSE, and JASMINE). Because ssGSEA and GSVA generate highly correlated scores and GSVA is slower, we focused on ssGSEA and the other three methods. Unlike methods that test for signature enrichment between sample groups, these signature-scoring methods quantify expression activity of a gene set in a sample independent of other samples. Outputs from these methods can be conveniently tested for association with complex sample characteristics. We show that single-cell-based methods are more robust at identifying <italic>bona fide</italic> up- and down regulated gene signatures from scRNAseq data. In contrast, bulk-sample-based ssGSEA and GSVA are more susceptible to dropouts. These disparities stem from their distinct mechanism to score signatures. AUCell uses Area Under the Curve (AUC) to test the enrichment of a gene set among top expressed genes in a cell. SCSE measures a signature using normalized total expression of the signature genes. AUCell and SCSE intuitively counter dropout effects by using only expressed genes. JASMINE considers the enrichment of signature genes in expressed genes to counter dropout effects, and meanwhile, evaluates the average expression level of the expressed signature genes. Bulk-sample-based methods were not designed to deal with excessive dropouts, which may mislead analysis especially if cell biology underpins different dropout rates. We further show that among single-cell methods, JASMINE and SCSE showed better concordance, and JASMINE outperforms SCSE in down sampling tests.</p><p>Dropouts were initially thought to result from low amounts of input RNA and transcriptional stochasticity. However, more studies showed that dropouts are associated with cell states and identities (<xref ref-type="bibr" rid="bib9">Gulati et al., 2020</xref>; <xref ref-type="bibr" rid="bib23">Qiu, 2020</xref>). Thus, in cellular contexts where cells may have systematic differences in dropout rates, any tool that fails to account for dropouts may generate misleading even erroneous data. In conclusion, our results caution against using bulk-sample-based signature-scoring methods to score single cells. Our study also suggests that it is important to consider cellular contexts when benchmarking methods for scRNA-seq data analysis, particularly when bulk-sample-based methods are involved.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Single cell data sets and signature scoring</title><p>We used single cell data sets from 10 published studies (<xref ref-type="bibr" rid="bib3">Bi et al., 2021</xref>; <xref ref-type="bibr" rid="bib5">Chung et al., 2017</xref>; <xref ref-type="bibr" rid="bib7">Darmanis et al., 2017</xref>; <xref ref-type="bibr" rid="bib11">He et al., 2021</xref>; <xref ref-type="bibr" rid="bib14">Lee et al., 2020</xref>; <xref ref-type="bibr" rid="bib15">Ma et al., 2019</xref>; <xref ref-type="bibr" rid="bib18">Neftel et al., 2019</xref>; <xref ref-type="bibr" rid="bib22">Puram et al., 2017</xref>; <xref ref-type="bibr" rid="bib25">Tirosh et al., 2016</xref>; <xref ref-type="bibr" rid="bib26">Venteicher et al., 2017</xref>) for the evaluation of number of expressed genes in tumor versus normal cells to identify significant heterogenous patterns among the two phenotypes. Annotations of cell identity were also downloaded from each publication. We filtered all the data sets by removing non-expressed genes and then applied regularized negative binomial regression implemented in Seurat for normalization. We used C2 (<italic>n</italic> = 6226), C3 (<italic>n</italic> = 3556) and Hallmarks (<italic>n</italic> = 50) modules from MSigDB (<xref ref-type="bibr" rid="bib24">Subramanian et al., 2005</xref>) v.7.2, to calculate the ratio of signature genes across all data sets and further signature scoring. We tested five tools for signature score calculations, including SCSE (<xref ref-type="bibr" rid="bib21">Pont et al., 2019</xref>), AUCell (<xref ref-type="bibr" rid="bib1">Aibar et al., 2017</xref>), ssGSEA, GSVA (<xref ref-type="bibr" rid="bib10">Hänzelmann et al., 2013</xref>), and JASMINE. GSVA was included in tumor-normal comparisons but was dropped in gold standard tests and down sampling experiments due to slow running speed and highly correlated outputs with ssGSEA. We used GSVA and ssGSEA methods implemented in the GSVA Bioconductor (<xref ref-type="bibr" rid="bib10">Hänzelmann et al., 2013</xref>) and AUCell method from AUCell Bioconductor packages (<xref ref-type="bibr" rid="bib1">Aibar et al., 2017</xref>) with default parameters. We implemented SCSE in the R environment (v4.0) according to the equation reported in their paper (<xref ref-type="bibr" rid="bib21">Pont et al., 2019</xref>). The output scores were used as is in tumor/normal cell comparisons and simulation analyses.</p></sec><sec id="s4-2"><title><bold>J</bold>ointly Assessing Signature Mean and Inferring Enrichment</title><p>For each signature, JASMINE calculates the approximate mean using gene ranks among expressed genes and the enrichment of the signature in expressed genes. The two are then scaled to 0–1 and averaged to result in the final JASMINE score.</p><p>Assume <italic>R<sub>g</sub></italic> represents the rank of an expressed signature gene <italic>g</italic> among genes with expression value &gt;0 in a cell, then a mean rank vector <italic>V<sub>mean</sub></italic> is calculated as follows:<disp-formula id="equ1"><mml:math id="m1"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>Where <italic>m</italic> represents the total number of expressed signature genes and <italic>N</italic> represents the total number of expressed genes in the cell. Because the mean is based on ranks, it is robust to scale normalization methods. It assesses the expression level of the signature only using genes detected in one cell, thus minimizing the effect of dropouts.</p><p>To assess signature enrichment in the expressed genes, we calculate either the Odds Ratio (OR) using four variables: a = signature genes expressed, b = signature genes not expressed, c = non-signature genes expressed, and d = non-signature genes not expressed. The signature enrichment using OR is calculated as follows:<disp-formula id="equ2"><mml:math id="m2"><mml:mi>O</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mi>*</mml:mi><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mi>*</mml:mi><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>In practice, <italic>c</italic> is unlikely zero. For smaller signatures, b can be occasionally 0. In that case, we replace it with 1. In our testing, we observed that 99% of the gene sets did not encounter this issue in any of the cells we analyzed. Despite this rare incidence, we provide Likelihood Ratio (LR) as an alternative to OR in the JASMINE function. LR is calculated as follows:<disp-formula id="equ3"><mml:math id="m3"><mml:mi>L</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>*</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mi>*</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo></mml:math></disp-formula></p><p><italic>OR</italic> and <italic>LR</italic> generate highly similar results according to our tests. <italic>OR</italic> (or <italic>LR</italic>) assesses the distribution of signature genes against the dropout background. Finally, <italic>V<sub>mean</sub></italic> and <italic>OR</italic> are linearly scaled to [0–1] and are averaged to generate JASMINE scores.</p></sec><sec id="s4-3"><title>Effect size for gene sets scores</title><p>We first filtered the 9835 gene sets to 7503 by requiring a minimum size of 20 genes. We scored these gene sets (C2, C3, and hallmarks) among tumor and normal phenotypes using Cohen’s d (<xref ref-type="bibr" rid="bib6">Cohen, 1988</xref>). We utilized an R package ‘effectsize’ (<xref ref-type="bibr" rid="bib2">Ben-Shachar et al., 2020</xref>) to calculate this metric. We used Cohen’s d ≥ one as a threshold for positive or up cases and d ≤ –1 as negative or down cases with respect to tumor versus normal cells.</p></sec><sec id="s4-4"><title>Gene signature simulation</title><p>We first identified differentially expressed genes for each dataset using MAST (<xref ref-type="bibr" rid="bib8">Finak et al., 2015</xref>), a method that explicitly accounts for dropout rates. We then randomly drew <italic>N</italic> genes from upregulated genes to generate an up gene set of size <italic>N</italic>, and similarly for down gene sets. Because in practice up and down regulated gene sets contain genes that have no expression change, or even changes at opposite directions, we added noises to the simulated gene sets. For instance, when setting noise level to 20%, an up gene set of size <italic>N</italic> would have 20% of its genes drawn from the remainders other than the upregulated genes. Following this procedure, we generated gene sets at the sizes of 50, 100, 150, 200, and 300 genes. For each size, we set the noise levels to 0, 20, 40, 60, and 80%. For each noise-size combination, we randomly generated 200 gene sets. In total, 5000 gene sets were generated per data set for each direction.</p></sec><sec id="s4-5"><title>Down sampling</title><p>We subset 100 tumor cells per data set for down sampling. The R package ‘scuttle’ (<xref ref-type="bibr" rid="bib17">McCarthy et al., 2017</xref>) was used to down sample each cell to 50% total coverage. The down sampled data sets were then scaled back to ensure equal total coverage before comparison. Down sampling was also performed at various levels (20, 40, 60, and 80%) to examine its impact upon scoring of different methods especially ssGSEA.</p></sec><sec id="s4-6"><title>Dropouts impact on ssGSEA</title><p>We generated a toy example to demonstrate the impact of dropouts on ssGSEA scores. We used a signature comprised of n + 1 genes. We randomly selected 99 genes from top 1000 genes of the dummy expression matrix. These 99 genes are fixed. Then starting from 1001 onward, we added one gene to the signature each time, starting from 1001st gene index throughout the remaining list. This allowed us to investigate how signature score changes as the additional gene gradually moves from high expression to dropouts. We simulated the scenario with 0% (original scores), and 60% dropout rates. This simulation clearly reflects how the dropout rates significantly affect the scoring by ssGSEA.</p></sec><sec id="s4-7"><title>Data availability</title><p>Single cell data sets used in this study including their downloading sources were listed in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>. Gene sets were downloaded from MSigDB v.7.2 (<ext-link ext-link-type="uri" xlink:href="http://www.gsea-msigdb.org/gsea/msigdb/index.jsp">http://www.gsea-msigdb.org/gsea/msigdb/index.jsp</ext-link>) for C2, C3 and Hallmark modules. JASMINE and ssGSEA testing codes are available on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/NNoureen/JASMINE">https://github.com/NNoureen/JASMINE</ext-link>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:f5b092ae4a9b8e9a7314131251bc01391abd8e1f;origin=https://github.com/NNoureen/JASMINE;visit=swh:1:snp:68b3eef22d209a4b966ce1c768b5eded68dae4ff;anchor=swh:1:rev:ba00996ad165ff471c6fada83e6cf76af50acdfa">swh:1:rev:ba00996ad165ff471c6fada83e6cf76af50acdfa</ext-link>; <xref ref-type="bibr" rid="bib20">Noureen, 2021b</xref>).</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Formal analysis, Funding acquisition, Investigation, Methodology, Software, Visualization, Writing - original draft</p></fn><fn fn-type="con" id="con2"><p>Investigation, Visualization</p></fn><fn fn-type="con" id="con3"><p>Investigation, Resources</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Data curation, Formal analysis, Investigation, Methodology, Software, Writing - original draft</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Data curation, Formal analysis, Funding acquisition, Investigation, Methodology, Project administration, Resources, Software, Supervision, Visualization, Writing - original draft</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Single cell RNAseq datasets.</title><p>The table lists all the ten datasets used in this study. Cell annotations were downloaded from the original publications.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-71994-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-71994-transrepform1-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. Single cell data sets used in this study including their downloading sources were listed in Supplementary file 1. Gene sets were downloaded from MSigDB v.7.2. JASMINE source code is available on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/NNoureen/JASMINE">https://github.com/NNoureen/JASMINE</ext-link>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:f5b092ae4a9b8e9a7314131251bc01391abd8e1f;origin=https://github.com/NNoureen/JASMINE;visit=swh:1:snp:68b3eef22d209a4b966ce1c768b5eded68dae4ff;anchor=swh:1:rev:ba00996ad165ff471c6fada83e6cf76af50acdfa">swh:1:rev:ba00996ad165ff471c6fada83e6cf76af50acdfa</ext-link>). Source Data contain the numerical data used to generate the figures.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Noureen</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Signature-scoring methods developed for bulk samples are not adequate for cancer single-cell RNA sequencing data</data-title><source>GitHub</source><pub-id pub-id-type="accession" xlink:href="https://github.com/NNoureen/JASMINE">GitHub</pub-id></element-citation></p><p>The following previously published datasets were used:</p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Izar</surname><given-names>B</given-names></name><name><surname>Prakadan</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Single-cell expression of metastatic melanoma</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE72056">GSE72056</pub-id></element-citation></p><p><element-citation id="dataset3" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Puram</surname><given-names>SV</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Parikh</surname><given-names>AS</given-names></name><name><surname>Patel</surname><given-names>AP</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Single-cell expression of head and neck cancer</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE103322">GSE103322</pub-id></element-citation></p><p><element-citation id="dataset4" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Bi</surname><given-names>K</given-names></name><name><surname>Mx</surname><given-names>He</given-names></name><name><surname>Bakouny</surname><given-names>Z</given-names></name><name><surname>Kanodia</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Single-cell expression of advanced renal cell carcinoma</data-title><source>Broad Single Cell portal</source><pub-id pub-id-type="accession" xlink:href="https://singlecell.broadinstitute.org/single_cell/study/SCP1288/tumor-and-immune-reprogramming-during-immunotherapy-in-advanced-renal-cell-carcinoma">SCP1288</pub-id></element-citation></p><p><element-citation id="dataset5" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>HO</given-names></name><name><surname>Hong</surname><given-names>Y</given-names></name><name><surname>Etlioglu</surname><given-names>HE</given-names></name><name><surname>Cho</surname><given-names>YB</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Single-cell expression of colorectal cancer</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE144735">GSE144735</pub-id></element-citation></p><p><element-citation id="dataset6" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>L</given-names></name><name><surname>Hernandez</surname><given-names>MO</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Mehta</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Single-cell expression of liver cancer</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE125449">GSE125449</pub-id></element-citation></p><p><element-citation id="dataset7" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Neftel</surname><given-names>C</given-names></name><name><surname>Laffy</surname><given-names>J</given-names></name><name><surname>Filbin</surname><given-names>MG</given-names></name><name><surname>Hara</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Single-cell expression of IDH wildtype glioblastoma</data-title><source>Broad Single Cell portal</source><pub-id pub-id-type="accession" xlink:href="https://singlecell.broadinstitute.org/single_cell/study/SCP393/single-cell-rna-seq-of-adult-and-pediatric-glioblastoma">SCP393</pub-id></element-citation></p><p><element-citation id="dataset8" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Venteicher</surname><given-names>AS</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Hebert</surname><given-names>C</given-names></name><name><surname>Yizhak</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Single-cell expression of IDH mutant astrocytoma</data-title><source>Broad Single Cell portal</source><pub-id pub-id-type="accession" xlink:href="https://singlecell.broadinstitute.org/single_cell/study/SCP50/single-cell-rna-seq-analysis-of-astrocytoma">SCP50</pub-id></element-citation></p><p><element-citation id="dataset9" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Darmanis</surname><given-names>S</given-names></name><name><surname>Sloan</surname><given-names>SA</given-names></name><name><surname>Croote</surname><given-names>D</given-names></name><name><surname>Mignardi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Single-cell expression of glioblastoma</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE84465">GSE84465</pub-id></element-citation></p><p><element-citation id="dataset10" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>W</given-names></name><name><surname>Eum</surname><given-names>HH</given-names></name><name><surname>Lee</surname><given-names>HO</given-names></name><name><surname>Lee</surname><given-names>KM</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Single-cell expression of breast cancer</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE75688">GSE75688</pub-id></element-citation></p><p><element-citation id="dataset11" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Mx</surname><given-names>He</given-names></name><name><surname>Cuoco</surname><given-names>MS</given-names></name><name><surname>Crowdis</surname><given-names>J</given-names></name><name><surname>Bosma-Moody</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Bi</surname><given-names>K</given-names></name><name><surname>Kanodia</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Single-cell expression of prostate cancer</data-title><source>Broad Single Cell portal</source><pub-id pub-id-type="accession" xlink:href="https://singlecell.broadinstitute.org/single_cell/study/SCP1244/transcriptional-mediators-of-treatment-resistance-in-lethal-prostate-cancer">SCP1244</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This work was supported by CPRIT (RR170055 to ZS). NN was supported by a CPRIT postdoctoral fellowship award (RP170345).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aibar</surname><given-names>S</given-names></name><name><surname>González-Blas</surname><given-names>CB</given-names></name><name><surname>Moerman</surname><given-names>T</given-names></name><name><surname>Huynh-Thu</surname><given-names>VA</given-names></name><name><surname>Imrichova</surname><given-names>H</given-names></name><name><surname>Hulselmans</surname><given-names>G</given-names></name><name><surname>Rambow</surname><given-names>F</given-names></name><name><surname>Marine</surname><given-names>J-C</given-names></name><name><surname>Geurts</surname><given-names>P</given-names></name><name><surname>Aerts</surname><given-names>J</given-names></name><name><surname>van den Oord</surname><given-names>J</given-names></name><name><surname>Atak</surname><given-names>ZK</given-names></name><name><surname>Wouters</surname><given-names>J</given-names></name><name><surname>Aerts</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>SCENIC: single-cell regulatory network inference and clustering</article-title><source>Nature Methods</source><volume>14</volume><fpage>1083</fpage><lpage>1086</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4463</pub-id><pub-id pub-id-type="pmid">28991892</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben-Shachar</surname><given-names>M</given-names></name><name><surname>Lüdecke</surname><given-names>D</given-names></name><name><surname>Makowski</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>effectsize: Estimation of Effect Size Indices and Standardized Parameters</article-title><source>Journal of Open Source Software</source><volume>5</volume><elocation-id>2815</elocation-id><pub-id pub-id-type="doi">10.21105/joss.02815</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bi</surname><given-names>K</given-names></name><name><surname>He</surname><given-names>MX</given-names></name><name><surname>Bakouny</surname><given-names>Z</given-names></name><name><surname>Kanodia</surname><given-names>A</given-names></name><name><surname>Napolitano</surname><given-names>S</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Grimaldi</surname><given-names>G</given-names></name><name><surname>Braun</surname><given-names>DA</given-names></name><name><surname>Cuoco</surname><given-names>MS</given-names></name><name><surname>Mayorga</surname><given-names>A</given-names></name><name><surname>DelloStritto</surname><given-names>L</given-names></name><name><surname>Bouchard</surname><given-names>G</given-names></name><name><surname>Steinharter</surname><given-names>J</given-names></name><name><surname>Tewari</surname><given-names>AK</given-names></name><name><surname>Vokes</surname><given-names>NI</given-names></name><name><surname>Shannon</surname><given-names>E</given-names></name><name><surname>Sun</surname><given-names>M</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Chang</surname><given-names>SL</given-names></name><name><surname>McGregor</surname><given-names>BA</given-names></name><name><surname>Haq</surname><given-names>R</given-names></name><name><surname>Denize</surname><given-names>T</given-names></name><name><surname>Signoretti</surname><given-names>S</given-names></name><name><surname>Guerriero</surname><given-names>JL</given-names></name><name><surname>Vigneau</surname><given-names>S</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Rotem</surname><given-names>A</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Choueiri</surname><given-names>TK</given-names></name><name><surname>Van Allen</surname><given-names>EM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Tumor and immune reprogramming during immunotherapy in advanced renal cell carcinoma</article-title><source>Cancer Cell</source><volume>39</volume><fpage>649</fpage><lpage>661</lpage><pub-id pub-id-type="doi">10.1016/j.ccell.2021.02.015</pub-id><pub-id pub-id-type="pmid">33711272</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title><source>Nature Biotechnology</source><volume>36</volume><fpage>411</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id><pub-id pub-id-type="pmid">29608179</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>W</given-names></name><name><surname>Eum</surname><given-names>HH</given-names></name><name><surname>Lee</surname><given-names>HO</given-names></name><name><surname>Lee</surname><given-names>KM</given-names></name><name><surname>Lee</surname><given-names>HB</given-names></name><name><surname>Kim</surname><given-names>KT</given-names></name><name><surname>Ryu</surname><given-names>HS</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>JE</given-names></name><name><surname>Park</surname><given-names>YH</given-names></name><name><surname>Kan</surname><given-names>Z</given-names></name><name><surname>Han</surname><given-names>W</given-names></name><name><surname>Park</surname><given-names>WY</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Single-cell RNA-seq enables comprehensive tumour and immune cell profiling in primary breast cancer</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>15081</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms15081</pub-id><pub-id pub-id-type="pmid">28474673</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1988">1988</year><source>Statistical Power Analysis for the Behavioral Sciences</source><publisher-name>Routledge</publisher-name></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darmanis</surname><given-names>S</given-names></name><name><surname>Sloan</surname><given-names>SA</given-names></name><name><surname>Croote</surname><given-names>D</given-names></name><name><surname>Mignardi</surname><given-names>M</given-names></name><name><surname>Chernikova</surname><given-names>S</given-names></name><name><surname>Samghababi</surname><given-names>P</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Neff</surname><given-names>N</given-names></name><name><surname>Kowarsky</surname><given-names>M</given-names></name><name><surname>Caneda</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Chang</surname><given-names>SD</given-names></name><name><surname>Connolly</surname><given-names>ID</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Barres</surname><given-names>BA</given-names></name><name><surname>Gephart</surname><given-names>MH</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Single-Cell RNA-Seq Analysis of Infiltrating Neoplastic Cells at the Migrating Front of Human Glioblastoma</article-title><source>Cell Reports</source><volume>21</volume><fpage>1399</fpage><lpage>1410</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2017.10.030</pub-id><pub-id pub-id-type="pmid">29091775</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finak</surname><given-names>G</given-names></name><name><surname>McDavid</surname><given-names>A</given-names></name><name><surname>Yajima</surname><given-names>M</given-names></name><name><surname>Deng</surname><given-names>J</given-names></name><name><surname>Gersuk</surname><given-names>V</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><name><surname>Slichter</surname><given-names>CK</given-names></name><name><surname>Miller</surname><given-names>HW</given-names></name><name><surname>McElrath</surname><given-names>MJ</given-names></name><name><surname>Prlic</surname><given-names>M</given-names></name><name><surname>Linsley</surname><given-names>PS</given-names></name><name><surname>Gottardo</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title><source>Genome Biology</source><volume>16</volume><elocation-id>278</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id><pub-id pub-id-type="pmid">26653891</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gulati</surname><given-names>GS</given-names></name><name><surname>Sikandar</surname><given-names>SS</given-names></name><name><surname>Wesche</surname><given-names>DJ</given-names></name><name><surname>Manjunath</surname><given-names>A</given-names></name><name><surname>Bharadwaj</surname><given-names>A</given-names></name><name><surname>Berger</surname><given-names>MJ</given-names></name><name><surname>Ilagan</surname><given-names>F</given-names></name><name><surname>Kuo</surname><given-names>AH</given-names></name><name><surname>Hsieh</surname><given-names>RW</given-names></name><name><surname>Cai</surname><given-names>S</given-names></name><name><surname>Zabala</surname><given-names>M</given-names></name><name><surname>Scheeren</surname><given-names>FA</given-names></name><name><surname>Lobo</surname><given-names>NA</given-names></name><name><surname>Qian</surname><given-names>D</given-names></name><name><surname>Yu</surname><given-names>FB</given-names></name><name><surname>Dirbas</surname><given-names>FM</given-names></name><name><surname>Clarke</surname><given-names>MF</given-names></name><name><surname>Newman</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Single-cell transcriptional diversity is a hallmark of developmental potential</article-title><source>Science (New York, N.Y.)</source><volume>367</volume><fpage>405</fpage><lpage>411</lpage><pub-id pub-id-type="doi">10.1126/science.aax0249</pub-id><pub-id pub-id-type="pmid">31974247</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hänzelmann</surname><given-names>S</given-names></name><name><surname>Castelo</surname><given-names>R</given-names></name><name><surname>Guinney</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>GSVA: gene set variation analysis for microarray and RNA-seq data</article-title><source>BMC Bioinformatics</source><volume>14</volume><elocation-id>7</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-14-7</pub-id><pub-id pub-id-type="pmid">23323831</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>MX</given-names></name><name><surname>Cuoco</surname><given-names>MS</given-names></name><name><surname>Crowdis</surname><given-names>J</given-names></name><name><surname>Bosma-Moody</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Bi</surname><given-names>K</given-names></name><name><surname>Kanodia</surname><given-names>A</given-names></name><name><surname>Su</surname><given-names>MJ</given-names></name><name><surname>Ku</surname><given-names>SY</given-names></name><name><surname>Garcia</surname><given-names>MM</given-names></name><name><surname>Sweet</surname><given-names>AR</given-names></name><name><surname>Rodman</surname><given-names>C</given-names></name><name><surname>DelloStritto</surname><given-names>L</given-names></name><name><surname>Silver</surname><given-names>R</given-names></name><name><surname>Steinharter</surname><given-names>J</given-names></name><name><surname>Shah</surname><given-names>P</given-names></name><name><surname>Izar</surname><given-names>B</given-names></name><name><surname>Walk</surname><given-names>NC</given-names></name><name><surname>Burke</surname><given-names>KP</given-names></name><name><surname>Bakouny</surname><given-names>Z</given-names></name><name><surname>Tewari</surname><given-names>AK</given-names></name><name><surname>Liu</surname><given-names>D</given-names></name><name><surname>Camp</surname><given-names>SY</given-names></name><name><surname>Vokes</surname><given-names>NI</given-names></name><name><surname>Salari</surname><given-names>K</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Vigneau</surname><given-names>S</given-names></name><name><surname>Fong</surname><given-names>L</given-names></name><name><surname>Russo</surname><given-names>JW</given-names></name><name><surname>Yuan</surname><given-names>X</given-names></name><name><surname>Balk</surname><given-names>SP</given-names></name><name><surname>Beltran</surname><given-names>H</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Rotem</surname><given-names>A</given-names></name><name><surname>Taplin</surname><given-names>ME</given-names></name><name><surname>Van Allen</surname><given-names>EM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Transcriptional mediators of treatment resistance in lethal prostate cancer</article-title><source>Nature Medicine</source><volume>27</volume><fpage>426</fpage><lpage>433</lpage><pub-id pub-id-type="doi">10.1038/s41591-021-01244-6</pub-id><pub-id pub-id-type="pmid">33664492</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hicks</surname><given-names>SC</given-names></name><name><surname>Townes</surname><given-names>FW</given-names></name><name><surname>Teng</surname><given-names>M</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Missing data and technical variability in single-cell RNA-sequencing experiments</article-title><source>Biostatistics (Oxford, England)</source><volume>19</volume><fpage>562</fpage><lpage>578</lpage><pub-id pub-id-type="doi">10.1093/biostatistics/kxx053</pub-id><pub-id pub-id-type="pmid">29121214</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holland</surname><given-names>CH</given-names></name><name><surname>Tanevski</surname><given-names>J</given-names></name><name><surname>Perales-Patón</surname><given-names>J</given-names></name><name><surname>Gleixner</surname><given-names>J</given-names></name><name><surname>Kumar</surname><given-names>MP</given-names></name><name><surname>Mereu</surname><given-names>E</given-names></name><name><surname>Joughin</surname><given-names>BA</given-names></name><name><surname>Stegle</surname><given-names>O</given-names></name><name><surname>Lauffenburger</surname><given-names>DA</given-names></name><name><surname>Heyn</surname><given-names>H</given-names></name><name><surname>Szalai</surname><given-names>B</given-names></name><name><surname>Saez-Rodriguez</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Robustness and applicability of transcription factor and pathway analysis tools on single-cell RNA-seq data</article-title><source>Genome Biology</source><volume>21</volume><elocation-id>36</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-020-1949-z</pub-id><pub-id pub-id-type="pmid">32051003</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>H-O</given-names></name><name><surname>Hong</surname><given-names>Y</given-names></name><name><surname>Etlioglu</surname><given-names>HE</given-names></name><name><surname>Cho</surname><given-names>YB</given-names></name><name><surname>Pomella</surname><given-names>V</given-names></name><name><surname>Van den Bosch</surname><given-names>B</given-names></name><name><surname>Vanhecke</surname><given-names>J</given-names></name><name><surname>Verbandt</surname><given-names>S</given-names></name><name><surname>Hong</surname><given-names>H</given-names></name><name><surname>Min</surname><given-names>J-W</given-names></name><name><surname>Kim</surname><given-names>N</given-names></name><name><surname>Eum</surname><given-names>HH</given-names></name><name><surname>Qian</surname><given-names>J</given-names></name><name><surname>Boeckx</surname><given-names>B</given-names></name><name><surname>Lambrechts</surname><given-names>D</given-names></name><name><surname>Tsantoulis</surname><given-names>P</given-names></name><name><surname>De Hertogh</surname><given-names>G</given-names></name><name><surname>Chung</surname><given-names>W</given-names></name><name><surname>Lee</surname><given-names>T</given-names></name><name><surname>An</surname><given-names>M</given-names></name><name><surname>Shin</surname><given-names>H-T</given-names></name><name><surname>Joung</surname><given-names>J-G</given-names></name><name><surname>Jung</surname><given-names>M-H</given-names></name><name><surname>Ko</surname><given-names>G</given-names></name><name><surname>Wirapati</surname><given-names>P</given-names></name><name><surname>Kim</surname><given-names>SH</given-names></name><name><surname>Kim</surname><given-names>HC</given-names></name><name><surname>Yun</surname><given-names>SH</given-names></name><name><surname>Tan</surname><given-names>IBH</given-names></name><name><surname>Ranjan</surname><given-names>B</given-names></name><name><surname>Lee</surname><given-names>WY</given-names></name><name><surname>Kim</surname><given-names>T-Y</given-names></name><name><surname>Choi</surname><given-names>JK</given-names></name><name><surname>Kim</surname><given-names>Y-J</given-names></name><name><surname>Prabhakar</surname><given-names>S</given-names></name><name><surname>Tejpar</surname><given-names>S</given-names></name><name><surname>Park</surname><given-names>W-Y</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Lineage-dependent gene expression programs influence the immune landscape of colorectal cancer</article-title><source>Nature Genetics</source><volume>52</volume><fpage>594</fpage><lpage>603</lpage><pub-id pub-id-type="doi">10.1038/s41588-020-0636-z</pub-id><pub-id pub-id-type="pmid">32451460</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>L</given-names></name><name><surname>Hernandez</surname><given-names>MO</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Mehta</surname><given-names>M</given-names></name><name><surname>Tran</surname><given-names>B</given-names></name><name><surname>Kelly</surname><given-names>M</given-names></name><name><surname>Rae</surname><given-names>Z</given-names></name><name><surname>Hernandez</surname><given-names>JM</given-names></name><name><surname>Davis</surname><given-names>JL</given-names></name><name><surname>Martin</surname><given-names>SP</given-names></name><name><surname>Kleiner</surname><given-names>DE</given-names></name><name><surname>Hewitt</surname><given-names>SM</given-names></name><name><surname>Ylaya</surname><given-names>K</given-names></name><name><surname>Wood</surname><given-names>BJ</given-names></name><name><surname>Greten</surname><given-names>TF</given-names></name><name><surname>Wang</surname><given-names>XW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Tumor Cell Biodiversity Drives Microenvironmental Reprogramming in Liver Cancer</article-title><source>Cancer Cell</source><volume>36</volume><fpage>418</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1016/j.ccell.2019.08.007</pub-id><pub-id pub-id-type="pmid">31588021</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malta</surname><given-names>TM</given-names></name><name><surname>Sokolov</surname><given-names>A</given-names></name><name><surname>Gentles</surname><given-names>AJ</given-names></name><name><surname>Burzykowski</surname><given-names>T</given-names></name><name><surname>Poisson</surname><given-names>L</given-names></name><name><surname>Weinstein</surname><given-names>JN</given-names></name><name><surname>Kamińska</surname><given-names>B</given-names></name><name><surname>Huelsken</surname><given-names>J</given-names></name><name><surname>Omberg</surname><given-names>L</given-names></name><name><surname>Gevaert</surname><given-names>O</given-names></name><name><surname>Colaprico</surname><given-names>A</given-names></name><name><surname>Czerwińska</surname><given-names>P</given-names></name><name><surname>Mazurek</surname><given-names>S</given-names></name><name><surname>Mishra</surname><given-names>L</given-names></name><name><surname>Heyn</surname><given-names>H</given-names></name><name><surname>Krasnitz</surname><given-names>A</given-names></name><name><surname>Godwin</surname><given-names>AK</given-names></name><name><surname>Lazar</surname><given-names>AJ</given-names></name><collab>Cancer Genome Atlas Research Network</collab><name><surname>Stuart</surname><given-names>JM</given-names></name><name><surname>Hoadley</surname><given-names>KA</given-names></name><name><surname>Laird</surname><given-names>PW</given-names></name><name><surname>Noushmehr</surname><given-names>H</given-names></name><name><surname>Wiznerowicz</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Machine Learning Identifies Stemness Features Associated with Oncogenic Dedifferentiation</article-title><source>Cell</source><volume>173</volume><fpage>338</fpage><lpage>354</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.03.034</pub-id><pub-id pub-id-type="pmid">29625051</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Campbell</surname><given-names>KR</given-names></name><name><surname>Lun</surname><given-names>ATL</given-names></name><name><surname>Wills</surname><given-names>QF</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title><source>Bioinformatics (Oxford, England)</source><volume>33</volume><fpage>1179</fpage><lpage>1186</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw777</pub-id><pub-id pub-id-type="pmid">28088763</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neftel</surname><given-names>C</given-names></name><name><surname>Laffy</surname><given-names>J</given-names></name><name><surname>Filbin</surname><given-names>MG</given-names></name><name><surname>Hara</surname><given-names>T</given-names></name><name><surname>Shore</surname><given-names>ME</given-names></name><name><surname>Rahme</surname><given-names>GJ</given-names></name><name><surname>Richman</surname><given-names>AR</given-names></name><name><surname>Silverbush</surname><given-names>D</given-names></name><name><surname>Shaw</surname><given-names>ML</given-names></name><name><surname>Hebert</surname><given-names>CM</given-names></name><name><surname>Dewitt</surname><given-names>J</given-names></name><name><surname>Gritsch</surname><given-names>S</given-names></name><name><surname>Perez</surname><given-names>EM</given-names></name><name><surname>Gonzalez Castro</surname><given-names>LN</given-names></name><name><surname>Lan</surname><given-names>X</given-names></name><name><surname>Druck</surname><given-names>N</given-names></name><name><surname>Rodman</surname><given-names>C</given-names></name><name><surname>Dionne</surname><given-names>D</given-names></name><name><surname>Kaplan</surname><given-names>A</given-names></name><name><surname>Bertalan</surname><given-names>MS</given-names></name><name><surname>Small</surname><given-names>J</given-names></name><name><surname>Pelton</surname><given-names>K</given-names></name><name><surname>Becker</surname><given-names>S</given-names></name><name><surname>Bonal</surname><given-names>D</given-names></name><name><surname>Nguyen</surname><given-names>QD</given-names></name><name><surname>Servis</surname><given-names>RL</given-names></name><name><surname>Fung</surname><given-names>JM</given-names></name><name><surname>Mylvaganam</surname><given-names>R</given-names></name><name><surname>Mayr</surname><given-names>L</given-names></name><name><surname>Gojo</surname><given-names>J</given-names></name><name><surname>Haberler</surname><given-names>C</given-names></name><name><surname>Geyeregger</surname><given-names>R</given-names></name><name><surname>Czech</surname><given-names>T</given-names></name><name><surname>Slavc</surname><given-names>I</given-names></name><name><surname>Nahed</surname><given-names>BV</given-names></name><name><surname>Curry</surname><given-names>WT</given-names></name><name><surname>Carter</surname><given-names>BS</given-names></name><name><surname>Wakimoto</surname><given-names>H</given-names></name><name><surname>Brastianos</surname><given-names>PK</given-names></name><name><surname>Batchelor</surname><given-names>TT</given-names></name><name><surname>Stemmer-Rachamimov</surname><given-names>A</given-names></name><name><surname>Martinez-Lage</surname><given-names>M</given-names></name><name><surname>Frosch</surname><given-names>MP</given-names></name><name><surname>Stamenkovic</surname><given-names>I</given-names></name><name><surname>Riggi</surname><given-names>N</given-names></name><name><surname>Rheinbay</surname><given-names>E</given-names></name><name><surname>Monje</surname><given-names>M</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Cahill</surname><given-names>DP</given-names></name><name><surname>Patel</surname><given-names>AP</given-names></name><name><surname>Hunter</surname><given-names>T</given-names></name><name><surname>Verma</surname><given-names>IM</given-names></name><name><surname>Ligon</surname><given-names>KL</given-names></name><name><surname>Louis</surname><given-names>DN</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Bernstein</surname><given-names>BE</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Suvà</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>An Integrative Model of Cellular States, Plasticity, and Genetics for Glioblastoma</article-title><source>Cell</source><volume>178</volume><fpage>835</fpage><lpage>849</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.06.024</pub-id><pub-id pub-id-type="pmid">31327527</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noureen</surname><given-names>N</given-names></name><name><surname>Wu</surname><given-names>S</given-names></name><name><surname>Lv</surname><given-names>Y</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Alfred Yung</surname><given-names>WK</given-names></name><name><surname>Gelfond</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Koul</surname><given-names>D</given-names></name><name><surname>Ludlow</surname><given-names>A</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021a</year><article-title>Integrated analysis of telomerase enzymatic activity unravels an association with cancer stemness and proliferation</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>139</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-20474-9</pub-id><pub-id pub-id-type="pmid">33420056</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Noureen</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021b</year><data-title>JASMINE</data-title><version designator="swh:1:rev:ba00996ad165ff471c6fada83e6cf76af50acdfa">swh:1:rev:ba00996ad165ff471c6fada83e6cf76af50acdfa</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:f5b092ae4a9b8e9a7314131251bc01391abd8e1f;origin=https://github.com/NNoureen/JASMINE;visit=swh:1:snp:68b3eef22d209a4b966ce1c768b5eded68dae4ff;anchor=swh:1:rev:ba00996ad165ff471c6fada83e6cf76af50acdfa">https://archive.softwareheritage.org/swh:1:dir:f5b092ae4a9b8e9a7314131251bc01391abd8e1f;origin=https://github.com/NNoureen/JASMINE;visit=swh:1:snp:68b3eef22d209a4b966ce1c768b5eded68dae4ff;anchor=swh:1:rev:ba00996ad165ff471c6fada83e6cf76af50acdfa</ext-link></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pont</surname><given-names>F</given-names></name><name><surname>Tosolini</surname><given-names>M</given-names></name><name><surname>Fournié</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Single-Cell Signature Explorer for comprehensive visualization of single cell signatures across scRNA-seq datasets</article-title><source>Nucleic Acids Research</source><volume>47</volume><elocation-id>e133</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gkz601</pub-id><pub-id pub-id-type="pmid">31294801</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Puram</surname><given-names>SV</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Parikh</surname><given-names>AS</given-names></name><name><surname>Patel</surname><given-names>AP</given-names></name><name><surname>Yizhak</surname><given-names>K</given-names></name><name><surname>Gillespie</surname><given-names>S</given-names></name><name><surname>Rodman</surname><given-names>C</given-names></name><name><surname>Luo</surname><given-names>CL</given-names></name><name><surname>Mroz</surname><given-names>EA</given-names></name><name><surname>Emerick</surname><given-names>KS</given-names></name><name><surname>Deschler</surname><given-names>DG</given-names></name><name><surname>Varvares</surname><given-names>MA</given-names></name><name><surname>Mylvaganam</surname><given-names>R</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Rocco</surname><given-names>JW</given-names></name><name><surname>Faquin</surname><given-names>WC</given-names></name><name><surname>Lin</surname><given-names>DT</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Bernstein</surname><given-names>BE</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Single-Cell Transcriptomic Analysis of Primary and Metastatic Tumor Ecosystems in Head and Neck Cancer</article-title><source>Cell</source><volume>171</volume><fpage>1611</fpage><lpage>1624</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.10.044</pub-id><pub-id pub-id-type="pmid">29198524</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Embracing the dropouts in single-cell RNA-seq analysis</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>1169</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-14976-9</pub-id><pub-id pub-id-type="pmid">32127540</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname><given-names>A</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mootha</surname><given-names>VK</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Ebert</surname><given-names>BL</given-names></name><name><surname>Gillette</surname><given-names>MA</given-names></name><name><surname>Paulovich</surname><given-names>A</given-names></name><name><surname>Pomeroy</surname><given-names>SL</given-names></name><name><surname>Golub</surname><given-names>TR</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles</article-title><source>PNAS</source><volume>102</volume><fpage>15545</fpage><lpage>15550</lpage><pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><pub-id pub-id-type="pmid">16199517</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Izar</surname><given-names>B</given-names></name><name><surname>Prakadan</surname><given-names>SM</given-names></name><name><surname>Wadsworth</surname><given-names>MH</given-names></name><name><surname>Treacy</surname><given-names>D</given-names></name><name><surname>Trombetta</surname><given-names>JJ</given-names></name><name><surname>Rotem</surname><given-names>A</given-names></name><name><surname>Rodman</surname><given-names>C</given-names></name><name><surname>Lian</surname><given-names>C</given-names></name><name><surname>Murphy</surname><given-names>G</given-names></name><name><surname>Fallahi-Sichani</surname><given-names>M</given-names></name><name><surname>Dutton-Regester</surname><given-names>K</given-names></name><name><surname>Lin</surname><given-names>JR</given-names></name><name><surname>Cohen</surname><given-names>O</given-names></name><name><surname>Shah</surname><given-names>P</given-names></name><name><surname>Lu</surname><given-names>D</given-names></name><name><surname>Genshaft</surname><given-names>AS</given-names></name><name><surname>Hughes</surname><given-names>TK</given-names></name><name><surname>Ziegler</surname><given-names>CGK</given-names></name><name><surname>Kazer</surname><given-names>SW</given-names></name><name><surname>Gaillard</surname><given-names>A</given-names></name><name><surname>Kolb</surname><given-names>KE</given-names></name><name><surname>Villani</surname><given-names>AC</given-names></name><name><surname>Johannessen</surname><given-names>CM</given-names></name><name><surname>Andreev</surname><given-names>AY</given-names></name><name><surname>Van Allen</surname><given-names>EM</given-names></name><name><surname>Bertagnolli</surname><given-names>M</given-names></name><name><surname>Sorger</surname><given-names>PK</given-names></name><name><surname>Sullivan</surname><given-names>RJ</given-names></name><name><surname>Flaherty</surname><given-names>KT</given-names></name><name><surname>Frederick</surname><given-names>DT</given-names></name><name><surname>Jané-Valbuena</surname><given-names>J</given-names></name><name><surname>Yoon</surname><given-names>CH</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Garraway</surname><given-names>LA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title><source>Science (New York, N.Y.)</source><volume>352</volume><fpage>189</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1126/science.aad0501</pub-id><pub-id pub-id-type="pmid">27124452</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venteicher</surname><given-names>AS</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Hebert</surname><given-names>C</given-names></name><name><surname>Yizhak</surname><given-names>K</given-names></name><name><surname>Neftel</surname><given-names>C</given-names></name><name><surname>Filbin</surname><given-names>MG</given-names></name><name><surname>Hovestadt</surname><given-names>V</given-names></name><name><surname>Escalante</surname><given-names>LE</given-names></name><name><surname>Shaw</surname><given-names>ML</given-names></name><name><surname>Rodman</surname><given-names>C</given-names></name><name><surname>Gillespie</surname><given-names>SM</given-names></name><name><surname>Dionne</surname><given-names>D</given-names></name><name><surname>Luo</surname><given-names>CC</given-names></name><name><surname>Ravichandran</surname><given-names>H</given-names></name><name><surname>Mylvaganam</surname><given-names>R</given-names></name><name><surname>Mount</surname><given-names>C</given-names></name><name><surname>Onozato</surname><given-names>ML</given-names></name><name><surname>Nahed</surname><given-names>BV</given-names></name><name><surname>Wakimoto</surname><given-names>H</given-names></name><name><surname>Curry</surname><given-names>WT</given-names></name><name><surname>Iafrate</surname><given-names>AJ</given-names></name><name><surname>Rivera</surname><given-names>MN</given-names></name><name><surname>Frosch</surname><given-names>MP</given-names></name><name><surname>Golub</surname><given-names>TR</given-names></name><name><surname>Brastianos</surname><given-names>PK</given-names></name><name><surname>Getz</surname><given-names>G</given-names></name><name><surname>Patel</surname><given-names>AP</given-names></name><name><surname>Monje</surname><given-names>M</given-names></name><name><surname>Cahill</surname><given-names>DP</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Louis</surname><given-names>DN</given-names></name><name><surname>Bernstein</surname><given-names>BE</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Suvà</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Decoupling genetics, lineages, and microenvironment in IDH-mutant gliomas by single-cell RNA-seq</article-title><source>Science (New York, N.Y.)</source><volume>355</volume><elocation-id>eaai8478</elocation-id><pub-id pub-id-type="doi">10.1126/science.aai8478</pub-id><pub-id pub-id-type="pmid">28360267</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Ma</surname><given-names>Y</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Jiang</surname><given-names>Q</given-names></name><name><surname>Zhou</surname><given-names>M</given-names></name><name><surname>Su</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Benchmarking algorithms for pathway activity transformation of single-cell RNA-seq data</article-title><source>Computational and Structural Biotechnology Journal</source><volume>18</volume><fpage>2953</fpage><lpage>2961</lpage><pub-id pub-id-type="doi">10.1016/j.csbj.2020.10.007</pub-id><pub-id pub-id-type="pmid">33209207</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71994.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Robles-Espinoza</surname><given-names>C Daniela</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>International Laboratory for Human Genome Research</institution><country>Mexico</country></aff></contrib></contrib-group><related-object id="sa0ro1" link-type="continued-by" object-id="10.1101/2021.06.29.450404" object-id-type="id" xlink:href="https://sciety.org/articles/activity/10.1101/2021.06.29.450404"/></front-stub><body><p>In this revised manuscript, Noureen and collaborators benchmark five methods that are used in single-cell RNA sequencing data analyses, including single sample gene set enrichment analysis (ssGSEA), Gene Set Variation Analysis (GSVA), AUCell, Single Cell Signature Explorer (SCSE), and a newly developed method, Jointly Assessing Signature Mean and Inferring Enrichment (JASMINE). The authors test these in distinct cancer datasets and conclude that caution should be exercised when using bulk sample-based methods in single-cell data analyses, and cellular contexts should be taken into consideration. As a rapidly developing field in need of method benchmarking, we believe that this paper will be of great interest to the bioinformatics and single-cell data analysis communities.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71994.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Robles-Espinoza</surname><given-names>C Daniela</given-names></name><role>Reviewing Editor</role><aff><institution>International Laboratory for Human Genome Research</institution><country>Mexico</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Han</surname><given-names>Leng</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03gds6c39</institution-id><institution>The University of Texas Health Science Center at Houston McGovern Medical School</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.06.29.450404">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.06.29.450404v2">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Signature-scoring methods developed for bulk samples are not adequate for cancer single-cell RNA sequencing data&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Patricia Wittkopp as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Leng Han (Reviewer #3).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>In this manuscript, Noureen and collaborators benchmark four methods that are used in single-cell RNA sequencing data analyses, including single sample gene set enrichment analysis (ssGSEA), AUCell, Single Cell Signature Explorer (SCSE), and a newly developed method, Jointly Assessing Signature Mean and Inferring Enrichment (JASMINE). The authors test these in distinct cancer datasets and conclude that caution should be exercised when using bulk sample-based methods in single-cell data analyses, and cellular contexts should be taken into consideration. Although interesting and informative, reviewers have raised a number of essential considerations that need to be addressed before publication.</p><p>Essential revisions:</p><p>Major Points</p><p>1. A reviewer comments, &quot;The main analysis performed by the authors was identifying gene sets that significantly distinguish between cancer cells and the rest of the cells in the tumor. This a problematic comparison, since the cancer cells are epithelial cells (in most of the studies used) and the &quot;normal&quot; cells are stromal cells, mostly immune. Those are not comparable &quot;normal&quot; cells, and therefore it is expected that all immune-related pathways will be significant. The authors find much more down-regulated gene sets in ssGSEA compared to the other methods, but why are they wrong? If they are all immune related, I would actually conclude that ssGSEA is better than the other methods.&quot; They continue, &quot;The comparison of cancer cells to normal microenvironment cells is meaningless. If looking at cancer, a relevant comparison would be cancer cells and normal adjacent cells. But cancer in general is not the best, as there would be way too many significant signatures, and its hard to understand what makes sense and what not&quot;. – Can the authors address this crucial observation please?</p><p>2. Can the methodology by which each method identifies signatures be explained? This would help identify why these methods perform differentially. Specifically, reviewers strongly suggest understanding what in ssGSEA makes it output different results. Gene dropouts could be the root cause, but this is something that needs proof. Empirically, reviewers suggest that this can be studied by comparing different scRNA-seq methods with different gene dropouts rates – compare 10X to SMART-seq. Do the authors have an idea of how this affects results?</p><p>3. The new method the authors propose (JASMINE) is not thoroughly explained and includes formulations which, in a reviewer's evaluation, lead to unintended mathematical behavior and hamper interpretation. Can the explanation on this method be expanded, please? Specifically, reviewers have raised the following points:</p><p>a. The four variables (a,b,c,d) considered when calculating the odds ratio make sense. However, the authors claim that &quot;For smaller signatures b can be occasionally 0. In that case we replace it with 1.&quot; In a reviewer's words, &quot;this is not a coherent and principled approach. I recommend the authors reconsider the mathematical formulation of this quantification to avoid the necessity of this unprincipled workaround.&quot;</p><p>b. A reviewer commented that &quot;It is not clear why the average is the best way to combine the V<sub>mean</sub> and OR to obtain the JASMINE score&quot;. Can this be specified, please?</p><p>[Editors’ note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for submitting your article &quot;Signature-scoring methods developed for bulk samples are not adequate for cancer single-cell RNA sequencing data&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Naama Barkai as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Leng Han (Reviewer #3).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>In this revised manuscript, Noureen and collaborators benchmark five methods that are used in single-cell RNA sequencing data analyses, including single sample gene set enrichment analysis (ssGSEA), Gene Set Variation Analysis (GSVA), AUCell, Single Cell Signature Explorer (SCSE), and a newly developed method, Jointly Assessing Signature Mean and Inferring Enrichment (JASMINE). The authors test these in distinct cancer datasets and conclude that caution should be exercised when using bulk sample-based methods in single-cell data analyses, and cellular contexts should be taken into consideration. The majority of the reviewers have found the answers to their initial points to be thorough and satisfactory, and so we would only ask the authors to address the points of one new reviewer, who replaced a previous reviewer for this round of revisions.</p><p>Essential revisions:</p><p>1. It is unclear how calibrated any of these methods are from the analysis presented in this manuscript. To help clarity, please address:</p><p>a) Can the authors please detail, in the Methods section, which thresholds are used on each program?</p><p>b) Is any test statistic is derived from the JASMINE method?</p><p>c) How is the final statistic is derived? That is, what is the range that the statistic is scaled by? In particular, in the eyes of a reviewer, the math for V<sub>mean</sub> is unclear. They write, &quot;As written, it is computed only over a fixed index g? The range on the sum is a bit confusing as well. Shouldn't it be over all the cells? If I were to guess, V<sub>mean</sub> appears to be V<sub>mean</sub> = \sum_{g=1}^{m}\sum_{c=1}^{total cells} R_{g,c}/(m*N). Is this correct?&quot;. Please clarify these points in the Methods section.</p><p>2. This manuscript infers that the main advantage of methods specific for single-cell data is to account for dropouts. However, in the view of a reviewer, the work presented here does not explicitly compare the differences between the bulk and single-cell methods, and they note that there might be factors that influence the results besides dropouts in real data. They argue that it is inconclusive to attribute poor performance of bulk methods to dropouts, especially when there is only one bulk method included in the analysis. For example, it is unclear how the authors ran ssGSEA, as there are some missing details in the Methods section. In particular, it is common practice to 'pre-filter' RNA-seq data before running any analysis on it. Did the authors do this for the real data analysis? Please add an introduction to each method, and add the details missing so readers can recapitulate the test conditions.</p><p>3. From Figure 1D, the authors reveal that the non-cycling tumor cells exhibit higher scores than non-cycling normal cells by ssGSEA. However, it is also noticeable that ssGSEA scores have a much higher variance than the other three methods, and results from SCSE and AUCell scores do not show a significant difference between cycling and non-cycling cells. Are there any explanations and/or intuition for such a result?</p><p>4. In the &quot;Dropouts affect ssGSEA scores&quot; section (Line 167), the &quot;dummy expression matrix of 1000 genes and nine columns&quot; is not clearly described. Is it for each cell? Is the ranking of genes the same for each dropout rate? Besides, Figure 3B is not fully explained: Could the authors please explain why the black line has a curvy feature towards the end of x axis while the blue line is linear? How about other dropout rates? There should be nine lines in the figure according to the matrix.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71994.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1. A reviewer comments, &quot;The main analysis performed by the authors was identifying gene sets that significantly distinguish between cancer cells and the rest of the cells in the tumor. This a problematic comparison, since the cancer cells are epithelial cells (in most of the studies used) and the &quot;normal&quot; cells are stromal cells, mostly immune. Those are not comparable &quot;normal&quot; cells, and therefore it is expected that all immune-related pathways will be significant. The authors find much more down-regulated gene sets in ssGSEA compared to the other methods, but why are they wrong? If they are all immune related, I would actually conclude that ssGSEA is better than the other methods.&quot; They continue, &quot;The comparison of cancer cells to normal microenvironment cells is meaningless. If looking at cancer, a relevant comparison would be cancer cells and normal adjacent cells. But cancer in general is not the best, as there would be way too many significant signatures, and its hard to understand what makes sense and what not&quot;. – Can the authors address this crucial observation please?</p></disp-quote><p>We agree with the reviewer that lineage is an important factor when comparing tumor and normal cells. Lineage specific signatures are expected to differ, but expectations are not reliable for benchmarking purposes because tumor cells may influence the expression of immune and stromal cells, and cancers of different lineages do not necessarily show the same differences with normal cells. A more objective approach is to compare outputs of each method with ground truth. This is why we designed two objective experiments to benchmark the reliability of the tested methods. In the first experiment, we generated gold standard up/down signatures and tested how well each method rediscovers them (sensitivity test, Figure 2a-b in initial manuscript). Note that generating these gold standard signatures does not rely on expectations, but rather on their constituent genes that are sampled from the pool of differentially expressed genes. In the second experiment, we generated pseudo-cells by down sampling. These cells are identical to the original cells in the distribution of expressed genes; thus, no signature should be identified. This experiment was to test how well each method eludes false positives (specificity test, Figure 2c in the initial manuscript). These experiments were designed precisely because of the challenges to establish functional gold standard, as the reviewer pointed it out.</p><p>We gently correct the reviewer that we found more up-regulated, not down-regulated gene sets in ssGSEA. We also respectfully remind the reviewer that in our manuscript, we never concluded that ssGSEA scores were wrong in the tumor vs normal comparisons. Instead, we concluded that “… ssGSEA is sensitive to variability of gene counts common to scRNAseq data” (lines 94-95 on page 4, first submitted version). We respectfully argue that the observation of many more deregulated signatures called by ssGSEA preludes the more systematic benchmark analyses we laid out later in the manuscript, because it substantiates the hypothesis that signature scores can be biased if a method does not factor in dropouts in single cell data.</p><p>To give the reviewer and readers an intuitive example of how ssGSEA scores may mislead single cell interpretation, we calculated the score of the cell cycle signature (Gene Ontology, GO:0007049). As the reviewer is aware, cycling cells often need to be regressed out before clustering in single cell analysis. In this example, we used the head and neck data (Puram et al., 2017), and normal/tumor cell annotations were downloaded from the publication. We divided cells into cycling (S phase, G2M phase) and non-cycling cells (G1) using Seurat. Very few normal cells were determined as cycling, and thus, were removed from the figure. We additionally added the expression of KI67 to further confirm cell cycle status. KI67 is an established proliferation marker and is expressed by cycling cells but not quiescent cells. As shown in the figure, KI67 expression agrees well with Seurat scores. Notably, in tumor cells highlighted in the red box, ssGSEA scores were significantly higher than those in normal cells, suggesting the tumor cells may be cycling. However, neither these tumor cells nor the normal cells are cycling according to other evidence. Thus, at the minimum, ssGSEA scores complicate the interpretation of cell cycle status in this example. None of the single-cell methods showed the same bias.</p><p>This example was included in our preprint but was omitted in our initial submission. In the revision, we have added it back to support our conclusion. We again apologize for the omission, and hope the reviewer finds that this example makes biological sense.</p><disp-quote content-type="editor-comment"><p>2. Can the methodology by which each method identifies signatures be explained? This would help identify why these methods perform differentially. Specifically, reviewers strongly suggest understanding what in ssGSEA makes it output different results. Gene dropouts could be the root cause, but this is something that needs proof. Empirically, reviewers suggest that this can be studied by comparing different scRNA-seq methods with different gene dropouts rates – compare 10X to SMART-seq. Do the authors have an idea of how this affects results?</p></disp-quote><p>We thank the reviewers for suggesting new analyses to better understand the impact of dropouts on signature scores. Comparing SMART-seq with 10x does reproduce the differences in dropout rates. Among the 10 datasets we used, five were from SMART-seq, four from 10X and one from C1 fludigm. However, one cell cannot be sequenced twice with two scRNAseq platforms. Therefore, it is unfeasible to compare data of the same cells generated by the two platforms. Alternatively, we can compare the same cell population sequenced by the two. In a recent study (PMID: 33662621), Wang et al., sequenced the same samples of CD45<sup>-</sup> cells with both SMART-seq and 10x platforms. They showed that the RNA composition detected by the two platforms differ. Specifically, the 10x platform detected more ribosomal genes and lncRNAs, whereas SMART-seq detected more mitochondrial genes. The differences in RNA composition are critically important for RNA sequencing data analysis (see Robinson et al., Genome Bio, 2010. PMID: 20196867; and Zhao et al., RNA, 2020. PMID: 32284352), and thus, gene expression values are not directly comparable between the two platforms. For the same reason, gene signatures scores are not directly comparable either. Another confounding factor is cell-to-cell variation such as caused by transcriptional bursting.</p><p>Down sampling is an established method in single cell RNAseq analysis to recapitulate the effects of differences in sequencing depth. The method increases technical dropout rates and creates a realistic expression profile at a prespecified depth (Luecken M and Theis F, Mol Syst Biol, 2019. PMID: 31217225). Using this method, we can generate the expression profile of the same cell at a lower depth (conversely, higher dropout) without confounding effects from other factors. As we show in Figure 2C, at the 50% down sampling rate, ssGSEA identifies many deregulated signatures between the original cells and down sampled cells across all ten datasets. These concerning results indicate dropouts likely affect ssGSEA much more than other methods.</p><p>To further prove this, we set down sampling levels to 20%, 40%, 60% and 80%. Here, 80% down sampling means after the procedure, the cell is at 80% sequencing depth of the original cell. As down sampling level decreases, more dropouts are created as the procedure primarily affects genes with low counts. New Figure 3A shows how the number of up and down signatures identified by ssGSEA shifts along with down sampling levels. Because the dropout rate is the only parameter we manipulated in this analysis, the results clearly indicate that it impacts ssGSEA scores. In contrast, single-cell methods do not show the same correlation. We replicated the results in other datasets (see Figure 3—figure supplement 1 in the revised manuscript).</p><p>An empirical approach to this question is to take advantage of cell-to-cell variation and examine how scoring patterns change as cells with similar dropout rates are compared. In new Figure 3-figure supplement 2, the top panel shows score correlation of a signature between JASMINE and the other three methods using all cells from the head and neck data. Normal cells are scored higher by single cell methods but not ssGSEA, despite that JASMINE and ssGSEA scores are nicely correlated in both normal and tumor cells. In the bottom panel, we limited tumor and normal cells to those with 4,000-5,000 expressed genes. With this filtering, tumor cells still have higher gene counts than normal cells on average (tumor, 4585; normal, 4407), but the difference is much smaller than using the entire dataset. Nevertheless, using these cells led to a much more consistent pattern between ssGSEA and single-cell methods, further supporting our conclusion.</p><p>We agree with the reviewers that more insights are needed, particularly related to ssGSEA. The method scores a signature by summing up differences in the empirical cumulative density of genes inside and outside the signature. To do so, ssGSEA orders and ranks genes from high to low expression and iterate through every gene. For bulk expression data, the ranks are continuous; thus, signature scores gradually change depending on the distribution of the signature genes on the rank list. Single cell data often encompass thousands of dropouts. Because dropout genes have equal expression values, i.e., zero, their ranks are tied, thus disrupting the presumption of continuous data distribution. This predicates that if a signature has no gene in the dropout zone, the signature score is not affected by dropout rates. Otherwise, the score will be affected. We think this is an important issue, because using 10x, it is common to detect only 2,000-4,000 genes; even smart-seq usually only detect ~6,000 genes. It is thus highly likely that genes from gene signatures fall into the dropout zone. Single cell methods dodge this issue for various reasons. AUCell and SCSE do not use dropout genes in scoring, whereas JASMINE explicitly considers dropout rate in the calculation.</p><p>We next designed a computational approach to test this idea. We first generated a dummy expression vector with 10,000 genes. The genes were ranked from high to low based on expression, the same as ssGSEA. This expression vector mimics bulk expression data. Then we set the bottom of the vector to zeros to create dropouts at various rates. Next, we generated a highly expressed gene signature of 100 genes. This 100-gene signature consisted of 99 genes that were randomly sampled from the top 1000 genes, and the last gene (the floating signature gene) was iterated from the 1001<sup>st</sup> gene onwards to the bottom of the gene list. This allowed us to observe how the signature score changes as the floating signature gene moved towards the dropout zone. We have provided the source code of this process in our Github repository for the reviewers and other researchers to reproduce our results and test different scenarios using the dummy expression data (https://github.com/NNoureen/JASMINE).</p><p>In new Figure 3B, the black line shows the signature score at no dropout. The blue line shows the signature score when the floating gene enters the dropout zone at 60% dropout rate. At this rate, the dropout zone is between the gene rank 4,000 and 10,000. Before the floating signature gene enters the dropout zone (at gene rank 4,000), the signature score is identical between the original cell and down sampled cell. However, between gene rank 4,000 and 7,000, the signature is scored higher in the dropout cell than the control cell, and the pattern is reversed after gene rank 7,000. Note that gene rank 7,000 is the tie rank for all dropout genes. Clearly, the scores deviate from the intended behavior in the dropouts.</p><p>In the revision, we have added new Figure 3A, new Figure 3—figure supplement 2 and new Figure 3B to the manuscript. We have also discussed the reasons why these methods perform differently.</p><disp-quote content-type="editor-comment"><p>3. The new method the authors propose (JASMINE) is not thoroughly explained and includes formulations which, in a reviewer's evaluation, lead to unintended mathematical behavior and hamper interpretation. Can the explanation on this method be expanded, please? Specifically, reviewers have raised the following points:</p><p>a. The four variables (a,b,c,d) considered when calculating the odds ratio make sense. However, the authors claim that &quot;For smaller signatures b can be occasionally 0. In that case we replace it with 1.&quot; In a reviewer's words, &quot;this is not a coherent and principled approach. I recommend the authors reconsider the mathematical formulation of this quantification to avoid the necessity of this unprincipled workaround.&quot;</p><p>b. A reviewer commented that &quot;It is not clear why the average is the best way to combine the V<sub>mean</sub> and OR to obtain the JASMINE score&quot;. Can this be specified, please?</p></disp-quote><p>a. When calculating odds ratio, the denominator is <italic>b</italic>*<italic>c</italic>, where <italic>b</italic> is the number of signature genes that are not detected, and <italic>c</italic> is the number of nonsignature genes that are detected (see <xref ref-type="table" rid="sa2table1">Author response table 1</xref> for reviewers’ convenience).</p><table-wrap id="sa2table1" position="float"><label>Author response table 1.</label><caption><title>A breakdown of signature genes in a single cell expression profile.</title><p>The four numbers are used in signature enrichment calculation by JASMINE.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="1" valign="bottom"/><th rowspan="1" valign="bottom">Expressed</th><th rowspan="1" valign="bottom">Not-expressed</th></tr></thead><tbody><tr><td align="left" valign="bottom">Signature gene</td><td align="left" valign="bottom"><italic>a</italic></td><td align="left" valign="bottom"><italic>b</italic></td></tr><tr><td align="left" valign="bottom">Non-signature gene</td><td align="left" valign="bottom">c</td><td align="left" valign="bottom">d</td></tr></tbody></table></table-wrap><p>b. In practice, <italic>c</italic> is unlikely zero. <italic>b</italic> would be zero if all genes in the signature are expressed. In this scenario, the signature is highly enriched in the expressed genes, and thus, should be given a high OR score. Imagine for a signature consisting of 50 genes, if all 50 genes are expressed in a cell, the signature is apparently highly enriched with expressed genes. Even if we assume one of the signature genes is not expressed, the enrichment pattern will be largely the same. We think adding a small number is a mathematical necessity without significantly changing the biological interpretation. Our approach is not so much different from other methods such as Haldane correction which would add a small number, such as 0.5, to each variable in the OR calculation.</p><p>We agree with the reviewer that this workaround may deviate scores from the formula for some signatures. To clarify how many signatures may be affected, the following <xref ref-type="table" rid="sa2table2">Author response table 2</xref> summarizes the number of signatures that have b=0 in none of the cells, 1 cell, 2 cells, or ≥3 cells. The number in the parenthesis indicates percentage. The total number of cells analyzed in each dataset is also given in the column name. On average, 99% of the signatures we analyzed did not encounter this issue in any of the cells in the ten datasets. Given that each dataset has hundreds to thousands of cells, this issue is extremely rare.</p><table-wrap id="sa2table2" position="float"><label>Author response table 2.</label><caption><title>Counts and frequencies of signatures with b=0 in 0, 1, 2 and ≥3 cells across datasets.</title><p>The number of cells analyzed in each dataset is given in the parenthesis at the column name.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">cell # (b=0)</th><th align="left" valign="bottom">Astrocytoma(n=6176)</th><th align="left" valign="bottom">BRCA(n=515)</th><th align="left" valign="bottom">IDHwtGBM(n=5742)</th><th align="left" valign="bottom">HNSC(n=5560)</th><th align="left" valign="bottom">GBM(n=3589)</th></tr></thead><tbody><tr><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">7425 (98.96)</td><td align="char" char="." valign="bottom">7438 (99.13)</td><td align="char" char="." valign="bottom">7395 (98.56)</td><td align="char" char="." valign="bottom">7194 (95.88)</td><td align="char" char="." valign="bottom">7326 (99.84)</td></tr><tr><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">33 (0.44)</td><td align="char" char="." valign="bottom">25 (0.33)</td><td align="char" char="." valign="bottom">33 (0.44)</td><td align="char" char="." valign="bottom">161 (2.15)</td><td align="char" char="." valign="bottom">7 (0.1)</td></tr><tr><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">18 (0.24)</td><td align="char" char="." valign="bottom">10 (0.13)</td><td align="char" char="." valign="bottom">17 (0.23)</td><td align="char" char="." valign="bottom">46 (0.61)</td><td align="char" char="." valign="bottom">2 (0.03)</td></tr><tr><td align="char" char="." valign="bottom">≥3</td><td align="char" char="." valign="bottom">27 (0.36)</td><td align="char" char="." valign="bottom">30 (0.4)</td><td align="char" char="." valign="bottom">58 (0.6)</td><td align="char" char="." valign="bottom">102 (1.36)</td><td align="char" char="." valign="bottom">3 (0.04)</td></tr><tr><td align="left" valign="bottom"><bold>cell # (b=0)</bold></td><td align="left" valign="bottom"><bold>LIHC</bold><bold>(n=5023)</bold></td><td align="left" valign="bottom"><bold>CRC</bold><bold>(n=3336)</bold></td><td align="left" valign="bottom"><bold>ccRCC</bold><bold>(n=3933)</bold></td><td align="left" valign="bottom"><bold>Prostate</bold><bold>(n=2170)</bold></td><td align="left" valign="bottom"><bold>Melanoma</bold><bold>(n=4645)</bold></td></tr><tr><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">7482 (99.72)</td><td align="char" char="." valign="bottom">7496 (99.91)</td><td align="char" char="." valign="bottom">7489 (99.81)</td><td align="char" char="." valign="bottom">7493 (99.87)</td><td align="char" char="." valign="bottom">7253 (96.67)</td></tr><tr><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">8 (0.11)</td><td align="char" char="." valign="bottom">2 (0.03)</td><td align="char" char="." valign="bottom">7 (0.09)</td><td align="char" char="." valign="bottom">7 (0.09)</td><td align="char" char="." valign="bottom">79 (1.05)</td></tr><tr><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">7 (0.09)</td><td align="char" char="." valign="bottom">3 (0.04)</td><td align="char" char="." valign="bottom">1 (0.01)</td><td align="char" char="." valign="bottom">2 (0.03)</td><td align="char" char="." valign="bottom">43 (0.57)</td></tr><tr><td align="char" char="." valign="bottom">≥3</td><td align="char" char="." valign="bottom">6 (0.08)</td><td align="char" char="." valign="bottom">2 (0.03)</td><td align="char" char="." valign="bottom">6 (0.08)</td><td align="char" char="." valign="bottom">1 (0.01)</td><td align="char" char="." valign="bottom">128 (1.71)</td></tr></tbody></table></table-wrap><p>Inspired by the reviewer’s comments, we have provided likelihood ratio as an additional approach to odds ratio in the revision. The first likelihood calculates the risk of a signature gene being detected as <italic>a</italic>/(<italic>a</italic>+<italic>b</italic>), and the second likelihood calculates the risk of non-signature genes being detected as <italic>c</italic>/(<italic>c</italic>+<italic>d</italic>). The second likelihood essentially provides a background, and approximately equals the ratio between the numbers of expressed genes and non-expressed genes. The likelihood ratio is calculated as the ratio of the two likelihoods, i.e., LR=<italic>a</italic>*(<italic>c</italic>+<italic>d</italic>)/(<italic>c</italic>*(<italic>a+b</italic>)). This will effectively avoid the 0 denominator issue. In our testing, the likelihood ratio and odds ratio gave highly consistent results: effect size correlation was higher than 0.95 in four of the five datasets tested. The new function has been implemented in the JASMINE code.</p><p>In the revision, we have added more details to the method description, and clarified the extent to which b=0 may affect signature scores. The JASMINE code has also been updated on Github. We thank the reviewer for prompting us to improve the JASMINE function.</p><p>b. We cannot say the average is the best way to combine the two. As insight evolves, there might be better and more sensible approaches to signature scoring. During our analysis, we tested multiple ways, including arithmetic mean, geometric mean, and some other non-linear methods. After the tests, we felt equal contribution from the two score components makes best sense, largely because we do not have a good reasoning to overweigh one option over another.</p><p>[Editors’ note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1. It is unclear how calibrated any of these methods are from the analysis presented in this manuscript. To help clarity, please address:</p><p>a) Can the authors please detail, in the Methods section, which thresholds are used on each program?</p></disp-quote><p>When we calculated scores with each method, no thresholds were used. However, when we compared signature scores between tumor and normal cells, we used Cohen’s d &gt; 1 as criterion for up regulation and &lt; -1 for down regulation. These thresholds have been clarified in the main text and Methods.</p><disp-quote content-type="editor-comment"><p>b) Is any test statistic is derived from the JASMINE method?</p></disp-quote><p>JASMINE does not derive a test statistic, similar to other methods benchmarked in the study. These methods calculate a score for an input signature in a cell/sample. These scores can be compared across cells/samples for differences in signature expression. Compared with methods such as regular GSEA, these single sample methods do not rely on class labels, and thus, offer better flexibility for downstream analyses. In our revised manuscript, we have provided further context in Discussion.</p><disp-quote content-type="editor-comment"><p>c) How is the final statistic is derived? That is, what is the range that the statistic is scaled by? In particular, in the eyes of a reviewer, the math for V<sub>mean</sub> is unclear. They write, &quot;As written, it is computed only over a fixed index g? The range on the sum is a bit confusing as well. Shouldn't it be over all the cells? If I were to guess, V<sub>mean</sub> appears to be V<sub>mean</sub> = \sum_{g=1}^{m}\sum_{c=1}^{total cells} R_{g,c}/(m*N). Is this correct?&quot;. Please clarify these points in the Methods section.</p></disp-quote><p>We thank the reviewer for meticulously checking the formula, and yes, it is indeed a bit confusing. To make it clearer, we have revised it as follows:</p><p>Assume <italic>R<sub>g</sub></italic> represents the rank of an expressed signature gene <italic>g</italic> among genes with expression value &gt; 0 in a cell, then a mean rank vector <italic>V<sub>mean</sub></italic> is calculated as follows:<disp-formula id="sa2equ1"><mml:math id="sa2m1"><mml:mrow><mml:mi>V</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mtext> </mml:mtext><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>∗</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The final score is defined as the arthemetic mean of the 2 signature components: signature mean defined by Vmean, and signature enrichment defined by odds ratio or likelihood ratio. Each component has a range of 0-1.</p><disp-quote content-type="editor-comment"><p>2. This manuscript infers that the main advantage of methods specific for single-cell data is to account for dropouts. However, in the view of a reviewer, the work presented here does not explicitly compare the differences between the bulk and single-cell methods, and they note that there might be factors that influence the results besides dropouts in real data. They argue that it is inconclusive to attribute poor performance of bulk methods to dropouts, especially when there is only one bulk method included in the analysis. For example, it is unclear how the authors ran ssGSEA, as there are some missing details in the Methods section. In particular, it is common practice to 'pre-filter' RNA-seq data before running any analysis on it. Did the authors do this for the real data analysis? Please add an introduction to each method, and add the details missing so readers can recapitulate the test conditions.</p></disp-quote><p>We appreciate the reviewer’s concern. We did pre-filter the single-cell RNAseq datasets by removing genes that were not detected in any cells. As for the running of these methods is concerned, we have run ssGSEA and GSVA using the R biocondutor package GSVA. We used the default parameters to run these methods. Similarly we ran AUCell using their package with default parameters. SCSE did not provide R codes, only a web application. For fair comparison, we implemented it in R according to the formula reported in their publication. These details have been added to the methods section. We have also included some discussions on each method in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>3. From Figure 1D, the authors reveal that the non-cycling tumor cells exhibit higher scores than non-cycling normal cells by ssGSEA. However, it is also noticeable that ssGSEA scores have a much higher variance than the other three methods, and results from SCSE and AUCell scores do not show a significant difference between cycling and non-cycling cells. Are there any explanations and/or intuition for such a result?</p></disp-quote><p>We thank the reviewer for raising this great question, which prompted us to include gene counts in the figure. Visually, it is clear that ssGSEA scores are associated with gene counts, which we think further strengthens our conclusion. We have replaced the original Figure 1D with the new one in our revised manuscript.</p><disp-quote content-type="editor-comment"><p>4. In the &quot;Dropouts affect ssGSEA scores&quot; section (Line 167), the &quot;dummy expression matrix of 1000 genes and nine columns&quot; is not clearly described. Is it for each cell? Is the ranking of genes the same for each dropout rate? Besides, Figure 3B is not fully explained: Could the authors please explain why the black line has a curvy feature towards the end of x axis while the blue line is linear? How about other dropout rates? There should be nine lines in the figure according to the matrix.</p></disp-quote><p>The dummy expression matrix of 10,000 genes and nine columns reflect a scenario where the first column representing a cell that has no dropouts; from the 2<sup>nd</sup> column to 9<sup>th</sup> column is the same cell but with different drop out rates ranging from 10 % to 80 % with the step of 10%. The ranking of genes is identical in each column. We agree with the reviewer that stating 9 columns in the text may lead to confusion because we did not show 9 lines in the figure. The reason we only showed 60% dropout (blue line) is that we think having one line is sufficient to show the deviation in the dropout zone, whereas having multiple lines would make the figure harder to read, and importantly, unnecessary given that they are essentially repeating the same message. The codes for this similatuion were published in our Github (https://github.com/NNoureen/JASMINE). We respectfully encourage the reviewer to check them.</p><p>As for the curly tail of the ssGSEA scores in the cell without dropouts, that is how ssGSEA penalizes the genes at the bottom of the gene list as shown in our floating gene simulation. Thus, it appears ssGSEA penalizes the gene less for the signature score if the gene appears at the bottom of the list. In our experiment, we only changed the position of the last signature gene while keeping all other settings the same. When the ranking of the bottom genes are identical due to dropouts, the penalization became linear, showing the score as a straight declining line. We think these are compelling data to show how dropouts can affect ssGSEA scoring.</p><p>In the revision, we have edited the text to mitigate confusion. We thank the reviewer for pointing out this.</p></body></sub-article></article>