<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">55308</article-id><article-id pub-id-type="doi">10.7554/eLife.55308</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Deciphering the regulatory genome of <italic>Escherichia coli</italic>, one hundred promoters at a time</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-171871"><name><surname>Ireland</surname><given-names>William T</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0971-2904</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172896"><name><surname>Beeler</surname><given-names>Suzannah M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1930-4827</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172897"><name><surname>Flores-Bautista</surname><given-names>Emanuel</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-199132"><name><surname>McCarty</surname><given-names>Nicholas S</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-199131"><name><surname>Röschinger</surname><given-names>Tom</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4900-3216</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172839"><name><surname>Belliveau</surname><given-names>Nathan M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1536-1963</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">†</xref></contrib><contrib contrib-type="author" id="author-8534"><name><surname>Sweredoski</surname><given-names>Michael J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0878-3831</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-30379"><name><surname>Moradian</surname><given-names>Annie</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0407-2031</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-27308"><name><surname>Kinney</surname><given-names>Justin B</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1897-3778</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-7190"><name><surname>Phillips</surname><given-names>Rob</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3082-2809</contrib-id><email>phillips@pboc.caltech.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Physics, California Institute of Technology</institution><addr-line><named-content content-type="city">Pasadena</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Division of Biology and Biological Engineering, California Institute of Technology</institution><addr-line><named-content content-type="city">Pasadena</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Division of Chemistry and Chemical Engineering, California Institute of Technology</institution><addr-line><named-content content-type="city">Pasadena</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Proteome Exploration Laboratory, Division of Biology and Biological Engineering, Beckman Institute, California Institute of Technology</institution><addr-line><named-content content-type="city">Pasadena</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution>Simons Center for Quantitative Biology, Cold Spring Harbor Laboratory</institution><addr-line><named-content content-type="city">Cold Spring Harbor</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Nourmohammad</surname><given-names>Armita</given-names></name><role>Reviewing Editor</role><aff><institution>University of Washington</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Barkai</surname><given-names>Naama</given-names></name><role>Senior Editor</role><aff><institution>Weizmann Institute of Science</institution><country>Israel</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Howard Hughes Medical Institute and Department of Biology, University of Washington, Seattle, United States</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>21</day><month>09</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e55308</elocation-id><history><date date-type="received" iso-8601-date="2020-01-20"><day>20</day><month>01</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-09-18"><day>18</day><month>09</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Ireland et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Ireland et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-55308-v2.pdf"/><abstract><p>Advances in DNA sequencing have revolutionized our ability to read genomes. However, even in the most well-studied of organisms, the bacterium <italic>Escherichia coli</italic>, for ≈65% of promoters we remain ignorant of their regulation. Until we crack this regulatory Rosetta Stone, efforts to read and write genomes will remain haphazard. We introduce a new method, Reg-Seq, that links massively parallel reporter assays with mass spectrometry to produce a base pair resolution dissection of more than a <italic>E. coli</italic> promoters in 12 growth conditions. We demonstrate that the method recapitulates known regulatory information. Then, we examine regulatory architectures for more than 80 promoters which previously had no known regulatory information. In many cases, we also identify which transcription factors mediate their regulation. This method clears a path for highly multiplexed investigations of the regulatory genome of model organisms, with the potential of moving to an array of microbes of ecological and medical relevance.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>transcriptional regulation</kwd><kwd>information theory</kwd><kwd>quantitative biology</kwd><kwd>gene expression</kwd><kwd>transcription factors</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>Director's Pioneer Award</award-id><principal-award-recipient><name><surname>Phillips</surname><given-names>Rob</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>National Research Service Award</award-id><principal-award-recipient><name><surname>Beeler</surname><given-names>Suzannah M</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>Maximizing Investigators Research Award</award-id><principal-award-recipient><name><surname>Phillips</surname><given-names>Rob</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap></funding-source><award-id>International Student Research Fellowship</award-id><principal-award-recipient><name><surname>Belliveau</surname><given-names>Nathan M</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>1S10OD02001301</award-id><principal-award-recipient><name><surname>Moradian</surname><given-names>Annie</given-names></name><name><surname>Sweredoski</surname><given-names>Michael J</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A combination of massively parallel reporter assays and mass spectrometry uncovers the regulation of previously unexplored promoters across the <italic>Escherichia coli</italic> genome.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>DNA sequencing is as important to biology as the telescope is to astronomy. We are now living in the age of genomics, where DNA sequencing has become cheap and routine. However, despite these incredible advances, how all of this genomic information is regulated and deployed remains largely enigmatic. Organisms must respond to their environments through the regulation of genes. Genomic methods often provide a 'parts list' but leave us uncertain about how those parts are used creatively and constructively in space and time. Yet, we know that promoters apply all-important dynamic logical operations that control when and where genetic information is accessed. In this paper, we demonstrate how we can infer the logical and regulatory interactions that control bacterial decision making by tapping into the power of DNA sequencing as a biophysical tool. The method introduced here provides a framework for solving the problem of deciphering the regulatory genome by connecting perturbation and response, mapping information flow from individual nucleotides in a promoter sequence to downstream gene expression, determining how much information each promoter base pair carries about the level of gene expression.</p><p>The advent of RNA-Seq (<xref ref-type="bibr" rid="bib54">Lister et al., 2008</xref>; <xref ref-type="bibr" rid="bib64">Nagalakshmi et al., 2008</xref>; <xref ref-type="bibr" rid="bib62">Mortazavi et al., 2008</xref>) launched a new era in which sequencing could be used as an experimental read-out of the biophysically interesting counts of mRNA, rather than simply as a tool for collecting ever more complete organismal genomes. The slew of ‘X’-Seq technologies that are available continues to expand at a dizzying pace, each serving their own creative and insightful role: RNA-Seq, ChIP-Seq, Tn-Seq, SELEX, 5C, etc (<xref ref-type="bibr" rid="bib83">Stuart and Satija, 2019</xref>). In contrast to whole genome screening sequencing approaches, such as Tn-Seq (<xref ref-type="bibr" rid="bib26">Goodall et al., 2018</xref>) and ChIP-Seq (<xref ref-type="bibr" rid="bib23">Gao et al., 2018</xref>), which give a coarse-grained view of gene essentiality and regulation respectively, another class of experiments known as massively parallel reporter assays (MPRA) have been used to study gene expression in a variety of contexts (<xref ref-type="bibr" rid="bib68">Patwardhan et al., 2009</xref>; <xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>; <xref ref-type="bibr" rid="bib80">Sharon et al., 2012</xref>; <xref ref-type="bibr" rid="bib69">Patwardhan et al., 2012</xref>; <xref ref-type="bibr" rid="bib59">Melnikov et al., 2012</xref>; <xref ref-type="bibr" rid="bib48">Kwasnieski et al., 2012</xref>; <xref ref-type="bibr" rid="bib20">Fulco et al., 2019</xref>; <xref ref-type="bibr" rid="bib45">Kinney and McCandlish, 2019</xref>). One elegant study relevant to the bacterial case of interest here by <xref ref-type="bibr" rid="bib47">Kosuri et al., 2013</xref> screened more than 10<sup>4</sup> combinations of promoter and ribosome-binding sites (RBS) to assess their impact on gene expression levels. Even more recently, the same research group has utilized MPRAs in sophisticated ways to search for regulated genes across the genome (<xref ref-type="bibr" rid="bib85">Urtecho et al., 2019</xref>; <xref ref-type="bibr" rid="bib86">Urtecho et al., 2020</xref>), in a way we see as being complementary to our own. While their approach yields a coarse-grained view of where regulation may be occurring, our approach yields a base-pair-by-base-pair view of how exactly that regulation is being enacted.</p><p>One of the most exciting X-Seq tools based on MPRAs with broad biophysical reach is the Sort-Seq approach developed by <xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>. Sort-Seq uses fluorescence activated cell sorting (FACS) based on changes in the fluorescence due to mutated promoters combined with sequencing to identify the specific locations of transcription factor binding in the genome. Importantly, it also provides a readout of how promoter sequences control the level of gene expression with single base-pair resolution. The results of such a massively parallel reporter assay make it possible to build a biophysical model of gene regulation to uncover how previously uncharacterized promoters are regulated. In particular, high-resolution studies like those described here yield quantitative predictions about promoter organization and protein-DNA interactions (<xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>). This allows us to employ the tools of statistical physics to describe the input-output properties of each of these promoters which can be explored much further with in-depth experimental dissection like those done by <xref ref-type="bibr" rid="bib72">Razo-Mejia et al., 2018</xref> and <xref ref-type="bibr" rid="bib13">Chure et al., 2019</xref> and summarized in <xref ref-type="bibr" rid="bib70">Phillips et al., 2019</xref>. In this sense, the Sort-Seq approach can provide a quantitative framework to not only discover and quantitatively dissect regulatory interactions at the promoter level, but also provides an interpretable scheme to design genetic circuits with a desired expression output (<xref ref-type="bibr" rid="bib3">Barnes et al., 2019</xref>).</p><p>Earlier work from <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref> illustrated how Sort-Seq, used in conjunction with mass spectrometry, can be used to identify which transcription factors bind to a given binding site, thus enabling the mechanistic dissection of promoters which previously had no regulatory annotation. However, a crucial drawback of the approach of <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref> is that while it is high-throughput at the level of a single gene and the number of promoter variants it accesses, it was unable to readily tackle multiple genes at once. Even in one of biology’s best understood organisms, the bacterium <italic>Escherichia coli</italic>, for more than 65% of its genes, we remain completely ignorant of how those genes are regulated (<xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>; <xref ref-type="bibr" rid="bib75">Santos-Zavaleta et al., 2019</xref>). If we hope to some day have a complete base pair resolution mapping of how genetic sequences relate to biological function, we must first be able to do so for the promoters of this 'simple' organism.</p><p>What has been missing in uncovering the regulatory genome in organisms of all kinds is a large-scale method for inferring genomic logic and regulation. Here, we replace the low-throughput, fluorescence-based Sort-Seq approach with a scalable, RNA-Seq based approach that makes it possible to attack many promoters at once. Accordingly, we refer to the entirety of our approach (MPRA, information footprints and energy matrices, and transcription factor identification) as Reg-Seq, which we employ here on over one hundred promoters. The concept of MPRA methods is to perturb promoter regions by mutating their sequences, and then to use next-generation sequencing (NGS) methods to read out how those mutations impact the expression level of each promoter (<xref ref-type="bibr" rid="bib68">Patwardhan et al., 2009</xref>; <xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>; <xref ref-type="bibr" rid="bib80">Sharon et al., 2012</xref>; <xref ref-type="bibr" rid="bib69">Patwardhan et al., 2012</xref>; <xref ref-type="bibr" rid="bib59">Melnikov et al., 2012</xref>; <xref ref-type="bibr" rid="bib48">Kwasnieski et al., 2012</xref>; <xref ref-type="bibr" rid="bib20">Fulco et al., 2019</xref>; <xref ref-type="bibr" rid="bib45">Kinney and McCandlish, 2019</xref>). We generate a broad diversity of promoter sequences for each promoter of interest and use mutual information as a metric to measure the information flow from that distribution of sequences to gene expression. Thus, Reg-Seq is able to collect causal information about candidate regulatory sequences that is then complemented by techniques such as mass spectrometry, which allows us to find which transcription factors mediate the action of those newly discovered candidate regulatory sequences. Hence, Reg-Seq solves the causal problem of linking DNA sequence to regulatory logic and information flow.</p><p>To demonstrate our ability to perform Reg-Seq at scale, we report here our results for 113 <italic>E. coli</italic> genes, whose regulatory architectures (i.e. gene-by-gene distributions of transcription-factor-binding sites and identities of the transcription factors that bind those sites) were determined in parallel for multiple different growth conditions. Although we make substantial progress in mapping the regulatory information for a swath of <italic>E. coli</italic> genes in this study (the 'regulome'), the field still remains limited in its understanding of which specific growth conditions, small molecules and metabolites (the allosterome) are responsible for altering the milieu of transcription factor activities (<xref ref-type="bibr" rid="bib53">Lindsley and Rutter, 2006</xref>; <xref ref-type="bibr" rid="bib71">Piazza et al., 2018</xref>; <xref ref-type="bibr" rid="bib34">Huang et al., 2018</xref>). We hope to address this shortcoming in future studies by appealing to recent work on solving the 'allosterome problem' (<xref ref-type="bibr" rid="bib71">Piazza et al., 2018</xref>). By taking the Sort-Seq approach from a gene-by-gene method to a larger scale, more multiplexed approach, we can begin to piece together not just how individual promoters are regulated, but also the nature of gene-gene interactions by revealing how certain transcription factors serve to regulate multiple genes at once. This approach has the benefits of a high-throughput assay without sacrificing any of the resolution afforded by the previous gene-by-gene approach, allowing us to uncover the gene regulation of over 100 operons, with base-pair resolution, in one set of experiments.</p><p>The organization of the remainder of the paper is as follows. In the Results section, we benchmark Reg-Seq against our own earlier Sort-Seq experiments to show that the use of RNA-Seq as a readout of the expression of mutated promoters is equally reliable as the fluorescence-based approach. Additionally, we provide a global view of the discoveries that were made in our exploration of more than 100 promoters in <italic>E. coli</italic> using Reg-Seq. These results are described in summary form in the paper itself, with a full online version of the results (<ext-link ext-link-type="uri" xlink:href="http://www.rpgroup.caltech.edu/RegSeq/interactive">www.rpgroup.caltech.edu/RegSeq/interactive</ext-link>) showing how different growth conditions elicit different regulatory responses. This section also follows the overarching view of our results by examining several biological stories that emerge from our data and serve as case studies in what has been revealed in our efforts to uncover the regulatory genome. The Discussion section summarizes the method and the current round of discoveries it has afforded with an eye to future applications to further elucidate the <italic>E. coli</italic> genome and open up the quantitative dissection of other non-model organisms. Lastly, in the Materials and methods section and Appendices, we describe our methodology and the false positive and false negative rates of the method.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Selection of genes and methodology</title><p>As shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>, we have explored more than 100 genes from across the <italic>E. coli</italic> genome. Our choices were based on a number of factors (see Appendix 1 Section 'Choosing target genes' for more details); namely, we wanted a subset of genes that served as a 'gold standard' for which the hard work of generations of molecular biologists have yielded deep insights into their regulation. Our set of gold standard genes is <italic>lacZYA</italic>, <italic>znuCB</italic>, <italic>znuA</italic>, <italic>ompR</italic>, <italic>araC</italic>, <italic>marR</italic>, <italic>relBE</italic>, <italic>dgoR</italic>, <italic>dicC</italic>, <italic>ftsK</italic>, <italic>xylA</italic>, <italic>xylF</italic>, <italic>rspA</italic>, <italic>dicA</italic>, and <italic>araAB</italic>. By using Reg-Seq on these genes, we were able to demonstrate that this method recovers not only what was already known about binding sites of transcription factors for well-characterized promoters (<xref ref-type="fig" rid="app2fig2">Appendix 2—figures 2</xref> and <xref ref-type="fig" rid="app2fig3">3</xref>), but also whether there are any important differences between the results of the methods presented here and the previous generation of experiments based on fluorescence and cell-sorting as a readout of gene expression (<xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>; <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>). These promoters of known regulatory architecture are complemented by an array of previously uncharacterized genes that we selected in part using data from a recent proteomic study, in which mass spectrometry was used to measure the copy number of different proteins in 22 distinct growth conditions (<xref ref-type="bibr" rid="bib76">Schmidt et al., 2016</xref>). We selected genes that exhibited a wide variation in their copy number over the different growth conditions considered, reasoning that differential expression across growth conditions implies that those genes are under regulatory control.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>The <italic>E. coli</italic> regulatory genome.</title><p>Illustration of the current ignorance with respect to how genes are regulated in <italic>E. coli</italic>. Genes with previously annotated regulation (as reported on RegulonDB [<xref ref-type="bibr" rid="bib22">Gama-Castro et al., 2016</xref>]) are denoted with blue ticks and genes with no previously annotated regulation denoted with red ticks. The 113 genes explored in this study are labeled in gray, and their precise genomic locations can be found in <xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref>.</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>Locations of TSS for all promoters in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</title><p>In <xref ref-type="fig" rid="fig1">Figure 1</xref> the locations of all promoters studied in Reg-Seq are displayed along the <italic>E. coli</italic> genome. The source data contains the exact position of the '0' position of each mutagenized promoter region.</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-55308-fig1-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig1-v2.tif"/></fig><p>As noted in the introduction, the original formulation of Reg-Seq, termed Sort-Seq, was based on the use of fluorescence activated cell sorting, one gene at a time, as a way to uncover putative binding sites for previously uncharacterized promoters (<xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>). As a result, as shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>, we have formulated a second generation version that permits a high-throughput interrogation of the genome. A comparison between the Sort-Seq and Reg-Seq approaches on the same set of genes is shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>. In the Reg-Seq approach, for each promoter interrogated, we generate a library of mutated variants and design each variant to express an mRNA with a unique sequence barcode. By counting the frequency of each expressed barcode using RNA-Seq, we can assess the differential expression from our promoter of interest based on the base-pair by base-pair sequence of its promoter. Using the mutual information between mRNA counts and sequences, we develop an information footprint that reveals the importance of different bases in the promoter region to the overall level of expression. We locate potential transcription-factor-binding regions by looking for clusters of base pairs that have a significant effect on gene expression. Further details on how potential binding sites are identified are found in the Methods Section 'Automated putative binding site algorithm' and 'Manual selection of binding sites', while determination of the false positive and false negative rates of the method can be found in Appendix 2 Section 'False positive and false negative rates'. Blue regions of the histogram shown in the information footprints of <xref ref-type="fig" rid="fig2">Figure 2</xref> correspond to hypothesized activating sequences and red regions of the histogram correspond to hypothesized repressing sequences.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Schematic of the Reg-Seq procedure as used to recover a repressor-binding site.</title><p>The process is as follows: After constructing a promoter library driving expression of a randomized barcode (an average of five barcodes for each promoter), RNA-Seq is conducted to determine the frequency of these mRNA barcodes across different growth conditions (list included in Appendix 1 Section 'Growth conditions'). By computing the mutual information between DNA sequence and mRNA barcode counts for each base pair in the promoter region, an 'information footprint' is constructed that yields a regulatory hypothesis for the putative binding sites (with the RNAP-binding region highlighted in blue and the repressor-binding site highlighted in red). Energy matrices, which describe the effect that any given mutation has on DNA-binding energy, as well as sequence logos, are inferred for the putative transcription-factor-binding sites. Next, we identify which transcription factor preferentially binds to the putative binding site via DNA-affinity chromatography followed by mass spectrometry. This procedure culminates in a coarse-grained, cartoon-level view of our regulatory hypothesis for how a given promoter is regulated.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Information footprint data displayed in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-fig2-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig2-v2.tif"/></fig><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>A summary of four direct comparisons of measurements from Sort-Seq and Reg-Seq.</title><p>We show the identified regulatory regions as well as quantitative comparisons between inferred position weight matrices. (<bold>A</bold>) CRP binds upstream of RNAP in the <italic>lacZYA</italic> promoter. Despite the different measurement techniques for the two inferred position weight matrices, the CRP-binding sites have a Pearson correlation coefficient of <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.98</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) The <italic>dgoRKADT</italic> promoter is activated by CRP in the presence of galactonate and is repressed by DgoR. For Sort-Seq and Reg-Seq, type II activator-binding sites can be identified based on the signals in the information footprint in the area indicated in green. Additionally, the quantitative agreement between the CRP position weight matrices are strong, with <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>C</bold>) The <italic>relBE</italic> promoter is repressed by RelBE as can be identified algorithmically in both Sort-Seq and Reg-Seq. The inferred logos for the two measurement methods have <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>D</bold>) The <italic>marRAB</italic> promoter is repressed by MarR. The inferred energy matrices (data not shown) and sequence logos shown have <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.78</mml:mn></mml:mrow></mml:math></inline-formula>. The right most MarR site overlaps with a ribosome-binding site. The overlap has a stronger obscuring effect on the sequence specificity of the Sort-Seq measurement, which measures protein levels directly, than it does on the output of the Reg-Seq measurement. Numeric values for the displayed data can be found in <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Data for information footprints and PWMs in <xref ref-type="fig" rid="fig3">Figure 3</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-fig3-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig3-v2.tif"/></fig><p>With the information footprint in hand, we can then determine energy matrices and sequence logos (described in the next section). Given putative binding sites, we use synthesized oligonucleotides that serve as fishing hooks to isolate the transcription factors that bind to those putative binding sites using DNA-affinity chromatography and mass spectrometry (<xref ref-type="bibr" rid="bib61">Mittler et al., 2009</xref>). Given all of this information, we can then formulate a schematized view of the newly discovered regulatory architecture of the previously uncharacterized promoter. For the case schematized in <xref ref-type="fig" rid="fig2">Figure 2</xref>, the experimental pipeline yields a complete picture of a simple repression architecture (i.e. a gene regulated by a single binding site for a repressor).</p></sec><sec id="s2-2"><title>Visual tools for data presentation</title><p>Throughout our investigation of the more than 100 genes explored in this study, we repeatedly relied on several key approaches to help make sense of the immense amount of data generated in these experiments. As these different approaches to viewing the results will appear repeatedly throughout the paper, here we familiarize the reader with five graphical representations referred to respectively as information footprints, energy matrices, sequence logos, mass spectrometry enrichment plots and regulatory cartoons, which taken together provide a quantitative description of previously uncharacterized promoters.</p><sec id="s2-2-1"><title>Information footprints</title><p>From our mutagenized libraries of promoter regions, we can build up a base-pair by base-pair graphical understanding of how the promoter sequence relates to level of gene expression in the form of the information footprint shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. In this plot, the bar above each base pair position represents how large of an effect mutations at this location have on the level of gene expression. Specifically, the quantity plotted is the mutual information <inline-formula><mml:math id="inf5"><mml:msub><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> at base pair <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> between mutation of a base pair at that position and the level of expression. In mathematical terms, the mutual information measures how much the joint probability <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> differs from the product of the probabilities <inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> which would be produced if mutation and gene expression level were independent. Formally, the mutual information between having a mutation at position <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and level of expression is given by<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note that both <italic>m</italic> and µ are binary variables that characterize the mutational state of the base of interest and the level of expression, respectively. Specifically, <italic>m</italic> can take the values<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo> <mml:mtext>is a mutated base</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo> <mml:mtext>is a wild-type base.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula>and µ can take on values<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>for sequencing reads from the DNA library</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>for sequencing reads originating from mRNA,</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula>where both <italic>m</italic> and µ are index variables that tell us whether the base has been mutated and if so, how likely that the read at that position will correspond to an mRNA, reflecting gene expression or a promoter, reflecting a member of the library. The higher the ratio of mRNA to DNA reads at a given base position, the higher the expression. <inline-formula><mml:math id="inf10"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> refers to the probability that a given sequencing read will be from a mutated base. <inline-formula><mml:math id="inf11"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a numeric value that gives the ratio of the number of DNA or mRNA sequencing counts to the total number of sequencing counts for each barcode.</p><p>Furthermore, we color the bars based on whether mutations at this location lowered gene expression on average (in blue, indicating an activating role) or increased gene expression (in red, indicating a repressing role). In this experiment, we targeted the regulatory regions based on a guess of where a transcription start site (TSS) will be, based on experimentally confirmed sites contained in RegulonDB (<xref ref-type="bibr" rid="bib75">Santos-Zavaleta et al., 2019</xref>), a 5’ RACE experiment (<xref ref-type="bibr" rid="bib60">Mendoza-Vargas et al., 2009</xref>), or by targeting small intergenic regions so as to capture all likely regulatory regions. Further details on TSS selection can be found in the Materials and methods Section 'Library design and construction'. After completing the Reg-Seq experiment, we note that many of the presumed TSS sites are not in the locations assumed, the promoters have multiple active RNA polymerase (RNAP) sites and TSS, or the primary TSS shifts with growth condition. To simplify the data presentation, the '0' base pair in all information footprints is set to the originally assumed base pair for the primary TSS, rather than one of the TSS that was found in the experiment.</p></sec><sec id="s2-2-2"><title>Energy matrices</title><p>Focusing on an individual putative transcription-factor-binding site as revealed in the information footprint, we are interested in a more fine-grained, quantitative understanding of how the underlying protein-DNA interaction is determined. An energy matrix displays this information using a heat map format, where each column is a position in the putative binding site and each row displays the effect on binding that results from mutating to that given nucleotide (given as a change in the DNA-transcription factor interaction energy upon mutation) (<xref ref-type="bibr" rid="bib6">Berg and von Hippel, 1987</xref>; <xref ref-type="bibr" rid="bib82">Stormo and Fields, 1998</xref>; <xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>). These energy matrices are scaled such that the wild type sequence is colored in white, mutations that improve binding are shown in blue, and mutations that weaken binding are shown in red. These energy matrices encode a full quantitative picture for how we expect sequence to relate to binding for a given transcription factor, such that we can provide a prediction for the binding energy of every possible binding site sequence as <disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mtext>binding energy</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>ε</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the energy matrix is predicated on an assumption of a linear binding model in which each base within the binding site region contributes a specific value (<inline-formula><mml:math id="inf12"><mml:msub><mml:mi>ε</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> for the <inline-formula><mml:math id="inf13"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> base in the sequence) to the total binding energy. Energy matrices are either given in A.U. (arbitrary units) or, for several cases where the gene has a simple repression or activation architecture with a single RNA polymerase (RNAP) site, are assigned k<sub><italic>B</italic></sub>T energy units following the procedure in <xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref> and validated on repression by <italic>lac</italic> repressor in <xref ref-type="bibr" rid="bib3">Barnes et al., 2019</xref>. The details of how and when absolute units are determined can be found in Appendix 3 Section 'Inference of scaling factors for energy matrices'.</p></sec><sec id="s2-2-3"><title>Sequence logos</title><p>From an energy matrix, we can also represent a preferred transcription-factor-binding site with the use of the letters corresponding to the four possible nucleotides, as is often done with position weight matrices (<xref ref-type="bibr" rid="bib77">Schneider and Stephens, 1990</xref>). In these sequence logos, the size of the letters corresponds to how strong the preference is for that given nucleotide at that given position, which can be directly computed from the energy matrix. This method of visualizing the information contained within the energy matrix is more easily digested and allows for quick comparison among various binding sites.</p></sec><sec id="s2-2-4"><title>Mass spectrometry enrichment plots</title><p>As the final piece of our experimental pipeline, we wish to determine the identity of the transcription factor we suspect is binding to our putative binding site that is represented in the energy matrix and sequence logo. While the details of the DNA-affinity chromatography and mass spectrometry can be found in the Materials and methods, the results of these experiments are displayed in enrichment plots such as is shown in the bottom panel of <xref ref-type="fig" rid="fig2">Figure 2</xref>. In these plots, the relative abundance of each protein bound to our site of interest is quantified relative to a scrambled control sequence. The putative transcription factor is the one we find to be highly enriched compared to all other DNA-binding proteins.</p></sec><sec id="s2-2-5"><title>Regulatory cartoons</title><p>The ultimate result of all these detailed base-pair-by-base-pair resolution experiments yields a cartoon model of how we think the given promoter is being regulated. A complete set of cartoons for all the architectures considered in our study is presented later in <xref ref-type="fig" rid="fig4">Figure 4</xref>. While the cartoon serves as a convenient, visual way to summarize our results, it is important to remember that these cartoons are a shorthand representation of all the data in the four quantitative measures described above and are, further, backed by quantitative predictions of how we expect the system to behave when tested experimentally. Throughout this paper, we use consistent iconography to illustrate the regulatory architecture of promoters with activators and their binding sites in green, repressors in red, and RNAP in blue.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>All regulatory architectures uncovered in this study.</title><p>For each regulated promoter, activators and their binding sites are labeled in green, repressors and their binding sires are labeled in red, and RNAP-binding sites are labeled in blue. All cartoons are displayed with the transcription direction to the right. Only one RNAP site is depicted per promoter. The transcription-factor-binding sites displayed have either been identified by the method described in the Section 'Automated putative binding site algorithm' or have additional evidence for their presence as described in <xref ref-type="table" rid="table2">Table 2</xref>. Binding sites found for these promoters in the EcoCyc or RegulonDB databases are only depicted in these cartoons if the sites are within the 160 bp mutagenized region studied, and are detected by Reg-Seq.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig4-v2.tif"/></fig></sec></sec><sec id="s2-3"><title>Newly discovered <italic>E. coli</italic> regulatory architectures</title><sec id="s2-3-1"><title>Elucidating individual promoters</title><p>With the tools outlined above, we are positioned to explore individual promoters, specifically those belonging to the part of the <italic>E. coli</italic> genome for which the function of the genes is unknown. Previously christened as the ‘y-ome’, <xref ref-type="bibr" rid="bib25">Ghatak et al., 2019</xref> surprisingly found that roughly 35% of the genes in <italic>E. coli</italic> lack experimental evidence of function. The situation is likely worse for other organisms. For many of the genes in the y-ome, we remain similarly ignorant of how those genes are regulated. <xref ref-type="fig" rid="fig4">Figures 4</xref> and <xref ref-type="fig" rid="fig5">5</xref> provide several examples of genes which until now had unknown regulation. As shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>, our study has found the first examples that we are aware of in the entire <italic>E. coli</italic> genome of a binding site for YciT. These examples are intended to show the outcome of the methods developed here and to serve as an invitation to browse the online resource (<ext-link ext-link-type="uri" xlink:href="https://www.rpgroup.caltech.edu/RegSeq/interactive">https://www.rpgroup.caltech.edu/RegSeq/interactive</ext-link>) where our full dataset is presented.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Examples of the insight gained by Reg-Seq in the context of promoters with no previously known regulatory information.</title><p>Activator-binding regions are highlighted in green, repressor binding regions in red, and RNAP binding regions in blue. (<bold>A</bold>) From the information footprint of the <italic>ykgE</italic> promoter under different growth conditions, we can identify a repressor-binding site downstream of the RNAP-binding site. From the enrichment of proteins bound to the DNA sequence of the putative repressor as compared to a control sequence, we can identify YieP as the transcription factor bound to this site as it has a much higher enrichment ratio than any other protein. Lastly, the binding energy matrix for the repressor site along with corresponding sequence logo shows that the wild-type sequence is the strongest possible binder and it displays an imperfect inverted repeat symmetry. (<bold>B</bold>) Illustration of a comparable dissection for the <italic>phnA</italic> promoter. Numeric values for the displayed data can be found in <xref ref-type="supplementary-material" rid="fig5sdata1">Figure 5—source data 1</xref>.</p><p><supplementary-material id="fig5sdata1"><label>Figure 5—source data 1.</label><caption><title>Data for information footprints, energy matrices, PWMs, and mass spectrometry in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-fig5-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig5-v2.tif"/></fig><p>The ability to find binding sites for both widely acting regulators and transcription factors which may have only a few sites in the whole genome allows us to get an in-depth and quantitative view of any given promoter. As indicated in <xref ref-type="fig" rid="fig5">Figure 5(A) and (B)</xref>, we were able to perform the relevant search and capture for the transcription factors that bind our putative binding sites. In both of these cases, we now hypothesize that these newly discovered binding site-transcription factor pairs exert their control through repression. The ability to extract the quantitative features of regulatory control through energy matrices means that we can take a nearly unstudied gene such as <italic>ykgE</italic>, which is regulated by an understudied transcription factor YieP, and quickly get to the point at which we can do quantitative modeling in the style that we and many others have performed on the <italic>lac</italic> operon (<xref ref-type="bibr" rid="bib88">Vilar and Leibler, 2003</xref>; <xref ref-type="bibr" rid="bib87">Vilar et al., 2003</xref>; <xref ref-type="bibr" rid="bib7">Bintu et al., 2005</xref>; <xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>; <xref ref-type="bibr" rid="bib24">Garcia and Phillips, 2011</xref>; <xref ref-type="bibr" rid="bib89">Vilar and Saiz, 2013</xref>; <xref ref-type="bibr" rid="bib3">Barnes et al., 2019</xref>; <xref ref-type="bibr" rid="bib70">Phillips et al., 2019</xref>).</p></sec><sec id="s2-3-2"><title>A panoply of promoter results</title><p><xref ref-type="fig" rid="fig6">Figure 6</xref> (and <xref ref-type="table" rid="table1">Tables 1</xref> and <xref ref-type="table" rid="table2">2</xref>) provides a summary of the discoveries made in the work done here using our next-generation Reg-Seq approach. The outcome of our study is a set of hypothesized regulatory architectures as characterized by a suite of binding sites for RNAP, repressors, and activators, as well as the extremely potent binding energy matrices. We do not assume, a priori, that a particular collection of such binding sites is AND, OR, or any other logic (<xref ref-type="bibr" rid="bib21">Galstyan et al., 2019</xref>). <xref ref-type="fig" rid="fig6">Figure 6(A)</xref> provides a shorthand notation that conveniently characterizes the different kinds of regulatory architectures found in bacteria. In this (<italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>r</italic></sub>) notation, <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>r</italic></sub> correspond to the number of recovered activator- and repressor-binding sites, respectively. In previous work (<xref ref-type="bibr" rid="bib74">Rydenfelt et al., 2014</xref>), we have explored the entirety of what is known about the regulatory genome of <italic>E. coli</italic>, revealing that the most common motif is the (0, 0) constitutive architecture, although we hypothesized that this is not a statement about the facts of the <italic>E. coli</italic> genome, but rather a reflection of our collective regulatory ignorance in the sense that we suspect that with further investigation, many of these apparent constitutive architectures will be found to be regulated under the right environmental conditions. The two most common regulatory architectures that emerged from our previous datebase survey are the (0, 1) and the (1, 0) architectures, the simple repression motif and the simple activation motif, respectively. It is interesting to consider that the (0, 1) architecture is in fact the repressor-operon model originally introduced in the early 1960s by <xref ref-type="bibr" rid="bib38">Jacob and Monod, 1961</xref> as the concept of gene regulation emerged. Now we see retrospectively the far reaching importance of that architecture across the regulatory genome.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>A summary of regulatory architectures discovered in this study.</title><p>(<bold>A</bold>) The cartoons display a representative example of each type of architecture, along with the corresponding shorthand notation. (<bold>B</bold>) Counts of the different regulatory architectures discovered in this study. We exclude the 'gold-standard' promoters (listed in <xref ref-type="table" rid="app1table1">Appendix 2—table 1</xref>) unless new transcription factors are also discovered in the promoter. If, for example, one repressor was newly discovered and two activators were previously known, then the architecture is still counted as a (2,1) architecture. (<bold>C</bold>) Distribution of positions of binding sites discovered in this study for activators and repressors. Only newly discovered binding sites are included in this figure. The position of the transcription-factor-binding sites are calculated relative to the estimated TSS location, which is based on the location of the associated RNAP site. Numeric values for the binding locations can be found in <xref ref-type="supplementary-material" rid="fig6sdata1">Figure 6—source data 1</xref>.</p><p><supplementary-material id="fig6sdata1"><label>Figure 6—source data 1.</label><caption><title>Data for binding site locations in <xref ref-type="fig" rid="fig6">Figure 6</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-fig6-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig6-v2.tif"/></fig><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>All promoters examined in this study, categorized according to type of regulatory architecture.</title><p>Those promoters which have no recognizable RNAP site are labeled as inactive rather than constitutively expressed (0, 0).</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Architecture</th><th>Total number <break/>of promoters</th><th>Number of promoters with <break/>at least one newly <break/>discovered binding site</th></tr></thead><tbody><tr><td>All Architectures</td><td>113</td><td>48</td></tr><tr><td>(0,0)</td><td>34</td><td>0</td></tr><tr><td>(0,1)</td><td>26</td><td>21</td></tr><tr><td>(1,0)</td><td>11</td><td>10</td></tr><tr><td>(1,1)</td><td>4</td><td>3</td></tr><tr><td>(0,2)</td><td>4</td><td>4</td></tr><tr><td>(2,0)</td><td>3</td><td>2</td></tr><tr><td>(1,2)</td><td>4</td><td>3</td></tr><tr><td>(2,1)</td><td>2</td><td>2</td></tr><tr><td>(2,2)</td><td>1</td><td>1</td></tr><tr><td>(3,0)</td><td>3</td><td>1</td></tr><tr><td>(0,3)</td><td>2</td><td>1</td></tr><tr><td>(0,4)</td><td>1</td><td>0</td></tr><tr><td>inactive</td><td>18</td><td>0</td></tr></tbody></table></table-wrap><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>All genes investigated in this study categorized according to their regulatory architecture, given as (number of activators, number of repressors).</title><p>The regulatory architectures as listed reflect only the binding sites that would be able to be recovered within our 160 bp constructs, but include both newly discovered and previously known binding sites. In those cases where binding sites that appear in RegulonDB or Ecocyc are omitted from this tally, the Section 'Explanation of included binding sites' in Appendix 4 has the reasoning, for each relevant gene, why the binding sites are not shown. The table also lists the number of newly discovered binding sites, previously known binding sites, and number of identified transcription factors. The evidence used for the transcription factor identification is given in the final column. 'Bioinformatic' evidence implies that discovered position weight matrices were compared to known transcription factor position weight matrices. The literature sites column contains only those sites that are both expected to be and are, in actuality, observed in the Reg-Seq data.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Architecture</th><th>Promoter</th><th>Newly discovered binding sites</th><th>Literature binding sites</th><th>Identified binding sites</th><th>Evidence</th></tr></thead><tbody><tr><td>(0, 0)</td><td><italic>acuI</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>aegA</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>arcB</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>cra</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>dnaE</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ecnB</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>fdoH</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>holC</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>hslU</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>htrB</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>minC</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>modE</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ycgB</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>mscL</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>pitA</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>poxB</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>rlmA</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>rumB</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>sbcB</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>sdaB</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>tar</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ybdG</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ybiP</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ybjT</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>yehT</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>yfhG</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ygdH</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ygeR</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>yggW</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ynaI</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>yqhC</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>zapB</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>zupT</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>amiC</italic></td><td>0</td><td>0</td><td>0</td><td/></tr><tr><td>(0, 1)</td><td><italic>araC</italic></td><td>0</td><td>1</td><td>0</td><td/></tr><tr><td/><td><italic>bdcR</italic></td><td>1</td><td>0</td><td>1</td><td>Known binding location (NsrR) (<xref ref-type="bibr" rid="bib66">Partridge et al., 2009</xref>)</td></tr><tr><td/><td><italic>coaA</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>dicC</italic></td><td>0</td><td>1</td><td>0</td><td/></tr><tr><td/><td><italic>dinJ</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ybeZ</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>idnK</italic></td><td>1</td><td>0</td><td>1</td><td>Mass- Spectrometry (YgbI)</td></tr><tr><td/><td><italic>leuABCD</italic></td><td>1</td><td>0</td><td>1</td><td>Mass- Spectrometry (YgbI)</td></tr><tr><td/><td><italic>mscM</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>yedK</italic></td><td>1</td><td>0</td><td>1</td><td>Mass- Spectrometry (TreR)</td></tr><tr><td/><td><italic>rapA</italic></td><td>1</td><td>0</td><td>1</td><td>Growth condition Knockout (GlpR), Bioinformatic (GlpR)</td></tr><tr><td/><td><italic>sdiA</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>tff-rpsB-tsf</italic></td><td>1</td><td>0</td><td>1</td><td>Growth condition Knockout (GlpR), Bioinformatic (GlpR), Knockout (GlpR)</td></tr><tr><td/><td><italic>thiM</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>tig</italic></td><td>1</td><td>0</td><td>1</td><td>Growth condition Knockout (GlpR), Bioinformatic (GlpR), Knockout (GlpR)</td></tr><tr><td/><td><italic>ybiO</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ydjA</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>yedJ</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>phnA</italic></td><td>1</td><td>0</td><td>1</td><td>Mass- Spectrometry (YciT)</td></tr><tr><td/><td><italic>mutM</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>rhlE</italic></td><td>1</td><td>0</td><td>1</td><td>Growth condition Knockout (GlpR), Bioinformatic (GlpR), Mass- Spectrometry (GlpR)</td></tr><tr><td/><td><italic>uvrD</italic></td><td>1</td><td>0</td><td>1</td><td>Bioinformatic (LexA)</td></tr><tr><td/><td><italic>dusC</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ftsK</italic></td><td>0</td><td>1</td><td>0</td><td/></tr><tr><td/><td><italic>znuA</italic></td><td>0</td><td>1</td><td>0</td><td/></tr><tr><td/><td><italic>znuCB</italic></td><td>0</td><td>1</td><td>0</td><td/></tr><tr><td>(1, 0)</td><td><italic>waaA-coaD</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>rcsF</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>groSL</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>mscS</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>thrLABC</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>yeiQ</italic></td><td>1</td><td>0</td><td>1</td><td>Growth condition Knockout (FNR), Bioinformatic (FNR)</td></tr><tr><td/><td><italic>ycbZ</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ygjP</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>lac</italic></td><td>0</td><td>1</td><td>0</td><td>Bioinformatic (CRP)</td></tr><tr><td/><td><italic>yehS</italic></td><td>1</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>yehU</italic></td><td>1</td><td>0</td><td>1</td><td>Growth condition Knockout (FNR), Bioinformatic (FNR)</td></tr><tr><td>(0, 2)</td><td><italic>pcm</italic></td><td>2</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>yecE</italic></td><td>2</td><td>0</td><td>1</td><td>Mass- Spectrometry (HU)</td></tr><tr><td/><td><italic>yjjJ</italic></td><td>2</td><td>0</td><td>1</td><td>Growth condition Knockout (MarA), Bioinformatic (MarA)</td></tr><tr><td/><td><italic>dcm</italic></td><td>2</td><td>0</td><td>1</td><td>Mass- Spectrometry (HNS)</td></tr><tr><td>(1, 1)</td><td><italic>arcA</italic></td><td>2</td><td>0</td><td>2</td><td>Growth condition Knockout (FNR), Bioinformatic (FNR), Mass- Spectrometry (FNR, CpxR)</td></tr><tr><td/><td><italic>dgoR</italic></td><td>0</td><td>2</td><td>0</td><td>Bioinformatic (CRP) Bioinformatic (DgoR)</td></tr><tr><td/><td><italic>ykgE</italic></td><td>2</td><td>0</td><td>2</td><td>Growth condition Knockout (FNR), Bioinformatic (FNR), Mass- Spectrometry(YieP) Knockout (YieP)</td></tr><tr><td/><td><italic>ymgG</italic></td><td>2</td><td>0</td><td>0</td><td/></tr><tr><td>(2, 0)</td><td><italic>asnA</italic></td><td>2</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>fdhE</italic></td><td>2</td><td>0</td><td>2</td><td>Growth condition Knockout (FNR, ArcA), Bioinformatic (FNR, ArcA), Knockout (ArcA)</td></tr><tr><td/><td><italic>xylF</italic></td><td>0</td><td>2</td><td>0</td><td/></tr><tr><td>(1, 2)</td><td><italic>marR</italic></td><td>0</td><td>3</td><td>0</td><td>Mass- Spectrometry (MarR)</td></tr><tr><td/><td><italic>aphA</italic></td><td>3</td><td>0</td><td>2</td><td>Growth condition Knockout (FNR), Bioinformatic (FNR), Mass- Spectrometry (DeoR)</td></tr><tr><td/><td><italic>iap</italic></td><td>3</td><td>0</td><td>0</td><td/></tr><tr><td/><td><italic>ilvC</italic></td><td>3</td><td>0</td><td>1</td><td>Mass- Spectrometry (IlvY) (<xref ref-type="bibr" rid="bib73">Rhee et al., 1998</xref>)</td></tr><tr><td>(2, 1)</td><td><italic>maoP</italic></td><td>3</td><td>0</td><td>3</td><td>Growth condition Knockout (GlpR), Bioinformatic (GlpR), Knockout (PhoP, HdfR, GlpR)</td></tr><tr><td/><td><italic>rspA</italic></td><td>1</td><td>2</td><td>1</td><td>Mass- Spectrometry (DeoR)</td></tr><tr><td>(2, 2)</td><td><italic>ybjX</italic></td><td>4</td><td>0</td><td>4</td><td>Bioinformatic (2 PhoP sites), Mass- Spectrometry (HNS, StpA)</td></tr><tr><td>(3, 0)</td><td><italic>araAB</italic></td><td>0</td><td>3</td><td>0</td><td/></tr><tr><td/><td><italic>xylA</italic></td><td>0</td><td>3</td><td>0</td><td/></tr><tr><td/><td><italic>yicI</italic></td><td>3</td><td>0</td><td>0</td><td/></tr><tr><td>(0, 3)</td><td><italic>ompR</italic></td><td>0</td><td>3</td><td>0</td><td/></tr><tr><td/><td><italic>ybjL</italic></td><td>3</td><td>0</td><td>0</td><td/></tr><tr><td>(0, 4)</td><td><italic>relBE</italic></td><td>0</td><td>4</td><td>0</td><td>Mass- Spectrometry (RelBE)</td></tr></tbody></table></table-wrap><p>For the 113 genes we considered, <xref ref-type="fig" rid="fig6">Figure 6(B)</xref> summarizes the number of simple repression (0, 1) architectures discovered, the number of simple activation (1, 0) architectures discovered and so on. A comparison of the frequency of the different architectures found in our study to the frequencies of all the known architectures in the RegulonDB database is provided in <xref ref-type="fig" rid="app4fig2">Appendix 4—figure 2</xref>. <xref ref-type="table" rid="table1">Tables 1</xref> and <xref ref-type="table" rid="table2">2</xref> provide a more detailed view of our results. As seen in <xref ref-type="table" rid="table1">Table 1</xref>, of the 113 genes we considered, 34 of them revealed no signature of any transcription-factor-binding sites and they are labeled as (0, 0). The simple repression architecture (0, 1) was found 26 times, the simple activation architecture (1, 0) was found 11 times, and more complex architectures featuring multiple binding sites (e.g. (1, 1), (0, 2), (2, 0), etc.) were revealed as well. Further, for 18 of the genes that we label 'inactive’, Reg-Seq did not reveal a potential RNAP-binding site. The lack of observable RNAP site could be because the proper growth condition to get high levels of expression was not used, or because the mutation window chosen for the gene does not capture a highly transcribing TSS.</p><p>The tables also include our set of 15 'gold standard' genes for which previous work has resulted in a knowledge (sometimes only partial) of their regulatory architectures. We find that our method recovers the regulatory elements of these gold standard cases fully in 11 out of 15 cases, and the majority of regulatory elements in two of the remaining cases. Overall, the performance of Reg-Seq in these gold-standard cases (for more details see <xref ref-type="fig" rid="app2fig2">Appendix 2—figures 2</xref> and <xref ref-type="fig" rid="app2fig3">3</xref>) builds confidence in the approach. Further, the failure modes inform us of the blind spots of Reg-Seq. For example, we find it challenging to observe weaker binding sites when multiple strong binding sites are also present such as in the <italic>marRAB</italic> operon. The <italic>araC</italic> case study shows that Reg-Seq does not perform well when many repressor sites regulate the promoter. Additionally the method will fail when there is no active TSS in the mutation window, as occurred in the case of <italic>dicA</italic>. Further details on the comparison to gold standard genes can be found in Appendix 2 Section 'False positive and false negative rates'.</p><p>We observe that the most common motif to emerge from our work (with the exception of constitutive expression) is the simple repression motif. Another relevant regulatory statistic is shown in <xref ref-type="fig" rid="fig6">Figure 6(C)</xref> where we see the distribution of binding site positions. Our own experience in the use of different quantitative modeling approaches to transcriptional regulation reveal that, for now, we remain largely ignorant of how to account for transcription-factor-binding site positions, and datasets like the one presented here will begin to provide data that can help us uncover how this parameter dictates gene expression. Indeed, with binding site positions and energy matrices in hand, we can systematically move these binding sites and explore the implications for the level of gene expression, providing a systematic tool to understand the role of binding-site position.</p></sec><sec id="s2-3-3"><title>Uncovering the action of global regulators</title><p>One of the revealing case studies that demonstrates the broad reach of our approach for discovering regulatory architectures is offered by the insights we have gained into two widely acting regulators, GlpR (<xref ref-type="fig" rid="fig7">Figure 7</xref>; <xref ref-type="bibr" rid="bib78">Schweizer et al., 1985</xref>) and FNR (<xref ref-type="fig" rid="fig8">Figure 8</xref>; <xref ref-type="bibr" rid="bib46">Körner et al., 2003</xref>; <xref ref-type="bibr" rid="bib41">Kargeti and Venkatesh, 2017</xref>). In both cases, we have expanded the array of promoters that they are now known to regulate. Further, these two case studies illustrate that even for widely acting transcription factors, there is a large gap in regulatory knowledge and the approach advanced here has the power to discover new regulatory motifs. The newly discovered binding sites in <xref ref-type="fig" rid="fig7">Figure 7(A)</xref>, with additional evidence for GlpR binding in <xref ref-type="fig" rid="fig7">Figure 7(B) and (C)</xref>, more than double the number of operons known to be regulated by GlpR as reported in RegulonDB (<xref ref-type="bibr" rid="bib75">Santos-Zavaleta et al., 2019</xref>). We found five newly regulated operons in our data set, even though we were not specifically targeting GlpR regulation. Although the number of example promoters across the genome that we considered is too small to make good estimates, finding five regulated operons out of approximately 100 examined operons supports the claim that GlpR widely regulates and many more of its sites would be found in a full search of the genome. The regulatory roles revealed in <xref ref-type="fig" rid="fig7">Figure 7(A)</xref> also reinforce the evidence that GlpR is a repressor.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>GlpR as a widely acting regulator.</title><p>(<bold>A</bold>) Information footprints for the promoters which we found to be regulated by GlpR, all of which were previously unknown. Activator-binding regions are highlighted in green, repressor-binding regions in red, and RNAP-binding regions in blue. (<bold>B</bold>) GlpR was demonstrated to bind to <italic>rhlE</italic> by mass spectrometry. (<bold>C</bold>) Sequence logos for GlpR-binding sites. Binding sites in the promotes of <italic>tff</italic>, <italic>tig</italic>, <italic>maoP</italic>, <italic>rhlE</italic>, and <italic>rapA</italic> have similar DNA binding preferences as seen in the sequence logos and each transcription-factor-binding site binds strongly only in the presence of glucose (As shown in (<bold>A</bold>)). These similarities suggest that the same transcription factor binds to each site. To test this hypothesis, we knocked out GlpR and ran the Reg-Seq experiments for <italic>tff</italic>, <italic>tig</italic>, and <italic>maoP</italic>. In (<bold>A</bold>), we see that knocking out GlpR removes the binding signature of the transcription factor. Numeric values for the binding locations can be found in <xref ref-type="supplementary-material" rid="fig7sdata1">Figure 7—source data 1</xref>.</p><p><supplementary-material id="fig7sdata1"><label>Figure 7—source data 1.</label><caption><title>Data for information footprints, PWMs, and mass spectrometry in <xref ref-type="fig" rid="fig7">Figure 7</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-fig7-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig7-v2.tif"/></fig><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>FNR as a global regulator.</title><p>FNR is known to be upregulated in anaerobic growth, and here we found it to regulate a suite of six genes. In aerobic growth conditions, the putative FNR sites are weakened. (<bold>A</bold>) Information footprints for the six regulated promoters. Activator binding regions are highlighted in green, repressor-binding regions in red, and RNAP binding regions in blue. (<bold>B</bold>) Sequence logos for the FNR-binding sites displayed in (<bold>A</bold>). The DNA binding preference of the six sites are shown to be similar from their sequence logos. Numeric values for the binding locations can be found in <xref ref-type="supplementary-material" rid="fig8sdata1">Figure 8—source data 1</xref>.</p><p><supplementary-material id="fig8sdata1"><label>Figure 8—source data 1.</label><caption><title>Data for information footprints and PWMs in <xref ref-type="fig" rid="fig8">Figure 8</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-fig8-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig8-v2.tif"/></fig><p>For the GlpR-regulated operons newly discovered here, we found that this repressor binds strongly in the presence of glucose while all other growth conditions result in greatly diminished, but not entirely abolished, binding (<xref ref-type="fig" rid="fig7">Figure 7(A)</xref>). As there is no previously known direct molecular interaction between GlpR and glucose and the repression is reduced but not eliminated, the derepression in the absence of glucose is likely an indirect effect. As a potential mechanism of the indirect effect, <italic>gpsA</italic> is known to be activated by CRP (<xref ref-type="bibr" rid="bib79">Seoh and Tai, 1999</xref>), and GpsA is involved in the synthesis of glycerol-3-phosphate (G3P), a known binding partner of GlpR which disables its repressive activity (<xref ref-type="bibr" rid="bib49">Larson et al., 1987</xref>). Thus, in the presence of glucose, GpsA and consequently G3P will be found at low concentrations, ultimately allowing GlpR to fulfill its role as a repressor.</p><p>Prior to this study, there were four operons known to be regulated by GlpR, each with between 4 and 8 GlpR-binding sites (<xref ref-type="bibr" rid="bib50">Larson et al., 1992</xref>; <xref ref-type="bibr" rid="bib96">Zhao et al., 1994</xref>; <xref ref-type="bibr" rid="bib93">Yang and Larson, 1996</xref>; <xref ref-type="bibr" rid="bib94">Ye and Larson, 1988</xref>; <xref ref-type="bibr" rid="bib91">Weissenborn et al., 1992</xref>), where the absence of glucose and the partial induction of GlpR was not enough to prompt a notable change in gene expression (<xref ref-type="bibr" rid="bib52">Lin, 1976</xref>). These previously explored operons seemingly are regulated as part of an AND gate. <italic>glpTQ</italic>, <italic>glpRABC</italic>, <italic>glpD</italic>, and <italic>glpFKX</italic> have high gene expression when grown in growth media that does <italic>not</italic> contain glucose but does contain contain G3P (or glycerol, which leads to high concentrations of G3P). All other combinations of growth media, such as M9 glucose with G3P, or growth in LB without G3P, lead to low gene expression (<xref ref-type="bibr" rid="bib52">Lin, 1976</xref>). In contrast, we have discovered operons whose regulation appears to be mediated by a single GlpR site per operon. With only a single site, GlpR functions as an indirect glucose sensor, as only the absence of glucose is needed to relieve repression by GlpR.</p><p>The second widely acting regulator our study revealed, FNR, has 151 binding sites already reported in RegulonDB and is well studied compared to most transcription factors (<xref ref-type="bibr" rid="bib75">Santos-Zavaleta et al., 2019</xref>). However, the newly discovered FNR sites displayed in <xref ref-type="fig" rid="fig8">Figure 8(A)</xref>, with sequence logos of the respective sites displayed in <xref ref-type="fig" rid="fig8">Figure 8(B)</xref>, demonstrate that even for well-understood transcription factors there is much still to be uncovered. Our information footprints are in agreement with previous studies suggesting that FNR acts as an activator. In the presence of O<sub>2</sub>, dimeric FNR is converted to a monomeric form and its ability to bind DNA is greatly reduced (<xref ref-type="bibr" rid="bib63">Myers et al., 2013</xref>). Only in low oxygen conditions did we observe a binding signature from FNR, and we show a representative example of the information footprint from one of 11 aerobic growth conditions in <xref ref-type="fig" rid="fig8">Figure 8(A)</xref>.</p><p>We observe quantitatively how FNR affects the expression of <italic>fdhE</italic> both directly through transcription factor binding (<xref ref-type="fig" rid="fig9">Figure 9B and C</xref>) and indirectly through increased expression of ArcA (<xref ref-type="fig" rid="fig9">Figure 9A, B, C and D</xref>). Also, fully understanding even a single operon often requires investigating several regulatory regions as we have in the case of <italic>fdoGHI-fdhE</italic> by investigating the main promoter for the operon as well as the promoter upstream of <italic>fdhE</italic>. 36% of all multi-gene operons have at least one TSS which transcribes only a subset of the genes in the operon (<xref ref-type="bibr" rid="bib15">Conway et al., 2014</xref>). Regulation within an operon is even more poorly studied than regulation in general. The main promoter for <italic>fdoGHI-fdhE</italic> has a repressor-binding site, which demonstrates that there is regulatory control of the entire operon. However, we also see in <xref ref-type="fig" rid="fig9">Figure 9(B)</xref> that there is control at the promoter level, as <italic>fdhE</italic> is regulated by both ArcA and FNR and will therefore be upregulated in anaerobic conditions (<xref ref-type="bibr" rid="bib14">Compan and Touati, 1994</xref>). The main TSS transcribes all four genes in the operon, while the secondary site shown in <xref ref-type="fig" rid="fig9">Figure 9(B)</xref> only transcribes <italic>fdhE</italic>, and therefore anaerobic conditions will change the stoichiometry of the proteins produced by the operon. By investigating over a hundred promoter regions in this experiment it becomes feasible to target multiple promoters within an operon as we have done with <italic>fdoGHI-fdhE</italic>. We can then determine under what conditions an operon is internally regulated.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Inspection of a genetic circuit.</title><p>(<bold>A</bold>) Here, the information footprint of the <italic>arcA</italic> promoter is displayed along with the energy matrix describing the discovered FNR-binding site. (<bold>B</bold>) Intra-operon regulation of <italic>fdhE</italic> by both FNR and ArcA. The information footprint of <italic>fdhE</italic> is displayed. The discovered sites for FNR and ArcA are highlighted and the energy matrix for ArcA is displayed. A TOMTOM (<xref ref-type="bibr" rid="bib29">Gupta et al., 2007</xref>) search of the binding motif found that ArcA was the most likely candidate for the transcription factor. The displayed information footprint from a knockout of ArcA demonstrates that the binding signature of the site, and its associated RNAP site, are no longer determinants of gene expression. (<bold>C</bold>) Sequence logos for FNR generated from both the sites cataloged in RegulonDB, as well as the discovered sites regulating <italic>arcA</italic> and <italic>fdhE</italic>. (<bold>D</bold>) Sequence logos for ArcA from sites contained in RegulonDB and the ArcA site regulating <italic>fdhE</italic>. Numeric values for the binding locations can be found in <xref ref-type="supplementary-material" rid="fig9sdata1">Figure 9—source data 1</xref>.</p><p><supplementary-material id="fig9sdata1"><label>Figure 9—source data 1.</label><caption><title>Data for information footprints, energy matrices, and PWMs in <xref ref-type="fig" rid="fig9">Figure 9B</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-fig9-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig9-v2.tif"/></fig></sec><sec id="s2-3-4"><title>In summary</title><p>By examining the over 100 promoters considered here, grown under 12 growth conditions, we have a total of more than 1000 information footprints and data sets. In this age of big data, methods to explore and draw insights from that data are crucial. To that end, as introduced in <xref ref-type="fig" rid="fig10">Figure 10</xref>, we have developed an online resource (see <ext-link ext-link-type="uri" xlink:href="https://www.rpgroup.caltech.edu/RegSeq/interactive">https://www.rpgroup.caltech.edu/RegSeq/interactive</ext-link>) that makes it possible for anyone who is interested to view our data and draw their own biological conclusions. Information footprints for any combination of gene and growth condition are displayed via drop down menus. Each identified transcription-factor-binding site is marked, and energy matrices for all transcription-factor-binding sites are displayed. In addition, for each gene, we feature a simple cartoon-level schematic that captures our now current, best understanding of the regulatory architecture and resulting mechanism.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Representative view of the interactive figure that is available online.</title><p>This interactive figure captures the entirety of our dataset. Each figure features a drop-down menu of genes and growth conditions. For each such gene and growth condition, there is a corresponding information footprint revealing putative binding sites, an energy matrix that shows the strength of binding of the relevant transcription factor to those binding sites and a cartoon that schematizes the newly-discovered regulatory architecture of that gene. Numeric values for the binding locations can be found in <xref ref-type="supplementary-material" rid="fig10sdata1">Figure 10—source data 1</xref>.</p><p><supplementary-material id="fig10sdata1"><label>Figure 10—source data 1.</label><caption><title>Data for information footprints, energy matrices, and PWMs in <xref ref-type="fig" rid="fig10">Figure 10</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-fig10-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig10-v2.tif"/></fig><p>The interactive figure in question was invaluable in identifying transcription factors, such as GlpR, whose binding properties vary depending on growth condition. As sigma factor availability also varies greatly depending on growth condition, studying the interactive figure identified many of the secondary RNAP sites present. The interactive figure provides a valuable resource both to those who are interested in the regulation of a particular gene and those who wish to look for patterns in gene regulation across multiple genes or across different growth conditions.</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The study of gene regulation is one of the centerpieces of modern biology. As a result, it is surprising that in the genome era, our ignorance of the regulatory landscape in even the best-understood model organisms remains so vast. Despite understanding the regulation of transcription initiation in bacterial promoters (<xref ref-type="bibr" rid="bib11">Browning and Busby, 2016</xref>), and how to tune their expression (<xref ref-type="bibr" rid="bib3">Barnes et al., 2019</xref>), we lack an experimental framework to unravel understudied promoter architectures at scale. As such, in our view, one of the grand challenges of the genome era is the need to uncover the regulatory landscape for each and every organism with a known genome sequence. Given the ability to read and write DNA sequences at will, we are convinced that to make that reading of DNA sequence truly informative about biological function and to give that writing the full power and poetry of what Crick christened 'the two great polymer languages', we need a full accounting of how the genes of a given organism are regulated and how environmental signals communicate with the transcription factors that mediate that regulation – the so-called 'allosterome' problem (<xref ref-type="bibr" rid="bib53">Lindsley and Rutter, 2006</xref>). The work presented here provides a general methodology for making progress on the former problem and also demonstrates that, by performing Reg-Seq in different growth conditions, we can make headway on the latter problem as well.</p><p>The advent of cheap DNA sequencing offers the promise of beginning to achieve this grand challenge in the form of MPRAs as reviewed in <xref ref-type="bibr" rid="bib45">Kinney and McCandlish, 2019</xref>. A particular implementation of such methods was christened Sort-Seq (<xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>) and was demonstrated in the context of well understood regulatory architectures. A second generation of the Sort-Seq method (<xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>) established a full protocol for regulatory dissection through the use of DNA-affinity chromatography and mass spectrometry which made it possible to identify the transcription factors that bind the putative binding sites discovered by Sort-Seq. However, there were critical shortcomings in the method, not least of which was that it lacked the scalability to uncover the regulatory genome in a more multiplexed manner.</p><p>The work presented here builds on the foundations laid in previous studies by invoking RNA-Seq as a readout for the level of expression of the promoter mutant libraries needed to infer information footprints and their corresponding energy matrices and sequence logos. The original inference and hypothesis generation is followed by a combination of mass spectrometry, comparison of binding motifs, and gene knockouts to identify the transcription factors that bind those sites. The case studies described in the main text showcase the ability of the Reg-Seq method to deliver on the promise of beginning to uncover the regulatory genome systematically. The extensive online resources hint at a way of systematically reporting those insights in a way that can be used by the community at large to develop regulatory intuition for biological function and to design novel regulatory architectures using energy matrices.</p><p>However, several shortcomings remain in the approach introduced here. First, the current implementation of Reg-Seq is not fully automated for various aspects in the experimental pipeline; for example, manual examination of information footprints is used to generate testable regulatory hypotheses. As the method is scaled up further, this can limit throughput of the analysis. To address this for future work, we have created an automated methodology for identifying putative binding sites, which we describe in the Materials and methods section, that will simplify future scaled up efforts at identifying putative binding sites. All putative binding sites reported in this study either were identified through the automated methodology or have additional evidence for their presence such as mass spectrometry. In addition, these regulatory hypotheses can be converted into gene regulatory models using statistical physics (<xref ref-type="bibr" rid="bib12">Buchler et al., 2003</xref>; <xref ref-type="bibr" rid="bib7">Bintu et al., 2005</xref>). However, here too, as the complexity of the regulatory architectures increases, it will be of great interest to use automated model generation as suggested in a recent biophysically based neural network approach (<xref ref-type="bibr" rid="bib84">Tareen and Kinney, 2019</xref>).</p><p>Another key challenge faced by the methods described here is that the mass spectrometry and the gene knockout confirmation aspects of the experimental pipeline remain low-throughput and, at times, inconclusive. Occasionally, we have found it challenging to observe weaker binding sites when multiple strong binding sites are also present. This was the case for the <italic>marRAB</italic> operon. To make our transcription factor identification methods more high-throughput, we have begun to explore a new generation of experiments such as in vitro binding assays that will make it possible to accomplish transcription factor identification in a multiplexed manner. Specifically, we are exploring multiplexed mass spectrometry measurements and multiplexed Reg-Seq on libraries of gene knockouts as ways to break the identification bottleneck. Transcription factor identification using Reg-Seq is also complicated by the growth conditions that we can test; for the 18 genes that we tested and labeled as 'inactive' in this study, Reg-Seq did not reveal even an RNAP-binding site, suggesting that the proper growth condition to get high levels of expression was not used, or perhaps that the mutation window chosen for the gene does not capture a highly transcribing TSS. While information on the location of a TSS is available for 2500 of 2600 operons in <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib75">Santos-Zavaleta et al., 2019</xref>), this information does not guarantee those sites will have high transcription in the growth conditions studied. Similarly, many genes have multiple TSS that can be active under different growth conditions. In these cases, we are limited both by the finite set of growth conditions we test as well as by the length of the mutation window, as it cannot always capture all TSS.</p><p>Another shortcoming of the current implementation of the method is that it misses regulatory action at a distance. Indeed, our laboratory has invested a significant effort in exploring such long-distance regulatory action in the form of DNA looping in bacteria (<xref ref-type="bibr" rid="bib39">Johnson et al., 2012</xref>; <xref ref-type="bibr" rid="bib30">Han et al., 2009</xref>) and V(D)J recombination in jawed vertebrates (<xref ref-type="bibr" rid="bib55">Lovely et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Hirokawa et al., 2020</xref>). It is well known that transcriptional control through enhancers in eukaryotic regulation is central in contexts ranging from embryonic development to hematopoiesis (<xref ref-type="bibr" rid="bib59">Melnikov et al., 2012</xref>). The current incarnation of the methods, as described here, have focused on contiguous regions in the vicinity of the transcription start site (within the 160 base pair mutagenized window). Clearly, to dissect the entire regulatory genome, these methods will have to be extended to non-contiguous regions of the genome.</p><p>Despite their limitations, the findings from this study provide a foundation for systematic, multiplexed regulatory dissections. We have developed a method to pass from complete regulatory ignorance to designable, regulatory architectures and we are hopeful that others will adopt these methods with the ambition of uncovering the regulatory architectures that preside over their organisms of interest.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>Here, we provide an overview of the key methodological aspects of Reg-Seq. Extensive details of the methods used in this study can also be found on the GitHub Wiki associated with this work.</p><sec id="s4-1"><title>Library design and construction</title><p>We selected 113 TSS from the <italic>E. coli</italic> K12 genome for experiments. The promoter regions analyzed in this study were each 160 base pairs in length, a region that includes 45 base pairs downstream and 115 base pairs upstream of each TSS. The general principles by which we selected each TSS were to first prioritize those TSS which have been extensively experimentally validated and catalogued in RegulonDB (<xref ref-type="bibr" rid="bib75">Santos-Zavaleta et al., 2019</xref>) or EcoCyc (<xref ref-type="bibr" rid="bib42">Keseler et al., 2017</xref>). Secondly, we selected those sites which had evidence of active transcription from RACE experiments (<xref ref-type="bibr" rid="bib60">Mendoza-Vargas et al., 2009</xref>) and were listed in RegulonDB. If a TSS lacked both experimental evidence and active transcription as indicated by RACE experiments, we used the computationally predicted TSS as indicated on RegulonDB (<xref ref-type="bibr" rid="bib75">Santos-Zavaleta et al., 2019</xref>) or EcoCyc (<xref ref-type="bibr" rid="bib42">Keseler et al., 2017</xref>) and determined previously by <xref ref-type="bibr" rid="bib35">Huerta and Collado-Vides, 2003</xref>. If there were multiple TSS located upstream of the gene in question, we selected the TSS closest to the gene start, unless selecting one further upstream would allow for multiple TSS to be contained in the 160 base pair mutated region analyzed for each promoter. Not all TSS locations are known, and many genes have multiple TSS. The exact start sites used, as well as the reasoning behind our selection of each TSS, are listed in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>.</p><p>Promoter variants were synthesized on a microarray (TWIST Bioscience, San Francisco, CA). The sequences were designed computationally such that each base in the 160 base pair promoter region has a 10% probability of being mutated. For each promoter’s oligonucleotide library, we ensured that the mutation rate as averaged across all sequences was kept between 9.5% and 10.5%, otherwise the library was regenerated. There are an average of 2200 unique promoter sequences per gene (for an analysis of how our results depend upon number of unique promoter sequences see <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>). The library arrived lyophilized (76 pmol) and was resuspended in 100 µL of TE (pH 8.0). Of the resuspended oligonucleotide, 1 µL was amplified for 12 cycles with New England Biolabs Q5 High-Fidelity 2x Master Mix (NEB, Ipswich, MA) to increase the quantity of DNA in the library. Unless otherwise stated, all amplifications were performed using this polymerase mixture.</p><p>The PCR product was then run on a 2% TAE agarose gel, and approximately 200 base pair amplicons were extracted using a Zymoclean Gel DNA Recovery Kit (Zymo Research, Irvine, CA). To add a random 20-nucleotide barcode to each oligonucleotide, 1 ng of the purified DNA library was amplified for 10 PCR cycles using primers containing random 20-nucleotide DNA overhangs. All primer sequences can be found in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>. After cleaning this PCR product using a Zymo Clean and Concentrator Kit (Zymo Research, Irvine, CA), the library was cloned into the plasmid backbone of pJK14 (SC101 origin) (<xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>) using Gibson Assembly. An illustration of this plasmid is displayed in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>. Genetic constructs were electroporated into <italic>E. coli</italic> K-12 MG1655 (<xref ref-type="bibr" rid="bib8">Blattner et al., 1997</xref>) and plated on LB plates with kanamycin. After 24 hr of growth on plates, libraries were scraped and inoculated into M9 media with 0.5% glucose in preparation for DNA sequencing.</p><p>All genetic barcodes were inserted 120 base pairs from the 5’ end of the mRNA, containing 45 base pairs from the targeted regulatory region, 64 base pairs containing primer sites used in the construction of the plasmid, and 11 base pairs containing a three frame stop codon. Exact sequences of primers and spacer sequences for the constructs are listed in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>. Following each genetic barcode, there is an RBS, a GFP-coding region, and a terminator.</p></sec><sec id="s4-2"><title>Preparation of libraries for sequencing</title><p>To prepare cDNA libraries for sequencing, cells were grown to an optical density of 0.3 and RNA was stabilized using Qiagen RNA Protect (Qiagen, Hilden, Germany). Lysis was performed using lysozyme (Sigma Aldrich, Saint Louis, MO) and RNA isolated using the Qiagen RNA Mini Kit. Reverse transcription was preformed using Superscript IV (Invitrogen, Carlsbad, CA) with a specific primer for the labeled mRNA. qPCR was then performed in triplicate to check the level of DNA contamination. Any sample that had contaminating DNA at a level of 5% or more of the mRNA concentration was discarded. DNA libraries were prepared by growing cells to an optical density of 0.3 and isolating plasmid DNA with a spin miniprep kit (Qiagen, Hilden, Germany).</p></sec><sec id="s4-3"><title>Sequencing</title><p>After preparing the barcoded libraries, we used next-generation sequencing (NGS) to map promoters to their respective barcodes. Sequencing libraries (both cDNA and DNA) had unindexed illumina flow cell adaptors attached via PCR, using primers that amplified a 221 base pair region that included the random barcode. We limited PCR cycles to exponential amplification, as determined by qPCR. Specifically, when we performed qPCR to check for DNA contamination, we also determined the number of cycles at which each sample reached exponential amplification, and then repeated the PCR reactions with the determined number of cycles to limit bias. After amplification, libraries were cleaned using a Zymo Clean and Concentrator kit and analyzed on an Agilent 2100 Bioanalyzer (Agilent, Santa Clara, CA). Samples were submitted to NGX Bio (NGX Bio, South Plainfield, NJ) for 150 base pair paired-end sequencing on a Hi-Seq 2500 (Illumina, San Diego, CA). We typically acquired 250 million total reads for mapping of libraries. Further details of how we process the sequences can be found in Appendix 1 Section 'Sequencing Analysis' and the GitHub Wiki associated with this work.</p><p>To quantify relative gene expression values for each promoter mutant in our library, we next grew cells expressing the DNA libraries in various growth conditions to an OD600 of 0.3. DNA and cDNA libraries were prepared in the same way as stated previously, and were sequenced at the Millard and Muriel Jacobs Genetics and Genomics Laboratory at Caltech on a HiSeq 2500 with a 100 base pair single read flow cell. An average of five unique 20 base pair barcodes per variant promoter was used for the purpose of counting transcripts. Specifically, for each promoter variant the number of sequences from the DNA library and the number of sequences produced from mRNA are determined.</p></sec><sec id="s4-4"><title>Determination of energy matrices</title><p>Energy matrices are used to represent the binding energy contribution for each nucleotide in a DNA sequence. We use relative gene expression values, as determined by counting genetic barcodes from NGS data for each mutated variant of a given regulatory sequence, and infer the energy contribution of each nucleotide by maximizing the mutual information between the rank-ordered binding strength predictions from the energy matrix and the gene expression data. We also perform this maximization using MCMC. Further discussion of how energy matrices are inferred can be found in Appendix 3 Section 'Energymatrix inference' and on the GitHub Wiki that accompanies this study.</p><p>In each energy matrix plot, a red box indicates that a mutation to a nucleotide in that position decreases the energy of transcription factor binding, while a blue box indicates that a mutation at a given nucleotide position increases transcription-factor-binding energy. Energy matrices are typically given in arbitrary units, but the method by which we can assign absolute units in <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> is covered in Appendix 3 Section 'Inference of scaling factors for energy matrices'.</p></sec><sec id="s4-5"><title>DNA-affinity chromatography and mass spectrometry</title><p>Upon identifying a putative transcription-factor-binding site, we used DNA-affinity chromatography, as performed in <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>, to isolate and enrich for the transcription factor of interest. In brief, we order biotinylated oligos of our binding site of interest (Integrated DNA Technologies, Coralville, IA) along with a control, 'scrambled' sequence, that we expect to have no specificity for the given transcription factor. We tether these oligos to magnetic streptavidin beads (Dynabeads MyOne T1; ThermoFisher, Waltham, MA), and incubate them overnight with whole cell lysate grown in the presences of either heavy (with <sup>15</sup>N) or light (with <sup>14</sup>N) lysine for the experimental and control sequences, respectively. The next day, proteins are recovered by digesting the DNA with the PtsI restriction enzyme (New England Biolabs, Ipswich, MA), whose cut site was incorporated into all designed oligos.</p><p>Protein samples were then prepared for mass spectrometry by either in-gel or in-solution digestion using the Lys-C protease (Wako Chemicals, Osaka, Japan). Liquid chromatography coupled mass spectrometry (LC-MS) was performed as previously described by <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>, and is further discussed in Appendix 3 Section 'Processing of mass spectrometry experiments'. SILAC labeling was performed by growing cells (<inline-formula><mml:math id="inf15"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> LysA) in either heavy isotope form of lysine or its natural form.</p><p>It is also important to note that while we utilized the SILAC method to identify the transcription factor identities, our approach does not require this specific technique. Specifically, our method only requires a way to contrast between the copy number of proteins bound to a target promoter in relation to a scrambled version of the promoter. In principle, one could use multiplexed proteomics based on isobaric mass tags (<xref ref-type="bibr" rid="bib65">Pappireddi et al., 2019</xref>) to characterize up to 10 promoters in parallel. Isobaric tags are reagents used to covalently modify peptides by using the heavy-isotope distribution in the tag to encode different conditions. The most widely adopted methods for isobaric tagging are the isobaric tag for relative and absolute quantitation (iTRAQ) and the tandem mass tag (TMT). This multiplexed approach involves the fragmentation of peptide ions by colliding with an inert gas. The resulting ions are resolved in a second MS-MS scan (MS2).</p><p>Only a subset (13) of all transcription factor targets were identified by mass spectrometry due to limitations in scaling the technique to large numbers of targets. The transcription factors identified by this method are enriched more than any other DNA binding protein, with p&lt;0.01 using the outlier detection method as outlined by <xref ref-type="bibr" rid="bib17">Cox and Mann, 2008</xref>, with corrections for multiple hypothesis testing using the method proposed by <xref ref-type="bibr" rid="bib5">Benjamini and Hochberg, 1995</xref>. Details on data processing can be found in Appendix 3 Section 'Processing of mass spectrometry experiments'. A detailed explanation of all experimental and computational steps can be found in the GitHub Wiki that accompanies this work.</p></sec><sec id="s4-6"><title>Construction of knockout strains</title><p>Conducting DNA-affinity chromatography followed by mass spectrometry on putative binding sites resulted in potential candidates for the transcription factors that bind to the target region. For some cases, to verify that a given transcription factor is, in fact, regulating a given promoter, we repeated the RNA sequencing experiments on strains in which the transcription factor of interest has been knocked out.</p><p>To construct the knockout strains, we ordered strains from the Keio collection (<xref ref-type="bibr" rid="bib92">Yamamoto et al., 2009</xref>) from the Coli Genetic Stock Center. These knockouts were put in a MG1655 background via phage P1 transduction and verified with Sanger sequencing. To remove the kanamycin resistance that comes with the strains from the Keio collection, we transformed in the pCP20 plasmid (<xref ref-type="bibr" rid="bib18">Datsenko and Wanner, 2000</xref>), induced FLP recombinase, and then selected for colonies that no longer grew on either kanamycin or ampicillin, verifying both loss of the chromosomally integrated kanamycin resistance and the pCP20 plasmid which confers ampicillin resistance. Finally, we transformed our desired promoter libraries into the constructed knockout strains, allowing us to perform the RNA sequencing in the same context as the original experiments.</p></sec><sec id="s4-7"><title>Automated putative binding site algorithm</title><p>We introduce a systematized way of identifying the locations of binding sites to supplement manual curation (described in the Section 'Manual selection of binding sites'). As illustrated in <xref ref-type="fig" rid="fig11">Figure 11</xref>, for a given information footprint, we average over 15 base pair 'windows'. We then determine which base pairs are part of a regulatory region by setting an information threshold of <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> bits. Threshold selection is described in Appendix 2 Section 'False positive and false negative rates'. All base pair positions that pass the information threshold were then joined into regulatory regions. We consider 'activator-like' (mutation decreases expression) and 'repressor-like' (mutation increases expression) base pairs separately. This means that it is possible to have overlapping repressor- and activator-binding sites identified. We join any base pair positions within four base pairs of each other into single regulatory regions. We then find the edges of the region by trimming off any base pairs at the edge that are below the information threshold (even if the 15 base pair average is above the threshold). While we can often resolve overlapping or nearby repressors from activators, a limitation of this method of identification is that is cannot resolve two activators or two repressors that are very close to each other or overlapping.</p><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Procedure to identify binding site regions automatically.</title><p>First, an information footprint is generated for the target region. Next, the information footprint is smoothed over a 15 base pair sliding window and a threshold of <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> bits is applied to identify regions of interest. RNAP-binding sites are first identified (in blue), and the remainder of the regulatory regions are identified as repressor-binding sites (if they tend to increase expression on mutation from wild type) or activator-binding sites (if they tend to decrease expression upon mutation).</p><p><supplementary-material id="fig11sdata1"><label>Figure 11—source data 1.</label><caption><title>Information footprint data displayed in <xref ref-type="fig" rid="fig11">Figure 11</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-fig11-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-fig11-v2.tif"/></fig><p>To identify RNAP-binding sites, we compare the sequence preference (through energy matrices and sequence logos) to experimentally validated examples of RNAP sites. We have examples of energy matrices for the <inline-formula><mml:math id="inf18"><mml:msup><mml:mi>σ</mml:mi><mml:mn>70</mml:mn></mml:msup></mml:math></inline-formula> RNAP site from <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>. For energy matrices of other <inline-formula><mml:math id="inf19"><mml:mi>σ</mml:mi></mml:math></inline-formula> factor binding sites, such as <inline-formula><mml:math id="inf20"><mml:msup><mml:mi>σ</mml:mi><mml:mn>32</mml:mn></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf21"><mml:msup><mml:mi>σ</mml:mi><mml:mn>28</mml:mn></mml:msup></mml:math></inline-formula>, we use energy matrices generated from within the Reg-Seq experiment itself. For a <inline-formula><mml:math id="inf22"><mml:msup><mml:mi>σ</mml:mi><mml:mn>32</mml:mn></mml:msup></mml:math></inline-formula> binding site, for example, we used the example from the <italic>hslU</italic> gene. For a <inline-formula><mml:math id="inf23"><mml:msup><mml:mi>σ</mml:mi><mml:mn>28</mml:mn></mml:msup></mml:math></inline-formula> binding site, we used the energy matrix generated from the <italic>dnaE</italic> gene. We 'scan' the example energy matrices across the mutated region. For each position in the region, we calculate the Pearson correlation coefficient between the example RNAP energy matrix and the inferred energy matrix at that position. We find RNAP-binding site locations by thresholding the Pearson correlation coefficients at a value of 0.45. When performing manual curation of binding sites, we visually compare the sequence logos of the example RNAP-binding sites to the sequence logos of putative binding sites. Further details of the method to create energy matrices and compare them to known motifs are given in Appendix 3 Section 'Energy matrix inference' and Appendix 3 Section 'TOMTOM motif comparison', respectively. Further, a detailed discussion of energy matrix construction is provided in the Sequencing Analysis GitHub Wiki page that accompanies this work.</p></sec><sec id="s4-8"><title>Manual selection of binding sites</title><p>Similarly to the automated method of locating putative binding regions, we look for regions of high mutual information in the information footprints. While there was no hard cut-off for mutual information values during manual curation, we select clusters of base pairs that have a similar average information value (<inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> bits) to that described in the Section 'Automated putative binding site algorithm'.</p><p>During manual curation of binding sites, we also disqualify any binding sites where there are only three or fewer base pairs with high values in the mutual information footprint. The logic behind this decision is that individual bases with very high mutual information can potentially indicate that a putative binding site is only active when a certain mutation occurs. In turn, the binding site would not be active in wild-type conditions. To explain why this is, consider that a typical binding site mutation, at any given base pair, will significantly <italic>weaken</italic> the binding site of interest. Therefore, each of those mutated base pairs is said to have a 'large effect' on expression. For a very poor binding site that is not active in the wild-type case, most mutations will further weaken a site which already will have only a minor effect on gene expression. However, for a small number of base pairs, a mutation can occur that makes the DNA bind more tightly to the transcription factor, making it relevant for gene expression. Therefore, in the case of an extremely weak binding site that is not relevant in the wild type condition, there can still be a small number of highly informative bases. Initial hypothesis generation in Reg-Seq was done manually. However, all those sites that are reported in <xref ref-type="table" rid="table2">Table 2</xref> that do not have additional validation through mass spectrometry, gene knockouts, or bioinformatics appear in the set of putative binding sites generated by the method described in Section 'Automated putative binding site algorithm'.</p></sec><sec id="s4-9"><title>Code and data availability</title><p>An in-depth discussion of all experimental protocols and mathematical analysis used in this study can be found on the GitHub Wiki for this study (<xref ref-type="bibr" rid="bib36">Ireland, 2020</xref> <ext-link ext-link-type="uri" xlink:href="https://github.com/RPGroup-PBoC/RegSeq/wiki">https://github.com/RPGroup-PBoC/RegSeq/wiki</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/RegSeq">https://github.com/elifesciences-publications/RegSeq</ext-link>). All code used for processing data and plotting as well as the final processed data, plasmid sequences, and primer sequences can also be found on the GitHub repository(archived by Zenodo; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3966687">https://doi.org/10.5281/zenodo.3966687</ext-link>). Energy matrices were generated using the MPAthic software (<xref ref-type="bibr" rid="bib37">Ireland and Kinney, 2016</xref>). All raw sequencing data is available at the Sequence Read Archive (accession no.PRJNA599253 and PRJNA603368). All inferred information footprints and energy matrices can be found on the GitHub repository (archived by Zenodo; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3966687">https://doi.org/10.5281/zenodo.3966687</ext-link>). All mass spectrometry raw data is available on the CaltechData repository (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.22002/d1.1336">https://doi.org/10.22002/d1.1336</ext-link>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We are grateful to Rachel Banks, Stephanie Barnes, Curt Callan, Griffin Chure, Ana Duarte, Vahe Galstyan, Hernan Garcia, Soichi Hirokawa, Thomas Lecuit, Heun Jin Lee, Madhav Mani, Muir Morrison, Steve Quake, Manuel Razo-Mejia, Gabe Salmon, and Guillaume Urtecho for useful discussion and feedback on the manuscript. Guillaume Urtecho and Sri Kosuri have been instrumental in providing key advice and protocols at various stages in the development of this work. We would like to thank Jost Vielmetter and Nina Budaeva for providing access to their Cell Disruptor. Brett Lomenick provided crucial help and advice with protein preparation. We also thank Igor Antoshechkin for his help with sequencing at the Caltech Genomics Facility.</p><p>Funding: We are deeply grateful for support from NIH Grants DP1 OD000217 (Director’s Pioneer Award) and 1R35 GM118043-01 (Maximizing Investigators Research Award) which made it possible to undertake this multi-year project. NMB was supported by an HHMI International Student Research Fellowship. SMB was supported by the NIH Institutional National Research Service Award (5T32GM007616-38) provided through Caltech. The Proteome Exploration Laboratory is supported by, the Beckman Institute, and NIH 1S10OD02001301.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Resources, Software, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Data curation, Software, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con7"><p>Formal analysis, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con8"><p>Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con9"><p>Software, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Resources, Supervision, Funding acquisition, Validation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>This file contains the presumed location of the TSS for each promoter region in Reg-Seq.</title><p>It additionally contains the logic behind the choice of TSS when there are multiple options.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>This file contains all primers used in the Reg-Seq experiment.</title><p>Additionally, it contains the flanking sequences of the mutated inserts and the barcodes used to label the growth conditions in the Reg-Seq experiment.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-supp2-v2.xlsx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>This file contains all transcription-factor-binding sites identified either through the automated binding site algorithm or which were identified manually and have additional evidence for binding.</title><p>The starting and ending base pairs for each binding site, and whether the transcription factor acts as an activator or repressor are listed.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-supp3-v2.xlsx"/></supplementary-material><supplementary-material id="scode1"><label>Source code 1.</label><caption><title>This file contains custom python scripts used in the processing and analysis of sequencing data.</title></caption><media mime-subtype="x-gzip" mimetype="application" xlink:href="elife-55308-code1-v2.tar.gz"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-55308-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Sequencing data has been deposited in the SRA under accession no.PRJNA599253 and PRJNA603368 Mass spectrometry data is deposited in the CalTech data repository at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.22002/d1.1336">https://doi.org/10.22002/d1.1336</ext-link> Model files and inferred information footprints are deposited in the CalTech data repository at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.22002/D1.1331">https://doi.org/10.22002/D1.1331</ext-link> Processed sequencing data sets and analysis software are available in the GitHub repository available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3953312">https://doi.org/10.5281/zenodo.3953312</ext-link>.</p><p>The following datasets were generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Ireland</surname><given-names>W</given-names></name><name><surname>Beeler</surname><given-names>S</given-names></name><name><surname>Flores-Bautista</surname><given-names>E</given-names></name><name><surname>Belliveau</surname><given-names>N</given-names></name><name><surname>Sweredoski</surname><given-names>M</given-names></name><name><surname>Moradian</surname><given-names>A</given-names></name><name><surname>Kinney</surname><given-names>J</given-names></name><name><surname>Phillips</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>RNAseq data for the Reg-Seq project</data-title><source>NCBI Sequence Read Archive</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/sra/PRJNA599253">PRJNA599253</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Ireland</surname><given-names>W</given-names></name><name><surname>Beeler</surname><given-names>S</given-names></name><name><surname>Flores-Bautista</surname><given-names>E</given-names></name><name><surname>Belliveau</surname><given-names>N</given-names></name><name><surname>Sweredoski</surname><given-names>M</given-names></name><name><surname>Moradian</surname><given-names>A</given-names></name><name><surname>Kinney</surname><given-names>J</given-names></name><name><surname>Phillips</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Mass Spectrometry data for the Reg-Seq project</data-title><source>CalTech Data</source><pub-id assigning-authority="other" pub-id-type="doi">10.22002/d1.1336</pub-id></element-citation></p><p><element-citation id="dataset3" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Ireland</surname><given-names>W</given-names></name><name><surname>Beeler</surname><given-names>S</given-names></name><name><surname>Flores-Bautista</surname><given-names>E</given-names></name><name><surname>Belliveau</surname><given-names>N</given-names></name><name><surname>Sweredoski</surname><given-names>M</given-names></name><name><surname>Moradian</surname><given-names>A</given-names></name><name><surname>Kinney</surname><given-names>J</given-names></name><name><surname>Phillips</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Sequencing Data for mapping mutated constructs</data-title><source>NCBI BioProject</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="http://www.ncbi.nlm.nih.gov/bioproject/603368">PRJNA603368</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ackers</surname> <given-names>GK</given-names></name><name><surname>Johnson</surname> <given-names>AD</given-names></name><name><surname>Shea</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Quantitative model for gene regulation by lambda phage repressor</article-title><source>PNAS</source><volume>79</volume><fpage>1129</fpage><lpage>1133</lpage><pub-id pub-id-type="doi">10.1073/pnas.79.4.1129</pub-id><pub-id pub-id-type="pmid">6461856</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arsène</surname> <given-names>F</given-names></name><name><surname>Tomoyasu</surname> <given-names>T</given-names></name><name><surname>Bukau</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The heat shock response of <italic>Escherichia coli</italic></article-title><source>International Journal of Food Microbiology</source><volume>55</volume><fpage>3</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1016/S0168-1605(00)00206-3</pub-id><pub-id pub-id-type="pmid">10791710</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barnes</surname> <given-names>SL</given-names></name><name><surname>Belliveau</surname> <given-names>NM</given-names></name><name><surname>Ireland</surname> <given-names>WT</given-names></name><name><surname>Kinney</surname> <given-names>JB</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Mapping DNA sequence to transcription factor binding energy <italic>in vivo</italic></article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1006226</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006226</pub-id><pub-id pub-id-type="pmid">30716072</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belliveau</surname> <given-names>NM</given-names></name><name><surname>Barnes</surname> <given-names>SL</given-names></name><name><surname>Ireland</surname> <given-names>WT</given-names></name><name><surname>Jones</surname> <given-names>DL</given-names></name><name><surname>Sweredoski</surname> <given-names>MJ</given-names></name><name><surname>Moradian</surname> <given-names>A</given-names></name><name><surname>Hess</surname> <given-names>S</given-names></name><name><surname>Kinney</surname> <given-names>JB</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Systematic approach for dissecting the molecular mechanisms of transcriptional regulation in Bacteria</article-title><source>PNAS</source><volume>115</volume><fpage>E4796</fpage><lpage>E4805</lpage><pub-id pub-id-type="doi">10.1073/pnas.1722055115</pub-id><pub-id pub-id-type="pmid">29728462</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname> <given-names>Y</given-names></name><name><surname>Hochberg</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title><source>Journal of the Royal Statistical Society: Series B</source><volume>57</volume><fpage>289</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1111/j.2517-6161.1995.tb02031.x</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname> <given-names>OG</given-names></name><name><surname>von Hippel</surname> <given-names>PH</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Selection of DNA binding sites by regulatory proteins. Statistical-mechanical theory and application to operators and promoters</article-title><source>Journal of Molecular Biology</source><volume>193</volume><fpage>723</fpage><lpage>750</lpage><pub-id pub-id-type="doi">10.1016/0022-2836(87)90354-8</pub-id><pub-id pub-id-type="pmid">3612791</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bintu</surname> <given-names>L</given-names></name><name><surname>Buchler</surname> <given-names>NE</given-names></name><name><surname>Garcia</surname> <given-names>HG</given-names></name><name><surname>Gerland</surname> <given-names>U</given-names></name><name><surname>Hwa</surname> <given-names>T</given-names></name><name><surname>Kondev</surname> <given-names>J</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Transcriptional regulation by the numbers: models</article-title><source>Current Opinion in Genetics &amp; Development</source><volume>15</volume><fpage>116</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.gde.2005.02.007</pub-id><pub-id pub-id-type="pmid">15797194</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blattner</surname> <given-names>FR</given-names></name><name><surname>Plunkett</surname> <given-names>G</given-names></name><name><surname>Bloch</surname> <given-names>CA</given-names></name><name><surname>Perna</surname> <given-names>NT</given-names></name><name><surname>Burland</surname> <given-names>V</given-names></name><name><surname>Riley</surname> <given-names>M</given-names></name><name><surname>Collado-Vides</surname> <given-names>J</given-names></name><name><surname>Glasner</surname> <given-names>JD</given-names></name><name><surname>Rode</surname> <given-names>CK</given-names></name><name><surname>Mayhew</surname> <given-names>GF</given-names></name><name><surname>Gregor</surname> <given-names>J</given-names></name><name><surname>Davis</surname> <given-names>NW</given-names></name><name><surname>Kirkpatrick</surname> <given-names>HA</given-names></name><name><surname>Goeden</surname> <given-names>MA</given-names></name><name><surname>Rose</surname> <given-names>DJ</given-names></name><name><surname>Mau</surname> <given-names>B</given-names></name><name><surname>Shao</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The complete genome sequence of <italic>Escherichia coli</italic> K-12</article-title><source>Science</source><volume>277</volume><fpage>1453</fpage><lpage>1462</lpage><pub-id pub-id-type="doi">10.1126/science.277.5331.1453</pub-id><pub-id pub-id-type="pmid">9278503</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bremer</surname> <given-names>H</given-names></name><name><surname>Dennis</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1996">1996</year><chapter-title>Modulation of chemical composition and other parameters of the cell by growth rate</chapter-title><person-group person-group-type="editor"><name><surname>Neidhardt</surname> <given-names>F. C</given-names></name></person-group><source>Escherichia coli and Salmonella Typhimurium: Cellular and Molecular Biology</source><publisher-name>Merck KGaA</publisher-name><fpage>1</fpage><lpage>3000</lpage></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brewster</surname> <given-names>RC</given-names></name><name><surname>Jones</surname> <given-names>DL</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Tuning promoter strength through RNA polymerase binding site design in <italic>Escherichia coli</italic></article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002811</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002811</pub-id><pub-id pub-id-type="pmid">23271961</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname> <given-names>DF</given-names></name><name><surname>Busby</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Local and global regulation of transcription initiation in Bacteria</article-title><source>Nature Reviews Microbiology</source><volume>14</volume><fpage>638</fpage><lpage>650</lpage><pub-id pub-id-type="doi">10.1038/nrmicro.2016.103</pub-id><pub-id pub-id-type="pmid">27498839</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchler</surname> <given-names>NE</given-names></name><name><surname>Gerland</surname> <given-names>U</given-names></name><name><surname>Hwa</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>On schemes of combinatorial transcription logic</article-title><source>PNAS</source><volume>100</volume><fpage>5136</fpage><lpage>5141</lpage><pub-id pub-id-type="doi">10.1073/pnas.0930314100</pub-id><pub-id pub-id-type="pmid">12702751</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chure</surname> <given-names>G</given-names></name><name><surname>Razo-Mejia</surname> <given-names>M</given-names></name><name><surname>Belliveau</surname> <given-names>NM</given-names></name><name><surname>Einav</surname> <given-names>T</given-names></name><name><surname>Kaczmarek</surname> <given-names>ZA</given-names></name><name><surname>Barnes</surname> <given-names>SL</given-names></name><name><surname>Lewis</surname> <given-names>M</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Predictive shifts in free energy couple mutations to their phenotypic consequences</article-title><source>PNAS</source><volume>116</volume><fpage>18275</fpage><lpage>18284</lpage><pub-id pub-id-type="doi">10.1073/pnas.1907869116</pub-id><pub-id pub-id-type="pmid">31451655</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Compan</surname> <given-names>I</given-names></name><name><surname>Touati</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Anaerobic activation of <italic>arcA</italic> transcription in <italic>Escherichia coli</italic>: roles of fnr and <italic>ArcA</italic></article-title><source>Molecular Microbiology</source><volume>11</volume><fpage>955</fpage><lpage>964</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2958.1994.tb00374.x</pub-id><pub-id pub-id-type="pmid">8022271</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conway</surname> <given-names>T</given-names></name><name><surname>Creecy</surname> <given-names>JP</given-names></name><name><surname>Maddox</surname> <given-names>SM</given-names></name><name><surname>Grissom</surname> <given-names>JE</given-names></name><name><surname>Conkle</surname> <given-names>TL</given-names></name><name><surname>Shadid</surname> <given-names>TM</given-names></name><name><surname>Teramoto</surname> <given-names>J</given-names></name><name><surname>San Miguel</surname> <given-names>P</given-names></name><name><surname>Shimada</surname> <given-names>T</given-names></name><name><surname>Ishihama</surname> <given-names>A</given-names></name><name><surname>Mori</surname> <given-names>H</given-names></name><name><surname>Wanner</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Unprecedented high-resolution view of bacterial operon architecture revealed by RNA sequencing</article-title><source>mBio</source><volume>5</volume><elocation-id>e01442-14</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.01442-14</pub-id><pub-id pub-id-type="pmid">25006232</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cox</surname> <given-names>J</given-names></name><name><surname>Matic</surname> <given-names>I</given-names></name><name><surname>Hilger</surname> <given-names>M</given-names></name><name><surname>Nagaraj</surname> <given-names>N</given-names></name><name><surname>Selbach</surname> <given-names>M</given-names></name><name><surname>Olsen</surname> <given-names>JV</given-names></name><name><surname>Mann</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A practical guide to the MaxQuant computational platform for SILAC-based quantitative proteomics</article-title><source>Nature Protocols</source><volume>4</volume><fpage>698</fpage><lpage>705</lpage><pub-id pub-id-type="doi">10.1038/nprot.2009.36</pub-id><pub-id pub-id-type="pmid">19373234</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cox</surname> <given-names>J</given-names></name><name><surname>Mann</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>MaxQuant enables high peptide identification rates, individualized p.p.b.-range mass accuracies and proteome-wide protein quantification</article-title><source>Nature Biotechnology</source><volume>26</volume><fpage>1367</fpage><lpage>1372</lpage><pub-id pub-id-type="doi">10.1038/nbt.1511</pub-id><pub-id pub-id-type="pmid">19029910</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Datsenko</surname> <given-names>KA</given-names></name><name><surname>Wanner</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>One-step inactivation of chromosomal genes in <italic>Escherichia coli</italic> K-12 using PCR products</article-title><source>PNAS</source><volume>97</volume><fpage>6640</fpage><lpage>6645</lpage><pub-id pub-id-type="doi">10.1073/pnas.120163297</pub-id><pub-id pub-id-type="pmid">10829079</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Forcier</surname> <given-names>TL</given-names></name><name><surname>Ayaz</surname> <given-names>A</given-names></name><name><surname>Gill</surname> <given-names>MS</given-names></name><name><surname>Jones</surname> <given-names>D</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name><name><surname>Kinney</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Measuring cis-regulatory energetics in living cells using allelic manifolds</article-title><source>eLife</source><volume>7</volume><elocation-id>e40618</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.40618</pub-id><pub-id pub-id-type="pmid">30570483</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fulco</surname> <given-names>CP</given-names></name><name><surname>Nasser</surname> <given-names>J</given-names></name><name><surname>Jones</surname> <given-names>TR</given-names></name><name><surname>Munson</surname> <given-names>G</given-names></name><name><surname>Bergman</surname> <given-names>DT</given-names></name><name><surname>Subramanian</surname> <given-names>V</given-names></name><name><surname>Grossman</surname> <given-names>SR</given-names></name><name><surname>Anyoha</surname> <given-names>R</given-names></name><name><surname>Doughty</surname> <given-names>BR</given-names></name><name><surname>Patwardhan</surname> <given-names>TA</given-names></name><name><surname>Nguyen</surname> <given-names>TH</given-names></name><name><surname>Kane</surname> <given-names>M</given-names></name><name><surname>Perez</surname> <given-names>EM</given-names></name><name><surname>Durand</surname> <given-names>NC</given-names></name><name><surname>Lareau</surname> <given-names>CA</given-names></name><name><surname>Stamenova</surname> <given-names>EK</given-names></name><name><surname>Aiden</surname> <given-names>EL</given-names></name><name><surname>Lander</surname> <given-names>ES</given-names></name><name><surname>Engreitz</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Activity-by-contact model of enhancer-promoter regulation from thousands of CRISPR perturbations</article-title><source>Nature Genetics</source><volume>51</volume><fpage>1664</fpage><lpage>1669</lpage><pub-id pub-id-type="doi">10.1038/s41588-019-0538-0</pub-id><pub-id pub-id-type="pmid">31784727</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galstyan</surname> <given-names>V</given-names></name><name><surname>Funk</surname> <given-names>L</given-names></name><name><surname>Einav</surname> <given-names>T</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Combinatorial control through allostery</article-title><source>The Journal of Physical Chemistry B</source><volume>123</volume><fpage>2792</fpage><lpage>2800</lpage><pub-id pub-id-type="doi">10.1021/acs.jpcb.8b12517</pub-id><pub-id pub-id-type="pmid">30768906</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gama-Castro</surname> <given-names>S</given-names></name><name><surname>Salgado</surname> <given-names>H</given-names></name><name><surname>Santos-Zavaleta</surname> <given-names>A</given-names></name><name><surname>Ledezma-Tejeida</surname> <given-names>D</given-names></name><name><surname>Muñiz-Rascado</surname> <given-names>L</given-names></name><name><surname>García-Sotelo</surname> <given-names>JS</given-names></name><name><surname>Alquicira-Hernández</surname> <given-names>K</given-names></name><name><surname>Martínez-Flores</surname> <given-names>I</given-names></name><name><surname>Pannier</surname> <given-names>L</given-names></name><name><surname>Castro-Mondragón</surname> <given-names>JA</given-names></name><name><surname>Medina-Rivera</surname> <given-names>A</given-names></name><name><surname>Solano-Lira</surname> <given-names>H</given-names></name><name><surname>Bonavides-Martínez</surname> <given-names>C</given-names></name><name><surname>Pérez-Rueda</surname> <given-names>E</given-names></name><name><surname>Alquicira-Hernández</surname> <given-names>S</given-names></name><name><surname>Porrón-Sotelo</surname> <given-names>L</given-names></name><name><surname>López-Fuentes</surname> <given-names>A</given-names></name><name><surname>Hernández-Koutoucheva</surname> <given-names>A</given-names></name><name><surname>Del Moral-Chávez</surname> <given-names>V</given-names></name><name><surname>Rinaldi</surname> <given-names>F</given-names></name><name><surname>Collado-Vides</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>RegulonDB version 9.0: high-level integration of gene regulation, coexpression, motif clustering and beyond</article-title><source>Nucleic Acids Research</source><volume>44</volume><fpage>D133</fpage><lpage>D143</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv1156</pub-id><pub-id pub-id-type="pmid">26527724</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname> <given-names>Y</given-names></name><name><surname>Yurkovich</surname> <given-names>JT</given-names></name><name><surname>Seo</surname> <given-names>SW</given-names></name><name><surname>Kabimoldayev</surname> <given-names>I</given-names></name><name><surname>Dräger</surname> <given-names>A</given-names></name><name><surname>Chen</surname> <given-names>K</given-names></name><name><surname>Sastry</surname> <given-names>AV</given-names></name><name><surname>Fang</surname> <given-names>X</given-names></name><name><surname>Mih</surname> <given-names>N</given-names></name><name><surname>Yang</surname> <given-names>L</given-names></name><name><surname>Eichner</surname> <given-names>J</given-names></name><name><surname>Cho</surname> <given-names>B-K</given-names></name><name><surname>Kim</surname> <given-names>D</given-names></name><name><surname>Palsson</surname> <given-names>BO</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Systematic discovery of uncharacterized transcription factors in <italic>Escherichia coli</italic> K-12 MG1655</article-title><source>Nucleic Acids Research</source><volume>8</volume><fpage>10682</fpage><lpage>10696</lpage><pub-id pub-id-type="doi">10.1093/nar/gky752</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia</surname> <given-names>HG</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Quantitative dissection of the simple repression input-output function</article-title><source>PNAS</source><volume>108</volume><fpage>12173</fpage><lpage>12178</lpage><pub-id pub-id-type="doi">10.1073/pnas.1015616108</pub-id><pub-id pub-id-type="pmid">21730194</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghatak</surname> <given-names>S</given-names></name><name><surname>King</surname> <given-names>ZA</given-names></name><name><surname>Sastry</surname> <given-names>A</given-names></name><name><surname>Palsson</surname> <given-names>BO</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The y-ome defines the 35% of <italic>Escherichia coli</italic> genes that lack experimental evidence of function</article-title><source>Nucleic Acids Research</source><volume>47</volume><fpage>2446</fpage><lpage>2454</lpage><pub-id pub-id-type="doi">10.1093/nar/gkz030</pub-id><pub-id pub-id-type="pmid">30698741</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodall</surname> <given-names>ECA</given-names></name><name><surname>Robinson</surname> <given-names>A</given-names></name><name><surname>Johnston</surname> <given-names>IG</given-names></name><name><surname>Jabbari</surname> <given-names>S</given-names></name><name><surname>Turner</surname> <given-names>KA</given-names></name><name><surname>Cunningham</surname> <given-names>AF</given-names></name><name><surname>Lund</surname> <given-names>PA</given-names></name><name><surname>Cole</surname> <given-names>JA</given-names></name><name><surname>Henderson</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The essential genome of <italic>Escherichia coli</italic> K-12</article-title><source>mBio</source><volume>9</volume><elocation-id>e02096-17</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.02096-17</pub-id><pub-id pub-id-type="pmid">29463657</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodman</surname> <given-names>J</given-names></name><name><surname>Weare</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Ensemble samplers with affine invariance</article-title><source>Communications in Applied Mathematics and Computational Science</source><volume>5</volume><fpage>65</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.2140/camcos.2010.5.65</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grass</surname> <given-names>G</given-names></name><name><surname>Franke</surname> <given-names>S</given-names></name><name><surname>Taudte</surname> <given-names>N</given-names></name><name><surname>Nies</surname> <given-names>DH</given-names></name><name><surname>Kucharski</surname> <given-names>LM</given-names></name><name><surname>Maguire</surname> <given-names>ME</given-names></name><name><surname>Rensing</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The metal permease ZupT from <italic>Escherichia coli</italic> is a transporter with a broad substrate spectrum</article-title><source>Journal of Bacteriology</source><volume>187</volume><fpage>1604</fpage><lpage>1611</lpage><pub-id pub-id-type="doi">10.1128/JB.187.5.1604-1611.2005</pub-id><pub-id pub-id-type="pmid">15716430</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname> <given-names>S</given-names></name><name><surname>Stamatoyannopoulos</surname> <given-names>JA</given-names></name><name><surname>Bailey</surname> <given-names>TL</given-names></name><name><surname>Noble</surname> <given-names>WS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Quantifying similarity between motifs</article-title><source>Genome Biology</source><volume>8</volume><elocation-id>R24</elocation-id><pub-id pub-id-type="doi">10.1186/gb-2007-8-2-r24</pub-id><pub-id pub-id-type="pmid">17324271</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname> <given-names>L</given-names></name><name><surname>Garcia</surname> <given-names>HG</given-names></name><name><surname>Blumberg</surname> <given-names>S</given-names></name><name><surname>Towles</surname> <given-names>KB</given-names></name><name><surname>Beausang</surname> <given-names>JF</given-names></name><name><surname>Nelson</surname> <given-names>PC</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Concentration and length dependence of DNA looping in transcriptional regulation</article-title><source>PLOS ONE</source><volume>4</volume><elocation-id>e5621</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0005621</pub-id><pub-id pub-id-type="pmid">19479049</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Hannon</surname> <given-names>GJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><source>FASTX-Toolkit</source><version designator="0.0.13">0.0.13</version><ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit/">http://hannonlab.cshl.edu/fastx_toolkit/</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hastie</surname> <given-names>T</given-names></name><name><surname>Tibshirani</surname> <given-names>R</given-names></name><name><surname>Friedman</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><source>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</source><publisher-name>Springer Science &amp; Business Media</publisher-name><pub-id pub-id-type="doi">10.1007/978-0-387-84858-7</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hirokawa</surname> <given-names>S</given-names></name><name><surname>Chure</surname> <given-names>G</given-names></name><name><surname>Belliveau</surname> <given-names>NM</given-names></name><name><surname>Lovely</surname> <given-names>GA</given-names></name><name><surname>Anaya</surname> <given-names>M</given-names></name><name><surname>Schatz</surname> <given-names>DG</given-names></name><name><surname>Baltimore</surname> <given-names>D</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Sequence-dependent dynamics of synthetic and endogenous RSSs in V(D)J recombination</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>6726</fpage><lpage>6739</lpage><pub-id pub-id-type="doi">10.1093/nar/gkaa418</pub-id><pub-id pub-id-type="pmid">32449932</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname> <given-names>M</given-names></name><name><surname>Song</surname> <given-names>K</given-names></name><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Lu</surname> <given-names>S</given-names></name><name><surname>Shen</surname> <given-names>Q</given-names></name><name><surname>Wang</surname> <given-names>R</given-names></name><name><surname>Gao</surname> <given-names>J</given-names></name><name><surname>Hong</surname> <given-names>Y</given-names></name><name><surname>Li</surname> <given-names>Q</given-names></name><name><surname>Ni</surname> <given-names>D</given-names></name><name><surname>Xu</surname> <given-names>J</given-names></name><name><surname>Chen</surname> <given-names>G</given-names></name><name><surname>Zhang</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>AlloFinder: a strategy for allosteric modulator discovery and allosterome analyses</article-title><source>Nucleic Acids Research</source><volume>46</volume><fpage>W451</fpage><lpage>W458</lpage><pub-id pub-id-type="doi">10.1093/nar/gky374</pub-id><pub-id pub-id-type="pmid">29757429</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta</surname> <given-names>AM</given-names></name><name><surname>Collado-Vides</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Sigma70 promoters in <italic>Escherichia coli</italic>: specific transcription in dense regions of overlapping promoter-like signals</article-title><source>Journal of Molecular Biology</source><volume>333</volume><fpage>261</fpage><lpage>278</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2003.07.017</pub-id><pub-id pub-id-type="pmid">14529615</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Ireland</surname> <given-names>WT</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>RegSeq</data-title><source>GitHub</source><version designator="d1df872">d1df872</version><ext-link ext-link-type="uri" xlink:href="https://github.com/RPGroup-PBoC/RegSeq">https://github.com/RPGroup-PBoC/RegSeq</ext-link></element-citation></ref><ref id="bib37"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ireland</surname> <given-names>WT</given-names></name><name><surname>Kinney</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>MPAthic: quantitative modeling of Sequence-Function relationships for massively parallel assays</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/054676</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Jacob</surname> <given-names>F</given-names></name><name><surname>Monod</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1961">1961</year><article-title>On the regulation of gene activity</article-title><conf-name>Cold Spring Harbor Symposia on Quantitative Biology</conf-name><fpage>193</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1101/SQB.1961.026.01.024</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname> <given-names>S</given-names></name><name><surname>Lindén</surname> <given-names>M</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Sequence dependence of transcription factor-mediated DNA looping</article-title><source>Nucleic Acids Research</source><volume>40</volume><fpage>7728</fpage><lpage>7738</lpage><pub-id pub-id-type="doi">10.1093/nar/gks473</pub-id><pub-id pub-id-type="pmid">22718983</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname> <given-names>CM</given-names></name><name><surname>Schleif</surname> <given-names>RF</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>In vivo induction kinetics of the arabinose promoters in <italic>Escherichia coli</italic></article-title><source>Journal of Bacteriology</source><volume>177</volume><fpage>3438</fpage><lpage>3442</lpage><pub-id pub-id-type="doi">10.1128/JB.177.12.3438-3442.1995</pub-id><pub-id pub-id-type="pmid">7768852</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kargeti</surname> <given-names>M</given-names></name><name><surname>Venkatesh</surname> <given-names>KV</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The effect of global transcriptional regulators on the anaerobic fermentative metabolism of <italic>Escherichia coli</italic></article-title><source>Molecular BioSystems</source><volume>13</volume><fpage>1388</fpage><lpage>1398</lpage><pub-id pub-id-type="doi">10.1039/C6MB00721J</pub-id><pub-id pub-id-type="pmid">28573283</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keseler</surname> <given-names>IM</given-names></name><name><surname>Mackie</surname> <given-names>A</given-names></name><name><surname>Santos-Zavaleta</surname> <given-names>A</given-names></name><name><surname>Billington</surname> <given-names>R</given-names></name><name><surname>Bonavides-Martínez</surname> <given-names>C</given-names></name><name><surname>Caspi</surname> <given-names>R</given-names></name><name><surname>Fulcher</surname> <given-names>C</given-names></name><name><surname>Gama-Castro</surname> <given-names>S</given-names></name><name><surname>Kothari</surname> <given-names>A</given-names></name><name><surname>Krummenacker</surname> <given-names>M</given-names></name><name><surname>Latendresse</surname> <given-names>M</given-names></name><name><surname>Muñiz-Rascado</surname> <given-names>L</given-names></name><name><surname>Ong</surname> <given-names>Q</given-names></name><name><surname>Paley</surname> <given-names>S</given-names></name><name><surname>Peralta-Gil</surname> <given-names>M</given-names></name><name><surname>Subhraveti</surname> <given-names>P</given-names></name><name><surname>Velázquez-Ramírez</surname> <given-names>DA</given-names></name><name><surname>Weaver</surname> <given-names>D</given-names></name><name><surname>Collado-Vides</surname> <given-names>J</given-names></name><name><surname>Paulsen</surname> <given-names>I</given-names></name><name><surname>Karp</surname> <given-names>PD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The EcoCyc database: reflecting new knowledge about <italic>Escherichia coli</italic> K-12</article-title><source>Nucleic Acids Research</source><volume>45</volume><fpage>D543</fpage><lpage>D550</lpage><pub-id pub-id-type="doi">10.1093/nar/gkw1003</pub-id><pub-id pub-id-type="pmid">27899573</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinney</surname> <given-names>JB</given-names></name><name><surname>Murugan</surname> <given-names>A</given-names></name><name><surname>Callan</surname> <given-names>CG</given-names></name><name><surname>Cox</surname> <given-names>EC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Using deep sequencing to characterize the biophysical mechanism of a transcriptional regulatory sequence</article-title><source>PNAS</source><volume>107</volume><fpage>9158</fpage><lpage>9163</lpage><pub-id pub-id-type="doi">10.1073/pnas.1004290107</pub-id><pub-id pub-id-type="pmid">20439748</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinney</surname> <given-names>JB</given-names></name><name><surname>Atwal</surname> <given-names>GS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Parametric inference in the large data limit using maximally informative models</article-title><source>Neural Computation</source><volume>26</volume><fpage>637</fpage><lpage>653</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00568</pub-id><pub-id pub-id-type="pmid">24479782</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinney</surname> <given-names>JB</given-names></name><name><surname>McCandlish</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Massively parallel assays and quantitative Sequence-Function relationships</article-title><source>Annual Review of Genomics and Human Genetics</source><volume>20</volume><fpage>99</fpage><lpage>127</lpage><pub-id pub-id-type="doi">10.1146/annurev-genom-083118-014845</pub-id><pub-id pub-id-type="pmid">31091417</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körner</surname> <given-names>H</given-names></name><name><surname>Sofia</surname> <given-names>HJ</given-names></name><name><surname>Zumft</surname> <given-names>WG</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Phylogeny of the bacterial superfamily of Crp-Fnr transcription regulators: exploiting the metabolic spectrum by controlling alternative gene programs</article-title><source>FEMS Microbiology Reviews</source><volume>27</volume><fpage>559</fpage><lpage>592</lpage><pub-id pub-id-type="doi">10.1016/S0168-6445(03)00066-4</pub-id><pub-id pub-id-type="pmid">14638413</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kosuri</surname> <given-names>S</given-names></name><name><surname>Goodman</surname> <given-names>DB</given-names></name><name><surname>Cambray</surname> <given-names>G</given-names></name><name><surname>Mutalik</surname> <given-names>VK</given-names></name><name><surname>Gao</surname> <given-names>Y</given-names></name><name><surname>Arkin</surname> <given-names>AP</given-names></name><name><surname>Endy</surname> <given-names>D</given-names></name><name><surname>Church</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Composability of regulatory sequences controlling transcription and translation in <italic>Escherichia coli</italic></article-title><source>PNAS</source><volume>110</volume><fpage>14024</fpage><lpage>14029</lpage><pub-id pub-id-type="doi">10.1073/pnas.1301301110</pub-id><pub-id pub-id-type="pmid">23924614</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kwasnieski</surname> <given-names>JC</given-names></name><name><surname>Mogno</surname> <given-names>I</given-names></name><name><surname>Myers</surname> <given-names>CA</given-names></name><name><surname>Corbo</surname> <given-names>JC</given-names></name><name><surname>Cohen</surname> <given-names>BA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Complex effects of nucleotide variants in a mammalian cis-regulatory element</article-title><source>PNAS</source><volume>109</volume><fpage>19498</fpage><lpage>19503</lpage><pub-id pub-id-type="doi">10.1073/pnas.1210678109</pub-id><pub-id pub-id-type="pmid">23129659</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larson</surname> <given-names>TJ</given-names></name><name><surname>Ye</surname> <given-names>SZ</given-names></name><name><surname>Weissenborn</surname> <given-names>DL</given-names></name><name><surname>Hoffmann</surname> <given-names>HJ</given-names></name><name><surname>Schweizer</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Purification and characterization of the repressor for the <italic>sn</italic>-glycerol 3-phosphate regulon of <italic>Escherichia coli</italic> K12</article-title><source>The Journal of Biological Chemistry</source><volume>262</volume><fpage>15869</fpage><lpage>15874</lpage><pub-id pub-id-type="pmid">3316209</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larson</surname> <given-names>TJ</given-names></name><name><surname>Cantwell</surname> <given-names>JS</given-names></name><name><surname>van Loo-Bhattacharya</surname> <given-names>AT</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Interaction at a distance between multiple operators controls the adjacent, divergently transcribed glpTQ-glpACB operons of <italic>Escherichia coli</italic> K-12</article-title><source>The Journal of Biological Chemistry</source><volume>267</volume><fpage>6114</fpage><lpage>6121</lpage><pub-id pub-id-type="pmid">1556120</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>GY</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Inouye</surname> <given-names>M</given-names></name><name><surname>Ikura</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Structural mechanism of transcriptional autorepression of the <italic>Escherichia coli</italic> RelB/RelE antitoxin/Toxin module</article-title><source>Journal of Molecular Biology</source><volume>380</volume><fpage>107</fpage><lpage>119</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2008.04.039</pub-id><pub-id pub-id-type="pmid">18501926</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname> <given-names>EC</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Glycerol dissimilation and its regulation in Bacteria</article-title><source>Annual Review of Microbiology</source><volume>30</volume><fpage>535</fpage><lpage>578</lpage><pub-id pub-id-type="doi">10.1146/annurev.mi.30.100176.002535</pub-id><pub-id pub-id-type="pmid">825019</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindsley</surname> <given-names>JE</given-names></name><name><surname>Rutter</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Whence cometh the allosterome?</article-title><source>PNAS</source><volume>103</volume><fpage>10533</fpage><lpage>10535</lpage><pub-id pub-id-type="doi">10.1073/pnas.0604452103</pub-id><pub-id pub-id-type="pmid">16818878</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lister</surname> <given-names>R</given-names></name><name><surname>O'Malley</surname> <given-names>RC</given-names></name><name><surname>Tonti-Filippini</surname> <given-names>J</given-names></name><name><surname>Gregory</surname> <given-names>BD</given-names></name><name><surname>Berry</surname> <given-names>CC</given-names></name><name><surname>Millar</surname> <given-names>AH</given-names></name><name><surname>Ecker</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Highly integrated single-base resolution maps of the epigenome in <italic>Arabidopsis</italic></article-title><source>Cell</source><volume>133</volume><fpage>523</fpage><lpage>536</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2008.03.029</pub-id><pub-id pub-id-type="pmid">18423832</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lovely</surname> <given-names>GA</given-names></name><name><surname>Brewster</surname> <given-names>RC</given-names></name><name><surname>Schatz</surname> <given-names>DG</given-names></name><name><surname>Baltimore</surname> <given-names>D</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Single-molecule analysis of RAG-mediated V(D)J DNA cleavage</article-title><source>PNAS</source><volume>112</volume><fpage>E1715</fpage><lpage>E1723</lpage><pub-id pub-id-type="doi">10.1073/pnas.1503477112</pub-id><pub-id pub-id-type="pmid">25831509</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lutkenhaus</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Assembly dynamics of the bacterial MinCDE system and spatial regulation of the Z ring</article-title><source>Annual Review of Biochemistry</source><volume>76</volume><fpage>539</fpage><lpage>562</lpage><pub-id pub-id-type="doi">10.1146/annurev.biochem.75.103004.142652</pub-id><pub-id pub-id-type="pmid">17328675</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lutz</surname> <given-names>R</given-names></name><name><surname>Bujard</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Independent and tight regulation of transcriptional units in <italic>Escherichia coli</italic> via the LacR/O, the TetR/O and AraC/I1-I2 regulatory elements</article-title><source>Nucleic Acids Research</source><volume>25</volume><fpage>1203</fpage><lpage>1210</lpage><pub-id pub-id-type="doi">10.1093/nar/25.6.1203</pub-id><pub-id pub-id-type="pmid">9092630</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magoč</surname> <given-names>T</given-names></name><name><surname>Salzberg</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>FLASH: fast length adjustment of short reads to improve genome assemblies</article-title><source>Bioinformatics</source><volume>27</volume><fpage>2957</fpage><lpage>2963</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr507</pub-id><pub-id pub-id-type="pmid">21903629</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Melnikov</surname> <given-names>A</given-names></name><name><surname>Murugan</surname> <given-names>A</given-names></name><name><surname>Zhang</surname> <given-names>X</given-names></name><name><surname>Tesileanu</surname> <given-names>T</given-names></name><name><surname>Wang</surname> <given-names>L</given-names></name><name><surname>Rogov</surname> <given-names>P</given-names></name><name><surname>Feizi</surname> <given-names>S</given-names></name><name><surname>Gnirke</surname> <given-names>A</given-names></name><name><surname>Callan</surname> <given-names>CG</given-names></name><name><surname>Kinney</surname> <given-names>JB</given-names></name><name><surname>Kellis</surname> <given-names>M</given-names></name><name><surname>Lander</surname> <given-names>ES</given-names></name><name><surname>Mikkelsen</surname> <given-names>TS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Systematic dissection and optimization of inducible enhancers in human cells using a massively parallel reporter assay</article-title><source>Nature Biotechnology</source><volume>30</volume><fpage>271</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1038/nbt.2137</pub-id><pub-id pub-id-type="pmid">22371084</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendoza-Vargas</surname> <given-names>A</given-names></name><name><surname>Olvera</surname> <given-names>L</given-names></name><name><surname>Olvera</surname> <given-names>M</given-names></name><name><surname>Grande</surname> <given-names>R</given-names></name><name><surname>Vega-Alvarado</surname> <given-names>L</given-names></name><name><surname>Taboada</surname> <given-names>B</given-names></name><name><surname>Jimenez-Jacinto</surname> <given-names>V</given-names></name><name><surname>Salgado</surname> <given-names>H</given-names></name><name><surname>Juárez</surname> <given-names>K</given-names></name><name><surname>Contreras-Moreira</surname> <given-names>B</given-names></name><name><surname>Huerta</surname> <given-names>AM</given-names></name><name><surname>Collado-Vides</surname> <given-names>J</given-names></name><name><surname>Morett</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Genome-wide identification of transcription start sites, promoters and transcription factor binding sites in <italic>E. coli</italic></article-title><source>PLOS ONE</source><volume>4</volume><elocation-id>e7526</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0007526</pub-id><pub-id pub-id-type="pmid">19838305</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mittler</surname> <given-names>G</given-names></name><name><surname>Butter</surname> <given-names>F</given-names></name><name><surname>Mann</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A SILAC-based DNA protein interaction screen that identifies candidate binding proteins to functional DNA elements</article-title><source>Genome Research</source><volume>19</volume><fpage>284</fpage><lpage>293</lpage><pub-id pub-id-type="doi">10.1101/gr.081711.108</pub-id><pub-id pub-id-type="pmid">19015324</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mortazavi</surname> <given-names>A</given-names></name><name><surname>Williams</surname> <given-names>BA</given-names></name><name><surname>McCue</surname> <given-names>K</given-names></name><name><surname>Schaeffer</surname> <given-names>L</given-names></name><name><surname>Wold</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title><source>Nature Methods</source><volume>5</volume><fpage>621</fpage><lpage>628</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1226</pub-id><pub-id pub-id-type="pmid">18516045</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myers</surname> <given-names>KS</given-names></name><name><surname>Yan</surname> <given-names>H</given-names></name><name><surname>Ong</surname> <given-names>IM</given-names></name><name><surname>Chung</surname> <given-names>D</given-names></name><name><surname>Liang</surname> <given-names>K</given-names></name><name><surname>Tran</surname> <given-names>F</given-names></name><name><surname>Keleş</surname> <given-names>S</given-names></name><name><surname>Landick</surname> <given-names>R</given-names></name><name><surname>Kiley</surname> <given-names>PJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genome-scale analysis of <italic>Escherichia coli</italic> FNR reveals complex features of transcription factor binding</article-title><source>PLOS Genetics</source><volume>9</volume><elocation-id>e1003565</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003565</pub-id><pub-id pub-id-type="pmid">23818864</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagalakshmi</surname> <given-names>U</given-names></name><name><surname>Wang</surname> <given-names>Z</given-names></name><name><surname>Waern</surname> <given-names>K</given-names></name><name><surname>Shou</surname> <given-names>C</given-names></name><name><surname>Raha</surname> <given-names>D</given-names></name><name><surname>Gerstein</surname> <given-names>M</given-names></name><name><surname>Snyder</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The transcriptional landscape of the yeast genome defined by RNA sequencing</article-title><source>Science</source><volume>320</volume><fpage>1344</fpage><lpage>1349</lpage><pub-id pub-id-type="doi">10.1126/science.1158441</pub-id><pub-id pub-id-type="pmid">18451266</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pappireddi</surname> <given-names>N</given-names></name><name><surname>Martin</surname> <given-names>L</given-names></name><name><surname>Wühr</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A review on quantitative multiplexed proteomics</article-title><source>ChemBioChem</source><volume>20</volume><fpage>1210</fpage><lpage>1224</lpage><pub-id pub-id-type="doi">10.1002/cbic.201800650</pub-id><pub-id pub-id-type="pmid">30609196</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Partridge</surname> <given-names>JD</given-names></name><name><surname>Bodenmiller</surname> <given-names>DM</given-names></name><name><surname>Humphrys</surname> <given-names>MS</given-names></name><name><surname>Spiro</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>NsrR targets in the <italic>Escherichia coli</italic> genome: new insights into DNA sequence requirements for binding and a role for NsrR in the regulation of motility</article-title><source>Molecular Microbiology</source><volume>73</volume><fpage>680</fpage><lpage>694</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2958.2009.06799.x</pub-id><pub-id pub-id-type="pmid">19656291</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patil</surname> <given-names>A</given-names></name><name><surname>Huard</surname> <given-names>D</given-names></name><name><surname>Fonnesbeck</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>PyMC: bayesian stochastic modelling in <italic>Python</italic></article-title><source>Journal of Statistical Software</source><volume>35</volume><fpage>1</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.18637/jss.v035.i04</pub-id><pub-id pub-id-type="pmid">21603108</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patwardhan</surname> <given-names>RP</given-names></name><name><surname>Lee</surname> <given-names>C</given-names></name><name><surname>Litvin</surname> <given-names>O</given-names></name><name><surname>Young</surname> <given-names>DL</given-names></name><name><surname>Pe'er</surname> <given-names>D</given-names></name><name><surname>Shendure</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>High-resolution analysis of DNA regulatory elements by synthetic saturation mutagenesis</article-title><source>Nature Biotechnology</source><volume>27</volume><fpage>1173</fpage><lpage>1175</lpage><pub-id pub-id-type="doi">10.1038/nbt.1589</pub-id><pub-id pub-id-type="pmid">19915551</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patwardhan</surname> <given-names>RP</given-names></name><name><surname>Hiatt</surname> <given-names>JB</given-names></name><name><surname>Witten</surname> <given-names>DM</given-names></name><name><surname>Kim</surname> <given-names>MJ</given-names></name><name><surname>Smith</surname> <given-names>RP</given-names></name><name><surname>May</surname> <given-names>D</given-names></name><name><surname>Lee</surname> <given-names>C</given-names></name><name><surname>Andrie</surname> <given-names>JM</given-names></name><name><surname>Lee</surname> <given-names>SI</given-names></name><name><surname>Cooper</surname> <given-names>GM</given-names></name><name><surname>Ahituv</surname> <given-names>N</given-names></name><name><surname>Pennacchio</surname> <given-names>LA</given-names></name><name><surname>Shendure</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Massively parallel functional dissection of mammalian enhancers <italic>in vivo</italic></article-title><source>Nature Biotechnology</source><volume>30</volume><fpage>265</fpage><lpage>270</lpage><pub-id pub-id-type="doi">10.1038/nbt.2136</pub-id><pub-id pub-id-type="pmid">22371081</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phillips</surname> <given-names>R</given-names></name><name><surname>Belliveau</surname> <given-names>NM</given-names></name><name><surname>Chure</surname> <given-names>G</given-names></name><name><surname>Garcia</surname> <given-names>HG</given-names></name><name><surname>Razo-Mejia</surname> <given-names>M</given-names></name><name><surname>Scholes</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Figure 1 theory meets figure 2 experiments in the study of gene expression</article-title><source>Annual Review of Biophysics</source><volume>48</volume><fpage>121</fpage><lpage>163</lpage><pub-id pub-id-type="doi">10.1146/annurev-biophys-052118-115525</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Piazza</surname> <given-names>I</given-names></name><name><surname>Kochanowski</surname> <given-names>K</given-names></name><name><surname>Cappelletti</surname> <given-names>V</given-names></name><name><surname>Fuhrer</surname> <given-names>T</given-names></name><name><surname>Noor</surname> <given-names>E</given-names></name><name><surname>Sauer</surname> <given-names>U</given-names></name><name><surname>Picotti</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A map of Protein-Metabolite interactions reveals principles of chemical communication</article-title><source>Cell</source><volume>172</volume><fpage>358</fpage><lpage>372</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.12.006</pub-id><pub-id pub-id-type="pmid">29307493</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Razo-Mejia</surname> <given-names>M</given-names></name><name><surname>Barnes</surname> <given-names>SL</given-names></name><name><surname>Belliveau</surname> <given-names>NM</given-names></name><name><surname>Chure</surname> <given-names>G</given-names></name><name><surname>Einav</surname> <given-names>T</given-names></name><name><surname>Lewis</surname> <given-names>M</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Tuning transcriptional regulation through signaling: a predictive theory of allosteric induction</article-title><source>Cell Systems</source><volume>6</volume><fpage>456</fpage><lpage>469</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2018.02.004</pub-id><pub-id pub-id-type="pmid">29574055</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rhee</surname> <given-names>KY</given-names></name><name><surname>Senear</surname> <given-names>DF</given-names></name><name><surname>Hatfield</surname> <given-names>GW</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Activation of gene expression by a ligand-induced conformational change of a protein-DNA complex</article-title><source>Journal of Biological Chemistry</source><volume>273</volume><fpage>11257</fpage><lpage>11266</lpage><pub-id pub-id-type="doi">10.1074/jbc.273.18.11257</pub-id><pub-id pub-id-type="pmid">9556617</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rydenfelt</surname> <given-names>M</given-names></name><name><surname>Cox</surname> <given-names>RS</given-names></name><name><surname>Garcia</surname> <given-names>H</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Statistical mechanical model of coupled transcription from multiple promoters due to transcription factor titration</article-title><source>Physical Review E</source><volume>89</volume><elocation-id>012702</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.89.012702</pub-id><pub-id pub-id-type="pmid">24580252</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santos-Zavaleta</surname> <given-names>A</given-names></name><name><surname>Salgado</surname> <given-names>H</given-names></name><name><surname>Gama-Castro</surname> <given-names>S</given-names></name><name><surname>Sánchez-Pérez</surname> <given-names>M</given-names></name><name><surname>Gómez-Romero</surname> <given-names>L</given-names></name><name><surname>Ledezma-Tejeida</surname> <given-names>D</given-names></name><name><surname>García-Sotelo</surname> <given-names>JS</given-names></name><name><surname>Alquicira-Hernández</surname> <given-names>K</given-names></name><name><surname>Muñiz-Rascado</surname> <given-names>LJ</given-names></name><name><surname>Peña-Loredo</surname> <given-names>P</given-names></name><name><surname>Ishida-Gutiérrez</surname> <given-names>C</given-names></name><name><surname>Velázquez-Ramírez</surname> <given-names>DA</given-names></name><name><surname>Del Moral-Chávez</surname> <given-names>V</given-names></name><name><surname>Bonavides-Martínez</surname> <given-names>C</given-names></name><name><surname>Méndez-Cruz</surname> <given-names>CF</given-names></name><name><surname>Galagan</surname> <given-names>J</given-names></name><name><surname>Collado-Vides</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>RegulonDB v 10.5: tackling challenges to unify classic and high throughput knowledge of gene regulation in <italic>E. coli</italic> K-12</article-title><source>Nucleic Acids Research</source><volume>47</volume><fpage>D212</fpage><lpage>D220</lpage><pub-id pub-id-type="doi">10.1093/nar/gky1077</pub-id><pub-id pub-id-type="pmid">30395280</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname> <given-names>A</given-names></name><name><surname>Kochanowski</surname> <given-names>K</given-names></name><name><surname>Vedelaar</surname> <given-names>S</given-names></name><name><surname>Ahrné</surname> <given-names>E</given-names></name><name><surname>Volkmer</surname> <given-names>B</given-names></name><name><surname>Callipo</surname> <given-names>L</given-names></name><name><surname>Knoops</surname> <given-names>K</given-names></name><name><surname>Bauer</surname> <given-names>M</given-names></name><name><surname>Aebersold</surname> <given-names>R</given-names></name><name><surname>Heinemann</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The quantitative and condition-dependent <italic>Escherichia coli</italic> proteome</article-title><source>Nature Biotechnology</source><volume>34</volume><fpage>104</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1038/nbt.3418</pub-id><pub-id pub-id-type="pmid">26641532</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneider</surname> <given-names>TD</given-names></name><name><surname>Stephens</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Sequence logos: a new way to display consensus sequences</article-title><source>Nucleic Acids Research</source><volume>18</volume><fpage>6097</fpage><lpage>6100</lpage><pub-id pub-id-type="doi">10.1093/nar/18.20.6097</pub-id><pub-id pub-id-type="pmid">2172928</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schweizer</surname> <given-names>H</given-names></name><name><surname>Boos</surname> <given-names>W</given-names></name><name><surname>Larson</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Repressor for the <italic>sn</italic>-glycerol-3-phosphate regulon of <italic>Escherichia coli</italic> K-12: cloning of the <italic>glpR</italic> gene and identification of its product</article-title><source>Journal of Bacteriology</source><volume>161</volume><fpage>563</fpage><lpage>566</lpage><pub-id pub-id-type="doi">10.1128/JB.161.2.563-566.1985</pub-id><pub-id pub-id-type="pmid">3881401</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seoh</surname> <given-names>HK</given-names></name><name><surname>Tai</surname> <given-names>PC</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Catabolic repression of secB expression is positively controlled by cyclic AMP (cAMP) receptor protein-cAMP complexes at the transcriptional level</article-title><source>Journal of Bacteriology</source><volume>181</volume><fpage>1892</fpage><lpage>1899</lpage><pub-id pub-id-type="doi">10.1128/JB.181.6.1892-1899.1999</pub-id><pub-id pub-id-type="pmid">10074084</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharon</surname> <given-names>E</given-names></name><name><surname>Kalma</surname> <given-names>Y</given-names></name><name><surname>Sharp</surname> <given-names>A</given-names></name><name><surname>Raveh-Sadka</surname> <given-names>T</given-names></name><name><surname>Levo</surname> <given-names>M</given-names></name><name><surname>Zeevi</surname> <given-names>D</given-names></name><name><surname>Keren</surname> <given-names>L</given-names></name><name><surname>Yakhini</surname> <given-names>Z</given-names></name><name><surname>Weinberger</surname> <given-names>A</given-names></name><name><surname>Segal</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Inferring gene regulatory logic from high-throughput measurements of thousands of systematically designed promoters</article-title><source>Nature Biotechnology</source><volume>30</volume><fpage>521</fpage><lpage>530</lpage><pub-id pub-id-type="doi">10.1038/nbt.2205</pub-id><pub-id pub-id-type="pmid">22609971</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skene</surname> <given-names>PJ</given-names></name><name><surname>Henikoff</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A simple method for generating high-resolution maps of genome-wide protein binding</article-title><source>eLife</source><volume>4</volume><elocation-id>e09225</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.09225</pub-id><pub-id pub-id-type="pmid">26079792</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stormo</surname> <given-names>GD</given-names></name><name><surname>Fields</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Specificity, free energy and information content in protein-DNA interactions</article-title><source>Trends in Biochemical Sciences</source><volume>23</volume><fpage>109</fpage><lpage>113</lpage><pub-id pub-id-type="doi">10.1016/S0968-0004(98)01187-6</pub-id><pub-id pub-id-type="pmid">9581503</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname> <given-names>T</given-names></name><name><surname>Satija</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Integrative single-cell analysis</article-title><source>Nature Reviews Genetics</source><volume>20</volume><fpage>257</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1038/s41576-019-0093-7</pub-id><pub-id pub-id-type="pmid">30696980</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Tareen</surname> <given-names>A</given-names></name><name><surname>Kinney</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Biophysical models of cis-regulation as interpretable neural networks</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/835942</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Urtecho</surname> <given-names>G</given-names></name><name><surname>Tripp</surname> <given-names>AD</given-names></name><name><surname>Insigne</surname> <given-names>KD</given-names></name><name><surname>Kim</surname> <given-names>H</given-names></name><name><surname>Kosuri</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Systematic dissection of sequence elements controlling σ70 promoters using a genomically encoded multiplexed reporter assay in <italic>Escherichia coli</italic></article-title><source>Biochemistry</source><volume>58</volume><fpage>1539</fpage><lpage>1551</lpage><pub-id pub-id-type="doi">10.1021/acs.biochem.7b01069</pub-id><pub-id pub-id-type="pmid">29388765</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Urtecho</surname> <given-names>G</given-names></name><name><surname>Insigne</surname> <given-names>K</given-names></name><name><surname>Tripp</surname> <given-names>AD</given-names></name><name><surname>Brinck</surname> <given-names>M</given-names></name><name><surname>Lubock</surname> <given-names>NB</given-names></name><name><surname>Kim</surname> <given-names>H</given-names></name><name><surname>Chan</surname> <given-names>T</given-names></name><name><surname>Kosuri</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Genome-wide functional characterization of <italic>Escherichia coli</italic> promoters and regulatory elements responsible for their function</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.01.04.894907</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vilar</surname> <given-names>JM</given-names></name><name><surname>Guet</surname> <given-names>CC</given-names></name><name><surname>Leibler</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Modeling network dynamics: the <italic>lac</italic> operon, a case study</article-title><source>The Journal of Cell Biology</source><volume>161</volume><fpage>471</fpage><lpage>476</lpage><pub-id pub-id-type="doi">10.1083/jcb.200301125</pub-id><pub-id pub-id-type="pmid">12743100</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vilar</surname> <given-names>JM</given-names></name><name><surname>Leibler</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>DNA looping and physical constraints on transcription regulation</article-title><source>Journal of Molecular Biology</source><volume>331</volume><fpage>981</fpage><lpage>989</lpage><pub-id pub-id-type="doi">10.1016/S0022-2836(03)00764-2</pub-id><pub-id pub-id-type="pmid">12927535</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vilar</surname> <given-names>JM</given-names></name><name><surname>Saiz</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Reliable prediction of complex phenotypes from a modular design in free energy space: an extensive exploration of the <italic>lac</italic> operon</article-title><source>ACS Synthetic Biology</source><volume>2</volume><fpage>576</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1021/sb400013w</pub-id><pub-id pub-id-type="pmid">23654358</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinert</surname> <given-names>FM</given-names></name><name><surname>Brewster</surname> <given-names>RC</given-names></name><name><surname>Rydenfelt</surname> <given-names>M</given-names></name><name><surname>Phillips</surname> <given-names>R</given-names></name><name><surname>Kegel</surname> <given-names>WK</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Scaling of gene expression with transcription-factor fugacity</article-title><source>Physical Review Letters</source><volume>113</volume><elocation-id>258101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.113.258101</pub-id><pub-id pub-id-type="pmid">25554908</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weissenborn</surname> <given-names>DL</given-names></name><name><surname>Wittekindt</surname> <given-names>N</given-names></name><name><surname>Larson</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Structure and regulation of the <italic>glpFK</italic> operon encoding glycerol diffusion facilitator and glycerol kinase of <italic>Escherichia coli</italic> K-12</article-title><source>The Journal of Biological Chemistry</source><volume>267</volume><fpage>6122</fpage><lpage>6131</lpage><pub-id pub-id-type="pmid">1372899</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamamoto</surname> <given-names>N</given-names></name><name><surname>Nakahigashi</surname> <given-names>K</given-names></name><name><surname>Nakamichi</surname> <given-names>T</given-names></name><name><surname>Yoshino</surname> <given-names>M</given-names></name><name><surname>Takai</surname> <given-names>Y</given-names></name><name><surname>Touda</surname> <given-names>Y</given-names></name><name><surname>Furubayashi</surname> <given-names>A</given-names></name><name><surname>Kinjyo</surname> <given-names>S</given-names></name><name><surname>Dose</surname> <given-names>H</given-names></name><name><surname>Hasegawa</surname> <given-names>M</given-names></name><name><surname>Datsenko</surname> <given-names>KA</given-names></name><name><surname>Nakayashiki</surname> <given-names>T</given-names></name><name><surname>Tomita</surname> <given-names>M</given-names></name><name><surname>Wanner</surname> <given-names>BL</given-names></name><name><surname>Mori</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Update on the keio collection of <italic>Escherichia coli</italic> single-gene deletion mutants</article-title><source>Molecular Systems Biology</source><volume>5</volume><elocation-id>335</elocation-id><pub-id pub-id-type="doi">10.1038/msb.2009.92</pub-id><pub-id pub-id-type="pmid">20029369</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>B</given-names></name><name><surname>Larson</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Action at a distance for negative control of transcription of the glpD gene encoding <italic>sn</italic>-glycerol 3-phosphate dehydrogenase of <italic>Escherichia coli</italic> K-12</article-title><source>Journal of Bacteriology</source><volume>178</volume><fpage>7090</fpage><lpage>7098</lpage><pub-id pub-id-type="doi">10.1128/JB.178.24.7090-7098.1996</pub-id><pub-id pub-id-type="pmid">8955388</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ye</surname> <given-names>SZ</given-names></name><name><surname>Larson</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Structures of the promoter and operator of the glpD gene encoding aerobic <italic>sn</italic>-glycerol-3-phosphate dehydrogenase of <italic>Escherichia coli</italic> K-12</article-title><source>Journal of Bacteriology</source><volume>170</volume><fpage>4209</fpage><lpage>4215</lpage><pub-id pub-id-type="doi">10.1128/jb.170.9.4209-4215.1988</pub-id><pub-id pub-id-type="pmid">3045087</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaslaver</surname> <given-names>A</given-names></name><name><surname>Bren</surname> <given-names>A</given-names></name><name><surname>Ronen</surname> <given-names>M</given-names></name><name><surname>Itzkovitz</surname> <given-names>S</given-names></name><name><surname>Kikoin</surname> <given-names>I</given-names></name><name><surname>Shavit</surname> <given-names>S</given-names></name><name><surname>Liebermeister</surname> <given-names>W</given-names></name><name><surname>Surette</surname> <given-names>MG</given-names></name><name><surname>Alon</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A comprehensive library of fluorescent transcriptional reporters for <italic>Escherichia coli</italic></article-title><source>Nature Methods</source><volume>3</volume><fpage>623</fpage><lpage>628</lpage><pub-id pub-id-type="doi">10.1038/nmeth895</pub-id><pub-id pub-id-type="pmid">16862137</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname> <given-names>N</given-names></name><name><surname>Oh</surname> <given-names>W</given-names></name><name><surname>Trybul</surname> <given-names>D</given-names></name><name><surname>Thrasher</surname> <given-names>KS</given-names></name><name><surname>Kingsbury</surname> <given-names>TJ</given-names></name><name><surname>Larson</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Characterization of the interaction of the glp repressor of <italic>Escherichia coli</italic> K-12 with single and tandem glp operator variants</article-title><source>Journal of Bacteriology</source><volume>176</volume><fpage>2393</fpage><lpage>2397</lpage><pub-id pub-id-type="doi">10.1128/JB.176.8.2393-2397.1994</pub-id><pub-id pub-id-type="pmid">8157609</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Extended details of experimental design</title><sec id="s8-1"><title>Choosing target genes</title><p>Genes in this study were chosen to cover several different categories. Twenty-nine genes had at least one transcription-factor-binding site listed in RegulonDB and were picked to validate our method under a number of conditions (15 with relevant high evidence sites). Thirty-seven were chosen because the work of <xref ref-type="bibr" rid="bib76">Schmidt et al., 2016</xref> demonstrated that gene expression changed significantly under different growth conditions. A handful of genes such as <italic>minC</italic>, <italic>maoP</italic>, or <italic>fdhE</italic> were chosen because we found either their physiological significance interesting, as in the case of <italic>minC</italic>, whose product is crucial for cell division and proper partitioning of the cell into two equal sized daughters in <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib56">Lutkenhaus, 2007</xref>). Alternatively, for some cases we found the gene regulatory question interesting, such as for the intra-operon regulation demonstrated by <italic>fdhE</italic>. The remainder of the genes were chosen because they had no regulatory information, often had minimal information about the function of the gene, and had an annotated transcription start site (TSS) in RegulonDB. A list of all genes chosen can be found in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>.</p></sec><sec id="s8-2"><title>Sequencing analysis</title><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Schematic of the genetic construct used in this study.</title><p>Mutated DNA libraries for each regulatory region were expressed from a pSC101 plasmid with kanamycin resistance (kanR). Each mutated sequence is 160 bp in length, which includes 45 bp downstream and 115 bp upstream of a given TSS. Each mutated sequence is flanked by primer-binding sites to facilitate cloning. The genetic construct also contains a random barcode, a ribosome-binding site (RBS), a GFP gene, and a terminator labeled with a large 'T'.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-app1-fig1-v2.tif"/></fig><p>In this Appendix section, we provide further details associated with the analysis of next-generation sequencing (NGS) results, from both the 'mapping' experiment, in which each unique barcode is 'linked' to its corresponding mutated promoter region, and from the barcode sequencing experiments, in which the frequency of each barcode is counted and relative gene expression values determined. It is important to perform two sequencing experiments, in this manner, for a couple of reasons. Oligonucleotide libraries ordered from Twist Bioscience, which we use to construct promoter regions mutated at a 10% rate, are prone to random errors. This means that we do not fully know what is in the ordered library, and so it is necessary to sequence the full library and determine which mutations are present in each promoter region. The 'mapping' phase of experiments also serves to connect each random, genetic barcode (which is added via PCR with primer overhangs) to its corresponding, mutated promoter. By linking barcodes to promoters, we are able to build a 'codex' that enables us to count genetic barcodes and, in turn, understand the relative gene expression values for each mutant promoter sequence.</p><p>For the 'mapping' of genetic barcodes to their corresponding mutant promoter, we use paired-end sequencing, with 150 cycles for both Read 1 and Read 2, on a Hi-Seq 2500 machine. We acquired 250 million total reads for mapping of libraries.</p><p>In our analysis of FASTQ files, we removed any barcodes that were associated with a promoter variant which had insertions or deletions. Similarly, any genetic barcodes associated with multiple promoter variants were removed from the analysis, as were any sequences which appeared only once (barcodes must appear at least two times to be analyzed, as the appearance of a single, unique barcode sequence could be attributed to a sequencing error). The paired end reads from this sequencing step were assembled using the FLASH tool (<xref ref-type="bibr" rid="bib58">Magoč and Salzberg, 2011</xref>). Any sequence with a PHRED score less than 20 was then removed using the FastX toolkit (<xref ref-type="bibr" rid="bib31">Hannon, 2010</xref>). The specific commands used for this step of our analysis are listed on the GitHub Wiki associated with this work.</p><p>To analyze the 'mapping' data and link each genetic barcode to its unique, mutagenized promoter region, we used a custom Python module, which can be found on the GitHub repository associated with this work. This module contains functions to check that sequences are the expected length, map unique barcodes to their corresponding promoter regions, and extract barcode sequences for subsequent sequencing experiments. We also provided a Jupyter notebook on the GitHub repository which provides a step-by-step walkthrough of the code used in processing sequencing data.</p><p>After mapping each barcode to its corresponding, mutated promoter region, we next 'count' barcodes, both DNA and cDNA, to determine the relative gene expression values for each mutated promoter. For barcode counting experiments, only the region containing the random, 20 bp barcode was sequenced. For each growth condition, each promoter library yielded 20,000 to 500,000 usable sequencing reads. If the dataset for a gene in a given growth condition did not have at least 20,000 reads, it was not analyzed further, as we consistently found that, below this threshold, we reached a regime wherein the inference reliability of MCMC was reduced.</p><p>When preparing DNA and cDNA for NGS, we add a 4nt barcode, via PCR, to the library isolated from each growth condition. These 4nt barcodes are used during data analysis both to map each library to its particular growth condition and to keep track of biological replicates, while the 20 bp barcodes can be used to identify each mutated promoter region. We performed all experiments with two biological replicates.</p><p>After collecting the FASTQ files, we perform quality filtering with FastX. We then perform barcode splitting with the FastX toolkit to separate each FASTQ file based on its growth condition, as well as separate the sequencing files based on whether they are derived from the DNA or cDNA library. Each experimental condition (both biological replicates, RNA vs. DNA, and growth conditions) receives a unique, 4nt barcode sequence, which enables us to identify where each library came from. Full details of our sequencing analysis methodologies, as well as all Python scripts, can be found on the GitHub repository associated with this work.</p></sec><sec id="s8-3"><title>Growth conditions</title><p>The growth conditions used in this study were inspired by <xref ref-type="bibr" rid="bib76">Schmidt et al., 2016</xref>, a study which observed changes in the <italic>E. coli</italic> proteome under growth conditions similar to the ones presented. The growth conditions utilized in this study are tabulated in <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>. The growth conditions explored here involved a range of environmental perturbations including altering the carbon source, inducing stress, or introducing trace metals. Unless otherwise noted in the caption of <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>, the cells were grown in the medium at 37°C until reaching an OD of 0.3, at which point the cells were harvested and the RNA extracted. These growth conditions were chosen so as to span a wide range of growth rates, as well as to illuminate any carbon source specific regulators.</p><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title>All growth conditions used in the Reg-Seq study.</title><p>Heat shocked cells were exposed to 42°C for 5 min upon reaching OD 0.3 as this is known to induce transcription by <inline-formula><mml:math id="inf25"><mml:msup><mml:mi>σ</mml:mi><mml:mn>32</mml:mn></mml:msup></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib2">Arsène et al., 2000</xref>). Low oxygen growth cells were grown in a flask sealed with parafilm with minimal oxygen, although some was present as no anaerobic chamber was used. This level of oxygen stress was still sufficient to activate FNR binding, thus activating anaerobic metabolism. For cells grown with iron, upon reaching OD of 0.3 iron was added and cells were incubated for 10 min before harvesting RNA. Growth without cAMP was accomplished by the use of the JK10 strain (<xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>) which does not maintain its cAMP levels.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Growth conditions</th></tr></thead><tbody><tr><td>M9 with glucose (0.5%)</td></tr><tr><td>M9 with acetate (0.5%)</td></tr><tr><td>M9 with arabinose (0.5%)</td></tr><tr><td>M9 with xylose (0.5%) and arabinose (0.5%)</td></tr><tr><td>M9 with succinate (0.5%)</td></tr><tr><td>M9 with trehalose (0.5%)</td></tr><tr><td>M9 with glucose (0.5%) and 5 mM sodium salycilate</td></tr><tr><td>LB</td></tr><tr><td>heat shock in M9 with glucose (0.5%)</td></tr><tr><td>LB in low oxygen</td></tr><tr><td>zinc, 5 mM ZnCl in M9 with glucose (0.5%)</td></tr><tr><td>iron, 5 mM FeCL in M9 with glucose (0.5%)</td></tr><tr><td>no cAMP in M9 with glucose (0.5%)</td></tr></tbody></table></table-wrap><p>All knockout experiment were performed in M9 with glucose except for the knockouts for <italic>arcA</italic>, <italic>hdfR</italic>, and <italic>phoP</italic> which were grown in LB.</p></sec></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><sec id="s9" sec-type="appendix"><title>Validating Reg-Seq against previous methods and results</title><p>The work presented here is effectively a third-generation of the use of Sort-Seq methods for the discovery of regulatory architecture. The primary difference between the present work and previous generations (<xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>; <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>) is the use of RNA-Seq rather than fluorescence and cell sorting as a readout of the level of expression of our promoter libraries. As such, there are many important questions to be asked about the comparison between the earlier methods and this work. We attack that question in several ways. First, as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>, we have performed a head-to-head comparison of the two approaches to be described further in this section. Second, as shown in the next section, our list of candidate promoters included roughly 20% for which there is at least one experimentally validated transcription-factor-binding site. In these cases, we examined the extent to which our methods recover the known features of regulatory control about those promoters.</p></sec><sec id="s10" sec-type="appendix"><title>Comparison between Reg-Seq by RNA-Seq and fluorescent sorting</title><p>As the basis for comparing the results of the fluorescence-based Sort-Seq approach with our RNA-Seq-based approach, we use information footprints and position weight matrices as our metrics.</p><p>When making these comparisons between the two methods, we compare the values of a position weight matrix (PWM), often displayed as a sequence logo, generated from the Sort-Seq and Reg-Seq methods. PWMs contain the probabilities that a given base will occur at a given position in the binding site. We calculate the Pearson correlation coefficient between the PWM values (represented as the height of the letters at each position) for the two methods. To compute the correlation coefficient, we use<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf27"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the entries of the PWM of nucleotide <inline-formula><mml:math id="inf28"><mml:mi>α</mml:mi></mml:math></inline-formula> at position <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> obtained from Sort-Seq and Reg-Seq respectively, <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the total length of the binding site, and <inline-formula><mml:math id="inf31"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf32"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> are the means of <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, respectively. As an example, consider the following sequence logo from a Sort-Seq experiment,</p><p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th>Position</th><th>A</th><th>C</th><th>G</th><th>T</th></tr></thead><tbody><tr><td>1</td><td>0.01</td><td>0.01</td><td>0.03</td><td><bold>0.95</bold></td></tr><tr><td>2</td><td>0.04</td><td><bold>0.83</bold></td><td>0.06</td><td>0.07</td></tr><tr><td>3</td><td><bold>0.70</bold></td><td>0.17</td><td>0.11</td><td>0.02</td></tr><tr><td>4</td><td><bold>0.86</bold></td><td>0.01</td><td>0.10</td><td>0.03</td></tr></tbody></table></table-wrap></p><p>and the same region resulting from a Reg-Seq experiment:</p><p><table-wrap id="inlinetable2" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th>Position</th><th>A</th><th>C</th><th>G</th><th>T</th></tr></thead><tbody><tr><td>1</td><td>0.01</td><td>0.04</td><td>0.03</td><td><bold>0.92</bold></td></tr><tr><td>2</td><td>0.05</td><td><bold>0.85</bold></td><td>0.07</td><td>0.03</td></tr><tr><td>3</td><td><bold>0.74</bold></td><td>0.14</td><td>0.09</td><td>0.03</td></tr><tr><td>4</td><td><bold>0.81</bold></td><td>0.02</td><td>0.13</td><td>0.04</td></tr></tbody></table></table-wrap></p><p>We see that for both sequence logos, the preferred nucleotides from position 1 through 4 are T-C-A-A, as indicated by the values in bold. Plugging in these values into <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>, we get a Pearson correlation coefficient of <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.997</mml:mn></mml:mrow></mml:math></inline-formula>, indicating substantial agreement between the Sort-Seq and Reg-Seq methods in this example. As a way to visualize similarity, for each position in the sequence logo we can plot the numerical value as resulting from the Sort-Seq experiment (<inline-formula><mml:math id="inf36"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) vs. the corresponding value obtained from the Reg-Seq experiment (<inline-formula><mml:math id="inf37"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). Perfect correspondence between the methods would result in all the data lying on the <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> line (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>).</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Mock data comparing Sort-Seq and Reg-Seq sequence logo values.</title><p>These data have a Pearson correlation coefficient of <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.997</mml:mn></mml:mrow></mml:math></inline-formula>. This high correlation is also indicated by the data deviating little from the <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> line.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-app2-fig1-v2.tif"/></fig><p><xref ref-type="fig" rid="fig3">Figure 3</xref> shows examples of this comparison for four distinct genes of interest. <xref ref-type="fig" rid="fig3">Figure 3(A)</xref> shows the results of the two methods for the <italic>lacZYA</italic> promoter with special reference to the CRP-binding site. Both the information footprint and the the position weight matrices (displayed with sequence logos) identify the same binding site.</p><p><xref ref-type="fig" rid="fig3">Figure 3(B)</xref> provides a similar analysis for the <italic>dgoRKADT</italic> promoter where the position weight matrices for the CRP-binding site from Reg-Seq and Sort-Seq have a correlation coefficient of r = 0.90. <xref ref-type="fig" rid="fig3">Figure 3(C)</xref> provides a quantitative dissection of the <italic>relBE</italic> promoter which is repressed by RelBE. Here, we use both information footprints and expression shifts as a way to quantify the significance of mutations to different binding sites across the promoter. Finally, <xref ref-type="fig" rid="fig3">Figure 3(D)</xref> shows a comparison of the two methods for the <italic>marRAB</italic> promoter. The two approaches both identify a MarR-binding site.</p></sec><sec id="s11" sec-type="appendix"><title>False positive and false negative rates</title><p>We introduce a systematized way of identifying the locations of binding sites, as shown in <xref ref-type="fig" rid="fig11">Figure 11</xref>, that allows the false negative and false positive rate of binding site identification to be clearly assessed. For a given information footprint, we average over 15 base pair 'windows'. We then determine which base pairs are part of a regulatory region by setting an information threshold of <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> bits, which is explained below. All base pair positions that pass the information threshold are then joined into 'regulatory regions', which we consider to be 'activator-like' (if a mutation decreases expression) or 'repressor-like' (if a mutation increases expression). This means that it is possible to identify overlapping repressor- and activator-binding sites. We join any base pair positions within 4 base pairs of each other into a single regulatory region. We then find the edges of each binding site region by trimming off any base pairs at the edge that are below the information threshold (even if the 15 base pair average is above the threshold). A limitation of this method of identification is that is cannot resolve transcription-factor-binding sites that are very close to each other. The primary reasons for this is that putative binding sites will overlap after the smoothing step. While the method could be tuned to avoid treating nearby regions as the same site, many transcription-factor-binding sites will have sections of base pairs within their site where base identity has little to no effect on gene expression. Helix-turn-helix type transcription factors like CRP (whose binding site can be observed in <xref ref-type="fig" rid="fig3">Figure 3</xref>) are common examples of this phenomenon.</p><p>To determine which information threshold to use as a cutoff for a putative binding site, as displayed in <xref ref-type="fig" rid="fig11">Figure 11</xref>, we selected a training set of genes which included two of our 'gold standard' genes with previously studied binding sites, DgoR (the upstream site from the <italic>dgoR</italic> promoter) and CRP (from the <italic>araAB</italic> promoter), two genes with only RNAP-binding sites, including <italic>hslU</italic> (under heat shock) and <italic>poxB</italic>, and several genes that we classified as inactive, wherein no RNAP-binding sites or other binding sites could be identified. These inactive genes included <italic>hicB, mtgA, eco, hslU</italic> (without heat shock), and <italic>yncD</italic>. The growth condition (heat shock) is specified for the <italic>hslU</italic> promoter as transcription occurs from a <inline-formula><mml:math id="inf42"><mml:msup><mml:mi>σ</mml:mi><mml:mn>32</mml:mn></mml:msup></mml:math></inline-formula> RNAP site, which will be inactive except during heat shock. We selected the threshold such that the RNAP sites and known binding sites were identified, while no binding sites were identified in the inactive regions.</p><p>We then determine a set of binding sites upon which to test this method and determine a false negative rate for the Reg-Seq experiment. In this set of binding sites, we include those sites which are 'high-evidence' according to EcoCyc. Such 'high evidence' binding sites have been validated experimentally with the binding of purified protein or through site mutation. Some 'high-evidence' sites are excluded because they are not included within our 160 base pair, mutagenized sequence, or because they are not active in any of the growth conditions that we tested. Justifications for those binding sites which were not included are now listed in a new appendix; Appendix 4 Section 'Explanation of included binding sites'. A full list of promoters and binding sites that <italic>were</italic> included in the set of genes used to validate our automated binding-site finding algorithms are also provided in <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>.</p><table-wrap id="app2table1" position="float"><label>Appendix 2—table 1.</label><caption><title>A suite of experimentally validated and high-evidence binding sites used to test our automated binding site finding algorithm.</title><p>Specifically, this list of genes was used to test the false negative rate of our Reg-Seq method by examining what fraction of high-evidence sites were also identified with Reg-Seq.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Gene</th><th>Transcription factor</th><th>Transcription factor type</th></tr></thead><tbody><tr><td><italic>rspA</italic></td><td>CRP</td><td>activator</td></tr><tr><td><italic>rspA</italic></td><td>YdfH</td><td>repressor</td></tr><tr><td><italic>araAB</italic></td><td>AraC (two sites)</td><td>activator</td></tr><tr><td><italic>znuCB</italic></td><td>Zur</td><td>repressor</td></tr><tr><td><italic>xylA</italic></td><td>CRP</td><td>activator</td></tr><tr><td><italic>xylA</italic></td><td>XylR (two sites)</td><td>activator</td></tr><tr><td><italic>xylF</italic></td><td>XylR (two sites)</td><td>activator</td></tr><tr><td><italic>dicC</italic></td><td>DicA</td><td>repressor</td></tr><tr><td><italic>relBE</italic></td><td>RelBE</td><td>repressor</td></tr><tr><td><italic>ftsK</italic></td><td>LexA</td><td>repressor</td></tr><tr><td><italic>znuA</italic></td><td>Zur</td><td>repressor</td></tr><tr><td><italic>lac</italic></td><td>CRP</td><td>activator</td></tr><tr><td><italic>marR</italic></td><td>Fis</td><td>activator</td></tr><tr><td><italic>marR</italic></td><td>MarA</td><td>activator</td></tr><tr><td><italic>marR</italic></td><td>MarR (two sites)</td><td>repressor</td></tr><tr><td><italic>dgoR</italic></td><td>CRP</td><td>activator</td></tr><tr><td><italic>dgoR</italic></td><td>DgoR (right site)</td><td>repressor</td></tr><tr><td><italic>ompR</italic></td><td>IHF (three sites)</td><td>repressor</td></tr><tr><td><italic>ompR</italic></td><td>CRP</td><td>repressor</td></tr><tr><td><italic>dicA</italic></td><td>DicA</td><td>repressor</td></tr><tr><td><italic>araC</italic></td><td>AraC (two sites)</td><td>repressor</td></tr><tr><td><italic>araC</italic></td><td>AraC (two sites)</td><td>activator</td></tr><tr><td><italic>araC</italic></td><td>CRP</td><td>activator</td></tr><tr><td><italic>araC</italic></td><td>XylR (two sites)</td><td>repressor</td></tr></tbody></table></table-wrap><p>For each promoter contained in <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>, we used the automated procedure outlined above and in <xref ref-type="fig" rid="fig11">Figure 11</xref> to identify the activator- and repressor-binding sites. A visual display of the expected binding sites, the information footprints for the promoters in <xref ref-type="table" rid="app2table1">Appendix 2—table 1</xref>, and the discovered binding sites are all displayed in <xref ref-type="fig" rid="app2fig2">Appendix 2—figures 2</xref> and <xref ref-type="fig" rid="app2fig3">3</xref>. To assess the false negative rate, we compare the identified regulatory regions to the known binding sites from <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>. At this stage, we did not consider the identities of the binding sites; we merely consider their presence or absence. Inferred binding sites are declared to 'match' the known binding site if the automated identification procedure classifies at least half of the base pairs reported in EcoCyc as belonging to a transcription-factor-binding site and correctly determines whether the binding site belongs to an activator or repressor.</p><p>We do not require exact matching of the edges of the binding sites for several reasons. One such reason is that, in some cases, the sequence of half of a binding site (for example, corresponding to one half of a helix-turn-helix binding motif) can contribute relatively little to gene expression, and so will not have high mutual information values in the corresponding information footprint for that binding site. While this may appear unintuitive for transcription factors where both sections of the binding site are bound by identical halves of a dimer, we see several examples of this in our Reg-Seq experiment results, including for CRP-binding sites of the <italic>rspA</italic> promoter studied during our analysis of false negative rates. We can see in <xref ref-type="fig" rid="app2fig2">Appendix 2—figures 2</xref> and <xref ref-type="fig" rid="app2fig3">3</xref> that the downstream half of the binding site is not identified as important for gene expression. If we examine the wild type sequence of the <italic>rspA</italic> promoter, we also see that, for the upstream half of the sequence, the wild type matches the five most conserved bases of the consensus sequence (TGTGA) perfectly. The downstream half of the sequence, however, has three mismatches out of five bases. The downstream half of the binding site already binds to its target transcription factor poorly, so further mutations have little effect. While it is true that CRP binds to that sequence region, it is also true that CRP binds only extremely weakly to that section of the region. A similar effect can be seen in previous work from <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref> where a mutation in the downstream half of a CRP-binding site in the <italic>xylE</italic> promoter had more than a 10-fold greater effect on binding energy than mutation in the upstream half of the binding site. As such, we are lenient when evaluating the successes of our algorithm in this regard. Furthermore, the methods that have been used to determine the presence of 'high evidence' binding sites in the past, such as ChIP-Seq, do not typically have base pair resolution with which to precisely determine the edges of binding sites (<xref ref-type="bibr" rid="bib81">Skene and Henikoff, 2015</xref>).</p><p>Lastly, a known weakness of our algorithmic approach is that binding sites that are extremely close or overlapping cannot be distinguished from each other initially. For example, the XylR sites in the <italic>xylF</italic> promoter are only separated by three bases according to RegulonDB. While the sites can be distinguished upon later investigation through gene knockouts, mass spectrometry, or motif comparison, our initial algorithm joins the sites into one large site. While this is a weakness of the algorithm, for our purposes it does not constitute a false negative, as the important regions for regulation are still discovered. All regions for all promoters that are classified as regulatory regions, their identities as activators, repressors, or RNAP binding sites, as well as their starting and ending base pairs, can be found in <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>. Furthermore, we summarize the success and failures of the method at each binding site in <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref> below.</p><table-wrap id="app2table2" position="float"><label>Appendix 2—table 2.</label><caption><title>The results of the comparison between experimentally verified, high-evidence binding sites and Reg-Seq-binding sites.</title><p>A visual illustration of the comparison can be found in <xref ref-type="fig" rid="app2fig2">Appendix 2—figures 2</xref> and <xref ref-type="fig" rid="app2fig3">3</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Gene</th><th>Transcription factor</th><th>Was the region classified correctly?</th></tr></thead><tbody><tr><td><italic>rspA</italic></td><td>CRP</td><td>Yes</td></tr><tr><td><italic>rspA</italic></td><td>YdfH</td><td>Yes</td></tr><tr><td><italic>araAB</italic></td><td>AraC (two sites)</td><td>Yes</td></tr><tr><td><italic>znuCB</italic></td><td>Zur</td><td>Yes</td></tr><tr><td><italic>xylA</italic></td><td>CRP</td><td>Yes</td></tr><tr><td><italic>xylA</italic></td><td>XylR (two sites)</td><td>Yes</td></tr><tr><td><italic>xylF</italic></td><td>XylR (two sites)</td><td>Yes</td></tr><tr><td><italic>dicC</italic></td><td>DicA</td><td>Yes</td></tr><tr><td><italic>relBE</italic></td><td>RelBE</td><td>Yes</td></tr><tr><td><italic>ftsK</italic></td><td>LexA</td><td>Yes</td></tr><tr><td><italic>znuA</italic></td><td>Zur</td><td>Yes</td></tr><tr><td><italic>lac</italic></td><td>CRP</td><td>Yes</td></tr><tr><td><italic>marR</italic></td><td>Fis</td><td>No</td></tr><tr><td><italic>marR</italic></td><td>MarA</td><td>Yes</td></tr><tr><td><italic>marR</italic></td><td>MarR (two sites)</td><td>Yes</td></tr><tr><td><italic>dgoR</italic></td><td>CRP</td><td>Yes</td></tr><tr><td><italic>dgoR</italic></td><td>DgoR (right site)</td><td>No</td></tr><tr><td><italic>ompR</italic></td><td>IHF (three sites)</td><td>Yes</td></tr><tr><td><italic>ompR</italic></td><td>CRP</td><td>No</td></tr><tr><td><italic>dicA</italic></td><td>DicA</td><td>No</td></tr><tr><td><italic>araC</italic></td><td>AraC (four sites)</td><td>one site identified</td></tr><tr><td><italic>araC</italic></td><td>CRP</td><td>No</td></tr><tr><td><italic>araC</italic></td><td>XylR (two sites)</td><td>No</td></tr></tbody></table></table-wrap><p>We see in <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref> that 11 of the 15 promoter regions included in <xref ref-type="table" rid="app1table1">Appendix 2—table 1</xref> have all transcription-factor-binding sites classified as putative transcription factors, two have the majority of sites correctly classified, and two do not have any of their binding sites correctly classified as regulatory elements. We can see the information footprints used in the correct identifications in <xref ref-type="fig" rid="app2fig2">Appendix 2—figures 2</xref> and <xref ref-type="fig" rid="app2fig3">3</xref>. We could alternatively consider that 23 out of 33 binding sites are correctly classified. However, we argue that the false negative rate should be considered on a per promoter basis, rather than on the basis of individual binding sites. The reason for this argument can be seen in the two 'worst' cases of correct binding site identification; namely, for the <italic>araC</italic> and <italic>dicA</italic> promoters.</p><p>The <italic>araC</italic> promoter is repressed by multiple repressor-binding sites in all growth conditions tested. <italic>araC</italic> only has high expression transiently after addition of arabinose (<xref ref-type="bibr" rid="bib40">Johnson and Schleif, 1995</xref>), and while growth in arabinose is utilized in this experiment, RNA was not collected during the window of high expression. The case study shows that Reg-Seq does not perform well when many repressor sites regulate the promoter. Reg-Seq relies on mapping the effect on expression of mutating a particular site, and when many strong repressor sites are present, expression change will be minimal unless all repressor sites are weakened through mutation. Additionally, in this highly repressed case, the RNAP-binding site we observe in the mutagenized region is not the documented RNAP site in RegulonDB, indicating that we are seeing transcription primarily from an alternative TSS. Different RNAP sites are often regulated differently, and in this case, the presence of an alternative and dominant RNAP-binding site (in the repressed case), likely contributes to a failure to observe six of the seven binding sites in the <italic>araC</italic> promoter. Similarly, in the <italic>dicA</italic> promoter, we did not find an RNAP-binding site in the studied region, which would make it very unlikely for any transcription-factor-binding sites to be identifiable.</p><p>In order to determine false positive rates, we test against promoters for which we are certain there are not additional, unannotated binding sites. Most known binding sites were not determined using a method like Reg-Seq, which looks for regulatory elements across an entire promoter region at base pair resolution. Rather, many efforts to pinpoint transcription-factor-binding site locations use assays like ChIP-Seq, which prioritizes looking for all binding sites of a given transcription factor across the entire genome. For those promoters studied with Reg-Seq, there are five promoters for which we have reason to believe that there are no undiscovered binding sites. There is evidence that the <italic>zupT</italic> promoter is constitutive (<xref ref-type="bibr" rid="bib28">Grass et al., 2005</xref>), and the <italic>marR</italic>, <italic>relBE</italic>, <italic>dgoR</italic>, and <italic>lacZYA</italic> promoters have all been examined for binding sites at base pair resolution previously (in the Sort-Seq experiment [<xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>; <xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>]).</p><p>To evaluate false positive rates, we examine the putative activator and repressor binding sites as identified using our automated methodology (described previously), and compare any known binding sites to the known binding sites for the target promoters. We also classify any putative regulatory regions that are outside of known transcription-factor-binding sites as false positives. Similarly, any identified RNAP-binding sites which were outside of the known RNAP binding locations were classified as false positives. In the <italic>zupT</italic> promoter, only the correctly placed RNAP site was identified. There were similarly no false positives identified in the <italic>marR</italic>, <italic>relBE</italic>, <italic>dgoR</italic>, or <italic>lacZYA</italic> promoters.</p><p>We additionally compare the energy matrices from putative regulatory regions to known binding site motifs. The known motifs are obtained either from RegulonDB or are generated from data from our prior Sort-Seq experiments (see <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>). We utilize the TOMTOM motif comparison software from <xref ref-type="bibr" rid="bib29">Gupta et al., 2007</xref> to perform these comparisons. TOMTOM generates a p-value under the null hypothesis that the two compared motifs are drawn independently from the same underlying probability distribution. We test 95 motifs against each target motif that we are attempting to identify. The 95 resulting p-values (for each target) generated by TOMTOM are displayed in <xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref>. A full discussion of TOMTOM can be found in Appendix 3 Section 'TOMTOM motif comparison'. We only included those transcription factors that either have over 50 known binding sites in RegulonDB or have experimental measurements of binding site preference, such as in Sort-Seq (<xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>). As such, we used TOMTOM on the XylR, CRP, MarA, MarR, and RelBE sites in <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>. We utilized a p-value cutoff of 0.05, corrected for multiple hypothesis testing. 95 motifs were tested against each target, and using the Bonferroni correction leads to a p-value cutoff of <inline-formula><mml:math id="inf43"><mml:mrow><mml:mfrac><mml:mn>0.05</mml:mn><mml:mn>95</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. In <xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref> we show that the correct transcription factor falls below the p-value threshold in all cases. For the CRP-binding site in the <italic>lacZYA</italic> promoter, FNR also falls below the cutoff, but CRP has a calculated p-value that is ≈ 6 orders of magnitude lower, and so is clearly identified as the correct binding site. The results show that motif comparisons can be used reliably in those cases where we have high-quality energy matrices for comparison.</p><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>A visual comparison of the literature binding sites (left panel) and the extent of the binding sites discovered by our algorithmic approach (right panel).</title><p>RNAP-binding sites are also labeled in the right panel, but RNAP-binding sites are not included in the false positive analysis. Numeric values for the displayed data can be found in <xref ref-type="supplementary-material" rid="app2fig2sdata1">Appendix 2—figure 2—source data 1</xref>.</p><p><supplementary-material id="app2fig2sdata1"><label>Appendix 2—figure 2—source data 1.</label><caption><title>Data for information footprints and identified regions in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-app2-fig2-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-app2-fig2-v2.tif"/></fig><fig id="app2fig3" position="float"><label>Appendix 2—figure 3.</label><caption><title>A continuation of the visual comparison of the literature binding sites (left panel) and the binding sites discovered by our algorithmic approach (right panel) begun in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>.</title><p><supplementary-material id="app2fig3sdata1"><label>Appendix 2—figure 3—source data 1.</label><caption><title>Data for information footprints and identified regions in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 3</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-55308-app2-fig3-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-app2-fig3-v2.tif"/></fig><fig id="app2fig4" position="float"><label>Appendix 2—figure 4.</label><caption><title>A visual display of the results of the TOMTOM motif comparison between the discovered binding sites and known sequence motifs from RegulonDB and our prior Sort-Seq experiment (<xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref>).</title><p>Each dot in a given panel represents a comparison between the target position weight matrix (given in the figure title) and a position weight matrix for a given transcription factor. The p-value is calculated using the null hypothesis, that both motifs are drawn independently from the same underlying probability distribution. The red dotted line is displayed at a p-value of <inline-formula><mml:math id="inf44"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The line represents a p-value threshold of 0.05 that has been corrected for multiple hypothesis testing using the Bonferroni correction (95 motifs were compared against the target for a p-value threshold of <inline-formula><mml:math id="inf45"><mml:mrow><mml:mfrac><mml:mn>0.05</mml:mn><mml:mn>95</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>). Numeric values for the displayed data can be found in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 4-source data 1</xref>.</p><p><supplementary-material id="app2fig4sdata1"><label>Appendix 2—figure 4—source data 1.</label><caption><title>All p-values displayed in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 4</xref>.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-55308-app2-fig4-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-app2-fig4-v2.tif"/></fig></sec></boxed-text></app><app id="appendix-3"><title>Appendix 3</title><boxed-text><sec id="s12" sec-type="appendix"><title>Extended details of analysis methods</title><sec id="s12-1"><title>Information footprints</title><p>We favor the use of information footprints as a tool for hypothesis generation to identify regions which may contain transcription-factor-binding sites. In general, a mutation within a transcription factor site is likely to weaken that site. We look for groups of positions where mutation away from wild type has a large effect on gene expression. Our datasets consist of nucleotide sequences, the number of times we sequenced a given, specific mutated promoter in the plasmid library, and the number of times we sequenced its corresponding mRNA. A simplified illustrative dataset on a hypothetical 4 nucleotide sequence is shown in <xref ref-type="table" rid="app3table1">Appendix 3—table 1</xref>.</p><table-wrap id="app3table1" position="float"><label>Appendix 3—table 1.</label><caption><title>Example dataset of four nucleotide sequences, and the corresponding counts from the plasmid library and mRNAs.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Sequence</th><th>Library sequencing counts</th><th>mRNA counts</th></tr></thead><tbody><tr><td><named-content content-type="sequence">ACTA</named-content></td><td>5</td><td>23</td></tr><tr><td><named-content content-type="sequence">ATTA</named-content></td><td>5</td><td>3</td></tr><tr><td><named-content content-type="sequence">CCTG</named-content></td><td>11</td><td>11</td></tr><tr><td><named-content content-type="sequence">TAGA</named-content></td><td>12</td><td>3</td></tr><tr><td><named-content content-type="sequence">GTGC</named-content></td><td>2</td><td>0</td></tr><tr><td><named-content content-type="sequence">CACA</named-content></td><td>8</td><td>7</td></tr><tr><td><named-content content-type="sequence">AGGC</named-content></td><td>7</td><td>3</td></tr></tbody></table></table-wrap><p>One strategy to measure the impact of a given mutation on expression is to take all sequences which have base <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> at position <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and determine the number of mRNAs produced per read in the sequencing library. By comparing the values for different bases we can determine how large of an effect a mutation has on gene expression. For example in <xref ref-type="table" rid="app3table1">Appendix 3—table 1</xref>, for the second position (<inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) those sequences that contain the wild type base A (<inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:math></inline-formula>) have 20 sequencing counts out of 50 (<inline-formula><mml:math id="inf50"><mml:mrow><mml:mrow><mml:mn>23</mml:mn><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:mn>11</mml:mn><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>+</mml:mo><mml:mn>7</mml:mn><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula>) from the DNA library and 10 sequencing counts from the 50 (<inline-formula><mml:math id="inf51"><mml:mrow><mml:mrow><mml:mn>5</mml:mn><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>+</mml:mo><mml:mn>11</mml:mn><mml:mo>+</mml:mo><mml:mn>12</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mn>8</mml:mn><mml:mo>+</mml:mo><mml:mn>7</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula>) mRNA reads. For all other sequences (<inline-formula><mml:math id="inf52"><mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> or T), there are 30 sequencing counts from the DNA library and 40 sequencing counts from mRNA. A measure of the effect of mutation on expression would be to compare the ratios <inline-formula><mml:math id="inf53"><mml:mfrac><mml:mrow><mml:mpadded width="+1.7pt"><mml:mtext>mRNA counts</mml:mtext></mml:mpadded><mml:mo rspace="4.2pt">/</mml:mo><mml:mtext>total mRNA counts</mml:mtext></mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mtext>library counts</mml:mtext></mml:mpadded><mml:mo rspace="4.2pt">/</mml:mo><mml:mtext>total library counts</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula> between mutated and wild-type sequences. For the data in <xref ref-type="table" rid="app3table1">Appendix 3—table 1</xref>, sequences with a wild type base at position 2 will have a ratio of purple <inline-formula><mml:math id="inf54"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>/</mml:mo><mml:mn>50</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo>/</mml:mo><mml:mn>50</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> and sequences with a mutated base at position 2 will have a ratio of <inline-formula><mml:math id="inf55"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>40</mml:mn><mml:mo>/</mml:mo><mml:mn>50</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>30</mml:mn><mml:mo>/</mml:mo><mml:mn>50</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mn>1.3</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>While directly comparing ratios is one way to measure the effect on gene expression, we use mutual information to quantify the effect of mutation, as <xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref> demonstrated could be done successfully. In <xref ref-type="table" rid="app3table1">Appendix 3—table 1</xref>, the frequency of the nucleotide A in the DNA library at position 2 is 0.4, as 20 out of 50 sequencing counts have an A at position 2. Similarly, the other frequencies at position 2 are 0.32 for C, 0.14 for G and 0.14 for T. In the observed mRNA sequence counts, we find C at 34 of of 50 total mRNA counts, which gives a frequency of 0.68, indicating that Cytosine is enriched in the mRNA transcripts compared to the DNA library. The frequencies for the other bases are 0.2 for A, 0.06 for T and 0.06 for G. Large enrichment of a base compared to others in mRNA sequencing counts occurs when base identity is important for gene expression.</p><p>We are classifying bases as either wild type (<inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) or mutated (<inline-formula><mml:math id="inf57"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). A discussion of this assumption can be found at the end of this section. We compute mutual information at position <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> as<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf59"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the ratio of the number of DNA (<inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) or mRNA (<inline-formula><mml:math id="inf61"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) sequencing counts to the total number of counts,<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mstyle displaystyle="false"><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mtext>(mRNA counts)</mml:mtext><mml:mo>/</mml:mo><mml:mtext>(total counts)</mml:mtext></mml:mrow></mml:mrow></mml:mstyle></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mtext>(Library Sequencing counts)</mml:mtext><mml:mo>/</mml:mo><mml:mtext>(total counts)</mml:mtext></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>From the example data in <xref ref-type="table" rid="app3table1">Appendix 3—table 1</xref> we can calculate <inline-formula><mml:math id="inf62"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. To do so, we sum up DNA counts and mRNA counts from all sequences and divide by the total number of counts (<inline-formula><mml:math id="inf63"><mml:mrow><mml:mrow><mml:mn>50</mml:mn><mml:mo>+</mml:mo><mml:mn>50</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>) to obtain<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In addition, <inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the fraction of the total counts that either have a mutation (<inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) at the given position or the fraction that have a wild-type base (<inline-formula><mml:math id="inf66"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) at the position. <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> has to be computed for each position individually. For position 1, the wild type base is an A, and we see that there are a total of 100 sequencing counts, of which 46 counts (DNA and mRNA combined) contain an A at position 1. Therefore, <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be calculated for position 1 as<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0.46</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0.54</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Lastly, the joint distribution <inline-formula><mml:math id="inf69"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability that a given sequencing read in the dataset will have expression level µ and mutation status <italic>m</italic>. <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is calculated by dividing the number of sequencing reads at the chosen position with mutation status <italic>m</italic> and expression status µ by the total number of sequencing reads. In the case of the example dataset in <xref ref-type="table" rid="app3table1">Appendix 3—table 1</xref> and for <inline-formula><mml:math id="inf71"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we sum the sequencing reads that are wild type at position 1 and also are in the DNA library. As there are 17 sequences that fit the criteria out of 100 total sequences, <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.17</mml:mn></mml:mrow></mml:math></inline-formula>. The other values of <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be calculated to be<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0.17</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:mn>0</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mtext>(wild type base)</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mtext>and</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:mn>0</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext>(DNA)</mml:mtext></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0.21</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:mn>1</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mtext>(mutated base)</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mtext>and</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:mn>1</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext>(RNA)</mml:mtext></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0.33</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:mn>1</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mtext>and</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0.29</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:mn>0</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mtext>and</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The marginal distributions <inline-formula><mml:math id="inf75"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be obtained by summing over one of the two variables, that is,<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>m</mml:mi></mml:munder></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:munder></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Plugging the values calculated above into <xref ref-type="disp-formula" rid="equ6">Equation (6)</xref> yields a mutual information value of 0.06 bits at position 1. The unit is bits because the mutual information is computed with a logarithm of base 2. Other bases can be chosen, however, that results in different units for the mutual information.</p><p>Mutual information is a measurement that quantifies how much the measurement of one of two variables reduces uncertainty of the other variable. For example, very low mutual information means that by knowing one variable one gains no information about the other variable, while on the other hand high mutual information means that by knowing one variable our knowledge about the others increases. At a position where base identity matters little for expression level, there would be little difference in the frequency distributions for the library and mRNA transcripts. The entropy of the distribution would decrease only by a small amount when considering the two types of sequencing reads separately.</p><p>We seek to determine the effect on gene expression of mutating a given base. However, if mutation rates at each position are not fully independent such that <inline-formula><mml:math id="inf77"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≠</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, then the information value calculated in <xref ref-type="disp-formula" rid="equ6">Equation (6)</xref> will also encode the effect of mutation at correlated positions. For instance, if position <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is part of an activator-binding site, mutating it will have a large effect on gene expression. If position <inline-formula><mml:math id="inf79"><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> is not within the activator site, then mutating position <inline-formula><mml:math id="inf80"><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> will have minimal true effect on gene expression. However, if mutations at the two bases are correlated, mutating position <inline-formula><mml:math id="inf81"><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> will make it more likely for <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and therefore the activator-binding site, to be mutated. Knowledge that <inline-formula><mml:math id="inf83"><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> is mutated is predictive of overall expression, and so position <inline-formula><mml:math id="inf84"><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> will have high mutual information according to <xref ref-type="disp-formula" rid="equ6">Equation (6)</xref>, even though that position has no regulatory function. In our experiment we designed sequences to be synthesized such that each position had a probability of mutation that was independent of mutation at any other position. However, due to errors in the oligonucleotide synthesis process, additional mutations in the ordered sequences were introduced. Sequencing our DNA libraries reveals that mutation at a given base pair can make mutation at another base pair more likely by up to 10%, where neighboring base pairs are the most likely to have correlations between mutations. This is enough to cloud the signature of most transcription factors in an information footprint calculated using <xref ref-type="disp-formula" rid="equ6">Equation (6)</xref>.</p><p>We need to determine values for <inline-formula><mml:math id="inf85"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> when mutations are independent, and to do this we need to fit these quantities from our data. We assert that<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>mRNA</mml:mi></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>is a reasonable approximation to make, which we will justify by considering a number of possible regulatory scenarios. <inline-formula><mml:math id="inf86"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>mRNA</mml:mi></mml:msub><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula> is the average number of mRNAs produced and <inline-formula><mml:math id="inf87"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is an effective binding energy for the sequence that can be determined by summing contributions from each position in the sequence independently. There are many possible underlying regulatory architectures, and those that have been discovered with Reg-Seq are summarized in <xref ref-type="table" rid="table1">Table 1</xref>. While we will show that under reasonable assumptions this approach is useful for any of these regulatory architectures, let us first consider the simple case where there is only an RNAP site in the region under study. We can write down an expression for average gene expression per cell as<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>mRNA</mml:mi></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf88"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the probability that the RNAP is bound to DNA and is known to be proportional to gene expression in <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib1">Ackers et al., 1982</xref>; <xref ref-type="bibr" rid="bib12">Buchler et al., 2003</xref>; <xref ref-type="bibr" rid="bib24">Garcia and Phillips, 2011</xref>), <inline-formula><mml:math id="inf89"><mml:msub><mml:mi>E</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> is the energy of RNAP binding, <inline-formula><mml:math id="inf90"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of nonspecific DNA binding sites, and <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of RNAP. If RNAP binds weakly then <inline-formula><mml:math id="inf92"><mml:mrow><mml:mrow><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and we can simplify <xref ref-type="disp-formula" rid="equ14">Equation (14)</xref> to<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>mRNA</mml:mi></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using this relation, we can compute the ratio of average mRNA counts in wild type <inline-formula><mml:math id="inf93"><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>mRNA</mml:mi><mml:msub><mml:mi>WT</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula> to average mRNA counts in a mutant <inline-formula><mml:math id="inf94"><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>mRNA</mml:mi><mml:msub><mml:mi>Mut</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow></mml:math></inline-formula> as<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf95"><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>WT</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:msub></mml:math></inline-formula> is the binding energy of RNAP to the wild-type binding site and <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>Mut</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:msub></mml:math></inline-formula> is the binding energy of RNAP to the mutant-binding site. Using the assumption that each position contributes independently to the binding energy, we can simplify the differences in energies to <inline-formula><mml:math id="inf97"><mml:mrow><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>WT</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>Mut</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We can now calculate the probability of finding a specific base in the expressed sequences. If the probability of finding a wild type base at position <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in the DNA library is <inline-formula><mml:math id="inf99"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, then<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:msub><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Under certain conditions, we can also infer a value for <inline-formula><mml:math id="inf100"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using a linear model when there are any number of activator or repressor-binding sites. We will demonstrate this in the case of a single activator and a single repressor, although a similar analysis can be done when there are greater numbers of transcription factors. Define <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>A</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of activators, and <inline-formula><mml:math id="inf104"><mml:msub><mml:mi>E</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> is the binding energy of the activator. Also define <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>R</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of repressors and <inline-formula><mml:math id="inf107"><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> is the binding energy of the repressor. Then we can compute the average number of produced mRNA as<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>mRNA</mml:mi></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the interaction energy of activators and the RNAP. One assumption we make is that activators and RNAP bind weakly to their binding sites (<inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>a</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) but interact strongly (<inline-formula><mml:math id="inf111"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>≫</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>). Under this assumption, RNAP and associated activators are much more likely to bind DNA as a unit than separately. The binding energy measurements by <xref ref-type="bibr" rid="bib19">Forcier et al., 2018</xref> support this assumption in the case of CRP in the <italic>lac</italic> operon. The DNA-protein binding energy of CRP is measured to be -3.18 <inline-formula><mml:math id="inf112"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> and the interaction energy between CRP and RNAP is measured to be <inline-formula><mml:math id="inf113"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>6.56</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The copy number of CRP is <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi>A</mml:mi><mml:mo>≈</mml:mo><mml:mn>4000</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib76">Schmidt et al., 2016</xref>), the copy number of RNAP is <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≈</mml:mo><mml:mn>2000</mml:mn></mml:mrow></mml:math></inline-formula> in slowly growing cells (<xref ref-type="bibr" rid="bib9">Bremer and Dennis, 1996</xref>), and the RNAP binding energy for the wild type <italic>lac</italic> promoter is <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mo>−</mml:mo><mml:mn>5.2</mml:mn><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib10">Brewster et al., 2012</xref>). As <inline-formula><mml:math id="inf117"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mn>4.6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, the value of <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> can be calculated to be <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi>a</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mfrac><mml:mn>4000</mml:mn><mml:mrow><mml:mn>4.6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mn>3.18</mml:mn></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula>. Similarly <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> can be calculated to be <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mfrac><mml:mn>2000</mml:mn><mml:mrow><mml:mn>4.6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mn>5.2</mml:mn></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.08</mml:mn></mml:mrow></mml:math></inline-formula>. Lastly, we can calculate <inline-formula><mml:math id="inf122"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mn>6.56</mml:mn></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. We can see that these numbers satisfy the assumptions <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>a</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf125"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>≫</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>. We can simplify <xref ref-type="disp-formula" rid="equ20">Equation (20)</xref> to<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>mRNA</mml:mi></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The last assumption we make is that repressors bind very strongly (<inline-formula><mml:math id="inf126"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf127"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≫</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>). To justify this assumption, we once again look to the lac operon. Wild-type LacI copy number is <inline-formula><mml:math id="inf128"><mml:mrow><mml:mi>R</mml:mi><mml:mo>≈</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> and the wild-type binding energy for the O1 operator is <inline-formula><mml:math id="inf129"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>16</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib24">Garcia and Phillips, 2011</xref>). We can use these values to compute <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mfrac><mml:mn>10</mml:mn><mml:mrow><mml:mn>4.6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mn>16</mml:mn></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>. We can simplify <xref ref-type="disp-formula" rid="equ21">Equation (21)</xref> to<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mtext> </mml:mtext><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mtext> </mml:mtext><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>As we typically assume that RNAP binding energy, activator binding energy, and repressor binding can all be represented as sums of contributions from their constituent bases, the combination of the energies can be written as a total effective energy <inline-formula><mml:math id="inf131"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> which is a sum of independent contributions from all positions within the binding sites.</p><p>We fit the parameters for each base using Markov Chain Monte Carlo Method (MCMC). Two MCMC runs are conducted using randomly generated initial conditions. We require both chains to reach sufficiently similar distributions to prove the convergence of the chains or we repeat the runs. During the analysis, we artificially treat mutation rates at all positions as equal, as we do not wish for mutation rate to play a role in mutual information calculations. The information values are smoothed by averaging with neighboring values.</p><p>By only considering wild type or mutated energy contributions to the total effective binding energy rather than having separate values for energy contributions from all four base pairs, our methods will not be accurate in the case of calculating mutual information at locations with degenerate base pairs. However, the information footprints are intended to be hypothesis generation tools that can identify transcription-factor-binding sites. As such, the most important test for the assumption that we can approximate effective energy contributions from all 4 bases as contributions from only wild type or mutated bases is to assess whether the approximation has any effect on determining binding site locations. We re-ran the false positive and false negative assessments discussed in Appendix 2 Section 'False positive and false negative rates', but instead calculated the effective energy parameters for producing information footprints as a sum of contributions from all four bases. We find that the literature binding sites that were properly identified, as summarized in <xref ref-type="table" rid="app2table2">Appendix 2—table 2</xref>, are identically identified. Specifically, any site which was identified using the previous method is still identified and any site that failed to be identified is still not observed. Similarly, when we only fit effective energy parameters for mutated or wild type bases there are no false positives identified in the promoters for <italic>marR</italic>, <italic>relBE</italic>, <italic>dgoR</italic>, <italic>zupT</italic>, or <italic>lacZYA</italic>. There are also no false positives when repeating the procedure while considering all 4 bases in the effective energy fits, implying that the simplification to only considering mutated or wild type bases does not have an effect on our ability to identify binding sites.</p></sec><sec id="s12-2"><title>Processing of mass spectrometry experiments</title><p>Mass spectrometry results were processed using MaxQuant (<xref ref-type="bibr" rid="bib17">Cox and Mann, 2008</xref>; <xref ref-type="bibr" rid="bib16">Cox et al., 2009</xref>). Spectra were searched against the UniProt <italic>E. coli</italic> K-12 database as well as a contaminant database (256 sequences). LysC was specified as the digestion enzyme. Proteins were considered if they were known to be transcription factors, or were predicted to bind DNA (using gene ontology term GO:0003677, for DNA-binding in BioCyc).</p></sec><sec id="s12-3"><title>Uncertainty due to number of independent sequences</title><p>1400 promoter variants were ordered from TWIST Bioscience for each promoter studied. Due to errors in oligonucleotide synthesis, additional mutations are randomly introduced into the ordered oligos. We have found that, as a result of these random, additional errors, the final number of variants received was an average of 2200 per promoter.</p><p>To demonstrate that our results are not strongly dependent on the number of sequences in each promoter library, and also to assess how a reduction in the number of sequences per promoter library could facilitate larger scale experiments in the future, we generated examples of smaller data sets by computationally sub-sampling the Reg-Seq experimental data from seven mutated promoter libraries (<italic>maoP</italic>, <italic>hslU</italic>, <italic>rpsA</italic>, <italic>leuABCD</italic>, <italic>aphA</italic>, <italic>araC</italic>, and <italic>tig</italic>). These promoters are representative of a large cross-section of the variety of regulation we see in our study, as they include promoters with constitutive expression (<italic>hslU</italic>), simple repression(<italic>leuABCD</italic>, <italic>tig</italic>), simple activation (<italic>aphA</italic>), as well as more complicated regulatory architectures (<italic>maoP</italic>, <italic>rspA</italic>, <italic>araC</italic>). Each sub-sampling was done three times, and we then use the Pearson correlation coefficient (Appendix 2 Section 'Comparison between Reg-Seq by RNA-Seq and fluorescent sorting') as a comparison metric between the inference based on the full data set and the computationally sub-sampled data sets.</p><p>Based on our analysis, the results of which are displayed in <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>, we find that there is only a small effect on the resulting sequence logo until the library has been reduced to approximately 500 promoter variants. We could, therefore, reasonably lower the resolution of the experiment to approximately 1000 or fewer unique sequences before large deviations in the inference are experienced. Decreasing the number of unique sequences can give modest boosts to the number of genes that can be studied, but will not be able to give order of magnitude increases in the number of genes that can be explored.</p><fig id="app3fig1" position="float"><label>Appendix 3—figure 1.</label><caption><title>Pearson correlation as a function of the number of unique DNA sequences (as explained in Appendix 2 Section 'Comparison between Reg-Seq by RNA-Seq and 2uorescent sorting').</title><p>For seven different genes, we studied how the number of mutated DNA sequences affects the reproducibility of our MCMC inference models. As the number of unique sequences increases, so too does the Pearson correlation value, approaching 1.0. Numeric values for the displayed data can be found in <xref ref-type="fig" rid="app3fig2">Appendix 3—figure 1—source data 1</xref>.</p><p><supplementary-material id="app3fig1sdata1"><label>Appendix 3—figure 1—source data 1.</label><caption><title>Pearson correlation values for <xref ref-type="fig" rid="app3fig2">Appendix 3—figure 1</xref>.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-55308-app3-fig1-data1-v2.txt"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-app3-fig1-v2.tif"/></fig></sec><sec id="s12-4"><title>Effect on calculated energy matrices when transcription factor copy number ≈ plasmid copy number</title><p>Throughout this study, we utilize plasmids to express GFP from mutated promoters, and then use the ratio of mRNA/DNA, based on sequencing results, to handle the effect of variability in plasmid copy number between cells. It is necessary, however, to consider the situation wherein the plasmid copy number is of a similar magnitude to the transcription factor copy number, and whether this can impact the calculated energy matrices and binding energies. The genetic expression levels are determined not only by the binding energy, but also by the transcription factor availability, and so it is necessary to consider whether, for those cases where transcription factor copy number ≈ plasmid copy number, there is a corresponding under-estimation of binding energies. Prior work from our laboratory was precisely aimed at rigorously predicting and measuring this effect (<xref ref-type="bibr" rid="bib90">Weinert et al., 2014</xref>). In that study, we demonstrated how to control this effect, wherein transcription factor copy number ≈ plasmid copy number, in a parameter-free manner. However, to mitigate this effect in future studies, we plan to use genome-integrated libraries, rather than plasmid-based expression.</p><p>The plasmid used in our experiments is derived from pUA66, which contains a pSC101 origin of replication (<xref ref-type="bibr" rid="bib95">Zaslaver et al., 2006</xref>). The copy number of plasmids with a pSC101 origin is, in log phase, approximately 3 or 4 (<xref ref-type="bibr" rid="bib57">Lutz and Bujard, 1997</xref>). We have not independently assessed the copy number of the plasmid used in this study.</p><p>The absolute copy number of thousands of proteins in <italic>E. coli</italic> have been determined using whole-proteome LC-MS. Specifically, a 2016 study that provides the absolute quantification for roughly 55 percent of predicted proteins in the <italic>E. coli</italic> K12 proteome (see Supplementary Table S6) (<xref ref-type="bibr" rid="bib76">Schmidt et al., 2016</xref>). For those transcription factors that were quantified in that study, and also show up in our Reg-Seq experiments, we provide their absolute quantification in <italic>E. coli</italic> K12 for both glucose and LB growth media in <xref ref-type="table" rid="app3table2">Appendix 3—table 2</xref>.</p><table-wrap id="app3table2" position="float"><label>Appendix 3—table 2.</label><caption><title>Global, absolute quantification for most transcription factors identified in this study, as determined for <italic>E. coli</italic> K12 grown in both glucose (5 g/L concentration in M9 minimal media) and LB medias.</title><p>The values in this table are reprinted from <xref ref-type="bibr" rid="bib76">Schmidt et al., 2016</xref> Supplemental Table S6.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Transcription factor name</th><th>Glucose</th><th>LB</th></tr></thead><tbody><tr><td>FNR</td><td>609</td><td>1101</td></tr><tr><td>YieP</td><td>158</td><td>261</td></tr><tr><td>YciT</td><td>82</td><td>104</td></tr><tr><td>NsrR</td><td>872</td><td>136</td></tr><tr><td>LexA</td><td>560</td><td>1027</td></tr><tr><td>DeoR</td><td>26</td><td>34</td></tr><tr><td>CRP</td><td>2048</td><td>3450</td></tr><tr><td>YdfH</td><td>96</td><td>154</td></tr><tr><td>ArcA</td><td>3367</td><td>5464</td></tr><tr><td>Zur</td><td>70</td><td>130</td></tr><tr><td>GlpR</td><td>75</td><td>145</td></tr><tr><td>PhoP</td><td>2967</td><td>3132</td></tr><tr><td>HNS</td><td>22541</td><td>47133</td></tr><tr><td>StpA</td><td>6863</td><td>5241</td></tr><tr><td>DicA</td><td>20</td><td>25</td></tr><tr><td>YgbI</td><td>2</td><td>6</td></tr><tr><td>XylR</td><td>1</td><td>8</td></tr></tbody></table></table-wrap><p>For most transcription factors, the copy number as determined by LC-MS is much greater than the expected, low copy number of the plasmid used in this study, thus mitigating the concern that the limited availability of a transcription factor could impact gene expression.</p><p>There are a few transcription factors that have copy number on the order of the plasmid copy number, however, including XylR, DicA, and YgbI. Prior work from our group (<xref ref-type="bibr" rid="bib90">Weinert et al., 2014</xref>) has explored how gene expression behaves in the regime where transcription factor copy number is ≈ plasmid copy number. Here, we will discuss the case of simple repression to demonstrate how the relationship between transcription factor and plasmid copy number could impact our results. The standard thermodynamic model for gene expression under simple repression with a weak promoter, as described by <xref ref-type="bibr" rid="bib7">Bintu et al., 2005</xref>, is<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>∝</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mi>R</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is a measurement for gene expression level, <inline-formula><mml:math id="inf133"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of nonspecific DNA-binding sites, <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of RNAP, and <inline-formula><mml:math id="inf135"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of repressors. <inline-formula><mml:math id="inf136"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represent the difference in the repressor-binding energy and RNAP-binding energy between the specific binding site and the averaged nonspecific genomic background respectively. <xref ref-type="bibr" rid="bib90">Weinert et al., 2014</xref> demonstrated experimentally that, in the presence of multiple target binding sites, such as from a multi-copy plasmid, the gene expression level can be described by a very similar functional form to <xref ref-type="disp-formula" rid="equ24">Equation (24)</xref>, namely,<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>∝</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf138"><mml:msub><mml:mi>λ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf139"><mml:msub><mml:mi>λ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> are the fugacity of RNAP and the repressor and describe the relative availability of RNAP or repressor as a function of plasmid copy number, transcription factor copy number, and binding site strength. The presence of additional plasmid copies does weaken the effect of repressor binding when the repressor copy number is ≈ plasmid copy number. Thus, our information footprint calculations will be affected and the information signature of binding sites such as YgbI, DicA, or XylR will be decreased.</p><p>For transcription-factor-binding site interactions that are sufficiently weak, together with a low transcription factor copy number, the effect of having multiple plasmids expressed in a cell could cause us to have a false negative, and thus miss the presence of a binding site. However, the Reg-Seq method does not claim to capture every regulatory feature for a given promoter, as the activity of some transcription factors is induced only in certain growth conditions, we use a finite, 160 bp mutation window that may miss 'regulation at a distance', and the presence of extremely weak and nonspecific binding sites may cause Reg-Seq to 'miss' some transcription factors (indeed, for the <italic>bdcR</italic> promoter, the GlaR-binding site is outside of the mutagenized region and so is not observed). The effect of additional plasmids within the cellular confines will always decrease the fugacity in <xref ref-type="disp-formula" rid="equ25">Equation (25)</xref>, as an increase in the number of sites competing for a limited pool of transcription factors will decrease the relative availability of those transcription factors. As a result, the effect on gene expression of a given transcription factor will always lessen in the presence of additional plasmids. This means that, while multi-copy plasmids can introduce false negatives into Reg-Seq, it will not introduce false positives. Additionally, we see empirically that, even for the lowest copy transcription factor for which we have a measurement, XylR (≈ 1 copy per cell), we can identify its transcription-factor-binding site. In <xref ref-type="fig" rid="app2fig2">Appendix 2—figures 2</xref> and <xref ref-type="fig" rid="app2fig3">3</xref>, 2 (previously known) XylR sites are identified for the <italic>xylA</italic> promoter, and 2 (previously known) XylR sites are identified in the <italic>xylF</italic> promoter.</p><p>Finally, the energy matrices, which are a quantitative output of the Reg-Seq experiment, will be unaffected by the presence of multi-copy plasmids. As discussed in Appendix 3 Section 'Energy matrix inference', energy matrix inference relies on calculating the mutual information between the energy predictions of the model and the experimental data. Mutual information is invariant under transformations to the input variables that do not affect their rank order. While the presence of multiple plasmid copies will affect the fugacity in <xref ref-type="disp-formula" rid="equ25">Equation (25)</xref>, and so will also affect any quantitative prediction of gene expression, a weaker repressor-binding site will still be predicted to have higher gene expression than a stronger repressor-binding site, regardless of the relative availability of the transcription factor. The rank-order is always preserved and so the presence of a multi-copy plasmid will not change the mutual information between model predictions and experimental data. As a result, the final inference of energy matrices will remain the same.</p></sec><sec id="s12-5"><title>Energy matrix inference</title><p>Energy matrices in this experiment are of the form shown in <xref ref-type="table" rid="app3table3">Appendix 3—table 3</xref>,</p><table-wrap id="app3table3" position="float"><label>Appendix 3—table 3.</label><caption><title>Example energy matrix.</title><p>This matrix is in arbitrary units, and the process to obtain absolute units (in <inline-formula><mml:math id="inf140"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>) is described in Appendix 3 Section 'Inference of scaling factors for energy matrices'.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Pos</th><th align="center">A</th><th align="center">C</th><th align="center">G</th><th align="center">T</th></tr></thead><tbody><tr><td>0</td><td align="char">−0.01</td><td align="char">−0.01</td><td align="char">−0.01</td><td align="char">0.03</td></tr><tr><td>1</td><td align="char">0.002</td><td align="char">0.05</td><td align="char">−0.06</td><td align="char">0.008</td></tr><tr><td>2</td><td align="char">−0.0002</td><td align="char">−0.04</td><td align="char">0.008</td><td align="char">0.03</td></tr><tr><td>3</td><td align="char">−0.02</td><td align="char">0.02</td><td align="char">−0.01</td><td align="char">0.01</td></tr></tbody></table></table-wrap><p>where each entry gives the energy contribution from a base pair at a given location. As an example from <xref ref-type="table" rid="app3table3">Appendix 3—table 3</xref>, an A at position 1 would give a total energy contribution of −0.01 (A.U.). All energy matrices used in our analysis are linear energy matrices, where the total energy is the sum of contributions from each base pair. As a result, total binding energy is<disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:mrow><mml:mrow><mml:mtext>binding energy</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the Kronecker delta, which takes on a value of 1 if the base at position <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is equal to <italic>j</italic> and is 0 otherwise, <italic>L</italic> is the length of the binding site, and <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the energy contribution of nucleotide <italic>j</italic> and position <inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in arbitrary units. To infer the parameters <inline-formula><mml:math id="inf145"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ26">Equation (26)</xref> from the experimental data, we perform Bayesian inference using a MCMC method, which requires us to calculate the likelihood of the model given the experimental data. The likelihood function is difficult to determine, but <xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref> found that, given a large amount of data, the likelihood function is related to the mutual information between energy predictions and data by the equation<disp-formula id="equ27"><label>(27)</label><mml:math id="m27"><mml:mrow><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the total number of independent sequences, <italic>D</italic> is the data consisting of sequences and measured sequencing counts, <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the mutual information between gene expression label µ and energy predictions <italic>E</italic>. µ is a discrete variable that characterizes the gene expression level as described in <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref> in the main text. We can calculate mutual information using the formula for mutual information between a continuous and a discrete variable, namely,<disp-formula id="equ28"><label>(28)</label><mml:math id="m28"><mml:mrow><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo rspace="0pt">d</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>E</mml:mi></mml:mpadded></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover></mml:mpadded><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>While <xref ref-type="disp-formula" rid="equ28">Equation (28)</xref> is used for continuous energy predictions, there are only <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> total sequences, and so only <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> discrete energy predictions. For a simple example of calculating the joint probability distribution <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, consider the hypothetical dataset of only four nucleotides in <xref ref-type="table" rid="app3table1">Appendix 3—table 1</xref>. We first predict the binding energy of each of the example sequences, shown in <xref ref-type="table" rid="app3table4">Appendix 3—table 4</xref>.</p><table-wrap id="app3table4" position="float"><label>Appendix 3—table 4.</label><caption><title>Example dataset with energy predictions.</title><p>Energy predictions are made by applying the example energy matrix in <xref ref-type="table" rid="app3table3">Appendix 3—table 3</xref> to the example dataset in <xref ref-type="table" rid="app3table1">Appendix 3—table 1</xref> according to <xref ref-type="disp-formula" rid="equ26">Equation (26)</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th><inline-formula><mml:math id="inf151"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></th><th align="left"><inline-formula><mml:math id="inf152"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></th><th align="center">Energy (<inline-formula><mml:math id="inf153"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula></th></tr></thead><tbody><tr><td>5</td><td>23</td><td align="char">0.05</td></tr><tr><td>5</td><td>3</td><td align="char">0.008</td></tr><tr><td>11</td><td>11</td><td align="char">0.09</td></tr><tr><td>12</td><td>3</td><td align="char">−0.03</td></tr><tr><td>2</td><td>0</td><td align="char">0.03</td></tr><tr><td>8</td><td>7</td><td align="char">−0.07</td></tr><tr><td>7</td><td>3</td><td align="char">−0.04</td></tr></tbody></table></table-wrap><p>We use kernel density estimation with kernel width of 4% to estimate the true joint distribution <inline-formula><mml:math id="inf154"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from the data contained in the joint distribution in the matrix in <xref ref-type="table" rid="app3table4">Appendix 3—table 4</xref>. This process estimates an underlying continuous distribution from a discrete set of energy predictions. The details of kernel density estimation can be found in <xref ref-type="bibr" rid="bib32">Hastie et al., 2009</xref>. We can do the final calculation of the mutual information by splitting the smoothed joint distribution into 500 energy 'bins' <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and calculating<disp-formula id="equ29"><label>(29)</label><mml:math id="m29"><mml:mrow><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>500</mml:mn></mml:munderover><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>With the ability to calculate the likelihood of an energy matrix model, MCMC can be used to infer the posterior distribution for our model. First a random matrix model is generated. The model is perturbed and the new model is accepted or rejected based on the Metropolis-Hastings algorithm (<xref ref-type="bibr" rid="bib67">Patil et al., 2010</xref>). After an initial burn in period of 60,000 steps, iterations are saved every 60 steps. A total of 600,000 iterations are performed. This procedure is performed twice for each model, and if inferred models do not have a Pearson correlation coefficient of 0.99 or higher they are discarded and computed again. A complete overview of the computational pipeline can be found at the GitHub wiki page.</p></sec><sec id="s12-6"><title>Inference of scaling factors for energy matrices</title><p>For the majority of energy matrices reported in our work, the results are given in arbitrary units. This is a direct result of using the method of <xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref> to infer our matrices. The method appeals to information theory to write an 'error-model-averaged' likelihood function for a given model. The likelihood function is given in <xref ref-type="disp-formula" rid="equ27">Equation (27)</xref>. A property of mutual information is that it is invariant to changes in the input variables as long as those transformations do not affect the rank-order of those variables. As a result, we can scale the energy predictions by any constant without changing the likelihood of the model, which means that in the case of simple linear models for transcription factor binding we cannot assign absolute units to energy matrix values. When we widen our view to considering promoter regions rather than single binding sites we can overcome this drawback. Using thermodynamic modeling as outlined in <xref ref-type="bibr" rid="bib7">Bintu et al., 2005</xref>, we can predict the gene expression from any given transcriptional architecture. In the case a thermodynamic model of simple repression the expression is given by<disp-formula id="equ30"><label>(30)</label><mml:math id="m30"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>∝</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mi>R</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is a measurement for expression, <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of RNAP, <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of repressors and <inline-formula><mml:math id="inf159"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of nonspecific binding sites. <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represent the difference in the repressor binding energy and RNAP-binding energy between the specific binding site and the averaged nonspecific genomic background respectively. As we use linear energy matrix models as described in Appendix 3 Section 'Energy matrix inference', <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> will be given by <xref ref-type="disp-formula" rid="equ26">Equation (26)</xref>. In these cases the overall rank order of gene expression predictions will change if you scale the energy matrix, and so the absolute units can be determined (<xref ref-type="bibr" rid="bib44">Kinney and Atwal, 2014</xref>). <xref ref-type="disp-formula" rid="equ30">Equation (30)</xref> is a more complicated and non-linear functional form for predicting <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> than a simple linear binding model, and has a correspondingly more difficult to sample posterior. To address complications in the inference, we first only use the non-linear fits to fix overall scale and wild-type energy for energy matrices rather than fit all parameters in this way. In other words, we use the standard fitting procedure to find the <inline-formula><mml:math id="inf165"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in the <xref ref-type="disp-formula" rid="equ26">Equation (26)</xref> using the standard MCMC procedure.</p><p>The binding energy matrices can be written <inline-formula><mml:math id="inf166"><mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is a constant that scales the matrix from arbitrary units to absolute units (<inline-formula><mml:math id="inf168"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>) and <inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is an additive constant that relates to the wild-type energy. We fit the constants <inline-formula><mml:math id="inf170"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for the transcription factor binding energy using the thermodynamic model in <xref ref-type="disp-formula" rid="equ30">Equation (30)</xref>.</p><p>While we can in principle fit thermodynamic models to any given architecture, these models are non-linear and, due to numerical difficulties, unreliable for sufficiently complex models. We only use this method on examples of simple repression or activation without more than one prominent RNAP model, whose transcription-factor-binding site does not overlap significantly with RNAP −10 or −35 sites. The scaling factors we discovered are given in <xref ref-type="table" rid="app3table5">Appendix 3—table 5</xref>.</p><table-wrap id="app3table5" position="float"><label>Appendix 3—table 5.</label><caption><title>A table showing scaling factors to convert arbitrary units to absolute units in <inline-formula><mml:math id="inf172"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>.</title><p>Growth conditions indicate the energy matrix and dataset used in the fit. In some growth condition additional regulatory features will be present, meaning specify condition is important.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Gene</th><th>Growth</th><th>Scaling factor <italic>A</italic></th></tr></thead><tbody><tr><td><italic>tff-rpsB-tsf</italic></td><td>Heat shock</td><td><inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>8.1</mml:mn><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><italic>tig</italic></td><td>Heat shock</td><td><inline-formula><mml:math id="inf174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>26.3</mml:mn><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><italic>yjjJ</italic></td><td>Heat shock</td><td><inline-formula><mml:math id="inf175"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>11.3</mml:mn><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><italic>bdcR</italic></td><td>Heat shock</td><td><inline-formula><mml:math id="inf176"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>9.9</mml:mn><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><italic>fdhE</italic></td><td>Anaerobic growth</td><td><inline-formula><mml:math id="inf177"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>6.34</mml:mn><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><italic>ykgE</italic></td><td>Arabinose</td><td><inline-formula><mml:math id="inf178"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>12.1</mml:mn><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><italic>dicC</italic></td><td>Arabinose</td><td><inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>15.1</mml:mn><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><italic>rspA</italic></td><td>Arabinose</td><td><inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>5.5</mml:mn><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr></tbody></table></table-wrap><p>We perform the inference using parallel tempering MCMC, where multiple chains are run in parallel with different 'temperatures'. High temperature chains widely explore parameter space, escaping any local optima, while low temperature chains optimize locally. The current parameter values of the chains are exchanged periodically. The fitting procedure is done using the emcee ensemble sampler (<xref ref-type="bibr" rid="bib27">Goodman and Weare, 2010</xref>) with 10 temperatures ranging from 1 to 10,000 on a log scale.</p></sec><sec id="s12-7"><title>Examination of promoters for which no RNAP site was found</title><p>We failed to find an RNAP site for 18 promoter sequences. In order to understand these sequences in more detail we examine the sequences within 50 bases of the TSS for the 18 genes in question for sequences which resemble the known consensus RNAP-binding site. For this comparison, we use the <inline-formula><mml:math id="inf181"><mml:msup><mml:mi>σ</mml:mi><mml:mn>70</mml:mn></mml:msup></mml:math></inline-formula> consensus binding sequence <sup>−35</sup>TTGACA - spacer sequence - TGNTATAAT<sup>−7</sup> (where the superscripts <sup>−35</sup> and <sup>−7</sup> indicate the position relative to the TSS). The consensus sequence we use for comparison contains the extended −10 element, consisting of a TG at bases −15 and −14 as we have found those to be important for gene expression in our study. The spacer length is between 15 and 13 bases (the typically reported spacer length is between 18 and 16 but this does not include the extended minus 10 element). The consensus sequence for the heat shock <inline-formula><mml:math id="inf182"><mml:mi>σ</mml:mi></mml:math></inline-formula> factor was used for the promoter <italic>yajL</italic>.</p><p>Previously, to analyze RNAP sites, we have examined energy matrices produced by Reg-Seq. Now we add an examination of wild type sequences. For each promoter, we found the best match to the consensus site, namely the sequence with the fewest mutations compared to the consensus sequence. We use the number of mutations as a measure of how well the site resemble consensus. We find that 16 out of 18 promoters have at least five mutations in the sequence that most closely resembles RNAP, one promoter has four mutations, and the last has three mutations. To put these numbers into context, <xref ref-type="bibr" rid="bib10">Brewster et al., 2012</xref> measured the RNAP binding energies of several RNAP-binding site mutants. Mutations away from the strongest sequence tested (<italic>lac</italic>UV5, which is two mutations away from consensus) yields a change in binding energy of <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. If the promoters are constitutive, then (in the weak promoter approximation) expression level will be proportional to <inline-formula><mml:math id="inf184"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> where <inline-formula><mml:math id="inf185"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the RNAP binding energy relative to the nonspecific background. Therefore, as an approximation, a sequence with three mutations would be predicted to be 3−10 fold weaker than a 'strong' RNAP site, and as such could be said to show a resemblance to the consensus RNAP site. However, 16 out of 18 of these promoter regions have, at best, extremely weak RNAP sites. It is important to note however, that even extremely weak RNAP sites often transcribe, especially when aided by activators. We do not intend to claim that RNAP does not bind to these promoter regions, merely that we do not detect it in our experiment. In fact, while the RNAP sites are weak, there is experimental evidence in EcoCyc of some level of transcription for 9 out of 18 promoters.</p></sec><sec id="s12-8"><title>TOMTOM motif comparison</title><p>In some cases, we used an alternative approach to mass spectrometry to discover the transcription factor identity regulating a given promoter based on sequence analysis using a motif comparison tool. TOMTOM (<xref ref-type="bibr" rid="bib29">Gupta et al., 2007</xref>) is a tool that uses a statistical method to infer if a putative motif resembles any previously discovered motif in a database. It accounts for all possible offsets between the motifs. Moreover, it uses a suite of metrics to compare between motifs such as Kullback-Leibler divergence, Pearson correlation, Euclidean distance, among others. All TOMTOM analyses in Reg-Seq utilize Euclidean distance. The method calculates a p-value under the null hypothesis that the two compared motifs are independently drawn from the same underlying distribution probability distribution.</p><p>We performed comparisons of the motifs generated from our energy matrices to those generated from all known transcription-factor-binding sites in RegulonDB. <xref ref-type="fig" rid="app3fig2">Appendix 3—figure 2</xref> shows a result of TOMTOM, where we compared the motif derived from the -35 region of the <italic>ybjX</italic> promoter and found a good match with the motif of PhoP from RegulonDB.</p><p>The information derived from this approach was then used to guide some of the transcription factor knockout experiments, in order to validate its interaction with a target promoter characterized by the loss of the information footprint. Furthermore, we also used TOMTOM to search for similarities between our own database of motifs, in order to generate regulatory hypotheses in tandem. This was particularly useful when looking at the group of GlpR-binding sites found in this experiment.</p><fig id="app3fig2" position="float"><label>Appendix 3—figure 2.</label><caption><title>Motif comparison using TOMTOM for the two PhoP-binding sites in the <italic>ybjX</italic> promoter.</title><p>Searching our energy motifs against the RegulonDB database using TOMTOM allowed us to guide our transcription factor knockout experiments. Here, we show the sequence logos of the PhoP transcription factor from RegulonDB (top) and the ones generated from the <italic>ybjX</italic> promoter energy matrix. E-value = 0.01 using Euclidean distance as a similarity matrix.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-app3-fig2-v2.tif"/></fig></sec></sec></boxed-text></app><app id="appendix-4"><title>Appendix 4</title><boxed-text><sec id="s13" sec-type="appendix"><title>Additional results</title><sec id="s13-1"><title>Binding sites regulating divergent operons</title><p>In addition to discovering new binding sites, we have discovered additional functions of known binding sites. In particular, in the case of <italic>bdcR</italic>, the repressor for the <italic>bdcA</italic> gene, which is transcribed from the same promoter in the opposite direction of transcription (<xref ref-type="bibr" rid="bib66">Partridge et al., 2009</xref>), is also shown to repress <italic>bdcR</italic> in <xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1(A)</xref>. Similarly in <xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1(B)</xref> IvlY is shown to repress <italic>ilvC</italic> in the absence of inducer. Divergently (transcription in opposite directions from the same promoter) transcribed operons that share regulatory regions are plentiful in <italic>E. coli</italic>, and although there are already many known examples of transcription-factor-binding sites regulating several different operons, there are almost certainly many examples of this type of transcription that have yet to be discovered.</p><fig id="app4fig1" position="float"><label>Appendix 4—figure 1.</label><caption><title>Two cases in which we see transcription-factor-binding sites that we have found to regulate both of the two divergently transcribed genes.</title><p>(<bold>A</bold>) An information footprint and regulatory cartoon for the divergently transcribed <italic>bdcA</italic> and <italic>bdcR</italic> promoters. A single NsrR site regulates both promoters. (<bold>B</bold>) An information footprint and regulatory cartoon for the <italic>ilvC</italic> and <italic>ilvY</italic> promoters. Both promoters are repressed by IlvY when grown without acetolactate. Only the IlvY site is labeled on the information footprint.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-app4-fig1-v2.tif"/></fig><p>In the case of <italic>ilvC</italic>, IlvY is known to activate <italic>ilvC</italic> in the presence of inducer. However, we now see that it also represses the promoter in the absence of that inducer. The production of <italic>ilvC</italic> is known to increase by approximately a factor of 100 in the presence of inducer (<xref ref-type="bibr" rid="bib73">Rhee et al., 1998</xref>). The magnitude of the change is attributed to the cooperative binding of two IlvY-binding sites, but the lowered expression of the promoter due to IlvY repression in the absence of inducer is also a factor.</p></sec><sec id="s13-2"><title>Comparison of results to RegulonDB</title><p>One area in which our work can be compared to current repositories of regulatory information such as RegulonDB is in comparing the prevalence of different regulatory architectures in the database to Reg-Seq. <xref ref-type="fig" rid="app4fig2">Appendix 4—figure 2</xref> shows the prevalence of each type of architecture (not including architectures more complex than 2 activators and 2 repressors) and shows how simpler architectures are more common in both cases.</p><p>Another point of comparison between RegulonDB and Reg-Seq can be found in comparing sequence motifs from Reg-Seq to those generated from binding sites in RegulonDB. This can often produce useful results, such as in Appendix 3 Section 'TOMTOM motif comparison'. For other cases, the data used to generate the RegulonDB motifs can be lacking. We believe the GlpR motif in RegulonDB highlights some of the issues with using the reported motifs in RegulonDB to predict binding preference. First, there are only four promoters regulated by GlpR, with a total of 17 binding sites for GlpR in RegulonDB. Nine of these binding sites differ by nine mutations or more from the consensus site (out of 22 total base pairs). Nine mutations is more than even the weak O3 operator for LacI. We do believe that a relatively low number of weakly conserved binding sites likely do not reveal quality sequence logos for a binding site, especially as compared to Reg-Seq which constructs sequence logos from over a thousand promoter variants. Generation of such sequence motifs is a point on which we believe Reg-Seq can improve the current status of regulatory knowledge.</p></sec><sec id="s13-3"><title>Explanation of included binding sites</title><p>This section is intended to clarify cases in which the regulatory cartoon or the displayed 'expected' binding sites differs from what can be found in RegulonDB or EcoCyc. The primary reason for these discrepancies is that our experiment only targets a 160 base pair mutation window. Some known binding sites will be outside of this window. Additionally, while some genes are known to be regulated by a specific transcription factor, the exact location of that transcription factor’s binding site is unknown and so we cannot be certain during the design of the 160 base pair mutagenized window whether or not the transcription-factor-binding site will be present in our experiment. The locations of the TSS selected in this experiment can be found in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>. Additionally, some transcription factors are known to only be active under certain growth conditions. Information footprints are depictions of the regulatory information for a specific growth condition; accordingly, not all transcription-factor-binding sites can be identified using a single growth condition. Throughout the main text and SI, however, we depict regulatory cartoons with their full milieu of transcription factors (based on experiments performed in multiple growth conditions).</p><p>When devising this study, we sought to test the reliability of the Reg-Seq method by testing experimentally-validated transcription-factor-binding sites, as reported by EcoCyc or RegulonDB, to assess our ability to recapitulate prior experiments. EcoCyc labels some transcription-factor-binding sites as 'low-evidence' in their database, most of which were identified via sequence motif matching. We have repeatedly observed that transcription-factor-binding sites identified from sequence matching are unreliable in relation to the empirical data collected in our experiment, and so we choose not to include them in the set of 'gold standard' genes which were used for this purpose of assessing Reg-Seq’s accuracy.</p><p>All of our 'gold standards' are genes for which there is high quality experimental evidence of their transcriptional regulation and the location of related transcription-factor-binding sites and, again, they were used to evaluate the false negative rates of our experiment. In those cases where the binding sites are either ’low-evidence’ according to EcoCyc, the location of a binding site is not known, a gene is only actively transcribed in certain or unknown growth conditions, or the binding site location is outside of the 160 bp mutagenized region, we do not include them in the list of sites we use to test our method even though they appear as binding sites in RegulonDB or EcoCyc. Regulatory features that are not transcription factors, including regulatory RNAs, are also not labeled in our reported results.</p><p>Accordingly, in some cases, the regulatory cartoons or architectures we present in this study may appear to be incomplete relative to previous reports of promoter architectures. For each gene below, we explain these discrepancies. This section is intended to explain why annotations on information footprints or regulatory cartoons do not match what is seen in RegulonDB or EcoCyc.</p><sec id="s13-3-1"><title>sdiA</title><p><italic>sdiA</italic> is known to be regulated by both Nac as well as CsrA (which has two binding sites), the CsrA sites are downstream of the mutated region and the location of the Nac-binding site is unknown. Thus, none of these binding sites are reported in our regulatory architectures for this gene.</p></sec><sec id="s13-3-2"><title>yqhC</title><p><italic>yqhC</italic> is known to be regulated by GlaR, but the location of this binding site is unknown. As a result, we were unable to identify this binding site in our analysis, and the architecture for <italic>yqhC</italic> is listed in this study as (0,0).</p></sec><sec id="s13-3-3"><title>bdcR</title><p><italic>bdcR</italic> is known to be regulated by GlaR, but this binding site is outside of the targeted mutation window of 160 bp. A known binding site for NsrR is included within the 160 bp region, but it was not previously known to regulate <italic>bdcR</italic>; the binding site for NsrR is included as a new discovery as shown in Section 'Binding sites regulating divergent operons'.</p></sec><sec id="s13-3-4"><title>aegA</title><p><italic>aegA</italic> has a predicted CRP-binding site, but the location of this binding site is unknown and it is also listed as low-evidence in EcoCyc. As a result, the site is not included within this study’s analysis.</p></sec><sec id="s13-3-5"><title>hicB</title><p>The CRP site associated with <italic>hicB</italic> is cited as low-evidence in EcoCyc and the HicB-binding site is outside of the 160 base pair mutated region. As a result, neither site is included in this study.</p></sec><sec id="s13-3-6"><title>rplKAJL-rpoBC</title><p>The known RplA-binding site for this operon is outside of the targeted, 160 base pair mutation window. As a result, the RplA site is not included in this study.</p></sec><sec id="s13-3-7"><title>tff-rpsB-tsf</title><p>RpsB is not contained in the mutated region. Additionally, the nearby predicted Mar-Sox-Rob-binding site is listed as low-evidence in EcoCyc and is also not directly predicted to regulate <italic>tff-rpsB-tsf</italic>, even though it may be present within the region. As a result, neither site is included in this study.</p></sec><sec id="s13-3-8"><title>yodB</title><p>GlaR is known to regulate <italic>yodB</italic>. However, the location of this binding site is unknown. As a result, we do not include the GlaR-binding site in our reported regulatory architecture for this gene.</p></sec><sec id="s13-3-9"><title>maoP</title><p>HdfR is known to regulate <italic>maoP</italic>. However, the location of the binding site is unknown. Additionally, the HdfR site is listed as low-evidence in EcoCyc. During the Reg-Seq experiment, however, we confirmed the presence of the low-evidence HdfR site with a gene knockout and located the binding site position. Thus, we include it in all regulatory cartoons and report the HdfR site in our discoveries.</p></sec><sec id="s13-3-10"><title>poxB</title><p>MarA and Sox have low-evidence binding sites in the mutagenized region. There is also a low-evidence site for Cra with an unknown binding location. As a result, neither site is included in the reported regulatory architectures in this study.</p></sec><sec id="s13-3-11"><title>mscM</title><p>While there is a known CpxR-binding site for <italic>mscM</italic>, the binding site exists outside of the mutagenized region. As a result, it is not included in the reported regulatory architectures in this study.</p></sec><sec id="s13-3-12"><title>tar</title><p>There is a low-evidence FNR site for <italic>tar</italic>. Its location is unknown. For both of these reasons, we do not include the binding site in our reported regulatory architectures for this gene.</p></sec><sec id="s13-3-13"><title>dpiBA</title><p>While there are 10 total binding sites for <italic>dpiBA</italic>, including an FNR site. However, the only ones that are known to regulate the particular TSS we chose (at position 652172 in <italic>E. coli</italic>) are 2 DcuR sites and a (low-evidence) NarL site. DcuR is induced by growth conditions like succinate or fumarate, neither of which were tested in this study. As a result, none of the sites are included in this study.</p></sec><sec id="s13-3-14"><title>araAB</title><p>There are a total of five AraC-binding sites and one CRP-binding site that regulate <italic>araAB</italic>. However, the three furthest upstream AraC-binding sites are outside of the 160 bp mutagenized region, and so only two AraC sites and one CRP site is included in the reported regulatory architecture in this study.</p></sec><sec id="s13-3-15"><title>xylF</title><p>There are two XylR sites, as well as three low-evidence Fis sites that regulate <italic>xylF</italic> in the mutagenized region. There is also a low-evidence CRP site outside the mutagenized region. Only the two XylR sites are included in the reported regulatory architectures, as the remaining sites are low-evidence or outside the mutagenized region.</p></sec><sec id="s13-3-16"><title>xylA</title><p>There are two XylR sites, two AraC, and a CRP site that regulates xylA. In our analysis, we utilize a growth condition containing xylose and arabinose. Under growth with xylose, XylR will bind DNA and activate expression. Under growth with arabinose, AraC will not bind DNA. We would only expect to see two XylR sites and a CRP site under growth in xylose and arabinose, so we only include these sites in our study.</p></sec><sec id="s13-3-17"><title>dicB</title><p>DicA has a low-evidence repressor-binding site for <italic>dicB</italic>. Additionally the binding location is unknown, and so we do not include the binding site in the reported regulatory architecture.</p></sec><sec id="s13-3-18"><title>xapAB</title><p>XapR has two low-evidence binding sites. The binding site furthest upstream is outside of the 160 bp mutagenized region. As the remaining site is low-evidence, it is not included in our reported regulatory architectures.</p></sec><sec id="s13-3-19"><title>ilvC</title><p>There are two IlvY-binding sites for <italic>ilvC</italic>. IlvY is known to be induced by acetolactate and activated in its presence . We do not utilize this growth condition in this experiment, however, nor do we include the two IlvY-binding sites in our 'gold standard' experimental analysis. We find that IlvY acts as a repressor when grown in other growth conditions. As repressor activity at these sites was not previously reported, we include this in our list of new discoveries.</p></sec><sec id="s13-3-20"><title>asnA</title><p>There are four low-evidence AsnC-binding sites in the mutated region. As they are low-evidence, however, we do not include these binding sites in the reported regulatory architectures for this gene.</p></sec><sec id="s13-3-21"><title>idnK</title><p>While there are three GntR sites, a CRP site, and one IdnR site, they are all low-evidence. As a result, we do not include any of these sites in our reported regulatory architectures.</p></sec><sec id="s13-3-22"><title>dinJ</title><p>While <italic>dinJ</italic> is regulated by DinJ-YafQ and LexA, they are both outside of the mutagenized window. As a result, neither are included in our reported regulatory architectures.</p></sec><sec id="s13-3-23"><title>yjiY</title><p><italic>yjiY</italic> is regulated by both BtsR and CRP. However, CRP is outside of the mutagenized window and so CRP is not included in our reported regulatory architectures.</p></sec><sec id="s13-3-24"><title>cra</title><p><italic>cra</italic> is regulated by a low-evidence binding site of PhoB. The location of the binding site is not known, however. As a result, the site is not included in the reported regulatory architecture.</p></sec><sec id="s13-3-25"><title>uvrD</title><p><italic>uvrD</italic> is regulated by a low-evidence binding site for LexA. This binding site is not included in the reported regulatory architectures for this study.</p></sec><sec id="s13-3-26"><title>znuCB</title><p>There are binding sites for Zur and OxyR in the mutagenized region for <italic>znuCB</italic>. OxyR is known to act as an activator under oxidative stress. As we do not utilize an oxidative stress growth condition in this study, we do not include this binding site in the reported regulatory architectures for this study.</p></sec><sec id="s13-3-27"><title>znuA</title><p>There are binding sites for Zur and OxyR in the mutagenized region for <italic>znuA</italic>. The OxyR-binding site is outside of the mutagenized region. Only the Zur-binding site is included our reported regulatory architectures.</p></sec><sec id="s13-3-28"><title>pitA</title><p>There is a low-evidence binding site for FNR in the mutagenized region. The location of this binding site, however, is unknown. Thus, this binding site is not included in our reported regulatory architectures.</p></sec><sec id="s13-3-29"><title>ecnB</title><p>There is a low-evidence OmpR-binding site for <italic>ecnB</italic>. The binding site is not included in our reported regulatory architectures.</p></sec><sec id="s13-3-30"><title>lacZYA</title><p>The mutagenized region extends from the TSS (the primary TSS p1) to 75 base pairs upstream of the TSS. The location of the mutagenized region excludes the LacI sites, while including a single CRP-binding site, a MarA-binding site, and two HNS-binding sites. The expression from <italic>marA</italic> is expected to be low, as we do not grow the cells in the presence salicylate or antibiotic stress and so we do not expect to observe the MarA site. In fact, the precursor of the Reg-Seq experiment, Sort-Seq, mutagenized and studied the same 75 base pair region, and only observed binding by CRP (<xref ref-type="bibr" rid="bib43">Kinney et al., 2010</xref>). As such, we only include CRP in <xref ref-type="table" rid="table2">Table 2</xref>, the regulatory cartoons, or the analysis of false positives and false negatives.</p></sec><sec id="s13-3-31"><title>leuABCD</title><p>There is a binding site for LeuO regulating <italic>leuABCD</italic>. The site is low-evidence and also has no known binding location. As a result, the site is not included in our reported regulatory architectures.</p></sec><sec id="s13-3-32"><title>arcA</title><p>There is a binding site for FNR within the mutagenized region listed as 'low-evidence' in EcoCyc. We find substantial additional evidence for the presence of the FNR-binding site. As such, we include the site in <xref ref-type="table" rid="table2">Table 2</xref> as an 'Identified Binding Site'.</p></sec><sec id="s13-3-33"><title>relBE</title><p>The <italic>relBE</italic> promoter contains four RelBE-binding sites and two RelB-binding sites in EcoCyc and RegulonDB. While the all four RelBE sites are listed as high evidence, <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref> mutagenized the RelBE promoter and did not identify binding in the furthest downstream or furthest upstream binding sites. Also, the original identification of the RelBE-binding sites presented (<xref ref-type="bibr" rid="bib51">Li et al., 2008</xref>), claims that the furthest upstream and downstream sites are only identified by similarity to consensus sequence. As a result only two of the RelBE and two of the RelB sites are included in this study.</p></sec><sec id="s13-3-34"><title>marR</title><p>The <italic>marR</italic> promoter contains a CpxR, CRP, Cra, and AcrR in EcoCyc that are not included in the 'gold standard' analysis or <xref ref-type="table" rid="table2">Table 2</xref>. <xref ref-type="bibr" rid="bib4">Belliveau et al., 2018</xref> performed mutagenesis experiments on the <italic>marR</italic> promoter and did not identify these additional sites and so they have been excluded.</p><fig id="app4fig2" position="float"><label>Appendix 4—figure 2.</label><caption><title>A comparison of the types of architectures found in RegulonDB (<xref ref-type="bibr" rid="bib75">Santos-Zavaleta et al., 2019</xref>) to the architectures with newly discovered binding sites found in the Reg-Seq study.</title><p>For each type of architecture, labeled as (number of activators, number of repressors), the fraction that architecture comprises of the total number of operons is given both for the data found in RegulonDB and from the results of the Reg-Seq experiment. Numeric values for the displayed data can be found in <xref ref-type="supplementary-material" rid="app4fig2sdata1">Appendix 4—figure 2—source data 1</xref>.</p><p><supplementary-material id="app4fig2sdata1"><label>Appendix 4—figure 2—source data 1.</label><caption><title>Source data for the percentage composition of regulatory architectures.</title><p>The source data file contains the percentage composition of each regulatory architecture displayed in the Figure. This includes architectures more complicated than those displayed in the histogram.</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-55308-app4-fig2-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-app4-fig2-v2.tif"/></fig></sec></sec></sec></boxed-text></app><app id="appendix-5"><title>Appendix 5</title><boxed-text><sec id="s14" sec-type="appendix"><title>Resource Table</title><table-wrap id="keyresource" position="anchor"><label>Appendix 5—key resources table</label><table frame="hsides" rules="groups"><thead><tr><th>Reagent type (species) <break/>or resource</th><th>Designation</th><th>Source or reference</th><th>Identifiers</th><th>Additional information</th></tr></thead><tbody><tr><td>Cell line (<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> K12</td><td><italic>E. coli</italic> Stock Center</td><td/><td/></tr><tr><td>Cell line (<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔYieP</td><td><italic>E. coli</italic> Stock Center</td><td/><td/></tr><tr><td>Cell line (<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔGlpR</td><td><italic>E. coli</italic> Stock Center</td><td/><td/></tr><tr><td>Cell line (<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔArcA</td><td><italic>E. coli</italic> Stock Center</td><td/><td/></tr><tr><td>Cell line (<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔLrhA</td><td><italic>E. coli</italic> Stock Center</td><td/><td/></tr><tr><td>Cell line (<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔPhoP</td><td><italic>E. coli</italic> Stock Center</td><td/><td/></tr><tr><td>Cell line (<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔHdfR</td><td><italic>E. coli</italic> Stock Center</td><td/><td/></tr><tr><td>Strain, strain background <break/>(<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔGlpR <break/>in K12 strain</td><td>This paper</td><td/><td>Knockout transferred to <italic>E. coli</italic> K12</td></tr><tr><td>Strain, strain background <break/>(<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔArcA <break/>in K12 strain</td><td>This paper</td><td/><td>Knockout transferred to <italic>E. coli</italic> K12</td></tr><tr><td>Strain, strain background <break/>(<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔLrhA <break/>in K12 strain</td><td>This paper</td><td/><td>Knockout transferred to <italic>E. coli</italic> K12</td></tr><tr><td>Strain, strain background <break/>(<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔPhoP <break/>in K12 strain</td><td>This paper</td><td/><td>Knockout transferred to <italic>E. coli</italic> K12</td></tr><tr><td>Strain, strain background <break/>(<italic>Escherichia coli</italic>)</td><td><italic>E. coli</italic> ΔHdfR <break/>in K12 strain</td><td>This paper</td><td/><td>Knockout transferred to <italic>E. coli</italic> K12</td></tr><tr><td>Chemical compound, drug</td><td>Q5 Polymerase</td><td>Qiagen</td><td>Cat. : M0491L</td><td/></tr><tr><td>Chemical compound, drug</td><td>qPCR master mix</td><td>QuantaBio</td><td>Cat. : 101414–166</td><td/></tr><tr><td>Chemical compound, drug</td><td>Lysyl Endopeptidase</td><td>Wako Chemicals</td><td>Cat. : 125–05061</td><td/></tr><tr><td>Commercial assay or kit</td><td>RNEasy Mini kit</td><td>Qiagen</td><td>Cat. : 74104</td><td/></tr><tr><td>Chemical compound, drug</td><td>RNAprotect <break/>bacteria reagent</td><td>Qiagen</td><td>Cat. : 76506</td><td/></tr><tr><td>Software, algorithm</td><td>mpathic</td><td>Kinney Lab <xref ref-type="bibr" rid="bib37">Ireland and Kinney, 2016</xref></td><td/><td/></tr><tr><td>Software, algorithm</td><td>FastX</td><td>Hannon Lab</td><td>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_005534">SCR_005534</ext-link></td><td/></tr><tr><td>Software, algorithm</td><td>FLASH</td><td>CBCB</td><td>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_005531">SCR_005531</ext-link></td><td/></tr><tr><td>Other</td><td>Oligo Pool</td><td>Twist Bioscience</td><td/><td/></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 101</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACGCTTATT CGTGCCGTGTTAT</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 102</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCTC GAGCACTTTGCTT CAGTCAGATTCGC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 103</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACGTCGAGT CCTATGTAACCGT</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 104</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACGTAAGAT GGAAGCCGGGATA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 105</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACGGTGTCGC AACATGATCTAC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 106</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACGTGCTAAG TCACACTGTTGG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 107</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACTCTAAACA GTTAGGCCCAGG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 108</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACGTCTTTAT ACTTGCCTGCCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 109</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACCACCGCGA TCAATACAACTT</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 110</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACTTCGGATA GACTCAGGAAGC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 111</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACCCATTGAT AGATTCGCTCGC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 112</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACTTTTCTAC TTTCCGGCTTGC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 113</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACATGACTAT TGGGGTCGTACC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 114</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACTCGACAAT AGTTGAGCCCTT</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 115</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACGAGCCATG TGAAATGTGTGT</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 116</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACCGTATACG TAAGGGTTCCGA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 117</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACTTATGATG TCCGGATACCCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd oligo 118</td><td>IDT</td><td/><td><named-content content-type="sequence">TTCGTCTTCACCT CGAGCACTCTTAGAA ATCCACGGGTCC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 101</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGG CCAGTGACTAGCGC TGAGGAGAAGCCT AATAGGGCACAGC AATCAAAAGTA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 102</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACG GCCAGTGAGGAGCGC TGAGGAGAAGCC TAATACCGGGATT CAGTGATTGAAC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 103</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACG GCCAGTGAGTCCC GCTGAGGAGAAG CCTAATATGAAGAT ATGACGACCCCTG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 104</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGG CCAGTGACCGACGCT GAGGAGAAGCCTAA TATTCCACAGCTC TATGAGGTG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 105</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGG CCAGTGATTGGCGCT GAGGAGAAGCCTA ATAGCAAACATGA CTAGGAACCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 106</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGG CCAGTGAGATACGC TGAGGAGAAGCC TAATACCGGGACG AGATTAGTACAA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 107</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGGC CAGTGAACTCCGCT GAGGAGAAGCCTA ATACACGCCAGTT GTGAACATAA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 108</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACG GCCAGTGATACTCGC TGAGGAGAAGC CTAATACAAAGGC CAAATCAGTTCCA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 109</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGGC CAGTGACCAACGCT GAGGAGAAGCCT AATAGGTGCATGGG AGGAACTATA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 110</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACG GCCAGTGAAGGCCGC TGAGGAGAAGCCT AATATGCATGGGT CTGTCTATTGT</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 111</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGGC CAGTGAAATTCGC TGAGGAGAAGCCT AATACTCCTATGCT AGCTCGACTC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 112</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACG GCCAGTGATTGT CGCTGAGGAGAAG CCTAATAATGGTA AGAAGCTCCCACAA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 113</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGGC CAGTGATTTACGCT GAGGAGAAGCCTA ATACTATGGTCA TTCCCGTACGA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 114</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGGC CAGTGAACCGCGCT GAGGAGAAGCCTA ATATAATCGGCT ACGTTGTGTCT</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 115</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGGC CAGTGATGGCCGC TGAGGAGAAGC CTAATATGACTCGA TCCTTTAGTCCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 116</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGG CCAGTGAGGCCCGC TGAGGAGAAGC CTAATAACGCTTT GTGTTATCCGATG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 117</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACGG CCAGTGAGGTGCG CTGAGGAGAAG CCTAATAACCACG GTGGAGTATACATC</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev oligo 118</td><td>IDT</td><td/><td><named-content content-type="sequence">TGTAAAACGACG GCCAGTGACAATCG CTGAGGAGAAGC CTAATAGGCACCA GGTACATATCTCA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>mRNA rev</td><td>IDT</td><td/><td><named-content content-type="sequence">GCAGGGGATAA TATTGCCCA</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 94</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTGACC TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 95</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTCAGT TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 96</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTTCTA TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 97</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTAGAG TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 98</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTGCAT TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 99</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTCTTA TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 100</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTTAGC TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 101</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTCAAG TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 102</td><td>IDT</td><td/><td> <named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTGTAC TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 103</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTTGAA TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 104</td><td>IDT</td><td/><td> <named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTTCGT TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 105</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTATGC TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 106</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTGTCA TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 107</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTCTCA TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>fwd sequencing 108</td><td>IDT</td><td/><td><named-content content-type="sequence">AATGATACGGCGACCAC CGAGATCT ACACTCTT TCCCTACACGACGC TCTTCCGATCTAGTA TATTAGGCTT CTCCTCAGCG</named-content></td></tr><tr><td>Sequence-based reagent</td><td>rev sequencing</td><td>IDT</td><td/><td><named-content content-type="sequence">AAGCAGAAGACGGCAT ACGAGATCGGT CTCG GCATTCCTGCTGAACC GCTCTTCCGATCTCAAA GCAGGGGATAA TATTGCCCA</named-content></td></tr><tr><td>Other</td><td>Streptavin coated dynabeads</td><td>Thermo Fisher</td><td>Cat. : 65601</td><td/></tr><tr><td>Database</td><td>RegulonDB</td><td/><td>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_003499">SCR_003499</ext-link></td><td/></tr><tr><td>Database</td><td>EcoCyc</td><td/><td>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_002433">SCR_002433</ext-link></td><td/></tr></tbody></table></table-wrap></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.55308.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Nourmohammad</surname><given-names>Armita</given-names></name><role>Reviewing Editor</role><aff><institution>University of Washington</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Friedlander</surname><given-names>Tamar</given-names> </name><role>Reviewer</role><aff><institution>IST Austria</institution><country>Austria</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>The manuscript presents a new approach, Reg-Seq, to study regulatory logic in hundreds of promoters at a time. To do so, the authors use massively parallel reporter assays and mass spectroscopy and build an information theoretical model to characterize binding energies in regulatory promoters at the base-pair resolution level. This approach can significantly advance our understanding of gene regulation in microbes and opens new avenues towards genome-wide quantification of regulatory logic and discovery of new transcription factors.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Deciphering the regulatory genome of <italic>Escherichia coli</italic>, one hundred promoters at a time&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Naama Barkai as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Tamar Friedlander (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Comments:</p><p>This manuscript introduces a new method &quot;Reg-Seq&quot; for identifying regulatory sites in promoters using RNA sequencing for cell sorting. The method generates impressive quantitative data for many genes in <italic>E. coli</italic>, which corroborates many previous results and starts to give us hints about the overall trends of regulatory architectures in <italic>E. coli</italic>. Although the experimental set up is very compelling and potentially promising, there are still some major concerns regarding presentation of the data and the underlying methods and analyses, which we would like to see addressed.</p><p>The main concerns about the manuscript can be summarized as: 1) Experimental method should be better discussed in the main text, its limitations should be explicitly pointed out and its advantages should be compared more clearly against previous techniques. 2) Statistical methods (including inference based on mutual information profiles) should be described more clearly and with more quantitative details throughout the text and the significance of the conclusions should be more explicitly expressed. 3) Analysis of <italic>E. coli</italic> data, comparison with previously identified regulatory regions and binding sites and the significance of these findings should be better discussed.</p><p>The reviewers strongly believe that the manuscript should be reworked to focus less on cherry-picked examples and more on presenting the method. The manuscript needs a significant rearrangement to better explain the procedures applied and fill in various missing points as detailed below.</p><p>Essential revisions:</p><p>1) The approach based on the mutual information profile to identify the binding sites within a promoter and to classify them as activator or repressors should be better explained:</p><p>1.1) Since this is such a key step, the authors need to provide more details about how the manual choice of activator/ repressors works. Overall, it is unclear how one goes from mutual information profiles to deciding whether known sites are or are not identified, how to decide which regions are putative sites, whether they fit known motifs, whether they are RNAP sites, and how to construct an energy matrix for each putative site.</p><p>1.2) It is mentioned (subsection “Analysis of sequencing results”, first paragraph) that, to confirm these manual choices, authors computationally identify regions of activators / repressors by assessing the fold change in gene expression due to mutations. It is unclear how the authors are assessing the significance of the changes, i.e., what the underlying null model is. If this computational approach is statistically sound, why the need for the manual approach? These manual choices are worrisome and raise concerns about the feasibility to scale-up this method, as intended by the authors.</p><p>2) It is difficult to assess the false positive/negative rate of identifying binding sites: This is partly due to the lack of clarity about the authors' approach in deciding whether a known site was identified or not, partly because the annotation of known sites is unclear and incomplete, and partly because the statistics are not transparently reported in the manuscript. It is therefore important that the authors present an objective method for assessing what fraction of known sites is not recovered, for what fraction of predicted novel sites a motif can be made, and for what fraction of those the mass-spec successfully recovers a binding TF.</p><p>As a suggestion: The authors should start from a unambiguously defined set of sites (e.g. from RegulonDB and EcoCyc) and then have an unambiguous procedure for:</p><p>i) Calling segments where a site exists (for example based on the summed mutual information within the segment).</p><p>ii) Calling the motif by comparing the profile with PSWMs or energy matrices for known motifs.</p><p>After that, they should clearly report what fractions of sites are recovered and for what fraction of sites the correct motif is predicted.</p><p>3) Energy matrices:</p><p>3.1) How are the energy matrices constructed? Details are missing from the manuscript.</p><p>3.2) How are the p-values estimated to assign significance to energy parameters? It appears that the authors have used MCMC to sample from a likelihood function but the details are very vague. To define an energy, it is assumed that the average expression can be written as the negative exponential of some effective energy to parametrize the average effects of mutations on expression- this should be better justified in the text. However, it seems that instead of 4 different energy parameters at each position, the model only assumes a “mutant” and a “wild type” energy. This may not be a good approximation given that we know nucleotides within TF binding sites have highly varying degeneracies. Moreover, the likelihood function for the observed DNA and RNA reads should be expressed as a function of the energy parameters at all positions. However, this is not the approach taken by the authors and instead, equations (8) and (9) only look at single positions. So, it is not clear what kind of likelihood function the MCMC is sampling from, or how p-values and confidence intervals are determined. Also, if the authors are indeed using MCMC with some likelihood function to sample the space of possible parameter values, the resulting variation in the energy parameters should correspond to posterior probability intervals and not confidence intervals.</p><p>3.3) Could the authors present the accuracy of the inferred energy matrices as a function of the number of genomic variants used? A particular example is currently given in Appendix 3. Can the authors use a simulation for that purpose? This is required to understand the validity of the results and the ability to scale-up such an experiment (if for example a lower resolution is sufficient, can larger regulatory regions be analyzed in future experiments?)</p><p>4) The step for assigning regulatory logic to promoters is unclear. Do authors always assume OR-gate-like interactions between the TFs, which is what Equation 14 suggests? If so, what is the justification for that assumption? Is it just the most basic statistical mechanical assumption, or is there strong empirical support?</p><p>5) The description of the method and analysis is hard to follow and unclear about many assumptions and limitations. To give a few examples:</p><p>5.1) Appendix 3 outlines how to calculate the mutual information footprint from the read count data but a more explicit discussion would be helpful: For example, how should the quantities in Equation 5 (<italic>p(m,</italic> 𝜇<italic>), p(m), p(</italic>𝜇)) be calculate from the preceding example data (subsection “Information footprints”)?</p><p>5.2) The methods rely on both DNA and RNA sequencing of the same sample and using ratios of RNA/DNA reads from the same reporter to estimate expression. The description of the sequencing protocol is insufficient. Importantly, the DNA sequencing is not even mentioned in the methods and it is not explained how precisely this expression quantification is done.</p><p>5.3) The methods mention correcting for correlated mutations, MCMC to assign p-values, and energy matrix reconstruction, but it is completely unclear how either of these are done.</p><p>6) The discussion of the methods in the main text is mostly qualitative and crucial details are scattered throughout the manuscript, in the appendices and in Materials and methods.</p><p>6.1) For example, it requires digging into the appendices to understand that the authors study a region of 160 bp mostly upstream TSS, and so, is this method inadequate if the regulatory region is larger or if its location is unknown? A clear and concise explanation of the crucial details (e.g. size of the region, number of variants per promoter, etc) should be given in the main text.</p><p>6.2) To further clarify the methods, it would be helpful to include a picture of the reporter construct, which based on the descriptions includes:</p><p>-promoter including 45 bp downstream of annotated TSS.</p><p>-then 64bp with primers for plasmid construction</p><p>-then 11bp with stop codons in 3 frames.</p><p>-then barcodes?</p><p>-then a RBS</p><p>-then GFP mRNA</p><p>7) Authors used TSS information to decide which promoters to pursue. How limiting is this for scaling up the procedure? It would be helpful to discuss briefly what fraction of promoters in <italic>E. coli</italic> have good TSS information and how valid is to assume that at the genome-wide level, each operon is dominated by a single TSS?</p><p>8) The authors rely on expression from plasmids and use mRNA/DNA ratio to handle the effect of variability in plasmid copy number between cells. However, if the plasmid copy number is of a similar order of magnitude as the transcription factor copy number, then the expression level measured (to calculate the energy matrices) is determined not only by the binding energy, but also by the TF availability leading to under-estimation of the binding energies. The authors should comment on this in the manuscript, and if they have the data available, show the measurements for plasmid and TF copy numbers to address this point. At this point we do not see a necessity for additional experiments.</p><p>9) The limitations of the method should be more concisely explained. Currently, limitations are scattered throughout the text.</p><p>Revisions required for Figures and Tables:</p><p>Figure 1: This figure is hard to read. It is difficult to distinguish the individual tick marks around the genome, because there are too many, they are too densely packed, and the colors are too mixed. Also, the caption describes the color of some ticks as &quot;red,&quot; but in the printed figure they look more brown (They appeared closer to red on the screen.)</p><p>Figure 2: You might want to clarify that the blue region likely corresponds to the σ factor binding site.</p><p>Figure 3: The number of (0,0) promoters should be shown as well. Moreover, it seems that the counts in Figure 3 add up to about 50 and the text mentions that there are 32 promoters with no sites found, i.e. type (0,0). Adding this in the sum still seems much less than 113 (i.e., the total number of promoters as indicated in the manuscript). Related to this, it seems that Table 2 has clearly less than 113 promoters in it. Where are the remaining ones?</p><p>Figure 4: The authors state about the results in Figure 4: &quot;In each of the cases shown in the figure, prior to the work presented here, these promoters had no regulatory information in relevant databases such as EcoCyc (Keseler et al., 2016) and RegulonDB (Santos- 318 Zavaleta et al., 2019).&quot;</p><p>This is simply not true. If you check EcoCyc for these genes you find:</p><p>i) <italic>idnK</italic> regulated by CRP, IdnR and GtnR.</p><p>ii) <italic>leuABCD</italic> regulated by LeuO, slyA, LrhA, and RcsB-BgU.</p><p>iii) <italic>maoP</italic> regulated by hdfR.</p><p>iv) <italic>rspA</italic> regulated by CRP and YdfH.</p><p>Only for <italic>yjjJ</italic>, <italic>aphA</italic>, and <italic>ybjX</italic> nothing was previously reported. It should also be noted that except for the <italic>rspA</italic> promoter, the previously reported regulatory interactions were generally not identified by the method.</p><p>Finally, it seems that there is no mass-spec data for <italic>yjjJ</italic>. Is the identification of marA as the regulator based on motif matching then?</p><p>Table 2: This table is unclear. Does the &quot;architecture&quot; of a promoter (first column) correspond to what is inferred in this study, to what is known in the literature, or to a combination of both? For the newly found sites it should be listed whether the binding TF was identified and (if so) what it is. For the fourth column, “literature binding sites”, it is not clear whether this is the total number of known literature sites or only the number of known sites that were successfully identified here – both should be listed. It is not clear what the fifth column “identified binding sites” refers to. The evidence column is also unclear. Is this evidence for the newly found sites or the literature sites?</p><p>Just to illustrate the confusion: consider the well-known lac operon. In Table 2 the <italic>lac</italic> operon (called lac as opposed to <italic>lacZYA</italic>, which is used elsewhere in the manuscript) is reported to have only 1 known literature site, whereas it is well established that it has a site for CRP and multiple sites for LacI. In the final column it is claimed that there is mass-spec evidence for LacI binding. However, on the website, the <italic>lac</italic> operon does not occur at all and in Appendix 2—figure 1 only the CRP site is reported. What makes this all even more confusing is that none of the experimental conditions included lactose or another inducer of the operon. As such, the lac operon should be highly repressed and so we expect very little effect of mutating the CRP site, and strong effects of abolishing the LacI site.</p><p>In multiple cases in the table, less literature information is reported than it actually exists: e.g. tar is a reported target of FNR, <italic>uvrD</italic> is a reported target of lexA, <italic>cra</italic> is a reported target of PhoB, and so on. The authors should make clear what literature information is shown here.</p><p>The authors should clear up this information so as to make it unambiguous and consistent across tables, figures, and website.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.55308.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The approach based on the mutual information profile to identify the binding sites within a promoter and to classify them as activator or repressors should be better explained:</p><p>1.1) Since this is such a key step, the authors need to provide more details about how the manual choice of activator/ repressors works. Overall, it is unclear how one goes from mutual information profiles to deciding whether known sites are or are not identified, how to decide which regions are putative sites, whether they fit known motifs, whether they are RNAP sites, and how to construct an energy matrix for each putative site.</p></disp-quote><p>We thank the reviewers for this comment and completely agree with both its spirit and content. As such, we have taken this opportunity to expand and clarify our discussion of the data analysis pipeline and how it leads to regulatory hypotheses. First, it is important to note that the information footprints used in this paper are tools for hypothesis generation, and the Reg-Seq approach is further complemented by the use of expression shifts (a signed quantity which provides other helpful hints) about possible binding site locations. Deciding which regions are putative binding sites depends on the value of the mutual information of the base pairs within the putative binding sites. The process by which we calculate mutual information can be found in Appendix 3 subsection “Information footprints”. In this part of the response, we focus on manual curation, the process by which we identify potential transcription factor binding sites by hand, and later take up the subject of automated identification of transcription factor binding sites as suggested by the reviewers.</p><p>In regards to manual curation, we used our experience in looking at gold-standard genes – genes with well-studied, experimentally-determined regulatory architectures (as indicated in EcoCyc or RegulonDB) – from a previous study conducted by our group (Belliveau et al., 2018). Our analysis of these genes, which include <italic>lacZYA</italic> and other well-studied promoters, provided us with a sense of the “threshold value” of the mutual information that indicates the presence of a binding site. As a result, as noted at the beginning of this response, a key additional tool that we have introduced and that has been a critical part of the manual method of identifying putative binding sites is the use of expression shifts, a signed version of the information footprint that is generally associated with increases in gene expression (corresponding to the presence of a repressor binding site) and decreases in gene expression (corresponding to presence of an activator or RNAP binding site). Because expression shifts are a signed quantity, boundaries between binding sites are more easily identified. For future iterations of the Reg-Seq method, we have every intention to explore automated curation of expression shifts as a tool to identify candidate binding sites as we highlight below.</p><p>During manual curation of binding sites, we also disqualify any binding sites where there are only 3 or fewer base pairs with high values in the mutual information footprint. The logic behind this decision is that individual bases with very high mutual information can potentially indicate that a putative binding site is only active when a certain mutation occurs. In turn, the binding site would not be active in wild-type conditions. To explain why this is, consider that a typical binding site mutation, at any given base pair, will significantly <italic>weaken</italic> the binding site of interest. Therefore, each of those mutated base pairs is said to have a “large effect” on expression. For a very poor binding site that is not active in the wild-type case, most mutations will further weaken a site which already will have only a minor effect on gene expression. However, for a small number of base pairs, a mutation can occur that makes the DNA bind more tightly to the TF, making it relevant for gene expression. Therefore, in the case of an extremely weak binding site that is not relevant in the wild type condition, there can still be a small number of highly informative bases. We integrate these expanded details into a new subsection in the Materials and methods section of the main text that is entitled “Manual selection of binding sites”.</p><p>While there was no hard cut-off for mutual information values during manual curation, inspired by the reviewer comments, we have undertaken another round of automation, a schematic for which is presented in Figure 11 and is to be explained in more detail in another reviewer comment. To automatically identify putative binding sites from information footprints, we developed a strategy, which is as follows: we first take a 15 base-pair window where the average mutual information value is greater than <inline-formula><mml:math id="inf186"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> bits. The cut-off value was chosen based on examination of a test set of genes, a fuller discussion of which can be found in another reviewer comment. Any cluster of 15 bp that meets the information value threshold is then classified as a putative regulatory region, and can then be used to identify putative RNAP, activator, and repressor binding sites. We classify binding sites as those for activators or repressors based on whether mutation of bases at a given site causes expression to increase (indicating a repressor binding site) or decrease (denoting an activator/RNAP binding site).</p><p>Specifically, to identify RNAP binding sites, we compare the sequence preference (through energy matrices and sequence logos) to experimentally validated examples of RNAP sites. We have examples of energy matrices for the <italic><sub>σ</sub></italic><sup>70</sup> RNAP site from Belliveau et al., 2018. For energy matrices of other <italic><sub>σ</sub></italic> factor binding sites, such as <italic><sub>σ</sub></italic><sup>32</sup> and <italic><sub>σ</sub></italic><sup>28</sup>, we use energy matrices generated from within the Reg-Seq experiment itself. For a <italic><sub>σ</sub></italic><sup>32</sup> binding site, for example, we used the example from the <italic>hslU</italic> gene. For a <italic><sub>σ</sub></italic><sup>28</sup> binding site, we used the energy matrix generated from the <italic>dnaE</italic> gene. When performing manual curation of binding sites, we visually compare the sequence logos of the example RNAP binding sites to the sequence logos of putative binding sites. We have also included a discussion of the method to create energy matrices and compare them to known motifs in Appendix 3 subsection “Energy matrix inference” and Appendix 3 subsection “TOMTOM motif comparison”, respectively. Further, a detailed discussion of energy matrix construction is provided in the GitHub Wiki that accompanies this work.</p><p>We really hope that the reviewers understand our goals. The information footprints should not be viewed as the key outcome of this work; we see them, rather, as a useful visualization tool that helps us generate hypotheses about the regulatory architecture for a given promoter. These hypotheses are allied with, and bolstered by, regulatory cartoons and energy matrices, which serve as a jumping off point for the kind of quantitative dissections we have carried out using chemical master equations and thermodynamic models in conjunction with careful promoter by promoter analyses during previous studies in our group (see Laxhuber et al., 2020; Amit et al., 2011; Phillips et al., 2019; Razo-Mejia et al., 2018; Rydenfelt et al., 2014a; Weinert et al., 2014). We share the reviewer’s concern in regards to scaling up the Reg-Seq methodology, but believe that it is not enough to produce single base pair resolution graphs such as the information footprints (and their analogs in the work of others), and are striving instead to produce a systematic approach to parlay those plots into actionable, regulatory hypotheses.</p><disp-quote content-type="editor-comment"><p>1.2) It is mentioned (subsection “Analysis of sequencing results”, first paragraph) that, to confirm these manual choices, authors computationally identify regions of activators / repressors by assessing the fold change in gene expression due to mutations. It is unclear how the authors are assessing the significance of the changes, i.e., what the underlying null model is. If this computational approach is statistically sound, why the need for the manual approach? These manual choices are worrisome and raise concerns about the feasibility to scale-up this method, as intended by the authors.</p></disp-quote><p>We appreciate the reviewer’s suggestions and the opportunity to improve our computational methods in this resubmitted manuscript. We hope that the reviewers will appreciate that we have been engaged in a staged scale-up of our approach to dissect the regulatory genome. During each generation of experiments, we have been upgrading all of our methodologies in an effort to develop tools that, eventually, will help us fully elucidate the so-called “regulome”. We detail the improvements that we have made below.</p><p>In light of the excellent suggestions of the reviewers, we have implemented automated motif finding, which replaces the appeal to p-values as explained in this study. The use of automated motif finding replaces our initial focus on p-values, replacing it with an appeal to our ability to recover the regulatory architectures of certain “gold-standard” promoters as a metric of the soundness of our results. The details of this new automated method are discussed in the Materials and methods subsection entitled “Automated putative binding site algorithm”.</p><p>Despite the advancements (and shortcomings) of the Reg-Seq method, we still hope that the reviewers are aware of the state of the art in the field of bacterial regulation and the important advances that we have made even without a genome-scale effort. During each round of new experiments, we want to materially alter the completeness of the EcoCyc and RegulonDB databases such that researchers interested in particular promoters have a way forward to design and perturb those promoters. Indeed, the group of Collado-Vides (see Santos-Zavaleta et al., 2019,) in Mexico, which manages the RegulonDB database, has already taken the results of the unpublished work in this manuscript that appeared on BioRxiv, contacted us, and updated their database accordingly. Our hope in the coming few years is that each and every promoter will have a full regulatory cartoon and corresponding energy matrix but, for the moment, we are excited about two successive 10-fold scaleups in our work, and hope that the reviewers acknowledge this as significant progress (Belliveau et al., 2018).</p><disp-quote content-type="editor-comment"><p>2) It is difficult to assess the false positive/negative rate of identifying binding sites: This is partly due to the lack of clarity about the authors' approach in deciding whether a known site was identified or not, partly because the annotation of known sites is unclear and incomplete, and partly because the statistics are not transparently reported in the manuscript. It is therefore important that the authors present an objective method for assessing what fraction of known sites is not recovered, for what fraction of predicted novel sites a motif can be made, and for what fraction of those the mass-spec successfully recovers a binding TF.</p><p>As a suggestion: The authors should start from a unambiguously defined set of sites (e.g. from RegulonDB and EcoCyc) and then have an unambiguous procedure for:</p><p>i) Calling segments where a site exists (for example based on the summed mutual information within the segment).</p><p>ii) Calling the motif by comparing the profile with PSWMs or energy matrices for known motifs.</p><p>After that, they should clearly report what fractions of sites are recovered and for what fraction of sites the correct motif is predicted.</p></disp-quote><p>We thank the reviewer for this comment, which is an extremely serious consideration that we hope to fully address in this resubmitted manuscript. We note that, with each successive generation of our experimental efforts, we are expanding our ability to scale-up the methods. The manual curation of binding sites has been used as a tool for hypothesis generation that we have followed by independent confirmation of these hypotheses. That said, we are very interested in developing robust, scalable approaches.</p><p>In this resubmitted manuscript, we introduce a systematized way of identifying the locations of binding sites, as shown in Figure 11, that allows the false negative and false positive rate of binding site identification to be clearly assessed. This new approach also replaces the previous arguments based on p-values and offers an alternative method to assess the accuracy of our method. Thanks to the reviewer’s suggestions, we find this new treatment more intuitive and transparent, and think it has substantially improved this manuscript.</p><p>For a given information footprint, we average over 15 base pair “windows”. We then determine which base pairs are part of a regulatory region by setting an information threshold of <inline-formula><mml:math id="inf187"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> bits (the rationale for this threshold is explained below). All base pair positions that pass the information threshold are then joined into “regulatory regions”, which we consider to be “activator-like” (if a mutation decreases expression) or “repressor-like” (if a mutation increases expression). This means that it is possible to identify overlapping repressor and activator binding sites. We join any base pair positions within 4 base pairs of each other into a single regulatory region. We then find the edges of each binding site region by trimming off any base pairs at the edge that are below the information threshold (even if the 15 base pair average is above the threshold). While we can often resolve overlapping or nearby repressors from activators, a limitation of this method of identification is that is cannot resolve two activators or two repressors that are very close to each other or overlapping.</p><p>To determine which information threshold to use as a cutoff for a putative binding site, as displayed in Figure 11, we selected a training set of genes which included two of our ”gold standard” genes with transcription factor binding sites which have experimental validation, DgoR (the upstream site from the <italic>dgoR</italic> promoter) and CRP (from the <italic>araAB</italic> promoter), two genes with only RNAP binding sites, including <italic>hslU</italic> (under heat shock) and <italic>poxB</italic>, and several genes that we classified as inactive, wherein no RNAP binding sites or other binding sites could be identified. These inactive genes included <italic>hicB, mtgA, eco, hslU</italic> (without heat shock), and <italic>yncD</italic>. The growth condition (heat shock) is specified for the <italic>hslU</italic> promoter as transcription occurs from a <italic><sub>σ</sub></italic><sup>32</sup> RNAP site, which will be inactive except during heat shock. We selected the threshold such that the RNAP sites and known binding sites were identified, while no binding sites were identified in the inactive regions.</p><p>We then determine a set of binding sites upon which to test this method and determine a false negative rate for the Reg-Seq experiment. In this set of binding sites, we include those sites which are “high-evidence” according to EcoCyc. Such “high evidence” binding sites have been validated experimentally with the binding of purified protein or through site mutation. Some “high-evidence” sites are excluded because they are not included within our 160-base pair, mutagenized sequence, or because they are not active in any of the growth conditions that we tested. Justifications for those binding sites which were not included are now listed in a new appendix; Appendix 4 subsection “Explanation of included binding sites”. A full list of promoters and binding sites that <italic>were</italic> included in the set of genes used to validate our automated binding-site finding algorithms are also provided in Appendix 2—table 1.</p><p>For each promoter contained in Appendix 2—table 1, we used the automated procedure outlined above and in Figure 11 to identify the activator and repressor binding sites. A visual display of the expected binding sites, the information footprints for the promoters in Appendix 2—table 1, and the discovered binding sites are all displayed in Appendix 2—figure 2 and 3. To assess the false negative rate, we summarize the identified regulatory regions to the known binding sites from Appendix 2—table 2. At this stage, we did not consider the identities of the binding sites; we merely consider their presence or absence. Inferred binding sites are declared to “match” the known binding site if the automated identification procedure classifies at least half of the base pairs reported in EcoCyc as belonging to a transcription factor binding site and correctly determines whether the binding site belongs to an activator or repressor.</p><p>We do not require exact matching of the edges of the binding sites for several reasons. One such reason is that, in some cases, the sequence of half of a binding site (for example, corresponding to one half of a helix-turn-helix binding motif) can contribute relatively little to gene expression, and so will not have high mutual information values in the corresponding information footprint for that binding site. While this may appear unintuitive for TFs where both sections of the binding site are bound by identical halves of a dimer, we see several examples of this in our Reg-Seq experiment results, including for CRP binding sites of the rspA promoter studied during our analysis of false negative rates. We can see in Appendix 2—figures 2 and 3 that the downstream half of the binding site is not identified as important for gene expression. If we examine the wild type sequence of the rspA promoter, we also see that, for the upstream half of the sequence, the wild type matches the five most conserved bases of the consensus sequence (TGTGA) perfectly. The downstream half of the sequence, however, has 4 mismatches out of 5 bases (CGGCT compared to the consensus sequence of TCACA). The downstream half of the binding site already binds to its target transcription factor poorly, so further mutations have little effect. While it is true that CRP binds to that sequence region, it is also true that CRP binds only extremely weakly to that section of the region. A similar effect can be seen in previous work from Belliveau et al., 2018, where a mutation in the downstream half of a CRP binding site in the xylE promoter had more than a 10-fold greater effect on binding energy than mutation in the upstream half of the binding site. As such, we are lenient when evaluating the successes of our algorithm in this regard. Furthermore, the methods that have been used to determine the presence of “high evidence” binding sites in the past, such as ChIP-seq, do not typically have base pair resolution with which to precisely determine the edges of binding sites (Skene and Henikoff, 2015).</p><p>Lastly, a known weakness of our algorithmic approach is that binding sites that are extremely close or overlapping cannot be distinguished from each other initially. For example, the XylR sites in the xylF promoter are only separated by 3 bases according to RegulonDB. While the sites can be distinguished upon later investigation through gene knockouts, mass spectrometry, or motif comparison, our initial algorithm joins the sites into one large site. While this is a weakness of the algorithm, for our purposes it does not constitute a false negative, as the important regions for regulation are still discovered. All regions for all promoters that are classified as regulatory regions, their identities as activators, repressors, or RNAP binding sites, as well as their starting and ending base pairs, can be found in Supplementary file 3. Furthermore, we summarize the success and failures of the method at each binding site in Appendix 2—table 2.</p><p>We see in Appendix 2—table 2 that 11 of the 15 promoter regions included in Appendix 2—table 1 have all TF binding sites classified as putative transcription factors, two have the majority of sites correctly classified, and two do not have any of their binding sites correctly classified as regulatory elements. We can see the information footprints used in the correct identifications in Appendix 2—figures 2 and 3. Considering binding sites, we find that 23 out of 33 binding sites are correctly classified. However, we argue that the false negative rate should be considered on a per promoter basis, rather than on the basis of individual binding sites. The reason for this argument can be seen in the two “worst” cases of correct binding site identification; namely, for the <italic>araC</italic> and <italic>dicA</italic> promoters.</p><p>The <italic>araC</italic> promoter is repressed by multiple repressor binding sites in all growth conditions tested. <italic>araC</italic> only has high expression transiently after addition of arabinose (Johnson and Schleif, 1995), and while growth in arabinose is utilized in this experiment, RNA was not collected during the window of high expression. The case study shows that Reg-Seq does not perform well when many repressor sites regulate the promoter. Reg-Seq relies on mapping the effect on expression of mutating a particular site, and when many strong repressor sites are present, expression change will be minimal unless all repressor sites are weakened through mutation. Additionally, in this highly repressed case, the RNAP binding site we observe in the mutagenized region is not the documented RNAP site in RegulonDB, indicating that we are seeing transcription primarily from an alternative TSS. Different RNAP sites are often regulated differently, and in this case, the presence of an alternative and dominant RNAP binding site (in the repressed case), likely contributes to a failure to observe six of the seven binding sites in the <italic>araC</italic> promoter. Similarly, in the <italic>dicA</italic> promoter, we did not find an RNAP binding site in the studied region, which would make it very unlikely for any transcription factor binding sites to be identifiable.</p><p>We next take the reviewer’s suggestion to compare the energy matrices from putative regulatory regions to known binding site motifs. The known motifs are obtained either from RegulonDB or are generated from data from prior Sort-Seq experiments (see Belliveau et al., 2018). We utilize the TOMTOM motif comparison software (Gupta et al., 2007) to perform these comparisons. TOMTOM generates a p-value under the null hypothesis that the two compared motifs are drawn independently from the same underlying probability distribution. We test 95 motifs against each target motif that we are attempting to identify. The 95 resulting p-values (for each target) generated by TOMTOM are displayed in Appendix 2—figure 4. A full discussion of TOMTOM can be found in Appendix 3 subsection “TOMTOM motif comparison”. We only included those transcription factors that either have over 50 known binding sites in RegulonDB or have experimental measurements of binding site preference, such as in Sort-Seq (Belliveau et al., 2018). As such, we used TOMTOM on the XylR, CRP, MarA, MarR, and RelBE sites in Appendix 2—table 2. We utilized a p-value cutoff of 0.05, corrected for multiple hypothesis testing. 95 motifs were tested against each target and using the Bonferroni correction leads to a p-value cutoff of <sup>0.05</sup><sub>95</sub> = 5 × 10<sup>−4</sup>. In Appendix 2—figure 4 we show that the correct transcription factor falls below the p-value threshold in all cases. For the CRP binding site in the <italic>lacZYA</italic> promoter, FNR also falls below the cut-off, but CRP has a calculated p-value that is ≈ 6 orders of magnitude lower, and so is clearly identified as the correct binding site. The results show that motif comparisons can be used reliably in those cases where we have high-quality energy matrices for comparison.</p><p>In order to determine false positive rates, we test against promoters for which we are certain there are not additional, unannotated binding sites. Most known binding sites were not determined using a method like Reg-Seq, which looks for regulatory elements across an entire promoter region at base pair resolution. Rather, many efforts to pinpoint TF binding site locations use assays like ChIP-seq, which prioritizes looking for all binding sites of a given TF across the entire genome. For those promoters studied with Reg-Seq, there are five promoters for which we have reason to believe that there are no undiscovered binding sites. There is evidence that the <italic>zupT</italic> promoter is constitutive (Grass et al., 2005), and the <italic>marR</italic>, <italic>relBE</italic>, <italic>dgoR</italic>, and <italic>lacZYA</italic> promoters have all been examined for binding sites at base pair resolution previously in the Sort-Seq experiments (Belliveau et al., 2018;Kinney et al., 2010).</p><p>To evaluate false positive rates, we examine the putative activator and repressor binding sites as identified using our automated methodology (described previously), and compare any known binding sites to the known binding sites for the target promoters. We also classify any putative regulatory regions that are outside of known TF binding sites as false positives. Similarly, any identified RNAP binding sites which were outside of the known RNAP binding locations were classified as false positives. In the <italic>zupT</italic> promoter, only the correctly placed RNAP site was identified. There were similarly no false positives identified in the <italic>marR</italic>, <italic>relBE</italic>, <italic>dgoR</italic>, or <italic>lacZYA</italic> promoters. We have added this discussion to Appendix 2 in a new subsection entitled “False positive and false negative rates”.</p><disp-quote content-type="editor-comment"><p>3) Energy matrices:</p><p>3.1) How are the energy matrices constructed? Details are missing from the manuscript.</p></disp-quote><p>We thank the reviewer for this comment and concur that additional information on our construction of energy matrices is necessary. We have added a general overview of our method for constructing energy matrices to the Materials and methods section of this manuscript and further detail can be found in Appendix 3 subsection “Energy matrix inference”. To ensure that readers of this work are able to pick up and use our methods in their own laboratories, we have also paid considerable attention, in this resubmitted manuscript, to the construction of a full, detailed set of experimental, mathematical, and computational discussions. Detailed instructions to build energy matrices can be found on the GitHub Wiki for this work, while associated code for building energy matrices can be found in our Jupyter notebooks.</p><p>To address the reviewer’s concern and clearly delineate how we built energy matrices in this work, we note that the plotting of an energy matrix for a regulatory region of interest begins by analyzing the next-generation sequencing data for each 160 bp mutagenized region included in our DNA libraries. In particular, we deduce the relative gene expression value for each mutated regulatory region by counting genetic barcodes in RNA and cDNA form. This approach, whereby genetic barcodes serve as a semi-quantitative metric for gene expression, is frequently used in a type of experiments known as “massively parallel reporter assays” (MPRAs). We count barcodes as a relative measure of gene expression values for every mutant sequence and infer the energy matrix that best describes the data by maximizing the mutual information between the expression predictions from a given energy matrix and its expression data. We do this by starting from a random energy matrix and using a Markov Chain Monte Carlo method following the procedure outlined in Kinney et al., 2010. An energy matrix with high mutual information would predict (if the binding site corresponds to a repressor) that the sequences with low expression would have strong binding of said repressor, while sequences with high expression would have weak binding by the repressor.</p><p>The output from our MCMC inference is a table of the form:</p><table-wrap id="resptable1" position="anchor"><label>Author response table 1.</label><table frame="hsides" rules="groups"><thead><tr><th><bold>pos</bold></th><th><bold>A</bold></th><th><bold>C</bold></th><th><bold>G</bold></th><th><bold>T</bold></th></tr></thead><tbody><tr><td>0</td><td>-0.005387</td><td>-0.011758</td><td>-0.010176</td><td>0.027322</td></tr><tr><td>1</td><td>0.002338</td><td>0.049826</td><td>-0.058030</td><td>0.005866</td></tr><tr><td>2</td><td>-0.000259</td><td>-0.037224</td><td>0.008021</td><td>0.029461</td></tr><tr><td>3</td><td>-0.017494</td><td>0.015760</td><td>-0.012184</td><td>0.013918</td></tr><tr><td>…</td><td>…</td><td>…</td><td>…</td><td>…</td></tr></tbody></table></table-wrap><p>In <xref ref-type="table" rid="resptable1">Author response table 1</xref>, each value represents the binding energy contribution for a specific nucleotide: A, C, G, or T. A negative value indicates that the nucleotide in that specific position confers a stronger binding energy with the transcription factor, while a positive value indicates a weaker binding energy. We next visualize these nucleotide-specific values using a simple Python script executed in Jupyter notebooks. The notebook and all code used for energy matrix visualization is available in our GitHub repository. Again, we are grateful to the reviewer for raising this concern and agree that our methods needed to be made clearer. We also note that we have updated our Materials and methods section, in the main text, to immediately state that “the reader is urged to visit our detailed GitHub repository and associated methods on our GitHub Wiki”.</p><disp-quote content-type="editor-comment"><p>3.2) How are the p-values estimated to assign significance to energy parameters? It appears that the authors have used MCMC to sample from a likelihood function, but the details are very vague. To define an energy, it is assumed that the average expression can be written as the negative exponential of some effective energy to parametrize the average effects of mutations on expression- this should be better justified in the text. However, it seems that instead of 4 different energy parameters at each position, the model only assumes a “mutant” and a “wild type” energy. This may not be a good approximation given that we know nucleotides within TF binding sites have highly varying degeneracies. Moreover, the likelihood function for the observed DNA and RNA reads should be expressed as a function of the energy parameters at all positions. However, this is not the approach taken by the authors and instead, equations (8) and (9) only look at single positions. So, it is not clear what kind of likelihood function the MCMC is sampling from, or how p-values and confidence intervals are determined. Also, if the authors are indeed using MCMC with some likelihood function to sample the space of possible parameter values, the resulting variation in the energy parameters should correspond to posterior probability intervals and not confidence intervals.</p></disp-quote><p>We thank the reviewer for the comment. We are afraid our p-value analysis was confusing since there is no such analysis associated with energy matrices. The information footprints, for which we calculate effective energies and p-values, and the energy matrices involve separate calculations. Furthermore, we would like to note that the quantitative measures created during Reg-Seq, the energy matrices of transcription factors or RNAP sites, do in fact consider all four bases separately for each position. This is again in contrast to the calculations of effective energies for information footprints, which are based on calculating parameters for only mutated or wild type bases.</p><p>We acknowledge that, by only considering wild type or mutated energy contributions to the total effective binding energy rather than having separate values for energy contributions from all four base pairs, our methods will not be accurate in the case of calculating mutual information at locations with degenerate base pairs. However, the information footprints, which are created from the fits to effective energy of wild type or mutated base pairs referred to in the reviewer comment, are intended to be hypothesis generation tools that can identify transcription factor binding sites, rather than a quantitative tool like the energy matrices for transcription factors that we generate. As such, the most important test for the assumption that we can approximate effective energy contributions from all 4 bases as contributions from only wild type or mutated bases is to assess whether the approximation has any effect on determining binding site locations. We re-ran the false positive and false negative assessments discussed in the response to major reviewer comment 2, but instead calculated the effective energy parameters for producing information footprints as a sum of contributions from all four bases. We find that the literature binding sites that were properly identified, as summarized in Appendix 2—table 2, are identically identified. Specifically, any site which was identified using the previous method is still identified and any site that failed to be identified is still not observed. Similarly, when we only fit effective energy parameters for mutated or wild type bases there are no false positives identified in the promoters for <italic>marR</italic>, <italic>relBE</italic>, <italic>dgoR</italic>, <italic>zupT</italic>, or <italic>lacZYA</italic>. There are also no false positives when repeating the procedure while considering all 4 bases in the effective energy fits, implying that the simplification to only considering mutated or wild type bases does not have an effect on our ability to identify binding sites. We have amended the text in Appendix 3 subsection “Information footprints” to call attention to the limitations of the assumption we make and to justify our assumptions regarding effective energy used when inferring the parameters used in creating information footprints.</p><p>We now refer explicitly to the likelihood function used during MCMC inference in Appendix 3 subsection “Energy matrix inference” in Equation 27.</p><disp-quote content-type="editor-comment"><p>3.3) Could the authors present the accuracy of the inferred energy matrices as a function of the number of genomic variants used? A particular example is currently given in Appendix 3. Can the authors use a simulation for that purpose? This is required to understand the validity of the results and the ability to scale-up such an experiment (if for example a lower resolution is sufficient, can larger regulatory regions be analyzed in future experiments?)</p></disp-quote><p>We appreciate the reviewer’s comment and, in this resubmitted manuscript, have expanded the analysis that was carried out in Appendix 3 to fully address the issue of how the number of mutated sequences for a given promoter affects inference of energy matrices. We wish to both prove that our results will not be strongly dependent on the number of sequences in the sequence regime that we are in, and also to explore, as the reviewer helpfully suggested, how a reduction in the number of mutated sequences could facilitate larger scale experiments in the future. While pure simulation of data from an energy matrix is a possible way to answer this question, we instead generated examples of smaller data sets by computationally sub-sampling the Reg-Seq data from 7 mutated promoters (<italic>maoP</italic>, <italic>hslU</italic>, <italic>rpsA</italic>, <italic>leuABCD</italic>, <italic>aphA</italic>, <italic>araC</italic>, and <italic>tig</italic>). These promoter regions are representative of a large cross section of the variety of transcriptional regulation that we see in our study, including constitutive expression (<italic>hslU</italic>), simple repression (<italic>leuABCD</italic>, <italic>tig</italic>), simple activation (<italic>aphA</italic>), and more complicated regulatory architectures (<italic>maoP</italic>, <italic>rspA</italic>, <italic>araC</italic>). Each sub-sampling was performed in triplicate, and we used the Pearson correlation coefficient as a comparison metric between the inference based on the full data set and the computationally sub-sampled data sets. The results of this analysis are displayed in Appendix 3—figure 1.</p><p>Based on this analysis, we find that there is room to moderately lower the resolution of the experiment to approximately 1000 unique, mutated sequences per 160-base pair “window” before our results are subjected to large deviations in the inference of energy matrices. A decrease in the number of unique sequences can give modest boosts to the number of genes that can be studied in our Reg-Seq experiments but would not, alas, be able to provide order of magnitude increases in the number of genes that can be explored. We have replaced the original discussion in Appendix 3 with this expanded analysis, which we hope will fully address the reviewer’s concerns.</p><disp-quote content-type="editor-comment"><p>4) The step for assigning regulatory logic to promoters is unclear. Do authors always assume OR-gate-like interactions between the TFs, which is what Equation 14 suggests? If so, what is the justification for that assumption? Is it just the most basic statistical mechanical assumption, or is there strong empirical support?</p></disp-quote><p>We appreciate that the reviewer has raised this question. First, we reiterate that the approach that we present in this study, if we as a field are being appropriately cautious, should be viewed as a powerful, quantitative tool for regulatory hypothesis generation. But it should be clear, based on many papers from our lab, that we are by no means satisfied with stopping at the current iteration of this method (Phillips et al., 2019; Razo-Mejia et al., 2018; Garcia and Phillips, 2011; Chure et al., 2019). The outcome of our study is a hypothesized regulatory architecture as characterized by a suite of binding sites for RNAP, repressors and activators, as well as the extremely potent binding energy matrices. We do not assume, <italic>a priori</italic>, that a particular collection of such binding sites is AND, OR, or any other logic (Buchler et al., 2003; Bintu et al., 2005; Galstyan et al., 2019). We are exploring a new round of experimental tools that will allow us to do the next step in our analysis of such architectures. Our new Figure 4, in the main body of this paper, shows the outcome of our analysis. For those promoters that contain multiple transcription factor binding sites, we do not yet know what detailed regulatory logic (AND, OR, NAND, and so forth) they imply. Using the traditional approach in our lab of using statistical physics to predict input-output functions, in conjunction with our methods for constructing energy matrices, we believe that there is a way forward to find out what the regulatory logic of a given promoter is. We also suspect, however, that information footprint and expression shifts under multiple growth conditions might produce substantial hints as to the logic as well. Ultimately, we believe the present work lays the foundation for asking and answering precisely these questions. To more fully address the reviewer’s concern, and our noted inability to identify regulatory logic, we have included a discussion of inferred regulatory logic based on this comment in the Results subsection entitled “Newly discovered <italic>E. coli</italic> regulatory architectures”.</p><disp-quote content-type="editor-comment"><p>5) The description of the method and analysis is hard to follow and unclear about many assumptions and limitations. To give a few examples:</p><p>5.1) Appendix 3 outlines how to calculate the mutual information footprint from the read count data but a more explicit discussion would be helpful: For example, how should the quantities in Equation 5 (p(m, m𝜇), p(m), p(𝜇)) be calculate from the preceding example data (subsection “Information footprints”)?</p></disp-quote><p>We thank the reviewer for their comment and agree that, as written in the original manuscript, our mathematical explanations are insufficient to guide the reader through our equations in a logical manner. We sincerely hope to address this shortcoming in this resubmitted manuscript. Accordingly, we have expanded our discussion regarding the calculation of information footprints in Appendix 3 to include explicit calculations of <italic>p</italic>(<italic>m</italic>), <italic>p</italic>(<italic>µ</italic>), and <italic>p</italic>(<italic>m</italic>, <italic>µ</italic>) from the example data presented in Appendix 3—table 1.</p><p>In the subsection entitled “Information footprints” in Appendix 3, we now give a very precise, pedagogical example of the calculations for <italic>p</italic>(<italic>m</italic>), <italic>p</italic>(<italic>µ</italic>), and <italic>p</italic>(<italic>m</italic>, <italic>µ</italic>), and provide further explanations regarding calculations of the mutual information itself. This Appendix, in conjunction with the new GitHub Wiki and Jupyter notebooks, also now show how these calculations can be performed on real data obtained using the Reg-Seq methodology.</p><disp-quote content-type="editor-comment"><p>5.2) The methods rely on both DNA and RNA sequencing of the same sample and using ratios of RNA/DNA reads from the same reporter to estimate expression. The description of the sequencing protocol is insufficient. Importantly, the DNA sequencing is not even mentioned in the Materials and methods and it is not explained how precisely this expression quantification is done.</p></disp-quote><p>We thank the reviewer for their comment and apologize for the error. We have now updated our Materials and methods section to more fully explain how our DNA libraries are prepared, how we isolate RNA and DNA, and how our sequencing experiments are performed. We have also added several sentences that describe how we count barcodes, in cDNA and DNA form, and then use these data to quantify gene expression values for mutated promoter sequences. In addition, the GitHub Wiki provides a detailed description of these methods.</p><disp-quote content-type="editor-comment"><p>5.3) The Materials and methods mention correcting for correlated mutations, MCMC to assign p-values, and energy matrix reconstruction, but it is completely unclear how either of these are done.</p></disp-quote><p>We apologize that our Materials and methods failed to mention the corrections for correlated mutations, MCMC to assign p-values, and how we construct energy matrices. We take this exclusion very seriously, as it is our sincere hope that readers and other laboratories will be able to easily utilize Reg-Seq to dissect a greater number of regulatory architectures. Since our first submission, we have made an in-depth GitHub Wiki that outlines all experimental, computational, and mathematical steps involved in our experiments. However, we do not merely wish to direct readers to an external GitHub repository, as this exclusion warrants remedy in the main body of the text. Accordingly, we have added a subsection in Appendix 3 entitled “Energy matrix inference” to explain the process of creating energy matrices. In light of the suggestions of the reviewers, we have also implemented a method for automated motif finding that replaces the appeal to p-values. We now explain this process in a subsection entitled “Automated putative binding site algorithm” in the Materials and methods section. The generation of mutual information footprints that we use to address the problem of correlated mutations is also now addressed in Appendix 3, in the subsection entitled “Information footprints”.</p><disp-quote content-type="editor-comment"><p>6) The discussion of the methods in the main text is mostly qualitative and crucial details are scattered throughout the manuscript, in the appendices and in Materials and methods.</p><p>6.1) For example, it requires digging into the appendices to understand that the authors study a region of 160 bp mostly upstream TSS, and so, is this method inadequate if the regulatory region is larger or if its location is unknown? A clear and concise explanation of the crucial details (e.g. size of the region, number of variants per promoter, etc) should be given in the main text.</p><p>6.2) To further clarify the methods, it would be helpful to include a picture of the reporter construct, which based on the descriptions includes:</p><p>-promoter including 45 bp downstream of annotated TSS.</p><p>-then 64bp with primers for plasmid construction</p><p>-then 11bp with stop codons in 3 frames.</p><p>-then barcodes?</p><p>-then a RBS</p><p>-then GFP mRNA</p></disp-quote><fig id="respfig1"><label>Author response image 1.</label><caption><title>Figure 10 from Rydenfelt et al., 2014b.</title><p>Distribution of activating and repressing binding sites bound by global TFs and specific TFs, respectively. The y-axis shows the number of binding sites overlapping each nucleotide position, after aligning all promoters with respect to their transcription start site (TSS) for the different kinds of TFs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55308-resp-fig1-v2.tif"/></fig><p>We thank the reviewer for this constructive comment and apologize that the methodology in our initial submission was unclear and insufficient. In this resubmitted manuscript, we have made numerous efforts to address these concerns.</p><p>We have created an exhaustive Materials and methods section that outlines every experimental, mathematical, and computational procedure utilized in this project. The full text is available on the GitHub Wiki that accompanies this project. Additionally, we now include a spreadsheet that lists every gene/operon that was studied in our manuscript (provided as Supplementary file 1). For each gene/operon, we also provide details on <italic>why</italic> each TSS was selected and provide applicable references for each choice. We hope that this provides clarity on our methodologies. Finally, we have updated our methods, in both the main text and appendix, to more clearly disclose our choice of TSS for each gene/operon and the design of our genetic constructs.</p><p>When we generate a library of mutated “regulatory regions” for Reg-Seq, we include a 160 bp region that includes 45 bp downstream of each TSS, and 115 bp upstream of each TSS. It is certainly possible, as noted by the reviewer, that a 160 bp region does not include all of the TF binding sites and regulatory information for a given gene/operon. In cases where little is known about the genetic architecture for a gene, and no TF binding sites have been experimentally determined, we cannot say definitively that our selected region includes all regulatory information.</p><p>A previous study from our group (Rydenfelt et al., 2014b) (see Author response image 1) asked the question: What is the distribution of binding site locations for activator and repressor TFs in the <italic>E. coli</italic> genome, based on a computational analysis of the RegulonDB database? In that study, as seen in Author response image 1, we found that most (but not all) TF binding sites fall within the range of approximately 45 bp downstream and 115 bp upstream of a TSS. Repressors tend to bind further upstream of a TSS than do activators. We used this study as the basis for designing the size and positioning of the 160 bp regulatory ”windows” used in this study, but of course, we are fully cognizant of the broader distribution revealed in Author response image 1, and in addition, of the even more thorny issue of action at a distance in the form of DNA looping. In future iterations of our experiments to dissect the <italic>E. coli</italic> ”regulome”, we aim to broaden the length of our mutagenized region, a goal which poses few conceptual or technical obstacles, though the question of DNA looping (and enhancers in eukaryotes) will clearly require further innovation.</p><p>For each gene, we obtained an average of 2200 unique DNA mutants in the form of oligo pools from TWIST Biosciences. This number was found to be sufficient for the replicable inference of binding energy matrices based on a previous systematic, experimental effort to evaluate the minimum number of DNA mutants that are necessary for such inference; we have previously discussed this in the context of Appendix 3—figure 1. We also now include our discussion of these points in Appendix 3 subsection “Uncertainty due to number of independent sequences”.</p><p>When we choose a TSS to study based on peer-reviewed literature and our search through the EcoCyc database, we do so using a few criteria; we always select, where possible, a TSS based on experimental evidence. If there are multiple TSS listed for a gene or operon of interest, we typically select the TSS that is best positioned to include regulatory information for all of the nearby TSS. For full transparency, however, we now include a spreadsheet that provides our rationale for selecting the TSS for each and every gene in this study (provided as Supplementary file 1).</p><p>To better disclose the design of our genetic constructs, we have also created a “cartoon” figure of the cloned plasmid architecture, which we show in Appendix 1—figure 1. As noted by the reviewer, our reporter construct is a pSC101-based plasmid with a kanamycin resistance marker. Each mutated, 160 bp DNA sequence is flanked by primer sites that are 20 bp in length (forward and reverse sites). Immediately downstream of the cloned regulatory regions is a random, unique, 20 bp barcode, followed by a ribosome binding site, GFP gene, and terminator. We have added clarifications on our genetic constructs to the accompanying figure legend in Appendix 1. Additionally, exact details of the sequences flanking the mutated region are stored in Supplementary file 2.</p><disp-quote content-type="editor-comment"><p>7) Authors used TSS information to decide which promoters to pursue. How limiting is this for scaling up the procedure? It would be helpful to discuss briefly what fraction of promoters in E. coli have good TSS information and how valid is to assume that at the genome-wide level, each operon is dominated by a single TSS?</p></disp-quote><p>We appreciate the reviewer’s comment and aim to address these concerns in this resubmission. We argue that the TSS information available in public databases is a significant limitation in the scaling up of this work that will require further ingenuity and vigilance on our part.</p><p>To explore this assumption, we downloaded the ”all promoters” dataset from RegulonDB v10.5 (Santos-Zavaleta et al., 2019), which provides information on every promoter in <italic>E. coli</italic>, with details on each promoter’s name, its DNA strand orientation, <italic>σ</italic> factors that recognize the promoter, the promoter sequence, evidence to support the existence of each promoter, and the confidence level of the evidence. An examination using Python indicated that, of the 2600 operons listed in RegulonDB, 2500 have a TSS known to be related to the operon or to have a TSS, determined by transcription initiation mapping, within 300 bp of the start of the operon. If we restrict our consideration to those TSS classified as having “Strong” or “Confirmed” evidence by RegulonDB, then 1700 operons have an associated TSS. In most cases, the evidence for a promoter with this classification is experimental; namely, the TSS was identified using transcription initiation mapping or RNA- seq experiments. The number of operons with a known TSS, as listed in these databases, represent a more than 10x increase over the number of genes explored in our Reg-Seq experiments and thus will serve as a powerful jumping off point for future iterations of this work. Unfortunately, EcoCyc and RegulonDB are not comprehensive, and thus will still not permit a complete genome-wide treatment of the problem.</p><p>The reviewer has also asked whether it is safe to assume, at the genome-wide level, that each operon is dominated by a single TSS. This is certainly not an assumption that we make in this study, as many genes/operons in <italic>E. coli</italic> have experimental evidence for multiple TSS, meaning that there are sometimes two or three promoters that are active upstream of certain genes or operons. Indeed, one of the limitations of the Reg-Seq method is its limited DNA “mutational window”; we are only able to build mutated oligo libraries for DNA fragments up to approximately 200 base pairs in length. This is a limitation that comes down to modern oligo synthesis technologies and financial feasibility, as ordering about 2000 unique sequences for 100 genes, each of which is about 200 bases in length, is already a costly endeavour. Thus, we do our utmost to include all known or putative regulatory information in the DNA sequences that we do order. If there are multiple TSS for a given gene/operon, we choose the TSS with the most experimental evidence, or the TSS that is located most closely to the others. In this resubmitted manuscript, we now include a spreadsheet as Supplementary file 1 that lists our rationale for choosing every TSS in this study.</p><disp-quote content-type="editor-comment"><p>8) The authors rely on expression from plasmids and use mRNA/DNA ratio to handle the effect of variability in plasmid copy number between cells. However, if the plasmid copy number is of a similar order of magnitude as the transcription factor copy number, then the expression level measured (to calculate the energy matrices) is determined not only by the binding energy, but also by the TF availability leading to under-estimation of the binding energies. The authors should comment on this in the manuscript, and if they have the data available, show the measurements for plasmid and TF copy numbers to address this point. At this point we do not see a necessity for additional experiments.</p></disp-quote><p>We are grateful to the reviewer for this comment, and certainly agree that this point demands serious consideration and scrutiny. Indeed, one of our favorite works from our laboratory was precisely aimed at rigorously predicting and measuring this effect, regarding protein and plasmid abundance (see Weinert et al., 2014). In that paper, we demonstrated how to control this effect in a parameter-free manner. Further, we share the reviewer’s aggravation that, until now, our experiments have been performed on plasmids. We have been working hard with the Sri Kosuri lab to make sure that our next set of experiments will involve chromosomally integrated libraries, and so only a single copy of each mutated promoter will be present in future iterations of our experiments.</p><p>With that said, the plasmid used in our experiments is derived from pUA66, which contains a pSC101 origin of replication (Zaslaver et al., 2006). A study from 1997 quantified the copy number of various “replication origins” and found that pSC101 has a copy number (in log phase) of 3 or 4 (Lutz and Bujard, 1997). To assess this copy number, the experimenters encoded luciferase on plasmids with differing origins of replication, quantified the luciferase activities for each, and compared their obtained values to a strain in which a single copy of the luciferase gene was inserted into the chromosome. The authors used a different strain of <italic>E. coli</italic> (DH5<italic>α</italic>Z1) and we have not independently assessed the copy number of our plasmid.</p><p>The absolute copy number of various TFs identified in our study can also be found using data from prior studies, chiefly those that performed experiments to quantify whole-proteome <italic>E. coli</italic> samples. Specifically, our laboratory has long admired a 2016 study from Matthias Heinemann’s group, which provides the absolute quantification for roughly 55 percent of predicted proteins in the <italic>E. coli</italic> K12 proteome using LC-MS (see Supplementary Table S6 from Schmidt et al., 2016. For those TFs that were quantified in the Schmidt study, and also identified in our Reg-Seq experiments, we provide their absolute quantification in <italic>E. coli</italic> K12 for both glucose and LB growth media in Appendix 3—table 2.</p><p>This table lists the global, absolute quantification for the listed TFs for <italic>E. coli</italic> K12 grown in both glucose (5 g/L concentration in M9 minimal media) and LB. For most TFs, the purported copy number for nearly all of these TFs is much greater than the low-copy number plasmid used in this study, thus mitigating the concern that the limited availability of a TF could impact gene expression, though we reiterate that going forward, we are committed to moving beyond this approach to perform chromosomal integrations.</p><p>“There are a few transcription factors in this work that have copy number on the order of the plasmid copy number, however, including XylR, DicA, and YgbI. […] The rank-order is always preserved and so the presence of a multi-copy plasmid will not change the mutual information between model predictions and experimental data. As a result, the final inference of energy matrices will remain the same.”</p><p>Again, we agree wholeheartedly with the reviewer that this point merits serious deliberation and discussion. As this is a point that astute readers of our work will likely share, we have added a modified form of this explanation to Appendix 3 subsection “Effect on calculated energy matrices when transcription factor copy number ≈ plasmid copy number”.</p><disp-quote content-type="editor-comment"><p>9) The limitations of the method should be more concisely explained. Currently, limitations are scattered throughout the text.</p></disp-quote><p>We thank the reviewer for their feedback and have aimed to address this concern by updating the main text’s Discussion section accordingly. Specifically, we have identified the major limitations discussed in the Results section, and have added them to the Discussion section, so that all main limitations relating to the Reg-Seq methodology can be found in one place. We have also added numerous limitations to this Discussion section, including our concerns regarding the use of mass spectrometry to identify weaker TF:DNA interactions, and further discuss our efforts to ameliorate some of these limitations for future work and the transcription research community at-large.</p><disp-quote content-type="editor-comment"><p>Revision required for Figures and Tables:</p><p>Figure 1: This figure is hard to read. It is difficult to distinguish the individual tick marks around the genome, because there are too many, they are too densely packed, and the colors are too mixed. Also, the caption describes the color of some ticks as &quot;red,&quot; but in the printed figure they look more brown (They appeared closer to red on the screen.)</p></disp-quote><p>We thank the reviewer for their comment and agree that the lines on this figure are difficult to distinguish. When making this schematic, we wanted to emphasize the known and unknown regions of the <italic>E. coli</italic> genome and did not aim to encode precise information about their positions. The percentages in the center serve to summarize the main point: that the majority of operons have no known regulation. As a result, we have opted to leave the figure unchanged, as it bolsters our argument concerning our “regulatory ignorance” of the <italic>E. coli</italic> genome. However, to address the reviewer’s concern with respect to gene positions, we now include (in Supplementary file 1) the genomic location of each gene’s TSS.</p><disp-quote content-type="editor-comment"><p>Figure 2: You might want to clarify that the blue region likely corresponds to the σ factor binding site.</p></disp-quote><p>We thank the reviewer for noticing this error and have corrected the caption for Figure 2 accordingly. Specifically, we now state that the RNAP binding region is highlighted in blue, whilst repressor binding regions are in red.</p><p>We have also updated the legends for Figure 3, 5, 7 and 8 to point out that repressor binding regions are in red, activator binding regions in green, and RNAP binding regions in blue.</p><disp-quote content-type="editor-comment"><p>Figure 3: The number of (0,0) promoters should be shown as well. Moreover, it seems that the counts in Figure 3 add up to about 50 and the text mentions that there are 32 promoters with no sites found, i.e. type (0,0). Adding this in the sum still seems much less than 113 (i.e., the total number of promoters as indicated in the manuscript). Related to this, it seems that Table 2 has clearly less than 113 promoters in it. Where are the remaining ones?</p></disp-quote><p>This figure (now Figure 6) has been updated to include these (0,0) architectures. As summarized in Table 1 of the main text, we only include in Figure 6(B) those regulated promoters which have at least one newly discovered binding site. The remaining 18 promoters that are not accounted for in Figure 6(B) were those we deemed “inactive” as we were unable to recover an RNAP binding site in the growth conditions we explored here. Further discussion regarding those promoters for which we did not recover an active RNAP binding site is now included in Appendix 3 subsection “Examination of promoters for which no RNAP site was found”.</p><disp-quote content-type="editor-comment"><p>Figure 4: The authors state about the results in Figure 4: &quot;In each of the cases shown in the figure, prior to the work presented here, these promoters had no regulatory information in relevant databases such as EcoCyc (Keseler et al., 2016) and RegulonDB (Santos- 318 Zavaleta et al., 2019).&quot;</p><p>This is simply not true. If you check EcoCyc for these genes you find:</p><p>i) idnK regulated by CRP, IdnR and GtnR.</p><p>ii) leuABCD regulated by LeuO, slyA, LrhA, and RcsB-BgU.</p><p>iii) maoP regulated by hdfR.</p><p>iv) rspA regulated by CRP and YdfH.</p><p>Only for yjjJ, aphA, and ybjX nothing was previously reported. It should also be noted that except for the rspA promoter, the previously reported regulatory interactions were generally not identified by the method.</p><p>Finally, it seems that there is no mass-spec data for yjjJ. Is the identification of marA as the regulator based on motif matching then?</p></disp-quote><p>We acknowledge and regret this mistake in claiming that these were newly discovered regulatory architectures. As an explanation, this figure was meant to display examples of data from a range of regulatory architectures, regardless of whether or not they were previously known, and the line referenced by the reviewer was intended to describe the following figure, but erroneously was used to describe the previous Figure 4. It was certainly not our intention to falsely over-state our discoveries. We have amended the previous Figure 4 caption to remove the erroneous text.</p><p>Unrelated to this comment, but as part of an overall push to make the methodology and results clearer, this figure has now replaced by a new Figure 4, listing all TF binding sites for which we have data. The new Figure 4 better encapsulates our point here: that this method is able to recover a myriad of regulatory architectures. Furthermore, MarA was identified as a regulator of <italic>yjjJ</italic> through motif matching to a putative binding site. A note to this effect is in the “Evidence” column of Table 2.</p><disp-quote content-type="editor-comment"><p>Table 2: This table is unclear. Does the &quot;architecture&quot; of a promoter (first column) correspond to what is inferred in this study, to what is known in the literature, or to a combination of both? For the newly found sites it should be listed whether the binding TF was identified and (if so) what it is. For the fourth column, “literature binding sites”, it is not clear whether this is the total number of known literature sites or only the number of known sites that were successfully identified here – both should be listed. It is not clear what the fifth column “identified binding sites” refers to. The evidence column is also unclear. Is this evidence for the newly found sites or the literature sites?</p><p>Just to illustrate the confusion: consider the well-known lac operon. In Table 2 the lac operon (called lac as opposed to lacZYA, which is used elsewhere in the manuscript) is reported to have only 1 known literature site, whereas it is well established that it has a site for CRP and multiple sites for LacI. In the final column it is claimed that there is mass-spec evidence for LacI binding. However, on the website, the lac operon does not occur at all and in Appendix 2—figure 1 only the CRP site is reported. What makes this all even more confusing is that none of the experimental conditions included lactose or another inducer of the operon. As such, the lac operon should be highly repressed and so we expect very little effect of mutating the CRP site, and strong effects of abolishing the LacI site.</p><p>In multiple cases in the table, less literature information is reported than it actually exists: e.g. tar is a reported target of FNR, uvrD is a reported target of LexA, cra is a reported target of PhoB, and so on. The authors should make clear what literature information is shown here.</p><p>The authors should clear up this information so as to make it unambiguous and consistent across tables, figures, and website.</p></disp-quote><p>We thank the reviewer for their comment and hope to address it in this resubmitted manuscript. Our 160 bp promoter regions (with 45 bp downstream of the annotated TSS used) does not always encapsulate all possible regulatory mechanisms, especially long-distance binding of repressors, as is the case in the <italic>lac</italic> operon. The regulatory architectures that we list in Table 2 in the main text reflect only the binding sites that we are able to recover within our 160 bp “mutation” window that was analyzed for each promoter in this study. While this is a clear limitation of the method, in that we are only able to recover regulation in a rather small, 160 bp region, we are encouraged by previous work that found that the majority of annotated regulation is found within 100 bp of the TSS (see Rydenfelt et al., 2014b).</p><p>In that study (a figure from which is displayed here as Author response image 1 and is further discussed in Major Comment 6 in this response letter), Rydenfelt <italic>et al.</italic> were able to show, using TSS and binding site positions in RegulonDB, that ”75% of all reported TF interactions in RegulonDB (v8.5) take place within 100 bp of the transcription start site.” Regardless of this close proximity to the TSS, however, repressor and activator binding sites do have distinctly different profiles, as activator binding sites tend to reside slightly further upstream of the TSS compared to repressor binding sites.</p><p>Furthermore, we do not include binding sites in this analysis that lack a known binding site location or that are listed as “low-evidence” in EcoCyc, which generally means that they were found only by similarity to a consensus binding site or through gene expression analysis. We agree with the reviewers that our rationale for including or excluding binding sites, as well as our organization of Table 2, was inadequate in our previous submission. To amend this shortcoming, we have added a new section to the appendix; namely, subsection “Explanation of included binding sites” in Appendix 4, which provides our explanations, for each relevant gene, regarding binding sites that appear in the regulatory information in RegulonDB or EcoCyc that are not addressed in Reg-Seq as a ”literature binding site” in Table 2. As one specific example from <italic>lacZYA</italic>, the mutagenized region extends from the TSS (the primary TSS p1) to 75 base pairs upstream of the TSS. The location of the mutagenized region excludes the LacI sites, while including a single CRP binding site, a MarA binding site, and two HNS binding sites. The expression from <italic>marA</italic> is expected to be low, as we do not grow the cells in the presence of salicylate or antibiotic stress and so we do not expect to observe the MarA site. In fact, the precursor of the Reg-Seq experiment, Sort-Seq, mutagenized and studied the same 75-base pair region, and only observed binding by CRP (Kinney et al., 2010). As such, we only include CRP in Table 2, the regulatory cartoons, or the analysis of false positives and false negatives discussed in Appendix 2 subsection “False positive and false negative rates”.</p><p>In our Reg-Seq experiments, there were several genes for which we failed to identify any repressor or activator binding sites, and indeed a limitation of this method (which we also discuss in the Discussion section of the main text), is our inability to study those binding sites outside of our narrow, 160 bp window.</p><p>We also have amended Table 2 in the main text in an attempt to clarify what is meant by each column. We now indicate in the table caption that the first column is meant to reflect the total number of binding sites that could be seen in the Reg-Seq data, regardless of whether there was previous evidence for their existence. We also note that binding sites which are not in the mutagenesis window or are otherwise not expected to appear in the Reg-Seq data, as explained in Appendix 4 subsection “Explanation of included binding sites”, are not counted in this tally. Similarly, we also emphasize that the literature sites column contains those sites that are both expected to be and are, in actuality, observed in the Reg-Seq data.</p></body></sub-article></article>