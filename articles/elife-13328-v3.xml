<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">13328</article-id><article-id pub-id-type="doi">10.7554/eLife.13328</article-id><article-categories><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Genomics and Evolutionary Biology</subject></subj-group><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Thousands of novel translated open reading frames in humans inferred by ribosome footprint profiling</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-38726"><name><surname>Raj</surname><given-names>Anil</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4412-0883</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-48212"><name><surname>Wang</surname><given-names>Sidney H</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-48213"><name><surname>Shim</surname><given-names>Heejung</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">‡</xref></contrib><contrib contrib-type="author" id="author-48214"><name><surname>Harpak</surname><given-names>Arbel</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-48215"><name><surname>Li</surname><given-names>Yang I</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0736-251X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-48216"><name><surname>Engelmann</surname><given-names>Brett</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9845-6668</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-19023"><name><surname>Stephens</surname><given-names>Matthew</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-2844"><name><surname>Gilad</surname><given-names>Yoav</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor3">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-7859"><name><surname>Pritchard</surname><given-names>Jonathan K</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="corresp" rid="cor4">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-4"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Genetics</institution>, <institution>Stanford University</institution>, <addr-line><named-content content-type="city">Stanford</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Human Genetics</institution>, <institution>University of Chicago</institution>, <addr-line><named-content content-type="city">Chicago</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Biology</institution>, <institution>Stanford University</institution>, <addr-line><named-content content-type="city">Stanford</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Department of Statistics</institution>, <institution>University of Chicago</institution>, <addr-line><named-content content-type="city">Chicago</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution>Howard Hughes Medical Institute, Stanford University</institution>, <addr-line><named-content content-type="city">Stanford</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ingolia</surname><given-names>Nicholas T</given-names></name><role>Reviewing editor</role><aff id="aff6"><institution>University of California, Berkeley</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>rajanil@stanford.edu</email> (AR);</corresp><corresp id="cor2"><email>siddisis@uchicago.edu</email> (SHW);</corresp><corresp id="cor3"><email>gilad@uchicago.edu</email> (YG);</corresp><corresp id="cor4"><email>pritch@stanford.edu</email> (JKP)</corresp><fn fn-type="present-address" id="pa1"><label>‡</label><p>Department of Statistics, Purdue University, West Lafayette, United States</p></fn><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>27</day><month>05</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>5</volume><elocation-id>e13328</elocation-id><history><date date-type="received"><day>24</day><month>12</month><year>2015</year></date><date date-type="accepted"><day>26</day><month>05</month><year>2016</year></date></history><permissions><copyright-statement>© 2016, Raj et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Raj et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-13328-v3.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.13328.001</object-id><p>Accurate annotation of protein coding regions is essential for understanding how genetic information is translated into function. We describe riboHMM, a new method that uses ribosome footprint data to accurately infer translated sequences. Applying riboHMM to human lymphoblastoid cell lines, we identified 7273 novel coding sequences, including 2442 translated upstream open reading frames. We observed an enrichment of footprints at inferred initiation sites after drug-induced arrest of translation initiation, validating many of the novel coding sequences. The novel proteins exhibit significant selective constraint in the inferred reading frames, suggesting that many are functional. Moreover, ~40% of bicistronic transcripts showed negative correlation in the translation levels of their two coding sequences, suggesting a potential regulatory role for these novel regions. Despite known limitations of mass spectrometry to detect protein expressed at low level, we estimated a 14% validation rate. Our work significantly expands the set of known coding regions in humans.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.001">http://dx.doi.org/10.7554/eLife.13328.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>ribosome profiling</kwd><kwd>translation</kwd><kwd>hidden Markov models</kwd><kwd>upstream ORF</kwd><kwd>noncoding RNA</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>HG007036</award-id><principal-award-recipient><name><surname>Pritchard</surname><given-names>Jonathan K</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>MH084703</award-id><principal-award-recipient><name><surname>Gilad</surname><given-names>Yoav</given-names></name><name><surname>Pritchard</surname><given-names>Jonathan K</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>HG02585</award-id><principal-award-recipient><name><surname>Stephens</surname><given-names>Matthew</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Pritchard</surname><given-names>Jonathan K</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Over 7,000 novel translated sequences have been identified from human cells, including several hundred in annotated noncoding RNA, pseudogenes and de novo assembled transcripts.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Annotations for coding sequences (CDSs) are fundamental to genomic research. The GENCODE Consortium (<xref ref-type="bibr" rid="bib19">Harrow et al., 2012</xref>) has played an important role in annotating the set of protein coding sequences in the human genome, predominantly relying on manual annotation from the Human and Vertebrate Analysis and Annotation (HAVANA) group (<xref ref-type="bibr" rid="bib53">Wilming et al., 2008</xref>). Their annotation pipeline identifies coding sequences using homology with sequences in large cDNA/EST databases and the SWISS-PROT protein sequence database (<xref ref-type="bibr" rid="bib2">Bairoch and Apweiler, 2000</xref>), and validates them using sequence homology across vertebrates and using tandem mass spectrometry. Despite being the most comprehensive database of CDSs available, the current set is conservative and does not include several classes of CDSs, including translated upstream open reading frames (ORFs), dually coded transcripts, and N-terminal extensions and truncations.</p><p>Recent work has made it increasingly clear that much of the human genome is transcribed in at least one tissue during some stage of development (<xref ref-type="bibr" rid="bib18">Hangauer et al., 2013</xref>; <xref ref-type="bibr" rid="bib12">Djebali et al., 2012</xref>; <xref ref-type="bibr" rid="bib6">Birney et al., 2007</xref>; <xref ref-type="bibr" rid="bib9">Clark et al., 2011</xref>; <xref ref-type="bibr" rid="bib25">Kapranov et al., 2007</xref>; <xref ref-type="bibr" rid="bib50">van Bakel et al., 2010</xref>). However, the functional implication for most of these transcripts remains unclear; in particular, the set of sequences translated from these transcripts are not yet completely characterized. For example, there are several recent studies in which RNA transcripts that were previously annotated as noncoding were shown to encode short functional peptides. One well characterized example is the <italic>polished rice (pri) / tarsal-less (tal</italic>) locus in flies, a polycistronic mRNA encoding four short peptides active during embryogenesis (<xref ref-type="bibr" rid="bib29">Kondo et al., 2007</xref>, <xref ref-type="bibr" rid="bib30">2010</xref>; <xref ref-type="bibr" rid="bib16">Galindo et al., 2007</xref>). While short peptides are known to play critical roles in multiple biological processes (<xref ref-type="bibr" rid="bib35">Lauressergues et al., 2015</xref>; <xref ref-type="bibr" rid="bib44">Oelkers et al., 2008</xref>; <xref ref-type="bibr" rid="bib8">Le Mercier et al., 2006</xref>; <xref ref-type="bibr" rid="bib24">Jung et al., 2009</xref>), annotating genomic regions that encode them remains challenging.</p><p>Direct proteogenomic mass spectrometry has the potential to fill this gap but suffers from variable accuracy in assignment of peptide sequences to spectra and assignment of identified peptides to proteins (for peptides shared across database entries). Moreover, these approaches suffer from a “needle in a haystack” problem when searching all six translational frames over the transcribed portion of the genome (<xref ref-type="bibr" rid="bib42">Nesvizhskii, 2014</xref>; <xref ref-type="bibr" rid="bib8">Le Mercier et al., 2006</xref>; <xref ref-type="bibr" rid="bib39">Ma, 2015</xref>). Alternative approaches that utilize empirically-derived phylogenetic codon models to distinguish coding transcripts from non-coding transcripts are promising (<xref ref-type="bibr" rid="bib38">Lin and Kellis, 2011</xref>). However, the success of such approaches is contingent on the duration, strength and stability of purifying selection and these methods may be underpowered for short coding sequences or for newly evolved coding sequences.</p><p>Ribosome profiling utilizes high throughput sequencing of ribosome-protected RNA fragments (RPFs) to quantify levels of translation (<xref ref-type="bibr" rid="bib22">Ingolia et al., 2009</xref>). Briefly, the technique consists of isolating monosomes from RNase-digested cell lysates and extracting and sequencing short mRNA fragments protected by ribosomes. Early studies of ribosome profiling have shown that RPFs are substantially more abundant within the CDS of annotated transcripts compared to the 5’ or 3’ untranslated regions (UTRs) (<xref ref-type="bibr" rid="bib22">Ingolia et al., 2009</xref>; <xref ref-type="bibr" rid="bib52">Weinberg et al., 2016</xref>). More importantly, when aggregated across annotated coding transcripts, the RPF abundance within the CDS has a clear three base-pair periodicity while the RPF abundance in the UTRs lacks this periodic pattern.</p><p>Recently, using ribosome profiling data, several studies reported conflicting results on the coding potential of long intergenic noncoding RNA (<xref ref-type="bibr" rid="bib23">Ingolia et al., 2011</xref>; <xref ref-type="bibr" rid="bib17">Guttman et al., 2013</xref>; <xref ref-type="bibr" rid="bib21">Ingolia et al., 2014</xref>). These studies assessed coding potential using either i) the enrichment of RPFs within the translated CDS relative to background, or ii) the difference in length of RPFs within the translated CDS compared to background. However, these approaches may lack power for several reasons. First, they make little distinction between ribosomes scanning through the transcript and ribosomes decoding the message. Second, the enrichment signal can be severely diminished if the transcript is significantly longer than the coding region within it. Third, there is often substantial variance in RPF abundance within the CDSs, which can decrease power to detect translated sequences when using a simple RPF enrichment statistic alone. Other studies have used the periodicity structure in RPF counts to identify dual coding sequences and short translated CDSs (<xref ref-type="bibr" rid="bib40">Michel et al., 2012</xref>; <xref ref-type="bibr" rid="bib5">Bazzini et al., 2014</xref>), but the methods reported high false positive rates and could only identify a few hundred CDSs.</p><p>In this work, we developed riboHMM; a model to identify translated CDSs by leveraging both the total abundance and the codon periodicity structure in RPFs. We used this model to identify thousands of novel CDSs in the transcriptome of human lymphoblastoid cell lines (LCLs).</p><sec id="s1-1"><title>Probabilistic model to infer translated coding sequences</title><p>Ribosome footprint profiling data, when aggregated across annotated coding transcripts centered at their translation initiation (or termination) sites (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), show two distinct features that distinguish the CDS from untranslated regions (UTRs).</p><list list-type="bullet"><list-item><p><bold>Higher abundance within the CDS</bold>. RPF counts are highly enriched within the CDS overall. Moreover, base positions within the CDS close to the translation initiation and termination sites have substantially higher RPF counts compared to base positions in the rest of the CDS. Untranslated regions have very low RPF counts, with the 5’UTR having a slightly higher RPF count compared to the 3’UTR. Furthermore, base positions in the 5’UTR immediately flanking the initiation site have a slightly higher RPF count compared to the rest of the 5’UTR; a similar pattern is observed in the 3’UTR.</p></list-item><list-item><p><bold>Three-base periodicity within the CDS</bold>. RPF counts typically peak at the first position of each codon. The RPF count over the initiation and termination codons tend to have a stronger peak (thus, a slightly different periodic pattern) compared to the rest of the CDS. The RPF counts in the UTRs lack this periodic pattern with similar aggregate counts among base positions in the 5’UTR and 3’UTR.</p></list-item></list><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.13328.002</object-id><label>Figure 1.</label><caption><title>Illustrating the model.</title><p>(<bold>A</bold>) Proportion of footprint counts aggregated across 1000 highly expressed annotated coding transcripts, centered at their translation initiation (blue) and termination (orange) sites. In aggregate, RPF count data have higher abundance within the CDS than the UTRs and exhibit a 3-base periodicity within the CDS. (<bold>B</bold>) Each transcript belongs to one of three unobserved reading frames, and is represented as a sequence of base-triplets (highlighted by differing shades of gray) that depends on the reading frame. Each triplet belongs to one of nine unobserved states. The state sequence shown corresponds to frame 3 and varying shades from purple to green highlight the different states. Base positions marked in orange are modeled independently and always belong to the relevant UTS state. Transitions with nonzero probabilities are indicated by arrows, with solid arrows denoting a probability of 1 and dotted arrows denoting probabilities that are a function of the underlying sequence.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.002">http://dx.doi.org/10.7554/eLife.13328.002</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig1-v3"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Robustness of periodicity parameter estimates.</title><p>Bar plots of the periodicity parameters <inline-formula><mml:math id="inf1"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, for 29 bp long footprints, estimated using the top 5000 expressed genes. Each red circle indicates the parameter values estimated by using a random set of 1000 genes.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.003">http://dx.doi.org/10.7554/eLife.13328.003</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig1-figsupp1-v3"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.004</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Robustness of occupancy parameter estimates.</title><p>Bar plots of the maximum likelihood estimates of the occupancy parameters in each state, <inline-formula><mml:math id="inf2"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (scaled by <inline-formula><mml:math id="inf3"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for mCDS). For mCDS (dark gray), the parameters were estimated using the top 5000 expressed genes, and the red circles indicate parameter values estimated using a random set of 1000 genes. For uaCDS (light gray), the parameters were estimated using a random set of 5000 upstream-restricted transcripts, and each red circle indicates values estimated using random sets of 1000 upstream-restricted transcripts.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.004">http://dx.doi.org/10.7554/eLife.13328.004</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig1-figsupp2-v3"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.005</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Decision rules to identify matches and mismatches of mCDS to annotation.</title><p>Illustrating the decisions by which mCDS inferred on each transcript are identified as an exact match, a frame match) or a mismatch to annotated coding sequences. Matches and mismatches are only defined when the transcript is annotated by GENCODE as coding and the classification depends on agreement with the annotated CDS. A gene is considered to have an exact (or frame) match if at least one of its isoforms is labeled an exact (or frame) match. In all other cases, the inference for the coding gene is considered a mismatch.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.005">http://dx.doi.org/10.7554/eLife.13328.005</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig1-figsupp3-v3"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.006</object-id><label>Figure 1—figure supplement 4.</label><caption><title>Model accuracy.</title><p>Quantifying model accuracy in terms of the fraction of previously annotated CDSs accurately recovered as a function of total footprint sequencing depth. We performed the entire analysis on the same set of assembled transcripts (parameter estimation and inference) after subsampling the data. Starting with inferences using the complete footprint data set that exactly match annotated CDSs (top subpanel), we show the fraction of these CDSs that were accurately (blue) and inaccurately (brown) recovered with a high posterior for varying sequencing depths. Starting with inferences that only match the frame of annotated CDSs (bottom subpanel), we show the fraction of accurately and inaccurately recovered CDSs for varying sequencing depths.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.006">http://dx.doi.org/10.7554/eLife.13328.006</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig1-figsupp4-v3"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.007</object-id><label>Figure 1—figure supplement 5.</label><caption><title>Comparing footprint abundance and gene expression.</title><p>Scatter plot of the RNA-seq density (reads per base per million sequenced reads) within annotated coding transcripts <italic>vs.</italic> the expected ribosome footprint count (normalized by sequencing depth) in triplets within the CDS of the transcripts. The top 50th percentile of expressed genes is shown in black and the bottom 50th percentile is shown in gray. For highly expressed genes, it is reasonable to assume that the expected footprint count in a triplet scales linearly with RNA-seq density. However, for lowly expressed genes and outlier genes (i.e., genes with high expected footprint count and low RNA-seq density, and genes with high RNA-seq density and low expected footprint count), this assumption may not be valid.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.007">http://dx.doi.org/10.7554/eLife.13328.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig1-figsupp5-v3"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.008</object-id><label>Figure 1—figure supplement 6.</label><caption><title>Comparing the periodicity in ribosome footprint counts for footprints of different lengths.</title><p>Proportion of footprint counts aggregated across 1000 highly expressed annotated coding transcripts, centered at their translation initiation sites. Each subplot illustrates the proportions for footprints of a given length, with the periodicity in the proportions showing distinct features between footprints of different lengths.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.008">http://dx.doi.org/10.7554/eLife.13328.008</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig1-figsupp6-v3"/></fig><fig id="fig1s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.009</object-id><label>Figure 1—figure supplement 7.</label><caption><title>Robustness of parameters for start codon usage to choice of learning set.</title><p>The estimated values of the parameter <inline-formula><mml:math id="inf4"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> when using the 5000 most expressed genes (blue) and random sets of 5000 genes (gray) show that start codon usage is robust to the choice of the learning set.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.009">http://dx.doi.org/10.7554/eLife.13328.009</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig1-figsupp7-v3"/></fig></fig-group><p>We developed a framework to infer the translated CDS in a transcript using a model that 1) captures these distinct features of ribosome profiling data and 2) integrates RNA sequence information and transcript expression. As illustrated in <xref ref-type="fig" rid="fig1">Figure 1B</xref>, to capture the three-base structure in the RPF count data within the CDS, we represented a transcript as a sequence of non-overlapping base triplets. The CDS of the transcript is required to belong to one of three reading frames. To account for all three reading frames, each transcript has a latent frame variable that specifies at which base position of the transcript we begin enumerating the triplets.</p><p>Conditional on the frame, we modeled the data for each transcript, represented as a sequence of base triplets, using a hidden Markov model (HMM). Each triplet belongs to one of nine latent states — 5’UTS (5’ Untranslated State), 5’UTS+ (the last untranslated triplet prior to the initiation site), TIS (Translation Initiation State), TIS+ (the triplet immediately following the initiation site), TES (Translation Elongation State), TTS- (the translated triplet prior to the termination site), TTS (Translation Termination State), 3’UTS- (the first untranslated triplet immediately following the termination site), and 3’UTS (3’ Untranslated State). The states {TIS, TIS+, TES, TTS-, TTS} denote translated triplets and {5’UTS, 5’UTS+, 3’UTS-, 3’UTS} denote untranslated triplets. The probability distribution over the possible sequence of latent states is a function of the underlying RNA sequence. <xref ref-type="fig" rid="fig1">Figure 1B</xref> illustrates these states, and how they relate to each other, in conjunction with the transcript representation. The groups of states {5’UTS+, TIS, TIS+} and {TTS-, TTS, 3’UTS-} help model the distinct structure of the RPF counts around the translation initiation and termination sites, respectively.</p><p>Assuming each transcript has either 0 or 1 CDS, we restricted the possible transitions between latent states as shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref>: transitions from 5’UTS to 5’UTS+ occur with probability <inline-formula><mml:math id="inf5"><mml:mi>ρ</mml:mi></mml:math></inline-formula>, transitions from TES to TTS- occur with probability <inline-formula><mml:math id="inf6"><mml:mi>ζ</mml:mi></mml:math></inline-formula>, and all other allowed transitions have probability 1. The transition probabilities <inline-formula><mml:math id="inf7"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf8"><mml:mi>ζ</mml:mi></mml:math></inline-formula> are estimated from the data, and are allowed to depend on the base sequence of the triplet; in addition, the probability <inline-formula><mml:math id="inf9"><mml:mi>ρ</mml:mi></mml:math></inline-formula> also depends on the base sequence context around the triplet (<xref ref-type="bibr" rid="bib31">Kozak, 1987</xref>). In this work, we assume that translation termination occurs at the first in-frame stop codon (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>), i.e., we do not consider stop codon readthrough.</p><p>Conditional on the state assignments, we modeled 1) the total RPF abundance within a triplet, to account for the observation that translated base positions have a higher average RPF count compared to untranslated base positions, and 2) the distribution of RPF counts among the base positions in a triplet, to account for the periodicity in RPF counts within translated triplets. We explicitly accounted for differences in RPF abundance due to differences in transcript expression levels by using transcript-level RNA-seq data as a normalization factor. The short lengths of ribosome footprints mean that many base positions are unmappable; we treated triplets with unmappable positions by modifying the emission probabilities accordingly. Finally, we accounted for the additional variation in RPF counts across triplets assigned to the same state by modeling overdispersion in the triplet RPF abundance (see Materials and methods for details).</p><p>To quantify the accuracy of our model, we designed a simulation scheme to estimate what fraction of our inferred translated sequences are false discoveries. We first estimated the Type 1 error rate – i.e., the probability of inferring a translated region when no such region exists – using a set of simulated transcripts that had no signal of translation (null transcripts). The simulated transcripts were constructed by permuting the observed footprint counts in annotated coding transcripts. We then used this estimate to quantify the false discovery rate for each class of translated CDSs identified by riboHMM. Independently, using a simulated set of transcripts containing some signal of translation, we quantified the proportion of transcripts where our model incorrectly identified the precise translation initiation site conditional on having identified a translated sequence (see Materials and methods for details on the simulations).</p></sec></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Application to human lymphoblastoid cell lines</title><p>We applied riboHMM to infer translated CDSs in human lymphoblastoid cell lines (LCLs) for which gene expression phenotypes were measured genome-wide: mRNA in 86 individuals, ribosome occupancy in 72 individuals and protein levels in 60 individuals (<xref ref-type="bibr" rid="bib34">Lappalainen et al., 2013</xref>; <xref ref-type="bibr" rid="bib4">Battle et al., 2015</xref>). We first assembled over 2.8 billion RNA sequencing reads into transcripts using StringTie (<xref ref-type="bibr" rid="bib46">Pertea et al., 2015</xref>). This assembly gives us annotated transcripts that are expressed in LCLs, along with novel transcripts that do not overlap any GENCODE annotated gene. (We do not consider novel isoforms of annotated genes in our analyses.) Restricting to transcripts with at least five footprints mapped to each exon, we used riboHMM to identify high-confidence translated CDS. We learned the maximum likelihood estimates of the model parameters using the top five thousand highly expressed genes. The estimated parameters are robust to the choice of the learning set (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>). Using these parameters, we then inferred the maximum <italic>a posteriori</italic> (MAP) frame and latent state sequence for each of the assembled transcripts. We retained transcripts whose MAP frame and state sequence corresponded to a pair of translation initiation and termination sites and had a joint posterior probability greater than 0.8. Using a set of simulated null transcripts, we estimated that this posterior cutoff corresponded to a Type 1 error rate of 4.5% per transcript. The MAP frame and state sequence directly give us the nucleotide sequence with the strongest signal of translation; we refer to these as main coding sequences or mCDS.</p></sec><sec id="s2-2"><title>Detection of novel CDSs in LCLs</title><p>Among 7801 GENCODE annotated coding genes for which we could infer a high posterior mCDS, we recovered the annotated reading frame for at least one transcript isoform in 7491 genes (96%); of these, we recovered the exact annotated CDS in 4500 genes. In the remaining 310 genes, among all isoforms where we inferred an mCDS, the mCDS had a distinct reading frame from the annotated CDS (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref> details the rules that decide how our inference agrees with GENCODE). Of all GENCODE coding genes, we identified 814 GENCODE isoforms where our method identified an mCDS with a distinct reading frame from the annotated CDS. This set of 814 includes both isoforms within the 310 genes and additional isoforms within the 7491 genes (i.e., excluding the isoforms where the mCDS matched the frame of the annotated CDS).</p><p>We used simulations to estimate the accuracy of our inferences. For transcripts that do contain a translated sequence, we find that riboHMM inaccurately identifies an overlapping, translated sequence in a different frame at extremely low rates (Type 1 error rate = 0.31%). In contrast, riboHMM has a relatively high error rate for identifying the precise translation initiation site (false discovery proportion = 38%; see Materials and methods for details). Among transcripts where riboHMM correctly identified the reading frame, the concordance between the inferred and annotated translation initiation site does not correlate with the length of CDS (Mann-Whitney test; p-value = 0.12). Amongst these, when riboHMM did not identify the annotated initiation site, the inferred initiation site was equally likely to be upstream or downstream of the annotated initiation site (Mann-Whitney test; p-value = 0.41). Our analysis is robust to sequencing depth; <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref> illustrates that nearly 60% of annotated coding sequences identified with the full data set (580 million footprints) could be accurately recovered even when the sequencing depth was reduced by almost two orders of magnitude.</p><p>Thus, in summary, it is likely that most of the 814 mCDS that were identified within GENCODE annotated protein-coding transcripts and have a distinct reading frame compared to GENCODE annotations are indeed novel alternate translated sequences. To ensure that an mCDS is truly novel, we verified that it does not overlap any known CDS annotated by GENCODE, UCSC (<xref ref-type="bibr" rid="bib48">Rosenbloom et al., 2015</xref>), or CCDS (<xref ref-type="bibr" rid="bib15">Farrell et al., 2014</xref>) in the same frame. (See <xref ref-type="fig" rid="fig2">Figure 2</xref> for the different classes of LCL transcripts that contain a novel mCDS; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> illustrates the decision rules used to identify a novel mCDS). Among these 814 novel mCDS, 386 mCDS overlap an annotated CDS but have a different reading frame (labeled ‘dual-coding’) and 156 do not overlap the annotated CDS. An example of a novel dual-coding region – an mRNA sequence that codes for proteins in two different frames – inferred in the POLR2M gene is illustrated in <xref ref-type="fig" rid="fig3">Figure 3A</xref>. Using tandem mass-spectrometry data (<xref ref-type="bibr" rid="bib4">Battle et al., 2015</xref>), we found four unique spectra matching peptides in the mCDS and no spectra matching peptides in the annotated CDS (protein level posterior error probability = 3 × 10<sup>−35</sup>. However, our simulations suggest that most, or all, of the 39% of genes where riboHMM infers the annotated reading frame but disagrees with the annotated start site are false discoveries, and these are not considered further here.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.13328.010</object-id><label>Figure 2.</label><caption><title>Overview of novel coding sequences.</title><p>The analysis workflow indicates the size of the data (in read/footprint depth, or number of transcripts) at each step and the numbers and classes of transcript within which novel translated sequences were identified. Transcripts assembled by StringTie that do not overlap any annotated gene are called 'novel transcripts'. Long non-coding RNA includes lincRNAs, antisense transcripts and transcripts with retained introns, short non-coding RNA includes snRNA, snoRNA and miRNA, processed transcripts are transcripts without a long, canonical ORF, and pseudogenes include all subclasses of such genes annotated by GENCODE.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.010">http://dx.doi.org/10.7554/eLife.13328.010</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig2-v3"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.011</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Decision rules to identify novel mCDS.</title><p>Illustrating the decisions that identify novel mCDS. The mCDS that do not overlap any known CDS (pooling GENCODE, UCSC and CCDS annotations) are labeled as novel mCDS -- these include mCDS from both novel and annotated transcripts.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.011">http://dx.doi.org/10.7554/eLife.13328.011</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig2-figsupp1-v3"/></fig></fig-group><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.13328.012</object-id><label>Figure 3.</label><caption><title>Thousands of novel translated sequences identified in annotated and novel transcript isoforms.</title><p>(<bold>A</bold>) The inferred CDS for an isoform of the POLR2M gene overlaps its annotated CDS and is in a different frame. All four distinct peptides uniquely mapping to this gene match the inferred CDS (protein-level posterior error probability = 3 × 10<sup>−35</sup>). (The introns and the last exon have been shortened for better visualization.) (<bold>B</bold>) Distribution of start codon usage across all novel mCDS. (<bold>C</bold>) Distribution of the lengths of the novel mCDS (gray) compared with the lengths of GENCODE annotated CDSs (black).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.012">http://dx.doi.org/10.7554/eLife.13328.012</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig3-v3"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.013</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Translated coding sequences identified in hundreds of pseudogenes.</title><p>Comparing the inferred CDS in the pseudogene GAPDHP72 (orange) with the annotated CDS (purple) of its parent gene GAPDH (introns have been removed for better visualization). Gray shaded boxes show the alignment between the pseudogene and parent gene transcripts, and dark shaded boxes indicate that the inferred coding frame of the pseudogene matches that of the parent gene. Although the pseudogene and parent gene share coding frames, the underlying sequences are sufficiently different.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.013">http://dx.doi.org/10.7554/eLife.13328.013</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig3-figsupp1-v3"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.014</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Comparing the amino acid content between annotated and novel CDS.</title><p>The overall amino acid content is largely similar between annotated CDSs and novel CDSs (mCDS, pseudogenes and uaCDS), with a substantially higher proportion of lysine and isoleucine residues in CDSs within pseudogenes, and a higher proportion of alanine, arginine, glycine, and proline residues within mCDS and uaCDS.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.014">http://dx.doi.org/10.7554/eLife.13328.014</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig3-figsupp2-v3"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.015</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Characteristics of peptides matched to novel CDS.</title><p>(<bold>A</bold>) Histogram of number of independent identification of unique peptides across novel mCDS that have at least one peptide match. (<bold>B</bold>) Scatter plot of the untreated ribosome footprint density and the protein abundance (median abundance across all unique peptides) across all novel mCDS that have at least one peptide match (Spearman R = 0.24; ).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.015">http://dx.doi.org/10.7554/eLife.13328.015</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig3-figsupp3-v3"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.016</object-id><label>Figure 3—figure supplement 4.</label><caption><title>Annotated genes with peptide hits tend to be longer, have higher expression and a distinct amino acid composition.</title><p>(<bold>A</bold>) Cumulative distribution of footprint density for genes with at least one unique peptide hit (blue) and genes with no unique peptide hit (red). The median footprint density of genes with a peptide hit is about 125 fold higher than the median footprint density of genes without a peptide hit. (<bold>B</bold>) Cumulative distribution of protein length for genes with at least one unique peptide hit (blue) and genes with no unique peptide hit (red). Genes with a peptide hit tend to code for proteins that are 20% longer than proteins encoded by genes without a peptide hit. (<bold>C-F</bold>) Comparing amino acid composition within tryptic peptides with a mass-spectrum match and tryptic peptides without a mass-spectrum match. Amino acids, grouped by their electrostatic properties, have distinct compositions between matched and unmatched peptides. Matched peptides tend to be significantly shorter than unmatched peptides, and have a distinct composition of charged amino acids.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.016">http://dx.doi.org/10.7554/eLife.13328.016</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig3-figsupp4-v3"/></fig></fig-group></p><p>In addition, we identified 2550 novel mCDS in annotated non-coding transcripts and 1019 mCDS within novel transcripts assembled <italic>de novo</italic> by StringTie (FDR = 5.6%). Using simulations, we estimated that given a transcript has no translated sequence; riboHMM inaccurately identifies a translated sequence at fairly low error rates (Type I error rate = 4.5%). Over 60% of the mCDS in novel transcripts were identified in single-exon transcripts transcribed from regions containing no annotated genes, while about 8% were identified in novel transcripts transcribed from the strand opposite to an annotated transcript. Finally, we inferred mCDS in 448 expressed pseudogenes, among 14,065 pseudogenes annotated in humans (<xref ref-type="bibr" rid="bib45">Pei et al., 2012</xref>); nearly 90% of these mCDS were identified in processed pseudogenes. An mCDS in pseudogene GAPDHP72 is shown in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, comparing the ribosome abundance and peptide matches to the pseudogene mCDS with those of its parent gene GAPDH.</p><p>Unlike current CDS annotations, which almost exclusively start at the methionine codon AUG, these novel mCDS taken together have a substantially higher usage of non-canonical codons, particularly CUG (<xref ref-type="fig" rid="fig3">Figure 3B</xref>), consistent with recent observations in mouse embryonic stem cells (<xref ref-type="bibr" rid="bib23">Ingolia et al., 2011</xref>) and human embryonic kidney cells (<xref ref-type="bibr" rid="bib37">Lee et al., 2012</xref>). This is despite the fact that we inferred the initiation site by assuming shared properties between novel and annotated CDS. Although riboHMM has a high error rate when identifying translation initiation sites, our use of a hierarchical model for the initiation sites suggests that the errors in our inferred start codons are likely to be unbiased. These novel mCDS are also significantly shorter than annotated CDSs (median lengths 23 vs. 339 amino acids, Mann-Whitney test p-value &lt; 2.2 × 10<sup>−16</sup>; <xref ref-type="fig" rid="fig3">Figure 3C</xref>). The overall amino acid content within novel mCDS is comparable to that within annotated CDS, with a slight enrichment for arginine, alanine, cysteine, glycine, proline, and tryptophan residues (binomial test, p-value &lt; 1.1 × 10<sup>−16</sup>; <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>).</p><p>Below, using an alternative measure of ribosome occupancy, we first assess independent evidence for translation initiation at many of these novel mCDS. Then, we test whether these mCDS are functional both using human polymorphism data and using substitution patterns across vertebrates. Finally, we characterize those mCDS whose peptide products were identified in mass-spectrometry data.</p></sec><sec id="s2-3"><title>Translation at novel mCDS validated using harringtonine-treated ribosome footprints</title><p>We next sought to provide independent experimental validation for the novel mCDS. A direct approach to validate translation initiation sites is to assay ribosome occupancy in cells treated with harringtonine (<xref ref-type="bibr" rid="bib23">Ingolia et al., 2011</xref>). Harringtonine interacts with and arrests the initiation complex while leaving the elongation complex to continue translating and run off the transcript. Harringtonine-treated ribosome footprint profiling data therefore show a specific enrichment pattern at the translation initiation site; this pattern has previously been used to identify translation initiation sites in mouse embryonic stem cells (<xref ref-type="bibr" rid="bib23">Ingolia et al., 2011</xref>). We measured harringtonine-treated ribosome footprints in two LCLs and aggregated the counts of footprints across all novel mCDS. We observed an enrichment of footprints at the inferred initiation site of the novel mCDS (binomial test, p-value = 9.5 × 10<sup>−79</sup>; <xref ref-type="fig" rid="fig4">Figure 4</xref>), similar to the enrichment of aggregate ribosome occupancy at the initiation sites of a matched number of mCDS that agreed exactly with the annotated CDS (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> for mCDS in pseudogenes). We observed a significant enrichment at both AUG (p-value = 5.2 × 10<sup>−79</sup>) and non-AUG (p-value = 9.4 × 10<sup>−25</sup>) initiation sites. The reduced enrichment for the novel mCDS compared to annotated CDSs is likely due to the lower levels of translation of these novel mCDS and the high error rate in identifying the precise base at which translation is initiated. Accounting for these limitations, our observation of enrichment suggests that ribosomes do initiate the translation of many of the novel mCDS identified by riboHMM.<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.13328.017</object-id><label>Figure 4.</label><caption><title>Validation of novel mCDS using harringtonine-treated ribosome profiling data.</title><p>Harringtonine-treated ribosome footprints show enrichment at the inferred translation initiation sites, when aggregated across novel mCDS (orange), similar to the enrichment at the initiation sites of a matched number of mCDS that agreed exactly with the annotated CDS (purple), suggesting that ribosomes do initiate translation of the novel mCDS.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.017">http://dx.doi.org/10.7554/eLife.13328.017</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig4-v3"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.018</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Validation of translated sequences identified in pseudogenes.</title><p>Enrichment of harringtonine-arrested ribosome occupancy at the inferred translation initiation sites validates our inferred mCDS in pseudogenes.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.018">http://dx.doi.org/10.7554/eLife.13328.018</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig4-figsupp1-v3"/></fig></fig-group></p></sec><sec id="s2-4"><title>Selective constraint on coding function in novel mCDS</title><p>We next ascertained the functional importance of these novel mCDS based on the selective constraint imposed on random mutations that occur within them. A bi-allelic single nucleotide polymorphism (SNP) that falls within an mCDS can be inferred as synonymous or nonsynonymous depending on whether switching between the two alleles of the SNP changes the amino acid sequence of the mCDS. If the mCDS do not produce proteins that are functionally important, we expect the two classes of variants to have similar selection pressures on average, and thus to segregate at similar frequencies. Only if the novel mCDS produce functionally important peptides do we expect inferred nonsynonymous SNPs to segregate at lower frequencies than inferred synonymous SNPs.</p><p>Starting with biallelic SNPs identified using whole genome sequences of 2504 individuals (<xref ref-type="bibr" rid="bib1">Auton et al., 2015</xref>), we examined the set of SNPs falling within all novel mCDS (13,907 variants within 3096 novel mCDS). We labeled each SNP as synonymous or nonsynonymous with respect to the inferred CDS and show the cumulative distribution of minor allele frequencies (MAF) of each SNP class (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). We observed that nonsynonymous SNPs have an excess of rare variants compared with synonymous SNPs (Mann-Whitney test; p-value = 1.08 × 10<sup>−4</sup>), implying a difference in the intensity of purifying selection (<xref ref-type="bibr" rid="bib43">Nielsen, 2005</xref>). This observed excess suggests that the novel mCDS are under significant constraint, consistent with functional peptides, albeit weaker than at annotated CDS. The mCDS identified within pseudogenes alone also showed a similar excess of rare variants among nonsynonymous SNPs (Mann-Whitney test; p-value = 5.6 × 10<sup>−3</sup>). Such an excess was not observed for pseudogenes that had detectable ribosome occupancy but lacked a high-confidence inferred coding sequence (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>); for these pseudogenes, the SNPs were labeled based on the reading frame of the parent gene. This highlights that ribosome occupancy alone is insufficient to identify translated sequences, and our method is able to leverage finer scale structure in ribosome footprint data to detect functional coding sequences.<fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.13328.019</object-id><label>Figure 5.</label><caption><title>Novel translated sequences show significant signatures of coding function.</title><p>(<bold>A</bold>) Genetic variants that are nonsynonymous with respect to the inferred mCDS segregate at significantly lower frequencies in human populations than synonymous variants. The novel regions are under weaker selective constraint compared to known CDS. (The numbers of variants in each class are matched between novel and annotated CDS.) (<bold>B</bold>) Scatter plot comparing the substitution rate at inferred synonymous variants versus inferred nonsynonymous variants for each novel mCDS, computed using multiple sequence alignments across 100 vertebrate species. Highlighted in red are 232 novel mCDS identified to be under significant long-term purifying selection after Bonferroni correction (testing for dN/dS &lt; 1;), indicating conserved coding function for these sequences.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.019">http://dx.doi.org/10.7554/eLife.13328.019</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig5-v3"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.020</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Signature of coding function in translated sequences identified in pseudogenes.</title><p>Nonsynonymous variants (orange) segregate at significantly lower frequencies than synonymous variants (blue) in those pseudogenes predicted to have a translated CDS. Pseudogenes with ribosome occupancy, but predicted to have no translated CDS, do not show any significant difference between the site frequency spectra of synonymous and nonsynonymous variants.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.020">http://dx.doi.org/10.7554/eLife.13328.020</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig5-figsupp1-v3"/></fig></fig-group></p><p>While the allele frequency spectra provide evidence that some of the novel mCDS are functional in present-day human populations, they are less informative about the long-term selective constraint on these sequences. To identify whether the novel mCDS have been under long-term functional constraint, we compared the substitution rates at synonymous and nonsynonymous sites within the novel mCDS using whole-genome multiple sequence alignments across 100 vertebrates. (We excluded mCDS identified in pseudogenes from this analysis due to difficulties in assigning orthology.) In <xref ref-type="fig" rid="fig5">Figure 5B</xref>, 232 novel mCDS have a significantly lower nonsynonymous substitution rate <inline-formula><mml:math id="inf10"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> compared to their synonymous substitution rate <inline-formula><mml:math id="inf11"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> after Bonferroni correction (p-value &lt; 2.91 × 10<sup>−5</sup>), suggesting that these mCDS have been under long-term purifying selection. Since the power to detect significantly low values of dN/dS depends on the length of the CDS and the qualities of the genome assemblies and the multiple sequence alignments across distant species at these sequences, the number of functional novel CDSs identified is a conservative lower bound.</p></sec><sec id="s2-5"><title>Detection of novel proteins by mass spectrometry</title><p>We next tested whether we could detect the novel mCDS predictions using mass spectrometry data. We used a large data set of SILAC-labeled tandem mass-spectra generated by trypsin-cleavage of large, stable proteins in many of the same LCLs (<xref ref-type="bibr" rid="bib4">Battle et al., 2015</xref>). Running MaxQuant (<xref ref-type="bibr" rid="bib10">Cox and Mann, 2008</xref>) against the sequence database of 4831 novel mCDS, at 10% FDR, we identified 161 novel mCDS sequences that have at least one unique peptide hit -- a tryptic peptide that matches a mass-spectrum (<xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>). More than 70% of novel mCDS with a peptide hit have at least 2 distinct peptides matched to it and, in almost all cases, the unique peptides were independently identified in two or more LCLs (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>).</p><p>To assess how many hits we would expect to the novel mCDS if their properties were like those of annotated CDSs, we developed a model that predicts whether an annotated protein has at least one mass-spectrum match, using features based on expression and sequence composition of the protein (see Materials and methods for more details). The mass-spectrometry data are highly biased towards detection of larger and more highly expressed proteins. Furthermore, the trypsin cleavage step of the experimental protocol imposes strong constraints on the set of unique peptide sequences that can be observed in an experiment. Assuming that the distributions of these predictive features estimated from annotated CDSs can be applied to the novel mCDS, we computed the expected number of novel mCDS with a peptide hit to be 603.</p><p>We thus find many fewer mass spectrometry hits to the novel mCDS than expected from a model calibrated on previously annotated mCDS (161 vs. 603). Since our model accounts for translation levels of the mCDS, the low validation rate is unlikely to be due to low rates of protein production. One possible explanation for the low validation rate may be that a large number of the inferred novel mCDS are false discoveries. However, our simulations highlight that our method has a low false positive rate and the Harringtonine data argue that many of the novel mCDS are correct predictions, thus we suggest that some other property of the mCDS may explain their low detection rate. In particular, it is possible that the novel proteins may have higher turnover rates than annotated proteins. For example it is possible that the proteins translated from novel mCDS may have substantially lower half-life than annotated proteins, or may be secreted, and thus have too low concentrations within the cell to be detectable by mass spectrometry assays.</p></sec><sec id="s2-6"><title>Translation of short alternate coding sequences in addition to the mCDS</title><p>Protein-coding transcripts in eukaryotes are typically annotated to have only one CDS (i.e., they are monocistronic). However, a number of studies have demonstrated that ribosomes can initiate translation at alternative start codons (<xref ref-type="bibr" rid="bib54">Xu et al., 2010</xref>; <xref ref-type="bibr" rid="bib23">Ingolia et al., 2011</xref>; <xref ref-type="bibr" rid="bib37">Lee et al., 2012</xref>) and many others have identified transcripts with alternative CDSs encoding functional peptides (<xref ref-type="bibr" rid="bib51">Vanderperre et al., 2013</xref>; <xref ref-type="bibr" rid="bib28">Kochetov, 2008</xref>; <xref ref-type="bibr" rid="bib3">Barbosa and Romão, 2013</xref>). Furthermore, anecdotal evidence has suggested that translation of the alternate CDS serves as a mechanism to suppress translation of the main CDS (<xref ref-type="bibr" rid="bib36">Lee et al., 2002</xref>; <xref ref-type="bibr" rid="bib20">Hernández-Sánchez et al., 2003</xref>; <xref ref-type="bibr" rid="bib32">Lammich et al., 2004</xref>). However, assessing such a mechanism genome-wide has been challenging, mainly due to a lack of appropriate annotations (<xref ref-type="bibr" rid="bib7">Calvo et al., 2009</xref>).</p><p>To this end, we adapted our approach to identify additional coding sequences within transcripts that are translated in LCLs. Assuming that the sub-codon structure of footprint abundance is similar between the main and alternate CDS, we identified 2442 novel CDSs upstream of the mCDS inferred by our method (FDR = 5%); we call them upstream alternate coding sequences or uaCDS (see Materials and methods for details; see also <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). <xref ref-type="fig" rid="fig6">Figure 6A</xref> illustrates the ribosome footprint density within the uaCDS of the transmembrane gene TM7SF2, and its conservation across mammals. We find strong enrichment of harringtonine-treated ribosome footprints at the initiation sites of uaCDS similar to the initiation sites of mCDS in the same transcripts (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). Using mass-spectrometry data, we identified 46 uaCDS that have at least one peptide hit, substantially lower than the expectation of 891 hits predicted by our model. Finally, comparing the substitution rates at inferred synonymous and nonsynonymous sites, we identified 317 uaCDS with highly constrained coding function (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). Those uaCDS with a peptide match and those having evidence of constrained coding function are not concordant (Fisher’s test; p-value = 0.56), consistent with the low sensitivity of standard mass-spectrometry protocols to identify very short proteins.<fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.13328.021</object-id><label>Figure 6.</label><caption><title>Short translated sequences identified upstream of thousands of translated main coding sequences.</title><p>(<bold>A</bold>) An alternate, novel CDS was identified upstream of the inferred main CDS in gene TM7SF2. As shown in its protein sequence alignment across mammals, the uaCDS (in particular, the start and stop codons) is highly conserved with dN/dS = 0.14. (<bold>B</bold>) Harringtonine-treated ribosome footprints show strong enrichment at the inferred initiation sites of uaCDS, comparable to the enrichment at the initiation sites of the corresponding mCDS, suggesting that ribosomes do initiate translation of these uaCDS. (<bold>C</bold>) Using multiple sequence alignment across 100 vertebrate species, 317 uaCDS were identified to have strong, significant long-term conservation.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.021">http://dx.doi.org/10.7554/eLife.13328.021</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig6-v3"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.13328.022</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Characteristics of novel uaCDS.</title><p>(<bold>A</bold>) Histogram of the distance between uaCDS and their corresponding mCDS. (<bold>B</bold>) Histogram of the lengths of uaCDS (median length of 16 amino acids).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.022">http://dx.doi.org/10.7554/eLife.13328.022</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig6-figsupp1-v3"/></fig></fig-group></p></sec><sec id="s2-7"><title>Translation of uaCDS negatively correlates with translation of mCDS</title><p>With 2442 uaCDS identified as translated in LCLs, we next tested the hypothesis that uaCDS expression negatively correlates with mCDS for each pair. We observed that, at 10% FDR, 917 pairs of uaCDS and mCDS had significant negative correlations across individuals between the proportion of footprints assigned to them (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). Our observation that nearly 40% of pairs of uaCDS and mCDS are significantly anti-correlated, despite incomplete power due to low sample size, suggests that a potential role of alternate CDSs in a transcript is to regulate the translation of the main CDS.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.13328.023</object-id><label>Figure 7.</label><caption><title>Translation of uaCDS regulates translation of mCDS.</title><p>(<bold>A</bold>) Spearman correlation, across LCLs, between mCDS translation and uaCDS translation (red histogram). Using random (mCDS, uaCDS) pairs, matched for length and pairwise distance, we computed an empirical null distribution of Spearman correlations (gray histogram). At 10% FDR, 917 inferred (uaCDS, mCDS) pairs have significant negative correlation (shaded red region). (<bold>B</bold>) 365 orfQTLs (genetic variants associated with ORF usage; i.e., whether the mCDS or uaCDS of a transcript is translated) were identified at 10% FDR (41 pairs of mCDS/uaCDS). (<bold>C</bold>) Illustrating an example of an orfQTL in the histocompatibility minor serpin domain-containing (HMSD) gene (introns removed for better visualization). The most significant variant (marked x) lies within an intron between the mCDS and uaCDS of the transcript.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.023">http://dx.doi.org/10.7554/eLife.13328.023</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-fig7-v3"/></fig></p><p>Variation in ORF usage can be driven by a number of factors including <italic>cis</italic> genetic effects and <italic>trans</italic> effects like variation in expression of RNA binding proteins. To identify <italic>cis</italic> variants that affect ORF usage in a bicistronic transcript, we tested for association of the proportion of RPFs assigned to the mCDS (or uaCDS) with variants in a 10-kilobase window around the transcript; this phenotype effectively controls for variation in gene expression across the LCLs. We identified 365 <italic>cis</italic> orfQTLs (genetic variants associated with ORF usage) across 41 pairs of mCDS and uaCDS at 10% FDR (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). In <xref ref-type="fig" rid="fig7">Figure 7C</xref>, we illustrate an example of an orfQTL in a bicistronic transcript of the HMSD gene (histocompatibility minor serpin domain-containing); this gene is also known to have a distinct genetic variant associated with alternative usage of two coding isoforms (<xref ref-type="bibr" rid="bib26">Kawase et al., 2007</xref>). Our observation of orfQTLs in a number of genes distinguishes ORF usage as an additional layer of post-transcriptional regulation of protein expression.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We developed riboHMM, a mixture of hidden Markov models to accurately resolve the precise set of mRNA sequences that are being translated in a given cell type, using sequenced RPFs from a ribosome profiling assay, sequenced reads from an RNA-seq assay and the RNA sequence. When applied to human LCLs, this method was able to accurately identify the translated frame in 96% of annotated coding genes that had a high posterior mCDS. In addition, a key advantage of our framework is the ability to infer novel translated sequences that may be missed by annotation pipelines that focus on long CDSs (&gt;100 amino acids), conservation based approaches that require long-term purifying selection, or direct proteomics measurements that are biased toward highly expressed, stable proteins. We used riboHMM to identify 7273 novel CDSs, including 448 of novel translated sequences in pseudogenes and 2442 bicistronic transcripts that contain an upstream CDS in addition to a main CDS. We observed enrichment in harringtonine-arrested ribosome occupancy at the inferred translation initiation sites, suggesting that many of the novel mCDS are real. These novel sequences showed significant differences in the amount of purifying selection acting on inferred nonsynonymous versus synonymous sites, suggesting that many of these sequences are conserved as functional peptides, including those mCDS identified in lncRNAs, pseudogenes and novel transcripts.</p><p>One caveat of our model is its restriction on one CDS per transcript. In this study, we worked around this limitation using a greedy approach and identified thousands of transcripts with multiple CDSs (either two non-overlapping inferred CDSs or an inferred mCDS distinct from the annotated CDS). Indeed, in some instances where the frame of the mCDS and annotated CDS of a transcript disagreed, we found strong support from mass-spec data for the inferred mCDS frame (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). These observations highlight the existence of a large number of transcripts in humans that have multiple CDSs and the variation in alternative usage of CDSs across tissues, an area that has largely been overlooked. Additionally, riboHMM does not effectively distinguish footprints arising from different isoforms and, thus, cannot resolve overlapping translated sequences from multiple coding isoforms of a gene. Extending riboHMM to model multiple, possibly overlapping CDSs jointly across multiple isoforms could help uncover this additional layer of complexity in the human genome.</p><p>In addition to identifying individual novel coding sequences, our method enables us to observe general properties shared across these coding regions. Interestingly, we found novel coding sequences to have a higher usage of non-AUG start codons than would be expected by considering current translation initiation site annotation (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). We emphasize that although our model assumes shared properties between novel CDS and annotated CDS, we did not use any information about annotated translation initiation and termination sites when learning the model parameters. We used well-expressed genes as our learning set to ensure that when the footprint data do not provide very strong evidence regarding the initiation site, novel coding sequences identified by our method are as similar as possible to annotated coding sequences in the sequence composition of their initiation sites. While this allows us to be conservative and identify novel CDS that are similar to annotated CDS in their ribosome footprint patterns, our approach will not be able to identify translation events that differ in their footprint patterns from the majority of translation events. In other words, our choice of learning set could potentially bias the inference. Nevertheless, similar start codon usage frequencies were observed when random sets of 5000 genes were used as learning set (<xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>) further confirming the robustness of our method.</p><p>To improve our ability to identify the translation initiation site, we attempted to incorporate harringtonine treated data in the model by introducing an additional covariate in the transition probabilities, providing independent information on the positions of translation initiation sites. However, the codon usage at the inferred initiation sites showed no significant change (K-S test; p-value = 0.88) and the set of inferred coding sequences showed very little difference when harringtonine data were incorporated into the model. Since the footprint data without treatment show clear enrichment at initiation sites, it is likely that harringtonine treated data do not provide much additional information. Thus, while the harringtonine treated data were useful as independent validation for our inferred initiation sites, the data did not have sufficient additional information to calibrate the confidence in our predicted initiation sites for each transcript.</p><p>While the precise function of these novel CDSs remains unclear, we found evidence supporting a regulatory role for novel alternate CDSs identified upstream of the mCDS (uaCDS). Although it is unclear whether the down regulation of mCDS by uaCDS is dependent on the peptide sequences of uaCDS, our finding is consistent with previous assertions under which translation of upstream ORFs regulates translation of the main CDS in cap-dependent translation initiation (<xref ref-type="bibr" rid="bib41">Morris and Geballe, 2000</xref>).</p><p>Our method provides an alternative framework for annotating the coding elements of the genome. Compared to current methods that use sequence information in cDNA and protein databases and those that rely on high-quality genome annotations in closely related species, riboHMM provides a relatively unbiased CDS annotation and opportunities for finding entirely novel CDSs. In particular, one could use riboHMM to identify the set of CDS for a species within a poorly annotated evolutionary clade, using ribosome profiling and RNA seq data immediately after its genome is sequenced and assembled. In addition, given ribosome footprint profiling data from multiple cell types, riboHMM can be used to investigate cell-type-specific translation of coding elements beyond cell-type-specific gene or isoform expression. These features render this tool particularly useful in studying molecular evolution of newly arisen coding genes and linking tissue-specificity of CDS usage to disease.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Assembling expressed transcripts in LCLs</title><p>We mapped paired-end 75 bp RNA-seq reads pooled across 85 Yoruba lymphoblastoid cell lines (<xref ref-type="bibr" rid="bib34">Lappalainen et al., 2013</xref>) to the Genome Reference Consortium Human Reference 37 (GRCh37) assembly using STAR (<xref ref-type="bibr" rid="bib13">Dobin et al., 2013</xref>), with the additional flag --outSAMstrandField intronMotif to aid transcript assembly downstream, resulting in 2.8 billion uniquely mapped fragments. Using the mapped reads, we assembled models of transcripts expressed in LCLs using StringTie v1.0.4 (<xref ref-type="bibr" rid="bib46">Pertea et al., 2015</xref>), and used GENCODE v.19 transcript models to guide the assembly. In addition, we required that the lowest expressed isoform of a gene have no less than 1% the expression of the highest expressed isoform (-f 0.01), and that each exon-exon junction be supported by at least 2 spliced reads (-j 2). Since the RNA-seq protocol did not produce strand-specific reads, we treated the forward strand and reverse strand of a transcript model assembled by StringTie as distinct transcripts. Our final set of 430,754 expressed transcripts included 122,168 GENCODE annotated transcript isoforms and 308,586 novel isoforms. (We did not consider novel isoforms of annotated genes identified by StringTie.)</p></sec><sec id="s4-2"><title>Ribosome footprint profiling</title><p>Cell lines used in this study were ordered from Coriell Institute for Medical Research (<ext-link ext-link-type="uri" xlink:href="https://www.coriell.org">https://www.coriell.org</ext-link>). To verify the identity of each cell line, we used genotype information derived from the sequencing data. To inspect potential contamination by mycoplasma, we used Universal Mycoplasma Detection Kit from ATCC (ATCC 30-1012K). Ribosome footprint profiling experiments and sequencing data processing were performed as previously described (<xref ref-type="bibr" rid="bib4">Battle et al., 2015</xref>), with the exception of a harringtonine treatment step to arrest ribosomes at the sites of translation initiation. Briefly, lymphoblastoid cell lines, GM19204 and GM19238, were cultured at 37°C with 5% CO<sub>2</sub> in RPMI media with 15% FBS. The media were further supplemented with 2 mM L-glutamate, 100 IU/ml penicillin, and 100 μg/ml streptomycin. Right before cell lysate preparation, each culture was treated with 2 μg/ml harringtonine (final concentration in media) for 2 min followed by 100 μg/ml cycloheximide (final concentration in media). For ribosome profiling experiments, ARTseq Ribosome Profiling kit for mammalian cells (RPHMR12126) was used following vendor’s instructions. Sephacryl S400 spin columns (GE; 27-5140-01) were used for monosome isolation. Libraries were sequenced on an Illumina HiSeq 2500. For sequencing data processing and mapping, adaptor sequences were removed from the 3’ end of each read using the Clipper tool from the FASTX-Toolkit. In addition, the 5’ most nucleotide (commonly resulted from non-templated additions) was removed using the Trimmer tool from the FASTX-Toolkit. To increase mapping efficiency, we filtered out sequence reads that mapped to rRNA, tRNA or snoRNA (FASTA files downloaded from Ensembl on 05/02/13) using Bowtie 2, version 2.0.2 (<xref ref-type="bibr" rid="bib33">Langmead and Salzberg, 2012</xref>). Processed reads were aligned to genome build hg19 (human) using TopHat v2.0.6 (<xref ref-type="bibr" rid="bib49">Trapnell et al., 2009</xref>). The mapping step was guided by transcriptome annotations (downloaded from Ensembl on 01/31/13).</p></sec><sec id="s4-3"><title>Mixture of HMMs to model translated coding sequences</title><p>Consider <inline-formula><mml:math id="inf12"><mml:mi>N</mml:mi></mml:math></inline-formula> transcripts where the <inline-formula><mml:math id="inf13"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> transcript has length of <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> assumed to be a multiple of three (<inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>; see <italic>Transcripts with length not a multiple of three</italic> for details on how our model handles the remaining one or two base positions when <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is not a multiple of three). Our data consist of RPF counts <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, RNA sequence <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, and transcript expression <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> (in units of RNA-seq reads per base position per million sequenced reads) on <inline-formula><mml:math id="inf20"><mml:mi>N</mml:mi></mml:math></inline-formula> transcripts, where <inline-formula><mml:math id="inf21"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf22"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> are vector quantities and <inline-formula><mml:math id="inf23"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is a scalar aggregated over the entire length of the transcript. Let <inline-formula><mml:math id="inf24"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf25"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf26"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf27"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> denote the RPF counts and the base at the <inline-formula><mml:math id="inf28"><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> position in the <inline-formula><mml:math id="inf29"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> transcript, respectively. We model the footprint data <inline-formula><mml:math id="inf30"><mml:mi>T</mml:mi></mml:math></inline-formula> using a mixture of HMMs that incorporates <inline-formula><mml:math id="inf31"><mml:mi>S</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf32"><mml:mi>E</mml:mi></mml:math></inline-formula>. Assuming independence across transcripts, the probability of <inline-formula><mml:math id="inf33"><mml:mi>T</mml:mi></mml:math></inline-formula> given <inline-formula><mml:math id="inf34"><mml:mi>S</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf35"><mml:mi>E</mml:mi></mml:math></inline-formula> is written as <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>E</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mi/><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes the set of model parameters.</p><sec id="s4-3-1"><title>Mixture of three reading frames for a transcript</title><p>To capture the three-base structure in RPF data within the CDS, we represent each transcript as a sequence of non-overlapping base triplets, some of which potentially represent codons. Since the CDS of the transcript could belong to one of three reading frames (as illustrated in <xref ref-type="fig" rid="fig1">Figure 1B</xref>), we introduced a latent frame variable, <inline-formula><mml:math id="inf38"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>3</mml:mn></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that specifies the reading frame for the <inline-formula><mml:math id="inf39"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> transcript. Then, given <inline-formula><mml:math id="inf40"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf41"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> can be represented as a sequence of <inline-formula><mml:math id="inf42"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> triplets and three remaining base positions (see <xref ref-type="fig" rid="fig1">Figure 1B</xref>). Specifically, <inline-formula><mml:math id="inf43"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>∶</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf44"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The probability of <inline-formula><mml:math id="inf45"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is then given by<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mi/><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We assumed that the probability over <inline-formula><mml:math id="inf46"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is independent of <inline-formula><mml:math id="inf47"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf48"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, and is uniform over all three frames, <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>. In addition, we assumed that the RPF data from the sequence of triplets and the RPF data from the three remaining base positions are independent, leading to<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>(For notation convenience, we have dropped highlighting the dependence of <inline-formula><mml:math id="inf50"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf51"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> on <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.) We modeled the probability of the data from the sequence of triplets, <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, using an HMM, and the probability of the data from the remaining positions, <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, using a Poisson-gamma model as described below.</p></sec><sec id="s4-3-2"><title>HMM for each frame of a transcript</title><p>The pattern of RPF count data in triplets depends on whether the triplet is being translated or not. To model these patterns, we assumed that each triplet belongs to one of nine states (see <xref ref-type="fig" rid="fig1">Figure 1B</xref>): 5' Untranslated State (5'UTS), last untranslated triplet 5' to the CDS (5'UTS+), Translation Initiation State (TIS), state after TIS (TIS+), Translation Elongation State (TES), state before TTS (TTS-), Translation Termination State (TTS), first untranslated triplet 3' to the CDS (3'UTS-), and 3' Untranslated State (3'UTS). The five states (TIS+, TIS, TES, TTS-, TTS) denote translated triplets and the remaining four states (5'UTS, 5'UTS+, 3'UTS-, 3'UTS) denote untranslated triplets. In particular, the start codon corresponds to the base triplet assigned to the TIS state and the stop codon corresponds to the base triplet assigned to the 3'UTS- state. The groups of states (5'UTS+, TIS, TIS+) and (TTS-, TTS, 3'UTS-) help model the distinct features of the footprint data around the translation initiation and termination sites, respectively. We introduced a sequence of <inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> hidden variables <inline-formula><mml:math id="inf57"><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for each frame of the <inline-formula><mml:math id="inf58"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> transcript, where <inline-formula><mml:math id="inf59"><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the state for the <inline-formula><mml:math id="inf60"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> triplet in the <inline-formula><mml:math id="inf61"><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> frame.</p><p>For each state, an emission probability for <inline-formula><mml:math id="inf62"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> can be modeled as follows. Let <inline-formula><mml:math id="inf63"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> denote the sum of three elements in <inline-formula><mml:math id="inf64"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> (i.e., the total RPF count for the <inline-formula><mml:math id="inf65"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> triplet). Then, <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>multinomial</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>Poisson</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>gamma</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where the density of the gamma distribution is <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>exp</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> with the mean and variance equal to <inline-formula><mml:math id="inf68"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf69"><mml:mrow><mml:mfrac><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, respectively.</p><p>The periodicity of RPF counts within the CDS is captured by the multinomial distribution with parameters <inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where we assume <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>z</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msup><mml:mn>5</mml:mn><mml:mo>'</mml:mo></mml:msup><mml:mtext>UTS</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mo>'</mml:mo></mml:msup><mml:mtext>UTS</mml:mtext><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mn>3</mml:mn><mml:mo>'</mml:mo></mml:msup><mml:mtext>UTS</mml:mtext><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mn>3</mml:mn><mml:mo>'</mml:mo></mml:msup><mml:mtext>UTS</mml:mtext></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to capture the lack of periodicity in the RPF data in untranslated regions. Furthermore, we allow the pattern of periodicity to differ across five states (TIS, TIS+, TTS, TTS-, TES).</p><p>The Poisson distribution for <inline-formula><mml:math id="inf73"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> captures the difference in RPF abundance between translated and untranslated regions (precisely, difference in abundance between triplets in different states). We corrected for differences in RPF abundance across transcripts due to differences in transcript expression levels by using <inline-formula><mml:math id="inf74"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> as a transcript-specific normalization factor (see <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>). To account for additional variation in the RPF counts across triplets in the same state (e.g., due to varying translation rates across transcripts, and translational pausing), we allowed for triplet-specific parameters <inline-formula><mml:math id="inf75"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> in the Poisson intensity and assumed that those parameters follow a gamma distribution. Under this model, <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>We assumed that the sequence of hidden variables <inline-formula><mml:math id="inf78"><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> follow a Markov chain. The assumption of up to one CDS in each transcript leads to a transition probability shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref>, where <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mrow><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> depend on the underlying RNA sequence and are given by<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="double-struck">I</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">I</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mo>⋅</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the indicator function, <inline-formula><mml:math id="inf82"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the base sequence of the <inline-formula><mml:math id="inf83"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> triplet, and <inline-formula><mml:math id="inf84"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the log of ratio of likelihood under the Kozak model to likelihood under a background model of the base sequence flanking the <inline-formula><mml:math id="inf85"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> triplet (see <italic>Kozak model</italic> for details). In our analysis, <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> contained the canonical start codon and all near-cognates, <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">G</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">G</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">G</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">G</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">G</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> contained the canonical stop codons, <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">G</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> The parameters, <inline-formula><mml:math id="inf90"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf91"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>κ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, indicate the importance of the triplet base sequence and the flanking base sequence in determining transition from untranslated triplets to translated triplets. The current specification of <inline-formula><mml:math id="inf92"><mml:mrow><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> forces the coding sequence to terminate at the first in-frame occurrence of a stop codon. This model can be extended to account for stop codon read-through by using a logistic function for <inline-formula><mml:math id="inf94"><mml:mrow><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> for the same set <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-3-3"><title><bold>Model for</bold> <inline-formula><mml:math id="inf96"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula></title><p>We model <inline-formula><mml:math id="inf97"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> the RPF counts at bases before or after the sequence of triplets (see <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>), using the emission probabilities of the <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mn>5</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mn>3</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> states. Assuming that the three elements of <inline-formula><mml:math id="inf100"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are independent, we have <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Each element can be modeled as<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>Poisson</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>gamma</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> if <inline-formula><mml:math id="inf103"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msubsup></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>3</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> if <inline-formula><mml:math id="inf105"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-3-4"><title>Parameter estimation and inference</title><p>We used an EM algorithm to compute the maximum likelihood estimate for the model parameters <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>Θ</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>κ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, that is, <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mtext>argmax</mml:mtext><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>E</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>To infer the translated CDS for the <inline-formula><mml:math id="inf108"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> transcript, we identified the frame and state sequence that maximizes the joint posterior probability<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mtext>argmax</mml:mtext><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We first computed the maximum <italic>a posteriori</italic> (MAP) state sequence for each reading frame using the Viterbi algorithm, <inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mtext>argmax</mml:mtext><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. Then, the MAP state sequence and frame is given as<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mtext>argmax</mml:mtext><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mtext>|</mml:mtext><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mtext>|</mml:mtext><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf111"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>is a function of <inline-formula><mml:math id="inf112"><mml:mi>f</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the probability of the data marginalized over the latent states.</p><p>In our analyses, we estimated the model parameters using the top five thousand highly expressed genes. Then, we inferred the translated CDS for those transcripts in which each exon has at least five distinct ribosome footprints mapping to it. We restricted our further analyses to transcripts where (1) <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, (2) the MAP state sequence <inline-formula><mml:math id="inf116"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> contains a TIS state and a TTS state (i.e., a pair of initiation and termination sites), (3) more than 50% of base positions within the inferred CDS are mappable, and (4) the coding sequence encodes a peptide more than 6 amino acids long – we call these translated sequences as main coding sequences or mCDS.</p></sec><sec id="s4-3-5"><title>Modeling ribosome footprints of different lengths</title><p>We observed that ribosome footprints with different lengths, arising due to incomplete nuclease digestion, show slightly different patterns of abundance when aggregated across transcripts (see <xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>). To model these differences, we partitioned the footprints into multiple groups based on length, and modeled the data in each group with a separate set of parameters in the emission probability (all groups share the same state sequence along a transcript). Specifically, for <inline-formula><mml:math id="inf117"><mml:mi>G</mml:mi></mml:math></inline-formula> groups of footprints, the data at the <inline-formula><mml:math id="inf118"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> triplet in <inline-formula><mml:math id="inf119"><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> reading frame <inline-formula><mml:math id="inf120"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> can be partitioned into <inline-formula><mml:math id="inf121"><mml:mi>G</mml:mi></mml:math></inline-formula> components, <inline-formula><mml:math id="inf122"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf123"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the triplet of RPF counts from <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> group. Assuming that the RPF counts from different groups at a given triplet are independent, conditional on the state of the triplet, the emission probability can be written as <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>multinomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>gamma</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where group-specific parameters, <inline-formula><mml:math id="inf126"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, capture the distinct patterns in each group. The RPF data used in our analyses had four groups of footprints of lengths 28, 29, 30, and 31 bases.</p></sec><sec id="s4-3-6"><title>Base positions with missing data</title><p>Approximately 15% of the transcriptome have unmappable base positions, in part due to the short lengths of ribosome footprints. Consider the <inline-formula><mml:math id="inf127"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> base triplet in frame <inline-formula><mml:math id="inf128"><mml:mi>f</mml:mi></mml:math></inline-formula> in the <inline-formula><mml:math id="inf129"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> transcript. If <inline-formula><mml:math id="inf130"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">𝒥</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is the set of positions in this triplet that are unmappable for footprints corresponding to group <inline-formula><mml:math id="inf131"><mml:mi>g</mml:mi></mml:math></inline-formula>, the emission probabilities become<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mtext> </mml:mtext><mml:mo>∼</mml:mo><mml:mtext> </mml:mtext><mml:mtext>multinomial</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>π</mml:mi><mml:mo>∼</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mo>∼</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∉</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">J</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>π</mml:mi><mml:mo>∼</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mtable columnalign="left right" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">J</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>If all three positions in a triplet are unmappable, then we treat the triplet as having missing data for that footprint group and set <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for all values of <inline-formula><mml:math id="inf133"><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-3-7"><title>Kozak model</title><p>Using the annotated initiation sites of GENCODE annotated coding transcripts, we estimated a position weight matrix (PWM) that captures the base composition of the −9 to +6 positions flanking known initiation sites. Since the consensus sequence of this PWM is the same as the reported consensus Kozak sequence (<xref ref-type="bibr" rid="bib31">Kozak, 1987</xref>), we refer to this model as the Kozak model. We estimated a background PWM model using the same set of positions relative to random AUG triplets within the same set of transcripts. For the <inline-formula><mml:math id="inf134"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> triplet in frame <inline-formula><mml:math id="inf135"><mml:mi>f</mml:mi></mml:math></inline-formula> in the <inline-formula><mml:math id="inf136"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> transcript, using the base sequence from the -9 to +6 positions flanking this triplet, we computed <inline-formula><mml:math id="inf137"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, the log of ratio of likelihood of the flanking sequence under the Kozak model to likelihood under the background model.</p></sec><sec id="s4-3-8"><title>Transcripts with length not a multiple of three</title><p>The length of such a transcript can be written as <inline-formula><mml:math id="inf138"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>B</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. We assumed that the RPF data on the first<inline-formula><mml:math id="inf140"><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>bases <inline-formula><mml:math id="inf141"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the data on the remaining <inline-formula><mml:math id="inf142"><mml:mi>B</mml:mi></mml:math></inline-formula> bases <inline-formula><mml:math id="inf143"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are independent. We modeled <inline-formula><mml:math id="inf144"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> using a mixture of HMMs as described above, and modeled <inline-formula><mml:math id="inf145"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> using the emission probability of the <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mn>3</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> state as follows.<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mtext>|</mml:mtext><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mtext>|</mml:mtext><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ24"><label>where</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>3</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>A Python implementation of riboHMM can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://rajanil.github.io/riboHMM/">https://rajanil.github.io/riboHMM/</ext-link>.</p></sec></sec><sec id="s4-4"><title>Quantifying false discoveries of riboHMM</title><p>We characterize the performance of riboHMM by addressing three scenarios: (1) How often does riboHMM identify an mCDS in transcripts with no signal of translation? (2) How often does riboHMM identify an incorrect reading frame in transcripts with signal for translation? (3) When riboHMM identifies the correct reading frame in transcripts with signal for translation, how often does it identify an incorrect initiation site? To address the first question, we started with the transcripts for which riboHMM was able to identify an mCDS and generated a set of “null transcripts” by permuting the footprint counts among base positions within each transcript. Applying a posterior cutoff of 0.8, riboHMM incorrectly identified an mCDS in 4.5% of these null transcripts. We used this estimate of the Type 1 error rate to compute the false discovery rate for novel mCDS in noncoding transcripts and novel uaCDS identified by riboHMM. To address the other two questions, we started with the set of annotated coding transcripts for which riboHMM was able to recover the precise CDS (i.e., the mCDS matched the annotated CDS exactly). We generated a set of “simulated transcripts” using the following strategy: (1) randomly select a new TIS downstream and in-frame to the annotated TIS, ensuring that the codon underlying the new TIS belonged to the set <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, (2) permute the footprint counts among bases upstream of the new TIS. Among the simulated transcripts in which riboHMM could identify an mCDS, the inferred reading frame was completely different from the true translated reading frame in 0.31% transcripts. We used this estimate of the Type 1 error rate to quantify false discoveries among novel mCDS in annotated coding transcripts. In the remaining simulated transcripts, the inferred TIS matched the new TIS exactly in 62% of transcripts; this corresponds to a false discovery proportion of 38%.</p></sec><sec id="s4-5"><title>Translated mCDS in pseudogenes</title><p>Starting with 14,065 pseudogenes that have been identified and categorized in humans (<xref ref-type="bibr" rid="bib45">Pei et al., 2012</xref>), 9,375 pseudogenes were identified by StringTie to be expressed in LCLs. Using a very stringent posterior cutoff of 99.99%, we inferred mCDS in 448 of these expressed pseudogenes. Using pairwise alignment of the pseudogene and parent gene transcript, we observed that although the pseudogene mCDS typically code for shorter protein sequences compared with the parent protein, a large fraction of the pseudogene mCDS share coding-frame with their parent gene (see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p></sec><sec id="s4-6"><title>Validation with Harringtonine-treated data</title><p>Harringtonine-treated ribosome footprints were measured in LCLs with a total sequencing depth of 21 million reads. In <xref ref-type="fig" rid="fig4">Figure 4</xref>, we illustrate the aggregate proportion of treated ribosome footprints centered at the inferred start codon for all novel mCDS, and compare it with the aggregate proportion of treated footprints around the start codon of an equal number of annotated CDSs that have a posterior probability greater than 0.8 under our model. In <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, we illustrate the aggregate proportion of treated footprints for mCDS inferred in pseudogenes alone, and in <xref ref-type="fig" rid="fig6">Figure 6B</xref>, we compare the aggregate treated footprint proportions at the start codons of inferred uaCDS and their corresponding mCDS.</p></sec><sec id="s4-7"><title>Identifying translated alternate ORFs</title><p>For each transcript that had a mCDS with posterior greater than 0.8 and more than 50 base pairs of RNA sequence in the 5’UTS state, we defined an “upstream-restricted transcript” consisting of the exons within the 5’UTS state. Using a random set of 5000 non-overlapping upstream-restricted transcripts in which more than 80% of base positions were mappable, we computed the maximum likelihood estimates of the transition parameters and occupancy parameters to identify additional translated sequences within these upstream-restricted transcripts. Assuming that the fine-scale structure of footprint counts within these translated sequences would be similar to that within the mCDS, we kept the periodicity parameters fixed to their previously estimated values. With these parameter estimates, we inferred the MAP frame and state sequences with posterior greater than 0.8 and filtered out inferences where less than 50% of the inferred CDS was mappable. These additional translated sequences within the upstream-restricted transcripts were called upstream alternate coding sequences or uaCDS.</p></sec><sec id="s4-8"><title>Identifying stable peptides with mass spectrometry data</title><p>To identify stable proteins translated from the novel CDSs (mCDS and uaCDS), we analyzed quantitative, high-resolution mass spectrometry data derived from 60 LCLs, with MaxQuant v1.5.0.30 (<xref ref-type="bibr" rid="bib10">Cox and Mann, 2008</xref>) and the Andromeda (<xref ref-type="bibr" rid="bib11">Cox et al., 2011</xref>) search engine. Sample labeling, processing and data collection details can be found elsewhere (<xref ref-type="bibr" rid="bib4">Battle et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Khan et al., 2013</xref>). Peptides were identified using a database that contained 63,904 GENCODE annotated protein sequences and 7271 novel CDSs identified by our method. For all searches, up to two missed tryptic cleavages were allowed, carbamidomethylation of cysteine was entered as a fixed modification, and N-terminal acetylation and oxidation of methionine were included as variable modifications for all searches. A ‘first search’ tolerance of 40 ppm with a score threshold of 70 was used for time-dependent mass recalibration followed by a main search MS1 tolerance of 6 ppm and an MS2 tolerance of 20 ppm. The ‘re-quantify’ option was used to aid the assignment of isotopic patterns to labeling pairs. The ‘match between runs’ option was enabled to match identifications across samples using a matching time window of 42 s and an alignment time window of 20 min. Peptide and protein false discovery rates were set to 10% using a reverted version of the search database. Protein group quantifications were taken as the median log<sub>2</sub> (sample/standard) ratio for all groups containing at least two independent unique or ‘razor’ peptide quantifications (including multiple measurements of the same peptide in different fractions) without a modified peptide counterpart.</p></sec><sec id="s4-9"><title>Bias correction to compute expected number of peptide hits</title><p>Proteins with at least one peptide identified by this high-resolution mass-spectrometry protocol tend to be distinct from proteins with no mass-spectrum matches.</p><list list-type="order"><list-item><p>1. The median footprint density of annotated coding genes with at least one peptide match is about 125 fold higher than that of coding genes with no peptide match (see <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4A</xref>).</p></list-item><list-item><p>The median length of coding genes with at least one peptide match is 20% higher than that of coding genes without a peptide match (see <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4B</xref>).</p></list-item><list-item><p>3. The trypsin cleavage step of the protocol ensures that nearly all observable peptides have a C-terminal lysine or arginine residue, and up to two additional lysine or arginine residues within the peptide sequence (called “tryptic peptides”). This step imposes a strict constraint on the set of unique peptide sequences that can be observed from a protein sequence, and genes with fewer tryptic peptides are less likely to have a mass-spectrum match.</p></list-item><list-item><p>All tryptic peptides in an expressed protein are not equally likely to be observed. The probability of detecting a tryptic peptide depends on its electrostatic properties relative to other tryptic peptides from all expressed proteins, which in turn depends on the amino acid composition of the tryptic peptides (see <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4C–F</xref>).</p></list-item></list><p>To account for these biases, we developed a predictive model to estimate the probability that a protein has at least one peptide hit in a mass-spectrometry experiment. The predicted label for a protein is whether the protein has at least one mass-spectrum match (<inline-formula><mml:math id="inf148"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) or no mass-spectrum match (<inline-formula><mml:math id="inf149"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). The predictive features of a protein used in the model are (1) the ribosome footprint density of the corresponding transcript (<inline-formula><mml:math id="inf150"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), (2) the protein length (<inline-formula><mml:math id="inf151"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), and (3) the counts of amino acids within each of the <inline-formula><mml:math id="inf152"><mml:mi>K</mml:mi></mml:math></inline-formula> tryptic peptides that can be generated from the protein (<inline-formula><mml:math id="inf153"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>). Since the relevant feature of an amino acid is its charge, we partitioned the set of amino acids into four groups – positively charged (R, H, K), negatively charged (D, E), polar uncharged (S, T, N Q), and others. The amino acid count vector <inline-formula><mml:math id="inf154"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was then collapsed into a vector of the counts of each of these four groups. Conditional on <inline-formula><mml:math id="inf155"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we introduced a latent variable for each tryptic peptide that indicates whether the peptide was matched to a mass-spectrum or not (<inline-formula><mml:math id="inf156"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>; this latent variable accounts for differences between matched and unmatched peptides.</p><p>Assuming that the three predictive features are independent conditional on the predicted label <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the odds of observing at least one peptide hit is then given as<disp-formula id="equ25"><mml:math id="m25"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>|</mml:mtext><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext>|</mml:mtext><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>We learn the predictive model using annotated coding genes and partitioning them into those that have at least one peptide hit (“hit genes”) and those that do not have a peptide hit (“no-hit genes”). We computed <inline-formula><mml:math id="inf158"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> using an empirical distribution of footprint density within coding genes, <inline-formula><mml:math id="inf159"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> using an empirical distribution of the lengths of coding genes, <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using tryptic peptides within hit genes matched to mass-spectra, <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using unmatched tryptic peptides within hit genes, and <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using tryptic peptides within no-hit genes. Finally, we set <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf164"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Using peptide hits in annotated proteins, we evaluated the accuracy of this model by holding out some annotated proteins as test data, learning the predictive distributions using the remaining training data and computing the expected number of test proteins that had a mass-spectrum match. We estimated the expected number of held-out annotated proteins with at least one mass-spectrum match to be 1206 (s.d. = 34), while the actual number of held-out proteins with a match was 1387 (s.d. = 36).</p></sec><sec id="s4-10"><title>Test for long-term purifying selection</title><p>In order to quantify whether the novel mCDS are evolutionary conserved in terms of their amino acid sequence, we first extracted DNA sequences orthologous to the mCDS from a 100-way vertebrate whole-genome alignments (UCSC), restricting to genomes aligned with either Syntenic net or Reciprocal best net. We next performed a three-frame translation on each orthologous sequence and a multiple alignment to obtain the correct codon alignments. More specifically, for each orthologous sequence, we kept the frame with the highest amino acid identity compared to the human peptide, requiring at least 60% identity for alignable positions and no more than 50% of the alignment as gaps. Finally, we used codeML/PAML (<xref ref-type="bibr" rid="bib55">Yang, 2007</xref>) to estimate <italic>dN</italic> and <italic>dS</italic> rates across the trees consisting of all remaining peptides, first using a model allowing variable omega and then a model with omega fixed to one. To determine whether a specific peptide is under purifying selection or not, we compared the two models using a likelihood ratio test and reported peptides that satisfied a Bonferroni-corrected <italic>p</italic>-value threshold.</p></sec><sec id="s4-11"><title>Correlation between uaCDS and mCDS</title><p>We computed the correlation across LCLs between the proportion of footprints mapped to a transcript that fall within its uaCDS and the proportion that fall within its mCDS. We evaluated the statistical significance of these correlations using an empirical null distribution of Spearman correlations computed using random pairs of mCDS and uaCDS. A random pair of mCDS and uaCDS was obtained by randomly shifting the coordinates of an observed pair of mCDS and uaCDS, matching for their respective lengths and the distance between them.</p></sec><sec id="s4-12"><title>Data release</title><p>All novel coding sequences identified in this work, along with the harringtonine-treated ribosome profiling data are deposited in GEO Accession GSE75290.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Adam Frankish from the GENCODE group for discussions on the sources of information used for annotating coding genes, Zia Khan for discussions on the mass-spectrometry data analysis, and Audrey Fu for discussions on evaluating the correlation between mCDS and uaCDS. We also thank members of the Pritchard, Gilad and Stephens labs for comments and suggestions, and the two anonymous reviewers, the Reviewing Editor, and Naama Barkai, the Senior Editor for their insightful reviews and comments. This work was funded by grants from the NIH (HG007036 to JKP, MH084703 to YG and JKP, and HG02585 to MS), and by the Howard Hughes Medical Institute. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>AR, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>SHW, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>HS, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con4"><p>AH, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con5"><p>YIL, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con6"><p>BE, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con7"><p>MS, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con8"><p>YG, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con9"><p>JKP, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.13328.024</object-id><label>Supplementary file 1.</label><caption><title>Peptide matches to novel CDS detected using mass spectrometry.</title><p>This table lists the 207 novel CDS (161 mCDS and 46 uaCDS) that have at least one mass-spectrum uniquely matching a peptide in the inferred protein sequence, at protein-level 10% FDR.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.024">http://dx.doi.org/10.7554/eLife.13328.024</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-13328-supp1-v3.xlsx"/></supplementary-material><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following dataset was generated:</p><p><related-object content-type="generated-dataset" id="data-ro1" source-id="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE75290" source-id-type="uri"><collab>Wang SH</collab>, <collab>Raj A</collab>, <collab>Shim H</collab>, <collab>Gilad Y</collab>, <collab>Pritchard JK</collab>, <collab>Stephens M</collab>, <collab>Engelmann B</collab>, <collab>Li YI</collab>, <collab>Harpak A</collab><x>,</x> <year>2015</year><x>,</x><source>Thousands of novel translated open reading frames in humans inferred by ribosome footprint profiling</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE75290">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE75290</ext-link><x>,</x> <comment>Publicly available at the NCBI Gene Expression Omnibus (accession no: GSE75290).</comment></related-object></p><p>The following previously published datasets were used:</p><p><related-object content-type="generated-dataset" id="data-ro2" source-id="http://proteomecentral.proteomexchange.org/cgi/GetDataset?ID=PXD001406" source-id-type="uri"><collab>Khan Z</collab><x>,</x> <year>2015</year><x>,</x><source>Mass-spectrometry measurements in 60 human LCLs</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://proteomecentral.proteomexchange.org/cgi/GetDataset?ID=PXD001406">http://proteomecentral.proteomexchange.org/cgi/GetDataset?ID=PXD001406</ext-link><x>,</x> <comment>Publicly available at ProteomeXchange (accession no: PXD001406)</comment></related-object></p><p><related-object content-type="generated-dataset" id="data-ro3" source-id="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE61742" source-id-type="uri"><collab>Battle A</collab>, <collab>Khan Z</collab>, <collab>Wang SH</collab>, <collab>Mitrano A</collab>, <collab>Ford MJ</collab>, <collab>Pritchard JK</collab>, <collab>Gilad Y</collab><x>,</x> <year>2015</year><x>,</x><source>Impact of regulatory variation from RNA to protein</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE61742">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE61742</ext-link><x>,</x> <comment>Publicly available at the NCBI Gene Expression Omnibus (accession no: GSE61742)</comment></related-object></p><p><related-object content-type="generated-dataset" id="data-ro4" source-id="http://www.ebi.ac.uk/arrayexpress/experiments/E-GEUV-1/" source-id-type="uri"><collab>Lappalainen T</collab>, <collab>Dermitzakis E</collab><x>,</x> <year>2013</year><x>,</x><source>RNA-seq measurementsin 86 human LCLs</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress/experiments/E-GEUV-1/">http://www.ebi.ac.uk/arrayexpress/experiments/E-GEUV-1/</ext-link><x>,</x> <comment>Publicly available at EMBL European Bioinformatics Institute (accession no: E-GEUV-1)</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Auton</surname><given-names>A</given-names></name><name><surname>Brooks</surname><given-names>LD</given-names></name><name><surname>Durbin</surname><given-names>RM</given-names></name><name><surname>Garrison</surname><given-names>EP</given-names></name><name><surname>Kang</surname><given-names>HM</given-names></name><name><surname>Korbel</surname><given-names>JO</given-names></name><name><surname>Marchini</surname><given-names>JL</given-names></name><name><surname>McCarthy</surname><given-names>S</given-names></name><name><surname>McVean</surname><given-names>GA</given-names></name><name><surname>Abecasis</surname><given-names>GR</given-names></name><name><surname>Consortium</surname><given-names>GP</given-names></name><collab>1000 Genomes Project Consortium</collab></person-group><year iso-8601-date="2015">2015</year><article-title>A global reference for human genetic variation</article-title><source>Nature</source><volume>526</volume><fpage>68</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1038/nature15393</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bairoch</surname><given-names>A</given-names></name><name><surname>Apweiler</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The SWISS-PROT protein sequence database and its supplement TrEMBL in 2000</article-title><source>Nucleic Acids Research</source><volume>28</volume><fpage>45</fpage><lpage>48</lpage><pub-id pub-id-type="doi">10.1093/nar/28.1.45</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barbosa</surname><given-names>C</given-names></name><name><surname>Peixeiro I</surname></name><name><surname>Romão</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Gene expression regulation by upstream open reading frames and human disease</article-title><source>PLoS Genetics</source><volume>9</volume><elocation-id>e1003529</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003529</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Battle</surname><given-names>A</given-names></name><name><surname>Khan</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>SH</given-names></name><name><surname>Mitrano</surname><given-names>A</given-names></name><name><surname>Ford</surname><given-names>MJ</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name><name><surname>Gilad</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Genomic variation. Impact of regulatory variation from RNA to protein</article-title><source>Science</source><volume>347</volume><fpage>664</fpage><lpage>667</lpage><pub-id pub-id-type="doi">10.1126/science.1260793</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bazzini</surname><given-names>AA</given-names></name><name><surname>Johnstone</surname><given-names>TG</given-names></name><name><surname>Christiano</surname><given-names>R</given-names></name><name><surname>Mackowiak</surname><given-names>SD</given-names></name><name><surname>Obermayer</surname><given-names>B</given-names></name><name><surname>Fleming</surname><given-names>ES</given-names></name><name><surname>Vejnar</surname><given-names>CE</given-names></name><name><surname>Lee</surname><given-names>MT</given-names></name><name><surname>Rajewsky</surname><given-names>N</given-names></name><name><surname>Walther</surname><given-names>TC</given-names></name><name><surname>Giraldez</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Identification of small ORFs in vertebrates using ribosome footprinting and evolutionary conservation</article-title><source>The EMBO Journal</source><volume>33</volume><fpage>981</fpage><lpage>1074</lpage><pub-id pub-id-type="doi">10.1002/embj.201488411</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Birney</surname><given-names>E</given-names></name><name><surname>Stamatoyannopoulos</surname><given-names>JA</given-names></name><name><surname>Dutta</surname><given-names>A</given-names></name><name><surname>Guigó</surname><given-names>R</given-names></name><name><surname>Gingeras</surname><given-names>TR</given-names></name><name><surname>Margulies</surname><given-names>EH</given-names></name><name><surname>Weng</surname><given-names>Z</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name><name><surname>Dermitzakis</surname><given-names>ET</given-names></name><name><surname>Thurman</surname><given-names>RE</given-names></name><name><surname>Kuehn</surname><given-names>MS</given-names></name><name><surname>Taylor</surname><given-names>CM</given-names></name><name><surname>Neph</surname><given-names>S</given-names></name><name><surname>Koch</surname><given-names>CM</given-names></name><name><surname>Asthana</surname><given-names>S</given-names></name><name><surname>Malhotra</surname><given-names>A</given-names></name><name><surname>Adzhubei</surname><given-names>I</given-names></name><name><surname>Greenbaum</surname><given-names>JA</given-names></name><name><surname>Andrews</surname><given-names>RM</given-names></name><name><surname>Flicek</surname><given-names>P</given-names></name><name><surname>Boyle</surname><given-names>PJ</given-names></name><name><surname>Cao</surname><given-names>H</given-names></name><name><surname>Carter</surname><given-names>NP</given-names></name><name><surname>Clelland</surname><given-names>GK</given-names></name><name><surname>Davis</surname><given-names>S</given-names></name><name><surname>Day</surname><given-names>N</given-names></name><name><surname>Dhami</surname><given-names>P</given-names></name><name><surname>Dillon</surname><given-names>SC</given-names></name><name><surname>Dorschner</surname><given-names>MO</given-names></name><name><surname>Fiegler</surname><given-names>H</given-names></name><name><surname>Giresi</surname><given-names>PG</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Hawrylycz</surname><given-names>M</given-names></name><name><surname>Haydock</surname><given-names>A</given-names></name><name><surname>Humbert</surname><given-names>R</given-names></name><name><surname>James</surname><given-names>KD</given-names></name><name><surname>Johnson</surname><given-names>BE</given-names></name><name><surname>Johnson</surname><given-names>EM</given-names></name><name><surname>Frum</surname><given-names>TT</given-names></name><name><surname>Rosenzweig</surname><given-names>ER</given-names></name><name><surname>Karnani</surname><given-names>N</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Lefebvre</surname><given-names>GC</given-names></name><name><surname>Navas</surname><given-names>PA</given-names></name><name><surname>Neri</surname><given-names>F</given-names></name><name><surname>Parker</surname><given-names>SC</given-names></name><name><surname>Sabo</surname><given-names>PJ</given-names></name><name><surname>Sandstrom</surname><given-names>R</given-names></name><name><surname>Shafer</surname><given-names>A</given-names></name><name><surname>Vetrie</surname><given-names>D</given-names></name><name><surname>Weaver</surname><given-names>M</given-names></name><name><surname>Wilcox</surname><given-names>S</given-names></name><name><surname>Yu</surname><given-names>M</given-names></name><name><surname>Collins</surname><given-names>FS</given-names></name><name><surname>Dekker</surname><given-names>J</given-names></name><name><surname>Lieb</surname><given-names>JD</given-names></name><name><surname>Tullius</surname><given-names>TD</given-names></name><name><surname>Crawford</surname><given-names>GE</given-names></name><name><surname>Sunyaev</surname><given-names>S</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name><name><surname>Dunham</surname><given-names>I</given-names></name><name><surname>Denoeud</surname><given-names>F</given-names></name><name><surname>Reymond</surname><given-names>A</given-names></name><name><surname>Kapranov</surname><given-names>P</given-names></name><name><surname>Rozowsky</surname><given-names>J</given-names></name><name><surname>Zheng</surname><given-names>D</given-names></name><name><surname>Castelo</surname><given-names>R</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><name><surname>Harrow</surname><given-names>J</given-names></name><name><surname>Ghosh</surname><given-names>S</given-names></name><name><surname>Sandelin</surname><given-names>A</given-names></name><name><surname>Hofacker</surname><given-names>IL</given-names></name><name><surname>Baertsch</surname><given-names>R</given-names></name><name><surname>Keefe</surname><given-names>D</given-names></name><name><surname>Dike</surname><given-names>S</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Hirsch</surname><given-names>HA</given-names></name><name><surname>Sekinger</surname><given-names>EA</given-names></name><name><surname>Lagarde</surname><given-names>J</given-names></name><name><surname>Abril</surname><given-names>JF</given-names></name><name><surname>Shahab</surname><given-names>A</given-names></name><name><surname>Flamm</surname><given-names>C</given-names></name><name><surname>Fried</surname><given-names>C</given-names></name><name><surname>Hackermüller</surname><given-names>J</given-names></name><name><surname>Hertel</surname><given-names>J</given-names></name><name><surname>Lindemeyer</surname><given-names>M</given-names></name><name><surname>Missal</surname><given-names>K</given-names></name><name><surname>Tanzer</surname><given-names>A</given-names></name><name><surname>Washietl</surname><given-names>S</given-names></name><name><surname>Korbel</surname><given-names>J</given-names></name><name><surname>Emanuelsson</surname><given-names>O</given-names></name><name><surname>Pedersen</surname><given-names>JS</given-names></name><name><surname>Holroyd</surname><given-names>N</given-names></name><name><surname>Taylor</surname><given-names>R</given-names></name><name><surname>Swarbreck</surname><given-names>D</given-names></name><name><surname>Matthews</surname><given-names>N</given-names></name><name><surname>Dickson</surname><given-names>MC</given-names></name><name><surname>Thomas</surname><given-names>DJ</given-names></name><name><surname>Weirauch</surname><given-names>MT</given-names></name><name><surname>Gilbert</surname><given-names>J</given-names></name><name><surname>Drenkow</surname><given-names>J</given-names></name><name><surname>Bell</surname><given-names>I</given-names></name><name><surname>Zhao</surname><given-names>X</given-names></name><name><surname>Srinivasan</surname><given-names>KG</given-names></name><name><surname>Sung</surname><given-names>WK</given-names></name><name><surname>Ooi</surname><given-names>HS</given-names></name><name><surname>Chiu</surname><given-names>KP</given-names></name><name><surname>Foissac</surname><given-names>S</given-names></name><name><surname>Alioto</surname><given-names>T</given-names></name><name><surname>Brent</surname><given-names>M</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><name><surname>Tress</surname><given-names>ML</given-names></name><name><surname>Valencia</surname><given-names>A</given-names></name><name><surname>Choo</surname><given-names>SW</given-names></name><name><surname>Choo</surname><given-names>CY</given-names></name><name><surname>Ucla</surname><given-names>C</given-names></name><name><surname>Manzano</surname><given-names>C</given-names></name><name><surname>Wyss</surname><given-names>C</given-names></name><name><surname>Cheung</surname><given-names>E</given-names></name><name><surname>Clark</surname><given-names>TG</given-names></name><name><surname>Brown</surname><given-names>JB</given-names></name><name><surname>Ganesh</surname><given-names>M</given-names></name><name><surname>Patel</surname><given-names>S</given-names></name><name><surname>Tammana</surname><given-names>H</given-names></name><name><surname>Chrast</surname><given-names>J</given-names></name><name><surname>Henrichsen</surname><given-names>CN</given-names></name><name><surname>Kai</surname><given-names>C</given-names></name><name><surname>Kawai</surname><given-names>J</given-names></name><name><surname>Nagalakshmi</surname><given-names>U</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Lian</surname><given-names>Z</given-names></name><name><surname>Lian</surname><given-names>J</given-names></name><name><surname>Newburger</surname><given-names>P</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Bickel</surname><given-names>P</given-names></name><name><surname>Mattick</surname><given-names>JS</given-names></name><name><surname>Carninci</surname><given-names>P</given-names></name><name><surname>Hayashizaki</surname><given-names>Y</given-names></name><name><surname>Weissman</surname><given-names>S</given-names></name><name><surname>Hubbard</surname><given-names>T</given-names></name><name><surname>Myers</surname><given-names>RM</given-names></name><name><surname>Rogers</surname><given-names>J</given-names></name><name><surname>Stadler</surname><given-names>PF</given-names></name><name><surname>Lowe</surname><given-names>TM</given-names></name><name><surname>Wei</surname><given-names>CL</given-names></name><name><surname>Ruan</surname><given-names>Y</given-names></name><name><surname>Struhl</surname><given-names>K</given-names></name><name><surname>Gerstein</surname><given-names>M</given-names></name><name><surname>Antonarakis</surname><given-names>SE</given-names></name><name><surname>Fu</surname><given-names>Y</given-names></name><name><surname>Green</surname><given-names>ED</given-names></name><name><surname>Karaöz</surname><given-names>U</given-names></name><name><surname>Siepel</surname><given-names>A</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Liefer</surname><given-names>LA</given-names></name><name><surname>Wetterstrand</surname><given-names>KA</given-names></name><name><surname>Good</surname><given-names>PJ</given-names></name><name><surname>Feingold</surname><given-names>EA</given-names></name><name><surname>Guyer</surname><given-names>MS</given-names></name><name><surname>Cooper</surname><given-names>GM</given-names></name><name><surname>Asimenos</surname><given-names>G</given-names></name><name><surname>Dewey</surname><given-names>CN</given-names></name><name><surname>Hou</surname><given-names>M</given-names></name><name><surname>Nikolaev</surname><given-names>S</given-names></name><name><surname>Montoya-Burgos</surname><given-names>JI</given-names></name><name><surname>Löytynoja</surname><given-names>A</given-names></name><name><surname>Whelan</surname><given-names>S</given-names></name><name><surname>Pardi</surname><given-names>F</given-names></name><name><surname>Massingham</surname><given-names>T</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>NR</given-names></name><name><surname>Holmes</surname><given-names>I</given-names></name><name><surname>Mullikin</surname><given-names>JC</given-names></name><name><surname>Ureta-Vidal</surname><given-names>A</given-names></name><name><surname>Paten</surname><given-names>B</given-names></name><name><surname>Seringhaus</surname><given-names>M</given-names></name><name><surname>Church</surname><given-names>D</given-names></name><name><surname>Rosenbloom</surname><given-names>K</given-names></name><name><surname>Kent</surname><given-names>WJ</given-names></name><name><surname>Stone</surname><given-names>EA</given-names></name><name><surname>Batzoglou</surname><given-names>S</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Hardison</surname><given-names>RC</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Miller</surname><given-names>W</given-names></name><name><surname>Sidow</surname><given-names>A</given-names></name><name><surname>Trinklein</surname><given-names>ND</given-names></name><name><surname>Zhang</surname><given-names>ZD</given-names></name><name><surname>Barrera</surname><given-names>L</given-names></name><name><surname>Stuart</surname><given-names>R</given-names></name><name><surname>King</surname><given-names>DC</given-names></name><name><surname>Ameur</surname><given-names>A</given-names></name><name><surname>Enroth</surname><given-names>S</given-names></name><name><surname>Bieda</surname><given-names>MC</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Bhinge</surname><given-names>AA</given-names></name><name><surname>Jiang</surname><given-names>N</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Yao</surname><given-names>F</given-names></name><name><surname>Vega</surname><given-names>VB</given-names></name><name><surname>Lee</surname><given-names>CW</given-names></name><name><surname>Ng</surname><given-names>P</given-names></name><name><surname>Shahab</surname><given-names>A</given-names></name><name><surname>Yang</surname><given-names>A</given-names></name><name><surname>Moqtaderi</surname><given-names>Z</given-names></name><name><surname>Zhu</surname><given-names>Z</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Squazzo</surname><given-names>S</given-names></name><name><surname>Oberley</surname><given-names>MJ</given-names></name><name><surname>Inman</surname><given-names>D</given-names></name><name><surname>Singer</surname><given-names>MA</given-names></name><name><surname>Richmond</surname><given-names>TA</given-names></name><name><surname>Munn</surname><given-names>KJ</given-names></name><name><surname>Rada-Iglesias</surname><given-names>A</given-names></name><name><surname>Wallerman</surname><given-names>O</given-names></name><name><surname>Komorowski</surname><given-names>J</given-names></name><name><surname>Fowler</surname><given-names>JC</given-names></name><name><surname>Couttet</surname><given-names>P</given-names></name><name><surname>Bruce</surname><given-names>AW</given-names></name><name><surname>Dovey</surname><given-names>OM</given-names></name><name><surname>Ellis</surname><given-names>PD</given-names></name><name><surname>Langford</surname><given-names>CF</given-names></name><name><surname>Nix</surname><given-names>DA</given-names></name><name><surname>Euskirchen</surname><given-names>G</given-names></name><name><surname>Hartman</surname><given-names>S</given-names></name><name><surname>Urban</surname><given-names>AE</given-names></name><name><surname>Kraus</surname><given-names>P</given-names></name><name><surname>Van Calcar</surname><given-names>S</given-names></name><name><surname>Heintzman</surname><given-names>N</given-names></name><name><surname>Kim</surname><given-names>TH</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Qu</surname><given-names>C</given-names></name><name><surname>Hon</surname><given-names>G</given-names></name><name><surname>Luna</surname><given-names>R</given-names></name><name><surname>Glass</surname><given-names>CK</given-names></name><name><surname>Rosenfeld</surname><given-names>MG</given-names></name><name><surname>Aldred</surname><given-names>SF</given-names></name><name><surname>Cooper</surname><given-names>SJ</given-names></name><name><surname>Halees</surname><given-names>A</given-names></name><name><surname>Lin</surname><given-names>JM</given-names></name><name><surname>Shulha</surname><given-names>HP</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Xu</surname><given-names>M</given-names></name><name><surname>Haidar</surname><given-names>JN</given-names></name><name><surname>Yu</surname><given-names>Y</given-names></name><name><surname>Ruan</surname><given-names>Y</given-names></name><name><surname>Iyer</surname><given-names>VR</given-names></name><name><surname>Green</surname><given-names>RD</given-names></name><name><surname>Wadelius</surname><given-names>C</given-names></name><name><surname>Farnham</surname><given-names>PJ</given-names></name><name><surname>Ren</surname><given-names>B</given-names></name><name><surname>Harte</surname><given-names>RA</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Trumbower</surname><given-names>H</given-names></name><name><surname>Clawson</surname><given-names>H</given-names></name><name><surname>Hillman-Jackson</surname><given-names>J</given-names></name><name><surname>Zweig</surname><given-names>AS</given-names></name><name><surname>Smith</surname><given-names>K</given-names></name><name><surname>Thakkapallayil</surname><given-names>A</given-names></name><name><surname>Barber</surname><given-names>G</given-names></name><name><surname>Kuhn</surname><given-names>RM</given-names></name><name><surname>Karolchik</surname><given-names>D</given-names></name><name><surname>Armengol</surname><given-names>L</given-names></name><name><surname>Bird</surname><given-names>CP</given-names></name><name><surname>de Bakker</surname><given-names>PI</given-names></name><name><surname>Kern</surname><given-names>AD</given-names></name><name><surname>Lopez-Bigas</surname><given-names>N</given-names></name><name><surname>Martin</surname><given-names>JD</given-names></name><name><surname>Stranger</surname><given-names>BE</given-names></name><name><surname>Woodroffe</surname><given-names>A</given-names></name><name><surname>Davydov</surname><given-names>E</given-names></name><name><surname>Dimas</surname><given-names>A</given-names></name><name><surname>Eyras</surname><given-names>E</given-names></name><name><surname>Hallgrímsdóttir</surname><given-names>IB</given-names></name><name><surname>Huppert</surname><given-names>J</given-names></name><name><surname>Zody</surname><given-names>MC</given-names></name><name><surname>Abecasis</surname><given-names>GR</given-names></name><name><surname>Estivill</surname><given-names>X</given-names></name><name><surname>Bouffard</surname><given-names>GG</given-names></name><name><surname>Guan</surname><given-names>X</given-names></name><name><surname>Hansen</surname><given-names>NF</given-names></name><name><surname>Idol</surname><given-names>JR</given-names></name><name><surname>Maduro</surname><given-names>VV</given-names></name><name><surname>Maskeri</surname><given-names>B</given-names></name><name><surname>McDowell</surname><given-names>JC</given-names></name><name><surname>Park</surname><given-names>M</given-names></name><name><surname>Thomas</surname><given-names>PJ</given-names></name><name><surname>Young</surname><given-names>AC</given-names></name><name><surname>Blakesley</surname><given-names>RW</given-names></name><name><surname>Muzny</surname><given-names>DM</given-names></name><name><surname>Sodergren</surname><given-names>E</given-names></name><name><surname>Wheeler</surname><given-names>DA</given-names></name><name><surname>Worley</surname><given-names>KC</given-names></name><name><surname>Jiang</surname><given-names>H</given-names></name><name><surname>Weinstock</surname><given-names>GM</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Graves</surname><given-names>T</given-names></name><name><surname>Fulton</surname><given-names>R</given-names></name><name><surname>Mardis</surname><given-names>ER</given-names></name><name><surname>Wilson</surname><given-names>RK</given-names></name><name><surname>Clamp</surname><given-names>M</given-names></name><name><surname>Cuff</surname><given-names>J</given-names></name><name><surname>Gnerre</surname><given-names>S</given-names></name><name><surname>Jaffe</surname><given-names>DB</given-names></name><name><surname>Chang</surname><given-names>JL</given-names></name><name><surname>Lindblad-Toh</surname><given-names>K</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Koriabine</surname><given-names>M</given-names></name><name><surname>Nefedov</surname><given-names>M</given-names></name><name><surname>Osoegawa</surname><given-names>K</given-names></name><name><surname>Yoshinaga</surname><given-names>Y</given-names></name><name><surname>Zhu</surname><given-names>B</given-names></name><name><surname>de Jong</surname><given-names>PJ</given-names></name><collab>ENCODE Project Consortium</collab><collab>NISC Comparative Sequencing Program</collab><collab>Baylor College of Medicine Human Genome Sequencing Center</collab><collab>Washington University Genome Sequencing Center</collab><collab>Broad Institute</collab><collab>Children's Hospital Oakland Research Institute</collab></person-group><year iso-8601-date="2007">2007</year><article-title>Identification and analysis of functional elements in 1% of the human genome by the ENCODE pilot project</article-title><source>Nature</source><volume>447</volume><fpage>799</fpage><lpage>816</lpage><pub-id pub-id-type="doi">10.1038/nature05874</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calvo</surname><given-names>SE</given-names></name><name><surname>Pagliarini</surname><given-names>DJ</given-names></name><name><surname>Mootha</surname><given-names>VK</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Upstream open reading frames cause widespread reduction of protein expression and are polymorphic among humans</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>106</volume><fpage>7507</fpage><lpage>7512</lpage><pub-id pub-id-type="doi">10.1073/pnas.0810916106</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camby I</surname></name><name><surname>Le Mercier</surname><given-names>M</given-names></name><name><surname>Lefranc</surname><given-names>F</given-names></name><name><surname>Kiss</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Galectin-1: a small protein with major functions</article-title><source>Glycobiology</source><volume>16</volume><fpage>137R</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1093/glycob/cwl025</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>MB</given-names></name><name><surname>Amaral</surname><given-names>PP</given-names></name><name><surname>Schlesinger</surname><given-names>FJ</given-names></name><name><surname>Dinger</surname><given-names>ME</given-names></name><name><surname>Taft</surname><given-names>RJ</given-names></name><name><surname>Rinn</surname><given-names>JL</given-names></name><name><surname>Ponting</surname><given-names>CP</given-names></name><name><surname>Stadler</surname><given-names>PF</given-names></name><name><surname>Morris</surname><given-names>KV</given-names></name><name><surname>Morillon</surname><given-names>A</given-names></name><name><surname>Rozowsky</surname><given-names>JS</given-names></name><name><surname>Gerstein</surname><given-names>MB</given-names></name><name><surname>Wahlestedt</surname><given-names>C</given-names></name><name><surname>Hayashizaki</surname><given-names>Y</given-names></name><name><surname>Carninci</surname><given-names>P</given-names></name><name><surname>Gingeras</surname><given-names>TR</given-names></name><name><surname>Mattick</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The reality of pervasive transcription</article-title><source>PLoS Biology</source><volume>9</volume><elocation-id>e1001102</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1000625</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cox</surname><given-names>J</given-names></name><name><surname>Mann</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>MaxQuant enables high peptide identification rates, individualized p.p.b.-range mass accuracies and proteome-wide protein quantification</article-title><source>Nature Biotechnology</source><volume>26</volume><fpage>1367</fpage><lpage>1372</lpage><pub-id pub-id-type="doi">10.1038/nbt.1511</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cox</surname><given-names>J</given-names></name><name><surname>Neuhauser</surname><given-names>N</given-names></name><name><surname>Michalski</surname><given-names>A</given-names></name><name><surname>Scheltema</surname><given-names>RA</given-names></name><name><surname>Olsen</surname><given-names>JV</given-names></name><name><surname>Mann</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Andromeda: a peptide search engine integrated into the MaxQuant environment</article-title><source>Journal of Proteome Research</source><volume>10</volume><fpage>1794</fpage><lpage>1805</lpage><pub-id pub-id-type="doi">10.1021/pr101065j</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Djebali</surname><given-names>S</given-names></name><name><surname>Davis</surname><given-names>CA</given-names></name><name><surname>Merkel</surname><given-names>A</given-names></name><name><surname>Dobin</surname><given-names>A</given-names></name><name><surname>Lassmann</surname><given-names>T</given-names></name><name><surname>Mortazavi</surname><given-names>A</given-names></name><name><surname>Tanzer</surname><given-names>A</given-names></name><name><surname>Lagarde</surname><given-names>J</given-names></name><name><surname>Lin</surname><given-names>W</given-names></name><name><surname>Schlesinger</surname><given-names>F</given-names></name><name><surname>Xue</surname><given-names>C</given-names></name><name><surname>Marinov</surname><given-names>GK</given-names></name><name><surname>Khatun</surname><given-names>J</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>Zaleski</surname><given-names>C</given-names></name><name><surname>Rozowsky</surname><given-names>J</given-names></name><name><surname>Röder</surname><given-names>M</given-names></name><name><surname>Kokocinski</surname><given-names>F</given-names></name><name><surname>Abdelhamid</surname><given-names>RF</given-names></name><name><surname>Alioto</surname><given-names>T</given-names></name><name><surname>Antoshechkin</surname><given-names>I</given-names></name><name><surname>Baer</surname><given-names>MT</given-names></name><name><surname>Bar</surname><given-names>NS</given-names></name><name><surname>Batut</surname><given-names>P</given-names></name><name><surname>Bell</surname><given-names>K</given-names></name><name><surname>Bell</surname><given-names>I</given-names></name><name><surname>Chakrabortty</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Chrast</surname><given-names>J</given-names></name><name><surname>Curado</surname><given-names>J</given-names></name><name><surname>Derrien</surname><given-names>T</given-names></name><name><surname>Drenkow</surname><given-names>J</given-names></name><name><surname>Dumais</surname><given-names>E</given-names></name><name><surname>Dumais</surname><given-names>J</given-names></name><name><surname>Duttagupta</surname><given-names>R</given-names></name><name><surname>Falconnet</surname><given-names>E</given-names></name><name><surname>Fastuca</surname><given-names>M</given-names></name><name><surname>Fejes-Toth</surname><given-names>K</given-names></name><name><surname>Ferreira</surname><given-names>P</given-names></name><name><surname>Foissac</surname><given-names>S</given-names></name><name><surname>Fullwood</surname><given-names>MJ</given-names></name><name><surname>Gao</surname><given-names>H</given-names></name><name><surname>Gonzalez</surname><given-names>D</given-names></name><name><surname>Gordon</surname><given-names>A</given-names></name><name><surname>Gunawardena</surname><given-names>H</given-names></name><name><surname>Howald</surname><given-names>C</given-names></name><name><surname>Jha</surname><given-names>S</given-names></name><name><surname>Johnson</surname><given-names>R</given-names></name><name><surname>Kapranov</surname><given-names>P</given-names></name><name><surname>King</surname><given-names>B</given-names></name><name><surname>Kingswood</surname><given-names>C</given-names></name><name><surname>Luo</surname><given-names>OJ</given-names></name><name><surname>Park</surname><given-names>E</given-names></name><name><surname>Persaud</surname><given-names>K</given-names></name><name><surname>Preall</surname><given-names>JB</given-names></name><name><surname>Ribeca</surname><given-names>P</given-names></name><name><surname>Risk</surname><given-names>B</given-names></name><name><surname>Robyr</surname><given-names>D</given-names></name><name><surname>Sammeth</surname><given-names>M</given-names></name><name><surname>Schaffer</surname><given-names>L</given-names></name><name><surname>See</surname><given-names>LH</given-names></name><name><surname>Shahab</surname><given-names>A</given-names></name><name><surname>Skancke</surname><given-names>J</given-names></name><name><surname>Suzuki</surname><given-names>AM</given-names></name><name><surname>Takahashi</surname><given-names>H</given-names></name><name><surname>Tilgner</surname><given-names>H</given-names></name><name><surname>Trout</surname><given-names>D</given-names></name><name><surname>Walters</surname><given-names>N</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Wrobel</surname><given-names>J</given-names></name><name><surname>Yu</surname><given-names>Y</given-names></name><name><surname>Ruan</surname><given-names>X</given-names></name><name><surname>Hayashizaki</surname><given-names>Y</given-names></name><name><surname>Harrow</surname><given-names>J</given-names></name><name><surname>Gerstein</surname><given-names>M</given-names></name><name><surname>Hubbard</surname><given-names>T</given-names></name><name><surname>Reymond</surname><given-names>A</given-names></name><name><surname>Antonarakis</surname><given-names>SE</given-names></name><name><surname>Hannon</surname><given-names>G</given-names></name><name><surname>Giddings</surname><given-names>MC</given-names></name><name><surname>Ruan</surname><given-names>Y</given-names></name><name><surname>Wold</surname><given-names>B</given-names></name><name><surname>Carninci</surname><given-names>P</given-names></name><name><surname>Guigó</surname><given-names>R</given-names></name><name><surname>Gingeras</surname><given-names>TR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Landscape of transcription in human cells</article-title><source>Nature</source><volume>489</volume><fpage>101</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1038/nature11233</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dobin</surname><given-names>A</given-names></name><name><surname>Davis</surname><given-names>CA</given-names></name><name><surname>Schlesinger</surname><given-names>F</given-names></name><name><surname>Drenkow</surname><given-names>J</given-names></name><name><surname>Zaleski</surname><given-names>C</given-names></name><name><surname>Jha</surname><given-names>S</given-names></name><name><surname>Batut</surname><given-names>P</given-names></name><name><surname>Chaisson</surname><given-names>M</given-names></name><name><surname>Gingeras</surname><given-names>TR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>STAR: ultrafast universal RNA-seq aligner</article-title><source>Bioinformatics</source><volume>29</volume><fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>SN</given-names></name><name><surname>Shvets</surname><given-names>Y</given-names></name><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Non-equilibrium theory of the allele frequency spectrum</article-title><source>Theoretical Population Biology</source><volume>71</volume><fpage>109</fpage><lpage>119</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2006.06.005</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farrell</surname><given-names>CM</given-names></name><name><surname>O'Leary</surname><given-names>NA</given-names></name><name><surname>Harte</surname><given-names>RA</given-names></name><name><surname>Loveland</surname><given-names>JE</given-names></name><name><surname>Wilming</surname><given-names>LG</given-names></name><name><surname>Wallin</surname><given-names>C</given-names></name><name><surname>Diekhans</surname><given-names>M</given-names></name><name><surname>Barrell</surname><given-names>D</given-names></name><name><surname>Searle</surname><given-names>SM</given-names></name><name><surname>Aken</surname><given-names>B</given-names></name><name><surname>Hiatt</surname><given-names>SM</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><name><surname>Suner</surname><given-names>MM</given-names></name><name><surname>Rajput</surname><given-names>B</given-names></name><name><surname>Steward</surname><given-names>CA</given-names></name><name><surname>Brown</surname><given-names>GR</given-names></name><name><surname>Bennett</surname><given-names>R</given-names></name><name><surname>Murphy</surname><given-names>M</given-names></name><name><surname>Wu</surname><given-names>W</given-names></name><name><surname>Kay</surname><given-names>MP</given-names></name><name><surname>Hart</surname><given-names>J</given-names></name><name><surname>Rajan</surname><given-names>J</given-names></name><name><surname>Weber</surname><given-names>J</given-names></name><name><surname>Snow</surname><given-names>C</given-names></name><name><surname>Riddick</surname><given-names>LD</given-names></name><name><surname>Hunt</surname><given-names>T</given-names></name><name><surname>Webb</surname><given-names>D</given-names></name><name><surname>Thomas</surname><given-names>M</given-names></name><name><surname>Tamez</surname><given-names>P</given-names></name><name><surname>Rangwala</surname><given-names>SH</given-names></name><name><surname>McGarvey</surname><given-names>KM</given-names></name><name><surname>Pujar</surname><given-names>S</given-names></name><name><surname>Shkeda</surname><given-names>A</given-names></name><name><surname>Mudge</surname><given-names>JM</given-names></name><name><surname>Gonzalez</surname><given-names>JM</given-names></name><name><surname>Gilbert</surname><given-names>JG</given-names></name><name><surname>Trevanion</surname><given-names>SJ</given-names></name><name><surname>Baertsch</surname><given-names>R</given-names></name><name><surname>Harrow</surname><given-names>JL</given-names></name><name><surname>Hubbard</surname><given-names>T</given-names></name><name><surname>Ostell</surname><given-names>JM</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Pruitt</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Current status and new features of the Consensus Coding Sequence database</article-title><source>Nucleic Acids Research</source><volume>42</volume><fpage>D865</fpage><lpage>D872</lpage><pub-id pub-id-type="doi">10.1093/nar/gkt1059</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galindo</surname><given-names>MI</given-names></name><name><surname>Pueyo</surname><given-names>JI</given-names></name><name><surname>Fouix</surname><given-names>S</given-names></name><name><surname>Bishop</surname><given-names>SA</given-names></name><name><surname>Couso</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Peptides encoded by short ORFs control development and define a new eukaryotic gene family</article-title><source>PLoS Biology</source><volume>5</volume><elocation-id>e106</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0050106</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guttman</surname><given-names>M</given-names></name><name><surname>Russell</surname><given-names>P</given-names></name><name><surname>Ingolia</surname><given-names>NT</given-names></name><name><surname>Weissman</surname><given-names>JS</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Ribosome profiling provides evidence that large noncoding RNAs do not encode proteins</article-title><source>Cell</source><volume>154</volume><fpage>240</fpage><lpage>251</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2013.06.009</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hangauer</surname><given-names>MJ</given-names></name><name><surname>Vaughn</surname><given-names>IW</given-names></name><name><surname>McManus</surname><given-names>MT</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Pervasive transcription of the human genome produces thousands of previously unidentified long intergenic noncoding RNAs</article-title><source>PLoS Genetics</source><volume>9</volume><elocation-id>e1003569</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003569</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrow</surname><given-names>J</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><name><surname>Gonzalez</surname><given-names>JM</given-names></name><name><surname>Tapanari</surname><given-names>E</given-names></name><name><surname>Diekhans</surname><given-names>M</given-names></name><name><surname>Kokocinski</surname><given-names>F</given-names></name><name><surname>Aken</surname><given-names>BL</given-names></name><name><surname>Barrell</surname><given-names>D</given-names></name><name><surname>Zadissa</surname><given-names>A</given-names></name><name><surname>Searle</surname><given-names>S</given-names></name><name><surname>Barnes</surname><given-names>I</given-names></name><name><surname>Bignell</surname><given-names>A</given-names></name><name><surname>Boychenko</surname><given-names>V</given-names></name><name><surname>Hunt</surname><given-names>T</given-names></name><name><surname>Kay</surname><given-names>M</given-names></name><name><surname>Mukherjee</surname><given-names>G</given-names></name><name><surname>Rajan</surname><given-names>J</given-names></name><name><surname>Despacio-Reyes</surname><given-names>G</given-names></name><name><surname>Saunders</surname><given-names>G</given-names></name><name><surname>Steward</surname><given-names>C</given-names></name><name><surname>Harte</surname><given-names>R</given-names></name><name><surname>Lin</surname><given-names>M</given-names></name><name><surname>Howald</surname><given-names>C</given-names></name><name><surname>Tanzer</surname><given-names>A</given-names></name><name><surname>Derrien</surname><given-names>T</given-names></name><name><surname>Chrast</surname><given-names>J</given-names></name><name><surname>Walters</surname><given-names>N</given-names></name><name><surname>Balasubramanian</surname><given-names>S</given-names></name><name><surname>Pei</surname><given-names>B</given-names></name><name><surname>Tress</surname><given-names>M</given-names></name><name><surname>Rodriguez</surname><given-names>JM</given-names></name><name><surname>Ezkurdia</surname><given-names>I</given-names></name><name><surname>van Baren</surname><given-names>J</given-names></name><name><surname>Brent</surname><given-names>M</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Kellis</surname><given-names>M</given-names></name><name><surname>Valencia</surname><given-names>A</given-names></name><name><surname>Reymond</surname><given-names>A</given-names></name><name><surname>Gerstein</surname><given-names>M</given-names></name><name><surname>Guigó</surname><given-names>R</given-names></name><name><surname>Hubbard</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>GENCODE: the reference human genome annotation for The ENCODE Project</article-title><source>Genome Research</source><volume>22</volume><fpage>1760</fpage><lpage>1834</lpage><pub-id pub-id-type="doi">10.1101/gr.135350.111</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hernández-Sánchez</surname><given-names>C</given-names></name><name><surname>Mansilla</surname><given-names>A</given-names></name><name><surname>de la Rosa</surname><given-names>EJ</given-names></name><name><surname>Pollerberg</surname><given-names>GE</given-names></name><name><surname>Martínez-Salas</surname><given-names>E</given-names></name><name><surname>de Pablo</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Upstream AUGs in embryonic proinsulin mRNA control its low translation level</article-title><source>The EMBO Journal</source><volume>22</volume><fpage>5582</fpage><lpage>5592</lpage><pub-id pub-id-type="doi">10.1093/emboj/cdg515</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ingolia</surname><given-names>NT</given-names></name><name><surname>Brar</surname><given-names>GA</given-names></name><name><surname>Stern-Ginossar</surname><given-names>N</given-names></name><name><surname>Harris</surname><given-names>MS</given-names></name><name><surname>Talhouarne</surname><given-names>GJ</given-names></name><name><surname>Jackson</surname><given-names>SE</given-names></name><name><surname>Wills</surname><given-names>MR</given-names></name><name><surname>Weissman</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Ribosome profiling reveals pervasive translation outside of annotated protein-coding genes</article-title><source>Cell Reports</source><volume>8</volume><fpage>1365</fpage><lpage>1379</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2014.07.045</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ingolia</surname><given-names>NT</given-names></name><name><surname>Ghaemmaghami</surname><given-names>S</given-names></name><name><surname>Newman</surname><given-names>JR</given-names></name><name><surname>Weissman</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Genome-wide analysis in vivo of translation with nucleotide resolution using ribosome profiling</article-title><source>Science</source><volume>324</volume><fpage>218</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1126/science.1168978</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ingolia</surname><given-names>NT</given-names></name><name><surname>Lareau</surname><given-names>LF</given-names></name><name><surname>Weissman</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Ribosome profiling of mouse embryonic stem cells reveals the complexity and dynamics of mammalian proteomes</article-title><source>Cell</source><volume>147</volume><fpage>789</fpage><lpage>802</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2011.10.002</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jung</surname><given-names>HW</given-names></name><name><surname>Tschaplinski</surname><given-names>TJ</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Glazebrook</surname><given-names>J</given-names></name><name><surname>Greenberg</surname><given-names>JT</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Priming in systemic plant immunity</article-title><source>Science</source><volume>324</volume><fpage>89</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1126/science.1170025</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kapranov</surname><given-names>P</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Dike</surname><given-names>S</given-names></name><name><surname>Nix</surname><given-names>DA</given-names></name><name><surname>Duttagupta</surname><given-names>R</given-names></name><name><surname>Willingham</surname><given-names>AT</given-names></name><name><surname>Stadler</surname><given-names>PF</given-names></name><name><surname>Hertel</surname><given-names>J</given-names></name><name><surname>Hackermüller</surname><given-names>J</given-names></name><name><surname>Hofacker</surname><given-names>IL</given-names></name><name><surname>Bell</surname><given-names>I</given-names></name><name><surname>Cheung</surname><given-names>E</given-names></name><name><surname>Drenkow</surname><given-names>J</given-names></name><name><surname>Dumais</surname><given-names>E</given-names></name><name><surname>Patel</surname><given-names>S</given-names></name><name><surname>Helt</surname><given-names>G</given-names></name><name><surname>Ganesh</surname><given-names>M</given-names></name><name><surname>Ghosh</surname><given-names>S</given-names></name><name><surname>Piccolboni</surname><given-names>A</given-names></name><name><surname>Sementchenko</surname><given-names>V</given-names></name><name><surname>Tammana</surname><given-names>H</given-names></name><name><surname>Gingeras</surname><given-names>TR</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>RNA maps reveal new RNA classes and a possible function for pervasive transcription</article-title><source>Science</source><volume>316</volume><fpage>1484</fpage><lpage>1488</lpage><pub-id pub-id-type="doi">10.1126/science.1138341</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawase</surname><given-names>T</given-names></name><name><surname>Akatsuka</surname><given-names>Y</given-names></name><name><surname>Torikai</surname><given-names>H</given-names></name><name><surname>Morishima</surname><given-names>S</given-names></name><name><surname>Oka</surname><given-names>A</given-names></name><name><surname>Tsujimura</surname><given-names>A</given-names></name><name><surname>Miyazaki</surname><given-names>M</given-names></name><name><surname>Tsujimura</surname><given-names>K</given-names></name><name><surname>Miyamura</surname><given-names>K</given-names></name><name><surname>Ogawa</surname><given-names>S</given-names></name><name><surname>Inoko</surname><given-names>H</given-names></name><name><surname>Morishima</surname><given-names>Y</given-names></name><name><surname>Kodera</surname><given-names>Y</given-names></name><name><surname>Kuzushima</surname><given-names>K</given-names></name><name><surname>Takahashi</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Alternative splicing due to an intronic SNP in HMSD generates a novel minor histocompatibility antigen</article-title><source>Blood</source><volume>110</volume><fpage>1055</fpage><lpage>1063</lpage><pub-id pub-id-type="doi">10.1182/blood-2007-02-075911</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>Z</given-names></name><name><surname>Ford</surname><given-names>MJ</given-names></name><name><surname>Cusanovich</surname><given-names>DA</given-names></name><name><surname>Mitrano</surname><given-names>A</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name><name><surname>Gilad</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Primate transcript and protein expression levels evolve under compensatory selection pressures</article-title><source>Science</source><volume>342</volume><fpage>1100</fpage><lpage>1104</lpage><pub-id pub-id-type="doi">10.1126/science.1242379</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kochetov</surname><given-names>AV</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Alternative translation start sites and hidden coding potential of eukaryotic mRNAs</article-title><source>BioEssays</source><volume>30</volume><fpage>683</fpage><lpage>691</lpage><pub-id pub-id-type="doi">10.1002/bies.20771</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kondo</surname><given-names>T</given-names></name><name><surname>Hashimoto</surname><given-names>Y</given-names></name><name><surname>Kato</surname><given-names>K</given-names></name><name><surname>Inagaki</surname><given-names>S</given-names></name><name><surname>Hayashi</surname><given-names>S</given-names></name><name><surname>Kageyama</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Small peptide regulators of actin-based cell morphogenesis encoded by a polycistronic mRNA</article-title><source>Nature Cell Biology</source><volume>9</volume><fpage>660</fpage><lpage>665</lpage><pub-id pub-id-type="doi">10.1038/ncb1595</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kondo</surname><given-names>T</given-names></name><name><surname>Plaza</surname><given-names>S</given-names></name><name><surname>Zanet</surname><given-names>J</given-names></name><name><surname>Benrabah</surname><given-names>E</given-names></name><name><surname>Valenti</surname><given-names>P</given-names></name><name><surname>Hashimoto</surname><given-names>Y</given-names></name><name><surname>Kobayashi</surname><given-names>S</given-names></name><name><surname>Payre</surname><given-names>F</given-names></name><name><surname>Kageyama</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Small peptides switch the transcriptional activity of Shavenbaby during Drosophila embryogenesis</article-title><source>Science</source><volume>329</volume><fpage>336</fpage><lpage>339</lpage><pub-id pub-id-type="doi">10.1126/science.1188158</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozak</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>An analysis of 5'-noncoding sequences from 699 vertebrate messenger RNAs</article-title><source>Nucleic Acids Research</source><volume>15</volume><fpage>8125</fpage><lpage>8148</lpage><pub-id pub-id-type="doi">10.1093/nar/15.20.8125</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lammich</surname><given-names>S</given-names></name><name><surname>Schöbel</surname><given-names>S</given-names></name><name><surname>Zimmer</surname><given-names>AK</given-names></name><name><surname>Lichtenthaler</surname><given-names>SF</given-names></name><name><surname>Haass</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Expression of the Alzheimer protease BACE1 is suppressed via its 5'-untranslated region</article-title><source>EMBO Reports</source><volume>5</volume><fpage>620</fpage><lpage>625</lpage><pub-id pub-id-type="doi">10.1038/sj.embor.7400166</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fast gapped-read alignment with Bowtie 2</article-title><source>Nature Methods</source><volume>9</volume><fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lappalainen</surname><given-names>T</given-names></name><name><surname>Sammeth</surname><given-names>M</given-names></name><name><surname>Friedländer</surname><given-names>MR</given-names></name><name><surname>'t Hoen</surname><given-names>PA</given-names></name><name><surname>Monlong</surname><given-names>J</given-names></name><name><surname>Rivas</surname><given-names>MA</given-names></name><name><surname>Gonzàlez-Porta</surname><given-names>M</given-names></name><name><surname>Kurbatova</surname><given-names>N</given-names></name><name><surname>Griebel</surname><given-names>T</given-names></name><name><surname>Ferreira</surname><given-names>PG</given-names></name><name><surname>Barann</surname><given-names>M</given-names></name><name><surname>Wieland</surname><given-names>T</given-names></name><name><surname>Greger</surname><given-names>L</given-names></name><name><surname>van Iterson</surname><given-names>M</given-names></name><name><surname>Almlöf</surname><given-names>J</given-names></name><name><surname>Ribeca</surname><given-names>P</given-names></name><name><surname>Pulyakhina</surname><given-names>I</given-names></name><name><surname>Esser</surname><given-names>D</given-names></name><name><surname>Giger</surname><given-names>T</given-names></name><name><surname>Tikhonov</surname><given-names>A</given-names></name><name><surname>Sultan</surname><given-names>M</given-names></name><name><surname>Bertier</surname><given-names>G</given-names></name><name><surname>MacArthur</surname><given-names>DG</given-names></name><name><surname>Lek</surname><given-names>M</given-names></name><name><surname>Lizano</surname><given-names>E</given-names></name><name><surname>Buermans</surname><given-names>HP</given-names></name><name><surname>Padioleau</surname><given-names>I</given-names></name><name><surname>Schwarzmayr</surname><given-names>T</given-names></name><name><surname>Karlberg</surname><given-names>O</given-names></name><name><surname>Ongen</surname><given-names>H</given-names></name><name><surname>Kilpinen</surname><given-names>H</given-names></name><name><surname>Beltran</surname><given-names>S</given-names></name><name><surname>Gut</surname><given-names>M</given-names></name><name><surname>Kahlem</surname><given-names>K</given-names></name><name><surname>Amstislavskiy</surname><given-names>V</given-names></name><name><surname>Stegle</surname><given-names>O</given-names></name><name><surname>Pirinen</surname><given-names>M</given-names></name><name><surname>Montgomery</surname><given-names>SB</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name><name><surname>McCarthy</surname><given-names>MI</given-names></name><name><surname>Flicek</surname><given-names>P</given-names></name><name><surname>Strom</surname><given-names>TM</given-names></name><name><surname>Lehrach</surname><given-names>H</given-names></name><name><surname>Schreiber</surname><given-names>S</given-names></name><name><surname>Sudbrak</surname><given-names>R</given-names></name><name><surname>Carracedo</surname><given-names>A</given-names></name><name><surname>Antonarakis</surname><given-names>SE</given-names></name><name><surname>Häsler</surname><given-names>R</given-names></name><name><surname>Syvänen</surname><given-names>AC</given-names></name><name><surname>van Ommen</surname><given-names>GJ</given-names></name><name><surname>Brazma</surname><given-names>A</given-names></name><name><surname>Meitinger</surname><given-names>T</given-names></name><name><surname>Rosenstiel</surname><given-names>P</given-names></name><name><surname>Guigó</surname><given-names>R</given-names></name><name><surname>Gut</surname><given-names>IG</given-names></name><name><surname>Estivill</surname><given-names>X</given-names></name><name><surname>Dermitzakis</surname><given-names>ET</given-names></name><collab>Geuvadis Consortium</collab></person-group><year iso-8601-date="2013">2013</year><article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title><source>Nature</source><volume>501</volume><fpage>506</fpage><lpage>511</lpage><pub-id pub-id-type="doi">10.1038/nature12531</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lauressergues</surname><given-names>D</given-names></name><name><surname>Couzigou</surname><given-names>JM</given-names></name><name><surname>Clemente</surname><given-names>HS</given-names></name><name><surname>Martinez</surname><given-names>Y</given-names></name><name><surname>Dunand</surname><given-names>C</given-names></name><name><surname>Bécard</surname><given-names>G</given-names></name><name><surname>Combier</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Primary transcripts of microRNAs encode regulatory peptides</article-title><source>Nature</source><volume>520</volume><fpage>90</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1038/nature14346</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>J</given-names></name><name><surname>Park</surname><given-names>EH</given-names></name><name><surname>Couture</surname><given-names>G</given-names></name><name><surname>Harvey</surname><given-names>I</given-names></name><name><surname>Garneau</surname><given-names>P</given-names></name><name><surname>Pelletier</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>An upstream open reading frame impedes translation of the huntingtin gene</article-title><source>Nucleic Acids Research</source><volume>30</volume><fpage>5110</fpage><lpage>5119</lpage><pub-id pub-id-type="doi">10.1093/nar/gkf664</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Lee</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>SX</given-names></name><name><surname>Shen</surname><given-names>B</given-names></name><name><surname>Qian</surname><given-names>SB</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Global mapping of translation initiation sites in mammalian cells at single-nucleotide resolution</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>109</volume><fpage>E2424</fpage><lpage>E2432</lpage><pub-id pub-id-type="doi">10.1073/pnas.1207846109</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>MF</given-names></name><name><surname>Jungreis</surname><given-names>I</given-names></name><name><surname>Kellis</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>PhyloCSF: a comparative genomics method to distinguish protein coding and non-coding regions</article-title><source>Bioinformatics</source><volume>27</volume><fpage>i275</fpage><lpage>282</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr209</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Novor: Real-time peptide de novo sequencing software</article-title><source>Journal of the American Society for Mass Spectrometry</source><volume>26</volume><fpage>1885</fpage><lpage>1894</lpage><pub-id pub-id-type="doi">10.1007/s13361-015-1204-0</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michel</surname><given-names>AM</given-names></name><name><surname>Choudhury</surname><given-names>KR</given-names></name><name><surname>Firth</surname><given-names>AE</given-names></name><name><surname>Ingolia</surname><given-names>NT</given-names></name><name><surname>Atkins</surname><given-names>JF</given-names></name><name><surname>Baranov</surname><given-names>PV</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Observation of dually decoded regions of the human genome using ribosome profiling data</article-title><source>Genome Research</source><volume>22</volume><fpage>2219</fpage><lpage>2229</lpage><pub-id pub-id-type="doi">10.1101/gr.133249.111</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>DR</given-names></name><name><surname>Geballe</surname><given-names>AP</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Upstream open reading frames as regulators of mRNA translation</article-title><source>Molecular and Cellular Biology</source><volume>20</volume><fpage>8635</fpage><lpage>8642</lpage><pub-id pub-id-type="doi">10.1128/MCB.20.23.8635-8642.2000</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nesvizhskii</surname><given-names>AI</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Proteogenomics: concepts, applications and computational strategies</article-title><source>Nature Methods</source><volume>11</volume><fpage>1114</fpage><lpage>1125</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3144</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Molecular signatures of natural selection</article-title><source>Annual Review of Genetics</source><volume>39</volume><fpage>197</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1146/annurev.genet.39.073003.112420</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oelkers</surname><given-names>K</given-names></name><name><surname>Goffard</surname><given-names>N</given-names></name><name><surname>Weiller</surname><given-names>GF</given-names></name><name><surname>Gresshoff</surname><given-names>PM</given-names></name><name><surname>Mathesius</surname><given-names>U</given-names></name><name><surname>Frickey</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Bioinformatic analysis of the CLE signaling peptide family</article-title><source>BMC Plant Biology</source><volume>8</volume><elocation-id>1</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2229-8-1</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pei</surname><given-names>B</given-names></name><name><surname>Sisu</surname><given-names>C</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><name><surname>Howald</surname><given-names>C</given-names></name><name><surname>Habegger</surname><given-names>L</given-names></name><name><surname>Mu</surname><given-names>XJ</given-names></name><name><surname>Harte</surname><given-names>R</given-names></name><name><surname>Balasubramanian</surname><given-names>S</given-names></name><name><surname>Tanzer</surname><given-names>A</given-names></name><name><surname>Diekhans</surname><given-names>M</given-names></name><name><surname>Reymond</surname><given-names>A</given-names></name><name><surname>Hubbard</surname><given-names>TJ</given-names></name><name><surname>Harrow</surname><given-names>J</given-names></name><name><surname>Gerstein</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The GENCODE pseudogene resource</article-title><source>Genome Biology</source><volume>13</volume><elocation-id>R51</elocation-id><pub-id pub-id-type="doi">10.1186/gb-2012-13-9-r51</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pertea</surname><given-names>M</given-names></name><name><surname>Pertea</surname><given-names>GM</given-names></name><name><surname>Antonescu</surname><given-names>CM</given-names></name><name><surname>Chang</surname><given-names>TC</given-names></name><name><surname>Mendell</surname><given-names>JT</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title><source>Nature Biotechnology</source><volume>33</volume><fpage>290</fpage><lpage>295</lpage><pub-id pub-id-type="doi">10.1038/nbt.3122</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pevtsov</surname><given-names>S</given-names></name><name><surname>Fedulova</surname><given-names>I</given-names></name><name><surname>Mirzaei</surname><given-names>H</given-names></name><name><surname>Buck</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Performance evaluation of existing de novo sequencing algorithms</article-title><source>Journal of Proteome Research</source><volume>5</volume><fpage>3018</fpage><lpage>3028</lpage><pub-id pub-id-type="doi">10.1021/pr060222h</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenbloom</surname><given-names>KR</given-names></name><name><surname>Armstrong</surname><given-names>J</given-names></name><name><surname>Barber</surname><given-names>GP</given-names></name><name><surname>Casper</surname><given-names>J</given-names></name><name><surname>Clawson</surname><given-names>H</given-names></name><name><surname>Diekhans</surname><given-names>M</given-names></name><name><surname>Dreszer</surname><given-names>TR</given-names></name><name><surname>Fujita</surname><given-names>PA</given-names></name><name><surname>Guruvadoo</surname><given-names>L</given-names></name><name><surname>Haeussler</surname><given-names>M</given-names></name><name><surname>Harte</surname><given-names>RA</given-names></name><name><surname>Heitner</surname><given-names>S</given-names></name><name><surname>Hickey</surname><given-names>G</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Hubley</surname><given-names>R</given-names></name><name><surname>Karolchik</surname><given-names>D</given-names></name><name><surname>Learned</surname><given-names>K</given-names></name><name><surname>Lee</surname><given-names>BT</given-names></name><name><surname>Li</surname><given-names>CH</given-names></name><name><surname>Miga</surname><given-names>KH</given-names></name><name><surname>Nguyen</surname><given-names>N</given-names></name><name><surname>Paten</surname><given-names>B</given-names></name><name><surname>Raney</surname><given-names>BJ</given-names></name><name><surname>Smit</surname><given-names>AF</given-names></name><name><surname>Speir</surname><given-names>ML</given-names></name><name><surname>Zweig</surname><given-names>AS</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Kuhn</surname><given-names>RM</given-names></name><name><surname>Kent</surname><given-names>WJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The UCSC Genome Browser database: 2015 update</article-title><source>Nucleic Acids Research</source><volume>43</volume><fpage>D670</fpage><lpage>681</lpage><pub-id pub-id-type="doi">10.1093/nar/gku1177</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>TopHat: discovering splice junctions with RNA-Seq</article-title><source>Bioinformatics</source><volume>25</volume><fpage>1105</fpage><lpage>1111</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp120</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Bakel</surname><given-names>H</given-names></name><name><surname>Nislow</surname><given-names>C</given-names></name><name><surname>Blencowe</surname><given-names>BJ</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Most &quot;dark matter&quot; transcripts are associated with known genes</article-title><source>PLoS Biology</source><volume>8</volume><elocation-id>e1000371</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1000371</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vanderperre</surname><given-names>B</given-names></name><name><surname>Lucier</surname><given-names>JF</given-names></name><name><surname>Bissonnette</surname><given-names>C</given-names></name><name><surname>Motard</surname><given-names>J</given-names></name><name><surname>Tremblay</surname><given-names>G</given-names></name><name><surname>Vanderperre</surname><given-names>S</given-names></name><name><surname>Wisztorski</surname><given-names>M</given-names></name><name><surname>Salzet</surname><given-names>M</given-names></name><name><surname>Boisvert</surname><given-names>FM</given-names></name><name><surname>Roucou</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Direct detection of alternative open reading frames translation products in human significantly expands the proteome</article-title><source>PloS One</source><volume>8</volume><elocation-id>e70698</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0070698</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinberg</surname><given-names>DE</given-names></name><name><surname>Shah</surname><given-names>P</given-names></name><name><surname>Eichhorn</surname><given-names>SW</given-names></name><name><surname>Hussmann</surname><given-names>JA</given-names></name><name><surname>Plotkin</surname><given-names>JB</given-names></name><name><surname>Bartel</surname><given-names>DP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Improved ribosome-footprint and mRNA measurements provide insights into dynamics and regulation of yeast translation</article-title><source>Cell Reports</source><volume>14</volume><fpage>1787</fpage><lpage>-99</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2016.01.043</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilming</surname><given-names>LG</given-names></name><name><surname>Gilbert</surname><given-names>JG</given-names></name><name><surname>Howe</surname><given-names>K</given-names></name><name><surname>Trevanion</surname><given-names>S</given-names></name><name><surname>Hubbard</surname><given-names>T</given-names></name><name><surname>Harrow</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The vertebrate genome annotation (Vega) database</article-title><source>Nucleic Acids Research</source><volume>36</volume><fpage>D753</fpage><lpage>D760</lpage><pub-id pub-id-type="doi">10.1093/nar/gkm987</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>P</given-names></name><name><surname>Fu</surname><given-names>Y</given-names></name><name><surname>Zheng</surname><given-names>Y</given-names></name><name><surname>Tang</surname><given-names>Q</given-names></name><name><surname>Si</surname><given-names>L</given-names></name><name><surname>You</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Zhu</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Wei</surname><given-names>Z</given-names></name><name><surname>Lin</surname><given-names>B</given-names></name><name><surname>Hu</surname><given-names>L</given-names></name><name><surname>Kong</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Length of the ORF, position of the first AUG and the Kozak motif are important factors in potential dual-coding transcripts</article-title><source>Cell Research</source><volume>20</volume><fpage>445</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1038/cr.2010.25</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>PAML 4: phylogenetic analysis by maximum likelihood</article-title><source>Molecular Biology and Evolution</source><volume>24</volume><fpage>1586</fpage><lpage>1591</lpage><pub-id pub-id-type="doi">10.1093/molbev/msm088</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.13328.036</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ingolia</surname><given-names>Nicholas T</given-names></name><role>Reviewing editor</role><aff id="aff7"><institution>University of California, Berkeley</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your work entitled &quot;Thousands of novel translated open reading frames in humans inferred by ribosome footprint profiling&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Naama Barkai (Senior editor) and two reviewers, one of whom served as guest Reviewing Editor.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Ribosome profiling seems to promise data that will allow empirical and unbiased detection of translated reading frames. In this manuscript, the authors apply a novel algorithm based on hidden markov models to analyze ribosome profiling data for a panel of human lymphoblastoid cell lines which they generated as part of this study. The new dataset is interesting, the computational approach is sensible and seems sound.</p><p>The end product of the analysis is a collection over 7,000 coding sequences (CDS) that are predicted to be translated to protein by the cell. They identify a wide variety of novel coding sequences, reflecting alternate reading frames on known mRNAs as well as translation of unannotated transcripts and pseudogenes. The authors try to demonstrate the validity of these predictions in various ways. The first comparison uses data generated in the presence of a drug that arrests the ribosome, which allows that start position and reading frame of the predicted CDS to be assessed. The p-values reported for the statistical significance in aggregate are impressive, but the underlying data in <xref ref-type="fig" rid="fig4">Figure 4</xref> suggest that the false positive rate is high. The second approach to validation considers the rate of non-synonymous vs synonymous substitutions inside the predicted CDS. Again, only for a small fraction (roughly 5%) of the CDS predictions there is statistical evidence that evolutionary pressure keeps the corresponding protein sequence constant, and the size of the effect for novel CDS in <xref ref-type="fig" rid="fig5">Figure 5A</xref> is tiny. A third comparison, with mass spec data for protein sequences, again reveals a confirmation rate (5%) that falls far short of what would be expected for matching annotated CDS.</p><p>Conceptually, the present work offers a statistically well-grounded approach for identifying translated reading frames. The results include a few interesting biological insights: alternative non-AUG start codons occur much more often than expected, a significant fraction of CDS have upstream alternatives whose level is mutually anti-correlated, and cis-QTLs can be mapped for the relative preference between the two alternatives. Empirically, the authors are able to ground their novel peptide predictions in direct detection of translated protein products, albeit at a rather low detection efficiency. These advances distinguish the present work from other recent studies addressing the same question, and on these grounds merit publication in <italic>eLife</italic>.</p><p>This is an excellent study, and the authors have done the best they can to analyze the data. It is perhaps disappointing that such a small fraction of the novel CDS predictions seem to hold up in validation. The authors speculate that these peptides may turn over more rapidly than for annotated CDS (perhaps by analogy with antisense transcription). This is indeed a possible explanation, but it would require further substantiation, which is beyond the scope of this study.</p><p>Essential revisions:</p><p>1) There is a risk that the larger community will use these new annotations as a resource without being aware of the low validation rate at the level of individual CDS. I therefore feel strongly that the authors should address the ~5% validation rate explicitly in the Abstract. That said, the validation rate in terms of transcriptional initiation may be much more favorable than that in terms of steady-state protein abundance. Future studies will need to address this further, but this is still an important work that sets a significant step towards a more comprehensive understanding of translational control on a genome-wide scale.</p><p>2) The authors estimate model parameters, including start codon usage psi_c, from five thousand well-expressed, annotated CDSes. However, annotated mCDSes, cryptic/novel mCDSes, and uaCDSes may differ – and in particular annotated mCDSes likely show a particularly strong bias towards the use of AUG codons, and a near-complete absence of most others besides CUG, which occurs in a few specific genes such as c-Myc. Does this effect in the estimated psi_c values bias the discovery of new reading frames in order to produce the trend shown in <xref ref-type="fig" rid="fig3">Figure 3B</xref>?</p><p>3) The authors report that 310 / 7,801 GENCODE-analyzed genes showed an &quot;entirely distinct&quot; mCDS. However, they estimate their per-transcript Type I error rate as 4.5%, which seems roughly consistent with all 310 instances of distinct CDSes reflecting annotation errors.</p><p>4) Identification of the precise translation initiation site has a higher false discovery rate than overall CDS identification. Other recent work (e.g. Fields et al.) incorporates harringtonine start site profiling directly into CDS predictions. Could the authors take a similar approach to improve detection of the correct initiation site (and perhaps thereby improve overall CDS accuracy too)?</p><p>5) As a related point, is there a general trend to identify CDSes that are longer, or CDSes that are shorter, when identifying the correct reading frame but not the annotated start site?</p><p>6) In the second paragraph of the subsection “Translation of short alternate coding sequences in addition to the mCDS”, the authors report 46 uaCDSes with detected peptides and 317 uaCDSes with evidence for selective constraint – are these two groups correlated?</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.13328.037</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions:</italic> </p><p><italic>1) There is a risk that the larger community will use these new annotations as a resource without being aware of the low validation rate at the level of individual CDS. I therefore feel strongly that the authors should address the ~5% validation rate explicitly in the Abstract. That said, the validation rate in terms of transcriptional initiation may be much more favorable than that in terms of steady-state protein abundance. Future studies will need to address this further, but this is still an important work that sets a significant step towards a more comprehensive understanding of translational control on a genome-wide scale.</italic></p><p>We have updated the Abstract to highlight the validation rate using mass-spectrometry measurements. That said, we note that the class of novel coding sequences is drastically different from annotated coding sequences in the lengths of the final protein. Thus, standard approaches to estimating selective constraint are likely to be significantly underpowered for these novel proteins. Moreover, standard mass-spectrometry measurements are not designed to measure proteins of these sizes and translation levels. We think it is important to quantify the observed number of validated novel CDS against a number that we can reasonably expect to be validated (to account for possible biases in the validation methods). Based on this, the mass-spectrometry validation rate for all novel coding sequences is 14%, increasing to 27% for just the class of mCDS. Details on how we established the expected novel CDS validation are described in the Materials and methods section.</p><p><italic>2) The authors estimate model parameters, including start codon usage psi_c, from five thousand well-expressed, annotated CDSes. However, annotated mCDSes, cryptic/novel mCDSes, and uaCDSes may differ – and in particular annotated mCDSes likely show a particularly strong bias towards the use of AUG codons, and a near-complete absence of most others besides CUG, which occurs in a few specific genes such as c-Myc. Does this effect in the estimated psi_c values bias the discovery of new reading frames in order to produce the trend shown in <xref ref-type="fig" rid="fig3">Figure 3B</xref>?</italic></p><p>Our model makes the assumption that all cytoplasmic mRNA translation shares the same molecular mechanism. Our learning set is enriched for annotated coding genes and we agree that this choice of learning set could lead to bias in estimating the frequency of non-AUG initiated coding sequences. Given the general lack of available information on these novel CDS, we find our estimate a reasonable starting point. The model parameters were learned using five thousand well-expressed genes; we used GENCODE annotations to define a gene but did not restrict this set to annotated coding genes. Most importantly, we did not use any information about the annotated translation initiation and termination sites when learning the model parameters. The psi_c values estimated with these well-expressed 5000 genes were very similar to those observed when random sets of five thousand genes were used as the learning set (see <xref ref-type="fig" rid="fig8">Author response image 1</xref>). In addition, only the periodicity parameters are shared between uaCDS and mCDS; i.e., we re-estimate psi_c before inferring uaCDS. We decided to use well-expressed genes as our learning set to ensure that when the footprint data do not provide very strong evidence regarding the initiation site, novel coding sequences identified by our method are as similar as possible to annotated coding sequences in the sequence composition of their initiation sites. We have now elaborated on our choice of learning set and its consequences in the Discussion section of the revised manuscript (third paragraph).<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.13328.025</object-id><label>Author response image 1.</label><caption><title>Comparing the estimated values of parameter psi_c, when using the 5000 most expressed genes (blue) and random sets of 5000 genes (gray).</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.025">http://dx.doi.org/10.7554/eLife.13328.025</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-resp-fig1-v3"/></fig></p><p><italic>3) The authors report that 310 / 7,801 GENCODE-analyzed genes showed an &quot;entirely distinct&quot; mCDS. However, they estimate their per-transcript Type I error rate as 4.5%, which seems roughly consistent with all 310 instances of distinct CDSes reflecting annotation errors.</italic></p><p>For annotated coding transcripts, the relevant Type I error rate for riboHMM is defined as follows: given that a set of transcripts each have a specific translated reading frame, the Type I error rate is the fraction of transcripts in which riboHMM infers a completely distinct reading frame as translated. Using simulations (described in detail in the subsection “Quantifying false discoveries of riboHMM”), we estimated the Type I error rate for annotated coding transcripts to be 0.31%. Thus, given that annotated coding transcripts have a specific translated reading frame, our error rate in inferring a completely different reading frame as translated is very small. The Type I error rate of 4.5% is more relevant to annotated non-coding transcripts. We have updated the manuscript clarifying the Type I error rate for these instances in the last paragraph of the Introduction and describing it in the subsection “Quantifying false discoveries of riboHMM” in Materials and methods.</p><p>As additional evidence supporting our inferences for these instances, <xref ref-type="fig" rid="fig9">Author response image 2</xref> shows that the aggregate harringtonine footprint signal at the annotated initiation sites is substantially lower than the signal at the initiation sites inferred by our model, for the same set of annotated coding transcripts.<fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.13328.026</object-id><label>Author response image 2.</label><caption><title>Comparing the proportion of harringtonine-treated ribosome footprints at the inferred initiation sites of novel coding sequences and the annotated initiation sites of annotated coding sequences.</title><p>Both plots are an aggregate over the same set of annotated coding genes for which the inferred coding sequence does not match the annotated coding sequence.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.13328.026">http://dx.doi.org/10.7554/eLife.13328.026</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-13328-resp-fig2-v3"/></fig></p><p><italic>4) Identification of the precise translation initiation site has a higher false discovery rate than overall CDS identification. Other recent work (e.g. Fields et al.) incorporates harringtonine start site profiling directly into CDS predictions. Could the authors take a similar approach to improve detection of the correct initiation site (and perhaps thereby improve overall CDS accuracy too)?</italic></p><p>We think it is a great idea to use the harringtonine footprint signal around the inferred initiation sites to improve overall accuracy of inferring novel coding sequences, similar to the approach in Fields et al. We attempted to incorporate harringtonine treated data in the model by introducing an additional covariate in the transition probabilities, providing independent information on the positions of translation initiation sites. However, the codon usage at the inferred initiation sites showed no significant change (K-S test; p-value = 0.88) and the set of inferred coding sequences showed very little difference when harringtonine data were incorporated into the model. Since the footprint data without treatment show clear enrichment at initiation sites, it is likely that harringtonine treated data do not provide much additional information. Thus, while the harringtonine data were useful for validating our inferred initiation sites (among potential initiation sites in a transcript) in aggregate, the data did not have sufficient information to calibrate the confidence in our predicted initiation sites across transcripts. We have modified the manuscript to discuss this point in the fourth paragraph of the Discussion section.</p><p><italic>5) As a related point, is there a general trend to identify CDSes that are longer, or CDSes that are shorter, when identifying the correct reading frame but not the annotated start site?</italic></p><p>When riboHMM identified the correct reading frame but not the annotated start site, we observed that the inferred initiation site was equally likely to be upstream or downstream of the annotated initiation site (Mann-Whitney test; p-value = 0.41). Moreover, riboHMM was no more likely to correctly identify the annotated initiation site in shorter proteins than longer proteins (Mann-Whitney test; p-value =<inline-formula><mml:math id="inf165"><mml:mo> </mml:mo></mml:math></inline-formula>0.12). We have now included these observations in the second paragraph of the subsection “Detection of novel CDSs in LCLs”.</p><p><italic>6) In the second paragraph of the subsection “Translation of short alternate coding sequences in addition to the mCDS”, the authors report 46 uaCDSes with detected peptides and 317 uaCDSes with evidence for selective constraint – are these two groups correlated?</italic></p><p>Among uaCDS, those having a peptide match and those having evidence of selective constraint are not concordant (Fisher’s test; p-value = 0.56). This is consistent with the low sensitivity of standard mass-spectrometry protocols to identify very short proteins. We have now noted this at the end of the subsection “Translation of short alternate coding sequences in addition to the mCDS”.</p></body></sub-article></article>