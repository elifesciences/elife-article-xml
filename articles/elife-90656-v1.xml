<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">90656</article-id><article-id pub-id-type="doi">10.7554/eLife.90656</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.90656.3</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Major patterns in the introgression history of <italic>Heliconius</italic> butterflies</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-228447"><name><surname>Thawornwattana</surname><given-names>Yuttapong</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2745-163X</contrib-id><email>ythawornwattana@g.harvard.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-325736"><name><surname>Seixas</surname><given-names>Fernando</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-53030"><name><surname>Yang</surname><given-names>Ziheng</given-names></name><email>z.yang@ucl.ac.uk</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-61406"><name><surname>Mallet</surname><given-names>James</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3370-0367</contrib-id><email>jmallet@oeb.harvard.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vek6s52</institution-id><institution>Department of Organismic and Evolutionary Biology, Harvard University</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>Department of Genetics, Evolution and Environment, University College London</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Rokas</surname><given-names>Antonis</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02vm5rt34</institution-id><institution>Vanderbilt University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Landry</surname><given-names>Christian R</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04sjchr03</institution-id><institution>Université Laval</institution></institution-wrap><country>Canada</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>18</day><month>12</month><year>2023</year></pub-date><volume>12</volume><elocation-id>RP90656</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2023-07-06"><day>06</day><month>07</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-06-23"><day>23</day><month>06</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.06.21.545923"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-09-11"><day>11</day><month>09</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.90656.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-11-22"><day>22</day><month>11</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.90656.2"/></event></pub-history><permissions><copyright-statement>© 2023, Thawornwattana et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Thawornwattana et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-90656-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-90656-figures-v1.pdf"/><abstract><p>Gene flow between species, although usually deleterious, is an important evolutionary process that can facilitate adaptation and lead to species diversification. It also makes estimation of species relationships difficult. Here, we use the full-likelihood multispecies coalescent (MSC) approach to estimate species phylogeny and major introgression events in <italic>Heliconius</italic> butterflies from whole-genome sequence data. We obtain a robust estimate of species branching order among major clades in the genus, including the ‘melpomene-silvaniform’ group, which shows extensive historical and ongoing gene flow. We obtain chromosome-level estimates of key parameters in the species phylogeny, including species divergence times, present-day and ancestral population sizes, as well as the direction, timing, and intensity of gene flow. Our analysis leads to a phylogeny with introgression events that differ from those obtained in previous studies. We find that <italic>Heliconius aoede</italic> most likely represents the earliest-branching lineage of the genus and that ‘silvaniform’ species are paraphyletic within the melpomene-silvaniform group. Our phylogeny provides new, parsimonious histories for the origins of key traits in <italic>Heliconius</italic>, including pollen feeding and an inversion involved in wing pattern mimicry. Our results demonstrate the power and feasibility of the full-likelihood MSC approach for estimating species phylogeny and key population parameters despite extensive gene flow. The methods used here should be useful for analysis of other difficult species groups with high rates of introgression.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd><italic>Heliconius</italic></kwd><kwd>introgression</kwd><kwd>gene flow</kwd><kwd>multispecies coalescent</kwd><kwd>chromosome inversion</kwd><kwd>BPP</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>BB/T003502/1</award-id><principal-award-recipient><name><surname>Yang</surname><given-names>Ziheng</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>BB/X007553/1</award-id><principal-award-recipient><name><surname>Yang</surname><given-names>Ziheng</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>BB/R01356X/1</award-id><principal-award-recipient><name><surname>Yang</surname><given-names>Ziheng</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000270</institution-id><institution>Natural Environment Research Council</institution></institution-wrap></funding-source><award-id>NE/X002071/1</award-id><principal-award-recipient><name><surname>Yang</surname><given-names>Ziheng</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The full-likelihood multispecies coalescent approach is useful for studying species groups with high rates of introgression from whole-genome sequence data.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Introgression among species has been reported in a wide range of organisms, including humans and Neanderthals (<xref ref-type="bibr" rid="bib37">Kuhlwilm et al., 2016</xref>), Darwin’s finches (<xref ref-type="bibr" rid="bib38">Lamichhaney et al., 2018</xref>), felids (<xref ref-type="bibr" rid="bib45">Li et al., 2016</xref>; <xref ref-type="bibr" rid="bib46">Li et al., 2019</xref>), canids (<xref ref-type="bibr" rid="bib23">Gopalakrishnan et al., 2018</xref>), horses (<xref ref-type="bibr" rid="bib30">Jónsson et al., 2014</xref>; <xref ref-type="bibr" rid="bib21">Gaunitz et al., 2018</xref>), living and extinct elephants (<xref ref-type="bibr" rid="bib56">Palkopoulou et al., 2018</xref>), cichlid fishes (<xref ref-type="bibr" rid="bib47">Malinsky et al., 2018</xref>), malaria mosquitoes (<xref ref-type="bibr" rid="bib20">Fontaine et al., 2015</xref>; <xref ref-type="bibr" rid="bib69">Small et al., 2020</xref>), <italic>Drosophila</italic> fruit flies (<xref ref-type="bibr" rid="bib71">Suvorov et al., 2022</xref>), sunflowers (<xref ref-type="bibr" rid="bib62">Rieseberg et al., 2003</xref>; <xref ref-type="bibr" rid="bib82">Whitney et al., 2010</xref>), maize (<xref ref-type="bibr" rid="bib10">Calfee et al., 2021</xref>), and yeast (<xref ref-type="bibr" rid="bib40">Leducq et al., 2016</xref>). Introgression is now widely recognized as an important process that can facilitate adaptation and speciation. While previous studies have confirmed the prevalence of gene flow, they give only a fragmented understanding of introgression because they mostly rely on approximate methods based on simple data summaries such as genome-wide site pattern counts or estimated gene trees. Those methods have limited power and cannot infer certain modes of gene flow or estimate most population parameters characterizing the process of species divergence and gene flow.</p><p>Recent advances make it possible to model genomic evolution under the multispecies coalescent (MSC) framework and use full-likelihood methods to estimate the species tree and quantify introgression (<xref ref-type="bibr" rid="bib81">Wen and Nakhleh, 2018</xref>; <xref ref-type="bibr" rid="bib86">Zhang et al., 2018</xref>; <xref ref-type="bibr" rid="bib18">Flouri et al., 2020</xref>). Analyses of both simulated and real data demonstrate that this full-likelihood MSC approach is efficient, accurate, and robust to moderate levels of model violation (<xref ref-type="bibr" rid="bib25">Huang et al., 2022</xref>; <xref ref-type="bibr" rid="bib75">Thawornwattana et al., 2023</xref>). A major advantage over approximate methods is the ability to estimate parameters of the species tree and introgression events among branches precisely, including the strength and direction of introgression as well as species divergence times, introgression times, and effective population sizes. Current approximate methods are mostly unable to estimate these parameters or infer gene flow between sister lineages (<xref ref-type="bibr" rid="bib29">Jiao et al., 2021</xref>; <xref ref-type="bibr" rid="bib53">Mirarab et al., 2021</xref>).</p><p>Neotropical butterflies of the genus <italic>Heliconius</italic> have become a model system for understanding introgression (<xref ref-type="bibr" rid="bib24">Heliconius Genome Consortium, 2012</xref>; <xref ref-type="bibr" rid="bib49">Martin et al., 2013</xref>; <xref ref-type="bibr" rid="bib35">Kozak et al., 2021</xref>; <xref ref-type="bibr" rid="bib11">Cicconardi et al., 2023</xref>). Previous phylogenomic studies have demonstrated introgression among closely related species, but investigations of gene flow deeper among lineages were only partially successful: the various different methods yielded different phylogenies and introgression scenarios (<xref ref-type="bibr" rid="bib35">Kozak et al., 2021</xref>; <xref ref-type="bibr" rid="bib11">Cicconardi et al., 2023</xref>), perhaps due to methodological artifcts.</p><p>Recently, we demonstrated deep-level introgression and hybrid speciation in the erato-sara clade of <italic>Heliconius</italic> (<xref ref-type="bibr" rid="bib14">Edelman et al., 2019</xref>; <xref ref-type="bibr" rid="bib74">Thawornwattana et al., 2022</xref>). Here, we focus on the more complex melpomene crown group, or ‘melpomene-silvaniform’ group, which includes the melpomene-cydno-timareta clade, and ‘silvaniform’ species that are mostly Müllerian mimics of Ithomiini models, together with the related <italic>Heliconius besckei</italic> and <italic>H. elevatus</italic> (<xref ref-type="bibr" rid="bib6">Brown, 1981</xref>). The melpomene-silvaniform species frequently hybridize today, and laboratory crosses demonstrate some interfertility across the entire group (<xref ref-type="bibr" rid="bib48">Mallet et al., 2007</xref>). Thus, extensive gene flow is likely, making estimation of the true species phylogeny difficult. We also examine the overall species divergence and deeper introgression history of the entire genus. By using full-likelihood analysis of whole-genome data, we overcome limitations of approximate methods to obtain a robust estimate of the species tree, with major introgression events between branches quantified in terms of direction, strength, and timing. We use subsets of species to represent each major clade and answer specific questions of introgression, which helps to keep the computation manageable. Our species phylogeny and introgression history provide a more parsimonious explanation for evolution of key traits in <italic>Heliconius</italic> than those previously inferred using approximate methods (<xref ref-type="bibr" rid="bib26">Jay et al., 2018</xref>; <xref ref-type="bibr" rid="bib35">Kozak et al., 2021</xref>; <xref ref-type="bibr" rid="bib11">Cicconardi et al., 2023</xref>). We find evidence of extensive autosomal gene flow across the melpomene-silvaniform group and show how trees based on the Z chromosome most likely represent the true species phylogeny. The so-called silvaniform species appear to be paraphyletic, contrary to previous findings based on approximate methods (<xref ref-type="bibr" rid="bib85">Zhang et al., 2016</xref>; <xref ref-type="bibr" rid="bib35">Kozak et al., 2021</xref>). As well as improving the understanding of diversification and gene flow in the genus <italic>Heliconius</italic>, we believe our approach provides useful pointers for studying species phylogeny with complex patterns of introgression in other taxa.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Ancestral gene flow at the base of <italic>Heliconius</italic> phylogeny</title><p>We first establish phylogenetic relationships among six major clades of <italic>Heliconius</italic> using blocks of 200 loci (well-spaced short segments) across the genome, with each block spanning 1–3 Mb. We select a representative species from each major clade (<italic>H. burneyi</italic>, <italic>H. doris</italic>, <italic>H. aoede, H. erato</italic>, <italic>H. sara</italic>), three species from the melpomene-silvaniform group (<italic>H. melpomene</italic>, <italic>H. besckei</italic>, <italic>H. numata</italic>), and one outgroup species (<italic>Eueides tales</italic>) (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a–c</xref>). Species tree search in each block was carried out under the MSC model using the Bayesian program <sc>bpp</sc> (see ‘Methods’). Although each block was assumed to lack gene flow, different trees in each block across the genome are likely to result from introgression. Unlike a windowed concatenated tree approach, our MSC method takes into account incomplete lineage sorting (ILS) and uncertainty in gene trees. Coding and noncoding loci were analyzed separately.</p><p>Two major patterns of species relationships were found at the base of the genus <italic>Heliconius</italic>: scenario 1 (<italic>erato-early</italic>), with the erato-sara clade diverging first, is supported by ~75% of genomic blocks, while scenario 2 (<italic>aoede-early</italic>), with <italic>H. aoede</italic> diverging first, is supported by ~20% of blocks (<xref ref-type="fig" rid="fig1">Figure 1A</xref>; see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1d</xref> for genome-level summaries and <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1e</xref> for chromosome-level summaries). Using a different reference genome or more stringent filtering yielded similar fractions of the same species trees across the genome (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1d–g</xref>). In both scenarios, there is uncertainty concerning (i) the branching order of <italic>H. doris</italic> and <italic>H. burneyi</italic>, with <italic>H. doris</italic> diverging first being the most common relationship in both scenarios, and (ii) the branching order within the melpomene-silvaniform clade, with both <italic>H. besckei + H. numata</italic> and <italic>H. melpomene + H. numata</italic> being nearly equally common across the genome (<xref ref-type="fig" rid="fig1">Figure 1B and C</xref>). To focus on the deep divergences, we constructed simplified summaries of inferred species trees with <italic>H. besckei, H. numata,</italic> and <italic>H. melpomene</italic> grouped together (‘BNM’ in <xref ref-type="fig" rid="fig1">Figure 1A</xref>; also see <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> and <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1d and e</xref>). Summaries of full species trees are provided in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> and <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1f and g</xref>; posterior probabilities of these local blockwise trees are generally low, with the median probability for each maximum a posteriori (MAP) tree &lt;0.7, reflecting both limited information from only 200 loci and the challenge of resolving short branches in the species trees.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Ancestral gene flow at the base of <italic>Heliconius</italic>.</title><p>(<bold>A</bold>) Posterior probabilities of species trees for major <italic>Heliconius</italic> clades inferred from <sc>bpp</sc> analysis of 200-locus blocks (each spanning 1–3 Mb) across the genome under the multispecies coalescent (MSC) model with no gene flow. The y-axis shows the posterior probability of species trees and ranges from 0 to 1. Colors correspond to the nine most common maximum a posteriori (MAP) trees, summarized by lumping species in the melpomene-silvaniform clade (Bes, Num, Mel) into a single tip (BNM); see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> for full trees. Proportions of coding and noncoding blocks with each tree as a MAP tree are shown in parentheses. (<bold>B, C</bold>) Two scenarios of early divergence of <italic>Heliconius</italic>: (<bold>B</bold>) erato-early versus (<bold>C</bold>) aoede-early. Each tree is a MAP tree from a block having the MAP tree supporting one of these scenarios, with estimates of branch lengths (posterior means). (<bold>D, E</bold>) Phylogenetic and introgression histories estimated under an MSC model with introgression (MSC-I) corresponding to the two scenarios based on coding loci in chromosome 1 (3517 coding loci; see <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplements 5</xref> and <xref ref-type="fig" rid="fig1s6">6</xref>). (<bold>F</bold>) Proportions of trees of scenarios 1 or 2 in each chromosome in order of increasing number of loci (used as a proxy for chromosome length). The Z chromosome (chr. 21) is placed at the right end. Number of blocks is shown on top of each bar. Tal: <italic>Eueides tales</italic>; Mel: <italic>H. melpomene</italic>; Bes: <italic>H. besckei</italic>; Num: <italic>H. numata</italic>; Bur: <italic>H. burneyi</italic>; Dor: <italic>H. doris</italic>; Aoe: <italic>H. aoede</italic>; Era: <italic>H. erato</italic>; Sar: <italic>H. sara</italic>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Posterior estimates of species trees from four versions of the 'etales-9spp' dataset (see ‘Methods’), using either <italic>H. erato</italic> (<bold>A</bold>, <bold>C</bold>) or <italic>H. melpomene</italic> (<bold>B</bold>, <bold>D</bold>) as a reference, and a read depth cutoff either 12 (<bold>A</bold>, <bold>B</bold>) or 20 (<bold>C</bold>, <bold>D</bold>).</title><p>See legend to <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Posterior estimates of species trees from four versions of the 'etales-9spp' dataset (see ‘Methods’), using either <italic>H. erato</italic> (<bold>A</bold>, <bold>C</bold>) or <italic>H. melpomene</italic> (<bold>B</bold>, <bold>D</bold>) as a reference, and a read depth cutoff either 12 (<bold>A</bold>, <bold>B</bold>) or 20 (<bold>C</bold>, <bold>D</bold>), with the clade containing three species (Bes, Num, Mel) in the melpomene-silvaniform clade collapsed as a single species.</title><p>See legend to <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Posterior means and 95% highest posterior density (HPD) intervals of introgression probabilities (<italic>φ</italic>), population sizes (<italic>θ</italic>), and divergence or introgression times (<italic>τ</italic>) under scenario 1 and scenario 2 multispecies coalescent model introgression (MSC-I) model in <xref ref-type="fig" rid="fig1">Figure 1D and E</xref> obtained from <sc>bpp</sc> analysis of the 'etales-8spp' dataset (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref> for the number of loci).</title><p>A few chromosomal regions (2a, 2b, 6b, 6c, 6d, 13b, 13c) yielded too few loci (&lt;100) and were excluded. Chromosome 21 is the sex (Z) chromosome.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig1-figsupp3-v1.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Posterior means and 95% HPD intervals of divergence times estimated under the multispecies coalescent with introgression (MSC-I) model of <xref ref-type="fig" rid="fig1">Figure 1D</xref> (erato-early, x-axis) versus estimates under the MSC-I model of <xref ref-type="fig" rid="fig1">Figure 1E</xref> (aoede-early, y-axis) using coding (<bold>A</bold>) or noncoding loci (<bold>B</bold>) of the 'etales-8spp' dataset.</title><p>Red points are divergence times unique to each model.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig1-figsupp4-v1.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 5.</label><caption><title>Posterior estimates of the species tree under the introgression model in <xref ref-type="fig" rid="fig1">Figure 1D</xref> (scenario 1: erato-early) obtained from <sc>bpp</sc> analysis of the 'etales-8spp' dataset for each chromosomal region.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig1-figsupp5-v1.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 6.</label><caption><title>Posterior estimates of the species tree under the introgression model in <xref ref-type="fig" rid="fig1">Figure 1E</xref> (scenario 2: aoede-early) obtained from <sc>bpp</sc> analysis of the 'etales-8spp' dataset for each chromosomal region.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig1-figsupp6-v1.tif"/></fig><fig id="fig1s7" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 7.</label><caption><title>Maximum likelihood estimates (MLEs) of all parameters in the MSC-M model as well as internal branch lengths (Δ<italic>τ</italic> = <italic>τ</italic><sub>0</sub> – <italic>τ</italic><sub>1</sub>) by chromosomal region for all pairs of <italic>Heliconius</italic> species in the 'etales-9spp' dataset obtained from <sc>3</sc>s analysis.</title><p>Error bars indicate two standard errors (not shown if standard errors were not reliably estimated). Columns are parameters in the model; rows are species pairs.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig1-figsupp7-v1.tif"/></fig></fig-group><p>Scenarios 1 and 2 are related via ancestral gene flow. If scenario 1 (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) represents the true species tree, gene flow between the erato-sara clade and the common ancestor of <italic>H. doris</italic>, <italic>H. burneyi,</italic> and the melpomene-silvaniform clade would lead to trees of scenario 2, with reduced estimated divergence time of the erato-sara clade. Similarly, if scenario 2 (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) is the true tree, gene flow between the aoede clade and the common ancestor of <italic>H. doris</italic>, <italic>H. burneyi,</italic> and the melpomene-silvaniform clade would lead to trees of scenario 1, with reduced estimated divergence time of <italic>H. aoede</italic>. This expected reduction in divergence time as a result of introgression is not apparent in our species tree estimates, partly due to a short internal branch separating <italic>H. aoede</italic> and the erato-sara clade in both scenarios (<xref ref-type="fig" rid="fig1">Figure 1B and C</xref>). To assess which scenario fits the data better, we calculated the Bayes factor under the MSC model with introgression (MSC-I) implemented in <sc>bpp</sc>, with <italic>H. besckei</italic> excluded to simplify the model (<xref ref-type="fig" rid="fig1">Figure 1D and E</xref>; 'etales-8spp' dataset in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>). The Bayes factor provides mixed evidence, with different chromosomes either strongly supporting alternative scenarios or not significant at 1% level; however, the Z chromosome supports scenario 2 (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1h</xref>). In scenario 2, divergence of <italic>H. aoede</italic> was estimated to be older than that of the erato-sara clade in scenario 1 while root age estimates were comparable, further supporting the hypothesis that <italic>H. aoede</italic> most likely diverged before the erato-sara clade (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplements 3</xref> and <xref ref-type="fig" rid="fig1s4">4</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1i and j</xref>). This is because younger divergence may be explained by introgression whereas older divergence more likely represents true time of divergence. In scenario 2, introgression from the doris-burneyi-melpomene clade was estimated as unidirectional into <italic>H. aoede</italic> with a high probability (~75%), occurring shortly before the divergence of <italic>H. doris</italic> (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplements 3</xref> and <xref ref-type="fig" rid="fig1s6">6</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1j</xref>). Surprisingly, under scenario 1 we also find strong unidirectional introgression into the erato-sara clade with a high introgression probability (~65%) (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplements 3</xref> and <xref ref-type="fig" rid="fig1s5">5</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1i</xref>).</p><p>Two additional pieces of evidence support scenario 2. First, species trees of scenario 2 are most common in the Z chromosome (chr. 21) and tend to be more common in longer chromosomes, which have lower recombination rates per base pair (<xref ref-type="fig" rid="fig1">Figure 1F</xref>). Conversely, species trees of scenario 1 are more common in shorter chromosomes, which have higher recombination rates. If we assume that regions of low recombination tend to exhibit less introgression, with the Z chromosome usually most resistant to gene flow in <italic>Heliconius</italic> (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>, <xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1k</xref>), as suggested by previous studies (<xref ref-type="bibr" rid="bib14">Edelman et al., 2019</xref>; <xref ref-type="bibr" rid="bib50">Martin et al., 2019</xref>), the association of species trees of scenario 2 with regions of low recombination suggests that scenario 2 more likely represents the true species relationships, whereas scenario 1 is a result of introgression. Second, we obtain a star tree whenever <italic>H. erato</italic> is assumed to diverge before <italic>H. aoede</italic> (scenario 1) under the MSC-with-migration (MSC-M or isolation-with-migration; IM) model of three species that allows for gene flow between two ingroup species since their divergence but does not allow gene flow with the outgroup species (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>). Star trees are commonly observed when the assumed bifurcating tree is incorrect (<xref ref-type="bibr" rid="bib12">Dalquen et al., 2017</xref>). By contrast, assuming <italic>H. aoede</italic> diverges before <italic>H. erato</italic> (scenario 2) always leads to a bifurcating tree.</p><p>Four small inversion regions (~100–400 kb) had been identified previously to be differentially fixed between the melpomene group and the erato-sara clade (<xref ref-type="bibr" rid="bib67">Seixas et al., 2021</xref>): 2b, 6b, 6c, 13b, and 21b. We were able to extract only a small number of loci (&lt;100; see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref>) from each region. While species tree estimates are more uncertain (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1d–g</xref>), the 13b region (~360 kb with respect to <italic>H. erato demophoon</italic> reference) consistently shows a unique pattern in which <italic>H. doris</italic> and <italic>H. burneyi</italic> cluster with the erato-sara clade instead of the melpomene-silvaniform clade. This suggests ancient introgression of the inversion from the erato-sara clade into <italic>H. doris</italic> and <italic>H. burneyi</italic> (<xref ref-type="bibr" rid="bib67">Seixas et al., 2021</xref>).</p><p>In conclusion, we detect some hitherto unrecognized introgression among the deepest branches within <italic>Heliconius</italic> sensu lato. The aoede-early scenario coupled with these deep introgression events may have led to some of the morphological and ecological evidence previously used in support of the erection the subgenera <italic>Neruda</italic> (for <italic>H. aoede</italic> and allies [<xref ref-type="bibr" rid="bib77">Turner, 1976</xref>]) as well as <italic>Laparus</italic> (for <italic>H. doris</italic> [<xref ref-type="bibr" rid="bib76">Turner, 1968</xref>]) that appeared to conflict with more recent molecular genetic data.</p></sec><sec id="s2-2"><title>Major introgression patterns in the melpomene-silvaniform clade</title><p>We next focus more closely on the melpomene-silvaniform clade (including <italic>H. besckei</italic>, <italic>H. numata,</italic> and <italic>H. melpomene</italic>, represented by ‘BNM’ in <xref ref-type="fig" rid="fig1">Figure 1A</xref>). This is one of the most phylogenetically difficult groups of <italic>Heliconius</italic> due to ongoing hybridization and extensive gene flow involving most members of the group (<xref ref-type="bibr" rid="bib48">Mallet et al., 2007</xref>). Previous studies have inferred conflicting introgression scenarios in this clade (<xref ref-type="bibr" rid="bib49">Martin et al., 2013</xref>; <xref ref-type="bibr" rid="bib85">Zhang et al., 2016</xref>; <xref ref-type="bibr" rid="bib26">Jay et al., 2018</xref>; <xref ref-type="bibr" rid="bib14">Edelman et al., 2019</xref>; <xref ref-type="bibr" rid="bib11">Cicconardi et al., 2023</xref>). We compiled a multilocus dataset from high-quality genomic data comprising eight (out of 15) species representing all major lineages within the clade: <italic>H. melpomene, H. cydno, H. timareta, H. besckei, H. numata, H. hecale, H. elevatus,</italic> and <italic>H. pardalinus</italic> (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1l</xref>). Our analysis below confirms widespread introgression within this clade.</p><p>We identify four major species relationships from blockwise estimates of species trees under the MSC model without gene flow (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1m and n</xref>): (a) autosome-majority (trees 1–3), (b) autosome-variant (trees 5–7), (c) the Z chromosome (chr. 21; tree 4), and (d) chromosome 15 inversion region (15b; tree 24). The pattern is highly similar between coding and noncoding loci. The first three relationships (trees 1–9) account for &gt;90% of the blocks, with a well-supported pardalinus-hecale clade ((<italic>H. pardalinus</italic>, <italic>H. elevatus</italic>), <italic>H. hecale</italic>) and a cydno-melpomene clade ((<italic>H. timareta, H. cydno</italic>), <italic>H. melpomene</italic>). They differ in the position of <italic>H. numata</italic> and in the relationships among the three species in the cydno-melpomene clade. We first focus on the three scenarios relating to different positions of <italic>H. numata</italic>: (a) <italic>H. numata</italic> sister to the pardalinus-hecale clade + the cydno-melpomene clade, (b) <italic>H. numata</italic> sister to the pardalinus-hecale clade, and (c) <italic>H. numata</italic> sister to <italic>H. besckei</italic>. The Z-chromosome tree (i.e. tree 4 in scenario c) is the MAP tree with a high posterior probability in almost all blocks of the Z chromosome (median probability of 1; <xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1m</xref>), with <italic>H. besckei + H. numata</italic> diverging first, followed by a split between the pardalinus-hecale clade and the cydno-melpomene clade. A similar distinction between the autosome-majority trees and the Z-chromosome tree was also found by <xref ref-type="bibr" rid="bib85">Zhang et al., 2016</xref>. All four scenarios a–d confirm paraphyly of the silvaniform species (<italic>H. besckei</italic>, <italic>H. numata,</italic> and the pardalinus-hecale clade), consistent with some recent phylogenomic studies (<xref ref-type="bibr" rid="bib85">Zhang et al., 2016</xref>; <xref ref-type="bibr" rid="bib51">Massardo et al., 2020</xref>; <xref ref-type="bibr" rid="bib11">Cicconardi et al., 2023</xref>). Monophyly of the silvaniforms was suggested in concatenation/sliding-window analysis (<xref ref-type="bibr" rid="bib24">Heliconius Genome Consortium, 2012</xref>; <xref ref-type="bibr" rid="bib34">Kozak et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Kozak et al., 2021</xref>; <xref ref-type="bibr" rid="bib87">Zhang et al., 2021</xref>), but this conclusion may suffer from a failure to account for deep coalescence (<xref ref-type="bibr" rid="bib15">Edwards et al., 2016</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Major introgression events in the melpomene-silvaniform clade.</title><p>(<bold>A</bold>) Blockwise estimates of species trees of the melpomene-silvaniform clade inferred from 200-locus blocks across the genome under the multispecies coalescent (MSC) model with no gene flow using <sc>bpp</sc> (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1l</xref> for data, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1m and n</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> for full results). Maximum a posteriori (MAP) trees are labeled in decreasing order of frequency among blocks. Proportions of coding and noncoding blocks with each tree as a MAP tree are shown in parentheses. (<bold>B</bold>) The multispecies coalescent with introgression (MSC-I) model events that can explain the three major groups of trees in (<bold>A</bold>). Branch lengths are based on posterior means of divergence/introgression times estimated from 5341 noncoding loci on chromosome 1 (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q</xref>). Each internal node is given a label, which is used to refer to a population above the node, for example, the population between nodes r and bn is referred to as branch bn. Each horizontal arrow represents a unidirectional introgression event, for example, the arrow from tcmeph1 to n3 represents tcmeph→Num introgression at time <italic>τ</italic><sub>tcmeph1</sub> = <italic>τ</italic><sub>n3</sub> with probability <italic>φ</italic><sub>tcmeph1→n3</sub>. (<bold>C</bold>) Continuous migration (IM) model for the pardalinus-hecale clade, allowing bidirectional gene flow among the three species. (<bold>D</bold>) Multispecies coalescent with migration (MSC-M) model for the cydno-melpomene clade. For (<bold>C</bold>) and (<bold>D</bold>), branch lengths are based on estimates from noncoding loci in chromosome 1 (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1s–u</xref>), and arrow sizes are proportional to estimated migration rate (<italic>M</italic> = <italic>Nm</italic>). Bes: <italic>H. besckei</italic>; Num: <italic>H. numata</italic>; Par: <italic>H. pardalinus</italic>; Ele: <italic>H. elevatus</italic>; Hec: <italic>H. hecale</italic>; Tim: <italic>H. timareta</italic>; Cyd: <italic>H. cydno</italic>; Mel: <italic>H. melpomene</italic>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Posterior estimates of species trees of the melpomene-silvaniform clade inferred from 200-locus blocks across the genome from the <sc>bpp</sc> multispecies coalescent (MSC) analysis with no gene flow of the 'hmelv25-res' dataset.</title><p><xref ref-type="fig" rid="fig2">Figure 2A</xref> shows a simplified version with fewer trees. See <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1m and n</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Maximum likelihood estimates (MLEs) of all parameters in the multispecies coalescent with migration (MSC-M) model as well as internal branch lengths (Δ<italic>τ</italic> = <italic>τ</italic><sub>0</sub> – <italic>τ</italic><sub>1</sub>) by chromosomal region from species pairs in the 'hmelv25-all' dataset obtained from <sc>3</sc>s analysis using (<bold>A</bold>) <italic>H</italic>. <italic>aoede</italic> or (<bold>B</bold>) <italic>H. erato</italic> as an outgroup.</title><p>Error bars indicate two standard errors (not shown if standard errors were not reliably estimated). Columns are parameters in the model; rows are species pairs. Full results are in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1o and p</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Estimated introgression history.</title><p>Estimated introgression history for each chromosomal region obtained under the model of <xref ref-type="fig" rid="fig2">Figure 2B</xref> and <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4D</xref> using (<bold>A</bold>) noncoding and (<bold>B</bold>) coding loci. Intensity of the horizontal edges is proportional to posterior mean of introgression probability, while the y-axis represents the divergence times in the units of the expected number of mutations per site. For posterior estimates of all parameters, see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q and r</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Posterior means and 95% HPD intervals of (<bold>A</bold>) introgression probabilities, (<bold>B</bold>) divergence or introgression times (<italic>τ</italic>), and (<bold>C</bold>) population sizes (<italic>θ</italic>) under the multispecies coalescent with introgression (MSC-I) model of <xref ref-type="fig" rid="fig2">Figure 2B</xref> using coding (blue) and noncoding data (yellow).</title><p>'main' (circle) is the main posterior peak; 'alt' (triangle) is an alternative posterior peak.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig2-figsupp4-v1.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Posterior means and 95% HPD intervals of species divergence and introgression times (<italic>τ</italic>) obtained from coding loci (<italic>y</italic>-axis) versus noncoding loci (<italic>x</italic>-axis) under the multispecies coalescent with introgression (MSC-I) models of <xref ref-type="fig" rid="fig2">Figure 2B</xref> (for chromosomal regions other than 15b) and of (<bold>D</bold>) (for 15b).</title><p>We used the divergence times (black points) only to fit a regression line <italic>y</italic> = <italic>c</italic> x. For the number of loci used, see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1l</xref> or <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig2-figsupp5-v1.tif"/></fig><fig id="fig2s6" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 6.</label><caption><title>Posterior means and 95% HPD intervals of migration rates (M), divergence times (<italic>τ</italic>), and population sizes (<italic>θ</italic>) under the multispecies coalescent with migration (MSC-M) model in three species obtained using <sc>bpp</sc>.</title><p>(<bold>A</bold>) Pardalinus-hecale clade: ((Par, Ele), Hec). (<bold>B</bold>) Pardalinus-elevatus clade: (Par, Ele), assuming all three populations have the same size <italic>θ</italic>. (<bold>C</bold>) Cydno-melpomene clade: ((Tim, Cyd), Mel). Full results for these three models are given in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1s–u</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig2-figsupp6-v1.tif"/></fig></fig-group><p>Our species tree search under the MSC (<xref ref-type="fig" rid="fig1">Figures 1A</xref> and <xref ref-type="fig" rid="fig2">2A</xref>) accounts for ILS but does not account for gene flow. To approximate a fuller introgression history of this group, we construct a species tree model with introgression that can explain the four scenarios above. We use estimates of migration rates between each pair of species under the MSC-with-migration (MSC-M or IM) model of species triplets (<sc>3</sc>s analysis) to inform placement of introgression edges (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref> , <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Our proposed model has six pairs of bidirectional introgression events (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). We use the Z-chromosome tree (tree 4) as the backbone that most likely represents the true species tree, while conflicting trees result from historical introgression. Tree 4 is largely limited to the Z chromosome, which appears more resistant to gene flow in <italic>Heliconius</italic> (<xref ref-type="bibr" rid="bib85">Zhang et al., 2016</xref>; <xref ref-type="bibr" rid="bib79">Van Belleghem et al., 2018</xref>; <xref ref-type="bibr" rid="bib50">Martin et al., 2019</xref>; <xref ref-type="bibr" rid="bib51">Massardo et al., 2020</xref>; <xref ref-type="bibr" rid="bib74">Thawornwattana et al., 2022</xref>). Consistent with this interpretation, we find no evidence of gene flow in the Z chromosome and high prevalence of gene flow on the autosomes based on the <sc>3</sc>s analysis (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref> , <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1o and p</xref>). Thus, we include two introgression events (between nodes n3–tcmeph1 and n2–eph1 in <xref ref-type="fig" rid="fig2">Figure 2B</xref>) to explain alternative positions of <italic>H. numata</italic> in the autosomes (scenarios a and b). Next, to explain the secondary source of genealogical variation within the cydno-melpomene clades (i.e. among trees 1–3, trees 4/8/9 and trees 5–7), we add two further introgression events between <italic>H. melpomene</italic> and <italic>H. cydno</italic> (m1–c1), and between <italic>H. melpomene</italic> and <italic>H. timareta</italic> (m2–t1). We do not model <italic>H. cydno–H. timareta</italic> introgression (these species are allopatric). We also include introgression between <italic>H. besckei</italic> and <italic>H. numata</italic> (b1–n1) to relate the autosome trees to the Z-chromosome tree. Finally, sister species <italic>H. pardalinus</italic> and <italic>H. elevatus</italic> hybridize today in sympatric populations (<xref ref-type="bibr" rid="bib65">Rosser et al., 2019</xref>), so we allow introgression between them (p1–e1). According to the <sc>3</sc>s analysis, the rates of gene flow in this pair are among the highest (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). This sister-species introgression does not alter species trees (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) because it does not change the topology.</p><p>The resultant MSC-I model is used to estimate species divergence times and effective population sizes for extant and ancestral species, and the intensity, timing, and direction of introgression. Consistent with scenario c representing the true species tree, we find least introgression on the Z chromosome (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplements 3</xref> and <xref ref-type="fig" rid="fig2s4">4</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q and r</xref>). On the autosomes, there is substantial introgression from the pardalinus-hecale + cydno-melpomene clade into <italic>H. numata</italic>, and to a lesser extent, between <italic>H. numata</italic> and the pardalinus-hecale clade. These patterns match well with the frequencies of the two main autosomal relationships (scenarios a and b in <xref ref-type="fig" rid="fig2">Figure 2</xref>). Within the cydno-melpomene clade, introgression is predominantly unidirectional from <italic>H. cydno</italic> and <italic>H. timareta</italic> into <italic>H. melpomene</italic>. The <italic>H. pardalinus–H. elevatus</italic> pair shows ongoing extensive but variable introgression across the genome, with the introgression time estimated to be zero. See Appendix 1, section ‘Major introgression patterns in the melpomene-silvaniform clade inferred using 3s and BPP<italic>'</italic> for more details.</p><p>The age of the melpomene-silvaniform clade (<italic>τ</italic><sub>r</sub>) is estimated to be ~0.020 substitutions per site based on noncoding data (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q</xref>). This translates to ~1.7 (CI: 0.9, 3.8) million years ago (Ma), assuming a neutral mutation rate of 2.9 × 10<sup>–9</sup> per site per generation (95% CI: 1.3 × 10<sup>–9</sup>, 5.5 × 10<sup>–9</sup>) and four generations per year (<xref ref-type="bibr" rid="bib33">Keightley et al., 2015</xref>). This is not very different from a previous estimate of 3.7 (CI: 3.2, 4.3) Ma based on molecular clock dating (<xref ref-type="bibr" rid="bib34">Kozak et al., 2015</xref>), which ignores ancestral polymorphism and is therefore expected to overestimate divergence time. Overall, our estimates of species divergence time tend to be precise and highly similar across the genome (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplements 3</xref> and <xref ref-type="fig" rid="fig2s4">4</xref>). The posterior means from coding and noncoding loci are strongly correlated, with <italic>τ</italic><sub>C</sub> ≈ <italic>bτ</italic><sub>NC</sub> where <italic>b</italic> varies between 0.4 and 0.6 (<italic>r</italic><sup>2</sup> &gt; 0.95) in most chromosomal regions (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>). The scale factor of <italic>b</italic> &lt; 1 can be explained by purifying selection removing deleterious nonsynonymous mutations in coding regions of the genome (<xref ref-type="bibr" rid="bib68">Shi and Yang, 2018</xref>). Present-day and ancestral population sizes (<italic>θ</italic>) are of the order of 0.01 (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4B</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q and r</xref>). For inbred individuals (chosen for sequencing to facilitate genome assembly) among our genomic data (<italic>H. melpomene</italic>, <italic>H. timareta</italic>, <italic>H. numata,</italic> and <italic>H. pardalinus</italic>; see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>), <italic>θ</italic> estimates vary among chromosomes by orders of magnitude, with the inbred genome of <italic>H. melpomene</italic> having the lowest population size of ~0.002–0.004 on average. Adding more individuals should help stabilize estimates of <italic>θ</italic>, but should not affect estimates of age or introgression rates.</p><p>The introgression model of <xref ref-type="fig" rid="fig2">Figure 2B</xref> assumes that gene flow occurs in single pulses. This may be unrealistic if gene flow is ongoing. We thus employ the MSC-M model implemented in <sc>bpp</sc> to estimate migration rates (<italic>M</italic> = <italic>Nm</italic>) between all pairs of species in each of the pardalinus-hecale and cydno-melpomene clades (<xref ref-type="fig" rid="fig2">Figure 2C and D</xref>)<sc>.</sc> The MSC-M model assumes continuous gene flow since lineage divergence at the rate of <italic>M</italic> migrants per generation (<xref ref-type="bibr" rid="bib19">Flouri et al., 2023</xref>). The results concur with the introgression pulse model in suggesting high gene flow between <italic>H. pardalinus</italic> and <italic>H. elevatus</italic> (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6A and B</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1s</xref>). There is also evidence of gene flow between <italic>H. hecale</italic> and <italic>H. pardalinus</italic>/<italic>H. elevatus</italic> at lower levels, with <italic>M</italic> &lt; 0.1 in most chromosomes (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6A</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1s</xref>). Allowing for continuous gene flow as well as gene flow involving <italic>H. hecale</italic>, we obtain slightly older estimates of both species divergence times (between <italic>H. pardalinus</italic> and <italic>H. elevatus</italic>, and between <italic>H. hecale</italic> and <italic>H. pardalinus + H. elevatus</italic>) (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6A</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1s</xref>), than under the single-pulse introgression model (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q and r</xref>). The cydno-melpomene clade shows a similar pattern of older divergence times with substantial gene flow between all three species although at smaller magnitudes (<italic>M</italic> ~0.01–0.1) (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6C</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1u</xref>). For more discussion of parameter estimates, see ‘Appendix 1,’ section <italic>'</italic>MSC-M model for pardalinus-hecale and cydno-melpomene clades.<italic>'</italic> We conclude that a model with continuous gene flow involving all three species may better describe the history of both the pardalinus-hecale clade and the cydno-melpomene clade.</p><p>In summary, we have identified substantial gene flow within the cydno-melpomene and pardalinus-hecale clades based on both pulse introgression (MSC-I) and continuous migration (MSC-M) models (<xref ref-type="fig" rid="fig2">Figure 2C and D</xref>,, <xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q–u</xref>). Earlier genomic studies failed to quantify the intensity of gene flow (introgression probability or migration rate) or infer direction and timing of gene flow. Gene flow within the cydno-melpomene clade has been extensively studied at population/subspecies levels and at specific loci involved in wing pattern mimicry (<xref ref-type="bibr" rid="bib8">Bull et al., 2006</xref>; <xref ref-type="bibr" rid="bib57">Pardo-Diaz et al., 2012</xref>; <xref ref-type="bibr" rid="bib36">Kronforst et al., 2013</xref>; <xref ref-type="bibr" rid="bib49">Martin et al., 2013</xref>; <xref ref-type="bibr" rid="bib80">Wallbank et al., 2016</xref>; <xref ref-type="bibr" rid="bib16">Enciso-Romero et al., 2017</xref>; <xref ref-type="bibr" rid="bib50">Martin et al., 2019</xref>), but gene flow involving other species has received less attention (<xref ref-type="bibr" rid="bib24">Heliconius Genome Consortium, 2012</xref>; <xref ref-type="bibr" rid="bib80">Wallbank et al., 2016</xref>; <xref ref-type="bibr" rid="bib85">Zhang et al., 2016</xref>; <xref ref-type="bibr" rid="bib26">Jay et al., 2018</xref>).</p></sec><sec id="s2-3"><title>Complex introgression in the 15b inversion region (P locus)</title><p>A polymorphic series of tandem inversions on chromosome 15 is involved in switching mimicry color pattern in <italic>H. numata</italic> (<xref ref-type="bibr" rid="bib26">Jay et al., 2018</xref>; <xref ref-type="bibr" rid="bib28">Jay et al., 2022</xref>). The first inversion, P<sub>1</sub> (~400 kb), is in the 15b region (also called the <italic>P</italic> locus), and is fixed in <italic>H. pardalinus</italic> and retained as a polymorphism in <italic>H. numata</italic> (<xref ref-type="bibr" rid="bib32">Joron et al., 2011</xref>; <xref ref-type="bibr" rid="bib41">Le Poul et al., 2014</xref>; <xref ref-type="bibr" rid="bib26">Jay et al., 2018</xref>). Multiple introgression events are necessary to make the 15b tree (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, scenario d, tree 24) compatible with either the Z chromosome tree or the autosomal trees (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, scenarios a–c), suggesting a much more complex introgression history of this region than in the rest of the genome. This inversion contains the known wing patterning locus <italic>cortex</italic> (<xref ref-type="bibr" rid="bib28">Jay et al., 2022</xref>), where it is maintained as a balanced polymorphism by natural selection (<xref ref-type="bibr" rid="bib31">Joron et al., 2006</xref>; <xref ref-type="bibr" rid="bib55">Nadeau et al., 2016</xref>; <xref ref-type="bibr" rid="bib78">Van Belleghem et al., 2017</xref>). Another feature of this 15b region is that among the species without the inversion, the cydno-melpomene clade clusters with <italic>H. elevatus</italic> and is nested within the pardalinus-hecale clade (without <italic>H. pardalinus</italic>). This is contrary to the expectation based on the topologies in the rest of the genome (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, scenarios a–c) that the cydno-melpomene clade would be sister to the pardalinus-hecale clade (without <italic>H. pardalinus</italic>). One explanation for this pattern is that introgression occurred between the common ancestor of the cydno-melpomene clade and either <italic>H. elevatus</italic> or the common ancestor of <italic>H. elevatus</italic> and <italic>H. pardalinus</italic> together with a total replacement of the non-inverted 15b in <italic>H. pardalinus</italic> by the P<sub>1</sub> inversion from <italic>H. numata</italic> (<xref ref-type="bibr" rid="bib26">Jay et al., 2018</xref>). We confirm and quantify this introgression below.</p><p>Using data from additional species (’silv_chr15' dataset in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>; see ‘Methods’), we obtain a better resolution of species relationships along chromosome 15, although with some uncertainty within the inversion region due to small numbers of loci (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1v</xref>). This analysis of independent data agrees with the Z chromosome tree (tree 24 in <xref ref-type="fig" rid="fig2">Figure 2A</xref>) and with (unrooted) trees obtained from concatenation analysis by <xref ref-type="bibr" rid="bib26">Jay et al., 2018</xref> (their Figures 2 and S1) and <xref ref-type="bibr" rid="bib27">Jay et al., 2021</xref> (their Figure S4), where <italic>H. numata</italic> with the inversion groups with <italic>H. pardalinus</italic> while <italic>H. numata</italic> without the inversion groups with its sister species, <italic>H. ismenius</italic> (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, red trees). Outside the inversion region, <italic>H. numata</italic> with both inversion genotypes groups with <italic>H. ismenius</italic> as expected (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, blue trees). Although this conclusion assumes that <italic>H. numata</italic> and <italic>H. ismenius</italic> are sister species while <italic>H. ismenius</italic> is not included in our species tree analysis of the melpomene-silvaniform clade (<xref ref-type="fig" rid="fig2">Figure 2</xref>), this sister relationship agrees with previous genomic studies of the autosomes and the sex chromosome (<xref ref-type="bibr" rid="bib85">Zhang et al., 2016</xref>; <xref ref-type="bibr" rid="bib27">Jay et al., 2021</xref>; <xref ref-type="bibr" rid="bib11">Cicconardi et al., 2023</xref>; <xref ref-type="bibr" rid="bib66">Rougemont et al., 2023</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Introgression history of the chromosome 15 inversion region (15b).</title><p>(<bold>A</bold>) Blockwise estimates of species trees for the inversion (15b) and the remnant flanking regions (15a and 15c) of chromosome 15. Trees were inferred from 200-locus blocks and 100-locus blocks under the multispecies coalescent (MSC) model without gene flow using <sc>bpp</sc> (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1v</xref>). Tree legends are grouped by whether <italic>H. numata</italic> clusters with <italic>H. ismenius</italic> (blue), or <italic>H. numata</italic> with P<sub>1</sub> inversion (Num11) clusters with <italic>H. pardalinus</italic> (red), or other relationships (green). (<bold>B–E</bold>) Four possible scenarios of the origin and introgression route of the P<sub>1</sub> inversion. Star indicates the origin of the P<sub>1</sub> inversion. Green lineages have the inversion, and green arrows indicates introgression of the inversion. Ism: <italic>H. ismenius</italic>; Num00: <italic>H. numata</italic> homozygous uninverted 15b (<italic>H. n. laura</italic> and <italic>H. n. silvana</italic>); Num11: <italic>H. numata</italic> homozygous for inversion P<sub>1</sub> (<italic>H. n. bicoloratus</italic>); Eth: <italic>H. ethilla</italic>. See <xref ref-type="fig" rid="fig2">Figure 2</xref> legend for codes for other species. For the direction of melpomene-cydno clade→<italic>H. elevatus</italic>, see <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Mean heterozygosity per site of the 15b inversion region and flanking regions (15a and 15c) of <italic>H</italic>. <italic>numata</italic> (Num) and <italic>H. pardalinus</italic> (Par) individuals.</title><p>Both individuals are homozygotes for the P<sub>1</sub> inversion.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Posterior estimates of divergence time for (Ism, Num00) and (Par, Num11) in the 15b region.</title><p>Only estimates from trees with posterior probabilities &gt;0.1 are shown. Trees are in order of decreasing frequency among coding or noncoding data. See legend to <xref ref-type="fig" rid="fig3">Figure 3</xref> for full species names.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig3-figsupp2-v1.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Estimated introgression history under five introgression models (m1–m5) of the 15b region.</title><p>Posterior estimates of all parameters under each model are in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1w</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig3-figsupp3-v1.tif"/></fig></fig-group><p>Given that <italic>H. numata</italic> is an early-diverging lineage of the melpomene-silvaniform clade (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) and is polymorphic for P<sub>1</sub> over large parts of its geographic distribution while <italic>H. pardalinus</italic> is fixed for this inversion (<xref ref-type="bibr" rid="bib32">Joron et al., 2011</xref>; <xref ref-type="bibr" rid="bib28">Jay et al., 2022</xref>), one parsimonious explanation is that the inversion originated either in <italic>H. numata</italic> after diverging from <italic>H. ismenius</italic>, or before the <italic>H. numata–H. ismenius</italic> split but was subsequently lost in <italic>H. ismenius</italic>, followed by introgression which introduced the inversion from <italic>H. numata</italic> into <italic>H. pardalinus</italic>, either before or after its divergence from <italic>H. elevatus</italic> (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). If the introgression occurred before <italic>H. pardalinus–H. elevatus</italic> divergence, the lack of the inversion in <italic>H. elevatus</italic> can be explained by another introgression from the cydno-melpomene clade into <italic>H. elevatus</italic>, completely replacing the inversion with the original orientation (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). This introgression route is reported in previous genomic studies, including at a different locus (<italic>optix</italic> gene, also involved in color pattern) in chromosome 18 as well as in the 15b region of chromosome 15 (<xref ref-type="bibr" rid="bib24">Heliconius Genome Consortium, 2012</xref>; <xref ref-type="bibr" rid="bib80">Wallbank et al., 2016</xref>). Under this scenario, we might expect the 15b region to be less diverse in <italic>H. pardalinus</italic> (recipient of P<sub>1</sub>) than in <italic>H. numata</italic> (donor of P<sub>1</sub>), with the magnitude depending on the duration between the origin of P<sub>1</sub> and introgression into <italic>H. pardalinus</italic>. However, we do not see this reduced heterozygosity in our data (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>), suggesting that the transfer likely occurred early, shortly after the formation of the inversion in <italic>H. numata</italic>, or shortly after the <italic>H. numata–H. ismenius</italic> split if the inversion originated earlier. This scenario is further supported by the 15b tree having similar times of divergence between <italic>H. ismenius</italic> and <italic>H. numata</italic> without the inversion, and between <italic>H. pardalinus</italic> and <italic>H. numata</italic> with the inversion (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). The topology of the 15b tree (<xref ref-type="fig" rid="fig2">Figures 2A</xref> and <xref ref-type="fig" rid="fig3">3A</xref>) also indicates that the first split is between species with the inversion (<italic>H. numata</italic> and <italic>H. pardalinus</italic>) and those without the inversion. This suggests another possibility: inversion polymorphism could have existed earlier in the history of the melpomene-silvaniform clade but was subsequently lost in most species (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). In this scenario, the ancestral polymorphism is maintained in <italic>H. numata</italic> while the inversion is fixed in <italic>H. pardalinus</italic> but is lost in other species. Introgression between <italic>H. numata</italic> and <italic>H. pardalinus</italic> is not required but could still occur.</p><p>To reconcile the introgression history of 15b with the overall species tree, we add three additional bidirectional introgression events onto the main model in <xref ref-type="fig" rid="fig2">Figure 2B</xref> and assess their plausibility using <sc>bpp</sc>. We allow for (i) bidirectional introgression between the cydno-melpomene clade into <italic>H. elevatus</italic>, (ii) bidirectional introgression between <italic>H. numata</italic> and <italic>H. pardalinus</italic>, and (iii) introgression between <italic>H. besckei</italic> and the common ancestor of the cydno-melpomene + pardalinus-hecale clade (to account for <italic>H. besckei</italic> being clustered with other species that do not have the inversion; see <xref ref-type="fig" rid="fig2">Figure 2A</xref>). We consider five models (m1–m5) differing in the placements of introgression events (i) and (ii) either before or after the <italic>H. pardalinus–H elevatus</italic> split (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). Our results best support unidirectional introgression from <italic>H. numata</italic> into the common ancestor of <italic>H. pardalinus</italic> and <italic>H. elevatus</italic>, and from the common ancestor of the cydno-melpomene clade into <italic>H. elevatus</italic> shortly after its divergence from <italic>H. pardalinus</italic> (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>, model m3). In other scenarios, estimated introgression times tend to collapse onto the <italic>H. pardalinus–H elevatus</italic> divergence time, suggesting that the introgression events were likely misplaced (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1w</xref>). Our finding that divergence of <italic>H. elevatus</italic> and introgression from the cydno-melpomene clade occurred almost simultaneously provides evidence for a hybrid speciation origin of <italic>H. elevatus</italic> resulting from introgression between <italic>H. pardalinus</italic> and the common ancestor of the cydno-melpomene clade (<xref ref-type="bibr" rid="bib65">Rosser et al., 2019</xref>).</p><p>In an alternative scenario proposed by <xref ref-type="bibr" rid="bib26">Jay et al., 2018</xref>, the inversion first originated in the common ancestor of <italic>H. pardalinus</italic> and <italic>H elevatus</italic>, and subsequently introgressed into some subspecies of <italic>H. numata</italic>, while the inversion in <italic>H. elevatus</italic> was completely replaced by introgression from the cydno-melpomene clade (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). They used sliding-window gene tree topologies to support introgression of the inversion from <italic>H. pardalinus</italic> to <italic>H. numata</italic> shortly after its formation in the common ancestor of <italic>H. pardalinus</italic> and <italic>H elevatus</italic> (their Figures 4 and S4). By including <italic>H. ismenius</italic> and <italic>H. elevatus</italic>, sister species of <italic>H. numata</italic> and <italic>H. pardalinus,</italic> respectively, different directions of introgression should lead to different gene tree topologies. Clustering of (<italic>H. numata</italic> with the inversion, <italic>H. pardalinus</italic>) with <italic>H. numata</italic> without the inversion would suggest the introgression is <italic>H. numata</italic> → <italic>H. pardalinus</italic> while clustering of (<italic>H. numata</italic> with the inversion, <italic>H. pardalinus</italic>) with <italic>H. elevatus</italic> would suggest <italic>H. pardalinus</italic> → <italic>H. numata</italic> introgression. However, tree topologies supporting each direction of introgression were almost equally common within the inversion region, particularly in the first half of the inversion, undermining this argument. With high levels of ILS and introgression in the group, estimated gene trees need not reflect the true species relationships. Another variant of this scenario is that the inversion originated in <italic>H. pardalinus</italic> after its divergence from <italic>H. elevatus</italic> and was introgressed into some subspecies of <italic>H. numata</italic> (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). We consider this scenario unlikely because the inversion appears to originated long before the <italic>H. pardalinus–H. elevatus</italic> split given deep divergence of lineages with and without the inversion (see 15b trees in <xref ref-type="fig" rid="fig2">Figures 2A</xref> and <xref ref-type="fig" rid="fig3">3A</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><sec id="s3-1"><title>Approaches for estimating species phylogeny with introgression from whole-genome sequence data: Advantages and limitations</title><p>Our full-likelihood MSC approach yields several improvements over concatenation and other approximate methods for inferring species trees and introgression. First, we account for ILS due to coalescent fluctuations, so variation in inferred genealogical histories can be more firmly attributed to variation in gene flow across the genome. Second, we analyze the sequence data directly, rather than using estimated gene trees as data. This utilizes information in branch lengths of the gene trees while accommodating their uncertainty. We retain heterozygous sites in the alignments as unphased diploid sequences from each individual without collapsing them into a single randomly phased nucleotide as is common in other phylogenomic studies. Our approach allows multiple individuals per species to be included, leading to improved estimation of introgression parameters. Third, MSC models with pulse introgression (MSC-I) or continuous migration (MSC-M) allow direct estimation of key features of the direction, intensity, and timing of gene flow, and are applicable to gene flow between sister species. Widely used summary statistics such as <italic>D</italic> and <italic>f<sub>d</sub></italic> do not estimate these parameters and cannot detect gene flow between sister lineages. Previous analyses using sliding-window concatenation or based on estimated gene trees were therefore liable to be less successful for estimating branching order in the melpomene-silvaniform clade, and because they may be misled by rapid speciation events coupled with extensive gene flow (<xref ref-type="bibr" rid="bib14">Edelman et al., 2019</xref>; <xref ref-type="bibr" rid="bib51">Massardo et al., 2020</xref>; <xref ref-type="bibr" rid="bib35">Kozak et al., 2021</xref>).</p><p>There are several limitations in our approach. First, in the exploratory analysis of genomic blocks using MSC without gene flow (e.g. <xref ref-type="fig" rid="fig1">Figures 1A</xref> and <xref ref-type="fig" rid="fig2">2A</xref>), we assume that one of the main topologies represents the true species tree and is related to other topologies via introgression. In general, it can be nontrivial to decide which topology most likely represents the true species tree, and how to add introgression edges onto the assumed species tree to explain other topologies. Here, we employ several strategies including a recombination-rate argument (<xref ref-type="fig" rid="fig1">Figure 1F</xref>), reduced introgression in the sex chromosome (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), estimates of pairwise migration rates under an explicit model of gene flow (<xref ref-type="fig" rid="app1fig1">Appendix 1—figures 1</xref> and <xref ref-type="fig" rid="app1fig2">2</xref>), and using additional evidence from geographic distributions (<xref ref-type="bibr" rid="bib63">Rosser et al., 2012</xref>) and records of natural hybrids (<xref ref-type="bibr" rid="bib48">Mallet et al., 2007</xref>). These strategies could fail in taxa with more limited biological or distribution information, or when the sex chromosome (if available) is less unreliable as to species topology. Ideally, one would like to be able to estimate species phylogeny and introgression events simultaneously as part of a single unsupervised analysis, but this task remains computationally challenging. Software such as PhyloNet (<xref ref-type="bibr" rid="bib81">Wen and Nakhleh, 2018</xref>) and starBEAST (<xref ref-type="bibr" rid="bib86">Zhang et al., 2018</xref>) implement Bayesian inference of MSC with introgression but they are usually limited to small datasets of no more than 100 loci. Heuristics based on summary statistics may attempt to place introgression edges onto a species phylogeny estimated on the assumption of no gene flow (<xref ref-type="bibr" rid="bib47">Malinsky et al., 2018</xref>; <xref ref-type="bibr" rid="bib71">Suvorov et al., 2022</xref>; <xref ref-type="bibr" rid="bib11">Cicconardi et al., 2023</xref>). However, these approaches do not make full use of sequence data and can be misled by incorrect initial species trees. Furthermore, they cannot convincingly infer direction of gene flow or gene flow between sister species.</p><p>Second, although our approach is more powerful than approximate methods, it is also more computationally intensive and does not scale well to analyses of large numbers of species (&gt;20, say). In <italic>Heliconius</italic>, there are 47 species in six major clades. Our strategy has therefore been to analyze subsets of species representing major clades or representative species within each clade. We then combine the results into a larger phylogeny. One caveat is that not all species get explored at the same time, and some introgression events may be missed. Lastly, the MSC makes simplifying modeling assumptions such as neutral evolution, constant substitution rates on all branches, no recombination within each locus, and free recombination among loci, the implications of which have been discussed previously (<xref ref-type="bibr" rid="bib9">Burgess and Yang, 2008</xref>; <xref ref-type="bibr" rid="bib74">Thawornwattana et al., 2022</xref>). We note that although the MSC model assumes constant rate neutral evolution, estimated introgression probabilities (<italic>φ</italic>) are a combination of both actual introgression and subsequent positive and negative selection on introgressed loci, the extent of which is modulated by local recombination rate (<xref ref-type="bibr" rid="bib59">Petry, 1983</xref>; <xref ref-type="bibr" rid="bib1">Barton and Bengtsson, 1986</xref>).</p><p>In summary, we first explore major species relationships across genome blocks using a full-likelihood MSC approach. We then identify introgression events that explain the different local species trees by proposing introgression edges on a background species topology, with additional evidence from explicit models of gene flow. In addition, geographic distributions and the prevalence of natural hybrids can be employed to help with placement of introgression edges in a phylogeny. This process can result in several competing introgression models. We estimate parameters under each model using sequence data, evaluate the model fit, and perform model comparison. By breaking the problem into manageable parts in this way, our approach is computationally tractable.</p></sec><sec id="s3-2"><title>An updated phylogeny of <italic>Heliconius</italic></title><p>We have clarified phylogenetic relationships among major clades within <italic>Heliconius</italic> and quantified major introgression events, including introgression between sister species (which does not change tree topology). We summarize our three key findings in <xref ref-type="fig" rid="fig4">Figure 4</xref>. First, <italic>H. aoede</italic> is most likely the earliest-branching lineage of <italic>Heliconius</italic>, and an ancient introgression event led to its apparently closer relationship with the doris-burneyi-melpomene clade (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We discuss an implication of this placement below. However, we emphasize the considerable level of uncertainty that remains, and having more high-quality genome data from <italic>H. aoede</italic> and its sibling species may help improve the phylogenetic resolution. Second, within the melpomene-silvaniform clade, we obtained a robust pattern in which the common ancestor of <italic>H. besckei</italic>, <italic>H. numata,</italic> and <italic>H. ismenius</italic> first split off from the rest, rendering the silvaniform species paraphyletic (<xref ref-type="fig" rid="fig2">Figure 2</xref>). This is contrary to a common belief that the silvaniforms are monophyletic (<xref ref-type="bibr" rid="bib24">Heliconius Genome Consortium, 2012</xref>; <xref ref-type="bibr" rid="bib34">Kozak et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Jay et al., 2021</xref>; <xref ref-type="bibr" rid="bib35">Kozak et al., 2021</xref>; <xref ref-type="bibr" rid="bib87">Zhang et al., 2021</xref>). Third, the P<sub>1</sub> inversion on chromosome 15 involved in wing pattern mimicry likely introgressed from <italic>H. numata</italic> into <italic>H. pardalinus</italic> based on species tree topologies (<xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig3">3</xref>) and direct modeling of introgression (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>), although where and when it originated remain uncertain.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Revised phylogeny and introgression history of <italic>Heliconius</italic>.</title><p>Phylogeny of the erato-sara clade was previously estimated using a similar approach (<xref ref-type="bibr" rid="bib74">Thawornwattana et al., 2022</xref>). Arrows represent introgression events. Introgression of chromosomal inversions are region-specific, indicated by a label (13b or 15b) above the arrow. Status of inversions 13b and 15b in each species is indicated in the two rows at the bottom, with + indicating inversion, – indicating standard orientation, and +/– inversion polymorphism. Gray shading represents a period of continuous gene flow. Triangle represents the origin of pollen feeding near the base of <italic>Heliconius</italic>. Star indicates a possible origin of the P<sub>1</sub> inversion on chromosome 15, and green branches indicate lineages with the inversion (polymorphic in Num, fixed in Par). Him: <italic>H. himera</italic>; Sia: <italic>H. hecalesia</italic>; Tel: <italic>H. telesiphe</italic>; Dem: <italic>H. demeter</italic>; see <xref ref-type="fig" rid="fig1">Figures 1</xref>—<xref ref-type="fig" rid="fig3">3</xref> legends for other species codes.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-fig4-v1.tif"/></fig><p>Overall, we conclude that the P<sub>1</sub> inversion likely arose in <italic>H. numata</italic> or its close ancestor and became fixed in <italic>H. pardalinus</italic> via an introgression replacement event from the former species (<xref ref-type="fig" rid="fig3">Figure 3B</xref>), although a deeper origin followed by persistent ancestral polymorphism (<xref ref-type="fig" rid="fig3">Figure 3C</xref>) remains a possibility.</p><p><italic>Heliconius</italic> is an example of recent and rapid diversification with extensive gene flow occurring between closely related species as well as between more divergent lineages throughout its history at varying degrees. Since many species pairs of <italic>Heliconius</italic> show high degrees of sympatry today, there are plenty of opportunities for low levels of gene flow to occur whenever their ranges overlap (<xref ref-type="bibr" rid="bib64">Rosser et al., 2015</xref>). This fact is evident in our estimates of pairwise migration rates among species in the melpomene-silvaniform clade (<xref ref-type="fig" rid="app1fig1">Appendix 1—figures 1</xref> and <xref ref-type="fig" rid="app1fig2">2</xref>). There are many documented natural hybrids (<xref ref-type="bibr" rid="bib48">Mallet et al., 2007</xref>) and there is evidence for introgression between particular pairs of subspecies from genomic studies, most of which involve wing patterning loci (<xref ref-type="bibr" rid="bib80">Wallbank et al., 2016</xref>; <xref ref-type="bibr" rid="bib16">Enciso-Romero et al., 2017</xref>; <xref ref-type="bibr" rid="bib54">Morris et al., 2020</xref>; <xref ref-type="bibr" rid="bib66">Rougemont et al., 2023</xref>). We did not attempt to incorporate all possible introgression signals into our phylogeny but instead focused on major introgression events that explain major patterns of species tree variation across the genome using a representative subset of species. Thus our phylogeny in <xref ref-type="fig" rid="fig4">Figure 4</xref> should be viewed as a simplified version of reality. One future direction is to model a low level of admixture among all lineages.</p></sec><sec id="s3-3"><title>Implications for the evolution of pollen feeding</title><p>To illustrate how our updated phylogeny (<xref ref-type="fig" rid="fig4">Figure 4</xref>) can provide new insights into the evolution of <italic>Heliconius</italic>, we discuss an implication of our results for the evolution of pollen collection and pollen-feeding by adult <italic>Heliconius</italic>, a unique trait found in no other Lepidoptera (<xref ref-type="bibr" rid="bib22">Gilbert, 1972</xref>). Our phylogeny indicates that the aoede clade, comprising <italic>H. aoede</italic> and three other species, is likely the earliest-branching lineage of <italic>Heliconius</italic>, followed by the erato-sara clade. This branching order is consistent with a phylogeny based on morphological and behavioral characters (<xref ref-type="bibr" rid="bib58">Penz, 1999</xref>). Since the aoede clade is the only group of <italic>Heliconius</italic> that does not feed on pollen (<xref ref-type="bibr" rid="bib6">Brown, 1981</xref>), the aoede-early scenario (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) suggests that unique pollen feeding traits arose once after the divergence of the aoede clade (<xref ref-type="fig" rid="fig4">Figure 4</xref>). In contrast, the erato-early scenario (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) is less parsimonious as it requires an additional loss of pollen feeding ability in the aoede clade (<xref ref-type="bibr" rid="bib11">Cicconardi et al., 2023</xref>).</p><p><xref ref-type="bibr" rid="bib77">Turner, 1976</xref> named the aoede clade as subgenus <italic>Neruda</italic> based on distinct morphology in all life stages, such as pupae that are more similar to those of <italic>Eueides</italic> (a sister genus of <italic>Heliconius</italic>), unique larva morphology, white eggs like those of <italic>Eueides</italic> (instead of yellow eggs in all other <italic>Heliconius</italic>), a different genus of larval host plant, <italic>Dilkea</italic> (<xref ref-type="bibr" rid="bib3">Benson et al., 1975</xref>) (all other <italic>Heliconius</italic> species feed on <italic>Passiflora</italic>), and chromosome numbers of n = 21–31 which are variable and intermediate between <italic>Heliconius</italic> (n = 21 in most species) and <italic>Eueides</italic> (n = 31) (<xref ref-type="bibr" rid="bib7">Brown et al., 1992</xref>). For these reasons, <xref ref-type="bibr" rid="bib6">Brown, 1981</xref> later raised <italic>Neruda</italic> from subgenus to genus.</p><p>Thus, morphological/behavioral/ecological characters tend to support early divergence of the aoede clade (<xref ref-type="bibr" rid="bib5">Brown, 1972</xref>; <xref ref-type="bibr" rid="bib58">Penz, 1999</xref>). Molecular phylogenetic work, on the other hand, seemed to support the erato-early scenario (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; <xref ref-type="bibr" rid="bib4">Brower and Egan, 1997</xref>; <xref ref-type="bibr" rid="bib2">Beltrán et al., 2007</xref>; <xref ref-type="bibr" rid="bib34">Kozak et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Kozak et al., 2021</xref>; <xref ref-type="bibr" rid="bib11">Cicconardi et al., 2023</xref>). Consequently, generic status of <italic>Neruda</italic> was revoked (<xref ref-type="bibr" rid="bib34">Kozak et al., 2015</xref>). Our full-likelihood approach, which accounts for ILS as well as introgression, enables inference of a phylogeny that is more parsimonious with morphology and life history. This result parallels analysis of genomic data from African mosquitoes in the <italic>Anopheles gambiae</italic> species complex, in which coalescent-based likelihood analyses support species trees that are more parsimonious for chromosomal rearrangement data (<xref ref-type="bibr" rid="bib73">Thawornwattana et al., 2018</xref>), while prior sliding-window and concatenation analysis favored trees that are less parsimonious (<xref ref-type="bibr" rid="bib20">Fontaine et al., 2015</xref>).</p><p>Our likelihood analyses can thus be used to rescue generic or subgeneric status for <italic>Neruda</italic>. Nevertheless, there remains considerable uncertainty near the base of <italic>Heliconius</italic>. Further whole-genome data from <italic>H. aoede</italic> and related species in the aoede, burneyi and doris clades will likely improve resolution.</p></sec></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Whole-genome sequence data and genotyping</title><p>We obtained raw sequencing data from previous studies (<xref ref-type="bibr" rid="bib80">Wallbank et al., 2016</xref>; <xref ref-type="bibr" rid="bib14">Edelman et al., 2019</xref>; see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>) and extracted multilocus data as described previously (<xref ref-type="bibr" rid="bib74">Thawornwattana et al., 2022</xref>) as unphased diploid sequences, retaining heterozygous sites. Sequencing reads were mapped to each of two reference genomes (see below) using bwa mem v0.7.15 (<xref ref-type="bibr" rid="bib44">Li, 2013</xref>) with default parameters, and then sorted using sambamba v0.6.8 (<xref ref-type="bibr" rid="bib72">Tarasov et al., 2015</xref>). <italic>RealignerTargetCreator</italic> and <italic>IndelRealigner</italic> modules in GATK v3.8 were used to improve alignment around indels (<xref ref-type="bibr" rid="bib52">McKenna et al., 2010</xref>; <xref ref-type="bibr" rid="bib13">DePristo et al., 2011</xref>). We called genotypes of each individual using <italic>mpileup</italic> and <italic>call</italic> modules in bcftools v1.5 (<xref ref-type="bibr" rid="bib42">Li et al., 2009</xref>) with the multiallelic-caller model (<italic>call -m</italic>) (<xref ref-type="bibr" rid="bib43">Li, 2011</xref>), and set minimum base and mapping quality to 20. We retained high-quality genotype calls using bcftools <italic>filter</italic> using the following filters: (1) a minimum quality score (QUAL) of 20 at both variant and invariant sites; (2) for each genotype, a genotype quality score (GQ) ≥ 20 and a read depth (DP) satisfying max(meanDP/2, <italic>d</italic>) ≤ DP ≤ 2 meanDP, where <italic>d</italic> = 12 or 20 depending on the dataset, and meanDP is the sample-averaged read depth. This choice of <italic>d</italic> was used to retain a large number of loci while maintaining low genotype-calling error rate (<xref ref-type="bibr" rid="bib74">Thawornwattana et al., 2022</xref>). For the Z chromosome in females (which are heterogametic in <italic>Heliconius</italic>), we halved the DP threshold (<italic>d</italic>). Finally, we excluded sites within five base pairs (bp) of indels.</p></sec><sec id="s4-2"><title>Multilocus datasets</title><p>There are three main datasets in this study: (1) 'etales-9spp' contains eight species (<italic>H. melpomene</italic>, <italic>H. besckei</italic>, <italic>H. numata</italic>, <italic>H. burneyi</italic>, <italic>H. doris</italic>, <italic>H. aoede, H. erato,</italic> and <italic>H. sara</italic>), one diploid individual per species, representative of all six major clades of <italic>Heliconius</italic> plus one species from a sister genus <italic>Eueides</italic> (<italic>E. tales</italic>). We used two reference genomes (<italic>H. erato demophoon</italic> v1 and <italic>H. melpomene melpomene</italic> Hmel2.5; see <ext-link ext-link-type="uri" xlink:href="http://ensembl.lepbase.org/index.html">http://ensembl.lepbase.org/index.html</ext-link>) for read mapping, and two choices of the minimum read depth cutoffs (12 and 20) to ensure high-quality genotypes, resulting in four datasets in total. All reference genomes were available from <ext-link ext-link-type="uri" xlink:href="http://lepbase.org">http://lepbase.org</ext-link>. (2) 'hmelv25-res' contains eight species (one individual per species) within the melpomene-silvaniform clade (<italic>H. melpomene, H. cydno, H. timareta, H. besckei, H. numata, H. hecale, H. elevatus,</italic> and <italic>H. pardalinus</italic>), mapped to Hmel2.5 reference. The DP threshold (<italic>d</italic>) for genotype calling was 20. (3) To understand the history of the 15b inversion region better, we also compiled a third multilocus dataset for chromosome 15 comprising the pardalinus-hecale clade, <italic>H. numata</italic> with and without the P<sub>1</sub> inversion, as well as <italic>H. ismenius</italic> (sister species of <italic>H. numata</italic>) and <italic>H. ethilla</italic> (sister to the pardalinus-hecale clade) (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>, ’silv_chr15' dataset; see below under <italic>'</italic>Chromosome 15 inversion region: dataset and analysis<italic>'</italic>) using publicly available data independent of our previous datasets used in this article (<xref ref-type="bibr" rid="bib26">Jay et al., 2018</xref>; <xref ref-type="bibr" rid="bib27">Jay et al., 2021</xref>).</p><p>We generated coding and noncoding multilocus datasets from each dataset (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>) as follows (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>). First, we extracted coordinates of coding and noncoding loci from the reference genome. In this study, loci refer to short segments of DNA that are far apart. The MSC model implemented in <sc>bpp</sc> assumes complete linkage within a locus and free recombination between loci. In simulations, species tree inference under MSC is found to be robust to within-locus recombination with recombination rates up to 10× the human rate (<xref ref-type="bibr" rid="bib89">Zhu et al., 2022</xref>). Each coding locus coincided with a protein coding sequence (CDS) and had length at least 100 bp, whereas a noncoding locus can contain noncoding exons, introns, and intergenic regions, and had length 100–1000 bp. Since linkage disequilibrium in <italic>Heliconius</italic> species decays rapidly to background level within 10 kb (<xref ref-type="bibr" rid="bib24">Heliconius Genome Consortium, 2012</xref>), we spaced loci ≥2 kb apart, each assumed approximately independent, to obtain sufficient data. We excluded as loci any repetitive regions annotated in the reference genome. We processed each locus by removing sites containing missing data: the locus was discarded if it consisted of &gt;50% missing data. After filtering, we also discarded loci with 10 or fewer sites remaining. We obtained &gt;10,000 loci in each dataset; see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c and l</xref> for the number of loci. For the dataset with read depth cutoff of 12 aligned to the <italic>H. erato</italic> reference, we obtained about 19,000 noncoding loci and 48,000 coding loci. Note that we here obtain more coding than noncoding loci because noncoding loci were more difficult to align with the divergent <italic>Eueides</italic> outgroup (~7% divergent). Filtered noncoding loci were more conserved than coding loci for the same reason. The number of informative sites per locus was 10 for coding loci and 4 for noncoding loci on average. Average heterozygosity per site was about 0.43% for coding loci and 0.49% for noncoding loci, with <italic>H. besckei</italic> having the lowest heterozygosity (0.15–0.25%) and <italic>H. burneyi</italic> and <italic>E. tales</italic> having the highest heterozygosity (0.7–0.8%).</p><p>For the 'etales-9spp' dataset, we separated out inversion regions on chromosomes 2, 6, 13, and 21 into 2b, 6b, 6c, 13b, and 21b (with two adjacent inversions in chromosome 6; chromosome 21 is the Z [sex] chromosome) while flanking regions were denoted 2a, 2c, 6a, 6d, 13a, 13c, 21a, and 21c, resulting in 30 chromosomal regions in total. These inversions were first identified in a previous study (<xref ref-type="bibr" rid="bib67">Seixas et al., 2021</xref>); see coordinates in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1b</xref>. We obtained &gt;11,000 noncoding loci and &gt;31,000 coding loci in the smallest dataset (aligned to the <italic>H. erato demophoon</italic> reference, <italic>d</italic> = 20) and &gt;31,000 noncoding loci and &gt;48,000 coding loci in the largest dataset (Hmel2.5 reference, <italic>d</italic> = 12); see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref>. The median number of sites was 100–130 depending on the dataset. The number of informative sites had median of 2–3 (range: 0–58) per locus for the noncoding loci and 4–5 (0–570) for the coding loci. Again, noncoding loci are underrepresented in our datasets and they tended to be more conserved.</p><p>For the 'hmvelv25-res' dataset, we split chromosomes 2 and 15 into inversion (2b and 15b) and flanking regions (2a, 2c, 15a, and 15c), resulting in 25 chromosomal regions in total; coordinates are in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1b</xref>. Although only the chromosome 15b inversion region has been hitherto identified in this melpomene-silvaniform clade, we wished to test whether the chromosome 2b inversion identified in the erato-sara clade was also present in this group. We obtained &gt;80,500 noncoding loci and &gt;73,200 coding loci for 'hmvelv25-res' (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1l</xref>). The median number of sites was 339 (range: 11–997) for noncoding loci and 147 (11–12,113) for coding loci. The median number of informative sites per locus was 6 (0–46) for noncoding loci and 2 (0–253) for coding loci.</p></sec><sec id="s4-3"><title>Overview of analysis approach</title><p>We first used the MSC model without gene flow to explore variation in genealogical history across the genome. We then formulated MSC models with introgression (MSC-I) based on a parsimony argument to explain major patterns of genealogical variation. We estimated the direction, timing, and intensity of introgression under each MSC-I model, and assessed most likely introgression scenarios. For gene flow between closely related species that may be on-going, we also used an MSC model with continuous migration (isolation-with-migration; IM) to estimate rates and directionality of gene flow.</p></sec><sec id="s4-4"><title>Species tree estimation under the MSC model without gene flow using <sc>bpp</sc></title><p>We performed Bayesian inference of species trees under the MSC model without gene flow using <sc>bpp</sc> v4.4.0 (<xref ref-type="bibr" rid="bib84">Yang and Rannala, 2014</xref>; <xref ref-type="bibr" rid="bib61">Rannala and Yang, 2017</xref>; <xref ref-type="bibr" rid="bib17">Flouri et al., 2018</xref>). This model accounts for gene-tree heterogeneity due to deep coalescence. Hence, the genome-wide variation in estimated genealogy is most likely due to differential gene flow. We grouped loci into blocks of 200 and estimated a posterior distribution of species trees for each block. This blockwise analysis allows us to explore genealogical variation along each chromosomal region and to choose models of introgression for estimation in later analysis. Blocks of coding and noncoding loci were analyzed separately.</p><p>The MSC model without gene flow has two types of parameters: species divergence times (<italic>τ</italic>) and effective population sizes (<italic>θ</italic> = 4<italic>Nμ</italic>), both measured in expected number of mutations per site. For the 'etales-9spp' dataset (all four versions; <xref ref-type="fig" rid="fig1">Figure 1</xref> used <italic>H. erato</italic> reference depth greater than 12, ‘minDP12’), we assigned a diffuse gamma prior to the root age <italic>τ</italic><sub>0</sub> ~ G(7, 200), with mean 0.035, and to all population sizes <italic>θ</italic> ~ G(4, 200), with mean 0.02. Given <italic>τ</italic><sub>0</sub>, other divergence times were assigned a uniform-Dirichlet distribution (<xref ref-type="bibr" rid="bib83">Yang and Rannala, 2010</xref>, eq. 2). For each block of loci, we performed 10 independent runs of MCMC, each with 2 × 10<sup>6</sup> iterations after a burn-in of 10<sup>5</sup> iterations, with samples recorded every 200 iterations. We assessed convergence by comparing the posterior distribution of species trees among the independent runs. Nonconvergent runs were discarded. The samples were then combined to produce the posterior summary such as the MAP tree. There were 1355 blocks in total from all four versions of the dataset (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref>), so there were 13,550 runs in total. Each run took about 20–30 hr.</p><p>Similarly, for the 'hmelv25-res' dataset, we used <italic>τ</italic><sub>0</sub> ~ G(4, 200), with mean 0.02, and population sizes <italic>θ</italic> ~ G(2, 200) for all populations, with mean 0.01. Each of the 10 independent runs of the MCMC took 1 × 10<sup>6</sup> iterations after a burn-in of 10<sup>5</sup> iterations, with samples recorded every 100 iterations. There were 7830 runs in total. Each run took about 15–20 hr.</p></sec><sec id="s4-5"><title>Migration rate estimation under the MSC-M model for species triplets using <sc>3s</sc></title><p>To obtain more direct evidence of gene flow, we estimated migration rates between all pairs of <italic>Heliconius</italic> species in the 'etales-8spp' dataset under an MSC-with-migration (MSC-M or IM) model using the maximum likelihood program <sc>3</sc>s v3.0 (<xref ref-type="bibr" rid="bib12">Dalquen et al., 2017</xref>). The implementation in 3s assumes a species phylogeny of three species ((<italic>S</italic><sub>1</sub>, <italic>S</italic><sub>2</sub>), <italic>S</italic><sub>3</sub>) with continuous gene flow between <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> since their divergence at constant rates in both directions, and requires three-phased haploid sequences per locus. Since our multilocus data were unphased diploid, we phased the data using PHASE v2.1.1 (<xref ref-type="bibr" rid="bib70">Stephens et al., 2001</xref>) to obtain two haploid sequences per individual at each locus. At each locus, we then sampled three types of sequence triplets 123, 113, and 223 with probabilities 0.5, 0.25, and 0.25, respectively, where 113 means two sequences from <italic>S</italic><sub>1</sub> and one sequence from <italic>S</italic><sub>3</sub> chosen at random, etc. We used <italic>E. tales</italic> as the outgroup (<italic>S</italic><sub>3</sub>) for all pairs (<italic>S</italic><sub>1</sub>, <italic>S</italic><sub>2</sub>). We analyzed coding and noncoding loci on the autosomes and three regions of the Z chromosome (chromosome 21) separately, each with 28 pairs among the eight <italic>Heliconius</italic> species. Additionally, we analyzed each autosomal region separately. This analysis was done with two choices of reference genome at read depth cutoff (<italic>d</italic>) of 12.</p><p>We fitted two models to each dataset: an MSC without gene flow (M0) and a bidirectional IM (M2). Model M0 has six parameters: two species divergence times (<italic>τ</italic><sub>1</sub> for <italic>S</italic><sub>1</sub>–<italic>S</italic><sub>2</sub> divergence, <italic>τ</italic><sub>0</sub> for the root) and four population sizes (<italic>θ</italic><sub>1</sub> for <italic>S</italic><sub>1</sub>, <italic>θ</italic><sub>2</sub> for <italic>S</italic><sub>2</sub>, <italic>θ</italic><sub>4</sub> for the root, and <italic>θ</italic><sub>5</sub> for the ancestor of <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>); there is no <italic>θ</italic><sub>3</sub> for <italic>S</italic><sub>3</sub> because there is at most one sequence from <italic>S</italic><sub>3</sub> per locus. Model M2 has two additional parameters: <italic>M</italic><sub>12</sub> and <italic>M</italic><sub>21</sub>, where <italic>M</italic><sub>12</sub> = <italic>m</italic><sub>12</sub><italic>N</italic><sub>2</sub> is the expected number of migrants from <italic>S</italic><sub>1</sub> to <italic>S</italic><sub>2</sub> per generation, <italic>m</italic><sub>12</sub> is the proportion of migrants from <italic>S</italic><sub>1</sub> to <italic>S</italic><sub>2</sub> and <italic>N</italic><sub>2</sub> is the effective population size of <italic>S</italic><sub>2</sub>. <italic>M</italic><sub>21</sub> is defined similarly. For each model, we performed 10 independent runs of model fitting and chose the run with the highest log-likelihood. We discarded runs with extreme estimates (close to boundaries in the optimization). We then compared models M0 and M2 via likelihood ratio test (LRT) using a chi-squared distribution with two degrees of freedom as a null distribution at a significance threshold of 1%. Adjusting this threshold to account for multiple testing did not change our conclusions because the LRT values were usually extreme, especially in the analysis of all autosomal loci (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1h</xref>). There were 31 (30 chromosomal regions + all of autosomal loci together) × 2 (coding and noncoding) × 28 (species pairs) × 2 (choices of reference genome) × 10 (replicates) = 34,720 runs in total. For our largest dataset with &gt;46,000 loci, each run of fitting two models (M0 and M2) took 2–3 hr.</p><p>We tested between two competing scenarios (<xref ref-type="fig" rid="fig1">Figure 1B and C</xref>) to infer which was more likely by estimating the internal branch length (Δ<italic>τ</italic> = <italic>τ</italic><sub>0</sub> – <italic>τ</italic><sub>1</sub>) when either <italic>H. aoede</italic> or <italic>H. erato</italic> was used as an outgroup, with ingroup species representing the melpomene-silvaniform clade. To this end, we compiled another dataset similar to 'hmelv25-res' but included species from all six major clades of <italic>Heliconius</italic> (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>, 'hmelv25-all' dataset). We followed the same procedure as described above. There were 55 pairs in total for each choice of the outgroup species. Estimates of internal branch length close to zero (with the resulting tree becoming star-shaped) suggest that the specified species tree ((<italic>S</italic><sub>1</sub>, <italic>S</italic><sub>2</sub>), <italic>S</italic><sub>3</sub>) was likely incorrect. There were 26 (25 chromosomal regions + all autosomal loci together) × 2 (coding and noncoding) × 55 (species pairs) × 2 (choices of reference genome) × 10 (replicates) = 57,200 runs in total.</p></sec><sec id="s4-6"><title>Parameter estimation under MSC-I using <sc>bpp</sc></title><p>Given the species-tree models with introgression of <xref ref-type="fig" rid="fig1">Figure 1D and E</xref>, we estimated introgression probabilities (<italic>φ</italic>), species divergence times and introgression times (<italic>τ</italic>), and effective population sizes (<italic>θ</italic>) for each coding and noncoding dataset from each chromosomal region using <sc>bpp</sc> v4.6.1 (<xref ref-type="bibr" rid="bib18">Flouri et al., 2020</xref>). We assumed that population sizes of source and target populations remained unchanged before and after each introgression event (thetamodel = linked msci). There were 25 unique parameters in total. We used the same prior distributions for <italic>τ</italic> and <italic>θ</italic> as in the MSC analysis without gene flow above, with root age <italic>τ</italic><sub>0</sub> ~ G(7, 200) and <italic>θ</italic> ~ G(4, 200) for all populations. We assigned a uniform prior U(0,1) to all introgression probabilities (<italic>φ</italic>). For each chromosomal region, we performed 10 independent runs of MCMC, each with 1 × 10<sup>6</sup> iterations after a burn-in of 10<sup>5</sup> iterations, with samples recorded every 100 iterations. We assessed convergence by comparing the posterior estimates among the independent runs. Non-convergent runs were discarded. Samples were then combined to produce posterior summaries. Multiple posterior peaks, if they existed, were recorded and processed separately. There were 30 (chromosomal regions) × 2 (coding and noncoding) × 2 (trees 1 and 3) × 10 (replicates) = 1200 runs in total. Each run took 200–300 hrs.</p><p>For the two MSC-I models of <xref ref-type="fig" rid="fig1">Figure 1D and E</xref>, we also estimated the marginal likelihood for each model using thermodynamic integration with 32 Gaussian quadrature points in <sc>bpp</sc> (<xref ref-type="bibr" rid="bib39">Lartillot and Philippe, 2006</xref>; <xref ref-type="bibr" rid="bib61">Rannala and Yang, 2017</xref>) and calculated Bayes factors to compare the two models (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1k</xref>). This was done for each coding and noncoding dataset from each chromosomal region. Since the estimates of marginal likelihoods can be noisy, occasionally with extreme outliers, we adjusted estimates of Bayes factor by fitting local quadratic polynomials with span of 0.4 to the difference in the mean log likelihood from the two models, using the loess function in R (<xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>). Additionally, we checked for reliability of the Bayes factor estimates by performing replicate calculation of the Bayes factor for a few chromosomes (3, 4, 9, and 21a) and found the preferred model choice to be reliable. The replicate estimates of log Bayes factor were –8.44, 19.35, –6.65, and 51.45 for chromosomes 3, 4, 9, and 21a, respectively, while the raw estimates were –11.41, 19.63, –10.94, and 53.12 and the adjusted estimates were –2.15, 20.83, –8.84, and 37.80 (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1k</xref>).</p><p>The MSC-I model of <xref ref-type="fig" rid="fig2">Figure 2B</xref> has six pairs of bidirectional introgression events, with 12 introgression probabilities (<italic>φ</italic>), 13 species divergence times and introgression times (<italic>τ</italic>), and 15 population size parameters (<italic>θ</italic>), a total of 40 parameters. We assigned the same prior distributions to <italic>τ</italic><sub>0</sub> and <italic>θ</italic> as in the MSC analysis above, and <italic>φ ~</italic> U(0,1) for all introgression probabilities. The MSC-I model of <xref ref-type="fig" rid="fig2">Figure 2C</xref> has three more bidirectional introgression edges, with nine additional parameters (six introgression probabilities and three introgression times). Other settings were the same as above. There were 25 (chromosomal regions) × 2 (coding and noncoding) × 10 (replicates) = 500 runs in total. Most runs took 20–40 d.</p></sec><sec id="s4-7"><title>Parameter estimation under an MSC-M model using <sc>bpp</sc></title><p>In the MSC-I model of <xref ref-type="fig" rid="fig2">Figure 2B</xref>, each of the pardalinus-hecale and cydno-melpomene clades has very recent estimated introgression times; thus gene flow may be ongoing. We therefore used the MSC-M model to estimate six continuous migration rates between the three species in each clade using <sc>bpp</sc> v4.6.1 (<xref ref-type="bibr" rid="bib19">Flouri et al., 2023</xref>), assuming the species tree as in <xref ref-type="fig" rid="fig2">Figure 2</xref>. We assigned prior distributions <italic>τ</italic><sub>0</sub> ~ G(2, 200) for the root age (mean 0.01), <italic>θ</italic> ~ G(2, 500) for all populations (mean 0.004), and <italic>M</italic> ~ G(2, 10) for all migration rates (mean 0.2). The MCMC setup was the same as in the MSC-I analysis above. There were 25 (chromosomal regions) × 2 (coding and noncoding) × 10 (replicates) × 2 (pardalinus-hecale and cydno-melpomene clades) = 1000 runs in total. Each run took 120–150 hr.</p></sec><sec id="s4-8"><title>Chromosome 15 inversion region: Dataset and analysis</title><p>To investigate the evolutionary history of the inversion region in chromosome 15 (15b region or <italic>P</italic> locus), we obtained genomic sequence data for six species (<italic>H. numata</italic> homozygous for the ancestral orientation, <italic>H. numata</italic> homozygous for the inversion, <italic>H. ismenius</italic>, <italic>H. pardalinus</italic>, <italic>H. elevatus</italic>, <italic>H. hecale,</italic> and <italic>H. ethilla</italic>), with two individuals per species, from previous studies (<xref ref-type="bibr" rid="bib26">Jay et al., 2018</xref>; <xref ref-type="bibr" rid="bib27">Jay et al., 2021</xref>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>, ’silv_chr15' dataset). We extracted a multilocus dataset using an improved pipeline compared with that described above (see 'Whole-genome sequence data and genotyping<italic>'</italic> and 'Multilocus datasets<italic>'</italic>). Here, a different filtering strategy used more complex, multi-stage genotyping to account for multiple individuals per species as follows. First, we removed Illumina adapters and trimmed low quality bases using trimmomatric v.0.39 (SLIDINGWINDOW:4:20 MINLEN:50). Next, sequencing reads were mapped to the <italic>H. melpomene melpomene</italic> reference assembly (Hmel2.5) using bwa-mem v.0.7.17 (<xref ref-type="bibr" rid="bib44">Li, 2013</xref>). Duplicate reads were masked using MarkDuplicates (Picard) in GATK v.4.2.6.1 (<xref ref-type="bibr" rid="bib60">Poplin et al., 2018</xref>). We jointly called genotypes on chromosome 15 of individuals from the same species (and the same inversion genotype) using <italic>mpileup</italic> and <italic>call</italic> modules in bcftools v1.17 (<xref ref-type="bibr" rid="bib42">Li et al., 2009</xref>) with the multiallelic-caller model (<italic>call -m</italic>) (<xref ref-type="bibr" rid="bib43">Li, 2011</xref>), and set the minimum base and mapping quality to 20. Only high-quality SNPs (QD score ≥2.0 and MQ score ≥40) were retained.</p><p>To obtain multilocus data, genomic coordinates of coding and noncoding loci were obtained from the reference genome as described above. Noncoding loci were 100–1000 bp in length and at least 2 kb apart. Coding loci were at least 100 bp in length (no maximum length limit) and at least 2 kb apart. To maximize information, minimum spacing was enforced for loci within the inversion region. We then extracted sequence alignments for each locus using the following procedure. All SNPs passing the quality filter were included. Constant sites were obtained from the reference sequence unless they were masked by one of the following criteria: (1) read depth below 20 (coded as '–') and (2) non-SNP variant or low-quality SNP (coded as 'N'). For each locus, we excluded sequences with &gt;50% of sites missing ('–' or 'N'), and excluded sites with all missing data. We discarded loci with only a single sequence remaining after filtering. Finally, we grouped loci into three regions as before: one inversion region (15b) and two flanking regions (15a and 15c). We obtained 218, 95, and 960 coding loci and 424, 368, and 2446 noncoding loci in 15a, 15b, and 15c regions, respectively.</p><p>We performed blockwise estimation of species trees under the MSC model without gene flow as described earlier in blocks of 100 and 200 loci (see 'Species tree estimation under the MSC model without gene flow using <sc>bpp</sc><italic><sc>'</sc></italic>). For the 200-locus blocks, there were 23 (7 coding blocks + 16 noncoding blocks) × 10 (replicates) = 230 runs; each run took about 60 hr. For the 100-locus blocks, there were 45 (13 coding blocks + 32 noncoding blocks) × 10 (replicates) = 450 runs; each run took about 30 hrs.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Software, Supervision, Funding acquisition, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Methodology, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Supplementary tables.</title><p>(<bold>a</bold>) Sample information. (<bold>b</bold>) Coordinates of chromosome inversion regions considered in this study. (<bold>c</bold>) Number of coding and noncoding loci by chromosomal region in four versions of the 'etales-9spp' dataset. (<bold>d</bold>) Proportions of posterior species tree estimates (maximum a posteriori [MAP] trees) from <sc>bpp</sc> multispecies coalescent (MSC) analysis without gene flow of all four versions of the 'etales-9spp' dataset in blocks of 200 loci, with BNM clade (<italic>H. besckei</italic>, <italic>H. numata</italic>, <italic>H. melpomene</italic>) collapsed into a single tip, summarized into major regions: auto (all autosomes excluding inversion regions), the Z chromosome (chr 21, excluding the inversion region), and individual inversion regions (2b, 6b, 6c, 13b, and 21b). n = number of blocks. Tree indices correspond to those in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>. A full list of MAP trees for each chromosomal region is provided in (e). Full results without BNM lumping are provided in (f and g). (<bold>e</bold>) Proportions of MAP trees from <sc>bpp</sc> MSC analysis without gene flow of all four versions of the 'etales-9spp' dataset in blocks of 200 loci, with BNM clade collapsed into a single tip, summarized by chromosomal region. Genome-wide summaries are given in (d). (<bold>f</bold>) Full results from <sc>bpp</sc> MSC analysis without gene flow of the 'etales-9spp' dataset, summarized into major regions of the genome. See also legend to (d). Trees are in a decreasing order of the total frequencies across all four versions of the dataset. Tree indices correspond to those in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. (<bold>g</bold>) Full results from <sc>bpp</sc> MSC analysis without gene flow of the 'etales-9spp' dataset, summarized by chromosomal region. See legend to (f). (<bold>h</bold>) Bayes factor <italic>B</italic> = <italic>M</italic><sub>1E</sub>/<italic>M</italic><sub>1D</sub> for comparing the two MSC-I models in <xref ref-type="fig" rid="fig1">Figure 1D</xref> (<italic>M</italic><sub>1E</sub>; scenario 1) and <xref ref-type="fig" rid="fig1">Figure 1E</xref> (<italic>M</italic><sub>1D</sub>; scenario 2), calculated for coding and noncoding loci for each chromosomal region using thermodynamic integration with 32 Gaussian quadrature points. <italic>M</italic><sub>1E</sub> (scenario 2) is preferred if <italic>B</italic>&gt;100, <italic>M</italic><sub>1D</sub> (scenario 1) is preferred if <italic>B</italic> &lt; 0.01, and the test is not significant (n.s.) otherwise (i.e. 100 &lt; B &lt; 0.01). The last three columns are adjusted values of Bayes factor to account for numerical instability of the thermodynamic integration estimates (see ‘Methods’ and <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>). (<bold>i</bold>) Posterior means and 95% HPD intervals (in parentheses) of parameters from the <sc>bpp</sc> MSC-I model in <xref ref-type="fig" rid="fig1">Figure 1D</xref> (scenario 1) using noncoding and coding loci for each chromosomal region of 'etales-8spp' dataset (see a). Multiple posterior peaks, if present, are reported, for example there are two peaks, denoted chr1 and chr1-alt, from the coding loci in chromosome 1. Plots of these estimates with 95% HPD intervals are provided in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>. Plots of species tree with estimated divergence times, introgression times, and introgression probabilities are provided in <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>. (<bold>j</bold>) Posterior means and 95% HPD intervals (in parentheses) of parameters from the <sc>bpp</sc> MSC-I model in <xref ref-type="fig" rid="fig1">Figure 1E</xref> (scenario 2) using noncoding and coding loci for each chromosomal region. Multiple posterior peaks, if present, are reported, for example, there are two peaks, denoted chr1 and chr1-alt, from the coding loci in chromosome 1. Plots of these estimates with 95% HPD intervals are provided in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>. Plots of the species tree with estimated divergence times, introgression times, and introgression probabilities are in <xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>. (<bold>k</bold>) Maximum likelihood estimates (MLEs) of parameters under the isolation-with-migration (IM) model obtained from <sc>3</sc>s for each of the 28 pairs of species in the 'etales-9spp' dataset (<italic>H. erato</italic> reference, minDP12), using <italic>Eueides tales</italic> (Tal) as an outgroup. We used the likelihood ratio test (LRT) statistic to test if the model with gene flow (M2) was preferred to the model without gene flow (M0) using the p-value threshold of 1%. The ‘auto’ dataset used all autosomal loci excluding the inversion regions (see c for the number of loci). Plots of migration rate and divergence time estimates are provided in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>. Plots of all parameter estimates with confidence intervals are provided in <xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>. (<bold>l</bold>) Number of coding and noncoding loci in each chromosomal region in the ‘hmelv25-res' dataset used in <sc>bpp</sc> analysis and the ‘hmelv25-all' dataset use in <sc>3</sc>s analysis. (<bold>m</bold>) Proportions of MAP trees, with minimum, median, and maximum posterior probabilities shown in parentheses, from <sc>bpp</sc> MSC analysis without gene flow of the 'hmelv25-res' dataset in blocks of 200 loci, summarized into four major regions: auto (all autosomes excluding 2b and 15b), 2b and 15b inversion regions, and chromosome 21 (Z chromosome). Trees are in a decreasing order of combined frequency across all chromosomes. Tree indices correspond to those in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>. (<bold>n</bold>) Proportions of MAP trees, with minimum, median, and maximum posterior probabilities shown in parentheses from <sc>bpp</sc> MSC analysis without gene flow in blocks of 200 loci, summarized by chromosomal region. See legend to (m). (<bold>o</bold>) MLEs of parameters under the MSC-M model obtained from <sc>3</sc>s for each of the 55 pairs of species in the 'hmelv25-all' dataset using <italic>H. aoede</italic> as an outgroup. We used the LRT statistic to test if the model with gene flow (M2) was preferred to the model without gene flow (M0) using the p-value threshold of 1%. See <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A</xref> for plots of these estimates. The ‘auto’ setting used all autosomal loci excluding the inversion regions. See l for the number of loci. (<bold>p</bold>) MLEs of parameters under the MSC-M model obtained from <sc>3</sc>s for each of the 55 pairs of species in the 'hmelv25-all' dataset using <italic>H. erato</italic> as an outgroup. See legend to (o). See <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> for plots of these estimates. (<bold>q</bold>) Posterior means and 95% HPD intervals (in parentheses) of parameters obtained from the <sc>bpp</sc> MSC-I model of <xref ref-type="fig" rid="fig2">Figure 2B</xref> using noncoding loci from each non-15b chromosomal region, and under the MSC-I model m1 of <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref> for the chromosome 15b inversion region. Plots of the estimates are provided in <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>. 'n/a' means the parameter does not exist in the model. (<bold>r</bold>) Posterior means and 95% HPD intervals (in parentheses) of parameters from <sc>bpp</sc> MSC-I models are provided in <xref ref-type="fig" rid="fig2">Figure 2B</xref> and <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref> (model m1) using coding loci. See legend to (q). (<bold>s</bold>) Posterior means and 95% HPD intervals (in parentheses) of parameters from <sc>bpp</sc> MSC-M models for the pardalinus-hecale clade: ((Par, Ele), Hec), with six continuous migration rates (<italic>M</italic> = <italic>Nm</italic>) among the three species, two species divergence times (<italic>τ</italic>) and five population sizes (θ). Plot of the estimates is provided in <xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6A</xref>. (<bold>t</bold>) Posterior means and 95% HPD intervals (in parentheses) of parameters obtained from <sc>bpp</sc> MSC-M models for the pardalinus-elevatus clade: (Par, Ele), with two continuous migration rates (<italic>M</italic> = <italic>Nm</italic>). All populations were assumed to have the same population size (θ). Plot of the estimates is provided in <xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6B</xref>. (<bold>u</bold>) Posterior means and 95% HPD intervals (in parentheses) of parameters from <sc>bpp</sc> MSC-M models for the cydno-melpomene clade: ((Tim, Cyd), Mel), with six continuous migration rates (<italic>M</italic> = <italic>Nm</italic>) among the three species, two species divergence times (<italic>τ</italic>), and five population sizes (θ). Plot of the estimates is provided in <xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6C</xref>. (<bold>v</bold>) Proportions of MAP trees, with minimum, median, and maximum posterior probabilities shown in parentheses, from <sc>bpp</sc> MSC analysis without gene flow of the ‘silv-chr15' dataset in blocks of 200 loci or 100 loci, summarized by three regions: the inversion region (15b) and flanking regions (15a and 15c). Trees are in decreasing order of combined frequency across all chromosomal regions and from both options of block size. (<bold>w</bold>) Posterior means and 95% HPD intervals (in parentheses) of parameters obtained from five <sc>bpp</sc> MSC-I models in <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>.</p></caption><media xlink:href="elife-90656-supp1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-90656-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All multilocus alignment datasets generated in this study (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a, c and l</xref>) and scripts for reproducing main analyses are available in Zenodo at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8415106">https://doi.org/10.5281/zenodo.8415106</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Thawornwattana</surname><given-names>Y</given-names></name><name><surname>Seixas</surname><given-names>F</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Major patterns in the introgression history of Heliconius butterflies</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.8415106</pub-id></element-citation></p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><name><surname>Edelman</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Genomic architecture and introgression shape a butterfly radiation</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA532398">PRJNA532398</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><name><surname>Jay</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Whole genome sequence data from silvaniform Heliconius individuals</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA471310">PRJNA471310</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset4"><person-group person-group-type="author"><name><surname>Jay</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Heliconius numata individual whole genome shotgun sequencing dataset</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJEB40136">PRJEB40136</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This study was supported by Harvard University (YT, FS, and JM), and by Biotechnology and Biological Sciences Research Council grants (BB/T003502/1, BB/X007553/1 and BB/R01356X/1) and Natural Environment Research Council grant (NSFDEB-NERC NE/X002071/1) to ZY</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>N</given-names></name><name><surname>Bengtsson</surname><given-names>BO</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>The barrier to genetic exchange between hybridising populations</article-title><source>Heredity</source><volume>57 (Pt 3)</volume><fpage>357</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1038/hdy.1986.135</pub-id><pub-id pub-id-type="pmid">3804765</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beltrán</surname><given-names>M</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name><name><surname>Brower</surname><given-names>AVZ</given-names></name><name><surname>Bermingham</surname><given-names>E</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Do pollen feeding, pupal-mating and larval gregariousness have a single origin in <italic>Heliconius</italic> butterflies? Inferences from multilocus DNA sequence data</article-title><source>Biological Journal of the Linnean Society</source><volume>92</volume><fpage>221</fpage><lpage>239</lpage><pub-id pub-id-type="doi">10.1111/j.1095-8312.2007.00830.x</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benson</surname><given-names>WW</given-names></name><name><surname>Brown</surname><given-names>KS</given-names></name><name><surname>Gilbert</surname><given-names>LE</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Coevolution of plants and herbivores: Passion flower butterflies</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>29</volume><fpage>659</fpage><lpage>680</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.1975.tb00861.x</pub-id><pub-id pub-id-type="pmid">28563089</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brower</surname><given-names>AVZ</given-names></name><name><surname>Egan</surname><given-names>MG</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Cladistic analysis of <italic>Heliconius</italic> butterflies and relatives (Nymphalidae: Heliconiiti): a revised phylogenetic position for Eueides based on sequences from mtDNA and a nuclear gene</article-title><source>Proceedings of the Royal Society of London. Series B</source><volume>264</volume><fpage>969</fpage><lpage>977</lpage><pub-id pub-id-type="doi">10.1098/rspb.1997.0134</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>The heliconians of Brazil (Lepidoptera: Nymphalidae). Part III. Ecology and biology of Heliconius nattereri, a key primitive species neat extinction, and comments on the evolutionary development of Heloconius and Eueides</article-title><source>Zoologica</source><volume>57</volume><fpage>41</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.5962/p.203235</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>The biology of <italic>Heliconius</italic> and related Genera</article-title><source>Annual Review of Entomology</source><volume>26</volume><fpage>427</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1146/annurev.en.26.010181.002235</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>KS</given-names></name><name><surname>Emmel</surname><given-names>TC</given-names></name><name><surname>Eliazar</surname><given-names>PJ</given-names></name><name><surname>Suomalainen</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Evolutionary patterns in chromosome numbers in neotropical Lepidoptera. I. Chromosomes of the Heliconiini (family Nymphalidae: subfamily Nymphalinae)</article-title><source>Hereditas</source><volume>117</volume><fpage>109</fpage><lpage>125</lpage><pub-id pub-id-type="doi">10.1111/j.1601-5223.1992.tb00165.x</pub-id><pub-id pub-id-type="pmid">1459855</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bull</surname><given-names>V</given-names></name><name><surname>Beltrán</surname><given-names>M</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Bermingham</surname><given-names>E</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Polyphyly and gene flow between non-sibling Heliconius species</article-title><source>BMC Biology</source><volume>4</volume><elocation-id>11</elocation-id><pub-id pub-id-type="doi">10.1186/1741-7007-4-11</pub-id><pub-id pub-id-type="pmid">16630334</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgess</surname><given-names>R</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Estimation of hominoid ancestral population sizes under bayesian coalescent models incorporating mutation rate variation and sequencing errors</article-title><source>Molecular Biology and Evolution</source><volume>25</volume><fpage>1979</fpage><lpage>1994</lpage><pub-id pub-id-type="doi">10.1093/molbev/msn148</pub-id><pub-id pub-id-type="pmid">18603620</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calfee</surname><given-names>E</given-names></name><name><surname>Gates</surname><given-names>D</given-names></name><name><surname>Lorant</surname><given-names>A</given-names></name><name><surname>Perkins</surname><given-names>MT</given-names></name><name><surname>Coop</surname><given-names>G</given-names></name><name><surname>Ross-Ibarra</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Selective sorting of ancestral introgression in maize and teosinte along an elevational cline</article-title><source>PLOS Genetics</source><volume>17</volume><elocation-id>e1009810</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1009810</pub-id><pub-id pub-id-type="pmid">34634032</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cicconardi</surname><given-names>F</given-names></name><name><surname>Milanetti</surname><given-names>E</given-names></name><name><surname>Pinheiro de Castro</surname><given-names>EC</given-names></name><name><surname>Mazo-Vargas</surname><given-names>A</given-names></name><name><surname>Van Belleghem</surname><given-names>SM</given-names></name><name><surname>Ruggieri</surname><given-names>AA</given-names></name><name><surname>Rastas</surname><given-names>P</given-names></name><name><surname>Hanly</surname><given-names>J</given-names></name><name><surname>Evans</surname><given-names>E</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name><name><surname>Owen McMillan</surname><given-names>W</given-names></name><name><surname>Papa</surname><given-names>R</given-names></name><name><surname>Di Marino</surname><given-names>D</given-names></name><name><surname>Martin</surname><given-names>A</given-names></name><name><surname>Montgomery</surname><given-names>SH</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Evolutionary dynamics of genome size and content during the adaptive radiation of Heliconiini butterflies</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>5620</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-41412-5</pub-id><pub-id pub-id-type="pmid">37699868</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dalquen</surname><given-names>DA</given-names></name><name><surname>Zhu</surname><given-names>T</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Maximum likelihood implementation of an isolation-with-migration model for three species</article-title><source>Systematic Biology</source><volume>66</volume><fpage>379</fpage><lpage>398</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syw063</pub-id><pub-id pub-id-type="pmid">27486180</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>MA</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><name><surname>Poplin</surname><given-names>R</given-names></name><name><surname>Garimella</surname><given-names>KV</given-names></name><name><surname>Maguire</surname><given-names>JR</given-names></name><name><surname>Hartl</surname><given-names>C</given-names></name><name><surname>Philippakis</surname><given-names>AA</given-names></name><name><surname>del Angel</surname><given-names>G</given-names></name><name><surname>Rivas</surname><given-names>MA</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Fennell</surname><given-names>TJ</given-names></name><name><surname>Kernytsky</surname><given-names>AM</given-names></name><name><surname>Sivachenko</surname><given-names>AY</given-names></name><name><surname>Cibulskis</surname><given-names>K</given-names></name><name><surname>Gabriel</surname><given-names>SB</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title><source>Nature Genetics</source><volume>43</volume><fpage>491</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1038/ng.806</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edelman</surname><given-names>NB</given-names></name><name><surname>Frandsen</surname><given-names>PB</given-names></name><name><surname>Miyagi</surname><given-names>M</given-names></name><name><surname>Clavijo</surname><given-names>B</given-names></name><name><surname>Davey</surname><given-names>J</given-names></name><name><surname>Dikow</surname><given-names>RB</given-names></name><name><surname>García-Accinelli</surname><given-names>G</given-names></name><name><surname>Van Belleghem</surname><given-names>SM</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Neafsey</surname><given-names>DE</given-names></name><name><surname>Challis</surname><given-names>R</given-names></name><name><surname>Kumar</surname><given-names>S</given-names></name><name><surname>Moreira</surname><given-names>GRP</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Chouteau</surname><given-names>M</given-names></name><name><surname>Counterman</surname><given-names>BA</given-names></name><name><surname>Papa</surname><given-names>R</given-names></name><name><surname>Blaxter</surname><given-names>M</given-names></name><name><surname>Reed</surname><given-names>RD</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name><name><surname>Kronforst</surname><given-names>M</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Di Palma</surname><given-names>F</given-names></name><name><surname>Blumberg</surname><given-names>AJ</given-names></name><name><surname>Wakeley</surname><given-names>J</given-names></name><name><surname>Jaffe</surname><given-names>D</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Genomic architecture and introgression shape a butterfly radiation</article-title><source>Science</source><volume>366</volume><fpage>594</fpage><lpage>599</lpage><pub-id pub-id-type="doi">10.1126/science.aaw2090</pub-id><pub-id pub-id-type="pmid">31672890</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edwards</surname><given-names>SV</given-names></name><name><surname>Xi</surname><given-names>Z</given-names></name><name><surname>Janke</surname><given-names>A</given-names></name><name><surname>Faircloth</surname><given-names>BC</given-names></name><name><surname>McCormack</surname><given-names>JE</given-names></name><name><surname>Glenn</surname><given-names>TC</given-names></name><name><surname>Zhong</surname><given-names>B</given-names></name><name><surname>Wu</surname><given-names>S</given-names></name><name><surname>Lemmon</surname><given-names>EM</given-names></name><name><surname>Lemmon</surname><given-names>AR</given-names></name><name><surname>Leaché</surname><given-names>AD</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Davis</surname><given-names>CC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Implementing and testing the multispecies coalescent model: A valuable paradigm for phylogenomics</article-title><source>Molecular Phylogenetics and Evolution</source><volume>94</volume><fpage>447</fpage><lpage>462</lpage><pub-id pub-id-type="doi">10.1016/j.ympev.2015.10.027</pub-id><pub-id pub-id-type="pmid">26518740</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enciso-Romero</surname><given-names>J</given-names></name><name><surname>Pardo-Díaz</surname><given-names>C</given-names></name><name><surname>Martin</surname><given-names>SH</given-names></name><name><surname>Arias</surname><given-names>CF</given-names></name><name><surname>Linares</surname><given-names>M</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Evolution of novel mimicry rings facilitated by adaptive introgression in tropical butterflies</article-title><source>Molecular Ecology</source><volume>26</volume><fpage>5160</fpage><lpage>5172</lpage><pub-id pub-id-type="doi">10.1111/mec.14277</pub-id><pub-id pub-id-type="pmid">28777894</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flouri</surname><given-names>T</given-names></name><name><surname>Jiao</surname><given-names>X</given-names></name><name><surname>Rannala</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Yoder</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Species tree inference with BPP using genomic sequences and the multispecies coalescent</article-title><source>Molecular Biology and Evolution</source><volume>35</volume><fpage>2585</fpage><lpage>2593</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy147</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flouri</surname><given-names>T</given-names></name><name><surname>Jiao</surname><given-names>X</given-names></name><name><surname>Rannala</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Rosenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A Bayesian implementation of the multispecies coalescent model with introgression for phylogenomic analysis</article-title><source>Molecular Biology and Evolution</source><volume>37</volume><fpage>1211</fpage><lpage>1223</lpage><pub-id pub-id-type="doi">10.1093/molbev/msz296</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flouri</surname><given-names>T</given-names></name><name><surname>Jiao</surname><given-names>X</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Rannala</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Efficient Bayesian inference under the multispecies coalescent with migration</article-title><source>PNAS</source><volume>120</volume><elocation-id>e2310708120</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2310708120</pub-id><pub-id pub-id-type="pmid">37871206</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fontaine</surname><given-names>MC</given-names></name><name><surname>Pease</surname><given-names>JB</given-names></name><name><surname>Steele</surname><given-names>A</given-names></name><name><surname>Waterhouse</surname><given-names>RM</given-names></name><name><surname>Neafsey</surname><given-names>DE</given-names></name><name><surname>Sharakhov</surname><given-names>IV</given-names></name><name><surname>Jiang</surname><given-names>X</given-names></name><name><surname>Hall</surname><given-names>AB</given-names></name><name><surname>Catteruccia</surname><given-names>F</given-names></name><name><surname>Kakani</surname><given-names>E</given-names></name><name><surname>Mitchell</surname><given-names>SN</given-names></name><name><surname>Wu</surname><given-names>Y-C</given-names></name><name><surname>Smith</surname><given-names>HA</given-names></name><name><surname>Love</surname><given-names>RR</given-names></name><name><surname>Lawniczak</surname><given-names>MK</given-names></name><name><surname>Slotman</surname><given-names>MA</given-names></name><name><surname>Emrich</surname><given-names>SJ</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name><name><surname>Besansky</surname><given-names>NJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Extensive introgression in a malaria vector species complex revealed by phylogenomics</article-title><source>Science</source><volume>347</volume><elocation-id>1258524</elocation-id><pub-id pub-id-type="doi">10.1126/science.1258524</pub-id><pub-id pub-id-type="pmid">25431491</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaunitz</surname><given-names>C</given-names></name><name><surname>Fages</surname><given-names>A</given-names></name><name><surname>Hanghøj</surname><given-names>K</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><name><surname>Khan</surname><given-names>N</given-names></name><name><surname>Schubert</surname><given-names>M</given-names></name><name><surname>Seguin-Orlando</surname><given-names>A</given-names></name><name><surname>Owens</surname><given-names>IJ</given-names></name><name><surname>Felkel</surname><given-names>S</given-names></name><name><surname>Bignon-Lau</surname><given-names>O</given-names></name><name><surname>de Barros Damgaard</surname><given-names>P</given-names></name><name><surname>Mittnik</surname><given-names>A</given-names></name><name><surname>Mohaseb</surname><given-names>AF</given-names></name><name><surname>Davoudi</surname><given-names>H</given-names></name><name><surname>Alquraishi</surname><given-names>S</given-names></name><name><surname>Alfarhan</surname><given-names>AH</given-names></name><name><surname>Al-Rasheid</surname><given-names>KAS</given-names></name><name><surname>Crubézy</surname><given-names>E</given-names></name><name><surname>Benecke</surname><given-names>N</given-names></name><name><surname>Olsen</surname><given-names>S</given-names></name><name><surname>Brown</surname><given-names>D</given-names></name><name><surname>Anthony</surname><given-names>D</given-names></name><name><surname>Massy</surname><given-names>K</given-names></name><name><surname>Pitulko</surname><given-names>V</given-names></name><name><surname>Kasparov</surname><given-names>A</given-names></name><name><surname>Brem</surname><given-names>G</given-names></name><name><surname>Hofreiter</surname><given-names>M</given-names></name><name><surname>Mukhtarova</surname><given-names>G</given-names></name><name><surname>Baimukhanov</surname><given-names>N</given-names></name><name><surname>Lõugas</surname><given-names>L</given-names></name><name><surname>Onar</surname><given-names>V</given-names></name><name><surname>Stockhammer</surname><given-names>PW</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name><name><surname>Boldgiv</surname><given-names>B</given-names></name><name><surname>Undrakhbold</surname><given-names>S</given-names></name><name><surname>Erdenebaatar</surname><given-names>D</given-names></name><name><surname>Lepetz</surname><given-names>S</given-names></name><name><surname>Mashkour</surname><given-names>M</given-names></name><name><surname>Ludwig</surname><given-names>A</given-names></name><name><surname>Wallner</surname><given-names>B</given-names></name><name><surname>Merz</surname><given-names>V</given-names></name><name><surname>Merz</surname><given-names>I</given-names></name><name><surname>Zaibert</surname><given-names>V</given-names></name><name><surname>Willerslev</surname><given-names>E</given-names></name><name><surname>Librado</surname><given-names>P</given-names></name><name><surname>Outram</surname><given-names>AK</given-names></name><name><surname>Orlando</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Ancient genomes revisit the ancestry of domestic and Przewalski’s horses</article-title><source>Science</source><volume>360</volume><fpage>111</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1126/science.aao3297</pub-id><pub-id pub-id-type="pmid">29472442</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilbert</surname><given-names>LE</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Pollen feeding and reproductive biology of heliconius butterflies</article-title><source>PNAS</source><volume>69</volume><fpage>1403</fpage><lpage>1407</lpage><pub-id pub-id-type="doi">10.1073/pnas.69.6.1403</pub-id><pub-id pub-id-type="pmid">16591992</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gopalakrishnan</surname><given-names>S</given-names></name><name><surname>Sinding</surname><given-names>MHS</given-names></name><name><surname>Ramos-Madrigal</surname><given-names>J</given-names></name><name><surname>Niemann</surname><given-names>J</given-names></name><name><surname>Samaniego Castruita</surname><given-names>JA</given-names></name><name><surname>Vieira</surname><given-names>FG</given-names></name><name><surname>Carøe</surname><given-names>C</given-names></name><name><surname>Montero</surname><given-names>M de M</given-names></name><name><surname>Kuderna</surname><given-names>L</given-names></name><name><surname>Serres</surname><given-names>A</given-names></name><name><surname>González-Basallote</surname><given-names>VM</given-names></name><name><surname>Liu</surname><given-names>YH</given-names></name><name><surname>Wang</surname><given-names>GD</given-names></name><name><surname>Marques-Bonet</surname><given-names>T</given-names></name><name><surname>Mirarab</surname><given-names>S</given-names></name><name><surname>Fernandes</surname><given-names>C</given-names></name><name><surname>Gaubert</surname><given-names>P</given-names></name><name><surname>Koepfli</surname><given-names>KP</given-names></name><name><surname>Budd</surname><given-names>J</given-names></name><name><surname>Rueness</surname><given-names>EK</given-names></name><name><surname>Sillero</surname><given-names>C</given-names></name><name><surname>Heide-Jørgensen</surname><given-names>MP</given-names></name><name><surname>Petersen</surname><given-names>B</given-names></name><name><surname>Sicheritz-Ponten</surname><given-names>T</given-names></name><name><surname>Bachmann</surname><given-names>L</given-names></name><name><surname>Wiig</surname><given-names>Ø</given-names></name><name><surname>Hansen</surname><given-names>AJ</given-names></name><name><surname>Gilbert</surname><given-names>MTP</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Interspecific Gene Flow Shaped the Evolution of the Genus Canis</article-title><source>Current Biology</source><volume>28</volume><fpage>3441</fpage><lpage>3449</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.08.041</pub-id><pub-id pub-id-type="pmid">30344120</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>Heliconius Genome Consortium</collab></person-group><year iso-8601-date="2012">2012</year><article-title>Butterfly genome reveals promiscuous exchange of mimicry adaptations among species</article-title><source>Nature</source><volume>487</volume><fpage>94</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1038/nature11041</pub-id><pub-id pub-id-type="pmid">22722851</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Thawornwattana</surname><given-names>Y</given-names></name><name><surname>Flouri</surname><given-names>T</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Pupko</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Inference of gene flow between species under misspecified models</article-title><source>Molecular Biology and Evolution</source><volume>39</volume><elocation-id>12</elocation-id><pub-id pub-id-type="doi">10.1093/molbev/msac237</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jay</surname><given-names>P</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Frézal</surname><given-names>L</given-names></name><name><surname>Rodríguez de Cara</surname><given-names>MÁ</given-names></name><name><surname>Nowell</surname><given-names>RW</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Supergene evolution triggered by the introgression of a chromosomal inversion</article-title><source>Current Biology</source><volume>28</volume><fpage>1839</fpage><lpage>1845</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.04.072</pub-id><pub-id pub-id-type="pmid">29804810</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jay</surname><given-names>P</given-names></name><name><surname>Chouteau</surname><given-names>M</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Bastide</surname><given-names>H</given-names></name><name><surname>Parrinello</surname><given-names>H</given-names></name><name><surname>Llaurens</surname><given-names>V</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Mutation load at a mimicry supergene sheds new light on the evolution of inversion polymorphisms</article-title><source>Nature Genetics</source><volume>53</volume><fpage>288</fpage><lpage>293</lpage><pub-id pub-id-type="doi">10.1038/s41588-020-00771-1</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jay</surname><given-names>P</given-names></name><name><surname>Leroy</surname><given-names>M</given-names></name><name><surname>Le Poul</surname><given-names>Y</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Arias</surname><given-names>M</given-names></name><name><surname>Chouteau</surname><given-names>M</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Association mapping of colour variation in a butterfly provides evidence that a supergene locks together a cluster of adaptive loci</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>377</volume><elocation-id>20210193</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2021.0193</pub-id><pub-id pub-id-type="pmid">35694756</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiao</surname><given-names>X</given-names></name><name><surname>Flouri</surname><given-names>T</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Multispecies coalescent and its applications to infer species phylogenies and cross-species gene flow</article-title><source>National Science Review</source><volume>8</volume><elocation-id>wab127</elocation-id><pub-id pub-id-type="doi">10.1093/nsr/nwab127</pub-id><pub-id pub-id-type="pmid">34987842</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jónsson</surname><given-names>H</given-names></name><name><surname>Schubert</surname><given-names>M</given-names></name><name><surname>Seguin-Orlando</surname><given-names>A</given-names></name><name><surname>Ginolhac</surname><given-names>A</given-names></name><name><surname>Petersen</surname><given-names>L</given-names></name><name><surname>Fumagalli</surname><given-names>M</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><name><surname>Petersen</surname><given-names>B</given-names></name><name><surname>Korneliussen</surname><given-names>TS</given-names></name><name><surname>Vilstrup</surname><given-names>JT</given-names></name><name><surname>Lear</surname><given-names>T</given-names></name><name><surname>Myka</surname><given-names>JL</given-names></name><name><surname>Lundquist</surname><given-names>J</given-names></name><name><surname>Miller</surname><given-names>DC</given-names></name><name><surname>Alfarhan</surname><given-names>AH</given-names></name><name><surname>Alquraishi</surname><given-names>SA</given-names></name><name><surname>Al-Rasheid</surname><given-names>KAS</given-names></name><name><surname>Stagegaard</surname><given-names>J</given-names></name><name><surname>Strauss</surname><given-names>G</given-names></name><name><surname>Bertelsen</surname><given-names>MF</given-names></name><name><surname>Sicheritz-Ponten</surname><given-names>T</given-names></name><name><surname>Antczak</surname><given-names>DF</given-names></name><name><surname>Bailey</surname><given-names>E</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Willerslev</surname><given-names>E</given-names></name><name><surname>Orlando</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Speciation with gene flow in equids despite extensive chromosomal plasticity</article-title><source>PNAS</source><volume>111</volume><fpage>18655</fpage><lpage>18660</lpage><pub-id pub-id-type="doi">10.1073/pnas.1412627111</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joron</surname><given-names>M</given-names></name><name><surname>Papa</surname><given-names>R</given-names></name><name><surname>Beltrán</surname><given-names>M</given-names></name><name><surname>Chamberlain</surname><given-names>N</given-names></name><name><surname>Mavárez</surname><given-names>J</given-names></name><name><surname>Baxter</surname><given-names>S</given-names></name><name><surname>Abanto</surname><given-names>M</given-names></name><name><surname>Bermingham</surname><given-names>E</given-names></name><name><surname>Humphray</surname><given-names>SJ</given-names></name><name><surname>Rogers</surname><given-names>J</given-names></name><name><surname>Beasley</surname><given-names>H</given-names></name><name><surname>Barlow</surname><given-names>K</given-names></name><name><surname>ffrench-Constant</surname><given-names>RH</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A conserved supergene locus controls colour pattern diversity in Heliconius butterflies</article-title><source>PLOS Biology</source><volume>4</volume><elocation-id>e303</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0040303</pub-id><pub-id pub-id-type="pmid">17002517</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joron</surname><given-names>M</given-names></name><name><surname>Frezal</surname><given-names>L</given-names></name><name><surname>Jones</surname><given-names>RT</given-names></name><name><surname>Chamberlain</surname><given-names>NL</given-names></name><name><surname>Lee</surname><given-names>SF</given-names></name><name><surname>Haag</surname><given-names>CR</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Becuwe</surname><given-names>M</given-names></name><name><surname>Baxter</surname><given-names>SW</given-names></name><name><surname>Ferguson</surname><given-names>L</given-names></name><name><surname>Wilkinson</surname><given-names>PA</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Davidson</surname><given-names>C</given-names></name><name><surname>Clark</surname><given-names>R</given-names></name><name><surname>Quail</surname><given-names>MA</given-names></name><name><surname>Beasley</surname><given-names>H</given-names></name><name><surname>Glithero</surname><given-names>R</given-names></name><name><surname>Lloyd</surname><given-names>C</given-names></name><name><surname>Sims</surname><given-names>S</given-names></name><name><surname>Jones</surname><given-names>MC</given-names></name><name><surname>Rogers</surname><given-names>J</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name><name><surname>ffrench-Constant</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Chromosomal rearrangements maintain a polymorphic supergene controlling butterfly mimicry</article-title><source>Nature</source><volume>477</volume><fpage>203</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1038/nature10341</pub-id><pub-id pub-id-type="pmid">21841803</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keightley</surname><given-names>PD</given-names></name><name><surname>Pinharanda</surname><given-names>A</given-names></name><name><surname>Ness</surname><given-names>RW</given-names></name><name><surname>Simpson</surname><given-names>F</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Davey</surname><given-names>JW</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Estimation of the spontaneous mutation rate in <italic>Heliconius melpomene</italic></article-title><source>Molecular Biology and Evolution</source><volume>32</volume><fpage>239</fpage><lpage>243</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu302</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozak</surname><given-names>KM</given-names></name><name><surname>Wahlberg</surname><given-names>N</given-names></name><name><surname>Neild</surname><given-names>AFE</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Multilocus species trees show the recent adaptive radiation of the mimetic heliconius butterflies</article-title><source>Systematic Biology</source><volume>64</volume><fpage>505</fpage><lpage>524</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syv007</pub-id><pub-id pub-id-type="pmid">25634098</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozak</surname><given-names>KM</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Rampant genome-wide admixture across the <italic>Heliconius</italic> radiation</article-title><source>Genome Biology and Evolution</source><volume>13</volume><elocation-id>evab099</elocation-id><pub-id pub-id-type="doi">10.1093/gbe/evab099</pub-id><pub-id pub-id-type="pmid">33944917</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kronforst</surname><given-names>MR</given-names></name><name><surname>Hansen</surname><given-names>MEB</given-names></name><name><surname>Crawford</surname><given-names>NG</given-names></name><name><surname>Gallant</surname><given-names>JR</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Kulathinal</surname><given-names>RJ</given-names></name><name><surname>Kapan</surname><given-names>DD</given-names></name><name><surname>Mullen</surname><given-names>SP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hybridization reveals the evolving genomic architecture of speciation</article-title><source>Cell Reports</source><volume>5</volume><fpage>666</fpage><lpage>677</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2013.09.042</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhlwilm</surname><given-names>M</given-names></name><name><surname>Gronau</surname><given-names>I</given-names></name><name><surname>Hubisz</surname><given-names>MJ</given-names></name><name><surname>de Filippo</surname><given-names>C</given-names></name><name><surname>Prado-Martinez</surname><given-names>J</given-names></name><name><surname>Kircher</surname><given-names>M</given-names></name><name><surname>Fu</surname><given-names>Q</given-names></name><name><surname>Burbano</surname><given-names>HA</given-names></name><name><surname>Lalueza-Fox</surname><given-names>C</given-names></name><name><surname>de la Rasilla</surname><given-names>M</given-names></name><name><surname>Rosas</surname><given-names>A</given-names></name><name><surname>Rudan</surname><given-names>P</given-names></name><name><surname>Brajkovic</surname><given-names>D</given-names></name><name><surname>Kucan</surname><given-names>Ž</given-names></name><name><surname>Gušic</surname><given-names>I</given-names></name><name><surname>Marques-Bonet</surname><given-names>T</given-names></name><name><surname>Andrés</surname><given-names>AM</given-names></name><name><surname>Viola</surname><given-names>B</given-names></name><name><surname>Pääbo</surname><given-names>S</given-names></name><name><surname>Meyer</surname><given-names>M</given-names></name><name><surname>Siepel</surname><given-names>A</given-names></name><name><surname>Castellano</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Ancient gene flow from early modern humans into Eastern Neanderthals</article-title><source>Nature</source><volume>530</volume><fpage>429</fpage><lpage>433</lpage><pub-id pub-id-type="doi">10.1038/nature16544</pub-id><pub-id pub-id-type="pmid">26886800</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lamichhaney</surname><given-names>S</given-names></name><name><surname>Han</surname><given-names>F</given-names></name><name><surname>Webster</surname><given-names>MT</given-names></name><name><surname>Andersson</surname><given-names>L</given-names></name><name><surname>Grant</surname><given-names>BR</given-names></name><name><surname>Grant</surname><given-names>PR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Rapid hybrid speciation in Darwin’s finches</article-title><source>Science</source><volume>359</volume><fpage>224</fpage><lpage>228</lpage><pub-id pub-id-type="doi">10.1126/science.aao4593</pub-id><pub-id pub-id-type="pmid">29170277</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lartillot</surname><given-names>N</given-names></name><name><surname>Philippe</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Computing Bayes factors using thermodynamic integration</article-title><source>Systematic Biology</source><volume>55</volume><fpage>195</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1080/10635150500433722</pub-id><pub-id pub-id-type="pmid">16522570</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leducq</surname><given-names>JB</given-names></name><name><surname>Nielly-Thibault</surname><given-names>L</given-names></name><name><surname>Charron</surname><given-names>G</given-names></name><name><surname>Eberlein</surname><given-names>C</given-names></name><name><surname>Verta</surname><given-names>JP</given-names></name><name><surname>Samani</surname><given-names>P</given-names></name><name><surname>Sylvester</surname><given-names>K</given-names></name><name><surname>Hittinger</surname><given-names>CT</given-names></name><name><surname>Bell</surname><given-names>G</given-names></name><name><surname>Landry</surname><given-names>CR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Speciation driven by hybridization and chromosomal plasticity in a wild yeast</article-title><source>Nature Microbiology</source><volume>1</volume><elocation-id>15003</elocation-id><pub-id pub-id-type="doi">10.1038/nmicrobiol.2015.3</pub-id><pub-id pub-id-type="pmid">27571751</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Poul</surname><given-names>Y</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Chouteau</surname><given-names>M</given-names></name><name><surname>Prunier</surname><given-names>F</given-names></name><name><surname>Llaurens</surname><given-names>V</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Evolution of dominance mechanisms at a butterfly mimicry supergene</article-title><source>Nature Communications</source><volume>5</volume><elocation-id>5644</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms6644</pub-id><pub-id pub-id-type="pmid">25429605</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><name><surname>Fennell</surname><given-names>T</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Homer</surname><given-names>N</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name><name><surname>Abecasis</surname><given-names>G</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name><collab>1000 Genome Project Data Processing Subgroup</collab></person-group><year iso-8601-date="2009">2009</year><article-title>The sequence alignment/map format and SAMtools</article-title><source>Bioinformatics</source><volume>25</volume><fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title><source>Bioinformatics</source><volume>27</volume><fpage>2987</fpage><lpage>2993</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id><pub-id pub-id-type="pmid">21903627</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Aligning Sequence Reads, Clone Sequences and Assembly Contigs with BWA-MEM</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.1303.3997</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Davis</surname><given-names>BW</given-names></name><name><surname>Eizirik</surname><given-names>E</given-names></name><name><surname>Murphy</surname><given-names>WJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Phylogenomic evidence for ancient hybridization in the genomes of living cats (Felidae)</article-title><source>Genome Research</source><volume>26</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1101/gr.186668.114</pub-id><pub-id pub-id-type="pmid">26518481</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Gang</given-names></name><name><surname>Figueiró</surname><given-names>HV</given-names></name><name><surname>Eizirik</surname><given-names>E</given-names></name><name><surname>Murphy</surname><given-names>WJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Recombination-Aware phylogenomics reveals the structured genomic landscape of hybridizing cat species</article-title><source>Molecular Biology and Evolution</source><volume>36</volume><fpage>2111</fpage><lpage>2126</lpage><pub-id pub-id-type="doi">10.1093/molbev/msz139</pub-id><pub-id pub-id-type="pmid">31198971</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malinsky</surname><given-names>M</given-names></name><name><surname>Svardal</surname><given-names>H</given-names></name><name><surname>Tyers</surname><given-names>AM</given-names></name><name><surname>Miska</surname><given-names>EA</given-names></name><name><surname>Genner</surname><given-names>MJ</given-names></name><name><surname>Turner</surname><given-names>GF</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Whole-genome sequences of Malawi cichlids reveal multiple radiations interconnected by gene flow</article-title><source>Nature Ecology &amp; Evolution</source><volume>2</volume><fpage>1940</fpage><lpage>1955</lpage><pub-id pub-id-type="doi">10.1038/s41559-018-0717-x</pub-id><pub-id pub-id-type="pmid">30455444</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Beltrán</surname><given-names>M</given-names></name><name><surname>Neukirchen</surname><given-names>W</given-names></name><name><surname>Linares</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Natural hybridization in heliconiine butterflies: The species boundary as a continuum</article-title><source>BMC Evolutionary Biology</source><volume>7</volume><elocation-id>28</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2148-7-28</pub-id><pub-id pub-id-type="pmid">17319954</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>SH</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name><name><surname>Nadeau</surname><given-names>NJ</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Walters</surname><given-names>JR</given-names></name><name><surname>Simpson</surname><given-names>F</given-names></name><name><surname>Blaxter</surname><given-names>M</given-names></name><name><surname>Manica</surname><given-names>A</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genome-wide evidence for speciation with gene flow in <italic>Heliconius</italic> butterflies</article-title><source>Genome Research</source><volume>23</volume><fpage>1817</fpage><lpage>1828</lpage><pub-id pub-id-type="doi">10.1101/gr.159426.113</pub-id><pub-id pub-id-type="pmid">24045163</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>SH</given-names></name><name><surname>Davey</surname><given-names>JW</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Recombination rate variation shapes barriers to introgression across butterfly genomes</article-title><source>PLOS Biology</source><volume>17</volume><elocation-id>e2006288</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2006288</pub-id><pub-id pub-id-type="pmid">30730876</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Massardo</surname><given-names>D</given-names></name><name><surname>VanKuren</surname><given-names>NW</given-names></name><name><surname>Nallu</surname><given-names>S</given-names></name><name><surname>Ramos</surname><given-names>RR</given-names></name><name><surname>Ribeiro</surname><given-names>PG</given-names></name><name><surname>Silva-Brandão</surname><given-names>KL</given-names></name><name><surname>Brandão</surname><given-names>MM</given-names></name><name><surname>Lion</surname><given-names>MB</given-names></name><name><surname>Freitas</surname><given-names>AVL</given-names></name><name><surname>Cardoso</surname><given-names>MZ</given-names></name><name><surname>Kronforst</surname><given-names>MR</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The roles of hybridization and habitat fragmentation in the evolution of Brazil’s enigmatic longwing butterflies, <italic>Heliconius nattereri</italic> and <italic>H. hermathena</italic></article-title><source>BMC Biology</source><volume>18</volume><elocation-id>84</elocation-id><pub-id pub-id-type="doi">10.1186/s12915-020-00797-1</pub-id><pub-id pub-id-type="pmid">32620168</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><name><surname>Sivachenko</surname><given-names>A</given-names></name><name><surname>Cibulskis</surname><given-names>K</given-names></name><name><surname>Kernytsky</surname><given-names>A</given-names></name><name><surname>Garimella</surname><given-names>K</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Gabriel</surname><given-names>S</given-names></name><name><surname>Daly</surname><given-names>M</given-names></name><name><surname>DePristo</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The genome analysis toolkit: A mapreduce framework for analyzing next-generation DNA sequencing data</article-title><source>Genome Research</source><volume>20</volume><fpage>1297</fpage><lpage>1303</lpage><pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id><pub-id pub-id-type="pmid">20644199</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirarab</surname><given-names>S</given-names></name><name><surname>Nakhleh</surname><given-names>L</given-names></name><name><surname>Warnow</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Multispecies coalescent: Theory and applications in phylogenetics</article-title><source>Annual Review of Ecology, Evolution, and Systematics</source><volume>52</volume><fpage>247</fpage><lpage>268</lpage><pub-id pub-id-type="doi">10.1146/annurev-ecolsys-012121-095340</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>J</given-names></name><name><surname>Hanly</surname><given-names>JJ</given-names></name><name><surname>Martin</surname><given-names>SH</given-names></name><name><surname>Van Belleghem</surname><given-names>SM</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Deep Convergence, Shared Ancestry, and Evolutionary Novelty in the Genetic Architecture of <italic>Heliconius</italic> Mimicry</article-title><source>Genetics</source><volume>216</volume><fpage>765</fpage><lpage>780</lpage><pub-id pub-id-type="doi">10.1534/genetics.120.303611</pub-id><pub-id pub-id-type="pmid">32883703</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadeau</surname><given-names>NJ</given-names></name><name><surname>Pardo-Diaz</surname><given-names>C</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Supple</surname><given-names>MA</given-names></name><name><surname>Saenko</surname><given-names>SV</given-names></name><name><surname>Wallbank</surname><given-names>RWR</given-names></name><name><surname>Wu</surname><given-names>GC</given-names></name><name><surname>Maroja</surname><given-names>L</given-names></name><name><surname>Ferguson</surname><given-names>L</given-names></name><name><surname>Hanly</surname><given-names>JJ</given-names></name><name><surname>Hines</surname><given-names>H</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Merrill</surname><given-names>RM</given-names></name><name><surname>Dowling</surname><given-names>AJ</given-names></name><name><surname>ffrench-Constant</surname><given-names>RH</given-names></name><name><surname>Llaurens</surname><given-names>V</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The gene cortex controls mimicry and crypsis in butterflies and moths</article-title><source>Nature</source><volume>534</volume><fpage>106</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1038/nature17961</pub-id><pub-id pub-id-type="pmid">27251285</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palkopoulou</surname><given-names>E</given-names></name><name><surname>Lipson</surname><given-names>M</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Nielsen</surname><given-names>S</given-names></name><name><surname>Rohland</surname><given-names>N</given-names></name><name><surname>Baleka</surname><given-names>S</given-names></name><name><surname>Karpinski</surname><given-names>E</given-names></name><name><surname>Ivancevic</surname><given-names>AM</given-names></name><name><surname>To</surname><given-names>T-H</given-names></name><name><surname>Kortschak</surname><given-names>RD</given-names></name><name><surname>Raison</surname><given-names>JM</given-names></name><name><surname>Qu</surname><given-names>Z</given-names></name><name><surname>Chin</surname><given-names>T-J</given-names></name><name><surname>Alt</surname><given-names>KW</given-names></name><name><surname>Claesson</surname><given-names>S</given-names></name><name><surname>Dalén</surname><given-names>L</given-names></name><name><surname>MacPhee</surname><given-names>RDE</given-names></name><name><surname>Meller</surname><given-names>H</given-names></name><name><surname>Roca</surname><given-names>AL</given-names></name><name><surname>Ryder</surname><given-names>OA</given-names></name><name><surname>Heiman</surname><given-names>D</given-names></name><name><surname>Young</surname><given-names>S</given-names></name><name><surname>Breen</surname><given-names>M</given-names></name><name><surname>Williams</surname><given-names>C</given-names></name><name><surname>Aken</surname><given-names>BL</given-names></name><name><surname>Ruffier</surname><given-names>M</given-names></name><name><surname>Karlsson</surname><given-names>E</given-names></name><name><surname>Johnson</surname><given-names>J</given-names></name><name><surname>Di Palma</surname><given-names>F</given-names></name><name><surname>Alfoldi</surname><given-names>J</given-names></name><name><surname>Adelson</surname><given-names>DL</given-names></name><name><surname>Mailund</surname><given-names>T</given-names></name><name><surname>Munch</surname><given-names>K</given-names></name><name><surname>Lindblad-Toh</surname><given-names>K</given-names></name><name><surname>Hofreiter</surname><given-names>M</given-names></name><name><surname>Poinar</surname><given-names>H</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A comprehensive genomic history of extinct and living elephants</article-title><source>PNAS</source><volume>115</volume><fpage>E2566</fpage><lpage>E2574</lpage><pub-id pub-id-type="doi">10.1073/pnas.1720554115</pub-id><pub-id pub-id-type="pmid">29483247</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pardo-Diaz</surname><given-names>C</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Baxter</surname><given-names>SW</given-names></name><name><surname>Merot</surname><given-names>C</given-names></name><name><surname>Figueiredo-Ready</surname><given-names>W</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Adaptive introgression across species boundaries in <italic>Heliconius</italic> butterflies</article-title><source>PLOS Genetics</source><volume>8</volume><elocation-id>e1002752</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002752</pub-id><pub-id pub-id-type="pmid">22737081</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Penz</surname><given-names>CM</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Higher level phylogeny for the passion-vine butterflies (<italic>Nymphalidae</italic>, <italic>Heliconiinae</italic>) based on early stage and adult morphology</article-title><source>Zoological Journal of the Linnean Society</source><volume>127</volume><fpage>277</fpage><lpage>344</lpage><pub-id pub-id-type="doi">10.1111/j.1096-3642.1999.tb00680.x</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petry</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>The effect on neutral gene flow of selection at a linked locus</article-title><source>Theoretical Population Biology</source><volume>23</volume><fpage>300</fpage><lpage>313</lpage><pub-id pub-id-type="doi">10.1016/0040-5809(83)90020-5</pub-id><pub-id pub-id-type="pmid">6623407</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Poplin</surname><given-names>R</given-names></name><name><surname>Ruano-Rubio</surname><given-names>V</given-names></name><name><surname>DePristo</surname><given-names>MA</given-names></name><name><surname>Fennell</surname><given-names>TJ</given-names></name><name><surname>Carneiro</surname><given-names>MO</given-names></name><name><surname>Van der Auwera</surname><given-names>GA</given-names></name><name><surname>Kling</surname><given-names>DE</given-names></name><name><surname>Gauthier</surname><given-names>LD</given-names></name><name><surname>Levy-Moonshine</surname><given-names>A</given-names></name><name><surname>Roazen</surname><given-names>D</given-names></name><name><surname>Shakir</surname><given-names>K</given-names></name><name><surname>Thibault</surname><given-names>J</given-names></name><name><surname>Chandran</surname><given-names>S</given-names></name><name><surname>Whelan</surname><given-names>C</given-names></name><name><surname>Lek</surname><given-names>M</given-names></name><name><surname>Gabriel</surname><given-names>S</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Neale</surname><given-names>B</given-names></name><name><surname>MacArthur</surname><given-names>DG</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Scaling accurate genetic variant discovery to tens of thousands of samples</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/201178</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rannala</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Efficient Bayesian species tree inference under the multispecies coalescent</article-title><source>Systematic Biology</source><volume>66</volume><fpage>823</fpage><lpage>842</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syw119</pub-id><pub-id pub-id-type="pmid">28053140</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rieseberg</surname><given-names>LH</given-names></name><name><surname>Raymond</surname><given-names>O</given-names></name><name><surname>Rosenthal</surname><given-names>DM</given-names></name><name><surname>Lai</surname><given-names>Z</given-names></name><name><surname>Livingstone</surname><given-names>K</given-names></name><name><surname>Nakazato</surname><given-names>T</given-names></name><name><surname>Durphy</surname><given-names>JL</given-names></name><name><surname>Schwarzbach</surname><given-names>AE</given-names></name><name><surname>Donovan</surname><given-names>LA</given-names></name><name><surname>Lexer</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Major ecological transitions in wild sunflowers facilitated by hybridization</article-title><source>Science</source><volume>301</volume><fpage>1211</fpage><lpage>1216</lpage><pub-id pub-id-type="doi">10.1126/science.1086949</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosser</surname><given-names>N</given-names></name><name><surname>Phillimore</surname><given-names>AB</given-names></name><name><surname>Huertas</surname><given-names>B</given-names></name><name><surname>Willmott</surname><given-names>KR</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Testing historical explanations for gradients in species richness in heliconiine butterflies of tropical America</article-title><source>Biological Journal of the Linnean Society</source><volume>105</volume><fpage>479</fpage><lpage>497</lpage><pub-id pub-id-type="doi">10.1111/j.1095-8312.2011.01814.x</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosser</surname><given-names>N</given-names></name><name><surname>Kozak</surname><given-names>KM</given-names></name><name><surname>Phillimore</surname><given-names>AB</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Extensive range overlap between heliconiine sister species: evidence for sympatric speciation in butterflies?</article-title><source>BMC Evolutionary Biology</source><volume>15</volume><elocation-id>125</elocation-id><pub-id pub-id-type="doi">10.1186/s12862-015-0420-3</pub-id><pub-id pub-id-type="pmid">26123545</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosser</surname><given-names>Neil</given-names></name><name><surname>Queste</surname><given-names>LM</given-names></name><name><surname>Cama</surname><given-names>B</given-names></name><name><surname>Edelman</surname><given-names>NB</given-names></name><name><surname>Mann</surname><given-names>F</given-names></name><name><surname>Mori Pezo</surname><given-names>R</given-names></name><name><surname>Morris</surname><given-names>J</given-names></name><name><surname>Segami</surname><given-names>C</given-names></name><name><surname>Velado</surname><given-names>P</given-names></name><name><surname>Schulz</surname><given-names>S</given-names></name><name><surname>Mallet</surname><given-names>JLB</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Geographic contrasts between pre- and postzygotic barriers are consistent with reinforcement in Heliconius butterflies</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>73</volume><fpage>1821</fpage><lpage>1838</lpage><pub-id pub-id-type="doi">10.1111/evo.13804</pub-id><pub-id pub-id-type="pmid">31334832</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rougemont</surname><given-names>Q</given-names></name><name><surname>Huber</surname><given-names>B</given-names></name><name><surname>Martin</surname><given-names>SH</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Estrada</surname><given-names>C</given-names></name><name><surname>Solano</surname><given-names>D</given-names></name><name><surname>Orpet</surname><given-names>R</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Frérot</surname><given-names>B</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Subtle introgression footprints at the end of the speciation continuum in a clade of <italic>Heliconius</italic> butterflies</article-title><source>Molecular Biology and Evolution</source><volume>40</volume><elocation-id>msad166</elocation-id><pub-id pub-id-type="doi">10.1093/molbev/msad166</pub-id><pub-id pub-id-type="pmid">37467472</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seixas</surname><given-names>FA</given-names></name><name><surname>Edelman</surname><given-names>NB</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Synteny-based genome assembly for 16 species of <italic>Heliconius</italic> butterflies, and an assessment of structural variation across the genus</article-title><source>Genome Biology and Evolution</source><volume>13</volume><elocation-id>evab069</elocation-id><pub-id pub-id-type="doi">10.1093/gbe/evab069</pub-id><pub-id pub-id-type="pmid">33792688</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>CM</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Coalescent-based analyses of genomic sequence data provide a robust resolution of phylogenetic relationships among major groups of Gibbons</article-title><source>Molecular Biology and Evolution</source><volume>35</volume><fpage>159</fpage><lpage>179</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx277</pub-id><pub-id pub-id-type="pmid">29087487</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Small</surname><given-names>ST</given-names></name><name><surname>Labbé</surname><given-names>F</given-names></name><name><surname>Lobo</surname><given-names>NF</given-names></name><name><surname>Koekemoer</surname><given-names>LL</given-names></name><name><surname>Sikaala</surname><given-names>CH</given-names></name><name><surname>Neafsey</surname><given-names>DE</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name><name><surname>Fontaine</surname><given-names>MC</given-names></name><name><surname>Besansky</surname><given-names>NJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Radiation with reticulation marks the origin of a major malaria vector</article-title><source>PNAS</source><volume>117</volume><fpage>31583</fpage><lpage>31590</lpage><pub-id pub-id-type="doi">10.1073/pnas.2018142117</pub-id><pub-id pub-id-type="pmid">33262284</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>NJ</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>A new statistical method for haplotype reconstruction from population data</article-title><source>American Journal of Human Genetics</source><volume>68</volume><fpage>978</fpage><lpage>989</lpage><pub-id pub-id-type="doi">10.1086/319501</pub-id><pub-id pub-id-type="pmid">11254454</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suvorov</surname><given-names>A</given-names></name><name><surname>Kim</surname><given-names>BY</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Armstrong</surname><given-names>EE</given-names></name><name><surname>Peede</surname><given-names>D</given-names></name><name><surname>D’Agostino</surname><given-names>ERR</given-names></name><name><surname>Price</surname><given-names>DK</given-names></name><name><surname>Waddell</surname><given-names>P</given-names></name><name><surname>Lang</surname><given-names>M</given-names></name><name><surname>Courtier-Orgogozo</surname><given-names>V</given-names></name><name><surname>David</surname><given-names>JR</given-names></name><name><surname>Petrov</surname><given-names>D</given-names></name><name><surname>Matute</surname><given-names>DR</given-names></name><name><surname>Schrider</surname><given-names>DR</given-names></name><name><surname>Comeault</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Widespread introgression across a phylogeny of 155 <italic>Drosophila</italic> genomes</article-title><source>Current Biology</source><volume>32</volume><fpage>111</fpage><lpage>123</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2021.10.052</pub-id><pub-id pub-id-type="pmid">34788634</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tarasov</surname><given-names>A</given-names></name><name><surname>Vilella</surname><given-names>AJ</given-names></name><name><surname>Cuppen</surname><given-names>E</given-names></name><name><surname>Nijman</surname><given-names>IJ</given-names></name><name><surname>Prins</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sambamba: Fast processing of NGS alignment formats</article-title><source>Bioinformatics</source><volume>31</volume><fpage>2032</fpage><lpage>2034</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv098</pub-id><pub-id pub-id-type="pmid">25697820</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thawornwattana</surname><given-names>Y</given-names></name><name><surname>Dalquen</surname><given-names>D</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Coalescent analysis of phylogenomic data confidently resolves the species relationships in the <italic>Anopheles gambiae</italic> species complex</article-title><source>Molecular Biology and Evolution</source><volume>35</volume><fpage>2512</fpage><lpage>2527</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy158</pub-id><pub-id pub-id-type="pmid">30102363</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thawornwattana</surname><given-names>Y</given-names></name><name><surname>Seixas</surname><given-names>FA</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Full-likelihood genomic analysis clarifies a complex history of species divergence and introgression: The example of the erato-sara group of <italic>Heliconius</italic> butterflies</article-title><source>Systematic Biology</source><volume>71</volume><fpage>1159</fpage><lpage>1177</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syac009</pub-id><pub-id pub-id-type="pmid">35169847</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thawornwattana</surname><given-names>Y</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Flouri</surname><given-names>T</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Inferring the direction of introgression using genomic sequence data</article-title><source>Molecular Biology and Evolution</source><volume>40</volume><elocation-id>msad178</elocation-id><pub-id pub-id-type="doi">10.1093/molbev/msad178</pub-id><pub-id pub-id-type="pmid">37552932</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname><given-names>JRG</given-names></name></person-group><year iso-8601-date="1968">1968</year><article-title>Some new Heliconius <italic>pupae</italic>: Their taxonomic and evolutionary significance in relation to mimicry (Lepidoptera, Nymphalidae)*</article-title><source>Journal of Zoology</source><volume>155</volume><fpage>311</fpage><lpage>325</lpage><pub-id pub-id-type="doi">10.1111/j.1469-7998.1968.tb03055.x</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname><given-names>JRG</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Adaptive radiation and convergence in subdivisions of the butterfly genus <italic>Heliconius</italic> (<italic>Lepidoptera</italic>: <italic>Nymphalidae</italic>)</article-title><source>Zoological Journal of the Linnean Society</source><volume>58</volume><fpage>297</fpage><lpage>308</lpage><pub-id pub-id-type="doi">10.1111/j.1096-3642.1976.tb01000.x</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Belleghem</surname><given-names>SM</given-names></name><name><surname>Rastas</surname><given-names>P</given-names></name><name><surname>Papanicolaou</surname><given-names>A</given-names></name><name><surname>Martin</surname><given-names>SH</given-names></name><name><surname>Arias</surname><given-names>CF</given-names></name><name><surname>Supple</surname><given-names>MA</given-names></name><name><surname>Hanly</surname><given-names>JJ</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Lewis</surname><given-names>JJ</given-names></name><name><surname>Hines</surname><given-names>HM</given-names></name><name><surname>Ruiz</surname><given-names>M</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Linares</surname><given-names>M</given-names></name><name><surname>Moreira</surname><given-names>GRP</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name><name><surname>Counterman</surname><given-names>BA</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Papa</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Complex modular architecture around a simple toolkit of wing pattern genes</article-title><source>Nature Ecology &amp; Evolution</source><volume>1</volume><elocation-id>52</elocation-id><pub-id pub-id-type="doi">10.1038/s41559-016-0052</pub-id><pub-id pub-id-type="pmid">28523290</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Belleghem</surname><given-names>SM</given-names></name><name><surname>Baquero</surname><given-names>M</given-names></name><name><surname>Papa</surname><given-names>R</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Counterman</surname><given-names>BA</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name><name><surname>Martin</surname><given-names>SH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Patterns of Z chromosome divergence among Heliconius species highlight the importance of historical demography</article-title><source>Molecular Ecology</source><volume>27</volume><fpage>3852</fpage><lpage>3872</lpage><pub-id pub-id-type="doi">10.1111/mec.14560</pub-id><pub-id pub-id-type="pmid">29569384</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wallbank</surname><given-names>RWR</given-names></name><name><surname>Baxter</surname><given-names>SW</given-names></name><name><surname>Pardo-Diaz</surname><given-names>C</given-names></name><name><surname>Hanly</surname><given-names>JJ</given-names></name><name><surname>Martin</surname><given-names>SH</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name><name><surname>Nadeau</surname><given-names>N</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Evolutionary novelty in a butterfly wing pattern through enhancer shuffling</article-title><source>PLOS Biology</source><volume>14</volume><elocation-id>e1002353</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002353</pub-id><pub-id pub-id-type="pmid">26771987</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname><given-names>D</given-names></name><name><surname>Nakhleh</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Coestimating reticulate phylogenies and gene trees from multilocus sequence data</article-title><source>Systematic Biology</source><volume>67</volume><fpage>439</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syx085</pub-id><pub-id pub-id-type="pmid">29088409</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whitney</surname><given-names>KD</given-names></name><name><surname>Randell</surname><given-names>RA</given-names></name><name><surname>Rieseberg</surname><given-names>LH</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Adaptive introgression of abiotic tolerance traits in the sunflower <italic>Helianthus annuus</italic></article-title><source>The New Phytologist</source><volume>187</volume><fpage>230</fpage><lpage>239</lpage><pub-id pub-id-type="doi">10.1111/j.1469-8137.2010.03234.x</pub-id><pub-id pub-id-type="pmid">20345635</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Rannala</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Bayesian species delimitation using multilocus sequence data</article-title><source>PNAS</source><volume>107</volume><fpage>9264</fpage><lpage>9269</lpage><pub-id pub-id-type="doi">10.1073/pnas.0913022107</pub-id><pub-id pub-id-type="pmid">20439743</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Rannala</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Unguided species delimitation using DNA sequence data from multiple Loci</article-title><source>Molecular Biology and Evolution</source><volume>31</volume><fpage>3125</fpage><lpage>3135</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu279</pub-id><pub-id pub-id-type="pmid">25274273</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Moreira</surname><given-names>GRP</given-names></name><name><surname>Kronforst</surname><given-names>MR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Genome-wide introgression among distantly related <italic>Heliconius</italic> butterfly species</article-title><source>Genome Biology</source><volume>17</volume><elocation-id>25</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-016-0889-0</pub-id><pub-id pub-id-type="pmid">26921238</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>C</given-names></name><name><surname>Ogilvie</surname><given-names>HA</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Stadler</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Bayesian inference of species networks from multilocus sequence data</article-title><source>Molecular Biology and Evolution</source><volume>35</volume><fpage>504</fpage><lpage>517</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx307</pub-id><pub-id pub-id-type="pmid">29220490</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Teng</surname><given-names>D</given-names></name><name><surname>Lu</surname><given-names>W</given-names></name><name><surname>Liu</surname><given-names>M</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Cao</surname><given-names>L</given-names></name><name><surname>Southcott</surname><given-names>L</given-names></name><name><surname>Potdar</surname><given-names>S</given-names></name><name><surname>Westerman</surname><given-names>E</given-names></name><name><surname>Zhu</surname><given-names>AJ</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A widely diverged locus involved in locomotor adaptation in <italic>Heliconius</italic> butterflies</article-title><source>Science Advances</source><volume>7</volume><elocation-id>eabh2340</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abh2340</pub-id><pub-id pub-id-type="pmid">34348900</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>T</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Maximum likelihood implementation of an isolation-with-migration model with three species for testing speciation with gene flow</article-title><source>Molecular Biology and Evolution</source><volume>29</volume><fpage>3131</fpage><lpage>3142</lpage><pub-id pub-id-type="doi">10.1093/molbev/mss118</pub-id><pub-id pub-id-type="pmid">22504520</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>T</given-names></name><name><surname>Flouri</surname><given-names>T</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A simulation study to examine the impact of recombination on phylogenomic inferences under the multispecies coalescent model</article-title><source>Molecular Ecology</source><volume>31</volume><fpage>2814</fpage><lpage>2829</lpage><pub-id pub-id-type="doi">10.1111/mec.16433</pub-id><pub-id pub-id-type="pmid">35313033</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Major introgression patterns in the melpomene-silvaniform clade inferred using 3s and BPP</title><p>To assess the possibility of introgression that might support the autosome-majority tree or the Z chromosome tree, we estimate pairwise gene flow rates under the MSC-M model between each pair of species in the melpomene clade as well as <italic>H. burneyi</italic>, <italic>H. doris,</italic> and <italic>H. erato</italic> using the program 3s (<xref ref-type="bibr" rid="bib88">Zhu and Yang, 2012</xref>; <xref ref-type="bibr" rid="bib12">Dalquen et al., 2017</xref>). This implementation allows for continuous bidirectional gene flow between two species since divergence. We performed maximum likelihood estimation and likelihood ratio tests (LRT) to determine if a allowing for bidirectional gene flow (model M2) is a better fit than without gene flow (model M0). An outgroup species was used to improve the power of the test but it was not involved in gene flow. We used <italic>H. aoede</italic> as an outgroup in all species pairs. We find gene flow to be prevalent in the autosomes but almost absent in the Z chromosome (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2A</xref>). In particular, we find no strong evidence of gene flow in the Z chromosome between <italic>H. numata</italic> and <italic>H. besckei</italic>, which is required to explain the Z chromosome tree if the autosome-majority tree is the true species tree. Taken together, these results suggest that the Z chromosome tree represents the true species branching order, and autosomal trees are a result of extensive introgression throughout the history of this group. Using <italic>H. erato</italic> as an outgroup instead of <italic>H. aoede</italic> leads to the same conclusion (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>), although the internal branch length becomes zero whenever one of the ingroup species is <italic>H. aoede</italic>. A full list of estimates from all species pairs is provided in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> and <xref ref-type="supplementary-material" rid="supp1">Supplementary files 1o and p</xref>.</p><p>Next, we formulated two models to capture major introgression events in the group using the Z chromosome tree as a base tree (<xref ref-type="fig" rid="fig2">Figure 2B and C</xref>). The first model is the main model used for most parts of the genome and had six pairs of bidirectional introgression (<xref ref-type="fig" rid="fig2">Figure 2B</xref>): two for explaining different positions of <italic>H. numata</italic> (nodes n3–tcmeph1 and n2–eph1, relating trees 1–3, tree 4 and trees 5–7), one for <italic>H. pardalinus–H. elevatus</italic> gene flow, which is ongoing in sympatric populations (p1–e1) (<xref ref-type="bibr" rid="bib65">Rosser et al., 2019</xref>), two for gene flow involving <italic>H. melpomene</italic> with <italic>H. cydno</italic> (m1–c1) and with <italic>H. timareta</italic> (m2–t1) (explaining variation among trees 1–3 and trees 5–7), and one for the possibility of <italic>H. besckei</italic> and <italic>H. numata</italic> (b1–n1) as suggested by the relationship between the Z chromosome tree and autosome trees. To keep the model tractable, we excluded potential <italic>H. cydno–H. timareta</italic> introgression in the model because these species are presently allopatric and signals of gene flow between them are likely to be via <italic>H. melpomene</italic>. We also assumed that population size did not change after introgression. This model has 12 introgression probabilities (<italic>φ</italic>), 13 species divergence times and introgression times (<italic>τ</italic>), and 15 population size parameters (<italic>θ</italic>), a total of 40 parameters. The second model is for the chromosome 15 inversion region (15b), which had three additional pairs of introgression edges, with 9 additional parameters (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>, model m1). We estimated those parameters for coding and noncoding loci of each chromosomal region using <sc>bpp</sc> (<xref ref-type="bibr" rid="bib18">Flouri et al., 2020</xref>).</p><p>Our estimated introgression histories are largely consistent across the genome and between coding and noncoding regions (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplements 3</xref> and <xref ref-type="fig" rid="fig2s4">4</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q and r</xref>). This pattern agrees with blockwise variation in species relationships (estimated without gene flow, <xref ref-type="fig" rid="fig2">Figure 2A</xref>). Gene flow was almost absent in the Z chromosome and consistent with our estimates under the MSC-M model.</p><p>The two introgression events involving <italic>H. numata</italic> that resolve majority autosomal relationships (trees 1–3, 5–7) and the Z chromosome tree (tree 4) were estimated to have high probabilities except for on the Z chromosome and in the chromosome 15b inversion region (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>). First, for the oldest introgression between <italic>H. numata</italic> and the common ancestor of the cydno-melpomene + pardalinus-hecale clade, the introgression is estimated to be unidirectional into <italic>H. numata</italic>, with probability (<italic>φ</italic><sub>n3←tcmeph1</sub>) ~ 0.85 in most parts of the genome while the introgression in the opposite direction was almost absent (<italic>φ</italic><sub>tcmeph1←n3</sub> &lt; 0.05). Second, the subsequent introgression between <italic>H. numata</italic> and the common ancestor of the pardalinus-hecale clade is estimated to be bidirectional in many chromosomes, with probabilities (<italic>φ</italic><sub>n2←eph1</sub> and <italic>φ</italic><sub>eph1←n2</sub>) ~ 0.3 on average in both directions, although values of these probabilities varied considerably among chromosomes (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>).</p><p>Within the pardalinus-hecale clade, we estimate introgression probabilities between the sister species <italic>H. pardalinus</italic> and <italic>H. elevatus</italic> (<italic>φ</italic><sub>e1←p1</sub> and <italic>φ</italic><sub>p1←e1</sub>) to be ~0.5 in both directions in most chromosomes, although there is some variation across the genome. The time of this introgression (<italic>τ</italic><sub>e1</sub> or <italic>τ</italic><sub>p1</sub>) is essentially zero (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q and r</xref>), consistent with the fact that these two species still hybridize today (<xref ref-type="bibr" rid="bib48">Mallet et al., 2007</xref>). In some chromosomes such as 13 and 21, posterior estimates of ~0.5 had wide intervals (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>). The uncertainty may be due to weak evidence for gene flow, even with non-zero posterior means.</p><p>Within the cydno-melpomene clade, both <italic>H. melpomene–H. cydno</italic> and <italic>H. melpomene–H. timareta</italic> introgression is estimated to be highly asymmetrical, with <italic>H. melpomene</italic> being the main recipient in both cases, and with the introgression probabilities varying widely across the genome (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>). The <italic>H. cydno</italic> → <italic>H. melpomene</italic> introgression is estimated to be strictly unidirectional, with introgression probability (<italic>φ</italic><sub>m1←c1</sub>) of ~0.35 in noncoding regions,~0.25 in coding regions, and zero in the opposite direction (<italic>φ</italic><sub>c1←m1</sub>). For <italic>H. melpomene–H. timareta</italic>, the introgression probability for <italic>H. timareta</italic> → <italic>H. melpomene</italic> (<italic>φ</italic><sub>m2←t1</sub>) is highly variable across the genome, with values ranging from close to 0 to almost 1; the opposite direction (<italic>φ</italic><sub>t1←m2</sub>) had low probabilities (&lt;0.1) for most chromosomes.</p><p>Surprisingly, we found strictly unidirectional introgression from <italic>H. numata</italic> into <italic>H. besckei</italic> in all regions of the genome, including the Z chromosome, with probability (<italic>φ</italic><sub>b1←n1</sub>) around 0.3–0.4 in the noncoding regions and 0.5–0.6 in the coding regions. This is the only substantial introgression estimated in the Z chromosome, with <italic>φ</italic><sub>b1←n1</sub> ≈ 0.3, which was still lower than most autosomes. The chromosome 15 inversion region (15b) has a unique history that is much more complex than the rest of the genome; results for 15b are discussed in the next section.</p><p>Species divergence time estimates are precise and highly similar across the genome (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>). The posterior means from coding and noncoding loci are strongly correlated, with <italic>τ</italic><sub>coding</sub> ≈ <italic>x τ</italic><sub>noncoding</sub> where <italic>x</italic> varies between 0.5 and 0.6 (<italic>r</italic><sup>2</sup> &gt; 0.95) in most chromosomal regions (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>). We estimate the age of the Melpomene clade (<italic>τ</italic><sub>r</sub>) to be ~0.020 substitutions per site based on noncoding data and ~0.013 based on coding data. Assuming a constant neutral mutation rate of 2.9 × 10<sup>–9</sup> per site per generation (95% CI: 1.3 × 10<sup>–9</sup>, 1.5 × 10<sup>–9</sup>) and four generations per year (<xref ref-type="bibr" rid="bib33">Keightley et al., 2015</xref>), we obtain a conservative estimate that the melpomene clade diverged about 1.7 (CI: 0.9, 3.8) Ma, which is comparable to a previous estimate of 3.7 (CI: 3.2, 4.3) Ma based on molecular clock dating (<xref ref-type="bibr" rid="bib34">Kozak et al., 2015</xref>). We estimate present-day and ancestral population sizes (<italic>θ</italic>) to be of the order of 0.01, largely consistent among chromosomes (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4B</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q and r</xref>). For inbred reference individuals (<italic>H. melpomene</italic>, <italic>H. timareta</italic>, <italic>H. numata,</italic> and <italic>H. pardalinus</italic>; see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>), the estimates (<italic>θ</italic><sub>Mel</sub>, <italic>θ</italic><sub>Tim</sub>, <italic>θ</italic><sub>Num,</sub> and <italic>θ</italic><sub>Par</sub>) tended to be much more variable, with some chromosomes having unusually low estimates in the order of 0.001 or lower. <italic>H. melpomene</italic> has the lowest population size estimate of about 0.002–0.004 on average. This pattern corresponds well to the fluctuating levels of heterozygosity among chromosomes as a result of inbreeding. Adding more individuals should help stabilize the estimates. Inbred individuals should be avoided in population genomic analyses.</p></sec><sec sec-type="appendix" id="s9"><title>MSC-M model for pardalinus-hecale and cydno-melpomene clades</title><p>In the pardalinus-hecale clade, we find the migration rates (<italic>M</italic><sub>Par→Ele</sub> and <italic>M</italic><sub>Ele→Par</sub>) between <italic>H. pardalinus</italic> and <italic>H. elevatus</italic> to be high and largely asymmetrical, with <italic>M</italic> ≈ 2–4 migrants per generation in one direction and a lower rate (<italic>M</italic> &lt; 1) in the opposite direction (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6A</xref>), consistent with the introgression probability estimates (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>). However, we observe a label-switching problem in which different runs of model fitting on the same data converged to different posterior peaks that differed in the main direction of gene flow accompanied by a flip in the corresponding population size parameters. This near unidentifiability of <italic>M</italic> and <italic>θ</italic> appears to be partly associated with high migration rates and low genomic distinctiveness between <italic>H. pardalinus</italic> and <italic>H. elevatus</italic>. Since these two species appear to be virtually panmictic and to share effective population size over most of their genome, we also fitted an alternative model to these two species assuming all three populations (two present-day and one ancestral) share the same population size. Under this simpler model, the migration rates are still high (<italic>M</italic> ~ 1) but less extreme, and the unidentifiability issue largely disappears (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6B</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1t</xref>). We also detect significant but lesser gene flow involving <italic>H. hecale</italic>, with migration rates <italic>M</italic><sub>Hec→Ele</sub>, <italic>M</italic><sub>Ele→Hec</sub>, <italic>M</italic><sub>Hec→Par</sub>, and <italic>M</italic><sub>Par→Hec</sub> &lt;0.1 in most chromosomes (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6A</xref>). Divergence time estimates are more stable among chromosomes and are not affected by the unidentifiability issue. Under this MSC-M model, the divergence time between <italic>H. pardalinus</italic> and <italic>H. elevatus</italic> is <italic>τ</italic><sub>ep</sub> ≈ 0.010 substitutions per site, and the divergence time between <italic>H. hecale</italic> and <italic>H. pardalinus + H. elevatus</italic> is <italic>τ</italic><sub>eph</sub> ≈ 0.013 substitutions per site based on noncoding data; coding data led to about half these values (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6A</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1s</xref>). These estimates are slightly older than those obtained under a larger model assuming pulse introgression in <xref ref-type="fig" rid="fig2">Figure 2B</xref> are <italic>τ</italic><sub>ep</sub> ≈ 0.0070 and <italic>τ</italic><sub>eph</sub> ≈ 0.0076 using noncoding data (<italic>τ</italic><sub>ep</sub> ≈ 0.002 and <italic>τ</italic><sub>eph</sub> ≈ 0.003 using coding data) (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q and r</xref>).</p><p>In the cydno-melpomene clade, estimated migration rates under the MSC-M model are below 0.1, generally much lower than those in the pardalinus-hecale clade, with large variation among chromosomes (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6C</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1u</xref>). The label-switching problem is rare. Chromosomes with unusually low incoming migration rate estimates tend to be associated with low heterozygosity in inbred individuals (<italic>H. melpomene</italic> and <italic>H. timareta</italic>). For instance, the <italic>H. melpomene</italic> individual had almost no variation in chromosomes 2, 9, 10, and 18, and as a result, the migration rates <italic>M</italic><sub>Cyd→Mel</sub> and <italic>M</italic><sub>Tim→Mel</sub> (and <italic>θ</italic><sub>Mel</sub>, <italic>θ</italic><sub>Tim</sub>) are estimated about one or two orders of magnitude lower on those chromosomes compared with other chromosomes (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1u</xref>). Unlike the introgression model where introgression is largely from <italic>H. cydno</italic> and <italic>H. timareta</italic> into <italic>H. melpomene</italic>, there is no clear pattern of highly asymmetrical gene flow into <italic>H. melpomene</italic>. In this MSC-M model, we also allow for gene flow between <italic>H. timareta</italic> and <italic>H. cydno</italic>, which is estimated to be <italic>M</italic><sub>Cyd→Tim</sub> ≈ 0.1 and <italic>M</italic><sub>Tim→Cyd</sub> ≈ 0.04 migrants per generation in both coding and noncoding loci (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1u</xref>). Divergence time estimates are largely comparable across chromosomes. However, the estimates tend to be older than those obtained under the introgression model of <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>. We obtained <italic>τ</italic><sub>tc</sub> ≈ 0.007 and <italic>τ</italic><sub>tcm</sub> ≈ 0.012–0.014 using coding or noncoding loci under the MSC-M model (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1u</xref>) while <italic>τ</italic><sub>tc</sub> ≈ 0.0025 and <italic>τ</italic><sub>tcm</sub> ≈ 0.007 using noncoding data and <italic>τ</italic><sub>tc</sub> ≈ 0.001 and <italic>τ</italic><sub>tcm</sub> ≈ 0.0043 using coding data (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1q and r</xref>).</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Isolation-with-migration (IM) analysis of the 'etales-9spp' dataset using 3s.</title><p>(<bold>A</bold>) Model specification in 3s. There are three types of parameters: divergence times (<italic>τ</italic><sub>1</sub>, <italic>τ</italic><sub>0</sub>), effective population sizes (<italic>θ</italic><sub>1</sub>, <italic>θ</italic><sub>2</sub>, <italic>θ</italic><sub>4</sub>, and <italic>θ</italic><sub>5</sub>) and migration rates (<italic>M</italic><sub>12</sub>, <italic>M</italic><sub>21</sub>). (<bold>B</bold>) Maximum-likelihood estimates (MLEs) of the pairwise migration rates (<italic>M</italic><sub>12</sub>, <italic>M</italic><sub>21</sub>), with donor species on the y-axis and recipient species on the x-axis. We used <italic>Eueides tales</italic> as the outgroup (<italic>S</italic><sub>3</sub> in <bold>A</bold>). Top and bottom quadrants are results from noncoding and coding loci, respectively. Left quadrants show results from all autosomal loci. Right quadrants show results from all Z chromosome loci (21a + 21b + 21c). For the number of loci, see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref> (<italic>H. erato</italic> reference, minDP (d) = 12). For pairs without displayed numbers, the likelihood ratio test (LRT) was not significant at 0.1%, thereby failing to reject a null model of zero gene flow. (<bold>C</bold>) Mutation-scaled migration rates (<italic>w</italic><sub><italic>12</italic></sub> = 4<italic>M</italic><sub>12</sub>/<italic>θ</italic><sub>2</sub> and w<sub>21</sub> = 4<italic>M</italic><sub>21</sub>/<italic>θ</italic><sub>1</sub>) as a measure of expected admixture fraction in the recipient genome. (<bold>D</bold>) Root age (<italic>τ</italic><sub>0</sub>). Estimates from coding loci are shown in the upper triangle while estimates from noncoding loci are in the lower triangle. (<bold>E</bold>) Divergence time of the ingroup species pair (<italic>τ</italic><sub>1</sub>). (<bold>F</bold>) Internal branch length (Δ<italic>τ</italic> = <italic>τ</italic><sub>0</sub> – <italic>τ</italic><sub>1</sub>). Full results are in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1k</xref> and <xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-app1-fig1-v1.tif"/></fig><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Maximum likelihood estimates (MLEs) of migration rates (<italic>M</italic>), divergence times (<italic>τ</italic><sub>0</sub>, <italic>τ</italic><sub>1</sub>), and the internal branch length (Δ<italic>τ</italic> = <italic>τ</italic><sub>0</sub> – <italic>τ</italic><sub>1</sub>) from 3s analysis of the 'hmelv25-all' dataset, using (<bold>A</bold>) <italic>H. aoede</italic> or (<bold>B</bold>) <italic>H. erato</italic> as an outgroup.</title><p>See legend to <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-app1-fig2-v1.tif"/></fig><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Generation of multilocus data.</title><p>Coordinates of coding and noncoding loci were obtained from a reference genome with an annotation of coding sequences (CDS).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-app1-fig3-v1.tif"/></fig><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Raw (black) and adjusted (red) estimates of the difference in the mean log likelihood from the two models (y-axis).</title><p>Raw and adjusted estimates of the Bayes factor are in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1h</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-90656-app1-fig4-v1.tif"/></fig></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.90656.3.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Rokas</surname><given-names>Antonis</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Vanderbilt University</institution><country>United States</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>This <bold>important</bold> study revises the evolutionary history of <italic>Heliconius</italic> butterflies, a well-established model system for understanding speciation in the presence of gene flow between species. Using a <bold>convincing</bold> statistical phylogenetic approach that relies on the multispecies coalescent, the authors reconstruct the evolution of the lineage, including the timing of speciation events and the history of gene flow. The new phylogeny will be of interest to all researchers working on <italic>Heliconius</italic> butterflies, and the phylogenetic approach to investigators aiming to understand the history of lineages that have experienced extensive gene flow.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.90656.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>This study aims to further resolve the history of speciation and introgression in Heliconius butterflies. The authors break the data into various partitions and test evolutionary hypotheses using the Bayesian software BPP, which is based on the multispecies coalescent model with introgression. By synthesizing these various analyses, the study pieces together an updated history of Heliconius, including a multitude of introgression events and the sharing of chromosomal inversions.</p><p>Strengths:</p><p>Full-likelihood methods for estimating introgression can be very computationally expensive, making them challenging to apply to datasets containing many species. This study provides a great example of how to apply these approaches by breaking the data down into a series of smaller inference problems and then piecing the results together. On the empirical side, it further resolves the history of a genus with a famously complex history of speciation and introgression, continuing its role as a great model system for studying the evolutionary consequences of introgression. This is highlighted by a nice Discussion section on the implications of the paper's findings for the evolution of pollen feeding.</p><p>Weaknesses:</p><p>The analyses in this study make use of a single method, BPP. The analyses are quite thorough so this is okay in my view from a methodological standpoint, but given this singularity, more attention should be paid to the weaknesses of this particular approach. Additionally, little attention is paid to comparable methods such as PhyloNet and their strengths and weaknesses in the Introduction or Discussion. BPP reduces computational burden by fixing certain aspects of the parameter space, such as the species tree topology or set of proposed introgression events. While this approach is statistically powerful, it requires users to make informed choices about which models to test, and these choices can have downstream consequences for subsequent analyses. It also might not be as applicable to systems outside of Heliconius where less previous information is available about the history of speciation and introgression. In general, it is likely that most modelling decisions made in the study are justified, but more attention should be paid to how these decisions are made and what the consequences of them could be, including alternative models.</p><p>• Co-estimating histories of speciation and introgression remains computationally challenging. To circumvent this in the study, the authors first estimate the history of speciation assuming no gene flow in BPP. While this approach should be robust to incomplete lineage sorting and gene tree estimation, it is still vulnerable to gene flow. This could result in a circular problem where gene flow causes the wrong species tree to be estimated, causing the true species tree to be estimated as a gene flow event. This is a flaw that this approach shares with summary-statistic approaches like the D-statistic, which also require an a-priori species tree. Enrichment of particular topologies on the Z chromosome helps resolve the true history in this particular case, but not all datasets will have sex chromosomes or chromosome-level assemblies to test against.</p><p>• The a-priori specification of network models necessarily means that potentially better-fitting models to the data don't get explored. Models containing introgression events are proposed here based on parsimony to explain patterns in gene tree frequencies. This is a reasonable and common assumption, but parsimony is not always the best explanation for a dataset, as we often see with phylogenetic inference. In general, there are no rigorous approaches to estimating the best-fitting number of introgression events in a dataset. Likewise, the study estimates both pulse and continuous introgression models for certain partitions, though there is no rigorous way to assess which of these describes the data better.</p><p>• Some aspects of the analyses involving inversions warrant additional consideration. Fewer loci were able to be identified in inverted regions, and such regions also often have reduced rates of recombination. I wonder if this might make inferences of the history of inverted regions vulnerable to the effects of incomplete lineage sorting, even when fitting the MSC model, due to a small # of truly genealogically independent loci. Additionally, there are several models where introgression events are proposed to explain the loss of segregating inversions in certain species. It is not clear why these scenarios should be proposed over those in which the inversion is lost simply due to drift or selection.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.90656.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Thawornwattana et al. reconstruct a species tree of the genus Heliconius using the full-likelihood multispecies coalescent, an exciting approach for genera with a history of extensive gene flow and introgression. With this, they obtain a species tree with H. aoede as the earliest diverging lineage, in sync with ecological and morphological characters. They also add resolution to the species relationships of the melpomene-silvaniform clade and quantify introgression events. Finally, they trace the origins of an inversion on chromosome 15 that exists as a polymorphism in H. numata, but is fixed in other species. Overall, obtaining better species tree resolutions and estimates of gene flow in groups with extensive histories of hybridization and introgression is an exciting avenue. Being able to control for ILS and get estimates between sister species are excellent perks. One overall quibble is that the paper seems to be best suited to a Heliconius audience, where past trees are easily recalled, or members of the different clades are well known.</p><p>Overall, applying approaches such as these to gain greater insight into species relationships with extensive gene flow could be of interest to many researchers.</p></body></sub-article><sub-article article-type="referee-report" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.90656.3.sa3</article-id><title-group><article-title>Reviewer #3 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>The authors use a full-likelihood multispecies coalescent (MSC) approach to identify major introgression events throughout the radiation of Heliconius butterflies, thereby improving estimates of the phylogeny. First, the authors conclude that H. aoede is the likely outgroup relative to other Heliconius species; miocene introgression into the ancestor of H. aoede makes it appear to branch later. Topologies at most loci were not concordant with this scenario, though 'aoede-early' topologies were enriched in regions of the genome where interspecific introgression is expected to be reduced: the Z chromosome and larger autosomes. The revised phylogeny is interesting because it would mean that no extant Heliconius species has reverted to a non-pollen-feeding ancestral state. Second, the authors focus on a particularly challenging clade in which ancient and ongoing gene flow is extensive, concluding that silvaniform species are not monophyletic. Building on these results, a third set of analyses investigates the origin of the P1 inversion, which harbours multiple wing patterning loci, and which is maintained as a balanced polymorphism in H. numata. The authors present data supporting a new scenario in which P1 arises in H. numata or its ancestor and is introduced to the ancestor of H. pardilinus and H. elevatus - introgression in the opposite direction to what has previously been proposed using a smaller set of taxa and different methods.</p><p>The analyses were extensive and methodologically sound. Care was taken to control for potential sources of error arising from incorrect genotype calls and the choice of a reference genome. The argument for H. aoede as the earliest-diverging Heliconius lineage was compelling, and analyses of the melpomene-silvaniform clade were thorough.</p><p>The authors have demonstrated the strengths of a full-likelihood MSC approach when reconstructing the evolutionary history of &quot;difficult&quot; clade. This approach, however, can quickly become intractable in large species complexes where there is extensive gene flow or significant shifts in population size. In such cases, there may be hundreds of potentially important parameters to estimate, and alternate introgression scenarios may be impossible to disentangle. This is particularly challenging in systems unlike Heliconius, where fewer data are available and there is little a priori knowledge of reproductive isolation, genome evolution, and the unique life history traits of each species.</p></body></sub-article><sub-article article-type="author-comment" id="sa4"><front-stub><article-id pub-id-type="doi">10.7554/eLife.90656.3.sa4</article-id><title-group><article-title>Author Response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Thawornwattana</surname><given-names>Yuttapong</given-names></name><role specific-use="author">Author</role><aff><institution>Harvard University</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Seixas</surname><given-names>Fernando</given-names></name><role specific-use="author">Author</role><aff><institution>Harvard University</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Ziheng</given-names></name><role specific-use="author">Author</role><aff><institution>University College London</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff></contrib><contrib contrib-type="author"><name><surname>Mallet</surname><given-names>James</given-names></name><role specific-use="author">Author</role><aff><institution>Harvard University</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Public Reviews:</bold></p><p><bold>Reviewer #1 (Public Review):</bold></p><p>Summary:</p><p>This study aims to further resolve the history of speciation and introgression in Heliconius butterflies.The authors break the data into various partitions and test evolutionary hypotheses using the Bayesian software BPP, which is based on the multispecies coalescent model with introgression. By synthesizing these various analyses, the study pieces together an updated history of Heliconius, including a multitude of introgression events and the sharing of chromosomal inversions.</p><p>Strengths:</p><p>Full-likelihood methods for estimating introgression can be very computationally expensive, making them challenging to apply to datasets containing many species. This study provides a great example of how to apply these approaches by breaking the data down into a series of smaller inference problems and then piecing the results together. On the empirical side, it further resolves the history of a genus with a famously complex history of speciation and introgression, continuing its role as a great model system for studying the evolutionary consequences of introgression. This is highlighted by a nice Discussion section on the implications of the paper's findings for the evolution of pollen feeding.</p><p>Weaknesses:</p><p>The analyses in this study make use of a single method, BPP. The analyses are quite thorough so this is okay in my view from a methodological standpoint, but given this singularity, more attention should be paid to the weaknesses of this particular approach.</p></disp-quote><p>In the Discussion, we have now added a discussion of the limitations of our approach in the section 'Approaches for estimating species phylogeny with introgression from whole-genome sequence data: advantages and limitations.'</p><disp-quote content-type="editor-comment"><p>Additionally, little attention is paid to comparable methods such as PhyloNet and their strengths and weaknesses in the Introduction or Discussion.</p></disp-quote><p>We have also mentioned other methods (PhyloNet and starBEAST) in our Discussion. Our attempts to obtain usable estimates from PhyloNet were unsuccessful. In another study, the full likelihood version of PhyloNet (comparable in intent to the BPP methodology used here) could run with only small datasets of ~100 loci; see Edelman et al. (2019).</p><disp-quote content-type="editor-comment"><p>BPP reduces computational burden by fixing certain aspects of the parameter space, such as the species tree topology or set of proposed introgression events. While this approach is statistically powerful, it requires users to make informed choices about which models to test, and these choices can have downstream consequences for subsequent analyses. It also might not be as applicable to systems outside of Heliconius where less previous information is available about the history of speciation and introgression. In general, it is likely that most modelling decisions made in the study are justified, but more attention should be paid to how these decisions are made and what the consequences of them could be, including alternative models.</p></disp-quote><p>We agree with the reviewer that inferring the species tree topology and placing introgression events on the species tree, although well justified here, may be challenging in many groups of organisms and may affect downstream analyses. We now discuss this as a limitation of our approach in the Discussion. In general, the initial MSC analysis without gene flow should provide information about possible species trees and introgression events. We can construct multiple introgression models and perform parameter estimation and model comparison to decide which best fits the data. This is summarized in the last paragraph of the section 'Approaches for estimating species phylogeny with introgression from whole-genome sequence data: advantages and limitations.' It would, of course, be nice to have a completely unsupervised method that could work with large phylogenies, but this is currently computationally impossible.</p><disp-quote content-type="editor-comment"><p>• Co-estimating histories of speciation and introgression remains computationally challenging. To circumvent this in the study, the authors first estimate the history of speciation assuming no gene flow in BPP. While this approach should be robust to incomplete lineage sorting and gene tree estimation, it is still vulnerable to gene flow. This could result in a circular problem where gene flow causes the wrong species tree to be estimated, causing the true species tree to be estimated as a gene flow event.</p></disp-quote><p>The goal of this initial analysis is to obtain a list of possible species trees with introgression events. We assume that gene flow results in a topology that is informative about the lineages involved. We also focus on common MAP trees with high posterior probabilities as less frequent trees or trees with low posterior probabilities reflect high uncertainty and are more likely to be erroneous. A difficulty is to decide which tree topology is most likely to be the true species tree. We summarize our approach in the Discussion.</p><disp-quote content-type="editor-comment"><p>This is a flaw that this approach shares with summary-statistic approaches like the D-statistic, which also require an a-priori species tree.</p></disp-quote><p>In a sense, this is true, but BPP is more flexible because it can be used to explore an arbitrary introgression model on any type of tree, while summary methods like D-statistic assume a specific species phylogeny with a particular introgression between nonsister lineages as well as fixed sampling configurations. Furthermore, as shown in the paper, we can compare different assumed trees, and test between them; we do this repeatedly in the paper for difficult branch placement issues. In contrast, summary methods such as the D-statistic works with species quartets only and do not work with either smaller or larger species trees.</p><disp-quote content-type="editor-comment"><p>Enrichment of particular topologies on the Z chromosome helps resolve the true history in this particular case, but not all datasets will have sex chromosomes or chromosome-level assemblies to test against.</p></disp-quote><p>Yes, we have the privilege of having chromosome-level assemblies available for Heliconius. In general, a spatial pattern of species tree estimates across genomic blocks can be informative about possible topologies that could represent the true species relationship. Then these candidate species trees can be tested by fitting different introgression models (as in Figure 1D,E) or by using the recombination rate argument (Figure 1F), which prefers trees common in low recombination rate regions of the genome, although this requires knowing a recombination rate map. In our case, we used a chromosome-level recombination rate per base pair, which is negatively correlated with the chromosome size. We have clarified this in the text. Ultimately, multiple lines of evidence should be examined before deciding on the most likely species tree. We now mention these potential difficulties with applying our methods to other datasets as limitations of our approach in the Discussion.</p><disp-quote content-type="editor-comment"><p>• The a-priori specification of network models necessarily means that potentially better-fitting models to the data don't get explored. Models containing introgression events are proposed here based on parsimony to explain patterns in gene tree frequencies. This is a reasonable and common assumption, but parsimony is not always the best explanation for a dataset, as we often see with phylogenetic inference. In general, there are no rigorous approaches to estimating the best-fitting number of introgression events in a dataset.</p></disp-quote><p>Joint inference of species topologies and possible introgression events remains computationally challenging. PhyloNet implements this joint inference but is limited to small datasets (&lt;100 loci) and we found it to be unreliable.</p><disp-quote content-type="editor-comment"><p>Likewise, the study estimates both pulse and continuous introgression models for certain partitions, though there is no rigorous way to assess which of these describes the data better.</p></disp-quote><p>The Bayes factor can be used to compare different models fitted to the same data, for example, different MSC-I models with different introgression events, or MSC-I models with gene flow in pulses versus MSC-M models with continuous gene flow. We did not attempt this as it was clear to us that a better model would include both modes of gene flow, but such an option is not currently implemented in any software. Rather, we relied on our exploratory analysis (BPP MSC and 3s) and previous knowledge to inform a likely introgression model. In the case of groups that we fitted the MSC-M models, we chose to provide an intuitive justification as to why they might be more realistic than the MSC-I model without formally performing model selection.</p><disp-quote content-type="editor-comment"><p>• Some aspects of the analyses involving inversions warrant additional consideration. Fewer loci were able to be identified in inverted regions, and such regions also often have reduced rates of recombination. I wonder if this might make inferences of the history of inverted regions vulnerable to the effects of incomplete lineage sorting, even when fitting the MSC model, due to a small # of truly genealogically independent loci.</p></disp-quote><p>We agree with the reviewer that it is challenging to infer the history of a small region of the genome, such as the inversions studied here. Indeed, the presence of only a few loci in the 15b inversion means there is only limited information in the data for the species tree, as reflected in the low posterior probabilities for the MAP tree (Figure 3A). The effect of using tightly linked loci in the inversion should be increased uncertainty in the estimates, but not a systematic bias towards any particular species tree topology. Since major patterns of species relationships in each of the 15a, 15b and 15c regions are clear, we do not expect these effects to strongly influence our conclusions.</p><disp-quote content-type="editor-comment"><p>Additionally, there are several models where introgression events are proposed to explain the loss of segregating inversions in certain species. It is not clear why these scenarios should be proposed over those in which the inversion is lost simply due to drift or selection.</p></disp-quote><p>We know that the 15b inversion is absent in most species except for H. numata and H. pardalinus, at least, and that introgression of the inversion occurred between these two species, based on previous studies such as Jay et al (2018) and our own analysis. Polymorphism at this inversion forms a well-known “supergene” that affects mimicry, and is maintained by documented balancing selection in H. numata. Given this information, we propose a few possible scenarios of how the inversion might have originated, and when and where the introgression might have occurred, shown in Figure 3. In particular, the direction of introgression is something we test specifically. One way to test among these scenarios is to date the origin and introgression event of the inversion, but doing so properly is beyond the scope of this work. Nonetheless, we argue that it is at least likely that one difference between H. pardalinus and its sister species H. elevatus is the presence of the 15b inversion. Since other evidence shows that colour patterning loci in H. elevatus originated from an unrelated species, H. melpomene (i.e. the 15b and other non-inverted colour patterning loci), it is indeed likely that the inversion was “swapped out” by an uninverted sequence from H. melpomene during the formation of H. elevatus.</p><p>We are aware that hypotheses such as these might appear highly elaborate and unparsimonious. But these are the conclusions where the data lead us. In the melpomene-silvanform clade, many speciation and introgression events occurred in short succession, and wild-caught hybrids prove that occasional hybridizations can occur across all 15 or so species in the group. We now detail how we have looked only for the major introgression patterns using a limited number of key speces. We leave fuller analyses for future work.</p><p>In the main text, we have revised our discussion of the four proposed scenarios for 15b to improve clarity. We have also updated the introgression model from the melpomene-cydno clade to H. elevatus to be unidirectional based on the BPP results in Figure S18.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public Review):</bold></p><p>Thawornwattana et al. reconstruct a species tree of the genus Heliconius using the full-likelihood multispecies coalescent, an exciting approach for genera with a history of extensive gene flow and introgression. With this, they obtain a species tree with H. aoede as the earliest diverging lineage, in sync with ecological and morphological characters. They also add resolution to the species relationships of the melpomene-silvaniform clade and quantify introgression events. Finally, they trace the origins of an inversion on chromosome 15 that exists as a polymorphism in H. numata, but is fixed in other species. Overall, obtaining better species tree resolutions and estimates of gene flow in groups with extensive histories of hybridization and introgression is an exciting avenue. Being able to control for ILS and get estimates between sister species are excellent perks. One overall quibble is that the paper seems to be best suited to a Heliconius audience, where past trees are easily recalled, or members of the different clades are well known.</p></disp-quote><p>We thank the reviewer for the accurate summary and positive comments. Although our data and some of the discussion are specific to Heliconius, we believe our analysis framework will be useful to study species phylogeny and introgression in other taxa as well.</p><disp-quote content-type="editor-comment"><p>Overall, applying approaches such as these to gain greater insight into species relationships with extensive gene flow could be of interest to many researchers. However, the conclusions could be strengthened with a bit more clarity on a few points.</p><p>1. The biggest point of concern was the choice of species to use for each analysis. In particular the omission of H. ismenius in the resolution of the BNM clade species tree. The analysis of the chromosome 15 inversion seems to rely on the knowledge that H. ismenius is sister to H. numata, so without that demonstrated in the BNM section the resulting conclusions of the origin of that inversion are less interruptible.</p></disp-quote><p>The choice of species to be included was mainly based on available high-quality genome resequence data from Edelman et al (2019), which were chosen to cover most of the major lineages within the genus. We agree that inclusion of H. ismenius would strengthen the analysis of the melpomene-silvaniform clade. In particular, it would be interesting to know which of only H. numata or H. numata+H. ismenius are responsible for the main source of genealogical variation across the genome in this group in Figure 2. The reviewer is correct in saying that we do assume that H. ismenius and H. numata are sister species. This relationship is supported by our analysis (Figure 3A) and previous analyses of genomic data, e.g. Zhang et al (2016), Cicconardi et al. (2023) and Rougemont et al. (2023). We made this clearer in the text:</p><p>&quot;Although this conclusion assumes that H. numata and H. ismenius are sister species while H. ismenius was not included in our species tree analysis of the melpomene-silvaniform clade (Figure 2), this sister relationship agrees with previous genomic studies of the autosomes and the sex chromosome (Zhang et al. 2016; Cicconardi et al. 2023; Rougemont et al. 2023).&quot;</p><disp-quote content-type="editor-comment"><p>1. An argument they make in support of the branching scenario where H. aoede is the earliest diverging branch is based on which chromosomes support that scenario and the key observation that less introgression is detected in regions of low recombination. Yet, they go no further to understand the relationship between recombination rate and species trees produced.</p></disp-quote><p>We believe Figure 1F does examine this relationship, showing that trees under scenario 2 are more common in regions of the genome with lower recombination rates (i.e. in longer chromosomes). We added more clarification in the text where Figure 1F is mentioned. The relationship between recombination and introgression in Heliconius was earlier discovered and shown using windowed estimated gene trees in Martin et al. (2019) and in Edelman et al. (2019), so we did not re-test this here.</p><disp-quote content-type="editor-comment"><p>1. How the loci were defined could use more clarity. From the methods, it seems like each loci could vary quite a bit in total bp length and number of informative sites. Understanding the data processing would make this paper a better resource for others looking to apply similar approaches.</p></disp-quote><p>We added a new supplemental figure, Figure S20, to illustrate how coding and noncoding loci were extracted from the genome.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Public Review):</bold></p><p>The authors use a full-likelihood multispecies coalescent (MSC) approach to identify major introgression events throughout the radiation of Heliconius butterflies, thereby improving estimates of the phylogeny. First, the authors conclude that H. aoede is the likely outgroup relative to other Heliconius species; miocene introgression into the ancestor of H. aoede makes it appear to branch later. Topologies at most loci were not concordant with this scenario, though 'aoede-early' topologies were enriched in regions of the genome where interspecific introgression is expected to be reduced: the Z chromosome and larger autosomes. The revised phylogeny is interesting because it would mean that no extant Heliconius species has reverted to a non-pollen-feeding ancestral state. Second, the authors focus on a particularly challenging clade in which ancient and ongoing gene flow is extensive, concluding that silvaniform species are not monophyletic. Building on these results, a third set of analyses investigates the origin of the P1 inversion, which harbours multiple wing patterning loci, and which is maintained as a balanced polymorphism in H. numata. The authors present data supporting a new scenario in which P1 arises in H. numata or its ancestor and is introduced to the ancestor of H. pardilinus and H. elevatus - introgression in the opposite direction to what has previously been proposed using a smaller set of taxa and different methods.</p><p>The analyses were extensive and methodologically sound. Care was taken to control for potential sources of error arising from incorrect genotype calls and the choice of a reference genome. The argument for H. aoede as the earliest-diverging Heliconius lineage was compelling, and analyses of the melpomene-silvaniform clade were thorough.</p><p>The discussion is quite short in its current form. In my view, this is a missed opportunity to summarise the level of support and biological significance of key results. This applies to the revised Melpomenesilvaniform phylogeny and, in particular, the proposed H. numata origin of P1. It would be useful to have a brief overview of the relationships that remain unclear, and which data (if any) might improve estimates.</p></disp-quote><p>We added a paragraph in the Discussion to summarize our key findings in 'An updated phylogeny of Heliconius', and discuss issues that remain uncertain.</p><disp-quote content-type="editor-comment"><p>It was good to see the authors reflect on the utility of full-likelihood approaches more generally, though the discussion of their feasibility and superiority was at times somewhat overstated and reductive. Alternative MSC-based methods that use gene tree frequencies or coalescence times can be used to infer the direction and extent of introgression with accuracy that is satisfactory for a wide variety of research questions. In practice, a combination of both approaches has often been successful. Although full-likelihood approaches can certainly provide richer information if specific parameter estimates are of interest, they quickly become intractable in large species complexes where there is extensive gene flow or significant shifts in population size. In such cases, there may be hundreds of potentially important parameters to estimate, and alternate introgression scenarios may be impossible to disentangle. This is particularly challenging in systems, unlike Heliconius where there is little a priori knowledge of reproductive isolation, genome evolution, and the unique life history traits of each species. It would be useful for the authors to expand on their discussion of strategies that can simplify inference problems in such systems, acknowledging the difficulties therein.</p></disp-quote><p>We agree that approximate methods based on summary statistics (e.g. gene tree topologies) are computationally much cheaper and are sometimes useful. We now discuss limitations of our approach regarding strategies for constructing possible introgression models, computational cost and analysis of large phylogenies, and modeling assumptions in the MSC framework in the first section of the Discussion.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p><p>In addition to the comments raised in the public review, I have some minor suggestions:</p><list list-type="bullet"><list-item><p>In the Introduction, &quot;Those methods have limited statistical power&quot; implies summary-statistic methods have a high false negative rate for inferring the presence of introgression, which I don't think is true.</p></list-item></list></disp-quote><p>We removed 'statistical' as we used the term power loosely to mean ability to estimate more parameters in the model by making a better use of information in the sequence data and not in the sense of a true positive rate.</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>When discussing full-likelihood approaches in a general sense, please cite additional methods than just BPP, such as PhyloNet.</p></list-item></list></disp-quote><p>We added references for PhyloNet (Wen &amp; Nakhleh, 2018) and starBEAST (Zhang et al., 2018) in the Introduction and Discussion.</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>Consider explicitly labelling chromosomal region 21 as the Z chromosome in relevant Figures, for ease of interpretation.</p></list-item></list></disp-quote><p>In the main figures, we changed the chromosome label from 21 to Z.</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>From reading the main text it's not clear what a &quot;3s analysis&quot; is</p></list-item></list></disp-quote><p>The 3s analysis estimates pairwise migration rates between two species by fitting an MSC-withmigration (MSC-M) model, also known as isolation-with-migration (IM), for three species, where gene flow is allowed between the two sister species while the outgroup is used to improve the power but does not involved in gene flow. We changed the text from</p><p>&quot;We use estimates of migration rates between each pair of species with a 3s analysis under the IM model of species triplets ...&quot;</p><p>to</p><p>&quot;We use estimates of migration rates between each pair of species under the the MSC-withmigration (MSC-M or IM) model of species triplets (3s analysis) ...&quot;</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>&quot;This agrees with the scenario in which H. elevatus is a result of hybrid speciation between H.pardalinus and the common ancestor of the cydno-melpomene clade [42, 43].&quot; I don't think this model provides any support for hybrid speciation in particular, over a standard post-speciation introgression scenario.</p></list-item></list></disp-quote><p>We took the finding that the introgression from the melpomene-cydno clade into H. elevatus occurs almost right after H. elevatus split off from H. pardalinus as evidence for hybrid speciation. We revised the text to make this clearer:</p><p>&quot;Our finding that divergence of H. elevatus and introgression from the cydno-melpomene clade occurred almost simultaneously provides evidence for a hybrid speciation origin of H. elevatus resulting from introgression between H. pardalinus and the common ancestor of the cydno-melpomene clade (Rosser et al. 2019; Rosser et al. 2023).&quot;</p><p>In particular, the Rosser et al. (2023) paper has now been submitted, and is the main paper to cite for the hybrid speciation hypothesis for H. elevatus.</p><disp-quote content-type="editor-comment"><list list-type="bullet"><list-item><p>&quot;while clustering with H. elevatus would suggest the opposite direction of introgression&quot; careful with terminology here; is this about direction (donor vs. recipient species) or taxa involved (which is not direction)?</p></list-item></list></disp-quote><p>This is about the direction of introgression, not the taxa involved. We modified the text to make this clearer:</p><p>&quot;By including H. ismenius and H. elevatus, sister species of H. numata and H. pardalinus respectively, different directions of introgression should lead to different gene tree topologies. Clustering of (H. numata with the inversion, H. pardalinus) with H. numata without the inversion would suggest the introgression is H. numata → H. pardalinus while clustering of (H. numata with the inversion, H. pardalinus) with H. elevatus would suggest H. pardalinus → H. numata introgression.&quot;</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p><p>The work is methodologically sound and rigorous but could have been reported and discussed with greater clarity.</p><p>It was difficult to assess the level of support for the proposed P1 introgression scenario without digging through the extensive supplementary materials. The discussion would ideally be used to clarify and summarise this.</p></disp-quote><p>We have substantially revised the section on the P1 inversion. We also mention in the Results (in the final paragraph of the inversion section) and Discussion that our data provided robust evidence that the introgression of the inversion is from H. numata into H. pardalinus while its precise origin (in which lineage and when it originated) remains uncertain.</p><disp-quote content-type="editor-comment"><p>The authors may also wish to compare their results to the recent work by Rougemont et al. on introgression between H. hecale and H. ismenius in the discussion.</p></disp-quote><p>We now mention Rougemont et al. (2023) in the Discussion as an example of introgression of small regions of the genome involved in wing patterning. We also acknowledge that our updated phylogeny does not include this kind of local introgression.</p><disp-quote content-type="editor-comment"><p>It was not initially obvious which number corresponded to the Z chromosome in any of the figures, even though this is critical to their interpretation.</p></disp-quote><p>We changed the label for chromosome 21 to Z in the main figures.</p><disp-quote content-type="editor-comment"><p>The supplementary tables should be described in more detail. For example, what is 'log_bf_check' and 'prefer_pred' in supplementary table S11?</p></disp-quote><p>We added more details explaning necessary quantities in the table heading in both SI file and in the spreadsheet.</p><disp-quote content-type="editor-comment"><p>Minor comments:</p><p>First paragraph of 'Complex introgression in the 15b inversion region (P locus):' Rephrase &quot;This suggests another introgression between the common...&quot;.</p></disp-quote><p>We modified the text as follows:</p><p>&quot;Another feature of this 15b region is that among the species without the inversion, the cydnomelpomene clade clusters with H. elevatus and is nested within the pardalinus-hecale clade (without H. pardalinus). This is contrary to the expectation based on the topologies in the rest of the genome (Figure 2A, scenarios a–c) that the cydno-melpomene clade would be sister to the pardalinus-hecale clade (without H. pardalinus). One explanation for this pattern is that introgression occurred between the common ancestor of the cydno-melpomene clade and either H. elevatus or the common ancestor of H. elevatus and H. pardalinus together with a total replacement of the non-inverted 15b in H. pardalinus by the P1 inversion from H. numata (Jay et al. 2018). We confirm and quantify this introgression below.&quot;</p><disp-quote content-type="editor-comment"><p>Second paragraph of 'Major Introgression Patterns in the melpomene-silvaniform clade:' &quot;cconclusion&quot; should be &quot;conclusion.&quot;</p></disp-quote><p>Corrected.</p><disp-quote content-type="editor-comment"><p>Paragraph preceding discussion: sentences toward the end of the paragraph should be rephrased for clarity. E.g. &quot;different tree topologies are expected under different direction of introgression.&quot;</p></disp-quote><p>We revised this paragraph. The sentence now says:</p><p>&quot;By including H. ismenius and H. elevatus, sister species of H. numata and H. pardalinus respectively, different directions of introgression should lead to different gene tree topologies.</p><p>Clustering of (H. numata with the inversion, H. pardalinus) with H. numata without the inversion would suggest the introgression is H. numata → H. pardalinus while clustering of (H. numata with the inversion, H. pardalinus) with H. elevatus would suggest H. pardalinus → H. numata introgression.&quot;</p><disp-quote content-type="editor-comment"><p>I enjoyed reading this paper and I am certain it will generate discussion and future research.</p></disp-quote></body></sub-article></article>