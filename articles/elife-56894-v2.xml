<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">56894</article-id><article-id pub-id-type="doi">10.7554/eLife.56894</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>A theory of joint attractor dynamics in the hippocampus and the entorhinal cortex accounts for artificial remapping and grid cell field-to-field variability</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-179239"><name><surname>Agmon</surname><given-names>Haggai</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7212-9052</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-23501"><name><surname>Burak</surname><given-names>Yoram</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1198-8782</contrib-id><email>yoram.burak@elsc.huji.ac.il</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Edmond and Lily Safra Center for Brain Sciences, The Hebrew University of Jerusalem</institution><addr-line><named-content content-type="city">Jerusalem</named-content></addr-line><country>Israel</country></aff><aff id="aff2"><label>2</label><institution>Racah Institute of Physics, The Hebrew University of Jerusalem</institution><addr-line><named-content content-type="city">Jerusalem</named-content></addr-line><country>Israel</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Chaudhuri</surname><given-names>Rishidev</given-names></name><role>Reviewing Editor</role><aff><institution>UC Davis</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Senior Editor</role><aff><institution>University of Texas at Austin</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>11</day><month>08</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e56894</elocation-id><history><date date-type="received" iso-8601-date="2020-03-13"><day>13</day><month>03</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-08-07"><day>07</day><month>08</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Agmon and Burak</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Agmon and Burak</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-56894-v2.pdf"/><abstract><p>The representation of position in the mammalian brain is distributed across multiple neural populations. Grid cell modules in the medial entorhinal cortex (MEC) express activity patterns that span a low-dimensional manifold which remains stable across different environments. In contrast, the activity patterns of hippocampal place cells span distinct low-dimensional manifolds in different environments. It is unknown how these multiple representations of position are coordinated. Here, we develop a theory of joint attractor dynamics in the hippocampus and the MEC. We show that the system exhibits a coordinated, joint representation of position across multiple environments, consistent with global remapping in place cells and grid cells. In addition, our model accounts for recent experimental observations that lack a mechanistic explanation: variability in the firing rate of single grid cells across firing fields, and artificial remapping of place cells under depolarization, but not under hyperpolarization, of layer II stellate cells of the MEC.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>theoretical neuroscience</kwd><kwd>hippcampus</kwd><kwd>entorhinal cortex</kwd><kwd>spatial memory</kwd><kwd>attractor networks</kwd><kwd>computational neuroscience</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd><kwd>Rat</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003977</institution-id><institution>Israel Science Foundation</institution></institution-wrap></funding-source><award-id>1745/18</award-id><principal-award-recipient><name><surname>Agmon</surname><given-names>Haggai</given-names></name><name><surname>Burak</surname><given-names>Yoram</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001736</institution-id><institution>German-Israeli Foundation for Scientific Research and Development</institution></institution-wrap></funding-source><award-id>I-1477-421.13/2018</award-id><principal-award-recipient><name><surname>Agmon</surname><given-names>Haggai</given-names></name><name><surname>Burak</surname><given-names>Yoram</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000324</institution-id><institution>Gatsby Charitable Foundation</institution></institution-wrap></funding-source><award-id>Gatsby Program in Theoretical Neuroscience at the Hebrew University</award-id><principal-award-recipient><name><surname>Agmon</surname><given-names>Haggai</given-names></name><name><surname>Burak</surname><given-names>Yoram</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003977</institution-id><institution>Israel Science Foundation</institution></institution-wrap></funding-source><award-id>1978/13</award-id><principal-award-recipient><name><surname>Agmon</surname><given-names>Haggai</given-names></name><name><surname>Burak</surname><given-names>Yoram</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A theory of coordinated neural network dynamics in multiple brain areas offers an explanation for several recent experimental findings in the hippocampus and medial entorhinal cortex.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The discoveries of spatially selective cells in the hippocampus (<xref ref-type="bibr" rid="bib53">O'Keefe and Dostrovsky, 1971</xref>) and the medial entorhinal cortex (MEC) (<xref ref-type="bibr" rid="bib24">Hafting et al., 2005</xref>), have opened a window into the mechanisms underlying neural coding and processing of a high-level cognitive variable, which is separated from direct sensory inputs: the brain’s estimate of an animal’s position. Experimental evidence and theoretical reasoning have suggested that the neural representation of this variable is maintained by multiple attractor networks in the hippocampus (<xref ref-type="bibr" rid="bib3">Battaglia and Treves, 1998</xref>; <xref ref-type="bibr" rid="bib56">Quirk et al., 1990</xref>; <xref ref-type="bibr" rid="bib60">Samsonovich and McNaughton, 1997</xref>; <xref ref-type="bibr" rid="bib62">Schlesiger et al., 2018</xref>; <xref ref-type="bibr" rid="bib73">Wills et al., 2005</xref>) and the MEC (<xref ref-type="bibr" rid="bib8">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib9">Burak and Fiete, 2009</xref>; <xref ref-type="bibr" rid="bib19">Fuhs and Touretzky, 2006</xref>; <xref ref-type="bibr" rid="bib23">Guanella et al., 2007</xref>; <xref ref-type="bibr" rid="bib43">McNaughton et al., 2006</xref>; <xref ref-type="bibr" rid="bib66">Stensola et al., 2012</xref>), each expressing highly restricted patterns of neural activity at the population level that are preserved across multiple environments and conditions (<xref ref-type="bibr" rid="bib21">Gardner et al., 2019</xref>; <xref ref-type="bibr" rid="bib68">Trettel et al., 2019</xref>; <xref ref-type="bibr" rid="bib77">Yoon et al., 2013</xref>). Under this interpretation of the experimental observations, patterns of population activity in the hippocampal-entorhinal system are selected from a limited repertoire, shaped by synaptic connectivity that enforces the attractor dynamics. These activity patterns are dynamically linked with the animal’s position in response to external sensory inputs and self-motion cues.</p><p>Despite the hypothesized role of recurrent connectivity in shaping spatial responses in the hippocampus and the MEC, theoretical research on the relationship between these brain areas has mostly treated them as successive stages in a processing hierarchy involving feed-forward connectivity from grid cells to place cells, or vice-versa (<xref ref-type="fig" rid="fig1">Figure 1a</xref>) (but see [<xref ref-type="bibr" rid="bib38">Laptev and Burgess, 2019</xref>; <xref ref-type="bibr" rid="bib58">Rennó-Costa and Tort, 2017</xref>]). It is easy to show that summed inputs from multiple grid cells, combined with thresholding or competitive dynamics, can produce place-cell like responses (<xref ref-type="bibr" rid="bib13">de Almeida et al., 2009</xref>; <xref ref-type="bibr" rid="bib45">Monaco et al., 2011</xref>; <xref ref-type="bibr" rid="bib52">Neher et al., 2017</xref>; <xref ref-type="bibr" rid="bib59">Rolls et al., 2006</xref>; <xref ref-type="bibr" rid="bib64">Solstad et al., 2006</xref>). It is also straightforward to produce grid-cell like responses by combining synaptic inputs from multiple place cells whose receptive fields are periodically arranged in space. Furthermore, theoretical studies have demonstrated that plasticity mechanisms, acting between place cells and their post-synaptic partners in the MEC, can give rise to synaptic connectivity of this form, thereby producing grid-cell like responses that are driven by place cell inputs (<xref ref-type="bibr" rid="bib12">D'Albis and Kempter, 2017</xref>; <xref ref-type="bibr" rid="bib16">Dordek et al., 2016</xref>; <xref ref-type="bibr" rid="bib36">Kropff and Treves, 2008</xref>; <xref ref-type="bibr" rid="bib48">Monsalve-Mercado and Leibold, 2017</xref>; <xref ref-type="bibr" rid="bib67">Stepanyuk, 2015</xref>; <xref ref-type="bibr" rid="bib70">Weber and Sprekeler, 2018</xref>). Nevertheless, the functional relationship between grid cells and place cells, its relationship with recurrent connectivity within each brain region, and its role in the encoding of positions across multiple environments, remain unclear.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Schematic illustration: possible architectures of grid cell and place cell connectivity.</title><p>(<bold>a</bold>) Two hypotheses on connectivity, with hierarchical relationship between grid cells and place cells. Left: feed-forward connectivity from grid cells to place cells. Right: feed-forward connectivity from place cells to grid cells. Grid cells are color coded by their allocation to modules. Place cells exhibit global remapping between distinct environments (room A/room B) accompanied by grid cells realignment (not shown). (<bold>b</bold>) Schematic illustration of the model’s architecture: place cells and grid cells are bidirectionally coupled. Top: the strength of synaptic connectivity between a pair of place cells is a sum of map-specific contributions arising from the distinct maps. In each discrete map, the connectivity depends on the environment-specific spatial separation between the place cell receptive fields (arrow thicknesses for place cells #1 and #2). Bottom: grid cell modules are modeled as independent continuous attractors. Recurrent connectivity is identical in all modules. Straight arrows: the bi-directional connection between a grid cell and a place cell is proportional to the overlap between their receptive fields across the discrete maps.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig1-v2.tif"/></fig><p>There are several difficulties with the hypothesis that spatial selectivity in the entorhinal-hippocampal system emerges from a simple feedforward architecture. First, a number of experiments indicate that grid cell inputs are not necessary for emergence of place cell spatial specificity. Stable place fields are expressed in the hippocampus of preweanling rats before the appearance of stable grid cell activity in the MEC (<xref ref-type="bibr" rid="bib37">Langston et al., 2010</xref>; <xref ref-type="bibr" rid="bib74">Wills et al., 2010</xref>), and place fields are maintained under MEC lesions (<xref ref-type="bibr" rid="bib25">Hales et al., 2014</xref>). Global hippocampal remapping can occur without input from the MEC (<xref ref-type="bibr" rid="bib62">Schlesiger et al., 2018</xref>), and place fields are expressed under the inactivation of the medial septum, which eliminates the spatial periodicity of grid cells (<xref ref-type="bibr" rid="bib34">Koenig et al., 2011</xref>). Furthermore, new place fields can be established in novel environments under medial septum inactivation (<xref ref-type="bibr" rid="bib5">Brandon et al., 2014</xref>).</p><p>Second, there are difficulties with the opposite hypothesis, that feedforward inputs from place cells are the sole determinants of grid cell specificity. One such difficulty arises from the observation that place cell activity patterns remap in different environments (<xref ref-type="bibr" rid="bib51">Muller and Kubie, 1987</xref>). If grid cell responses emerge under activity dependent plasticity of feedforward synapses from place cells to grid cells (<xref ref-type="bibr" rid="bib12">D'Albis and Kempter, 2017</xref>; <xref ref-type="bibr" rid="bib16">Dordek et al., 2016</xref>; <xref ref-type="bibr" rid="bib36">Kropff and Treves, 2008</xref>; <xref ref-type="bibr" rid="bib48">Monsalve-Mercado and Leibold, 2017</xref>; <xref ref-type="bibr" rid="bib67">Stepanyuk, 2015</xref>; <xref ref-type="bibr" rid="bib70">Weber and Sprekeler, 2018</xref>), it is difficult to explain why they remain grid-like across familiar and novel environments, and why phase relationships between grid cells within a module are tightly preserved (<xref ref-type="bibr" rid="bib21">Gardner et al., 2019</xref>; <xref ref-type="bibr" rid="bib68">Trettel et al., 2019</xref>; <xref ref-type="bibr" rid="bib77">Yoon et al., 2013</xref>). Furthermore, grid cells maintain their correlation structure under hippocampal inactivation (<xref ref-type="bibr" rid="bib1">Almog et al., 2019</xref>), indicating that the low dimensionality of activity within each grid cell module is independent of hippocampal inputs.</p><p>Third, anatomically, the MEC and the hippocampus are reciprocally connected (<xref ref-type="bibr" rid="bib69">van Strien et al., 2009</xref>). A significant proportion of excitatory projections to place cells that arise in MEC originate in grid cells (<xref ref-type="bibr" rid="bib79">Zhang et al., 2013</xref>), and there are abundant feedback projections from place cells to deep layers of MEC (<xref ref-type="bibr" rid="bib14">Deadwyler et al., 1975</xref>).</p><p>Here, instead of assuming a feed-forward architecture of the entorhinal-hippocampal network, we explore theoretically an alternative hypothesis, that grid cells and place cells are driven by two types of synaptic inputs (<xref ref-type="fig" rid="fig1">Figure 1b</xref>): inputs arising from recurrent connectivity within each brain area that restrict activity to lie within low dimensional manifolds, and inputs arising from reciprocal connections between the MEC and the hippocampus that coordinate their joint representation of position.</p><p>We first examine whether such an architecture can enforce a coordinated representation of position in both brain regions. The joint system must be able to represent all possible positions within each environment by coordinated and persistent patterns of neural activity. To achieve this goal, while accounting for the global remapping of place cells (<xref ref-type="bibr" rid="bib51">Muller and Kubie, 1987</xref>) and the phase shift of grid cells (<xref ref-type="bibr" rid="bib20">Fyhn et al., 2007</xref>) across distinct environments (<xref ref-type="bibr" rid="bib30">Jeffery, 2011</xref>), we evoke theoretical ideas on the representation of multiple spatial maps by attractor dynamics in the hippocampus (<xref ref-type="bibr" rid="bib3">Battaglia and Treves, 1998</xref>; <xref ref-type="bibr" rid="bib46">Monasson and Rosay, 2013</xref>; <xref ref-type="bibr" rid="bib60">Samsonovich and McNaughton, 1997</xref>), and extend them to construct synaptic connectivity that supports a representation of position jointly with the grid cell system.</p><p>We demonstrate that the coupling between hippocampal and entorhinal attractor networks enables two computational functions. First, integration of velocity inputs in the grid cell network drives similar updates of the place cell representation of position. Idiothetic path integration can thus be implemented within the grid cell system, using fixed synaptic connectivity that does not require readjustment in new environments. Second, the reciprocal connectivity between grid cells and place cells yields an error correcting mechanism that eliminates incompatible drifts in the positions represented by distinct grid cell modules, independently from sensory inputs. Such independent drifts would otherwise rapidly lead to catastrophic readout errors of the grid cell representation (<xref ref-type="bibr" rid="bib8">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib18">Fiete et al., 2008</xref>; <xref ref-type="bibr" rid="bib49">Mosheiff and Burak, 2019</xref>; <xref ref-type="bibr" rid="bib65">Sreenivasan and Fiete, 2011</xref>; <xref ref-type="bibr" rid="bib72">Welinder et al., 2008</xref>) and would therefore be highly detrimental for the coding of position by grid cell activity.</p><p>Next, we show that our model exhibits two emergent features that provide a compelling explanation for several recent experimental observations.</p><sec id="s1-1"><title>Variability of individual grid cell firing rates across firing fields</title><p>Even though grid cell activity is spatially periodic to a good approximation, several recent works showed that firing rates of individual grid cells vary across firing fields (<xref ref-type="bibr" rid="bib15">Diehl et al., 2017</xref>; <xref ref-type="bibr" rid="bib17">Dunn et al., 2017</xref>; <xref ref-type="bibr" rid="bib28">Ismakov et al., 2017</xref>). These firing rate differences are retained across multiple exposures to the same environment. On their own, attractor models of grid cell dynamics predict that firing rates should be identical across firing fields. However, external inputs to the grid cell system could modulate the activity of grid cells in a non-periodic manner. Such inputs could have a sensory origin and project to grid cells from the LEC or the hippocampus. Here, we show that even without any sensory inputs projecting into the system, the embedding of multiple spatial maps within the hippocampus, combined with the synaptic projections from place cell to grid cells, generates variability in the firing rate of grid cells across firing fields.</p></sec><sec id="s1-2"><title>Artificial hippocampal remapping upon grid cell depolarization</title><p>Place cell firing fields were recently recorded during hyperpolarization or depolarization of layer II stellate cells in the MEC (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>), giving rise to surprising observations. First, depolarization in the MEC led to a form of remapping in the hippocampus that resembles partial remapping (<xref ref-type="bibr" rid="bib11">Colgin et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Latuske et al., 2017</xref>; <xref ref-type="bibr" rid="bib51">Muller and Kubie, 1987</xref>; <xref ref-type="bibr" rid="bib56">Quirk et al., 1990</xref>). Some place cells shifted their firing fields to new locations, while other place fields remained anchored to their original positions and exhibited only rate remapping. This implies that in contrast to global remapping, population patterns of activity under depolarization of the MEC retained partial overlap with firing patterns that were expressed under non-perturbed conditions. Unlike classical remapping experiments, the changes in the firing patterns of place cells in <xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref> were induced without any changes in the sensory inputs. We refer to this form of remapping induced by MEC depolarization as <italic>artificial remapping</italic>, following <xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>. Second, an asymmetry was observed between consequences of depolarization and hyperpolarization in the MEC, since hyperpolarization had only mild effect on the spatial tuning curves of place cells. So far, these observations have lacked a satisfying theoretical explanation. We show below that our model exhibits the same phenomenology as observed in <xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>. The theory predicts that MEC depolarization, but not hyperpolarization, alters the manifold of persistent population activity patterns, such that the hippocampus expresses mixtures of patterns that were associated with different environments before the perturbation. The emergence of such mixed states under certain perturbations is characteristic of models of associative memory. Thus, artificial remapping may offer the first experimental observation of this phenomenon in a well-characterized neural network.</p></sec></sec><sec id="s2" sec-type="results"><title>Results</title><p>We first ask whether bidirectional connectivity between grid cells and place cells can enforce persistent states of activity that enable continuous coding of position, and are compatible with the observed phenomenology of the place and grid cell neural codes in multiple environments: global hippocampal remapping (<xref ref-type="bibr" rid="bib51">Muller and Kubie, 1987</xref>), and phase shifts in individual modules of the MEC (<xref ref-type="bibr" rid="bib20">Fyhn et al., 2007</xref>). For simplicity, and to reduce the computational cost of simulations, we consider throughout this manuscript a one-dimensional (1d) analogue of grid cell and place cell dynamics.</p><sec id="s2-1"><title>Model architecture and description</title><p>We model neural activity using a standard rate model. Neurons are grouped into several sub-populations: hippocampal place cells and three grid-cell modules. The architecture of synaptic connections is briefly described here, and fully specified in Methods. There are three types of synaptic connections in the model:</p><sec id="s2-1-1"><title>Recurrent connectivity between grid cells</title><p>Connectivity within each grid cell module produces a continuous attractor with a periodic manifold of steady states. We adopt the simple synaptic architecture proposed in <xref ref-type="bibr" rid="bib23">Guanella et al., 2007</xref>. In the 1d analogue, this form of connectivity maps into the ring attractor model (<xref ref-type="bibr" rid="bib4">Ben-Yishai et al., 1995</xref>; <xref ref-type="bibr" rid="bib57">Redish et al., 1996</xref>; <xref ref-type="bibr" rid="bib63">Skaggs et al., 1995</xref>; <xref ref-type="bibr" rid="bib78">Zhang, 1996</xref>): neurons, functionally arranged on a ring, excite nearby neighbors, while global inhibitory connections imply that distant neurons inhibit each other. This synaptic architecture leads to coactivation of a localized group of neurons, which can be positioned anywhere along the ring. The possible positions of the bump are associated with the 1d spatial coordinate by tiling them periodically along the spatial dimension, with an environment specific phase, in accordance with the experimentally observed phase-shifts of grid cell responses under global remapping (<xref ref-type="bibr" rid="bib20">Fyhn et al., 2007</xref>).</p></sec><sec id="s2-1-2"><title>Recurrent connectivity between place cells</title><p>Connectivity between place cells is based on similar principles, with two differences: first, each population activity pattern is mapped to a single spatial location. Second, the network possesses a discrete set of continuous attractors, each mapping a distinct environment to a low dimensional manifold of population activity patterns. The synaptic connectivity can be expressed as a sum over contributions from different maps, in similarity to the sum of contributions associated with discrete memories in the Hopfield model (<xref ref-type="bibr" rid="bib27">Hopfield, 1982</xref>). To mimic the features of global remapping, spatial relationships between place cells in the different maps are related to each other by a random permutation. This is similar to previous models (<xref ref-type="bibr" rid="bib3">Battaglia and Treves, 1998</xref>; <xref ref-type="bibr" rid="bib46">Monasson and Rosay, 2013</xref>; <xref ref-type="bibr" rid="bib60">Samsonovich and McNaughton, 1997</xref>) but adapted here to the formalism of a dynamical rate model.</p></sec><sec id="s2-1-3"><title>Connectivity between grid cells and place cells</title><p>We first define an idealized tuning curve for each grid cell and each place cell, in each environment. These tuning curves are determined by the mapping between attractor states and positions, as described above and in Methods. For each pair of grid and place cells, we evaluate the correlation between their spatial tuning patterns across all spatial positions and environments. The efficacy of the synapse is then linearly related to this correlation coefficient.</p></sec></sec><sec id="s2-2"><title>Coordinated persistent representations</title><p>We demonstrate that coordinated persistent representations, and only them, simultaneously co-exist in grid cells and place cells. Our methodology is based on quantitative mapping of persistent states obtained when starting from multiple types of initial conditions. We require that in all cases the system will settle on a persistent activity bump in one of the hippocampal maps, and on persistent activity bumps in each grid cell module at matching locations. Examples of such states are shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Each state exhibits unimodal and co-localized activity bumps when cells are ordered according to their firing location in a particular environment, whereas scattered place cell activity accompanied with grid cell realignment is observed when cells are ordered according to their firing location in other environments.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Examples of simulation results, demonstrating joint persistent states of place cells and grid cells.</title><p>(<bold>a</bold>) One persistent state of the network (state 1). In each panel, cells are ordered according to their preferred firing locations in one environment. In each grid cell module, positions displaced by any integer multiple of the grid spacing correspond to the same cell, whereas distinct place cells span the whole extent of the environment. When cells are ordered according to their preferred firing locations in map #1 (left), a unimodal place cell bump is observed, and the distinct grid cell bumps of the three modules co-localize around the same spatial location. When the cells are ordered according to their preferred firing locations in a different map (middle - map <italic>#3</italic> and right - map <italic>#6)</italic>, the same place cell activities are scattered throughout the environment and do not resemble a unimodal activity bump. Furthermore, grid cell bumps do not necessarily co-localize around the same spatial location, as they independently realign. (<bold>b-c</bold>) Examples of persistent states (state 2 and 3), similar to (a) but representing positions in map <italic>#3</italic> and in map #6 respectively. Note that here the activity of place cells seems scattered and grid cell bumps independently realign when cells are ordered according to their preferred firing locations in map #1.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig2-v2.tif"/></fig><p>To test whether a persistent state represents coherently a valid position in one of the environments, we define a <italic>bump score</italic> that quantifies the existence of a unimodal activity bump in each sub-network. In the hippocampal sub-network, a high bump score should be seen only in a single spatial map. Within that map, we also measure the spatial location that corresponds to activity bumps in each sub-network (Methods). This measurement allows us to verify that all sub-networks express activity bumps in compatible positions, and to test the persistence of these bump states. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows the results from several types of initial conditions:</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Quantitative mapping of the persistent states expressed by the joint network.</title><p>In all panels, the system is placed at 500 initial conditions of three types (<bold>a-d</bold>: ‘consistent’, <bold>e-h</bold>: ‘inconsistent’, <bold>i-l</bold>: ‘all random’). Its state is then analyzed after a 1 s delay period. (<bold>a-d</bold>) Results from the ‘consistent’ initial condition (the system is placed without loss of generality in map #1). (<bold>a</bold>) Histogram of winning map, defined as the map that achieved the highest bump score. Red dashed line: uniform distribution. (<bold>b</bold>) Histogram of place cell bump scores, obtained from the winning map (blue) and from an average on all other maps (‘Losing maps’, orange). (<bold>c</bold>) Histogram of distances between the measured spatial location of each grid cell bump and the place cell bump, evaluated in the coordinates of the winning map. (<bold>d</bold>) Histogram of distances traveled by the activity bumps from their initial condition, evaluated in the coordinates of the winning map. (<bold>e-h</bold>) Similar to (<bold>a-d</bold>) but for ‘inconsistent’ condition. (<bold>i-l</bold>) Similar to (<bold>a-d</bold>) but for ‘all random’ condition. The initial position was evaluated using the same algorithm used in (<bold>d</bold>,<bold>h</bold>) but in this case, where there were no initial bumps, the outcome depended on slight random variations in the initial condition and thus, effectively, the initial position was chosen randomly. Note that for all initial conditions the state of the system after the delay period corresponded to a single spatial map (<bold>b</bold>,<bold>f</bold>,<bold>j</bold>), and the place cell and grid cell representations are coordinated (<bold>c</bold>,<bold>g</bold>,<bold>k</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Analysis of persistent states following initial conditions of type (4).</title><p>(<bold>a-d</bold>) Similar to <xref ref-type="fig" rid="fig3">Figure 3a–d</xref> but for ‘Grid cells - random, Place cells - bump’ initial conditions: grid cells were initially set to have random rates, while place cells were set to encode a specific location. (<bold>e–h</bold>) Similar to <xref ref-type="fig" rid="fig3">Figure 3a–d</xref> but for ‘Place cells - random, Grid cells - bump’: grid cells were set to encode a specific location, and place cells were assigned with random rates.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Bump score dynamics of persistent states.</title><p>(<bold>a</bold>) Bump score dynamics in the ‘consistent’ initial condition, corresponding to all realizations shown in <xref ref-type="fig" rid="fig3">Figure 3a–d</xref>. Error bars correspond to ±1 std. (<bold>b</bold>) Same as (<bold>a</bold>) but in the ‘inconsistent’ initial condition (same realizations as shown in <xref ref-type="fig" rid="fig3">Figure 3e–h</xref>). (<bold>c</bold>) Same as (<bold>a</bold>) but in the ‘all random’ initial condition (same realizations as shown in <xref ref-type="fig" rid="fig3">Figure 3i–l</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig3-figsupp2-v2.tif"/></fig><media id="fig3video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-56894-fig3-video1.mp4"><label>Figure 3—video 1.</label><caption><title>Dynamics under ‘consistent’ initial condition.</title><p>Firing rates of place cells (black) and grid cell modules (red, green, and blue) during a single 1 s simulation, in which the network was initialized in a ‘consistent’ state in map 1. Left: neurons are sorted according to firing locations in map 1. Right: neurons are sorted according to firing locations in map 5.</p></caption></media><media id="fig3video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-56894-fig3-video2.mp4"><label>Figure 3—video 2.</label><caption><title>Dynamics under ‘inconsistent’ initial condition.</title><p>Firing rates of place cells (black) and grid cell modules (red, green, and blue) during a single 1 s simulation, in which the network was initialized in an ‘inconsistent’ state in map 1. Left: neurons are sorted according to firing locations in map 1. Right: neurons are sorted according to firing locations in map 6.</p></caption></media><media id="fig3video3" mime-subtype="mp4" mimetype="video" xlink:href="elife-56894-fig3-video3.mp4"><label>Figure 3—video 3.</label><caption><title>Dynamics under ‘all random’ initial condition.</title><p>Firing rates of place cells (black) and grid cell modules (red, green, and blue) during a single 1 s simulation, in which the network was initialized in an ‘all random’ state. Left: neurons are sorted according to firing locations in map 1. Right: neurons are sorted according to firing locations in map 4.</p></caption></media></fig-group><list list-type="order"><list-item><p>‘Consistent condition’: Grid cell and place cell activities are initially set to encode an identical location within the same map. Using these initial conditions, we verify that all locations, in all environments, can be represented by persistent states (<xref ref-type="fig" rid="fig3">Figure 3a–d</xref>). The bump score remains high after 1 s when initializing the network in co-localized bump states, and the drift of the represented position is small compared to the width of activity bumps, indicating that these states are persistent.</p></list-item><list-item><p>‘Inconsistent condition’: Grid cell and place cell activities are initially set to encode different locations. Using this test, we verify that such incompatible states are unstable and give rise (after a short transient period) to a consistent state (<xref ref-type="fig" rid="fig3">Figure 3e–h</xref>).</p></list-item><list-item><p>‘All random’: Both grid cell and place cell activities are set to random initial rates. The goal of these tests is to verify that even if bump states do not exist initially, the system evolves into unimodal activity bumps in compatible positions, and that no other spurious states emerge. As expected, co-localized place cell and grid cell activity bumps appear with equal probabilities across the different maps (<xref ref-type="fig" rid="fig3">Figure 3i</xref>).</p></list-item><list-item><p>Finally, we test how the system evolves from two additional types of initial states: in one condition grid cells are initially set to have random rates, while place cells are set to encode a specific location. In the second condition, grid cells are set to encode a specific location, and place cells are assigned with random rates. The results (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) indicate that both place cells and grid cells are capable of attracting activity in the other network to organize in a compatible manner with their initial state (note however that in the ‘inconsistent’ initial condition, under our choice of coupling parameters, the final locations of persistent states are typically determined by the initial place cell location).</p></list-item></list><p><xref ref-type="video" rid="fig3video1">Figure 3—videos 1</xref>–<xref ref-type="video" rid="fig3video3">3</xref> show examples of activity dynamics in the network for initial conditions of types (1–3) and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> quantify the dynamics of the bump score for each type of the initial conditions shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p></sec><sec id="s2-3"><title>Functional consequences: path integration and dynamic coupling</title><p>Two functional consequences arise from the coupling between the place and grid cell networks:</p><sec id="s2-3-1"><title>Path integration</title><p>The MEC has been hypothesized to be the brain area responsible for idiothetic path integration for several reasons (<xref ref-type="bibr" rid="bib8">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib24">Hafting et al., 2005</xref>; <xref ref-type="bibr" rid="bib43">McNaughton et al., 2006</xref>) among them the highly geometric nature of grid cell spatial selectivity, the existence of inputs to the MEC that convey information about the animal’s self-motion and heading (<xref ref-type="bibr" rid="bib35">Kropff et al., 2015</xref>; <xref ref-type="bibr" rid="bib61">Sargolini et al., 2006</xref>), and the impairment of path integration following disruption of grid cell activity (<xref ref-type="bibr" rid="bib22">Gil et al., 2018</xref>). The similarity in response patterns of grid cells across environments implies that implementation of path integration in the MEC could be accomplished in different environments by the same synaptic connectivity, whereas implementation in the hippocampus (<xref ref-type="bibr" rid="bib42">McNaughton et al., 1996</xref>) would require establishment of dedicated synaptic connectivity in each environment. <xref ref-type="fig" rid="fig4">Figure 4a</xref> demonstrates that in the coupled system, integration of velocity inputs in the MEC, using mechanisms described in <xref ref-type="bibr" rid="bib9">Burak and Fiete, 2009</xref> (Methods) induces coordinated updates in the position represented in the place cell network and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> shows the dynamics of the corresponding bump scores across multiple maps. <xref ref-type="fig" rid="fig4">Figure 4b</xref> shows that errors accrued during path integration remain small, when using realistic velocities that were measured experimentally during foraging in an open field environment (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). Interestingly, the representation in the hippocampus lags behind the entorhinal representation, due to synaptic transmission delays (<xref ref-type="fig" rid="fig4">Figure 4d</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Velocity integration in grid cells can update the place cell representation.</title><p>(<bold>a</bold>) Readout of place cell bump location (black) while grid cell modules (green, red, and blue) integrate a velocity profile (dashed orange line). (<bold>b</bold>) Mean absolute distance between measured location of the place cell activity bump, and integrated velocity (blue), as a function of time. This quantity is compared with the total distance traveled by the place cell bump (red), which is much larger. Averaging was performed over 500 trajectories. In each trajectory velocity was randomly sampled every 0.5 s from an experimentally measured velocity distribution, which was obtained during foraging of a rat in an open-field environment (see panel c). Shaded error bars are 1.96 times the standard deviations obtained from each simulation, divided by the square root of the number of realizations (corresponding to a confidence interval of 95%). (<bold>c</bold>) Histogram of velocities measured experimentally during foraging of a rat in an open field environment (<xref ref-type="bibr" rid="bib24">Hafting et al., 2005</xref>). (<bold>d</bold>) Mean squared displacement between positions represented by place cells and grid cells, when evaluated at varying time lags between the two measurements. Red circle marks the minimal MSE. The minimum MSE occurs at a negative time lag (~−100 ms), which indicates that the place cell representation lags behind the grid cell representation. Shaded error bars are 1.96 times the standard deviations obtained from each simulation, divided by the square root of the number of realizations (corresponding to a confidence interval of 95%).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Bump score dynamics for each of the embedded maps, corresponding to the realization shown in <xref ref-type="fig" rid="fig4">Figure 4a</xref>.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig4-figsupp1-v2.tif"/></fig></fig-group></sec><sec id="s2-3-2"><title>Coordination of the grid cell representation: suppression of incompatible drifts</title><p>The modular structure of the grid cell code for position confers it with large representational capacity (<xref ref-type="bibr" rid="bib18">Fiete et al., 2008</xref>). Yet, the modularity poses a significant challenge for the neural circuitry that maintains the representation and updates it based on self-motion. The configurational space of <italic>M</italic> grid module phases is <italic>M</italic> dimensional in 1-d (or 2<italic>M</italic> dimensional in 2-d), but phases that correspond to continuous motion in a given environment span a much smaller subspace: during continuous motion, changes in the phases of any two modules should be identical, up to a proportionality factor related to their respective grid spacings. However, in the absence of correcting mechanisms phase errors that accrue in different modules due to noise might not adhere to these restrictions. Such incompatible drifts can rapidly lead to combinations of phases that do not represent any position in the nearby vicinity of the animal, resulting in catastrophic readout errors (<xref ref-type="fig" rid="fig5">Figure 5a</xref>) (see also <xref ref-type="bibr" rid="bib8">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib65">Sreenivasan and Fiete, 2011</xref>; <xref ref-type="bibr" rid="bib72">Welinder et al., 2008</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Place cells coordinate the representations of position in distinct grid cell modules.</title><p>(<bold>a</bold>) The need for coupling. Top panel: blue- and red-shaded areas represent schematically the posterior likelihood for the animal’s position in 2-d, obtained from the activity of all grid cells in module 1 (red) and module 2 (blue). Periodic colored blobs correspond to areas with high likelihood for the position, while blank areas correspond to low likelihood (note that since the blobs represent a decoded likelihood from the activity of all grid cells in the same module, they should not be confused with the spatial receptive fields of single cells). The position which is most likely given the joint activity in both modules is designated by a black circle. Bottom left: when noise-driven drifts in the two modules are identical (compatible drifts, blue and red arrows), the outcome is a shift in the represented position (original location marked by black dashed circle for reference). Bottom right: incompatible drifts in the two modules may result in abrupt jumps in the maximum-likelihood location (<xref ref-type="bibr" rid="bib8">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib49">Mosheiff and Burak, 2019</xref>). (<bold>b</bold>) Examples of 1-d simulation results starting from a consistent initial condition showing grid cell module bump locations (green, red and blue) vs. time without (up) and with (middle) coupling between place cells and grid cells. Random accumulated drifts are driven by intrinsic neural noise, modeled as arising from Poisson spiking. Dashed lines in middle panel are generated from a non-noisy simulation for reference. Bottom: mean square displacement (MSD) between bump locations of distinct grid cell modules (averaged across all pairs and realizations of the stochastic dynamics) vs. time with (green) and without (red) coupling between place cells and grid cells, starting from a consistent initial condition. Shaded error bars are 1.96 times the standard deviations obtained from each simulation, divided by the square root of the number of realizations (corresponding to a confidence interval of 95%). (<bold>c</bold>) Similar examples (top, middle) and analysis (bottom) as in (b) but obtained from simulations in which drifts arise from incompatible velocity inputs provided to the distinct modules.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig5-v2.tif"/></fig><p>Sensory cues may correct drifts in individual modules and restore the coordination between the phases of different modules. It has been shown that such phase resets occur during encounters with walls, possibly mediated by an interaction between grid cells and border cells (<xref ref-type="bibr" rid="bib26">Hardcastle et al., 2015</xref>; <xref ref-type="bibr" rid="bib50">Mulas et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Pollock et al., 2018</xref>). However, it has been argued that under conditions in which sensory inputs are absent or poor, other mechanisms must act to coordinate grid cell phases and prevent catastrophic readout errors (<xref ref-type="bibr" rid="bib8">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib18">Fiete et al., 2008</xref>). Two possible mechanisms have been proposed: in one solution (<xref ref-type="bibr" rid="bib65">Sreenivasan and Fiete, 2011</xref>; <xref ref-type="bibr" rid="bib72">Welinder et al., 2008</xref>), the hippocampal network reads out the position jointly represented by grid cell modules, and projections from hippocampus to the MEC correct small incompatible drifts accrued in the different modules. A second solution, proposed more recently (<xref ref-type="bibr" rid="bib49">Mosheiff and Burak, 2019</xref>) involves synaptic connectivity between grid cells belonging to different modules. The first solution has been explored previously (<xref ref-type="bibr" rid="bib65">Sreenivasan and Fiete, 2011</xref>) without explicit modeling of attractor dynamics in the hippocampus, and without considering the embedding of multiple spatial maps in the entorhinal-hippocampal network. Therefore, we tested whether coordination of modules can be implemented in the coupled system, across multiple environments.</p><p>We first considered the consequences of stochastic neural firing, by modeling grid cells as noisy (Poisson) units. In the absence of coupling between the MEC and hippocampus the positions represented in different modules drifted randomly in an uncoordinated manner (<xref ref-type="fig" rid="fig5">Figure 5b</xref>, top). With bidirectional coupling (<xref ref-type="fig" rid="fig5">Figure 5b</xref>, middle) the representation of position accrued errors relative to the true position of the animal, but remained coordinated in all modules and in the hippocampus. <xref ref-type="fig" rid="fig5">Figure 5b</xref> (bottom) quantifies the relative drift between modules in the different conditions over multiple realizations of the dynamics, showing that drifts remain coordinated under coupling with the hippocampus. Drifts that are coordinated across modules are much less detrimental for decoding of position than coordinated drifts [see (<xref ref-type="bibr" rid="bib8">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib49">Mosheiff and Burak, 2019</xref>) for a thorough discussion].</p><p>Next, we demonstrated that the system is resilient to noise in the velocity inputs to the different modules (<xref ref-type="fig" rid="fig5">Figure 5c</xref>). Even in an extreme situation, in which modules received highly incompatible velocity inputs, their motion remained coordinated in the coupled network but not in the uncoupled network.</p></sec></sec><sec id="s2-4"><title>Emergent properties in the hippocampus and MEC</title><p>The embedding of multiple spatial maps in the coupled hippocampal-entorhinal network gives rise to two non-trivial emergent properties.</p><sec id="s2-4-1"><title>Variability of individual grid cell firing rates across firing fields</title><p>As the animal moves in a given environment, the summed synaptic input from all place cells to a given grid cell includes a contribution associated with that environment, which is spatially periodic. However, grid cell synaptic inputs also receive contributions from place cells associated with other spatial maps that are embedded in the synaptic connectivity. The latter contributions are spatially aperiodic within the present environment, leading to variability across fields. As an example, <xref ref-type="fig" rid="fig6">Figure 6a</xref> shows the population activity of place cells and grid cells from module #3. The system is placed at three spatial locations that are displaced from each other by the grid spacing of module #3. Thus, the same grid cells are active in these three locations. However, the amplitude of the grid cell activity bump differ at the three locations. <xref ref-type="fig" rid="fig6">Figure 6b</xref> quantifies the variability of peak firing rates generated by individual grid cells across firing fields within a single environment, using the coefficient of variation (CV): a histogram of the CV, collected from all cells, is shown for networks with varying number of embedded maps. CVs vanish when a single spatial map is embedded in the synaptic connectivity and increase with the addition of spatial maps.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Spontaneously emerging variability of individual grid cell firing rates across firing fields.</title><p>(<bold>a</bold>) Simultaneous firing rates of place cells (black) and grid cells from one module (module #3, blue), shown at three different persistent states that represent periodic locations of module #3. Even though the same grid cells are active in all three locations, the amplitude of the grid cell activity bumps differ (compared with the red dashed line which shows the maximal grid cell firing rate achieved at the left example, for reference). Different place cells are active in the three examples, thus providing different quenched noise to the same grid cells in each case. (<bold>b</bold>) Histogram showing CV of maximal firing rate obtained from all individual grid cells across firing fields within a single environment, shown for networks with a single map (blue), two maps (green), and six maps (red).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig6-v2.tif"/></fig></sec><sec id="s2-4-2"><title>Artificial hippocampal remapping upon grid cell depolarization</title><p>In a recent experiment (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>), MEC layer 2 stellate cells were reversibly hyperpolarized or depolarized using chemogenetic receptors, while animals were foraging in a familiar environment. Chronic tetrode arrays implanted in the hippocampus were used to monitor CA1 firing fields during these manipulations. Hyperpolarization of the MEC had very little effect on place cell firing fields, whereas depolarization of the MEC elicited dramatic effects: a significant portion of place cells exhibited changes in the locations or rates of their firing fields, resembling those seen during global and rate remapping experiments. This effect included place cells that had been turned off or on as seen in natural remapping experiments. Firing fields of all other cells remained in their baseline positions, without significant changes. As for the grid cells, both manipulations led to changes in the firing rates but did not elicit a change in the firing locations, unlike the coherent shifts and rotations seen in distinct familiar environments (<xref ref-type="bibr" rid="bib20">Fyhn et al., 2007</xref>).</p><p>The asymmetric effect of entorhinal depolarization and hyperpolarization was highlighted (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>) as the most puzzling experimental outcome. Indeed, under simple feedforward models of place cell emergence from grid cell inputs (<xref ref-type="bibr" rid="bib13">de Almeida et al., 2009</xref>; <xref ref-type="bibr" rid="bib45">Monaco et al., 2011</xref>; <xref ref-type="bibr" rid="bib52">Neher et al., 2017</xref>; <xref ref-type="bibr" rid="bib59">Rolls et al., 2006</xref>; <xref ref-type="bibr" rid="bib64">Solstad et al., 2006</xref>), it is difficult to envision why such an asymmetry would be observed. Overall, a theoretical framework that can coherently explain the consequences of depolarization and hyperpolarization of the MEC hasn’t been available so far.</p><p>To test the effect of grid cell depolarization or hyperpolarization in our model, we adjusted the excitability of grid cells by adding a fixed contribution to their synaptic drive, which was either excitatory or inhibitory. We first placed the system in persistent states in one map (map 1). We then hyperpolarized the grid cell network. Place cell bumps remained around their baseline spatial location, and activity in the place-cell network exhibited significant overlap only with map 1 (<xref ref-type="fig" rid="fig7">Figure 7a–b</xref>). Similar results from control trials, in which no manipulation was performed, are shown in <xref ref-type="fig" rid="fig3">Figure 3a–b</xref>. The minor effect of grid cell hyperpolarization is not surprising, since the hippocampal network is structured such that it can sustain population activity patterns associated with each environment even without inputs from grid cells. Therefore, suppression of activity in the MEC network did not significantly alter the population activity patterns expressed by the place cell network.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Emergence of persistent mixed states under depolarization but not under hyperpolarization of grid cells.</title><p>(<bold>a</bold>) Histogram showing bump score distributions for all embedded maps under grid cell hyperpolarization. In each simulation, the system is placed in a ‘consistent’ initial condition, and hyperpolarization is applied. Spatial maps are then ranked according to their bump score. Each color corresponds to a histogram over all bump scores from maps with specific rank, regardless of the map’s identity (this is identical to the analysis shown in <xref ref-type="fig" rid="fig3">Figure 3b,g,f</xref> except that here losing maps are separated into distinct histograms according to rank). Bump scores for random unembedded maps are shown in gray. (<bold>b</bold>) Distribution of identities of the top scored maps from (<bold>a</bold>). Dashed red line shows the uniform distribution. In all realizations, top ranked map is map #1. (<bold>c</bold>) Same as (<bold>a</bold>) under grid cell depolarization. Bump scores are lower than the winning scores in <xref ref-type="fig" rid="fig3">Figure 3b</xref>. Bump score distributions from differently ranked maps overlap, and all histograms exhibit significantly higher bump scores than those of unembedded maps (gray), indicating simultaneous expression of activity patterns from multiple embedded maps. (<bold>d</bold>) Same as (b) under grid cell depolarization.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Persistent mixed state examples, and maintenance of grid cell firing location but not firing rate under grid cell depolarization.</title><p>(<bold>a</bold>) Firing rates of place cells (black) and grid cells (different modules shown in green, red and blue), shown 2.25 s after starting from a ‘Consistent’ initial condition at a specific location (24 cm in map #1). (<bold>b</bold>) Same as (<bold>a</bold>) but under grid cell depolarization. Place cells exhibit scattered activity, yet they preserve dense activity around their original location from (<bold>a</bold>). Note that the grid cell activity patterns continue to match the original location in map #1, but grid cells increased their firing rate. (<bold>c–d</bold>) Same as (<bold>a–b</bold>) but observed in coordinates of map #6. Dense place cell activity can be seen around three locations (~48 cm,~120 cm and ~168 cm) under grid cell depolarization (<bold>d</bold>). Note that these locations overlap with locations in which multiple grid cell activity bumps overlap under the coordinates of map #6. (<bold>e</bold>) Analysis of persistence in the mixed state. Location of activity place cell bumps of winning maps was measured using the bump score as in <xref ref-type="fig" rid="fig3">Figure 3</xref> (Methods), 2 s and 2.5 s after onset of depolarization. A histogram of the changes in the measured location within this period is shown, demonstrating that drifts in persistent mixed states are small. Out of 500 simulations, 29 simulations in which the identity of the winning map changed within this period are excluded from the histogram.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>Bump score dynamics under grid cell hyperpolarization and depolarization.</title><p>(<bold>a</bold>) Bump score dynamics for each of the embedded maps and for unembedded maps (gray) under grid cell hyperpolarization, corresponding to the realizations shown in <xref ref-type="fig" rid="fig7">Figure 7a–b</xref>. Scores for all maps except map one overlap with the score of unembedded maps. Error bars correspond to ±1 std. (<bold>b</bold>) Same as (<bold>a</bold>) but showing only the winning map and an average over losing maps. Error bars correspond to ±1 std. (<bold>c</bold>) Same as (<bold>a</bold>), but under grid cell depolarization, corresponding to the realizations shown in <xref ref-type="fig" rid="fig7">Figure 7c–d</xref>. (<bold>d</bold>) Same as (<bold>b</bold>) but under grid cell depolarization.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig7-figsupp2-v2.tif"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 3.</label><caption><title>Mixed states can be induced or suppressed by changing the connectivity between grid cells and place cells.</title><p>(<bold>a-b</bold>) Same analysis as <xref ref-type="fig" rid="fig7">Figure 7a–b</xref> but while doubling the bi-directional synaptic strengths between grid cells and place cells. Mixed states emerge under this manipulation, without grid cell depolarization. (<bold>c–d</bold>) Same as (<bold>a–b</bold>) but while selectively enhancing only the contribution to the connectivity associated with map #1. Mixed states do not emerge in this case. (<bold>e–f</bold>) Same as (<bold>c–d</bold>) but under grid cell depolarization. Although winning map bump score (cyan) is smaller than in <xref ref-type="fig" rid="fig3">Figure 3b</xref>, mixed states still do not emerge in this case.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig7-figsupp3-v2.tif"/></fig><media id="fig7video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-56894-fig7-video1.mp4"><label>Figure 7—video 1.</label><caption><title>Dynamics under grid cell depolarization.</title><p>Firing rates of place cells (black) and grid cell modules (red, green, and blue) during a single 2.5 s simulation (shown also in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1a–d</xref>), in which the network was initialized in a ‘consistent’ state, followed after 10 ms by grid cell depolarization, which lasted until the end of the simulation. Left: neurons are sorted according to firing locations in map 1. Right: neurons are sorted according to firing locations in map 6.</p></caption></media></fig-group><p>In contrast with this result, depolarization of the MEC network elicited significant changes in the structure of population activity patterns expressed by the hippocampal network. Following a short transient, population activity of place cells stabilized on patterns that exhibited overlap with patterns that were previously associated with multiple spatial maps (<xref ref-type="fig" rid="fig7">Figure 7c</xref>). The overlap was highly significant compared to overlaps obtained with random maps that were not embedded in the connectivity (gray bars in <xref ref-type="fig" rid="fig7">Figure 7c</xref>). Thus, the place cell network expressed mixtures of population activity patterns from different maps stored in the hippocampal connectivity. Typically, the highest overlap remained with map 1 (<xref ref-type="fig" rid="fig7">Figure 7d</xref>). An example of population activity patterns before and after depolarization in one location is shown in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1a–d</xref>. (Corresponding dynamics can be seen in <xref ref-type="video" rid="fig7video1">Figure 7—video 1</xref>, and <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref> quantifies the bump score dynamics, from all realizations shown in <xref ref-type="fig" rid="fig7">Figure 7</xref>.) In similarity to experimental results (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>), both depolarization and hyperpolarization changed the firing rate, but not firing location, of MEC neurons. On average, grid cells increased their firing rates under grid cell depolarization and decreased their firing rates under grid cell hyperpolarization (not shown), in agreement with the experiment. <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1e</xref> demonstrates that the mixed activity patterns are persistent.</p><p>Our interpretation of artificial remapping is thus that excessive inputs from grid cells enhance the quenched noise arising from multiple embedded maps, and that this enhancement puts the system in a regime in which it expresses mixed states. To demonstrate the existence of such a regime, we show in <xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3a–b</xref> that similar expression of mixed states emerges when synapses between grid and place cell are strengthened, even without grid cell depolarization. In contrast, selective strengthening only of the component associated with one of the maps, does not generate mixed states (<xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3c–d</xref>). On the contrary: this selective enhancement suppresses the emergence of mixed states under grid cell depolarization (<xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3e–f</xref>). These results demonstrate that the emergence of mixed states is not simply due to enhancement of inputs from the MEC, but is due to the amplification of quenched noise.</p><p>To make direct contact with the experimental observations (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>), we examined the firing properties of individual place cells as a function of the animal’s position during locomotion under MEC depolarization. The observation that population activity patterns under depolarization are mixtures of activity patterns from different maps led us to expect that some cells would maintain place fields in their baseline locations, while others would remap. To test this hypothesis, we first placed the system in a state corresponding to a particular position in map 1. Then, while applying the perturbation, we induced path integration in the MEC network and monitored population activity patterns while continuously scanning positions along the environment.</p><p>In accordance with the hypothesis, we found that cells exhibited the same phenomenology observed experimentally (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>; <xref ref-type="fig" rid="fig8">Figure 8a–g</xref>). Many cells shifted their firing location (~29%), whereas others (~18%) maintained their place fields in their baseline location. Of these, some cells exhibited rate remapping (~7%), while the firing rate of other cells remained unaffected (~11%). Some place cells expressed one or (rarely) more firing fields in addition to their original field location (~36.5%), some completely turned-off (~6%) or exhibited a minor field (~1.5%), and some place cells remapped into more than a single field (~9%). The percentages of place cell responses are likely influenced by the model parameters (<xref ref-type="table" rid="table1">Table 1</xref>), and depend also on the precise classification criteria (Methods). Qualitatively, however, all the response types observed in our model have been observed experimentally (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>). All active cells exhibited a continuous activity pattern with one, or occasionally few, unimodal firing fields. <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref> shows all the population activity patterns observed while traversing the environment in a single path integration cycle. In agreement with the experimental observations, firing patterns returned to baseline configurations following reversal of MEC depolarization (not shown). As expected (<xref ref-type="fig" rid="fig7">Figure 7a–b</xref>), hyperpolarization did not elicit significant changes in the firing locations of place cells (<xref ref-type="fig" rid="fig8">Figure 8h</xref>).</p><table-wrap id="table1" position="float"><label>Table 1.</label><table frame="hsides" rules="groups"><thead><tr><th valign="top">Parameter</th><th valign="top">Value</th><th valign="top">Units</th></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf1"><mml:mi>L</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf2"><mml:msup><mml:mrow><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>none</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf4"><mml:mi>A</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf5"><mml:mn>8.31</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Hz</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf7"><mml:mi>σ</mml:mi></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>4.8</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>cm</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf10"><mml:mi>h</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf11"><mml:mo>-</mml:mo><mml:mn>2.6</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Hz</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf13"><mml:mi>B</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf14"><mml:mn>75</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Hz</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf16"><mml:mi>ρ</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf17"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>∙</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>radian</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf19"><mml:mi>k</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf20"><mml:mo>-</mml:mo><mml:mn>6.93</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Hz</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf23"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>radian</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf25"><mml:mi>α</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf26"><mml:mn>1.03</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Hz</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf28"><mml:mi>β</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf29"><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>20</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Hz</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf31"><mml:mi>τ</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf32"><mml:mn>15</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>s</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf35"><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>s</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>none</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>pc</mml:mtext><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf42"><mml:msup><mml:mrow><mml:mtext>Hz</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>none</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mtext>gc</mml:mtext><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf47"><mml:mfenced separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf48"><mml:msup><mml:mrow><mml:mtext>Hz</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf49"><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf50"><mml:mfenced separators="|"><mml:mrow><mml:mn>1.7,1.9,2.3</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf51"><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtext>cm</mml:mtext><mml:mo>·</mml:mo><mml:mtext>s</mml:mtext></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf52"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mtext>per</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Depo</mml:mtext></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>500</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf54"><mml:msup><mml:mrow><mml:mtext>Hz</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf55"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mtext>per</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Hyper</mml:mtext></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td valign="top"><inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf57"><mml:msup><mml:mrow><mml:mtext>Hz</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula></td></tr></tbody></table><table-wrap-foot><fn><p>*In all Figures we simulated the same networks using <inline-formula><mml:math id="inf58"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:math></inline-formula>, except for <xref ref-type="fig" rid="fig6">Figure 6b</xref> (where <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> was also set to 1 and 2), and <xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref> (where <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> was also set to 1, 2 and 4).</p></fn></table-wrap-foot></table-wrap><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Artificial remapping of place cells following depolarization, but not hyperpolarization of grid cells.</title><p>(<bold>a-g</bold>) Firing rate maps of seven representative place cells during locomotion with (blue) and without (orange) grid cell depolarization. Rate maps show that under grid cell depolarization place cells changed locations (<bold>a-b</bold>), acquired additional fields (<bold>c-d</bold>), turned off (<bold>e</bold>), rate remapped (<bold>f</bold>) or were unaffected (<bold>g</bold>). (<bold>h</bold>) Rate maps of a representative place cell with (blue) and without (orange) grid cell hyperpolarization.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig8-v2.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Place cell population activity patterns observed while traversing the environment using path integration.</title><p>(<bold>a</bold>) Place cell firing rates vs. spatial location under grid cell depolarization and grid cell integration of velocity input that produces one complete cycle through the environment. Color bar: place cell firing rates [Hz]. Place cells exhibit uni-modal and continuous firing fields. Same result is obtained while traversing the environment with different velocities, direction, or number of cycles through the environment (not shown). (<bold>b</bold>) Similar analysis as in <xref ref-type="fig" rid="fig7">Figure 7a</xref>, showing the existence of mixed states throughout the process. Activity patterns were analyzed at 500 time points uniformly distributed across the cycle. (<bold>c–d</bold>) Same as (<bold>a–b</bold>) but without grid cell depolarization (control). (<bold>e–f</bold>) Same as (<bold>a–b</bold>) during grid cell hyperpolarization.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig8-figsupp1-v2.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>Altered firing rate relationship between individual grid fields is observed during grid cell depolarization.</title><p>(<bold>a</bold>) Spearman rank correlation before and after grid cell depolarization is shown for a varied number of embedded maps. Perturbation was applied persistently 10 ms after starting from a ‘consistent’ initial condition and grid cell rates were measured 100 ms afterwards. Rates were measured from 4800 realizations, uniformly distributed over all positions. Error bars are 1.96 times the standard deviations obtained from each simulation, divided by the square root of the number of realizations (corresponding to a confidence interval of 95%). (<bold>b</bold>) Same as (<bold>a</bold>) but under grid cell hyperpolarization.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-fig8-figsupp2-v2.tif"/></fig></fig-group><p>Finally, we examined how grid cell activity is influenced by the altered firing patterns of place cells during grid cell depolarization. Our previous observation that place cell inputs induce variability in firing rates of single grid cells across different firing fields, led us to examine whether the rank order of grid fields according to peak firing changes under the modification of place cell firing patterns associated with grid cell depolarization (similar rank changes have been observed also under place cell rate remapping, but in this case changes were induced by modifications of sensory inputs in a familiar environment [<xref ref-type="bibr" rid="bib15">Diehl et al., 2017</xref>]). <xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref> demonstrates that when a single spatial map is embedded in the synaptic connectivity the rank correlation is equal to unity, as expected. When multiple spatial maps are embedded in the connectivity, the rank order correlation weakens, in accordance with experimental observations (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>).</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We demonstrated how multiple attractor networks in the hippocampus and MEC can be coupled to each other, such that they jointly and coherently represent positions across multiple spatial maps, while exhibiting the features of global remapping that are experimentally observed in both brain areas.</p><p>Due to the embedding of multiple spatial maps in the hippocampal network, the input to a place cell in a given environment can be separated into two components. The first component arises from the synaptic connectivity associated with the presently expressed spatial map. The other component is associated with other spatial maps, and contributes quenched noise to the synaptic inputs (<xref ref-type="bibr" rid="bib3">Battaglia and Treves, 1998</xref>; <xref ref-type="bibr" rid="bib46">Monasson and Rosay, 2013</xref>; <xref ref-type="bibr" rid="bib60">Samsonovich and McNaughton, 1997</xref>) (Appendix 1). Due to this quenched noise, the system loses its ability to represent all spatial positions in true steady states of the network dynamics. However, if the quenched noise is sufficiently weak, bump states representing all possible positions remain highly persistent. This feature of continuous attractor systems with quenched noise, and specifically with multiple maps, has been extensively discussed in previous works (<xref ref-type="bibr" rid="bib29">Itskov et al., 2011</xref>; <xref ref-type="bibr" rid="bib47">Monasson and Rosay, 2014</xref>). For this reason, we tested for the existence of persistent rather than steady states in our analysis (<xref ref-type="fig" rid="fig3">Figure 3</xref>). In particular, we verified that drifts of the represented location are small, when starting from the consistent condition (<xref ref-type="fig" rid="fig3">Figure 3d</xref>). The drift rate is expected to be even smaller with a larger number of place cells, since the contribution from place cell inputs to the drift scales inversely with the network size (<xref ref-type="bibr" rid="bib47">Monasson and Rosay, 2014</xref>). Furthermore, it has been demonstrated that sensory inputs, projecting to the hippocampus can pin the representation and prevent drift (<xref ref-type="bibr" rid="bib47">Monasson and Rosay, 2014</xref>).</p><p>Systematic drifts (<xref ref-type="bibr" rid="bib29">Itskov et al., 2011</xref>; <xref ref-type="bibr" rid="bib47">Monasson and Rosay, 2014</xref>) and pinning of the attractor state when velocity inputs are small (<xref ref-type="bibr" rid="bib9">Burak and Fiete, 2009</xref>), can reduce the precision of path integration. Yet, <xref ref-type="fig" rid="fig4">Figure 4b</xref> demonstrates that with a realistic distribution of velocities, the system is still highly effective in integrating the velocity inputs, over multiple spatial maps, even when allocentric sensory inputs are completely absent.</p><p>Our model simplified the biological complexity of the hippocampal formation: we did not take into account the laminar organization of the MEC, and the division of the hippocampus into sub-regions. Our model of the hippocampal network matches most closely CA3, which is believed to underlie the auto-associative features of network activity in the hippocampus, and is the area targeted by layer II of the MEC, which was manipulated by <xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>.</p><p>We assumed that the association of place cells to locations in a novel environment is random and occurs jointly with random and independent realignment of grid phases. The connectivity is then set up in order to support the joint representation in the hippocampus and MEC. Under independent remapping in grid cells and place cells, the capacity of the joint representation is limited by the grid-to-place connections (Appendix 1). This result is in line with recent analysis (<xref ref-type="bibr" rid="bib76">Yim et al., 2019</xref>), which indicates that once grid phases are set, realizable patterns of place fields by a binary perceptron (involving a linear weighting of grid cell inputs) are limited. As an alternative to independent remapping in place cells and grid cells, it has been proposed that place cell firing locations may be determined in a new environment by grid cell inputs (<xref ref-type="bibr" rid="bib20">Fyhn et al., 2007</xref>; <xref ref-type="bibr" rid="bib45">Monaco et al., 2011</xref>). We did not explore this scenario explicitly in this work, but in principle, it may be possible to construct a variant of our model in which connections from grid cells to place are kept fixed as new maps are embedded in the network, while the association of place cells to positions in a new environment is determined by these fixed connections, followed by competitive dynamics. The exact mechanism through which spatial fields in novel environments are associated to place cells is not known and since global remapping in place cells can occur also without input from grid cells (<xref ref-type="bibr" rid="bib62">Schlesiger et al., 2018</xref>), it is likely that place fields are not solely determined by grid cells inputs.</p><p>Previous theoretical works showed that the grid cell representation has a high dynamic range, which enables coding and storage in working memory of the animal’s location with high spatial resolution, over a large range of positions (<xref ref-type="bibr" rid="bib8">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib18">Fiete et al., 2008</xref>; <xref ref-type="bibr" rid="bib41">Mathis et al., 2012</xref>; <xref ref-type="bibr" rid="bib65">Sreenivasan and Fiete, 2011</xref>; <xref ref-type="bibr" rid="bib71">Wei et al., 2015</xref>). However, due to the distributed nature of the grid cell code, it was argued that it is crucial to maintain precise coordination between the positions represented in different grid cell modules (<xref ref-type="bibr" rid="bib8">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib49">Mosheiff and Burak, 2019</xref>; <xref ref-type="bibr" rid="bib65">Sreenivasan and Fiete, 2011</xref>; <xref ref-type="bibr" rid="bib72">Welinder et al., 2008</xref>). Here, we showed that the required coordination can be achieved through bidirectional connectivity between grid cells and place cells, over multiple spatial maps, using an explicit model of attractor dynamics in the MEC and the hippocampus.</p><p>The experimentally observed variability in the firing rates of individual grid cells across their firing fields may arise from place cell inputs, as predicted by our model and proposed in other studies (<xref ref-type="bibr" rid="bib17">Dunn et al., 2017</xref>; <xref ref-type="bibr" rid="bib28">Ismakov et al., 2017</xref>). The variability can arise from inhomogeneities in the synaptic connections from place cell to grid cells which are unrelated to the embedding of multiple maps (<xref ref-type="bibr" rid="bib17">Dunn et al., 2017</xref>). Alternately, it can arise from sensory inputs, or from synaptic inputs from different modules (<xref ref-type="bibr" rid="bib28">Ismakov et al., 2017</xref>; <xref ref-type="bibr" rid="bib32">Kang and Balasubramanian, 2019</xref>). Instead, we identified a mechanism which naturally produces this variability, at least in part, simply by the process of embedding multiple spatial maps in the connectivity and is independent from sensory inputs. The fact that the rank order of grid fields was modified under grid cell depolarization when the hippocampal network exhibited artificial remapping (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>), as observed in our model, provides further support to the hypothesis that inputs from place cells significantly contribute to the variability, independently of sensory inputs.</p><p>Our model reproduces the recently observed phenomenology of artificial remapping in the hippocampus under MEC depolarization but not under hyperpolarization. While this phenomenon resembles partial remapping observed under certain manipulations of environmental features (<xref ref-type="bibr" rid="bib11">Colgin et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Latuske et al., 2017</xref>; <xref ref-type="bibr" rid="bib51">Muller and Kubie, 1987</xref>; <xref ref-type="bibr" rid="bib56">Quirk et al., 1990</xref>), we focused on artificial remapping (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>) since our interest in this work is in the ability of the MEC and hippocampus to sustain persistent patterns of activity at the population level, irrespective of external inputs. Artificial remapping, as opposed to partial remapping, occurs under a manipulation in which sensory inputs are kept fixed and therefore must arise from mechanisms that are intrinsic to the MEC-hippocampal network.</p><p>According to our model, artificial remapping is a consequence of a perturbation to the network that places it in a regime in which it expresses mixtures of population activity patterns. This transition does not require any modification of sensory inputs, in accordance with the experimental protocol (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>), in which the environment remains fixed. All types of remapping observed experimentally (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>), emerged in our model except for cells that lacked a firing field before depolarization and acquired one afterwards. This is due to the fact that, for simplicity, we assigned a spatial receptive field to all cells in each environment. It would be straightforward to include in the model silent cells in each spatial map (<xref ref-type="bibr" rid="bib46">Monasson and Rosay, 2013</xref>), in order to obtain cells in the hippocampal network that acquire a firing field only after grid cell depolarization.</p><p>Our results also suggest that place cell artificial remapping is likely to occur at specific spatial locations which are determined by the relationship between grid phases and the place cell’s firing locations across all maps: remapped place fields are likely to emerge at locations in which the grid phases (associated with the original spatial map) align under the coordinates of another spatial map. Note that artificial remapping occurs only in place cells while grid cell activities do not collectively realign or change their firing location (in agreement with <xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>). This property breaks the symmetry between the maps, as there is still a signature of the original map expressed by grid cells. One implication of this prediction is that remapping is likely to occur to locations in which the synaptic input to the place cells is elevated before the depolarization (even if it is not sufficiently strong to induce firing). Another manifestation of this prediction can be easily seen in <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1a</xref>: a margin of positions near the diagonal into which place cells are highly unlikely to remap.</p><p>The model explains why artificial remapping occurred under depolarization, but not under hyperpolarization of MEC cells (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>). In another experiment (<xref ref-type="bibr" rid="bib44">Miao et al., 2015</xref>), remapping in the hippocampus was observed under suppression of activity in the MEC. The reason for the different outcomes (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>; <xref ref-type="bibr" rid="bib44">Miao et al., 2015</xref>) is unclear. The different outcomes may have arisen from specificity differences in the targeted populations: in <xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref> chemogenetic receptors were targeted almost exclusively to layer II stellate cells of the MEC in transgenic animals. In comparison, a broader population has been likely affected in <xref ref-type="bibr" rid="bib44">Miao et al., 2015</xref>–in terms of the targeted anatomical area and cortical layers (since the manipulation relied on the diffusion of a virus), and the affected cell types, which most likely included interneurons. Another difference between the experiments of Miao et al and Kanter et al is that the former recorded neural activity in CA3, whereas the latter recorded activity in CA1.</p><sec id="s3-1"><title>Experimental predictions</title><p>We next discuss some of the predictions arising from our model. To test some of these predictions experimentally, it will be necessary to simultaneously record the activity of multiple cells in the MEC and the hippocampus in freely behaving animals, in sufficient numbers that will enable dynamic decoding of the population activity. Thus, our results offer a rich set of predictions that could be tested using high-throughput recording techniques (<xref ref-type="bibr" rid="bib31">Jun et al., 2017</xref>; <xref ref-type="bibr" rid="bib54">Pfeiffer and Foster, 2015</xref>; <xref ref-type="bibr" rid="bib80">Ziv et al., 2013</xref>; <xref ref-type="bibr" rid="bib81">Zong et al., 2017</xref>).</p><sec id="s3-1-1"><title>Idiothetic path integration</title><p>We predict that when updates of the brain’s self-estimate of position rely solely on idiothetic path integration, the hippocampal representation of position will lag behind the MEC representation, due to synaptic transmission delays (<xref ref-type="fig" rid="fig4">Figure 4d</xref>). If verified, this feature of the neural population dynamics may help identify where different types of sensory inputs are integrated into the joint neural representation of position in the hippocampus and the MEC. If sensory inputs that convey spatial information project mainly to hippocampus, we expect a reversal of the time lag under conditions in which such sensory inputs are highly informative.</p><p>The hippocampal network in our model is set up such that it expresses bump activity patterns at the neural population level even without inputs from the MEC. This is in agreement with the observation that place fields are expressed under MEC lesions (<xref ref-type="bibr" rid="bib6">Brun et al., 2008</xref>; <xref ref-type="bibr" rid="bib25">Hales et al., 2014</xref>). We predict that under these manipulations, and in conditions in which sensory inputs are absent, such that the brain must rely on idiothetic path integration to update its internal representation of position, bump activity patterns will still be expressed in the hippocampus at the population level, but their association with position will be disrupted. Thus, the spatial fields of single cells will be severely disrupted in these conditions.</p></sec><sec id="s3-1-2"><title>Coupling of entorhinal modules</title><p>To test whether a coupling mechanism coordinates the states of grid cell modules, we propose to simultaneously decode activities of multiple modules under conditions in which sensory inputs are absent or poor, and observe whether drifts in these modules are coordinated. A hippocampus-independent mechanism for coordinating the activity of grid cells modules, which relies on synaptic connectivity within the MEC was recently proposed (<xref ref-type="bibr" rid="bib49">Mosheiff and Burak, 2019</xref>). Therefore, it will be of interest to further test whether the coordination requires place cell inputs to the MEC, by repeating the experiment while inactivating inputs from the hippocampus. Under these conditions, cells within a single grid cell module maintain their phase relationships (<xref ref-type="bibr" rid="bib1">Almog et al., 2019</xref>), but it is unknown whether drifts in different modules remain coordinated. Another possible way to approach this question is to examine the coordination of grid cell modules immediately after exposure to a completely novel environment, since it is unlikely that reciprocal connectivity that could support this coordination is established immediately.</p></sec><sec id="s3-1-3"><title>Variability of individual grid cell firing rates across firing fields</title><p>Two experiments can directly test the hypothesis that inputs from place cells, independent of sensory inputs, are responsible for a significant fraction of the variability observed in the firing rates of individual grid cells across different firing fields. First, if grid cell modules remain coordinated under hippocampal inactivation, it may be possible to decode position from activity in the MEC in this condition, and test whether firing rates become less variable across firing fields. Second, the independence of variability on sensory inputs could be tested by monitoring activity in the MEC under conditions in which sensory cues are poor or absent. It would also be interesting in this context to measure the variability in animals that have been exposed to different numbers of environments.</p></sec><sec id="s3-1-4"><title>Artificial remapping</title><p>We predict that artificial remapping (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>) arises due to the auto-associative features of network dynamics in the hippocampus, which are believed to arise in area CA3. However, Kanter et al recorded in area CA1. Global and partial remapping have been observed both in CA1 and CA3, yet patterns of activity in CA1 tend to be more correlated across different environments than those observed in CA3 (<xref ref-type="bibr" rid="bib40">Leutgeb et al., 2004</xref>). Thus, partial remapping in CA1 does not necessarily imply that remapping in CA3 is partial as well. Since Kanter et al observed partial overlap between CA1 activity patterns that were expressed before and after entorhinal depolarization, it will be interesting to record activity also in CA3 under similar conditions. We predict that mixed states will be observed already in CA3 during entorhinal depolarization. Thus, we expect that in CA3 (in similarity to CA1) only a subset of place fields will shift their firing fields. On the other hand, this form of remapping is not expected to occur in the dentate gyrus, since this area is upstream of CA3.</p><p>According to our theory, artificial remapping (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>) arises from expression of population activity patterns that mix contributions normally associated with distinct environments. To test this prediction, we propose to raise animals while exposing them to a limited number of environments. After measuring the response patterns of place cells in each of these environments, we propose to apply depolarization of the MEC in one environment, and look for overlap between place cell activity patterns, and the activity patterns that were previously observed in the other environments (with appropriate controls such as those obtained by randomly permuting cells, or by exposing the animal to new environments after the depolarization experiments). Overlap with one of the experimentally characterized spatial maps is not certain, but this is a plausible outcome of our theory, since we observe that the overlap is highly significant with many spatial maps. If successful, such experiments may provide direct evidence for a key theoretical prediction on the dynamics of auto-associative networks: the emergence of mixed states (<xref ref-type="bibr" rid="bib2">Amit et al., 1985</xref>; <xref ref-type="bibr" rid="bib7">Brunel, 2003</xref>).</p></sec></sec></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Place cell network</title><p>The place network consists of <inline-formula><mml:math id="inf61"><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4800</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula> neurons, which represent positions in <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> environments. All environments are one-dimensional, spanning a length of 192 cm with periodic boundary conditions. A distinct spatial map is generated for each environment, by choosing a random permutation that assigns all place cells to a set of preferred firing location that uniformly tile this environment.</p><p>The synaptic connectivity between place cells is expressed as a sum over contributions from all spatial maps:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mi mathvariant="bold">J</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf63"><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> depends on the distance between the preferred firing locations of cells <inline-formula><mml:math id="inf64"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf65"><mml:mi>j</mml:mi></mml:math></inline-formula> in environment <inline-formula><mml:math id="inf66"><mml:mi>l</mml:mi></mml:math></inline-formula>, as follows<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="center left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>A</mml:mi><mml:mi>exp</mml:mi><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mstyle></mml:mtd><mml:mtd><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The first term is an excitatory contribution to the synaptic connectivity that decays with the distance <inline-formula><mml:math id="inf67"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, with a Gaussian profile. The second term is a uniform inhibitory contribution. The parameters <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>h</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> are listed in <xref ref-type="table" rid="table1">Table 1</xref>. Note that the connectivity matrices corresponding to any two maps <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are related to each other by a random permutation:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></disp-formula>where <inline-formula><mml:math id="inf73"><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> denotes the random permutation from map <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to map <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-2"><title>Grid cell network</title><p>Each grid cell module is modeled as a double ring attractor (<xref ref-type="bibr" rid="bib75">Xie et al., 2002</xref>) with <inline-formula><mml:math id="inf76"><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>960</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula> neurons. Within each module, neurons are assigned angles <inline-formula><mml:math id="inf77"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, uniformly distributed in <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow/><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow/><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1...</mml:mn><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The synaptic weight between neurons <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is given by<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="center left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>B</mml:mi><mml:mi>exp</mml:mi><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mo>±</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mstyle></mml:mtd><mml:mtd><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf81"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mtext>min</mml:mtext><mml:mfenced separators="|"><mml:mrow><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo> <mml:mi/><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>-</mml:mo><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula> and the small phase shift <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula> applies to the pre-synaptic neurons with even (odd) index <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Thus, evenly indexed and oddly indexed neurons comprise two sub-populations that drive motion of the activity to the right and to the left, respectively, to implement idiothetic path integration (see also <xref ref-type="disp-formula" rid="equ9">Equation 9</xref> below). The parameters <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are listed in <xref ref-type="table" rid="table1">Table 1</xref>. The ring attractor possesses a continuous manifold of steady states, structured as activity bumps that can be localized anywhere in the range <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. We refer to the the center of the activity bump as the phase of the population activity pattern. Grid cells from distinct modules are not directly connected to each other.</p><p>In our implementation of the model, we include three grid cell modules with grid spacings <inline-formula><mml:math id="inf89"><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>64</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:mn>48</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>38.4</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> cm for modules <inline-formula><mml:math id="inf91"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo> <mml:mi/><mml:mn>2</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively. Within each environment, positions are mapped to attractor states by tiling the possible phases <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of the population activity periodically along the extent of the environment. For simplicity, we chose grid spacings that correspond precisely to 5, 4 and 3 cycles along the 192 cm environment. To account for grid cell realignment during global remapping (<xref ref-type="bibr" rid="bib20">Fyhn et al., 2007</xref>), a uniform phase shift <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is applied to the tiling of grid phases to positions. This phase shift is randomly chosen from the range <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, independently for each environment <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and module <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-3"><title>Bi-directional synaptic connectivity between grid cells and place cells</title><p>The mutual connection between each place cell and grid cell depends linearly on the overlap between their tuning curves, summed over all environments. We thus define a connectivity matrix <inline-formula><mml:math id="inf98"><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> between all place cells and all grid cells from module <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> as a sum over contributions <inline-formula><mml:math id="inf100"><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> from all environments:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>To determine <inline-formula><mml:math id="inf101"><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> we first define a correlation matrix<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:math></disp-formula>where <inline-formula><mml:math id="inf102"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the idealized receptive field of place cell <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf104"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the idealized receptive field of grid cell <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> measured from uncoupled networks at environment <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The normalization factor <inline-formula><mml:math id="inf107"><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is chosen such that <inline-formula><mml:math id="inf108"><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>0,1</mml:mn></mml:mrow></mml:mfenced> <mml:mi/><mml:mo>∀</mml:mo><mml:mi>μ</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula>.</p><p>Note that the correlation matrices corresponding to any two maps <inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are related to each other by a permutation on the place cell indices, and a cyclic shift on the grid cell indices. Finally,<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:math></disp-formula>where the parameters <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> are identical for all modules and maps (<xref ref-type="table" rid="table1">Table 1</xref>).</p><p>The idealized receptive fields of place cells and grid cells from <xref ref-type="disp-formula" rid="equ6">Equation (6)</xref> are determined as follows: the field <inline-formula><mml:math id="inf113"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is generated by simulating only the place cell network, uncoupled from the grid cell network and when only a single map is embedded in the connectivity. This generates an idealized bump around the initial condition, and all possible steady states of this bump are related to each other by rigid translation in the neural space sorted by the coordinates of map <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Thus, rigid translations of the observed activity bump are associated with all possible positions in the environment. Similarly, the tuning curve <inline-formula><mml:math id="inf115"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> of a particular grid cell from module <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, is defined using a rigid translation of an idealized grid cell activity pattern which emerged in a simulation of an uncoupled grid cell module network, and association of the different translations with all possible positions in the environment.</p></sec><sec id="s4-4"><title>Dynamics</title><p>The dynamics of neural activity are described by a standard rate model. The synaptic activation <inline-formula><mml:math id="inf117"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of place cell <inline-formula><mml:math id="inf118"><mml:mi>i</mml:mi></mml:math></inline-formula> evolves in time according to the following equation:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>pc</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>and the synaptic activation <inline-formula><mml:math id="inf119"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> of grid cell <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> from module <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> evolve as follows:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:msubsup><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mtext>gc</mml:mtext></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>±</mml:mo><mml:msup><mml:mi>ε</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In both equations, <inline-formula><mml:math id="inf122"><mml:mi>τ</mml:mi></mml:math></inline-formula> is the synaptic time constant (taken for simplicity to be identical for all synapses). The coupling parameters <inline-formula><mml:math id="inf123"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf124"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> determine the strength of synaptic connections from grid cells to place cells and from place cells to grid cells, respectively. The velocity signal is denoted by <inline-formula><mml:math id="inf125"><mml:mi>v</mml:mi></mml:math></inline-formula>. The signs (+) and (−) are used for the even and odd grid cell populations, respectively. Thus, neurons with even index, whose outgoing synaptic weights are biased to the right (see <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) are preferentially activated during motion to the right, whereas neurons with odd index, whose synaptic weights are biased to the left are preferentially activated during motion to the left. The coefficients <inline-formula><mml:math id="inf126"><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> determine the weighting of the velocity signal per module. These parameters are chosen in order to obtain correct grid spacings during idiothetic path integration. The external currents <inline-formula><mml:math id="inf127"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mtext>pc</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> in the place cell population and <inline-formula><mml:math id="inf128"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mtext>gc</mml:mtext></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> in the grid cell population are constant in time and identical in all cells from a given subpopulation. These currents include two terms: one term is the baseline current, required to drive activity when a single spatial map is embedded in the connectivity. The second term compensates for interference coming from additional maps, and is proportional to <inline-formula><mml:math id="inf129"><mml:mtable><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula> (see Appendix 1, <xref ref-type="disp-formula" rid="equ37 equ38">Equations 37 and 38</xref>).</p><p>The transfer function <inline-formula><mml:math id="inf130"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> determines the firing rate (in Hz) of place cells <inline-formula><mml:math id="inf131"><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> and grid cells <inline-formula><mml:math id="inf132"><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math></inline-formula> as a function of their total synaptic inputs. To resemble realistic neuronal F-I curves, it is chosen to be sub-linear:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mtext> </mml:mtext><mml:mo>≤</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msqrt><mml:mi>x</mml:mi></mml:msqrt></mml:mtd><mml:mtd><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The noise terms <inline-formula><mml:math id="inf133"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> and <inline-formula><mml:math id="inf134"><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ9">Equation 9</xref> are included only in <xref ref-type="fig" rid="fig5">Figure 5</xref>. These terms have zero mean, and to mimic Poisson noise, we assume that they are independent for different neurons and obey<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We implemented the dynamics using the Euler-method for numeric integration, with a time interval <inline-formula><mml:math id="inf135"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="table" rid="table1">Table 1</xref>).</p></sec><sec id="s4-5"><title>Coupling parameters</title><p>The parameter <inline-formula><mml:math id="inf136"><mml:mi>α</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ7">Equation 7</xref> is included for convenience but is redundant since it can be absorbed in the definitions of <inline-formula><mml:math id="inf137"><mml:mi>β</mml:mi><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf138"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. We note also that due to the coupling parameters <inline-formula><mml:math id="inf139"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf140"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the synaptic connectivity is not necessarily symmetric. However, it is possible to recast the equations in a form that involves symmetric connectivity, by rescaling the synaptic variables <inline-formula><mml:math id="inf141"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf142"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. This observation is important since it implies that the dynamics always settle on stationary steady states and do not exhibit limit cycles (<xref ref-type="bibr" rid="bib10">Cohen and Grossberg, 1983</xref>).</p><p>The coupling parameters <inline-formula><mml:math id="inf143"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf144"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were chosen based on the following considerations: on one hand, if the coupling parameters are too weak, the network exhibits persistent states in which the bump positions in different sub-networks are incompatible. Moreover, it is essential for path integration and the coupling of grid cell modules, that both place cells can influence the position of grid cell bumps, and that grid cells can influence the state of the place cell network. Thus, it was not sufficient to include connections only in one direction. On the other hand, the connections cannot be too strong since we are interested in the regime in which the structure of steady states in each sub-network is predominantly determined by its internal connectivity. These goals can be achieved using a wide range of choices for <inline-formula><mml:math id="inf145"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf146"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. A single set of parameters (<xref ref-type="table" rid="table1">Table 1</xref>) was used throughout the manuscript.</p></sec><sec id="s4-6"><title>Bump score and location analysis</title><p>Without loss of generality, whenever we set the system in a bump state, we do so in the map labeled as map 1.</p><sec id="s4-6-1"><title>Place cell network</title><p>To identify whether the place cell network expresses a bump state, and to identify its location <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and associated spatial map <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, we define a correlation coefficient <inline-formula><mml:math id="inf149"><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> that quantifies the overlap between the hippocampal population activity pattern and the activity pattern corresponding to position <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in spatial map <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf152"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (already defined above) is the firing rate of place cell <inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf154"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, is the firing rate of neuron <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in an idealized bump state localized at position <inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in map <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The idealized bump (as defined above) is obtained from the activity of a network in which a single map (map <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) is embedded in the neural connectivity, and there is no quenched noise.</p><p>Next, we define a bump score for each spatial map, defined as the maximum of the correlation coefficient <inline-formula><mml:math id="inf159"><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> over all positions <inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in spatial map <inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mo form="prefix">max</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:munder><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Finally, the map with the highest <inline-formula><mml:math id="inf162"><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> value is considered as the winning map, and the location <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> that generated that value is considered as the location of the place cell bump within that map.</p></sec><sec id="s4-6-2"><title>Grid cell network</title><p>To identify the location corresponding to activity in each grid cell module, we use a similar procedure, in which we calculate the overlap between the population activity and an idealized activity pattern of grid cells, evaluated across all positions in the winning map. Note that due the periodicity of grid cell responses, multiple positions produce the same correlation coefficient. When measuring the distance between the grid cell activity bump and the place activity bump or with its initial position (for example in <xref ref-type="fig" rid="fig3">Figure 3c,g and k</xref>), we chose from these periodically spaced positions the one closest to the location of the place cell bump.</p></sec></sec><sec id="s4-7"><title>Grid cells hyperpolarization and depolarization implementation</title><p>To mimic to effects of transgenic DREADDs (Designer Receptors Exclusively Activated by Designer Drugs) in MEC layer 2 cells as performed experimentally (<xref ref-type="bibr" rid="bib33">Kanter et al., 2017</xref>) we added a constant current <inline-formula><mml:math id="inf164"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mtext>per</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> to the total synaptic input driving grid cell activity. <xref ref-type="disp-formula" rid="equ9">Equation 9</xref> is thus replaced by:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:msubsup><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mtext>gc</mml:mtext></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>±</mml:mo><mml:msup><mml:mi>ε</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>per</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>A current <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> was used for depolarization, and a current <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> was used for hyperpolarization (see <xref ref-type="table" rid="table1">Table 1</xref>).</p><sec id="s4-7-1"><title>Analysis of persistent mixed states</title><p>In <xref ref-type="fig" rid="fig7">Figure 7</xref>, the system is placed at bump states corresponding to 500 uniformly distributed spatial locations in map 1, and its state is analyzed after a 2 s delay period following the onset of grid cell depolarization.</p></sec></sec><sec id="s4-8"><title>Classification of place cell responses under grid cell depolarization</title><p>Classification of place cell responses under grid cell depolarization was performed based on the following criteria: (a) Cells that turned off (∼6%) are defined as cells that exhibited a precisely vanishing firing rate at all locations. (b) Cells with a minor field (∼1.5%) are defined as cells that exhibited maximal peak firing rate of 2.5 Hz (not necessarily in the vicinity of the peak’s original location). (c) Cells that rate remapped (∼7%) are defined as cells whose peak firing rate remained within a distance of at most 12 cm from its original location. In addition, their peak firing rate decreased or increased by more than 33% relative to its baseline value (but did not decrease below 2.5 Hz). (d) Cells that were not affected (∼11%) are defined as in (c), except that their peak firing rate did not change by more than 33% relative to its baseline value. (e) Cells that shifted their firing location (∼29%) are defined as cells that exhibited a peak firing rate greater than 2.5 Hz, at a distance of 12 cm or more from the baseline peak location. (f) Cells that expressed remapped fields but maintained their firing field in their original location (∼36.5%) are defined as in (e), but exhibited in addition a peak firing rate which did not change by more than 33% relative to its baseline value and at a distance not greater than 12 cm from its original location. (g) Cells that expressed multiple fields (∼9%) are defined as cells that exhibited more than a single peak (at least one peak greater than 2.5 Hz - could involve in addition multiple smaller peaks) at distances greater than 12 cm from the original peak location.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This research was supported by the Israel Science Foundation grant No. 1745/18, in part by the Israel Science Foundation grant No. 1978/13, and by a grant from the GIF, the German-Israeli Foundation for Scientific Research and Development. We acknowledge support from the Gatsby Charitable Foundation.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Methodology, Writing - original draft, Project administration, Writing - review and editing, Development of the theory</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Methodology, Writing - original draft, Project administration, Writing - review and editing, Development of the theory</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-56894-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>This is a theoretical manuscript which does not contain data of our own. The rat trajectory used in Figure 4 to generate a distribution of velocities is taken from Fig.2c in (Hafting et al., 2005). It is available online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.11582/2014.00001">https://doi.org/10.11582/2014.00001</ext-link>.</p><p>The following previously published dataset was used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>T</surname><given-names>Hafting</given-names></name><name><surname>M</surname><given-names>Fyhn</given-names></name><name><surname>S</surname><given-names>Molden</given-names></name><name><surname>MB</surname><given-names>Moser</given-names></name><name><surname>EI</surname><given-names>Moser</given-names></name></person-group><year iso-8601-date="2005">2005</year><data-title>Grid cell data Hafting et al 2005</data-title><source>NIRD Research Data Archive</source><pub-id assigning-authority="Dryad" pub-id-type="doi">10.11582/2014.00001</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almog</surname> <given-names>N</given-names></name><name><surname>Tocker</surname> <given-names>G</given-names></name><name><surname>Bonnevie</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Derdikman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>During hippocampal inactivation, grid cells maintain synchrony, even when the grid pattern is lost</article-title><source>eLife</source><volume>8</volume><elocation-id>e47147</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.47147</pub-id><pub-id pub-id-type="pmid">31621577</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amit</surname> <given-names>DJ</given-names></name><name><surname>Gutfreund</surname> <given-names>H</given-names></name><name><surname>Sompolinsky</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Spin-glass models of neural networks</article-title><source>Physical Review A</source><volume>32</volume><fpage>1007</fpage><lpage>1018</lpage><pub-id pub-id-type="doi">10.1103/PhysRevA.32.1007</pub-id><pub-id pub-id-type="pmid">9896156</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Battaglia</surname> <given-names>FP</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Attractor neural networks storing multiple space representations: a model for hippocampal place fields</article-title><source>Physical Review E</source><volume>58</volume><fpage>7738</fpage><lpage>7753</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.58.7738</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben-Yishai</surname> <given-names>R</given-names></name><name><surname>Bar-Or</surname> <given-names>RL</given-names></name><name><surname>Sompolinsky</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Theory of orientation tuning in visual cortex</article-title><source>PNAS</source><volume>92</volume><fpage>3844</fpage><lpage>3848</lpage><pub-id pub-id-type="doi">10.1073/pnas.92.9.3844</pub-id><pub-id pub-id-type="pmid">7731993</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brandon</surname> <given-names>MP</given-names></name><name><surname>Koenig</surname> <given-names>J</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>New and distinct hippocampal place codes are generated in a new environment during septal inactivation</article-title><source>Neuron</source><volume>82</volume><fpage>789</fpage><lpage>796</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.04.013</pub-id><pub-id pub-id-type="pmid">24853939</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brun</surname> <given-names>VH</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Wu</surname> <given-names>HQ</given-names></name><name><surname>Schwarcz</surname> <given-names>R</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Impaired spatial representation in CA1 after lesion of direct input from entorhinal cortex</article-title><source>Neuron</source><volume>57</volume><fpage>290</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2007.11.034</pub-id><pub-id pub-id-type="pmid">18215625</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Brunel</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2003">2003</year><source>Course 10 Network Models of Memory</source><publisher-name>Les Houches Summer School Proceedings</publisher-name><pub-id pub-id-type="doi">10.1016/S0924-8099(05)80016-2</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Spatial coding and attractor dynamics of grid cells in the entorhinal cortex</article-title><source>Current Opinion in Neurobiology</source><volume>25</volume><fpage>169</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.01.013</pub-id><pub-id pub-id-type="pmid">24561907</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Accurate path integration in continuous attractor network models of grid cells</article-title><source>PLOS Computational Biology</source><volume>5</volume><elocation-id>e1000291</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000291</pub-id><pub-id pub-id-type="pmid">19229307</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname> <given-names>MA</given-names></name><name><surname>Grossberg</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Absolute stability of global pattern formation and parallel memory storage by competitive neural networks</article-title><source>IEEE Transactions on Systems, Man, and Cybernetics</source><volume>SMC-13</volume><fpage>815</fpage><lpage>826</lpage><pub-id pub-id-type="doi">10.1109/TSMC.1983.6313075</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colgin</surname> <given-names>LL</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Understanding memory through hippocampal remapping</article-title><source>Trends in Neurosciences</source><volume>31</volume><fpage>469</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2008.06.008</pub-id><pub-id pub-id-type="pmid">18687478</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D'Albis</surname> <given-names>T</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A single-cell spiking model for the origin of grid-cell patterns</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005782</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005782</pub-id><pub-id pub-id-type="pmid">28968386</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Almeida</surname> <given-names>L</given-names></name><name><surname>Idiart</surname> <given-names>M</given-names></name><name><surname>Lisman</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The input-output transformation of the hippocampal granule cells: from grid cells to place fields</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>7504</fpage><lpage>7512</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.6048-08.2009</pub-id><pub-id pub-id-type="pmid">19515918</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deadwyler</surname> <given-names>SA</given-names></name><name><surname>West</surname> <given-names>JR</given-names></name><name><surname>Cotman</surname> <given-names>CW</given-names></name><name><surname>Lynch</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Physiological studies of the reciprocal connections between the Hippocampus and entorhinal cortex</article-title><source>Experimental Neurology</source><volume>49</volume><fpage>35</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1016/0014-4886(75)90194-6</pub-id><pub-id pub-id-type="pmid">171171</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diehl</surname> <given-names>GW</given-names></name><name><surname>Hon</surname> <given-names>OJ</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Grid and nongrid cells in medial entorhinal cortex represent spatial location and environmental features with complementary coding schemes</article-title><source>Neuron</source><volume>94</volume><fpage>83</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.03.004</pub-id><pub-id pub-id-type="pmid">28343867</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dordek</surname> <given-names>Y</given-names></name><name><surname>Soudry</surname> <given-names>D</given-names></name><name><surname>Meir</surname> <given-names>R</given-names></name><name><surname>Derdikman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Extracting grid cell characteristics from place cell inputs using non-negative principal component analysis</article-title><source>eLife</source><volume>5</volume><elocation-id>e10094</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.10094</pub-id><pub-id pub-id-type="pmid">26952211</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Dunn</surname> <given-names>B</given-names></name><name><surname>Wennberg</surname> <given-names>D</given-names></name><name><surname>Huang</surname> <given-names>Z</given-names></name><name><surname>Roudi</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Grid cells show field-to-field variability and this explains the aperiodic response of inhibitory interneurons</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1701.04893">https://arxiv.org/abs/1701.04893</ext-link></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fiete</surname> <given-names>IR</given-names></name><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Brookings</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>What grid cells convey about rat location</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>6858</fpage><lpage>6871</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5684-07.2008</pub-id><pub-id pub-id-type="pmid">18596161</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuhs</surname> <given-names>MC</given-names></name><name><surname>Touretzky</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A spin glass model of path integration in rat medial entorhinal cortex</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>4266</fpage><lpage>4276</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4353-05.2006</pub-id><pub-id pub-id-type="pmid">16624947</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hippocampal remapping and grid realignment in entorhinal cortex</article-title><source>Nature</source><volume>446</volume><fpage>190</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1038/nature05601</pub-id><pub-id pub-id-type="pmid">17322902</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname> <given-names>RJ</given-names></name><name><surname>Lu</surname> <given-names>L</given-names></name><name><surname>Wernle</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Correlation structure of grid cells is preserved during sleep</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>598</fpage><lpage>608</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0360-0</pub-id><pub-id pub-id-type="pmid">30911185</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gil</surname> <given-names>M</given-names></name><name><surname>Ancau</surname> <given-names>M</given-names></name><name><surname>Schlesiger</surname> <given-names>MI</given-names></name><name><surname>Neitz</surname> <given-names>A</given-names></name><name><surname>Allen</surname> <given-names>K</given-names></name><name><surname>De Marco</surname> <given-names>RJ</given-names></name><name><surname>Monyer</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Impaired path integration in mice with disrupted grid cell firing</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>81</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1038/s41593-017-0039-3</pub-id><pub-id pub-id-type="pmid">29230055</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guanella</surname> <given-names>A</given-names></name><name><surname>Kiper</surname> <given-names>D</given-names></name><name><surname>Verschure</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A model of grid cells based on a twisted torus topology</article-title><source>International Journal of Neural Systems</source><volume>17</volume><fpage>231</fpage><lpage>240</lpage><pub-id pub-id-type="doi">10.1142/S0129065707001093</pub-id><pub-id pub-id-type="pmid">17696288</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Molden</surname> <given-names>S</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Microstructure of a spatial map in the entorhinal cortex</article-title><source>Nature</source><volume>436</volume><fpage>801</fpage><lpage>806</lpage><pub-id pub-id-type="doi">10.1038/nature03721</pub-id><pub-id pub-id-type="pmid">15965463</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hales</surname> <given-names>JB</given-names></name><name><surname>Schlesiger</surname> <given-names>MI</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Squire</surname> <given-names>LR</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Clark</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Medial entorhinal cortex lesions only partially disrupt hippocampal place cells and hippocampus-dependent place memory</article-title><source>Cell Reports</source><volume>9</volume><fpage>893</fpage><lpage>901</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2014.10.009</pub-id><pub-id pub-id-type="pmid">25437546</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardcastle</surname> <given-names>K</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name><name><surname>Giocomo</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Environmental boundaries as an error correction mechanism for grid cells</article-title><source>Neuron</source><volume>86</volume><fpage>827</fpage><lpage>839</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.039</pub-id><pub-id pub-id-type="pmid">25892299</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopfield</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Neural networks and physical systems with emergent collective computational abilities</article-title><source>PNAS</source><volume>79</volume><fpage>2554</fpage><lpage>2558</lpage><pub-id pub-id-type="doi">10.1073/pnas.79.8.2554</pub-id><pub-id pub-id-type="pmid">6953413</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ismakov</surname> <given-names>R</given-names></name><name><surname>Barak</surname> <given-names>O</given-names></name><name><surname>Jeffery</surname> <given-names>K</given-names></name><name><surname>Derdikman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Grid cells encode local positional information</article-title><source>Current Biology</source><volume>27</volume><fpage>2337</fpage><lpage>2343</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.06.034</pub-id><pub-id pub-id-type="pmid">28756950</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Itskov</surname> <given-names>V</given-names></name><name><surname>Hansel</surname> <given-names>D</given-names></name><name><surname>Tsodyks</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Short-Term facilitation may stabilize parametric working memory trace</article-title><source>Frontiers in Computational Neuroscience</source><volume>5</volume><elocation-id>40</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2011.00040</pub-id><pub-id pub-id-type="pmid">22028690</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeffery</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Place cells, grid cells, attractors, and remapping</article-title><source>Neural Plasticity</source><volume>2011</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1155/2011/182602</pub-id><pub-id pub-id-type="pmid">22135756</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jun</surname> <given-names>JJ</given-names></name><name><surname>Steinmetz</surname> <given-names>NA</given-names></name><name><surname>Siegle</surname> <given-names>JH</given-names></name><name><surname>Denman</surname> <given-names>DJ</given-names></name><name><surname>Bauza</surname> <given-names>M</given-names></name><name><surname>Barbarits</surname> <given-names>B</given-names></name><name><surname>Lee</surname> <given-names>AK</given-names></name><name><surname>Anastassiou</surname> <given-names>CA</given-names></name><name><surname>Andrei</surname> <given-names>A</given-names></name><name><surname>Aydın</surname> <given-names>Ç</given-names></name><name><surname>Barbic</surname> <given-names>M</given-names></name><name><surname>Blanche</surname> <given-names>TJ</given-names></name><name><surname>Bonin</surname> <given-names>V</given-names></name><name><surname>Couto</surname> <given-names>J</given-names></name><name><surname>Dutta</surname> <given-names>B</given-names></name><name><surname>Gratiy</surname> <given-names>SL</given-names></name><name><surname>Gutnisky</surname> <given-names>DA</given-names></name><name><surname>Häusser</surname> <given-names>M</given-names></name><name><surname>Karsh</surname> <given-names>B</given-names></name><name><surname>Ledochowitsch</surname> <given-names>P</given-names></name><name><surname>Lopez</surname> <given-names>CM</given-names></name><name><surname>Mitelut</surname> <given-names>C</given-names></name><name><surname>Musa</surname> <given-names>S</given-names></name><name><surname>Okun</surname> <given-names>M</given-names></name><name><surname>Pachitariu</surname> <given-names>M</given-names></name><name><surname>Putzeys</surname> <given-names>J</given-names></name><name><surname>Rich</surname> <given-names>PD</given-names></name><name><surname>Rossant</surname> <given-names>C</given-names></name><name><surname>Sun</surname> <given-names>WL</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name><name><surname>Carandini</surname> <given-names>M</given-names></name><name><surname>Harris</surname> <given-names>KD</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Harris</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Fully integrated silicon probes for high-density recording of neural activity</article-title><source>Nature</source><volume>551</volume><fpage>232</fpage><lpage>236</lpage><pub-id pub-id-type="doi">10.1038/nature24636</pub-id><pub-id pub-id-type="pmid">29120427</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname> <given-names>L</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A geometric attractor mechanism for self-organization of entorhinal grid modules</article-title><source>eLife</source><volume>8</volume><elocation-id>e46687</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.46687</pub-id><pub-id pub-id-type="pmid">31373556</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanter</surname> <given-names>BR</given-names></name><name><surname>Lykken</surname> <given-names>CM</given-names></name><name><surname>Avesar</surname> <given-names>D</given-names></name><name><surname>Weible</surname> <given-names>A</given-names></name><name><surname>Dickinson</surname> <given-names>J</given-names></name><name><surname>Dunn</surname> <given-names>B</given-names></name><name><surname>Borgesius</surname> <given-names>NZ</given-names></name><name><surname>Roudi</surname> <given-names>Y</given-names></name><name><surname>Kentros</surname> <given-names>CG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A novel mechanism for the Grid-to-Place cell transformation revealed by transgenic depolarization of medial entorhinal cortex layer II</article-title><source>Neuron</source><volume>93</volume><fpage>1480</fpage><lpage>1492</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.03.001</pub-id><pub-id pub-id-type="pmid">28334610</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koenig</surname> <given-names>J</given-names></name><name><surname>Linder</surname> <given-names>AN</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The spatial periodicity of grid cells is not sustained during reduced theta oscillations</article-title><source>Science</source><volume>332</volume><fpage>592</fpage><lpage>595</lpage><pub-id pub-id-type="doi">10.1126/science.1201685</pub-id><pub-id pub-id-type="pmid">21527713</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Carmichael</surname> <given-names>JE</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Speed cells in the medial entorhinal cortex</article-title><source>Nature</source><volume>523</volume><fpage>419</fpage><lpage>424</lpage><pub-id pub-id-type="doi">10.1038/nature14622</pub-id><pub-id pub-id-type="pmid">26176924</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The emergence of grid cells: intelligent design or just adaptation?</article-title><source>Hippocampus</source><volume>18</volume><fpage>1256</fpage><lpage>1269</lpage><pub-id pub-id-type="doi">10.1002/hipo.20520</pub-id><pub-id pub-id-type="pmid">19021261</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langston</surname> <given-names>RF</given-names></name><name><surname>Ainge</surname> <given-names>JA</given-names></name><name><surname>Couey</surname> <given-names>JJ</given-names></name><name><surname>Canto</surname> <given-names>CB</given-names></name><name><surname>Bjerknes</surname> <given-names>TL</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Development of the spatial representation system in the rat</article-title><source>Science</source><volume>328</volume><fpage>1576</fpage><lpage>1580</lpage><pub-id pub-id-type="doi">10.1126/science.1188210</pub-id><pub-id pub-id-type="pmid">20558721</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laptev</surname> <given-names>D</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Neural dynamics indicate parallel integration of environmental and Self-Motion information by place and grid cells</article-title><source>Frontiers in Neural Circuits</source><volume>13</volume><elocation-id>59</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2019.00059</pub-id><pub-id pub-id-type="pmid">31636545</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Latuske</surname> <given-names>P</given-names></name><name><surname>Kornienko</surname> <given-names>O</given-names></name><name><surname>Kohler</surname> <given-names>L</given-names></name><name><surname>Allen</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Hippocampal remapping and its entorhinal origin</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>11</volume><elocation-id>253</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2017.00253</pub-id><pub-id pub-id-type="pmid">29354038</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Distinct ensemble codes in hippocampal Areas CA3 and CA1</article-title><source>Science</source><volume>305</volume><fpage>1295</fpage><lpage>1298</lpage><pub-id pub-id-type="doi">10.1126/science.1100265</pub-id><pub-id pub-id-type="pmid">15272123</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathis</surname> <given-names>A</given-names></name><name><surname>Herz</surname> <given-names>AV</given-names></name><name><surname>Stemmler</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Resolution of nested neuronal representations can be exponential in the number of neurons</article-title><source>Physical Review Letters</source><volume>109</volume><elocation-id>018103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.109.018103</pub-id><pub-id pub-id-type="pmid">23031134</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Barnes</surname> <given-names>CA</given-names></name><name><surname>Gerrard</surname> <given-names>JL</given-names></name><name><surname>Gothard</surname> <given-names>K</given-names></name><name><surname>Jung</surname> <given-names>MW</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name><name><surname>Kudrimoti</surname> <given-names>H</given-names></name><name><surname>Qin</surname> <given-names>Y</given-names></name><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>Suster</surname> <given-names>M</given-names></name><name><surname>Weaver</surname> <given-names>KL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Deciphering the hippocampal polyglot: the Hippocampus as a path integration system</article-title><source>The Journal of Experimental Biology</source><volume>199</volume><fpage>173</fpage><lpage>185</lpage><pub-id pub-id-type="pmid">8576689</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Battaglia</surname> <given-names>FP</given-names></name><name><surname>Jensen</surname> <given-names>O</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Path integration and the neural basis of the 'cognitive map'</article-title><source>Nature Reviews Neuroscience</source><volume>7</volume><fpage>663</fpage><lpage>678</lpage><pub-id pub-id-type="doi">10.1038/nrn1932</pub-id><pub-id pub-id-type="pmid">16858394</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miao</surname> <given-names>C</given-names></name><name><surname>Cao</surname> <given-names>Q</given-names></name><name><surname>Ito</surname> <given-names>HT</given-names></name><name><surname>Yamahachi</surname> <given-names>H</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Hippocampal remapping after partial inactivation of the medial entorhinal cortex</article-title><source>Neuron</source><volume>88</volume><fpage>590</fpage><lpage>603</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.09.051</pub-id><pub-id pub-id-type="pmid">26539894</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monaco</surname> <given-names>JD</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Modular realignment of entorhinal grid cell activity as a basis for hippocampal remapping</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>9414</fpage><lpage>9425</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1433-11.2011</pub-id><pub-id pub-id-type="pmid">21697391</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monasson</surname> <given-names>R</given-names></name><name><surname>Rosay</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Crosstalk and transitions between multiple spatial maps in an attractor neural network model of the Hippocampus: phase diagram</article-title><source>Physical Review E</source><volume>87</volume><elocation-id>062813</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.87.062813</pub-id><pub-id pub-id-type="pmid">23848735</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monasson</surname> <given-names>R</given-names></name><name><surname>Rosay</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Crosstalk and transitions between multiple spatial maps in an attractor neural network model of the Hippocampus: collective motion of the activity</article-title><source>Physical Review E</source><volume>89</volume><elocation-id>032803</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.89.032803</pub-id><pub-id pub-id-type="pmid">24730895</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monsalve-Mercado</surname> <given-names>MM</given-names></name><name><surname>Leibold</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Hippocampal Spike-Timing correlations lead to hexagonal grid fields</article-title><source>Physical Review Letters</source><volume>119</volume><elocation-id>038101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.119.038101</pub-id><pub-id pub-id-type="pmid">28777606</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mosheiff</surname> <given-names>N</given-names></name><name><surname>Burak</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Velocity coupling of grid cell modules enables stable embedding of a low dimensional variable in a high dimensional neural attractor</article-title><source>eLife</source><volume>8</volume><elocation-id>e48494</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.48494</pub-id><pub-id pub-id-type="pmid">31469365</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mulas</surname> <given-names>M</given-names></name><name><surname>Waniek</surname> <given-names>N</given-names></name><name><surname>Conradt</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Hebbian plasticity realigns grid cell activity with external sensory cues in continuous attractor models</article-title><source>Frontiers in Computational Neuroscience</source><volume>10</volume><elocation-id>13</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2016.00013</pub-id><pub-id pub-id-type="pmid">26924979</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname> <given-names>RU</given-names></name><name><surname>Kubie</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>The effects of changes in the environment on the spatial firing of hippocampal complex-spike cells</article-title><source>The Journal of Neuroscience</source><volume>7</volume><fpage>1951</fpage><lpage>1968</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.07-07-01951.1987</pub-id><pub-id pub-id-type="pmid">3612226</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neher</surname> <given-names>T</given-names></name><name><surname>Azizi</surname> <given-names>AH</given-names></name><name><surname>Cheng</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>From grid cells to place cells with realistic field sizes</article-title><source>PLOS ONE</source><volume>12</volume><elocation-id>e0181618</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0181618</pub-id><pub-id pub-id-type="pmid">28750005</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Dostrovsky</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The Hippocampus as a spatial map. preliminary evidence from unit activity in the freely-moving rat</article-title><source>Brain Research</source><volume>34</volume><fpage>171</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(71)90358-1</pub-id><pub-id pub-id-type="pmid">5124915</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname> <given-names>BE</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Autoassociative dynamics in the generation of sequences of hippocampal place cells</article-title><source>Science</source><volume>349</volume><fpage>180</fpage><lpage>183</lpage><pub-id pub-id-type="doi">10.1126/science.aaa9633</pub-id><pub-id pub-id-type="pmid">26160946</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pollock</surname> <given-names>E</given-names></name><name><surname>Desai</surname> <given-names>N</given-names></name><name><surname>Wei</surname> <given-names>X</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dynamic self-organized error-correction of grid cells by border cells</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/385229</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quirk</surname> <given-names>GJ</given-names></name><name><surname>Muller</surname> <given-names>RU</given-names></name><name><surname>Kubie</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>The firing of hippocampal place cells in the dark depends on the rat's recent experience</article-title><source>The Journal of Neuroscience</source><volume>10</volume><fpage>2008</fpage><lpage>2017</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.10-06-02008.1990</pub-id><pub-id pub-id-type="pmid">2355262</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redish</surname> <given-names>AD</given-names></name><name><surname>Elga</surname> <given-names>AN</given-names></name><name><surname>Touretzky</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A coupled attractor model of the rodent head direction system</article-title><source>Network: Computation in Neural Systems</source><volume>7</volume><fpage>671</fpage><lpage>685</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_7_4_004</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rennó-Costa</surname> <given-names>C</given-names></name><name><surname>Tort</surname> <given-names>ABL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Place and grid cells in a loop: implications for memory function and spatial coding</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>8062</fpage><lpage>8076</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3490-16.2017</pub-id><pub-id pub-id-type="pmid">28701481</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rolls</surname> <given-names>ET</given-names></name><name><surname>Stringer</surname> <given-names>SM</given-names></name><name><surname>Elliot</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Entorhinal cortex grid cells can map to hippocampal place cells by competitive learning</article-title><source>Network: Computation in Neural Systems</source><volume>17</volume><fpage>447</fpage><lpage>465</lpage><pub-id pub-id-type="doi">10.1080/09548980601064846</pub-id><pub-id pub-id-type="pmid">17162463</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samsonovich</surname> <given-names>A</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Path integration and cognitive mapping in a continuous attractor neural network model</article-title><source>The Journal of Neuroscience</source><volume>17</volume><fpage>5900</fpage><lpage>5920</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.17-15-05900.1997</pub-id><pub-id pub-id-type="pmid">9221787</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sargolini</surname> <given-names>F</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title><source>Science</source><volume>312</volume><fpage>758</fpage><lpage>762</lpage><pub-id pub-id-type="doi">10.1126/science.1125572</pub-id><pub-id pub-id-type="pmid">16675704</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlesiger</surname> <given-names>MI</given-names></name><name><surname>Boublil</surname> <given-names>BL</given-names></name><name><surname>Hales</surname> <given-names>JB</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Hippocampal global remapping can occur without input from the medial entorhinal cortex</article-title><source>Cell Reports</source><volume>22</volume><fpage>3152</fpage><lpage>3159</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2018.02.082</pub-id><pub-id pub-id-type="pmid">29562172</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name><name><surname>Kudrimoti</surname> <given-names>HS</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>A model of the neural basis of the rat’s sense of direction</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>173</fpage><lpage>180</lpage></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Einevoll</surname> <given-names>GT</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>From grid cells to place cells: a mathematical model</article-title><source>Hippocampus</source><volume>16</volume><fpage>1026</fpage><lpage>1031</lpage><pub-id pub-id-type="doi">10.1002/hipo.20244</pub-id><pub-id pub-id-type="pmid">17094145</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sreenivasan</surname> <given-names>S</given-names></name><name><surname>Fiete</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Grid cells generate an analog error-correcting code for singularly precise neural computation</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>1330</fpage><lpage>1337</lpage><pub-id pub-id-type="doi">10.1038/nn.2901</pub-id><pub-id pub-id-type="pmid">21909090</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stensola</surname> <given-names>H</given-names></name><name><surname>Stensola</surname> <given-names>T</given-names></name><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Frøland</surname> <given-names>K</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The entorhinal grid map is discretized</article-title><source>Nature</source><volume>492</volume><fpage>72</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1038/nature11649</pub-id><pub-id pub-id-type="pmid">23222610</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stepanyuk</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Self-organization of grid fields under supervision of place cells in a neuron model with associative plasticity</article-title><source>Biologically Inspired Cognitive Architectures</source><volume>13</volume><fpage>48</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/j.bica.2015.06.006</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trettel</surname> <given-names>SG</given-names></name><name><surname>Trimper</surname> <given-names>JB</given-names></name><name><surname>Hwaun</surname> <given-names>E</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name><name><surname>Colgin</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Grid cell co-activity patterns during sleep reflect spatial overlap of grid fields during active behaviors</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>609</fpage><lpage>617</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0359-6</pub-id><pub-id pub-id-type="pmid">30911183</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Strien</surname> <given-names>NM</given-names></name><name><surname>Cappaert</surname> <given-names>NL</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The anatomy of memory: an interactive overview of the parahippocampal-hippocampal network</article-title><source>Nature Reviews Neuroscience</source><volume>10</volume><fpage>272</fpage><lpage>282</lpage><pub-id pub-id-type="doi">10.1038/nrn2614</pub-id><pub-id pub-id-type="pmid">19300446</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname> <given-names>SN</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Learning place cells, grid cells and invariances with excitatory and inhibitory plasticity</article-title><source>eLife</source><volume>7</volume><elocation-id>e34560</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34560</pub-id><pub-id pub-id-type="pmid">29465399</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname> <given-names>XX</given-names></name><name><surname>Prentice</surname> <given-names>J</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A principle of economy predicts the functional architecture of grid cells</article-title><source>eLife</source><volume>4</volume><elocation-id>e08362</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.08362</pub-id><pub-id pub-id-type="pmid">26335200</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Welinder</surname> <given-names>PE</given-names></name><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Grid cells: the position code, neural network models of activity, and the problem of learning</article-title><source>Hippocampus</source><volume>18</volume><fpage>1283</fpage><lpage>1300</lpage><pub-id pub-id-type="doi">10.1002/hipo.20519</pub-id><pub-id pub-id-type="pmid">19021263</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wills</surname> <given-names>TJ</given-names></name><name><surname>Lever</surname> <given-names>C</given-names></name><name><surname>Cacucci</surname> <given-names>F</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Attractor dynamics in the hippocampal representation of the local environment</article-title><source>Science</source><volume>308</volume><fpage>873</fpage><lpage>876</lpage><pub-id pub-id-type="doi">10.1126/science.1108905</pub-id><pub-id pub-id-type="pmid">15879220</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wills</surname> <given-names>TJ</given-names></name><name><surname>Cacucci</surname> <given-names>F</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Development of the hippocampal cognitive map in preweanling rats</article-title><source>Science</source><volume>328</volume><fpage>1573</fpage><lpage>1576</lpage><pub-id pub-id-type="doi">10.1126/science.1188224</pub-id><pub-id pub-id-type="pmid">20558720</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname> <given-names>X</given-names></name><name><surname>Hahnloser</surname> <given-names>RH</given-names></name><name><surname>Seung</surname> <given-names>HS</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Double-ring network model of the head-direction system</article-title><source>Physical Review E</source><volume>66</volume><elocation-id>041902</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.66.041902</pub-id><pub-id pub-id-type="pmid">12443230</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Yim</surname> <given-names>MY</given-names></name><name><surname>Sadun</surname> <given-names>LA</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name><name><surname>Taillefumier</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Where can a place cell put its fields? let Us count the ways</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2019.12.19.881458</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname> <given-names>K</given-names></name><name><surname>Buice</surname> <given-names>MA</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Hayman</surname> <given-names>R</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Specific evidence of low-dimensional continuous attractor dynamics in grid cells</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1077</fpage><lpage>1084</lpage><pub-id pub-id-type="doi">10.1038/nn.3450</pub-id><pub-id pub-id-type="pmid">23852111</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Representation of spatial orientation by the intrinsic dynamics of the head-direction cell ensemble: a theory</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>2112</fpage><lpage>2126</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-06-02112.1996</pub-id><pub-id pub-id-type="pmid">8604055</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>SJ</given-names></name><name><surname>Ye</surname> <given-names>J</given-names></name><name><surname>Miao</surname> <given-names>C</given-names></name><name><surname>Tsao</surname> <given-names>A</given-names></name><name><surname>Cerniauskas</surname> <given-names>I</given-names></name><name><surname>Ledergerber</surname> <given-names>D</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Optogenetic dissection of entorhinal-hippocampal functional connectivity</article-title><source>Science</source><volume>340</volume><elocation-id>1232627</elocation-id><pub-id pub-id-type="doi">10.1126/science.1232627</pub-id><pub-id pub-id-type="pmid">23559255</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziv</surname> <given-names>Y</given-names></name><name><surname>Burns</surname> <given-names>LD</given-names></name><name><surname>Cocker</surname> <given-names>ED</given-names></name><name><surname>Hamel</surname> <given-names>EO</given-names></name><name><surname>Ghosh</surname> <given-names>KK</given-names></name><name><surname>Kitch</surname> <given-names>LJ</given-names></name><name><surname>El Gamal</surname> <given-names>A</given-names></name><name><surname>Schnitzer</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Long-term dynamics of CA1 hippocampal place codes</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>264</fpage><lpage>266</lpage><pub-id pub-id-type="doi">10.1038/nn.3329</pub-id><pub-id pub-id-type="pmid">23396101</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zong</surname> <given-names>W</given-names></name><name><surname>Wu</surname> <given-names>R</given-names></name><name><surname>Li</surname> <given-names>M</given-names></name><name><surname>Hu</surname> <given-names>Y</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Li</surname> <given-names>J</given-names></name><name><surname>Rong</surname> <given-names>H</given-names></name><name><surname>Wu</surname> <given-names>H</given-names></name><name><surname>Xu</surname> <given-names>Y</given-names></name><name><surname>Lu</surname> <given-names>Y</given-names></name><name><surname>Jia</surname> <given-names>H</given-names></name><name><surname>Fan</surname> <given-names>M</given-names></name><name><surname>Zhou</surname> <given-names>Z</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Wang</surname> <given-names>A</given-names></name><name><surname>Chen</surname> <given-names>L</given-names></name><name><surname>Cheng</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Fast high-resolution miniature two-photon microscopy for brain imaging in freely behaving mice</article-title><source>Nature Methods</source><volume>14</volume><fpage>713</fpage><lpage>719</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4305</pub-id><pub-id pub-id-type="pmid">28553965</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><p>In this appendix, we analyze mathematically how the embedding of multiple spatial maps in the synaptic connectivity affects the existence of bump states in the system, using a mean-field analysis. Similar questions have been extensively studied for associative networks with discrete memories, and for models of multiple spatial map representations in the hippocampus. Here, we consider properties of the coupled entorhinal-hippocampal network.</p><p>As the number of spatial maps <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> increases, the shape of the bump is increasingly distorted until at a certain critical <inline-formula><mml:math id="inf168"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the representation of the bump will totally collapse and no localized bump will be observed in any of the embedded maps. This happens since with every map added, there is addition of quenched noise into the place cell connections, arising from the random permutations and thus, there is accumulating interference between the distinct map representations. To characterize the influence of the quenched noise, we compute here the mean and variance of quenched noisy inputs to place cells and grid cells.</p><p>The calculation of the mean input is used to adjust the feed-forward inhibition in the network (which is uniform in each grid cell module and within the place cell network), such that the mean input to all cells remains fixed with addition of new maps (<xref ref-type="disp-formula" rid="equ37 equ38">Equations 37 and 38</xref>). The calculation of the variance allows us to assess how <inline-formula><mml:math id="inf169"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> scales with network parameters.</p><sec id="s8" sec-type="appendix"><title>Quenched noise conveyed to place cells</title><p>Without loss of generality, we assume a steady bump state in map 1. Since the synaptic activities are steady, we can replace them in all expressions with the corresponding firing rates: <inline-formula><mml:math id="inf170"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula> and <inline-formula><mml:math id="inf171"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mi mathvariant="normal"/></mml:math></inline-formula>. The firing rate profile of place cells can be thought as the sum of two contributions: a smooth bump of synaptic activation associated with map 1, and noisy deviations originating from the synaptic weights associated with the rest of the maps. When <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≥</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, these deviations are too large and the representation collapses.</p><p>Since we assume that the deviations are sufficiently small, we decompose terms in the steady state equation to inputs from map 1 and to inputs from all the other interfering maps. We obtain terms describing (1) inputs from place cells through the synaptic connectivity that corresponds to map 1, (2) noisy inputs from place cells arising from all the other interfering maps, (3) inputs from grid cells, associated with map 1, and (4) noisy inputs from grid cells that arise from all the other interfering maps. When evaluating these terms, to leading order in the deviations we can approximate the firing rates <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> by those taken from the case <inline-formula><mml:math id="inf174"><mml:mtable><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula>. Rewriting the steady state equation of a place cell accordingly yields<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>μ</mml:mi></mml:munder></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:munder></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>pc</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We are interested in the means, variances and covariances of terms (2) and (4), compared to the means of terms (1) and (3).</p><sec id="s8-1"><title>Quenched noise conveyed to place cells by place cells (term 2):</title><p>We note that the sum of each row and the sum of each column of <inline-formula><mml:math id="inf175"><mml:msup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> are all identical, and denote<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>≡</mml:mo><mml:mi>C</mml:mi> <mml:mi/> <mml:mi/> <mml:mi/> <mml:mi/><mml:mo>;</mml:mo> <mml:mi/> <mml:mi/> <mml:mi/> <mml:mi/><mml:mo>∀</mml:mo> <mml:mi/><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:math></disp-formula></p><p>Since maps are drawn independently, we note also that<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced> <mml:mi/> <mml:mi/> <mml:mi/> <mml:mi/><mml:mo>;</mml:mo> <mml:mi/> <mml:mi/> <mml:mi/> <mml:mi/><mml:mo>∀</mml:mo> <mml:mi/><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>m</mml:mi></mml:math></disp-formula>where the pointy brackets denote an average over the random permutation <inline-formula><mml:math id="inf176"><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> that relates the matrix <inline-formula><mml:math id="inf177"><mml:msup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> to <inline-formula><mml:math id="inf178"><mml:msup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>:<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">℘</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="script">℘</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula>and <inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">℘</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the permutation matrix corresponding to the permutation <inline-formula><mml:math id="inf180"><mml:mi>π</mml:mi></mml:math></inline-formula>.</p><p>For convenience, we denote term (2) by <inline-formula><mml:math id="inf181"><mml:mi>P</mml:mi></mml:math></inline-formula>:<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The mean of <inline-formula><mml:math id="inf182"><mml:mi>P</mml:mi></mml:math></inline-formula> is<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>P</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mi>C</mml:mi><mml:mi>N</mml:mi></mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the average firing rate of place cells in the bump steady state when <inline-formula><mml:math id="inf184"><mml:mtable><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula>. Since the permutations in different maps are drawn independently, the variance of <inline-formula><mml:math id="inf185"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Thus, both the mean and the variance grow linearly with <inline-formula><mml:math id="inf186"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and vanish when <inline-formula><mml:math id="inf187"><mml:mtable><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula>.</p></sec><sec id="s8-2"><title>Quenched noise conveyed to place cells by grid cells (term 4):</title><p>Similarly, the sums of all rows of <inline-formula><mml:math id="inf188"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>) are equal to each other, and we denote<disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>≡</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mtext> </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Thus,<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mi>n</mml:mi><mml:mo>≡</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mtext> </mml:mtext><mml:mi>f</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Similarly to (<xref ref-type="disp-formula" rid="equ18">Equation 18</xref>), note that<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced> <mml:mi/> <mml:mi/> <mml:mi/> <mml:mi/><mml:mo>;</mml:mo> <mml:mi/> <mml:mi/> <mml:mi/> <mml:mi/><mml:mo>∀</mml:mo> <mml:mi/><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>m</mml:mi></mml:math></disp-formula></p><p>For convenience, we denote the contributions of module <inline-formula><mml:math id="inf189"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> from term 4 by <inline-formula><mml:math id="inf190"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>:<disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:math></disp-formula></p><p>The mean contribution of module <inline-formula><mml:math id="inf191"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to the quenched noise in the input to place cells is<disp-formula id="equ27"><label>(27)</label><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mtext>per</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mtext>per</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The variance of place cell inputs arising from grid cell activities includes two types of contributions: (a) covariance terms between inputs arising from all pairs of grid modules, and (b) covariance terms between place cell inputs and the inputs from each grid module (discussed in the next subsection).</p><p>Since phase shifts of each grid module are drawn independently of each other we note that <inline-formula><mml:math id="inf192"><mml:mtable><mml:mtr><mml:mtd><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula> for <inline-formula><mml:math id="inf193"><mml:mtable><mml:mtr><mml:mtd><mml:mi>μ</mml:mi><mml:mo>≠</mml:mo><mml:mi>ν</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula>. Consequently, all covariance terms between distinct modules (the mixed expressions in term 4) vanish (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1a</xref>). The variance to place cell inputs from each grid module is:<disp-formula id="equ28"><label>(28)</label><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mtext>per</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf194"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the average firing rate of grid cells from module <inline-formula><mml:math id="inf195"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in the bump steady state when <inline-formula><mml:math id="inf196"><mml:mtable><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula>.</p></sec><sec id="s8-3"><title>Overall mean and variance of place cell inputs</title><p>The overall mean of the quenched noise is (sum of terms from <xref ref-type="disp-formula" rid="equ21">Equation (21)</xref> and <xref ref-type="disp-formula" rid="equ27">Equation(27)</xref>):<disp-formula id="equ29"><label>(29)</label><mml:math id="m29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The overall variance of the quenched noise is determined by <xref ref-type="disp-formula" rid="equ22">Equation (22)</xref>, <xref ref-type="disp-formula" rid="equ28">Equation (28)</xref> and the covariance between place cell and grid cell activities (terms 2 and 4 in <xref ref-type="disp-formula" rid="equ16">Equation 16</xref>). Since in each map, phase shifts of each grid module are drawn independently from the permutation of the place cells, we note that <inline-formula><mml:math id="inf197"><mml:mtable><mml:mtr><mml:mtd><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula>, and thus all covariance terms between place cell and grid cell vanish (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1b</xref>). The overall variance is thus:<disp-formula id="equ30"><label>(30)</label><mml:math id="m30"><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Note that all terms in these expressions are proportional to <inline-formula><mml:math id="inf198"><mml:mtable><mml:mtr><mml:mtd><mml:mfenced separators="|"><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula>.</p></sec></sec><sec id="s9" sec-type="appendix"><title>Quenched noise conveyed to grid cells</title><p>Similarly to our derivation for place cells, we decompose the input to grid cells into a contribution from map 1 (in which we assume a bump state), and to inputs from all other interfering maps:<disp-formula id="equ31"><label>(31)</label><mml:math id="m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The quenched noise inputs to grid cells originate solely from place cells. Thus, we are interested in the mean and variance of the third term, compared to the sum of the first two terms in the argument of <inline-formula><mml:math id="inf199"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>. We denote<disp-formula id="equ32"><label>(32)</label><mml:math id="m32"><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>We note that<disp-formula id="equ33"><label>(33)</label><mml:math id="m33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>≡</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mtext> </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula>and thus<disp-formula id="equ34"><label>(34)</label><mml:math id="m34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mi>N</mml:mi><mml:mo>≡</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mtext> </mml:mtext><mml:mi>f</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>From here on, the derivation is similar to the previous calculation and it is straightforward to see that the mean of the quenched noise input to grid cell is equal to<disp-formula id="equ35"><label>(35)</label><mml:math id="m35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mtext>per</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>and the variance is<disp-formula id="equ36"><label>(36)</label><mml:math id="m36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mtext>per</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><sec id="s9-1"><title>Compensating for the mean of the quenched noise</title><p>In order to sustain a constant mean input to place cells and grid cells as <inline-formula><mml:math id="inf200"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is varied, we adjust the external current to compensate for the mean of the quenched noise, <xref ref-type="disp-formula" rid="equ29">Equation 29</xref> and <xref ref-type="disp-formula" rid="equ35">Equation 35</xref>. Thus, the external input to place cells is<disp-formula id="equ37"><label>(37)</label><mml:math id="m37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>pc</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>pc</mml:mtext><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>and the external input to each grid cell module <inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is<disp-formula id="equ38"><label>(38)</label><mml:math id="m38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mtext>gc</mml:mtext></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mtext>gc</mml:mtext><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf202"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mtext>pc</mml:mtext><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf203"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mtext>gc</mml:mtext><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are independent of <inline-formula><mml:math id="inf204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec></sec><sec id="s10" sec-type="appendix"><title>Scaling of the variance of inputs with <inline-formula><mml:math id="inf205"><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>,</mml:mo></mml:math></inline-formula> and assessing <inline-formula><mml:math id="inf206"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></title><p>We now consider how the variance of inputs scales with the number of neurons in the system, when the fraction of active cells and their typical firing rates are kept fixed with addition of new spatial maps.</p><p>To maintain a fixed distribution of place cell and grid cell firing rates at steady state under the assumption that <inline-formula><mml:math id="inf207"><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula> place cells and <inline-formula><mml:math id="inf208"><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula> grid cells in each module cover uniformly and densely the environment, the synaptic connectivity should scale as follows under re-scaling of <inline-formula><mml:math id="inf209"><mml:mi>N</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf210"><mml:mi>n</mml:mi></mml:math></inline-formula>:<disp-formula id="equ39"><label>(39)</label><mml:math id="m39"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo> <mml:mi/> <mml:mi/><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo> <mml:mi/> <mml:mi/><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo> <mml:mi/> <mml:mi/><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>We focus first on the inputs to place cells: the signal conveyed to place cells in <xref ref-type="disp-formula" rid="equ16">Equation (16)</xref>, which we denote by <inline-formula><mml:math id="inf211"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒮</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, is composed of the contribution from terms 1 and 3. The noise conveyed to place cells, denoted by <inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, is composed of the contribution from terms 2 and 4. With the scaling of <xref ref-type="disp-formula" rid="equ39">Equation 39</xref>, <inline-formula><mml:math id="inf213"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒮</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is independent of the number of neurons when <inline-formula><mml:math id="inf214"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf215"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are large.</p><p>The mean of the noise <inline-formula><mml:math id="inf216"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is canceled by the adjustment of the external current (<xref ref-type="disp-formula" rid="equ37">Equation 37</xref>),<disp-formula id="equ40"><label>(40)</label><mml:math id="m40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mtext>per</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula>and the variance of the noise is given in <xref ref-type="disp-formula" rid="equ30">Equation (30)</xref>:<disp-formula id="equ41"><label>(41)</label><mml:math id="m41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In all these terms, the variance is across random choices of the place cell permutations and grid cell phases. Due to the random shuffling of place cells under random permutations, it is straightforward to show (see also <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2a</xref>) that<disp-formula id="equ42"><label>(42)</label><mml:math id="m42"><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>Therefore, in a system composed only of place cells, <inline-formula><mml:math id="inf217"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mi>N</mml:mi></mml:math></inline-formula>.</p><p>However, the variance of place cell inputs arising from grid cell activities (<inline-formula><mml:math id="inf218"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula>) is constant (for <inline-formula><mml:math id="inf219"><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula>) and does not depend on the the number of neurons (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2b</xref>). This is due to the fixed phases between pairs of grid cells that belong to the same module in each of the maps. Therefore, increasing the number of grid cells would not increase <inline-formula><mml:math id="inf220"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Overall, as the total number of neurons increases, <inline-formula><mml:math id="inf221"> <mml:mi/><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> increases until the variance of place cell inputs is dominated by the variance arising from grid cell activities.</p><p>As for the grid cells: similarly to place cells, the signal (first two terms in <xref ref-type="disp-formula" rid="equ31">Equation 31</xref>) is independent of the number of neurons when <inline-formula><mml:math id="inf222"><mml:mi>N</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf223"><mml:mi>n</mml:mi></mml:math></inline-formula> are large, and the mean of the noise (third term in <xref ref-type="disp-formula" rid="equ31">Equation 31</xref>) is canceled by the adjustment of the external current (<xref ref-type="disp-formula" rid="equ38">Equation 38</xref>). Similarly to place cells, the variance of the noise of each grid cell module input (<xref ref-type="disp-formula" rid="equ36">Equation 36</xref>), which arise from place cell activities, is inversely proportional to the number of place cells (see also <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>):<disp-formula id="equ43"><label>(43)</label><mml:math id="m43"><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>To qualitatively assess <inline-formula><mml:math id="inf224"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> numerically, <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref> shows the bump score as a function of <inline-formula><mml:math id="inf225"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> when initial rates were set as bumps (consistent condition) in map 1 (without loss of generality), for the fixed number of neurons used throughout this manuscript and for three different values of <inline-formula><mml:math id="inf226"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The bump score decreases sharply at a certain characteristic value of <inline-formula><mml:math id="inf227"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, which provides an assessment of <inline-formula><mml:math id="inf228"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. As expected and based on (<xref ref-type="disp-formula" rid="equ41">Equation 41</xref>), the capacity increases when decreasing <inline-formula><mml:math id="inf229"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (the coupling parameter that determines the strength of connectivity from grid cells to place cells).</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Covariances of place cell inputs across sub-populations vanish.</title><p>(<bold>a</bold>) Simulation results (blue dots) showing the covariance of place cell inputs arising from activities of pairs of different grid cell modules. A common scaling factor <inline-formula><mml:math id="inf230"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> determines the number of place cells and grid cells in each module where <inline-formula><mml:math id="inf231"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> was used throughout this manuscript. Red dashed lines show the zero-identity line for reference. Top: covariance between first and second modules. Middle: covariance between first and third modules. Bottom: covariance between second and third modules. Simulation results include 2000 random map realizations bootstrapped into 40 batches of 50 realizations to obtain multiple covariance measurements. Error bars are 1.96 times the standard deviations obtained from each simulation, divided by the square root of the number of realizations (corresponding to a confidence interval of 95%). (<bold>b</bold>) Same as (<bold>a</bold>) but for the covariance of place cell inputs arising from activities of place cells and each of the grid cell modules. Top: covariance between place cells and first grid cell module. Middle: covariance between place cells and second grid cell module. Bottom: covariance between place cells and third grid cell module.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-app1-fig1-v2.tif"/></fig><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Variance of place cell inputs.</title><p>(<bold>a</bold>) Simulation results (blue dots) showing the variance of place cell inputs arising from place cell activities. A common scaling factor <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> determines the number of place cells and grid cells in each module where <inline-formula><mml:math id="inf233"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> was used throughout this manuscript. Simulation results include 2000 random map realizations bootstrapped into 40 batches of 50 realizations to obtain multiple variance measurements. Error bars are 1.96 times the standard deviations obtained from each simulation, divided by the square root of the number of realizations (corresponding to a confidence interval of 95%. Some error bars are too small to be visible). Dashed red line shows the curve <inline-formula><mml:math id="inf234"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> with optimal fitted <inline-formula><mml:math id="inf235"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>9.543</mml:mn></mml:math></inline-formula> for reference, <inline-formula><mml:math id="inf236"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.999</mml:mn></mml:math></inline-formula>. (<bold>b</bold>) Same as (<bold>a</bold>) but for the variance of place cell inputs arising from grid cell activities.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-app1-fig2-v2.tif"/></fig><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Variance of grid cell inputs.</title><p>(<bold>a</bold>) Simulation results (blue dots) showing the variance of grid module 1 inputs arising from place cell activities. A common scaling factor <inline-formula><mml:math id="inf237"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> determines the number of place cells and grid cells in each module where <inline-formula><mml:math id="inf238"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> was used throughout this manuscript. Simulation results include 2000 random map realizations bootstrapped into 40 batches of 50 realizations to obtain multiple variance measurements. Error bars are 1.96 times the standard deviations obtained from each simulation, divided by the square root of the number of realizations (corresponding to a confidence interval of 95%. Some error bars are too small to be visible). Dashed red line shows the curve <inline-formula><mml:math id="inf239"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> with optimal fitted <inline-formula><mml:math id="inf240"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01203</mml:mn></mml:math></inline-formula> for reference, <inline-formula><mml:math id="inf241"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.999</mml:mn></mml:math></inline-formula>. (<bold>b</bold>) Same as (<bold>a</bold>) but for grid module 2. Dashed red line shows the curve <inline-formula><mml:math id="inf242"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> with optimal fitted <inline-formula><mml:math id="inf243"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01369</mml:mn></mml:math></inline-formula> for reference, <inline-formula><mml:math id="inf244"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.999</mml:mn></mml:math></inline-formula>. (<bold>c</bold>) Same as (<bold>a</bold>) but for grid module 3. Dashed red line shows the curve <inline-formula><mml:math id="inf245"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> with optimal fitted <inline-formula><mml:math id="inf246"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01488</mml:mn></mml:math></inline-formula> for reference, <inline-formula><mml:math id="inf247"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.999</mml:mn></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-app1-fig3-v2.tif"/></fig><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Capacity dependence on grid to place coupling parameter.</title><p>Bump score vs the total number of embedded maps for three different values of <inline-formula><mml:math id="inf248"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (circle, triangle and square) when starting from a ‘consistent’ initial condition in map #1. Blue curves show the bump score for map #1 and overlapping red curves show the average bump score for the rest of the embedded maps (whenever <inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). Each plotted value is the average bump score obtained from 100 randomly chosen realizations for each specific value of <inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (and including 5 randomly chosen initial conditions within each realization). Error bars are 1.96 times the standard deviations obtained from each simulation, divided by the square root of the number of realizations (corresponding to a confidence interval of 95%. Some error bars are too small to be visible).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-56894-app1-fig4-v2.tif"/></fig></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.56894.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Chaudhuri</surname><given-names>Rishidev</given-names></name><role>Reviewing Editor</role><aff><institution>UC Davis</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Grid cells and place cells are populations of neurons that are thought to work together to represent an animal's spatial position using complementary encodings of space. This paper provides a simple but compelling mechanistic model of how they might interact and, in doing so, suggests explanations for a variety of experimental findings.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Bidirectional coupling of hippocampus and MEC accounts for grid field variability and artificial place cell remapping&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by Laura Colgin as the Senior Editor, a Reviewing Editor, and three reviewers. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, we are asking editors to accept without delay manuscripts, like yours, that they judge can stand as <italic>eLife</italic> papers without additional data, even if they feel that they would make the manuscript stronger. Thus the revisions requested below primarily address clarity and presentation and require only minor additional numerical simulations.</p><p>Summary:</p><p>Agmon and Burak present a novel integrated model of grid cell and place cell networks, with bidirectional coupling between grid cells in the medial entorhinal cortex and place cells in the hippocampus. The model combines attractor dynamics in the hippocampus and in multiple grid modules in an interesting and consistent manner. Despite its relative simplicity, the joint place cell-grid cell network can explain a wide range of experimental findings, including that hippocampal place cells and hippocampal remapping can persist without MEC, the variability of firing rates across grid fields, and the intriguing observation that artificial hippocampal remapping is induced by depolarization but not hyperpolarization of MEC inputs to the hippocampus.</p><p>Overall, the model surpasses previous feedforward models, is implemented at an appropriate level, is presented in language that is accessible to experimentalists and is quite timely given recent puzzling observations on the relation between grid cells and place cells.</p><p>Essential revisions:</p><p>1) The operation of the network should be presented more thoroughly. The development of this combined network is a major result, but it is a bit unclear how the network produces the reported results. In particular:</p><p>a) Illustrating bump dynamics. The only dynamical data presented in the paper relates to path-integration and drift. When a bump develops from random initial conditions, does it do so steadily or in spurts? Similarly, how does bump score across different maps evolve when the bump develops into a mixed state?</p><p>b) How many maps can be stored by the network? In the Supplementary Material, the authors calculate that this number scales with the number of neurons. Do simulations support this result, and what is the scaling prefactor?</p><p>c) What range of parameters, especially the relative strength of connections within and across subnetworks, produce desired results?</p><p>2) How does the place cell network operate without grid cell input, and how does this compare to MEC lesion experiments? What activity patterns appear? I presume that it would not path-integrate-is this true? Also, it seems that place cell remapping arises from grid cell inputs, namely, map-dependent shifts in grid cell phase – is this true?</p><p>3) All the modeling presented in the paper is done in 1-d. It would be useful to confirm that it indeed also works in 2-d (and use the grid scales consistent with the experimental data). This would facilitate the comparison to (future) experimental results.</p><p>4) In addition to artificial remapping, where the firing rate distribution across grid fields is experimentally manipulated, a reorganization of the firing rate among grid fields can also be naturally observed in rate remapping paradigms (Diehl et al., 2017). Although the authors may have omitted this experimental finding because it does not fit into their framework of the place cell network mimicking global remapping, some of their analysis of artificial remapping shows that their network can in principle generate persistent mixed states. More in depth analysis should be added which describes to what extent the findings by Diehl et al. can be reproduced by the current network architecture or whether major modifications would be necessary. The Introduction, Results and Discussion sections should be expanded to include these analyses and their interpretation.</p><p>5) Correction of drifts: It is interesting that the network can correct the drift of the grid module. There has now been a literature on this issue (Hardcastle, Ganguli and Giocomo, 2015; Mulas, Waniek and Conradt, 2016; Pollock et al., 2018). In particular these studies have shown that error correction can happen between the boundary cell or landmark cells to grid cells. It is unclear if/how the current error-correction mechanism fundamentally differs from the previous studies. It would be useful to clarify these issues. Also, how is &quot;incompatible drift&quot; defined in subsection “Coordination of the grid cell representation: suppression of incompatible drifts”?</p><p>6) Robustness with respect to the selection of the grid modules: The authors used [38.4,48, 64]cm for the 3 grid modules. Are the predictions robust with respect to the selection of the modules? For example, the form of decoding error using ML estimate would depend on the how the scales of the module are organized. With a hierarchical grid code (Mathis et al., 2012; Wei et al., <italic>eLife</italic> 2015), it is much less prone to non-local errors, unlike the residual number system studied by Fiete et al., (2008).</p><p>7) One highlight of the current work is that the model could account for the seemingly paradoxical finding in Kanter et al., (2017). However, as the authors pointed out that there is also the issue regarding the generality of the finding in Kanter et al., (2017). Is there a regime that the proposed model can also account for Miao et al., (2015)? The authors wrote: &quot;while in Ref (Kanter et al., 2017) chemogenetic receptors were targeted almost exclusively to layer II stellate cells of the MEC in transgenic animals, a broader population has been likely affected using viral injection in Ref (Miao et al., 2015).&quot; The argument may not address the problem, because both stellate cells and pyramidal cells in EC2 can be grid cells. These points need to be more carefully discussed, as it is critical to the test of the proposed model.</p><p>8) The rationale behind the variability in individual grid firing here bears some similarity to Dunn et al. (Dunn et al., 2017). This relationship needs to be clarified.</p><p>9) Quantification of the model predictions: Regarding the variability of individual grid firing fields, is it possible to quantify the effect and compare it to the publicly available grid cell dataset? Similarly, is it possible to quantify the model prediction on artificial mapping and put it into a format which would be more directly comparable to the data at the neural population level?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.56894.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The operation of the network should be presented more thoroughly. The development of this combined network is a major result, but it is a bit unclear how the network produces the reported results. In particular:</p><p>a) Illustrating bump dynamics. The only dynamical data presented in the paper relates to path-integration and drift.</p></disp-quote><p>We added videos and supplementary figures with several panels in order to illustrate the dynamics of bump formation under different conditions.</p><p>First, for each of the three conditions presented in Figure 3, we now include a video showing one representative example (Figure 3—video 1, Figure 3—video 2, Figure 3—video 3, referenced in subsection “Coordination of the grid cell representation: suppression of incompatible drifts”), showing the dynamics of activity in all sub-networks over one second, starting from initialization. We have also added Figure 7—video 1 (referenced in the Discussion section), which shows the dynamics under grid cell depolarization, corresponding to the exact example shown in Figure 7—figure supplement 1A-D.</p><p>We added Figure 3—figure supplement 2 which includes quantitative analysis of bump score dynamics corresponding to each of the conditions from Figure 3 (referenced in subsection “Coordination of the grid cell representation: suppression of incompatible drifts”). We also added Figure 4—figure supplement 1 which includes the bump scores dynamics corresponding to the path-integration example from Figure 4A (referenced in subsection “Coordination of the grid cell representation: suppression of incompatible drifts”). Finally, we also added Figure 7—figure supplement 2, which includes a quantitative analysis of bump scores dynamics corresponding to each of the conditions from Figure 7 (referenced in the Discussion section).</p><disp-quote content-type="editor-comment"><p>When a bump develops from random initial conditions, does it do so steadily or in spurts?</p></disp-quote><p>Typically, as seen in the video for this condition, it is possible to identify very early on (shorter than the synaptic time scale, t) a single location within a single environment, in which a somewhat noisy bump state develops in the place cell network. This is followed by more gradual convergence to a persistent state as presented in Figure 2.</p><disp-quote content-type="editor-comment"><p>Similarly, how does bump score across different maps evolve when the bump develops into a mixed state?</p></disp-quote><p>This is now shown in Figure 7—figure supplement 2.</p><disp-quote content-type="editor-comment"><p>b) How many maps can be stored by the network? In the Supplementary Material, the authors calculate that this number scales with the number of neurons. Do simulations support this result, and what is the scaling prefactor?</p></disp-quote><p>Following this question, we extended our analysis to more thoroughly examine how quenched noise affects the number of maps that can be stored in the network. We have extensively revised the Appendix and added four Figures (Appendix—figure 1, Appendix—figure 2, Appendix—figure 3, Appendix— figure 4) related to the new text.</p><p>In our original submission, we analyzed how the quenched noise associated with place cell inputs to place cells scales with <italic>N</italic> (the number of place cells) and found that the variance is inversely proportional to <italic>N</italic>. This is now verified numerically in Appendix—figure 2A which also shows the scaling prefactor.</p><p>However, the variance of the quenched noise conveyed by grid cells to place cells does not similarly decrease with <italic>n</italic>, the number of grid cells. The difference in the two scaling behaviors is due to the difference in the type of remapping that occurs in place cells and grid cells: while the spatial relationships between place cells are chosen randomly in each map, grid cells within a module maintain fixed relative phases. This is verified numerically in Appendix—figure 2B (see also the expanded Appendix text and the Appendix—figure 1 and Appendix—figure 3 for covariance terms and variance in inputs conveyed to grid cells).</p><p>The outcome of this conclusion is that when neurons are added to the grid and place cell networks, the variance of quenched noise becomes dominated by the grid cell inputs, and saturates as the network sizes increase, thereby limiting the capacity (the number of spatial maps that can be stored in the network). Appendix—figure 4 provides an assessment of the capacity and shows qualitatively how it depends on the coupling parameter from grid cells to place cells. We qualitatively validated that even with the smallest coupling parameter chosen (𝛾<sub><italic>g</italic></sub> =1), mixed states emerge under grid cell depolarization and path integration is performed successfully.</p><p>The conclusion that the transformation from grid cells to place cells limits the capacity of the network when place cell firing fields are assigned randomly, resonates well with recent results of Yim et al., (December 2019), which we now cite.</p><p>We added a paragraph in the Discussion section of the main manuscript that discusses the limitation on capacity, and how it relates to our assumptions on place cell and grid cell remapping.</p><disp-quote content-type="editor-comment"><p>c) What range of parameters, especially the relative strength of connections within and across subnetworks, produce desired results?</p></disp-quote><p>The relative strength of connections between grid cells and place cells (and vice versa) must indeed be set within a certain range in order to obtain the desired results: for example, if these connections are too weak, the network exhibits persistent states in which the bump positions in different sub-networks are incompatible. Moreover, it is essential for path integration and the coupling of grid cell modules, that both place cells can influence the position of grid cell bumps, and that grid cells can influence the state of the place cell network. Thus, it is not sufficient to include connections only in one direction. On the other hand, the connections cannot be too strong since we are interested in the regime in which the structure of steady states in each sub-network is predominantly determined by its internal connectivity.</p><p>In our numerical explorations we observed all these features qualitatively and settled on a set of parameters in which the desired properties were observed. This did not require fine tuning of the parameters. A quantitative demonstration of these points would require a very large number of simulations, since we would need to thoroughly explore the set of persistent states over a large range of parameters. We feel that such systematic exploration is interesting, but lies outside the main goals of our work, which are to demonstrate the qualitative consequences arising from bidirectional coupling between grid cells and place cell systems.</p><p>We added a discussion of these points (Subsection “coupling parameters”). Note also that Appendix—figure 4 includes an analysis of how 𝛾<italic><sub>g</sub></italic> affects the capacity.</p><disp-quote content-type="editor-comment"><p>2) How does the place cell network operate without grid cell input, and how does this compare to MEC lesion experiments? What activity patterns appear?</p></disp-quote><p>The hippocampal network in our model is set up such that it expresses bump activity patterns at the neural population level even without inputs from the MEC (see the Discussion section). This is in agreement with the observation that place fields are expressed under MEC lesions (Brun et al., 2008, Hales et al., 2014). Most likely, consistent assignment of the population activity patterns to spatial locations under MEC lesions relies on sensory inputs that project to the hippocampus from the LEC and are not modeled explicitly in our work. We added a paragraph on this topic in the Discussion section.</p><disp-quote content-type="editor-comment"><p>I presume that it would not path-integrate – is this true?</p></disp-quote><p>Correct, our model’s place cells activities won’t be updated in accordance with velocity inputs injected to grid cells in that case. This is consistent with the observation (Hales et al., 2014) that MEC lesions imparied spatial memory as the performance in the Morris water maze decreased under MEC lesion. Even without a lesion to the MEC, but with a disruption of grid cell activity by removing NMDA receptors, path-integration performance is impaired (Gil et al., 2018).</p><disp-quote content-type="editor-comment"><p>Also, it seems that place cell remapping arises from grid cell inputs, namely, map-dependent shifts in grid cell phase-is this true?</p></disp-quote><p>In our model, place cells are randomly assigned to locations in each environment, and random grid cell phases are assigned independently of the place cell remapping. Reciprocal connections between the two networks are then set up based on the overlap of desired joint activity patterns, as described in Methods section. Therefore, firing locations of place cells in a new environment are not determined by grid cell phases. Nevertheless, we expect that upon inducing persistent phase shifts in grid cells that correspond to a different embedded map, place cells will remap accordingly. We added a paragraph in the Discussion section to clarify this.</p><disp-quote content-type="editor-comment"><p>3) All the modeling presented in the paper is done in 1-d. It would be useful to confirm that it indeed also works in 2-d (and use the grid scales consistent with the experimental data). This would facilitate the comparison to (future) experimental results.</p></disp-quote><p>Conceptually, generalisation of the model to 2-d is straightforward. We implemented the model in 1-d for several reasons. First, the computational cost of simulations in 2-d is much higher than in 1-d. Second, visualization of the results (especially in multiple maps) is easier in 1-d than in 2-d, and since we do not expect fundamental differences between the two cases, in many ways it is advantageous for presentation purposes to work in 1-d.</p><p>We have recently been working on extending our results to 2-d, with the aim of adding additional realism into the model, and additional ingredients such as sensory inputs that project into the two networks. Qualitatively, we have been able to reproduce in 2-d the features demonstrated in the 1-d case: for example, we qualitatively verified the restriction of joint activity patterns to compatible persistent states, we were able to see path integration in the place cell network in response to velocity signal injected to grid cells, the coupling of grid cell modules in the presence of noise, and we observed, a similar outcome of grid cell depolarization on place cell activity patterns, as seen in Figure 7—video 1. However, extensive numerical work and analysis will be required for systematic quantification of all the results, and given the large volume of results already presented in the present manuscript we plan to include this analysis in a future study that will explore additional features of the model.</p><disp-quote content-type="editor-comment"><p>4) In addition to artificial remapping, where the firing rate distribution across grid fields is experimentally manipulated, a reorganization of the firing rate among grid fields can also be naturally observed in rate remapping paradigms (Diehl et al., 2017). Although the authors may have omitted this experimental finding because it does not fit into their framework of the place cell network mimicking global remapping, some of their analysis of artificial remapping shows that their network can in principle generate persistent mixed states. More in depth analysis should be added which describes to what extent the findings by Diehl et al. can be reproduced by the current network architecture or whether major modifications would be necessary. The Introduction, Results and Discussion sections should be expanded to include these analyses and their interpretation.</p></disp-quote><p>Thanks for pointing out that reorganization of the firing rate among grid fields occurs also under place cell rate remapping. This result is expected in our proposed model: changes in the firing rates of place cells, which occur under rate remapping, are expected to affect grid cell firing rates in a field-dependent manner due to the inhomogeneous connections from place cells to grid cells. While the phenomenon is similar to the results observed by Kanter et al., the origins for the changes in the firing rates of place cells are different in the two cases.</p><p>In order to observe reorganization of the firing rate among grid fields following rate remapping in our model we would need to explicitly model sensory inputs projecting into the hippocampus. We did not consider sensory inputs in the present work. The exploration of the MEC-hippocampal interaction with sensory inputs deserves a thorough analysis, and it would make sense to do this alongside an adaptation of the model to 2d environments. We believe that these extensions of the model should be addressed in a separate manuscript.</p><p>Our work is concerned with the interaction between grid cells and place cells and their joint dynamics as an attractor network: thus, our focus is on the ability of the MEC and hippocampus to sustain persistent patterns of activity at the population level irrespective of external inputs. This is what has led us to consider in detail the experiments of Kanter et al., where sensory inputs remained fixed under the experimental manipulation yet substantial changes were observed in the firing patterns in the hippocampus. Since sensory inputs were kept fixed, the modifications must have arisen from mechanisms that are intrinsic to the MEC-hippocampal network.</p><p>We now mention in the Results section the influence of place cell rate remapping on grid cell field variability. In addition, we added a new paragraph to the Discussion section in which we explain more explicitly why we focus on the experiment of Kanter et al.</p><disp-quote content-type="editor-comment"><p>5) Correction of drifts: It is interesting that the network can correct the drift of the grid module. There has now been a literature on this issue (Hardcastle, Ganguli and Giocomo, 2015; Mulas, Waniek and Conradt, 2016; Pollock et al., 2018). In particular these studies have shown that error correction can happen between the boundary cell or landmark cells to grid cells. It is unclear if/how the current error-correction mechanism fundamentally differs from the previous studies. It would be useful to clarify these issues.</p></disp-quote><p>The activation of boundary and landmark cells is typically related to sensory cues. In addition, the research on phase resets associated with encounters with walls has focused on single modules. The literature which is more relevant to the point raised in our manuscript addresses the need for an internal mechanism that could couple the phases of different grid cell modules independently from sensory inputs. The reason why such a mechanism is required, is that incompatible drifts (see below) in different modules are highly detrimental from the neural coding point of view, much more so than coordinated drifts (see Fiete, Burak and Wellinder 2008; Sreenivasan and Fiete, 2012; Burak, 2014; and Mosheiff and Burak, 2019 – all cited in our manuscript).</p><p>Our model does not include sensory inputs, yet we show that the reciprocal coupling between place cells and grid cells implements a mechanism that couples the distinct grid cell modules (Figure 5). Thus, our suggested error-correction mechanism is different from those mentioned in the comment (Hardcastle, Ganguli and Giocomo, 2015; Mulas, Waniek and Conradt, 2016; Pollock et al., 2018) since (1) it involves an internal mechanism which doesn’t depend on sensory inputs and because (2) it deals with coordination of the grid cell modules irrespective of the absolute represented location.</p><p>We have revised this part in the Introduction, clarifying that the error-correction mechanism we present is independent from sensory inputs (Results section). We clarified the difference from mentioned studies above in the Results section. We have also explained in more detail the concept of incompatible drifts (see below).</p><disp-quote content-type="editor-comment"><p>Also, how is &quot;incompatible drift&quot; defined in subsection “Coordination of the grid cell representation: suppression of incompatible drifts”?</p></disp-quote><p>Grid phases of two modules in two-dimensional space span a four-dimensional space (a two-dimensional phase for each module), of which the correct representations of position on the plane span a two dimensional subspace. In other words, during continuous motion in 2d, correctly updated phases span a 2d subspace of the 4d space of possible configurations. Similarly, in our 1d analogue, the phases of two modules span a two-dimensional space, whereas motion is one dimensional. During continuous motion, the change in the phase of one module must be related to the change in the phase of the other module through the ratio of their grid spacings, in order for the two modules to coherently represent a position in the local vicinity of the animal. Incompatible drifts are modifications in the phases, driven by dynamic noise, that do not obey these constraints. These issues are extensively discussed in several manuscripts that we cite, (e.g. Sreenivasan and Fiete, 2012, e.g. Burak, 2014, Mosheiff and Burak, 2019).</p><p>We notice that the labels in Figure 5A were ‘coherent/incoherent’. We changed these to ‘compatible/incompatible’ in order to use consistent terminology. In addition, we expanded the paragraph that introduces this topic in the Results section, to explain the concept of incompatible drifts.</p><disp-quote content-type="editor-comment"><p>6) Robustness with respect to the selection of the grid modules: The authors used [38.4,48, 64]cm for the 3 grid modules. Are the predictions robust with respect to the selection of the modules? For example, the form of decoding error using ML estimate would depend on the how the scales of the module are organized. With a hierarchical grid code (Mathis et al., 2012; Wei et al., 2015), it is much less prone to non-local errors, unlike the residual number system studied by Fiete et al., (2008).</p></disp-quote><p>Our specific grid spacings were chosen for convenience, such that an integer number of periods fits in the arena, which allows us to use periodic boundary conditions. Note also that the ratios of grid spacings (1.25 between modules 2 and 1; 1.33 between modules 3 and 2) are similar to those observed empirically.</p><p>Ratios of sequential grid spacings observed empirically by Stensola et al. were close to 1.4, when averaging across animals. In this respect, the spacings were similar to the idealized geometric series postulated by Mathis et al., and by Wei et al. However, across animals there is a large scatter in the ratios and in a given animal, the spacings are far from forming a precise geometric series.</p><p>With respect to the range of positions that can be represented by the grid cell code, Vágó and Ujfalussi (2018) concluded that when the number of modules is larger than 2, most choices of grid spacing ratios lead to near-optimal capacity.</p><p>With respect to the sensitivity to non-local readout errors, arising from incompatible phase errors: with biologically realistic choices of the grid spacings, the grid cells code is highly sensitive to such phase errors, even within a relatively small arena and with grid spacings that form a geometric series. As an example, see our recent paper (Mosheiff and Burak, 2019), where it was explicitly shown, both in 1d and in 2d, that suppression of incompatible phase errors dramatically improves the robustness of the code to noise, and that this is due to elimination of non-local readout errors.</p><disp-quote content-type="editor-comment"><p>7) One highlight of the current work is that the model could account for the seemingly paradoxical finding in Kanter et al., (2017). However, as the authors pointed out that there is also the issue regarding the generality of the finding in Kanter et al., (2017). Is there a regime that the proposed model can also account for Miao et al., (2015)? The authors wrote: &quot;while in Ref (Kanter et al., 2017) chemogenetic receptors were targeted almost exclusively to layer II stellate cells of the MEC in transgenic animals, a broader population has been likely affected using viral injection in Ref (Miao et al., 2015).&quot; The argument may not address the problem, because both stellate cells and pyramidal cells in EC2 can be grid cells.</p></disp-quote><p>Two central points that we meant to convey are (1) the specificity of the manipulation applied by Kanter et al., compared to the experiment of Miao et al., and (2) their simultaneous characterization of grid cell responses:</p><p>1) The manipulation used by Kanter et al., targeted the full extent of the MEC, with very little effect on neighboring tissues. In addition, the targeting was specific to excitatory cells. This was possible in the Kanter et al. experiment using transgenic mice in which DREADDs were specifically expressed almost exclusively in stellate cells of MEC layer II. On the other hand, the Miao et al. experiment relied on an injection of adeno-associated virus (AAV), which broadly targets neurons of various types: not only stellate and pyramidal cells but most likely also interneurons. In addition, the infection relied on the diffusion of the virus within the brain, which generates variability across the brain regions and in the number and types of neurons affected in each animal. Therefore, the affected cell types could not be precisely determined.</p><p>2) In the Kanter et al., experiment, the impact of DREADD activation on activity in MEC was probed experimentally, whereas similar electrophysiological measurements in the MEC were not performed in the experiment of Miao et al. Therefore, changes in MEC firing patterns following the experimental manipulation were not characterized.</p><p>This is now clarified in the revised manuscript (Discussion section).</p><p>Due to these reasons, the experimental manipulation of Miao et al., was less specific than the one applied in the Kanter et al. experiment, and its effect was less well characterized. An attempt to model the different conditions in this experiment, compared to the experiment of Kanter et al., requires information about the nature of the manipulation which is unavailable. Therefore, in our view, an attempt to do so would be too speculative.</p><disp-quote content-type="editor-comment"><p>These points need to be more carefully discussed, as it is critical to the test of the proposed model.</p></disp-quote><p>We provided an extensive discussion on possible experimental tests of our model, and specifically of our proposed explanation for the results of Kanter et al. The question of whether mixed states appear under the experimental protocols used by Kanter et al., is separate from the question why their results differ from those of Miao et al. Our predictions should be tested on the same transgenic animals used by Kanter et al., using similar experimental protocols.</p><disp-quote content-type="editor-comment"><p>8) The rationale behind the variability in individual grid firing here bears some similarity to Dunn et al. (Dunn et al., 2017). This relationship needs to be clarified.</p></disp-quote><p>Thanks for pointing out that the arXiv manuscript by Dunn et al., discussed a possible role of inputs from place cells in generating variability in individual grid cell firing fields.</p><p>The similarity between our mechanism and the one suggested by Dunn et al., is that they both arise from place cell inputs to grid cells. However, the exact sources which induce the variability are different: In Dunn et al., the source of variability stems from a random component added to the synaptic connectivity from place-like cells to grid cells. This would be similar to our model consisting only of a single map, but with (artificial) insertion of random noise in the connections between place cells to grid cells. Instead, we demonstrate a different principle: that simply by embedding and representing multiple spatial maps, variability in the firing fields of individual grid cells naturally and inevitably emerges due the quenched noise, and even without explicitly adding random noise from the type described by Dunn et al.</p><p>In our model, there are two contributions that elicit this variability:</p><p>1) Even with a non-stochastic and ideal connectivity from place cells to grid cells, embedding of multiple spatial maps inevitably embeds also quenched noise in the connectivity from place cells to grid cells. This is fundamentally a different source to the noise in the connections between place cells to grid cells than that of Dunn et al., although in practice, from a functional point of view it can have an equivalent effect.</p><p>2) In addition, the existence of the quenched noise and the recurrent place cell dynamics generate a spatially dependent distorted place cell bump and not an identical and smooth bump at each spatial location. Therefore, the variability of the place cell firing rates across distinct grid cell periodic locations inevitably contributes to the variability of individual grid cells across their firing fields. This distinction is emphasized in Figure 6A in our manuscript where place cell bumps which are slightly different from one another are shown at periodic grid spacing locations. Thus, since the place cell population activity pattern is different along the attractor, grid cell variability is inevitably exhibited by individual grid cells across their periodic firing fields.</p><p>We do not claim that our suggested mechanism is the sole determinant of individual grid cell variability. There could be multiple sources for variability in the grid fields (such as sensory inputs or connections between different modules), and one of them could also be random noise in the connections between place cells to grid cells as suggested by Dunn et al.</p><p>This is explained in the revised manuscript in the Discussion section. We added a reference to Dunn et al., in this context, alongside the work of Ismakov et al., and clarified the points raised above. We clarified our suggested mechanism which induces variability in individual grid cell firing fields in the Discussion section.</p><disp-quote content-type="editor-comment"><p>9) Quantification of the model predictions: Regarding the variability of individual grid firing fields, is it possible to quantify the effect and compare it to the publicly available grid cell dataset?</p></disp-quote><p>We did show a quantification in Figure 6B, which shows a histogram of the coefficient of variation (CV). This is similar to the quantification performed by Isamkov et al., presented in Figure 1B of their manuscript.</p><p>We showed that with the embedding of multiple spatial maps in the connectivity the CV increases. However, the purpose of our result is to point out a principle, and a specific and inevitable mechanism as a source, out of multiple possible sources, for the variability of individual grid cell firing fields.</p><p>We did not argue that this is the sole mechanism which is responsible for the experimentally observed variability and therefore a quantified comparison with the experimental results of Isamkov et al. is not straightforward. The experimental variability measured in Isamkov et al. reflects multiple sources which collectively account for the finding. This is now explained more explicitly in the Discussion section. We also discuss a way to experimentally eliminate the possible contribution of sensory inputs to the inter-field variability, and isolate variability that arises from intrinsic network mechanisms (Methods section).</p><p>It would be interesting to try and experimentally isolate the contribution to the grid firing field variability which arises only from the embedding of multiple spatial maps in order to make a clear comparison with theoretical prediction. We now briefly mention that this could perhaps be done by comparing animals that were exposed to a different number of spatial environments (Methods section).</p><disp-quote content-type="editor-comment"><p>Similarly, is it possible to quantify the model prediction on artificial mapping and put it into a format which would be more directly comparable to the data at the neural population level?</p></disp-quote><p>We did not fine-tune the model parameters to replicate exactly the statistics of responses reported by Kanter et al. It is probable that different statistics of the place cell responses would be obtained when varying the model parameters. Therefore, a direct comparison with the experimental data and the model’s artificial remapping statistics is not straightforward. At the population level, the responses of all place cells could be seen in Figure 8—figure supplement 1a. We now added a classification (explained in Methods section) of remapping types as described in the Results section.</p></body></sub-article></article>