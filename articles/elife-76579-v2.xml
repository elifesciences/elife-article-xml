<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">76579</article-id><article-id pub-id-type="doi">10.7554/eLife.76579</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Mapping circuit dynamics during function and dysfunction</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-157366"><name><surname>Gorur-Shandilya</surname><given-names>Srinivas</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7429-457X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-245690"><name><surname>Cronin</surname><given-names>Elizabeth M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4949-0042</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-245691"><name><surname>Schneider</surname><given-names>Anna C</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1270-836X</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-194946"><name><surname>Haddad</surname><given-names>Sara Ann</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0807-0823</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-48353"><name><surname>Rosenbaum</surname><given-names>Philipp</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9976-366X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="pa2">‡</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-80602"><name><surname>Bucher</surname><given-names>Dirk</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4144-2895</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-15818"><name><surname>Nadim</surname><given-names>Farzan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4144-9042</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-1021"><name><surname>Marder</surname><given-names>Eve</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9632-5448</contrib-id><email>marder@brandeis.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05abbep66</institution-id><institution>Volen Center and Biology Department, Brandeis University</institution></institution-wrap><addr-line><named-content content-type="city">Waltham</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05e74xb87</institution-id><institution>Federated Department of Biological Sciences, New Jersey Institute of Technology and Rutgers University</institution></institution-wrap><addr-line><named-content content-type="city">Newark</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Department of Molecular Life Sciences, University of Zürich, Zürich, Switzerland</p></fn><fn fn-type="present-address" id="pa2"><label>‡</label><p>GlobalData, New York, United States</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>18</day><month>03</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e76579</elocation-id><history><date date-type="received" iso-8601-date="2021-12-21"><day>21</day><month>12</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-03-18"><day>18</day><month>03</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2021-07-07"><day>07</day><month>07</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.07.06.451370"/></event></pub-history><permissions><copyright-statement>© 2022, Gorur-Shandilya et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Gorur-Shandilya et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-76579-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-76579-figures-v2.pdf"/><abstract><p>Neural circuits can generate many spike patterns, but only some are functional. The study of how circuits generate and maintain functional dynamics is hindered by a poverty of description of circuit dynamics across functional and dysfunctional states. For example, although the regular oscillation of a central pattern generator is well characterized by its frequency and the phase relationships between its neurons, these metrics are ineffective descriptors of the irregular and aperiodic dynamics that circuits can generate under perturbation or in disease states. By recording the circuit dynamics of the well-studied pyloric circuit in <italic>Cancer borealis</italic>, we used statistical features of spike times from neurons in the circuit to visualize the spike patterns generated by this circuit under a variety of conditions. This approach captures both the variability of functional rhythms and the diversity of atypical dynamics in a single map. Clusters in the map identify qualitatively different spike patterns hinting at different dynamic states in the circuit. State probability and the statistics of the transitions between states varied with environmental perturbations, removal of descending neuromodulatory inputs, and the addition of exogenous neuromodulators. This analysis reveals strong mechanistically interpretable links between complex changes in the collective behavior of a neural circuit and specific experimental manipulations, and can constrain hypotheses of how circuits generate functional dynamics despite variability in circuit architecture and environmental perturbations.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd><italic>Cancer borealis</italic></kwd><kwd>pyloric circuit</kwd><kwd>stomatogastric ganglion</kwd><kwd>neural circuit</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>T32 NS007292</award-id><principal-award-recipient><name><surname>Gorur-Shandilya</surname><given-names>Srinivas</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R35 NS097343</award-id><principal-award-recipient><name><surname>Gorur-Shandilya</surname><given-names>Srinivas</given-names></name><name><surname>Marder</surname><given-names>Eve</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>MH060605</award-id><principal-award-recipient><name><surname>Bucher</surname><given-names>Dirk M</given-names></name><name><surname>Nadim</surname><given-names>Farzan</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>DFG SCHN 1594/1-1</award-id><principal-award-recipient><name><surname>Schneider</surname><given-names>Anna C</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Mapping spike patterns from a small identified circuit reveals the diversity and complexity of circuit dynamics across animals and in response to perturbations.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Neural circuits can generate a wide variety of spiking dynamics, but must constrain their dynamics to function appropriately. Cortical circuits maintain irregular spiking patterns through a balance of excitatory and inhibitory inputs (<xref ref-type="bibr" rid="bib106">van Vreeswijk and Sompolinsky, 1996</xref>; <xref ref-type="bibr" rid="bib64">Mariño et al., 2005</xref>; <xref ref-type="bibr" rid="bib8">Brunel and Wang, 2003</xref>) and the loss of canonical dynamics is associated with neural diseases like channelopathies and epilepsy (<xref ref-type="bibr" rid="bib58">Marbán, 2002</xref>; <xref ref-type="bibr" rid="bib91">Staley, 2015</xref>). Preserving functional dynamics can be a challenge for neural circuits for the following reasons. The same spike pattern can be generated by diverse circuits with many different topologies and broadly distributed synaptic and cellular parameters (<xref ref-type="bibr" rid="bib79">Prinz et al., 2004</xref>; <xref ref-type="bibr" rid="bib31">Golowasch et al., 2002</xref>; <xref ref-type="bibr" rid="bib2">Alonso and Marder, 2019</xref>; <xref ref-type="bibr" rid="bib66">Memmesheimer and Timme, 2006</xref>). Furthermore, neural circuits are constantly being reconfigured, with ion channel protein turnover, and homeostatic feedback mechanisms modifying conductance and synapse strengths continuously (<xref ref-type="bibr" rid="bib102">Turrigiano et al., 1994</xref>; <xref ref-type="bibr" rid="bib103">Turrigiano et al., 1995</xref>; <xref ref-type="bibr" rid="bib73">O’Leary et al., 2014</xref>; <xref ref-type="bibr" rid="bib27">Franci et al., 2020</xref>). The problem of maintaining functional activity patterns is aggravated by the fact that functional circuit dynamics tend to lie within a low-dimensional subspace within the high-dimensional state space: of the numerous possible solutions, only a few are functional and are found in animals (<xref ref-type="bibr" rid="bib18">Cunningham and Yu, 2014</xref>; <xref ref-type="bibr" rid="bib75">Pang et al., 2016</xref>). How do neural circuits preserve functional dynamics despite these obstacles?</p><p>Answering this question requires, as a prerequisite, a quantitative description of the dynamics of neural circuits during function and dysfunction. When rhythms are regular, this is relatively simple, but when rhythms become irregular, classifying them becomes hard (<xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>; <xref ref-type="bibr" rid="bib95">Tang et al., 2012</xref>; <xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>). In this article, we study the dynamics of a well-studied central pattern generator, the pyloric circuit in the stomatogastric ganglion (STG) in <italic>Cancer borealis</italic> (<xref ref-type="bibr" rid="bib62">Marder and Bucher, 2007</xref>). The pyloric circuit is small, in crabs consisting of 13 neurons coupled by inhibitory and electrical synapses. Its topology and cellular dynamics are well understood, and the circuit generates a clearly defined ‘functional’ collective behavior where bursts of spikes from three different cell types alternate rhythmically to generate a triphasic motor pattern. The stereotypy and periodicity of the motor pattern suggest that the baseline dynamics of the pyloric circuit are fundamentally low dimensional. This has allowed for the effective parameterization of the rhythm by a small number of ad hoc descriptors such as the burst period, duty cycles, and phase of each neuron (<xref ref-type="bibr" rid="bib43">Hartline and Maynard, 1975</xref>; <xref ref-type="bibr" rid="bib24">Eisen and Marder, 1984</xref>; <xref ref-type="bibr" rid="bib67">Miller and Selverston, 1982</xref>).</p><p>In response to perturbations that span many cycles, pyloric circuit dynamics are not always periodic, and descriptors that work well to characterize the canonical rhythm are inadequate to describe these atypical dynamic states. Efforts to study circuit dynamics under these regimes, and to characterize how the circuit responds to, and recovers from perturbations, have been frustrated by the inability to quantitatively describe irregular and non-stationary dynamics (<xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>; <xref ref-type="bibr" rid="bib95">Tang et al., 2012</xref>; <xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>).</p><p>In this article, we set out to address the problem of quantitatively describing neural circuit dynamics under a variety of conditions. We reasoned that circuit dynamics lie on some lower-dimensional set within the full high-dimensional space of possible dynamics, even when circuits exhibit atypical and nonfunctional behavior, because even circuits generating dysfunctional dynamics are still constrained by cellular parameters and network topology. We therefore set out to find and visualize this subset of spike patterns using an unsupervised machine learning approach to visualize patterns in the high-dimensional data in two dimensions. This method allows us to visualize the totality of a large and complex dataset of spike patterns, while being explicit about the assumptions and biases in the analysis. Using this method, we found nontrivial features in the distribution of the data that hinted at diverse, stereotyped responses to perturbations. Using this compact representation allowed us to efficiently manually classify these patterns and measure transitions between these patterns. We were thus able to characterize the diversity of circuit dynamics under baseline and perturbed conditions, and identify anecdotally observed atypical states within the full repertoire of spiking patterns for many hundreds of animals.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Perturbations can destabilize the triphasic pyloric rhythm</title><p>Studies that measure the pyloric rhythm commonly involve recording from nerves from the STG in ex vivo preparations. Preparations typically also include the stomatogastric nerve (<italic>stn</italic>) that carries the axons of descending neuromodulatory neurons from the esophageal and commissural ganglia that project into the STG. Under baseline conditions (11°C, with the <italic>stn</italic> intact, <xref ref-type="fig" rid="fig1">Figure 1a</xref>), the periodic triphasic oscillation of the pyloric circuit can be measured by extracellular recordings of the lateral pyloric, pyloric dilator, and pyloric nerves (<italic>lpn</italic>, <italic>pdn,</italic> and <italic>pyn</italic>) (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). Bursts of spikes from the pyloric dilator (PD) neurons on the <italic>pdn</italic> are followed by bursts of spikes from the lateral pyloric neuron (LP) on <italic>lpn</italic> and bursts of spikes from the pyloric neurons (PY) on <italic>pyn</italic>. Spikes from lateral posterior gastric (LPG) neurons are also found on the <italic>pyn</italic> nerve in these recordings and can be differentiated from PY spikes by their shape and timing (LPG is active during PD bursts). Under these control conditions, where the rhythm is robust and spikes from these neurons are easily identifiable both by their location on the nerve and their phase in the cycle, the dual problems of identifying spikes from raw extracellular recordings and meaningfully describing circuit dynamics are easily resolvable.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>The triphasic pyloric rhythm can become irregular and hard to characterize under perturbation.</title><p>(<bold>a</bold>) Simplified schematic of part of the pyloric circuit (left). Filled circles indicate inhibitory synapses, solid lines are glutamatergic synapses, and dotted lines are cholinergic synapses. Resistor symbol indicates electrical coupling. The pyloric circuit is subject to descending neuromodulatory control from the stomatogastric nerve (<italic>stn</italic>). Right: simultaneous extracellular recordings from the <italic>lvn</italic>, <italic>lpn</italic>, <italic>pdn,</italic> and <italic>pyn</italic> motor nerves. Action potentials from lateral pyloric (LP), pyloric dilator (PD), and pyloric (PY) are visible on <italic>lpn</italic>, <italic>pdn,</italic> and <italic>pyn</italic>. Under these baseline conditions, PD, LP, and PY neurons burst in a triphasic pattern. The anterior burster (AB) neuron is an endogenous burster and is electrically coupled to PD neurons. (<bold>b</bold>) When the <italic>stn</italic> is cut, neuromodulatory input is removed and the circuit is ‘decentralized.’ In this case, the pyloric rhythm can become irregular and hard to characterize. In addition, spikes from multiple PY neurons can become harder to reliably identify on <italic>pyn</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig1-v2.tif"/></fig><p>In studies that characterize the changes in circuit dynamics to prolonged perturbations, spike identification and circuit dynamics characterization are less straightforward. For example, when descending neuromodulatory projections from the <italic>stn</italic> are cut (i.e., when the STG is decentralized, <xref ref-type="fig" rid="fig1">Figure 1b</xref>), the collective dynamics of the pyloric circuit can become less regular. This loss of regularity is concomitant with spikes being harder to reliably identify in extracellular recordings. While PD and LP neuron spikes can still be typically easily identified on the <italic>pdn</italic> and <italic>lpn</italic> nerves (<xref ref-type="fig" rid="fig1">Figure 1b</xref>), identifying PY on the <italic>pyn</italic> in the absence of a regular rhythm can be challenging. This problem is aggravated by the fact that spikes from the LPG neuron are frequently found on <italic>pyn</italic>, and because there are several copies of the PY neuron, whose spikes can range from perfect coincidence to slight offsets that can unpredictably change the amplitude and shape of PY spikes due to partial summation. For these reasons, some previous works studying the response of pyloric circuits to perturbations have consistently recorded from the <italic>lpn</italic> and <italic>pdn</italic> nerves, but not from the <italic>pyn</italic> (<xref ref-type="bibr" rid="bib40">Hamood et al., 2015</xref>; <xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>; <xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>; <xref ref-type="bibr" rid="bib83">Rosenbaum and Marder, 2018</xref>). Therefore, in order to include the largest number of experiments in our analysis, we chose to characterize the dynamics of the LP and PD neurons.</p></sec><sec id="s2-2"><title>Nonlinear dimensionality reduction allows for the visualization of diverse pyloric circuit dynamics</title><p>The regular pyloric rhythm involves out-of-phase bursts of spikes between LP and PD, and is observed under baseline conditions (<xref ref-type="fig" rid="fig2">Figure 2a1-3</xref>). Perturbations such as the removal of descending neuromodulatory inputs, changes in temperature, or changes in pH can qualitatively alter the rhythm, leading to a large variety of hard-to-characterize spiking patterns (<xref ref-type="fig" rid="fig2">Figure 2a4-6</xref>). Because these irregular states may lose the strong periodicity found in the canonical motor pattern, burst metrics such as burst period or phase offsets between bursts that work well to characterize the regular rhythm perform poorly. Efforts to characterize and quantify these atypical spike patterns must overcome the slow timescales in observed dynamics, the large quantity of data, and irregularity and variability in observed spike trains. Previous work used ad hoc categorization systems to assign observations of spike trains into one of a few groups (<xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>; <xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>), but these categorization methods scaled poorly and relied on subjective annotations.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Visualization of diverse neural circuit dynamics.</title><p>(<bold>a</bold>) Examples of canonical (1–3) and atypical (4–6) spike patterns of pyloric dilator (PD; blue) and lateral pyloric (LP; red) neurons. Rasters show 10 s of data. (<bold>b–d</bold>) Schematic of data analysis pipeline. (<bold>b</bold>) Spike rasters in (<bold>a2</bold>) can be equivalently represented by interspike intervals (ISIs) and phases. 20 s bins shown. Each 20 s bin contains a variable number of spikes/ISIs. (<bold>c</bold>) Summary statistics of ISI and phase sets in (<bold>d</bold>), showing tenth percentiles. Using percentiles converts the variable length sets in (<bold>b</bold>) to vectors of fixed length. (<bold>d</bold>) <inline-formula><mml:math id="inf1"><mml:mi>z</mml:mi></mml:math></inline-formula>-scored data assembled into a single vector, together with some additional measures (Materials and methods). (<bold>e</bold>) Embedding of data matrix containing all vectors such as the one shown in (<bold>d</bold>) using <italic>t</italic>-distributed stochastic neighbor embedding (t-SNE). Each dot in this image corresponds to a single 20 s spike train from both LP and PD. Example spike patterns shown in (<bold>a</bold>) are highlighted in the map. <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>94</mml:mn><mml:mo>,</mml:mo><mml:mn>844</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> points from <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>426</mml:mn></mml:mrow></mml:math></inline-formula> animals. In (<bold>a–d</bold>), features derived from LP spike times are shown in red, and features derived from PD spike times are shown in blue.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Burst metrics smoothly vary in map.</title><p>In each panel, embedding of the entire dataset is shown in gray. Points are colored by (<bold>a</bold>) burst period of the pyloric dilator (PD) neuron (<bold>b</bold>) phase of lateral pyloric (LP) burst start in PD time (<bold>c</bold>) mean firing rate of PD neuron, and (<bold>d</bold>) mean number of spikes per burst in the LP neuron. In each panel, the color scale also shows the distribution of metric over the entire dataset (y-axis in log scale). The distribution in (<bold>d</bold>) is spiky because the mean number of spikes/burst tends to be integer valued.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Principal components analysis (PCA) and k-means to find clusters in feature vectors.</title><p>(<bold>a</bold>) First and second components of PCA of feature vectors. Each dot is a single 20 s spike pattern from both pyloric dilator (PD) and lateral pyloric (LP) neurons. Colors correspond to cluster IDs from k-means on the first 10 principal components. (<bold>b</bold>) Cluster indices from (<bold>a</bold>) used to color points in the <italic>t</italic>-distributed stochastic neighbor embedding (t-SNE) embedding. The PCA + k-means approach tends to split up the large regular cluster, and clusters from k-means span clusters in t-SNE space, which were subsequently found to include spike patterns that were qualitatively different.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Embedding arranges data so that neighbors tend to be similar.</title><p>(<bold>a</bold>) Map shows embedding of all data in red shading. Shaded dots are incenters of a Delaunay triangulation of the map, and shading indicates the maximum absolute value of difference between burst period of the pyloric dilator (PD) neuron in each cell in the triangulation. (<bold>b</bold>) Distribution of absolute triadic differences over the entire dataset (gray) compared to triadic differences between shuffled triads (green) and compared to triadic differences between the first two principal components. Triadic differences are significantly smaller than in the shuffled data and in the principal components (p&lt;0.001, Kolmogorov–Smirnov test). (<bold>c, d</bold>) Same as in (<bold>a, b</bold>), for the duty cycle of the PD neuron.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Effect of varying perplexity in <italic>t</italic>-distributed stochastic neighbor embedding (t-SNE) embedding.</title><p>In each panel, data are embedded using t-SNE using the indicated perplexity parameter. Initialization is the same across all perplexities (Materials and methods). In every panel, points are colored by their location in the embedding with <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> (black box).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig2-figsupp4-v2.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Validation of method using synthetic data.</title><p>Synthetic data with different spike pattern classes converted into feature vectors and embedded using <italic>t</italic>-distributed stochastic neighbor embedding (t-SNE) as described (Materials and methods). Data from different classes tend to be well separated in the map, suggesting that this method can identify stereotyped and distinct spike patterns in neural recordings.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig2-figsupp5-v2.tif"/></fig></fig-group><p>We sought instead to visualize the totality of pyloric circuit dynamics under all conditions using a method that did not rely on a priori identification of (non)canonical dynamic patterns. Such a data visualization method, while descriptive, would generate a quantitative vocabulary to catalog the diversity of spike patterns observed both when these patterns were regular and also when they were irregular and aperiodic, thus allowing for the quantitative characterization of data previously inaccessible to traditional methods (<xref ref-type="bibr" rid="bib7">Börner et al., 2005</xref>; <xref ref-type="bibr" rid="bib70">Nguyen and Holmes, 2019</xref>).</p><p>The visualization was generated as follows: time-binned spike trains were converted into their equivalent interspike interval (ISI) and phase representations (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, Materials and methods). For all analyses, we consider nonoverlapping 20 s time bins. We chose this time bin following inspection of circuit dynamics across many conditions in several animals. Because there can be an arbitrary number of spikes in a bin, there are an arbitrary number of ISIs and phases. This makes it challenging to find a basis to represent the entire dataset. Ideally, we want to represent the spike pattern in each 20 s bin with a point in some space of high but fixed dimensionality. To convert this into a vector of fixed length, we measured percentiles of ISIs and phases (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). Together with other metrics (like ratios of ISIs, measures that capture discontinuities in ISI distributions, see Materials and methods for details), these percentiles were assembled into a fixed-length vector and each dimension was <inline-formula><mml:math id="inf5"><mml:mi>z</mml:mi></mml:math></inline-formula>-scored across the entire dataset (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). A collection of spike trains from an arbitrary number of neurons has thus been reduced to a matrix where each row consists of <inline-formula><mml:math id="inf6"><mml:mi>z</mml:mi></mml:math></inline-formula>-scored percentiles of ISIs and other metrics. This matrix can be visualized using a nonlinear dimensionality reduction technique such as <inline-formula><mml:math id="inf7"><mml:mi>t</mml:mi></mml:math></inline-formula>-distributed stochastic neighbor embedding (t-SNE) (<xref ref-type="bibr" rid="bib104">Van der Maaten and Hinton, 2008</xref>), which can generate a two-dimensional representation of the full dataset (<xref ref-type="fig" rid="fig2">Figure 2e</xref>).</p><p>In this representation, each dot corresponds to a single time bin of spike trains from both neurons. We found by manual inspection that spike trains that are visually similar (<xref ref-type="fig" rid="fig2">Figure 2a1-3</xref>) tend to occur close to each other in the embedding (<xref ref-type="fig" rid="fig2">Figure 2e1-3</xref>). Spike patterns that are qualitatively different from each other (<xref ref-type="fig" rid="fig2">Figure 2a4-6</xref>) tended to occur far from each other, often in clusters separated by regions of low data density (<xref ref-type="fig" rid="fig2">Figure 2e4-6</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>).</p><p>How useful is such a visualization and does it represent the variation in spike patterns in the data in a reasonable manner? We colored each point by classically defined features such as the burst period or the phase (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). We found that the embedding arranges data so that differences between clusters and within clusters had interpretable differences in various burst metrics. For example, clusters on the left edge of the map tended not to have defined LP phases, typically due to silent or very sparse LP firing (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1b</xref>). Location of data in the largest cluster was correlated to firing rate in the PD neuron (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1c</xref>). We observed that burst metrics, when they were defined, tended to vary smoothly across the map. To quantify this observation, we built a Delaunay triangulation (Materials and methods) on the embedded data and measured the triadic differences between PD burst periods and PD duty cycles (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). Triadic differences in these metrics were significantly smaller in the map than triadic differences in a projection of the first two principal components or a shuffled map (p&lt;0.0001, Kolmogorov–Smirnv test), suggesting that the t-SNE cost function generates a useful embedding where spike features vary smoothly within clusters. Finally, to validate our approach, we generated a synthetic dataset with different classes of spike patterns (Materials and methods) and analyzed it similarly. Coloring points in the t-SNE embedding by the original class revealed that clusters in the t-SNE map corresponded to different classes in the synthetic data, suggesting that this method can identify and recover stereotyped spike patterns in neural data (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>).</p></sec><sec id="s2-3"><title>Visualization of circuit dynamics allows manual labeling and clustering of data</title><p>Previous studies have shown that regular oscillatory bursting activity of the pyloric circuit can qualitatively change on perturbation. Circuit dynamics can be highly variable and has been categorized into various states such as ‘atypical firing,’ ‘LP-01 spikes,’ or ‘atypical’ (<xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>; <xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>). Both the process of constructing these categories and the process of classifying data into these categories are typically done manually, and therefore requires expert knowledge that is not explicitly captured and is impossible to reproduce. Because the embedding distributed data into clusters, we hypothesized that clusters corresponded to stereotyped dynamics that were largely similar, and different clusters represented the qualitatively different circuit dynamics identified by earlier studies.</p><p>We therefore manually inspected circuit dynamics at randomly chosen points in each apparent cluster and generated labels to describe the dynamics in that region (<xref ref-type="fig" rid="fig3">Figure 3</xref>). This process colored the map and segmented it into distinct regions that broadly followed, and were largely determined by, the distribution of the data in the embedding (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). Most of the data (57%) were assigned the regular label, where both PD and LP neurons burst regularly in alternation with at least two spikes per burst, and all identified regular states occurred in a single contiguous region in the map (blue). In the LP-weak-skipped state, PD bursts regularly, but LP does not burst every cycle, or only fires a single spike per burst. Irregular-bursting states showed bursting activity on both neurons, which were interrupted or otherwise irregular. In contrast, the irregular state showed spiking that was more variable and did not show strong signs of bursting at any point. LP-silent-PD-bursting states had regular bursting on PD, with no spikes on LP, while LP-silent states also had no spikes on LP, but activity on PD was more variable, and did not show regular bursting.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Map allows identification of distinct spiking dynamics.</title><p>(<bold>a</bold>) Map of all pyloric dynamics in dataset where each point is colored by manually assigned labels. Each point corresponds to a 20 s paired spike train from lateral pyloric (LP) and pyloric dilator (PD) neurons. Each panel in (<bold>b</bold>) shows two randomly chosen points from that class. The number of points in each class is shown in parentheses above each panel. <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>94</mml:mn><mml:mo>,</mml:mo><mml:mn>844</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> points from <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">426</mml:mn></mml:mrow></mml:math></inline-formula> animals. Labels are ordered by likelihood in the data.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Speed of trajectories through map.</title><p>(<bold>a</bold>) Map colored by speed of trajectories through map at that point. Cooler colors indicate that preparations move through that region of space more slowly, and warmer colors suggest that preparations are more likely to be far from that location in the next time step. (<bold>b</bold>) Speed grouped by manually identified labels.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Embeddings with different initializations.</title><p>In each panel, the embedding is performed with a different initialization. (<bold>a–d</bold>) Random initializations. (<bold>e</bold>) Initializations based on minimum interspike intervals (ISIs) in pyloric dilator (PD) and lateral pyloric (LP) neurons. (<bold>f</bold>) Initializations based on mean ISIs in PD and LP neurons. In every panel, points are colored identically.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Using Uniform Manifold Approximation and Projection (uMAP) instead of <italic>t</italic>-distributed stochastic neighbor embedding (t-SNE).</title><p>Instead of t-SNE, we used uMAP to embed the feature vectors in two dimensions (<bold>a</bold>). Points are colored identically to <xref ref-type="fig" rid="fig3">Figure 3</xref>. The coarse features of the map are preserved here, even though we used a different embedding algorithm. Each panel in (<bold>b</bold>) shows two randomly chosen points in that class.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig3-figsupp3-v2.tif"/></fig></fig-group><p>The time evolution of the pyloric dynamics of every preparation constitutes a trajectory in the map, and every point in the map is therefore associated with an instantaneous speed of motion in the map. We hypothesized that instantaneous speed could vary across the map, with points labeled regular moving more slowly through the map than points with labels corresponding to atypical states such as irregular because regular rhythms would vary less over time. Consistent with this, we found that points in the regular cluster tended to have smaller speeds than points in other clusters (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a</xref>). Speeds in the regular state were significantly lower than every other state except PD-silent-LP-bursting (p&lt;0.004, permutation test), suggesting that atypical states were associated with increased variability in circuit dynamics (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1b</xref>).</p><p>Do the clusters we see in the data, and the resultant categorization of the data, depend strongly on the details of the dimensionality reduction method we used (t-SNE)? We used an entirely different embedding algorithm (Uniform Manifold Approximation and Projection [uMAP], <xref ref-type="bibr" rid="bib65">McInnes et al., 2018</xref>) to embed the feature vectors in two-dimensional space. The map generated by uMAP preserved the coarse feature of the t-SNE embedding, suggesting that the features in the map reflected the features of the distribution of the data more strongly than details of the dimensionality reduction method. Coloring points in the uMAP embedding (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>) revealed a roughly similar organization of data in the embedding space, suggesting that our categorization method did not strongly depend on the details of the dimensionality reduction.</p></sec><sec id="s2-4"><title>Variability in baseline circuit dynamics across a population of wild-caught animals</title><p>Work on the pyloric circuit has used a wild-caught crustacean population. This uncontrolled environmental and genetic variability serves as a window into the extant variability of a functional neural circuit in a wild population of animals. In addition, experimental and computational work has shown that similar rhythms can be generated by a wide variety of circuit architectures and cellular parameters (<xref ref-type="bibr" rid="bib78">Prinz et al., 2003</xref>; <xref ref-type="bibr" rid="bib39">Hamood and Marder, 2014</xref>; <xref ref-type="bibr" rid="bib2">Alonso and Marder, 2019</xref>). We therefore set out to study the variability in baseline circuit dynamics in the 346 pyloric circuits recorded under baseline conditions in this dataset.</p><p>The burst period of the pyloric circuit in the lobster can vary two- to threefold under baseline conditions at 11°C across animals (<xref ref-type="bibr" rid="bib9">Bucher et al., 2005</xref>). Despite this sizable variation, other burst metrics, such as the phase onset of follower neurons, or the duty cycles of individual neurons, are tightly constrained (<xref ref-type="bibr" rid="bib9">Bucher et al., 2005</xref>), likely related to the fact that these circuits are under activity-dependent feedback regulation (<xref ref-type="bibr" rid="bib103">Turrigiano et al., 1995</xref>; <xref ref-type="bibr" rid="bib73">O’Leary et al., 2014</xref>; <xref ref-type="bibr" rid="bib33">Gorur-Shandilya et al., 2020</xref>) as they develop and grow. Activity-dependent regulation of diverse pyloric circuits could constrain variability in a single circuit across time to be smaller than variability across the population.</p><p>To test this hypothesis, we measured a number of burst metrics such as burst period and the phases and duty cycles of the two neurons across these 346 preparations in baseline conditions (<xref ref-type="fig" rid="fig4">Figure 4</xref>) when data are labeled regular because metrics are well-defined in this state. The mean values of each of these metrics were unimodally distributed (<xref ref-type="fig" rid="fig4">Figure 4a</xref>) and the coefficient of variation (CV) for all metrics was approximately 0.1 (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). Using the mean CV in each individual as a proxy for the within-animal variability, and the CV of the individual means as a proxy for the across-animal variability, we found that every metric measured was more variable across animals than within animals (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). Shuffling experimental labels generated null distributions for excess variability across animals and showed that across-animal variability was significantly greater than within-animal variability (<xref ref-type="fig" rid="fig4">Figure 4d</xref>, p&lt;0.007, permutation test, <xref ref-type="table" rid="table1">Table 1</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Variability of burst metrics under baseline conditions.</title><p>(<bold>a</bold>) Variability of burst metrics in pyloric dilator (PD) and lateral pyloric (LP) neurons across a population of wild-caught animals. Metrics are only computed under baseline conditions and in the regular cluster. (<bold>b</bold>) Distribution of coefficient of variation (CV) of metrics in each animal across all data from that animal. In (<bold>a, b</bold>), each dot is from a single animal, and distributions show variability across the entire population. (<bold>c</bold>) Across-animal variability (CV of individual means, Δ) is greater than within-animal variation (mean of CV in each animal, Ο) for every metric. (<bold>d</bold>) Difference between across-animal variability and within-animal variability (colored dots). For each metric, gray dots and distribution show differences between across-animal and within-animal variability for shuffled data. <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>18</mml:mn><mml:mo>,</mml:mo><mml:mn>336</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> points from <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">346</mml:mn></mml:mrow></mml:math></inline-formula> animals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>State distribution under baseline conditions.</title><p>(<bold>a</bold>) Map showing occupancy of baseline data. Shading indicates all data. Bright colored points are data from baseline conditions. (<bold>b</bold>) Treemap showing state probabilities under baseline conditions. (<bold>c</bold>) Preparation-by-preparation variation in state distribution under baseline conditions. <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>22</mml:mn><mml:mo>,</mml:mo><mml:mn>807</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> data snippets from <inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>346</mml:mn></mml:mrow></mml:math></inline-formula> individual preparations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Recording condition alters regular state probability.</title><p>(<bold>a</bold>) Cumulative probability of the probability of observing a regular state, per animal. Cumulative probability of probability of regular state for preparations with lateral pyloric (LP) (<bold>b</bold>) and pyloric dilator (PD) (<bold>c</bold>) neurons recorded extracellularly (black) vs. LP recorded intracellularly (red). (<bold>d–g</bold>) State probabilities in different recording conditions. (<bold>h</bold>) Probability of observing states in which PD activity is reduced (PD-silent, PD-weak-skipped) in preparations in which PD is recorded intracellularly (red) vs. preparations in which PD is recorded extracellularly (black). (<bold>i</bold>) Same as (<bold>h</bold>), but for LP. In all panels, thick lines show CDFs and shading indicates confidence intervals estimated by bootstrap. <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>22</mml:mn><mml:mo>,</mml:mo><mml:mn>807</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, N = 346. p-values in each panel are from two-sample Kolmogorov-Smirnov tests.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Effect of sea surface temperature on baseline circuit dynamics.</title><p>(<bold>a</bold>) Sea surface temperature at the Boston Harbor vs. experimental date. Red line is a smoothing fit. Mean burst period of pyloric dilator (PD) neuron (<bold>b</bold>), mean duty cycle of PD (<bold>c</bold>), and probability of observing the regular state (<bold>d</bold>) vs. sea surface temperature. In all panels, each dot corresponds to a single preparation. <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>312</mml:mn></mml:mrow></mml:math></inline-formula> preparations. <inline-formula><mml:math id="inf16"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is the Spearman correlation coefficient, and <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>-value is from the Spearman rank correlation test.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig4-figsupp3-v2.tif"/></fig></fig-group><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>ANOVA results and power analysis for <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title><p>ANOVA results for burst metrics in baseline conditions. For each metric, each animal is treated as a group and the variability (mean square difference) is compared within and across group. <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the ratio of across-animal to within-animal mean square differences. <italic>N</italic><sub>.99</sub> is the estimate of the sample size required to reject the null hypothesis with a probability of 0.99 when the alternative hypothesis is true. <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>346</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> animals.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Metric</th><th align="left" valign="bottom">Across-animal MS</th><th align="left" valign="bottom">Within-animal MS</th><th align="left" valign="bottom">F</th><th align="left" valign="bottom"><italic>N</italic><sub>.99</sub></th></tr></thead><tbody><tr><td align="left" valign="bottom">LP delay off (s)</td><td align="char" char="." valign="bottom">1.1391</td><td align="char" char="." valign="bottom">0.010 956</td><td align="left" valign="bottom">103.97</td><td align="char" char="." valign="bottom">6</td></tr><tr><td align="left" valign="bottom">LP delay on (s)</td><td align="char" char="." valign="bottom">0.616 47</td><td align="char" char="." valign="bottom">0.0111</td><td align="left" valign="bottom">55.54</td><td align="char" char="." valign="bottom">6</td></tr><tr><td align="left" valign="bottom">LP durations (s)</td><td align="char" char="." valign="bottom">0.363 86</td><td align="char" char="." valign="bottom">0.012 366</td><td align="left" valign="bottom">29.424</td><td align="char" char="." valign="bottom">4</td></tr><tr><td align="left" valign="bottom">LP duty cycle</td><td align="char" char="." valign="bottom">0.159 86</td><td align="char" char="." valign="bottom">0.001 309 3</td><td align="left" valign="bottom">122.09</td><td align="char" char="." valign="bottom">10</td></tr><tr><td align="left" valign="bottom">LP phase off</td><td align="char" char="." valign="bottom">0.234 06</td><td align="char" char="." valign="bottom">0.007 227 9</td><td align="left" valign="bottom">32.383</td><td align="char" char="." valign="bottom">11</td></tr><tr><td align="left" valign="bottom">LP phase on</td><td align="char" char="." valign="bottom">0.216 55</td><td align="char" char="." valign="bottom">0.008 811 5</td><td align="left" valign="bottom">24.576</td><td align="char" char="." valign="bottom">9</td></tr><tr><td align="left" valign="bottom">PD burst period (s)</td><td align="char" char="." valign="bottom">3.557</td><td align="char" char="." valign="bottom">0.036 872</td><td align="left" valign="bottom">96.469</td><td align="char" char="." valign="bottom">4</td></tr><tr><td align="left" valign="bottom">PD durations (s)</td><td align="char" char="." valign="bottom">0.079 397</td><td align="char" char="." valign="bottom">0.000 549 44</td><td align="left" valign="bottom">144.5</td><td align="char" char="." valign="bottom">6</td></tr><tr><td align="left" valign="bottom">PD duty cycle</td><td align="char" char="." valign="bottom">0.053 472</td><td align="char" char="." valign="bottom">0.000 413 23</td><td align="left" valign="bottom">129.4</td><td align="char" char="." valign="bottom">16</td></tr></tbody></table><table-wrap-foot><fn><p>LP: lateral pyloric; PD: pyloric dilator.MS: mean square.</p></fn></table-wrap-foot></table-wrap><p>It is reasonable to suppose that all baseline data exist in the regular cluster. While most baseline data are confined to the regular cluster (<inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>80</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1a</xref>), the remaining data, nominally recorded under baseline conditions, contains atypical circuit dynamics (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1b and c</xref>). What causes these atypical circuit dynamics in this large, unbiased survey of baseline pyloric activity? One possibility could be inadvertent damage to the preparation caused by dissection and preparation of the circuit for recording. Consistent with this, we found that the probability of observing regular states was significantly reduced when cells were recorded from intracellularly (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>), which may be due to increase in leak currents owing to impaling cells with sharp electrodes (<xref ref-type="bibr" rid="bib19">Cymbalyuk et al., 2002</xref>) or due to cell dialysis (<xref ref-type="bibr" rid="bib47">Hooper et al., 2015</xref>). No significant correlation was observed between sea surface temperatures (a proxy for environmental conditions for these wild-caught animals) and burst metrics (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3a–c</xref>) or the probability of observing a regular state (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3d</xref>). Taken together, these results underscore the importance of verifying that baseline or control data does not include uncontrolled technical variability that could mask biological effects of interest.</p></sec><sec id="s2-5"><title>Perturbation modality alters state probability</title><p>The pyloric circuit and other circuits in the crab must exhibit robustness to the environmental perturbations that these animals are likely to encounter. Previous studies have characterized the ability of crustacean circuits to be robust to environmental perturbations such as pH (<xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>; <xref ref-type="bibr" rid="bib81">Ratliff et al., 2021</xref>; <xref ref-type="bibr" rid="bib80">Qadri et al., 2007</xref>), temperature (<xref ref-type="bibr" rid="bib94">Tang et al., 2010</xref>; <xref ref-type="bibr" rid="bib95">Tang et al., 2012</xref>; <xref ref-type="bibr" rid="bib82">Rinberg et al., 2013</xref>; <xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>; <xref ref-type="bibr" rid="bib51">Kushinsky et al., 2019</xref>), oxygen levels (<xref ref-type="bibr" rid="bib15">Clemens et al., 2001</xref>), and changes in extracellular ionic concentrations (<xref ref-type="bibr" rid="bib44">He et al., 2020</xref>). Robustness to these perturbations exists up to a limit, likely reflecting the bounds of the natural variation in these quantities that these circuits are evolved to function in. When challenged with extremes of any of these perturbation modalities, the pyloric rhythm breaks down, displaying irregular or aberrant states, and may even cease spiking entirely. Such states are commonly referred to as ‘crashes’ and can have many flavors (<xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>; <xref ref-type="bibr" rid="bib94">Tang et al., 2010</xref>; <xref ref-type="bibr" rid="bib95">Tang et al., 2012</xref>) and involve the loss of the characteristic antiphase activity in the LP and PD neurons.</p><p>It remains unclear if extreme perturbations of different modalities share common pathways of destabilizing and disrupting the pyloric rhythm (<xref ref-type="bibr" rid="bib81">Ratliff et al., 2021</xref>). In principle, these environmental perturbations can disrupt neuron and circuit function in qualitatively different ways: for example, changes in extracellular potassium concentration can alter the reversal potential of potassium (<xref ref-type="bibr" rid="bib44">He et al., 2020</xref>) vs. changes in temperature can have varied effects on the timescales and conductances of all ion channels (<xref ref-type="bibr" rid="bib94">Tang et al., 2010</xref>; <xref ref-type="bibr" rid="bib10">Caplan et al., 2014</xref>). Because prior work was focused on studying the limits of robustness and lacked a detailed quantitative description of irregular behavior, the fine structure of the transition between functional dynamics and silent or ‘crashed’ states remain poorly characterized (<xref ref-type="bibr" rid="bib81">Ratliff et al., 2021</xref>). We therefore set out to measure how pH, temperature, and extracellular potassium perturbations alter circuit state probability.</p><p>Where in the map are data under extreme environmental perturbations? Circuit spike patterns under high pH (&gt;9.5), high temperature (&gt;25°C), and high extracellular potassium (<inline-formula><mml:math id="inf21"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) are distributed across a wide region of the map, spanning both regions in the regular cluster and other nonregular clusters (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). Spike patterns observed under high-temperature conditions in the regular region were clustered in the lower extremity, in the region containing high firing rates and small burst periods of PD (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>), consistent with earlier studies showing that elevated temperatures tend to speed up the pyloric rhythm (<xref ref-type="bibr" rid="bib94">Tang et al., 2010</xref>; <xref ref-type="bibr" rid="bib95">Tang et al., 2012</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Effect of three different environmental perturbations.</title><p>(<bold>a</bold>) Map showing regions that are more likely to contain data recorded under extreme environmental perturbations. (<bold>b</bold>) Treemaps showing probability distributions of states under baseline and perturbed conditions. (<bold>c</bold>) Probability distribution of states preceding silent state under perturbation. pH perturbations: <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">4023</mml:mn></mml:mrow></mml:math></inline-formula> from 6 animals; <inline-formula><mml:math id="inf23"><mml:mrow><mml:mo mathvariant="normal" stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo mathvariant="normal">+</mml:mo></mml:msup><mml:mo mathvariant="normal" stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> perturbations: <inline-formula><mml:math id="inf24"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">5526</mml:mn></mml:mrow></mml:math></inline-formula> from 20 animals; temperature perturbations: <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>80</mml:mn><mml:mo>,</mml:mo><mml:mn>470</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> from 414 animals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Preparation-by-preparation response to pH perturbations.</title><p>Each panel shows the response of a single preparation to pH perturbations. States are indicated in colors. Each preparation was stepped through various pH levels before returning to baseline pH. Note silent states (black) during acidic pH.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig5-figsupp1-v2.tif"/></fig></fig-group><p>Subjecting the pyloric circuit to extremes of pH, temperature, and extracellular potassium altered the distribution of observed states (<xref ref-type="fig" rid="fig5">Figure 5c</xref>). In all cases, the probability of observing regular was significantly reduced (p&lt;0.001, paired permutation test), and a variety of nonregular states were observed. We observed that high pH (&gt;9.5) did not silence the preparation, but silent states were observed in low pH (&lt;6.5), consistent with previously published manual annotation of this data (<xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>). Silent states were also observed in <inline-formula><mml:math id="inf26"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, as reported earlier by <xref ref-type="bibr" rid="bib44">He et al., 2020</xref>. Previous work has shown that the isolated pacemaker kernel (AB and PD neurons) has a stereotyped trajectory from bursting through tonic spiking to silence when subjected to pH perturbations (<xref ref-type="bibr" rid="bib81">Ratliff et al., 2021</xref>), but moves through a different trajectory (bursting to weak bursting to silence) during temperature perturbations. Do pathways to silent states share similarities across perturbation modality in intact circuits? To answer this, we plotted the probability of observing states conditioned on the transition to silence in low pH, high temperature, and <inline-formula><mml:math id="inf27"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5d</xref>). In the <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>2000</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> transitions between states detected, we never observed a transition from regular to silent, suggesting that the timescales of silencing are slow, longer than the width of one data bin (20 s). Trajectories to silent states always transition through a few intermediate states such as <monospace>sparse-irregular, LP-silent, or PD-silent</monospace> (<xref ref-type="fig" rid="fig5">Figure 5d</xref>).</p></sec><sec id="s2-6"><title>Transitions between states during environmental perturbations</title><p>Changes in temperature, pH, and <inline-formula><mml:math id="inf29"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> have different effects on the cells in the pyloric circuit and therefore can destabilize the rhythm in different ways. Increasing the extracellular <inline-formula><mml:math id="inf30"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> changes the reversal potential of K<sup>+</sup> ions, altering the currents flowing through potassium channels, and typically depolarizes the neuron (<xref ref-type="bibr" rid="bib44">He et al., 2020</xref>). Ion channels can be differentially sensitive to changes in temperature or pH, and changes in these variables can have complex effects on ionic currents in neurons (<xref ref-type="bibr" rid="bib94">Tang et al., 2010</xref>; <xref ref-type="bibr" rid="bib95">Tang et al., 2012</xref>; <xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>). We therefore asked if different environmental perturbations changed the way in which regular rhythms destabilized.</p><p>Our analysis mapped a time series of spike times from PD and LP neurons to a categorical time series of labels such as regular. We therefore could measure the transitions between states during different environmental perturbations (Materials and methods). We found that transition matrices between states shared commonalities across environmental perturbations (<xref ref-type="fig" rid="fig6">Figure 6a</xref>), such as likely transitions between regular and LP-weak-skipped states. PD-silent-LP-bursting states tended to be followed by PD-silent states, in which the LP neuron is spiking, but not bursting regularly. The LP neuron becomes less regular in both transitions, contributing to the loss of regular rhythms. We never observed a transition from regular rhythms LP-silent or PD-silent states, suggesting slow (&gt;20 s) timescales of rhythm collapse. In high pH, every transition away from the regular state was to the LP-weak-skipped state, hinting at increased sensitivity of the LP neuron to high pH. High pH perturbations also never silenced the circuit, as previously reported (<xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>), and showed fewer and less varied transitions than other perturbations. Are some transitions over- or underrepresented in the transition matrix? To determine this, we constructed a null model where transitions occurred with probabilities that scaled with the marginal probability of final states (Materials and methods). Transitions that occurred significantly more often than predicted by the null model are shown with black borders and those that occurred significantly less often than predicted are shown with filled circles (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). Transitions that never occurred but occurred at significantly nonzero rates in the null model are indicated with diamonds.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Effect of environmental perturbations on transitions between states.</title><p>(<bold>a</bold>) Transition matrix between states during environmental perturbations. Each matrix shows the conditional probability of observing the final state in the next time step given an observation of the initial state. Probabilities in each row sum to 1. Size of disc scales with probability. Discs with dark borders are transitions that are significantly more likely than the null model (Materials and methods). Dark solid discs are transitions with nonzero probability that are significantly less likely than in the null model. <inline-formula><mml:math id="inf31"><mml:mi mathvariant="normal">◇</mml:mi></mml:math></inline-formula> are transitions that are never observed and are significantly less likely than in the null model. States are ordered from regular to silent. (<bold>b</bold>) Coefficient of variation (CV) of burst period of pyloric dilator (PD) (purple) and lateral pyloric (LP) (red) vs. time before transition away from the regular state. <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> are from Spearman test (on binned data, as plotted) to check if variability increases significantly before transition. Temperature perturbations: <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1035</mml:mn></mml:mrow></mml:math></inline-formula> transitions in 61 animals; pH perturbations: <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">90</mml:mn></mml:mrow></mml:math></inline-formula> transitions in 6 animals; <inline-formula><mml:math id="inf35"><mml:mrow><mml:mo mathvariant="normal" stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo mathvariant="normal">+</mml:mo></mml:msup><mml:mo mathvariant="normal" stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> perturbations: <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">271</mml:mn></mml:mrow></mml:math></inline-formula> transitions in 20 animals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig6-v2.tif"/></fig><p>Earlier work has shown that transitions from regular bursting are preceded by an increase in variability in the voltage dynamics of bursting in PD neurons pharmacologically isolated from most of the pyloric circuit (<xref ref-type="bibr" rid="bib81">Ratliff et al., 2021</xref>). Can we detect similar signatures of destabilization before transitions from regular states in the intact circuit? We measured the CV of the burst periods of PD and LP neurons in regular states just before transitions away from regular (<xref ref-type="fig" rid="fig6">Figure 6b</xref>). Because we restricted our measurement of variability to regular states, we could disambiguate true cycle-to-cycle jitter in the timing of bursts from the apparent variability in cycle period due to alternations between bursting and nonbursting dynamics. We found that transitions away from regular were correlated with a steady and almost monotonic increase in variability in PD and LP burst periods for low pH and high <inline-formula><mml:math id="inf37"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> perturbations, but not for high pH and high-temperature perturbations (Spearman rank correlation test). This suggests mechanistically different underpinnings to the pathways of destabilization between these sets of perturbations and is consistent with previous work showing that robustness to perturbations in pH only moderately affects temperature robustness in the same neuron (<xref ref-type="bibr" rid="bib81">Ratliff et al., 2021</xref>).</p></sec><sec id="s2-7"><title>Decentralization elicits variable circuit dynamics</title><p>The pyloric circuit is modulated by a large and chemically diverse family of neuromodulators that it receives via the stomatogastric (<italic>stn</italic>) nerve (<xref ref-type="bibr" rid="bib63">Marder, 2012</xref>). Decentralization, or the removal of this neuromodulatory input via transection and/or chemical block of the <italic>stn</italic>, has been shown to affect the pyloric rhythm in a number of ways (<xref ref-type="bibr" rid="bib84">Russell, 1976</xref>). Decentralization can stop the rhythm temporarily, which can recover after a few days (<xref ref-type="bibr" rid="bib30">Golowasch et al., 1999</xref>; <xref ref-type="bibr" rid="bib98">Thoby-Brisson and Simmers, 1998</xref>). Decentralization slows down the pyloric rhythm (<xref ref-type="bibr" rid="bib23">Eisen and Marder, 1982</xref>; <xref ref-type="bibr" rid="bib83">Rosenbaum and Marder, 2018</xref>) and makes the rhythm more variable (<xref ref-type="bibr" rid="bib39">Hamood and Marder, 2014</xref>; <xref ref-type="bibr" rid="bib40">Hamood et al., 2015</xref>). Decentralization can evoke variable circuit dynamics, sometimes with slow timescales (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>), and can lead to changes in ion channel expression (<xref ref-type="bibr" rid="bib68">Mizrahi et al., 2001</xref>).</p><p>The variability in circuit dynamics elicited by decentralization and the animal-to-animal variability in response to decentralization have made a quantitative analysis of the effects of decentralization difficult. We therefore set about to characterize the variable and invariant features of the changes in circuit spiking dynamics on removal of descending neuromodulation across a large (<inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>141</mml:mn></mml:mrow></mml:math></inline-formula>) population.</p><p>We first asked where in the map decentralized data were (<xref ref-type="fig" rid="fig7">Figure 7a</xref>). A large fraction (<inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>30</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) of the data was found outside the regular cluster, suggesting the existence of atypical circuit dynamics on decentralization. Decentralization also changed probabilities of observing many states. The regular state was significantly less likely on decentralization, and several atypical states were significantly more likely (<xref ref-type="fig" rid="fig7">Figure 7b and c</xref>, <xref ref-type="table" rid="table2">Table 2</xref>, <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>).</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Effect of decentralization.</title><p>(<bold>a</bold>) Map occupancy conditional on decentralization. Shading shows all data, and bright colored dots indicate data when preparations are decentralized. (<bold>b</bold>) State probabilities before and after decentralization. (<bold>c</bold>) Fold change in state probabilities on decentralization. States marked n.s. are not significantly more or less likely after decentralization. All other states are (paired permutation test, p&lt;0.00016). (<bold>a, b</bold>) <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>602</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> points from <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">141</mml:mn></mml:mrow></mml:math></inline-formula> animals. (<bold>d</bold>) Transition matrix during decentralization. Probabilities in each row sum to 1. Size of disc scales with probability. Discs with dark borders are transitions that are significantly more likely than the null model (Materials and methods). Dark solid discs are transitions with nonzero probability that are significantly less likely than in the null model. <inline-formula><mml:math id="inf42"><mml:mi mathvariant="normal">◇</mml:mi></mml:math></inline-formula> are transitions that are never observed and are significantly less likely than in the null model. States are ordered from regular to silent. <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1933</mml:mn></mml:mrow></mml:math></inline-formula> transitions. (<bold>e</bold>) Coefficient of variation of pyloric dilator (PD, purple) and lateral pyloric (LP; red) burst periods before transition away from regular states. <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> from Spearman test. <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1332</mml:mn></mml:mrow></mml:math></inline-formula> points from <inline-formula><mml:math id="inf46"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">79</mml:mn></mml:mrow></mml:math></inline-formula> animals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Decentralization evokes variable dynamics.</title><p>In each panel, interspike intervals (ISIs) of pyloric dilator (PD; blue) and lateral pyloric (LP; red) neurons are shown before and after (shaded) decentralization. The diversity of circuit responses to decentralization includes minimal change (<bold>a</bold>), transient perturbation followed by recovery (<bold>b–d</bold>), silence in one or two neurons (<bold>e–h</bold>), slow oscillatory responses (<bold>l</bold>), and a switch from bursting to spiking (<bold>m, n</bold>). Each panel corresponds to a different preparation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>Effects of decentralization on state probabilities.</title><p>Each panel shows the probability of observing a given state before (x-axis) and after (y-axis) decentralization. Each dot is a single preparation. Probabilities computed on an animal-by-animal basis from <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mn>940</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> points from <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>140</mml:mn></mml:mrow></mml:math></inline-formula> preparations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig7-figsupp2-v2.tif"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 3.</label><caption><title>Time course of effects of decentralization.</title><p>(<bold>a</bold>) Each line shows the states exhibited by one circuit before and after (gray shaded region) decentralization. Dots indicate states that were maintained only for one time bin (20 s). (<bold>b</bold>) Stacked bars show probabilities of displaying state vs. time. <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>93</mml:mn></mml:mrow></mml:math></inline-formula> animals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig7-figsupp3-v2.tif"/></fig><fig id="fig7s4" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 4.</label><caption><title>Effects of decentralization do not correlate with seasonal effects.</title><p>Probability of observing the regular state during decentralization (<bold>a</bold>), change in time period of pyloric dilator (PD) neuron (<bold>b</bold>), and change in firing rate of PD (<bold>c</bold>) vs. sea surface temperature on the day experiment was carried out. <inline-formula><mml:math id="inf50"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is the Spearman correlation coefficient, and <inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>-values are computed using the Spearman rank correlation test.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig7-figsupp4-v2.tif"/></fig></fig-group><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>State counts before and after decentralization for the data shown in <xref ref-type="fig" rid="fig7">Figure 7</xref>.</title><p>p-Values of change in probability of observing change estimated from paired permutation tests.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">State</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf52"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf53"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf54"><mml:mi>p</mml:mi></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf55"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom">Regular</td><td align="char" char="." valign="bottom">7,967</td><td align="char" char="." valign="bottom">5,791</td><td align="left" valign="bottom"><italic>lt</italic><sub>0.001</sub></td><td align="char" char="." valign="bottom">-0.308 77</td></tr><tr><td align="left" valign="bottom">LP-silent</td><td align="char" char="." valign="bottom">22</td><td align="char" char="." valign="bottom">724</td><td align="left" valign="bottom"><italic>lt</italic><sub>0.001</sub></td><td align="char" char="." valign="bottom">0.030 65</td></tr><tr><td align="left" valign="bottom">LP-silent-PD-bursting</td><td align="char" char="." valign="bottom">14</td><td align="char" char="." valign="bottom">577</td><td align="left" valign="bottom"><italic>lt</italic><sub>0.001</sub></td><td align="char" char="." valign="bottom">0.045 926</td></tr><tr><td align="left" valign="bottom">PD-silent</td><td align="char" char="." valign="bottom">11</td><td align="char" char="." valign="bottom">140</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">0.018 51</td></tr><tr><td align="left" valign="bottom">PD-silent-LP-bursting</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">18</td><td align="char" char="." valign="bottom">0.469 59</td><td align="char" char="." valign="bottom">0.000 188 91</td></tr><tr><td align="left" valign="bottom">Aberrant-spikes</td><td align="char" char="." valign="bottom">111</td><td align="char" char="." valign="bottom">168</td><td align="char" char="." valign="bottom">0.300 37</td><td align="char" char="." valign="bottom">0.003 285 3</td></tr><tr><td align="left" valign="bottom">LP-weak-skipped</td><td align="char" char="." valign="bottom">317</td><td align="char" char="." valign="bottom">1,628</td><td align="left" valign="bottom"><italic>lt</italic><sub>0.001</sub></td><td align="char" char="." valign="bottom">0.099 875</td></tr><tr><td align="left" valign="bottom">PD-weak-skipped</td><td align="char" char="." valign="bottom">142</td><td align="char" char="." valign="bottom">118</td><td align="char" char="." valign="bottom">0.292 19</td><td align="char" char="." valign="bottom">0.003 453 8</td></tr><tr><td align="left" valign="bottom">Sparse-irregular</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">154</td><td align="left" valign="bottom"><italic>lt</italic><sub>0.001</sub></td><td align="char" char="." valign="bottom">0.013 263</td></tr><tr><td align="left" valign="bottom">Irregular</td><td align="char" char="." valign="bottom">13</td><td align="char" char="." valign="bottom">116</td><td align="char" char="." valign="bottom">0.000 23</td><td align="char" char="." valign="bottom">0.010 877</td></tr><tr><td align="left" valign="bottom">Silent</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">321</td><td align="left" valign="bottom"><italic>lt</italic><sub>0.001</sub></td><td align="char" char="." valign="bottom">0.024 825</td></tr><tr><td align="left" valign="bottom">Irregular-bursting</td><td align="char" char="." valign="bottom">72</td><td align="char" char="." valign="bottom">753</td><td align="left" valign="bottom"><italic>lt</italic><sub>0.001</sub></td><td align="char" char="." valign="bottom">0.057 913</td></tr></tbody></table><table-wrap-foot><fn><p>LP: lateral pyloric; PD: pyloric dilator.</p></fn></table-wrap-foot></table-wrap><p>How do preparations switch between different states when decentralized? The transition matrix during decentralization revealed many transitions between diverse states (<xref ref-type="fig" rid="fig7">Figure 7d</xref>), with the most likely transitions being significantly overrepresented compared to the null model (p&lt;0.05, Materials and methods). Transitions away from regular included significantly more likely transitions into states where one of the neurons was irregular such as LP-weak-skipped and PD-weak-skipped. Similar to rhythm destabilization in high <inline-formula><mml:math id="inf56"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> or low pH, transitions away from regular were associated with a near-monotonic increase in the variability of PD and LP burst periods before the transitions (<xref ref-type="fig" rid="fig7">Figure 7e</xref>, <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>≈</mml:mo><mml:mn>.8</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, p&lt;0.006, Spearman rank correlation test).</p><p>The time series of identified states on a preparation-by-preparation basis showed striking variability in the responses to decentralization (<xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3a</xref>), with the probability of observing regular states decreasing immediately after decentralization (<xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3b</xref>). What causes the observed animal-to-animal variability in circuit dynamics on decentralization? One possibility is that seasonal changes in environmental conditions alter the sensitivity of the pyloric circuit to neuromodulation. We tested this hypothesis by measuring the correlation between measures such as the probability of observing the regular state, the change in burst period, and the change in firing rate on decentralization and the sea surface temperature at the approximate location of these wild-caught animals (<xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref>). None of these measures was significantly correlated with sea surface temperature (p&gt;0.07, Spearman rank correlation test).</p></sec><sec id="s2-8"><title>Stereotyped effects of decentralization on burst metrics</title><p>Despite the animal-to-animal variation in responses to decentralization, are there stereotyped responses to decentralization? Decentralization removes some unknown mixture of modulators that are released by the <italic>stn</italic>, which can vary from animal to animal. Previous work has shown that decentralization typically slows down the pyloric rhythm (<xref ref-type="bibr" rid="bib23">Eisen and Marder, 1982</xref>; <xref ref-type="bibr" rid="bib83">Rosenbaum and Marder, 2018</xref>) and (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>), but a finer-grained analysis of rhythm metrics was confounded by the irregular dynamics that can arise when preparations are decentralized. For example, alteration between regular and atypical states could bias estimates of burst metrics that are not defined in atypical states. Because our analysis allows us to identify the subset of data where pyloric circuit dynamics are regular enough that burst metrics are well-defined, we measured the changes in a number of burst metrics like the burst period, duty cycle, and phases on decentralization (<xref ref-type="fig" rid="fig8">Figure 8a</xref>). Every metric measured was significantly changed except the phase at which LP bursts start (p&lt;0.007, paired permutation test). Consistent with earlier studies, we found that the CV in every metric increased following decentralization (<xref ref-type="fig" rid="fig8">Figure 8b</xref>).</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Effects of decentralization on burst metrics.</title><p>(<bold>a</bold>) Change in mean burst metrics on decentralization. (<bold>b</bold>) Change in coefficient of variation of burst metrics on decentralization. In (<bold>a</bold>) and (<bold>b</bold>), each dot is a single preparation; * indicate distributions whose mean is significantly different from zero (p&lt;0.007, paired permutation test). Firing rates (<bold>c</bold>), burst period (<bold>d</bold>), lateral pyloric (LP) phases (<bold>e</bold>), and duty cycles (<bold>f</bold>) vs. time since decentralization. In (<bold>c–f</bold>), thick lines indicate population means, and shading indicates the standard error of the mean. <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mn>898</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> points from <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">141</mml:mn></mml:mrow></mml:math></inline-formula> preparations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig8-v2.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Example rasters showing effect of decentralization.</title><p>Rasters from two preparations showing activity before and after decentralization. All of these patterns are classified as regular. Note that the overall rhythm slows down when the preparation is decentralized, but the phase relationships between the bursts are preserved.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig8-figsupp1-v2.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>Effects of decentralization on regular rhythms.</title><p>(<bold>a</bold>) Mean locations of data in the regular cluster before and after decentralization. Each preparation is represented by a pair of points, one circle, and one cross. (<bold>b</bold>) Dispersion (Materials and methods) of data before and after decentralization. Each preparation is a single point. Note that the data appear to be skewed to the right, indicating larger dispersion before decentralization. (<bold>c</bold>) Distribution of differences in dispersion. The distribution of differences is not significantly skewed from a Gaussian (<inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.66</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, Anderson–Darling test), and dispersion in decentralized preparations is significantly lower than in baseline (<inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.0016</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>3.246</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, paired <italic>t</italic>-test). <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mn>758</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> points from <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>140</mml:mn></mml:mrow></mml:math></inline-formula> preparations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig8-figsupp2-v2.tif"/></fig></fig-group><p>What are the dynamics of changes in burst metrics on decentralization? Firing rates of both LP and PD neurons decreased immediately on decentralization, roughly halving their pre-decentralized values (<xref ref-type="fig" rid="fig8">Figure 8c</xref>). This occurred together with a doubling of PD burst periods (<xref ref-type="fig" rid="fig8">Figure 8d</xref>), suggesting that the entire rhythm is slowing down. Intriguingly, decentralization led to significant advance in the phase of LP burst ends, but not starts (<xref ref-type="fig" rid="fig8">Figure 8e</xref>), leading to a large decrease in the duty cycle of the LP neuron (<xref ref-type="fig" rid="fig8">Figure 8f</xref>) that was significantly more than the decrease in PD’s duty cycle (p&lt;10<sup>-8</sup>, paired <italic>t</italic>-test).</p><p>The stereotyped slowing of the rhythm on decentralization can also be quantified by looking at the distribution of the data in the regular cluster before and after decentralization (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref>). Data are concentrated in the upper-left edge of the regular cluster when decentralized, where burst periods are large and firing rates low (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1a and c</xref>), suggesting that decentralization could elicit a more stereotyped rhythm for circuits that continue to burst regularly, because circuits that do so tend to share a common, slow bursting dynamics. Counterintuitively, it may appear that regular rhythms in baseline conditions are more variable than regular rhythms after decentralization. To test this hypothesis, we measured the dispersion of each preparation in the map (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2b</xref>) before and after decentralization. Dynamics before decentralization were significantly more dispersed in the regular cluster than dynamics after decentralization (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2c</xref>, <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.0016</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, paired <italic>t</italic>-test) because they then tended to be concentrated in the upper-left edge of that cluster. To first approximation, our analysis shows that there are many ways to manifest a regular rhythm under baseline conditions, but regular rhythms on decentralization are typically slow, and stereotyped in comparison.</p></sec><sec id="s2-9"><title>Neuromodulators differentially affect state probabilities</title><p>The crustacean STG is modulated by more than 30 substances (<xref ref-type="bibr" rid="bib42">Harris-Warrick and Marder, 1991</xref>; <xref ref-type="bibr" rid="bib63">Marder, 2012</xref>) that tune neuronal properties at an intermediate timescale between feedback homeostasis and intrinsic cellular properties (<xref ref-type="bibr" rid="bib20">Daur et al., 2016</xref>). Earlier work has focused on understanding the effect modulators have on restoring (or destabilizing) the canonical rhythm, in part because the restoration of regular oscillatory dynamics is a common feature of neuromodulator action. Other effects that neuromodulators might have on pyloric circuit dynamics are harder to investigate and are hindered by the difficulty in characterizing circuit dynamics when nonregular. Here, we set out to systematically characterize the effects of neuromodulators on dynamic states identified in the full space of circuit behaviors (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>We focused our analysis on the effect of four neuromodulators: red pigment-concentrating hormone (RPCH), proctolin, oxotremorine, and serotonin. In the experiments analyzed, these neuromodulators were added to decentralized preparations so that endogenous effects of these (and other) neuromodulators were minimized. We therefore first characterized the distribution of states in decentralized preparations where neuromodulators were subsequently added (<xref ref-type="fig" rid="fig9">Figure 9a</xref>).</p><fig-group><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Effect of bath-applied modulators.</title><p>(<bold>a</bold>) State distribution in decentralized preparations. (<bold>b</bold>) State distribution in bath application of neuromodulators. Change percentages show difference in probability of regular state from decentralized to addition of neuromodulator. (<bold>c</bold>) Probability distribution of states conditional on transition to (for red pigment-concentrating hormone [RPCH], proctolin, and oxotremorine) or from (for serotonin) the regular state. <inline-formula><mml:math id="inf65"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of data points, and <inline-formula><mml:math id="inf66"><mml:mi>N</mml:mi></mml:math></inline-formula> is the number of animals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig9-v2.tif"/></fig><fig id="fig9s1" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 1.</label><caption><title>Raw traces during proctolin application.</title><p>Nonregular activity patterns in proctolin. Each panel shows a 20 s snippet of raw recordings showing spikes from lateral pyloric (LP; red) and pyloric dilator (PD; blue) neurons. Each panel is from a different animal. Each row is from a different experimenter. (<bold>a</bold>) Irregular bursting; note prolonged spiking of LP on <italic>lvn</italic>. (<bold>b</bold>) LP completely silent; missing from <italic>lvn</italic>. (<bold>c</bold>) Intermittent LP interruptions; note breaks in <italic>lvn</italic>. (<bold>d</bold>) Interruption in LP bursting. (<bold>e</bold>) Interruption in PD and LP bursting. (<bold>f</bold>) Irregular bursting of both PD and LP. (<bold>g, h</bold>) Interruption of both PD and LP. Traces labeled PD or LP are intracellular recordings.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig9-figsupp1-v2.tif"/></fig><fig id="fig9s2" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 2.</label><caption><title>Neuromodulators affect map occupancy.</title><p>In each panel, all the data are shown in light shading. Bright colors indicate distribution of data during bath application of that neuromodulator. The number of animals in each panel is indicated in the title.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig9-figsupp2-v2.tif"/></fig></fig-group><p>RPCH is a neuropeptide that targets a number of cells in the circuit (<xref ref-type="bibr" rid="bib71">Nusbaum and Marder, 1988</xref>; <xref ref-type="bibr" rid="bib93">Swensen and Marder, 2001</xref>) and has been shown to increase the number of spikes per burst in PD and LP (<xref ref-type="bibr" rid="bib21">Dickinson et al., 2001</xref>; <xref ref-type="bibr" rid="bib96">Thirumalai and Marder, 2002</xref>), though it has little effect on the pyloric period (<xref ref-type="bibr" rid="bib97">Thirumalai et al., 2006</xref>). RPCH increased the probability of the regular state, suggesting stabilization of the triphasic rhythm, and decreased the probability of most other atypical states (<xref ref-type="fig" rid="fig9">Figure 9b</xref>, <xref ref-type="table" rid="table3">Table 3</xref>, p&lt;0.004, paired permutation test). Consistent with earlier studies that reported that RPCH can activate rhythms in silent preparations (<xref ref-type="bibr" rid="bib71">Nusbaum and Marder, 1988</xref>), the probability of observing the silent state was driven to 0 in the presence of RPCH, together with other atypical states such as LP-silent and LP-silent-PD-bursting (<xref ref-type="fig" rid="fig9">Figure 9b</xref>).</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Probability distribution of states during modulator application, as shown in <xref ref-type="fig" rid="fig9">Figure 9</xref>.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">State</th><th align="left" valign="bottom">Decentralized</th><th align="left" valign="bottom">RPCH</th><th align="left" valign="bottom">Proctolin</th><th align="left" valign="bottom">Oxotremorine</th><th align="left" valign="bottom">Serotonin</th></tr></thead><tbody><tr><td align="left" valign="bottom">Regular</td><td align="char" char="." valign="bottom">0.39</td><td align="char" char="." valign="bottom">0.73</td><td align="left" valign="bottom">0.69</td><td align="left" valign="bottom">0.78</td><td align="left" valign="bottom">0.27</td></tr><tr><td align="left" valign="bottom">LP-silent</td><td align="char" char="." valign="bottom">0.06</td><td align="char" char="." valign="bottom">0</td><td align="left" valign="bottom">0.02</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0.07</td></tr><tr><td align="left" valign="bottom">LP-silent-PD-bursting</td><td align="char" char="." valign="bottom">0.09</td><td align="char" char="." valign="bottom">0</td><td align="left" valign="bottom">0.07</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0.1</td></tr><tr><td align="left" valign="bottom">PD-silent</td><td align="char" char="." valign="bottom">0.07</td><td align="char" char="." valign="bottom">0</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0.04</td></tr><tr><td align="left" valign="bottom">PD-silent-LP-bursting</td><td align="char" char="." valign="bottom">0.01</td><td align="char" char="." valign="bottom">0</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0.03</td></tr><tr><td align="left" valign="bottom">Aberrant-spikes</td><td align="char" char="." valign="bottom">0.01</td><td align="char" char="." valign="bottom">0.04</td><td align="left" valign="bottom">0.01</td><td align="left" valign="bottom">0.01</td><td align="left" valign="bottom">0.03</td></tr><tr><td align="left" valign="bottom">LP-weak-skipped</td><td align="char" char="." valign="bottom">0.14</td><td align="char" char="." valign="bottom">0.11</td><td align="left" valign="bottom">0.07</td><td align="left" valign="bottom">0.17</td><td align="left" valign="bottom">0.19</td></tr><tr><td align="left" valign="bottom">PD-weak-skipped</td><td align="char" char="." valign="bottom">0.02</td><td align="char" char="." valign="bottom">0.05</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0</td></tr><tr><td align="left" valign="bottom">Sparse-irregular</td><td align="char" char="." valign="bottom">0.03</td><td align="char" char="." valign="bottom">0</td><td align="left" valign="bottom">0.01</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0.02</td></tr><tr><td align="left" valign="bottom">Irregular</td><td align="char" char="." valign="bottom">0.02</td><td align="char" char="." valign="bottom">0.02</td><td align="left" valign="bottom">0.01</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0.07</td></tr><tr><td align="left" valign="bottom">Silent</td><td align="char" char="." valign="bottom">0.07</td><td align="char" char="." valign="bottom">0</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0.01</td></tr><tr><td align="left" valign="bottom">Irregular-bursting</td><td align="char" char="." valign="bottom">0.1</td><td align="char" char="." valign="bottom">0.04</td><td align="left" valign="bottom">0.11</td><td align="left" valign="bottom">0.03</td><td align="left" valign="bottom">0.17</td></tr></tbody></table><table-wrap-foot><fn><p>LP: lateral pyloric; PD: pyloric dilator.</p></fn></table-wrap-foot></table-wrap><p>Proctolin also targets a number of cells in the circuit (<xref ref-type="bibr" rid="bib93">Swensen and Marder, 2001</xref>) and strengthens the pyloric rhythm through various mechanisms: by increasing the amplitude of slow oscillations in AB and LP (<xref ref-type="bibr" rid="bib46">Hooper and Marder, 1987</xref>; <xref ref-type="bibr" rid="bib72">Nusbaum and Marder, 1989</xref>), depolarizing the LP neuron (<xref ref-type="bibr" rid="bib29">Golowasch and Marder, 1992</xref>; <xref ref-type="bibr" rid="bib101">Turrigiano and Marder, 1993</xref>), and increasing the number of spikes per burst in LP and PD (<xref ref-type="bibr" rid="bib46">Hooper and Marder, 1987</xref>; <xref ref-type="bibr" rid="bib60">Marder et al., 1986</xref>; <xref ref-type="bibr" rid="bib45">Hooper and Marder, 1984</xref>). Oxotremorine, a muscarinic agonist, has also been shown to enhance the robustness of the pyloric rhythm (<xref ref-type="bibr" rid="bib4">Bal et al., 1994</xref>; <xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>; <xref ref-type="bibr" rid="bib83">Rosenbaum and Marder, 2018</xref>). Similar to RPCH, both proctolin and oxotremorine significantly increase the probability of the regular state (<xref ref-type="fig" rid="fig9">Figure 9b</xref>, <xref ref-type="table" rid="table3">Table 3</xref>, p&lt;0.004, paired permutation test), and the regular state is the only one significantly more likely when the neuromodulator is added. The strengthening effects of RPCH and oxotremorine are also manifested in the significantly lower probabilities of observing atypical and dysfunctional states such as silent, LP-silent, PD-silent, and sparse-irregular (<xref ref-type="table" rid="table3">Table 3</xref>).</p><p>Serotonin can have variable effects on the pyloric circuit, varying from animal to animal, and can either speed up or slow down the rhythm (<xref ref-type="bibr" rid="bib5">Beltz et al., 1984</xref>; <xref ref-type="bibr" rid="bib90">Spitzer et al., 2008</xref>). In <italic>Panularis</italic>, serotonin depolarizes LP in culture, but hyperpolarizes LP in situ, unlike other neuromodulators that typically have the same effect in situ and in culture (<xref ref-type="bibr" rid="bib101">Turrigiano and Marder, 1993</xref>). Consistent with earlier work in <italic>C. borealis</italic> showing that serotonin destabilizes the rhythm in decentralized preparations (<xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>), we found that the probability of regular states was significantly lower on addition of serotonin (<xref ref-type="fig" rid="fig9">Figure 9b</xref>, <xref ref-type="table" rid="table3">Table 3</xref>, p&lt;0.004, paired permutation test), together with a significantly higher probability of atypical dysfunctional states such as LP-silent, aberrant-spikes, PD-silent-LP-bursting, and irregular, suggesting loss of coordination between the many neurons in the pyloric circuit with serotonin receptors (<xref ref-type="bibr" rid="bib13">Clark et al., 2004</xref>).</p><p>Do these modulators share common features in how they (de)stabilize the rhythm? We computed the probability distribution of states conditional on transitions to the regular state for RPCH, proctolin, and oxotremorine, and conditional on transitions from the regular state for serotonin (<xref ref-type="fig" rid="fig9">Figure 9c</xref>). For all four neuromodulators, the conditional state distribution predominantly comprised these three states: LP-weak-skipped, irregular-bursting, and aberrant-spikes, suggesting that trajectories of recovery or destabilization of the regular rhythm share common features. Serotonin destabilizes the rhythm, decreasing the likelihood of observing regular states, similar to environmental perturbations (<xref ref-type="fig" rid="fig5">Figure 5</xref>) and decentralization (<xref ref-type="fig" rid="fig7">Figure 7</xref>).</p><p>Different neuromodulators activate different forms of the rhythm (<xref ref-type="bibr" rid="bib61">Marder and Weimann, 1992</xref>; <xref ref-type="bibr" rid="bib59">Marder et al., 1985</xref>; <xref ref-type="bibr" rid="bib63">Marder, 2012</xref>), partly because different neuron types express different receptors to varying extents (<xref ref-type="bibr" rid="bib28">Garcia et al., 2015</xref>). Moreover, similar rhythmic motor patterns can be produced by qualitatively different mechanisms, such as one that depends on voltage-gated sodium channel activity, and one that can persist in their absence (<xref ref-type="bibr" rid="bib41">Harris-Warrick and Flamm, 1987</xref>; <xref ref-type="bibr" rid="bib25">Epstein and Marder, 1990</xref>; <xref ref-type="bibr" rid="bib83">Rosenbaum and Marder, 2018</xref>). To determine if different neuromodulators elicit regular rhythms that occupy different parts of the map, we plotted the location of data elicited by various neuromodulators in the full map (<xref ref-type="fig" rid="fig9s2">Figure 9—figure supplement 2</xref>). Regular data elicited by different neuromodulators tended to lie in clusters, whose distribution in the map was significantly different between serotonin and CCAP (Crustacean cardioactive peptide), and proctolin and every other neuromodulator tested (p&lt;0.05, two-dimensional Kolmogorov–Smirnov test, using the method of <xref ref-type="bibr" rid="bib76">Peacock, 1983</xref>). The differential clustering of regular states in the map with neuromodulator suggests that neuromodulators can elicit characteristic, distinct rhythms.</p></sec><sec id="s2-10"><title>Neuromodulators differentially affect transition between states</title><p>RPCH, proctolin, and oxotremorine activate a common voltage-dependent modulatory current, <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib93">Swensen and Marder, 2001</xref>), but can differentially affect neurons in the STG because different cell types express receptors to these modulators to different degrees. For example, RPCH activates <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> strongly in LP neurons, but the effects of oxotremorine and proctolin are more broadly observed in the circuit (<xref ref-type="bibr" rid="bib92">Swensen and Marder, 2000</xref>; <xref ref-type="bibr" rid="bib93">Swensen and Marder, 2001</xref>). Though these three modulators strengthen the slow-wave oscillations in pyloric neurons, only oscillations elicited by oxotremorine and RPCH persist in tetrodotoxin, and proctolin rhythms do not, hinting that qualitatively different mechanisms underlie the generation of these seemingly similar oscillations (<xref ref-type="bibr" rid="bib83">Rosenbaum and Marder, 2018</xref>). We therefore measured the transition rates between states during neuromodulator application to how similar or different trajectories towards recovery were.</p><p>In RPCH, proctolin, and oxotremorine application, ≈100 transitions were observed between states (<xref ref-type="fig" rid="fig10">Figure 10</xref>). Transitions could not always be predicted by a null model assuming that transition probabilities scaled with the conditional probability of observing states after a transition. For example, some transitions, such as the transition from irregular to regular, were never observed in RPCH, a significant deviation from the expected number of transitions given the likelihood of observing regular states after transitions (Materials and methods). Others, such as the transition LP-silent to LP-silent-PD-bursting in proctolin and oxotremorine, were observed at rates significantly higher than expected from the null model. Transitions into regular state are distributed across aberrant-spikes, LP-weak-skipped, and irregular-bursting states for all three, but no invariant feature emerges in the rest of the transition matrix.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Effect of red pigment-concentrating hormone (RPCH), proctolin, oxotremorine, and serotonin on transition probabilities.</title><p>Each matrix shows the conditional probability of observing the final state in the next time step given an observation of the initial state during bath application of that neuromodulator. Probabilities in each row sum to 1. Size of disc scales with probability. Discs with dark borders are transitions that are significantly more likely than the null model (Materials and methods). Dark solid discs are transitions with nonzero probability that are significantly less likely than in the null model. <inline-formula><mml:math id="inf69"><mml:mi mathvariant="normal">◇</mml:mi></mml:math></inline-formula> are transitions that are never observed and are significantly less likely than in the null model. States are ordered from regular to silent. Bar graphics show the coefficient of variability (CV) of pyloric dilator (PD) and lateral pyloric (LP) burst periods before transition away from regular states. <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> from Spearman rank correlation test. RPCH: <inline-formula><mml:math id="inf71"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">148</mml:mn></mml:mrow></mml:math></inline-formula> transitions in <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">33</mml:mn></mml:mrow></mml:math></inline-formula> animals; proctolin: <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">155</mml:mn></mml:mrow></mml:math></inline-formula> transitions in <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">59</mml:mn></mml:mrow></mml:math></inline-formula> animals; oxotremorine: <inline-formula><mml:math id="inf75"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">102</mml:mn></mml:mrow></mml:math></inline-formula> transitions in <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">21</mml:mn></mml:mrow></mml:math></inline-formula> animals; serotonin: <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">263</mml:mn></mml:mrow></mml:math></inline-formula> transitions in <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">23</mml:mn></mml:mrow></mml:math></inline-formula> animals. Bar graphs show the CV of burst periods of PD and LP vs. time before a transition away from regular states during serotonin application. <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> from Spearman rank correlation test.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-fig10-v2.tif"/></fig><p>Serotonin destabilizes the rhythm in decentralized preparations, and the transition matrix under serotonin reveals several features of the irregularity behavior observed under serotonin (<xref ref-type="fig" rid="fig10">Figure 10</xref>). A number of irregular and low-firing states from silent to irregular never transition into the regular state, which is unlikely in the null model (p&lt;0.05, Materials and methods). Transitions between pairs of states are symmetric and occur at rates significantly larger than in the null model, such as between LP-silent and LP-silent-PD-bursting. Intriguingly, destabilizing transitions from regular to LP-weak-skipped, aberrant-spikes, and irregular-bursting are observed at rates significantly higher than in the null model. These three abnormal states are also observed immediately preceding regular states in RPCH, proctolin, and oxotremorine (<xref ref-type="fig" rid="fig9">Figure 9c</xref>), suggesting that the mechanisms for both stabilization and destabilization of the rhythm share stereotyped trajectories.</p><p>Are transitions away from regular states also associated with increases in variability of burst periods? Similar to preparations in high <inline-formula><mml:math id="inf80"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and low pH, and when decentralized, transitions away from regular states in serotonin were associated with significantly rising variability in the burst periods of PD and LP neurons (<xref ref-type="fig" rid="fig10">Figure 10</xref>, p&lt;0.05, Spearman rank correlation test).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Advances in neural recording technology have made it possible to generate increasingly large datasets, and an ongoing challenge is in developing computational tools to find structure in the neural haystack (<xref ref-type="bibr" rid="bib74">Pachitariu et al., 2016</xref>). Nonlinear dimensionality reduction algorithms such as t-SNE can create a useful representation of datasets that are too large to visualize in their entirety using traditional methods. We combined domain-specific expert knowledge with an unsupervised dimensionality reduction process (t-SNE) by manually segmenting and labeling clusters of dynamics representing biologically significant behavior. This approach conferred two advantages: it allowed for a more accurate measure of traditional metrics such as burst phases in large datasets (<xref ref-type="fig" rid="fig4">Figures 4</xref> and <xref ref-type="fig" rid="fig8">8</xref>), and it allowed for the analysis of irregular dynamics that are typically intractable with conventional analysis methods (e.g., <xref ref-type="fig" rid="fig9">Figure 9</xref>), with the disadvantage of not being fully automated, and requiring human intervention to inspect data in the embedding and draw cluster boundaries. Our work hints at a possibility to characterize nonregular spike patterns in small neural circuits and can thus provide a deeper understanding of circuit activity under baseline conditions and in response to perturbations. Our approach makes limited assumptions of the dynamics of the circuit, yet provides a formal framework based on domain-specific knowledge for characterizing circuit activity. Additionally, this way of analyzing neural spike data can readily be adapted to other circuits and systems.</p><sec id="s3-1"><title>Reliable identification of regular rhythms allows for accurate, interpretable analysis of rhythm metrics</title><p>Characterizing the statistics of neural oscillations has several subtle challenges. For example, variations in cycle period arising from cycle-to-cycle fluctuations are not distinguished from those arising from alteration between epochs of regular oscillations interrupted by spans of irregular activity where metrics like cycle period are undefined. One way to disambiguate the two is to construct elaborate checks to make sure that the spike pattern being measured meets certain criteria. However, edge cases abound, and this is a challenging and subjective approach. A fortuitous consequence of the embedding method we used is to reliably identify when rhythms were regular, and we found that burst metrics were well defined for this subset of data (blue region in <xref ref-type="fig" rid="fig3">Figure 3</xref>). We were therefore able to measure the mean and variability of various burst metrics (<xref ref-type="fig" rid="fig4">Figure 4</xref>) only in stretches of data where it made sense to do so, and thus the measured variability stemmed almost entirely from cycle-to-cycle variations.</p><p>Consistent with previous studies (<xref ref-type="bibr" rid="bib9">Bucher et al., 2005</xref>; <xref ref-type="bibr" rid="bib39">Hamood and Marder, 2014</xref>; <xref ref-type="bibr" rid="bib40">Hamood et al., 2015</xref>), our results (<xref ref-type="fig" rid="fig4">Figure 4</xref>) show that within-animal variability in pyloric burst metrics is lower than across-animal variability. Our results are from an analysis of data from several experimenters from different laboratories, collected over a span of 10 years. It is therefore an ideal dataset in which to measure variability. We find that the CV of all burst metrics measured is <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4b</xref>), which can now be used as a standard for regular baseline pyloric oscillations. Measuring burst metrics on decentralization (<xref ref-type="fig" rid="fig8">Figure 8</xref>) also allowed us to characterize how regular rhythms change, while still being recognizably regular. In addition to recapitulating well-understood phenomena such as the slowing down and increased variability in rhythms, we found that the phase of LP burst onset did not change significantly, but the phase of LP burst termination did, suggesting that features of the rhythm are differentially robust to the removal of neuromodulation.</p><p>Earlier work categorized the varied dynamics of the pyloric circuit during perturbations (<xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>; <xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>; <xref ref-type="bibr" rid="bib81">Ratliff et al., 2021</xref>). In those studies, categories were typically constructed by hand and were not rigorously shown to be mutually exclusive. Categories in this work, while manually chosen, emerge naturally from the distribution of the data in the reduced space (<xref ref-type="fig" rid="fig3">Figure 3</xref>) and no segment of data can have more than one label because it can exist only at a single point in the map. For instance, earlier work categorized rhythms that were labeled regular into two categories, ‘normal triphasic’ and ‘normal triphasic slow’ (<xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>), while we did not observe a distinctly bimodal distribution of burst periods. In contrast, the catch-all ‘atypical firing’ state was separated here into a number of states (irregular, irregular-bursting, sparse-irregular) that span several well-separated clusters in the map (<xref ref-type="fig" rid="fig3">Figure 3</xref>). In summary, this work recapitulates every label constructed to categorize spike patterns from PD and LP neurons in earlier work, and additionally finds new spike patterns that were either not detected or not identified as distinct because they are hard to detect by manual inspection.</p></sec><sec id="s3-2"><title>Diversity and stereotypy in trajectories from functional to crash states</title><p>Are there preferred paths to go from regular rhythms to crash? Diversity in the solution space of functional circuits, and the varied effects of perturbations on these circuits, argues for an assortment of trajectories from functional dynamics to irregular or silent states. While transition matrices measured during different perturbations were varied (<xref ref-type="fig" rid="fig6">Figure 6</xref>), we did observe universal features in transition matrices measured during environmental perturbations, decentralization, and addition of neuromodulators (<xref ref-type="fig" rid="fig6">Figures 6</xref>, <xref ref-type="fig" rid="fig7">7</xref> and <xref ref-type="fig" rid="fig10">10</xref>). The destabilizing transition from regular → LP-weak-skipped was overrepresented in every transition matrix, suggesting that the weakening of the LP neuron is a crucial step in the trajectories towards destabilization, perhaps because there is only one copy of LP in the circuit. Earlier work studying trajectories of destabilization of regular bursting in the isolated pacemaker kernel also found a conserved motif in trajectories towards destabilization: from regular bursting to tonic spiking to silence in response to pH perturbations, and another conserved motif (bursting to weak bursting to silence) in response to temperature perturbations (<xref ref-type="bibr" rid="bib81">Ratliff et al., 2021</xref>). Transitions away from regular rhythms were also associated with increased variability in burst periods during all perturbations except high temperature and low pH (<xref ref-type="fig" rid="fig6">Figures 6</xref>, <xref ref-type="fig" rid="fig7">7</xref> and <xref ref-type="fig" rid="fig10">10</xref>). An increase in variability in PD voltage dynamics before transitions from regular bursting has been observed in the isolated pacemaker kernel (<xref ref-type="bibr" rid="bib81">Ratliff et al., 2021</xref>), similar to the effect we observed in the intact circuit.</p><p>The structure of the transitions between states also hints at features of the circuit that are critical for rhythm (de)stabilization. Unsurprisingly, PD-silent states precede silent states in low pH, high temperature, and high <inline-formula><mml:math id="inf82"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> perturbations (<xref ref-type="fig" rid="fig6">Figure 6</xref>). This makes sense because PD cells are electrically coupled to the endogenous burster AB in the pacemaker kernel, and silencing the pacemaker kernel can cause the circuit to go silent. Though the states are determined purely from clusters in the embedding (<xref ref-type="fig" rid="fig2">Figure 2</xref>), and thus from statistical features of spike times, some states may be identified predominantly with cell-specific features (e.g., LP-weak-skipped where the LP neuron fails to burst regularly, but the PD neurons continue to burst regularly), or with circuit-level features (e.g., aberrant-spikes where one or both neurons fire spikes outside the main burst, which may be caused by incomplete inhibition). Decentralization elicits the largest number of transition types, with <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>80</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> of all transition types observed, which could be a consequence of the complex change in the neuromodulator milieu following transection of descending nerves.</p></sec><sec id="s3-3"><title>Linking circuit output to circuit mechanisms</title><p>A large body of work has shown that there is more than one way to make a neural circuit with similar patterns of activity (<xref ref-type="bibr" rid="bib78">Prinz et al., 2003</xref>; <xref ref-type="bibr" rid="bib79">Prinz et al., 2004</xref>; <xref ref-type="bibr" rid="bib36">Gutierrez et al., 2013</xref>). Several combinations of circuit parameters such as synapse strengths, ion channel conductances, and network topology can be found in circuits that generate similar emergent collective dynamics (<xref ref-type="bibr" rid="bib32">Gonçalves et al., 2020</xref>). The dimensionality of the space of neuronal and synaptic parameters in a neural circuit is much larger than the dimensionality of the circuit output (<xref ref-type="bibr" rid="bib62">Marder and Bucher, 2007</xref>). This disparity in dimensionality leads to an inherently many-to-one mapping from the space of circuit architecture to the space of circuit dynamics. Circuits can therefore exhibit ‘cryptic’ architectural variability (<xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>), where the diversity of topologies and neuronal parameters is masked by the relatively low-dimensional nature of the observed circuit outputs. However, perturbations can reveal differences between seemingly identical circuits. For instance, current injections in an oscillator network can shift phases, thus revealing connection weights between individual neurons (<xref ref-type="bibr" rid="bib99">Timme, 2007</xref>). This work reveals a path towards analysis that can reveal cryptic variability and build mechanistic links from circuit architecture to function. By characterizing the totality of circuit dynamics under a variety of conditions, our framework provides a way to fit biophysically detailed models of the pyloric circuit to diverse circuit dynamics under baseline conditions and perturbations. From the large diversity of neuron and circuit parameters that can reproduce a snapshot of activity, only a subset of models could potentially recapitulate the diverse irregular behavior seen under extreme perturbations. Recent work that reproduced how circuits change cycle periods with temperature (<xref ref-type="bibr" rid="bib3">Alonso and Marder, 2020</xref>) can be extended to find parameter sets that also generate the irregular states characterized in this study at the rates observed in the data. Crucially, the characterization of the pyloric circuit dynamics in this work can be used to rule out models and parameter sets that generate irregular activity that is qualitatively dissimilar to any of the irregular states observed in the pyloric circuit. Future experimental work can pair data analysis methods such as this work with quantitative measurements of cellular and circuit parameters using emerging techniques (<xref ref-type="bibr" rid="bib86">Schulz et al., 2006</xref>; <xref ref-type="bibr" rid="bib87">Schulz et al., 2007</xref>; <xref ref-type="bibr" rid="bib100">Tobin et al., 2009</xref>) to find parameter sets that generate robust rhythms and irregular states.</p></sec><sec id="s3-4"><title>Applicability to other systems</title><p>The analysis method in this study is well-suited for large datasets of neural recordings from identified neurons. Data where the identity of each neuron is not or cannot be known, such as large-scale mammalian brain recordings, would require modifications to the analysis pipeline described in <xref ref-type="fig" rid="fig2">Figure 2</xref>. First, it would no longer be possible to construct a data vector of fixed length because ordering of the different neurons would not be meaningful. Each data point would instead be an unordered set of spike times from each neuron, and a distance function that operated on spike times (<xref ref-type="bibr" rid="bib12">Christen et al., 2006</xref>; <xref ref-type="bibr" rid="bib107">Victor and Purpura, 2009</xref>; <xref ref-type="bibr" rid="bib85">Schreiber et al., 2003</xref>; <xref ref-type="bibr" rid="bib105">van Rossum, 2001</xref>) could be used to generate a distance matrix between raw data points, which would be the input to the embedding algorithm. In our analysis, we included features such as the ‘spike phase’ (<xref ref-type="fig" rid="fig2">Figure 2b and c</xref>) because the neurons in this circuit interact with one another strongly in each cycle of oscillations. The analysis of neural circuits that do not show such strong intrinsically phase-controlled behavior could use other features more suitable to those systems.</p></sec><sec id="s3-5"><title>Comparison with other methods</title><p>Visualization and other forms of analysis of large neural datasets rely on dimensionality reduction (<xref ref-type="bibr" rid="bib70">Nguyen and Holmes, 2019</xref>). Here, we used the t-SNE algorithm as a core method to reduce the dimensionality of the dataset and visualize our data. t-SNE has been widely used in the unsupervised analysis of many types of biological data (<xref ref-type="bibr" rid="bib6">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib50">Kollmorgen et al., 2020</xref>; <xref ref-type="bibr" rid="bib11">Chen et al., 2021</xref>; <xref ref-type="bibr" rid="bib56">Macosko et al., 2015</xref>; <xref ref-type="bibr" rid="bib48">Kobak and Berens, 2019</xref>; <xref ref-type="bibr" rid="bib52">Leelatian et al., 2020</xref>), including neural recordings (<xref ref-type="bibr" rid="bib22">Dimitriadis et al., 2018</xref>). t-SNE is a technique that allows high-dimensional data to be visualized in a lower-dimensional space (<xref ref-type="bibr" rid="bib104">Van der Maaten and Hinton, 2008</xref>; <xref ref-type="bibr" rid="bib54">Linderman and Steinerberger, 2019</xref>), and works by preserving pairwise distances between points in the high-dimensional space and the low-dimensional embedding, within a certain neighborhood. This feature makes t-SNE an attractive tool to try to visualize large, structured datasets, such as those examined in this study, because it can demonstrate how similar spike patterns are to each other (<xref ref-type="bibr" rid="bib22">Dimitriadis et al., 2018</xref>). t-SNE has been shown rigorously to be capable of recovering well-separated data clusters (<xref ref-type="bibr" rid="bib54">Linderman and Steinerberger, 2019</xref>). In our application, t-SNE generated embeddings where spike patterns in different regions could be described as qualitatively different. For example, spike patterns in the top-most cluster (colored green in <xref ref-type="fig" rid="fig3">Figure 3</xref>) all had weak PD spiking, but regular and strong LP spiking. This was qualitatively different from the two closest clusters LP-weak-skipped and irregular. In regions of the map where clusters were not cleanly separated (e.g., in the connection between the regular and irregular-bursting clusters), manual inspection revealed a number of intermediate states. The clustered or not-clustered regions of the map are therefore informative of the underlying distribution of spike patterns and emerge robustly from the embedding.</p><p>t-SNE is widely used in the analysis and visualization of high-dimensional data, but is important to acknowledge its limitations. t-SNE can generate embeddings that appear to have clusters from purely randomly distributed data, can distort sizes of clusters, and can fail to preserve large-scale topological features of the data in some embeddings (<xref ref-type="bibr" rid="bib109">Wattenberg et al., 2016</xref>). The visualization we generated was useful in that it guided manual clustering and made feasible a previously intractable task, that of classifying hundreds of hours of spike patterns from hundreds of animals.</p><p>A variety of other dimensional reduction techniques, including multidimensional scaling (<xref ref-type="bibr" rid="bib17">Cox and Cox, 2008</xref>), convolutional non-negative matrix factorization (<xref ref-type="bibr" rid="bib55">Mackevicius et al., 2019</xref>) and their extensions (<xref ref-type="bibr" rid="bib111">Williams et al., 2020</xref>), tensor component analysis (<xref ref-type="bibr" rid="bib110">Williams et al., 2018</xref>), and dynamical component analysis (<xref ref-type="bibr" rid="bib14">Clark et al., 2019</xref>), have been developed that aid in visualizing and analysis of large neural datasets. Methods based on neural networks offer powerful tools to analyze unstructured neural data by modeling the data with a recurrent neural net and then analyzing that model (<xref ref-type="bibr" rid="bib108">Vyas et al., 2020</xref>). Topological autoencoders are one such technique that combine autoencoders with methods from topological data analysis to produce representation in lower-dimensional spaces (<xref ref-type="bibr" rid="bib69">Moor et al., 2019</xref>). These methods are similar in spirit to the analysis presented here, but use sophisticated neural nets whose parameters yield the lower-dimensional representation. Other analysis methods include SOM-VAE, which combines self-organizing maps (SOMs) and variational auto-encoders (VAEs) (<xref ref-type="bibr" rid="bib26">Fortuin et al., 2018</xref>) to analyze high-dimensional time series and find transitions between states, and deep temporal clustering, which combines dimensionality reduction and temporal clustering (<xref ref-type="bibr" rid="bib57">Madiraju et al., 2018</xref>).</p></sec><sec id="s3-6"><title>Technical considerations</title><p>In this study, we have used the activity of the LP and PD neurons as a proxy for the pyloric circuit. However, the pyloric circuit contains other neurons: AB (which is electrically coupled to PD neurons), PY neurons (which are anti-phase to both PD and LP), and VD and IC neurons. A richer description of the dynamics of the pyloric circuit would include spikes from these neurons, and the methods we have described here can be scaled up to include these neurons. It is likely that we are underestimating the number of states, and thus, transitions between states, because we do not have access to the dynamics of these neurons. Datasets that contain recordings from all pyloric neurons as preparations are subjected to the perturbations studied here and are not available for large numbers of animals. We therefore chose to focus on the functional antagonists LP and PD. Additionally, neurons in the pyloric circuit are coupled using graded synapses, and the circuit can generate coordinated activity even when spiking is abolished (<xref ref-type="bibr" rid="bib83">Rosenbaum and Marder, 2018</xref>), suggesting that subthreshold oscillations may be an important feature we are not measuring by only recording spikes. However, the data required necessitates substantially harder to perform experiments because intracellular electrodes must be used. Furthermore, the signal to the muscles – arguably the physiologically and functionally relevant signal – is the spike signal, suggesting that spike patterns from the pyloric circuit are a useful feature to measure.</p><p>The unit of data we operated on was a time series of spikes from the LP and PD neurons. In order to describe what the dynamics of these neurons is at a given point in time, we chose to look at a neighborhood in time. In this article, we chose 20 s nonoverlapping bins, based on inspection of the data by eye. Choosing a time bin imposes certain tradeoffs in the analysis of time series: changes in dynamics on timescales smaller than the bin are counted as different states, and changes in dynamics on timescales longer than the bin size are counted as transitions between states. The statistics of the transitions we measure are therefore dependent on the bin size we chose. We note that dwell times in each state are almost always in excess of null model predictions generated by shuffling states (transition matrices in <xref ref-type="fig" rid="fig6">Figures 6</xref>, <xref ref-type="fig" rid="fig7">7</xref> and <xref ref-type="fig" rid="fig10">10</xref>), supporting the validity of our choice of 20 s bins.</p></sec><sec id="s3-7"><title>Conclusion and outlook</title><p>Our work provides a way to characterize nonregular spike patterns in small neural circuits. It thus provides a bridge between experimental or simulation work grounded in the biophysical detail of ion channels and synaptic currents; and the rich body of observations of circuits under baseline and perturbed conditions. The methods we have employed can easily be adapted to other circuits and systems, make limited assumptions of the dynamics of the circuit, yet provide a robust framework on which to hang a large volume of previously ineffable expert domain knowledge.</p><p>Prior to this work, crashes in the pyloric circuit and irregular dynamics in a normally regular circuit were difficult to characterize. We present a method to tame the complexity of the distribution of irregular states by exploiting the fact that pyloric dynamics are not unbounded even in their irregularity. By using a t-SNE in conjunction with manual inspection of reduced data and manual clustering, we have made this previously intractable problem feasible and found undiscovered spike patterns and transitions. Our approach was successful because we used a dataset with long recordings from identified neurons in a circuit that can be subjected to many different perturbations, which is one of the advantages of using the STG system. It will be interesting to see if this can be applied to other systems with identified neurons in a functional circuit to characterize their function and failure modes.</p><p>In intact pyloric circuits, and in the presence of modulatory input from the <italic>stn</italic>, almost all networks are ‘normal’ and exhibit regular rhythms. Decentralization can generate more variable dynamics, presumably because the underlying differences in network structure that were compensated by modulator action now manifest as different collective dynamics in the network. Although it may appear that modulators can have similar effects when added to a decentralized network, they are in fact distinguishable when looking at how they influence the totality of circuit dynamics, not just the regular state.</p><p>A major unanswered question was whether crashes triggered by different perturbations share dynamical mechanisms and common pathways. Earlier work looking at a simpler subset of the pyloric circuit argued that different perturbations led to stereotyped but diverse transitions before crash, and we have extended this result in the intact circuit. We show that different perturbations can have different trajectories to crash, but the stereotypy observed in the simpler system was not observed, presumably due to the larger number of pathways accessible to the intact circuit. The new insight from this work stems from the fact that this is the first time transitions through multiple physiological conditions in so many modalities have been characterized and shows that there are many paths through possible circuit dynamical states from canonical states to crash. Several studies focus on one perturbation at a time. By studying a number of perturbations together, we compare responses to different kinds of perturbations on the same physiological network.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Animals and experimental methods</title><p>Adult male Jonah crabs (<italic>C. borealis</italic>) were obtained from Commercial Lobster (Boston, MA), Seabra’s Market (Newark, NJ), and Garden Farm Market (Newark, NJ). Dissections were carried out as previously described (<xref ref-type="bibr" rid="bib35">Gutierrez and Grashow, 2009</xref>). Decentralization was carried out either by cutting the <italic>stn</italic> or by additionally constructing a well on the <italic>stn</italic> and adding sucrose and TTX (tetrodotoxin) as described in <xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>. Temperature was controlled as described in <xref ref-type="bibr" rid="bib94">Tang et al., 2010</xref>; <xref ref-type="bibr" rid="bib95">Tang et al., 2012</xref>; <xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>. Extracellular potassium concentrations were varied as described in <xref ref-type="bibr" rid="bib44">He et al., 2020</xref>. pH perturbations are described in <xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>.</p></sec><sec id="s4-2"><title>Data selection and curation</title><p>Our goal was to include as much data as possible to create as complete a description of pyloric dynamics as possible. Following our strategy of including only the LP and PD neurons, we used every available dataset that recorded from these neurons from the Marder lab. We also included available datasets from the Nadim and Bucher labs. No dataset was explicitly excluded for reasons linked to the activity of the pyloric circuit in those datasets. Data where crucial metadata was not recorded (e.g., if the temperature of the preparation was not recorded) was excluded. Data where only <italic>lvn</italic> was recorded from was only included in cases of exceptional data quality, where it was judged that PD and LP could be reliably identified.</p></sec><sec id="s4-3"><title>Spike identification and sorting</title><p>Spikes are identified from extracellular recordings of motor nerves or from intracellular recordings. LP spikes were identified from intracellular recordings, <italic>lvn</italic>, <italic>lpn,</italic> and <italic>gpn</italic> nerves (in descending order of likelihood). PD spikes were identified from <italic>pdn</italic>, intracellular recordings, and <italic>lvn</italic>. We used a custom-designed spike identification and sorting software (called ‘crabsort’) that we have made freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sg-s/crabsort">https://github.com/sg-s/crabsort</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:b22b2c2456d851ffad732d42288db699d660fa7b;origin=https://github.com/sg-s/crabsort;visit=swh:1:snp:da7045d992613143c796feabea2668445c8a3e6b;anchor=swh:1:rev:6a67e765e90caa536e6a11f67d9d4737d059af50">swh:1:rev:6a67e765e90caa536e6a11f67d9d4737d059af50</ext-link>; <xref ref-type="bibr" rid="bib34">Gorur-Shandilya, 2021</xref>), previously described in <xref ref-type="bibr" rid="bib77">Powell et al., 2021</xref>. Spikes are identified using a fully connected neural network that learns spike shapes from small labeled datasets. A new network is typically initialized for every preparation. Predictions from the neural network also indicate the confidence of the network in these predictions, and uncertain predictions are inspected and labeled and the neural network learns from these using an active learning framework (<xref ref-type="bibr" rid="bib88">Settles, 2009</xref>).</p></sec><sec id="s4-4"><title>Data curation and data model</title><p>Each file was split into 20 s nonoverlapping bins, and spike times, together with metadata, were assembled into a single immutable instance of a custom-built class (embedding.DataStore). The data store had the following attributes:</p><list list-type="bullet"><list-item><p><italic>Spike times</italic> containing LP and PD spike times.</p></list-item><list-item><p><italic>ISIs</italic> containing ISIs and spike phases</p></list-item><list-item><p><italic>Labels</italic> categorical data containing manually generated labels from <xref ref-type="fig" rid="fig3">Figure 3</xref></p></list-item><list-item><p><italic>Metadata</italic> such as concentration of modulators, pH, temperature, whether the preparation was decentralized or not, etc.</p></list-item></list><p>Using an immutable data structure, reduced risks of accidental data alteration during analysis. Every attribute was defined for every data point.</p></sec><sec id="s4-5"><title>Embedding</title><sec id="s4-5-1"><title>ISI and phase representation (<xref ref-type="fig" rid="fig2">Figure 2b</xref>)</title><p>Each data point is a 20 s bin containing spike times from LP and PD neurons (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). For each data point, spike times are converted into ISIs. A set of spike times uniquely identifies a set of (ordered) ISIs. The set of LP spike times generates a set of LP ISIs, and the set of PD spike times generates a set of PD ISIs (<xref ref-type="fig" rid="fig2">Figure 2b</xref>).</p><p>For every spike in PD or LP, a ‘spike phase’ can be calculated as follows. Spike phases are not defined when either LP or PD are silent in that data point, or for LP/PD spikes with no spikes from the other neuron before or after that spike. Thus, the ‘spike phase’ of the <italic>i</italic>th spike on neuron X w.r.t. neuron Y is given by<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>X</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>-</mml:mo></mml:mrow><mml:mi>Y</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo></mml:mrow><mml:mi>Y</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>-</mml:mo></mml:mrow><mml:mi>Y</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf84"><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>X</mml:mi></mml:msubsup></mml:math></inline-formula> is the time of the <italic>i</italic>th spike on neuron <inline-formula><mml:math id="inf85"><mml:mi>X</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf86"><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>-</mml:mo></mml:mrow><mml:mi>Y</mml:mi></mml:msubsup></mml:math></inline-formula> is the time of the last spike on <inline-formula><mml:math id="inf87"><mml:mi>Y</mml:mi></mml:math></inline-formula> before <inline-formula><mml:math id="inf88"><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>X</mml:mi></mml:msubsup></mml:math></inline-formula>, and <inline-formula><mml:math id="inf89"><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo></mml:mrow><mml:mi>Y</mml:mi></mml:msubsup></mml:math></inline-formula> is the time of the first spike after <inline-formula><mml:math id="inf90"><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>X</mml:mi></mml:msubsup></mml:math></inline-formula>. Note that this definition can be generalized to <inline-formula><mml:math id="inf91"><mml:mi>N</mml:mi></mml:math></inline-formula> neurons, though the number of spike phases grows combinatorially with <inline-formula><mml:math id="inf92"><mml:mi>N</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s4-5-2"><title>Construction of vectorized data frame (<xref ref-type="fig" rid="fig2">Figure 2c and d</xref>)</title><p>Each data point can contain an arbitrary number of spikes, and thus an arbitrary number of ISIs and spike phases. Ideally, each data point is a data frame of fixed length (a point in some fixed high-dimensional space). To do so, we computed percentiles ISIs and spike phases (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). We chose 10 bins per ISI type (deciles). The end result is not strongly dependent on the number of bins chosen as long as there are sufficiently many bins to capture the distinctly bimodal distribution in ISIs during bursting.</p><p>We included four other features to help separate spike patterns that appeared qualitatively different. First, firing rates of LP and PD neurons. Second, the ratios of second-order to first-order ISIs, defined as<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mfrac><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the nth order set of ISIs computed as the time between n spikes. <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the simple set of ISIs defined between subsequent spikes. This measure is included because it captures the difference between single spike bursts and normal bursts well. Third, the ratio between the largest and second-largest ISIs for each neuron.</p><p>Finally, we also included a metric defined as follows:<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mfrac><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is a vector of sorted ISIs, and <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the sorted ISI for which the difference between it and the previous sorted ISI is maximum. This metric was included as it captures to a first approximation how ‘burst-like’ a spike train is. Intuitively, this metric is high for spike trains with bimodal ISI distributions, as is the case during bursts.</p><p>All these features were combined into a single data frame and <inline-formula><mml:math id="inf97"><mml:mi>z</mml:mi></mml:math></inline-formula>-scored (<xref ref-type="fig" rid="fig2">Figure 2d</xref>).</p><p>In some cases, these features were not defined, for example, when there are no spikes on either neuron, the concepts of spike phases or ISIs are meaningless. In these cases, ‘filler’ values were used that were located well off the extremes of the distribution of the metric when defined. For example, ISIs were filled with values of 20 s (the size of the bin) when no spikes were observed. The overall results and shape of the embedding did not depend sensitively on the value of the filler values used.</p><p>These features were chosen to capture various modes of spiking and bursting that have been previously identified by manual inspection (<xref ref-type="bibr" rid="bib37">Haddad and Marder, 2018</xref>; <xref ref-type="bibr" rid="bib95">Tang et al., 2012</xref>; <xref ref-type="bibr" rid="bib38">Haley et al., 2018</xref>). Other features may be more appropriate in other systems where spike patterns span different axes of variability. However, we note that these features while being appropriate for this data were not ‘fine-tuned’ to specialize in features that are exclusively found in spike patterns from the pyloric circuit. For example, these features do not explicitly measure bursting, the dominant feature of the pyloric rhythm, but instead use distributions of ISIs that are sufficiently descriptive to capture the variability in bursting and transitions from bursting to other spiking.</p></sec><sec id="s4-5-3"><title>Embedding using t-SNE</title><p>So far, we have described how we converted a 20 s snippet containing spike times from LP and PD into a data frame (a vector). We did this for every 20 s snippet in the dataset. Data that did not fit into any bin was discarded (e.g., data at the trailing end of an experiment shorter than 20 s). Thus, our entire dataset is represented by <inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> matrix, where <inline-formula><mml:math id="inf99"><mml:mi>M</mml:mi></mml:math></inline-formula> is the number of features in the data frame and <inline-formula><mml:math id="inf100"><mml:mi>N</mml:mi></mml:math></inline-formula> is the number of data points.</p><p>We used the t-SNE algorithm (<xref ref-type="bibr" rid="bib104">Van der Maaten and Hinton, 2008</xref>) to visualize the vectorized data matrix in two dimensions. Our dataset contained <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> points and was therefore too large for easy use of the original t-SNE algorithm. We used the FI-t-SNE approximate algorithm (<xref ref-type="bibr" rid="bib53">Linderman et al., 2019</xref>) to generate these embeddings. We used a perplexity of <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> to generate these embeddings. Varying perplexity caused the embedding to change in ways consistent with what is expected for t-SNE embeddings, and the coarse features of the embedding did not sensitively depend on this choice of perplexity (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). t-SNE is often used with random initialization, and different random initializations can lead to different embeddings with clusters located at different positions in the map. The importance of meaningful initializations has recently been highlighted (<xref ref-type="bibr" rid="bib49">Kobak and Linderman, 2021</xref>), and we used a fixed initialization where the x-axis corresponded to the shortest ISI in each data point and the y-axis corresponded to the maximum ratio of second-order to first-order ISI ratios (described above). For completeness, we also generated embeddings using other initializations (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). For both random initializations (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2a–d</xref>) and initializations based on ISIs (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2e and f</xref>), we observed that regular states tended to occur in a single region, surrounded by clusters that were dominated by a single color corresponding to irregular states. Thus, the precise location of different clusters can vary with the initialization, but the overall structure of the embedding, and the identity of points that tend to co-occur in a cluster, does not vary substantially with initialization.</p></sec></sec><sec id="s4-6"><title>Manual clustering and annotation of data</title><p>Once the feature vectors were embedded using t-SNE, we manually inspected these points to get a sense of the spike patterns in each point cloud. To do so, we built an interactive tool that visualized spike patterns that corresponded to each point when clicked on. Random points within regions of high density were sampled to check that interior points had similar spike patterns. Points were assigned labels by drawing boundaries around them and labeling all points within that boundary. Finally, we generated plots of ISIs and rasters from points in clusters to ensure that patterns of spiking were visually similar.</p><sec id="s4-6-1"><title>Triangulation and triadic differences (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>)</title><p>The output of the embedding algorithm is a set of points in two dimensions. We built a Delaunay triangulation on these points. For each triangle in the triangulation, we computed the maximum difference between some burst metric (e.g., burst period of PD neurons) across the three vertices of that triangle. These triadic differences are represented colored dots, where the dots are located at the incenters of each triangle in the triangulation.</p></sec></sec><sec id="s4-7"><title>Time-series analysis</title><sec id="s4-7-1"><title>Measuring burst metrics (<xref ref-type="fig" rid="fig4">Figure 4</xref>)</title><p>Burst metrics were measured following previous definitions (<xref ref-type="bibr" rid="bib79">Prinz et al., 2004</xref>; <xref ref-type="bibr" rid="bib9">Bucher et al., 2005</xref>). Briefly, bursts were identified by observing that ISI distributions were bimodal, with smaller ISIs corresponding to ISIs within a burst, and longer ISIs corresponding to inter-burst intervals. This allowed us to threshold ISIs, and this identifies burst starts and burst ends. From here, burst periods could be calculated, which allowed us to measure phases and delays relative to the start of the PD burst.</p></sec><sec id="s4-7-2"><title>Measuring transition matrices (<xref ref-type="fig" rid="fig6">Figures 6</xref>, <xref ref-type="fig" rid="fig7">7</xref> and <xref ref-type="fig" rid="fig10">10</xref>)</title><p>The transition matrix is a square matrix of size <inline-formula><mml:math id="inf103"><mml:mi>N</mml:mi></mml:math></inline-formula> that describes the probability of transitioning from one to another of <inline-formula><mml:math id="inf104"><mml:mi>N</mml:mi></mml:math></inline-formula> possible states. The transition matrix we report is the right stochastic matrix, where rows sum to 1. Each element of the matrix <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> corresponds to the conditional probability that we observe state <inline-formula><mml:math id="inf106"><mml:mi>j</mml:mi></mml:math></inline-formula> given state <inline-formula><mml:math id="inf107"><mml:mi>i</mml:mi></mml:math></inline-formula>. To compute this, we iterate over the sequence of states and compare the current state to the state in the next state. Breakpoints in the sequence are identified by discontinuities in the timestamps of that sequence and are ignored. We then zeroed the diagonal of the matrix and normalized each row by the sum.</p></sec><sec id="s4-7-3"><title>Measuring variability before transitions away from regular states (<xref ref-type="fig" rid="fig6">Figures 6</xref> and <xref ref-type="fig" rid="fig7">7</xref>)</title><p>We first identified continuous segments that corresponded to uninterrupted recordings from the same preparation at the appropriate condition. For each segment, we found all transitions away from the regular state. We therefore computed a vector as long as the segment containing the time to the next transition. We then collected points corresponding to time to next transition ranging from <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>200</mml:mn><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. For each time bin, we measured the CV of the burst period by dividing the standard deviation of the burst period in that datum by the mean in that datum.</p></sec></sec><sec id="s4-8"><title>Data visualization</title><sec id="s4-8-1"><title>Raincloud plots (<xref ref-type="fig" rid="fig4">Figure 4</xref>)</title><p>Raincloud plots (<xref ref-type="bibr" rid="bib1">Allen et al., 2019</xref>) are used to visualize a univariate distribution. Individual points are plotted as dots, and a shaded region indicates the overall shape of the distribution. This shape is obtained by estimating a kernel smoothing function estimate over the data. Individual points are randomly jittered along the vertical axis for visibility.</p></sec><sec id="s4-8-2"><title>Occupancy maps (<xref ref-type="fig" rid="fig5">Figures 5</xref> and <xref ref-type="fig" rid="fig7">7</xref>)</title><p>To visualize where in the map data from a certain condition occurred, the full embedding is first plotted with colors corresponding to the state each point belongs to. The full dataset is made semi-transparent and plotted with larger dots to emphasize the data of interest. Data in the condition of interest is then plotted as usual. Each bright point in these plots corresponds to a 20 s snippet of data in the condition indicated.</p></sec><sec id="s4-8-3"><title>Treemaps (<xref ref-type="fig" rid="fig7">Figures 7</xref> and <xref ref-type="fig" rid="fig9">9</xref>)</title><p>Treemaps (<xref ref-type="bibr" rid="bib89">Shneiderman and Wattenberg, 2001</xref>) were used to visualize state probabilities in a given experimental condition. For each preparation, the probability of each state was computed, and the mean probability of a given state was computed by averaging across all preparations. Thus, each preparation contributes equally. The area of the region in the treemap scales with the probability of that state.</p></sec><sec id="s4-8-4"><title>Transition matrices (<xref ref-type="fig" rid="fig6">Figures 6</xref>, <xref ref-type="fig" rid="fig7">7</xref> and <xref ref-type="fig" rid="fig10">10</xref>)</title><p>Transition matrices were visualized as in <xref ref-type="bibr" rid="bib16">Corver et al., 2021</xref>. Initial states are shown along the left edge, and final states are shown along the bottom edge of each matrix. Lines are colored by origin (horizontal lines) or destination (vertical) states. The size of each disc at the intersection of each line scales with the conditional probability of moving from the initial state to the final state. Note that the size of all discs is offset by a constant to make small discs visible.</p></sec></sec><sec id="s4-9"><title>Statistics</title><sec id="s4-9-1"><title>Comparing within-group to across-group variability (<xref ref-type="fig" rid="fig4">Figure 4</xref>)</title><p>To compare the variability of various burst metrics within each animal and across animals, we first measured the means and CVs of each burst metrics in every animal. We then used the mean of the coefficients of variations as a proxy for the within-animal variability and used the CV of the means as a proxy for the across-animal variability. Note that both measures are dimensionless. They can therefore be directly compared.</p><p>To test if the within-animal variability was significantly less than the across-animal variability, we performed a permutation test. We shuffled the labels identifying the animal to which each data point belonged to and measured a new ‘within-animal’ and ‘across-animal’ variability measure using these shuffled labels. We repeated this process 1000 times to obtain a null distribution of differences between within- and across-animal variability. Identifying where in the null distribution the data occurred allowed us to estimate a p-value for the measured difference. For example, if the measured difference between within- and across-animal variability in metric X was greater than 99% of the null distribution obtained by shuffling labels, we conclude that the p-value is 0.01. The significance level of 0.05 was divided by the number of burst metrics we tested to determine if any one metric was significantly more or less variable across animals.</p></sec><sec id="s4-9-2"><title>Measuring trends in variability in regular rhythms before transitions (<xref ref-type="fig" rid="fig6">Figures 6b</xref>, <xref ref-type="fig" rid="fig7">7f</xref> and <xref ref-type="fig" rid="fig9">9d</xref>)</title><p>To determine if variability significantly increased in the 200 s preceding a transition away from regular, we measured the Spearman rank correlation between time before transition (x-axis) and mean variability. The Spearman rank correlation <inline-formula><mml:math id="inf110"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is 1 if quantities monotonically increase.</p></sec><sec id="s4-9-3"><title>Measuring transition rate significance (<xref ref-type="fig" rid="fig6">Figures 6a</xref>, <xref ref-type="fig" rid="fig7">7e</xref> and <xref ref-type="fig" rid="fig10">10</xref>)</title><p>In the empirical transition matrices, certain transitions never occur, and certain transitions occur with relatively high probability. Each element of the transition matrix <inline-formula><mml:math id="inf111"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> corresponds to the conditional probability <inline-formula><mml:math id="inf112"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext mathvariant="normal">final</mml:mtext><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mtext mathvariant="normal">initial</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Our null model assumes that transitions occur at random between states, and therefore the probability of observing any transition <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> scales with the marginal probability of observing state <inline-formula><mml:math id="inf114"><mml:mi>j</mml:mi></mml:math></inline-formula> after transitions. We therefore built a null distribution of transition rates by sampling with replacement from the marginal counts of states after transitions. The fraction of this null distribution that was above or below the empirical transition rate was interpreted to be the p-value and thus determined significance.</p></sec></sec><sec id="s4-10"><title>Code availability</title><p><xref ref-type="table" rid="table4">Table 4</xref> lists the code used in this article. The code can be downloaded by prefixing <ext-link ext-link-type="uri" xlink:href="https://github.com/">https://github.com/</ext-link> to the project name.</p><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title>Code availability.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Project</th><th align="left" valign="bottom">Notes</th></tr></thead><tbody><tr><td align="left" valign="bottom">sg-s/crabsort</td><td align="left" valign="bottom">Interactive toolbox to sort spikes from extracellular data</td></tr><tr><td align="left" valign="bottom">sg-s/stg-embedding</td><td align="left" valign="bottom">Contains all scripts used to generate every figure in this article</td></tr><tr><td align="left" valign="bottom">KlugerLab/FIt-SNE</td><td align="left" valign="bottom">Fast interpolation-based <italic>t</italic>-distributed stochastic neighbor embedding, used to make embedding</td></tr><tr><td align="left" valign="bottom">sg-s/SeaSurfaceTemperature</td><td align="left" valign="bottom">Wrapper to scrape NOAA databases</td></tr></tbody></table></table-wrap></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Investigation, Methodology, Software, Validation, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Investigation, Methodology, Resources, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Investigation, Methodology</p></fn><fn fn-type="con" id="con6"><p>Project administration, Software, Supervision, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Project administration, Supervision, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Funding acquisition, Project administration, Supervision, Writing – original draft, Writing – review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-76579-transrepform1-v2.pdf"/></supplementary-material><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Interactive visualization of pyloric dynamics.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-76579-supp1-v2.zip"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data needed to reproduce figures in this paper are available at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/5090130">https://zenodo.org/record/5090130</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><collab>Srinivas Gorur-Shandilya Brandeis University ; Elizabeth M Cronin; Anna C. Schneider; Sara Ann Haddad; Philipp Rosenbaum; Dirk Bucher; Farzan Nadim; Eve Marder</collab></person-group><year iso-8601-date="2021">2021</year><data-title>Mapping circuit dynamics during function and dysfunction</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.5090130</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This article includes data collected by Lamont Tang, Lily He, Mara Rue, Jessica Haley, Daniel Powell, Anatoly Rinberg, and Ekaterina Morozova. We gratefully acknowledge helpful conversations with Paul Miller, Mark Zielinksi, Sriram Sampath, and Alec Hoyland. This work was funded by NIH grants T32 NS007292 (SGS) and R35 NS097343 (EM and SGS), NIH MH060605 (FN and DB), and DFG SCHN 1594/1-1 (ACS).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>M</given-names></name><name><surname>Poggiali</surname><given-names>D</given-names></name><name><surname>Whitaker</surname><given-names>K</given-names></name><name><surname>Marshall</surname><given-names>TR</given-names></name><name><surname>Kievit</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Raincloud plots: a multi-platform tool for robust data visualization</article-title><source>Wellcome Open Research</source><volume>4</volume><elocation-id>63</elocation-id><pub-id pub-id-type="doi">10.12688/wellcomeopenres.15191.1</pub-id><pub-id pub-id-type="pmid">31069261</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alonso</surname><given-names>LM</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Visualization of currents in neural models with similar behavior and different conductance densities</article-title><source>eLife</source><volume>8</volume><elocation-id>e42722</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.42722</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alonso</surname><given-names>LM</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Temperature compensation in a small rhythmic circuit</article-title><source>eLife</source><volume>9</volume><elocation-id>e55470</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.55470</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bal</surname><given-names>T</given-names></name><name><surname>Nagy</surname><given-names>F</given-names></name><name><surname>Moulins</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Muscarinic modulation of a pattern-generating network: control of neuronal properties</article-title><source>The Journal of Neuroscience</source><volume>14</volume><fpage>3019</fpage><lpage>3035</lpage><pub-id pub-id-type="pmid">8182456</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beltz</surname><given-names>B</given-names></name><name><surname>Eisen</surname><given-names>JS</given-names></name><name><surname>Flamm</surname><given-names>R</given-names></name><name><surname>Harris-Warrick</surname><given-names>RM</given-names></name><name><surname>Hooper</surname><given-names>SL</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Serotonergic innervation and modulation of the stomatogastric ganglion of three decapod crustaceans (Panulirus interruptus, Homarus americanus and Cancer irroratus)</article-title><source>The Journal of Experimental Biology</source><volume>109</volume><fpage>35</fpage><lpage>54</lpage><pub-id pub-id-type="doi">10.1242/jeb.109.1.35</pub-id><pub-id pub-id-type="pmid">6376680</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>GJ</given-names></name><name><surname>Choi</surname><given-names>DM</given-names></name><name><surname>Bialek</surname><given-names>WS</given-names></name><name><surname>Shaevitz</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mapping the stereotyped behaviour of freely moving fruit flies</article-title><source>Journal of the Royal Society, Interface</source><volume>11</volume><elocation-id>20140672</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2014.0672</pub-id><pub-id pub-id-type="pmid">25142523</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Börner</surname><given-names>K</given-names></name><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Boyack</surname><given-names>KW</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Visualizing knowledge domains</article-title><source>Annual Review of Information Science and Technology</source><volume>37</volume><fpage>179</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1002/aris.1440370106</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunel</surname><given-names>N</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>What determines the frequency of fast network oscillations with irregular neural discharges? i. synaptic dynamics and excitation-inhibition balance</article-title><source>Journal of Neurophysiology</source><volume>90</volume><fpage>415</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1152/jn.01095.2002</pub-id><pub-id pub-id-type="pmid">12611969</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bucher</surname><given-names>D</given-names></name><name><surname>Prinz</surname><given-names>AA</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Animal-to-animal variability in motor pattern production in adults and during growth</article-title><source>The Journal of Neuroscience</source><volume>25</volume><fpage>1611</fpage><lpage>1619</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3679-04.2005</pub-id><pub-id pub-id-type="pmid">15716396</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caplan</surname><given-names>JS</given-names></name><name><surname>Williams</surname><given-names>AH</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Many Parameter Sets in a Multicompartment Model Oscillator Are Robust to Temperature Perturbations</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>4963</fpage><lpage>4975</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0280-14.2014</pub-id><pub-id pub-id-type="pmid">24695714</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Bi</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>V</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Choi</surname><given-names>H</given-names></name><name><surname>Ernest</surname><given-names>B</given-names></name><name><surname>Tran</surname><given-names>B</given-names></name><name><surname>Mehta</surname><given-names>M</given-names></name><name><surname>Kumar</surname><given-names>P</given-names></name><name><surname>Farmer</surname><given-names>A</given-names></name><name><surname>Mir</surname><given-names>A</given-names></name><name><surname>Mehra</surname><given-names>UA</given-names></name><name><surname>Li</surname><given-names>JL</given-names></name><name><surname>Moos</surname><given-names>M</given-names></name><name><surname>Xiao</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A multicenter study benchmarking single-cell RNA sequencing technologies using reference samples</article-title><source>Nature Biotechnology</source><volume>39</volume><fpage>1103</fpage><lpage>1114</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-00748-9</pub-id><pub-id pub-id-type="pmid">33349700</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christen</surname><given-names>M</given-names></name><name><surname>Kohn</surname><given-names>A</given-names></name><name><surname>Ott</surname><given-names>T</given-names></name><name><surname>Stoop</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Measuring spike pattern reliability with the lempel–ziv-distance</article-title><source>Journal of Neuroscience Methods</source><volume>156</volume><fpage>342</fpage><lpage>350</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2006.02.023</pub-id><pub-id pub-id-type="pmid">16584787</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>MC</given-names></name><name><surname>Dever</surname><given-names>TE</given-names></name><name><surname>Dever</surname><given-names>JJ</given-names></name><name><surname>Xu</surname><given-names>P</given-names></name><name><surname>Rehder</surname><given-names>V</given-names></name><name><surname>Sosa</surname><given-names>MA</given-names></name><name><surname>Baro</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Arthropod 5-HT2 Receptors: A Neurohormonal Receptor in Decapod Crustaceans That Displays Agonist Independent Activity Resulting from an Evolutionary Alteration to the DRY Motif</article-title><source>The Journal of Neuroscience</source><volume>24</volume><fpage>3421</fpage><lpage>3435</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0062-04.2004</pub-id><pub-id pub-id-type="pmid">15056722</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>DG</given-names></name><name><surname>Livezey</surname><given-names>JA</given-names></name><name><surname>Bouchard</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Unsupervised Discovery of Temporal Structure in Noisy Data with Dynamical Components Analysis</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1905.09944">https://arxiv.org/abs/1905.09944</ext-link></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clemens</surname><given-names>S</given-names></name><name><surname>Massabuau</surname><given-names>JC</given-names></name><name><surname>Meyrand</surname><given-names>P</given-names></name><name><surname>Simmers</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>A modulatory role for oxygen in shaping rhythmic motor output patterns of neuronal networks</article-title><source>Respiration Physiology</source><volume>128</volume><fpage>299</fpage><lpage>315</lpage><pub-id pub-id-type="doi">10.1016/s0034-5687(01)00308-5</pub-id><pub-id pub-id-type="pmid">11718760</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corver</surname><given-names>A</given-names></name><name><surname>Wilkerson</surname><given-names>N</given-names></name><name><surname>Miller</surname><given-names>J</given-names></name><name><surname>Gordus</surname><given-names>AG</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Distinct movement patterns generate stages of spider web-building</article-title><source>Current Biology</source><volume>31</volume><fpage>4983</fpage><lpage>4997</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2021.09.030</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cox</surname><given-names>MA</given-names></name><name><surname>Cox</surname><given-names>TF</given-names></name></person-group><year iso-8601-date="2008">2008</year><chapter-title>Multidimensional scaling</chapter-title><person-group person-group-type="editor"><name><surname>Cox</surname><given-names>MA</given-names></name></person-group><source>Handbook of Data Visualization</source><publisher-name>Springer</publisher-name><fpage>315</fpage><lpage>347</lpage><pub-id pub-id-type="doi">10.1007/978-3-540-33037-0_14</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dimensionality reduction for large-scale neural recordings</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1500</fpage><lpage>1509</lpage><pub-id pub-id-type="doi">10.1038/nn.3776</pub-id><pub-id pub-id-type="pmid">25151264</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cymbalyuk</surname><given-names>GS</given-names></name><name><surname>Gaudry</surname><given-names>Q</given-names></name><name><surname>Masino</surname><given-names>MA</given-names></name><name><surname>Calabrese</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Bursting in leech heart interneurons: cell-autonomous and network-based mechanisms</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>10580</fpage><lpage>10592</lpage><pub-id pub-id-type="pmid">12486150</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daur</surname><given-names>N</given-names></name><name><surname>Nadim</surname><given-names>F</given-names></name><name><surname>Bucher</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The complexity of small circuits: the stomatogastric nervous system</article-title><source>Current Opinion in Neurobiology</source><volume>41</volume><fpage>1</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.07.005</pub-id><pub-id pub-id-type="pmid">27450880</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dickinson</surname><given-names>PS</given-names></name><name><surname>Hauptman</surname><given-names>J</given-names></name><name><surname>Hetling</surname><given-names>J</given-names></name><name><surname>Mahadevan</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Rpch modulation of a multi-oscillator network: effects on the pyloric network of the spiny lobster</article-title><source>Journal of Neurophysiology</source><volume>85</volume><fpage>1424</fpage><lpage>1435</lpage><pub-id pub-id-type="doi">10.1152/jn.2001.85.4.1424</pub-id><pub-id pub-id-type="pmid">11287466</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dimitriadis</surname><given-names>G</given-names></name><name><surname>Neto</surname><given-names>JP</given-names></name><name><surname>Kampff</surname><given-names>AR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>t-SNE Visualization of Large-Scale Neural Recordings</article-title><source>Neural Computation</source><volume>30</volume><fpage>1750</fpage><lpage>1774</lpage><pub-id pub-id-type="doi">10.1162/neco_a_01097</pub-id><pub-id pub-id-type="pmid">29894653</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eisen</surname><given-names>JS</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Mechanisms underlying pattern generation in lobster stomatogastric ganglion as determined by selective inactivation of identified neurons. iii. synaptic connections of electrically coupled pyloric neurons</article-title><source>Journal of Neurophysiology</source><volume>48</volume><fpage>1392</fpage><lpage>1415</lpage><pub-id pub-id-type="doi">10.1152/jn.1982.48.6.1392</pub-id><pub-id pub-id-type="pmid">6296329</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eisen</surname><given-names>JS</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>A mechanism for production of phase shifts in a pattern generator</article-title><source>Journal of Neurophysiology</source><volume>51</volume><fpage>1375</fpage><lpage>1393</lpage><pub-id pub-id-type="doi">10.1152/jn.1984.51.6.1375</pub-id><pub-id pub-id-type="pmid">6145759</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Epstein</surname><given-names>IR</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Multiple modes of a conditional neural oscillator</article-title><source>Biological Cybernetics</source><volume>63</volume><fpage>25</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1007/BF00202450</pub-id><pub-id pub-id-type="pmid">2357477</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Fortuin</surname><given-names>V</given-names></name><name><surname>Hüser</surname><given-names>M</given-names></name><name><surname>Locatello</surname><given-names>F</given-names></name><name><surname>Strathmann</surname><given-names>H</given-names></name><name><surname>Rätsch</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>SOM-VAE: Interpretable Discrete Representation Learning on Time Series</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1806.02199">https://arxiv.org/abs/1806.02199</ext-link></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franci</surname><given-names>A</given-names></name><name><surname>O’Leary</surname><given-names>T</given-names></name><name><surname>Golowasch</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Positive Dynamical Networks in Neuronal Regulation: How Tunable Variability Coexists With Robustness</article-title><source>IEEE Control Systems Letters</source><volume>4</volume><fpage>946</fpage><lpage>951</lpage><pub-id pub-id-type="doi">10.1109/LCSYS.2020.2997214</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia</surname><given-names>VJ</given-names></name><name><surname>Daur</surname><given-names>N</given-names></name><name><surname>Temporal</surname><given-names>S</given-names></name><name><surname>Schulz</surname><given-names>DJ</given-names></name><name><surname>Bucher</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neuropeptide Receptor Transcript Expression Levels and Magnitude of Ionic Current Responses Show Cell Type-Specific Differences in a Small Motor Circuit</article-title><source>The Journal of Neuroscience</source><volume>35</volume><fpage>6786</fpage><lpage>6800</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0171-15.2015</pub-id><pub-id pub-id-type="pmid">25926455</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golowasch</surname><given-names>J</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Proctolin activates an inward current whose voltage dependence is modified by extracellular</article-title><source>The Journal of Neuroscience</source><volume>12</volume><fpage>810</fpage><lpage>817</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.12-03-00810.1992</pub-id><pub-id pub-id-type="pmid">1347561</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golowasch</surname><given-names>J</given-names></name><name><surname>Casey</surname><given-names>M</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Network Stability from Activity-Dependent Regulation of Neuronal Conductances</article-title><source>Neural Computation</source><volume>11</volume><fpage>1079</fpage><lpage>1096</lpage><pub-id pub-id-type="doi">10.1162/089976699300016359</pub-id><pub-id pub-id-type="pmid">10418158</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golowasch</surname><given-names>J</given-names></name><name><surname>Goldman</surname><given-names>MS</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Failure of Averaging in the Construction of a Conductance-Based Neuron Model</article-title><source>Journal of Neurophysiology</source><volume>87</volume><fpage>1129</fpage><lpage>1131</lpage><pub-id pub-id-type="doi">10.1152/jn.00412.2001</pub-id><pub-id pub-id-type="pmid">11826077</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonçalves</surname><given-names>PJ</given-names></name><name><surname>Lueckmann</surname><given-names>JM</given-names></name><name><surname>Deistler</surname><given-names>M</given-names></name><name><surname>Nonnenmacher</surname><given-names>M</given-names></name><name><surname>Öcal</surname><given-names>K</given-names></name><name><surname>Bassetto</surname><given-names>G</given-names></name><name><surname>Chintaluri</surname><given-names>C</given-names></name><name><surname>Podlaski</surname><given-names>WF</given-names></name><name><surname>Haddad</surname><given-names>SA</given-names></name><name><surname>Vogels</surname><given-names>TP</given-names></name><name><surname>Greenberg</surname><given-names>DS</given-names></name><name><surname>Macke</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Training deep neural density estimators to identify mechanistic models of neural dynamics</article-title><source>eLife</source><volume>9</volume><elocation-id>e56261</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.56261</pub-id><pub-id pub-id-type="pmid">32940606</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorur-Shandilya</surname><given-names>S</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>O’Leary</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Activity-dependent compensation of cell size is vulnerable to targeted deletion of ion channels</article-title><source>Scientific Reports</source><volume>10</volume><elocation-id>7</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-020-72977-6</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Gorur-Shandilya</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>crabsort</data-title><version designator="swh:1:rev:6a67e765e90caa536e6a11f67d9d4737d059af50">swh:1:rev:6a67e765e90caa536e6a11f67d9d4737d059af50</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:b22b2c2456d851ffad732d42288db699d660fa7b;origin=https://github.com/sg-s/crabsort;visit=swh:1:snp:da7045d992613143c796feabea2668445c8a3e6b;anchor=swh:1:rev:6a67e765e90caa536e6a11f67d9d4737d059af50">https://archive.softwareheritage.org/swh:1:dir:b22b2c2456d851ffad732d42288db699d660fa7b;origin=https://github.com/sg-s/crabsort;visit=swh:1:snp:da7045d992613143c796feabea2668445c8a3e6b;anchor=swh:1:rev:6a67e765e90caa536e6a11f67d9d4737d059af50</ext-link></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gutierrez</surname><given-names>GJ</given-names></name><name><surname>Grashow</surname><given-names>RG</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Cancer borealis stomatogastric nervous system dissection</article-title><source>Journal of Visualized Experiments: JoVE</source><volume>25</volume><elocation-id>1207</elocation-id><pub-id pub-id-type="doi">10.3791/1207</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gutierrez</surname><given-names>GJ</given-names></name><name><surname>O’Leary</surname><given-names>T</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Multiple mechanisms switch an electrically coupled, synaptically inhibited neuron between competing rhythmic oscillators</article-title><source>Neuron</source><volume>77</volume><fpage>845</fpage><lpage>858</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.01.016</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haddad</surname><given-names>SA</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Circuit Robustness to Temperature Perturbation Is Altered by Neuromodulators</article-title><source>Neuron</source><volume>100</volume><fpage>609</fpage><lpage>623</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.08.035</pub-id><pub-id pub-id-type="pmid">30244886</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haley</surname><given-names>JA</given-names></name><name><surname>Hampton</surname><given-names>D</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Two central pattern generators from the crab, Cancer borealis, respond robustly and differentially to extreme extracellular pH</article-title><source>eLife</source><volume>7</volume><elocation-id>e41877</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.41877</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Hamood</surname><given-names>AW</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Animal-to-Animal Variability in Neuromodulation and Circuit Function</article-title><conf-name>Cold Spring Harbor Symposia on Quantitative Biology</conf-name><fpage>21</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1101/sqb.2014.79.024828</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamood</surname><given-names>AW</given-names></name><name><surname>Haddad</surname><given-names>SA</given-names></name><name><surname>Otopalik</surname><given-names>AG</given-names></name><name><surname>Rosenbaum</surname><given-names>P</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Quantitative Reevaluation of the Effects of Short- and Long-Term Removal of Descending Modulatory Inputs on the Pyloric Rhythm of the Crab, Cancer borealis</article-title><source>ENeuro</source><volume>2</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1523/ENEURO.0058-14.2015</pub-id><pub-id pub-id-type="pmid">25914899</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris-Warrick</surname><given-names>RM</given-names></name><name><surname>Flamm</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Multiple mechanisms of bursting in a conditional bursting neuron</article-title><source>The Journal of Neuroscience</source><volume>7</volume><fpage>2113</fpage><lpage>2128</lpage><pub-id pub-id-type="pmid">3112322</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris-Warrick</surname><given-names>RM</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Modulation of neural networks for behavior</article-title><source>Annual Review of Neuroscience</source><volume>14</volume><fpage>39</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1146/annurev.ne.14.030191.000351</pub-id><pub-id pub-id-type="pmid">2031576</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartline</surname><given-names>DK</given-names></name><name><surname>Maynard</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Motor patterns in the stomatogastric ganglion of the lobster Panulirus argus</article-title><source>The Journal of Experimental Biology</source><volume>62</volume><fpage>405</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1242/jeb.62.2.405</pub-id><pub-id pub-id-type="pmid">173787</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>LS</given-names></name><name><surname>Rue</surname><given-names>MCP</given-names></name><name><surname>Morozova</surname><given-names>EO</given-names></name><name><surname>Powell</surname><given-names>DJ</given-names></name><name><surname>James</surname><given-names>EJ</given-names></name><name><surname>Kar</surname><given-names>M</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Rapid adaptation to elevated extracellular potassium in the pyloric circuit of the crab, Cancer borealis</article-title><source>Journal of Neurophysiology</source><volume>123</volume><fpage>2075</fpage><lpage>2089</lpage><pub-id pub-id-type="doi">10.1152/jn.00135.2020</pub-id><pub-id pub-id-type="pmid">32319837</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hooper</surname><given-names>SL</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Modulation of a central pattern generator by two neuropeptides, proctolin and FMRFamide</article-title><source>Brain Research</source><volume>305</volume><fpage>186</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(84)91138-7</pub-id><pub-id pub-id-type="pmid">6146385</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hooper</surname><given-names>SL</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Modulation of the lobster pyloric rhythm by the peptide proctolin</article-title><source>The Journal of Neuroscience</source><volume>7</volume><fpage>2097</fpage><lpage>2112</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.07-07-02097.1987</pub-id><pub-id pub-id-type="pmid">3612231</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hooper</surname><given-names>SL</given-names></name><name><surname>Thuma</surname><given-names>JB</given-names></name><name><surname>Guschlbauer</surname><given-names>C</given-names></name><name><surname>Schmidt</surname><given-names>J</given-names></name><name><surname>Büschges</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Cell dialysis by sharp electrodes can cause nonphysiological changes in neuron properties</article-title><source>Journal of Neurophysiology</source><volume>114</volume><fpage>1255</fpage><lpage>1271</lpage><pub-id pub-id-type="doi">10.1152/jn.01010.2014</pub-id><pub-id pub-id-type="pmid">26063785</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobak</surname><given-names>D</given-names></name><name><surname>Berens</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The art of using t-SNE for single-cell transcriptomics</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>5416</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-13056-x</pub-id><pub-id pub-id-type="pmid">31780648</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobak</surname><given-names>D</given-names></name><name><surname>Linderman</surname><given-names>GC</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Initialization is critical for preserving global data structure in both t-sne and umap</article-title><source>Nature Biotechnology</source><volume>39</volume><fpage>156</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-00809-z</pub-id><pub-id pub-id-type="pmid">33526945</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kollmorgen</surname><given-names>S</given-names></name><name><surname>Hahnloser</surname><given-names>RHR</given-names></name><name><surname>Mante</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Nearest neighbours reveal fast and slow components of motor learning</article-title><source>Nature</source><volume>577</volume><fpage>526</fpage><lpage>530</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1892-x</pub-id><pub-id pub-id-type="pmid">31915383</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kushinsky</surname><given-names>D</given-names></name><name><surname>Morozova</surname><given-names>EO</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>In vivo effects of temperature on the heart and pyloric rhythms in the crab Cancer borealis</article-title><source>Journal of Experimental Biology</source><volume>222</volume><elocation-id>jeb.199190</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.199190</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leelatian</surname><given-names>N</given-names></name><name><surname>Sinnaeve</surname><given-names>J</given-names></name><name><surname>Mistry</surname><given-names>AM</given-names></name><name><surname>Barone</surname><given-names>SM</given-names></name><name><surname>Brockman</surname><given-names>AA</given-names></name><name><surname>Diggins</surname><given-names>KE</given-names></name><name><surname>Greenplate</surname><given-names>AR</given-names></name><name><surname>Weaver</surname><given-names>KD</given-names></name><name><surname>Thompson</surname><given-names>RC</given-names></name><name><surname>Chambless</surname><given-names>LB</given-names></name><name><surname>Mobley</surname><given-names>BC</given-names></name><name><surname>Ihrie</surname><given-names>RA</given-names></name><name><surname>Irish</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Unsupervised machine learning reveals risk stratifying glioblastoma tumor cells</article-title><source>eLife</source><volume>9</volume><elocation-id>e56879</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.56879</pub-id><pub-id pub-id-type="pmid">32573435</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Linderman</surname><given-names>GC</given-names></name><name><surname>Rachh</surname><given-names>M</given-names></name><name><surname>Hoskins</surname><given-names>JG</given-names></name><name><surname>Steinerberger</surname><given-names>S</given-names></name><name><surname>Kluger</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Fast interpolation-based t-sne for improved visualization of single-cell rna-seq data</article-title><source>Nature Methods</source><volume>16</volume><fpage>243</fpage><lpage>245</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0308-4</pub-id><pub-id pub-id-type="pmid">30742040</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Linderman</surname><given-names>GC</given-names></name><name><surname>Steinerberger</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Clustering with t-SNE, provably</article-title><source>SIAM Journal on Mathematics of Data Science</source><volume>1</volume><fpage>313</fpage><lpage>332</lpage><pub-id pub-id-type="doi">10.1137/18m1216134</pub-id><pub-id pub-id-type="pmid">33073204</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mackevicius</surname><given-names>EL</given-names></name><name><surname>Bahle</surname><given-names>AH</given-names></name><name><surname>Williams</surname><given-names>AH</given-names></name><name><surname>Gu</surname><given-names>S</given-names></name><name><surname>Denisenko</surname><given-names>NI</given-names></name><name><surname>Goldman</surname><given-names>MS</given-names></name><name><surname>Fee</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Unsupervised discovery of temporal sequences in high-dimensional datasets, with applications to neuroscience</article-title><source>eLife</source><volume>8</volume><elocation-id>e38471</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.38471</pub-id><pub-id pub-id-type="pmid">30719973</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Basu</surname><given-names>A</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Nemesh</surname><given-names>J</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Goldman</surname><given-names>M</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Bialas</surname><given-names>AR</given-names></name><name><surname>Kamitaki</surname><given-names>N</given-names></name><name><surname>Martersteck</surname><given-names>EM</given-names></name><name><surname>Trombetta</surname><given-names>JJ</given-names></name><name><surname>Weitz</surname><given-names>DA</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>McCarroll</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title><source>Cell</source><volume>161</volume><fpage>1202</fpage><lpage>1214</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id><pub-id pub-id-type="pmid">26000488</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Madiraju</surname><given-names>NS</given-names></name><name><surname>Sadat</surname><given-names>SM</given-names></name><name><surname>Fisher</surname><given-names>D</given-names></name><name><surname>Karimabadi</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Deep Temporal Clustering: Fully Unsupervised Learning of Time-Domain Features</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.01059">https://arxiv.org/abs/1802.01059</ext-link></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marbán</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Cardiac channelopathies</article-title><source>Nature</source><volume>415</volume><fpage>213</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1038/415213a</pub-id><pub-id pub-id-type="pmid">11805845</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Hooper</surname><given-names>SL</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Neurotransmitter modulation of the stomatogastric ganglion of decapod crustaceans</article-title><source>Model Neural Networks and Behavior</source><volume>7</volume><fpage>319</fpage><lpage>337</lpage><pub-id pub-id-type="doi">10.1007/978-1-4757-5858-0_17</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Hooper</surname><given-names>SL</given-names></name><name><surname>Siwicki</surname><given-names>KK</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Modulatory action and distribution of the neuropeptide proctolin in the crustacean stomatogastric nervous system</article-title><source>The Journal of Comparative Neurology</source><volume>243</volume><fpage>454</fpage><lpage>467</lpage><pub-id pub-id-type="doi">10.1002/cne.902430403</pub-id><pub-id pub-id-type="pmid">2869069</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Weimann</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Modulatory control of multiple task processing in the stomatogastric nervous system</article-title><source>Neurobiology of Motor Programme Selection</source><volume>6</volume><fpage>3</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1016/B978-0-08-041986-2.50006-0</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Bucher</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Understanding circuit dynamics using the stomatogastric nervous system of lobsters and crabs</article-title><source>Annual Review of Physiology</source><volume>69</volume><fpage>291</fpage><lpage>316</lpage><pub-id pub-id-type="doi">10.1146/annurev.physiol.69.031905.161516</pub-id><pub-id pub-id-type="pmid">17009928</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neuromodulation of neuronal circuits: back to the future</article-title><source>Neuron</source><volume>76</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.09.010</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mariño</surname><given-names>J</given-names></name><name><surname>Schummers</surname><given-names>J</given-names></name><name><surname>Lyon</surname><given-names>DC</given-names></name><name><surname>Schwabe</surname><given-names>L</given-names></name><name><surname>Beck</surname><given-names>O</given-names></name><name><surname>Wiesing</surname><given-names>P</given-names></name><name><surname>Obermayer</surname><given-names>K</given-names></name><name><surname>Sur</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Invariant computations in local cortical networks with balanced excitation and inhibition</article-title><source>Nature Neuroscience</source><volume>8</volume><fpage>194</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1038/nn1391</pub-id><pub-id pub-id-type="pmid">15665876</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Saul</surname><given-names>N</given-names></name><name><surname>Großberger</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Umap: Uniform manifold approximation and projection</article-title><source>Journal of Open Source Software</source><volume>3</volume><elocation-id>861</elocation-id><pub-id pub-id-type="doi">10.21105/joss.00861</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Memmesheimer</surname><given-names>RM</given-names></name><name><surname>Timme</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Designing the dynamics of spiking neural networks</article-title><source>Physical Review Letters</source><volume>97</volume><elocation-id>18</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.97.188101</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>JP</given-names></name><name><surname>Selverston</surname><given-names>AI</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Mechanisms underlying pattern generation in lobster stomatogastric ganglion as determined by selective inactivation of identified neurons</article-title><source>Journal of Neurophysiology</source><volume>48</volume><fpage>1416</fpage><lpage>1432</lpage><pub-id pub-id-type="doi">10.1152/jn.1982.48.6.1416</pub-id><pub-id pub-id-type="pmid">7153799</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizrahi</surname><given-names>A</given-names></name><name><surname>Dickinson</surname><given-names>PS</given-names></name><name><surname>Kloppenburg</surname><given-names>P</given-names></name><name><surname>Fénelon</surname><given-names>V</given-names></name><name><surname>Baro</surname><given-names>DJ</given-names></name><name><surname>Harris-Warrick</surname><given-names>RM</given-names></name><name><surname>Meyrand</surname><given-names>P</given-names></name><name><surname>Simmers</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Long-term maintenance of channel distribution in a central pattern generator neuron by neuromodulatory inputs revealed by decentralization in organ culture</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>7331</fpage><lpage>7339</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.21-18-07331.2001</pub-id><pub-id pub-id-type="pmid">11549743</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Moor</surname><given-names>M</given-names></name><name><surname>Horn</surname><given-names>M</given-names></name><name><surname>Rieck</surname><given-names>B</given-names></name><name><surname>Borgwardt</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Topological Autoencoders</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1906.00722">https://arxiv.org/abs/1906.00722</ext-link></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>LH</given-names></name><name><surname>Holmes</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Ten quick tips for effective dimensionality reduction</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1006907-19</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006907</pub-id><pub-id pub-id-type="pmid">31220072</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nusbaum</surname><given-names>MP</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>A neuronal role for a crustacean red pigment concentrating hormone-like peptide: Neuromodulation of the pyloric rhythm in the crab, Cancer Borealis</article-title><source>Journal of Experimental Biology</source><volume>135</volume><fpage>165</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1242/jeb.135.1.165</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nusbaum</surname><given-names>MP</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>A modulatory proctolin-containing neuron (MPN). I. Identification and characterization</article-title><source>The Journal of Neuroscience</source><volume>9</volume><fpage>1591</fpage><lpage>1599</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.09-05-01591.1989</pub-id><pub-id pub-id-type="pmid">2566658</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Leary</surname><given-names>T</given-names></name><name><surname>Williams</surname><given-names>AH</given-names></name><name><surname>Franci</surname><given-names>A</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Cell Types, Network Homeostasis, and Pathological Compensation from a Biologically Plausible Ion Channel Expression Model</article-title><source>Neuron</source><volume>82</volume><fpage>809</fpage><lpage>821</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.04.002</pub-id><pub-id pub-id-type="pmid">24853940</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Stringer</surname><given-names>C</given-names></name><name><surname>Dipoppa</surname><given-names>M</given-names></name><name><surname>Schröder</surname><given-names>S</given-names></name><name><surname>Rossi</surname><given-names>LF</given-names></name><name><surname>Dalgleish</surname><given-names>H</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Suite2p: Beyond 10,000 Neurons with Standard Two-Photon Microscopy</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/061507</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pang</surname><given-names>R</given-names></name><name><surname>Lansdell</surname><given-names>BJ</given-names></name><name><surname>Fairhall</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Dimensionality reduction in neuroscience</article-title><source>Current Biology</source><volume>26</volume><fpage>R656</fpage><lpage>R660</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2016.05.029</pub-id><pub-id pub-id-type="pmid">27458907</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peacock</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Two-dimensional goodness-of-fit testing in astronomy</article-title><source>Monthly Notices of the Royal Astronomical Society</source><volume>202</volume><fpage>615</fpage><lpage>627</lpage><pub-id pub-id-type="doi">10.1093/mnras/202.3.615</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Powell</surname><given-names>D</given-names></name><name><surname>Haddad</surname><given-names>SA</given-names></name><name><surname>Gorur-Shandilya</surname><given-names>S</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Coupling between fast and slow oscillator circuits in Cancer borealis is temperature-compensated</article-title><source>eLife</source><volume>10</volume><elocation-id>e60454</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.60454</pub-id><pub-id pub-id-type="pmid">33538245</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prinz</surname><given-names>AA</given-names></name><name><surname>Billimoria</surname><given-names>CP</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Alternative to Hand-Tuning Conductance-Based Models: Construction and Analysis of Databases of Model Neurons</article-title><source>Journal of Neurophysiology</source><volume>90</volume><fpage>3998</fpage><lpage>4015</lpage><pub-id pub-id-type="doi">10.1152/jn.00641.2003</pub-id><pub-id pub-id-type="pmid">12944532</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prinz</surname><given-names>AA</given-names></name><name><surname>Bucher</surname><given-names>D</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Similar network activity from disparate circuit parameters</article-title><source>Nature Neuroscience</source><volume>7</volume><fpage>1345</fpage><lpage>1352</lpage><pub-id pub-id-type="doi">10.1038/nn1352</pub-id><pub-id pub-id-type="pmid">15558066</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qadri</surname><given-names>SA</given-names></name><name><surname>Camacho</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Taylor</surname><given-names>JR</given-names></name><name><surname>Grosell</surname><given-names>M</given-names></name><name><surname>Worden</surname><given-names>MK</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Temperature and acid–base balance in the american lobster Homarus americanus</article-title><source>The Journal of Experimental Biology</source><volume>210</volume><fpage>1245</fpage><lpage>1254</lpage><pub-id pub-id-type="doi">10.1242/jeb.02709</pub-id><pub-id pub-id-type="pmid">17371923</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ratliff</surname><given-names>J</given-names></name><name><surname>Franci</surname><given-names>A</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>O’Leary</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Neuronal oscillator robustness to multiple global perturbations</article-title><source>Biophysical Journal</source><volume>120</volume><fpage>1454</fpage><lpage>1468</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2021.01.038</pub-id><pub-id pub-id-type="pmid">33610580</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rinberg</surname><given-names>A</given-names></name><name><surname>Taylor</surname><given-names>AL</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The effects of temperature on the stability of a neuronal oscillator</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1002857</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002857</pub-id><pub-id pub-id-type="pmid">23326223</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenbaum</surname><given-names>P</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Graded Transmission without Action Potentials Sustains Rhythmic Activity in Some But Not All Modulators That Activate the Same Current</article-title><source>The Journal of Neuroscience</source><volume>38</volume><fpage>8976</fpage><lpage>8988</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2632-17.2018</pub-id><pub-id pub-id-type="pmid">30185461</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russell</surname><given-names>DF</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Rhythmic excitatory inputs to the lobster stomatogastric ganglion</article-title><source>Brain Research</source><volume>101</volume><fpage>582</fpage><lpage>588</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(76)90482-0</pub-id><pub-id pub-id-type="pmid">1244992</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schreiber</surname><given-names>S</given-names></name><name><surname>Fellous</surname><given-names>JM</given-names></name><name><surname>Whitmer</surname><given-names>D</given-names></name><name><surname>Tiesinga</surname><given-names>P</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>A new correlation-based measure of spike timing reliability</article-title><source>Neurocomputing</source><volume>52–54</volume><fpage>925</fpage><lpage>931</lpage><pub-id pub-id-type="doi">10.1016/S0925-2312(02)00838-X</pub-id><pub-id pub-id-type="pmid">20740049</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname><given-names>DJ</given-names></name><name><surname>Goaillard</surname><given-names>JM</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Variable channel expression in identified single and electrically coupled neurons in different animals</article-title><source>Nature Neuroscience</source><volume>9</volume><fpage>356</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.1038/nn1639</pub-id><pub-id pub-id-type="pmid">16444270</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname><given-names>DJ</given-names></name><name><surname>Goaillard</surname><given-names>JM</given-names></name><name><surname>Marder</surname><given-names>EE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Quantitative expression profiling of identified neurons reveals cell-specific constraints on highly variable levels of gene expression</article-title><source>PNAS</source><volume>104</volume><fpage>13187</fpage><lpage>13191</lpage><pub-id pub-id-type="doi">10.1073/pnas.0705827104</pub-id><pub-id pub-id-type="pmid">17652510</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Settles</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2009">2009</year><source>Active Learning Literature Survey Doctoral Dissertation</source><publisher-name>University of Wisconsin-Madison</publisher-name></element-citation></ref><ref id="bib89"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Shneiderman</surname><given-names>B</given-names></name><name><surname>Wattenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Ordered treemap layouts</article-title><conf-name>IEEE Symposium on Information Visualization, 2001</conf-name><fpage>73</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1109/INFVIS.2001.963283</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spitzer</surname><given-names>N</given-names></name><name><surname>Cymbalyuk</surname><given-names>G</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Edwards</surname><given-names>DH</given-names></name><name><surname>Baro</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Serotonin Transduction Cascades Mediate Variable Changes in Pyloric Network Cycle Frequency in Response to the Same Modulatory Challenge</article-title><source>Journal of Neurophysiology</source><volume>99</volume><fpage>2844</fpage><lpage>2863</lpage><pub-id pub-id-type="doi">10.1152/jn.00986.2007</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Staley</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Molecular mechanisms of epilepsy</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>367</fpage><lpage>372</lpage><pub-id pub-id-type="doi">10.1038/nn.3947</pub-id><pub-id pub-id-type="pmid">25710839</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swensen</surname><given-names>AM</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Multiple peptides converge to activate the same voltage-dependent current in a central pattern-generating circuit</article-title><source>The Journal of Neuroscience</source><volume>20</volume><fpage>6752</fpage><lpage>6759</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.20-18-06752.2000</pub-id><pub-id pub-id-type="pmid">10995818</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swensen</surname><given-names>AM</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Modulators with Convergent Cellular Actions Elicit Distinct Circuit Outputs</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>4050</fpage><lpage>4058</lpage><pub-id pub-id-type="pmid">11356892</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>LS</given-names></name><name><surname>Goeritz</surname><given-names>ML</given-names></name><name><surname>Caplan</surname><given-names>JS</given-names></name><name><surname>Taylor</surname><given-names>AL</given-names></name><name><surname>Fisek</surname><given-names>M</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Precise Temperature Compensation of Phase in a Rhythmic Motor Pattern</article-title><source>PLOS Biology</source><volume>8</volume><elocation-id>e1000469</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1000469</pub-id><pub-id pub-id-type="pmid">20824168</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>LS</given-names></name><name><surname>Taylor</surname><given-names>AL</given-names></name><name><surname>Rinberg</surname><given-names>A</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Robustness of a Rhythmic Circuit to Short- and Long-Term Temperature Changes</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>10075</fpage><lpage>10085</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1443-12.2012</pub-id><pub-id pub-id-type="pmid">22815521</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thirumalai</surname><given-names>V</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Colocalized Neuropeptides Activate a Central Pattern Generator by Acting on Different Circuit Targets</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>1874</fpage><lpage>1882</lpage><pub-id pub-id-type="pmid">11880517</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thirumalai</surname><given-names>V</given-names></name><name><surname>Prinz</surname><given-names>AA</given-names></name><name><surname>Johnson</surname><given-names>CD</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Red Pigment Concentrating Hormone Strongly Enhances the Strength of the Feedback to the Pyloric Rhythm Oscillator But Has Little Effect on Pyloric Rhythm Period</article-title><source>Journal of Neurophysiology</source><volume>95</volume><fpage>1762</fpage><lpage>1770</lpage><pub-id pub-id-type="doi">10.1152/jn.00764.2005</pub-id><pub-id pub-id-type="pmid">16319213</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thoby-Brisson</surname><given-names>M</given-names></name><name><surname>Simmers</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Neuromodulatory inputs maintain expression of a lobster motor pattern-generating network in a modulation-dependent state: evidence from long-term decentralization in vitro</article-title><source>The Journal of Neuroscience</source><volume>18</volume><fpage>2212</fpage><lpage>2225</lpage><pub-id pub-id-type="pmid">9482805</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Timme</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Revealing network connectivity from response dynamics</article-title><source>Physical Review Letters</source><volume>98</volume><elocation-id>224101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.98.224101</pub-id><pub-id pub-id-type="pmid">17677845</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tobin</surname><given-names>AE</given-names></name><name><surname>Cruz-Bermúdez</surname><given-names>ND</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Schulz</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Correlations in ion channel mrna in rhythmically active neurons</article-title><source>PLOS ONE</source><volume>4</volume><elocation-id>e6742</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0006742</pub-id><pub-id pub-id-type="pmid">19707591</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turrigiano</surname><given-names>GG</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Modulation of identified stomatogastric ganglion neurons in primary cell culture</article-title><source>Journal of Neurophysiology</source><volume>69</volume><fpage>1993</fpage><lpage>2002</lpage><pub-id pub-id-type="doi">10.1152/jn.1993.69.6.1993</pub-id><pub-id pub-id-type="pmid">8102397</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turrigiano</surname><given-names>G</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Activity-dependent changes in the intrinsic properties of cultured neurons</article-title><source>Science (New York, N.Y.)</source><volume>264</volume><fpage>974</fpage><lpage>977</lpage><pub-id pub-id-type="doi">10.1126/science.8178157</pub-id><pub-id pub-id-type="pmid">8178157</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turrigiano</surname><given-names>G</given-names></name><name><surname>LeMasson</surname><given-names>G</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Selective regulation of current densities underlies spontaneous changes in the activity of cultured neurons</article-title><source>The Journal of Neuroscience</source><volume>15</volume><fpage>3640</fpage><lpage>3652</lpage><pub-id pub-id-type="pmid">7538565</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van der Maaten</surname><given-names>L</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Visualizing data using t-sne</article-title><source>Journal of Machine Learning Research</source><volume>9</volume><elocation-id>11</elocation-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Rossum</surname><given-names>MC</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>A novel spike distance</article-title><source>Neural Computation</source><volume>13</volume><fpage>751</fpage><lpage>763</lpage><pub-id pub-id-type="doi">10.1162/089976601300014321</pub-id><pub-id pub-id-type="pmid">11255567</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Vreeswijk</surname><given-names>C</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Chaos in neuronal networks with balanced excitatory and inhibitory activity</article-title><source>Science (New York, N.Y.)</source><volume>274</volume><fpage>1724</fpage><lpage>1726</lpage><pub-id pub-id-type="doi">10.1126/science.274.5293.1724</pub-id><pub-id pub-id-type="pmid">8939866</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Victor</surname><given-names>JD</given-names></name><name><surname>Purpura</surname><given-names>KP</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Metric-space analysis of spike trains: theory, algorithms and application</article-title><source>Network</source><volume>8</volume><fpage>127</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_8_2_003</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vyas</surname><given-names>S</given-names></name><name><surname>Golub</surname><given-names>MD</given-names></name><name><surname>Sussillo</surname><given-names>D</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Computation Through Neural Population Dynamics</article-title><source>Annual Review of Neuroscience</source><volume>43</volume><fpage>249</fpage><lpage>275</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-092619-094115</pub-id><pub-id pub-id-type="pmid">32640928</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wattenberg</surname><given-names>M</given-names></name><name><surname>Viégas</surname><given-names>F</given-names></name><name><surname>Johnson</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>How to use t-sne effectively</article-title><source>Distill</source><volume>1</volume><elocation-id>0002</elocation-id><pub-id pub-id-type="doi">10.23915/distill.00002</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>AH</given-names></name><name><surname>Kim</surname><given-names>TH</given-names></name><name><surname>Wang</surname><given-names>F</given-names></name><name><surname>Vyas</surname><given-names>S</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Schnitzer</surname><given-names>M</given-names></name><name><surname>Kolda</surname><given-names>TG</given-names></name><name><surname>Ganguli</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Unsupervised Discovery of Demixed, Low-Dimensional Neural Dynamics across Multiple Timescales through Tensor Component Analysis</article-title><source>Neuron</source><volume>98</volume><fpage>1099</fpage><lpage>1115</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.05.015</pub-id><pub-id pub-id-type="pmid">29887338</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>AH</given-names></name><name><surname>Degleris</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Linderman</surname><given-names>SW</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Point process models for sequence detection in high-dimensional neural spike trains</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2010.04875">https://arxiv.org/abs/2010.04875</ext-link></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.76579.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>This study applies an unsupervised dimensionality reduction (t-SNE) to characterize neural spiking dynamics in the pyloric circuit in the stomatogastric ganglion of the crab, an important system for mechanistic analysis of rhythmic circuit function. The application of unsupervised methods to characterize qualitatively distinct regimes of spiking neural circuits is interesting and novel. The challenges and lessons learned in this study are of broader interest to those seeking to quantitatively characterize large sets of neural data across many subjects. The method is demonstrated across hundreds of animal subjects and used to investigate circuit responses to a variety of perturbations.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.76579.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Williams</surname><given-names>Alex</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00f54p054</institution-id><institution>Stanford University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>[Editors’ note: the authors submitted for reconsideration following the decision after peer review. What follows is the decision letter after the first round of review.]</p><p>Thank you for submitting the paper &quot;Mapping Circuit Dynamics During Function and Dysfunction&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and a Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Alex Williams (Reviewer #1).</p><p>We are sorry to say that, after consultation with the reviewers, we have decided that this work will not be considered further for publication by <italic>eLife</italic>.</p><p>The reviewers find that paper has intrinsic interest especially to specialists in motor pattern generation by small circuits but requires considerable work and refocusing to make it of broader significance.</p><p>The expert reviews are quite compatible and provide rich feedback that could lead to a major overhaul and a new submission to <italic>eLife</italic>.</p><p>1. t-SNR is not in itself a clustering algorithm so its resulting 'clusters' should be validated by application of a true clustering algorithm. t–SNE does often provide a nice 2–D embedding that can simplify subsequent clustering. Here the reviewers suggest that the feature vectors themselves should be subjected to clustering algorithm.</p><p>2. The feature vectors are not as well motivated and explained as they should be so that readers in other systems can use the strategy presented here in cases where other features than ISI and spike phase of the activity might be more relevant.</p><p>3. There was discussion as to whether the framing of the manuscript as a ML pipeline is appropriate because the pipeline described relies heavily on manual curation. The manual curation should be more explicitly described (with details), and the limitations of this approach – ML followed by manual curation – discussed. Such a pipeline probably can't be as easily downloaded and applied directly to someone else's data, but overall, the community could benefit from more examples/consideration of how to systematically and carefully interleave the use of machine–learning techniques with manual analysis by domain experts but the process should be more explicitly explained.</p><p>4. Discussion should be revamped to discuss more fully specific insights into the pyloric circuit and the limitations of the analyses presented, for example the omission of the PY neuron activity means that the map as given is incomplete: potentially there are many more states, and hence transitions, within or beyond those already found that correspond to changes in PY neuron activity.</p><p><italic>Reviewer #1:</italic></p><p>The authors sought to establish a standardized quantitative approach to categorize the activity patterns in a central pattern generator (specifically, the well–studied pyloric circuit in C. borealis). While it is easy to describe these patterns under &quot;normal&quot; conditions, this circuit displays a wide range of irregular behaviors under experimental perturbations. Characterizing and cataloguing these irregular behaviors is of interest to understand how the network avoids these dysfunctional patterns under &quot;normal&quot; circumstances.</p><p>The authors draw upon established machine learning tools to approach this problem. To do so, they must define a set of features that describe circuit activity at a moment in time. They use the distribution of inter–spike–intervals ISIs and spike phases of the LP and PD neuron as these features. As the authors mention in their Discussion section, these features are highly specialized and adapted to this particular circuit. This limits the applicability of their approach to other circuits with neurons that are unidentifiable or very large in number (the number of spike phase statistics grows quadratically with the number of neurons).</p><p>The main results of the paper provide evidence that ISIs and spike phase statistics provide a reasonable descriptive starting point for understanding the diversity of pyloric circuit patterns. The authors rely heavily on t–distributed stochastic neighbor embedding (tSNE), a well–known nonlinear dimensionality reduction method, to visualize activity patterns in a low–dimensional, 2D space. While effective, the outputs of tSNE have to be interpreted with great care (Wattenberg, et al., &quot;How to Use t–SNE Effectively&quot;, Distill, 2016. http://doi.org/10.23915/distill.00002). I think the conclusions of this paper would be strengthened if additional machine learning models were applied to the ISI and spike phase features, and if those additional models validated the qualitative results shown by tSNE. For example, tSNE itself is not a clustering method, so applying clustering methods directly to the high–dimensional data features would be a useful validation of the apparent low–dimensional clusters shown in the figures.</p><p>The authors do show that the algorithmically defined clusters agree with expert–defined clusters. (Or, at least, they show that one can come up with reasonable post–hoc explanations and interpretations of each cluster). The very large cluster of &quot;regular&quot; patterns – shown typically in a shade of blue – actually looks like an archipelago of smaller clusters that the authors have reasoned should be lumped together. Thus, while the approach is still a useful data–driven tool, a non–trivial amount of expert knowledge is baked into the results. A central challenge in this line of research is to understand how sensitive the outcomes are to these modeling choices, and there is unlikely to be a definitive answer.</p><p>Nonetheless, the authors show results which suggest that this analysis framework may be useful for the community of researchers studying central pattern generators. They use their method to qualitatively characterize a variety of network perturbations – temperature changes, pH changes, decentralization, etc.</p><p>In some cases it is difficult to understand the level of certainty in these qualitative observations. A first look at Figure 5a suggests that three different kinds of perturbations push the circuit activity into different dysfunctional cluster regions. However, the apparent spatial differences between these three groups of perturbations might be due to animal–level differences (i.e. each preparation produces multiple points in the low–D plot, so the number of effective statistical replicates is smaller than it appears at first glance). Similarly, in Figure 9, it is somewhat hard to understand how much the state occupancy plots would change if more animals were collected –– with the exception of proctolin, there are ~25 animals and 12 circuit activity clusters which may not be a favorable ratio. It would be useful if a principled method for computing &quot;error bars&quot; on these occupancy diagrams could be developed. Similar &quot;error bars&quot; on the state transition diagrams (e.g. Figure 6a) would also be useful.</p><p>Finally, one nagging concern that I have is that the ISIs and spike phase statistics aren't the ideal features one would use to classify pyloric circuit behaviors. Sub–threshold dynamics are incredibly important for this circuit (e.g. due to electrical coupling of many neurons). A deeper discussion about what is potentially lost by only having access to the spikes would be useful.</p><p>Overall, I think this work provides a useful starting point for large–scale quantitative analysis of CPG circuit behaviors, but there are many additional hurdles to be overcome.</p><p><italic>Reviewer #2:</italic></p><p>This manuscript uses the t–SNE dimensionality reduction technique to capture the rich dynamics of the pyloric circuit of the crab.</p><p>Strengths:</p><p>– The integration of a rich data–set of spiking data from the pyloric circuit.</p><p>– Use of nonlinear dimension reduction (t–SNE) to visualise that data.</p><p>– Use of clusters from that t–SNE visualisation to create subsets of data that are amenable to consistent analyses (such as using the &quot;regular&quot; cluster as a basis for surveying the types of dynamics possible in baseline conditions).</p><p>– Innovative use of the cluster types to describe transitions between dynamics within the baseline state and within perturbed states (whether by changes to exogenous variables, cutting nerves, or applying neuromodulators).</p><p>Some interesting main results:</p><p>– Baseline variability in the spiking patterns of the pyloric circuit is greater within than between animals.</p><p>– Transitions to silent states often (always?) pass through the same intermediate state of the LP neuron skipping spikes.</p><p>Weaknesses:</p><p>– t-SNE is not, in isolation, a clustering algorithm, yet here it is treated as such. How the clusters were identified is unclear: the manuscript mentions manual curation of randomly sampled points, implying that the clusters were extrapolations from these. This would seem to rather defeat the point of using unsupervised techniques to obtain an unbiased survey of the spiking dynamics and raises the issue of how robust the clusters are.</p><p>– The main purpose and contribution of the paper is unclear, as the results are descriptive, and mostly state that dynamics in some vary between different states of the circuit; while the collated dataset is a wonderful resource, and the map is no doubt useful for the lab to place in context what they are looking at, it is not clear what we learn about the pyloric circuit, or more widely about the dynamical repertoire of neural circuits.</p><p>– In some places the contribution is noted as being the pipeline of analysis: unfortunately as the pipeline used here seems to rely in manual curation, it is of limited general use; moreover, there are already a number of previous works that use unsupervised machine–learning pipelines to characterise the complexity of spiking activity across a large data–set of neurons, using the same general approach here (quantify properties of spiking as a vector; map/cluster using dimension reduction), including Baden et al. (2016, Nature), Bruno et al. (2015, Neuron), Frady et al. (2016, Neural Computation).</p><p>Some key limitations are not considered:</p><p>– The omission of the PY neuron activity means that the map as given is incomplete: potentially there are many more states, and hence transitions, within or beyond those already found that correspond to changes in PY neuron activity.</p><p>– The use of long, non–overlapping time segments (20s) – this means, for example, that the transitions are slow and discrete, whereas in reality they may be abrupt, or continuous.</p><p>– tSNE cannot capture hierarchical structure, nor has a null model to demonstrate that the underlying data contains some clustering structure. So, for example, distances measured on the map may not be strictly meaningful if the data is hierarchical.</p><p>– The Discussion does not include enough insight and contextualisation of the results.</p><p>Recommendations:</p><p>Explain and validate the clusters:</p><p>– The paper explains only that the clusters were assigned by manual curation of randomly sampled points. How then were all points assigned to clusters given that sample? What metric was used?</p><p>– We would suggest validating the clusters by using a clustering algorithm to recover them (approximately) from the vectors</p><p>Clarify the paper's goals and contributions:</p><p>– As noted above, the use of an unsupervised pipeline to map spiking activity is not novel; the survey of data is interesting, but purely descriptive. The key contributions were then not obvious to this reader – please clarify. To give some suggestions, while reading 3 possible contributions came to mind, but none quite fit: if the paper is an announcement of the dataset, then the datasets need a detailed explanation; if the paper is the introduction of a pipeline, then the pipeline ought to be fully unsupervised, else it is of little use outside the hands of the present lab; if the paper is about insights into the pyloric circuit, then conclusions and insights ought to be drawn from the descriptive results</p><p>Improve the Discussion:</p><p>– Explicitly link the results to insights into the pyloric circuit. The abstract states &quot;strong mechanistically interpretable links between complex changes in the collective behavior of a neural circuit and specific experimental manipulations&quot; – but only the short section on &quot;Diversity and stereotypy in trajectories from functional to crash states&quot; touches on this.</p><p>– Long section on other clustering methods is a survey of some alternatives and draws no conclusions about why tSNE was chosen here: either use to justify tSNE, or omit.</p><p>– Lines 678–716 are not based on any results in the paper.</p><p>Discuss limitations:</p><p>– The omission of the PY neuron activity means that the map as given is incomplete – what might it look like with it (new states, new transitions etc)?</p><p>– The transitions are slow and discrete by design (20 s long segments), whereas in reality they may be abrupt, or continuous.</p><p>– tSNE's limitations and their implications e.g. it cannot capture hierarchical structure, nor has a null model to demonstrate that the underlying data contains some clustering structure.</p><p>– Why those features of the spike–trains, and how would the map change if features were omitted or added? (e.g. the regularity of spiking).</p><p><italic>Reviewer #3:</italic></p><p>Gorur–Shandilya et al. apply an unsupervised dimensionality reduction (t–SNE) to characterize neural spiking dynamics in the pyloric circuit in the stomatogastric ganglion of the crab. The application of unsupervised methods to characterize qualitatively distinct regimes of spiking neural circuits is very interesting and novel, and the manuscript provides a comprehensive demonstration of its utility by analyzing dynamical variability in function and dysfunction in an important rhythm–generating circuit. The system is highly tractable with small numbers of neurons, and the study here provides an important new characterization of the system that can be used to further understand the mapping between gene expression, circuit activity, and functional regimes. The explicit note about the importance of visualization and manual labeling was also nice, since this is often brushed under the rug in other studies.</p><p>While the specific analysis pipeline clearly identifies qualitatively distinct regimes of spike patterns in the LP/PD neurons, it is not clear how much of this is due to t–SNE itself vs the initial pre–processing and feature definition (ISI and spike phase percentiles). Analyses that would help clarify this would be to check whether the same clusters emerge after (1) applying ordinary PCA to the feature vectors and plotting the projections of the data along the first two PCs, or (2) defining input features as the concatenated binned spike rates over time of the LP &amp; PD neurons (which would also yield a fixed–length vector per 20 s trial), and then passing these inputs to PCA or t–SNE. As the significance of this work is largely motivated by using unsupervised vs ad hoc descriptors of circuit dynamics, it will be important to clarify how much of the results derive from the use of ISI and phase representation percentiles, etc. as input features, vs how much emerge from the dimensionality reduction.</p><p>Please define all acronyms when they are introduced.</p><p>Why is 20 seconds chosen as the time window to compute ISIs/phase representations before feeding the data into t–SNE? Is this roughly the window one needs to look at to visually identify differences across dynamical regimes and can the authors explain why?</p><p>It would be useful to note in the manuscript that t–SNE is tuned to preserve local over global similarities, which gives it its utility in clustering. It would also be useful to discuss the relationship of t–SNE to UMAP (McInnes, Healy, Melville 2018 arXiv: https://arxiv.org/abs/1802.03426), another popular dimensionality reduction technique in neuroscience.</p><p>Most uses of t–SNE in biology in the past have been in the context of classifying behavior (e.g. Berman et al. 2014 J R Soc Interface: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4233753/ or Clemens et al. Current Biology 2018: https://www.sciencedirect.com/science/article/pii/S0960982218307735). Including these references would be helpful as a point of comparison and to emphasize the novelty of applying t–SNE to neural spiking data.</p><p>Can the authors comment on how much pyloric rhythms can deviate from the standard triphasic pattern before behavior (or digestion?) is significantly disrupted?</p><p>In Figure 6 it would be helpful to show example time–series going into the transition matrix analysis, with identified state labels at the different timepoints. It wasn't clear whether timepoints were e.g. moment–to–moment, 20 sec chunks, a 20 sec sliding window, etc.</p><p>In Figure 8 it would be helpful to show examples of what bursts look like with and without decentralization, in order to contextualize the quantitative metrics.</p><p>It would also be useful to connect this work in the discussion to modern approaches for identifying model parameter regimes underlying distinct neural activity patterns (see e.g. Bittner et al. 2021 bioRxiv https://www.biorxiv.org/content/10.1101/837567v3)</p><p>[Editors’ note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Mapping circuit dynamics during function and dysfunction&quot; for further consideration by <italic>eLife</italic>. Your revised article has been evaluated by Ronald Calabrese (Senior Editor) and a Reviewing Editor.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below:</p><p>Two reviewer concerns remain, which are explained more fully in the reviews below.</p><p>1. The analysis pipeline outlined in this paper is rather ad hoc. This isn't a general &quot;tool&quot; as it has only been demonstrated in one particular biological system.</p><p>2. It is acceptable for the authors to call the core method (tSNE) unsupervised. The &quot;manual curation&quot; is part of any exploratory data analysis, though it is generally preferable to for this manual curation / interpretation step to be as objective and reproducible as possible (which is arguably not entirely achieved in this paper). The paper can be seen as an investigation into how to apply an existing tool (tSNE) to a very well-studied and simple neural system.</p><p>In revision, we ask the authors to take a final pass through the Introduction and Discussion and to tone down any comments about this being a general, off-the-shelf tool and to note that while the core algorithmic method (tSNE) is unsupervised, there is still the need for expert interpretation of the output.</p><p><italic>Reviewer #1:</italic></p><p>The manuscript has been revised along the lines suggested in both the consensus suggestions and the individual reports. The rewritten Discussion is considerably improved. There is a lot of hard work here, and I've no doubt the results are useful to the PI's lab, and presumably other workers on this CPG.</p><p>To my mind the authors did not really address two of the main concerns of the reviewers: (1) what the purpose of this paper is and (2) the validity of the manual clustering of tSNE. In more detail:</p><p>Purpose of the paper: the paper prominently refers to it introducing an &quot;unsupervised&quot; method/approach (e.g. lines 69-70) and a &quot;tool&quot; (lines 537-541, 711-714). Neither are true: the approach here is by definition not unsupervised as it uses manual curation to identify the clusters upon which all further analyses are based; such manual curation means that the only &quot;tool&quot; parts are using tSNE on a feature vector, which doesn't merit the term. Rather, it seems that the purpose of the paper is instead to provide a cohesive overview of the dynamics of this specific CPG system, by finding a way to systematically combine a large number of separate recordings from baseline and perturbed preparations, thus allowing knowledge discovery (e.g. the types of transitions; the changes in the regular state that precede transitions) on those combined data.</p><p>tSNE and validating the clustering: the authors did considerable work related to this issue, by using their approach on synthetic data, replacing tSNE with UMAP, and by testing simple hierarchical and k-means clustering of their feature vectors. But none of these spoke directly to the validity of the clustering: the synthetic data and UMAP were still manually clustered, so could be made to conform to the desired results; the unsupervised clustering approach used shows the well-known problem that directly clustering a high-dimensional dataset (a 48-dimensional feature vector) is often impossible using classical techniques simply due to the curse of dimensionality. The normal approach here would be to use dimension reduction then unsupervised clustering (e.g. in the classic combination of PCA then k-means), matching the way the two steps are done in the present paper.</p><p>As the paper shows, the clusters found in tSNE by manual curation are arbitrary. For example, changing the perplexity parameter changes the fragmentation of the tSNE map, so would likely lead to different manual clusterings. In another example, the clusters found by manual curation are not all contiguous in the 2D space e.g. the LP-silent cluster is in 3 groups, one of which is on the opposite side of the 2D space to the others – so distance in this space is not interpreted as meaningful for all clusters. In another example, the dividing line between some &quot;clusters&quot; is arbitrarily put in a contiguous run of points – e.g. the LP-weak-skipped (pink) and irregular-bursting (brown).</p><p>So to me it seems we're still left with the original main issues raised, and consequently am still unclear who this paper is aimed at – this is a useful way for the lab who owns that data to organise it, but how useful is it in revealing the structure of dynamics in the CPG, and hence to others? Moreover, though the Discussion is much improved, the paper is still rather descriptive throughout.</p><p>These are clearly subjective concerns, not issues with the quality of the analyses done based on the clustering, which are solid, nor with their interpretation, which has been considerably improved. Nonetheless, I think the paper would still be considerably improved by a concerted redraft, and perhaps reorganisation, to deal with these issues.</p><p><italic>Reviewer #2:</italic></p><p>I appreciate that the authors carefully considered my review and tried new analyses (e.g. hierarchical clustering and UMAP) and have expanded the Discussion section to comment on the issues raised during review. I also agree that &quot;a rigorous error analysis would be useful but is not trivially done&quot; -- and since I do not have a concrete suggestion here, I think the manuscript should be published without one. Overall, I feel that my concerns have been satisfactorily addressed.</p><p><italic>Reviewer #3:</italic></p><p>One small remaining edit that would be helpful is to show the projection of the data onto the first two PCs (re: the PCA analysis referenced in Figure 2-Figure supp 2), so that the reader can visualize what structure there is prior to computing the triadic difference statistics. If not too computationally intensive, it would also be useful to show what emerges from applying a naive clustering or visualization algorithm directly on the spike-train time-series [see (2) in Reviewer #3 major concern], even if only to show that it is quite messy.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.76579.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the authors resubmitted a revised version of the paper for consideration. What follows is the authors’ response to the first round of review.]</p><disp-quote content-type="editor-comment"><p>1. t-SNR is not in itself a clustering algorithm so its resulting 'clusters' should be validated by application of a true clustering algorithm. t–SNE does often provide a nice 2–D embedding that can simplify subsequent clustering. Here the reviewers suggest that the feature vectors themselves should be subjected to clustering algorithm.</p></disp-quote><p>We agree with the reviewers is t-SNE is not in itself a clustering algorithm. We have been careful to use it as a <italic>visualization</italic> and <italic>data reduction</italic> tool, whose strengths are uniquely suited to the task we applied it to. The only clustering we performed in the original manuscript was entirely manual, using the t-SNE embedding to visualize the data and a tool to quickly inspect the raw spike patterns to guide our clustering. As the reviewers point out, “t-SNE does often provide a nice 2-D embedding that can simplify subsequent clustering”. This is exactly what we did. The strength of our approach is that it made feasible a previously intractable task: manually classifying hundreds of hours of spike patterns from hundreds of animals.</p><p>We agree with the reviewers that this paper can be strengthened by validation of this technique and by also comparing to alternative techniques. We therefore did the following:</p><p>1. We created a synthetic data set with spikes from two neurons drawn from different patterns. We then subjected this data set to the workflow described in the manuscript and found we could recover distinct classes of spike patterns that existed in the synthetic data. This new analysis is shown in Figure 2—figure supplement 4.</p><p>2. In addition, we used another nonlinear dimensionality reduction technique (uMAP) to also embed the feature vectors in two-dimensional space. We do this to emphasize that t-SNE is only a tool to visualize patterns in high dimensional data and is not the only one that can be useful, and that clustering of this data comes not from t-SNE but is a distinct step following embedding (Figure 3— figure supplement 3).</p><p>3. Finally, we use hierarchical clustering to directly cluster the feature vectors. In <xref ref-type="fig" rid="sa2fig1">Author response image 1</xref>, (a) shows how the number of clusters varies with the cutoff chosen. Allowing the cutoff to vary to yield a maximum of 20 clusters, we color the points in the t-SNE embedding by cluster identity (b). The vast majority of the data are grouped into a single cluster, with disparate spike patterns grouped together. This is likely because we used Euclidean distances to determine linkage between clusters, and clustering may be dominated by global rather than local structure in the feature vectors. A similar picture emerges when we use <italic>k</italic>means clustering on the feature vectors (c) Setting the number of clusters <italic>k</italic> = 20. Cluster boundaries do not correspond to sharp discontinuities in spike patterns, as observed by manual inspection. (d) shows the distribution of points in each cluster. These results demonstrate that the methods we propose offer utility beyond naïve hierarchical or <italic>k</italic>-means clustering and are better suited to recover patterns in neural data.</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-76579-sa2-fig1-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>2. The feature vectors are not as well motivated and explained as they should be so that readers in other systems can use the strategy presented here in cases where other features than ISI and spike phase of the activity might be more relevant.</p></disp-quote><p>We have expanded the description of the feature vectors in the Methods:</p><p>Construction of vectorized data frame to go into greater detail. We have included a discussion of why we chose these feature vectors, and proposed alternatives to ease applicability in other systems.</p><disp-quote content-type="editor-comment"><p>3. There was discussion as to whether the framing of the manuscript as a ML pipeline is appropriate, because the pipeline described relies heavily on manual curation. The manual curation should be more explicitly described (with details), and the limitations of this approach – ML followed by manual curation – discussed. Such a pipeline probably can't be as easily downloaded and applied directly to someone else's data, but overall, the community could benefit from more examples/consideration of how to systematically and carefully interleave the use of machine–learning techniques with manual analysis by domain experts but the process should be more explicitly explained.</p></disp-quote><p>The method described here uses a nonlinear dimensionality reduction algorithm to generate a two-dimensional visualization that allows a domain expert to efficiently label and cluster large amounts of data. We agree that this is a manual process that requires human intervention. We have extensively rewritten the Discussion to take this into account and included a section “Applicability to other systems” that goes into detail what needs to be done to apply this method to other circuits. We have included a statement in the Discussion making clear that a drawback of this method is that it is not fully automated and requires a human to inspect data and draw cluster boundaries (lines 532-541).</p><disp-quote content-type="editor-comment"><p>4. Discussion should be revamped to discuss more fully specific insights into the pyloric circuit and the limitations of the analyses presented, for example the omission of the PY neuron activity means that the map as given is incomplete: potentially there are many more states, and hence transitions, within or beyond those already found that correspond to changes in PY neuron activity.</p></disp-quote><p>We agree with the reviewers that the omission of the PY neurons’ activity means that the map is incomplete. There are likely many more states, and hence many more transitions, than the ones we have identified. In addition, we note that there are other pyloric neurons whose activity is also missing (AB, IC, LPG, VD). However, measuring just LP and PD allows us to monitor the activity of the most important functional antagonists in the system (because they are effectively in a half-center oscillator because PD is electrically coupled to AB). In general, the more neurons one measures, the richer the description of the circuit dynamics will be, and the more transitions one will observe. Collecting datasets at this scale (~500 animals) from all pyloric neurons is challenging, and we have revised the manuscript to make this important point (see Discussion: Technical considerations).</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>The authors sought to establish a standardized quantitative approach to categorize the activity patterns in a central pattern generator (specifically, the well–studied pyloric circuit in C. borealis). While it is easy to describe these patterns under &quot;normal&quot; conditions, this circuit displays a wide range of irregular behaviors under experimental perturbations. Characterizing and cataloguing these irregular behaviors is of interest to understand how the network avoids these dysfunctional patterns under &quot;normal&quot; circumstances.</p><p>The authors draw upon established machine learning tools to approach this problem. To do so, they must define a set of features that describe circuit activity at a moment in time. They use the distribution of inter–spike–intervals ISIs and spike phases of the LP and PD neuron as these features. As the authors mention in their Discussion section, these features are highly specialized and adapted to this particular circuit. This limits the applicability of their approach to other circuits with neurons that are unidentifiable or very large in number (the number of spike phase statistics grows quadratically with the number of neurons).</p></disp-quote><p>We agree with the reviewer that the size of the feature vectors as described grows quadratically with the number of neurons. The feature sets we describe are most suited for “identified” neurons – neurons whose identity and connectivity are known and can be reliably recorded from multiple animals. The method described here is best suited for systems with small numbers of identified neurons. For other systems, other feature vectors may be chosen, as we have suggested in the Discussion: Applicability to other systems.</p><disp-quote content-type="editor-comment"><p>The main results of the paper provide evidence that ISIs and spike phase statistics provide a reasonable descriptive starting point for understanding the diversity of pyloric circuit patterns. The authors rely heavily on t–distributed stochastic neighbor embedding (tSNE), a well–known nonlinear dimensionality reduction method, to visualize activity patterns in a low–dimensional, 2D space. While effective, the outputs of tSNE have to be interpreted with great care (Wattenberg, et al., &quot;How to Use t–SNE Effectively&quot;, Distill, 2016. http://doi.org/10.23915/distill.00002). I think the conclusions of this paper would be strengthened if additional machine learning models were applied to the ISI and spike phase features, and if those additional models validated the qualitative results shown by tSNE. For example, tSNE itself is not a clustering method, so applying clustering methods directly to the high–dimensional data features would be a useful validation of the apparent low–dimensional clusters shown in the figures.</p></disp-quote><p>We thank the reviewer for these suggestions and agree with the reviewer that t-SNE is not a clustering method, and directly clustering on t-SNE embeddings is rife with complexities. Instead, we have used t-SNE to generate a visualization that allows domain experts to quickly label and cluster large quantities of data. This makes a previously intractable task feasible, and offers some basic guarantees on quality (e.g., no one data point can have two labels, because labels derive from position of data points in two-dimensional space). In addition:</p><p>– We used uMAP, another dimensionality reduction algorithm, to perform the embedding step, and colored points by the original t-SNE embedding. (Figure 3—figure supplement 3). Large sections of the map are still strikingly colored in single colors, suggesting that the manual clustering did not depend on the details of the t-SNE algorithm, but is rather informed by the statistics of the data.</p><p>We validated our method using synthetic data. We generated synthetic spike trains from different “classes” and embedded the resultant feature vectors using t-SNE. Data from different classes are not intermingled and form tight “clusters” (Figure 2 —figure supplement 4).</p><p>– Finally, we attempted to use hierarchical clustering to cluster the raw feature vectors and were not able to find a reasonable portioning of the linkage tree that separated qualitatively different spike patterns (Figure at the top of this document). We speculate that this is because feature vectors may contain outliers that bias clustering algorithms that attempt to preserve global distance to lump the majority of the data into a single cluster, in order to differentiate outliers from the bulk of the data.</p><disp-quote content-type="editor-comment"><p>The authors do show that the algorithmically defined clusters agree with expert–defined clusters. (Or, at least, they show that one can come up with reasonable post–hoc explanations and interpretations of each cluster). The very large cluster of &quot;regular&quot; patterns – shown typically in a shade of blue – actually looks like an archipelago of smaller clusters that the authors have reasoned should be lumped together. Thus, while the approach is still a useful data–driven tool, a non–trivial amount of expert knowledge is baked into the results. A central challenge in this line of research is to understand how sensitive the outcomes are to these modeling choices, and there is unlikely to be a definitive answer.</p></disp-quote><p>We agree with the reviewer entirely.</p><disp-quote content-type="editor-comment"><p>Nonetheless, the authors show results which suggest that this analysis framework may be useful for the community of researchers studying central pattern generators. They use their method to qualitatively characterize a variety of network perturbations – temperature changes, pH changes, decentralization, etc.</p><p>In some cases it is difficult to understand the level of certainty in these qualitative observations. A first look at Figure 5a suggests that three different kinds of perturbations push the circuit activity into different dysfunctional cluster regions. However, the apparent spatial differences between these three groups of perturbations might be due to animal–level differences (i.e. each preparation produces multiple points in the low–D plot, so the number of effective statistical replicates is smaller than it appears at first glance). Similarly, in Figure 9, it is somewhat hard to understand how much the state occupancy plots would change if more animals were collected –– with the exception of proctolin, there are ~25 animals and 12 circuit activity clusters which may not be a favorable ratio. It would be useful if a principled method for computing &quot;error bars&quot; on these occupancy diagrams could be developed. Similar &quot;error bars&quot; on the state transition diagrams (e.g. Figure 6a) would also be useful.</p></disp-quote><p>We agree with the reviewer. Despite this paper containing data from hundreds of animals, the dataset may not be sufficiently large to perform some necessary statistical checks. We agree with the reviewer that a more rigorous error analysis would be useful but is not trivially done.</p><disp-quote content-type="editor-comment"><p>Finally, one nagging concern that I have is that the ISIs and spike phase statistics aren't the ideal features one would use to classify pyloric circuit behaviors. Sub–threshold dynamics are incredibly important for this circuit (e.g. due to electrical coupling of many neurons). A deeper discussion about what is potentially lost by only having access to the spikes would be useful.</p></disp-quote><p>We agree with the reviewer that spike times aren’t the ideal feature to use to describe circuit dynamics. This is especially true in the STG, where synapses are graded, and coupling between cells can persist without spiking. However, the data required simply do not exist, as it requires intracellular recordings, which are substantially harder to perform (and maintain over challenging perturbations) than extracellular recordings.</p><p>Finally, the signal to the muscles – arguably the physiologically and functionally relevant signal – is the spike signal, suggesting that spike patterns from the pyloric circuit are a useful feature to measure. Nevertheless, this is an important point, and we thank the reviewer for raising it, and we have included it in the section titled Discussion: Technical considerations.</p><disp-quote content-type="editor-comment"><p>Overall, I think this work provides a useful starting point for large–scale quantitative analysis of CPG circuit behaviors, but there are many additional hurdles to be overcome.</p><p>Reviewer #2:</p><p>This manuscript uses the t–SNE dimensionality reduction technique to capture the rich dynamics of the pyloric circuit of the crab.</p><p>Strengths:</p><p>– The integration of a rich data–set of spiking data from the pyloric circuit.</p><p>– Use of nonlinear dimension reduction (t–SNE) to visualise that data.</p><p>– Use of clusters from that t–SNE visualisation to create subsets of data that are amenable to consistent analyses (such as using the &quot;regular&quot; cluster as a basis for surveying the types of dynamics possible in baseline conditions).</p><p>– Innovative use of the cluster types to describe transitions between dynamics within the baseline state and within perturbed states (whether by changes to exogenous variables, cutting nerves, or applying neuromodulators).</p><p>Some interesting main results:</p><p>– Baseline variability in the spiking patterns of the pyloric circuit is greater within than between animals.</p><p>– Transitions to silent states often (always?) pass through the same intermediate state of the LP neuron skipping spikes</p><p>Weaknesses:</p><p>– t-SNE is not, in isolation, a clustering algorithm, yet here it is treated as such. How the clusters were identified is unclear: the manuscript mentions manual curation of randomly sampled points, implying that the clusters were extrapolations from these. This would seem to rather defeat the point of using unsupervised techniques to obtain an unbiased survey of the spiking dynamics and raises the issue of how robust the clusters are.</p></disp-quote><p>We have used t-SNE to visualize the circuit dynamics in a two-dimensional map. We have exploited t-SNE’s ability to preserve local structure to generate an embedding where a domain expert can efficiently manually identify and label stereotyped clusters of activity. As the author points out, this is a manual step, and we have emphasized this in the manuscript. The strength of our approach is to combine the power of a nonlinear dimensionality reduction technique such as t-SNE with human curation to make a task that was previously impossible (identifying and labelling very large datasets of neural activity) feasible.</p><p>To address the question of how robust the manually identified clusters are, we have:</p><p>1. Used another dimensionality reduction technique, uMAP, to generate an embedding and colored points by the original t-SNE map (Figure 3 —figure supplement 3). To rough approximation, the coloring reveals that a similar clustering exists in this uMAP embedding.</p><p>2. We generated synthetic spike trains from pre-determined spike pattern classes and used the feature vector extraction and t-SNE embedding procedure as described in the paper. We found that this generated a map (Figure 2—figure supplement 4) where classes of spike patterns were well separated in the t-SNE space.</p><disp-quote content-type="editor-comment"><p>– The main purpose and contribution of the paper is unclear, as the results are descriptive, and mostly state that dynamics in some vary between different states of the circuit; while the collated dataset is a wonderful resource, and the map is no doubt useful for the lab to place in context what they are looking at, it is not clear what we learn about the pyloric circuit, or more widely about the dynamical repertoire of neural circuits.</p><p>– In some places the contribution is noted as being the pipeline of analysis: unfortunately as the pipeline used here seems to rely in manual curation, it is of limited general use; moreover, there are already a number of previous works that use unsupervised machine–learning pipelines to characterise the complexity of spiking activity across a large data–set of neurons, using the same general approach here (quantify properties of spiking as a vector; map/cluster using dimension reduction), including Baden et al. (2016, Nature), Bruno et al. (2015, Neuron), Frady et al. (2016, Neural Computation).</p><p>Some key limitations are not considered:</p><p>– The omission of the PY neuron activity means that the map as given is incomplete: potentially there are many more states, and hence transitions, within or beyond those already found that correspond to changes in PY neuron activity.</p></disp-quote><p>We agree with the reviewer that the omission of the PY neurons’ activity means that the map is incomplete. There are likely many more states, and hence many more transitions, than the ones we have identified. In addition, we note that there are other pyloric neurons whose activity is also missing (AB, IC, LPG, VD). However, measuring just LP and PD allows us to monitor the activity of the most important functional antagonists in the system (because they are effectively in a half-center oscillator because PD is electrically coupled to AB). In general, the more neurons one measures, the richer the description of the circuit dynamics will be. Collecting datasets at this scale (~500 animals) from all pyloric neurons is challenging, and we have revised the manuscript to make this important point (see Discussion: Technical considerations).</p><disp-quote content-type="editor-comment"><p>– The use of long, non–overlapping time segments (20s) – this means, for example, that the transitions are slow and discrete, whereas in reality they may be abrupt, or continuous.</p></disp-quote><p>We agree with the reviewer. There are tradeoffs in choosing a bin size in analyzing time series – choosing longer bins can increase the number of “states” and choosing shorter bins can increase the number of transitions. We chose 20s bins because it is long enough to include several cycles of the pyloric rhythm, even when decentralized, yet was short enough to resolve slow changes in spiking. We have included a statement clarifying this (see Discussion: Technical considerations).</p><disp-quote content-type="editor-comment"><p>– tSNE cannot capture hierarchical structure, nor has a null model to demonstrate that the underlying data contains some clustering structure. So, for example, distances measured on the map may not be strictly meaningful if the data is hierarchical.</p></disp-quote><p>We agree with the reviewer. t-SNE can manifest clusters when none exist (Section 4 of https://distill.pub/2016/misread-tsne/) and can obscure or merge true clusters. We have restricted analyses that rely on distances measured in the map to cases where there are qualitative differences in behavior (e.g., with decentralization, Figure 7) or have compared distances within subsets of data where a single parameter is changed (e.g., pH or temperature, Figure 5). The only conclusion we draw from these distance measures is that data are more (or less) spread out in the map, which we use as a proxy for variability. We have included a statement, discussion limitations of using t-SNE (Discussion: Comparison with other methods).</p><disp-quote content-type="editor-comment"><p>– The Discussion does not include enough insight and contextualisation of the results.</p></disp-quote><p>We have completely rewritten the discussion to address this.</p><disp-quote content-type="editor-comment"><p>Recommendations:</p><p>Explain and validate the clusters:</p><p>– The paper explains only that the clusters were assigned by manual curation of randomly sampled points. How then were all points assigned to clusters given that sample? What metric was used?</p></disp-quote><p>We have added a new section in the Methods (Manual clustering and annotation of data) that describes this process.</p><disp-quote content-type="editor-comment"><p>– We would suggest validating the clusters by using a clustering algorithm to recover them (approximately) from the vectors.</p></disp-quote><p>We have validated the clusters and the embedding algorithm by:</p><p>1. Creating a synthetic data set with spikes from two neurons drawn from different patterns. We then subjected this data set to the workflow described in the manuscript and found we could recover distinct classes of spike patterns that existed in the synthetic data. This new analysis is shown in Figure 2—figure supplement 4.</p><p>2. In addition, we used another nonlinear dimensionality reduction technique (uMAP) to also embed the feature vectors in two-dimensional space. We do this to emphasize that t-SNE is only a tool to visualize patterns in high dimensional data and is not the only one that can be useful, and that clustering of this data comes not from t-SNE but is a distinct step following embedding. (Figure 3— figure supplement 3)</p><p>3. Finally, we use hierarchical clustering to directly cluster the feature vectors. <xref ref-type="fig" rid="sa2fig1">Author response image 1</xref>, (a) shows how the number of clusters varies with the cutoff chosen. Allowing the cutoff to vary to yield a maximum of 20 clusters, we color the points in the t-SNE embedding by cluster identity (b). The vast majority of the data is grouped into a single cluster, with disparate spike patterns grouped together. This is likely because we used Euclidean distances to determine linkage between clusters, and clustering may be dominated by global rather than local structure in the feature vectors. A similar picture emerges when we use kmeans clustering on the feature vectors (c) setting the number of clusters k = 20. Cluster boundaries do not correspond to sharp discontinuities in spike patterns, as observed by manual inspection. (d) shows the distribution of points in each cluster. These results demonstrate that the methods we propose offer utility beyond naïve hierarchical or k-means clustering and are better suited to recover patterns in neural data.</p><disp-quote content-type="editor-comment"><p>Clarify the paper's goals and contributions:</p><p>– As noted above, the use of an unsupervised pipeline to map spiking activity is not novel; the survey of data is interesting, but purely descriptive. The key contributions were then not obvious to this reader – please clarify. To give some suggestions, while reading 3 possible contributions came to mind, but none quite fit: if the paper is an announcement of the dataset, then the datasets need a detailed explanation; if the paper is the introduction of a pipeline, then the pipeline ought to be fully unsupervised, else it is of little use outside the hands of the present lab; if the paper is about insights into the pyloric circuit, then conclusions and insights ought to be drawn from the descriptive results</p><p>Improve the Discussion:</p><p>– Explicitly link the results to insights into the pyloric circuit. The abstract states &quot;strong mechanistically interpretable links between complex changes in the collective behavior of a neural circuit and specific experimental manipulations&quot; – but only the short section on &quot;Diversity and stereotypy in trajectories from functional to crash states&quot; touches on this.</p></disp-quote><p>We have rewritten the entire Discussion. A new section (Linking circuit outputs to circuit mechanisms) reviewers links between our results and what we learn about the pyloric circuit.</p><disp-quote content-type="editor-comment"><p>– Long section on other clustering methods is a survey of some alternatives and draws no conclusions about why tSNE was chosen here: either use to justify tSNE, or omit.</p></disp-quote><p>We have removed this section.</p><disp-quote content-type="editor-comment"><p>– Lines 678–716 are not based on any results in the paper</p></disp-quote><p>We have removed this section.</p><disp-quote content-type="editor-comment"><p>Discuss limitations:</p><p>– The omission of the PY neuron activity means that the map as given is incomplete – what might it look like with it (new states, new transitions etc)?</p></disp-quote><p>We agree with the reviewer that the omission of the PY neurons’ activity means that the map is incomplete. There are likely many more states, and hence many more transitions, than the ones we have identified. In addition, we note that there are other pyloric neurons whose activity is also missing (AB, IC, LPG, VD). However, measuring just LP and PD allows us to monitor the activity of the most important functional antagonists in the system (because they are effectively in a half-center oscillator because PD is electrically coupled to AB). In general, the more neurons one measures, the richer the description of the circuit dynamics will be. Collecting datasets at this scale (~500 animals) from all pyloric neurons is challenging, and we have revised the manuscript to make this important point (see Discussion: Technical considerations).</p><disp-quote content-type="editor-comment"><p>– The transitions are slow and discrete by design (20 s long segments), whereas in reality they may be abrupt, or continuous.</p></disp-quote><p>We agree with the reviewer. There are tradeoffs in choosing a bin size in analyzing time series – choosing longer bins can increase the number of “states” and choosing shorter bins can increase the number of transitions. We chose 20s bins because it is long enough to include several cycles of the pyloric rhythm, even when decentralized, yet was short enough to resolve slow changes in spiking. We have added a new section called “Technical considerations” to make this important point.</p><disp-quote content-type="editor-comment"><p>– tSNE's limitations and their implications e.g. it cannot capture hierarchical structure, nor has a null model to demonstrate that the underlying data contains some clustering structure.</p></disp-quote><p>This is an important point. We have added this to a new section in the Discussion called “Technical considerations”.</p><disp-quote content-type="editor-comment"><p>– Why those features of the spike–trains, and how would the map change if features were omitted or added? (e.g. the regularity of spiking).</p></disp-quote><p>We have repeated the embedding deleting randomly chosen columns in our matrix of feature vectors. This gives us some insight into whether our results are strongly dependent on any one feature. In the following figure, each panel shows the result of embedding following the deletion of a randomly chosen column in the feature matrix. All coloring is from the original map. All maps look similar, and gross features of the map are preserved, suggesting that the map does not depend sensitively on any one feature.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>Gorur–Shandilya et al. apply an unsupervised dimensionality reduction (t–SNE) to characterize neural spiking dynamics in the pyloric circuit in the stomatogastric ganglion of the crab. The application of unsupervised methods to characterize qualitatively distinct regimes of spiking neural circuits is very interesting and novel, and the manuscript provides a comprehensive demonstration of its utility by analyzing dynamical variability in function and dysfunction in an important rhythm–generating circuit. The system is highly tractable with small numbers of neurons, and the study here provides an important new characterization of the system that can be used to further understand the mapping between gene expression, circuit activity, and functional regimes. The explicit note about the importance of visualization and manual labeling was also nice, since this is often brushed under the rug in other studies.</p><p>While the specific analysis pipeline clearly identifies qualitatively distinct regimes of spike patterns in the LP/PD neurons, it is not clear how much of this is due to t–SNE itself vs the initial pre–processing and feature definition (ISI and spike phase percentiles). Analyses that would help clarify this would be to check whether the same clusters emerge after (1) applying ordinary PCA to the feature vectors and plotting the projections of the data along the first two PCs, or (2) defining input features as the concatenated binned spike rates over time of the LP &amp; PD neurons (which would also yield a fixed–length vector per 20 s trial), and then passing these inputs to PCA or t–SNE. As the significance of this work is largely motivated by using unsupervised vs ad hoc descriptors of circuit dynamics, it will be important to clarify how much of the results derive from the use of ISI and phase representation percentiles, etc. as input features, vs how much emerge from the dimensionality reduction.</p></disp-quote><p>We agree with the reviewer that is important to clarify how much of our results come from the data itself, and how we parameterize them using ISIs and phases, and how much comes from the choice of t-SNE as a dimensionality reduction algorithm. We have addressed this concern in the following ways:</p><p>1. We used principal components analysis on the feature vectors and measured triadic differences in features such as the period and duty cycle of the PD neuron. We found that triadic differences were lower in the t-SNE embedding than in the first two PCA features, or in shuffled t-SNE embeddings (Figure 2– Figure supplement 2), suggesting that the embedding is creating a useful representation that captures key features of the data.</p><p>2. We have used uMAP to reduce the dimensionality of the feature matrix to two dimensions and found that it too preserved the coarse features of the embedding that we observe with t-SNE. Coloring the uMAP embedding by the t-SNE labels revealed that the overall classification scheme was intact (Fig 3 – figure supplement 3).</p><p>3. We generated a synthetic dataset and applied the unsupervised part of our algorithm to it (conversion to ISIs, phases, etc., then t-SNE). We colored the points in the t-SNE embedding by the category in the synthetic dataset. We found that categories were well separated in the t-SNE plot, and each cluster tended to have a single color. This validates the overall power of our approach and shows that it can recover clustering information in large spike sets (Figure 2—figure supplement 4).</p><p>4. We have run k-means and hierarchical clustering on the feature vectors directly and shown that our method is superior to these naïve clustering algorithms running on the feature vectors. We speculate that this is because these clustering methods attempt to partition the full space using global distances, at the expense of distance along the manifold on which the data is located. Algorithms like t-SNE are biased towards local distances, and discount global distances between points outside a neighborhood, and are this better suited here.</p><disp-quote content-type="editor-comment"><p>Please define all acronyms when they are introduced.</p></disp-quote><p>Fixed.</p><disp-quote content-type="editor-comment"><p>Why is 20 seconds chosen as the time window to compute ISIs/phase representations before feeding the data into t–SNE? Is this roughly the window one needs to look at to visually identify differences across dynamical regimes and can the authors explain why?</p></disp-quote><p>Binning and analyzing data in bins is routine in any time-series analysis. 20s bins were chosen to be large enough that there are rich spike patterns within the bin, and small enough so that long-term changes could be visualized as changes in states. Smaller bins increase the number of points that need to be embedded. We have added a statement about this to the section titled Discussion: Technical considerations.</p><disp-quote content-type="editor-comment"><p>It would be useful to note in the manuscript that t–SNE is tuned to preserve local over global similarities, which gives it its utility in clustering. It would also be useful to discuss the relationship of t–SNE to UMAP (McInnes, Healy, Melville 2018 arXiv: https://arxiv.org/abs/1802.03426), another popular dimensionality reduction technique in neuroscience.</p></disp-quote><p>We have revised the manuscript to include using uMAP to perform the dimensionality reduction instead of t-SNE (Figure 3 – figure supplement 3). As we pointed out in the original manuscript (lines 885), recent work (Kobak and Linderman 2021) has found that t-SNE and uMAP are more similar than previously thought, with differences arising substantially from differences in initialization.</p><disp-quote content-type="editor-comment"><p>Most uses of t–SNE in biology in the past have been in the context of classifying behavior (e.g. Berman et al. 2014 J R Soc Interface: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4233753/ or Clemens et al. Current Biology 2018: https://www.sciencedirect.com/science/article/pii/S0960982218307735). Including these references would be helpful as a point of comparison and to emphasize the novelty of applying t–SNE to neural spiking data.</p></disp-quote><p>We cite Berman <italic>et al.</italic> and other relevant papers for these reasons (line 551 in original manuscript).</p><disp-quote content-type="editor-comment"><p>Can the authors comment on how much pyloric rhythms can deviate from the standard triphasic pattern before behavior (or digestion?) is significantly disrupted?</p></disp-quote><p>Unfortunately, there are very few studies of motor patterns in intact animals, and it would be very hard to know how much real disruption of food movement would occur, even if the pyloric rhythm were somewhat disrupted. So sadly, we have no idea how to answer this question. That said, the pyloric rhythm is remarkably reliable in vivo under normal conditions.</p><disp-quote content-type="editor-comment"><p>In Figure 6 it would be helpful to show example time–series going into the transition matrix analysis, with identified state labels at the different timepoints. It wasn't clear whether timepoints were e.g. moment–to–moment, 20 sec chunks, a 20 sec sliding window, etc.</p></disp-quote><p>Time series of states are shown in Fig 5—figure supplement 1. Transition analysis was performed taking care only to measure transitions in contiguous chunks of data. All analysis in the manuscript uses 20s non-overlapping bins. We have added a sentence clarifying this in the Results.</p><disp-quote content-type="editor-comment"><p>In Figure 8 it would be helpful to show examples of what bursts look like with and without decentralization, in order to contextualize the quantitative metrics.</p></disp-quote><p>We have included a new figure supplement (Figure 8 – figure supplement 1) showing example traces before and after decentralization.</p><disp-quote content-type="editor-comment"><p>It would also be useful to connect this work in the discussion to modern approaches for identifying model parameter regimes underlying distinct neural activity patterns (see e.g. Bittner et al. 2021 bioRxiv https://www.biorxiv.org/content/10.1101/837567v3)</p></disp-quote><p>This is an interesting topic for further discussion, and is beyond the scope of our paper. In this manuscript we do not try to infer parameters of a mechanistic model that can generate these data; instead we focus on trying to understand the structure of the data and what stereotyped patterns we observe in it.</p><p>[Editors’ note: what follows is the authors’ response to the second round of review.]</p><disp-quote content-type="editor-comment"><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below:</p><p>Two reviewer concerns remain, which are explained more fully in the reviews below.</p><p>1. The analysis pipeline outlined in this paper is rather ad hoc. This isn't a general &quot;tool&quot; as it has only been demonstrated in one particular biological system.</p></disp-quote><p>We agree with the reviewers that this isn’t a general “tool” and we have demonstrated the utility of this approach only in one biological system. We have revised all descriptions of our approach to remove the word “tool”. Even though we have limited ourselves to a single circuit type, we have shown that our approach allows us to ask many interesting questions of the system and refer the reader to the Discussion section where we talk about its applicability to other systems.</p><disp-quote content-type="editor-comment"><p>2. It is acceptable for the authors to call the core method (tSNE) unsupervised. The &quot;manual curation&quot; is part of any exploratory data analysis, though it is generally preferable to for this manual curation / interpretation step to be as objective and reproducible as possible (which is arguably not entirely achieved in this paper). The paper can be seen as an investigation into how to apply an existing tool (tSNE) to a very well-studied and simple neural system.</p><p>In revision, we ask the authors to take a final pass through the Introduction and Discussion and to tone down any comments about this being a general, off-the-shelf tool and to note that while the core algorithmic method (tSNE) is unsupervised, there is still the need for expert interpretation of the output.</p></disp-quote><p>We have carefully revised the Introduction and Discussion and removed any statements suggesting that our approach is an off-the-shelf tool and have revised its description to be explicit about what we did. We have explicitly stated that our approach requires manual annotation and classification of spike patterns (Introduction lines 68-71; Results – Visualization of circuit dynamics allows manual labelling and clustering of data; Discussion lines 494, 531, 623-631, 676-684).</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>The manuscript has been revised along the lines suggested in both the consensus suggestions and the individual reports. The rewritten Discussion is considerably improved. There is a lot of hard work here, and I've no doubt the results are useful to the PI's lab, and presumably other workers on this CPG.</p><p>To my mind the authors did not really address two of the main concerns of the reviewers: (1) what the purpose of this paper is and (2) the validity of the manual clustering of tSNE. In more detail:</p><p>Purpose of the paper: the paper prominently refers to it introducing an &quot;unsupervised&quot; method/approach (e.g. lines 69-70) and a &quot;tool&quot; (lines 537-541, 711-714). Neither are true: the approach here is by definition not unsupervised as it uses manual curation to identify the clusters upon which all further analyses are based; such manual curation means that the only &quot;tool&quot; parts are using tSNE on a feature vector, which doesn't merit the term.</p></disp-quote><p>We agree with the reviewer. We have removed all references to “unsupervised” in isolation and made it clear that t-SNE is an unsupervised method, but what we have done requires manual identification and labelling of clusters.</p><p>We further agree that the use of “tool” isn’t warranted. We have removed “tool” from all references to what we did and rephrased to make it clear that what we did uses both an off-the-shelf tool (t-SNE) and expert annotation.</p><disp-quote content-type="editor-comment"><p>Rather, it seems that the purpose of the paper is instead to provide a cohesive overview of the dynamics of this specific CPG system, by finding a way to systematically combine a large number of separate recordings from baseline and perturbed preparations, thus allowing knowledge discovery (e.g. the types of transitions; the changes in the regular state that precede transitions) on those combined data.</p></disp-quote><p>We agree with the reviewers’ assessment of our paper. This is indeed the purpose of this paper, and we hope it is clearer to the reader now that we have focused our attention on this.</p><disp-quote content-type="editor-comment"><p>tSNE and validating the clustering: the authors did considerable work related to this issue, by using their approach on synthetic data, replacing tSNE with UMAP, and by testing simple hierarchical and k-means clustering of their feature vectors. But none of these spoke directly to the validity of the clustering: the synthetic data and UMAP were still manually clustered, so could be made to conform to the desired results;</p></disp-quote><p>We apologize for not being clear – we did not manually re-cluster either the synthetic data or the UMAP embedding. We used the labelling generated in the original t-SNE map to color all other maps (t-SNE embeddings with different parameters, initializations, UMAP embeddings). The fact that these other maps appear “clustered” even when we use the original labelling offers (qualitative) evidence that the heavy lifting in the labelling isn’t being done by the human but by the dimensionality reduction technique we used. Similarly, we did not re-color or label clusters in the synthetic data embedding (Figure 2—figure supplement 5). The fact that clusters are almost entirely of a single color suggests that the first part of our method (feature reduction + t-SNE) is powerful enough that separating clusters in the synthetic data is largely trivial by a human.</p><disp-quote content-type="editor-comment"><p>The unsupervised clustering approach used shows the well-known problem that directly clustering a high-dimensional dataset (a 48-dimensional feature vector) is often impossible using classical techniques simply due to the curse of dimensionality. The normal approach here would be to use dimension reduction then unsupervised clustering (e.g. in the classic combination of PCA then k-means), matching the way the two steps are done in the present paper.</p></disp-quote><p>We thank the reviewer for this suggestion. We have added a new figure (Figure 2—figure supplement 2) showing the first two principal components of the feature vectors. We applied k-means to the first ten principal vectors and colored the dots in both the projection of the first two principal components and the t-SNE embedding using this k-means clustering, demonstrating the point the reviewer makes.</p><disp-quote content-type="editor-comment"><p>As the paper shows, the clusters found in tSNE by manual curation are arbitrary. For example, changing the perplexity parameter changes the fragmentation of the tSNE map, so would likely lead to different manual clusterings.</p></disp-quote><p>Figure 2—figure supplement 4 shows the opposite. We use the same coloring for all perplexities, and we see that as long as the perplexity is sufficiently high, we get qualitatively the same result. If one were to manually re-cluster embeddings at higher perplexities, the result would be similar.</p><disp-quote content-type="editor-comment"><p>In another example, the clusters found by manual curation are not all contiguous in the 2D space e.g. the LP-silent cluster is in 3 groups, one of which is on the opposite side of the 2D space to the others – so distance in this space is not interpreted as meaningful for all clusters.</p></disp-quote><p>This is correct. We previously reasoned that most of the distance measurements were between pairs of points within the same cluster, but we agree with the reviewer that we did not rigorously show this. We have removed all distance-based metrics and plots from the paper, because it is confounded by this effect.</p><disp-quote content-type="editor-comment"><p>In another example, the dividing line between some &quot;clusters&quot; is arbitrarily put in a contiguous run of points – e.g. the LP-weak-skipped (pink) and irregular-bursting (brown).</p></disp-quote><p>This is correct. This stems from a smooth variation in observed spike patterns between one canonical form to another, so there truly is no discontinuity when the raw spike patterns are observed. This can be seen clearly in our interactive visualization of the data (a preview of which is available at https://srinivas.gs/stg). When putting smoothly varying data into categorical bins, this is unavoidable. A strength of our visualization method is that it is clear when there exist clear distinctions between categories (e.g., between PD-weak-skipped and LP-weak-skipped) and when there does not (e.g., between the LP-weak-skipped and irregular bursting, as the reviewer points out).</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>One remaining edit that would be helpful is to show the projection of the data onto the first two PCs (re: the PCA analysis referenced in Figure 2-Figure supp 2), so that the reader can visualize what structure there is prior to computing the triadic difference statistics.</p></disp-quote><p>We show the first two principal components in the new Figure 2 —figure supplement 2.</p><disp-quote content-type="editor-comment"><p>If not too computationally intensive, it would also be useful to show what emerges from applying a naive clustering or visualization algorithm directly on the spike-train time-series [see (2) in Reviewer #3 major concern], even if only to show that it is quite messy.</p></disp-quote><p>There is no straightforward way to do this. If we treat the spike trains as binary series, small shifts in the time of first spike can lead to spurious large differences between similar or identical spike trains. This was our motivation for converting spike trains to ISI sets. Even then, because ISI sets are of arbitrary length, it is not trivial to directly apply a naïve clustering or visualization algorithm.</p></body></sub-article></article>