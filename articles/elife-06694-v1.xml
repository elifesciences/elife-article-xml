<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">06694</article-id><article-id pub-id-type="doi">10.7554/eLife.06694</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Dynamical feature extraction at the sensory periphery guides chemotaxis</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-28191"><name><surname>Schulze</surname><given-names>Aljoscha</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-7"/><xref ref-type="other" rid="par-8"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-28192"><name><surname>Gomez-Marin</surname><given-names>Alex</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="fn" rid="pa1">‡</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-7"/><xref ref-type="other" rid="par-8"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28193"><name><surname>Rajendran</surname><given-names>Vani G</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="pa2">§</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-7"/><xref ref-type="other" rid="par-8"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28194"><name><surname>Lott</surname><given-names>Gus</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28195"><name><surname>Musy</surname><given-names>Marco</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28196"><name><surname>Ahammad</surname><given-names>Parvez</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="pa3">¶</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28197"><name><surname>Deogade</surname><given-names>Ajinkya</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-4"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-20255"><name><surname>Sharpe</surname><given-names>James</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28198"><name><surname>Riedl</surname><given-names>Julia</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="pa4">#</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-7"/><xref ref-type="other" rid="par-8"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28199"><name><surname>Jarriault</surname><given-names>David</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="pa5">‖</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-7"/><xref ref-type="other" rid="par-8"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28200"><name><surname>Trautman</surname><given-names>Eric T</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28201"><name><surname>Werner</surname><given-names>Christopher</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="pa6">**</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con12"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28202"><name><surname>Venkadesan</surname><given-names>Madhusudhan</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="par-5"/><xref ref-type="fn" rid="con13"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-28203"><name><surname>Druckmann</surname><given-names>Shaul</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con14"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-5086"><name><surname>Jayaraman</surname><given-names>Vivek</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con15"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-4023"><name><surname>Louis</surname><given-names>Matthieu</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2267-0262</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-6"/><xref ref-type="other" rid="par-7"/><xref ref-type="other" rid="par-8"/><xref ref-type="fn" rid="con16"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">EMBL-CRG Systems Biology Program</institution>, <institution>Centre for Genomic Regulation</institution>, <addr-line><named-content content-type="city">Barcelona</named-content></addr-line>, <country>Spain</country></aff><aff id="aff2"><label>2</label><institution>Universitat Pompeu Fabra</institution>, <addr-line><named-content content-type="city">Barcelona</named-content></addr-line>, <country>Spain</country></aff><aff id="aff3"><label>3</label><institution>Janelia Research Campus, Howard Hughes Medical Institute</institution>, <addr-line><named-content content-type="city">Ashburn</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Department of Mechanical Engineering and Materials Science</institution>, <institution>Yale University</institution>, <addr-line><named-content content-type="city">New Haven</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">National Centre for Biological Sciences</institution>, <institution>Tata Institute of Fundamental Research</institution>, <addr-line><named-content content-type="city">Bangalore</named-content></addr-line>, <country>India</country></aff><aff id="aff6"><label>6</label><institution>Institucio Catalana de Recerca i Estudis Avancats</institution>, <addr-line><named-content content-type="city">Barcelona</named-content></addr-line>, <country>Spain</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-1056"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>mlouis@crg.eu</email></corresp><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="present-address" id="pa1"><label>‡</label><p>Champalimaud Neuroscience Programme, Champalimaud Centre for the Unknown, Lisbon, Portugal</p></fn><fn fn-type="present-address" id="pa2"><label>§</label><p>Department of Physiology, Anatomy and Genetics, University of Oxford, Oxford, United Kingdom</p></fn><fn fn-type="present-address" id="pa3"><label>¶</label><p>Instart Logic Inc., Palo Alto, United States</p></fn><fn fn-type="present-address" id="pa4"><label>#</label><p>Research Institute of Molecular Pathology, Vienna, Austria</p></fn><fn fn-type="present-address" id="pa5"><label>‖</label><p>Centre des Sciences du Goût et de l'Alimentation, Université de Bourgogne, Dijon, France</p></fn><fn fn-type="present-address" id="pa6"><label>**</label><p>T2Biosystems Inc., Lexington, United States</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>16</day><month>06</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e06694</elocation-id><history><date date-type="received"><day>26</day><month>01</month><year>2015</year></date><date date-type="accepted"><day>30</day><month>05</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Schulze et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Schulze et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-06694-v1.pdf"/><related-article ext-link-type="doi" related-article-type="article-reference" xlink:href="10.7554/eLife.06651"/><abstract><object-id pub-id-type="doi">10.7554/eLife.06694.001</object-id><p>Behavioral strategies employed for chemotaxis have been described across phyla, but the sensorimotor basis of this phenomenon has seldom been studied in naturalistic contexts. Here, we examine how signals experienced during free olfactory behaviors are processed by first-order olfactory sensory neurons (OSNs) of the <italic>Drosophila</italic> larva. We find that OSNs can act as differentiators that transiently normalize stimulus intensity—a property potentially derived from a combination of integral feedback and feed-forward regulation of olfactory transduction. In olfactory virtual reality experiments, we report that high activity levels of the OSN suppress turning, whereas low activity levels facilitate turning. Using a generalized linear model, we explain how peripheral encoding of olfactory stimuli modulates the probability of switching from a run to a turn. Our work clarifies the link between computations carried out at the sensory periphery and action selection underlying navigation in odor gradients.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.001">http://dx.doi.org/10.7554/eLife.06694.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.06694.002</object-id><title>eLife digest</title><p>Fruit flies are attracted to the smell of rotting fruit, and use it to guide them to nearby food sources. However, this task is made more challenging by the fact that the distribution of scent or odor molecules in the air is constantly changing. Fruit flies therefore need to cope with, and exploit, this variation if they are to use odors as cues.</p><p>Odor molecules bind to receptors on the surface of nerve cells called olfactory sensory neurons, and trigger nerve impulses that travel along these cells. While many studies have investigated how fruit flies can distinguish between different odors, less is known about how animals can use variation in the strength of an odor to guide them towards its source.</p><p>Optogenetics is a technique that allows neuroscientists to control the activities of individual nerve cells, simply by shining light on to them. Because fruit fly larvae are almost transparent, optogenetics can be used on freely moving animals. Now, Schulze, Gomez-Marin et al. have used optogenetics in these larvae to trigger patterns of activity in individual olfactory sensory neurons that mimic the activity patterns elicited by real odors. These virtual realities were then used to study, in detail, some of the principles that control the sensory navigation of a larva—as it moves using a series of forward ‘runs’ and direction-changing ‘turns’.</p><p>Olfactory sensory neurons responded most strongly whenever light levels changed rapidly in strength (which simulated a rapid change in odor concentration). On the other hand, these neurons showed relatively little response to constant light levels (i.e., constant odors). This indicates that the activity of olfactory sensory neurons typically represents the rate of change in the concentration of an odor. An independent study by Kim et al. found that olfactory sensory neurons in adult fruit flies also respond in a similar way.</p><p>Schulze, Gomez-Marin et al. went on to show that the signals processed by a single type of olfactory sensory neuron could be used to predict a larva's behavior. Larvae tended to turn less when their olfactory sensory neurons were highly active. Low levels and inhibition of activity in the olfactory sensory neurons had the opposite effect; this promoted turning. It remains to be determined how this relatively simple control principle is implemented by the neural circuits that connect sensory neurons to the parts of a larva's nervous system that are involved with movement.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.002">http://dx.doi.org/10.7554/eLife.06694.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>chemotaxis</kwd><kwd>olfaction</kwd><kwd>optogenetics</kwd><kwd>electrophysiology</kwd><kwd>sensorimotor control</kwd><kwd>computational modeling</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution>Spanish Ministry of Science and Innovation</institution></institution-wrap></funding-source><award-id>BFU2008-00362</award-id><principal-award-recipient><name><surname>Schulze</surname><given-names>Aljoscha</given-names></name><name><surname>Gomez-Marin</surname><given-names>Alex</given-names></name><name><surname>Rajendran</surname><given-names>Vani G</given-names></name><name><surname>Riedl</surname><given-names>Julia</given-names></name><name><surname>Jarriault</surname><given-names>David</given-names></name><name><surname>Louis</surname><given-names>Matthieu</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution>Centre for Genomic Regulation</institution></institution-wrap></funding-source><award-id>EMBL/CRG</award-id><principal-award-recipient><name><surname>Schulze</surname><given-names>Aljoscha</given-names></name><name><surname>Gomez-Marin</surname><given-names>Alex</given-names></name><name><surname>Rajendran</surname><given-names>Vani G</given-names></name><name><surname>Musy</surname><given-names>Marco</given-names></name><name><surname>Deogade</surname><given-names>Ajinkya</given-names></name><name><surname>Sharpe</surname><given-names>James</given-names></name><name><surname>Riedl</surname><given-names>Julia</given-names></name><name><surname>Jarriault</surname><given-names>David</given-names></name><name><surname>Louis</surname><given-names>Matthieu</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute (HHMI)</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Lott</surname><given-names>Gus</given-names></name><name><surname>Ahammad</surname><given-names>Parvez</given-names></name><name><surname>Trautman</surname><given-names>Eric T</given-names></name><name><surname>Werner</surname><given-names>Christopher</given-names></name><name><surname>Druckmann</surname><given-names>Shaul</given-names></name><name><surname>Jayaraman</surname><given-names>Vivek</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id><institution>European Commission (EC)</institution></institution-wrap></funding-source><award-id>FP7 Framework (Marie Curie ITN, FLiACT)</award-id><principal-award-recipient><name><surname>Deogade</surname><given-names>Ajinkya</given-names></name></principal-award-recipient></award-group><award-group id="par-5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001405</institution-id><institution>Tata Insitute of Fundamental research (TIFR)</institution></institution-wrap></funding-source><award-id>(NCBS)</award-id><principal-award-recipient><name><surname>Venkadesan</surname><given-names>Madhusudhan</given-names></name></principal-award-recipient></award-group><award-group id="par-6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute (HHMI)</institution></institution-wrap></funding-source><award-id>Janelia visitor programme</award-id><principal-award-recipient><name><surname>Louis</surname><given-names>Matthieu</given-names></name></principal-award-recipient></award-group><award-group id="par-7"><funding-source><institution-wrap><institution>Spanish Ministry of Science and Innovation</institution></institution-wrap></funding-source><award-id>BFU2011-26208</award-id><principal-award-recipient><name><surname>Schulze</surname><given-names>Aljoscha</given-names></name><name><surname>Gomez-Marin</surname><given-names>Alex</given-names></name><name><surname>Rajendran</surname><given-names>Vani G</given-names></name><name><surname>Riedl</surname><given-names>Julia</given-names></name><name><surname>Jarriault</surname><given-names>David</given-names></name><name><surname>Louis</surname><given-names>Matthieu</given-names></name></principal-award-recipient></award-group><award-group id="par-8"><funding-source><institution-wrap><institution>Spanish Ministry of Science and Innovation</institution></institution-wrap></funding-source><award-id>BFU2009-07757-E/BMC</award-id><principal-award-recipient><name><surname>Schulze</surname><given-names>Aljoscha</given-names></name><name><surname>Gomez-Marin</surname><given-names>Alex</given-names></name><name><surname>Rajendran</surname><given-names>Vani G</given-names></name><name><surname>Riedl</surname><given-names>Julia</given-names></name><name><surname>Jarriault</surname><given-names>David</given-names></name><name><surname>Louis</surname><given-names>Matthieu</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.3</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A computational model for the control of chemotaxis in the <italic>Drosophila</italic> larva clarifies the link between the peripheral encoding of naturalistic olfactory stimuli and action selection.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Chemosensation is an evolutionarily ancient sense found in nearly every living organism. In bacteria, chemotaxis allows individual cells to detect the presence of food and to accumulate in its vicinity. Multicellular organisms have evolved complex sensory systems to track temporal changes in the concentration of volatile odorant molecules relevant to their survival—food odors, pheromones associated with the presence of conspecifics and substances signaling danger. In turn, sensory perception drives behavioral strategies to forage, locate a mating partner and actively avoid danger (<xref ref-type="bibr" rid="bib26">Fraenkel and Gunn, 1961</xref>; <xref ref-type="bibr" rid="bib87">Schöne, 1984</xref>). Bacterial chemotaxis represents the archetype of orientation behavior in unicellular organisms: phases of relatively straight motion—called <italic>runs</italic>—alternate with changes in orientation—called <italic>tumbles</italic>—that randomize the direction of the next run (<xref ref-type="bibr" rid="bib8">Berg, 2004</xref>). Accumulation near the source of an attractive chemical results from the elongation of runs in the direction of the gradient. In multicellular organisms, olfactory behaviors have been investigated in detail in the nematode <italic>Caenorhabditis elegans</italic> (<xref ref-type="bibr" rid="bib5">Bargmann, 2006a</xref>), which uses a combination of undirected turns (‘pirouettes’) and continuous correction of the orientation of individual runs (‘weathervaning’) (<xref ref-type="bibr" rid="bib43">Iino and Yoshida, 2009</xref>; <xref ref-type="bibr" rid="bib63">Lockery, 2011</xref>). The neural computations enabling animals with a central nervous system to orient in odor gradients, however, remain poorly understood.</p><p>The <italic>Drosophila</italic> larva has the smallest known olfactory system analogous to that of vertebrates (<xref ref-type="bibr" rid="bib18">Cobb, 1999</xref>; <xref ref-type="bibr" rid="bib6">Bargmann, 2006b</xref>; <xref ref-type="bibr" rid="bib32">Gerber and Stocker, 2007</xref>; <xref ref-type="bibr" rid="bib98">Vosshall and Stocker, 2007</xref>). The larva achieves robust odor gradient ascents through an alternation of approximately straight runs and turning events (<xref ref-type="bibr" rid="bib37">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib33">Gershow et al., 2012</xref>). The duration of runs is modulated by the sensory input: runs up the gradient are elongated while runs away from it are shortened (<xref ref-type="bibr" rid="bib37">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib33">Gershow et al., 2012</xref>). Although published results hint at how larval chemotaxis may be achieved (<xref ref-type="bibr" rid="bib35">Gomez-Marin and Louis, 2012</xref>, <xref ref-type="bibr" rid="bib36">2014</xref>), a quantitative model of the underlying sensorimotor integration is still missing. Here, we focus on the primary task of the orientation algorithm common to bacteria, <italic>C. elegans</italic>, and <italic>Drosophila</italic>: the control of run duration (<xref ref-type="bibr" rid="bib5">Bargmann, 2006a</xref>; <xref ref-type="bibr" rid="bib63">Lockery, 2011</xref>; <xref ref-type="bibr" rid="bib35">Gomez-Marin and Louis, 2012</xref>). It is known that turns are preceded by stereotyped decreases in odor concentration (<xref ref-type="bibr" rid="bib37">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib35">Gomez-Marin and Louis, 2012</xref>), but the key question of how concentration differences are computed is unresolved.</p><p>In both insects and vertebrates, odor concentrations are represented by time-varying patterns of activity distributed across the olfactory sensory neuron (OSN) population (<xref ref-type="bibr" rid="bib101">Wilson and Mainen, 2006</xref>; <xref ref-type="bibr" rid="bib100">Wilson, 2013</xref>; <xref ref-type="bibr" rid="bib71">Masse et al., 2009</xref>; <xref ref-type="bibr" rid="bib67">Mainland et al., 2014</xref>; <xref ref-type="bibr" rid="bib96">Uchida et al., 2014</xref>). Nonetheless, animals with an olfactory system genetically reduced to a single functional OSN are still capable of robust chemotaxis (<xref ref-type="bibr" rid="bib25">Fishilevich et al., 2005</xref>; <xref ref-type="bibr" rid="bib65">Louis et al., 2008</xref>), implying that the mechanisms of odor concentration detection can be understood at the level of single OSNs. Here, we rely on this simplification to develop a novel larval preparation in which the neural computations underlying odor gradient ascent can be understood in unprecedented detail. We used optogenetics in larvae with a single type of functional OSNs to substitute turbulent olfactory signals with well-controlled light stimulations (<xref ref-type="bibr" rid="bib91">Suh et al., 2007</xref>; <xref ref-type="bibr" rid="bib7">Bellmann et al., 2010</xref>; <xref ref-type="bibr" rid="bib89">Smear et al., 2011</xref>; <xref ref-type="bibr" rid="bib30">Gaudry et al., 2013</xref>). This allowed us to characterize the modulatory effects of OSN firing patterns on the probability of switching from a run to a turn. Toward this goal, we developed a novel tracker to create virtual olfactory realities (<xref ref-type="bibr" rid="bib54">Kocabas et al., 2012</xref>) in which optogenetic stimulations of genetically targeted OSNs are defined based on the behavioral history of the larva. We used this technology to derive a phenomenological model of the OSN transfer function. The model was validated on free behavior in sensory landscapes designed to produce predictable sensorimotor responses, and ultimately, it was found to be applicable to real odor gradients. We found that for positive gradients, the OSN operates as a slope detector: its activity increases with the stimulus derivative, which suppresses the probability of turning. For strongly negative gradients, the OSN acts like an OFF detector: the inhibition of the neural activity facilitates turning in a nearly deterministic manner. Altogether, our results advance our understanding of how peripheral odor encoding guides action selection during chemotaxis.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Run-to-turn transitions as a paradigm for action selection</title><p>Odors are generally attractive to <italic>Drosophila</italic> larvae (<xref ref-type="bibr" rid="bib18">Cobb, 1999</xref>). Exposure to an odor produces gradient ascent even in larvae with a genetically manipulated olfactory system reduced to a single OSN (<xref ref-type="bibr" rid="bib25">Fishilevich et al., 2005</xref>; <xref ref-type="bibr" rid="bib65">Louis et al., 2008</xref>). We examined the behavior of larvae with a single functional OSN expressing Or42a, an odorant receptor with a well-characterized tuning profile that includes the odorant isoamyl acetate (IAA) (<xref ref-type="bibr" rid="bib25">Fishilevich et al., 2005</xref>; <xref ref-type="bibr" rid="bib56">Kreher et al., 2008</xref>; <xref ref-type="bibr" rid="bib4">Asahina et al., 2009</xref>). Behavior was studied in a closed environment with a single source of IAA suspended from the ‘ceiling’ of the arena (<xref ref-type="fig" rid="fig1">Figure 1</xref> and ‘Materials and methods’). For large odor droplets, diffusion from the source creates a radially symmetric gradient that can be approximated by a stationary Gaussian distribution (<xref ref-type="bibr" rid="bib65">Louis et al., 2008</xref>). For smaller odor droplets such as those used in the present study, the temporal evolution of the odor gradient cannot be neglected. We therefore combined infrared spectroscopy (IR) and a partial differential equation (PDE) model to experimentally reconstruct the two-dimensional geometry of the odor gradient over time (see <xref ref-type="fig" rid="fig1">Figure 1B</xref> and ‘Materials and methods’). The simulated odor gradient served as a template to reconstruct the average stimulus time course experienced by the larva during real trajectories (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.003</object-id><label>Figure 1.</label><caption><title>Sensory experience corresponding to unconstrained chemotactic behavior.</title><p>(<bold>A</bold>) Illustrative trajectory of a larva freely moving in an attractive odor gradient (isoamyl acetate, source concentration: 0.25 M). Position of the midpoint shown in black; position of the head shown in magenta. Two run segments, R1 and R2, are underlined in green. Turns are depicted as white disks. White arrows indicate the direction of motion. (<bold>B</bold>) Reconstruction of the odor gradient based on numerical simulations of the odor diffusion process modeled by a partial differential equation (PDE) system with realistic boundary conditions (‘Materials and methods’). The gradient shown in panel <bold>A</bold> corresponds to a snapshot obtained 60 s after onset of the odor diffusion. (<bold>C</bold>) Time course of the odor concentration experienced at the head (magenta) and midpoint (black) of the larva during the trajectory shown in panel <bold>A</bold>. The sensory experiences are reconstructed based on mapping the positions of interest on the dynamic odor gradient computed upon integration of the PDE system for the entire duration of the trajectory. The green box outlines the sensory experience corresponding to run segments R1 and R2. Small disks on the abscissa indicate the turns comprised in this behavioral sequence.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.003">http://dx.doi.org/10.7554/eLife.06694.003</ext-link></p></caption><graphic xlink:href="elife-06694-fig1-v1"/></fig></p><p><xref ref-type="fig" rid="fig1">Figure 1A</xref> presents a trajectory consisting of approximately straight segments (‘runs’) punctuated by large changes in orientation (‘turns’). Where to turn to is determined through lateral exploratory head movements, ‘head casts’, during which the larva scans the local odor gradient (<xref ref-type="bibr" rid="bib37">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib33">Gershow et al., 2012</xref>). On average, larvae terminate their runs when motion is directed down the gradient where the odor concentration is decreasing (<xref ref-type="bibr" rid="bib37">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib33">Gershow et al., 2012</xref>). In contrast, turns are suppressed when the direction of motion is along the gradient and the odor concentration is increasing. We sought to define the neural computations underlying this behavior by characterizing the neural activity of the <italic>Or42a</italic>-expressing OSN in response to changes in odor concentration experienced during chemotactic behavior (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).</p></sec><sec id="s2-2"><title>Peripheral representation of naturalistic olfactory stimuli in a single larval OSN</title><p>To probe the input–output transfer function of the <italic>Or42a</italic> OSN, we devised an extracellular recording technique based on the suction of the antennal nerve into a glass pipette downstream from the dorsal organ (DO) ganglion (<xref ref-type="fig" rid="fig2">Figure 2A</xref> and ‘Materials and methods’). With the use of an optogenetic spike-sorting strategy we identified the spikes originating from the <italic>Or42a</italic> OSN expressing channelrhodopsin (ChR2) (denoted as ‘<italic>Or42a</italic>&gt;ChR2 OSN’) (<xref ref-type="fig" rid="fig2">Figure 2B,C</xref> and ‘Material and methods’). We devised a customized olfactometer to produce odor stimuli with controlled temporal profiles (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) with which we examined the response of the <italic>Or42a</italic>&gt;ChR2 OSN to a concentration replay defined by the stimulus time course associated with the trajectory shown in <xref ref-type="fig" rid="fig1">Figure 1A</xref>. Recordings from this 3-min stimulation led to consistent patterns of neural activity in different preparations (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). Although the OSN activity appeared to follow the envelope of the stimulus time course, a closer examination revealed greater complexity in the neural response. The OSN firing rate displayed a clear amplification of changes in stimulus intensity, as illustrated by the activity associated with the replay of two consecutive runs, R1 and R2 (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). Run R2 brought the larva close to and then beyond the peak of the gradient. When stimulated by the corresponding time course of the odor concentration, OSN activity peaked several seconds before the stimulus intensity (<xref ref-type="fig" rid="fig2">Figure 2F</xref>, arrows). Minute fluctuations in odor concentration were strongly amplified in the OSN spiking dynamics (bursts marked by a sharp # symbol in <xref ref-type="fig" rid="fig2">Figure 2F</xref>).<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.004</object-id><label>Figure 2.</label><caption><title>Response of a single larval olfactory sensory neuron (OSN) to naturalistic odor stimulation.</title><p>(<bold>A</bold>) Illustration of preparation for suction electrode recordings of single functional OSNs expressing channelrhodopsin (ChR2). The preparation is bathed in saline to prevent the dehydration of the dorsal organ ganglion to which the recording electrode is attached. Controlled odor stimulations are achieved in liquid phase with a customized mass flow controller system. (<bold>B</bold>) Recording from the dorsal organ stimulated by a series of 10-ms light pulses. (<bold>i</bold>–<bold>ii</bold>) The voltage trace shows spikes with different amplitudes. (<bold>iii</bold>) Close-up view of the voltage trace corresponding to three consecutive light pulses. Action potentials with a stereotyped waveform are observed at a short-latency after the onset of the light pulse (spikes denoted by a blue star *). These spikes are associated with the activity of the <italic>Or42a</italic> OSN expressing ChR2. Each light pulse yielded an average of 1.8 light-evoked spikes. (<bold>C</bold>) Superimposition of light- and odor-evoked spike waveforms observed for the same OSN. The results of two different recordings are shown in (<bold>i</bold>) and (<bold>ii</bold>). Spike waveforms associated with the light stimulation (blue spikes) are superimposed on spike waveforms collected during an episode of odor stimulation (magenta spikes). The high similarity between the light- and odor-evoked spikes serves as a basis to spike sort the recordings arising from the dorsal organ ganglion (‘Materials and methods’). (<bold>D</bold>) Dynamic reconstruction of the concentration time course corresponding to the trajectory of the head position depicted in <xref ref-type="fig" rid="fig1">Figure 1</xref>. (<bold>E</bold>) Results of 9 suction electrode recordings for the <italic>Or42a</italic>&gt;ChR2 OSN stimulated by the concentration shown in panel <bold>D</bold> (5 preparations). (Top) Raster plot. (Bottom) PSTH of the OSN response to the concentration time course shown in panel <bold>D</bold> with shade representing the standard deviation. (<bold>F</bold>) Close-up view of the sensory experience (top) and OSN response (bottom) corresponding to the illustrative runs R1 and R2 shown in panel <bold>D</bold> (green box). Since the maximum firing rate is attained earlier than the stimulus intensity reaches its maximum, the input–output relationship driving the dynamics of the OSN activity is more complex than a proportional detector. Short increases in odor concentration lead to transient bursts in spiking activity (bursts indicated by sharp # signs). Small disks on the abscissa denote turns in the original trajectory presented in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.004">http://dx.doi.org/10.7554/eLife.06694.004</ext-link></p></caption><graphic xlink:href="elife-06694-fig2-v1"/></fig></p></sec><sec id="s2-3"><title>Characterization of the features encoded by a single larval OSN stimulated by controlled olfactory signals</title><p>To tease apart the sensory features encoded by the <italic>Or42a</italic>&gt;ChR2 OSN, we examined the OSN response induced by a set of controlled odor ramps with a temporal profile analogous to the run sequence described in <xref ref-type="fig" rid="fig2">Figure 2F</xref>. As a first approximation, we used linear ramps with symmetrical 8-s rising and falling phases. During the rising phase of the ramp, the neural activity increased in proportion with the derivative of the odor concentration (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). During the falling phase of the ramp, the firing rate appeared to be driven by the stimulus intensity rather than the stimulus derivative (<xref ref-type="fig" rid="fig3">Figure 3B</xref>), suggesting that the response properties of the OSN differed for positive and negative gradients.<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.005</object-id><label>Figure 3.</label><caption><title>Characterization of the dynamical features extracted by the <italic>Or42a</italic>-expressing olfactory sensory neuron.</title><p>(<bold>A</bold>) Response to three linear ramps with variable slopes during the rising phase and equal slope during the falling phase. The ‘low’ (‘high’) ramps have a positive slope that is twice slower (faster) than the medium ramp. PSTH computed on a pool of minimum 24 recordings obtained from minimum 8 preparations. During the rising phase of the ramp, the activity of the OSN reaches a peak value that scales with the slope of the ramp. (<bold>B</bold>) Response to three linear ramps with variable slopes during the falling phase and equal slope during the rising phase. The ‘slow’ (‘fast’) ramp has a negative slope that is twice slower (faster) than the medium ramp. During the rising phase of the ramp, the plateau reached by the OSN activity grows with the slope of the ramp. During the falling phase of the ramp, the activity of the OSN is more directly driven by the stimulus intensity. For the three ramps, the OSN activity becomes inhibited when the ramp terminates. PSTH computed on a pool of minimum 24 recordings obtained from minimum 8 preparations. (<bold>B</bold>) Response to nonlinear ramps featuring a symmetrical 8 s-rise and 8 s–fall profiles. From left to right, the ramps tested have the following characteristics: linear (∝ t), exponential (∝ e<sup>−8</sup>(e<sup>t</sup> −1)), and sigmoid (∝ t<sup>3</sup>/(t<sup>3</sup>+4<sup>3</sup>)) with the time given in s. PSTH computed on a pool of minimum 16 recordings obtained from minimum 9 preparations. For panels <bold>C</bold>, the odor concentration (magenta) is computed from the flow ratio measured experimentally based on the flow controller outputs (‘Materials and methods’). The time derivative of the concentration time course is represented according to the <italic>y</italic>-scale on the right of the graph (gray). The derivative was computed after mild smoothening of the stimulus input. Asterisks denote inhibitory phases of the OSN response where the activity decreases below its basal level (horizontal dashed line).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.005">http://dx.doi.org/10.7554/eLife.06694.005</ext-link></p></caption><graphic xlink:href="elife-06694-fig3-v1"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06694.006</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Dose-response of the <italic>Or42a</italic>-expressing olfactory sensory neuron stimulated by prolonged odor pulses.</title><p>(<bold>A</bold>) Response to odor step stimulations of low and high concentrations: 52 μM and 522 μM. (Bottom) Raster plot of the OSN activity in response to low- and high-concentration odor steps (light and dark gray, respectively). 15 recordings conducted on 5 different preparations. (<bold>B</bold>) PSTH of the OSN activity in response to the low- and high-concentration odor steps (light and dark gray, respectively) shown in panel <bold>A</bold>. Shades represent standard deviations. The response dynamics of the <italic>Or42a</italic> OSN to static odor pulses is similar to that observed in adult-fly OSNs (<xref ref-type="bibr" rid="bib21">de Bruyne et al., 1999</xref>, <xref ref-type="bibr" rid="bib76">Nagel and Wilson, 2011</xref>, <xref ref-type="bibr" rid="bib69">Martelli et al., 2013</xref>). (<bold>C</bold>) Dose-response curve observed for the activity of the OSN after it has relaxed to a steady state value (mean firing rate computed during the time interval 20–24 s). Error bars represent standard deviations.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.006">http://dx.doi.org/10.7554/eLife.06694.006</ext-link></p></caption><graphic xlink:href="elife-06694-fig3-figsupp1-v1"/></fig></fig-group></p><p>To assess the slope sensitivity of the OSN, we compared the neural activity elicited by nonlinear ramps in which the first derivative of the stimulus changed over time (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). In an exponential ramp, the stimulus derivative increased throughout the rising phase of the ramp. This acceleration correlated with a continuous increase in spiking activity. To further test the hypothesis that the OSN encodes features related to the slope of the stimulus, we examined a sigmoid ramp (<xref ref-type="fig" rid="fig3">Figure 3C</xref>, right panel) for which the first derivative of the stimulus reached its maximum (gray arrow) prior to the stimulus intensity (magenta arrow). Consistent with the slope-sensitivity hypothesis, the OSN spiking activity peaked with the first derivative and not the absolute intensity of the stimulus. During the falling phase of the ramps, the OSN firing rate behaved in a way that could not be predicted from the slope sensitivity observed during the rising phase. At the end of the falling phase, OSN activity decreased below baseline (star signs * in <xref ref-type="fig" rid="fig3">Figure 3C</xref>), suggesting offset inhibition similar to that observed in OSNs of adult flies (<xref ref-type="bibr" rid="bib41">Hallem et al., 2004</xref>; <xref ref-type="bibr" rid="bib76">Nagel and Wilson, 2011</xref>). Our findings on the features encoded by the OSN were corroborated by responses elicited by other odor ramps (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><p>We attempted to model the input–output relationship of the OSN by following a linear system-identification approach (<xref ref-type="bibr" rid="bib17">Chichilnisky, 2001</xref>). To this end, we applied an M-sequence (pseudorandom binary sequence with nearly flat frequency spectrum) and reverse-correlation (<xref ref-type="bibr" rid="bib31">Geffen et al., 2009</xref>), but discovered that the resulting linear filter was insufficient to account for the firing patterns elicited by naturalistic stimuli (‘Materials and methods’). We thus turned to dynamical systems theory to capture the nonlinear characteristics of the OSN response. We developed a biophysical model that accounts for the slope-sensitivity of the OSN during stimulus upslopes, proportionality response and offset inhibition during downslopes (<xref ref-type="fig" rid="fig4">Figure 4</xref>).<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.007</object-id><label>Figure 4.</label><caption><title>Quantitative model for signal processing achieved by a single olfactory sensory neuron.</title><p>(<bold>A</bold>) Hypothetical physiological processes underlying the olfactory transduction pathway and spike generation. The integral feedback (IFB) motif is built on the assumption that inhibitory feedback modulates the activity of the odorant receptor, as was proposed in the adult fly (<xref ref-type="bibr" rid="bib76">Nagel and Wilson, 2011</xref>). This motif appears to be essential to olfactory transduction in vertebrates (<xref ref-type="bibr" rid="bib23">De Palo et al., 2013</xref>). The incoherent feed-forward (IFF motif) relies on the hypothetical existence of a delayed inhibitory effect, as was proposed for the transduction cascade of <italic>C. elegans</italic> (<xref ref-type="bibr" rid="bib48">Kato et al., 2014</xref>). (<bold>B</bold>) Biophysical model of the olfactory transduction pathway. (<bold>Bi</bold>) Circuit elements combining the IFF and IFB motifs described in panel <bold>A</bold>. Variable <italic>x</italic> represents the stimulus intensity, <italic>u</italic>, the activity or concentration of the intermediate variable and <italic>y</italic>, the firing rate of the OSN. Pathway (3) is specific to the IFB motif (light blue). (<bold>Bii</bold>) ODE system providing a phenomenological description of the reaction scheme outlined in panel <bold>A</bold> for the combination of the IFF and IFB regulatory motifs. The three pathways regulating the activity of <italic>u</italic> are outlined by numbers (1)–(3). Reaction (1) corresponds to a ‘production’ of <italic>u</italic> through the IFF branch; (2) corresponds to a first-order ‘decay’ of <italic>u</italic>; (3) corresponds to a ‘production’ of <italic>u</italic> through the IFB branch. (<bold>C</bold>) Simulated activity of <italic>u</italic> (green, middle) and firing rate <italic>y</italic> (blue, bottom) in response to an 8-s linear odor ramp (magenta, top). Numerical simulations were achieved by integrating the ODE system described in panel <bold>Bii</bold> with the parameter values listed in <xref ref-type="table" rid="tbl1">Table 1</xref>. (<bold>D</bold>) Decomposition of the predicted activity of individual pathways contributing to the regulation of <italic>u</italic> for the linear odor ramp displayed in panel <bold>C</bold>. Activity computed from the terms (1)–(3) outlined in panel <bold>B</bold> for the feed-forward activation by the stimulus (IFF, 1), first-order decay (2) and coupling of the firing rate with the intermediate variable through the negative feedback (IFB, 3). Notably, the contribution of the reaction specific to the IFB motif (3) is dominated by the reaction specific to the IFF motif (1). (<bold>E</bold>) Fit of the solution of the ODE model for three linear stimulation ramps introduced in <xref ref-type="fig" rid="fig3">Figure 3A,B</xref> and produced with odor (middle) and light (bottom). (Top) Stimulus intensity given as odor concentration (μM). The time derivative of the concentration profile (gray lines) is given according to the <italic>y</italic>-axis shown on the right side of the graph. The derivative was computed after mild smoothening of the stimulus time course. The same (idealized) profile was used for the light stimulation with an intensity ranging between 15 W/m<sup>2</sup> and 207 W/m<sup>2</sup>. (Middle) Comparison of the outcome of the model featuring a pure IFF motif (green) and a combination of the IFF and IFB motifs (blue). The parameters of both models were obtained independently through a Simplex optimization procedure (‘Materials and methods’). For the pure IFF model, parameter <italic>α</italic><sub>3</sub> was artificially set to 0. (Bottom) Comparison of the outcome of the experimental PSTH and the model's predictions based on a pure IFF motif (green) for light stimulation. Parameter optimization shows that the IFB motif does not contribute to the light-evoked OSN dynamics. (<bold>F</bold>) Fit of the solution of the ODE model for three nonlinear stimulation ramps generated with odor and light. (Middle) Results of the model compared to the odor-evoked OSN activity. Close-up view of the 8-s linear ramp highlighting the differences between the behavior of the pure IFF (green) and combined IFF+IFB (blue) circuit motifs for odor stimulation. (Bottom) Comparison of the outcome of the experimental PSTH and model based on a pure IFF motif (green) for light stimulation. For all conditions shown in the figure, PSTHs were computed on a pool of a minimum of 10 recordings obtained from a minimum of 10 preparations.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.007">http://dx.doi.org/10.7554/eLife.06694.007</ext-link></p></caption><graphic xlink:href="elife-06694-fig4-v1"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06694.008</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Response dynamics of the <italic>Or42a</italic>&gt;ChR2 OSN to linear and nonlinear stimulation ramps induced with odor and light, and fits of the stimulus-to-neural (ODE) models.</title><p>(<bold>A</bold>) Set of 4-s linear ramps with different rising and falling slopes. (<bold>Ai</bold>) Five ramps with a rising phase that lasts 4 s. Stimulus intensity given as odor concentration (μM, magenta). Upon mild smoothening of the stimulus time course trajectories with a Savitzky-Golay filter, the time derivative (gray) of the concentration profile is represented according to the <italic>y</italic>-axis on the right of the graph. The same (idealized) profile was used for the light stimulation with an intensity ranging between 15 W/m<sup>2</sup> and 207 W/m<sup>2</sup>. (<bold>Aii</bold>) Fit of the solution of the ODE model for the linear stimulation ramps generated with odor. Comparison of the experimental PSTH (black) with the outcome of the model featuring a pure IFF motif (green), and a combination of the IFF and IFB motifs (blue). (<bold>Aiii</bold>) Modeling of the OSN activity elicited by the linear light ramps. Comparison of the experimental PSTH with the outcome of the model based on a pure IFF motif (green). (<bold>B</bold>) Set of 8-s linear and nonlinear ramps. (<bold>Bi</bold>) Stimulus intensity given as odor concentration (μM, magenta). Same conditions as panel <bold>A</bold>. (<bold>Bii</bold>) Modeling of the OSN activity elicited by odor ramps. Comparison of the experimental PSTH (black) with the outcome of the model featuring a pure IFF motif (green), and a combination of the IFF and IFB motifs (blue). (<bold>Biii</bold>) Same as <bold>Bi</bold> for the light ramps. Comparison of the experimental PSTH with the outcome of the model based on a pure IFF motif (green). For all conditions shown in this figure, the PSTHs were computed on a pool of a minimum of 10 recordings obtained from a minimum of 10 preparations.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.008">http://dx.doi.org/10.7554/eLife.06694.008</ext-link></p></caption><graphic xlink:href="elife-06694-fig4-figsupp1-v1"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06694.009</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Validation of the stimulus-to-neural (ODE) model for the olfactory transduction cascade upon training on partial datasets.</title><p>(<bold>A</bold>) Training of the ODE model described in <xref ref-type="fig" rid="fig4">Figure 4B</xref> on a set of 5 linear ramps with rising phase lasting 4 s. (<bold>B</bold>) The ODE model trained on the 4-s linear ramps alone (panel <bold>A</bold>) is validated on 8-s stimulus ramps: a linear ramp (left), an exponential ramp (middle), and a sigmoid ramp (right). The model is trained independently for odor (middle row) and light stimulations (bottom row). The predictions of the model are shown as a dashed line. The PSTH experimentally observed is shown in black (shades denote standard deviation). The output of the model trained on the entire set of ramps (plain line, parameter set listed in <xref ref-type="table" rid="tbl1">Table 1</xref>) shows nearly no improvement compared to the model trained on the subset of linear ramps. For both the odor-evoked and light-evoked OSN dynamics, the correlation coefficients (<italic>ρ</italic>) and coefficients of variation of the RMSE (<xref ref-type="table" rid="tbl1">Table 1</xref>) corresponding to the model trained on the linear ramps and that trained on all ramps differ by less than 1% and 5%, respectively. (<bold>C</bold>) Validation of the ODE model obtained in panel <bold>A</bold> on naturalistic stimulation with odor (middle row) and light (bottom row). Stimulus time course represented in magenta. The experimental PSTH is shown in black (shades denote standard deviation). The predictions of the model trained on the linear ramps alone (dashed line) show nearly no difference with the output of the model trained on the entire set of ramps (plain line). The naturalistic odor stimulus corresponds to the trajectory presented in <xref ref-type="fig" rid="fig2">Figure 2D</xref>. The naturalistic light stimulus corresponds to the trajectory presented in <xref ref-type="fig" rid="fig6">Figure 6B</xref>. For both the light and the odor-evoked spiking activity, the correlation coefficients (<italic>ρ</italic>) and coefficients of variation of the root-mean-square error (RMSE) corresponding to the model trained on the linear ramps alone and that trained on all ramps differ by less than 1% and 7%, respectively.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.009">http://dx.doi.org/10.7554/eLife.06694.009</ext-link></p></caption><graphic xlink:href="elife-06694-fig4-figsupp2-v1"/></fig></fig-group></p></sec><sec id="s2-4"><title>Phenomenological model of the olfactory transduction cascade</title><p>Negative feedback is known to play an important regulatory function in sensory transduction. Integral feedback control underlies perfect adaption in bacterial chemotaxis (<xref ref-type="bibr" rid="bib104">Yi et al., 2000</xref>). In vertebrates, the olfactory transduction cascade involves a metabotropic pathway downstream from a G-protein coupled receptor (GPCR) that features negative regulatory feedback (<xref ref-type="bibr" rid="bib49">Kaupp, 2010</xref>; <xref ref-type="bibr" rid="bib82">Pifferi et al., 2010</xref>). As with phototransduction, adaptive features of the olfactory transduction cascade in vertebrate can be accounted for by integral feedback (<xref ref-type="bibr" rid="bib22">De Palo et al., 2012</xref>; <xref ref-type="bibr" rid="bib23">De Palo et al., 2013</xref>). Even though invertebrate olfaction does not rely on GPCR signaling (<xref ref-type="bibr" rid="bib49">Kaupp, 2010</xref>), the existence of negative feedback on the odorant receptor has been postulated for olfactory transduction in adult-fly OSNs (<xref ref-type="bibr" rid="bib76">Nagel and Wilson, 2011</xref>). This conclusion was drawn from a biophysical model that combined a linear filter accounting for the OSN spiking dynamics with a kinetic formalism to describe ligand–receptor interactions. Research in the moth has revealed a different regulatory mechanism that constitutes an ‘incoherent feed-forward’ loop (<xref ref-type="bibr" rid="bib2">Alon, 2007</xref>) in which the activity of the odorant receptor has a dual effect on the OSN spike rate (<xref ref-type="bibr" rid="bib39">Gu et al., 2009</xref>): (1) on a short timescale, the inflow of cations increases the firing rate; (2) on a longer timescale increasing concentration of intracellular calcium ions inhibits the OSN firing rate through a pathway that involves the binding of calcium to calmodulin.</p><p>Combining the previous ideas, we hypothesized that the OSN spiking activity is regulated by a negative feedback loop (or integral feedback, IFB) coupled with an incoherent feed-forward loop (IFF) (<xref ref-type="fig" rid="fig4">Figure 4A</xref> and ‘Materials and methods’). In what follows, this composite model will be denoted as IFB+IFF (<xref ref-type="fig" rid="fig4">Figure 4Bi</xref>). Using a mass-action-kinetics formalism originally developed for genetic networks (<xref ref-type="bibr" rid="bib1">Ackers et al., 1982</xref>; <xref ref-type="bibr" rid="bib10">Bintu et al., 2005</xref>), each of the two regulatory motifs was described by a system of two ordinary differential equations (ODEs) with three variables (<xref ref-type="fig" rid="fig4">Figure 4Bii</xref>): <italic>x</italic>, the stimulus strength (input: odor concentration or light intensity), <italic>y</italic> the instantaneous firing rate of the OSN (output), and <italic>u</italic>, a phenomenological variable that might represent the intracellular concentration of calcium. The free parameters of the model were determined through a simplex algorithm which optimized the fit between the experimental spiking activity of the <italic>Or42a</italic>&gt;ChR2 OSN and that produced by the ODE model. The optimization was achieved on a set of 10 linear and nonlinear ramps listed in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> together with the naturalistic stimulus presented in <xref ref-type="fig" rid="fig2">Figure 2D</xref>. The parameter set derived from the 10 odor ramps and naturalistic stimulus (<xref ref-type="table" rid="tbl1">Table 1</xref>) led to a remarkably good fit between the output of the ODE model and the experimentally measured spiking activity (experimental peristimulus time histogram PSTH—black line, results of the IFF+IFB model—blue line; <xref ref-type="fig" rid="fig4">Figure 4C,E,F</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Throughout the study, this parameter set was used to reproduce and predict the OSN spiking activity elicited by olfactory stimuli. To rule out over-fitting, we trained the IFF+IFB model on a partial dataset containing the linear ramps alone and validated its response against other stimuli not present in the training dataset (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>).<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.010</object-id><label>Table 1.</label><caption><p>Parameters of ODE model derived from the Simplex optimization procedure (‘Materials and methods’) applied on the OSN spiking activity elicited by light stimulation (pure IFF model—left column) and odor stimulation (pure IFF model—middle column; combined IFF+IFB model—right column)</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.010">http://dx.doi.org/10.7554/eLife.06694.010</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Light: IFF motif</th><th>Odor: pure IFF motif</th><th>Odor: IFF+IFB motifs</th></tr></thead><tbody><tr><td style="background:#8C8C8C"><italic>α</italic><sub><italic>1</italic></sub></td><td style="background:#8C8C8C">0.1 (W m<sup>−2</sup>)<sup>−1</sup> s<sup>−1</sup></td><td style="background:#8C8C8C">0.1 μM<sup>−1</sup> s<sup>−1</sup></td><td style="background:#8C8C8C">0.13 μM<sup>−1</sup> s<sup>−1</sup></td></tr><tr><td><italic>α</italic><sub><italic>2</italic></sub></td><td>0.88 s<sup>−1</sup></td><td>0.6 s<sup>−1</sup></td><td>0.26 s<sup>−1</sup></td></tr><tr><td style="background:#8C8C8C"><italic>α</italic><sub><italic>3</italic></sub></td><td style="background:#8C8C8C">10<sup>−6</sup> Hz<sup>−1</sup> s<sup>−1</sup></td><td style="background:#8C8C8C">0<xref ref-type="table-fn" rid="tblfn1">*</xref> Hz<sup>−1</sup> s<sup>−1</sup></td><td style="background:#8C8C8C">1.1 Hz<sup>−1</sup> s<sup>−1</sup></td></tr><tr><td><italic>β</italic><sub><italic>1</italic></sub></td><td>1731.41 Hz s<sup>−1</sup></td><td>1002.25 μM s<sup>−1</sup></td><td>2903.36 μM s<sup>−1</sup></td></tr><tr><td style="background:#8C8C8C"><italic>β</italic><sub><italic>2</italic></sub></td><td style="background:#8C8C8C">1.27 W m<sup>−2</sup></td><td style="background:#8C8C8C">8.63 μM</td><td style="background:#8C8C8C">0.01 μM</td></tr><tr><td><italic>β</italic><sub><italic>3</italic></sub></td><td>2.48 W m<sup>−2</sup></td><td>2.39 μM</td><td>2.65 μM</td></tr><tr><td style="background:#8C8C8C"><italic>β</italic><sub><italic>4</italic></sub></td><td style="background:#8C8C8C">1214.08 Hz s<sup>−1</sup></td><td style="background:#8C8C8C">624.69 μM s<sup>−1</sup></td><td style="background:#8C8C8C">795.62 μM s<sup>−1</sup></td></tr><tr><td><italic>β</italic><sub><italic>5</italic></sub></td><td>13.03 s<sup>−1</sup></td><td>6.44 s<sup>−1</sup></td><td>23.79 s<sup>−1</sup></td></tr><tr><td style="background:#8C8C8C"><italic>θ</italic></td><td style="background:#8C8C8C">0.3 Hz</td><td style="background:#8C8C8C">1.01 Hz</td><td style="background:#8C8C8C">1.88 Hz</td></tr><tr><td><italic>n</italic></td><td>2</td><td>2</td><td>2</td></tr></tbody></table><table-wrap-foot><fn><p>Parameters were obtained upon training of the model on 10 stereotyped stimulus ramps (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) together with the naturalistic stimulation patterns shown in <xref ref-type="fig" rid="fig2">Figure 2D</xref> (odor) or Figure 6B (light). For light stimulation, the parameter of the IFB pathway (<italic>α</italic><sub><italic>3</italic></sub>) was negligible and considered equal to 0 in the rest of the study. For odor stimulation, parameter <italic>α</italic><sub><italic>3</italic></sub> was artificially set to 0 in the case of the pure IFF motif. Note that the units of the intermediate variable <italic>u</italic> are undefined. We empirically found that the goodness of fit improved when the value of the offset <italic>β</italic><italic><sub>4</sub></italic> undergoes a small correction over time. In all numerical simulations of this study, we used <italic>β</italic><italic><sub>4</sub></italic>(t) = (1.023 <italic>t</italic><italic><sup>4</sup></italic>/(<italic>t</italic><italic><sup>4</sup></italic> + 30<sup>4</sup>)) × <italic>β</italic><italic><sub>4</sub></italic>. The Hill coefficient <italic>n</italic> was set equal to 2. In this table, all concentrations are given for odor stimulation in liquid phase. As described in the ‘Materials and methods’ section, the concentration equivalence in gaseous phase can be approximated by multiplying the liquid phase concentration by a factor <italic>ρ</italic><sup>liquid → gas</sup> = 26.73. The parameters listed in this table are used in all numerical simulations of the study, except the validation controls described in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>.</p></fn><fn id="tblfn1"><label>*</label><p>parameter set artificially to 0.</p></fn></table-wrap-foot></table-wrap></p><p>Next, we examined the individual contribution of the IFF and IFB pathways to the response dynamics of the OSN. In <xref ref-type="fig" rid="fig4">Figure 4D</xref>, the activity of each pathway was separately computed in response to stimulation by a linear odor ramp. The contribution of the IFB motif to the dynamics of variable <italic>u</italic> is approximately 30% that of the IFF (cyan vs magenta curves, <xref ref-type="fig" rid="fig4">Figure 4D</xref>). This led us to conclude that the IFF pathway dominates the control of OSN spiking activity. The IFB pathway has nonetheless a non-negligible impact on the dynamics. Using the parameter optimization procedure, the pure IFF model was trained on the full set of odor ramps (<xref ref-type="table" rid="tbl1">Table 1</xref>, middle column). At a qualitative level, both the pure IFF and the composite IFF+IFB models reproduced the OSN spiking dynamics (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>), but a quantification of the goodness of fit established the superiority of the IFF+IFB model (<xref ref-type="table" rid="tbl2">Table 2</xref> and inset of <xref ref-type="fig" rid="fig4">Figure 4F</xref>). In addition, none of the other standard 3-element circuit motifs we tested produced a reasonable fit of the OSN spiking activity (data not shown), arguing that the composite IFF+IFB model comprises essential regulatory features of the olfactory transduction cascade.<table-wrap id="tbl2" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.011</object-id><label>Table 2.</label><caption><p>Quantification of the goodness of fit between the stimulus-to-neural (ODE) models and the experimental firing dynamics of the OSN stimulated by the linear and nonlinear ramps</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.011">http://dx.doi.org/10.7554/eLife.06694.011</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Odor, IFF</th><th>Odor, IFF+IFB</th><th>Light, IFF</th></tr></thead><tbody><tr><td colspan="4">A Correlation coefficient (ρ)</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), low</td><td style="background:#8C8C8C">0.982</td><td style="background:#8C8C8C">0.985</td><td style="background:#8C8C8C">0.954</td></tr><tr><td> Linear (4 s), med</td><td>0.994</td><td>0.994</td><td>0.980</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), high</td><td style="background:#8C8C8C">0.986</td><td style="background:#8C8C8C">0.995</td><td style="background:#8C8C8C">0.983</td></tr><tr><td> Linear (4 s), slow</td><td>0.993</td><td>0.994</td><td>0.980</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), fast</td><td style="background:#8C8C8C">0.983</td><td style="background:#8C8C8C">0.979</td><td style="background:#8C8C8C">0.970</td></tr><tr><td> Linear (8 s)</td><td>0.983</td><td>0.994</td><td>0.982</td></tr><tr><td style="background:#8C8C8C"> Quadratic</td><td style="background:#8C8C8C">0.993</td><td style="background:#8C8C8C">0.993</td><td style="background:#8C8C8C">0.988</td></tr><tr><td> Exponential</td><td>0.990</td><td>0.984</td><td>0.965</td></tr><tr><td style="background:#8C8C8C"> Sigmoid</td><td style="background:#8C8C8C">0.985</td><td style="background:#8C8C8C">0.994</td><td style="background:#8C8C8C">0.990</td></tr><tr><td> Asymptotic</td><td>0.990</td><td>0.994</td><td>0.972</td></tr><tr><td colspan="4">B CV(RMSE)</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), low</td><td style="background:#8C8C8C">0.143</td><td style="background:#8C8C8C">0.121</td><td style="background:#8C8C8C">0.225</td></tr><tr><td> Linear (4 s), med</td><td>0.112</td><td>0.097</td><td>0.174</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), high</td><td style="background:#8C8C8C">0.159</td><td style="background:#8C8C8C">0.093</td><td style="background:#8C8C8C">0.184</td></tr><tr><td> Linear (4 s), slow</td><td>0.111</td><td>0.091</td><td>0.167</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), fast</td><td style="background:#8C8C8C">0.173</td><td style="background:#8C8C8C">0.179</td><td style="background:#8C8C8C">0.229</td></tr><tr><td> Linear (8 s)</td><td>0.185</td><td>0.106</td><td>0.153</td></tr><tr><td style="background:#8C8C8C"> Quadratic</td><td style="background:#8C8C8C">0.131</td><td style="background:#8C8C8C">0.111</td><td style="background:#8C8C8C">0.150</td></tr><tr><td> Exponential</td><td>0.155</td><td>0.226</td><td>0.237</td></tr><tr><td style="background:#8C8C8C"> Sigmoid</td><td style="background:#8C8C8C">0.175</td><td style="background:#8C8C8C">0.102</td><td style="background:#8C8C8C">0.131</td></tr><tr><td> Asymptotic</td><td>0.124</td><td>0.080</td><td>0.193</td></tr></tbody></table><table-wrap-foot><fn><p><bold>(A)</bold> Pearson's correlation coefficient (<italic>ρ</italic>) computed for stimulus ramps listed in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>. <bold>(B)</bold> Coefficient of variation (CV) of the root-mean-square error (RMSE).</p></fn></table-wrap-foot></table-wrap></p><p>The response properties of the OSN were then studied for a family of stimulus ramps induced by light instead of odor. The temporal profiles of the light ramps were identical to the odor ramps; the intensity range was fixed to coarsely match the low firing rate of the OSN activity observed for the odor stimulations. In this regime, the temporal pattern of the OSN activity elicited by the light ramps was comparable to that elicited by the odor ramps (experimental PSTH—black lines, <xref ref-type="fig" rid="fig4">Figure 4E,F</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). This close similarity in the input–output relationships permitted us to substitute the odor stimulus with light. Using the full set of linear and nonlinear light ramps together with a naturalistic pattern of light stimulation (Figure 6B), optimization of the parameters of the ODE system showed that the IFB pathway does not contribute to the light-evoked response dynamics of the OSN, suggesting that the integral feedback motif is specific to the odor-evoked activity (<xref ref-type="table" rid="tbl1">Table 1</xref>). The results of the pure IFF model are in good agreement with the experimental observations (<xref ref-type="fig" rid="fig4">Figure 4E,F</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Notably, the goodness of fit of the pure IFF motif, when applied to both light and odor stimulations, was comparable (<xref ref-type="table" rid="tbl2">Table 2</xref>). In conclusion, the nonlinear-dynamical response properties of the OSN stimulated by odor and light ramps can be well approximated by the IFF motif, even though the IFB motif brings a non-negligible contribution to the modeling of odor-evoked response dynamics.</p></sec><sec id="s2-5"><title>Peripheral encoding of the olfactory stimulus produces transient normalization</title><p>To clarify the sensory computation achieved by the <italic>Or42a</italic> OSN, we sought to derive an analytical solution of the ODE system. We restricted this analysis to the pure IFF motif, which provides a good approximation of the dynamics of the composite IFF+IFB motif. The general solution of the IFF motif required solving the ODE system shown in <xref ref-type="fig" rid="fig4">Figure 4Bii</xref>. Since the OSN spiking activity evolves on a different timescale than the other two variables, the solution of the ODEs could be simplified through a quasi-steady-state approximation (QSSA, see ‘Materials and methods’). The mathematical expression of the QSSA solution reveals that the OSN spiking activity (<italic>y</italic>) is determined by a hyperbolic ratio function of the stimulus intensity <italic>x</italic>:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">QSSA</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>δ</italic><sub>1</sub>, <italic>δ</italic><sub>2</sub>, and <italic>δ</italic><sub>4</sub> are constants (‘Materials and methods’). The denominator of this hyperbolic relationship contains a scaling term S(<italic>x</italic>, <italic>t</italic>) that normalizes the spiking activity by the short-term history of changes in the stimulus intensity d<italic>x</italic>/d<italic>t</italic>:<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The integration-differentiation scaling function S(<italic>x</italic>, <italic>t</italic>) plays a role similar to the ‘input gain control’ resulting from lateral inhibition of the local interneuron on the projection neurons in the adult antennal lobe (<xref ref-type="bibr" rid="bib80">Olsen et al., 2010</xref>) with the notable difference that the rescaling takes place within the primary OSN and that it is driven by the temporal integration of changes in the stimulus intensity. In analogy to the divisive normalization reported in the visual system (<xref ref-type="bibr" rid="bib14">Carandini and Heeger, 2012</xref>), we termed the rescaling operation described in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> as ‘transient normalization’. This operation appears related to the adaptive rescaling of the spike dynamics observed in adult-fly OSNs (<xref ref-type="bibr" rid="bib51">Kim et al., 2011</xref>; <xref ref-type="bibr" rid="bib76">Nagel and Wilson, 2011</xref>).</p></sec><sec id="s2-6"><title>Behavioral relevance of the dynamical features encoded in the OSN activity</title><p>By examining the analytical solution of the IFF motif under the quasi-steady-state approximation (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>), we discovered that the most salient features encoded in the activity pattern of the <italic>Or42a</italic>&gt;ChR2 OSN are: (1) rapid increases in firing rate triggered by abrupt positive changes in the stimulus intensity (accelerations); (2) a relaxation of the firing rate toward stationary activity when the first derivative of the stimulus is null or constant (no acceleration or deceleration); (3) decreases in firing rate in response to stimulus decelerations. In addition, we experimentally observed that (4) the spiking activity of the neuron is strongly inhibited upon abrupt return to the stimulus baseline. We asked whether these features bore any relevance to the control of run-to-turn transitions during odor gradient ascent. We hypothesized that sustained spiking activity of the OSN would suppress turning while inhibition of the OSN would facilitate turning. To test this hypothesis, we built a tracker to monitor the position and behavioral state of a single larva in real-time at a rate of 30 Hz (<xref ref-type="fig" rid="fig5">Figure 5A</xref> and detailed description in ‘Materials and methods’). Equipped with blue LEDs, the tracker was designed to evoke controlled patterns of spiking activity in the <italic>Or42a</italic>&gt;ChR2 OSN by means of optogenetics. To avoid innate photophobic behavior (<xref ref-type="bibr" rid="bib86">Sawin-McCormack et al., 1995</xref>; <xref ref-type="bibr" rid="bib46">Kane et al., 2013</xref>), experiments were conducted on blind larvae (‘Materials and methods’).<fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.013</object-id><label>Figure 5.</label><caption><title>Modulation of run-to-turn transitions by light-evoked activity in the <italic>Or42a</italic>-expressing OSN.</title><p>(<bold>A</bold>) Illustration of the closed-loop tracker used to synthesize virtual olfactory realities with light stimulation coupled to optogenetics. Close-up view of the larva illuminated by a red light pad fixed to a moving stage below the agarose slab. The camera and LEDs are mounted on a second moving stage whose position is updated synchronously with the bottom stage to remain locked on the position of the larva. The platform on which the larva behaves is fixed. (<bold>B</bold>) Presentation of the run-based light stimulation paradigm where runs are randomly assigned to constant stimulation (control) or to a test ramp with an exponential profile similar to that introduced in <xref ref-type="fig" rid="fig3">Figure 3C</xref>. (Right) Midpoint position of the larva during a trajectory with the light intensity color-coded in accordance with the color bar on the left. Illustrative runs denoted as R1-4 are interspaced by turns T1-3 denoted by arrows. (<bold>C</bold>) Turn probability estimated from a set of runs associated with constant stimulation (light gray) or stimulation by an exponential light ramp (black). The turn probabilities are reported as the fraction of turns occurring during a 1-s window centered on the time point of interest (‘Materials and methods’). Error bars are estimated from resampled sets of runs (shaded areas denote standard deviation, see ‘Materials and methods’). The dashed line depicts the mean turning rate computed for constant light stimulation. The turning rate is in first approximation independent of the run duration. Small disks on the <italic>x</italic>-axis indicate time points after which fewer than 10% of the total number of runs are left for the constant stimulation (light gray) and exponential ramp (dark gray). Beyond these time points, the estimates of the turn probability should be considered as unreliable. (<bold>D</bold>) Generalized linear model (GLM) for the modulation of turn probability as a function of the sensory experience (integrated stimulus-to-behavior model). The turn probability is predicted from a linear combination of the predicted neural activity (<italic>γ</italic><sub><italic>1</italic></sub> <italic>y</italic> (<italic>t</italic>)) and a constant term (γ<sub>0</sub>). This linear combination is then fed into a logit transformation to convert the domain of definition of the neural activity into a probability. The two parameters of the model, <italic>γ</italic><sub><italic>0</italic></sub> and <italic>γ</italic><sub><italic>1</italic></sub>, are determined from a linear regression on the experimental profiles of turn probability. The OSN activity driven by light, <italic>y</italic>, is predicted from the pure IFF (ODE) model described in <xref ref-type="fig" rid="fig4">Figure 4B</xref>. As a control, we consider the same model where the input is the stimulus intensity. The parameters of this control model are denoted as <italic>γ′</italic><sub>0</sub> and <italic>γ′</italic><sub>1</sub>. Upon training of the test and control models on the full set of linear and nonlinear ramps (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>), we derived the parameter values reported in <xref ref-type="table" rid="tbl3">Table 3</xref>. (<bold>E</bold>) Predictions of the integrated stimulus-to-behavior GLM for linear ramps of different rising and falling slopes. (Top) For the individual ramps, the time course of light intensity is shown in magenta. The time derivative of the light ramp (gray line) is computed after mild smoothening of the stimulus input. (Bottom) Behavioral predictions based on the neural activity predicted by the IFF (plain blue line) and the control model that is purely based on the stimulus (dashed magenta line). The integrated stimulus-to-behavior model clearly outperforms the predictions of the control model, which highlights the importance of the signal processing achieved by the OSN. (<bold>F</bold>) Predictions of the integrated stimulus-to-behavior model for 8-s light ramps. For all conditions tested, the experimental turn probability was estimated on a sample of 490–970 runs. Quantification of the goodness of fit is reported in <xref ref-type="table" rid="tbl4">Table 4</xref> for the test and control models.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.013">http://dx.doi.org/10.7554/eLife.06694.013</ext-link></p></caption><graphic xlink:href="elife-06694-fig5-v1"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06694.014</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Fit of the integrated stimulus-to-behavior generalized linear model (GLM) for the linear and nonlinear light ramps.</title><p>(<bold>A</bold>) Set of 4-s linear ramps. (<bold>Ai</bold>) Light intensity profile (W/m<sup>2</sup>). (<bold>Aii</bold>) Application of pure IFF motif to model the OSN activity elicited by the light ramps (green line). (<bold>Aiii</bold>) Application of the integrated stimulus-to-behavior GLM to predict behavior in response to stereotyped light ramps. The test model (blue line) is based on the neural activity modeled by the IFF motif. The turn probability estimated experimentally is shown in black (shades denote standard deviation as described in ‘Materials and methods’). As indicated in the textbox on the right, the control model is based on the stimulus without any processing of the OSN (dashed magenta line). The black dashed line in the background represents the average turn probability observed upon stimulation at constant light intensity. The integrated stimulus-to-behavior model clearly outperforms the predictions of the control model. (<bold>B</bold>) Set of 8-s linear and nonlinear ramps. (<bold>Bi</bold>–<bold>Biii</bold>) Same as panels <bold>Ai</bold>–<bold>Aiii</bold> for the behavior elicited by 8-s light ramps. For all test conditions, the experimental turn probability was estimated on a sample of 490–970 runs. The outputs of the test and control models are obtained based on the parameter sets listed in <xref ref-type="table" rid="tbl1">Table 1</xref> (ODE model) and <xref ref-type="table" rid="tbl3">Table 3</xref> (GLM).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.014">http://dx.doi.org/10.7554/eLife.06694.014</ext-link></p></caption><graphic xlink:href="elife-06694-fig5-figsupp1-v1"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06694.015</object-id><label>Figure 5—figure supplement 2.</label><caption><title>Validation of the integrated stimulus-to-behavior generalized linear model (GLM) upon training on a partial set of light ramps.</title><p>(<bold>A</bold>) Training of the GLM described in <xref ref-type="fig" rid="fig5">Figure 5D</xref> restricted to the set of 4-s linear light ramps. (<bold>B</bold>) Validation of the GLM model trained on the set of 4-s linear ramps (panel <bold>A</bold>) on 8-s ramps (dashed green line). Comparison with the output of the model trained on the entire set of ramps (plain blue line, parameter set presented in <xref ref-type="table" rid="tbl3">Table 3</xref>) shows nearly no difference with the model trained on a subset of linear ramps. The turn probability estimated experimentally is shown in black (shades denote standard deviation as described in ‘Materials and methods’). (<bold>Bi</bold>) Validation of the model on the 8-s linear ramp. (<bold>Bii</bold>) Validation of the model on the 8-s exponential ramp. (<bold>Biii</bold>) Validation of model on the 8-s sigmoid ramp. The correlation coefficients and coefficients of variation of the RMSE corresponding to the model trained on the linear ramps and the model trained on all ramps differ by less than 1% and 9%, respectively. (<bold>C</bold>) Training of the GLM on a single light ramp and validation on the 8-s sigmoid ramp: training on the 8-s linear ramp (short dashed line); training on the 8-s exponential ramp (long dashed line). The output of the model trained on the complete set of ramps is shown as plain line. The correlation coefficients and coefficients of variation of the RMSE corresponding to the model trained on a single ramp and the model trained on all ramps differ by less than 1% and 10%, respectively.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.015">http://dx.doi.org/10.7554/eLife.06694.015</ext-link></p></caption><graphic xlink:href="elife-06694-fig5-figsupp2-v1"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06694.016</object-id><label>Figure 5—figure supplement 3.</label><caption><title>Comparison of the predictions of the integrated and control generalized linear model (GLM) with and without the contribution of the first derivative of the stimulus intensity.</title><p>(<bold>A</bold>) Predictions for the linear low (4-s) ramp. (Top) Time courses of the stimulus intensity (magenta line) and its time derivative (gray line). (Bottom) The turn probability estimated experimentally is shown in black (shades denote standard deviation as described in ‘Materials and methods’). The predictions of the integrated stimulus-to-behavior GLM are shown in blue. The performance of the stimulus-to-behavior control model, based on the stimulus intensity alone (dashed magenta line), improves by combining the light intensity with its first derivative. We note that the integrated stimulus-to-behavior GLM outperforms the two control GLMs. The discrepancies between the controls and the test model are particularly pronounced during the beginning of the rising phase of the ramp. The goodness of fit is quantified in <xref ref-type="table" rid="tbl4">Table 4</xref>. (<bold>B</bold>) Same as panel <bold>A</bold> for the 8-s linear ramp. (<bold>C</bold>) Same as panel <bold>A</bold> for the 8-s exponential ramp. (<bold>D</bold>) Same as panel <bold>A</bold> for the 8-s sigmoid ramp.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.016">http://dx.doi.org/10.7554/eLife.06694.016</ext-link></p></caption><graphic xlink:href="elife-06694-fig5-figsupp3-v1"/></fig></fig-group></p><p>We took advantage of our ability to use stereotyped light ramps to elicit predictable and reproducible patterns of firing activity in the <italic>Or42a</italic>&gt;ChR2 OSN (<xref ref-type="fig" rid="fig4">Figure 4</xref>, light-evoked activity patterns). In a series of experiments, we associated individual runs with a predefined light ramp and correlated the simulated OSN firing rate with the onset of run-to-turn transitions. In the example shown in <xref ref-type="fig" rid="fig5">Figure 5B</xref>, we began each run with either an exponential ramp or a constant basal light intensity (internal control). When an exponential ramp was played to the larva, the pattern of light stimulation was executed as long as the larva remained in a run state. Upon interruption of the run, the light intensity was reset to baseline. As the motion of the larva had no influence on the stimulation pattern it experienced, this experimental protocol featured a sensorimotor loop that is essentially ‘open’.</p><p>When the behavior was modulated by changes in light intensity, the majority of the runs associated with an exponential ramp did not terminate before the falling phase of the ramp. This trend was quantified through the probability of turning (or turn rate) defined as the relative number of runs that switched to a turn during a given time window of 1 s (‘Materials and methods’). The turn probability was estimated at every time point by using a sliding window. Upon constant light stimulation, we found that the instantaneous turn probability was largely independent of the duration of the ongoing run (light gray line, <xref ref-type="fig" rid="fig5">Figure 5C</xref>). In contrast, the turn probability was strongly modulated by the exponential light ramp (black line, <xref ref-type="fig" rid="fig5">Figure 5C</xref>). During the rising phase of the ramp (0–8 s), turning was suppressed below the value corresponding to basal stimulation. Conversely, a sharp increase in turn probability was observed during the falling phase of the ramp. The modulation of the turn probability by the light-evoked spiking activity corroborated the idea that strong activation of the OSN efficiently suppresses turning, whereas inhibition promotes turning.</p><p>We set out to develop a quantitative model for the control of run-to-turn transitions by the neural activity. As the probability of turning remained approximately constant when the OSN activity was stationary, we hypothesized that the relationship between the OSN spiking activity and the control of run-to-turn transitions could be captured by a simple model where the time-varying probability of turning was described by the combination of a constant term (<italic>λ</italic><sub><italic>0</italic></sub>) and a term proportional to the current OSN firing rate: <italic>λ</italic><sub><italic>0</italic></sub>+ <italic>λ</italic><sub><italic>1</italic></sub><italic>y</italic>(<italic>t</italic>)<italic>.</italic> To map this linear combination (which can be positive or negative) onto the definition domain of a probability (which varies between 0 and 1), we applied a standard logit transformation and described the turn probability as a generalized linear model (GLM) (<xref ref-type="bibr" rid="bib75">Myers et al., 2002</xref>):<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To define the parameters of the GLM (<italic>λ</italic><sub><italic>0</italic></sub> and <italic>λ</italic><sub><italic>1</italic></sub>), we transformed the previous relationship as shown in <xref ref-type="fig" rid="fig5">Figure 5D</xref>, and we carried out a linear regression on the open-loop behavior elicited by 10 light ramps identical to those used to characterize the OSN response dynamics (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). The parameter set obtained through this procedure is reported in <xref ref-type="table" rid="tbl3">Table 3</xref>. It was used to reproduce or predict behavioral transitions throughout the study. From here on, the GLM (<xref ref-type="fig" rid="fig5">Figure 5D</xref>) was fed with the OSN firing rate predicted from the neural model (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). This model will be referred to as the integrated <italic>stimulus-to-behavior GLM</italic>.<table-wrap id="tbl3" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.017</object-id><label>Table 3.</label><caption><p>Parameters of the stimulus-to-behavior generalized linear model (GLM) obtained upon training of model on the stimulation ramps listed in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref></p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.017">http://dx.doi.org/10.7554/eLife.06694.017</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th><named-content content-type="author-callout-style1">Control without first derivative of stimulus</named-content></th><th><named-content content-type="author-callout-style1">Control with first derivative of stimulus</named-content></th><th><named-content content-type="author-callout-style2">Test model with predicted neural activity</named-content></th></tr></thead><tbody><tr><td style="background:#8C8C8C"><bold>γ</bold><sub><bold>0</bold></sub> (constant)</td><td style="background:#8C8C8C">−0.8156</td><td style="background:#8C8C8C">−0.8200</td><td style="background:#8C8C8C">−0.3534</td></tr><tr><td><bold>γ</bold><sub><bold>1</bold></sub> (input variable)</td><td>−0.0114 (W/m<sup>2</sup>)<sup>−1</sup></td><td>−0.0013 (W/m<sup>2</sup>)<sup>−1</sup></td><td>−0.1523 Hz<sup>−1</sup></td></tr><tr><td style="background:#8C8C8C"><bold>γ</bold><sub><bold>2</bold></sub> (derivative of input variable)</td><td style="background:#8C8C8C">–</td><td style="background:#8C8C8C">−0.0214 (W/m<sup>2</sup>)<sup>−1</sup> s</td><td style="background:#8C8C8C">–</td></tr></tbody></table><table-wrap-foot><fn><p>The first two columns of the table report the value of the stimulus-to-behavior control model without (left) and with (center) the contribution of the first derivative of the stimulus. The last column reports the value of the integrated stimulus-to-behavior model fed with the predicted firing rate of the OSN. The parameters listed in this table are used in all numerical simulations of the study, except for the validation controls described in <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>.</p></fn></table-wrap-foot></table-wrap></p><p>For the linear and nonlinear ramps, the stimulus-to-behavior GLM accurately reproduces the time courses of the experimental turn probability (blue lines, <xref ref-type="fig" rid="fig5">Figures 5E,F</xref>). The performance of the test model was compared to a control GLM in which the turn probability was directly predicted from the stimulus intensity without any sensory processing from the OSN (dashed magenta lines, <xref ref-type="fig" rid="fig5">Figure 5E,F</xref>). For this control model, we independently fitted the same GLM with the simulated OSN firing rate replaced by the stimulus intensity (‘Materials and methods’). The values of the parameters of the control model are reported in <xref ref-type="table" rid="tbl3">Table 3</xref>. The goodness of fit of the GLM was clearly contingent on the nonlinear transformation achieved by the OSN (<xref ref-type="table" rid="tbl4">Table 4</xref>). To rule out that the test GLM was overfitted, we trained the model on a subset of linear light ramps and validated the model on a set of nonlinear light ramps (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>).<table-wrap id="tbl4" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.018</object-id><label>Table 4.</label><caption><p>Quantification of the goodness of fit of the control and the test generalized linear model (GLM)</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.018">http://dx.doi.org/10.7554/eLife.06694.018</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th><named-content content-type="author-callout-style1">Control GLM <underline>without</underline> derivative</named-content></th><th><named-content content-type="author-callout-style1">Control GLM <underline>with</underline> derivative</named-content></th><th><named-content content-type="author-callout-style2">Test GLM</named-content></th></tr></thead><tbody><tr><td colspan="4">A Correlation coefficient (ρ)</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), low</td><td style="background:#8C8C8C">0.69</td><td style="background:#8C8C8C">0.75</td><td style="background:#8C8C8C">0.89</td></tr><tr><td> Linear (4 s), med</td><td>0.62</td><td>0.90</td><td>0.90</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), high</td><td style="background:#8C8C8C">0.67</td><td style="background:#8C8C8C">0.96</td><td style="background:#8C8C8C">0.95</td></tr><tr><td> Linear (4 s), slow</td><td>0.54</td><td>0.92</td><td>0.91</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), fast</td><td style="background:#8C8C8C">0.65</td><td style="background:#8C8C8C">0.76</td><td style="background:#8C8C8C">0.90</td></tr><tr><td> Linear (8 s)</td><td>−0.05</td><td>0.66</td><td>0.78</td></tr><tr><td style="background:#8C8C8C"> Quadratic</td><td style="background:#8C8C8C">0.11</td><td style="background:#8C8C8C">0.70</td><td style="background:#8C8C8C">0.88</td></tr><tr><td> Exponential</td><td>0.29</td><td>0.43</td><td>0.92</td></tr><tr><td style="background:#8C8C8C"> Sigmoid</td><td style="background:#8C8C8C">0.13</td><td style="background:#8C8C8C">0.61</td><td style="background:#8C8C8C">0.60</td></tr><tr><td> Asymptotic</td><td>−0.10</td><td>0.25</td><td>0.03</td></tr><tr><td style="background:#8C8C8C"> <italic>All conditions (all time points included)</italic></td><td style="background:#8C8C8C"><italic>0.53</italic></td><td style="background:#8C8C8C"><italic>0.74</italic></td><td style="background:#8C8C8C"><italic>0.86</italic></td></tr><tr><td colspan="4">B CV(RMSE)</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), low</td><td style="background:#8C8C8C">0.59</td><td style="background:#8C8C8C">0.54</td><td style="background:#8C8C8C">0.33</td></tr><tr><td> Linear (4 s), med</td><td>0.60</td><td>0.41</td><td>0.32</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), high</td><td style="background:#8C8C8C">0.75</td><td style="background:#8C8C8C">0.41</td><td style="background:#8C8C8C">0.33</td></tr><tr><td> Linear (4 s), slow</td><td>0.56</td><td>0.34</td><td>0.27</td></tr><tr><td style="background:#8C8C8C"> Linear (4 s), fast</td><td style="background:#8C8C8C">0.53</td><td style="background:#8C8C8C">0.45</td><td style="background:#8C8C8C">0.31</td></tr><tr><td> Linear (8 s)</td><td>1.06</td><td>0.71</td><td>0.59</td></tr><tr><td style="background:#8C8C8C"> Quadratic</td><td style="background:#8C8C8C">1.06</td><td style="background:#8C8C8C">0.73</td><td style="background:#8C8C8C">0.55</td></tr><tr><td> Exponential</td><td>0.84</td><td>0.85</td><td>0.39</td></tr><tr><td style="background:#8C8C8C"> Sigmoid</td><td style="background:#8C8C8C">0.95</td><td style="background:#8C8C8C">0.65</td><td style="background:#8C8C8C">0.58</td></tr><tr><td> Asymptotic</td><td>0.85</td><td>0.52</td><td>0.97</td></tr><tr><td style="background:#8C8C8C"> <italic>All conditions (all time points included)</italic></td><td style="background:#8C8C8C"><italic>0.65</italic></td><td style="background:#8C8C8C"><italic>0.51</italic></td><td style="background:#8C8C8C"><italic>0.39</italic></td></tr></tbody></table><table-wrap-foot><fn><p>Comparison of the performances of the integrated stimulus-to-behavior GLM and the control model bypassing the OSN processing. The outputs of the test and control GLMs are obtained based on the parameter sets listed in <xref ref-type="table" rid="tbl3">Table 3</xref>. <bold>(A)</bold> Application of Pearson's correlation coefficient (<italic>ρ</italic>) on the time course of the experimental turn probability and the simulated turn probability. Restriction of the quantification to the first 12 s of the ramp where the experimental estimate of the turn probability is reliable. <bold>(B)</bold> Same as panel <bold>A</bold> for the coefficient of variation of the RMSE. The goodness of fit computed for the entire set of ramps is reported at the bottom of the table for both metrics.</p></fn></table-wrap-foot></table-wrap></p><p>The successful application of the stimulus-to-behavior GLM led us to conclude that: (1) stationary levels of OSN firing rate lead to probabilistic transitions from run to turn. When the OSN spiking activity remains constant, the probability of turning at a given time is largely independent of the duration of the run; (2) excitation of the OSN suppresses turning (evident during rising phase of all ramps); (3) inhibition of the OSN facilitates turning (most evident during falling phase of the exponential ramp). Consistent with our finding that the OSN activity is sensitive to the slope of the ramp, we found that the performance of the control GLM was improved by combining the light intensity (<italic>x</italic>) with its first derivative (d<italic>x</italic>/d<italic>t</italic>) (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>). For the majority of ramps, this improvement did, however, not match the quality of the fit produced by the integrated stimulus-to-behavior GLM (<xref ref-type="table" rid="tbl4">Table 4</xref>). We concluded that the nonlinear response characteristics of the OSN have a noticeable influence on the control of orientation behavior.</p></sec><sec id="s2-7"><title>Predicting run-to-turn transitions in virtual olfactory gradients</title><p>To test the relevance of the integrated stimulus-to-behavior GLM in conditions in which the sensorimotor loop is closed, we synthesized a controlled light gradient with a shape comparable to that of the odor gradient (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). In this stimulation paradigm, the light intensity was continuously updated based on the position of the larva (‘Materials and methods’). <xref ref-type="fig" rid="fig6">Figure 6A</xref> illustrates the behavior of an <italic>Or42a</italic>&gt;ChR2 larva in a light gradient. As observed for the odor-evoked behavior (<xref ref-type="bibr" rid="bib37">Gomez-Marin et al., 2011</xref>), the larva ascended the light gradient and remained in the vicinity of its peak by implementing a series of runs and directed turns. In <xref ref-type="fig" rid="fig6">Figure 6B</xref>, we examined how the <italic>Or42a</italic>&gt;ChR2 OSN responds to a replay of the light intensity changes experienced during the trajectory shown in <xref ref-type="fig" rid="fig6">Figure 6A</xref>. The spiking activity of the OSN displayed considerable processing of the stimulation pattern. This transformation of the stimulus was well captured by the IFF model. To predict the temporal evolution of the turn probability associated with individual runs, we fed the predicted spiking activity of the OSN into the GLM trained on the open-loop light ramps (<xref ref-type="fig" rid="fig5">Figure 5</xref> and <xref ref-type="table" rid="tbl3">Table 3</xref>). Correlating the predictions of the model with the termination of the actual runs revealed that the initiation of a turn was typically preceded by a steady increase in the predicted probability of turning (<xref ref-type="fig" rid="fig6">Figure 6B,C</xref> and <xref ref-type="other" rid="video1">Video 1</xref>). To quantify this trend, we analyzed a large set of runs included in 25 trajectories, each trajectory corresponding to a different animal (representation of a subset of 10 trajectories in <xref ref-type="fig" rid="fig6">Figure 6D</xref>). Since every run corresponded to a unique sensory experience, the predictions of the stimulus-to-behavior GLM could only pertain to the average behavior observed over multiple runs. We therefore analyzed the averaged trend of the turn probability preceding individual turns.<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.012</object-id><label>Figure 6.</label><caption><title>Predictions of the integrated stimulus-to-behavior generalized linear model (GLM) for run-to-turn transitions observed in a virtual olfactory gradient.</title><p>(<bold>A</bold>) Synthetic chemotaxis in a virtual odor gradient produced by light stimulation. The larva experiences a light intensity determined by a predefined stimulus landscape. The landscape displayed in the background of panel <bold>A</bold> is an exponential gradient centered on a point ‘source’. Larvae responding to this light gradient accumulate at the gradient's peak as observed for odor gradients. Illustrative trajectory of the midpoint (black) and head (magenta). Black arrows indicate the direction of motion. (<bold>B</bold>) Sensorimotor analysis of a representative trajectory. (Top) Time course of the light intensity associated with the trajectory displayed in panel <bold>A</bold>. (Middle) PSTH of the OSN activity measured experimentally upon a replay of the intensity time course at the electrophysiology rig (black line). Numerical simulations of the neural activity carried out by the IFF motif (green line) presented in <xref ref-type="fig" rid="fig4">Figure 4B</xref>. (Bottom) Turn probability (blue line) predicted from the integrated stimulus-to-behavior GLM presented in <xref ref-type="fig" rid="fig5">Figure 5D</xref> (parameter set listed in <xref ref-type="table" rid="tbl3">Table 3</xref>). The neural activity simulated in the middle panel is fed into the GLM to predict the turn probability shown in the bottom panel. Behavioral predictions are only shown for the sequences associated with runs. (<bold>C</bold>) Overlay of the trajectory of the midpoint with the predicted turn probability color-coded in accordance with the color bar on the left. We observe that the turn probability tends to increase (red color range) when the larva is moving away from the gradient's peak, whereas it decreases (blue color range) when the larva is moving toward the peak. (<bold>D</bold>) Overlay of 10 trajectories recorded in the exponential light gradient shown in panel <bold>A</bold>. For each trajectory, the position of the midpoint is shown in gray. Turns are indicated as small black circles. (<bold>E</bold>) Turn-triggered average of the predicted turn probability for the exponential light gradient. A comparison is made between predictions based on the simulated OSN activity driven by the stimulus intensity (test model, blue line), predictions based on the simulated OSN activity driven by the time-reversed stimulus time course (uncoupled control, black line), and predictions based on the assumption that the neural activity stays constant over the course of each trajectory (constant control, magenta line). The parameters of the stimulus-to-behavior GLM are listed in <xref ref-type="table" rid="tbl3">Table 3</xref>. We observe that the turn probability steeply increases 4 s before the turn, which coincides with the median duration (3.8 s) of the entire set of runs. Analysis conduced over 750 runs with a duration of minimum 1 s. Shaded areas represent SEM. (<bold>F</bold>) Log-likelihood of the predictions of the stimulus-to-behavior test GLM compared to the controls. Bootstrap analysis of the difference in log-likelihood (logL) between the test model and the controls normalized by the log-likelihood of the test model (ΔlogL/logL<sub>test</sub>). Distribution of the relative difference in logL is shown for the test model against the constant neural activity control (red), and the uncoupled stimulus control (black). The median of the distribution is equal to the value obtained from the original full set of runs; the median of the entire distribution is indicated by a dot in the x-axis. As an internal control, the test model was compared to itself (blue). Out of 10,000 resampled subsets of runs, none of the controls was found to be more likely than the test model (p &lt; 0.0001). The analysis included all observed runs with a duration of minimum 1 s (750 runs originating from 25 trajectories).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.012">http://dx.doi.org/10.7554/eLife.06694.012</ext-link></p></caption><graphic xlink:href="elife-06694-fig6-v1"/></fig><media content-type="glencoe play-in-place height-250 width-310" id="video1" mime-subtype="mov" mimetype="video" xlink:href="elife-06694-media1-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.06694.019</object-id><label>Video 1.</label><caption><title>Illustrative trajectory sequence in an exponential light gradient with predicted turn probability colored in red.</title><p>The scale bar at the bottom left of the Video represents 1 cm. The green trace displays a 20 s segment of the past positions of the centroid. White spots represent the position of the head every 20 frames (or 0.66 s). The behavioral sequence is accelerated by a factor 3.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.019">http://dx.doi.org/10.7554/eLife.06694.019</ext-link></p></caption></media></p><p>As reported in previous work (<xref ref-type="bibr" rid="bib37">Gomez-Marin et al., 2011</xref>), we found that the stimulus intensity decreases steadily for several seconds prior to a turn (data not shown). Accordingly, the stimulus-to-behavior GLM predicted that the stimulus downslope was transformed into a monotonic increase in turn probability (light blue line, <xref ref-type="fig" rid="fig6">Figure 6E</xref>). To establish the sensorimotor control underlying this trend, we computed the turn-triggered averages of the turn probability by using two control models (‘Materials and methods’): (1) behavioral predictions based on the assumption that the OSN spiking activity remained constant throughout the trajectory and (2) behavioral predictions upon uncoupling of the stimulus and the behavior by temporally inverting the reconstructed time course of the stimulus. In contrast to the test GLM, neither control displayed a substantial increase in turn probability prior to turning (red and back dashed lines, <xref ref-type="fig" rid="fig6">Figure 6E</xref>). The significance of the improvement in the predictive power of the test model relative to the controls was established by comparing the log-likelihood computed over the entire set of runs (<xref ref-type="fig" rid="fig6">Figures 6F</xref>, bottom panel and ‘Materials and methods’). This allowed us to conclude that the integrated neural-to-behavior model built on controlled conditions of stimulation (open-loop paradigm) was sufficient to predict run-to-turn transitions arising from free behavior in a virtual odor gradient (closed-loop paradigm).</p></sec><sec id="s2-8"><title>Inhibition of OSN spiking activity facilitates turning during free behavior</title><p>Next, we tested the idea that inhibition of the OSN activity at the stimulus offset is sufficient to trigger a nearly deterministic release of turning during free behavior. To this end, we designed radially symmetrical light landscapes with geometrical features producing inhibition or maintenance of OSN activity during free motion. As a control, we considered a landscape with an exponential rise interrupted by an exponential fall at a fixed distance of 8 mm from the center (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, top panel, ‘rim’ indicated by a dashed line). The shape of this landscape is reminiscent of a ‘volcano’. The geometry of the landscape was chosen such that a larva moving at a speed of 1 mm/s from the foot of the gradient toward its center would experience a light pattern similar to the 8-s exponential ramp (<xref ref-type="fig" rid="fig5">Figure 5F</xref> and <xref ref-type="fig" rid="fig7">Figure 7Ai</xref>). In response to an exponential ramp, the spiking activity of the OSN featured a steady increase followed by a rapid decrease. We therefore expected to observe turn suppression during the rising phase of the ramp and turn facilitation during the falling phase of the ramp. The tendency of larvae to initiate turning upon crossing of the volcano's rim was evident from the set of runs that moved from the outer to the inner edge of the volcano (<xref ref-type="fig" rid="fig7">Figure 7Aii</xref>, bottom panel). The alternation between turn suppression and turn facilitation resulted in a zigzagging of trajectories across the rim of the volcano. The integrated stimulus-to-behavior GLM predicted a rise in the turn probability prior to the interruption of a run (<xref ref-type="fig" rid="fig7">Figure 7E</xref> and <xref ref-type="other" rid="video2">Video 2</xref>).<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.020</object-id><label>Figure 7.</label><caption><title>Predictions of run-to-turn transitions elicited by a family of radially symmetrical light landscapes.</title><p>(<bold>Ai</bold>–<bold>Di</bold>) Stereotyped OSN responses to light ramps starting with a common 8-s exponential rise: ramp with a smooth exponential fall (‘volcano’, see panel <bold>A</bold>), ramp with an abrupt fall to basal intensity (‘well’, see panel <bold>B</bold>), ramp with a prolongation of the maximum intensity (‘mesa’, see panel <bold>C</bold>), and ramp with a linear increase (‘linear’, see panel <bold>D</bold>). The spiking activity of the OSN is computed from the pure IFF (ODE) model presented in <xref ref-type="fig" rid="fig4">Figure 4B</xref> (parameter set listed in <xref ref-type="table" rid="tbl1">Table 1</xref>). Time course of the light intensity shown in magenta; first derivative of the light intensity shown in gray; simulated OSN activity shown in green. (<bold>Ai</bold>) Experimental and predicted OSN activity elicited by an exponential rise followed by an exponential fall. (<bold>Aii</bold>) Symmetrical two-dimensional light landscapes corresponding to the exponential ‘volcano’ profile described in panel <bold>Ai</bold>. (Top) Set of 54 trajectories superimposed onto the stimulus landscape. (Bottom) Set of 48 runs starting from the external edge of the ‘volcano’ and heading toward its center (minimum run duration: 1 s). (<bold>Bi</bold>) Same as <bold>Ai</bold> for the ‘well’ profile. Strong inhibition of the OSN activity follows the abrupt fall in light intensity. (<bold>Bii</bold>) Crossing of the rim leads to an aversive response. As a consequence, larvae avoid the well at the center of the landscape. Set of 42 trajectories represented in the diagram at the top; set of 63 entering runs represented in the diagram at the bottom. (<bold>Ci</bold>) Same as <bold>Ai</bold> for the ‘mesa’ profile. The transition from an exponential rise in light intensity to constant intensity leads to a transient drop in neural activity before a steady state value is reached. (<bold>Cii</bold>) For the mesa landscape, crossing of the rim does not lead to an aversive response: larvae tend to maintain their ongoing run. The center of the landscape is therefore visited. Set of 36 trajectories represented in the diagram at the top; set of 79 entering runs represented in the diagram at the bottom. (<bold>Di</bold>) Same as <bold>Ai</bold> for a ‘linear’ hat profile. The deceleration in stimulus from an exponential rise to a linear rise leads to a transient drop in neural activity before a steady state value is reached. The corresponding OSN dynamics is similar to that elicited by the mesa (panel <bold>Ci</bold>). (<bold>Dii</bold>) Upon crossing of the rim of the linear hat landscape, larvae undergo a deceleration in light intensity that is expected to modulate behavior in a way similar to the mesa landscape. Set of 47 trajectories represented in the diagram at the top; set of 72 entering runs represented in the diagram at the top. (<bold>E</bold>) Turn-triggered averages of the predicted turn probability for the subset of runs entering the landscape's central area (bottom graphs of <bold>Aii</bold>–<bold>Dii</bold>). Each run included in the analysis crosses the rim of the landscape (minimum run duration: 1 s). Shaded areas represent SEM. (<bold>F</bold>) Distribution of run durations following the crossing of the landscape's rim. Analysis restricted to the subset of runs described in the diagram at the tops of panels <bold>Aii</bold>–<bold>Dii</bold> (runs entering the central area of the landscape). The experience of an abrupt fall in light intensity promotes rapid turning (‘well’ condition), whereas runs are elongated by constant light stimulation or by a linear rise in light intensity (‘mesa’ and ‘linear’ landscapes). Differences between the median of the run durations associated with each of the four landscapes is assessed through a Kruskal–Wallis test (p &lt; 10<sup>−10</sup>) followed by pair-wise Wilcoxon tests with a Bonferroni correction (for the non-significant difference p &gt; 0.05/6; for all other pairwise comparisons p &lt; 0.05/6). The behavior predicted from turn probability (panel <bold>E</bold>) is in good agreement with the shortening or elongation of the runs observed for each of the four landscapes.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.020">http://dx.doi.org/10.7554/eLife.06694.020</ext-link></p></caption><graphic xlink:href="elife-06694-fig7-v1"/></fig><media content-type="glencoe play-in-place height-250 width-310" id="video2" mime-subtype="mov" mimetype="video" xlink:href="elife-06694-media2-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.06694.021</object-id><label>Video 2.</label><caption><title>Illustrative trajectory sequence in ‘volcano’ light gradient with predicted turn probability colored in red.</title><p>The scale bar at the bottom left of the Video represents 1 cm. The green trace displays a 20 s segment of the past positions of the centroid. White spots represent the position of the head every 20 frames (or 0.66 s). The behavioral sequence is accelerated by a factor 3.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.021">http://dx.doi.org/10.7554/eLife.06694.021</ext-link></p></caption></media></p><p>We then considered an extreme version of the volcano: a well (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). In this landscape, the light intensity experienced by a larva moving toward the center of the well corresponded to an exponential rise followed by a near-instantaneous drop. The IFF model correctly reproduced the strong inhibitory phase experimentally observed in the OSN spiking activity (<xref ref-type="fig" rid="fig7">Figure 7Bi</xref>, bottom panel). This inhibition was expected to generate a nearly deterministic release of turns. Consistently, larvae avoided the well region (<xref ref-type="fig" rid="fig7">Figure 7Bii</xref>). Such a behavior was correctly described by the GLM, which predicted a dramatic increase in turn probability following the crossing of the rim (<xref ref-type="fig" rid="fig7">Figure 7E</xref> and <xref ref-type="other" rid="video3">Video 3</xref>). To probe the idea that sustained OSN spiking activity suppresses turning, we synthesized a landscape complementary to the well: a ‘mesa’ in which the light intensity at the rim was extended to the central area of the landscape (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). During the transition from an exponential rise in light intensity to a plateau value, the OSN underwent a mild drop in spiking activity before a stationary value was reached—a feature accurately reproduced by the IFF motif (<xref ref-type="fig" rid="fig7">Figure 7Ci</xref>). The stimulus-to-behavior GLM predicted a modest increase in turn probability upon crossing of the rim without significant avoidance of the central area of the mesa (<xref ref-type="fig" rid="fig7">Figure 7E</xref> and <xref ref-type="other" rid="video4">Video 4</xref>). This prediction was corroborated by our experimental results (<xref ref-type="fig" rid="fig7">Figure 7Cii</xref>, bottom panel).<media content-type="glencoe play-in-place height-250 width-310" id="video3" mime-subtype="mov" mimetype="video" xlink:href="elife-06694-media3-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.06694.022</object-id><label>Video 3.</label><caption><title>Illustrative trajectory sequence in the ‘well’ light gradient with predicted turn probability colored in red.</title><p>The scale bar at the bottom left of the Video represents 1 cm. The green trace displays a 20 s segment of the past positions of the centroid. White spots represent the position of the head every 20 frames (or 0.66 s). The behavioral sequence is accelerated by a factor 3.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.022">http://dx.doi.org/10.7554/eLife.06694.022</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="video4" mime-subtype="mov" mimetype="video" xlink:href="elife-06694-media4-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.06694.023</object-id><label>Video 4.</label><caption><title>Illustrative trajectory sequence in the plateau light gradient with predicted turn probability colored in red.</title><p>The scale bar at the bottom left of the Video represents 1 cm. The green trace displays a 20 s segment of the past positions of the centroid. White spots represent the position of the head every 20 frames (or 0.66 s). The behavioral sequence is accelerated by a factor 3.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.023">http://dx.doi.org/10.7554/eLife.06694.023</ext-link></p></caption></media></p><p>Finally, we considered an intermediate landscape consisting of a linear ‘hat’ (a cone) in which runs moving toward the center underwent a deceleration in stimulus intensity during the transition from the exponential rise to the linear rise (‘linear’, <xref ref-type="fig" rid="fig7">Figure 7D</xref>). Due to the sensitivity of the OSN activity to deceleration in the stimulus intensity, the linear hat landscape led to a modest drop in firing rate similar to that observed for the mesa (<xref ref-type="fig" rid="fig7">Figure 7Di</xref>). The IFF model faithfully reproduced this counterintuitive observation. At a behavioral level, the stimulus-to-behavior GLM predicted no significant difference between the behavior evoked by the mesa and the linear hat landscapes (<xref ref-type="fig" rid="fig7">Figure 7E</xref> and <xref ref-type="other" rid="video5">Video 5</xref>). These predictions were in good agreement with the free behavior of larvae (<xref ref-type="fig" rid="fig7">Figure 7Dii</xref>, bottom panel).<media content-type="glencoe play-in-place height-250 width-310" id="video5" mime-subtype="mov" mimetype="video" xlink:href="elife-06694-media5-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.06694.024</object-id><label>Video 5.</label><caption><title>Illustrative trajectory sequence in the linear ‘hat’ light gradient with predicted turn probability colored in red.</title><p>The scale bar at the bottom left of the Video represents 1 cm. The green trace displays a 20 s segment of the past positions of the centroid. White spots represent the position of the head every 20 frames (or 0.66 s). The behavioral sequence is accelerated by a factor 3.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.024">http://dx.doi.org/10.7554/eLife.06694.024</ext-link></p></caption></media></p><p>To assess the predictive power of the integrated stimulus-to-behavior GLM, we compared the average turn probability preceding a turn (<xref ref-type="fig" rid="fig7">Figure 7E</xref>) with the observed latency to turning upon crossing of the rim (<xref ref-type="fig" rid="fig7">Figure 7F</xref>). The well was associated with the prediction of the steepest increase in turn probability, leading to the expectation that most runs stopped within 2 s of the rim crossing. The volcano led to a milder increase in the predicted turn probability for about 3 s, while the mesa and linear hat were predicted to generate an even weaker increase. As shown in <xref ref-type="fig" rid="fig7">Figure 7F</xref>, we found that the average latency to turn was shortest for the well landscape (0.93 s) followed by the volcano (3.48 s). We observed significantly longer turn latencies for the mesa and linear hat with no difference between the two conditions (6.6 s and 6.7 s, respectively). In conclusion, the use of synthetic light landscapes permitted us to experimentally demonstrate that sustained OSN spiking activity suppresses turning during free behavior, whereas inhibition of the OSN activity promotes run-to-turn transitions in a nearly deterministic manner. This approach established that the relatively simple linear control underlying the GLM trained on the behavior of larvae experiencing stereotyped open-loop light stimulations is sufficient to account for the control of behavior elicited under conditions of closed-loop light stimulation.</p></sec><sec id="s2-9"><title>Sensorimotor control can be predicted for free behavior in odor gradients</title><p>Our ultimate goal was to test the ability of the integrated stimulus-to-behavior model to predict the duration of runs in an odor gradient. In a real odor landscape (<xref ref-type="fig" rid="fig8">Figure 8A</xref>), larvae accumulated at the peak of the gradient with a dispersal notably larger than that observed in a light gradient (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). This apparent decrease in orientation performances can be partly explained by the shallower geometry of the odor gradient (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>). In <xref ref-type="fig" rid="fig8">Figure 8B</xref>, the goodness of fit between the spiking activity of the OSN and the output of the IFF+IFB model can be appreciated for the representative trajectory highlighted in <xref ref-type="fig" rid="fig8">Figure 8A</xref> (magenta trace). To predict run-to-turn transitions during free motion in a real odor gradient, we replaced the pure IFF model devised for light-evoked spiking activity by the composite IFF+IFB model as input for the stimulus-to-behavior GLM trained on the open-loop light ramps (<xref ref-type="fig" rid="fig5">Figure 5D</xref> and <xref ref-type="table" rid="tbl3">Table 3</xref>). The model predicted that runs were on average associated with a monotonic increase in the turn probability during several seconds before a turn (<xref ref-type="fig" rid="fig8">Figure 8C</xref>). Based on these predictions, we computed the likelihood of the ensemble of runs observed in the odor gradient. This likelihood was significantly larger than that computed for two control models (<xref ref-type="fig" rid="fig8">Figure 8D</xref>). Together, these results establish that the structure and parameters of the integrated stimulus-to-behavior GLM form a solid conceptual basis to describe how the sensory dynamics of single OSNs influence run-to-turn transitions during naturalistic behavior (<xref ref-type="other" rid="video6">Video 6</xref>).<fig-group><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.025</object-id><label>Figure 8.</label><caption><title>Predictions of the integrated stimulus-to-behavior model for run-to-turn transitions observed in a real odor gradient.</title><p>(<bold>A</bold>) Superimposition of 10 consecutive trajectories observed in an odor gradient of isoamyl acetate (same experimental conditions as <xref ref-type="fig" rid="fig1">Figure 1</xref>). For every trajectory, the position of the midpoint is shown in gray. Small black circles indicate turns. The head position of the trajectory presented in <xref ref-type="fig" rid="fig1">Figure 1A</xref> is highlighted in magenta. Arrows indicate the direction of motion. The odor gradient shown in the background corresponds to the reconstructed snapshot 60 s after the onset of the diffusion process (‘Materials and methods’). (<bold>B</bold>) Sensorimotor analysis of a representative trajectory. (Top) Time course of the reconstructed odor concentration associated with the trajectory displayed in panel <bold>A</bold>. (Center) PSTH of the OSN measured experimentally in response to a replay of the odor concentration course (black line). Neural activity simulated by the composite IFF+IFB ODE model (blue line) presented in <xref ref-type="fig" rid="fig4">Figure 4B</xref> (parameter set listed in <xref ref-type="table" rid="tbl1">Table 1</xref>). (Bottom) Turn probability (blue line) predicted by the stimulus-to-behavior GLM trained on the light-evoked open-loop behavior reported in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> (parameter set listed in <xref ref-type="table" rid="tbl3">Table 3</xref>). The neural activity simulated in the middle panel is fed into the GLM to predict the turn probability shown in the bottom panel. Behavioral predictions are only shown for the sequences associated with runs. The predicted turn probability is only shown for the behavioral sequences associated with runs. (<bold>C</bold>) Turn-triggered average of the predicted probability of turning for behavior observed in the odor gradient. A comparison is made between predictions based on the simulated OSN activity driven by the stimulus intensity (coupled test, blue), predictions based on the simulated OSN activity driven by the time-reversed stimulus time courses (uncoupled control, black), and predictions based on the assumption that the neural activity stays constant over the course of each trajectory (constant control, red). As for the light gradient, we observe that the predicted turn probability increases 5 s before the turn, which coincides with the median duration (5.4 s) of the entire set of runs. Since the geometry of the odor gradient is shallower than the light gradient (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>), the increase in turn probability has a reduced amplitude compared to the behavior elicited by the light gradient (<xref ref-type="fig" rid="fig6">Figure 6E</xref>). Shaded areas denote SEM. (<bold>D</bold>) Log-likelihood of the predictions of the integrated stimulus-to-behavior GLM compared to the controls. Bootstrap analysis of the difference in log-likelihood (logL) of the test model and the controls normalized by the log-likelihood of the test model (ΔlogL/logL<sub>test</sub>). Distribution of the relative difference in logL computed for the test model against itself (blue), against the constant neural activity control (red), and against the uncoupled stimulus control (gray). The median of the distribution is equal to the value obtained from the original full set of runs; the median of the entire distribution is indicated by a dot in the x-axis. Based on 10,000 resampled subsets of runs, we conclude that the test model is significantly larger than both controls (p = 0.0001 for the constant neural activity control and the uncoupled stimulus control). For panels <bold>C</bold> and <bold>D</bold>, the analysis includes all runs with a duration of minimum 1 s (304 runs originating from 20 trajectories).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.025">http://dx.doi.org/10.7554/eLife.06694.025</ext-link></p></caption><graphic xlink:href="elife-06694-fig8-v1"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06694.026</object-id><label>Figure 8—figure supplement 1.</label><caption><title>Comparison of the geometry of the exponential light gradient and the odor gradient.</title><p>(<bold>A</bold>) Reconstruction of the odor gradient displayed in <xref ref-type="fig" rid="fig1 fig8">Figures 1, 8</xref> with color-coding in accordance with the scale on the right. Snapshot corresponding to the odor landscape 60 s after the initiation of the diffusion process. Cross-section intersecting the gradient's peak: f(5, <italic>y</italic>). (<bold>B</bold>) Same as panel <bold>A</bold> for the light gradient presented in <xref ref-type="fig" rid="fig6">Figure 6</xref>. Cross-section along gradient: g(5, <italic>y</italic>). (<bold>C</bold>) Comparison of the cross-sections f and g of the odor and light gradients, respectively. Each profile was normalized by its maximum value reached under the gradient's peak. (<bold>D</bold>) Comparison of the derivative of the cross-sections of the odor and light gradients: df/d<italic>y</italic> and dg/d<italic>y</italic> where y represents the variable associated with the vertical axis. From this analysis, we observe that the slope of the light gradient is considerably steeper than the slope of the odor gradient, which is expected to facilitate chemotaxis.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.026">http://dx.doi.org/10.7554/eLife.06694.026</ext-link></p></caption><graphic xlink:href="elife-06694-fig8-figsupp1-v1"/></fig></fig-group><media content-type="glencoe play-in-place height-250 width-310" id="video6" mime-subtype="mov" mimetype="video" xlink:href="elife-06694-media6-v1.mov"><object-id pub-id-type="doi">10.7554/eLife.06694.027</object-id><label>Video 6.</label><caption><title>Illustrative trajectory sequence in odor gradient with turn probability colored in red. Same trajectory as that shown in <xref ref-type="fig" rid="fig8">Figure 8A</xref>.</title><p>Superimposition of the behavior on the dynamical reconstruction of the odor gradient based on the PDE simulations. The scale bar at the bottom left of the Video represents 5 mm. The green trace displays a 20 s segment of the past positions of the centroid. White spots represent the position of the head every 20 frames (or 0.66 s).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.027">http://dx.doi.org/10.7554/eLife.06694.027</ext-link></p></caption></media></p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Most primary sensory neurons operate differently from proportional counters (<xref ref-type="bibr" rid="bib85">Rieke, 1997</xref>; <xref ref-type="bibr" rid="bib90">Song et al., 2012</xref>). Individual OSNs of <italic>C. elegans</italic> and cockroaches function as bipolar detectors that selectively respond to either increases or decreases in stimulus intensity (<xref ref-type="bibr" rid="bib94">Tichy et al., 2005</xref>; <xref ref-type="bibr" rid="bib16">Chalasani et al., 2007</xref>). A similar specialization into ON-OFF detection pathways has been observed for thermotaxis in <italic>C. elegans</italic> (<xref ref-type="bibr" rid="bib92">Suzuki et al., 2008</xref>) and motion perception in adult flies (<xref ref-type="bibr" rid="bib45">Joesch et al., 2010</xref>). In contrast with these binary sensory responses, we discovered that a single larval OSN is sensitive to both the stimulus intensity and its first derivative. The enhanced information-processing capacity of primary olfactory neurons in the larva is consistent with the response characteristics of OSNs in adult flies, which encode complex dynamical features of airborne odorant stimuli (<xref ref-type="bibr" rid="bib51">Kim et al., 2011</xref>; <xref ref-type="bibr" rid="bib69">Martelli et al., 2013</xref>).</p><p>To describe the input–output response properties of single larval OSNs, we set out to build a biophysical model of the olfactory transduction pathway. IFB motifs constitute the core mechanism of chemoreception in bacteria, olfactory transduction, and phototransduction (<xref ref-type="bibr" rid="bib104">Yi et al., 2000</xref>; <xref ref-type="bibr" rid="bib23">De Palo et al., 2013</xref>). In adult flies, <xref ref-type="bibr" rid="bib76">Nagel and Wilson (2011)</xref> investigated how the potential involvement of negative feedback on the olfactory transduction cascade could account for dynamical and adaptive features of OSN response. On the other hand, IFF motifs are implicated in the regulation of numerous cellular and developmental processes (<xref ref-type="bibr" rid="bib34">Goentoro and Kirschner, 2009</xref>; <xref ref-type="bibr" rid="bib60">Lim et al., 2013</xref>), and their contribution to sensory processing has been documented in recent work (<xref ref-type="bibr" rid="bib48">Kato et al., 2014</xref>; <xref ref-type="bibr" rid="bib62">Liu et al., 2015</xref>). These results led us to conjecture that two regulatory motifs might be involved in larval olfactory transduction: an IFB and an IFF featuring direct excitation and indirect inhibition (<xref ref-type="fig" rid="fig4">Figure 4A,B</xref>). Using a parameter optimization approach, we found that a pure IFF motif is sufficient to approximate the response properties of the OSN. Combining the IFF and IFB motifs was nonetheless necessary to recapitulate the richness of OSN dynamics elicited by naturalistic olfactory stimuli (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Consistent with the model proposed by <xref ref-type="bibr" rid="bib76">Nagel and Wilson (2011)</xref>, our numerical simulations indicate that the integral feedback applies to the signaling pathway specific to the odorant receptor (OR). Nagel and Wilson have suggested that a diffusible effector—potentially intracellular calcium—inhibits the activity of the OR, thereby affecting the onset and offset kinetics of the OSN response. By contrast, the IFF motif would describe a regulatory mechanism acting on components of the transduction pathway downstream from the OR (<xref ref-type="bibr" rid="bib39">Gu et al., 2009</xref>). It is plausible that the IFF regulation is also mediated by intracellular calcium.</p><p>What features of the olfactory stimulus are encoded in the spiking dynamics of single larval OSNs? Our biophysical model of the olfactory transduction cascade shows that the spiking activity of the OSN follows a standard hyperbolic dose-response when stimulated by prolonged pulses of odor (‘Materials and methods’). In this regime, the maximum OSN firing rate we observed for IAA is modest (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Changes in odor concentration occurring on a timescale relevant to the behavior—a second or shorter—can produce significantly higher (or lower) firing rates. This sensitivity to positive and negative changes in stimulus intensity can be explained by the mathematical solution we derived for the OSN dynamics (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). Upon changes in odor concentration, the dose–response function describing the OSN spiking activity is transiently rescaled (or ‘normalized’) by the short-term history of the stimulus derivative (‘memory’ on characteristic time scale of 1 s, see ‘Materials and methods’). As a result, positive derivatives in stimulus intensity excite the OSN. Negative derivatives can inhibit the OSN firing rate in a manner consistent with the stimulus-offset inhibitions observed in adult-fly OSNs (<xref ref-type="bibr" rid="bib41">Hallem et al., 2004</xref>; <xref ref-type="bibr" rid="bib76">Nagel and Wilson, 2011</xref>). Our model indicates that a single <italic>Or42a</italic> OSN combines the function of a slope (ON) detector in response to positive gradients and an OFF detector in response to negative gradients. When larvae ascend Gaussian odor gradients originating from single odor sources, we thus expect high OSN firing rates. Robust inhibition of OSN spiking activity would result from motion that takes larvae down the odor gradient.</p><p>How relevant are the features encoded by the spiking activity of the <italic>Or42a</italic> OSN to the behavioral dynamics directing chemotaxis? To address this question, we substituted the odor stimulation with optogenetics-based light stimulation and gained unprecedented control over the spiking activity evoked in a genetically targeted OSN. Under the conditions of open-loop light stimulation, we found that OFF responses (offset inhibition of the OSN firing) promote turning, whereas ON responses (sustained high firing) suppress turning (<xref ref-type="fig" rid="fig5">Figure 5</xref>). We applied a GLM to describe the link between the OSN spiking dynamics and the probability of switching from a run to a turn (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). The accuracy of the model's output showed a striking dependence on the nonlinear transformation achieved by the olfactory transduction cascade (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>). Ultimately, we combined the biophysical model for the OSN spiking dynamics with the GLM to make robust predictions about closed-loop behavior in virtual and in real odor gradients (<xref ref-type="fig" rid="fig6 fig7 fig8">Figures 6–8</xref>).</p><p>The integrated stimulus-to-behavior GLM clarifies how features encoded in the activity pattern of individual primary olfactory neurons influence behavioral dynamics. The information transmitted by a single larval OSN is sufficient to represent positive and negative odor gradients through the excitation and inhibition of spiking activity. Unlike for chemotaxis and thermotaxis in <italic>C. elegans</italic> where the ON and OFF pathways are associated with different cellular substrates (<xref ref-type="bibr" rid="bib16">Chalasani et al., 2007</xref>; <xref ref-type="bibr" rid="bib92">Suzuki et al., 2008</xref>), the same larval OSN is capable of controlling up-gradient and down-gradient sensorimotor programs. This observation echoes findings recently made for thermotaxis in the <italic>Drosophila</italic> larva (<xref ref-type="bibr" rid="bib53">Klein et al., 2015</xref>). Furthermore, it corroborates the idea that sensory representations are rapidly transformed into motor representations in the circuit controlling chemotaxis (<xref ref-type="bibr" rid="bib66">Luo et al., 2014</xref>).</p><p>In the future, it will be important to define whether the sensorimotor principles proposed for the <italic>Or42a</italic> OSN can be generalized to OSNs expressing other odorant receptors (<xref ref-type="bibr" rid="bib25">Fishilevich et al., 2005</xref>; <xref ref-type="bibr" rid="bib56">Kreher et al., 2008</xref>; <xref ref-type="bibr" rid="bib73">Mathew et al., 2013</xref>). In addition, the network of interneurons located in the larval antennal lobe (<xref ref-type="bibr" rid="bib19">Das et al., 2013</xref>) is expected to participate in the processing of olfactory information arising from the OSNs (<xref ref-type="bibr" rid="bib4">Asahina et al., 2009</xref>; <xref ref-type="bibr" rid="bib58">Larkin et al., 2010</xref>). Although our work suggests that the computations achieved by the antennal lobe are not strictly necessary to guide robust chemotaxis (see also ‘Materials and methods’), the function of the transformation carried out by the synapse between the <italic>Or42a</italic> OSN and its cognate projection neuron (PN) remains to be elucidated in the larva (<xref ref-type="bibr" rid="bib84">Ramaekers et al., 2005</xref>; <xref ref-type="bibr" rid="bib4">Asahina et al., 2009</xref>; <xref ref-type="bibr" rid="bib72">Masuda-Nakagawa et al., 2009</xref>). As adult-fly PNs encode the second derivative of olfactory stimuli (<xref ref-type="bibr" rid="bib52">Kim et al., 2015</xref>) including circuit elements downstream of the OSNs in the present multilevel model are expected to improve the accuracy of the behavioral predictions of the model.</p><p>The aim of this study was to clarify the relationships between the peripheral encoding of naturalistic olfactory stimuli and gradient ascent toward an odor source. By exploiting the sufficiency of a single OSN to direct larval chemotaxis (<xref ref-type="bibr" rid="bib25">Fishilevich et al., 2005</xref>; <xref ref-type="bibr" rid="bib65">Louis et al., 2008</xref>), we developed a mathematical model accounting for the transformation of time-varying stimuli into the firing rate of an OSN and the conversion of dynamical patterns of OSN activity into the selection between two basic types of action—running and turning. It will be interesting to examine the validity of the present model for the sensorimotor control of other aspects of larval chemotaxis such as turn orientation through lateral head casts (casting-to-turn transitions). In adult flies, turn orientation is determined by the crossing of the boundaries of odor plumes: upon encountering of an odor plume, flies veer upwind whereas exiting the plume initiates lateral and vertical casting (<xref ref-type="bibr" rid="bib97">van Breugel and Dickinson, 2014</xref>)—an orientation strategy related to the surge-and-cast response of moths (<xref ref-type="bibr" rid="bib15">Carde and Willis, 2008</xref>). To orient in a rapidly changing olfactory landscape, the OSNs of various flying insects are capable of tracking rapid odor pulses on sub-second timescales and differentiating these signals (<xref ref-type="bibr" rid="bib51">Kim et al., 2011</xref>; <xref ref-type="bibr" rid="bib29">Fujiwara et al., 2014</xref>; <xref ref-type="bibr" rid="bib93">Szyszka et al., 2014</xref>). Whether the processing of turbulent olfactory inputs involves more temporal integration than that described by the sensorimotor model proposed here remains to be elucidated. Finally, the <italic>Drosophila</italic> larva offers a unique opportunity to delineate the neural circuit basis of behavior (<xref ref-type="bibr" rid="bib78">Ohyama et al., 2013</xref>, <xref ref-type="bibr" rid="bib79">2015</xref>). Interdisciplinary approaches combining behavioral screens, functional imaging, and circuit reconstruction on the one hand (<xref ref-type="bibr" rid="bib103">Yao et al., 2012</xref>), and computational modeling and robotics on the other hand (<xref ref-type="bibr" rid="bib38">Grasso et al., 2000</xref>; <xref ref-type="bibr" rid="bib99">Webb, 2002</xref>; <xref ref-type="bibr" rid="bib44">Izquierdo and Lockery, 2010</xref>; <xref ref-type="bibr" rid="bib3">Ando et al., 2013</xref>), should improve our understanding of how brains with reduced numerical complexity exploit streams of sensory information to direct action selection.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Fly stocks</title><p>All behavioral experiments shown in the main figures were achieved with third instar larvae expressing the co-receptor Orco in only one OSN (<xref ref-type="bibr" rid="bib25">Fishilevich et al., 2005</xref>) (<italic>Or42a</italic>-Gal4&gt;UAS-<italic>Orco</italic>,UAS-ChR2-H134R;<italic>Orco</italic><sup>−/−</sup>) in a double blind background (<italic>GMR</italic>-<italic>hid</italic>/+;<italic>dTrpA1</italic><sup><italic>1</italic></sup>) (<xref ref-type="bibr" rid="bib57">Kwon et al., 2008</xref>; <xref ref-type="bibr" rid="bib102">Xiang et al., 2010</xref>). For the control experiments shown Figure 18, the double blind background was achieved with the null alleles <italic>glass</italic><sup><italic>60j</italic></sup> and <italic>dTrpA1</italic><sup><italic>1</italic></sup> (<xref ref-type="bibr" rid="bib74">Moses et al., 1989</xref>; <xref ref-type="bibr" rid="bib13">Busto et al., 1999</xref>). The UAS-ChR2-H134R transgene was donated by Stefan Pulver and Leslie C Griffith (<xref ref-type="bibr" rid="bib83">Pulver et al., 2009</xref>). Flies were raised on standard fly food containing 0.5 mM all-<italic>trans</italic>-retinal in an incubator in complete darkness (food vials wrapped in aluminum foil). Exposure to ambient light was minimized until the experimental test. Approximately 96 hr after egg laying, third instar larvae were taken out of the food and immersed in a 15% (wt/V) glucose solution.</p></sec><sec id="s4-2"><title>Experimental arena with controlled odor gradient</title><p>A controlled odorant environment was created in a 120 × 120 × 12 mm arena consisting of a polystyrene dish (the lid of a Greiner square dish ref. number: 688102, Sigma–Aldrich, St. Louis, MO) standing on a 2% wt/V agarose surface inside the closed-loop tracker. A 3-μl odor droplet of IAA (0.25 M) was placed inside a plastic reinforcement ring at the center of the dish (internal diameter of disk occupied by the odor droplet: 5 mm). Inside the arena, an odor gradient emerged as a result of the diffusion from the source for 30 s prior to the introduction of a single larva. This step required a brief opening of the arena. The tracking was carried out for a minimum duration of 3 min. A minority of trajectories associated with no chemotactic response or with larvae idly dwelling under the odor source was excluded from the dataset.</p></sec><sec id="s4-3"><title>Behavioral quantification</title><sec id="s4-3-1"><title>Run/non-run classifiers</title><p>To detect turning events, we adopted a geometrical approach based on the physical trajectory described by the larva. First, we parsed the trajectory into segments of equal sizes. Next, we calculated the angle between successive segments of the trajectory. Finally, we computed the distribution over these angles. This distribution had the characteristics of a long-tailed exponential (data not shown). We defined a threshold at the location of the ‘kink’ of the distribution. Turning events were associated with positions with a turning angle larger than the threshold. We empirically found that good results were obtained for trajectory segments of 5 mm and an angular threshold of 20°. The results of the behavioral classification were insensitive to the precise length of the trajectory segments and the angular threshold.</p><p>Throughout the present study, the identification of turns was based on the trajectory of the midpoint (point located on the skeleton at a third of the distance from the head). Due to the high sampling rate of the tracker and the inherent noise of the stepper motors moving the stage holding the camera, the positions of the points of interest were subject to minute jittering. Unless stated otherwise, the trajectories of every point of interest were smoothened with a Savitzky-Golay filter to remove fluctuations on a small spatial scale irrelevant to the motion of the larva. This geometric approach was used to classify the data obtained from the closed-loop experiments (<xref ref-type="fig" rid="fig1 fig6 fig7 fig8">Figures 1, 6–8</xref>). For the open-loop experiments described in <xref ref-type="fig" rid="fig5">Figure 5</xref>, turns were identified by the online classification carried out by the tracker software (see section Tracker, Figure 16).</p></sec></sec><sec id="s4-4"><title>Physical model for odor diffusion</title><p>For the experimental conditions used in previous work (<xref ref-type="bibr" rid="bib65">Louis et al., 2008</xref>; <xref ref-type="bibr" rid="bib4">Asahina et al., 2009</xref>; <xref ref-type="bibr" rid="bib37">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib36">Gomez-Marin and Louis, 2014</xref>), we obtained evidence that the odor gradients could be approximated as static. Due to the use of an odor source with reduced volume, this approximation did not hold in the present study. To correlate the behavior of the larva with a more accurate reconstruction of the odor gradient, we developed a physical model for the diffusion of the odor inside the behavioral arena (<xref ref-type="fig" rid="fig9">Figure 9</xref>). We used model-based estimation techniques for parameters underlying this physical model. We considered 3D diffusion with separate diffusion constants for air and the droplet. Exposed plastic surfaces of the chamber were treated as adsorptive boundaries. Since the odor gradient was initially established in the arena for 30 s prior to the introduction of a larva, our model also included non-zero initial concentration of the odor in the air, agarose, and plastic chamber. COMSOL Multiphysics v4.3 (COMSOL, Burlington, MA) was used to solve the diffusion equation with these boundary conditions. Parameter estimation was performed using the MATLAB/Optimization toolbox (MathWorks, Natick, MA) by solving a nonlinear least squares problem that matched the simulated odor concentration to measurements at the same time points.<fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.030</object-id><label>Figure 9.</label><caption><title>Physical model of odor diffusion in behavioral arena.</title><p>(<bold>A</bold>) Configuration of behavioral arena on which the PDE model is based. The arena consists of a square shaped transparent plastic box with a side length of 120 mm and a height of 12 mm. The lid is inverted on a surface of agarose. The odor source consists of a solution of isoamyl acetate mixed with paraffin oil. A droplet of 3 μl of odor is placed inside a transparent reinforcement ring of a radius <italic>r</italic><sub>ring</sub>. This volume fills the ring evenly and, upon inversion of the lid on an agarose slab, the droplet remains suspended due to surface tension. The droplet shape is modeled as a spherical cap. The flat face of the droplet is in contact with the top plastic lid. The volume <italic>v</italic><sub>drop</sub> of the droplet is related to the radius of the flat face <italic>r</italic><sub>ring</sub> and the droplet height <italic>h</italic><sub>drop</sub> according to the formula of a sphere. The agarose layer at the bottom of the chamber is modeled as a two-dimensional sheet with an independent diffusion constant. The top flat face of the droplet that contacts the plastic cap is treated as a no-flux boundary, and flux continuity is imposed on the spherical interface with air. The remaining boundaries, air-agarose and air-plastic, are modeled as Robin boundary conditions to accommodate the possibility of adsorption-desorption at these boundaries. The establishment of the odor gradient in the arena is modeled by two simultaneous diffusion processes, both of which are described by partial differential equation (PDE): ∂<italic>x</italic>(<italic>r</italic>⃑, <italic>t</italic>)/∂<italic>t</italic> = <italic>D</italic> ∇<sup>2</sup><italic>x</italic>(<italic>r</italic>⃑, <italic>t</italic>) where <italic>x</italic>(<italic>r</italic>⃑, <italic>t</italic>) denotes the odor concentration at position <italic>r</italic>⃑ and time <italic>t</italic>. The diffusion constant D depends on whether the medium is air or the odor droplet. We used a flux continuity condition at the droplet-air boundary. For additional details about the model, see ‘Materials and methods’. (<bold>B</bold>) As described in <xref ref-type="bibr" rid="bib65">Louis et al. (2008)</xref>, infrared spectroscopy was used to estimate the absorbance and thereby the average concentration along sections of the arena (IR beam depicted in panel <bold>A</bold>). The time course of the cumulated concentration was determined for 7 sections at a distance from the source ranging from 0 to 45 mm (only first 6 are shown in the graph). Each concentration profile results from an average over 2 to 4 independent measurements. The absorbance was measured for a source concentration of 1.0 M. As discussed in ‘Materials and methods’, the parameters of the model are estimated by optimizing the fit of the model with the average concentration profiles along the 7 sections of the arena. The parameters of the model are reported in <xref ref-type="table" rid="tbl5">Table 5</xref>. The PDE model leads to a good fit of the temporal profiles of the average concentrations after an initial transient phase of 30 s. (<bold>C</bold>) Assessment of variability in the concentration estimates at a fixed position of the center of the 1.0 M odor source (7.5 mm). Mean concentration obtained from four independent infrared measurements. Error bars denote standard deviation. The time course of the simulated concentration is shown as a dashed line. (<bold>D</bold>) Assessment of variability in the concentration estimates at a fixed position of the center of the 1.0 M odor source (15 mm). Mean concentration obtained from three independent infrared measurements. Error bars denote standard deviation. The time course of the simulated concentration is shown as a dashed line.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.030">http://dx.doi.org/10.7554/eLife.06694.030</ext-link></p></caption><graphic xlink:href="elife-06694-fig9-v1"/></fig></p><p>The geometry of the experimental arena is described in <xref ref-type="fig" rid="fig9">Figure 9</xref>. The radius <italic>r</italic><sub>ring</sub> of the odor ring confines the liquid droplet so that the radius of the flat face is equal to <italic>r</italic><sub>ring</sub>. The volume <italic>V</italic><sub><italic>drop</italic></sub> of the droplet, made up of odor and solvent, is fixed to be 3 μl. According to the formula of a sphere, <inline-formula><mml:math id="inf1"><mml:mrow><mml:mo> </mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">drop</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>6</mml:mn></mml:mfrac><mml:mo> </mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="normal">drop</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="normal">drop</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">ring</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <italic>h</italic><sub>drop</sub> is the droplet height. The agarose layer at the bottom of the chamber was modeled as a two-dimensional sheet with an independent diffusion constant.</p><sec id="s4-4-1"><title>Boundary conditions</title><p>The top flat face of the droplet that contacts the plastic cap was treated as a no-flux boundary. Flux continuity was imposed on the spherical interface with air. The remaining boundaries, air-agarose, and air-plastic, were modeled as Robin boundary conditions to accommodate the possibility of adsorption-desorption reactions at the boundary. Although the standard way of treating adsorption reactions would be to use a reactive boundary condition where the odorant is treated as free in the air or bound to the boundary, we modeled these boundaries as a Robin boundary condition, which reduces the number of parameters to be considered (<xref ref-type="bibr" rid="bib88">Singer et al., 2008</xref>). This simplification of the boundary conditions was necessary for us to estimate the associated parameters with a single experiment.</p><p>Considering a diffusing chemical species with concentration <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that varies with time <italic>t</italic> and location <inline-formula><mml:math id="inf3"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> within the chamber, the flux vector <inline-formula><mml:math id="inf4"><mml:mrow><mml:mover accent="true"><mml:mi>J</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of this chemical is given by <inline-formula><mml:math id="inf5"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>J</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic>D</italic> is the diffusion constant in air. If the normal direction to the boundary under consideration denoted as <inline-formula><mml:math id="inf6"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, the Robin boundary condition relates to the normally incident flux to the boundary reaction by <inline-formula><mml:math id="inf7"><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi><mml:mo>.</mml:mo></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>J</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <italic>k</italic><sub><italic>i</italic></sub> is related to the reaction rate at the boundary <italic>i</italic> (agar or plastic), and <italic>x</italic><sub><italic>0,i</italic></sub> is the saturation concentration of the odorant on this boundary. This reaction drives the flux toward the saturation concentration of the boundary. For example, if the concentration of the odorant in air is lower than the saturation concentration, the boundary would become an odor source by undergoing desorption, with a rate governed by <italic>k</italic><sub><italic>i</italic></sub>. Conversely, a higher concentration of the odorant in air would lead to adsorption at the boundary.</p></sec><sec id="s4-4-2"><title>Diffusion equation and coupling of the evaporation-diffusion process</title><p>There were two simultaneous diffusion processes, both of which were modeled using a PDE:<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The diffusion constant <italic>D</italic><sub><italic>i</italic></sub> depended on whether the medium <italic>i</italic> is air or droplet. We used a flux continuity condition at the droplet-air boundary, that is, the odorant could not accumulate at this boundary. As a result of the flux continuity at the droplet-air boundary, and because diffusion through air was substantially faster than through the droplet, the odor developed a radial profile within the droplet despite starting with a homogenous initial concentration. This process is our approximation of the coupled evaporation-diffusion process. Modeling the diffusion limited evaporation process (<xref ref-type="bibr" rid="bib50">Kelly-Zion et al., 2011</xref>) would render this problem intractable in the context of our model-based parameter estimation. We, therefore, used an approximation for the evaporation process. Although inaccuracies could arise from this approximation because we ignored natural convection and concentration-dependent changes in volatility of the odorant arising from chemical interactions with the solvent, our model was able to match experimental measurements with good fidelity as seen from the results of our model-based estimation (<xref ref-type="fig" rid="fig9">Figure 9B–D</xref>).</p></sec><sec id="s4-4-3"><title>Calibration of FT-IR measurements</title><p>Following the protocol described in (<xref ref-type="bibr" rid="bib65">Louis et al., 2008</xref>), we used a gas-flow cell and Fourier Transform-Infrared Spectroscopy (FT-IR) (Bruker, USA) to assess the molar extinction coefficient of the odor in gaseous phase. The odor (isoamyl acetate, IAA) was mixed with the solvent n-hexane in different proportions. The solution was then injected directly into the gas flow cell by using a 10 μl Hamilton syringe (Hamilton Company, Reno, NV). The quantities of odor tested were 0, 0.01, 0.1, 0.2, 0.25, 0.5, and 1 μl. In all cases, the absorbance was measured by calculating the height of the absorption peak at the wave number 1765 cm<sup>−1</sup>—a wavelength specific to IAA. Between trials, the gas flow cell was disassembled and all parts were rinsed with n-hexane. The absorption coefficient was estimated to be 479.87 M<sup>−1</sup>cm<sup>−1</sup> at 25°C. The concentration of saturated odor was estimated by injecting 10 μl of pure IAA into the gas-flow cell. The absorbance saturated at a value close to 1.36. Using the absorption coefficient, the concentration of the saturated vapor was estimated to be 278.45 μM.</p></sec><sec id="s4-4-4"><title>Model-based estimation of PDE parameters</title><p>Absorbance of infrared light was measured through the air along sections of the behavioral arena. As described in (<xref ref-type="bibr" rid="bib65">Louis et al., 2008</xref>), the average odor concentration along the light path was estimated using the Beer–Lambert law. Based on this, we defined the parameters of the PDE model by characterizing the geometry of the gradient produced by a single odor source of 3 μl of IAA at a concentration of 1.0 M. A higher source concentration was used for the infrared spectroscopic measurements than for the behavioral experiments (0.25 M) to ensure the accuracy of the concentration estimates. We measured the absorbance along sections located at distances 0 mm, 7.5 mm, 15 mm, 22.5 mm, 30 mm, 37.5 mm, and 45 mm from the center of the droplet (<xref ref-type="fig" rid="fig9">Figure 9B–D</xref>). The measurements were taken after the odorant was placed in the chamber following the exact same protocol as for the behavioral experiments. From these, we inferred the average concentration at these 7 sections over a time interval of 360 s. For a given set of parameters based on an initial guess about the order of magnitude, we simulated the diffusion process. To this end, we used trapezoidal integration to estimate the average of the concentration along the sections that corresponded to the experimental measurements. The objective function to be minimized for estimating the parameters was the root-mean-squared error of the average concentration at each of the seven locations and at all times.</p><p>To minimize the objective function, we used sequential quadratic programming as implemented by the function <italic>fmincon</italic> in MATLAB v8.2. The Jacobian of the cost function with respect to the parameters being estimated was computed using finite differences. We constrained all physical parameters to be greater than 0. None of these inequality constraints were active for the converged solution. We tried 20 random initial guesses, and one where all parameters were set to 0. Once the optimization converged, we perturbed the converged estimates using random numbers. The perturbed estimates were fed back to the estimator, and the optimization ran again until convergence. We carried out 20 such restarts, and all of them converged to the same estimates, which are reported in <xref ref-type="table" rid="tbl5">Table 5</xref>. As described in <xref ref-type="fig" rid="fig10">Figure 10</xref>, the reconstruction of the odor gradient experienced by freely moving larvae (3-μl source of IAA at a concentration of 0.25 M) was then achieved by scaling down the gradient obtained at a source concentration of 1.0 M. We noted that the temporal evolution of the odor gradient is non-negligible (<xref ref-type="fig" rid="fig10">Figure 10B,C</xref>), which justified its integration in the entire analysis.<table-wrap id="tbl5" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.031</object-id><label>Table 5.</label><caption><p>Parameters of PDE model for odor diffusion</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.031">http://dx.doi.org/10.7554/eLife.06694.031</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Physical description</th><th>Converged value</th></tr></thead><tbody><tr><td style="background:#8C8C8C"><italic>D</italic><sub>air</sub></td><td style="background:#8C8C8C">Diffusion constant in air</td><td style="background:#8C8C8C">8.9377 × 10<sup>−7</sup> m<sup>2</sup>s<sup>−1</sup></td></tr><tr><td><italic>D</italic><sub>drop</sub></td><td>Diffusion constant in droplet</td><td>8.7859 × 10<sup>−11</sup> m<sup>2</sup>s<sup>−1</sup></td></tr><tr><td style="background:#8C8C8C"><italic>c</italic><sub>0,air</sub></td><td style="background:#8C8C8C">Initial odorant concentration in air</td><td style="background:#8C8C8C">4.0492 × 10<sup>−7</sup> mol l<sup>−1</sup></td></tr><tr><td><italic>c</italic><sub>0,drop</sub></td><td>Initial odorant concentration in droplet</td><td>0.0450 mol l<sup>−1</sup></td></tr><tr><td style="background:#8C8C8C"><italic>k</italic><sub>agar</sub></td><td style="background:#8C8C8C">Robin rate for air-agar boundary</td><td style="background:#8C8C8C">1.5762 × 10<sup>−6</sup> ms<sup>−1</sup></td></tr><tr><td><italic>k</italic><sub>plastic</sub></td><td>Robin rate for air-plastic boundary</td><td>5.8025 × 10<sup>−5</sup> ms<sup>−1</sup></td></tr><tr><td style="background:#8C8C8C"><italic>c</italic><sub>0,agar</sub></td><td style="background:#8C8C8C">Saturation concentration of agar</td><td style="background:#8C8C8C">3.6817 × 10<sup>−5</sup> mol l<sup>−1</sup></td></tr><tr><td><italic>c</italic><sub>0,plastic</sub></td><td>Saturation concentration of plastic</td><td>5.7921 × 10<sup>−7</sup> mol l<sup>−1</sup></td></tr></tbody></table><table-wrap-foot><fn><p>The parameters are optimized for an odor gradient of isoamyl acetate under the experimental condition outlined in <xref ref-type="fig" rid="fig9">Figure 9</xref>.</p></fn></table-wrap-foot></table-wrap><fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.032</object-id><label>Figure 10.</label><caption><title>Dynamical reconstruction of the odor gradient experienced by the larva during free behavior.</title><p>(<bold>A</bold>) Behavioral experiments were conducted with a 3-μl odor droplet at a concentration of 0.25 M. At this low concentration and due to the small volume of the source, accurate temporal profiles of the average odor concentration could not be obtained through infrared spectroscopy for all sections of the plate. Under the source, we find that the average concentration of the odor scales as a function of the source concentration. We therefore assume that the gradient obtained for a 0.25 M source can be approximated by the gradient reconstructed at 1.0 M scaled by a factor 0.25. (<bold>B</bold>) Numerical integration of the PDE model (parameter set listed in <xref ref-type="table" rid="tbl5">Table 5</xref>) permits us to reconstruct the temporal evolution of the odor gradient experienced by the larva at arbitrary spatiotemporal precision. Due to practical considerations, the reconstruction was saved at time steps of 1 s. As on the time scale of 1 s the geometry of the gradient does not evolve considerably, a linear interpolation is applied between defined sections of the gradient. Over time, the gradient tends to flatten out. This effect is due to the gradual depletion of the source. It is worth noting that in previous studies (<xref ref-type="bibr" rid="bib65">Louis et al., 2008</xref>; <xref ref-type="bibr" rid="bib4">Asahina et al., 2009</xref>; <xref ref-type="bibr" rid="bib37">Gomez-Marin et al., 2011</xref>), the gradients generated by a single odor source could be approximated as roughly constant. In these configurations, the enhanced stability of the gradient was due to the larger volume of the odor source (10 μl) and the reduced dimension of the behavioral arenas. (<bold>C</bold>) Reconstruction of the concentration time course experienced during the trajectory displayed in <xref ref-type="fig" rid="fig1">Figure 1A</xref>. The magenta trace was obtained after mapping the behavior onto the dynamical reconstruction of the gradient shown in panel <bold>B</bold>. In contrast, the blue trace was obtained after mapping the behavior onto a static gradient computed 60 s after the onset of the odor diffusion. The differences between the two temporal profiles highlight the importance of the dynamical reconstruction for the experimental conditions in the present study.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.032">http://dx.doi.org/10.7554/eLife.06694.032</ext-link></p></caption><graphic xlink:href="elife-06694-fig10-v1"/></fig></p></sec></sec><sec id="s4-5"><title>Electrophysiology</title><p>Third instar larvae were transferred from the food vial into 15% (wt/V) glucose solution. Dissection of tissues was carried out in cold extracellular saline solution (<xref ref-type="bibr" rid="bib88a">Singleton and Woodruff, 1994</xref>) where the head was separated from the rest of the body while the brain was left intact. Using tissue glue (Histoacryl B, Braun, Germany), the dissected head was then glued in the middle of a glass slide at the bottom of a flow chamber. The cuticle covering the mouth hook was removed using a 3 mm Vanna spring scissor (Fine Science Tools, Germany) to make the dorsal organ ganglion accessible to the recording electrode. Throughout the experiment, the head was immersed in extracellular saline. The flow chamber was connected to two syringe pumps (Aladdin2-220, World Precision Instruments, Sarasota, FL) to perfuse the preparation with fresh saline and to ensure the continuous evacuation of the odor out of the chamber. The chamber volume was approximately 500 μl. The flow in the chamber was 28.4 μl/s, leading to a turnover of the chamber volume in 17.6 s.</p><p>Recording electrodes were pulled (P97, Sutter Instruments) out of borosilicate glass capillaries (1.5 mm/1.12 mm outer/inner diameters (OD/ID), World Precision Instruments, Novato, CA) with a 10 μm open tip. Electrodes were then back-filled with 3 μl of extracellular saline. A chlorinated silver wire (0.38 mm in diameter) was used to connect the electrode to the head stage of a microelectrode amplifier (Axon MultiClamp 700B, Molecular Devices, Sunnyvale, CA). The electrode was mounted on an automated micromanipulator (ROE-200 &amp; MPC-200, Sutter Instruments). The antennal nerve in close vicinity of the dorsal ganglion was sucked into the recording pipette by applying a negative pressure (−20 kpa) created through vacuum. The extracellular signal was amplified 100 times at the microelectrode amplifier; it was visualized on an oscilloscope (Tektronix, Beaverton, OR), and recorded at a sample rate of 20 kHz by a personal computer (PC) equipped with the free data acquisition software SpikeHound (<xref ref-type="bibr" rid="bib64">Lott et al., 2009</xref>). The conception of this preparation and recording technique benefited from pioneering recordings from the larval olfactory organ (<xref ref-type="bibr" rid="bib81">Oppliger et al., 2000</xref>; <xref ref-type="bibr" rid="bib55">Kreher et al., 2005</xref>; <xref ref-type="bibr" rid="bib42">Hoare et al., 2008</xref>).</p><sec id="s4-5-1"><title>Light stimulation at electrophysiology rig</title><p>For the light stimulation, a blue light emitting diode (LED) (LCS-0470-03-22 LED, Mightex, Canada) was mounted in a lighthouse (U-DULHA, Olympus, Japan) and integrated into the light path of the microscope (BX51, Olympus) allowing for localized stimulation of the larval head through a 40× immersion objective. The light intensity arriving at the larval head was estimated by measuring the photocurrent under the objective with a photodiode (SM05PD7A, Thorlabs, Newton, NJ) connected to a bench top photodiode amplifier (PDA200C, Thorlabs). The LED was controlled by a custom Labview (National Instruments, Austin, TX) interface available from the following link: <ext-link ext-link-type="uri" xlink:href="https://github.com/LabLouis/eLife_2015/tree/master/Electrophysiology">https://github.com/LabLouis/eLife_2015/tree/master/Electrophysiology</ext-link>. The current controlling the LED was fed into the data acquisition software, where it was recorded along with the signal from the suction electrode. Pulses of blue light elicited spikes exclusively in OSNs expressing ChR2 (<xref ref-type="fig" rid="fig2">Figure 2B,C</xref> and <xref ref-type="fig" rid="fig11">Figure 11A</xref>).<fig id="fig11" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.033</object-id><label>Figure 11.</label><caption><title>Semi-automated channelrhodopsin assisted spike sorting (OpSIN).</title><p>(<bold>A</bold>) Cross-correlation of light- and odor-evoked spikes (blue) recorded from the <italic>Or42a</italic>&gt;ChR2 OSN, and cross-correlation of light-evoked and spontaneous background spikes (gray). The similarity in the shape of the waveform is larger between the light- and odor-evoked spikes compared to light-evoked and background spikes. Light-evoked spikes were collected from time windows during a light stimulation interval; odor-evoked spikes were collected during the odor stimulation interval; background spikes were collected from intervals devoid of light and odor stimulations. Although light- and odor-evoked spike waveforms are very similar to each other during the same recording, the overall shape of the spike waveforms can vary across recordings. (<bold>B</bold>) Flow chart of the functions underlying the spike-sorting algorithm (OpSIN). Spike candidates were selected during light-activation episodes based on simple amplitude thresholding and local non-maximum suppression. Spike selection was accomplished by comparing candidate waveforms identified throughout the recording to the ChR2-derived waveform template by transforming candidate waveforms to appear as similar as possible to the template via dynamic time warping. Orange boxes denote steps where inputs are sought from the user. For more details, see ‘Materials and methods’. (<bold>C</bold>) Average spike yield of the <italic>Or42a</italic>&gt;ChR2 OSN measured in a 58-ms time window with and without light stimulation. The data were obtained by analyzing 35 recordings. The spike yield during the light stimulation is 2.30 ± 0.40 spikes. The corresponding spike latency is 6.96 ± 1.02 ms (t-test, p &lt; 0.001).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.033">http://dx.doi.org/10.7554/eLife.06694.033</ext-link></p></caption><graphic xlink:href="elife-06694-fig11-v1"/></fig></p></sec><sec id="s4-5-2"><title>Spike-sorting algorithm</title><p>Spike-sorting and PSTH analysis was performed with Matlab using custom scripts available from the following link: <ext-link ext-link-type="uri" xlink:href="https://github.com/pahammad/OpSIN">https://github.com/pahammad/OpSIN</ext-link>. In the <italic>Orco</italic> null background, spontaneous activity of OSNs is drastically reduced but not abolished (<xref ref-type="bibr" rid="bib42">Hoare et al., 2008</xref>). Furthermore, non-OSNs contribute to the activity monitored from the DO ganglion. We devised an optogenetic spike-sorting strategy to distinguish spikes of the <italic>Or42a</italic> OSN from other spikes (<xref ref-type="fig" rid="fig11">Figure 11B,C</xref>) (<xref ref-type="bibr" rid="bib61">Lima et al., 2009</xref>). Channelrhodopsin-2 (ChR2-H134R) was expressed in the single functional <italic>Or42a</italic> OSN (<italic>Or42a</italic>&gt;ChR2). The spike-sorting algorithm (called OpSIN) parsed the extracellular recording data and collected candidate ChR2-evoked spikes specifically during light-activation time windows based on amplitude thresholding and local non-maximum suppression. Template candidates were separated into clusters using an affinity propagation algorithm (<xref ref-type="bibr" rid="bib28">Frey and Dueck, 2007</xref>). Spike selection was accomplished by comparing candidate waveforms identified throughout the recording to ChR2 derived waveform templates. Candidate waveforms were then transformed to appear as similar as possible to the template waveform via dynamic time warping (<xref ref-type="bibr" rid="bib9">Berndt and Clifford, 1994</xref>). The probability of spike occurrence at every candidate location was estimated by warping the residual distance between the candidate waveform <italic>X</italic> and the chosen set of spike templates <italic>T</italic>.<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mi>T</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>→</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>A spike-probability-histogram-based cut-off was applied across the entire recording to select the correct spikes and assign identities.<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>K</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>K</italic> is the median of all the pair wise distances computed across the set of spike-candidates.<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the spike candidate's probability is based on its best matched template. Every PSTH was mildly low-pass filtered using a Savitzky-Golay filter.</p></sec><sec id="s4-5-3"><title>Liquid phase odor stimulation</title><p>For the odor stimulation two-barrel pipettes (1.5 mm/0.84 mm OD/ID, World Precision Instruments) were pulled using a PMP-107 Multipipette Puller (MicroData Instrument, South Plainfield, NJ) resulting in a two-barrel tip with a 5 µm OD. One barrel was back-filled with the odor solution (IAA dissolved in extracellular saline), and the other with extracellular saline alone. An injection needle (0.51 mm/0.26 mm OD/ID, Becton, Dickinson and Company, Franklin Lakes, NJ) was inserted into the back of each barrel and airtight sealed using hot-melt adhesive. Each barrel was subsequently connected to separate channels of a pressure-driven flow controller (Fluigent, France). The tip of the odor stimulation pipette was placed and maintained at a distance of 10 μm in front of the larval dorsal organ with a micromanipulator (ROE-200 &amp; MPC-200, Sutter Instruments). The output pressure and thereby the flow of each individual channel of the odor delivery pipette was controlled at a temporal resolution of 10 Hz via a custom Labview interface available from the following link: <ext-link ext-link-type="uri" xlink:href="https://github.com/LabLouis/eLife_2015/tree/master/Electrophysiology">https://github.com/LabLouis/eLife_2015/tree/master/Electrophysiology</ext-link>. Rapid concentration changes of the odorous stream were achieved by varying the flow between the empty channel and the odor channel while keeping the overall flow constant at a set value of 0.32 nl/s (measured flow rate corresponding to a 320 mbar output pressure). The experimental setup is outlined in <xref ref-type="fig" rid="fig12">Figure 12A</xref>.<fig id="fig12" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.034</object-id><label>Figure 12.</label><caption><title>Phase conversion of air and liquid phase odor stimulation.</title><p>(<bold>A</bold>) Schematic illustration of the single-OSN imaging setup: liquid phase odor stimulation of the larval dorsal organ with a pressure controller connected to a two-barrel pipette. The odor solution is placed in one channel of a two-barrel pipette while the other channel contains pure saline. The fixed larval head is perfused by a constant flow of extracellular saline while the odorous solution is delivered via the glass pipette. As for the olfactometer in gaseous phase (panel <bold>B</bold>), rapid changes in concentration of the odorous stream are achieved by varying the flow of the empty channel and the odorous channel while keeping the overall flow constant. As described in ‘Materials and methods’, the flow rates of individual channels are controlled by a system of mass flow controllers. (<bold>B</bold>) Air-phase odor stimulation of the larval dorsal organ with a custom-built olfactometer. A continuous stream of air (510 ml/min) is regulated by combining the outputs of two mass flow controllers. The air stream is humidified, and subsequently passed through the odor solution after which the odorous air stream is delivered to the larval dorsal organ. Rapid concentration changes of the odorous stream are achieved by varying the flow between the empty channel and the odor channel while keeping the overall flow constant. As described in the ‘Materials and methods’, individual flow rates are controlled in real-time. The OSN activity was recorded by imaging the GCaMP activity elicited in the axon terminal of the <italic>Or42a</italic> OSN. (<bold>C</bold>) Schematic illustration of the site of imaging of single OSN glomeruli at the level of the antennal lobe (inset: false-color-coded activity in the axon terminal of the <italic>Or42a</italic> OSN). (<bold>D</bold>) Odor response profile (ΔF/F) of the <italic>Or42a</italic> OSN in response to an exponential odor stimulation in the air-phase (left) and liquid-phase (right). The response amplitude and overall dynamics are conserved between the liquid and gaseous phases. Shades denote standard deviation. Recordings were made on a total of six experiments conducted on three different preparations. (<bold>E</bold>) Calibration of fluorescein in liquid phase showing a linear relationship of the fluorescein concentration and the measured change in fluorescence (left panel). Linear relationship between the observed change in fluorescence and the output pressure of the odorous stream (right panel). (<bold>F</bold>) Calibration of the photoionization detector (PID) with airborne odorant stimuli showing a linear relationship between the odor concentration and the measured voltage change. Error bars denote standard deviation.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.034">http://dx.doi.org/10.7554/eLife.06694.034</ext-link></p></caption><graphic xlink:href="elife-06694-fig12-v1"/></fig></p><p>The liquid phase odor stimulation system was calibrated using a dilution series of the fluorescent dye fluorescein, which was expelled at a constant pressure (320 mbar) into the perfusion chamber (Bioscience Tools, San Diego, CA) while imaging the tip of the pipette with a high-speed camera (Andor, United Kingdom). We determined that the relationship between the fluorescein concentration and the measured fluorescence was best fitted by a linear function (<xref ref-type="fig" rid="fig12">Figure 12E</xref>, left panel). When varying the output pressure while keeping the concentration of fluorescein constant, the observed fluorescence could be mapped to the output pressure using a linear function (<xref ref-type="fig" rid="fig12">Figure 12E</xref>, right panel). The concentration arriving at the dorsal organ was quantified by comparing the fluorescence measured at the tip of the odor delivery pipette (region of interest <italic>ROI</italic><sub><italic>tip</italic></sub>) to the fluorescence measured right at the dorsal organ (<italic>ROI</italic><sub><italic>dorsal</italic></sub>). Assuming that the fluorescence measured at the tip of the odor delivery pipette represents the undiluted concentration, the dilution factor (<italic>d</italic>) was calculated according to:<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The time lag between the pressure output and the odor arriving at the dorsal organ was quantified by computing the cross correlation between the recorded output pressure of the mass-flow controller system (MFCS) and the measured fluorescence at the larval dorsal organ. By calculating the shift of the peak of the cross correlation with respect to the peak of the autocorrelation of the pressure output signal, the final lag for each experiment was determined. The lag was estimated to be 500 ms.</p></sec><sec id="s4-5-4"><title>Phase conversion for olfactory stimulation</title><p>Gas-phase odor stimulation was achieved by means of a custom olfactometer delivering a continuous stream of air (510 ml/min). The air stream, regulated by two mass flow controllers (Cole–Parmer, Vernon Hills, IL), was humidified and subsequently passed through the odor solution and delivered to the tip of the larval head. Rapid concentration changes of the odorized stream were achieved by varying the flow between the empty channel and the odor channel while keeping the overall airflow constant. A custom Labview protocol was used to control the flow rate of the individual mass flow controllers at a rate of 30 Hz. This script is available from the following link: <ext-link ext-link-type="uri" xlink:href="https://github.com/LabLouis/eLife_2015/tree/master/Electrophysiology">https://github.com/LabLouis/eLife_2015/tree/master/Electrophysiology</ext-link>. The experimental setup is outlined in <xref ref-type="fig" rid="fig12">Figure 12B</xref>: it is similar in design to past olfactometers (<xref ref-type="bibr" rid="bib11">Borst and Heisenberg, 1982</xref>; <xref ref-type="bibr" rid="bib51">Kim et al., 2011</xref>) and it was adapted to produce a stimulus time course on the timescale of a typical run.</p><p>Odor concentrations were estimated in gaseous phase by using a mini photoionization detector (200B miniPID, Aurora Scientific, Canada). Calibration of the miniPID (photoionization detector) was achieved by passing an air stream through pure IAA to obtain saturated vapor. Since the PID signal saturated at high concentrations of airborne odor, it was necessary to establish the calibration curve in an odor range that was significantly lower than saturated vapor. The saturated airflow was therefore diluted into clear air in ratios of 1:10.0, 1:19.2, 1:38.5, and 1:83.0. Gaseous concentrations and PID voltage readings followed a linear relationship (<xref ref-type="fig" rid="fig12">Figure 12F</xref>), which allowed us to convert the PID readout into absolute concentration.</p><p>As illustrated in <xref ref-type="fig" rid="fig12">Figure 12C</xref>, the OSN activity was monitored by means of calcium imaging at the axon terminal of the OSNs at the larval antennal lobe (<italic>Or42a</italic>&gt;GCaMP3) using a high-speed camera (Andor, United Kingdom) and a fluorescence microscope (BX51 mounted with 40× water immersion objective, Olympus). The OSN activity was measured during odor stimulation in gaseous and liquid phase, respectively. The phase correlation between liquid and gaseous stimulations was established for an 8-s exponential ramp. In liquid phase, both background and maximum concentration were fixed to the pre-existing experimental conditions used for the electrophysiology: they corresponded to a range spanning between 50 μM and 530 μM. The corresponding ΔF/F of the OSN response ranged between 10% and 60% in liquid phase. The background and maximum concentration of the airborne ramp were adjusted to obtain an activity profile with a ΔF/F matching the liquid phase stimulations.</p><p>Using the miniPID, the estimate of the final air-phase exponential odor time course ranged from 2.20 to 20.13 μM and led to an OSN response ranging between 10% and 59%. From the original ΔF/F, it was found that the ratio of the max ΔF/F in gaseous and liquid phases was 0.98. The ratio of the integral of ΔF/F over the full time course of the stimulation was 0.87. We established the equivalence of the OSN calcium responses elicited by an exponential ramp with a concentration range of 50–530 μM in liquid phase and with a concentration range of 2.20–20.13 μM in gaseous phase, with comparable OSN response dynamics for both phases (<xref ref-type="fig" rid="fig12">Figure 12D</xref>). To map the concentration range of 2.20–20.13 μM in gaseous phase onto the concentration range of 50–530 μM in liquid phase, we used the ratio between the maximum concentrations of the ramp in liquid and gaseous phases: ρ<sup>liquid → gas</sup> = 26.73. This conversion was applied to predict the behavior of larvae in an airborne odor gradient on the basis of the model for the OSN activity developed for liquid phase stimulation (<xref ref-type="fig" rid="fig4">Figure 4</xref>).<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>liquid</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">gas</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msup><mml:mtext>ρ</mml:mtext><mml:mrow><mml:mtext>liquid</mml:mtext><mml:mo>→</mml:mo><mml:mi mathvariant="normal">gas</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>y</italic> denotes the activity of the OSN, <italic>x</italic><sub><italic>gas</italic></sub> the concentration in gaseous phase, and <italic>F</italic><sub><italic>liquid</italic></sub> the predicted neural activity from the IFF+IFB (ODE) model introduced in <xref ref-type="fig" rid="fig4">Figure 4B</xref>.</p></sec></sec><sec id="s4-6"><title>Reverse-correlation analysis of OSN response dynamics</title><p>Standard systems identification approaches have shown that the important aspects of the response of invertebrate photoreceptors can be approximated as linear (<xref ref-type="bibr" rid="bib68">Marmarelis and McCann, 1977</xref>), even though the modeling of nonlinear features of the response requires a more sophisticated treatment (<xref ref-type="bibr" rid="bib27">French et al., 1993</xref>). More recently, it has been suggested that the response dynamics of OSNs in <italic>C. elegans</italic> and primary thermosensory neurons in the <italic>Drosophila</italic> larva are largely linear (<xref ref-type="bibr" rid="bib47">Kato et al., 2012</xref>; <xref ref-type="bibr" rid="bib53">Klein et al., 2015</xref>). We therefore examined whether a linear-nonlinear model could be used to describe the OSN response of the larva. Following a reverse-correlation approach, we stimulated the <italic>Or42a</italic>&gt;ChR2 OSN by a M-sequence induced with light (<xref ref-type="fig" rid="fig13">Figure 13A</xref>). Reproducible patterns of neural activity were observed (<xref ref-type="fig" rid="fig13">Figure 13C</xref>), from which a biphasic filter was computed (<xref ref-type="fig" rid="fig13">Figure 13B</xref>). This filter had a shape similar to those found in retinal ganglion cells (<xref ref-type="bibr" rid="bib17">Chichilnisky, 2001</xref>) and insect OSNs (<xref ref-type="bibr" rid="bib31">Geffen et al., 2009</xref>; <xref ref-type="bibr" rid="bib69">Martelli et al., 2013</xref>). To test the predictive power of this filter, we reconstructed the activity elicited by an exponential and a sigmoid ramp (<xref ref-type="fig" rid="fig13">Figure 13D,E</xref>). Whereas the linear filter led to a reasonable reconstruction of the firing pattern elicited by the M-sequence (<xref ref-type="fig" rid="fig13">Figure 13C</xref>), it produced unsatisfactory results for the graded ramps with a mismatch so pronounced that it could not be rectified by a nonlinear function. This conclusion is consistent with the nonlinear response dynamics observed in adult-fly OSNs upon stimulation by graded odor ramps (<xref ref-type="bibr" rid="bib51">Kim et al., 2011</xref>).<fig id="fig13" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.035</object-id><label>Figure 13.</label><caption><title>A linear filter alone is insufficient to account for the transfer function of the <italic>Or42a</italic>&gt;ChR2 OSN.</title><p>(<bold>A</bold>) Stimulation of the <italic>Or42a</italic>&gt;ChR2 OSN by a maximum-length (M) sequence generated with light. The M-sequence was based on a discretization of the light intensity range 15–207 W/m<sup>2</sup> into the following 5 values: 15, 50, 100, 150, and 207 W/m<sup>2</sup>. The M-sequence featured all possible 4-element combinations of these 5 intensities. In the experiments, changes in light intensity occurred with time steps of 33 ms. (Bottom, left) PSTH of the neural response computed over 10 trials (10 preparations) and for a bin size of 10 ms. The gray boxes outline a 2-s time window over which the predictions of the linear filter are reported in panel <bold>C</bold>. (<bold>B</bold>) Computation of the linear filter, <italic>h</italic>, through the operations described in panel <bold>B</bold> (<xref ref-type="bibr" rid="bib17">Chichilnisky, 2001</xref>; <xref ref-type="bibr" rid="bib76">Nagel and Wilson, 2011</xref>). Function F represents the Fourier transform from the time domain to the frequency domain; F<sup>−1</sup> represents the inverse transformation from the frequency domain to the time domain. The bar above the variables in frequency space denotes the complex conjugate transformation. To cancel any DC drifts in the OSN response, the filter was computed on windows of 5-s slid over the entire duration of stimulus (20 s). An average filter was computed from this series (dark blue line). The linear filter was used to make predictions about particular stimulus time courses. (<bold>C</bold>) Neural activity predicted from the linear filter in response to the M-sequence. The prediction was obtained by convolving the filter with the time course of the stimulus. The resulting activity was normalized to have the same mean as the experimental activity. The result of the prediction is shown for a 2-s window of the complete stimulus (dashed gray box in panel <bold>A</bold>). The activity predicted from the linear filter (dark blue line) is compared to the output of the IFF (ODE) model introduced in <xref ref-type="fig" rid="fig4">Figure 4B</xref> (green line). Pearson's correlation coefficient (<italic>ρ</italic>) of the predicted and the experimental activities is 0.37 for the linear filter reconstruction compared to 0.57 for the IFF model. (<bold>D</bold>) Application of the linear filter derived in panel <bold>C</bold> for the M-sequence to stimulation by an exponential ramp (red line). The linear filter (dark blue line) fails to predict the PSTH that was observed experimentally (black line; gray error bars represent the standard deviation) (<italic>ρ</italic> = 0.56). Prediction of the IFF model shown in green (<italic>ρ</italic> = 0.93). (<bold>E</bold>) Application of the linear filter derived in panel <bold>C</bold> to a sigmoid ramp (red line). As in panel <bold>D</bold>, the linear filter (dark blue line) fails to reproduce the experimental PSTH (<italic>ρ</italic> = 0.54) while the IFF model leads to a good fit (green line, <italic>ρ</italic> = 0.98).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.035">http://dx.doi.org/10.7554/eLife.06694.035</ext-link></p></caption><graphic xlink:href="elife-06694-fig13-v1"/></fig></p></sec><sec id="s4-7"><title>IFF and IFB motifs</title><p>The dynamics of the pure IFF motif (<xref ref-type="fig" rid="fig4">Figure 4Bi</xref>) is described by a 3-variable ODE system (<xref ref-type="fig" rid="fig4">Figure 4Bii</xref>). We hypothesized that the firing rate of the OSN (<italic>y</italic>) results from the combined effects of direct excitation and indirect inhibition of the OSN activity. The excitation is mediated by the gating of the OR by the binding of odorant molecules or the absorption of photons by channelrhodopsin-2 (ChR2). By analogy to the olfactory transduction cascade in the moth (<xref ref-type="bibr" rid="bib39">Gu et al., 2009</xref>), we speculated that the indirect inhibition is mediated by an intermediate variable (<italic>u</italic>) that might represent the concentration of calcium bound to calmodulin. For the pure IFF motif, the dynamics of variable <italic>u</italic> results from a production term proportional to the stimulus <italic>x</italic> and a first-order decay term<italic>.</italic></p><p>To model the direct excitation and indirect inhibition of the OSN activity, we used a control function (d(<italic>x</italic>,<italic>u</italic>) where d stands for depolarization) inspired by the <italic>cis</italic>-regulatory logic of gene transcription (<xref ref-type="bibr" rid="bib34">Goentoro and Kirschner, 2009</xref>):<disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mi>u</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This expression was built from thermodynamic considerations about the state of a promoter occupied by transcription factors (<xref ref-type="bibr" rid="bib1">Ackers et al., 1982</xref>; <xref ref-type="bibr" rid="bib10">Bintu et al., 2005</xref>). Here, we hypothesized that a similar function is suitable to describe the depolarizing effects of the opening of the OR (or ChR2), and the indirect hyperpolarizing effects that calcium bound to calmodulin might have on the OSN membrane. The contribution of each trend is described by <italic>x</italic> and <italic>β</italic><sub><italic>3</italic></sub> <italic>u</italic>, respectively.</p><p>In addition, we assumed that the intermediate variable (<italic>u</italic>) and the OSN spiking activity (<italic>y</italic>) undergo a first-order decay. For the OSN activity, the introduction of such a decay can be justified by speculating about the existence of ion pumps that restore the membrane to resting potential after an initial increase of cations following the gating of the OR (or ChR2) (<xref ref-type="bibr" rid="bib39">Gu et al., 2009</xref>). By trial and error, we also discovered the necessity of including a constitutive decay (offset) term that vanishes at a low firing rate. Although the molecular correlate of this offset remains undefined, it could be explained by the homeostatic function of ion pumps. The combined effects of the two decays are mathematically described as:<disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mi>y</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>h</italic> stands for hyperpolarization. To keep the model as simple as possible, the membrane potential was not modeled explicitly. Instead, we assumed that depolarizing d(<italic>x</italic>,<italic>u</italic>) and hyperpolarizing <italic>h</italic>(<italic>x</italic>) effects on the OSN membrane can be translated into excitatory and inhibitory effects on the OSN firing rate. While our knowledge about the olfactory transduction cascade in <italic>Drosophila</italic> was insufficient to justify these assumptions, the goodness of fit resulting from the integration of the ODE model demonstrated that the OSN dynamics could be captured by the combination of d(<italic>x</italic>,<italic>u</italic>) and <italic>h</italic>(<italic>x</italic>). By combining the previous relationships, we obtained the following systems of ODEs:<disp-formula id="equ12"><mml:math id="m12"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>u</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ13"><label>(2)</label><mml:math id="m13"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mi>u</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mi>y</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The second regulatory motif we considered is a negative IFB. This motif has been implicated in the process of olfactory transduction and adaptation in adult flies (<xref ref-type="bibr" rid="bib76">Nagel and Wilson, 2011</xref>). It also forms the regulatory basis of the transduction pathway underlying adaptive chemoreception in bacterial chemotaxis (<xref ref-type="bibr" rid="bib104">Yi et al., 2000</xref>; <xref ref-type="bibr" rid="bib95">Tu et al., 2008</xref>). For this motif, we assumed that the activity of the neuron had an excitatory effect on the intermediate variable <italic>u</italic>, which in turn has an inhibitory effect on the OSN activity. In a first approximation, the negative feedback was assumed to be linear. The difference between the IFF and IFB motifs lies in the production of the intermediate variable (<italic>u</italic>), which in the case of the IFB is proportional to the firing rate (<italic>y</italic>) and not the stimulus intensity (<italic>x</italic>). These considerations yielded the following system of ODEs:<disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>u</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ15"><label>(3)</label><mml:math id="m15"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mi>u</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mi>y</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using numerical simulations, we found that the IFB motif alone cannot account for the dynamics of the OSN activity. In contrast, we discovered that the combination of the IFF and IFB motifs leads to substantial improvements in the quality of the fit (<xref ref-type="fig" rid="fig4">Figure 4</xref>). For all simulations achieved in this work, the ODE equations were numerically integrated by the solver <italic>ode23s</italic> built in Matlab.</p></sec><sec id="s4-8"><title>Parameter fitting of the composite IFF+IFB and pure IFF models</title><p>To optimize the parameters of the model to the experimental data, a standard fitting procedure was applied. As outlined in <xref ref-type="fig" rid="fig4">Figure 4Bi</xref>, we considered three possible models: the motif IFF, the motif IFB, and a combination of the two motifs. The joint probability of the observations was maximized as a function of the internal parameters for the neural activity patterns elicited by a set of 6 linear ramps, 5 nonlinear ramps, (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) and a naturalistic stimulus (<xref ref-type="fig" rid="fig2">Figure 2D,E</xref>). For each stimulation protocol, the confidence interval of the OSN activity (PSTH) was used to achieve a robust fit of the free parameters of the model. This procedure was applied to each of the three models independently.</p><p>In the ODE systems presented in <xref ref-type="fig" rid="fig4">Figure 4Bii</xref> and <xref ref-type="disp-formula" rid="equ2 equ3">Equations 2, 3</xref>, we observe that the time derivative of <italic>u</italic> can be multiplied by an arbitrary scaling factor reabsorbed by the fitting parameter <italic>β</italic><sub><italic>3</italic></sub> in the time derivative of <italic>y.</italic> For this reason one is forced to fix one of the eight parameters to a constant value. For numerical convenience we chose to fix <italic>α</italic><sub><italic>1</italic></sub> = 0.1. To infer the actual value of this parameter, one would need to experimentally access the value of the intermediate variable <italic>u</italic>, whose molecular identity remains unknown. For the pure IFF model, the number of free parameters is therefore seven. In addition to these parameters, we considered the scaling of the firing rate <italic>y</italic> elicited by individual stimulation protocols via a multiplicative factor accounting for variability across experimental conditions (e.g., minute differences in the positions of the stimulation pipette).</p><p>The maximization of the likelihood function was achieved by means of the Nelder-Mead (NM) method (<xref ref-type="bibr" rid="bib77">Nelder and Mead, 1965</xref>), which proved to be fast and reliable. The result of the NM optimization was then refined through a gradient search algorithm (<xref ref-type="bibr" rid="bib12">Brun and Rademakers, 1997</xref>). For the dataset corresponding to the light stimulation, the fitting procedure led us to rule out the relevance of the IFB model alone with a probability of <italic>χ</italic><sup>2</sup> very close to zero. In contrast, the IFF was able to reproduce the experimental observation with good accuracy. On the other hand, in the case of the odor stimulation, we obtained a significant improvement of the model fit by adding an IFB component to the IFF motif (addition of the term <italic>α</italic><sub>3</sub> <italic>y</italic> to the dynamics of <italic>u</italic>).</p><p>The fitted value of the composite IFF+IFB motif indicated that the IFB component was not negligible during the stimulation and accounted for about 30% of the final firing rate (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). In contrast to the pure IFF model, variables <italic>u</italic> and <italic>y</italic> of the IFF+IFB model were entangled in the structure of the ODE resulting in a coupling that allowed us to fit the value of parameter <italic>α</italic><sub><italic>1</italic></sub>. We also examined the effect of introducing additional terms in the denominator of the function defining <italic>y</italic>, such as the product <italic>u</italic> × <italic>y</italic>. Besides the test of other circuit motifs, the introduction of additional free parameters represented a qualitative test against the possibility of over-fitting. The improvements in the fitting obtained in these cases were very marginal.</p><p>With regards to both light and odor stimulation protocols, the data comprised stimulation patterns on diverse timescales and with varying stimulus durations: 10 linear and nonlinear ramps lasting less than 25 s and one ‘naturalistic’ stimulus lasting more than 200 s. We found that the parameter set leading to a good fit during the first 30 s of the light or odor stimulation did not yield an accurate fit for longer durations. By fitting the activity at the beginning and the end of the naturalistic stimulation, we discovered that the discrepancy between both time ranges was mainly due to a change in the threshold <italic>θ</italic> of the Hill term in the time derivative of <italic>y</italic> (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>)<italic>.</italic> We therefore allowed the threshold <italic>θ</italic> to change smoothly between the two different time ranges with the functional expression: <italic>θ′ = θ×</italic>(<italic>τ/t</italic>)<sup>2</sup> for <italic>t</italic> &gt; <italic>τ</italic> with <italic>τ</italic> = 30 s. A third set of measurements of the firing rate at steady state (time interval 20–24 s in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) was used as an independent control of the parameter fit obtained from the fitting of the other stimulation protocols.</p></sec><sec id="s4-9"><title>Derivation of the mathematical solution of the IFF motif</title><p>As observed in <xref ref-type="fig" rid="fig4">Figure 4E,F</xref>, the pure IFF motif not only accounts for the response of the OSN stimulated by light, but it also represents a good approximation of the OSN dynamics stimulated by an odor (<xref ref-type="fig" rid="fig4">Figure 4E,F</xref> and <xref ref-type="table" rid="tbl2">Table 2</xref>). The general solution of <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> is:<disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mn>o</mml:mn><mml:mi>t</mml:mi></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For times <italic>t</italic> larger than <italic>α</italic><sub>2</sub>, the second term of the solution converges to zero, and we obtain the more compact form:<disp-formula id="equ17"><label>(4)</label><mml:math id="m17"><mml:mrow><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mn>o</mml:mn><mml:mi>t</mml:mi></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>By sequentially integrating (4) by parts, we obtain the following identities:<disp-formula id="equ18"><label>(5)</label><mml:math id="m18"><mml:mrow><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>where the brackets &lt; &gt; denote the convolution introduced in relationship (4). While timescale of the dynamics of variable <italic>u</italic> is given by <italic>α</italic><sub>2</sub>, the time scale of the stimulus can be approximated as<disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>≃</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For the linear and nonlinear ramps tested in <xref ref-type="fig" rid="fig3">Figure 3</xref>, <italic>τ</italic><sub><italic>x</italic></sub> is typically 10 s. As the value of <italic>α</italic><sub>2</sub> is 0.88 s<sup>–1</sup> (<xref ref-type="table" rid="tbl1">Table 1</xref>), the variable <italic>u</italic> evolves on a timescale approximately 10 times faster than the stimulus. Using relationship (4), <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> can be rewritten as:<disp-formula id="equ20"><label>(6)</label><mml:math id="m20"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mtext>​</mml:mtext></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mi>y</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The function multiplying parameter <italic>β</italic><sub>4</sub> is a steep sigmoid (or Hill function) whose value is close to 1 when <italic>y</italic> is reasonably larger than 0. More formally, this approximation is valid for values of <italic>y</italic> larger than the threshold <inline-formula><mml:math id="inf8"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ21"><label>(7)</label><mml:math id="m21"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ε</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ε</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>ε</mml:mi></mml:mfrac></mml:mrow></mml:msqrt><mml:mi>θ</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Given that the value of <italic>θ</italic> of 0.3, we see that the Hill term will be larger than 0.95 for values of <italic>y</italic> larger than 1.3 Hz. For this range of values, <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> can be rewritten as:<disp-formula id="equ22"><label>(8)</label><mml:math id="m22"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mi>y</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>f</italic>(<italic>t</italic>) is a function independent of <italic>y</italic>. This function evolves on a timescale slower than <italic>α</italic><sub>2</sub>. If we assume that the firing rate <italic>y</italic> (0) is initially 0, the solution of (8) is:<disp-formula id="equ23"><label>(9)</label><mml:math id="m23"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mn>o</mml:mn><mml:mi>t</mml:mi></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ9">Equation 9</xref> shows that the dynamics of <italic>y</italic>(<italic>t</italic>) obeys a characteristic time given by <italic>β</italic><sub>5</sub>. Since <italic>β</italic><sub>5</sub> = 13.03 s<sup>−1</sup> (<xref ref-type="table" rid="tbl1">Table 1</xref>), variable <italic>y</italic> evolves on a timescale more than 10 times faster than the stimulus. In view of this separation of the timescales, it is justified to assume that <italic>y</italic> is at quasi-steady-state (QSSA, <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>≃</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) during the evolution of the stimulus <italic>x</italic> and variable <italic>u</italic>. By combining this assumption with (6), we find that:<disp-formula id="equ24"><label>(10)</label><mml:math id="m24"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Based on the values of the parameters of the original ODE system (<xref ref-type="table" rid="tbl1">Table 1</xref>), we obtain <italic>β</italic><sub>1</sub>/<italic>β</italic><sub>5</sub> = 132.9 Hz, <italic>β</italic><sub>2</sub> = 1.27 W/m<sup>2</sup>, <italic>α</italic><sub>1</sub><italic>β</italic><sub>3</sub> = 0.25 s<sup>−1</sup>, and <italic>β</italic><sub>4</sub>/<italic>β</italic><sub>5</sub> = 93.17 Hz. It is interesting to note that the convolution of <italic>x</italic> is necessarily smaller when <italic>x</italic> takes on larger values. Using the identities (5), we can rewrite (10) as:<disp-formula id="equ25"><label>(11)</label><mml:math id="m25"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo> </mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ26"><mml:math id="m26"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>103.66</mml:mn><mml:mo> </mml:mo><mml:mi>H</mml:mi><mml:mi>z</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ27"><mml:math id="m27"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn><mml:mo> </mml:mo><mml:mi>W</mml:mi><mml:mo>/</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ28"><mml:math id="m28"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.22.</mml:mn></mml:mrow></mml:math></disp-formula><disp-formula id="equ29"><mml:math id="m29"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>93.17</mml:mn><mml:mo> </mml:mo><mml:mi>H</mml:mi><mml:mi>z</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>As expected, the QSSA solution is in excellent agreement with the results of the integration of the full ODE system (<xref ref-type="fig" rid="fig14">Figure 14</xref>). Given the values of the parameters (<xref ref-type="table" rid="tbl1">Table 1</xref>), the denominator of relationship (11) is mostly driven by the stimulus intensity for slowly evolving stimuli. The contribution of the convolution over the first derivative is significant for rapid and large changes of the stimulus intensity. In the limit where the stimulus is constant over time (d<italic>x</italic>/d<italic>t</italic> = 0), the scaling term S(<italic>x</italic>,<italic>t</italic>) is equal to zero and the QSSA predicts the dose–response function displayed in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1C</xref>:<disp-formula id="equ30"><mml:math id="m30"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">QSSA</mml:mi></mml:mrow></mml:msup><mml:mo>∝</mml:mo><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>C</italic><sub>1</sub> is a constant. For stimulation patterns in which the intensity changes at a constant rate (linear ramps, <xref ref-type="fig" rid="fig4">Figure 4E</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>), the first derivative is constant with a positive or a negative sign.<disp-formula id="equ31"><mml:math id="m31"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">QSSA</mml:mi></mml:mrow></mml:msup><mml:mo>∝</mml:mo><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext> constant </mml:mtext><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <italic>C</italic><sub>1</sub> and <italic>C</italic><sub>2</sub> being constants. The sign of <italic>C</italic><sub>2</sub> is determined by that of d<italic>x</italic>/d<italic>t</italic>. For constant stimulus gradients (linear increases in concentration), we predict that the firing rate also followed a hyperbolic function (dose–response) of the stimulus intensity (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). This time, however, the dose–response is expected to saturate at lower values of the stimulus intensity when the gradient is positive (rising phase of the linear ramps) and higher values of the stimulus intensity when the gradient is negative (falling phase of the linear ramps). These predictions are consistent with the firing patterns observed in <xref ref-type="fig" rid="fig4">Figure 4</xref>.<fig id="fig14" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.036</object-id><label>Figure 14.</label><caption><title>Quasi-steady state approximation of the IFF model describing the spiking dynamics of a single OSN stimulated by light ramps.</title><p>Comparisons of the analytical solution of the OSN activity upon numerical integration of the full ODE system (green line) with the solution obtained under the quasi-steady state approximation (QSSA, orange line) and the experimental PSTH (black line, shades denote standard deviation). The goodness of fit of the QSSA is remarkable for the linear and nonlinear ramps. As discussed in the ‘Materials and methods’, the QSSA holds for values of <italic>y</italic> such that the Hill term can be linearized (<italic>y</italic> &gt;1.3 Hz). This domain of validity is depicted by the orange background.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.036">http://dx.doi.org/10.7554/eLife.06694.036</ext-link></p></caption><graphic xlink:href="elife-06694-fig14-v1"/></fig></p></sec><sec id="s4-10"><title>Tracker</title><p>The tracker outlined in <xref ref-type="fig" rid="fig5">Figure 5</xref> is presented in more detail in <xref ref-type="fig" rid="fig15">Figure 15</xref>. It was conceived and built at the Instrumentation Design and Fabrication Facility at the Janelia Research Campus. Part of the construction was carried out by KeyTech (Baltimore, USA). Unlike other tracking systems (<xref ref-type="bibr" rid="bib24">Faumont et al., 2011</xref>; <xref ref-type="bibr" rid="bib59">Leifer et al., 2011</xref>; <xref ref-type="bibr" rid="bib54">Kocabas et al., 2012</xref>), our setup was designed to keep the stage on which the larva evolves fixed by mounting the camera and stimulation LEDs on a moving stage whose position was continuously updated to stay locked with the animal's position (<xref ref-type="fig" rid="fig15">Figure 15</xref>). The upper and lower moving stage were powered by a pair of stepper motors (T-LSR450B, Zaber Technologies, Canada). The blueprint of the tracker and list of parts are available from the following link: <ext-link ext-link-type="uri" xlink:href="https://github.com/LabLouis/eLife_2015/tree/master/Tracker%20Hardware">https://github.com/LabLouis/eLife_2015/tree/master/Tracker%20Hardware</ext-link>. The light stimulation module consisted of three LEDs, connected in series (LCS-0470-03-22, Mightex Systems) to an LED controller (SLA-1200-2, Mightex Systems) whose output current limit was set to 750 mA. The angle and position of each LED was fixed to cover the camera's field of view with maximum light intensity. The controller's output current scaled proportionally to the analog voltage fed into the controller board. The light intensity reaching the arena was estimated by measuring the current emitted by a photodiode (SM05PD7A, Thorlabs) connected to a benchtop amplifier (PDA200C, Thorlabs). The tracker's video camera (A622f, Basler, Germany) was placed at the center of the three blue LEDs; it delivered images at a resolution of 800 × 800 pixels at a frame time interval of 23 ms. Combined with the time required to process the image and actuate the position of the stage, the effective frame rate was 30 Hz.<fig id="fig15" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.037</object-id><label>Figure 15.</label><caption><title>Technical description of the closed-loop tracker for virtual olfactory realities.</title><p>(<bold>A</bold>) Schematic drawing of the closed-loop tracker. The blue LEDs and the camera are mounted on a moving stage that follows the larva while it crawls on an agarose slab (40 × 40 cm or approximately 120 × 120 body lengths of the larva). (<bold>B</bold>) Depiction and description of the moving camera stage equipped with three LEDs. (<bold>C</bold>) Flow chart outlining the interaction of the core modules of the tracking software (‘Materials and methods’). (<bold>D</bold>) Illustration of the spatial trajectory generated by an <italic>Or42a</italic>&gt;ChR2 larva undergoing closed-loop light stimulation in a virtual odor gradient. (Top-left) Predefined light landscape with a geometry approximating the odor distribution produced by a point source. During the behavioral tests, the full gradient is not projected onto the arena: the larva is illuminated by the LEDs at an intensity determined by its position in the virtual light gradient. (Bottom) The light intensity is updated based on the motion of the larva, which forms the temporal evolution shown in the graph. (Top-right) The spatial trajectory described by an <italic>Or42a</italic>&gt;ChR2 larva in the virtual light gradient. The orientation response faithfully reproduces chemotactic behavior. In closed-loop experiments, the LED intensity was updated according to the position of the head with respect to a predefined spatial landscape. In open-loop experiments, the LED intensity was determined by a predefined temporal profile implemented only when a larva was in a run mode (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). During a run, the motion of the larva had no influence on the intensity of the stimulus. As soon as the larva interrupted a run, the light intensity returned to a baseline value (15 W/m<sup>2</sup>). (<bold>E</bold>) Abolishment of photophobic behavior in blind larvae. Stimulation of larvae with light flashes of 0.5 s (intensity: 207 W/m<sup>2</sup>). The flashes were interspaced by a time interval picked from a Poisson distribution with mean 7.7 s. To ensure that a larva had sufficient time to react to individual light pulses, the minimum inter-flash interval was set to 5 s. The behavior resulting from the flash was characterized by computing the flash-triggered averages of the amplitude of the absolute head angle and its time derivative. Wild-type larvae (black trace) display an increase in head motion following the flash (release of head cast). Blind <italic>GMR</italic>-<italic>hid</italic>;<italic>dTrpA1</italic><sup><italic>1</italic></sup> larvae (red trace) were not affected by the light flashes. The graph represents the means of the kinematic variables computed across trajectories; error bars denote SEM.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.037">http://dx.doi.org/10.7554/eLife.06694.037</ext-link></p></caption><graphic xlink:href="elife-06694-fig15-v1"/></fig></p><p>As summarized in <xref ref-type="fig" rid="fig15">Figure 15C</xref>, the larval tracker control unit (LTCU) formed the main hardware interface controlling the LEDs and acquiring images from the video camera. While the camera was controlled via a transistor–transistor logic pulse signal, a 12-bit digital-to-analog converter output was used to send the control signals (0–5 V analog signal) to the LED controller. An in-circuit debugging (ICD) Port was used to connect the LTCU to an ICD3 programmable interface controller via a registered jack (RJ11) connector interface, while an USB Port enabled the LTCU's communication to the PC. A customized program written in C was used to direct the function of the LTCU. This C program enabled the LTCU to respond to the commands issued by the PC. The software interface of the tracking and image analysis software interfacing the LTCU was written in JAVA. Both the C program and JAVA interface are available from the following links: <ext-link ext-link-type="uri" xlink:href="https://github.com/LabLouis/eLife_2015/tree/master/Wormsign">https://github.com/LabLouis/eLife_2015/tree/master/Wormsign</ext-link> (tracker) and <ext-link ext-link-type="uri" xlink:href="https://github.com/LabLouis/eLife_2015/tree/master/Venkman">https://github.com/LabLouis/eLife_2015/tree/master/Venkman</ext-link> (JAVA controller interface).</p><sec id="s4-10-1"><title>Update of light intensity</title><p>For closed-loop experiments described in <xref ref-type="fig" rid="fig6 fig7">Figures 6, 7</xref>, the light intensity was updated based on the position of the head of the larva mapped on a predefined light landscape. The light landscape was loaded and interpolated by the software controller environment from a matrix with a spatial resolution of 1 × 1 mm. Since the position of the larva was monitored at a higher resolution, the intensity of the spatial landscape was redefined by using a bi-linear interpolation along the <italic>x</italic>- and <italic>y</italic>-axis. The position of the center of the light gradient was automatically adjusted at the beginning of the experiment in such a way that every larva started in a direction facing the center of the gradient at a fixed distance of 9.6 mm from the center for the exponential light gradient (<xref ref-type="fig" rid="fig6">Figure 6</xref>) and a distance of 17.1 mm for the family of light landscapes (<xref ref-type="fig" rid="fig7">Figure 7</xref>). The minority of trajectories from which larvae failed to detect the presence of the light gradient was discarded from the dataset.</p><p>For open-loop experiments described in <xref ref-type="fig" rid="fig5">Figure 5</xref>, the LED intensity was updated based on a predefined temporal function. This function was only implemented when the larva was classified in a run mode according to the rules described in <xref ref-type="fig" rid="fig16">Figure 16</xref>. Throughout the study, odor and light gradient landscapes were represented using brewermap (S. Cobeldick, MathWorks file exchange) with color schemes from <ext-link ext-link-type="uri" xlink:href="http://colorbrewer2.org/">http://colorbrewer2.org/</ext-link>.<fig id="fig16" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.029</object-id><label>Figure 16.</label><caption><title>Real-time classification of the locomotor behavior of the larva.</title><p>(<bold>A</bold>) In the present study, the locomotor behavior of the larva is classified into two basic types of action: forward runs and non-runs. Non-run is a meta-state that includes stops, turns, casts, and backward runs. No distinction is made between non-run behaviors. To distinguish runs from non-runs, we defined empirical filters based on the following three sensorimotor features: (1) the head angle between the direction of the body axis (tail-midpoint) and the neck axis (head-midpoint); (2) the instantaneous velocity vector measured at the tail position (vector vtail) and (3) the angle α formed by tail velocity vector and the direction of the body axis (unitary vector 1<sub>m</sub>). (<bold>B</bold>) Transitions from a run to a non-run state take place as soon as (i) the head angle is larger than a threshold <italic>τ</italic><sub><italic>1</italic></sub> or (ii) the dot product of the tail velocity vector and unitary vector corresponding to the direction of the body axis is smaller than <italic>τ</italic><sub><italic>2</italic></sub> (condition C1). The first condition on the head angle identifies head casts while the second condition on the dot product identifies sequences of behavior associated with a stop or a backward run. Transitions from a non-run to a run take place when the following two conditions are verified: (iii) the head angle must be lower than the threshold value <italic>τ</italic><sub><italic>3</italic></sub> and (iv) the dot product of the tail velocity and unitary vector along the body axis must be larger than <italic>τ</italic><sub><italic>2</italic></sub> (condition C2). (<bold>C</bold>) The thresholds of conditions (i–iv) were set at a value that maximizes the difference in the cumulative distribution of the run and non-run states along the relevant sensorimotor feature (head angle or dot product) for the two possible types of behavioral state transitions (run → non-run or non-run → run). Distributions of the frame-by-frame sensorimotor features were constructed by pooling the annotated frames from four representative trajectories. Manual annotation was achieved by two trained experimenters. (Top) The values of the thresholds used in the analysis were: <italic>τ</italic><italic><sub>1</sub></italic> = 18°, <italic>τ</italic><sub><italic>2</italic></sub> = 0.0065, and <italic>τ</italic><sub><italic>3</italic></sub> = 13°. (Bottom) Comparison of frame-by-frame manual classification of run/non-run behavior achieved by the two trained annotators (A1 and A2) vs the computational classification obtained by filters described in panel <bold>B</bold>. The table reports the percentage of true positives (frames classified as a run by both the annotator and the algorithm) and false negatives (frames classified as a run by the annotator and a non-run by the algorithm). This good match validates the use of the computational classifiers in real-time experiments.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.029">http://dx.doi.org/10.7554/eLife.06694.029</ext-link></p></caption><graphic xlink:href="elife-06694-fig16-v1"/></fig></p></sec></sec><sec id="s4-11"><title>Computation and predictions of the turn probability</title><p>In the behavioral experiments of <xref ref-type="fig" rid="fig5">Figure 5</xref>, the probability of turning (‘turn rate’) was estimated from the relative number of turns that took place during a 1-s time window centered on the time point of interest. If we denote the number of runs observed at the beginning and the end of the ith time window as Nb<sub><italic>i</italic></sub> and Ne<sub><italic>i</italic></sub>, respectively, Nb1 represents the total number of runs contained in the dataset. Over time, Nb<sub><italic>i</italic></sub> decreases monotonically to 0. The turn probability associated with the ith time point was estimated as the fraction of runs that ended during the corresponding time window: (Nb<sub><italic>i</italic></sub> − Ne<sub><italic>i</italic></sub>)/Nb<sub><italic>i</italic></sub>. A sliding time window was then applied to estimate the turn probability corresponding to every time point of the experiment. The turn probability was thus defined as the likelihood of implementing a turn within a 1 s time window, resulting in values smaller than 1 (in the case of 1 all runs entering a given time window switch to a turn) and larger or equal to 0 (in the case of 0 no turn takes place during a given time window). While a short time window led to noisy turn probability estimates, long time windows led to undesirable averaging effects. We empirically found that a time window of 1 s (or 30 time points) offered a good tradeoff.</p><sec id="s4-11-1"><title>Generalized linear model for turn predictions</title><p>As described in <xref ref-type="fig" rid="fig5">Figure 5</xref>, the predicted probability of turning was computed from a GLM based on a linear function of the firing rate of the OSN, <italic>y</italic>. To map the domain of definition of the firing rate ([0, ∞]) onto the domain of definition of the turn probability ([0, 1]), we applied a logit link function (<xref ref-type="bibr" rid="bib75">Myers et al., 2002</xref>). This led to the following relationship:<disp-formula id="equ32"><label>(13)</label><mml:math id="m32"><mml:mrow><mml:mi>ln</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The two parameters of the model, <italic>γ</italic><sub>0</sub> and <italic>γ</italic><sub>1</sub>, were trained on a set of 10 light ramps listed in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>. Parameter <italic>γ</italic><sub>0</sub> corresponds to a term related to the basal turn rate. The values of the parameters of the model are reported in <xref ref-type="table" rid="tbl3">Table 3</xref>.</p><p>As shown in <xref ref-type="fig" rid="fig17">Figure 17</xref>, the logit transform included in the GLM improved the accuracy of the fit without being essential. The predictive value of the model trained on open-loop behavior was then evaluated when applied to closed-loop experiments such as those described in <xref ref-type="fig" rid="fig6 fig7 fig8">Figures 6–8</xref>. The performance of the test model was compared to a control model devoid of sensory processing of the OSN. For the control model, relationship (13) became:<disp-formula id="equ33"><label>(14)</label><mml:math id="m33"><mml:mrow><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the parameters <italic>γ′</italic><sub>0</sub> and <italic>γ′</italic><sub>1</sub> were computed from a linear regression on the open-loop experiments listed in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> (parameter values listed in <xref ref-type="table" rid="tbl3">Table 3</xref>).<fig id="fig17" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.038</object-id><label>Figure 17.</label><caption><title>Contribution of the logit transform to the predictions of the integrated stimulus-to-behavior generalized linear model (GLM).</title><p>(<bold>A</bold>) Comparison of the behavioral outputs of the GLM with and without logit transformation for the run-to-turn transitions elicited by a 8-s linear light ramp. In the absence of logit transformation, the GLM is based on a linear combination <italic>λ</italic>(<italic>t</italic>) = <italic>γ</italic><sub>0</sub> + <italic>γ</italic><sub>1</sub><italic>y</italic>(<italic>t</italic>). Negative values of the linear combination were rectified to be equal to 0. The parameters of the model were trained on the full set of ramps presented in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> (derived parameter set: <italic>γ</italic><sub>0</sub> = 0.3762, <italic>γ</italic><sub>1</sub> = −0.0198 Hz<sup>−1</sup>). The result of the GLM without logit transformation is represented by a dashed line. The GLM model that includes the logit transformation is represented by a plain line (parameter set listed in <xref ref-type="table" rid="tbl3">Table 3</xref>). The correlation coefficients (<italic>ρ</italic>) and coefficients of variation of the RMSE computed on the outputs of the GLM with and without logit transformation differ by 12% and 10%, respectively. (<bold>B</bold>) Same as panel <bold>A</bold> for a sigmoid light ramp. The correlation coefficients and coefficients of variation of the RMSE computed on the outputs of the GLM with and without logit transformation differ by 5% and 22%, respectively.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.038">http://dx.doi.org/10.7554/eLife.06694.038</ext-link></p></caption><graphic xlink:href="elife-06694-fig17-v1"/></fig></p><p>Finally, the contribution of the first derivative of the stimulus intensity was assessed in the enhanced control model:<disp-formula id="equ34"><label>(15)</label><mml:math id="m34"><mml:mrow><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mo>″</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mo>″</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mo>″</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The time derivative of the stimulus was defined by the change in stimulus intensity that occurred during the frame (33 ms) preceding the present time point <italic>t</italic>. The goodness of fit of the two control models can be compared to the test model in <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>.</p></sec></sec><sec id="s4-12"><title>Statistical procedures and data analysis</title><p>This section summarizes the methods used for the quantification of physiological and behavioral data.</p><sec id="s4-12-1"><title>Quantification of goodness of fit of the OSN and behavioral models (material pertaining to <xref ref-type="table" rid="tbl2 tbl4">Tables 2, 4</xref>, <xref ref-type="fig" rid="fig13 fig18">Figures 13, 18</xref>)</title><p>For the firing rate of the OSN and the probability of turning, two metrics were used to quantify the goodness of fit of the models. First, we used Pearson's correlation coefficient. If we denote the experimental observations as <italic>X</italic><sub>t</sub> and the output from the model as <italic>Y</italic><sub>t</sub>, the correlation coefficient was computed as:<disp-formula id="equ35"><mml:math id="m35"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>Y</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>s</italic><sub><italic>X</italic></sub> is the standard deviation of variable <italic>X</italic> and <italic>n</italic> represents the total number of time points in the dataset. The second metric used is the coefficient of variation (CV) of the root-mean-square error (RMSE) defined as:<disp-formula id="equ36"><mml:math id="m36"><mml:mrow><mml:mtext>CV</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>RMSE</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msubsup><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><fig id="fig18" position="float"><object-id pub-id-type="doi">10.7554/eLife.06694.028</object-id><label>Figure 18.</label><caption><title>Behavior of single functional Or42a&gt;ChR2 OSN in the background of a silenced and an intact peripheral olfactory system (1 vs 21 functional OSNs).</title><p>(<bold>A</bold>) Open-loop stimulation protocol with a 8-s linear light ramp (magenta line). Comparison of the behavior elicited by ChR2 in the <italic>Or42a</italic> OSN in the background of 20 silenced OSNs (1 functional OSN, black line) and 21 functional OSNs (green line). The genotype of larvae with only one functional OSN is: <italic>w</italic>;<italic>Or42a</italic>-Gal4,<italic>GMR</italic>-<italic>hid</italic>;<italic>Orco</italic><sup>2</sup>,<italic>dTrpA1</italic><sup><italic>1</italic></sup> × <italic>w</italic>;UAS-<italic>Orco</italic>,UAS-ChR2-H134R;<italic>Orco</italic><sup>2</sup>,<italic>dTrpA1</italic><sup><italic>1</italic></sup>. This genotype is used throughout the study. The genotype of control larvae with 21 functional OSNs is: UAS-ChR2-H134R/<italic>Or42a</italic>-Gal4;<italic>gl</italic><sup><italic>60j</italic></sup>,<italic>dTrpA1</italic><sup><italic>1</italic></sup>. This genotype is only used in the present control. The modulation of the turn probability elicited by the stimulus is similar for both genotypes. Plain lines indicate the mean of the turn probability; shaded areas denote standard deviation (see ‘Materials and methods’). (<bold>B</bold>) Closed-loop behavior in an exponential light gradient. The stimulus landscape is the same as that used in <xref ref-type="fig" rid="fig6">Figure 6A</xref>. Side-by-side comparison of 10 light-driven trajectories superimposed onto the gradient. The overall patterns of the trajectories indicate that light-driven chemotaxis can be mediated by a single OSN in the background of 21 functional OSNs.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06694.028">http://dx.doi.org/10.7554/eLife.06694.028</ext-link></p></caption><graphic xlink:href="elife-06694-fig18-v1"/></fig></p></sec><sec id="s4-12-2"><title>Error bars for the PSTHs (material pertaining to <xref ref-type="fig" rid="fig2 fig3 fig4 fig5 fig6 fig7 fig8">Figures 2–8</xref>)</title><p>Except for <xref ref-type="fig" rid="fig13">Figure 13</xref>, all PSTH were computed on a sliding time window of 50 ms (<xref ref-type="bibr" rid="bib20">Dayan and Abbott, 2001</xref>). Throughout the manuscript, the error bars (shaded areas) associated with the firing rate of the <italic>Or42a&gt;</italic>ChR2 OSN (PSTH) denote the standard deviation.</p></sec><sec id="s4-12-3"><title>Error bars for the turn probabilities estimated from open-loop behavioral experiments (material pertaining to <xref ref-type="fig" rid="fig5 fig17 fig18">Figures 5, 17, 18</xref>)</title><p>Error bars for the turn probability were estimated by resampling the initial distribution of runs 100 times without replacement and with a sample containing half of the original set of runs. The error bars reported in the figures (shaded areas) correspond to the standard deviations calculated on the resampled sets of runs.</p></sec><sec id="s4-12-4"><title>Cross-validation of the ODE model for the OSN spiking activity (material pertaining to <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>)</title><p>The composite IFF+IFB model developed to reproduce and predict the activity elicited by odor stimulation was trained on the full set of odor ramps listed in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> together with the natural stimulus shown in <xref ref-type="fig" rid="fig2">Figure 2D,E</xref>. The parameters derived through this training procedure (<xref ref-type="table" rid="tbl1">Table 1</xref>) were used throughout the study. To validate the structure of the ODE model, we followed a cross-validation approach in which the IFF+IFB model was trained on the 4-s linear ramps listed in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1Ai–ii</xref> and used to accurately predict the activity elicited by the 8-s ramps listed in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2B</xref> (middle panel) as well as the naturalistic stimulus shown in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2C</xref> (top panel). The same approach was followed to provide a successful validation of the IFF model to describe the spiking activity elicited by light stimulations (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>, bottom panels).</p></sec><sec id="s4-12-5"><title>Controls for behavioral experiments: open-loop light stimulation (material pertaining to <xref ref-type="fig" rid="fig5">Figure 5</xref>)</title><p>In open-loop stimulation experiments (<xref ref-type="fig" rid="fig5">Figure 5</xref>), the output of the integrated stimulus-to-behavior GLM described in (13) was computed for each time point of the experiment. The performances of the test model were compared to a control GLM in which the turn probability was predicted from the stimulus intensity without any sensory processing from the OSN. For this control model, we independently fitted a GLM identical to that presented in <xref ref-type="fig" rid="fig5">Figure 5D</xref> after replacement of the firing rate by the stimulus intensity alone or a combination of the stimulus intensity and its first derivative (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>). The goodness of fit of the test and control GLMs are reported in <xref ref-type="table" rid="tbl4">Table 4</xref>.</p></sec><sec id="s4-12-6"><title>Controls for behavioral experiments: closed-loop light and odor stimulation (material pertaining to <xref ref-type="fig" rid="fig6 fig8">Figures 6, 8</xref>)</title><p>In closed-loop experiments conducted in light and odor gradients (<xref ref-type="fig" rid="fig6 fig8">Figures 6, 8</xref>), the predictions of the integrated stimulus-to-behavior GLM described in <xref ref-type="disp-formula" rid="equ13">equation (13)</xref> were analyzed by computing the turn-triggered average of the turn probability. This average time course was compared to two controls. The first control consisted in achieving turn predictions based on a sensory experience whose relation to the corresponding behavior was uncoupled. To this end, we inverted the time course of the light (odor) intensity and associated it with the forward time course of the behavior. This first control preserved the statistics of the stimulus intensity experienced by the larva. The second control was based on the assumption that the OSN firing rate was constant over time and corresponded to the mean activity predicted by a typical trajectory. Given that each larva experienced a different time course of light intensity, the mean OSN firing rate was computed on a trajectory-by-trajectory basis. Note that the control GLM derived in <xref ref-type="disp-formula" rid="equ14">equation (14)</xref> for the open-loop light ramps was deemed inadequate to predict closed-loop behaviors in odor gradients due to the mismatch between the dynamic range of the stimulus associated with the light ramps and that experienced in the odor gradient.</p></sec><sec id="s4-12-7"><title>Cross-validation of the GLM for the turn probabilities (material pertaining to <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>)</title><p>The integrated stimulus-to-behavior GLM was trained on the full set of light ramps listed in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>. To validate the structure of the GLM, we followed a cross-validation approach in which the GLM was trained on the 4-s linear ramps listed in <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2A</xref> and used to accurately predict the activity elicited by the 8-s ramps listed in <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2Bi–iii</xref>. Furthermore, we demonstrated that training the GLM on a single light ramp was sufficient to make accurate predictions on a different ramp (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2C</xref>).</p></sec><sec id="s4-12-8"><title>Likelihood analysis for behavioral predictions (material pertaining to <xref ref-type="fig" rid="fig6 fig8">Figures 6, 8</xref>)</title><p>To assess the quality of the behavioral predictions obtained from the stimulus-to-behavior GLM described in <xref ref-type="disp-formula" rid="equ13">equation (13)</xref>, we computed the likelihood associated with the observation of the entire set of runs obtained in the closed-loop light and odor gradients. Let us denote the total number of runs observed in a particular gradient as N. The likelihood of the ith run was computed based on the turn probability predicted on bins of 1 s. The probability of observing a turn between time <italic>t</italic> and (<italic>t</italic> +1 s) is: <italic>λ</italic><sub><italic>i</italic></sub> (<italic>t</italic>) where the index <italic>i</italic> refers to the sensory experience associated with the ith run. The probability of not turning during a time interval (<italic>t</italic>, <italic>t</italic> +1) is: 1 − <italic>λ</italic><sub><italic>i</italic></sub> (<italic>t</italic>). Thus, the probability of observing a given run lasting 5.6 s can be estimated as:<disp-formula id="equ37"><label>(16)</label><mml:math id="m37"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0.6</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1.6</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2.6</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3.6</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>4.6</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using relationship (16), we calculated the likelihood of the entire set of runs as:<disp-formula id="equ38"><label>(17)</label><mml:math id="m38"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The log-likelihoods (logL) of the predictions associated with the test model and the two controls (see previous section) were computed. To evaluate the reliability of differences between the test model and controls, we applied a standard bootstrap approach (<xref ref-type="bibr" rid="bib70">Martinez and Martinez, 2001</xref>). From the original collection of runs, we generated 10,000 independent new samples of runs based on random resampling with replacement. For each sample, we computed the logL of the test model and the controls. Next we considered the relative difference in logL between the model and the control defined as:<disp-formula id="equ39"><mml:math id="m39"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>ΔlogL</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>logL</mml:mtext></mml:mrow><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>logL</mml:mtext></mml:mrow><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>logL</mml:mtext></mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>logL</mml:mtext></mml:mrow><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The distribution of this variable is reported in <xref ref-type="fig" rid="fig6">Figure 6F</xref> for the behavior elicited by the light gradient, and in <xref ref-type="fig" rid="fig8">Figure 8D</xref> for the behavior elicited by the odor gradient. Finally, we computed the number of instances where <inline-formula><mml:math id="inf10"><mml:mrow><mml:mtext>ΔlogL</mml:mtext><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mtext>logL</mml:mtext></mml:mrow><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was lower than 0 (control outperforming the test model) and derived a p-value for the hypothesis that the test model yields a larger likelihood than the controls.</p></sec></sec><sec id="s4-13"><title>Optogenetics-based chemotaxis in the background of a silenced and intact olfactory system</title><p>For optimal results, the spike-sorting method (OpSIN, <xref ref-type="fig" rid="fig11">Figure 11B</xref>) developed in this work required that the recordings of the odor-stimulated OSN activity be achieved in the background of a silenced olfactory system (<italic>Orco</italic><sup><italic>−/−</italic></sup>). For this reason, the genotype of the larvae used throughout the study for physiological and behavioral quantification resulted from the cross: <italic>w</italic>;<italic>Or42a</italic>-Gal4,<italic>GMR</italic>-<italic>hid</italic>;<italic>Orco</italic><sup>2</sup>,<italic>dTrpA1</italic><sup><italic>1</italic></sup> × <italic>w</italic>;UAS-<italic>Orco</italic>,UAS-ChR2-H134R;<italic>Orco</italic><sup>2</sup>,<italic>dTrpA1</italic><sup><italic>1</italic></sup><italic>.</italic> Given that interneurons of the larval antennal lobe clearly contribute to the neural representation of odors (<xref ref-type="bibr" rid="bib4">Asahina et al., 2009</xref>; <xref ref-type="bibr" rid="bib58">Larkin et al., 2010</xref>), it was important to determine whether the sensorimotor principles controlling chemotactic behavior in a silenced and intact olfactory system are the same. In this aim, we examined the behavior of larvae with ChR2 expressed in the <italic>Or42a</italic> OSN in the background of a fully functional olfactory system (21 intact OSNs): UAS-ChR2-H134R/<italic>Or42a</italic>-Gal4;<italic>gl</italic><sup><italic>60j</italic></sup>,<italic>dTrpA1</italic><sup><italic>1</italic></sup><italic>.</italic> Larvae bearing the double mutant alleles <italic>gl</italic><sup><italic>60j</italic></sup> and <italic>dTrpA1</italic><sup><italic>1</italic></sup> were insensitive to light (data not shown). In closed-loop and open-loop conditions of light stimulation, we found a high similarity of the chemotactic responses observed in the background of 1 or 21 functional OSNs (<xref ref-type="fig" rid="fig18">Figure 18</xref>). This result corroborates the idea that the basic control principles learned from single functional OSN larvae are relevant to wild-type larvae.</p></sec><sec id="s4-14"><title>Scripts</title><p>All scripts described in the ‘Materials and methods’ as well as the blueprint of the larval tracker are available for download from the following website: <ext-link ext-link-type="uri" xlink:href="https://github.com/LabLouis/eLife_2015">https://github.com/LabLouis/eLife_2015</ext-link>.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank A Leonardo, E Knoche, and the Louis lab for comments on the manuscript. The tracker was developed with the help of L Ramaswamy (ID&amp;F at Janelia Research Campus). We are grateful to the following individuals for insightful discussions at different stages of the project: C Bargmann (molecular interpretation of the IFF motif), H Davidowitz and D Rinberg (design of olfactometer in gaseous phase), A Kim and A Lazar (comparison between transfer function adult and larval OSNs), A Leonardo (linear filter analysis and data interpretation), R Moreno (likelihood analysis), M Phillips (turn classifiers). We thank S Pulver and L Griffith for donating the UAS-ChR2-H134R transgenic stock. ML acknowledges funding from the Spanish Ministry of Science and Innovation (MICINN, BFU2008-00362, BFU2009-07757-E/BMC and BFU2011-26208). We are grateful to KeyTech (Baltimore, USA) for advising about the design of the tracker and for carrying out the assembly of the hardware. AS, AGM, VGR, MM, JS, JR, DJ, and ML were supported by the EMBL/CRG Systems Biology Program. JS was supported by ICREA. AD was funded by the European Commission FP7 Initial Training Network FLiACT (289941). MS was partially funded by the National Centre for Biological Sciences—Tata Institute of Fundamental Research. GL, PA, ETT, CW, SD, and VJ were supported by the Howard Hughes Medical Institute. This project received support from the HHMI Janelia Research Campus visitor program (AS, AGM, VGR, DJ, and ML).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>AS, Conception and design (electrophysiology and part of the behavioral experiments), Acquisition of all data included in the study (electrophysiology, IR spectroscopy and behavior), Development of the OSN recording technique, Analysis and interpretation of data (electrophysiology), Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>AG-M, Conception and design (models for OSN activity and behavioral control, part of the behavioral experiments); Analysis and interpretation of data (analysis and modeling of the experimental data), Tracker development (machine vision algorithm), Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>VGR, Conception and design (part of the behavioral experiments), Acquisition of data (early dataset for behavior), Tracker development (behavioral classifiers)</p></fn><fn fn-type="con" id="con4"><p>GL, Tracker development (machine vision algorithm), Conception and design</p></fn><fn fn-type="con" id="con5"><p>MM, Tracker development (machine vision algorithm), Conception and design, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con6"><p>PA, Spike-sorting method based on optogenetics (electrophysiology), Conception and design, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con7"><p>AD, Conception and design (analysis of model predictions)</p></fn><fn fn-type="con" id="con8"><p>JS, Design of Simplex parameter optimization (modeling), Drafting or revising the article</p></fn><fn fn-type="con" id="con9"><p>JR, Development of the OSN recording technique, Conception and design, Contributed unpublished essential data or reagents</p></fn><fn fn-type="con" id="con10"><p>DJ, Development of the OSN recording technique and spike-sorting algorithm, Conception and design, Analysis and interpretation of data, Contributed unpublished essential data or reagents</p></fn><fn fn-type="con" id="con11"><p>ETT, Tracker development (controller algorithm), Conception and design</p></fn><fn fn-type="con" id="con12"><p>CW, Tracker development (hardware), Conception and design</p></fn><fn fn-type="con" id="con13"><p>MV, Conception of model and analysis of data related to the PDE simulations of odor diffusion (modeling), Acquisition of data, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con14"><p>SD, Conception of generalized linear model for behavior (modeling), Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con15"><p>VJ, Conception and design of the experiments, Spike-sorting method based on optogenetics (electrophysiology), Analysis and interpretation of data (electrophysiology), Drafting or revising the article</p></fn><fn fn-type="con" id="con16"><p>ML, Conception and design of the experiments and models, Tracker development; Analysis and interpretation of data (electrophysiology, behavior and modeling), Drafting or revising the article</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ackers</surname><given-names>GK</given-names></name><name><surname>Johnson</surname><given-names>AD</given-names></name><name><surname>Shea</surname><given-names>MA</given-names></name></person-group><year>1982</year><article-title>Quantitative model for gene regulation by lambda phage repressor</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>79</volume><fpage>1129</fpage><lpage>1133</lpage><pub-id pub-id-type="doi">10.1073/pnas.79.4.1129</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Alon</surname><given-names>U</given-names></name></person-group><year>2007</year><source>An introduction to systems biology: design principles of biological circuits</source><publisher-loc>Boca Raton, FL</publisher-loc><publisher-name>Chapman &amp; Hall/CRC</publisher-name></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ando</surname><given-names>N</given-names></name><name><surname>Emoto</surname><given-names>S</given-names></name><name><surname>Kanzaki</surname><given-names>R</given-names></name></person-group><year>2013</year><article-title>Odour-tracking capability of a silkmoth driving a mobile robot with turning bias and time delay</article-title><source>Bioinspiration &amp; Biomimetics</source><volume>8</volume><fpage>016008</fpage><pub-id pub-id-type="doi">10.1088/1748-3182/8/1/016008</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asahina</surname><given-names>K</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name><name><surname>Piccinotti</surname><given-names>S</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name></person-group><year>2009</year><article-title>A circuit supporting concentration-invariant odor perception in <italic>Drosophila</italic></article-title><source>Journal of Biology</source><volume>8</volume><fpage>9</fpage><pub-id pub-id-type="doi">10.1186/jbiol108</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year>2006a</year><article-title>Chemosensation in <italic>C. elegans</italic></article-title><source>WormBook</source><volume>25</volume><fpage>1</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1895/wormbook.1.123.1</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year>2006b</year><article-title>Comparative chemosensation from receptors to ecology</article-title><source>Nature</source><volume>444</volume><fpage>295</fpage><lpage>301</lpage><pub-id pub-id-type="doi">10.1038/nature05402</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bellmann</surname><given-names>D</given-names></name><name><surname>Richardt</surname><given-names>A</given-names></name><name><surname>Freyberger</surname><given-names>R</given-names></name><name><surname>Nuwal</surname><given-names>N</given-names></name><name><surname>Schwarzel</surname><given-names>M</given-names></name><name><surname>Fiala</surname><given-names>A</given-names></name><name><surname>Stortkuhl</surname><given-names>KF</given-names></name></person-group><year>2010</year><article-title>Optogenetically induced olfactory stimulation in <italic>Drosophila</italic> larvae reveals the neuronal basis of odor-aversion behavior</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>4</volume><fpage>27</fpage><pub-id pub-id-type="doi">10.3389/fnbeh.2010.00027</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>HC</given-names></name></person-group><year>2004</year><source>E. coli in motion</source><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Berndt</surname><given-names>DJ</given-names></name><name><surname>Clifford</surname><given-names>J</given-names></name></person-group><year>1994</year><source>Using dynamic time warping to find patterns in time series</source><publisher-loc>Seattle, WA</publisher-loc><publisher-name>KDD workshop</publisher-name></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bintu</surname><given-names>L</given-names></name><name><surname>Buchler</surname><given-names>NE</given-names></name><name><surname>Garcia</surname><given-names>HG</given-names></name><name><surname>Gerland</surname><given-names>U</given-names></name><name><surname>Hwa</surname><given-names>T</given-names></name><name><surname>Kondev</surname><given-names>J</given-names></name><name><surname>Phillips</surname><given-names>R</given-names></name></person-group><year>2005</year><article-title>Transcriptional regulation by the numbers: models</article-title><source>Current Opinion in Genetics &amp; Development</source><volume>15</volume><fpage>116</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.gde.2005.02.007</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borst</surname><given-names>A</given-names></name><name><surname>Heisenberg</surname><given-names>M</given-names></name></person-group><year>1982</year><article-title>Osmotropotaxis in <italic>Drosophila melanogaster</italic></article-title><source>Journal of Comparative Physiology A</source><volume>147</volume><fpage>479</fpage><lpage>484</lpage><pub-id pub-id-type="doi">10.1007/BF00612013</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brun</surname><given-names>R</given-names></name><name><surname>Rademakers</surname><given-names>F</given-names></name></person-group><year>1997</year><article-title>ROOT—an object oriented data analysis framework</article-title><source>Nuclear Instruments and Methods in Physics Research Section A</source><volume>389</volume><fpage>81</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1016/S0168-9002(97)00048-X</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Busto</surname><given-names>M</given-names></name><name><surname>Iyengar</surname><given-names>B</given-names></name><name><surname>Campos</surname><given-names>AR</given-names></name></person-group><year>1999</year><article-title>Genetic dissection of behavior: modulation of locomotion by light in the <italic>Drosophila melanogaster</italic> larva requires genetically distinct visual system functions</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>3337</fpage><lpage>3344</lpage></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Heeger</surname><given-names>DJ</given-names></name></person-group><year>2012</year><article-title>Normalization as a canonical neural computation</article-title><source>Nature Reviews. Neuroscience</source><volume>13</volume><fpage>51</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1038/nrn3136</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carde</surname><given-names>RT</given-names></name><name><surname>Willis</surname><given-names>MA</given-names></name></person-group><year>2008</year><article-title>Navigational strategies used by insects to find distant, wind-borne sources of odor</article-title><source>Journal of Chemical Ecology</source><volume>34</volume><fpage>854</fpage><lpage>866</lpage><pub-id pub-id-type="doi">10.1007/s10886-008-9484-5</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chalasani</surname><given-names>SH</given-names></name><name><surname>Chronis</surname><given-names>N</given-names></name><name><surname>Tsunozaki</surname><given-names>M</given-names></name><name><surname>Gray</surname><given-names>JM</given-names></name><name><surname>Ramot</surname><given-names>D</given-names></name><name><surname>Goodman</surname><given-names>MB</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year>2007</year><article-title>Dissecting a circuit for olfactory behaviour in <italic>Caenorhabditis elegans</italic></article-title><source>Nature</source><volume>450</volume><fpage>63</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1038/nature06292</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year>2001</year><article-title>A simple white noise analysis of neuronal light responses</article-title><source>Network</source><volume>12</volume><fpage>199</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1080/713663221</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cobb</surname><given-names>M</given-names></name></person-group><year>1999</year><article-title>What and how do maggots smell?</article-title><source>Biological Reviews</source><volume>74</volume><fpage>425</fpage><lpage>459</lpage><pub-id pub-id-type="doi">10.1017/S0006323199005393</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Das</surname><given-names>A</given-names></name><name><surname>Gupta</surname><given-names>T</given-names></name><name><surname>Davla</surname><given-names>S</given-names></name><name><surname>Prieto-Godino</surname><given-names>LL</given-names></name><name><surname>Diegelmann</surname><given-names>S</given-names></name><name><surname>Reddy</surname><given-names>OV</given-names></name><name><surname>Raghavan</surname><given-names>KV</given-names></name><name><surname>Reichert</surname><given-names>H</given-names></name><name><surname>Lovick</surname><given-names>J</given-names></name><name><surname>Hartenstein</surname><given-names>V</given-names></name></person-group><year>2013</year><article-title>Neuroblast lineage-specific origin of the neurons of the <italic>Drosophila</italic> larval olfactory system</article-title><source>Developmental Biology</source><volume>373</volume><fpage>322</fpage><lpage>337</lpage><pub-id pub-id-type="doi">10.1016/j.ydbio.2012.11.003</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name></person-group><year>2001</year><source>Theoretical neuroscience: computational and mathematical modeling of neural systems</source><publisher-loc>Cambridge, Mass</publisher-loc><publisher-name>Massachusetts Institute of Technology Press</publisher-name></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Bruyne</surname><given-names>M</given-names></name><name><surname>Clyne</surname><given-names>PJ</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name></person-group><year>1999</year><article-title>Odor coding in a model olfactory organ: the <italic>Drosophila</italic> maxillary palp</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>4520</fpage><lpage>4532</lpage></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Palo</surname><given-names>G</given-names></name><name><surname>Boccaccio</surname><given-names>A</given-names></name><name><surname>Miri</surname><given-names>A</given-names></name><name><surname>Menini</surname><given-names>A</given-names></name><name><surname>Altafini</surname><given-names>C</given-names></name></person-group><year>2012</year><article-title>A dynamical feedback model for adaptation in the olfactory transduction pathway</article-title><source>Biophysical Journal</source><volume>102</volume><fpage>2677</fpage><lpage>2686</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2012.04.040</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Palo</surname><given-names>G</given-names></name><name><surname>Facchetti</surname><given-names>G</given-names></name><name><surname>Mazzolini</surname><given-names>M</given-names></name><name><surname>Menini</surname><given-names>A</given-names></name><name><surname>Torre</surname><given-names>V</given-names></name><name><surname>Altafini</surname><given-names>C</given-names></name></person-group><year>2013</year><article-title>Common dynamical features of sensory adaptation in photoreceptors and olfactory sensory neurons</article-title><source>Scientific Reports</source><volume>3</volume><fpage>1251</fpage><pub-id pub-id-type="doi">10.1038/srep01251</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faumont</surname><given-names>S</given-names></name><name><surname>Rondeau</surname><given-names>G</given-names></name><name><surname>Thiele</surname><given-names>TR</given-names></name><name><surname>Lawton</surname><given-names>KJ</given-names></name><name><surname>McCormick</surname><given-names>KE</given-names></name><name><surname>Sottile</surname><given-names>M</given-names></name><name><surname>Griesbeck</surname><given-names>O</given-names></name><name><surname>Heckscher</surname><given-names>ES</given-names></name><name><surname>Roberts</surname><given-names>WM</given-names></name><name><surname>Doe</surname><given-names>CQ</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year>2011</year><article-title>An image-free opto-mechanical system for creating virtual environments and imaging neuronal activity in freely moving <italic>Caenorhabditis elegans</italic></article-title><source>PLOS ONE</source><volume>6</volume><fpage>e24666</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0024666</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fishilevich</surname><given-names>E</given-names></name><name><surname>Domingos</surname><given-names>AI</given-names></name><name><surname>Asahina</surname><given-names>K</given-names></name><name><surname>Naef</surname><given-names>F</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year>2005</year><article-title>Chemotaxis behavior mediated by single larval olfactory neurons in <italic>Drosophila</italic></article-title><source>Current Biology</source><volume>15</volume><fpage>2086</fpage><lpage>2096</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2005.11.016</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fraenkel</surname><given-names>GS</given-names></name><name><surname>Gunn</surname><given-names>DL</given-names></name></person-group><year>1961</year><source>The orientation of animals</source><publisher-loc>New York</publisher-loc><publisher-name>Dover Publications</publisher-name></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>French</surname><given-names>AS</given-names></name><name><surname>Korenberg</surname><given-names>MJ</given-names></name><name><surname>Jarvilehto</surname><given-names>M</given-names></name><name><surname>Kouvalainen</surname><given-names>E</given-names></name><name><surname>Juusola</surname><given-names>M</given-names></name><name><surname>Weckstrom</surname><given-names>M</given-names></name></person-group><year>1993</year><article-title>The dynamic nonlinear behavior of fly photoreceptors evoked by a wide range of light intensities</article-title><source>Biophysical Journal</source><volume>65</volume><fpage>832</fpage><lpage>839</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(93)81116-0</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frey</surname><given-names>BJ</given-names></name><name><surname>Dueck</surname><given-names>D</given-names></name></person-group><year>2007</year><article-title>Clustering by passing messages between data points</article-title><source>Science</source><volume>315</volume><fpage>972</fpage><lpage>976</lpage><pub-id pub-id-type="doi">10.1126/science.1136800</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujiwara</surname><given-names>T</given-names></name><name><surname>Kazawa</surname><given-names>T</given-names></name><name><surname>Sakurai</surname><given-names>T</given-names></name><name><surname>Fukushima</surname><given-names>R</given-names></name><name><surname>Uchino</surname><given-names>K</given-names></name><name><surname>Yamagata</surname><given-names>T</given-names></name><name><surname>Namiki</surname><given-names>S</given-names></name><name><surname>Haupt</surname><given-names>SS</given-names></name><name><surname>Kanzaki</surname><given-names>R</given-names></name></person-group><year>2014</year><article-title>Odorant concentration differentiator for intermittent olfactory signals</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>16581</fpage><lpage>16593</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2319-14.2014</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaudry</surname><given-names>Q</given-names></name><name><surname>Hong</surname><given-names>EJ</given-names></name><name><surname>Kain</surname><given-names>J</given-names></name><name><surname>de Bivort</surname><given-names>BL</given-names></name><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year>2013</year><article-title>Asymmetric neurotransmitter release enables rapid odour lateralization in <italic>Drosophila</italic></article-title><source>Nature</source><volume>493</volume><fpage>424</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1038/nature11747</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geffen</surname><given-names>MN</given-names></name><name><surname>Broome</surname><given-names>BM</given-names></name><name><surname>Laurent</surname><given-names>G</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name></person-group><year>2009</year><article-title>Neural encoding of rapidly fluctuating odors</article-title><source>Neuron</source><volume>61</volume><fpage>570</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.01.021</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerber</surname><given-names>B</given-names></name><name><surname>Stocker</surname><given-names>RF</given-names></name></person-group><year>2007</year><article-title>The <italic>Drosophila</italic> larva as a model for studying chemosensation and chemosensory learning: a review</article-title><source>Chemical Senses</source><volume>32</volume><fpage>65</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1093/chemse/bjl030</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Berck</surname><given-names>M</given-names></name><name><surname>Mathew</surname><given-names>D</given-names></name><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2012</year><article-title>Controlling airborne cues to study small animal navigation</article-title><source>Nature Methods</source><volume>9</volume><fpage>290</fpage><lpage>296</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1853</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goentoro</surname><given-names>L</given-names></name><name><surname>Kirschner</surname><given-names>MW</given-names></name></person-group><year>2009</year><article-title>Evidence that fold-change, and not absolute level, of beta-catenin dictates Wnt signaling</article-title><source>Molecular Cell</source><volume>36</volume><fpage>872</fpage><lpage>884</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2009.11.017</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomez-Marin</surname><given-names>A</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year>2012</year><article-title>Active sensation during orientation behavior in the <italic>Drosophila</italic> larva: more sense than luck</article-title><source>Current Opinion in Neurobiology</source><volume>22</volume><fpage>208</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.11.008</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomez-Marin</surname><given-names>A</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year>2014</year><article-title>Multilevel control of run orientation in <italic>Drosophila</italic> larval chemotaxis</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>8</volume><fpage>38</fpage><pub-id pub-id-type="doi">10.3389/fnbeh.2014.00038</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomez-Marin</surname><given-names>A</given-names></name><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Louis</surname><given-names>M</given-names></name></person-group><year>2011</year><article-title>Active sampling and decision making in <italic>Drosophila</italic> chemotaxis</article-title><source>Nature Communications</source><volume>2</volume><fpage>441</fpage><pub-id pub-id-type="doi">10.1038/ncomms1455</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grasso</surname><given-names>FW</given-names></name><name><surname>Consi</surname><given-names>TR</given-names></name><name><surname>Mountain</surname><given-names>DC</given-names></name><name><surname>Atema</surname><given-names>J</given-names></name></person-group><year>2000</year><article-title>Biomimetic robot lobster performs chemo-orientation in turbulence using a pair of spatially separated sensors: progress and challenges</article-title><source>Robotics and Autonomous Systems</source><volume>30</volume><fpage>115</fpage><lpage>131</lpage><pub-id pub-id-type="doi">10.1016/S0921-8890(99)00068-8</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>Y</given-names></name><name><surname>Lucas</surname><given-names>P</given-names></name><name><surname>Rospars</surname><given-names>JP</given-names></name></person-group><year>2009</year><article-title>Computational model of the insect pheromone transduction cascade</article-title><source>PLOS Computational Biology</source><volume>5</volume><fpage>e1000321</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000321</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hallem</surname><given-names>EA</given-names></name><name><surname>Ho</surname><given-names>MG</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name></person-group><year>2004</year><article-title>The molecular basis of odor coding in the <italic>Drosophila</italic> antenna</article-title><source>Cell</source><volume>117</volume><fpage>965</fpage><lpage>979</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2004.05.012</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoare</surname><given-names>DJ</given-names></name><name><surname>McCrohan</surname><given-names>CR</given-names></name><name><surname>Cobb</surname><given-names>M</given-names></name></person-group><year>2008</year><article-title>Precise and fuzzy coding by olfactory sensory neurons</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>9710</fpage><lpage>9722</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1955-08.2008</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iino</surname><given-names>Y</given-names></name><name><surname>Yoshida</surname><given-names>K</given-names></name></person-group><year>2009</year><article-title>Parallel use of two behavioral mechanisms for chemotaxis in <italic>Caenorhabditis elegans</italic></article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>5370</fpage><lpage>5380</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3633-08.2009</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izquierdo</surname><given-names>EJ</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year>2010</year><article-title>Evolution and analysis of minimal neural circuits for klinotaxis in <italic>Caenorhabditis elegans</italic></article-title><source>The Journal of Neuroscience</source><volume>30</volume><fpage>12908</fpage><lpage>12917</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2606-10.2010</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joesch</surname><given-names>M</given-names></name><name><surname>Schnell</surname><given-names>B</given-names></name><name><surname>Raghu</surname><given-names>SV</given-names></name><name><surname>Reiff</surname><given-names>DF</given-names></name><name><surname>Borst</surname><given-names>A</given-names></name></person-group><year>2010</year><article-title>ON and OFF pathways in <italic>Drosophila</italic> motion vision</article-title><source>Nature</source><volume>468</volume><fpage>300</fpage><lpage>304</lpage><pub-id pub-id-type="doi">10.1038/nature09545</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Afonso</surname><given-names>B</given-names></name><name><surname>Larderet</surname><given-names>I</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Carter</surname><given-names>AR</given-names></name><name><surname>de Bivort</surname><given-names>BL</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2013</year><article-title>Sensorimotor structure of <italic>Drosophila</italic> larva phototaxis</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>110</volume><fpage>E3868</fpage><lpage>E3877</lpage><pub-id pub-id-type="doi">10.1073/pnas.1215295110</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname><given-names>HE</given-names></name><name><surname>Zhang</surname><given-names>F</given-names></name><name><surname>Yizhar</surname><given-names>O</given-names></name><name><surname>Ramakrishnan</surname><given-names>C</given-names></name><name><surname>Nishizawa</surname><given-names>T</given-names></name><name><surname>Hirata</surname><given-names>K</given-names></name><name><surname>Ito</surname><given-names>J</given-names></name><name><surname>Aita</surname><given-names>Y</given-names></name><name><surname>Tsukazaki</surname><given-names>T</given-names></name><name><surname>Hayashi</surname><given-names>S</given-names></name><name><surname>Hegemann</surname><given-names>P</given-names></name><name><surname>Maturana</surname><given-names>AD</given-names></name><name><surname>Ishitani</surname><given-names>R</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name><name><surname>Nureki</surname><given-names>O</given-names></name></person-group><year>2012</year><article-title>Crystal structure of the channelrhodopsin light-gated cation channel</article-title><source>Nature</source><volume>482</volume><fpage>369</fpage><lpage>374</lpage><pub-id pub-id-type="doi">10.1038/nature10870</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Cho</surname><given-names>CE</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year>2014</year><article-title>Temporal responses of <italic>C. elegans</italic> chemosensory neurons are preserved in behavioral dynamics</article-title><source>Neuron</source><volume>81</volume><fpage>616</fpage><lpage>628</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.11.020</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaupp</surname><given-names>UB</given-names></name></person-group><year>2010</year><article-title>Olfactory signalling in vertebrates and insects: differences and commonalities</article-title><source>Nature Reviews. Neuroscience</source><volume>11</volume><fpage>188</fpage><lpage>200</lpage><pub-id pub-id-type="doi">10.1038/nrn2789</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelly-Zion</surname><given-names>P</given-names></name><name><surname>Pursell</surname><given-names>C</given-names></name><name><surname>Vaidya</surname><given-names>S</given-names></name><name><surname>Batra</surname><given-names>J</given-names></name></person-group><year>2011</year><article-title>Evaporation of sessile drops under combined diffusion and natural convection</article-title><source>Colloids and Surfaces A</source><volume>381</volume><fpage>31</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1016/j.colsurfa.2011.03.020</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>AJ</given-names></name><name><surname>Lazar</surname><given-names>AA</given-names></name><name><surname>Slutskiy</surname><given-names>YB</given-names></name></person-group><year>2011</year><article-title>System identification of <italic>Drosophila</italic> olfactory sensory neurons</article-title><source>Journal of Computational Neuroscience</source><volume>30</volume><fpage>143</fpage><lpage>161</lpage><pub-id pub-id-type="doi">10.1007/s10827-010-0265-0</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>AJ</given-names></name><name><surname>Lazar</surname><given-names>AA</given-names></name><name><surname>Slutskiy</surname><given-names>YB</given-names></name></person-group><year>2015</year><article-title>Projection neurons in <italic>Drosophila</italic> antennal lobes signal the acceleration of odor concentrations</article-title><source>eLife</source><volume>4</volume><fpage>e06651</fpage><pub-id pub-id-type="doi">10.7554/eLife.06651</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Afonso</surname><given-names>B</given-names></name><name><surname>Vonner</surname><given-names>AJ</given-names></name><name><surname>Hernandez-Nunez</surname><given-names>L</given-names></name><name><surname>Berck</surname><given-names>M</given-names></name><name><surname>Tabone</surname><given-names>CJ</given-names></name><name><surname>Kane</surname><given-names>EA</given-names></name><name><surname>Pieribone</surname><given-names>VA</given-names></name><name><surname>Nitabach</surname><given-names>MN</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Garrity</surname><given-names>PA</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2015</year><article-title>Sensory determinants of behavioral dynamics in <italic>Drosophila</italic> thermotaxis</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>112</volume><fpage>E220</fpage><lpage>E229</lpage><pub-id pub-id-type="doi">10.1073/pnas.1416212112</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kocabas</surname><given-names>A</given-names></name><name><surname>Shen</surname><given-names>CH</given-names></name><name><surname>Guo</surname><given-names>ZV</given-names></name><name><surname>Ramanathan</surname><given-names>S</given-names></name></person-group><year>2012</year><article-title>Controlling interneuron activity in <italic>Caenorhabditis elegans</italic> to evoke chemotactic behaviour</article-title><source>Nature</source><volume>490</volume><fpage>273</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1038/nature11431</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kreher</surname><given-names>SA</given-names></name><name><surname>Kwon</surname><given-names>JY</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name></person-group><year>2005</year><article-title>The molecular basis of odor coding in the <italic>Drosophila</italic> larva</article-title><source>Neuron</source><volume>46</volume><fpage>445</fpage><lpage>456</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.04.007</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kreher</surname><given-names>SA</given-names></name><name><surname>Mathew</surname><given-names>D</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name></person-group><year>2008</year><article-title>Translation of sensory input into behavioral output via an olfactory system</article-title><source>Neuron</source><volume>59</volume><fpage>110</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.06.010</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kwon</surname><given-names>Y</given-names></name><name><surname>Shim</surname><given-names>HS</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Montell</surname><given-names>C</given-names></name></person-group><year>2008</year><article-title>Control of thermotactic behavior via coupling of a TRP channel to a phospholipase C signaling cascade</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>871</fpage><lpage>873</lpage><pub-id pub-id-type="doi">10.1038/nn.2170</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkin</surname><given-names>A</given-names></name><name><surname>Karak</surname><given-names>S</given-names></name><name><surname>Priya</surname><given-names>R</given-names></name><name><surname>Das</surname><given-names>A</given-names></name><name><surname>Ayyub</surname><given-names>C</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name><name><surname>Rodrigues</surname><given-names>V</given-names></name><name><surname>Ramaswami</surname><given-names>M</given-names></name></person-group><year>2010</year><article-title>Central synaptic mechanisms underlie short-term olfactory habituation in <italic>Drosophila</italic> larvae</article-title><source>Learning &amp; Memory</source><volume>17</volume><fpage>645</fpage><lpage>653</lpage><pub-id pub-id-type="doi">10.1101/lm.1839010</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leifer</surname><given-names>AM</given-names></name><name><surname>Fang-Yen</surname><given-names>C</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Alkema</surname><given-names>MJ</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year>2011</year><article-title>Optogenetic manipulation of neural activity in freely moving <italic>Caenorhabditis elegans</italic></article-title><source>Nature Methods</source><volume>8</volume><fpage>147</fpage><lpage>152</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1554</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lim</surname><given-names>WA</given-names></name><name><surname>Lee</surname><given-names>CM</given-names></name><name><surname>Tang</surname><given-names>C</given-names></name></person-group><year>2013</year><article-title>Design principles of regulatory networks: searching for the molecular algorithms of the cell</article-title><source>Molecular Cell</source><volume>49</volume><fpage>202</fpage><lpage>212</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2012.12.020</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lima</surname><given-names>SQ</given-names></name><name><surname>Hromádka</surname><given-names>T</given-names></name><name><surname>Znamenskiy</surname><given-names>P</given-names></name><name><surname>Zador</surname><given-names>AM</given-names></name></person-group><year>2009</year><article-title>PINP: a new method of tagging neuronal populations for identification during in vivo electrophysiological recording</article-title><source>PLOS ONE</source><volume>4</volume><fpage>e6099</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0006099</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>WW</given-names></name><name><surname>Mazor</surname><given-names>O</given-names></name><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year>2015</year><article-title>Thermosensory processing in the <italic>Drosophila</italic> brain</article-title><source>Nature</source><volume>519</volume><fpage>353</fpage><lpage>357</lpage><pub-id pub-id-type="doi">10.1038/nature14170</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year>2011</year><article-title>The computational worm: spatial orientation and its neuronal basis in <italic>C. elegans</italic></article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>782</fpage><lpage>790</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.06.009</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lott</surname><given-names>GK</given-names><suffix>III</suffix></name><name><surname>Johnson</surname><given-names>BR</given-names></name><name><surname>Bonow</surname><given-names>RH</given-names></name><name><surname>Land</surname><given-names>BR</given-names></name><name><surname>Hoy</surname><given-names>RR</given-names></name></person-group><year>2009</year><article-title>G-prime: a free, windows based data acquisition and event analysis software package for physiology in classrooms and research labs</article-title><source>Journal of Undergraduate Neuroscience Education</source><volume>8</volume><fpage>A50</fpage><lpage>A54</lpage></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louis</surname><given-names>M</given-names></name><name><surname>Huber</surname><given-names>T</given-names></name><name><surname>Benton</surname><given-names>R</given-names></name><name><surname>Sakmar</surname><given-names>TP</given-names></name><name><surname>Vosshall</surname><given-names>LB</given-names></name></person-group><year>2008</year><article-title>Bilateral olfactory sensory input enhances chemotaxis behavior</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>187</fpage><lpage>199</lpage><pub-id pub-id-type="doi">10.1038/nn2031</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Wen</surname><given-names>Q</given-names></name><name><surname>Ren</surname><given-names>J</given-names></name><name><surname>Hendricks</surname><given-names>M</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Qin</surname><given-names>Y</given-names></name><name><surname>Greenwood</surname><given-names>J</given-names></name><name><surname>Soucy</surname><given-names>ER</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Smith-Parker</surname><given-names>HK</given-names></name><name><surname>Calvo</surname><given-names>AC</given-names></name><name><surname>Colon-Ramos</surname><given-names>DA</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name></person-group><year>2014</year><article-title>Dynamic encoding of perception, memory, and movement in a <italic>C. elegans</italic> chemotaxis circuit</article-title><source>Neuron</source><volume>82</volume><fpage>1115</fpage><lpage>1128</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.05.010</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mainland</surname><given-names>JD</given-names></name><name><surname>Lundstrom</surname><given-names>JN</given-names></name><name><surname>Reisert</surname><given-names>J</given-names></name><name><surname>Lowe</surname><given-names>G</given-names></name></person-group><year>2014</year><article-title>From molecule to mind: an integrative perspective on odor intensity</article-title><source>Trends in Neurosciences</source><volume>37</volume><fpage>443</fpage><lpage>454</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2014.05.005</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marmarelis</surname><given-names>VZ</given-names></name><name><surname>McCann</surname><given-names>GD</given-names></name></person-group><year>1977</year><article-title>A family of quasi-white random signals and its optimal use in biological system identification. Part II: application to the photoreceptor of Calliphora erythrocephala</article-title><source>Biological Cybernetics</source><volume>27</volume><fpage>57</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1007/BF00357711</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martelli</surname><given-names>C</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name><name><surname>Emonet</surname><given-names>T</given-names></name></person-group><year>2013</year><article-title>Intensity invariant dynamics and odor-specific latencies in olfactory receptor neuron response</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>6285</fpage><lpage>6297</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0426-12.2013</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Martinez</surname><given-names>WL</given-names></name><name><surname>Martinez</surname><given-names>AR</given-names></name></person-group><year>2001</year><source>Computational statistics handbook with MATLAB</source><publisher-name>CRC press</publisher-name></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masse</surname><given-names>NY</given-names></name><name><surname>Turner</surname><given-names>GC</given-names></name><name><surname>Jefferis</surname><given-names>GS</given-names></name></person-group><year>2009</year><article-title>Olfactory information processing in <italic>Drosophila</italic></article-title><source>Current Biology</source><volume>19</volume><fpage>R700</fpage><lpage>R713</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2009.06.026</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masuda-Nakagawa</surname><given-names>LM</given-names></name><name><surname>Gendre</surname><given-names>N</given-names></name><name><surname>O'Kane</surname><given-names>CJ</given-names></name><name><surname>Stocker</surname><given-names>RF</given-names></name></person-group><year>2009</year><article-title>Localized olfactory representation in mushroom bodies of <italic>Drosophila</italic> larvae</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>106</volume><fpage>10314</fpage><lpage>10319</lpage><pub-id pub-id-type="doi">10.1073/pnas.0900178106</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathew</surname><given-names>D</given-names></name><name><surname>Martelli</surname><given-names>C</given-names></name><name><surname>Kelley-Swift</surname><given-names>E</given-names></name><name><surname>Brusalis</surname><given-names>C</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name><name><surname>Emonet</surname><given-names>T</given-names></name><name><surname>Carlson</surname><given-names>JR</given-names></name></person-group><year>2013</year><article-title>Functional diversity among sensory receptors in a <italic>Drosophila</italic> olfactory circuit</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>110</volume><fpage>E2134</fpage><lpage>E2143</lpage><pub-id pub-id-type="doi">10.1073/pnas.1306976110</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moses</surname><given-names>K</given-names></name><name><surname>Ellis</surname><given-names>MC</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name></person-group><year>1989</year><article-title>The glass gene encodes a zinc-finger protein required by <italic>Drosophila</italic> photoreceptor cells</article-title><source>Nature</source><volume>340</volume><fpage>531</fpage><lpage>536</lpage><pub-id pub-id-type="doi">10.1038/340531a0</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>RH</given-names></name><name><surname>Montgomery</surname><given-names>DC</given-names></name><name><surname>Vining</surname><given-names>GG</given-names></name></person-group><year>2002</year><source>Generalized linear models: with applications in engineering and the sciences</source><publisher-loc>New York</publisher-loc><publisher-name>J. Wiley</publisher-name></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagel</surname><given-names>KI</given-names></name><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year>2011</year><article-title>Biophysical mechanisms underlying olfactory receptor neuron dynamics</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>208</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1038/nn.2725</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelder</surname><given-names>JA</given-names></name><name><surname>Mead</surname><given-names>R</given-names></name></person-group><year>1965</year><article-title>A simplex method for function minimization</article-title><source>The Computer Journal</source><volume>7</volume><fpage>308</fpage><lpage>313</lpage><pub-id pub-id-type="doi">10.1093/comjnl/7.4.308</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohyama</surname><given-names>T</given-names></name><name><surname>Jovanic</surname><given-names>T</given-names></name><name><surname>Denisov</surname><given-names>G</given-names></name><name><surname>Dang</surname><given-names>TC</given-names></name><name><surname>Hoffmann</surname><given-names>D</given-names></name><name><surname>Kerr</surname><given-names>RA</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name></person-group><year>2013</year><article-title>High-throughput analysis of stimulus-evoked behaviors in <italic>Drosophila</italic> larva reveals multiple modality-specific escape strategies</article-title><source>PLOS ONE</source><volume>8</volume><fpage>e71706</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0071706</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohyama</surname><given-names>T</given-names></name><name><surname>Schneider-Mizell</surname><given-names>CM</given-names></name><name><surname>Fetter</surname><given-names>RD</given-names></name><name><surname>Aleman</surname><given-names>JV</given-names></name><name><surname>Franconville</surname><given-names>R</given-names></name><name><surname>Rivera-Alba</surname><given-names>M</given-names></name><name><surname>Mensh</surname><given-names>BD</given-names></name><name><surname>Branson</surname><given-names>KM</given-names></name><name><surname>Simpson</surname><given-names>JH</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name></person-group><year>2015</year><article-title>A multilevel multimodal circuit enhances action selection in <italic>Drosophila</italic></article-title><source>Nature</source><volume>520</volume><fpage>633</fpage><lpage>639</lpage><pub-id pub-id-type="doi">10.1038/nature14297</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olsen</surname><given-names>SR</given-names></name><name><surname>Bhandawat</surname><given-names>V</given-names></name><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year>2010</year><article-title>Divisive normalization in olfactory population codes</article-title><source>Neuron</source><volume>66</volume><fpage>287</fpage><lpage>299</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.04.009</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oppliger</surname><given-names>FY</given-names></name><name><surname>M Guerin</surname><given-names>P</given-names></name><name><surname>Vlimant</surname><given-names>M</given-names></name></person-group><year>2000</year><article-title>Neurophysiological and behavioural evidence for an olfactory function for the dorsal organ and a gustatory one for the terminal organ in <italic>Drosophila melanogaster</italic> larvae</article-title><source>Journal of Insect Physiology</source><volume>46</volume><fpage>135</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1016/S0022-1910(99)00109-2</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pifferi</surname><given-names>S</given-names></name><name><surname>Menini</surname><given-names>A</given-names></name><name><surname>Kurahashi</surname><given-names>T</given-names></name></person-group><year>2010</year><article-title>Signal transduction in vertebrate olfactory cilia</article-title><person-group person-group-type="editor"><name><surname>Menini</surname><given-names>A</given-names></name></person-group><source>The neurobiology of olfaction</source><publisher-loc>Boca Raton (FL)</publisher-loc></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pulver</surname><given-names>SR</given-names></name><name><surname>Pashkovski</surname><given-names>SL</given-names></name><name><surname>Hornstein</surname><given-names>NJ</given-names></name><name><surname>Garrity</surname><given-names>PA</given-names></name><name><surname>Griffith</surname><given-names>LC</given-names></name></person-group><year>2009</year><article-title>Temporal dynamics of neuronal activation by Channelrhodopsin-2 and TRPA1 determine behavioral output in <italic>Drosophila</italic> larvae</article-title><source>Journal of Neurophysiology</source><volume>101</volume><fpage>3075</fpage><lpage>3088</lpage><pub-id pub-id-type="doi">10.1152/jn.00071.2009</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramaekers</surname><given-names>A</given-names></name><name><surname>Magnenat</surname><given-names>E</given-names></name><name><surname>Marin</surname><given-names>EC</given-names></name><name><surname>Gendre</surname><given-names>N</given-names></name><name><surname>Jefferis</surname><given-names>GS</given-names></name><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Stocker</surname><given-names>RF</given-names></name></person-group><year>2005</year><article-title>Glomerular maps without cellular redundancy at successive levels of the <italic>Drosophila</italic> larval olfactory circuit</article-title><source>Current Biology</source><volume>15</volume><fpage>982</fpage><lpage>992</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2005.04.032</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year>1997</year><source>Spikes: exploring the neural code</source><publisher-loc>Cambridge, Mass</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sawin-McCormack</surname><given-names>EP</given-names></name><name><surname>Sokolowski</surname><given-names>MB</given-names></name><name><surname>Campos</surname><given-names>AR</given-names></name></person-group><year>1995</year><article-title>Characterization and genetic analysis of <italic>Drosophila melanogaster</italic> photobehavior during larval development</article-title><source>Journal of Neurogenetics</source><volume>10</volume><fpage>119</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.3109/01677069509083459</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schöne</surname><given-names>H</given-names></name></person-group><year>1984</year><source>Spatial orientation: the spatial control of behavior in animals and man</source><publisher-loc>Princeton, NJ</publisher-loc><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singer</surname><given-names>A</given-names></name><name><surname>Schuss</surname><given-names>Z</given-names></name><name><surname>Osipov</surname><given-names>A</given-names></name><name><surname>Holcman</surname><given-names>D</given-names></name></person-group><year>2008</year><article-title>Partially reflected diffusion</article-title><source>SIAM Journal on Applied Mathematics</source><volume>68</volume><fpage>844</fpage><lpage>868</lpage><pub-id pub-id-type="doi">10.1137/060663258</pub-id></element-citation></ref><ref id="bib88a"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singleton</surname><given-names>K</given-names></name><name><surname>Woodruff</surname><given-names>RI</given-names></name></person-group><year>1994</year><article-title>The osmolarity of adult Drosophila hemolymph and its effect on oocyte-nurse cell electrical polarity</article-title><source>Developmental biology</source><volume>161.1</volume><fpage>154</fpage><lpage>167</lpage><pub-id pub-id-type="doi">10.1006/dbio.1994.1017</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smear</surname><given-names>M</given-names></name><name><surname>Shusterman</surname><given-names>R</given-names></name><name><surname>O'Connor</surname><given-names>R</given-names></name><name><surname>Bozza</surname><given-names>T</given-names></name><name><surname>Rinberg</surname><given-names>D</given-names></name></person-group><year>2011</year><article-title>Perception of sniff phase in mouse olfaction</article-title><source>Nature</source><volume>479</volume><fpage>397</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1038/nature10521</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>Z</given-names></name><name><surname>Postma</surname><given-names>M</given-names></name><name><surname>Billings</surname><given-names>SA</given-names></name><name><surname>Coca</surname><given-names>D</given-names></name><name><surname>Hardie</surname><given-names>RC</given-names></name><name><surname>Juusola</surname><given-names>M</given-names></name></person-group><year>2012</year><article-title>Stochastic, adaptive sampling of information by microvilli in fly photoreceptors</article-title><source>Current Biology</source><volume>22</volume><fpage>1371</fpage><lpage>1380</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.05.047</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suh</surname><given-names>GS</given-names></name><name><surname>Ben-Tabou de Leon</surname><given-names>S</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name><name><surname>Fiala</surname><given-names>A</given-names></name><name><surname>Benzer</surname><given-names>S</given-names></name><name><surname>Anderson</surname><given-names>DJ</given-names></name></person-group><year>2007</year><article-title>Light activation of an innate olfactory avoidance response in <italic>Drosophila</italic></article-title><source>Current Biology</source><volume>17</volume><fpage>905</fpage><lpage>908</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2007.04.046</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suzuki</surname><given-names>H</given-names></name><name><surname>Thiele</surname><given-names>TR</given-names></name><name><surname>Faumont</surname><given-names>S</given-names></name><name><surname>Ezcurra</surname><given-names>M</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name><name><surname>Schafer</surname><given-names>WR</given-names></name></person-group><year>2008</year><article-title>Functional asymmetry in <italic>Caenorhabditis elegans</italic> taste neurons and its computational role in chemotaxis</article-title><source>Nature</source><volume>454</volume><fpage>114</fpage><lpage>117</lpage><pub-id pub-id-type="doi">10.1038/nature06927</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szyszka</surname><given-names>P</given-names></name><name><surname>Gerkin</surname><given-names>RC</given-names></name><name><surname>Galizia</surname><given-names>CG</given-names></name><name><surname>Smith</surname><given-names>BH</given-names></name></person-group><year>2014</year><article-title>High-speed odor transduction and pulse tracking by insect olfactory receptor neurons</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>111</volume><fpage>16925</fpage><lpage>16930</lpage><pub-id pub-id-type="doi">10.1073/pnas.1412051111</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tichy</surname><given-names>H</given-names></name><name><surname>Hinterwirth</surname><given-names>A</given-names></name><name><surname>Gingl</surname><given-names>E</given-names></name></person-group><year>2005</year><article-title>Olfactory receptors on the cockroach antenna signal odour ON and odour OFF by excitation</article-title><source>The European Journal of Neuroscience</source><volume>22</volume><fpage>3147</fpage><lpage>3160</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2005.04501.x</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tu</surname><given-names>Y</given-names></name><name><surname>Shimizu</surname><given-names>TS</given-names></name><name><surname>Berg</surname><given-names>HC</given-names></name></person-group><year>2008</year><article-title>Modeling the chemotactic response of <italic>Escherichia coli</italic> to time-varying stimuli</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>105</volume><fpage>14855</fpage><lpage>14860</lpage><pub-id pub-id-type="doi">10.1073/pnas.0807569105</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uchida</surname><given-names>N</given-names></name><name><surname>Poo</surname><given-names>C</given-names></name><name><surname>Haddad</surname><given-names>R</given-names></name></person-group><year>2014</year><article-title>Coding and transformations in the olfactory system</article-title><source>Annual Review of Neuroscience</source><volume>37</volume><fpage>363</fpage><lpage>385</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-071013-013941</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Breugel</surname><given-names>F</given-names></name><name><surname>Dickinson</surname><given-names>MH</given-names></name></person-group><year>2014</year><article-title>Plume-tracking behavior of flying <italic>Drosophila</italic> emerges from a set of distinct sensory-motor reflexes</article-title><source>Current Biology</source><volume>24</volume><fpage>274</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.12.023</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vosshall</surname><given-names>LB</given-names></name><name><surname>Stocker</surname><given-names>RF</given-names></name></person-group><year>2007</year><article-title>Molecular architecture of smell and taste in <italic>Drosophila</italic></article-title><source>Annual Review of Neuroscience</source><volume>30</volume><fpage>505</fpage><lpage>533</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.30.051606.094306</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year>2002</year><article-title>Robots in invertebrate neuroscience</article-title><source>Nature</source><volume>417</volume><fpage>359</fpage><lpage>363</lpage><pub-id pub-id-type="doi">10.1038/417359a</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year>2013</year><article-title>Early olfactory processing in <italic>Drosophila</italic>: mechanisms and principles</article-title><source>Annual Review of Neuroscience</source><volume>36</volume><fpage>217</fpage><lpage>241</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-062111-150533</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>RI</given-names></name><name><surname>Mainen</surname><given-names>ZF</given-names></name></person-group><year>2006</year><article-title>Early events in olfactory processing</article-title><source>Annual Review of Neuroscience</source><volume>29</volume><fpage>163</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.29.051605.112950</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiang</surname><given-names>Y</given-names></name><name><surname>Yuan</surname><given-names>Q</given-names></name><name><surname>Vogt</surname><given-names>N</given-names></name><name><surname>Looger</surname><given-names>LL</given-names></name><name><surname>Jan</surname><given-names>LY</given-names></name><name><surname>Jan</surname><given-names>YN</given-names></name></person-group><year>2010</year><article-title>Light-avoidance-mediating photoreceptors tile the <italic>Drosophila</italic> larval body wall</article-title><source>Nature</source><volume>468</volume><fpage>921</fpage><lpage>926</lpage><pub-id pub-id-type="doi">10.1038/nature09576</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Macara</surname><given-names>AM</given-names></name><name><surname>Lelito</surname><given-names>KR</given-names></name><name><surname>Minosyan</surname><given-names>TY</given-names></name><name><surname>Shafer</surname><given-names>OT</given-names></name></person-group><year>2012</year><article-title>Analysis of functional neuronal connectivity in the <italic>Drosophila</italic> brain</article-title><source>Journal of Neurophysiology</source><volume>108</volume><fpage>684</fpage><lpage>696</lpage><pub-id pub-id-type="doi">10.1152/jn.00110.2012</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yi</surname><given-names>TM</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Simon</surname><given-names>MI</given-names></name><name><surname>Doyle</surname><given-names>J</given-names></name></person-group><year>2000</year><article-title>Robust perfect adaptation in bacterial chemotaxis through integral feedback control</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>97</volume><fpage>4649</fpage><lpage>4653</lpage><pub-id pub-id-type="doi">10.1073/pnas.97.9.4649</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.06694.039</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for sending your work entitled “Dynamical feature extraction at the sensory periphery guides chemotaxis” for consideration at <italic>eLife</italic>. Your article has been favorably evaluated by Eve Marder (Senior editor) and three reviewers, one of whom, Ronald L Calabrese, is a member of our Board of Reviewing Editors.</p><p>The Reviewing editor and the other reviewers discussed their comments before we reached this decision, and the Reviewing editor has assembled the following comments to help you prepare a revised submission.</p><p>The authors present an extraordinarily thorough electrophysiological and behavioral analysis of the chemotaxis in <italic>Drosophila</italic> larvae in natural odor gradients, defined odor gradients, and optogenetically induced fictive olfactory gradients. These analyses relate OSN activity empirically determined to behavior using a model of sensory transduction and a GLM relating neural activity to the probability of turning. They also create closed loop virtual reality environments to test the effectiveness of their models. They conclude that OSN activity accurately predicts turning probability by a simple linear transform and thus OSN spiking dynamics in odor gradients are key for understanding chemotaxis.</p><p>The major biological findings are:</p><p>1) Real odor landscapes even in a controlled chamber are complex and they can be described quantitatively.</p><p>2) OSN activity in real odor and in fictive odor landscapes can be assayed and then modeled (albeit in an ad hoc manner) so that OSN activity can be accurately predicted in both real and fictive odor landscapes.</p><p>3) Fictive controlled odor landscapes can be navigated in a chemotatic way and turn probability can be accurately predicted (using the OSN model and a further ad hoc model) based on OSN activity. Fictive odor landscapes are elegantly designed to extract real behavioral principles. For example a ‘well’ landscape shows that a precipitous drop in predicted (and confirmed) OSN activity induces turns.</p><p>4) When real odor landscapes are chemotaxed, then turn probability can be accurately predicted based on predicted (and confirmed) OSN activity.</p><p>The major technical innovations are:</p><p>1) Real odor landscapes can be calculated based on diffusion equations with sufficient accuracy to extract real odor dynamics for a moving maggot. Confirmed by IR spectroscopy.</p><p>2) It is possible to move between the liquid phase and the gas phase when experiments demand it by matching liquid phase and gas phase OSN activity.</p><p>3) Identical fictive and real odor waveform leads to measureable differences in OSN activity owing to adaptive processes in the OSN during odor stimuli.</p><p>4) Ad hoc models of OSNs can be constructed that capture their essential activity to real and fictive odor stimuli.</p><p>5) GLM ad hoc models can capture the relationship of the ONS activity to turn probability, and used as a tool to understand real chemotaxis in an odor gradient.</p><p>6) Tracker technology can present freely moving maggots with fictive odor gradients to determine turn probability.</p><p>At the paragraph level the writing is clear and the paper is thoroughly illustrated, but finding the above major contributions amid the voluminous data (especially supplemental data) is difficult owing to the overall structure of the paper. Moreover the Discussion seems to focus too much on the OSN model and its implications at the expense of the biological insights for chemotaxis. The authors must be at pains to bring out these contributions in the way they structure the paper and in Abstract and Discussion. The logical flow of the techniques (tool development) and experiments and the conclusions must be made more apparent. One thing that will help immensely with flow will be to delete some of the supplemental figures on tool development or to place the call outs in Materials and methods (simply refer—no figure call outs—to Materials and methods in the Results): Figure 1–figure supplement 1, 2, 3 in Materials and methods; Figure 2–figure supplement 1 can be eliminated, as it is a negative result; Figure 2–figure supplement 2 can be eliminated; <xref ref-type="fig" rid="fig4">Figure 4</xref> can be made into a supplemental figure and placed in Materials and methods; Figure 5–figure supplement 1, 2, 5 in Materials and methods; Figure 6–figure supplement 1 eliminated; <xref ref-type="fig" rid="fig8s1">Figure 8–figure supplement 1</xref> in Materials and methods.</p><p>There are some technical concerns that must be addressed:</p><p>1) Statistics. In Materials and methods add a statistics section and write a clear description of the statistical tests used. This is somewhat scattered throughout Materials and methods now. Much of the statistics is in tables and in the figure legends and needs to be made more apparent. <xref ref-type="fig" rid="fig6 fig8">Figures 6F and 8D, E</xref> present critical statistical tests that are based on a subset of long run trajectory. The rationale and validity of excluding short runs need to be made more apparent.</p><p>2) There is some concern about whether parameters for the models were fixed at some point or whether they were changed with each experiment. One possible reading is that the parameters of <xref ref-type="table" rid="tbl1">Table 1</xref> and <xref ref-type="table" rid="tbl3">Table 3</xref> represent fixed parameters based on the ‘training’ of the associated figure and that subsequent uses of the models used these fixed parameters. The authors must make this explicit. If parameters, were changed with each new experiments then this would seriously diminish the value of the modeling. Specifically, the authors' need to address the question of whether models that were trained on a set of input–output pairs generalize to an equivalent set of pairs that were not in the original training set.</p><p>3) There is the concern that the sensory neuron model is fitted to events on a time scale of less than 10 sec (<xref ref-type="fig" rid="fig2 fig3 fig4">Figure 2, 3, 4</xref>, etc.), whereas the dynamics of chemosensory stimuli during behavior in an odor gradient occur on a time scale of about 30 sec. The authors should acknowledge in text any difference in time scale and dynamic range between real odor time courses and the input domain over which the model was fitted.</p><p>4) The odor and channelrhodopsin (ChR) experiments are done in <italic>Or83b</italic> mutant background. Thus the dynamics of <italic>Or42a</italic>-ORNs can be more easily related to behavior in an otherwise silent olfactory system. Will the same be the case in the presence of spontaneous spiking of other ORNs? Another important issue with doing behaviors in a completely silent system is that local interaction at higher levels of olfactory circuits would likely be diminished if not completely absent. Therefore OSN activity-to-turn probability transformation determined might not be representative of that in the WT animal. The authors must address this limitation forthrightly in Discussion.</p><p>5) The logit transform of the equation in <xref ref-type="fig" rid="fig5">Figure 5D</xref> caused some reviewer confusion; here is a case where some explanation in the text is needed and not just a reference to Materials and methods.</p><p>The results presented and tools developed have important implications for behavioral analysis of chemotaxis in animals and set a standard for further mechanistic studies in this important model system. Moreover, the approach used here can be a model for analyses of sensory-motor transformations in other systems.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled “Dynamical feature extraction at the sensory periphery guides chemotaxis” for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Eve Marder (Senior editor), a Reviewing editor, and one of the original reviewers. The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>This revision meets the major expectations set down by the previous reviews. The flow of the paper now is greatly improved. All the main technical points have been resolved and the new statistical section adds significantly. There are a few minor points that should still be considered.</p><p>1) The authors belabor the description of <xref ref-type="fig" rid="fig3">Figure 3</xref>. The figure itself has too much data (3D and 3E are the only panels that are essential.). Emphasize the main point of the figure: the sensitivity of ORNs to concentration slope. Between the subsection “Characterization of the features encoded by a single larval OSN stimulated by controlled olfactory signals”, where you have concluded that linear filters won't work, and the passage, in the subsection “Phenomenlogical model of the olfactory transduction cascade”, where you start with the dynamical system approach, you lose momentum. The authors can do a better job of explaining how the qualitative observations in <xref ref-type="fig" rid="fig3">Figure 3</xref> led them to the model they built in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p><p>2) In the Discussion, or when the paper is cited, it might be appropriate to compare the approach of <xref ref-type="bibr" rid="bib76">Nagel and Wilson, 2011</xref>.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.06694.040</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>At the paragraph level the writing is clear and the paper is thoroughly illustrated, but finding the above major contributions amid the voluminous data (especially supplemental data) is difficult owing to the overall structure of the paper. Moreover the Discussion seems to focus too much on the OSN model and its implications at the expense of the biological insights for chemotaxis. The authors must be at pains to bring out these contributions in the way they structure the paper and in Abstract and Discussion.</italic> The logical flow of the techniques (tool development) and experiments and the conclusions must be made more apparent. One thing that will help immensely with flow will be to delete some of the supplemental figures on tool development or to place the call outs in Materials and methods (simply refer—no figure call outs—to Materials and methods in the Results).</p><p>We implemented this suggestion to reorganize the main text. We only kept the supporting material necessary to back up specific results. The rest of the information has now been moved to Materials and methods. As was proposed by the editor, we are now referring to Materials and methods for technical details without specific figure/section call outs.</p><p><italic>Figure 1–figure supplement 1, 2, 3 in Materials and methods</italic>.</p><p>The former Figure 1–figure supplement 1, 2 and 3 have now been moved to Materials and methods as <xref ref-type="fig" rid="fig9 fig10 fig11 fig12">Figures 9-12</xref>.</p><p><italic>Figure 2–figure supplement 1 can be eliminated, as it is a negative result</italic>.</p><p>We believe the material reported in this figure is important since it motivated the development of a biophysical model based on ODEs instead of the use of a more standard linear-nonlinear (LN) model. Showing that a LN cannot adequately reproduce the OSN spiking dynamics is a negative result that many readers may want to see. Taking the editor’s recommendation into account, we therefore moved the former Figure 2–figure supplement 1 to a figure in Materials and methods (new <xref ref-type="fig" rid="fig13">Figure 13</xref>).</p><p><italic>Figure 2–figure supplement 2 can be eliminated</italic>.</p><p>This figure has now been eliminated.</p><p><xref ref-type="fig" rid="fig4"><italic>Figure 4</italic></xref> <italic>can be made into a supplemental figure and placed in Materials and methods</italic>.</p><p>This figure has now been moved to Materials and methods (new <xref ref-type="fig" rid="fig14">Figure 14</xref>).</p><p><italic>Figure 5–figure supplement 1, 2, 5 in Materials and methods</italic>.</p><p>Figure 5–figure supplement 1 and 2 have now been moved to Materials and methods as the new <xref ref-type="fig" rid="fig15 fig16">Figures 15 and 16</xref>. We propose to keep Figure 5–figure supplement 5 in the main manuscript as it highlights that nonlinear characteristics in the response of the <italic>Or42a</italic> OSN are behaviorally relevant. This result is part of the main conclusions of the work. We therefore kept Figure 5–figure supplement 5 among the main figures of the manuscript (now labeled as <xref ref-type="fig" rid="fig5s3">Figure 5–figure supplement 3</xref>) to permit a direct reference to it.</p><p><italic>Figure 6–figure supplement 1 eliminated</italic>.</p><p>This figure has now been eliminated.</p><p><xref ref-type="fig" rid="fig8s1"><italic>Figure 8–figure supplement 1</italic></xref> <italic>in Materials and methods</italic>.</p><p>The material included in this figure provides an explanation for the differences observed in the precision of the navigational behavior elicited by the light and odor gradients. Behavioral differences are likely to arise from the spatial characteristics of each gradient rather than the processing of changes in light and odor intensities. As this point is touched on in the main text, making a direct reference to <xref ref-type="fig" rid="fig8s1">Figure 8–figure supplement 1</xref> appeared to be necessary. This figure was therefore kept in the main text.</p><p><italic>There are some technical concerns that must be addressed</italic>:</p><p><italic>1) Statistics. In Materials and methods add a statistics section and write a clear description of the statistical tests used. This is somewhat scattered throughout Materials and methods now. Much of the statistics is in tables and in the figure legends and needs to be made more apparent.</italic> <xref ref-type="fig" rid="fig6 fig8"><italic>Figures 6F and 8D, E</italic></xref> <italic>present critical statistical tests that are based on a subset of long run trajectory. The rationale and validity of excluding short runs need to be made more apparent</italic>.</p><p>Following this recommendation, we have created a new section in Materials and methods: Statistical procedures and data analysis. This section summarizes the metrics used to quantify the goodness of fit, the approaches followed to validate the models, as well as non-standard statistical tests involving physiological and behavioral data.</p><p>Regarding the previous use of subsets of runs with a duration longer than the median, we have now removed this filtering from the analysis. The rationale behind our initial focus on runs longer than a minimum duration was to reveal a strong trend on a time window preceding a turn where all runs are defined. In <xref ref-type="fig" rid="fig6 fig8">Figures 6 and 8</xref>, the predictions of the behavioral model are now plotted for the full set of runs (with a minimum duration of 1 sec). Our conclusions still hold in the absence of this filter, even though the average trend is noisier. Runs shorter than 1 sec could not be considered in the analysis since the turn probability is defined on a time bin of 1 sec.</p><p><italic>2) There is some concern about whether parameters for the models were fixed at some point or whether they were changed with each experiment. One possible reading is that the parameters of</italic> <xref ref-type="table" rid="tbl1"><italic>Table 1</italic></xref> <italic>and</italic> <xref ref-type="table" rid="tbl3"><italic>Table 3</italic></xref> <italic>represent fixed parameters based on the ‘training’ of the associated figure and that subsequent uses of the models used these fixed parameters. The authors must make this explicit. If parameters, were changed with each new experiments then this would seriously diminish the value of the modeling. Specifically, the authors' need to address the question of whether models that were trained on a set of input-output pairs generalize to an equivalent set of pairs that were not in the original training set</italic>.</p><p>We thank the editor and reviewers for raising this issue. The parameters of the neural and behavioral models are fixed once and for all in the manuscript. The parameters were not modified in an ad-hoc manner for each experimental condition. We have now clarified this point at different occasions in the main text (including the figure captions). In our opinion, it is remarkable that a behavioral model developed for open-loop optogenetic stimulations holds for closed-loop odor-driven behavior in naturalistic conditions. To further establish the quality of the neural and behavioral models, we added cross-validation tests. In <xref ref-type="fig" rid="fig4s2">Figure 4–figure supplement 2</xref> and <xref ref-type="fig" rid="fig5s2">Figure 5–figure supplement 2</xref>, we trained the model parameters on a subset of ramps (4-s linear) and successfully applied it to predict other ramps (8-s nonlinear ramps and naturalistic stimuli). These controls should address concerns about a potential overfitting of the neural and/or behavioral models.</p><p><italic>3) There is the concern that the sensory neuron model is fitted to events on a time scale of less than 10 sec (</italic><xref ref-type="fig" rid="fig2 fig3 fig4"><italic>Figure 2, 3, 4</italic></xref><italic>, etc.), whereas the dynamics of chemosensory stimuli during behavior in an odor gradient occur on a time scale of about 30 sec. The authors should acknowledge in text any difference in time scale and dynamic range between real odor time courses and the input domain over which the model was fitted</italic>.</p><p>The parameters of the neural model were trained on a dataset comprising the linear and nonlinear ramps with a characteristic time of 10 sec together with the naturalistic stimulus associated with a real trajectory (see <xref ref-type="fig" rid="fig2">Figure 2D-E</xref> for odor stimulation and <xref ref-type="fig" rid="fig6">Figure 6B</xref> for light stimulation). The naturalistic stimulus had a duration longer than 90 sec. The goodness of fit of the neural model appears to be largely insensitive to the duration of the stimulation. We have nonetheless found evidence for slow adaptation that can be (empirically) modeled by a small temporal correction of one parameter of the model (β<sub>4</sub>, see <xref ref-type="table" rid="tbl1">Table 1</xref>). This temporal correction improves the fit without being essential. The biophysical model described in <xref ref-type="fig" rid="fig4">Figure 4B</xref> is coarse-grained and one should not expect it to account for physiological processes such as long-term adaptation.</p><p>Regarding the input domain over which the model was fitted, we designed the light ramps (<xref ref-type="fig" rid="fig4">Figure 4</xref>) to match the intensity domain of the naturalistic light stimulation (<xref ref-type="fig" rid="fig6">Figure 6</xref>): both ranges between 0 and 207 W/m<sup>2</sup>. Likewise, the intensity domain of the odor ramps (<xref ref-type="fig" rid="fig3 fig4">Figures 3 and 4</xref>) and the naturalistic odor stimulus (<xref ref-type="fig" rid="fig8">Figure 8</xref>) were chosen to be comparable: 0—500 µM for the ramps and 0—120 µM for the naturalistic stimulus. Consequently, the neural models for the light and odor stimulations were trained on a dataset that included the domain over which the naturalistic patterns of stimulation were predicted.</p><p><italic>4) The odor and channelrhodopsin (ChR) experiments are done in</italic> Or83b <italic>mutant background. Thus the dynamics of</italic> Or42a<italic>-ORNs can be more easily related to behavior in an otherwise silent olfactory system. Will the same be the case in the presence of spontaneous spiking of other ORNs? Another important issue with doing behaviors in a completely silent system is that local interaction at higher levels of olfactory circuits would likely be diminished if not completely absent. Therefore OSN activity-to-turn probability transformation determined might not be representative of that in the WT animal. The authors must address this limitation forthrightly in Discussion</italic>.</p><p>To address this concern, we ran a new set of control experiments. We tested a fly cross in which channelrhodopsin (ChR2) is exclusively expressed in the <italic>Or42a</italic> olfactory sensory neuron (OSN). In this cross, olfactory function was retained in the 21 OSNs. To avoid photophobic behavior, we used a double-blind background involving the <italic>dTrpA1</italic><sup><italic>1</italic></sup> and <italic>glass</italic><sup><italic>60j</italic></sup> mutant alleles. In <xref ref-type="fig" rid="fig18">Figure 18</xref>, we report the strong similarity in the sensorimotor modulation observed for a linear ramp whether light was activating the <italic>Or42a</italic> OSN in the background of only 1 or 21 functional OSNs. In addition, we show that larvae with 21 functional OSNs are capable of robust chemotaxis in a light gradient. Although the antennal lobe is expected to contribute to the processing of the information mediated by <italic>Or42a</italic> OSN, this transformation does not appear to significantly influence the types of behavioral responses considered in the present manuscript.</p><p><italic>5) The logit transform of the equation in</italic> <xref ref-type="fig" rid="fig5"><italic>Figure 5D</italic></xref> <italic>caused some reviewer confusion; here is a case where some explanation in the text is needed and not just a reference to Materials and methods</italic>.</p><p>In the revised manuscript, we have now introduced the logit transformation more extensively in the main text. Furthermore, we have added <xref ref-type="fig" rid="fig17">Figure 17</xref> in the Materials and methods section where the reader can compare the goodness of fit of the GLM with and without the contribution of the logit transformation.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p><italic>1) The authors belabor the description of</italic> <xref ref-type="fig" rid="fig3"><italic>Figure 3</italic></xref><italic>. The figure itself has too much data (3D and 3E are the only panels that are essential.). Emphasize the main point of the figure: the sensitivity of ORNs to concentration slope</italic>.</p><p>Following this advice, we have simplified <xref ref-type="fig" rid="fig3">Figure 3</xref> by removing the previous panels A and B. The dose-response shown in panel A is nonetheless important because (1) it further establishes the similarity in response dynamics of larval and adult-fly OSNs; (2) it validates the IFF+IFB model. We have therefore moved the dose-response curve from <xref ref-type="fig" rid="fig3">Figure 3</xref> to <xref ref-type="fig" rid="fig3s1">Figure 3–figure supplement 1</xref>.</p><p><italic>Between the subsection “Characterization of the features encoded by a single larval OSN stimulated by controlled olfactory signals”, where you have concluded that linear filters won't work, and the passage, in the subsection “Phenomenlogical model of the olfactory transduction cascade”, where you start with the dynamical system approach, you lose momentum</italic>.</p><p>We have changed the text and inverted the order of presentation of the features encoded by the <italic>Or42a</italic> OSN and the results of the linear filter.</p><p><italic>The authors can do a better job of explaining how the qualitative observations in</italic> <xref ref-type="fig" rid="fig3"><italic>Figure 3</italic></xref> <italic>led them to the model they built in</italic> <xref ref-type="fig" rid="fig4"><italic>Figure 4</italic></xref>.</p><p>The presentation of the OSN model now begins with the introduction of the integral feedback and incoherent feed-forward motifs. These two motifs were considered because of (1) their involvement in olfactory transduction in other model systems and (2) the nonlinear dynamics they could generate. We refrained from commenting on the specific design of the ODE equations as it would require technical considerations that would break the flow of the main text. A detailed description of the ODE model can be found in the Materials and methods (section: Incoherent feed-forward (IFF) and integral feedback (IFB) motifs).</p><p><italic>2) In the Discussion, or when the paper is cited, it might be appropriate to compare the approach of</italic> <xref ref-type="bibr" rid="bib76"><italic>Nagel and Wilson, 2011</italic></xref>.</p><p>We have added a (brief) description of the approach used by Nagel and Wilson, together with the main findings reported in their paper. Throughout the text, about 10 references are now made to this paper.</p></body></sub-article></article>