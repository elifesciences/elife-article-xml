<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">81692</article-id><article-id pub-id-type="doi">10.7554/eLife.81692</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Dynamics of immune memory and learning in bacterial communities</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-105918"><name><surname>Bonsma-Fisher</surname><given-names>Madeleine</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5813-4664</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-17744"><name><surname>Goyal</surname><given-names>Sidhartha</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7452-892X</contrib-id><email>goyal@physics.utoronto.ca</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>Department of Physics, University of Toronto</institution></institution-wrap><addr-line><named-content content-type="city">Toronto</named-content></addr-line><country>Canada</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>Institute of Biomaterials &amp; Biomedical Engineering, University of Toronto</institution></institution-wrap><addr-line><named-content content-type="city">Toronto</named-content></addr-line><country>Canada</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bitbol</surname><given-names>Anne-Florence</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s376052</institution-id><institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution></institution-wrap><country>Switzerland</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03a26mh11</institution-id><institution>CNRS LPENS</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>16</day><month>01</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e81692</elocation-id><history><date date-type="received" iso-8601-date="2022-07-07"><day>07</day><month>07</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-01-15"><day>15</day><month>01</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-07-07"><day>07</day><month>07</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.07.07.498272"/></event></pub-history><permissions><copyright-statement>© 2023, Bonsma-Fisher and Goyal</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Bonsma-Fisher and Goyal</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-81692-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-81692-figures-v2.pdf"/><abstract><p>From bacteria to humans, adaptive immune systems provide learned memories of past infections. Despite their vast biological differences, adaptive immunity shares features from microbes to vertebrates such as emergent immune diversity, long-term coexistence of hosts and pathogens, and fitness pressures from evolving pathogens and adapting hosts, yet there is no conceptual model that addresses all of these together. To this end, we propose and solve a simple phenomenological model of CRISPR-based adaptive immunity in microbes. We show that in coexisting phage and bacteria populations, immune diversity in both populations is coupled and emerges spontaneously, that bacteria track phage evolution with a context-dependent lag, and that high levels of diversity are paradoxically linked to low overall CRISPR immunity. We define average immunity, an important summary parameter predicted by our model, and use it to perform synthetic time-shift analyses on available experimental data to reveal different modalities of coevolution. Finally, immune cross-reactivity in our model leads to qualitatively different states of evolutionary dynamics, including an influenza-like traveling wave regime that resembles a similar state in models of vertebrate adaptive immunity. Our results show that CRISPR immunity provides a tractable model, both theoretically and experimentally, to understand general features of adaptive immunity.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd><italic>S. thermophilus</italic></kwd><kwd>CRISPR</kwd><kwd>bacteriophage</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id><institution>Natural Sciences and Engineering Research Council of Canada</institution></institution-wrap></funding-source><award-id>Vanier Canada Graduate Scholarship</award-id><principal-award-recipient><name><surname>Bonsma-Fisher</surname><given-names>Madeleine</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100021784</institution-id><institution>Ministry of Colleges and Universities</institution></institution-wrap></funding-source><award-id>Queen Elizabeth II Graduate Scholarship in Science &amp; Technology</award-id><principal-award-recipient><name><surname>Bonsma-Fisher</surname><given-names>Madeleine</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution>Walter C. Sumner Foundation</institution></institution-wrap></funding-source><award-id>Walter C. Sumner Memorial Fellowship</award-id><principal-award-recipient><name><surname>Bonsma-Fisher</surname><given-names>Madeleine</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id><institution>Natural Sciences and Engineering Research Council of Canada</institution></institution-wrap></funding-source><award-id>Discovery Grant RGPIN-2015</award-id><principal-award-recipient><name><surname>Goyal</surname><given-names>Sidhartha</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id><institution>Natural Sciences and Engineering Research Council of Canada</institution></institution-wrap></funding-source><award-id>Discovery Grant and RGPIN-2021</award-id><principal-award-recipient><name><surname>Goyal</surname><given-names>Sidhartha</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Bacterial CRISPR immunity tracks phage mutations, creating immune diversity in bacterial populations that parallels phage genetic diversity and patterns of phage evolution that are determined by the type and degree of immune cross-reactivity in the CRISPR system.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Adaptive immunity equips organisms to survive changing pathogen attacks across their lifetime. Many diverse organisms from bacteria to humans possess adaptive immune systems, and their presence shapes the survival, diversity, and evolution of both hosts and pathogens. How adaptive immunity changes the landscape of host-pathogen coexistence, how immune diversity emerges and evolves, and how the pressures of evolving pathogens and adaptive immunity are coupled to produce unique evolutionary outcomes: all of these factors are of fundamental importance to understanding the role of adaptive immunity in populations.</p><p>These questions have naturally been explored in the vertebrate adaptive immune system, which protects humans and other vertebrates from evolving pathogens. In these organisms, a diverse repertoire of T cell and B cell receptors can rapidly recognize and respond to a wide range of threats. Immune specificity is determined by the unique genetic sequence of each cell’s receptor, and individuals may harbour millions to billions of unique sequences distributed across four or more orders of magnitude of abundance (<xref ref-type="bibr" rid="bib35">Desponds et al., 2016</xref>; <xref ref-type="bibr" rid="bib99">Mora and Walczak, 2019</xref>; <xref ref-type="bibr" rid="bib30">de Greef et al., 2020</xref>). Quantitative frameworks to model immune diversity and clone abundance have revealed that simple low-level interactions can give rise to complex outcomes including broad distributions of clone abundance (<xref ref-type="bibr" rid="bib35">Desponds et al., 2016</xref>; <xref ref-type="bibr" rid="bib99">Mora and Walczak, 2019</xref>; <xref ref-type="bibr" rid="bib30">de Greef et al., 2020</xref>; <xref ref-type="bibr" rid="bib90">Mayer et al., 2015</xref>; <xref ref-type="bibr" rid="bib47">Gaimann et al., 2020</xref>; <xref ref-type="bibr" rid="bib36">Dessalles et al., 2022</xref>), long-lived biologically realistic transient states (<xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>; <xref ref-type="bibr" rid="bib47">Gaimann et al., 2020</xref>), and clonal restructuring following immune challenges (<xref ref-type="bibr" rid="bib26">Childs et al., 2015</xref>; <xref ref-type="bibr" rid="bib109">Puelma Touzel et al., 2020</xref>; <xref ref-type="bibr" rid="bib116">Sachdeva et al., 2020</xref>; <xref ref-type="bibr" rid="bib96">Molari et al., 2020</xref>; <xref ref-type="bibr" rid="bib47">Gaimann et al., 2020</xref>). Phenomenological models of pathogen coevolution with the immune system have accelerated our understanding of how the fitness landscape generated by the immune system constrains pathogen evolution (<xref ref-type="bibr" rid="bib85">Luksza and Lässig, 2014</xref>; <xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref>; <xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>; <xref ref-type="bibr" rid="bib118">Schnaack and Nourmohammad, 2021</xref>; <xref ref-type="bibr" rid="bib22">Chardès et al., 2022</xref>), how the adaptive immune system responds to rapid pathogen evolution (<xref ref-type="bibr" rid="bib136">Wang et al., 2015</xref>; <xref ref-type="bibr" rid="bib102">Nourmohammad et al., 2019</xref>; <xref ref-type="bibr" rid="bib118">Schnaack and Nourmohammad, 2021</xref>; <xref ref-type="bibr" rid="bib22">Chardès et al., 2022</xref>), and what drives pathogen extinction (<xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>; <xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref> or the extinction of particular clonal cell lineages <xref ref-type="bibr" rid="bib102">Nourmohammad et al., 2019</xref>; <xref ref-type="bibr" rid="bib116">Sachdeva et al., 2020</xref>). These models have also explored trade-offs such as between immune receptor specificity and cross-reactivity (<xref ref-type="bibr" rid="bib90">Mayer et al., 2015</xref>; <xref ref-type="bibr" rid="bib101">Nourmohammad et al., 2016</xref>), between the specificity of host-pathogen discrimination and sensitivity to pathogens (<xref ref-type="bibr" rid="bib26">Childs et al., 2015</xref>; <xref ref-type="bibr" rid="bib43">Downie et al., 2021</xref>; <xref ref-type="bibr" rid="bib93">Metcalf et al., 2017</xref>), between the speed of an immune response and the efficiency of that response (<xref ref-type="bibr" rid="bib118">Schnaack and Nourmohammad, 2021</xref>), or between metabolic resource use and immune coverage (<xref ref-type="bibr" rid="bib22">Chardès et al., 2022</xref>). All of these models have shown rich dynamics and qualitatively different states of diversity and evolution arising from simple rules. However, experiments in vertebrates are difficult: vertebrate immunity depends on a complex interplay of many cell types and experiments are time-consuming because of long generation times (<xref ref-type="bibr" rid="bib2">Altan-Bonnet et al., 2020</xref>).</p><p>Adaptive immunity in microbes is realized through the CRISPR system, conceptually related to the vertebrate adaptive immune system. The CRISPR system is functionally simple, yet it is incredibly powerful, as indicated by its widespread presence in many diverse bacteria and archaea <xref ref-type="bibr" rid="bib75">Koonin and Makarova, 2019</xref> and its experimentally demonstrated ability to provide strong immunity against phages (<xref ref-type="bibr" rid="bib103">Paez-Espino et al., 2013</xref>; <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>; <xref ref-type="bibr" rid="bib131">van Houte et al., 2016</xref>; <xref ref-type="bibr" rid="bib8">Bondy-Denomy et al., 2013</xref>). Attacking phages expose their DNA to bacteria, and bacteria with a CRISPR immune system acquire small segments of phage DNA, called spacers. They store spacers in their genome and use them to recognize and destroy matching phage sequences in future infections: spacers are transcribed into RNA and guide DNA-cleaving CRISPR-associated proteins to recognize and cut re-infecting phages. Spacers provide a highly specific immune memory of infecting phages, preventing recognized phages from reproducing. In turn, phages can acquire mutations in the protospacer regions of their genome that are targeted by spacers. These features of the CRISPR immune system mean that (a) phage genetic evolution occurs by selection for escape mutants, and (b) the network of CRISPR immune interactions between bacteria and phages can be inferred by sequencing the genomes of co-living bacteria and phages. Spacer acquisition and phage mutation are rare random events, and many such events must be observed in order to understand their impact on populations. Bacteria and phages have short life cycles and can reach large population size, making it possible to build a statistical picture of the impacts of adaptive immunity.</p><p>The kinetics and interactions of phages and bacteria with CRISPR systems have been the subject of numerous experiments (<xref ref-type="bibr" rid="bib131">van Houte et al., 2016</xref>; <xref ref-type="bibr" rid="bib27">Common et al., 2019</xref>; <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>; <xref ref-type="bibr" rid="bib20">Chabas et al., 2021</xref>; <xref ref-type="bibr" rid="bib41">Dimitriu et al., 2022</xref>; <xref ref-type="bibr" rid="bib53">Guillemet et al., 2021</xref>). Some themes have emerged from experimental studies of CRISPR immunity: (a) high spacer diversity relative to phage diversity increases the likelihood of phage extinction (<xref ref-type="bibr" rid="bib131">van Houte et al., 2016</xref>; <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>; <xref ref-type="bibr" rid="bib53">Guillemet et al., 2021</xref>), (b) bacteria become more immune to phages over time (<xref ref-type="bibr" rid="bib79">Laanto et al., 2017</xref>; <xref ref-type="bibr" rid="bib100">Morley et al., 2017</xref>; <xref ref-type="bibr" rid="bib27">Common et al., 2019</xref>; <xref ref-type="bibr" rid="bib111">Pyenson and Marraffini, 2020</xref>), and (c) phages readily gain mutations (<xref ref-type="bibr" rid="bib139">Weinberger et al., 2012a</xref>; <xref ref-type="bibr" rid="bib103">Paez-Espino et al., 2013</xref>; <xref ref-type="bibr" rid="bib82">Levin et al., 2013</xref>; <xref ref-type="bibr" rid="bib110">Pyenson et al., 2017</xref>; <xref ref-type="bibr" rid="bib137">Watson et al., 2019</xref>; <xref ref-type="bibr" rid="bib111">Pyenson and Marraffini, 2020</xref>; <xref ref-type="bibr" rid="bib53">Guillemet et al., 2021</xref>; <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>) and sometimes genome rearrangements (<xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>) to escape CRISPR targeting. Explorations of CRISPR immunity in natural environments have also documented ongoing spacer acquisition and phage escape mutations (<xref ref-type="bibr" rid="bib139">Weinberger et al., 2012a</xref>; <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>). Likewise, previous theoretical work has addressed the impact of parameters such as spacer acquisition rate and phage mutation rate on spacer diversity (<xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref>; <xref ref-type="bibr" rid="bib58">Han et al., 2013</xref>; <xref ref-type="bibr" rid="bib59">Han and Deem, 2017</xref>) and population survival and extinction (<xref ref-type="bibr" rid="bib140">Weinberger et al., 2012b</xref>), how costs of CRISPR immunity impact bacteria-phage coexistence (<xref ref-type="bibr" rid="bib123">Skanata and Kussell, 2021</xref>) and the maintenance of CRISPR immunity (<xref ref-type="bibr" rid="bib81">Levin, 2010</xref>; <xref ref-type="bibr" rid="bib140">Weinberger et al., 2012b</xref>; <xref ref-type="bibr" rid="bib145">Westra et al., 2015</xref>; <xref ref-type="bibr" rid="bib54">Gurney et al., 2019</xref>), how spacer diversity impacts population outcomes (<xref ref-type="bibr" rid="bib61">He and Deem, 2010</xref>; <xref ref-type="bibr" rid="bib139">Weinberger et al., 2012a</xref>; <xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref>; <xref ref-type="bibr" rid="bib56">Haerter and Sneppen, 2012</xref>; <xref ref-type="bibr" rid="bib58">Han et al., 2013</xref>; <xref ref-type="bibr" rid="bib25">Childs et al., 2014</xref>; <xref ref-type="bibr" rid="bib11">Bradde et al., 2017</xref>; <xref ref-type="bibr" rid="bib59">Han and Deem, 2017</xref>), and how stochasticity and initial conditions impact population survival (<xref ref-type="bibr" rid="bib12">Bradde et al., 2019</xref>; <xref ref-type="bibr" rid="bib19">Chabas et al., 2018</xref>). Notably, foundational work by <xref ref-type="bibr" rid="bib25">Childs et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref> and <xref ref-type="bibr" rid="bib139">Weinberger et al., 2012a</xref>; <xref ref-type="bibr" rid="bib140">Weinberger et al., 2012b</xref> found through simulations that spacer diversity readily emerges in a population of CRISPR-competent bacteria interacting with mutating phages.</p><p>However, the majority of both experiments and theory are based on observations and models of transient phenomena and short-term dynamics, while it is at long timescales that natural microbial communities experience bacteria-phage coexistence. Some notable experiments have measured long-term coexistence (<xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>; <xref ref-type="bibr" rid="bib138">Wei et al., 2011</xref>), and long-term sequential sequencing data from natural populations is becoming more available (<xref ref-type="bibr" rid="bib50">Gómez and Buckling, 2011</xref>; <xref ref-type="bibr" rid="bib15">Burstein et al., 2016</xref>), but appropriate theories to understand steady-state coexistence, sequence evolution and turnover, and immune memory in microbial populations remain rare. Because the processes of growth, death, and immune interaction are inherently random, understanding population establishment and extinction requires a fully stochastic analysis, and theoretical models that explore long-term coexistence have been partially deterministic to date (<xref ref-type="bibr" rid="bib139">Weinberger et al., 2012a</xref>; <xref ref-type="bibr" rid="bib140">Weinberger et al., 2012b</xref>; <xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref>; <xref ref-type="bibr" rid="bib82">Levin et al., 2013</xref>; <xref ref-type="bibr" rid="bib25">Childs et al., 2014</xref>; <xref ref-type="bibr" rid="bib117">Santos et al., 2014</xref>; <xref ref-type="bibr" rid="bib141">Weissman et al., 2018</xref>; <xref ref-type="bibr" rid="bib54">Gurney et al., 2019</xref>). These models do not accurately capture rare stochastic events, in particular mutation, establishment, and extinction. Notable fully stochastic simulations of CRISPR immunity, on the other hand, have lacked rigorous analytic results (<xref ref-type="bibr" rid="bib58">Han et al., 2013</xref>; <xref ref-type="bibr" rid="bib59">Han and Deem, 2017</xref>).</p><p>To understand the emergent properties of immune memory and diversity in microbial populations and how phages and bacteria coexist long-term, we developed a simple theoretical model of bacteria and phages interacting with adaptive immunity. We model a population of bacteria with CRISPR immune systems interacting with phages that can mutate to escape CRISPR targeting, building on our previous work that assumed a clonal population of phages with multiple protospacers in each phage (<xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>). We model phages with single protospacers in this work to efficiently track mutations in large populations over long timescales. We stochastically simulate thousands of bacteria-phage populations across a range of population sizes, spacer acquisition rates, spacer effectiveness rates, and phage mutation rates, and derive analytic expressions for the probability of establishment for new phage mutants, the time to extinction for phage and bacterial clones, and the dependence of bacterial spacer diversity on spacer acquisition rate, effectiveness, and phage mutation rate. Our simulations are fully stochastic and run for many thousands of generations to accurately capture the dynamics of establishment and extinction, yet the underlying model is simple enough to solve analytically. We show that even with the simplest assumptions of uniform spacer acquisition and effectiveness, complex dynamics and a wide range of outcomes of diversity and population structure are possible. We recover and reinterpret experimentally observed feaures: (a) we find that high diversity is not beneficial for bacteria when phage and bacterial diversity is strongly coupled, (b) we show that bacterial immunity can either track new phage mutations rapidly or keep a memory for a long time, but not both, and (c) we find emergent diversity resulting from selection for phage mutations that evade CRISPR targeting, linking diversity to the dynamical quantities of establishment and extinction. We compute bacterial average immunity in our simulations and in available experimental data and show that our model predicts qualitative trends that are visible in data. Finally, we show that adding immune cross-reactivity leads to qualitatively different states of evolutionary dynamics: (a) a traveling wave regime that resembles a similar state in models of vertebrate adaptive immunity (<xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>; <xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref>; <xref ref-type="bibr" rid="bib88">Marchi et al., 2021</xref>) emerges when high cross-reactivity creates a fitness gradient for phage evolution, and (2) a regime of low turnover protected from new establishment by the reduced fitness of new phage mutants.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Bacteria and phages dynamically coexist and coevolve</title><p>We model bacteria and phage interacting and coevolving in a well-mixed system (<xref ref-type="fig" rid="fig1">Figure 1A</xref> and ‘Model’). Bacteria divide by consuming nutrients and phages reproduce by creating a burst of <inline-formula><mml:math id="inf1"><mml:mi>B</mml:mi></mml:math></inline-formula> new phages after successfully infecting a bacterium. Bacteria can contain a single CRISPR spacer that confers immunity against phages with a matching protospacer. Phages are labelled with a single protospacer type, a binary sequence of length <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> that can mutate to a new type during a burst with probability <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf4"><mml:mi>μ</mml:mi></mml:math></inline-formula> is the per-base mutation rate per generation. All simulations begin with a single clonal phage population unless otherwise specified.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Model description.</title><p>(<bold>A</bold>) We model bacteria and phages interacting in a well-mixed vessel. We track nutrient concentration, phage population size (<inline-formula><mml:math id="inf5"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>), and bacteria population size (<inline-formula><mml:math id="inf6"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>). Bacteria can either have no spacer (<inline-formula><mml:math id="inf7"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula>) or a spacer of type <inline-formula><mml:math id="inf8"><mml:mi>i</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf9"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf10"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>), and phages can have a single protospacer of type <inline-formula><mml:math id="inf11"><mml:mi>j</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf12"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:math></inline-formula>). With rate <inline-formula><mml:math id="inf13"><mml:mi>α</mml:mi></mml:math></inline-formula>, a phage interacts with a bacterium. If the bacterium does not have a matching spacer, the phage kills with probability <inline-formula><mml:math id="inf14"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> and produces a burst of <inline-formula><mml:math id="inf15"><mml:mi>B</mml:mi></mml:math></inline-formula> new phages, while for bacteria with a matching spacer that probability is reduced to <inline-formula><mml:math id="inf16"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>V</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf17"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>e</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Bacteria without spacers that survive an attack have a chance to acquire a spacer with probability <inline-formula><mml:math id="inf18"><mml:mi>η</mml:mi></mml:math></inline-formula>, and bacteria with spacers lose them at rate <inline-formula><mml:math id="inf19"><mml:mi>r</mml:mi></mml:math></inline-formula>. Lower inset: average immunity is the weighted average pairwise immunity between spacer-containing bacteria and phages, given by <inline-formula><mml:math id="inf20"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. The probability of a phage with protospacer <inline-formula><mml:math id="inf21"><mml:mi>j</mml:mi></mml:math></inline-formula> successfully infecting a bacterium with spacer <inline-formula><mml:math id="inf22"><mml:mi>i</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) Three time points in a typical simulation with <inline-formula><mml:math id="inf24"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf25"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Coloured circles represent unique protospacer or spacer sequences; shared sequences are shown with the same colour. The size of each circle is proportional to clone size, and new mutants are shown radially more distant from the centre. (<bold>C</bold>) Ten individual clone trajectories vs simulation time for phages (top) and bacteria (bottom). The mean clone size is shown with a horizontal dashed line. (<bold>D</bold>) Total phage, bacteria, and nutrient concentration as a function of phage success probability <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>. Markers show an average over five independent simulations for different values of <inline-formula><mml:math id="inf29"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> with <inline-formula><mml:math id="inf30"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Solid lines show theoretical predictions for different constant values of effective <inline-formula><mml:math id="inf32"><mml:mi>e</mml:mi></mml:math></inline-formula>. As <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> decreases, phages go extinct at a critical value given by <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. (<bold>E</bold>) Total phage and bacteria population size as a function of average bacterial immunity to phages. Colours indicate the fraction of simulations in which phage or bacteria go extinct before a set endpoint. Solid lines show the mean-field prediction. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Probability of stochastic extinction at low spacer acquisition.</title><p>Probability of extinction in four or more simulations with the same parameters vs. mean phage population size (left) and mean bacteria population size (right) for the lowest value of spacer acquisition probability (<inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). Colours indicate mutation rate <inline-formula><mml:math id="inf37"><mml:mi>μ</mml:mi></mml:math></inline-formula> and shapes indicate CRISPR effectiveness <inline-formula><mml:math id="inf38"><mml:mi>e</mml:mi></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Probability of stochastic extinction at high spacer acquisition.</title><p>Probability of extinction in four or more simulations with the same parameters vs. mean phage population size (left) and mean bacteria population size (right) for the highest value of spacer acquisition probability (<inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). Colours indicate mutation rate <inline-formula><mml:math id="inf40"><mml:mi>μ</mml:mi></mml:math></inline-formula> and shapes indicate CRISPR effectiveness <inline-formula><mml:math id="inf41"><mml:mi>e</mml:mi></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Time to extinction for phages vs. mutation rate.</title><p>Mean time for the phage population to go extinct vs. phage mutation rate <inline-formula><mml:math id="inf42"><mml:mi>μ</mml:mi></mml:math></inline-formula> across simulations where at least one simulation experienced phage extinction. The darkness of each point indicates the fraction of simulations that went extinct with darkest colours representing all simulations extinct. Simulations are shown for <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig1-figsupp3-v2.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Time to extinction for bacteria vs. mutation rate.</title><p>Mean time for the bacteria population to go extinct vs. phage mutation rate <inline-formula><mml:math id="inf44"><mml:mi>μ</mml:mi></mml:math></inline-formula> across simulations where at least one simulation experienced bacteria extinction. The darkness of each point indicates the fraction of simulations that went extinct with darkest colours representing all simulations extinct. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig1-figsupp4-v2.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 5.</label><caption><title>Time to extinction for phages for different initial diversity and low spacer acquisition.</title><p>Mean time for the phage population to go extinct vs. phage mutation rate <inline-formula><mml:math id="inf45"><mml:mi>μ</mml:mi></mml:math></inline-formula> across simulations where at least one simulation experienced phage extinction. The darkness of each point indicates the fraction of simulations that went extinct with darkest colours representing all simulations extinct. Colours represent number of initial phage clones <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Simulations are shown for <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf48"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig1-figsupp5-v2.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 6.</label><caption><title>Time to extinction for phages for different initial diversity and high spacer acquisition.</title><p>Mean time for the phage population to go extinct vs. phage mutation rate <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> across simulations where at least one simulation experienced phage extinction. The darkness of each point indicates the fraction of simulations that went extinct with darkest colours representing all simulations extinct. Colours represent number of initial phage clones <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Simulations are shown for <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf52"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig1-figsupp6-v2.tif"/></fig><media mimetype="video" mime-subtype="mp4" xlink:href="elife-81692-fig1-video1.mp4" id="fig1video1"><label>Figure 1—video 1.</label><caption><title>An animation of a typical simulation of bacteria and phages interacting with CRISPR immunity.</title><p>Each bacteria can have a single spacer, indicated by colour, and each phage has a single protospacer sequence. Matching sequences are shown with the same colour. The size of each circle is proportional to clone size, and new mutants are shown radially more distant from the centre. New phages appear by mutation over time; many of them go extinct, but some establish and grow large, and then bacteria acquire matching spacers.</p></caption></media></fig-group><p>Coexistence occurs across a wide range of parameters but is not guaranteed: below a certain success probability <inline-formula><mml:math id="inf53"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, phages are not able to reproduce often enough to overcome their base death rate due to outflow and adsorption and are driven extinct (grey area of <xref ref-type="fig" rid="fig1">Figure 1D</xref>; <xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>). In this expression, <inline-formula><mml:math id="inf54"><mml:mi>g</mml:mi></mml:math></inline-formula> is the bacterial growth rate, <inline-formula><mml:math id="inf55"><mml:mi>B</mml:mi></mml:math></inline-formula> is the phage burst size, <inline-formula><mml:math id="inf56"><mml:mi>α</mml:mi></mml:math></inline-formula> is the phage adsorption rate, <inline-formula><mml:math id="inf57"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is a normalized outflow rate, and <italic>C</italic><sub>0</sub> is the inflow nutrient concentration. This is the same extinction threshold reported by <xref ref-type="bibr" rid="bib106">Payne et al., 2018</xref> as the cutoff for achieving herd immunity in a well-mixed bacterial population. To a first approximation, phages must successfully infect every <inline-formula><mml:math id="inf58"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> bacteria they encounter, but if bacteria are growing quickly, then phages must do better to overcome bacterial growth, leading to the extra terms in this expression (see ‘Phage extinction threshold’). We write this extinction threshold as <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Above the phage extinction threshold (<inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), the phage population size increases with increasing <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> but eventually decreases again as bacterial numbers are driven too low to support a large phage population (<xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>). A similar non-monotonicity as a function of the probability of naive bacterial resistance (<inline-formula><mml:math id="inf62"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) was described in theoretical work by <xref ref-type="bibr" rid="bib140">Weinberger et al., 2012b</xref>. In our model the position of the peak in phage population size as a function of infection success probability is determined by <inline-formula><mml:math id="inf63"><mml:mi>e</mml:mi></mml:math></inline-formula>, the effectiveness of CRISPR spacers against phage; increasing <inline-formula><mml:math id="inf64"><mml:mi>e</mml:mi></mml:math></inline-formula> pushes the peak to higher <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). While <inline-formula><mml:math id="inf66"><mml:mi>e</mml:mi></mml:math></inline-formula> is a constant parameter that determines the outcome of pairwise interactions between bacteria and phages, the bacterial population as a whole possesses an average immunity to phages that is a weighted average of all the possible pairwise interactions (<xref ref-type="fig" rid="fig1">Figure 1A</xref> inset). It is the overall average immunity that determines population outcomes, which we describe in detail in ‘Pathogen and host diversity must be considered together’.</p><p>To focus on regimes where bacteria and phages coexist, we select parameters within the deterministic coexistence regime to explore bacteria-phage coevolution. Even in this regime, stochastic extinction will eventually come for one or both populations in simulations (<xref ref-type="fig" rid="fig1">Figure 1E</xref>), though the timescale of extinction may be extremely long for large population sizes (<xref ref-type="bibr" rid="bib3">Badali and Zilman, 2020</xref>). Phages are more susceptible to stochastic extinction than bacteria because of their large burst size <inline-formula><mml:math id="inf67"><mml:mi>B</mml:mi></mml:math></inline-formula> which increases their overall population fluctuations (Appendix 3). The length of coexistence before stochastic extinction depends on population size as well as simulation parameters and initial conditions (see ‘Stochastic population extinction’): phage populations can be rescued from extinction by high mutation rate (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>) or high initial protospacer diversity (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>), but are more likely to go extinct if spacer effectiveness is high (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Conversely, bacteria are more likely to go extinct if spacer effectiveness or spacer acquisition rate are low (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). Population survival and persistence in natural populations is impacted by additional factors we do not address in our model, including immigration (<xref ref-type="bibr" rid="bib135">Volkov et al., 2003</xref>; <xref ref-type="bibr" rid="bib18">Chabas et al., 2016</xref>, niche partitioning <xref ref-type="bibr" rid="bib121">Simek et al., 2010</xref>; <xref ref-type="bibr" rid="bib144">Weitz et al., 2013</xref>; <xref ref-type="bibr" rid="bib94">Mills et al., 2013</xref>; <xref ref-type="bibr" rid="bib3">Badali and Zilman, 2020</xref>; <xref ref-type="bibr" rid="bib134">Voigt et al., 2021</xref>), environmental fluctuations (<xref ref-type="bibr" rid="bib1">Abreu et al., 2020</xref>; <xref ref-type="bibr" rid="bib134">Voigt et al., 2021</xref>), and spatial structure (<xref ref-type="bibr" rid="bib55">Haerter et al., 2011</xref>; <xref ref-type="bibr" rid="bib56">Haerter and Sneppen, 2012</xref>; <xref ref-type="bibr" rid="bib62">Heilmann et al., 2010</xref>; <xref ref-type="bibr" rid="bib63">Heilmann et al., 2012</xref>; <xref ref-type="bibr" rid="bib122">Simmons et al., 2018</xref>; <xref ref-type="bibr" rid="bib123">Skanata and Kussell, 2021</xref>).</p><p>Across a wide range of coexistence parameters, our simulations show continual phage evolution and bacterial CRISPR adaptation in response (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). New phage protospacer clones arise from a single founding clone by mutation, and a small fraction of new mutants grow to a large size and become established. Once phage clones become large, bacteria acquire matching spacers and an immune bacterial subpopulation becomes established. The specific protospacer and spacer types present in the population continually change as old types go extinct and new types are created by phage mutation, but the average total diversity and average overlap between bacteria and phage remains constant at steady state (Figure 8). Both bacteria and phage clones stochastically go extinct, completing the life cycle of a clonal population (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).</p></sec><sec id="s2-2"><title>Phages drive stable emergent sequence diversity</title><p>New phage protospacer clones continually arise and go extinct in our simulations, generating turnover in clone identity in the population. Despite constant turnover, however, the total number of clones remains fixed at steady state. We use the mean number of bacterial clones at steady state, designated <inline-formula><mml:math id="inf68"><mml:mi>m</mml:mi></mml:math></inline-formula>, as a measure of system diversity. This choice of diversity measurement is equivalent to the Hartley entropy of the clone size distribution, a special case of the Rényi entropy (<xref ref-type="bibr" rid="bib98">Mora and Walczak, 2016</xref>; <xref ref-type="bibr" rid="bib2">Altan-Bonnet et al., 2020</xref>). This definition weights all clones equally regardless of their abundance; such a measurement is not appropriate when clone size distributions are very broad and small clones may be unsampled, but is reasonable when clone size distributions are relatively narrow and all clones are sampled (<xref ref-type="bibr" rid="bib98">Mora and Walczak, 2016</xref>). In our simulation results, both bacteria and phage populations exhibit relatively narrow clone size distributions across a range of parameters, with the exception of low values of spacer acquisition <inline-formula><mml:math id="inf69"><mml:mi>η</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). Even at low <inline-formula><mml:math id="inf70"><mml:mi>η</mml:mi></mml:math></inline-formula>, however, clone size distributions are approximately exponential, indicating that they are not scale-invariant and that the mean clone size still captures important information about the full clone size distribution.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Diversity depends sub-linearly on parameters.</title><p>(<bold>A</bold>) Bacteria and phage clone size distributions normalized to the measured mean clone size for <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. As <inline-formula><mml:math id="inf74"><mml:mi>η</mml:mi></mml:math></inline-formula> increases, both clone size distributions become more sharply peaked. (<bold>B</bold>) The mean number of bacterial clones depends only on a combined parameter in the limit of small average immunity (generally coinciding with high <italic>C</italic><sub>0</sub>). (Inset) The mean number of bacterial clones can be predicted by numerically solving <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> for <inline-formula><mml:math id="inf75"><mml:mi>m</mml:mi></mml:math></inline-formula>. The two lowest values of <inline-formula><mml:math id="inf76"><mml:mi>η</mml:mi></mml:math></inline-formula> are shown with lighter shading. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Predicted diversity grouped by spacer effectiveness.</title><p>Simulation mean number of bacteria clones (<inline-formula><mml:math id="inf77"><mml:mi>m</mml:mi></mml:math></inline-formula>) vs. theoretical prediction for <inline-formula><mml:math id="inf78"><mml:mi>m</mml:mi></mml:math></inline-formula> given by numerically solving <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, broken down by different values of <inline-formula><mml:math id="inf79"><mml:mi>e</mml:mi></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Predicted diversity grouped by mutation rate.</title><p>Simulation mean number of bacteria clones (<inline-formula><mml:math id="inf80"><mml:mi>m</mml:mi></mml:math></inline-formula>) vs. theoretical prediction for <inline-formula><mml:math id="inf81"><mml:mi>m</mml:mi></mml:math></inline-formula> given by numerically solving <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, broken down by different values of <inline-formula><mml:math id="inf82"><mml:mi>μ</mml:mi></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Clone size histograms by spacer effectiveness.</title><p>Bacteria and phage clone size distributions normalized to the measured mean clone size for <inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf84"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf85"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Clone size histograms by phage mutation rate.</title><p>Bacteria and phage clone size distributions normalized to the measured mean clone size for <inline-formula><mml:math id="inf86"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf88"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig2-figsupp4-v2.tif"/></fig></fig-group><p>What determines clonal diversity? Many factors that correlate with transient diversity have been experimentally identified, such as phage extinction and slower phage evolution at high bacterial spacer diversity (<xref ref-type="bibr" rid="bib131">van Houte et al., 2016</xref>; <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>) and maintenance of a diverse bacterial population when exposed to diverse phages (<xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Common et al., 2019</xref>; <xref ref-type="bibr" rid="bib53">Guillemet et al., 2021</xref>; <xref ref-type="bibr" rid="bib83">Lopatina et al., 2019</xref>), but a conceptual framework to understand emergent diversity has remained elusive. For instance, while initial high spacer diversity puts low-diversity phage populations under intense pressure to the point of driving them extinct (<xref ref-type="bibr" rid="bib131">van Houte et al., 2016</xref>; <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>), is the same true for emergent bacterial diversity after an extended period of coexistence? Is observed high bacterial spacer diversity indicative of successful bacterial escape from phage predation or an indicator of increased phage pressure? In our model, phage and bacterial diversity is tightly coupled: the number of large phage clones is approximately the same as the number of bacterial clones (Figure 22). This is also the case in experimental coevolution data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>: the number of phage protospacer types is on the same order of magnitude as the number of bacterial spacer types across most similarity thresholds (Figure 72). There is evidence that this coupling of diversity may also occur in the wild: a recent longitudinal study of <italic>Gordonia</italic> bacteria interacting with phage in a wastewater treatment plant identified 14 high-coverage phage genotypes and 11 high-coverage bacterial variants based on CRISPR spacer sequence (<xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>).</p><p>Using the tight correspondence between bacterial diversity and phage diversity in our model, we calculate the overall steady-state diversity by balancing the effective phage clone mutation rate <inline-formula><mml:math id="inf89"><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, phage clone establishment probability <inline-formula><mml:math id="inf90"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and the time to extinction for large phage clones <inline-formula><mml:math id="inf91"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (details in ‘Measuring diversity):<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ1">Equation 1</xref> arises from the simple statement that the number of large clones must be equal to their establishment rate (<inline-formula><mml:math id="inf92"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>) multiplied by their average time to extinction (<inline-formula><mml:math id="inf93"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). This relationship successfully predicts the number of bacterial clones at steady state across a wide range of parameters and a wide range of diversity values (<xref ref-type="fig" rid="fig2">Figure 2B</xref> inset, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, and <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). At the lowest value of <inline-formula><mml:math id="inf94"><mml:mi>η</mml:mi></mml:math></inline-formula> the prediction tends to overestimate the number of clones – in this regime, low acquisition means that phage clones go extinct because of clonal interference before bacteria are able to acquire spacers (Figure 16, ‘Measuring diversity’).</p><p>Through approximations (‘Analytic approximations for diversity’), we find that diversity depends on a single combined parameter to the power <inline-formula><mml:math id="inf95"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>), and this parameter is proportional to spacer effectiveness <inline-formula><mml:math id="inf96"><mml:mi>e</mml:mi></mml:math></inline-formula>, the probability of bacterial survival followed by spacer acquisition <inline-formula><mml:math id="inf97"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:math></inline-formula>, and the phage mutation rate <inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>e</mml:mi><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Each of these parameters intuitively increases diversity (e.g., a higher phage mutation rate means that phage diversity increases and bacterial diversity follows suit). What is surprising is that their combined effect on diversity is to a power much less than 1: this 1/3 exponent means that if the mutation rate increased tenfold, the diversity would only increase by about a factor of two (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>). In contrast, a simple neutral model of cell division with mutations gives a linearly proportional increase in diversity for the same increase in mutation rate (<xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>).</p><p>To understand where the dependence of diversity on these key parameters come from, we look more closely at each component expression. The effective phage mutation rate <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> depends linearly on the parameter <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>:</mml:mo><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>f</mml:mi><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>, while both the probability of establishment and the time to extinction depend inversely on diversity <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ5">Equation 5</xref>) and <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ189">Equation 173</xref>, Appendix 3). By comparison with <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, we find that <inline-formula><mml:math id="inf103"><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:math></inline-formula> depends approximately linearly on mutation rate, resulting in the weak <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∝</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:math></inline-formula> dependence on mutation rate.</p><p>The dependence of diversity on both <inline-formula><mml:math id="inf105"><mml:mi>e</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf106"><mml:mi>η</mml:mi></mml:math></inline-formula> comes from the probability of phage establishment since <inline-formula><mml:math id="inf107"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> depends only very weakly on these parameters through its dependence on total population sizes and <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> depends explicitly on <inline-formula><mml:math id="inf109"><mml:mi>m</mml:mi></mml:math></inline-formula> alone, not <inline-formula><mml:math id="inf110"><mml:mi>e</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf111"><mml:mi>η</mml:mi></mml:math></inline-formula>. The phage probability of establishment is proportional to <inline-formula><mml:math id="inf112"><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ5">Equation 5</xref>), and as before, this gives <inline-formula><mml:math id="inf113"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>∝</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Bacteria are more successful at high <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula>, which increases the phage establishment probability. Previous theoretical work has predicted that diversity increases as spacer acquisition rate increases (<xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref>); here, we provide a quantitative prediction for this dependence. In the following sections, we explore phage establishment in more detail.</p></sec><sec id="s2-3"><title>What determines the fitness and establishment of new mutants?</title><p>We find that diversity emerges in our model from the balance of phage clone establishment and extinction. However, only some phage mutants escape initial stochastic extinction and survive long enough to become established. What determines the fate of a new phage mutant? In our model, a single phage mutation in a protospacer can completely overcome CRISPR targeting, which means that new phage mutants can infect all bacteria equally well and their initial growth rate <italic>s</italic><sub>0</sub> is independent of CRISPR: <inline-formula><mml:math id="inf115"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf116"><mml:mi>F</mml:mi></mml:math></inline-formula> is the chemostat flow rate (a shared death rate for phages and bacteria). Surprisingly, however, even once bacteria start to acquire matching spacers, the probability of establishment for new phage mutants is still well-described by theory in which CRISPR targeting only influences total average population sizes (<xref ref-type="fig" rid="fig3">Figure 3C</xref>); that is, the specific interaction between a phage and its matching clone can be ignored. Intuitively, this is because phage clones must grow to a certain size before bacteria encounter them enough to begin to acquire spacers, and this size turns out to be large enough to avoid stochastic extinction (Figure 15). The probability of phage establishment is <inline-formula><mml:math id="inf117"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula>, where <inline-formula><mml:math id="inf118"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the initial phage mutant death rate. Importantly, these rates are independent of the population size of <italic>matching</italic> CRISPR bacteria clones; the only dependence on bacteria is on the total bacterial population size <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>), which is fairly stable at steady state.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>The fate of individual clones.</title><p>(<bold>A</bold>) Phage and bacteria coevolve in two timescale-separated regimes characterized by phage clone fitness. Average phage and bacteria clone size vs. time since phage mutation (right axis), and average clone growth rate vs. time since phage mutation (left axis). Markers show the average over all clone trajectories after steady state from six simulations with the same parameters. (<bold>B</bold>) Histograms of individual clone fitness grouped by time since phage mutation. Phage clones initially have fitness <italic>gt</italic><sub>0</sub>, but rapidly most clones reach neutral growth (fitness <inline-formula><mml:math id="inf120"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Bacteria clones also follow suit, initially having fitness <italic>gt</italic><sub>0</sub> and rapidly reaching 0 fitness on average. Because spacer acquisition for a clone only happens after that clone is created by phage mutation, the top-right panel of (<bold>B</bold>) is empty at the earliest time point following phage mutation. Individual clone trajectories are highly variable. (<bold>C</bold>) Probability of phage clone establishment vs. average immunity. Clones are considered established in simulations when they reach the mean clone size. <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> with <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is shown in green and with <inline-formula><mml:math id="inf122"><mml:mi>ν</mml:mi></mml:math></inline-formula> given by <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> in blue. In (<bold>A, B</bold>), <inline-formula><mml:math id="inf123"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf126"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Average clone sizes and fitness over time in a simulation.</title><p>Average phage and bacteria clone size vs. time (right vertical axis, purple and green markers) and average phage clone growth rate vs. time (left vertical axis, orange markers). Markers are the average over all clone trajectories after steady state in a single simulation. Phage clones appear at size 1 and grow until they reach the deterministic mean phage clone size on average. Once a phage clone becomes large, bacteria encounter it often enough to acquire a matching spacer, and bacteria clones grow until they reach their deterministic mean clone size. New phage mutants have a selective advantage (fitness <italic>gt</italic><sub>0</sub>, positive growth rate) until they reach the deterministic mean clone size, at which point they evolve neutrally (fitness <inline-formula><mml:math id="inf127"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Individual clone trajectories are highly variable, leading to a large standard deviation on the mean phage clone fitness and a fitness trend which is only evident on average. The predicted clone size is piecewise-defined as the theoretical clone trajectory until the theoretical trajectory reaches the predicted mean clone size.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Approximations for phage establishment probability.</title><p>Phage establishment probability vs. effective <inline-formula><mml:math id="inf128"><mml:mi>e</mml:mi></mml:math></inline-formula>. Markers are simulation results; error bars are standard deviation across three or more independent simulations. Black lines are the numerical theoretical solution. Blue lines are the approximate solution given by <xref ref-type="disp-formula" rid="equ55">Equation 54</xref> (with the full theoretical predicted value of <inline-formula><mml:math id="inf129"><mml:mi>m</mml:mi></mml:math></inline-formula>), and green lines are the same but with <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. All values of <inline-formula><mml:math id="inf131"><mml:mi>e</mml:mi></mml:math></inline-formula> collapse on the same <inline-formula><mml:math id="inf132"><mml:mi>η</mml:mi></mml:math></inline-formula> lines; the establishment probability depends only on <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> and not on <inline-formula><mml:math id="inf134"><mml:mi>e</mml:mi></mml:math></inline-formula> by itself. Interestingly, the <inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> approximation is close to the small <inline-formula><mml:math id="inf136"><mml:mi>e</mml:mi></mml:math></inline-formula> approximation at high <inline-formula><mml:math id="inf137"><mml:mi>η</mml:mi></mml:math></inline-formula>. This implies that high <inline-formula><mml:math id="inf138"><mml:mi>e</mml:mi></mml:math></inline-formula> matters more at small <inline-formula><mml:math id="inf139"><mml:mi>η</mml:mi></mml:math></inline-formula>. For some simulations near the transition from low to high <inline-formula><mml:math id="inf140"><mml:mi>η</mml:mi></mml:math></inline-formula>, the probability of establishment is zero, which is why the grey connecting lines drop below the x-axis near effective <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>e</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Theoretical phage establishment probability with approximations.</title><p>Theoretical phage establishment probability vs. <inline-formula><mml:math id="inf142"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. Solid lines are the numerical theoretical solution. Light dashed lines (‘small <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>’) are the approximate solution given by <xref ref-type="disp-formula" rid="equ55">Equation 54</xref> (with the full theoretical predicted value of <inline-formula><mml:math id="inf144"><mml:mi>m</mml:mi></mml:math></inline-formula>), heavy dashed lines are the same but with <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. All values of <inline-formula><mml:math id="inf146"><mml:mi>e</mml:mi></mml:math></inline-formula> collapse on the same <inline-formula><mml:math id="inf147"><mml:mi>η</mml:mi></mml:math></inline-formula> lines; the establishment probability depends only on <inline-formula><mml:math id="inf148"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> and not on <inline-formula><mml:math id="inf149"><mml:mi>e</mml:mi></mml:math></inline-formula> by itself. The inflection point in <inline-formula><mml:math id="inf150"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (dashed black line) is given by <xref ref-type="disp-formula" rid="equ59">Equation 58</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig3-figsupp3-v2.tif"/></fig></fig-group><p>Even though CRISPR targeting does not explicitly affect the establishment probability for new phage mutants, the probability of phage establishment increases as the average bacterial immunity increases (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Average immunity is a measure of the overall effectiveness of CRISPR immunity for the entire bacterial population; it is the average of all pairwise immunities between phage clones and bacterial clones weighted by their population sizes (<xref ref-type="fig" rid="fig1">Figure 1A</xref> inset). Because higher average immunity is beneficial for bacteria and leads to larger bacterial population sizes (<xref ref-type="fig" rid="fig3">Figure 3C</xref>), higher average immunity also means there is stronger selective advantage for new phage mutants that can escape CRISPR targeting (<xref ref-type="fig" rid="fig3">Figure 3C</xref> and Figure 5A).</p><p>For insight into the nature of this dependence, we approximated the probability of establishment at two extremes of average immunity (see ‘Dominant balance approximations for <inline-formula><mml:math id="inf151"><mml:mi>ν</mml:mi></mml:math></inline-formula>’). The probability of establishment can also be written<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf152"><mml:mi>ν</mml:mi></mml:math></inline-formula> is the fraction of bacteria that have spacers and <inline-formula><mml:math id="inf153"><mml:mi>m</mml:mi></mml:math></inline-formula> is the average number of bacterial clones at steady state. Low average immunity occurs when <inline-formula><mml:math id="inf154"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> is small: in this limit, the fraction of bacteria with spacers is<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf155"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is the extinction threshold for phages (<inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for phage survival), and <inline-formula><mml:math id="inf157"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> is the phage population size calculated with <inline-formula><mml:math id="inf158"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ53">Equation 52</xref>); this is the extreme limit of low average immunity where total population sizes approach their values in the absence of CRISPR immunity (Figure 26). The quantity <inline-formula><mml:math id="inf159"><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> can be understood as the ratio of the rate of spacer loss to the rate of spacer acquisition. If spacer loss is high and acquisition is low, the fraction of bacteria with spacers (<inline-formula><mml:math id="inf160"><mml:mi>ν</mml:mi></mml:math></inline-formula>) decreases. This in turn correlates with a lower probability of phage establishment (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>) since phages are less likely to establish when there is less pressure from bacteria defending against them with CRISPR. <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> is plotted in <xref ref-type="fig" rid="fig3">Figure 3C</xref> in blue. At very high average immunity, on the other hand, <inline-formula><mml:math id="inf161"><mml:mi>ν</mml:mi></mml:math></inline-formula> becomes close to 1 regardless of <inline-formula><mml:math id="inf162"><mml:mi>η</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), which is why the curves in <xref ref-type="fig" rid="fig3">Figure 3C</xref> overlap at high average immunity (<inline-formula><mml:math id="inf163"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is plotted in green).</p><p>For more insight into the parameter dependence of <inline-formula><mml:math id="inf164"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, we apply the same approximation as for <inline-formula><mml:math id="inf165"><mml:mi>m</mml:mi></mml:math></inline-formula>, expanding <inline-formula><mml:math id="inf166"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in <inline-formula><mml:math id="inf167"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf168"><mml:mi>η</mml:mi></mml:math></inline-formula> (‘Approximation for <inline-formula><mml:math id="inf169"><mml:mi>m</mml:mi></mml:math></inline-formula>’):<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>e</mml:mi><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>e</mml:mi><mml:mi>α</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mi>B</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The probability of establishment increases with the probability of bacterial escape and spacer acquisition <inline-formula><mml:math id="inf170"><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and with spacer effectiveness <inline-formula><mml:math id="inf171"><mml:mi>e</mml:mi></mml:math></inline-formula>, but decreases with increasing mutation rate <inline-formula><mml:math id="inf172"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. This is consistent with the intuition that more successful bacteria increase the strength of selection for phage mutants (higher <inline-formula><mml:math id="inf173"><mml:mi>η</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf174"><mml:mi>e</mml:mi></mml:math></inline-formula>), but that higher mutation rate reduces the probability of establishment for any particular mutant.</p></sec><sec id="s2-4"><title>Cross-reactivity leads to dynamically unique evolutionary states</title><p>We next asked how cross-reactivity between spacer and protospacer types impacts population dynamics and outcomes. Adding cross-reactivity was motivated by several experimental observations in CRISPR immunity: (a) In type I and type II CRISPR systems, single mutations in the PAM or protospacer seed regions (approximately 8 nucleotides at the start of a protospacer) can facilitate phage escape, whereas mutations elsewhere in the protospacer are tolerated by the CRISPR system (<xref ref-type="bibr" rid="bib39">Deveau et al., 2008</xref>; <xref ref-type="bibr" rid="bib111">Pyenson and Marraffini, 2020</xref>). Even when a phage manages to escape direct targeting, in type I and II systems an imperfect spacer match can facilitate priming: when Cas machinery binds to a protospacer match, even if unable to cleave the target, the likelihood of acquiring a nearby spacer is increased (<xref ref-type="bibr" rid="bib145">Westra et al., 2015</xref>; <xref ref-type="bibr" rid="bib112">Rao et al., 2017</xref>; <xref ref-type="bibr" rid="bib111">Pyenson and Marraffini, 2020</xref>; <xref ref-type="bibr" rid="bib142">Weissman et al., 2020</xref>). (b) Type III CRISPR targeting in <italic>Staphylococcus epidermidis</italic> has been shown to be completely tolerant to all single and even double mutations, meaning that these systems are naturally cross-reactive (<xref ref-type="bibr" rid="bib110">Pyenson et al., 2017</xref>).</p><p>We simulated two types of cross-reactivity: one in which phages experience an exponential decrease in CRISPR effectiveness with mutational distance (<xref ref-type="disp-formula" rid="equ7">Equation 7</xref>), and a step-function cross-reactivity where phages require additional <inline-formula><mml:math id="inf175"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi><mml:mo>≤</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> mutations to perfectly escape CRISPR targeting (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>). Phage success probability without cross-reactivity is given by <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>, a special case of 7 and 8 with <inline-formula><mml:math id="inf176"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mtext> exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>θ</mml:mi></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>θ</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The mutational distance <inline-formula><mml:math id="inf177"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of mutations between a protospacer and spacer, and <inline-formula><mml:math id="inf178"><mml:mi>θ</mml:mi></mml:math></inline-formula> scales the radius of cross-reactivity, with larger <inline-formula><mml:math id="inf179"><mml:mi>θ</mml:mi></mml:math></inline-formula> meaning more mutations are required to achieve the same immune escape (<xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>).</p><p>Exponential cross-reactivity has been modelled extensively in vertebrate adaptive immunity (<xref ref-type="bibr" rid="bib21">Chao et al., 2005</xref>; <xref ref-type="bibr" rid="bib90">Mayer et al., 2015</xref>; <xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref>; <xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>; <xref ref-type="bibr" rid="bib118">Schnaack and Nourmohammad, 2021</xref>; <xref ref-type="bibr" rid="bib22">Chardès et al., 2022</xref>), and our definition of exponential cross-reactivity as a function of mutational distance is the same as in <xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>. Step-function cross-reactivity, on the other hand, is reminiscent of the type III CRISPR system in which multiple point mutations are required to escape CRISPR targeting (<xref ref-type="bibr" rid="bib110">Pyenson et al., 2017</xref>) and was also modelled theoretically by <xref ref-type="bibr" rid="bib58">Han et al., 2013</xref>.</p><p>We find that cross-reactivity results in strikingly different dynamics of clone establishment and persistence (<xref ref-type="fig" rid="fig4">Figure 4</xref> and ‘Cross-reactivity’), including a travelling wave regime in which genetically neighbouring clones ‘pull’ each other along (<xref ref-type="fig" rid="fig4">Figure 4B–D</xref>), giving way to a regime in which new mutants have very low establishment rates in the case of step-function cross-reactivity (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). When cross-reactivity is high and phages require multiple mutations to escape targeting, we expect new phage mutants to have a lower fitness on average because they may already be within the immunity range of existing bacterial clones. However, unlike without cross-reactivity, not all new mutant fitnesses are the same because fitness now depends on the distribution of matching spacers in the bacterial population. Cross-reactivity adds a ‘direction’ in the genetic landscape and a fitness gradient for new phage mutants, leading to a series of rapid establishments and a travelling-wave regime. We believe these rapid establishments also suppress instantaneous diversity; diversity emerges longitudinally instead of concurrently in this regime (<xref ref-type="fig" rid="fig4">Figure 4</xref> and Figure 61). This is true for both types of cross-reactivity we studied, but we also observed striking qualitative differences between exponential and step-function cross-reactivity. In the former, all phage mutants are guaranteed a slight fitness advantage, and the travelling wave appears right at the start of simulations, with occasional lineage-splitting events (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). In contrast, step-function cross-reactivity means that mutants within the cross-reactivity radius have no fitness advantage at all. In this case, there is some variable initial length of time required to establish the travelling wave pattern: at the start of a simulation, all mutants are within the cross-reactivity radius and evolve purely neutrally. At least <inline-formula><mml:math id="inf180"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> new mutants must establish through neutral dynamics before the next mutant can escape CRISPR targeting and grow with high fitness; this leads to the travelling-wave regime appearing later for <inline-formula><mml:math id="inf181"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> than for <inline-formula><mml:math id="inf182"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and sometimes never appearing at all. Once the traveling wave appears, the dominant phage and bacteria clone types are exactly offset by <inline-formula><mml:math id="inf183"><mml:mi>θ</mml:mi></mml:math></inline-formula>: the most abundant phage clone will in general be <inline-formula><mml:math id="inf184"><mml:mi>θ</mml:mi></mml:math></inline-formula> mutations away from the most abundant concurrent bacteria clone. This is directly visible in the clone trajectories in <xref ref-type="fig" rid="fig4">Figure 4C–D</xref> inset and Figure 54: matching-colour bacteria and phage clones are offset in time. Another regime is also possible in the case of step-function cross-reactivity: if multiple large clones establish that are each outside of all the others’ cross-reactivity radii (Figure 63), then new mutants all have zero fitness and the travelling wave comes to an abrupt halt (around 7000 generations in <xref ref-type="fig" rid="fig4">Figure 4C</xref>). Establishment of new clones is once again extremely rare, and the existing large clones persist for a long time (Figures 53 and 62).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Cross-reactivity leads to ‘spindly’ phylogenies and regime switching.</title><p>Phage clone phylogenies for four simulations with different cross-reactivities: no cross-reactivity (<bold>A</bold>), exponential cross-reactivity with <inline-formula><mml:math id="inf185"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> (<bold>B</bold>), and step-function cross-reactivity with <inline-formula><mml:math id="inf186"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (<bold>C</bold>) and <inline-formula><mml:math id="inf187"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (<bold>D</bold>). All simulations share all other parameters: <inline-formula><mml:math id="inf188"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Phage clones are plotted at the first time they pass a population size of 2 to remove clutter from many new mutations destined for extinction, and the size of each circle is logarithmically proportional to the maximum size reached by that clone. Colours indicate the time of extinction of each clone. For each simulation with cross-reactivity, the left inset shows phage (top) and bacteria (bottom) clone sizes over time; colours indicate unique clone identities. Coloured rectangles above insets in (<bold>C</bold>) and (<bold>D</bold>) correspond to the dominant clone at each time. Dominant clone identities are offset by <inline-formula><mml:math id="inf189"><mml:mi>θ</mml:mi></mml:math></inline-formula> (vertical dashed line for visual aid).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig4-v2.tif"/></fig><media mimetype="video" mime-subtype="mp4" xlink:href="elife-81692-fig4-video1.mp4" id="fig4video1"><label>Figure 4—video 1.</label><caption><title>Animation of simulation without cross-reactivity for <xref ref-type="fig" rid="fig4">Figure 4A</xref>.</title></caption></media><media mimetype="video" mime-subtype="mp4" xlink:href="elife-81692-fig4-video2.mp4" id="fig4video2"><label>Figure 4—video 2.</label><caption><title>Simulation animation with exponential cross-reactivity for <xref ref-type="fig" rid="fig4">Figure 4B</xref>.</title></caption></media><media mimetype="video" mime-subtype="mp4" xlink:href="elife-81692-fig4-video3.mp4" id="fig4video3"><label>Figure 4—video 3.</label><caption><title>Simulation animation with step-function cross-reactivity for <xref ref-type="fig" rid="fig4">Figure 4C</xref>.</title></caption></media><media mimetype="video" mime-subtype="mp4" xlink:href="elife-81692-fig4-video4.mp4" id="fig4video4"><label>Figure 4—video 4.</label><caption><title>Simulation animation with step-function cross-reactivity for <xref ref-type="fig" rid="fig4">Figure 4D</xref>.</title></caption></media></fig-group><p>Changes to the fitness landscape of individual clones caused by cross-reactivity also influence population-level outcomes such as diversity. In general, we find that for high cross-reactivity, average diversity is lower than predicted for simulations without cross-reactivity because the probability of phage establishment per mutant decreases (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). A decrease in phage mutant fitness as the strength of cross-reactivity increases is in line with the dependence of fitness on cross-reactivity reported by <xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref> and <xref ref-type="bibr" rid="bib115">Rouzine and Rozhnova, 2018</xref>. Even with more complicated underlying dynamics, though, measuring average immunity alone is enough to reproduce total population sizes using our simple deterministic equations developed in the limit of no cross-reactivity (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, 'Total population size'). This is because average immunity completely captures the population-level impact of CRISPR immunity, and we can replace the CRISPR effectiveness parameter <inline-formula><mml:math id="inf190"><mml:mi>e</mml:mi></mml:math></inline-formula> with measured average immunity in <xref ref-type="disp-formula" rid="equ13 equ14 equ15 equ16 equ17">Equations 13–17</xref> to get very good agreement between measured and predicted population sizes even away from steady state (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). In contrast, inferring average immunity from the number of clones using the approximation that effective <inline-formula><mml:math id="inf191"><mml:mrow><mml:mi>e</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> does not give good agreement with simulation results for simulations with cross-reactivity (<xref ref-type="fig" rid="fig5">Figure 5B</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Average immunity underlies population outcomes.</title><p>(<bold>A</bold>) Probability of phage clone establishment vs. average immunity for different amounts and types of cross-reactivity. No cross-reactivity (<inline-formula><mml:math id="inf192"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) is shown as black stars, exponential cross-reactivity in red, and step-function cross-reactivity in blue. Simulation averages are shown for <inline-formula><mml:math id="inf193"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf194"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations and are shown in both x directions and the positive y direction. (<bold>B, C</bold>) Total phage (purple) and total bacteria (teal) average population sizes vs. the mean number of bacterial clones <inline-formula><mml:math id="inf195"><mml:mi>m</mml:mi></mml:math></inline-formula> (<bold>B</bold>) and vs. average bacterial immunity (<bold>C</bold>) for <inline-formula><mml:math id="inf196"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Each point is an average at steady state over three or more independent simulations with the same parameters; error bars are standard deviation. Total sizes are scaled by the initial nutrient concentration <italic>C</italic><sub>0</sub>. Lighter colours indicate stronger cross-reactivity, marker shapes match legends in (<bold>A</bold>) and (<bold>B</bold>). Solid lines are the predicted total population size given by solving <xref ref-type="disp-formula" rid="equ13">Equations 13</xref>–17 and using the approximation effective <inline-formula><mml:math id="inf197"><mml:mrow><mml:mi>e</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> in (<bold>B</bold>) and the measured average immunity for effective <inline-formula><mml:math id="inf198"><mml:mi>e</mml:mi></mml:math></inline-formula> in (<bold>C</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Total population sizes predicted by average immunity in a simulation with cross-reactivity.</title><p>Total phage (top) and total bacteria (bottom) in a simulation with cross-reactivity (step function CRISPR effectiveness with <inline-formula><mml:math id="inf199"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). The dashed black line uses the measured value of average immunity from the simulation at each time point to predict population sizes using the solutions to the system of <xref ref-type="disp-formula" rid="equ13">Equations 13</xref>–17. This simulation has one initial phage clone and parameters <inline-formula><mml:math id="inf200"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf201"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf202"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf203"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig5-figsupp1-v2.tif"/></fig></fig-group><p><xref ref-type="fig" rid="fig5">Figure 5B</xref> makes an additional subtle point: higher immune diversity promotes larger population sizes for phages but not for bacteria. This is counterintuitive and appears to conflict with several experimental results that show that more bacterial diversity increases the likelihood of phage extinction (<xref ref-type="bibr" rid="bib131">van Houte et al., 2016</xref>; <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>) and decreases the ability of phages to adapt (<xref ref-type="bibr" rid="bib100">Morley et al., 2017</xref>). This discrepancy appears at first glance to be a consequence of limiting bacteria and phages to a single spacer and protospacer in our model, but we propose that it is actually because bacteria and phage diversity is decoupled in prior experiments. In the following section, we introduce a toy model to understand the conceptual impact of multiple protospacers and spacers when overall phage and bacterial diversity is coupled.</p></sec><sec id="s2-5"><title>Pathogen and host diversity must be considered together</title><p>Our model restricts bacteria to a single spacer and phages to a single protospacer. This single-spacer assumption is a reasonable approximation for the experimental systems we consider: many liquid culture experiments find that most bacteria acquire a single spacer when exposed to phages, (<xref ref-type="bibr" rid="bib65">Heler et al., 2015</xref>; <xref ref-type="bibr" rid="bib66">Heler et al., 2019</xref>; <xref ref-type="bibr" rid="bib111">Pyenson and Marraffini, 2020</xref>) even after up to 2 weeks (<xref ref-type="bibr" rid="bib103">Paez-Espino et al., 2013</xref>; <xref ref-type="bibr" rid="bib27">Common et al., 2019</xref>). Additionally, metagenomic results show that most spacer matches to viral sequences are located near the leader end of the CRISPR array <xref ref-type="bibr" rid="bib139">Weinberger et al., 2012a</xref>. These results, combined with theory positing that recently acquired spacer provide more immune benefit than older spacers (<xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref>; <xref ref-type="bibr" rid="bib58">Han et al., 2013</xref>), suggest that dynamics may be dominated by a very small number of spacers per bacterium.</p><p>Nevertheless, many bacteria possess tens to hundreds of spacers (<xref ref-type="bibr" rid="bib105">Pavlova et al., 2021</xref>) and the question of multiple protospacers remains. Can we make inferences about how a more realistic multiple spacer or multiple protospacer scenario will change the relationship between diversity and average immunity in our model? First, we note that our model with exponential cross-reactivity is a good approximation for a realistic scenario where bacteria are limited to a single spacer but phages can have multiple protospacers. In this situation, multiple bacteria with unique spacers may target different protospacers in the same phage. A mutation in one protospacer will increase phage fitness but will not provide perfect immune escape, just as in the case of exponential cross-reactivity (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Even in this scenario, our qualitative results remain the same: bacteria and phage diversity is coupled and bacteria have higher average immunity at low diversity (<xref ref-type="fig" rid="fig5">Figure 5B</xref> and Figure 50).</p><p>We explored the consequences of both multiple spacers and multiple protospacers with a toy model. We generated synthetic sets of protospacers and spacers and varied the total diversity by changing the size of their pool and distributing their abundances exponentially to qualitatively match data (<xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>). We randomly assigned protospacers and spacers to individual phages and bacteria, then calculated average immunity. Importantly, we constrain phage and bacterial diversity to be coupled – overall spacer and protospacer diversity is the kept the same in all scenarios.</p><p>We find that across all combinations of array sizes and for two of three scenarios of protospacer diversity, average immunity is negatively correlated with diversity (Figure 69). Only when we limited phage diversity to a single mutating protospacer with all other protospacers conserved were bacteria with multiple spacers reliably able to target conserved protospacers regardless of the level of diversity in the variable protospacer position (Figure 69D). We compared our toy model to the experimental setup from <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>. In their experiments, bacterial CRISPR spacer diversity was increased while phage diversity was kept constant with a single phage strain able to infect only one of the bacterial clones. This translated to an increasing initial average immunity as bacterial diversity increased and phages were able to infect a smaller proportion of the bacterial population (Figure 69A), which we think is not a realistic situation in a coevolving population of phages and bacteria.</p><p>Based on these results, we predict that in many realistic situations average immunity does not increase with diversity if phage and bacterial diversity are coupled. The intuition is this: if diversity of both bacteria and phages increase beyond the functional length of the CRISPR array, bacteria cannot be immune to all phage strains at once and average immunity must go down as diversity increases. The actual benefit of bacterial diversity depends very strongly on the characteristics of <italic>phage</italic> diversity (Figure 69) and manipulations of diversity should be understood in terms of their impact on average immunity. This has implications for understanding the so-called 'dilution effect' which is typically described as a decrease in the fraction of susceptible hosts as host diversity increases (<xref ref-type="bibr" rid="bib19">Chabas et al., 2018</xref>; <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>). Our model and analysis show that a dilution effect can only occur if host diversity increases out of proportion to pathogen diversity as in <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref> (Figure 69A), whereas if both host and pathogen diversity increase in tandem, the dilution effect actually changes direction, decreasing the fraction of pathogens that a host may be immune to as pathogen diversity increases (Figure 69B–D). In the same vein, previous theoretical work has found that CRISPR with a fitness cost would be selected against when viral diversity is high for this reason (<xref ref-type="bibr" rid="bib140">Weinberger et al., 2012b</xref>; <xref ref-type="bibr" rid="bib72">Iranzo et al., 2013</xref>), notably with models that allowed for multiple spacers and protospacers. Our results, building on existing theory, show that phage and bacterial diversity must be explored in tandem and that CRISPR immunity may provide less benefit when phage diversity is high.</p></sec><sec id="s2-6"><title>Dynamics are determined by diversity</title><p>How quickly does the phage population evolve? With explicitly modelled spacer and protospacer sequences of length <inline-formula><mml:math id="inf204"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula>, we quantify the speed of evolution as the ‘mutational distance’ per generation (<xref ref-type="bibr" rid="bib115">Rouzine and Rozhnova, 2018</xref>): between two time points, how far in genome space has the phage population travelled, or how many mutations have occurred on average (Speed of evolution)?</p><p>The speed of evolution is both stable and repeatable between simulations at steady state and highly correlated between bacteria and phage (Figure 38). We find that the speed of evolution is inversely proportional to the time to extinction for large phage clones (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, 'Measuring speed of evolution'). Intuitively, if phage clones turn over more quickly (small time to extinction), the population is able to move more quickly to a different genetic state, while if the time to extinction is large, new mutants are seeded close to parent populations that persist for a long time, limiting the mutational distance. Since the phage time to extinction has a simple relationship to bacterial diversity, we can also relate speed to diversity, and we find that the speed of evolution is proportional to diversity and proportional to the same parameter combination to the power 1/3 (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). As in the case of diversity, increasing phage mutation rate <inline-formula><mml:math id="inf205"><mml:mi>μ</mml:mi></mml:math></inline-formula> increases the speed of evolution sublinearly, and like diversity, the prediction diverges from simulation results at low <inline-formula><mml:math id="inf206"><mml:mi>η</mml:mi></mml:math></inline-formula> as described in 'Measuring diversity.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Phage evolution and spacer turnover.</title><p>(<bold>A</bold>) Principal Component Analysis (PCA) decomposition of phage and bacteria clone abundances for a simulation with <inline-formula><mml:math id="inf207"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf208"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf209"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf210"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Clone abundances are normalized at each time point, then PCA is performed for the entire phage time series over <inline-formula><mml:math id="inf211"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mn>4000</mml:mn></mml:mrow></mml:math></inline-formula> generations (four times the mean extinction time for phage clones). Bacteria and phage clone abundances are transformed into the PCA coordinates; colours indicate simulation time. Five time points are highlighted in progressively lighter shades of red for emphasis. (<bold>B</bold>) Phage genomic speed of evolution vs. mean large phage clone time to extinction. The phage speed is the weighted average genomic distance between the phage population at the end of the simulation and the phage population at an earlier time, divided by the time interval. The dashed line is <inline-formula><mml:math id="inf212"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>x</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. (<bold>C</bold>) The speed of evolution increases as spacer effectiveness <inline-formula><mml:math id="inf213"><mml:mi>e</mml:mi></mml:math></inline-formula>, spacer acquisition probability <inline-formula><mml:math id="inf214"><mml:mi>η</mml:mi></mml:math></inline-formula>, and phage mutation rate <inline-formula><mml:math id="inf215"><mml:mi>μ</mml:mi></mml:math></inline-formula> increase. The dashed line shows an approximate theoretical calculation (assuming speed = 1/time to extinction) which captures the trend across a wide range of parameters. Error bars in (B) and (C) are the standard deviation across three or more independent simulations and are shown in the positive direction only. (<bold>D</bold>) Spacer turnover as a function of time delay for four simulations with <inline-formula><mml:math id="inf216"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf217"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf218"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The fraction of bacterial clones remaining is the fraction of clones that were present at time <inline-formula><mml:math id="inf219"><mml:mi>t</mml:mi></mml:math></inline-formula> that are still present at time <inline-formula><mml:math id="inf220"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:math></inline-formula> delay. Solid lines are an average across steady-state for each value of the time delay; shaded regions are the standard deviation. (<bold>E–G</bold>) Spacer-type turnover calculated as in (<bold>D</bold>) using experimental data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref> (<bold>E</bold>), metagenomic data sampled from groundwater from <xref ref-type="bibr" rid="bib15">Burstein et al., 2016</xref> (<bold>F</bold>), and metagenomic data sampled from a wastewater treatment plant from <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref> (<bold>G</bold>). Experimental time points are interpolated to the minimum sampling interval to allow averaging across the experiment.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Clone size PCA for a simulation with exponential cross-reactivity.</title><p>PCA decomposition of phage and bacteria clone abundances for a simulation with exponential cross-reactivity and <inline-formula><mml:math id="inf221"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf222"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>,,<inline-formula><mml:math id="inf223"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and.<inline-formula><mml:math id="inf224"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> Clone abundances are normalized at each time point, then PCA is performed for the entire phage time series over <inline-formula><mml:math id="inf225"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula> generations (four times the mean extinction time for phage clones). Bacteria and phage clone abundances are transformed into the PCA coordinates; colours indicate simulation time. Five time points are highlighted in progressively lighter shades of red for emphasis.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Genetic distance vs. diversity and time to extinction.</title><p>Phage mutational distance reached in simulations divided by the number of phage establishments vs. diversity (left) and phage mutational distance per generation vs. mean phage time to extinction (right). Error bars are the standard deviation across three or more independent simulations and are shown in the positive direction only.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>Spacer turnover by spacer effectiveness.</title><p>Spacer turnover as a function of time delay for four simulations with <inline-formula><mml:math id="inf226"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf227"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf228"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The fraction of bacterial clones remaining is the fraction of clones that were present at time <inline-formula><mml:math id="inf229"><mml:mi>t</mml:mi></mml:math></inline-formula> that are still present at time <inline-formula><mml:math id="inf230"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:math></inline-formula> delay. Solid lines are an average across steady state for each value of the time delay; shaded regions are the standard deviation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig6-figsupp3-v2.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 4.</label><caption><title>Spacer turnover by phage mutation rate.</title><p>Spacer turnover as a function of time delay for four simulations with <inline-formula><mml:math id="inf231"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf232"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf233"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>. The fraction of bacterial clones remaining is the fraction of clones that were present at time <inline-formula><mml:math id="inf234"><mml:mi>t</mml:mi></mml:math></inline-formula> that are still present at time <inline-formula><mml:math id="inf235"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:math></inline-formula> delay. Solid lines are an average across steady state for each value of the time delay; shaded regions are the standard deviation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig6-figsupp4-v2.tif"/></fig><media mimetype="video" mime-subtype="mp4" xlink:href="elife-81692-fig6-video1.mp4" id="fig6video1"><label>Figure 6—video 1.</label><caption><title>PCA decomposition of phage and bacteria protospacer and spacer clone abundances for a simulation of bacteria and phages interacting with CRISPR immunity.</title><p>Clone abundances are normalized at each time point, then PCA is performed for the entire phage time series over about 4000 generations (four times the mean extinction time for phage clones). Bacteria and phage clone abundances are transformed into the PCA coordinates; colours indicate simulation time.</p></caption></media></fig-group><p>Our simulations show continual spacer turnover at steady state (<xref ref-type="fig" rid="fig6">Figure 6D</xref>, <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>, <xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4</xref>), a feature that we might also expect to see in actively evolving laboratory or natural populations of bacteria and phages. We analysed data from a long-term in vitro coevolution experiment with <italic>Streptococcus thermophilus</italic> bacteria and phage (<xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>), data from a time-series sampling of a natural aquifer community of bacteria (<xref ref-type="bibr" rid="bib15">Burstein et al., 2016</xref>), and data from a time-series sampling of a wastewater treatment plant (<xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>) (see 'Materials and methods') and calculated spacer turnover over time (<xref ref-type="fig" rid="fig6">Figure 6E–G</xref>). We found that spacer sequences experienced turnover in all cases, indicating ongoing change in the spacer content in these populations, though no experimental system sho wed complete turnover of all spacer types. Even if spacer loss is happening for non-selective reasons (e.g., mixing or flow in the aquifer system), turnover indicates that new spacers are being acquired as well and that CRISPR systems are active. Moreover, the timescale of early spacer turnover in the <italic>S. thermophilus</italic> experiment is similar to the timescale in our simulations — after 1000 generations, most simulations have between 40 and 60% of clones remaining (<xref ref-type="fig" rid="fig6">Figure 6D</xref>) and about 60% of clones remain after 1000 generations in the experimental data (<xref ref-type="fig" rid="fig6">Figure 6E</xref>). We modelled all simulation parameters on known parameters for <italic>S. thermophilus</italic> where possible.</p></sec><sec id="s2-7"><title>Time-shifted average immunity calculated from data reveals distinctive patterns of turnover</title><p>Bacteria acquire spacers in response to phage clones becoming large. The spacer composition of the bacterial population tracks the phage protospacer composition with a lag: <xref ref-type="fig" rid="fig6">Figure 6A</xref> shows the first two components of a PCA decomposition of bacteria and phage abundances over time in a simulation, a visual illustration of bacterial tracking. Without cross-reactivity, trajectories in this lower-dimensional space do not travel in a straight line; they are reminiscent of the diffusive coevolutionary trajectories in antigenic space described in a theoretical model of vertebrate virus-host coevolution (<xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref>). In the travelling wave regime with cross-reactivity, trajectories are much more ballistic (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). Can we quantify how well and how quickly can bacteria track the evolving phage population with CRISPR?</p><p>Average immunity is a simple metric that quantifies the overlap between bacteria and phages. In experiments with both microbes and vertebrates, time-shift infectivity analyses between host and pathogen populations typically show that hosts are more immune to pathogens from the past and less immune to pathogens from the future (<xref ref-type="bibr" rid="bib113">Richman et al., 2003</xref>; <xref ref-type="bibr" rid="bib45">Frost et al., 2005</xref>; <xref ref-type="bibr" rid="bib97">Moore et al., 2009</xref>; <xref ref-type="bibr" rid="bib57">Hall et al., 2011</xref>; <xref ref-type="bibr" rid="bib77">Koskella, 2014</xref>; <xref ref-type="bibr" rid="bib6">Betts et al., 2018</xref>; <xref ref-type="bibr" rid="bib27">Common et al., 2019</xref>; <xref ref-type="bibr" rid="bib40">Dewald-Wang et al., 2022</xref>). We conduct a time-shift analysis on our simulation data (<xref ref-type="fig" rid="fig7">Figure 7A and B</xref>, <xref ref-type="fig" rid="fig7s11">Figure 7—figure supplement 11</xref>, <xref ref-type="fig" rid="fig7s12">Figure 7—figure supplement 12</xref>) and find that the same pattern holds true, but only for a limited time window: bacteria are indeed more immune to phages from the past, but this past immunity has a peak and then decays as we look further into the past, eventually reaching 0 immunity (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). The presence of a peak in past immunity reflects the timescale of spacer turnover: once the bacterial population has lost all spacers from a previous time point, it is no longer immune to contemporaneous phages and time-shifted average immunity falls to 0. In simulations, the position of this peak is dependent on parameters such as <inline-formula><mml:math id="inf236"><mml:mi>η</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf237"><mml:mi>μ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig7">Figure 7E and F</xref>). As <inline-formula><mml:math id="inf238"><mml:mi>μ</mml:mi></mml:math></inline-formula> increases, the peak occurs further in the past since phage are now moving more quickly away from bacteria tracking, while as <inline-formula><mml:math id="inf239"><mml:mi>η</mml:mi></mml:math></inline-formula> increases, the peak moves closer to the present since bacteria are responding more quickly to changes in the phage population. This suggests that there is a tradeoff between immune memory durability and responding quickly to immune threats: bacteria must choose between tracking the phage population closely or keeping past immunity for a long time.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Quantifying immune memory in data.</title><p>(<bold>A, B</bold>) Average immunity of bacteria against phage for four simulations with different values of <inline-formula><mml:math id="inf240"><mml:mi>η</mml:mi></mml:math></inline-formula> as a function of time shift. Solid lines are an average across steady state for each value of the time shift; shaded regions are the standard deviation. Average immunity peaks in the recent past (<bold>A</bold>, indicated by <inline-formula><mml:math id="inf241"><mml:msup><mml:mi>τ</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>) with a negative slope through zero delay (<bold>A</bold>, black dashed line) and decays to zero at long delays in the past or future (<bold>B</bold>). For all simulations <inline-formula><mml:math id="inf242"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf244"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>C, D</bold>) Average overlap between bacterial spacer and phage protospacer types using data from a lab experiment with <italic>S. thermophilus</italic> and phage from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref> (<bold>C</bold>) and data from a wastewater treatment plant sampled over 3 years from <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref> (<bold>D</bold>). Spacer types are grouped by 85% similarity, and shaded region is standard deviation across averaged data. Base average immunity values were multiplied by the average number of protospacers corresponding to the <italic>S. thermophilus</italic> CRISPR system (<bold>C</bold>) and the <italic>Gordonia</italic> CRISPR systems (<bold>D</bold>) to account for multiple potential protospacer targets per phage. In (<bold>D</bold>), we compared two time shifts with zero delay average immunity using a Wilcoxon signed-rank test: <inline-formula><mml:math id="inf245"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.27</mml:mn></mml:mrow></mml:math></inline-formula> for lower past immunity at 500 days, <inline-formula><mml:math id="inf246"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.008</mml:mn></mml:mrow></mml:math></inline-formula> for lower past immunity at 200 days, <inline-formula><mml:math id="inf247"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> for lower future immunity at 500 days, and <inline-formula><mml:math id="inf248"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.003</mml:mn></mml:mrow></mml:math></inline-formula> for lower future immunity at 200 days. (<bold>E, F</bold>) The position of the peak in past immunity for simulated data vs. spacer acquisition probability <inline-formula><mml:math id="inf249"><mml:mi>η</mml:mi></mml:math></inline-formula> (<bold>E</bold>) and phage mutation rate <inline-formula><mml:math id="inf250"><mml:mi>μ</mml:mi></mml:math></inline-formula> (<bold>F</bold>). The peak position is the time shift value for which the curves in (<bold>A</bold>) are largest, indicated by <inline-formula><mml:math id="inf251"><mml:msup><mml:mi>τ</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Time-shifted average immunity for experimental coevolution data.</title><p>Time shifted overlap for experimental coevolution data with the first time point and last two time points removed. Interpolation spacing is 3 days, the smallest interval between remaining time points. Time intervals in days were multiplied by 6.64, the estimated number of bacterial generations per day assuming exponential growth with 100:1 serial dilutions. Protospacers are included if they have a perfect PAM, and all wild-type spacers are included.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>Time-shifted average immunity for experimental coevolution data with partial PAM matches included.</title><p>Time-shifted overlap for experimental coevolution data with the first time point and last two time points removed. Interpolation spacing is 3 days, the smallest interval between remaining time points. Time intervals in days were multiplied by 6.64, the estimated number of bacterial generations per day assuming exponential growth with 100:1 serial dilutions. Protospacers are included if they have a perfect PAM or partially perfect PAM, and all wild-type spacers are included.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp2-v2.tif"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 3.</label><caption><title>Time-shifted average immunity for experimental coevolution data with all sequences regardless of PAM.</title><p>Time-shifted overlap for experimental coevolution data with the first time point and last two time points removed. Interpolation spacing is 3 days, the smallest interval between remaining time points. Time intervals in days were multiplied by 6.64, the estimated number of bacterial generations per day assuming exponential growth with 100:1 serial dilutions. All potential protospacers are included regardless of PAM sequence, and all wild-type spacers are included.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp3-v2.tif"/></fig><fig id="fig7s4" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 4.</label><caption><title>Time-shifted average immunity for experimental coevolution data with data trimmed from start and end.</title><p>Time-shifted overlap for experimental coevolution data with increasing numbers of time points from the start and end removed. Interpolation spacing is the smallest interval between remaining time points. Only perfect-PAM protospacers are included; all wild-type spacers are included.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp4-v2.tif"/></fig><fig id="fig7s5" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 5.</label><caption><title>Time-shifted average immunity for wastewater with data trimmed from start and end.</title><p>Time-shifted average immunity for spacers and protospacers from wastewater grouped at four different similarity thresholds. Points are trimmed from the start and end of the time series in each panel as described in the overlay text. Raw values are multiplied by 1956, the average number of protospacers with the GTT PAM from the phage DC-56 and DS-92 genomes. Only perfect-PAM protospacers are included; all wild-type spacers are included.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp5-v2.tif"/></fig><fig id="fig7s6" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 6.</label><caption><title>Bootstrapped average immunity with all points randomly shuffled.</title><p>Bootstrapped control: time-shifted average immunity for wastewater after randomly shuffling the interpolated clone abundances separately for bacteria and phage.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp6-v2.tif"/></fig><fig id="fig7s7" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 7.</label><caption><title>Bootstrapped average immunity with pairs of bacteria and phage clone sizes shuffled.</title><p>Bootstrapped control: time-shifted average immunity for wastewater after randomly shuffling pairs of interpolated bacteria and phage clone sizes such that time point matching is maintained between bacteria and phages.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp7-v2.tif"/></fig><fig id="fig7s8" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 8.</label><caption><title>Time-shifted average immunity for wastewater with data trimmed from the end.</title><p>Time-shifted average immunity for spacers and protospacers grouped at an 85% similarity threshold. 16 time points are removed from the end of the data series in order to remove the region with zero protospacer counts. Raw values are multiplied by 1956, the average number of protospacers with the GTT PAM from the phage DC-56 and DS-92 genomes. Only perfect-PAM protospacers are included; all wild-type spacers are included.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp8-v2.tif"/></fig><fig id="fig7s9" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 9.</label><caption><title>Time-shifted average immunity for wastewater with data trimmed from the start.</title><p>Time-shifted average immunity for spacers and protospacers grouped at an 85% similarity threshold. 21 time points are removed from the beginning of the data series to remove the region with anomalously high average immunity. Raw values are multiplied by 1956, the average number of protospacers with the GTT PAM from the phage DC-56 and DS-92 genomes. Only perfect-PAM protospacers are included; all wild-type spacers are included.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp9-v2.tif"/></fig><fig id="fig7s10" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 10.</label><caption><title>Time-shifted average immunity for wastewater with data trimmed from the start and end.</title><p>Time-shifted average immunity for spacers and protospacers grouped at an 85% similarity threshold. 21 time points are removed from the beginning of the data series to remove the region with anomalously high average immunity, and 16 time points are removed from the end of the data series in order to remove the region with zero protospacer counts. Raw values are multiplied by 1956, the average number of protospacers with the GTT PAM from the phage DC-56 and DS-92 genomes. Only perfect-PAM protospacers are included; all wild-type spacers are included.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp10-v2.tif"/></fig><fig id="fig7s11" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 11.</label><caption><title>Time-shifted average immunity by spacer effectiveness.</title><p>Average immunity of bacteria against phage for four simulations with different values of <inline-formula><mml:math id="inf252"><mml:mi>e</mml:mi></mml:math></inline-formula> as a function of time shift. Solid lines are an average across steady-state for each value of the time shift; shaded regions are the standard deviation. A short-time view is shown on the left and a long-time view on the right. For all simulations <inline-formula><mml:math id="inf253"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf254"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf255"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp11-v2.tif"/></fig><fig id="fig7s12" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 12.</label><caption><title>Time-shifted average immunity by phage mutation rate.</title><p>Average immunity of bacteria against phage for four simulations with different values of <inline-formula><mml:math id="inf256"><mml:mi>μ</mml:mi></mml:math></inline-formula> as a function of time shift. Solid lines are an average across steady state for each value of the time shift; shaded regions are the standard deviation. A short-time view is shown on the left and a long-time view on the right. For all simulations <inline-formula><mml:math id="inf257"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf258"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf259"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig7-figsupp12-v2.tif"/></fig></fig-group><p>Time-shift analyses are usually performed explicitly by directly combining stored samples from different time points (<xref ref-type="bibr" rid="bib6">Betts et al., 2018</xref>; <xref ref-type="bibr" rid="bib27">Common et al., 2019</xref>; <xref ref-type="bibr" rid="bib40">Dewald-Wang et al., 2022</xref>). However, by sequencing CRISPR spacers and phage genomes, a pseudo-analysis can be done without any time-shifted competition experiments by calculating the overlap between bacterial spacers and phage protospacers at different times delays. We performed such an analysis for two published datasets: a long-term laboratory coevolution experiment with <italic>S. thermophilus</italic> and phage (<xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>) and time series of metagenomic samples over 3 years from a wastewater treatment plant (<xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>). In both experiments, whole-genome shotgun sequencing was performed on bacteria and phage DNA, and CRISPR spacers and protospacers were recovered and reported. We re-analysed these datasets to detect CRISPR spacers by finding sequences adjacent to known CRISPR repeats in raw reads. We also detected protospacers by finding matches to our detected CRISPR spacers in reads that did not match the CRISPR repeats or the bacterial reference genome(s) (see ‘Laboratory coevolution experimental data’; ‘Experimental data from wastewater treatment plant’).</p><p>We grouped spacers with an 85% similarity threshold and interpolated counts between sequenced time points. We calculated the average overlap assuming <inline-formula><mml:math id="inf260"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (perfect immunity from matching spacers) as a function of time delay, averaging over all combinations of interpolated data with the same time delay (<xref ref-type="fig" rid="fig7">Figure 7C and D</xref>). We found two qualitatively different trends as a function of time delay. In the laboratory coevolution experiment, we found that bacteria are more immune to past phages and less immune to future phages (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>), consistent with what we see at short time delay in our model (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, black dashed line). In contrast, in the wastewater treatment plant data, we found a peak in average immunity that is roughly centred at zero time delay: bacteria are most immune to phages from their same time point, and immunity rapidly decays in both the past and the future (<xref ref-type="fig" rid="fig7">Figure 7D</xref>), qualitatively similar to our simulation results on very long timescales (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). These different trends may reflect different regimes of CRISPR immune memory: in the laboratory experiment data, we see no evidence of the decay of immune memory, while in the wastewater treatment data we see a suggestion of decay on the timescale of weeks. Bacteria appear to track the phage population closely in the wastewater data, while in the laboratory data bacteria lag behind the phage population.</p><p>Because the variability in average immunity between time points was very high in the wastewater treatment plant data, we performed a Wilcoxon signed-rank test between the average immunity at zero time delay and the average immunity at a time delay ±200 and ±500 (see ‘Calculating average immunity for details’). We found that past immunity after 200 days is significantly lower than present (Wilcoxon statistic <inline-formula><mml:math id="inf261"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1241</mml:mn></mml:mrow></mml:math></inline-formula> p-value <inline-formula><mml:math id="inf262"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.008</mml:mn></mml:mrow></mml:math></inline-formula>), but that immunity after 500 days is not significantly lower than present (<inline-formula><mml:math id="inf263"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>392</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.27</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). For both time delays, we found that future immunity is significantly lower than present (<inline-formula><mml:math id="inf264"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>580</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0012</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for 500 days and <inline-formula><mml:math id="inf265"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1293</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.003</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for 200 days). Interestingly, these significance values are not symmetric if we pose the question from the perspective of phage: the overlap between phage and future bacteria at 500 days is lower than the overlap for present phages (<inline-formula><mml:math id="inf266"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>507</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.024</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>), and the overlap between phage and past bacteria is lower than the overlap at present (<inline-formula><mml:math id="inf267"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>388</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.027</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, Figure 88). This asymmetry, that bacteria are generally more immune to all past phages while phage are not more infective against all past bacteria, is qualitatively the same as that reported by Dewald-Wang et al. in an explicit time-shift study of bacteria and phage immunity and infectivity in chestnut trees (<xref ref-type="bibr" rid="bib40">Dewald-Wang et al., 2022</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Many bacteria and archaea possess CRISPR systems, and a significant fraction of these systems are likely to provide immunity against phages (<xref ref-type="bibr" rid="bib14">Brodt et al., 2011</xref>; <xref ref-type="bibr" rid="bib120">Shmakov et al., 2017</xref>; <xref ref-type="bibr" rid="bib108">Pourcel et al., 2020</xref>). Given that bacteria and phages coexist in natural environments over extremely long timescales, the impact of CRISPR immunity in these steady-state conditions has remained underexplored. We constructed a phenomenological model of CRISPR immunity in a bacterial population interacting with phages to explore the impacts of adaptive immunity on population survival, fitness, and diversity. We found that both phage and bacterial genetic diversity emerged spontaneously with a minimal set of interactions, and we derived approximate analytic predictions for population outcomes. These rigorous analyses of our simple model lay a foundation for theoretical analysis of adaptive immunity in host-pathogen systems.</p><p>Our model is mechanistically simple, and we left out many known biological features and interactions by choice in order to gain a deep understanding of the factors that influenced our results. We modelled uniform spacer effectiveness, uniform spacer acquisition probability, and a constant phage mutation rate, all in a well-mixed system. This constitutes a null model of CRISPR immunity that provides a useful comparison point for both more accurate mechanistic models and experimental data. CRISPR is one of many other bacterial antiviral defence systems (<xref ref-type="bibr" rid="bib5">Bernheim and Sorek, 2020</xref>), and within the CRISPR world, CRISPR systems are highly evolutionarily diverse and there are many known differences in function and effect between CRISPR systems of different bacterial species (<xref ref-type="bibr" rid="bib74">Koonin et al., 2017</xref>; <xref ref-type="bibr" rid="bib67">Hille et al., 2018</xref>; <xref ref-type="bibr" rid="bib86">Makarova et al., 2020</xref>; <xref ref-type="bibr" rid="bib76">Koonin and Makarova, 2022</xref>). Experiments typically study a particular CRISPR system, and it is unclear which revealed mechanisms are specific to that system or are a more general property of CRISPR systems. For example, the spacer acquisition rate has been demonstrated to vary across particular phage sequences in several experiments (<xref ref-type="bibr" rid="bib66">Heler et al., 2019</xref>; <xref ref-type="bibr" rid="bib95">Modell et al., 2017</xref>; <xref ref-type="bibr" rid="bib103">Paez-Espino et al., 2013</xref>) and is the source of differences in spacer abundance in some experiments (<xref ref-type="bibr" rid="bib66">Heler et al., 2019</xref>), but whether this is a general principle that causes broad abundance distributions is not known. Many theoretical works also include mechanistic details such as a lag between infection and burst (<xref ref-type="bibr" rid="bib82">Levin et al., 2013</xref>; <xref ref-type="bibr" rid="bib117">Santos et al., 2014</xref>), multiple protospacers and spacers (typically with a fixed upper bound) (<xref ref-type="bibr" rid="bib140">Weinberger et al., 2012b</xref>; <xref ref-type="bibr" rid="bib72">Iranzo et al., 2013</xref>; <xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>; <xref ref-type="bibr" rid="bib25">Childs et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref>; <xref ref-type="bibr" rid="bib141">Weissman et al., 2018</xref>, spatial structure <xref ref-type="bibr" rid="bib106">Payne et al., 2018</xref>; <xref ref-type="bibr" rid="bib55">Haerter et al., 2011</xref>, autoimmunity <xref ref-type="bibr" rid="bib141">Weissman et al., 2018</xref>; <xref ref-type="bibr" rid="bib20">Chabas et al., 2021</xref>, and fitness costs of immunity and/or escape mutations <xref ref-type="bibr" rid="bib140">Weinberger et al., 2012b</xref>; <xref ref-type="bibr" rid="bib143">Weissman et al., 2021</xref>). Many phages also contain anti-CRISPRs which impact phage evolution and CRISPR immunity (<xref ref-type="bibr" rid="bib8">Bondy-Denomy et al., 2013</xref>; <xref ref-type="bibr" rid="bib71">Hwang and Maxwell, 2019</xref>). These details are all biologically important, but stripping them away as we do provides great insight into which population features depend on these details and which may be more general properties of adaptive immunity.</p><sec id="s3-1"><title>Diversity and average immunity</title><p>Experimental manipulations of CRISPR diversity have focused on changing the number of bacterial spacers present in the population (<xref ref-type="bibr" rid="bib131">van Houte et al., 2016</xref>; <xref ref-type="bibr" rid="bib100">Morley et al., 2017</xref>; <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>) while keeping phage diversity fixed (and low), with the exception of <xref ref-type="bibr" rid="bib53">Guillemet et al., 2021</xref> who also explored high vs. low phage diversity. In contrast, emergent phage and bacterial diversity are tightly coupled in our model (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). At high diversity, bacteria must ‘choose’ which of many phage clones to gain immunity against, meaning that they are then immune to a smaller fraction of the total phage population compared to when diversity is low. This is not a result of limiting bacteria and phage to a single spacer or protospacer; this trend also holds when there are multiple spacers or protospacers provided phage and bacteria diversity are correlated, as we showed in ‘Pathogen and host diversity must be considered together’.</p><p>Our toy model described in ‘Pathogen and host diversity must be considered together’ shows that the framework of average immunity provides a conceptually intuitive way to understand the impacts of different types of diversity and modes of evolution. Future work to explicitly model the population dynamics of multiple spacers and protospacers with this lens will allow us to understand how and when these different evolutionary modes arise. For instance, it remains unknown how the linkage of different spacers and protospacers within genomes would affect individual clone dynamics. Our work effectively assumes that all spacers and protospacers evolve independently and are uncoupled, but in real genomes evolving with CRISPR, spacers and protospacers may hitchhike to prominence through selection acting on a different sequence in the same genome. Models of CRISPR locus spacer addition have shown that trailer-end clonality emerges from selective sweeps of newly added spacers (<xref ref-type="bibr" rid="bib139">Weinberger et al., 2012a</xref>; <xref ref-type="bibr" rid="bib58">Han et al., 2013</xref>), and hitchhiking will affect interpretations that can be drawn from the abundance of individual spacer clones. Exploring correlations between spacer abundances at different locus positions can be done in experimental data (such as <xref ref-type="bibr" rid="bib103">Paez-Espino et al., 2013</xref>), and extending our simulation to explicitly include multiple protospacers and spacers per genome will provide further data.</p><p>Our results suggest that immune diversity itself may not be the most informative observable feature but that average immunity is what actually determines population outcomes. Indeed, when we introduced cross-reactivity between spacer sequences, we found that diversity decreased and that other processes such as establishment were impacted, but that average immunity still correctly predicted population sizes (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). Average immunity completely summarizes the effect of CRISPR immunity and accurately predicts population outcomes. Experiments that manipulate bacterial diversity only change average immunity if they include a changing proportion of sensitive bacteria as in <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref> (Figure 69A).</p><p>Our results showed complex outcomes and a wide range of overall spacer diversity despite limiting bacteria and phage to a single protospacer and spacer. We also observed rapid loss of previous spacer types as bacteria returned to the naive state before acquiring new spacers. In reality, bacteria can store multiple spacers in their CRISPR arrays (<xref ref-type="bibr" rid="bib105">Pavlova et al., 2021</xref>; <xref ref-type="bibr" rid="bib108">Pourcel et al., 2020</xref>) and phages can have several hundred to several thousand protospacer sequences which are determined by a particular protospacer-adjacent motif (PAM) in type I and II CRISPR systems (<xref ref-type="bibr" rid="bib80">Leenay et al., 2016</xref>). In <italic>S. thermophilus</italic> phage 2972, for example, there are about 230 protospacers that can be acquired into the CRISPR1 locus of <italic>S. thermophilus</italic> (<xref ref-type="bibr" rid="bib103">Paez-Espino et al., 2013</xref>) and 465 that can be acquired into the CRISPR3 locus. Similarly, many bacteria can store tens to hundreds of spacers in their CRISPR arrays (<xref ref-type="bibr" rid="bib105">Pavlova et al., 2021</xref>; <xref ref-type="bibr" rid="bib23">Chen et al., 2022</xref>; <xref ref-type="bibr" rid="bib13">Bradde et al., 2020</xref>; <xref ref-type="bibr" rid="bib108">Pourcel et al., 2020</xref>). Our single-spacer assumption is reasonable for the experimental systems we consider. In liquid culture experiments with staphylococci, most bacteria acquire a single spacer (<xref ref-type="bibr" rid="bib65">Heler et al., 2015</xref>; <xref ref-type="bibr" rid="bib66">Heler et al., 2019</xref>; <xref ref-type="bibr" rid="bib111">Pyenson and Marraffini, 2020</xref>), and in short-term experiments with <italic>S. thermophilus</italic>, most bacteria acquired just one CRISPR spacer over 2 weeks (<xref ref-type="bibr" rid="bib103">Paez-Espino et al., 2013</xref> or one to three spacers over 9 days <xref ref-type="bibr" rid="bib27">Common et al., 2019</xref>). In the experimental data we analysed here (a 200+ day experiment), the average number of newly acquired spacers hovered around 5 throughout the experiment (<xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>). In a long-term study of metagenomic data, most spacer matches to extant viral sequences were located near the leader end of CRISPR loci; conserved trailer-end spacers had very few matches to sampled viruses (<xref ref-type="bibr" rid="bib139">Weinberger et al., 2012a</xref>). All these results suggest that dynamics may be dominated by just a handful of spacers per bacterium. In addition, theoretical work has found that the most recently acquired spacer provides more immune benefit than older spacers (<xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref>; <xref ref-type="bibr" rid="bib58">Han et al., 2013</xref>). Our single-protospacer assumption for phages had a more extreme impact, however: in our model, we assumed in the non-cross-reactive case that a single point mutation allowed phages to escape from all CRISPR targeting, when in reality a phage with hundreds of protospacers may need mutations in many different protospacers to fully escape from the bacterial population. Previous work on the impact of CRISPR diversity takes place in this context: that having more diverse bacterial spacers means phages need mutations in multiple protospacers to escape, and that a single mutation only escapes a single bacterial spacer at most, leaving other bacteria still resistant (<xref ref-type="bibr" rid="bib19">Chabas et al., 2018</xref>; <xref ref-type="bibr" rid="bib131">van Houte et al., 2016</xref>; <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>). We approximated this scenario of gradually increasing phage fitness per protospacer mutation by adding cross-reactivity to our model and showed in ‘Cross-reactivity leads to dynamically unique evolutionary states’ that the relationship between diversity and average immunity does not qualitatively change. We also observed the same qualitative trend in a toy model exploring the effects of both multiple spacers and multiple protospacers (‘Pathogen and host diversity must be considered together’).</p><p>Our model makes quantitative predictions about the relationship of population size and population outcomes to average immunity that can be tested in data. We directly calculated average immunity in experimental data without the need to assemble phage genomes (<xref ref-type="fig" rid="fig7">Figure 7</xref>), and we found that average immunity is anticorrelated with phage population size in data in one experimental dataset, as predicted by our model (Figure 77). However, we did not find a correlation between average immunity and read count (a proxy for population size) in wastewater treatment plant data (Figure 90). When calculating average immunity using experimental data, one must make assumptions about the immune benefit of spacers. In our work, we assumed that spacer and protospacer sequences that belong to the same similarity group provide perfect immunity. Other more complex assumptions are possible, and there has been a great deal of work quantifying the efficiency of spacers based on the position of SNPs in the protospacer in vitro (see <xref ref-type="bibr" rid="bib127">Sternberg et al., 2015</xref> for an example) and in vivo (<xref ref-type="bibr" rid="bib125">Soto-Perez et al., 2019</xref>). Additionally, phages regularly acquire mutations in PAMs, and these mutations strongly decrease the targeting efficiency of bacterial spacers (<xref ref-type="bibr" rid="bib80">Leenay et al., 2016</xref>; <xref ref-type="bibr" rid="bib129">Sun et al., 2013</xref>).</p><p>In certain limits, average immunity can be related to the Morisita–Horn similarity index <inline-formula><mml:math id="inf268"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula><xref ref-type="bibr" rid="bib146">Wolda, 1981</xref> (see Appendix 1), where instead of comparing two populations from different timepoints or different regions, we compared bacteria and phage populations scaled by the immune benefit of CRISPR. By comparing our definition of average immunity to the Morisita–Horn index, we find that the Morisita overlap is constant across all parameters we study, which implies that the population diversity evolves to attain the highest possible overlap. Average immunity is also theoretically similar to the concept of distributed immunity introduced by <xref ref-type="bibr" rid="bib25">Childs et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref>, the ‘immunity’ quantity calculated by <xref ref-type="bibr" rid="bib58">Han et al., 2013</xref>, and the probability of an immune encounter used by <xref ref-type="bibr" rid="bib72">Iranzo et al., 2013</xref> to derive mean-field population predictions. The mathematical definition of average immunity is slightly different than these quantities, but the effect on populations is strikingly similar, and it is significant that several different models and different metrics find that a quantification of immunity is the important predictor for population-level outcomes.</p></sec><sec id="s3-2"><title>In silico time-shift experiments yield qualitative trends</title><p>We calculated average immunity in two experimental datasets and performed synthetic time-shift experiments by calculating average immunity between time-shifted populations of bacteria and phage. This effectively replicates explicit time-shift experiments (<xref ref-type="bibr" rid="bib113">Richman et al., 2003</xref>; <xref ref-type="bibr" rid="bib45">Frost et al., 2005</xref>; <xref ref-type="bibr" rid="bib97">Moore et al., 2009</xref>; <xref ref-type="bibr" rid="bib7">Blanquart and Gandon, 2013</xref>; <xref ref-type="bibr" rid="bib77">Koskella, 2014</xref>; <xref ref-type="bibr" rid="bib18">Chabas et al., 2016</xref>; <xref ref-type="bibr" rid="bib111">Pyenson and Marraffini, 2020</xref>; <xref ref-type="bibr" rid="bib79">Laanto et al., 2017</xref>; <xref ref-type="bibr" rid="bib27">Common et al., 2019</xref>; <xref ref-type="bibr" rid="bib40">Dewald-Wang et al., 2022</xref>). A similar time-shift calculation using sequence data was performed by <xref ref-type="bibr" rid="bib53">Guillemet et al., 2021</xref>; they approached the question from the phage perspective and found that phages are most infectious against bacteria from the past and least infectious against bacteria from the future. Our results show that powerful insights into the dynamical immune state of a population can be obtained from sequencing data without explicitly performing time-shift experiments. We applied the same simple method to two very different experimental populations, suggesting that this analysis may be feasible in other time-series datasets, including from other natural microbial populations.</p><p>Our model predicts that an immune-evolving population in true steady state must eventually experience declining past immunity. CRISPR arrays are not infinite, and spacers must eventually be lost, even though this may happen on very long timescales. This pattern of declining past immunity is also in line with the expectations of fluctuating selection dynamics in which more rare genotypes are more fit (<xref ref-type="bibr" rid="bib46">Gaba and Ebert, 2009</xref>; <xref ref-type="bibr" rid="bib57">Hall et al., 2011</xref>; <xref ref-type="bibr" rid="bib7">Blanquart and Gandon, 2013</xref>; <xref ref-type="bibr" rid="bib40">Dewald-Wang et al., 2022</xref>). Previous theoretical work applied to vertebrate adaptive immunity also supports the existence of a peak in adaptive benefit in the recent past (<xref ref-type="bibr" rid="bib7">Blanquart and Gandon, 2013</xref>; <xref ref-type="bibr" rid="bib101">Nourmohammad et al., 2016</xref>), and some experimental time-shift studies have reported a peak in adaptation for bacteria-phage interactions (<xref ref-type="bibr" rid="bib57">Hall et al., 2011</xref>; <xref ref-type="bibr" rid="bib77">Koskella, 2014</xref>; <xref ref-type="bibr" rid="bib40">Dewald-Wang et al., 2022</xref> and for HIV-immune system interactions <xref ref-type="bibr" rid="bib7">Blanquart and Gandon, 2013</xref>; <xref ref-type="bibr" rid="bib101">Nourmohammad et al., 2016</xref>). We saw two qualitatively different time-shift curves in the experimental data we analysed: in the long-term laboratory coevolution data, bacteria were more immune to all past phages and less immune to all future phages (<xref ref-type="fig" rid="fig7">Figure 7C</xref>), while in the wastewater treatment plant data, bacteria were most immune to phages in their present context and less immune to phages in both the past and the future (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). The time-shift pattern of the laboratory coevolution data was consistent with experimental time-shift data that is typically said to be indicative of arms-race dynamics (<xref ref-type="bibr" rid="bib113">Richman et al., 2003</xref>; <xref ref-type="bibr" rid="bib45">Frost et al., 2005</xref>; <xref ref-type="bibr" rid="bib97">Moore et al., 2009</xref>; <xref ref-type="bibr" rid="bib7">Blanquart and Gandon, 2013</xref>; <xref ref-type="bibr" rid="bib6">Betts et al., 2018</xref>; <xref ref-type="bibr" rid="bib27">Common et al., 2019</xref>), while the wastewater data may be consistent with a ‘zoomed-out’ view of the eventual decline in immunity in both the distant past and distant future (<xref ref-type="bibr" rid="bib101">Nourmohammad et al., 2016</xref>; <xref ref-type="bibr" rid="bib53">Guillemet et al., 2021</xref>). Indeed, the distinction between arms-race dynamics and fluctuating selection dynamics in time-shift experiments may be a question of the timescale being investigated (<xref ref-type="bibr" rid="bib46">Gaba and Ebert, 2009</xref>; <xref ref-type="bibr" rid="bib7">Blanquart and Gandon, 2013</xref>; <xref ref-type="bibr" rid="bib40">Dewald-Wang et al., 2022</xref>). Our simulation results may qualitatively match both of these regimes depending on the timescale observed, which suggests that measuring very long-term coexistence is an area for further work in host-parasite coexistence experiments. In general, we expect that the timescale of memory length is related to the size of CRISPR arrays: if overall rates of spacer gain and loss are balanced, then we expect an individual spacer’s lifetime in the population to be proportional to array length. The factors that affect the timescale of memory length is an interesting area for further work.</p><p>One reason why past immunity did not unambiguously decline in our analysis of the laboratory coevolution data may be that spacer loss was not observed in the original experiment (<xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>. This is also true of several other similar experiments with <italic>S. thermophilus</italic> <xref ref-type="bibr" rid="bib103">Paez-Espino et al., 2013</xref>; <xref ref-type="bibr" rid="bib141">Weissman et al., 2018</xref>), though spacer loss was directly observed coincident with spacer acquisition in <xref ref-type="bibr" rid="bib39">Deveau et al., 2008</xref>. Spacer loss has also been observed in other experimental systems (<xref ref-type="bibr" rid="bib73">Jiang et al., 2013</xref>; <xref ref-type="bibr" rid="bib112">Rao et al., 2017</xref>; <xref ref-type="bibr" rid="bib29">Deecker and Ensminger, 2020</xref>; <xref ref-type="bibr" rid="bib49">Garrett, 2021</xref>), and indirect evidence of spacer loss through sequence comparisons has been reported for <italic>S. thermophilus</italic> (<xref ref-type="bibr" rid="bib68">Horvath et al., 2008</xref> and metagenomic data <xref ref-type="bibr" rid="bib64">Held et al., 2010</xref>; <xref ref-type="bibr" rid="bib139">Weinberger et al., 2012a</xref>). Spacers may also be functionally lost despite remaining in the genome, either from stochastic decoupling of RNA polymerase (<xref ref-type="bibr" rid="bib148">Zoephel and Randau, 2013</xref>; <xref ref-type="bibr" rid="bib89">Martynov et al., 2017</xref>; <xref ref-type="bibr" rid="bib125">Soto-Perez et al., 2019</xref> or from a dilution effect of competition for limited Cas protein complexes <xref ref-type="bibr" rid="bib89">Martynov et al., 2017</xref>; <xref ref-type="bibr" rid="bib13">Bradde et al., 2020</xref>; <xref ref-type="bibr" rid="bib49">Garrett, 2021</xref>). The ‘loss’ rate in our model could also be taken to be gain and loss of the entire CRISPR system, which is known to happen (<xref ref-type="bibr" rid="bib31">Delaney et al., 2012</xref>; <xref ref-type="bibr" rid="bib114">Rollie et al., 2020</xref>), although this would likely happen on much slower timescales than the acquisition and loss we model. The qualitative shape and timescale of time-shift curves like the ones we presented may indirectly contain information about the timescale of spacer loss.</p><p>We found in our simulations that memory length decreased as spacer acquisition probability increased and as phage mutation rate decreased: if bacteria followed phages more closely (higher <inline-formula><mml:math id="inf269"><mml:mi>η</mml:mi></mml:math></inline-formula>) or if phages evolved more slowly (lower <inline-formula><mml:math id="inf270"><mml:mi>μ</mml:mi></mml:math></inline-formula>), the peak in past immunity was closer to the present and memory was more quickly lost (<xref ref-type="fig" rid="fig7">Figure 7A, E, and F</xref>). A similar correspondence was derived in a theoretical model of optimal immune memory formation in vertebrates: more frequent sampling of the pathogen landscape (corresponding to higher spacer acquisition <inline-formula><mml:math id="inf271"><mml:mi>η</mml:mi></mml:math></inline-formula> in our model) led to faster memory loss (<xref ref-type="bibr" rid="bib92">Mayer et al., 2019</xref>). Notably, that result is the optimal update scheme for an immune system wishing to minimize the costs of infection; there is no explicit optimization in our model, yet we find a pattern consistent with a potentially optimal solution.</p></sec><sec id="s3-3"><title>Vertebrate adaptive immunity</title><p>CRISPR adaptive immunity is mechanistically very different from the vertebrate adaptive immune system, yet there are several striking conceptual similarities between them and in the way past theoretical works have modelled vertebrate immunity. For example, phenomenological models of binding affinity between antigens and the immune system have used the degree of similarity between strings as a metric for interaction strength (<xref ref-type="bibr" rid="bib37">Detours and Perelson, 1999</xref>; <xref ref-type="bibr" rid="bib38">Detours and Perelson, 2000</xref>; <xref ref-type="bibr" rid="bib21">Chao et al., 2005</xref>; <xref ref-type="bibr" rid="bib136">Wang et al., 2015</xref>; <xref ref-type="bibr" rid="bib101">Nourmohammad et al., 2016</xref>; <xref ref-type="bibr" rid="bib116">Sachdeva et al., 2020</xref>), and more abstract models of the change in immunity after a virus mutation have also used string similarity to track the strength of immune coverage (<xref ref-type="bibr" rid="bib85">Luksza and Lässig, 2014</xref>; <xref ref-type="bibr" rid="bib115">Rouzine and Rozhnova, 2018</xref>; <xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>). This is a simplification of a complex protein-protein interaction in the case of the vertebrate immune system (<xref ref-type="bibr" rid="bib2">Altan-Bonnet et al., 2020</xref>), but it is nearly identical to the actual mechanism of CRISPR immunity, suggesting that lessons from models of CRISPR immunity may in turn be applicable to other forms of adaptive immunity.</p><p>Pathogen evolution has been extensively explored in models of vertebrate immunity, and here too we can draw conceptual parallels. We found that the speed of phage evolution depended sublinearly on phage population size in our model (<xref ref-type="fig" rid="fig6">Figure 6C</xref>), analogous to the weak positive dependence on population size described by <xref ref-type="bibr" rid="bib88">Marchi et al., 2021</xref>. Adding cross-reactivity between spacer types in our model changed overall population outcomes as well as population dynamics. We observed a traveling wave regime in which new phage mutants ‘pull’ existing bacterial clones along, even if their matching clone is small or extinct (Figure 54). This travelling wave regime is qualitatively similar to that observed in theoretical models of ‘ballistic’ pathogen evolution in effective low-dimensional antigenic space (<xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>; <xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref>; <xref ref-type="bibr" rid="bib88">Marchi et al., 2021</xref>). Similar clone population dynamics were observed in a model of B cell activation and memory generation in which existing memory B cells are reactivated in response to infection with a mutated virus that remains within its cross-reactivity radius (<xref ref-type="bibr" rid="bib22">Chardès et al., 2022</xref>). We also observed splitting of lineages into divergent subtypes in our model, a phenomenon that has been studied in vertebrate pathogen evolution as well (<xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref>; <xref ref-type="bibr" rid="bib88">Marchi et al., 2021</xref>). We found that the average number of distinct clans was proportional to overall diversity but that increasing cross-reactivity decreased the average clan size (‘Number and size of clone clans’). These qualitative similarities highlight the usefulness of CRISPR adaptive immunity to understand population dynamics that also occur in the vertebrate immune system.</p><p>Selection in the vertebrate immune system happens at many distinct stages within individuals, including T cell receptor selection in the thymus (<xref ref-type="bibr" rid="bib16">Camaglia et al., 2022</xref> and affinity maturation of B cells following an immune challenge <xref ref-type="bibr" rid="bib22">Chardès et al., 2022</xref>; <xref ref-type="bibr" rid="bib102">Nourmohammad et al., 2019</xref>; <xref ref-type="bibr" rid="bib101">Nourmohammad et al., 2016</xref>; <xref ref-type="bibr" rid="bib96">Molari et al., 2020</xref>). Selection also happens at the population level as pathogens and individuals coevolve over time (<xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref>; <xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>, for instance, in the evolution of influenza <xref ref-type="bibr" rid="bib85">Luksza and Lässig, 2014</xref>; <xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>). In contrast, within-host dynamics are much simpler in bacteria, and the possibilities for within-host coevolution are especially limited in the case of virulent phages that kill their hosts after a single infection. Similarly, in the vertebrate immune system, extremely high immune diversity is possible in a single individual, whereas in CRISPR immunity, total diversity per individual is many orders of magnitude lower: most bacteria contain tens of spacers with a very few examples of a few hundred spacers (<xref ref-type="bibr" rid="bib105">Pavlova et al., 2021</xref>). This reintroduces the question of how to think about immunity in microbial populations, whether as playing out on the level of individuals or on the level of the entire population. Finally, unlike the vertebrate adaptive immune system, CRISPR immunity is heritable, and so the optimal immune strategy for bacteria takes place on a timescale potentially much longer than an individual’s lifetime as well as on the level of the entire population <xref ref-type="bibr" rid="bib91">Mayer et al., 2016</xref>. We have highlighted several analogies between CRISPR adaptive immunity and vertebrate adaptive immunity. Overall, the mechanistic simplicity and experimental tractability of CRISPR immunity mean that abstract ideas from vertebrate immunity can be linked to measurable features of CRISPR immunity, and insights from CRISPR immunity may be useful in understanding vertebrate immunity as well.</p></sec><sec id="s3-4"><title>Primed acquisition</title><p>In some CRISPR systems, an imprecise match between a spacer and protospacer results in a much higher spacer acquisition rate, a phenomenon called priming (<xref ref-type="bibr" rid="bib112">Rao et al., 2017</xref>). Including cross-reactivity in our model is a way to explore the effect of primed acquisition. However, we modelled cross-reactivity as a change in phage infection success probability, whereas in primed acquisition it is the spacer acquisition rate that changes. Because bacteria must lose their spacer before gaining a new spacer in our model, including primed acquisition directly would require expanding bacterial arrays to at least two spacers. The acquisition probability <inline-formula><mml:math id="inf272"><mml:mi>η</mml:mi></mml:math></inline-formula> could then become a function of protospacer-spacer similarity to directly model primed acquisition.</p></sec><sec id="s3-5"><title>Selection patterns in CRISPR immunity</title><p>The mechanism of selection for immune variants in CRISPR adaptive immunity is a matter of debate. We observed several features that suggest the presence of negative frequency-dependent selection in our model: (a) decreased clone growth rates as clone size increased, (b) cyclic clone size dynamics as immune pairs oscillate in size, and (c) continual turnover in spacer types over time. This is consistent with recent experimental observations of negative frequency-dependent selection in host-pathogen systems (<xref ref-type="bibr" rid="bib6">Betts et al., 2018</xref>; <xref ref-type="bibr" rid="bib53">Guillemet et al., 2021</xref>). Our model also contains the base assumption that phages that can successfully infect dominant bacterial strains will experience positive selection, generating ‘kill-the-winner‘ dynamics that lead to negative frequency-dependent selection for bacteria (<xref ref-type="bibr" rid="bib139">Weinberger et al., 2012a</xref>). Our model does not capture true host-pathogen coevolution because bacteria are not able to evolve beyond ‘following’ the mutational landscape of phages by acquiring spacers. In true coevolution, bacterial genomic mutations, apart from the ability to acquire spacers, are also drivers of evolution and sources of selection pressure on phages.</p></sec><sec id="s3-6"><title>Phase transitions in immunity</title><p>We observed large population size fluctuations when average immunity reached a particular value of approximately 10% for the parameters we used (Figure 31). This critical value is determined by a balance of the rate of spacer acquisition and spacer loss that leads to exactly equal fitness for both bacteria with spacers and bacteria without spacers (see ‘Dominant balance approximations for <inline-formula><mml:math id="inf273"><mml:mi>ν</mml:mi></mml:math></inline-formula>’). Despite the presence of spacers with non-zero effectiveness, near this critical point the population appears to behave as if there is no CRISPR immunity at all. This has two interesting results: first, the probability of phage establishment drops to zero for some simulations near this critical point (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), since if CRISPR has no influence then mutant phages do not experience strong positive selection. Second, population sizes become unstable near the transition: outcomes with quite different total bacteria population size and fraction of bacteria with spacers are possible (Figures 30 and 31). This critical point will be interesting to explore further as a possible phase transition.</p></sec><sec id="s3-7"><title>Experimentally accessible parameters</title><p>We found that diversity in our model depended on spacer acquisition rate, spacer effectiveness, and spacer mutation rate. These parameters are all known to vary in natural systems, and some may also be experimentally manipulated. CRISPR systems display a range of spacer acquisition rates even within the same system (<xref ref-type="bibr" rid="bib66">Heler et al., 2019</xref>), and both spacer acquisition rate and spacer effectiveness may be controlled by the level of expression of Cas proteins, which has been found to be connected to the quorum sensing pathway (<xref ref-type="bibr" rid="bib69">Høyland-Kroghsbo et al., 2017</xref>). Additionally, recent work has found that spacer acquisition is more efficient at slow bacterial growth rate because phages also grow more slowly, giving bacteria more time to acquire spacers (<xref ref-type="bibr" rid="bib70">Høyland-Kroghsbo et al., 2018</xref>; <xref ref-type="bibr" rid="bib41">Dimitriu et al., 2022</xref>). This change in bacterial growth rate can be controlled by nutrient concentration (<xref ref-type="bibr" rid="bib41">Dimitriu et al., 2022</xref>; <xref ref-type="bibr" rid="bib106">Payne et al., 2018</xref>, temperature <xref ref-type="bibr" rid="bib70">Høyland-Kroghsbo et al., 2018</xref>, or by bacteriostatic antibiotics which slow bacterial growth without killing <xref ref-type="bibr" rid="bib41">Dimitriu et al., 2022</xref>). Phage mutations rates also vary and may be experimentally modified (<xref ref-type="bibr" rid="bib78">Kysela and Turner, 2007</xref>). These findings all represent possible experimental manipulations of parameters relevant for CRISPR immunity; for example, given these findings we predict that a bacteria-phage population exposed to bacteriostatic antibiotics would evolve higher CRISPR spacer diversity than one without antibiotics.</p></sec></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Model</title><p>In this section, we describe the details of our phenomenological model of bacteria and phages, providing more detail for <xref ref-type="fig" rid="fig1">Figure 1A</xref>. Sections ‘Reactions’ and ‘Master equation’ list the stochastic interactions we simulate, and ‘Clone size master equation’ lists master equations that are used to derive mean-field equations for this dynamical system (Total population size) and clone size distributions for bacteria and phages (Appendix 2).</p><p>We model bacteria and phages interacting in a chemostat. The populations we track are nutrient concentration (<inline-formula><mml:math id="inf274"><mml:mi>C</mml:mi></mml:math></inline-formula>), phages (<inline-formula><mml:math id="inf275"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>), and bacteria (<inline-formula><mml:math id="inf276"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>). Bacteria can either have no spacer (<inline-formula><mml:math id="inf277"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula>) or a spacer of type <inline-formula><mml:math id="inf278"><mml:mi>i</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf279"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula>), and phages can have a single protospacer of type <inline-formula><mml:math id="inf280"><mml:mi>j</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf281"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:math></inline-formula>). Nutrients flow in at concentration <italic>C</italic><sub>0</sub> with rate <inline-formula><mml:math id="inf282"><mml:mi>F</mml:mi></mml:math></inline-formula>, and all species flow out with rate <inline-formula><mml:math id="inf283"><mml:mi>F</mml:mi></mml:math></inline-formula>. The total number of bacteria with a spacer is <inline-formula><mml:math id="inf284"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> and the total number of bacteria is <inline-formula><mml:math id="inf285"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>. Bacteria grow at rate <inline-formula><mml:math id="inf286"><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula>. With rate <inline-formula><mml:math id="inf287"><mml:mi>α</mml:mi></mml:math></inline-formula>, a phage interacts with a bacterium. With probability <inline-formula><mml:math id="inf288"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, the phage will kill bacteria without a matching spacer and produce a burst of new phages with size <inline-formula><mml:math id="inf289"><mml:mi>B</mml:mi></mml:math></inline-formula>, while for bacteria with a matching spacer that probability is reduced to <inline-formula><mml:math id="inf290"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>V</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf291"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>e</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). Bacteria without spacers that survive an attack have a chance to acquire a spacer with probability <inline-formula><mml:math id="inf292"><mml:mi>η</mml:mi></mml:math></inline-formula>. Bacteria with a spacer lose their spacer at rate <inline-formula><mml:math id="inf293"><mml:mi>r</mml:mi></mml:math></inline-formula>. Phages are limited to a single protospacer, and phages can mutate to a new protospacer type with probability <inline-formula><mml:math id="inf294"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf295"><mml:mi>μ</mml:mi></mml:math></inline-formula> is the per-base mutation rate and <inline-formula><mml:math id="inf296"><mml:mi>L</mml:mi></mml:math></inline-formula> is the protospacer length (<inline-formula><mml:math id="inf297"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> in all simulations). Parameter descriptions and default values are shown in Table 3. See refs <xref ref-type="bibr" rid="bib143">Weissman et al., 2021</xref>; <xref ref-type="bibr" rid="bib54">Gurney et al., 2019</xref> for recent examples of other chemostat-based models.</p><sec id="s4-1-1"><title>Reactions</title><p><xref ref-type="table" rid="table1">Table 1</xref> lists all the interactions present in our model between individual bacteria (<inline-formula><mml:math id="inf298"><mml:mi>b</mml:mi></mml:math></inline-formula>), phages (<inline-formula><mml:math id="inf299"><mml:mi>V</mml:mi></mml:math></inline-formula>), and nutrients (<inline-formula><mml:math id="inf300"><mml:mi>C</mml:mi></mml:math></inline-formula>).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Model reactions.</title></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf301"><mml:mrow><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mover accent="true"><mml:mo>→</mml:mo><mml:mo>g</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">Bacterium divides</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf302"><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mo>→</mml:mo><mml:mo>F</mml:mo></mml:mover><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">Bacterium flows out</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf303"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mover accent="true"><mml:mo>→</mml:mo><mml:mo>F</mml:mo></mml:mover><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">Phage flows out</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">∅</mml:mi><mml:mover><mml:mo>→</mml:mo><mml:mpadded width="+0.611em" lspace="0.278em" voffset=".15em"><mml:mi>F</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mpadded></mml:mover><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Nutrients flow in</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf305"><mml:mrow><mml:mi>C</mml:mi><mml:mover accent="true"><mml:mo>→</mml:mo><mml:mo>F</mml:mo></mml:mover><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">Nutrients flow out</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf306"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mover accent="true"><mml:mo>→</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mover><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">Interaction, phage wins,</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom"><inline-formula><mml:math id="inf307"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> probability of <inline-formula><mml:math id="inf308"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> mutuant phages</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Interaction, bacterium survives</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf310"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Interaction, bacterium survives and acquires a spacer</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf311"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Interaction, phage wins,</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom"><inline-formula><mml:math id="inf312"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> probability of <inline-formula><mml:math id="inf313"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> mutant phages</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf314"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:munder><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>→</mml:mo></mml:munder><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Interaction, bacterium survives</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf315"><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mover accent="true"><mml:mo>→</mml:mo><mml:mo>r</mml:mo></mml:mover><mml:msup><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">Bacterium loses spacer</td></tr></tbody></table></table-wrap><p>In <xref ref-type="table" rid="table1">Table 1</xref>, <inline-formula><mml:math id="inf316"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of a phage with protospacer type <inline-formula><mml:math id="inf317"><mml:mi>j</mml:mi></mml:math></inline-formula> killing a bacteria with spacer type <inline-formula><mml:math id="inf318"><mml:mi>i</mml:mi></mml:math></inline-formula>.</p><p><inline-formula><mml:math id="inf319"><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="table" rid="table1">Table 1</xref> is the probability of <inline-formula><mml:math id="inf320"><mml:mi>n</mml:mi></mml:math></inline-formula> mutant phages in a burst, given by a binomial distribution:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mfrac linethickness="0"><mml:mi>B</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf321"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the probability of no mutations for an individual phage. <inline-formula><mml:math id="inf322"><mml:mi>L</mml:mi></mml:math></inline-formula> is the protospacer length and <inline-formula><mml:math id="inf323"><mml:mi>μ</mml:mi></mml:math></inline-formula> is the mutation probability per base per generation.</p><p>In this formulation of the mutation term, new mutants are assumed to be a new, not previously existent, phage type which increases <inline-formula><mml:math id="inf324"><mml:mi>m</mml:mi></mml:math></inline-formula> by <inline-formula><mml:math id="inf325"><mml:mi>n</mml:mi></mml:math></inline-formula>, the number of mutations (<inline-formula><mml:math id="inf326"><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>). In our simulations, phage mutations can happen to existing types, but these are rare events and we neglect them in our theoretical analysis.</p></sec><sec id="s4-1-2"><title>Master equation</title><p>The reactions in <xref ref-type="table" rid="table1">Table 1</xref> can be formulated as a master equation describing the probability of observing <inline-formula><mml:math id="inf327"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula> bacteria without spacers, the set of <inline-formula><mml:math id="inf328"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> bacteria with spacers of type <inline-formula><mml:math id="inf329"><mml:mi>i</mml:mi></mml:math></inline-formula>, the set of <inline-formula><mml:math id="inf330"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:math></inline-formula> phages with protospacers of type <inline-formula><mml:math id="inf331"><mml:mi>j</mml:mi></mml:math></inline-formula>, and a nutrient concentration of <inline-formula><mml:math id="inf332"><mml:mi>C</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf333"><mml:mi>t</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ10">Equation 10</xref>).<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>η</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Each term is included only if all respective population quantities are <inline-formula><mml:math id="inf334"><mml:mrow><mml:mi/><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>; for instance, the first term is only included if <inline-formula><mml:math id="inf335"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, since if <inline-formula><mml:math id="inf336"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> then <inline-formula><mml:math id="inf337"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and the entire term is negative and non-physical. This is important to note especially in terms containing <inline-formula><mml:math id="inf338"><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, which are only included if <inline-formula><mml:math id="inf339"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-1-3"><title>Clone size master equation</title><p>We can also write master equations for the total number of clones of size <inline-formula><mml:math id="inf340"><mml:mi>k</mml:mi></mml:math></inline-formula>. These equations describe the population-level distribution of clone sizes instead of the size of a single typical clone as in <xref ref-type="disp-formula" rid="equ127 equ159">Equations 123 and 147</xref>.</p><p>The master equation for <italic>b</italic><sub><italic>k</italic></sub>, the number of bacteria clones of size <inline-formula><mml:math id="inf341"><mml:mi>k</mml:mi></mml:math></inline-formula>, is:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>Bacteria growth</mml:mtext></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>Removal of spacer-containing bacteria by chemostat outflow or spacer loss</mml:mtext></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mi>α</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:munder><mml:mi>ℓ</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>Phage predation - reduces clone size by 1 for each successful infection</mml:mtext></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mi>α</mml:mi><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>New bacteria clones from spacer acquisition</mml:mtext></mml:mrow></mml:munder></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The last term representing spacer acquisition is complicated: <inline-formula><mml:math id="inf342"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁣</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is the total number of phages which contain protospacers that match bacteria clones of size <inline-formula><mml:math id="inf343"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, multiplied by the probability of getting that protospacer if infected by that phage. In other words, these are the phages that bacteria clones of size <inline-formula><mml:math id="inf344"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> could acquire spacers from to increase to size <inline-formula><mml:math id="inf345"><mml:mi>k</mml:mi></mml:math></inline-formula>, multiplied by the probability of acquiring a particular spacer from those phages. In a model where phages are all identical with a large number of protospacers <inline-formula><mml:math id="inf346"><mml:mi>m</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf347"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁣</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf348"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> is the total number of phages and <inline-formula><mml:math id="inf349"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> is the probability of acquiring a particular spacer. If instead phages can only have a single protospacer, <inline-formula><mml:math id="inf350"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁣</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is not known in general, but approximations may be found; for instance, if there are <inline-formula><mml:math id="inf351"><mml:mi>m</mml:mi></mml:math></inline-formula> phage types present and all phage clones are the same size, <inline-formula><mml:math id="inf352"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁣</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is again equal to <inline-formula><mml:math id="inf353"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>The corresponding master equation for <inline-formula><mml:math id="inf354"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">ℓ</mml:mi></mml:msub></mml:math></inline-formula>, the number of phage clones of size <inline-formula><mml:math id="inf355"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula>, is:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>ℓ</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>Phage death from chemostat flow and adsorption</mml:mtext></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mi>α</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>k</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ℓ</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>Phage burst after infecting spacer-containing bacteria (subtracting mutant phages which become new clones)</mml:mtext></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mi>α</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>ℓ</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>Phage burst after infecting bacteria without spacers</mml:mtext></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>ℓ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>ℓ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msup><mml:mi>ℓ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:msup><mml:mi>ℓ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>ℓ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>ℓ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:msup><mml:mi>ℓ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>New phage clones created by mutation from both spacer-containing and naive bacteria</mml:mtext></mml:mrow></mml:munder></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The phage master equation assumes that all new mutants are unique and that they are a type not currently present in the population.</p><p><inline-formula><mml:math id="inf356"><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is a binomial distribution giving the probability of <inline-formula><mml:math id="inf357"><mml:mi>n</mml:mi></mml:math></inline-formula> mutant phages per burst (<xref ref-type="disp-formula" rid="equ9">Equation 9</xref>).</p><p><inline-formula><mml:math id="inf358"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> is the probability of phage successfully infecting bacteria, and in general is an unknown function of both <inline-formula><mml:math id="inf359"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf360"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula>. All details of immunity are contained in <inline-formula><mml:math id="inf361"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>; later we discuss certain choices of <inline-formula><mml:math id="inf362"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> and their implications for the model and population dynamics. <inline-formula><mml:math id="inf363"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> with no functional arguments is the probability of phage success against bacteria with no spacers, a constant.</p></sec></sec><sec id="s4-2"><title>Mean-field model results</title><sec id="s4-2-1"><title>Total population size</title><p>These mean-field equations for total bacteria, bacteria with spacers, phages, and nutrients are the backbone of our analytic model results. Throughout this work, we assume that clone dynamics take place in a background of total populations at steady state; these equations describe the model that we solve to find these steady-state quantities underlying results in ‘Bacteria and phages dynamically coexist and coevolve’, ‘Phages drive stable emergent sequence diversity’, ‘What determines the fitness and establishment of new mutants?’, ‘Cross-reactivity leads to dynamically unique evolutionary states’, and ‘Dynamics are determined by diversity’.</p><p>The total number of bacteria with spacers, <inline-formula><mml:math id="inf364"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula>, is equal to <inline-formula><mml:math id="inf365"><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and the total number of phages, <inline-formula><mml:math id="inf366"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, is <inline-formula><mml:math id="inf367"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∑</mml:mo><mml:mi>ℓ</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf368"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mi>ℓ</mml:mi><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and summing over <inline-formula><mml:math id="inf369"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf370"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ11 equ12">Equations 11 and 12</xref> gives mean-field equations:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can also write mean-field equations for the total number of bacteria without spacers, <inline-formula><mml:math id="inf371"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula>, and the total nutrients, <inline-formula><mml:math id="inf372"><mml:mi>C</mml:mi></mml:math></inline-formula>. The total number of bacteria <inline-formula><mml:math id="inf373"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> is <inline-formula><mml:math id="inf374"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The probability of phage success against bacteria with spacers, averaged across the whole population, is given by <inline-formula><mml:math id="inf375"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ℓ</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">ℓ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p><p><inline-formula><mml:math id="inf376"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:math></inline-formula> is not known in general, but it can be simplified if certain assumptions are made about the population. In particular, we begin by assuming that immunity is all-or-nothing: if a bacterium has a matching spacer to a phage, the phage success probability is reduced to <inline-formula><mml:math id="inf377"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (where <inline-formula><mml:math id="inf378"><mml:mi>e</mml:mi></mml:math></inline-formula> is the ‘spacer effectiveness’), but if a bacterium has a spacer that is not exactly matching, that spacer confers no immunity and the phage probability of success is <inline-formula><mml:math id="inf379"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, the same as against naive bacteria. This amounts to defining <inline-formula><mml:math id="inf380"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> in terms of the spacer type <inline-formula><mml:math id="inf381"><mml:mi>i</mml:mi></mml:math></inline-formula> and protospacer type <inline-formula><mml:math id="inf382"><mml:mi>j</mml:mi></mml:math></inline-formula> as follows:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If each bacterium and phage can have only one spacer or protospacer, then the number of bacteria or phage with a particular spacer type <inline-formula><mml:math id="inf383"><mml:mi>i</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf384"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf385"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula>, respectively, and<disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ13">Equations 13</xref>–17 can be solved analytically at steady state if we further assume <inline-formula><mml:math id="inf386"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf387"><mml:mi>m</mml:mi></mml:math></inline-formula> is the average number of bacterial clones at steady state. This assumption is described in detail in ‘Measuring diversity’. The solution is exactly the mean-field analytic solution described in <xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref> with the simple replacement of the parameter <inline-formula><mml:math id="inf388"><mml:mi>e</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf389"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-2-2"><title>Phage extinction threshold</title><p>This section relates to <xref ref-type="fig" rid="fig1">Figure 1E</xref> in ‘Bacteria and phages dynamically coexist and coevolve’.</p><p>We reported in our previous work (<xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>) that <xref ref-type="disp-formula" rid="equ13 equ14 equ15">Equations 13–15</xref>–17 experience a change in fixed point at a critical threshold of the phage infection success probability <inline-formula><mml:math id="inf390"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>: below <inline-formula><mml:math id="inf391"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, phages are driven extinct (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). This is the same extinction threshold reported by <xref ref-type="bibr" rid="bib106">Payne et al., 2018</xref> as the cutoff for achieving herd immunity in a well-mixed bacterial population. To a first approximation, phages must successfully infect every <inline-formula><mml:math id="inf392"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> bacteria they encounter, but if bacteria are growing quickly, then phage must do better to overcome bacterial growth. The correction gives <inline-formula><mml:math id="inf393"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mtext>bacterial birth rate</mml:mtext><mml:mtext>phage birth rate</mml:mtext></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <inline-formula><mml:math id="inf394"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mtext>phage generation time</mml:mtext><mml:mtext>bacterial generation time</mml:mtext></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as reported in <xref ref-type="bibr" rid="bib106">Payne et al., 2018</xref>. To see this, we note that the bacterial birth rate in our model is <inline-formula><mml:math id="inf395"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> when phage population sizes are small, and the phage birth rate in our model is <inline-formula><mml:math id="inf396"><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> since <inline-formula><mml:math id="inf397"><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. When phage population sizes are small, the total number of bacteria is <inline-formula><mml:math id="inf398"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Combining these expressions, we find <inline-formula><mml:math id="inf399"><mml:mrow><mml:mfrac><mml:mtext>bacterial birth rate</mml:mtext><mml:mtext>phage birth rate</mml:mtext></mml:mfrac><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> as in our original expression.</p></sec><sec id="s4-2-3"><title>Steady state</title><p>Simulation results are calculated and presented at steady state unless otherwise specified. We define steady state to be the simulation run-time divided by 5, choosing simulation run-times so that mean-field quantities have equilibrated by the steady-state time. We run large population simulations longer than small population simulations: these simulations have less frequent interactions on average because of decreased <inline-formula><mml:math id="inf400"><mml:mi>α</mml:mi></mml:math></inline-formula> and take longer to equilibrate (<xref ref-type="fig" rid="fig8">Figure 8</xref>).</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Total phage, total bacteria (left), and mean number of bacterial clones (right) vs. simulation time for five simulations with <inline-formula><mml:math id="inf401"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf402"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf403"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, and <italic>C</italic><sub>0</sub> ranging from 300 (top row) to 30,000 (bottom row).</title><p>Total population sizes equilibrate very quickly, but the total number of clones can take longer at large population sizes (high <italic>C</italic><sub>0</sub>). The time constants inset are a measure of how quickly we expect each mean-field quantity to equilibrate: <inline-formula><mml:math id="inf404"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> time constant is the inverse growth rate of the total phage population (<inline-formula><mml:math id="inf405"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) and the extinction time constant is the mean time to extinction for large phage clones (<xref ref-type="disp-formula" rid="equ187">Equation 171</xref>), a measure of the rate of turnover of the number of clones.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig8-v2.tif"/></fig><p>We set the total bacterial generations to be <inline-formula><mml:math id="inf406"><mml:mrow><mml:mn>10000</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mtext>log</mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, rounded to the nearest thousand, with a minimum of 10,000 generations (see <xref ref-type="table" rid="table2">Table 2</xref>). The following table lists simulation length and assumed steady-state time <inline-formula><mml:math id="inf407"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for different values of <italic>C</italic><sub>0</sub>.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Simulation length.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"><italic>C</italic><sub>0</sub></th><th align="left" valign="bottom">Simulation length (bacterial generations)</th><th align="left" valign="bottom">Steady-state start time (<inline-formula><mml:math id="inf408"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>)</th></tr></thead><tbody><tr><td align="left" valign="bottom">300</td><td align="char" char="." valign="bottom">10,000</td><td align="char" char="." valign="bottom">2000</td></tr><tr><td align="left" valign="bottom">1000</td><td align="char" char="." valign="bottom">10,000</td><td align="char" char="." valign="bottom">2000</td></tr><tr><td align="left" valign="bottom">3000</td><td align="char" char="." valign="bottom">10,000</td><td align="char" char="." valign="bottom">2000</td></tr><tr><td align="left" valign="bottom">10,000</td><td align="char" char="." valign="bottom">10,000</td><td align="char" char="." valign="bottom">2000</td></tr><tr><td align="left" valign="bottom">30,000</td><td align="char" char="." valign="bottom">15,000</td><td align="char" char="." valign="bottom">3000</td></tr><tr><td align="left" valign="bottom">100,000</td><td align="char" char="." valign="bottom">20,000</td><td align="char" char="." valign="bottom">4000</td></tr><tr><td align="left" valign="bottom">300,000</td><td align="char" char="." valign="bottom">25,000</td><td align="char" char="." valign="bottom">5000</td></tr><tr><td align="left" valign="bottom">1,000,000</td><td align="char" char="." valign="bottom">30,000</td><td align="char" char="." valign="bottom">6000</td></tr></tbody></table></table-wrap><p><xref ref-type="fig" rid="fig9">Figure 9</xref> shows the mean number of bacterial clones (<inline-formula><mml:math id="inf409"><mml:mi>m</mml:mi></mml:math></inline-formula>) at steady state as a function of the initial number of phage clones. For most parameters, the steady-state <inline-formula><mml:math id="inf410"><mml:mi>m</mml:mi></mml:math></inline-formula> is independent of the initial m. There is a slight dependence on initial <inline-formula><mml:math id="inf411"><mml:mi>m</mml:mi></mml:math></inline-formula> at high <italic>C</italic><sub>0</sub>.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Mean number of bacterial clones after <inline-formula><mml:math id="inf412"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> bacterial generations vs. initial number of phage clones for <inline-formula><mml:math id="inf413"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf414"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</title><p>The mean is an average of 15 evenly spaced points from <inline-formula><mml:math id="inf415"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf416"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> bacterial generations. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig9-v2.tif"/></fig></sec><sec id="s4-2-4"><title>Single-clone mean-field dynamics</title><p>This section presents mean-field equations for the population size of single bacteria and phage clones. The steady-state bacteria and phage clone sizes (<xref ref-type="disp-formula" rid="equ26 equ27">Equations 25 and 26)</xref> are, like the mean-field results in ‘Total population size’, used extensively in further analytic results. In particular, predicted mean clone sizes are used as a cutoff to measure the time to extinction for large clones (Appendix 3) and to calculate diversity in ‘Analytic approximations for diversity’ (main text ‘Phages drive stable emergent sequence diversity’). These expressions are also used to calculate the fitness of new phage mutants in Appendix 3.</p><p>We can write mean-field equations for individual clones <inline-formula><mml:math id="inf417"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf418"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:math></inline-formula> as well:<disp-formula id="equ20"><label>(19)</label><mml:math id="m20"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ21"><label>(20)</label><mml:math id="m21"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf419"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is binary and all spacers are equally effective (<xref ref-type="disp-formula" rid="equ18">Equation 18</xref>), <inline-formula><mml:math id="inf420"><mml:mover accent="true"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf421"><mml:mover accent="true"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> can be simplified:<disp-formula id="equ22"><label>(21)</label><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ23"><label>(22)</label><mml:math id="m23"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In <xref ref-type="disp-formula" rid="equ20 equ22">Equations 19 and 21</xref>, mutations that arise from phage <inline-formula><mml:math id="inf422"><mml:mi>i</mml:mi></mml:math></inline-formula> decrease <inline-formula><mml:math id="inf423"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula>, which is captured in that <inline-formula><mml:math id="inf424"><mml:mi>B</mml:mi></mml:math></inline-formula> becomes <inline-formula><mml:math id="inf425"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> for type <inline-formula><mml:math id="inf426"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is effectively lower, since mutations go to different phage types.</p><p>The last term in <xref ref-type="disp-formula" rid="equ20 equ22">Equations 19 and 21</xref> is for mutations that happen in all other phages besides type <inline-formula><mml:math id="inf427"><mml:mi>i</mml:mi></mml:math></inline-formula> that convert type <inline-formula><mml:math id="inf428"><mml:mi>k</mml:mi></mml:math></inline-formula> to type <inline-formula><mml:math id="inf429"><mml:mi>i</mml:mi></mml:math></inline-formula>. Any particular phage <inline-formula><mml:math id="inf430"><mml:mi>k</mml:mi></mml:math></inline-formula> has a certain mutational distance from phage <inline-formula><mml:math id="inf431"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf432"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which means <inline-formula><mml:math id="inf433"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>-specific mutations must happen to get from type <inline-formula><mml:math id="inf434"><mml:mi>k</mml:mi></mml:math></inline-formula> to type <inline-formula><mml:math id="inf435"><mml:mi>i</mml:mi></mml:math></inline-formula>. This happens with probability <inline-formula><mml:math id="inf436"><mml:msup><mml:mi>μ</mml:mi><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:msup></mml:math></inline-formula>. Going forward we assume that this term is small, which is true if the overall mutation rate <inline-formula><mml:math id="inf437"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is sufficiently low and/or the space of protospacer types is sufficiently large so that mutations are almost always to new types not present in the population.</p><p>We solve the coupled time-dependent system given by <xref ref-type="disp-formula" rid="equ22 equ23">Equations 21 and 22</xref> numerically, assuming all other populations (<inline-formula><mml:math id="inf438"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf439"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf440"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf441"><mml:mi>C</mml:mi></mml:math></inline-formula>) are at their deterministic steady-state value and ignoring the last term of <xref ref-type="disp-formula" rid="equ22">Equation 21</xref>. These solutions are plotted alongside mean clone sizes from a simulation in <xref ref-type="fig" rid="fig10">Figure 10</xref> (‘Numerical deterministic prediction’). The deterministic solution matches the mean clone size well at early times but does not capture the effects of clone extinction at later times. By including only surviving clones in the simulation mean and normalizing the deterministic solution by the predicted fraction of surviving clones (‘Numerical deterministic prediction normalized to survival probability’), the theoretical prediction matches well at early times and can be piecewise-combined with the steady-state mean clone size to give good agreement at all times (see ‘Predicted clone size’ dashed lines in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). We estimate the predicted fraction of surviving phage clones by numerically solving <xref ref-type="disp-formula" rid="equ167">Equation 153</xref> which gives the phage clone probability of extinction in the absence of matching bacterial clones. The fraction of surviving clones is <inline-formula><mml:math id="inf442"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf443"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of extinction. Normalizing by <inline-formula><mml:math id="inf444"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> does not give good agreement at long times because <inline-formula><mml:math id="inf445"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> goes to 1 as <inline-formula><mml:math id="inf446"><mml:mi>t</mml:mi></mml:math></inline-formula> goes to infinity, causing the solution to diverge at long times. While individual trajectories do eventually go extinct, the mean clone size conditioned on survival reaches the deterministic steady state at long times.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Phage (<bold>A</bold>) and bacteria (<bold>B</bold>) mean clone size in a simulation, either conditioned on survival (blue circles) or including extinct clones (orange circles).</title><p>Theoretical predictions are plotted as solid lines: the time-dependent numerical solution to <xref ref-type="disp-formula" rid="equ22 equ23">Equations 21 and 22</xref> in green, the same solution divided by the phage clone probability of survival in red, and a one-dimensional solution to <xref ref-type="disp-formula" rid="equ22">Equation 21</xref> in (<bold>A</bold>) and 22 in (<bold>B</bold>). <xref ref-type="disp-formula" rid="equ26 equ27">Equations 25 and 26</xref> are black dashed lines. An alternate simulation mean clone size is plotted for bacteria (brown circles) in which each clone trajectory is stacked based on the bacterial acquisition time and averaged across trajectories, conditioned on survival. Simulation parameters are <inline-formula><mml:math id="inf447"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10000.0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf448"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf449"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf450"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig10-v2.tif"/></fig><p>We consider bacteria clones in the background of phage clones; that is, time 0 for a bacterial clone starts when the matching phage clone arises by mutation. This is the case in the numerical solution for the coupled bacteria-phage clone system given by <xref ref-type="disp-formula" rid="equ22 equ23">Equations 21 and 22</xref>. For this reason, normalizing the bacterial clone size prediction by the phage clone probability of extinction also gives good agreement to the simulation mean conditioned on bacterial clone survival. (If a bacterial clone size is 0 but its corresponding phage clone has not yet gone extinct, that 0 will count in the mean clone size, but after the phage goes extinct, a 0 in the bacterial clone size will not be included.)</p><p>We can also solve <xref ref-type="disp-formula" rid="equ22 equ23">Equations 21 and 22</xref> analytically by assuming <inline-formula><mml:math id="inf451"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf452"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> are constant, respectively; this amounts to removing the dependence of phage clone dynamics on bacteria clone dynamics and vice versa.</p><p>If we assume <inline-formula><mml:math id="inf453"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we get the following solution for <inline-formula><mml:math id="inf454"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ24"><label>(23)</label><mml:math id="m24"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf455"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the average growth rate of phage clones and <inline-formula><mml:math id="inf456"><mml:mi>t</mml:mi></mml:math></inline-formula> is in minutes. This is the same growth rate as is in <xref ref-type="disp-formula" rid="equ171">Equation 156</xref> with a small correction: <inline-formula><mml:math id="inf457"><mml:mrow><mml:mi>B</mml:mi><mml:mo>→</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>; the burst of an individual phage clone is reduced by phages that mutate to a new type.</p><p>Likewise if we assume that <inline-formula><mml:math id="inf458"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> is constant, we get the following solution for <inline-formula><mml:math id="inf459"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ25"><label>(24)</label><mml:math id="m25"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf460"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the average growth rate for bacterial clone <inline-formula><mml:math id="inf461"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf462"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the rate of spacer acquisition for that clone.</p><p><xref ref-type="disp-formula" rid="equ24 equ25">Equations 23 and 24</xref> are plotted in <xref ref-type="fig" rid="fig10">Figure 10</xref> (‘Analytic 1D prediction’). <xref ref-type="disp-formula" rid="equ24">Equation 23</xref> matches the phage clone size not conditioned on survival at early times, but continues to grow past the steady-state phage clone size without growing bacterial clones to reign it in. <xref ref-type="disp-formula" rid="equ25">Equation 24</xref> is not comparable to the simulation mean with time zero as the time of phage clone birth; rather it should be compared to bacterial clone growth independent of what the phages are doing. Using the steady-state mean phage clone size in <xref ref-type="disp-formula" rid="equ25">Equation 24</xref> (purple line), we obtain a rough correspondence with the simulation mean (brown circles). The prediction does not match at intermediate times, likely because this solution assumes that phage clones are at their mean size when in fact they are likely still smaller.</p><p><xref ref-type="disp-formula" rid="equ22 equ23">Equations 21 and 22</xref> can be solved at steady state in terms of the total mean-field variables (ignoring the last term of <xref ref-type="disp-formula" rid="equ22">Equation 21</xref>). These solutions (<xref ref-type="disp-formula" rid="equ26 equ27">Equations 25 and 26)</xref> are indicated by horizontal dashed lines in <xref ref-type="fig" rid="fig10">Figure 10</xref>.<disp-formula id="equ26"><label>(25)</label><mml:math id="m26"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>e</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ27"><label>(26)</label><mml:math id="m27"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec></sec><sec id="s4-3"><title>Simulation methods</title><p>This section describes how simulations were performed, shows basic simulation results, describes parameter choices (‘Parameter values’), and explores the parameter dependence of stochastic population extinction (‘Stochastic population extinction’) that relates to results in ‘Bacteria and phages dynamically coexist and coevolve’.</p><p>Simulations were written in Python and performed on the Béluga and Niagara supercomputers at the SciNet HPC Consortium (<xref ref-type="bibr" rid="bib107">Ponce et al., 2019</xref>) and on a local server in our group. Our simulation code can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/mbonsma/CRISPR-dynamics-model">https://github.com/mbonsma/CRISPR-dynamics-model</ext-link> (copy archived at <xref ref-type="bibr" rid="bib10">Bonsma-Fisher and Goyal, 2023</xref>). We used the tau-leaping method, a fast approximation for Gillespie simulation <xref ref-type="bibr" rid="bib17">Cao et al., 2006</xref> and compared with full Gillespie simulations for some cases. Gillespie and tau-leaping methods showed similar dynamics and good agreement for total population sizes (<xref ref-type="fig" rid="fig11">Figure 11</xref>), total spacer diversity (<xref ref-type="fig" rid="fig12">Figure 12</xref>), mean phage and bacteria clone sizes (<xref ref-type="fig" rid="fig13">Figure 13</xref>), and produced the same qualitative behaviour for individual spacer types (<xref ref-type="fig" rid="fig14">Figure 14</xref>).</p><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Total phage (<inline-formula><mml:math id="inf463"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>) and total bacteria (<inline-formula><mml:math id="inf464"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>) as a function of time for a Gillespie simulation and a tau-leaping simulation with the same parameters.</title><p>Total phage is shown at early times (<bold>A</bold>) and late times (<bold>B</bold>), and total bacteria at early times (<bold>C</bold>) and late times (<bold>D</bold>). The simulation parameters are <inline-formula><mml:math id="inf465"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf466"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf467"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf468"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. Early time dynamics differ slightly in this example, but the long-time behaviour and steady-state values are similar.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig11-v2.tif"/></fig><fig id="fig12" position="float"><label>Figure 12.</label><caption><title>Number of bacterial clones (<inline-formula><mml:math id="inf469"><mml:mi>m</mml:mi></mml:math></inline-formula>) vs. simulation time for three sets of simulations, each beginning with 1, 10, or 50 phage clones.</title><p>Gillespie simulations are dashed blue lines, and tau-leaping simulations are solid orange and red lines. The simulation parameters are <inline-formula><mml:math id="inf470"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf471"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf472"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf473"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig12-v2.tif"/></fig><fig id="fig13" position="float"><label>Figure 13.</label><caption><title>Average population size of phage clones (solid lines) and bacterial clones (dashed lines) in a Gillespie and tau-leaping simulation with the same parameters.</title><p>The simulation parameters are <inline-formula><mml:math id="inf474"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf475"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf476"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf477"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig13-v2.tif"/></fig><fig id="fig14" position="float"><label>Figure 14.</label><caption><title>10 spacer trajectories for a Gillespie simulation (<bold>A</bold>) and tau-leaping simulation (<bold>B</bold>).</title><p>The first 10 trajectories that surpass <inline-formula><mml:math id="inf478"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> are shown. The simulation parameters are <inline-formula><mml:math id="inf479"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf480"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf481"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf482"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig14-v2.tif"/></fig><p>We initialized five simulations for each parameter combination for a total of approximately 19,800 simulations, not including simulations with cross-reactivity. A small subset of simulation parameters were run six times instead of five. Not all simulations were successfully completed either due to errors while running or because their running time was exceedingly long. Of the initialized simulations, approximately 10,000 were completed and included in analysis. Simulations with very low <inline-formula><mml:math id="inf483"><mml:mi>μ</mml:mi></mml:math></inline-formula> tended to either have no phage establishments (at low <italic>C</italic><sub>0</sub>) or very long running times (at high <italic>C</italic><sub>0</sub>), and simulations with very high <inline-formula><mml:math id="inf484"><mml:mi>μ</mml:mi></mml:math></inline-formula> tended to have higher diversity and longer running times in general. Unless otherwise noted, plots with simulation averages are an average across three to six simulations with the same parameters. We set simulations to run for a fixed number of bacterial generations intended to be long enough to allow the system to reach steady state and remain there for a long time to generate statistics (‘Steady state’).</p><p>We model spacers and protospacers as a binary sequence of length <inline-formula><mml:math id="inf485"><mml:mi>L</mml:mi></mml:math></inline-formula> as in <xref ref-type="bibr" rid="bib58">Han et al., 2013</xref>; <xref ref-type="bibr" rid="bib59">Han and Deem, 2017</xref>. When a phage reproduces and creates a burst of <inline-formula><mml:math id="inf486"><mml:mi>B</mml:mi></mml:math></inline-formula> phages, we draw <inline-formula><mml:math id="inf487"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> numbers from a binomial distribution with probability <inline-formula><mml:math id="inf488"><mml:mi>μ</mml:mi></mml:math></inline-formula>. Successes in this draw designate bits that will mutate (flip) in the newly created phages. It is possible but very rare for more than one mutation to happen in the same new phage: this occurs with probability <inline-formula><mml:math id="inf489"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> whereas a single mutation occurs with probability <inline-formula><mml:math id="inf490"><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Multiple mutations occur approximately <inline-formula><mml:math id="inf491"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> times as often as single mutations; for the largest value of <inline-formula><mml:math id="inf492"><mml:mi>μ</mml:mi></mml:math></inline-formula> we use, they represent 0.3% of events.</p><p>Our simulation code can be found on <ext-link ext-link-type="uri" xlink:href="https://github.com/mbonsma/CRISPR-dynamics-model">GitHub</ext-link>.</p><sec id="s4-3-1"><title>Parameter values</title><p>Parameter values are as above unless otherwise indicated. Representative values estimated for <italic>S. thermophilus</italic> bacteria in lab conditions.</p><p>Parameter descriptions and values are listed in <xref ref-type="table" rid="table3">Table 3</xref>. The burst size for phage that target <italic>S. thermophilus</italic> has been measured at between 140 and 200 (<xref ref-type="bibr" rid="bib84">Lucchini, 1999</xref>) and 80 for phage 2972 (<xref ref-type="bibr" rid="bib82">Levin et al., 2013</xref>). We use a burst size of 170. (<xref ref-type="bibr" rid="bib132">Vaningelgem et al., 2004</xref>) measured the maximum growth rate of <italic>S. thermophilus</italic> in milk at 42°C to be <inline-formula><mml:math id="inf493"><mml:mrow><mml:mrow><mml:mn>2.4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mtext> min</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. This corresponds to <inline-formula><mml:math id="inf494"><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in our model; we choose <inline-formula><mml:math id="inf495"><mml:mi>g</mml:mi></mml:math></inline-formula> based on <italic>C</italic><sub>0</sub> so that <inline-formula><mml:math id="inf496"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>2.4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mtext> min</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Model parameters.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Parameter</th><th align="left" valign="bottom">Description</th><th align="left" valign="bottom">Value</th></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf497"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula></td><td align="left" valign="bottom">Bacterial doubling time</td><td align="left" valign="bottom">41.7 min</td></tr><tr><td align="left" valign="bottom"><italic>C</italic><sub>0</sub></td><td align="left" valign="bottom">Inflow nutrient concentration in</td><td align="left" valign="bottom">10<sup>2</sup> to 10<sup>-6</sup></td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Units of bacterial cell density</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf498"><mml:mi>α</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Phage adsorption rate</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf499"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf500"><mml:mi>B</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Phage burst size</td><td align="left" valign="bottom">170</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf501"><mml:mi>F</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Chemostat flow rate</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf502"><mml:mrow><mml:mn>0.3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf503"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Probability of phage success</td><td align="left" valign="bottom">0.02</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">for bacteria without spacers</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf504"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Spacer effectiveness</td><td align="left" valign="bottom">0.1 to 0.95</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf505"><mml:mi>r</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Rate of spacer loss</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf506"><mml:mrow><mml:mn>0.04</mml:mn><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf507"><mml:mi>η</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Probability of spacer acquisition</td><td align="left" valign="bottom">10<sup>-5</sup> to 10<sup>-2</sup></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf508"><mml:mi>μ</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Phage mutation rate per base per generation</td><td align="left" valign="bottom">10<sup>-8</sup> to 10<sup>-4</sup></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf509"><mml:mi>L</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Phage protospacer length in nucleotides</td><td align="left" valign="bottom">30</td></tr></tbody></table><table-wrap-foot><fn><p>Parameter values are as above unless otherwise indicated. Representative values estimated for Streptococcus thermophilus bacteria in lab conditions.</p></fn></table-wrap-foot></table-wrap><p>The parameter <inline-formula><mml:math id="inf510"><mml:mi>α</mml:mi></mml:math></inline-formula> in our model is the phage adsorption rate constant divided by the culture volume. The rate of adsorption for phage is of the order of <inline-formula><mml:math id="inf511"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mtext> min</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> ml <xref ref-type="bibr" rid="bib32">Delbrück, 1940</xref>; this is similar to the values used in <xref ref-type="bibr" rid="bib82">Levin et al., 2013</xref> and <xref ref-type="bibr" rid="bib141">Weissman et al., 2018</xref>. In order to explore regimes of different total population sizes, we decrease <inline-formula><mml:math id="inf512"><mml:mi>α</mml:mi></mml:math></inline-formula> as we increase <italic>C</italic><sub>0</sub> in order to maintain stable coexistence between bacteria and phage; this is equivalent to decreasing the culture volume as <italic>C</italic><sub>0</sub> decreases. For example, if <inline-formula><mml:math id="inf513"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, we set <inline-formula><mml:math id="inf514"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, implying a culture volume of approximately <inline-formula><mml:math id="inf515"><mml:mrow><mml:mn>50</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mtext>l</mml:mtext></mml:mrow></mml:math></inline-formula>.</p><p><xref ref-type="bibr" rid="bib82">Levin et al., 2013</xref> estimated the frequency of phage mutants that escape CRISPR targeting by <italic>S. thermophilus</italic> to be between <inline-formula><mml:math id="inf516"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf517"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. These measurements are the fractions of phages from lysate that can evade CRISPR targeting of different unique spacers. This is analogous to <inline-formula><mml:math id="inf518"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> in our model, which is the probability of a mutation occurring in a newly burst phage. We use values of <inline-formula><mml:math id="inf519"><mml:mi>μ</mml:mi></mml:math></inline-formula> between 10<sup>-8</sup> and 10<sup>-4</sup> corresponding to <inline-formula><mml:math id="inf520"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> between <inline-formula><mml:math id="inf521"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf522"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to encompass the physiological range of phage mutation rates as well as unusually high mutation rates.</p><p>We generally fix the probability of successful phage infection against naive bacteria at <inline-formula><mml:math id="inf523"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula> (though <inline-formula><mml:math id="inf524"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> is varied in <xref ref-type="fig" rid="fig1">Figure 1E</xref> and in <xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>). This is consistent with the value of 10<sup>-2</sup> used in <xref ref-type="bibr" rid="bib42">Doekes et al., 2021</xref> and <xref ref-type="bibr" rid="bib4">Berngruber et al., 2013</xref>. Several other models of CRISPR immunity have assumed phage success probability to be much higher, typically close to 1 (<xref ref-type="bibr" rid="bib25">Childs et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref>; <xref ref-type="bibr" rid="bib141">Weissman et al., 2018</xref>). Increasing <inline-formula><mml:math id="inf525"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> does not qualitatively alter our results beyond changing the relative population sizes of phage and bacteria; at high values of <inline-formula><mml:math id="inf526"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> bacteria population sizes are small and they become more likely to experience stochastic extinction (see <xref ref-type="fig" rid="fig1">Figure 1E</xref>). A low value of <inline-formula><mml:math id="inf527"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> can be taken to reflect the presence or effectiveness of other anti-phage defence systems.</p><p>The rate of spacer loss in our model, <inline-formula><mml:math id="inf528"><mml:mi>r</mml:mi></mml:math></inline-formula>, can be thought of as a phenomenological parameter since the true rate of spacer loss is not well understood (<xref ref-type="bibr" rid="bib141">Weissman et al., 2018</xref>). For comparison, Jiang et al. estimate the rate of loss of function of the entire CRISPR system in <italic>S</italic>. <italic>epidermis</italic> at 10<sup>-4</sup> to 10<sup>-3</sup> per individual per generation (<xref ref-type="bibr" rid="bib73">Jiang et al., 2013</xref>). We rescale the parameter <inline-formula><mml:math id="inf529"><mml:mi>r</mml:mi></mml:math></inline-formula> as a function of bacterial growth rate, which means that the rescaled parameter <inline-formula><mml:math id="inf530"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:math></inline-formula> is constant per bacterial generation. Our loss rate is an order of magnitude higher than the rate in <xref ref-type="bibr" rid="bib73">Jiang et al., 2013</xref>.</p><p>We vary the parameters <inline-formula><mml:math id="inf531"><mml:mi>η</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf532"><mml:mi>e</mml:mi></mml:math></inline-formula> to explore different 'strengths' of CRISPR immunity. The parameter <inline-formula><mml:math id="inf533"><mml:mi>e</mml:mi></mml:math></inline-formula> is spacer effectiveness: when <inline-formula><mml:math id="inf534"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, spacers provide no immunity and bacteria with spacers are functionally no different from bacteria without spacers. When <inline-formula><mml:math id="inf535"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, a spacer-containing bacterium that encounters a phage with a matching protospacer is guaranteed to survive. We vary <inline-formula><mml:math id="inf536"><mml:mi>e</mml:mi></mml:math></inline-formula> between 0.1 and 0.5 to explore different regimes of CRISPR effectiveness. The parameter <inline-formula><mml:math id="inf537"><mml:mi>η</mml:mi></mml:math></inline-formula> is the probability that a naive bacterium will acquire a spacer if it is infected but not killed by a phage. Rates of naive spacer acquisition vary widely, and we vary <inline-formula><mml:math id="inf538"><mml:mi>η</mml:mi></mml:math></inline-formula> between 10<sup>-5</sup> and 10<sup>-2</sup>, with the value of <inline-formula><mml:math id="inf539"><mml:mi>η</mml:mi></mml:math></inline-formula> constant within a simulation. For comparison with measured acquisition rates, Pyenson et al. measured naive acquisition in <italic>Staphylococcus aureus</italic> to be approximately 10<sup>-6</sup> to 10<sup>-7</sup> (<xref ref-type="bibr" rid="bib111">Pyenson and Marraffini, 2020</xref>). Acquisition rates may hundreds of times higher in primed acquisition (<xref ref-type="bibr" rid="bib126">Staals et al., 2016</xref>), and Heler et al. measured four orders of magnitude difference in spacer abundances shortly after infection, likely a result of differences in acquisition rate (<xref ref-type="bibr" rid="bib66">Heler et al., 2019</xref>).</p><p>The flow rate <inline-formula><mml:math id="inf540"><mml:mi>F</mml:mi></mml:math></inline-formula> was picked in order to get a stable fixed point where phage and bacteria coexist. Stability conditions approximately correspond to those derived in our previous work (<xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>).</p></sec><sec id="s4-3-2"><title>Stochastic population extinction</title><p>This section relates to results in 'Bacteria and phages dynamically coexist and coevolve'.</p><p>Even when bacteria and phage are within the deterministic coexistence regime, populations may experience stochastic extinction (main text <xref ref-type="fig" rid="fig1">Figure 1F</xref>). Simulations are run for a fixed number of generations (see 'Steady state') or until bacteria or phage go extinct. Population extinction on the timescale of our simulation run-time is restricted to low values of <italic>C</italic><sub>0</sub> (no phage population extinctions happen for <inline-formula><mml:math id="inf541"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>3000</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and no bacteria extinctions happen for <inline-formula><mml:math id="inf542"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). Phages are prone to population extinction at higher population sizes than bacteria because of their large burst size which makes their dynamics more noisy (see 'Long-time approximation for <inline-formula><mml:math id="inf543"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>').</p><p>Extinction probability is strongly related to total population size, with smaller populations being more likely to go extinct across all parameters (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> and <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). However, there are differences that depend on parameters and initial conditions. First, high spacer effectiveness increases the likelihood of phage extinction and decreases the likelihood of bacterial extinction (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). High spacer effectiveness correspondingly increases the time to extinction for bacteria (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>) and decreases the time to extinction for phages (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). Bacteria also appear to be less likely to go extinct at high values of <inline-formula><mml:math id="inf544"><mml:mi>η</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). Phages have longer times to extinction and lower extinction probability at high values of <inline-formula><mml:math id="inf545"><mml:mi>μ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). And finally, phages have a longer time to extinction if the initial number of phage clones (<inline-formula><mml:math id="inf546"><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) is high (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>), but this effect disappears at low <inline-formula><mml:math id="inf547"><mml:mi>η</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>), perhaps because bacteria do not acquire spacers quickly enough for the initial phage diversity to make a difference before the number of clones equilibrates, which happens rapidly at low total population size (see upper rows of <xref ref-type="fig" rid="fig8">Figure 8</xref>).</p></sec></sec><sec id="s4-4"><title>Simulation results</title><sec id="s4-4-1"><title>Measuring diversity</title><p>This section describes in detail our method for measuring diversity in simulations, relating to results in 'Phages drive stable emergent sequence diversity'. It provides justification for matching the number of large phage clones to the number of bacteria clones and discusses the assumptions made and where they may break down.</p><p>A measure for the overall sequence diversity in the population is the total number of unique clones. In general, the bacterial diversity and phage diversity need not be the same, but it turns out that the number of bacterial clones (which we call <inline-formula><mml:math id="inf548"><mml:mi>m</mml:mi></mml:math></inline-formula>) closely tracks the number of 'large' phage clones across a wide range of parameters.</p><p>To measure the number of large phage clones in a simulation, we scale the observed phage clone size distribution by the probability of extinction for each clone size below a size cutoff given by <xref ref-type="disp-formula" rid="equ119">Equation 115</xref>. We multiply each observed number of clones of size <inline-formula><mml:math id="inf549"><mml:mi>n</mml:mi></mml:math></inline-formula> by the probability of extinction (<xref ref-type="disp-formula" rid="equ174">Equation 159</xref>) to the power of the clone size <inline-formula><mml:math id="inf550"><mml:mi>n</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ28">Equation 27</xref>): this gives a scaling factor for each clone size that predicts how many clones of that size will survive at long times (<xref ref-type="disp-formula" rid="equ29">Equation 28</xref>). <inline-formula><mml:math id="inf551"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>n</mml:mi><mml:mtext>large</mml:mtext></mml:msubsup></mml:math></inline-formula> is plotted alongside the full normalized histogram of clone sizes for one simulation in <xref ref-type="fig" rid="fig15">Figure 15</xref>.<disp-formula id="equ28"><label>(27)</label><mml:math id="m28"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ29"><label>(28)</label><mml:math id="m29"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>large</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mi>n</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mi>n</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig id="fig15" position="float"><label>Figure 15.</label><caption><title>Phage clone size distribution from 15 combined time points for a simulation with the parameters <inline-formula><mml:math id="inf552"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf553"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf554"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf555"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</title><p>The blue points are the values of the full normalized phage clone size histogram with a bin width of 1500. The orange line is given by <inline-formula><mml:math id="inf556"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>n</mml:mi><mml:mtext>large</mml:mtext></mml:msubsup></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ29">Equation 28</xref> smoothed with a running average of window size 3000. Both distributions are scaled by the total number of phage clones.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig15-v2.tif"/></fig><p>We then calculate the number of large phage clones at steady state as <inline-formula><mml:math id="inf557"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>total</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:msubsup><mml:mi>P</mml:mi><mml:mi>n</mml:mi><mml:mtext>large</mml:mtext></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, the total number of phage clones multiplied by the fraction of clones that survive for long times. Note that <inline-formula><mml:math id="inf558"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>n</mml:mi><mml:mtext>large</mml:mtext></mml:msubsup></mml:math></inline-formula> is not normalized; it is a quantity <inline-formula><mml:math id="inf559"><mml:mrow><mml:mi/><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> representing the proportion of the clone size distribution that corresponds to large clones. The predicted number of large phage clones is plotted against the observed mean number of bacterial clones in Figure 22. There is extremely good agreement at all parameters except the lowest value of <inline-formula><mml:math id="inf560"><mml:mi>η</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf561"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where the estimated number of large phage clones tends to be larger than <inline-formula><mml:math id="inf562"><mml:mi>m</mml:mi></mml:math></inline-formula>. In this regime, phage clones go extinct because of clonal interference before bacteria are able to acquire spacers (<xref ref-type="fig" rid="fig16">Figure 16</xref> and <xref ref-type="fig" rid="fig17">Figure 17</xref>). At low <inline-formula><mml:math id="inf563"><mml:mi>η</mml:mi></mml:math></inline-formula> and high <inline-formula><mml:math id="inf564"><mml:mi>μ</mml:mi></mml:math></inline-formula>, phage clone fitness declines more rapidly with less influence from bacterial spacer acquisition than at high <inline-formula><mml:math id="inf565"><mml:mi>η</mml:mi></mml:math></inline-formula> and moderate <inline-formula><mml:math id="inf566"><mml:mi>μ</mml:mi></mml:math></inline-formula>: <xref ref-type="fig" rid="fig18">Figure 18</xref> shows the ratio of phage clone initial fitness to phage clone fitness at the mean bacteria spacer acquisition time, measured from simulations, vs. <inline-formula><mml:math id="inf567"><mml:mrow><mml:mi>η</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>. At most parameters, however, phage clone fitness has not changed much by the time bacteria are acquiring spacers.</p><fig id="fig16" position="float"><label>Figure 16.</label><caption><title>Mean phage clone size at the time of first spacer acquisition vs. the deterministic mean phage clone size.</title><p>For each phage clone trajectory, the clone size at the time of first spacer acquisition is recorded and these are averaged across each simulation. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig16-v2.tif"/></fig><fig id="fig17" position="float"><label>Figure 17.</label><caption><title>Mean time to extinction for phage clones vs. the timescale of bacteria spacer acquisition given by <inline-formula><mml:math id="inf568"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf569"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</title><p>Points outlined in red are simulations where the ratio of large phage clones to bacterial clones exceeds 1.2. Phage clones experience clonal interference at low <inline-formula><mml:math id="inf570"><mml:mi>η</mml:mi></mml:math></inline-formula>: they go extinct faster than bacteria acquire spacers.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig17-v2.tif"/></fig><fig id="fig18" position="float"><label>Figure 18.</label><caption><title>Ratio of average phage clone initial fitness to the average phage clone fitness at the mean bacterial spacer acquisition time vs <inline-formula><mml:math id="inf571"><mml:mrow><mml:mi>η</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>.</title><p>Points outlined in red are simulations where the ratio of large phage clones to bacterial clones exceeds 1.2. The phage fitness is the average per capita growth rate of phage clones conditioned on survival. Phage clones experience clonal interference at low <inline-formula><mml:math id="inf572"><mml:mi>η</mml:mi></mml:math></inline-formula> and high <inline-formula><mml:math id="inf573"><mml:mi>μ</mml:mi></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig18-v2.tif"/></fig><p>There is an <inline-formula><mml:math id="inf574"><mml:mi>η</mml:mi></mml:math></inline-formula>-dependent ‘floor’ on the minimum size a phage clone must be before bacteria begin to acquire spacers (<xref ref-type="fig" rid="fig16">Figure 16</xref>). We can estimate the size of a phage clone at the time of first spacer acquisition by calculating the mean time of acquisition from an exponentially growing population. Let <inline-formula><mml:math id="inf575"><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be the size of a phage clone relative to the time of mutation. We assume phage clones grow exponentially with rate <italic>s</italic><sub>0</sub> at early times, where <inline-formula><mml:math id="inf576"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the average initial growth rate of phage clones: <inline-formula><mml:math id="inf577"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>The probability that no acquisitions have happened by time <inline-formula><mml:math id="inf578"><mml:mi>t</mml:mi></mml:math></inline-formula> is given by <italic>P</italic><sub>0</sub> in a Poisson process. Let <inline-formula><mml:math id="inf579"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> be the rate of spacer acquisition (see <xref ref-type="disp-formula" rid="equ15">Equation 15</xref>), then the probability of no acquisitions by time <inline-formula><mml:math id="inf580"><mml:mi>t</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf581"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo rspace="0pt">d</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Now, the probability that an acquisition happens between time <inline-formula><mml:math id="inf582"><mml:mi>t</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf583"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is then<disp-formula id="equ30"><label>(29)</label><mml:math id="m30"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ30">Equation 29</xref> is shown as a function of <inline-formula><mml:math id="inf584"><mml:mi>t</mml:mi></mml:math></inline-formula> for four simulations with different values of <inline-formula><mml:math id="inf585"><mml:mi>η</mml:mi></mml:math></inline-formula> in <xref ref-type="fig" rid="fig19">Figure 19</xref>. The probability has a sharp peak: there is a particular time related to phage clone growth at which the first acquisition is most likely — intuitively, this is what leads to the appearance of a sharp floor in phage clone size at first acquisition. Interestingly, the mean time of first acquisition is non-monotonic in <inline-formula><mml:math id="inf586"><mml:mi>η</mml:mi></mml:math></inline-formula>: the mean time is smallest for the lowest and highest values of <inline-formula><mml:math id="inf587"><mml:mi>η</mml:mi></mml:math></inline-formula>.</p><fig id="fig19" position="float"><label>Figure 19.</label><caption><title>Probability of the first spacer acquisition happening at time <inline-formula><mml:math id="inf588"><mml:mi>t</mml:mi></mml:math></inline-formula> for four simulations with different values of <inline-formula><mml:math id="inf589"><mml:mi>η</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf590"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf591"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</title><p>The mean of each distribution is shown as a vertical dashed line.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig19-v2.tif"/></fig><p>We calculate the mean time from <xref ref-type="disp-formula" rid="equ30">Equation 29</xref>:<disp-formula id="equ31"><label>(30)</label><mml:math id="m31"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>t</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mi>a</mml:mi><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ32"><label>(31)</label><mml:math id="m32"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>t</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf592"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup><mml:mrow><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>t</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo rspace="0pt">d</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the incomplete gamma function. We can plug this time into <inline-formula><mml:math id="inf593"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to estimate the mean phage clone size at first acquisition; the measured clone size is plotted as a function of this prediction in <xref ref-type="fig" rid="fig20">Figures 20</xref> and <xref ref-type="fig" rid="fig21">21</xref>. The clone size depends on the phage growth rate and bacterial acquisition rate, which are themselves primarily dependent on the total bacteria population size and the acquisition probability parameter <inline-formula><mml:math id="inf594"><mml:mi>η</mml:mi></mml:math></inline-formula>. If <inline-formula><mml:math id="inf595"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi><mml:mo>&lt;&lt;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (true for our parameters), then <inline-formula><mml:math id="inf596"><mml:mrow><mml:msup><mml:mtext>e</mml:mtext><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:msup><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf597"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, meaning that the time of first acquisition is larger than <inline-formula><mml:math id="inf598"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. (<inline-formula><mml:math id="inf599"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf600"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mi>a</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>⪅</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.) Since <inline-formula><mml:math id="inf601"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is the approximate time at which phages are safe from stochastic extinction due to drift (see ‘Clone fitness’), this means that phage clones are out of the stochastic extinction regime by the time bacteria begin to acquire spacers.</p><fig id="fig20" position="float"><label>Figure 20.</label><caption><title>Mean phage clone size at time of first spacer acquisition for simulation data, the predicted with <xref ref-type="disp-formula" rid="equ32">Equation 31</xref>, and the prediction with the mode of the distribution given by <xref ref-type="disp-formula" rid="equ30">Equation 29</xref> for four simulations with different values of <inline-formula><mml:math id="inf602"><mml:mi>η</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf603"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf604"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig20-v2.tif"/></fig><fig id="fig21" position="float"><label>Figure 21.</label><caption><title>Measured mean phage clone size at the time of first spacer acquisition vs. the prediction given by <inline-formula><mml:math id="inf605"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>t</mml:mi><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> of <xref ref-type="disp-formula" rid="equ32">Equation 31</xref>.</title><p>Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig21-v2.tif"/></fig><p>The definition of large phage clones we just described depends on the measured simulation distribution of phage clone sizes. We can instead approximate the number of large phage clones as the product of the rate at which phage clones become established and the rate at which large phage clones go extinct. This statement is summarized in <xref ref-type="disp-formula" rid="equ33">Equation 32</xref>. Numerically solving this equation for <inline-formula><mml:math id="inf606"><mml:mi>m</mml:mi></mml:math></inline-formula> gives a prediction for the total number of bacterial clones and total number of large phage clones.<disp-formula id="equ33"><label>(32)</label><mml:math id="m33"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>phage establishment fraction</mml:mtext></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>phage mutation rate</mml:mtext></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:munder><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>ln</mml:mtext><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>large phage clone time to extinction</mml:mtext></mml:mrow></mml:munder></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf607"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula></p><p><inline-formula><mml:math id="inf608"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> deterministic mean phage clone size at steady state</p><p><inline-formula><mml:math id="inf609"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></p><p><inline-formula><mml:math id="inf610"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></p><p><inline-formula><mml:math id="inf611"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></p><p><inline-formula><mml:math id="inf612"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></p><p>We now describe each of the three terms in <xref ref-type="disp-formula" rid="equ33">Equation 32</xref>. The phage establishment rate is the phage mutation rate multiplied by the fraction of new phage mutants which become established. Derivation of the phage establishment fraction and phage time to extinction can be found in ‘Long-time approximation for <inline-formula><mml:math id="inf613"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>’ (<xref ref-type="disp-formula" rid="equ173">Equation 158</xref>). Derivation of the mean time to extinction for large phage clones can be found in ‘Neutral time to extinction from backward master equation’ (<xref ref-type="disp-formula" rid="equ187">Equation 171</xref>).</p><p>The phage mutation rate is the mean-field phage reproduction rate <inline-formula><mml:math id="inf614"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> multiplied by the probability of one or more mutations per burst (<inline-formula><mml:math id="inf615"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>).</p><p>We assume that <inline-formula><mml:math id="inf616"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which is true if all clones are equal in size (i.e., <inline-formula><mml:math id="inf617"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf618"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>) or if the deviations from equal size are uncorrelated between matching bacteria and phage clones. This assumption means that the average immunity in the population is approximately <inline-formula><mml:math id="inf619"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> which is accurate across a wide range of parameters: <xref ref-type="fig" rid="fig22">Figure 22</xref> and <xref ref-type="fig" rid="fig23">Figure 23</xref> compare the full average immunity (<xref ref-type="disp-formula" rid="equ34">Equation 33</xref>) with <inline-formula><mml:math id="inf620"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf621"><mml:mi>m</mml:mi></mml:math></inline-formula> is the number of bacterial clones present at a given time point in a simulation. The assumption breaks down at low <inline-formula><mml:math id="inf622"><mml:mi>η</mml:mi></mml:math></inline-formula> and high <inline-formula><mml:math id="inf623"><mml:mi>μ</mml:mi></mml:math></inline-formula> (points below the line in the upper right). Intuitively this happens when the sizes of matching clones become anti-correlated because bacteria acquire few spacers while phages acquire many mutations. The resulting matching pairs have more mismatched clone sizes than the mean number of bacterial clones would suggest. (In this particular case, phage clones are smaller than <inline-formula><mml:math id="inf624"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>.) Conversely, at large population sizes and large spacer acquisition rates, matching clone sizes become correlated, leading to average immunity <inline-formula><mml:math id="inf625"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. <xref ref-type="fig" rid="fig24">Figure 24</xref> shows clone size distributions for four simulations with increasing <inline-formula><mml:math id="inf626"><mml:mi>η</mml:mi></mml:math></inline-formula>, showing that as <inline-formula><mml:math id="inf627"><mml:mi>η</mml:mi></mml:math></inline-formula> increases the phage clone distribution becomes more narrow and the matching clone pairs become more correlated.<disp-formula id="equ34"><label>(33)</label><mml:math id="m34"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>Average immunity</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig id="fig22" position="float"><label>Figure 22.</label><caption><title>Mean number of large phage clones vs. mean number of bacterial clones in simulations.</title><p>For each simulation, we take a subset of 15 evenly spaced timepoints at steady state and calculate the size and number of phage clones present. We scale the observed clone sized distribution with <xref ref-type="disp-formula" rid="equ29">Equation 28</xref> and calculate the mean number of large phage clones by multiplying the total number of clones with the fraction of large phage clones given by <inline-formula><mml:math id="inf628"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:msubsup><mml:mi>P</mml:mi><mml:mi>n</mml:mi><mml:mtext>large</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula>. We use the simulation mean total population sizes to calculate <italic>s</italic><sub>0</sub> and <inline-formula><mml:math id="inf629"><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ28">Equation 27</xref>. We obtain the mean number of bacterial clones by averaging the number of clones present at 15 evenly spaced timepoints at steady state. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig22-v2.tif"/></fig><fig id="fig23" position="float"><label>Figure 23.</label><caption><title>Effective <inline-formula><mml:math id="inf630"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> vs <inline-formula><mml:math id="inf631"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> across all simulations where <inline-formula><mml:math id="inf632"><mml:mrow><mml:mi>m</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> on average.</title><p>Error bars are the standard deviation across three or more independent simulations. The solid black line is <inline-formula><mml:math id="inf633"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig23-v2.tif"/></fig><fig id="fig24" position="float"><label>Figure 24.</label><caption><title>Four simulations with <inline-formula><mml:math id="inf634"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10000</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf635"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf636"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</title><p>From top to bottom, <inline-formula><mml:math id="inf637"><mml:mi>η</mml:mi></mml:math></inline-formula> increases by a factor of 10 in each row, from <inline-formula><mml:math id="inf638"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> in the top row to <inline-formula><mml:math id="inf639"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> in the bottom row. The first two columns show clone size distributions combined from 15 time points between 2000 and 10,000 bacterial generations. Bacteria are in the left column and phages in the middle column. The third column shows the pairwise clone sizes of matching clones at the last sampled time point (9467 generations). The expected large phage clone size is the total phage population divided by the mean number of bacterial clones. The inverse overlap is <inline-formula><mml:math id="inf640"><mml:mrow><mml:mfrac><mml:mi>e</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mtext>eff</mml:mtext></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mstyle><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, which we assume is <inline-formula><mml:math id="inf641"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> as shown in <xref ref-type="fig" rid="fig23">Figure 23</xref>. The dashed line in the third column indicates the line that clone size pairs would fall on if they were perfectly correlated, and the red star indicates the mean large clone size for phages and the mean clone size for bacteria.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig24-v2.tif"/></fig><p>For several parameter combinations, there is no <inline-formula><mml:math id="inf642"><mml:mi>m</mml:mi></mml:math></inline-formula> that satisfies <xref ref-type="disp-formula" rid="equ33">Equation 32</xref>. This generally occurs for parameters resulting in small total population sizes. In these cases, no solution is found because the predicted mutation rate and/or the predicted establishment fraction and/or the predicted mean time to extinction for large clones are too low (<xref ref-type="fig" rid="fig25">Figure 25</xref>).</p><fig id="fig25" position="float"><label>Figure 25.</label><caption><title>Measured simulation phage clone mutation rate, establishment fraction, and mean time to extinction as a function of the theoretical prediction for each.</title><p>Highlighted in grey are parameter combinations for which no theoretically predicted <inline-formula><mml:math id="inf643"><mml:mi>m</mml:mi></mml:math></inline-formula> could be determined; the predicted quantity is instead calculated with the simulation mean <inline-formula><mml:math id="inf644"><mml:mi>m</mml:mi></mml:math></inline-formula>. Error bar are the stnadard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig25-v2.tif"/></fig></sec><sec id="s4-4-2"><title>Analytic approximations for diversity</title><p>This section describes how we approximate our measurement of diversity to arrive at <xref ref-type="disp-formula" rid="equ88">Equation 87</xref>, an analytic approximation for the number of bacterial clones at steady state. The first sections describe approximations for each of the components of diversity; the combination is summarized in ‘Approximation for <inline-formula><mml:math id="inf645"><mml:mi>m</mml:mi></mml:math></inline-formula>’. This is the mathematical background for results in ‘Phages drive stable emergent sequence diversity’.</p><p>We want to understand more intuitively how diversity depends on system parameters. Here we describe analytic approximations for diversity <inline-formula><mml:math id="inf646"><mml:mi>m</mml:mi></mml:math></inline-formula> and its components. <xref ref-type="disp-formula" rid="equ33">Equation 32</xref> contains <inline-formula><mml:math id="inf647"><mml:mi>m</mml:mi></mml:math></inline-formula> both explicitly and implicitly, so we approximate each of the three components to arrive at an analytic approximation for <inline-formula><mml:math id="inf648"><mml:mi>m</mml:mi></mml:math></inline-formula>.</p><p>We can make some initial simplifications by cancelling terms (note that <inline-formula><mml:math id="inf649"><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf650"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>):<disp-formula id="equ35"><label>(34)</label><mml:math id="m35"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>ln</mml:mtext><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now expanding <italic>s</italic><sub>0</sub> and the denominator and cancelling and collecting terms:<disp-formula id="equ36"><label>(35)</label><mml:math id="m36"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>ln</mml:mtext><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In theory, <inline-formula><mml:math id="inf651"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf652"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. To see this, we start with the solutions for the deterministic mean bacteria and phage clone sizes (<xref ref-type="disp-formula" rid="equ26 equ27">Equations 25 and 26</xref>, reprinted here):<disp-formula id="equ37"><label>(36)</label><mml:math id="m37"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>e</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ38"><label>(37)</label><mml:math id="m38"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>From the deterministic mean-field equation for <inline-formula><mml:math id="inf653"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ14">Equation 14</xref>), we have that <inline-formula><mml:math id="inf654"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Substituting this in <xref ref-type="disp-formula" rid="equ37">Equation 36</xref>, we get<disp-formula id="equ39"><label>(38)</label><mml:math id="m39"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>e</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>e</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can neglect <italic>P</italic><sub>0</sub>, both because it is always close to 1 and because, at steady state, the effect of mutants leaving type <inline-formula><mml:math id="inf655"><mml:mi>i</mml:mi></mml:math></inline-formula> is partially balanced by mutants entering type <inline-formula><mml:math id="inf656"><mml:mi>i</mml:mi></mml:math></inline-formula>.<disp-formula id="equ40"><label>(39)</label><mml:math id="m40"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mi>m</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Similarly, from the deterministic mean-field equation for <inline-formula><mml:math id="inf657"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ13">Equation 13</xref>), we have <inline-formula><mml:math id="inf658"><mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Substituting this in <xref ref-type="disp-formula" rid="equ38">Equation 37</xref>, we get<disp-formula id="equ41"><label>(40)</label><mml:math id="m41"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Substituting <inline-formula><mml:math id="inf659"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf660"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, we find <inline-formula><mml:math id="inf661"><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Replacing <inline-formula><mml:math id="inf662"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf663"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> with <inline-formula><mml:math id="inf664"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf665"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, respectively:<disp-formula id="equ42"><label>(41)</label><mml:math id="m42"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>ln</mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now we want to solve <xref ref-type="disp-formula" rid="equ42">Equation 41</xref> for <inline-formula><mml:math id="inf666"><mml:mi>m</mml:mi></mml:math></inline-formula>. This is difficult because the total population sizes <inline-formula><mml:math id="inf667"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf668"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf669"><mml:mi>C</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf670"><mml:mi>ν</mml:mi></mml:math></inline-formula> also depend on <inline-formula><mml:math id="inf671"><mml:mi>m</mml:mi></mml:math></inline-formula>. To find the <inline-formula><mml:math id="inf672"><mml:mi>m</mml:mi></mml:math></inline-formula> dependence of <inline-formula><mml:math id="inf673"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf674"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf675"><mml:mi>C</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf676"><mml:mi>ν</mml:mi></mml:math></inline-formula>, we note that we can approximate the steady-state solutions to <xref ref-type="disp-formula" rid="equ13 equ14 equ15 equ16 equ17">Equations 13–17</xref> as the corresponding solutions described in <xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref> with the simple replacement of the parameter <inline-formula><mml:math id="inf677"><mml:mi>e</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf678"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. This is because <inline-formula><mml:math id="inf679"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> is a good approximation for the full average immunity at most parameters (<xref ref-type="fig" rid="fig23">Figure 23</xref>), and average immunity enters these equations in place of <inline-formula><mml:math id="inf680"><mml:mi>e</mml:mi></mml:math></inline-formula> in the model without phage mutations. This is analogous to average adaptive immunity replacing the rate of innate immunity in the Lotka-Volterra system described by <xref ref-type="bibr" rid="bib72">Iranzo et al., 2013</xref>.</p><p>We write the steady-state solutions for <xref ref-type="disp-formula" rid="equ14 equ17">Equations 14 and 17</xref> below, where we have defined <inline-formula><mml:math id="inf681"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as in <xref ref-type="disp-formula" rid="equ18">Equation 18</xref> and approximated average immunity as <inline-formula><mml:math id="inf682"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. For simplicity we rescale <inline-formula><mml:math id="inf683"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf684"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> by <italic>C</italic><sub>0</sub>: <inline-formula><mml:math id="inf685"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf686"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Here <inline-formula><mml:math id="inf687"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. These steady-state solutions are shown in <xref ref-type="fig" rid="fig26">Figure 26</xref>.</p><fig id="fig26" position="float"><label>Figure 26.</label><caption><title>Total phage, total bacteria, and fraction of bacteria with spacers as a function of average immunity (effective <inline-formula><mml:math id="inf688"><mml:mi>e</mml:mi></mml:math></inline-formula>).</title><p>Blue points are simulation results. Error bars are standard deviation across three or more independent simulations. The solid black line is the solution given by <xref ref-type="disp-formula" rid="equ43">Equations 42</xref>–44 (from <xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>) with the parameter <inline-formula><mml:math id="inf689"><mml:mi>e</mml:mi></mml:math></inline-formula> replaced by effective <inline-formula><mml:math id="inf690"><mml:mi>e</mml:mi></mml:math></inline-formula>. The horizontal grey dashed line corresponds to the no-CRISPR (<inline-formula><mml:math id="inf691"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) mean-field solution (derived in <xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig26-v2.tif"/></fig><p>At low average immunity (high diversity), the population behaves as if there were no CRISPR system at all. <xref ref-type="fig" rid="fig26">Figure 26</xref> shows total phage, total bacteria, and the fraction of bacteria with spacers as a function of average immunity (effective <inline-formula><mml:math id="inf692"><mml:mi>e</mml:mi></mml:math></inline-formula>). At low average immunity, total population sizes are the same as in a population without CRISPR entirely. Interestingly, the effective no-CRISPR case does not necessarily correspond to no CRISPR spacers: <inline-formula><mml:math id="inf693"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> even when effective <inline-formula><mml:math id="inf694"><mml:mrow><mml:mi>e</mml:mi><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for these parameters. This is because spacer acquisition and growth of that clone can still happen even if the spacer confers no fitness benefit.<disp-formula id="equ43"><label>(42)</label><mml:math id="m43"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>p</mml:mi></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mi>ν</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ44"><label>(43)</label><mml:math id="m44"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mi>ν</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mi>ν</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mi>ν</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We have defined <inline-formula><mml:math id="inf695"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf696"><mml:msup><mml:mi>y</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> in terms of <inline-formula><mml:math id="inf697"><mml:msup><mml:mi>ν</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, which is given in the following implicit cubic equation, where <inline-formula><mml:math id="inf698"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ45"><label>(44)</label><mml:math id="m45"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>ν</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This cubic equation is analytically solvable (ignoring the dependence of <inline-formula><mml:math id="inf699"><mml:mi>m</mml:mi></mml:math></inline-formula> on <inline-formula><mml:math id="inf700"><mml:mi>ν</mml:mi></mml:math></inline-formula>), but the full solutions in terms of all parameters are cumbersome.</p><p>Only one of the three solutions of <xref ref-type="disp-formula" rid="equ45">Equation 44</xref> is physical in the parameter range we use (real-valued and properly bounded):<disp-formula id="equ46"><label>(45)</label><mml:math id="m46"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mml:mtr><mml:mtd><mml:msup><mml:mi>ν</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mroot><mml:mrow><mml:msqrt><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>27</mml:mn><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>9</mml:mn><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>−</mml:mo><mml:mn>27</mml:mn><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>9</mml:mn><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mn>3</mml:mn></mml:mroot></mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:mroot><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mroot><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mtext> </mml:mtext><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mi>a</mml:mi><mml:mroot><mml:mrow><mml:msqrt><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>27</mml:mn><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>9</mml:mn><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>−</mml:mo><mml:mn>27</mml:mn><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>9</mml:mn><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mn>3</mml:mn></mml:mroot></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the coefficients are<disp-formula id="equ47"><label>(46)</label><mml:math id="m47"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ48"><label>(47)</label><mml:math id="m48"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ49"><label>(48)</label><mml:math id="m49"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>c</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ50"><label>(49)</label><mml:math id="m50"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-4-3"><title>Dominant balance approximations for <inline-formula><mml:math id="inf701"><mml:mi>ν</mml:mi></mml:math></inline-formula></title><p>The cubic equation for <inline-formula><mml:math id="inf702"><mml:mi>ν</mml:mi></mml:math></inline-formula> given by <xref ref-type="disp-formula" rid="equ45">Equation 44</xref> can be simplified in certain parameter regimes using dominant balance. We write <xref ref-type="disp-formula" rid="equ45">Equation 44</xref> as <inline-formula><mml:math id="inf703"><mml:mrow><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ν</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ν</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> with the coefficients as written above. Comparing the numerical values of the coefficients in different parameter regimes, we arrive at <xref ref-type="table" rid="table4">Table 4</xref> which outlines three different approximations for <inline-formula><mml:math id="inf704"><mml:mi>ν</mml:mi></mml:math></inline-formula> obtained by dropping coefficients of the original cubic equation. Broadly speaking, at low <inline-formula><mml:math id="inf705"><mml:mi>η</mml:mi></mml:math></inline-formula> and low <inline-formula><mml:math id="inf706"><mml:mi>e</mml:mi></mml:math></inline-formula>, both the cubic and quadratic coefficients (<inline-formula><mml:math id="inf707"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf708"><mml:mi>b</mml:mi></mml:math></inline-formula>) are small, so <inline-formula><mml:math id="inf709"><mml:mrow><mml:msup><mml:mi>ν</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>≈</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, while at high <inline-formula><mml:math id="inf710"><mml:mi>η</mml:mi></mml:math></inline-formula> and low <inline-formula><mml:math id="inf711"><mml:mi>e</mml:mi></mml:math></inline-formula> the cubic coefficient (<inline-formula><mml:math id="inf712"><mml:mi>a</mml:mi></mml:math></inline-formula>) can be dropped, and at high <inline-formula><mml:math id="inf713"><mml:mi>e</mml:mi></mml:math></inline-formula> and low <inline-formula><mml:math id="inf714"><mml:mi>η</mml:mi></mml:math></inline-formula> the constant <inline-formula><mml:math id="inf715"><mml:mi>d</mml:mi></mml:math></inline-formula> can be dropped. <xref ref-type="fig" rid="fig27">Figures 27</xref>—<xref ref-type="fig" rid="fig29">29</xref> show total population sizes as a function of the three approximations in <xref ref-type="table" rid="table4">Table 4</xref>.</p><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title><inline-formula><mml:math id="inf716"><mml:mi>ν</mml:mi></mml:math></inline-formula> approximations.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom" rowspan="3"><inline-formula><mml:math id="inf717"><mml:mi>η</mml:mi></mml:math></inline-formula></th><th align="center" valign="bottom" colspan="5"><inline-formula><mml:math id="inf718"><mml:msub><mml:mi>e</mml:mi><mml:mtext>effective</mml:mtext></mml:msub></mml:math></inline-formula></th></tr><tr><th align="left" valign="bottom">≤0.01</th><th align="left" valign="bottom">0.01 to 0.05</th><th align="left" valign="bottom">0.05 to 0.1</th><th align="left" valign="bottom">0.1 to 0.5</th><th align="left" valign="bottom">0.5 to 1</th></tr><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom"/></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf719"><mml:mrow><mml:mi/><mml:mo>≤</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf720"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf721"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf722"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf723"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf724"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula></td></tr><tr><td align="char" char="hyphen" valign="bottom">10<sup>-5</sup> to10<sup>-4</sup></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf725"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf726"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf727"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf728"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula></td><td align="left" valign="bottom"/></tr><tr><td align="char" char="hyphen" valign="bottom">10<sup>-4</sup> to 10<sup>-2</sup></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf729"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf730"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf731"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf732"><mml:mrow><mml:mi/><mml:mo>≥</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf733"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf734"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf735"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr></tbody></table><table-wrap-foot><fn><p>Note: the drop-<inline-formula><mml:math id="inf736"><mml:mi>a</mml:mi></mml:math></inline-formula> solution also works for below <inline-formula><mml:math id="inf737"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> for all values of <inline-formula><mml:math id="inf738"><mml:mi>η</mml:mi></mml:math></inline-formula> (since <inline-formula><mml:math id="inf739"><mml:mrow><mml:msup><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:mfrac><mml:mn>2</mml:mn></mml:msup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), but the <inline-formula><mml:math id="inf740"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> solution is simpler and so preferred for the very low <inline-formula><mml:math id="inf741"><mml:mi>e</mml:mi></mml:math></inline-formula> range.</p></fn></table-wrap-foot></table-wrap><fig id="fig27" position="float"><label>Figure 27.</label><caption><title><inline-formula><mml:math id="inf742"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf743"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf744"><mml:mi>ν</mml:mi></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf745"><mml:mi>η</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="inf746"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, approximating <inline-formula><mml:math id="inf747"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig27-v2.tif"/></fig><fig id="fig28" position="float"><label>Figure 28.</label><caption><title><inline-formula><mml:math id="inf748"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf749"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf750"><mml:mi>ν</mml:mi></mml:math></inline-formula> vs <inline-formula><mml:math id="inf751"><mml:mi>η</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="inf752"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math></inline-formula>, approximating <inline-formula><mml:math id="inf753"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig28-v2.tif"/></fig><fig id="fig29" position="float"><label>Figure 29.</label><caption><title><inline-formula><mml:math id="inf754"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf755"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf756"><mml:mi>ν</mml:mi></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf757"><mml:mi>η</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="inf758"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>, approximating <inline-formula><mml:math id="inf759"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig29-v2.tif"/></fig><p>For small effective <inline-formula><mml:math id="inf760"><mml:mi>e</mml:mi></mml:math></inline-formula> and small <inline-formula><mml:math id="inf761"><mml:mi>η</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf762"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ51"><label>(50)</label><mml:math id="m51"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We define two combined parameters: <inline-formula><mml:math id="inf763"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf764"><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Each of these has an intuitive meaning: <inline-formula><mml:math id="inf765"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is the stability condition for phage existence, and <inline-formula><mml:math id="inf766"><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is the probability of spacer acquisition following escape from naive phage predation, so it can be thought of as the overall spacer acquisition probability at the start of an infection. With these variable substitutions, we get<disp-formula id="equ52"><label>(51)</label><mml:math id="m52"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now we notice that the deterministic total phage population size when <inline-formula><mml:math id="inf767"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is given by<disp-formula id="equ53"><label>(52)</label><mml:math id="m53"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>no CRISPR</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We also include <inline-formula><mml:math id="inf768"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> for <inline-formula><mml:math id="inf769"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for completeness:<disp-formula id="equ54"><label>(53)</label><mml:math id="m54"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>no CRISPR</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>A</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can replace some terms in <inline-formula><mml:math id="inf770"><mml:mi>ν</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf771"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> by comparison with <xref ref-type="disp-formula" rid="equ53">Equation 52</xref>:<disp-formula id="equ55"><label>(54)</label><mml:math id="m55"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf772"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the spacer loss rate per minute. The second term in the denominator is the balance of spacer acquisition and spacer loss per naive bacterium: <inline-formula><mml:math id="inf773"><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the rate of spacer acquisition per naive bacterium in the low average immunity limit.</p><p>The third term in the denominator is negative for the parameters we use, but this is not necessarily true in general. It is negative if <inline-formula><mml:math id="inf774"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mo>&lt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, which for the values of <inline-formula><mml:math id="inf775"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf776"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> we use (fixed across all simulations) is true for <inline-formula><mml:math id="inf777"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>η</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.0113</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>From this expression for <inline-formula><mml:math id="inf778"><mml:mi>ν</mml:mi></mml:math></inline-formula> we learn the following:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf779"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> decreases if <inline-formula><mml:math id="inf780"><mml:mi>r</mml:mi></mml:math></inline-formula> goes up. More spacer loss means a smaller fraction of bacteria with spacers.</p></list-item><list-item><p><inline-formula><mml:math id="inf781"><mml:mi>ν</mml:mi></mml:math></inline-formula> increases if spacer acquisition goes up (provided <inline-formula><mml:math id="inf782"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> is small).</p></list-item><list-item><p><inline-formula><mml:math id="inf783"><mml:mi>ν</mml:mi></mml:math></inline-formula> increases if <inline-formula><mml:math id="inf784"><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac></mml:math></inline-formula> increases: higher CRISPR effectiveness means higher <inline-formula><mml:math id="inf785"><mml:mi>ν</mml:mi></mml:math></inline-formula>.</p></list-item></list><p>For <inline-formula><mml:math id="inf786"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we define <inline-formula><mml:math id="inf787"><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula>:<disp-formula id="equ56"><label>(55)</label><mml:math id="m56"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ55">Equation 54</xref> expression breaks down at high <inline-formula><mml:math id="inf788"><mml:mi>η</mml:mi></mml:math></inline-formula> where the true value of <inline-formula><mml:math id="inf789"><mml:mi>ν</mml:mi></mml:math></inline-formula> is largely independent of <inline-formula><mml:math id="inf790"><mml:mi>e</mml:mi></mml:math></inline-formula>. In this case, when both <inline-formula><mml:math id="inf791"><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac></mml:math></inline-formula> is small and <inline-formula><mml:math id="inf792"><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is large, we can drop the third term in the denominator in <xref ref-type="disp-formula" rid="equ55">Equation 54</xref>.</p><p>There is a discontinuity in <xref ref-type="disp-formula" rid="equ55">Equation 54</xref> at the value of <inline-formula><mml:math id="inf793"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> where the denominator equals zero. This critical value of <inline-formula><mml:math id="inf794"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf795"><mml:msup><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, is given by <xref ref-type="disp-formula" rid="equ57">Equation 56</xref>.<disp-formula id="equ57"><label>(56)</label><mml:math id="m57"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Taking a series expansion in <inline-formula><mml:math id="inf796"><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and keeping the first two terms:<disp-formula id="equ58"><label>(57)</label><mml:math id="m58"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>At high <inline-formula><mml:math id="inf797"><mml:mi>η</mml:mi></mml:math></inline-formula>, the middle term dominates, and at small <inline-formula><mml:math id="inf798"><mml:mi>η</mml:mi></mml:math></inline-formula>, the first two terms dominate (since the third term is <inline-formula><mml:math id="inf799"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mrow><mml:mn>9.8</mml:mn><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf800"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula>). This transition governs the change between the low <inline-formula><mml:math id="inf801"><mml:mi>e</mml:mi></mml:math></inline-formula> and high <inline-formula><mml:math id="inf802"><mml:mi>e</mml:mi></mml:math></inline-formula> regimes; <xref ref-type="disp-formula" rid="equ59">Equation 58</xref> is plotted in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> and <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>.<disp-formula id="equ59"><label>(58)</label><mml:math id="m59"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If we substitute this critical value of <inline-formula><mml:math id="inf803"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> into the mean-field equations and take <inline-formula><mml:math id="inf804"><mml:mi>η</mml:mi></mml:math></inline-formula> to 0, we recover the no-CRISPR mean-field solutions for <inline-formula><mml:math id="inf805"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf806"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf807"><mml:mi>C</mml:mi></mml:math></inline-formula>. Since this also corresponds to <inline-formula><mml:math id="inf808"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, this seems to explain why several simulation values of the phage establishment probability go to 0 around effective <inline-formula><mml:math id="inf809"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> for small <inline-formula><mml:math id="inf810"><mml:mi>η</mml:mi></mml:math></inline-formula> and small <italic>C</italic><sub>0</sub> (<xref ref-type="fig" rid="fig30">Figure 30</xref>). Despite the presence of spacers with non-zero effectiveness, the population appears to behave as if there is no CRISPR near this point, which removes the fitness advantage of new phage mutants and lowers their establishment probability. We also see large fluctuations in total bacteria population size near this critical point (<xref ref-type="fig" rid="fig31">Figure 31</xref>).</p><fig id="fig30" position="float"><label>Figure 30.</label><caption><title>Fraction of bacteria with spacers <inline-formula><mml:math id="inf811"><mml:mi>ν</mml:mi></mml:math></inline-formula> vs. effective <inline-formula><mml:math id="inf812"><mml:mi>e</mml:mi></mml:math></inline-formula>.</title><p>The solid line is the full numerical theoretical solution. The dashed black line is given by <xref ref-type="disp-formula" rid="equ59">Equation 58</xref>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig30-v2.tif"/></fig><fig id="fig31" position="float"><label>Figure 31.</label><caption><title>Population standard deviation divided by population mean as a function of the distance from the average immunity critical point given by <xref ref-type="disp-formula" rid="equ59">Equation 58</xref>.</title><p>Insets show a smaller x-axis range for the same quantities. Total phage (top left), total bacteria (top right), fraction of bacteria with spacers (bottom left) and total nutrients (bottom right) are plotted. X error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig31-v2.tif"/></fig><p>Another way to understand the critical point is to look at the difference in relative fitness between bacteria with and without spacers, <inline-formula><mml:math id="inf813"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf814"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula>:<disp-formula id="equ60"><label>(59)</label><mml:math id="m60"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now if effective <inline-formula><mml:math id="inf815"><mml:mi>e</mml:mi></mml:math></inline-formula> is given by <xref ref-type="disp-formula" rid="equ59">Equation 58</xref>:<disp-formula id="equ61"><label>(60)</label><mml:math id="m61"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ61">Equation 60</xref> indicates that at the critical value of effective <inline-formula><mml:math id="inf816"><mml:mi>e</mml:mi></mml:math></inline-formula>, the fitness difference is exactly given by the balance of spacer acquisition and spacer loss. Below this critical point, there are additional constant negative terms, and for the same values of <inline-formula><mml:math id="inf817"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf818"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula>, the relative fitness of spacer-containing bacteria is lower than naive bacteria; above this point, it is higher. At the critical point, the immunity boost from spacers exactly cancels out spacer loss. It is interesting that for the same reasons that many parameters collapse onto the same curves as a function of average immunity, the value of this critical point is largely independent of the parameters of CRISPR immunity and occurs at a value of effective <inline-formula><mml:math id="inf819"><mml:mrow><mml:mi>e</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> regardless of <inline-formula><mml:math id="inf820"><mml:mi>μ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf821"><mml:mi>e</mml:mi></mml:math></inline-formula>, or <italic>C</italic><sub>0</sub>.</p></sec><sec id="s4-4-4"><title>Large <inline-formula><mml:math id="inf822"><mml:mi>e</mml:mi></mml:math></inline-formula> approximation for <inline-formula><mml:math id="inf823"><mml:mi>ν</mml:mi></mml:math></inline-formula></title><p>In the limit of <inline-formula><mml:math id="inf824"><mml:mrow><mml:mi>e</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and small <inline-formula><mml:math id="inf825"><mml:mi>η</mml:mi></mml:math></inline-formula>, we find the following approximate solution for <inline-formula><mml:math id="inf826"><mml:mi>ν</mml:mi></mml:math></inline-formula> by setting <inline-formula><mml:math id="inf827"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and taking a series expansion in <inline-formula><mml:math id="inf828"><mml:mi>η</mml:mi></mml:math></inline-formula>.<disp-formula id="equ62"><label>(61)</label><mml:math id="m62"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ62">Equation 61</xref> is plotted in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> in red. The second term proportional to <inline-formula><mml:math id="inf829"><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is tiny compared to the first for all values of <inline-formula><mml:math id="inf830"><mml:mi>η</mml:mi></mml:math></inline-formula> we use.</p></sec><sec id="s4-4-5"><title>Approximation for <inline-formula><mml:math id="inf831"><mml:msub><mml:mi>T</mml:mi><mml:mtext>ext</mml:mtext></mml:msub></mml:math></inline-formula></title><p>If we evaluate the mean phage time to extinction (‘Neutral time to extinction from backward master equation’) at the deterministic mean phage clone size, we can approximate <inline-formula><mml:math id="inf832"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf833"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> as before:<disp-formula id="equ63"><label>(62)</label><mml:math id="m63"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>ext</mml:mtext></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ν</mml:mi><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We expand <inline-formula><mml:math id="inf834"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf835"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> in powers of <inline-formula><mml:math id="inf836"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ64"><label>(63)</label><mml:math id="m64"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ65"><label>(64)</label><mml:math id="m65"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>A</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Note that <inline-formula><mml:math id="inf837"><mml:mi>ν</mml:mi></mml:math></inline-formula> never appears without <inline-formula><mml:math id="inf838"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> beside it in these expressions, so we will use the zeroth-order expression for <inline-formula><mml:math id="inf839"><mml:mi>ν</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ56">Equation 55</xref>) which still allows us to keep <inline-formula><mml:math id="inf840"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> to first order elsewhere.<disp-formula id="equ66"><label>(65)</label><mml:math id="m66"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Substituting <xref ref-type="disp-formula" rid="equ64 equ65 equ66">Equations 63–65</xref> into <inline-formula><mml:math id="inf841"><mml:msub><mml:mi>T</mml:mi><mml:mtext>ext</mml:mtext></mml:msub></mml:math></inline-formula>:<disp-formula id="equ67"><label>(66)</label><mml:math id="m67"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>ext</mml:mtext></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>f</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>g</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The second term is order <inline-formula><mml:math id="inf842"><mml:mfrac><mml:mi>e</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:math></inline-formula>, which we drop, giving the following approximation for the mean phage time to extinction (plotted in <xref ref-type="fig" rid="fig32">Figure 32</xref>):<disp-formula id="equ68"><label>(67)</label><mml:math id="m68"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>ext</mml:mtext></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig id="fig32" position="float"><label>Figure 32.</label><caption><title>Approximate phage time to extinction vs. numerically calculated theoretical time to extinction, where the approximate time to extinction is given by (<xref ref-type="bibr" rid="bib77">Koskella, 2014</xref>).</title><p>The full theoretical predicted value of <inline-formula><mml:math id="inf843"><mml:mi>m</mml:mi></mml:math></inline-formula> is used in the approximate expression.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig32-v2.tif"/></fig><p>Here again we are using the phage population size independent of CRISPR (<inline-formula><mml:math id="inf844"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>). Notably this is independent of <inline-formula><mml:math id="inf845"><mml:mi>η</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf846"><mml:mi>e</mml:mi></mml:math></inline-formula> (except implicitly in <inline-formula><mml:math id="inf847"><mml:mi>m</mml:mi></mml:math></inline-formula>) but is still extremely close to the full theoretical quantity.</p><p>From <xref ref-type="disp-formula" rid="equ68">Equation 67</xref> we learn:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf848"><mml:msub><mml:mi>T</mml:mi><mml:mtext>ext</mml:mtext></mml:msub></mml:math></inline-formula> is insensitive to the changes in total phage population size caused by changing CRISPR immunity.</p></list-item><list-item><p><inline-formula><mml:math id="inf849"><mml:msub><mml:mi>T</mml:mi><mml:mtext>ext</mml:mtext></mml:msub></mml:math></inline-formula> increases if the phage clone size <inline-formula><mml:math id="inf850"><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub><mml:mi>m</mml:mi></mml:mfrac></mml:math></inline-formula> increases.</p></list-item><list-item><p><inline-formula><mml:math id="inf851"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the effective burst size: for every phage adsorption, <inline-formula><mml:math id="inf852"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> new phages emerge on average. This can be thought of as the phage growth rate. <inline-formula><mml:math id="inf853"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> lies between 0 and 1; if <inline-formula><mml:math id="inf854"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is larger, <inline-formula><mml:math id="inf855"><mml:msub><mml:mi>T</mml:mi><mml:mtext>ext</mml:mtext></mml:msub></mml:math></inline-formula> is also larger.</p></list-item><list-item><p>The burst size <inline-formula><mml:math id="inf856"><mml:mi>B</mml:mi></mml:math></inline-formula> also appears alone in the denominator (<inline-formula><mml:math id="inf857"><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). A larger burst size means larger fluctuations: for larger <inline-formula><mml:math id="inf858"><mml:mi>B</mml:mi></mml:math></inline-formula>, more deaths tend to happen between birth events at steady-state, so extinction happens sooner on average (shorter <inline-formula><mml:math id="inf859"><mml:msub><mml:mi>T</mml:mi><mml:mtext>ext</mml:mtext></mml:msub></mml:math></inline-formula> from <inline-formula><mml:math id="inf860"><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in the denominator).</p></list-item><list-item><p>The normalized chemostat flow rate <inline-formula><mml:math id="inf861"><mml:mi>f</mml:mi></mml:math></inline-formula> lies between 0 and 1 and is a death rate for phages; if <inline-formula><mml:math id="inf862"><mml:mi>f</mml:mi></mml:math></inline-formula> is larger <inline-formula><mml:math id="inf863"><mml:msub><mml:mi>T</mml:mi><mml:mtext>ext</mml:mtext></mml:msub></mml:math></inline-formula> is smaller.</p></list-item></list><p>The <inline-formula><mml:math id="inf864"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mtext>ln</mml:mtext><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> term is more difficult to parse. A hand-wavy intuition is that while larger <inline-formula><mml:math id="inf865"><mml:mi>m</mml:mi></mml:math></inline-formula> sometimes means smaller clone size and shorter extinction times (<inline-formula><mml:math id="inf866"><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub><mml:mi>m</mml:mi></mml:mfrac></mml:math></inline-formula>), it is also related to increased phage success in the population, and so the <inline-formula><mml:math id="inf867"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mtext>ln</mml:mtext><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> in the numerator softens the straight inverse dependence on <inline-formula><mml:math id="inf868"><mml:mi>m</mml:mi></mml:math></inline-formula> through clone size.</p></sec><sec id="s4-4-6"><title>Approximation for <inline-formula><mml:math id="inf869"><mml:msub><mml:mi>P</mml:mi><mml:mtext>est</mml:mtext></mml:msub></mml:math></inline-formula></title><p>Now we approximate the probability of phage clone establishment.<disp-formula id="equ69"><label>(68)</label><mml:math id="m69"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Recall that <inline-formula><mml:math id="inf870"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf871"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf872"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. These all depend on <inline-formula><mml:math id="inf873"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, so plugging in <xref ref-type="disp-formula" rid="equ43">Equation 42</xref> for <inline-formula><mml:math id="inf874"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, we get<disp-formula id="equ70"><label>(69)</label><mml:math id="m70"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ70">Equation 69</xref> with <inline-formula><mml:math id="inf875"><mml:mi>ν</mml:mi></mml:math></inline-formula> given by <xref ref-type="disp-formula" rid="equ55">Equation 54</xref> is plotted in blue in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>. The same expression with <inline-formula><mml:math id="inf876"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is plotted in green. There is a discontinuity in <inline-formula><mml:math id="inf877"><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> when the third term in the denominator becomes large, which is why the blue lines do not extend to large effective <inline-formula><mml:math id="inf878"><mml:mi>e</mml:mi></mml:math></inline-formula>. These two approximations bound the full solution at low effective <inline-formula><mml:math id="inf879"><mml:mi>e</mml:mi></mml:math></inline-formula>.</p></sec></sec><sec id="s4-5"><title>Approximation for phage mutation rate</title><p>The effective phage mutation rate (new phages per minute, <inline-formula><mml:math id="inf880"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>) is given by <xref ref-type="disp-formula" rid="equ71">Equation 70</xref>. In general, <inline-formula><mml:math id="inf881"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> depends both explicitly on <inline-formula><mml:math id="inf882"><mml:mi>e</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf883"><mml:mi>m</mml:mi></mml:math></inline-formula> and implicitly through <inline-formula><mml:math id="inf884"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf885"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf886"><mml:mi>ν</mml:mi></mml:math></inline-formula>. We do the same small <inline-formula><mml:math id="inf887"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> approximation for <inline-formula><mml:math id="inf888"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> as above, where we expand <inline-formula><mml:math id="inf889"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf890"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf891"><mml:mi>ν</mml:mi></mml:math></inline-formula> in <inline-formula><mml:math id="inf892"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf893"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, etc.). The zeroth order approximation (<inline-formula><mml:math id="inf894"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) does not change <inline-formula><mml:math id="inf895"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> much at all across the whole range of parameters we investigated (<xref ref-type="disp-formula" rid="equ72">Equation 71</xref> and <xref ref-type="fig" rid="fig33">Figure 33</xref>).<disp-formula id="equ71"><label>(70)</label><mml:math id="m71"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ72"><label>(71)</label><mml:math id="m72"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig id="fig33" position="float"><label>Figure 33.</label><caption><title>Approximate phage mutation rate for <inline-formula><mml:math id="inf896"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> vs theoretical phage mutation rate.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig33-v2.tif"/></fig><p>Approximation for <inline-formula><mml:math id="inf897"><mml:mi>m</mml:mi></mml:math></inline-formula></p><p>Finally, we do the same approximation for the complete expression for <inline-formula><mml:math id="inf898"><mml:mi>m</mml:mi></mml:math></inline-formula>, expanding all variables in powers of <inline-formula><mml:math id="inf899"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. The result turns out to be the same as if we combined the individual approximations shown above.<disp-formula id="equ73"><label>(72)</label><mml:math id="m73"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>e</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>phage establishment fraction</mml:mtext></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ν</mml:mi><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>phage mutation rate</mml:mtext></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:munder><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ν</mml:mi><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>large phage clone time to extinction</mml:mtext></mml:mrow></mml:munder></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ74"><label>(73)</label><mml:math id="m74"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>m</mml:mi><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>ν</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>3</mml:mn></mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>3</mml:mn></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Let’s look at the first term by itself, neglecting <inline-formula><mml:math id="inf900"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> and higher. Rearranging to collect <inline-formula><mml:math id="inf901"><mml:mi>m</mml:mi></mml:math></inline-formula> terms:<disp-formula id="equ75"><label>(74)</label><mml:math id="m75"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Let us let the right-hand side of <xref ref-type="disp-formula" rid="equ75">Equation 74</xref> equal <inline-formula><mml:math id="inf902"><mml:mi>a</mml:mi></mml:math></inline-formula>, a new parameter that is independent of <inline-formula><mml:math id="inf903"><mml:mi>m</mml:mi></mml:math></inline-formula>. Now we are approximating:<disp-formula id="equ76"><label>(75)</label><mml:math id="m76"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Changing variables to<disp-formula id="equ77"><label>(76)</label><mml:math id="m77"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We solve this perturbatively. Let <inline-formula><mml:math id="inf904"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>, then let <inline-formula><mml:math id="inf905"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where we assume <inline-formula><mml:math id="inf906"><mml:mi>δ</mml:mi></mml:math></inline-formula> is small. Now we are solving for the perturbation<disp-formula id="equ78">: <label>(77)</label><mml:math id="m78"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We approximate <inline-formula><mml:math id="inf907"><mml:mrow><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula> for small <inline-formula><mml:math id="inf908"><mml:mi>δ</mml:mi></mml:math></inline-formula>. This gives<disp-formula id="equ79"><label>(78)</label><mml:math id="m79"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ80"><label>(79)</label><mml:math id="m80"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ81"><label>(80)</label><mml:math id="m81"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf909"><mml:mi>a</mml:mi></mml:math></inline-formula> is large, the leading order contribution to <inline-formula><mml:math id="inf910"><mml:mi>m</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf911"><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>.<disp-formula id="equ82"><label>(81)</label><mml:math id="m82"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>e</mml:mi><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Measured <inline-formula><mml:math id="inf912"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf913"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is shown in <xref ref-type="fig" rid="fig34">Figure 34</xref>. To get more insight into the dependence of <inline-formula><mml:math id="inf914"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf915"><mml:mi>m</mml:mi></mml:math></inline-formula> on parameters, we make some approximations. First, since <inline-formula><mml:math id="inf916"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mo>&lt;&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, we approximate <inline-formula><mml:math id="inf917"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Then substituting <inline-formula><mml:math id="inf918"><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> in <inline-formula><mml:math id="inf919"><mml:mi>a</mml:mi></mml:math></inline-formula>:<disp-formula id="equ83"><label>(82)</label><mml:math id="m83"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>e</mml:mi><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mfrac><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig id="fig34" position="float"><label>Figure 34.</label><caption><title>Measured mean <inline-formula><mml:math id="inf920"><mml:mi>m</mml:mi></mml:math></inline-formula> in simulations vs. <inline-formula><mml:math id="inf921"><mml:mi>a</mml:mi></mml:math></inline-formula> as given by <xref ref-type="disp-formula" rid="equ82">Equation 81</xref>.</title><p>The solid line is <inline-formula><mml:math id="inf922"><mml:mi>m</mml:mi></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf923"><mml:mi>a</mml:mi></mml:math></inline-formula> solved numerically using <xref ref-type="disp-formula" rid="equ116">Equation 113</xref>. The right panel shows the same but with the two lowest values of <inline-formula><mml:math id="inf924"><mml:mi>η</mml:mi></mml:math></inline-formula> removed. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig34-v2.tif"/></fig><p>Substituting in <inline-formula><mml:math id="inf925"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ84"><label>(83)</label><mml:math id="m84"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ85"><label>(84)</label><mml:math id="m85"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>e</mml:mi><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mfrac><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now we do an expansion assuming large burst size, <inline-formula><mml:math id="inf926"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>&gt;&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Expanding in <inline-formula><mml:math id="inf927"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ86"><label>(85)</label><mml:math id="m86"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mi>e</mml:mi><mml:mi>η</mml:mi><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now if <inline-formula><mml:math id="inf928"><mml:mi>η</mml:mi></mml:math></inline-formula> is small, specifically if <inline-formula><mml:math id="inf929"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, we can expand in <inline-formula><mml:math id="inf930"><mml:mi>η</mml:mi></mml:math></inline-formula>. This assumption roughly amounts to assuming bacterial survival followed by spacer acquisition is rare compared to phage predation and spacer loss.<disp-formula id="equ87"><label>(86)</label><mml:math id="m87"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mi>e</mml:mi><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The 0th-order term captures the trend across a wide range of parameters and gives some insight into parameter dependence (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). To summarize: For <inline-formula><mml:math id="inf931"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mo>&lt;&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf932"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>&gt;&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf933"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ88"><label>(87)</label><mml:math id="m88"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>e</mml:mi><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ88">Equation 87</xref> implies that <inline-formula><mml:math id="inf934"><mml:mi>m</mml:mi></mml:math></inline-formula> goes like <inline-formula><mml:math id="inf935"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, a non-intuitive dependence.</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf936"><mml:mi>m</mml:mi></mml:math></inline-formula> increases as the overall phage mutation rate increases.</p></list-item><list-item><p><inline-formula><mml:math id="inf937"><mml:mi>m</mml:mi></mml:math></inline-formula> increases as <inline-formula><mml:math id="inf938"><mml:mi>ν</mml:mi></mml:math></inline-formula> increases.</p></list-item><list-item><p><inline-formula><mml:math id="inf939"><mml:mi>m</mml:mi></mml:math></inline-formula> increases for the same reasons that phage time to extinction increases, except that it depends on the total phage population size (instead of the phage clone size).</p></list-item></list><sec id="s4-5-1"><title>Speed of evolution</title><p>This section provides more detail on our calculation of the speed of phage evolution presented in ‘Dynamics are determined by diversity’.</p><p>The speed of evolution of a population is often taken as the rate at which its genetic structure changes over time. For example, Betts et al. measure the rate of evolution in a bacteria-phage coevolution experiment by calculating the Euclidean genetic distance between populations at different time points (<xref ref-type="bibr" rid="bib6">Betts et al., 2018</xref>), and Rouzine and Rozhnova calculate the rate of substitution (<xref ref-type="bibr" rid="bib115">Rouzine and Rozhnova, 2018</xref>). Speed of evolution is sometimes defined more functionally as the rate of change of a population’s fitness over time (see <xref ref-type="bibr" rid="bib33">Desai and Fisher, 2007</xref>; <xref ref-type="bibr" rid="bib34">Desai et al., 2007</xref>; <xref ref-type="bibr" rid="bib115">Rouzine and Rozhnova, 2018</xref>).</p><p>In our context, the average population fitness does not change over time at steady state (more like a Red Queen scenario than an arms-race scenario) and so we use a measure of genetic distance to calculate the speed of evolution. Instead of Euclidean distance (L2 norm), we use Hamming distance or edit distance (L1 norm). This distance metric is more representative of the process involved in changing sequences since the sequence [1,1] is mutationally twice as far from [0,0] as [0,1]. Our sequence space has as many dimensions as the number of genetic sites, and a population’s 'centre of mass' can be calculated by weighting each sequence ('position') in this space by the frequency of each subpopulation with that sequence. Our effective space is dimension <inline-formula><mml:math id="inf940"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> since each protospacer has 30 sites that can mutate. Each site can have the value 0 or 1 meaning there are 2<sup>30</sup> possible sequences, but a sequence can differ by at most 30 changes from another sequence. The maximum distance possible in our model using the L1 norm is 30.</p><p>For example: if <inline-formula><mml:math id="inf941"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and there are 20 phages with the sequence [0,1] and 10 phages with the sequence [1,1], then the centre of mass in the two-dimensional space is <inline-formula><mml:math id="inf942"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ89"><mml:math id="m89"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>30</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>20</mml:mn><mml:mo>×</mml:mo><mml:mn>0</mml:mn><mml:mo>+</mml:mo><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn><mml:mi>x</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ90"><mml:math id="m90"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>30</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>20</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>y</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If the ancestor phage is [0,0], then the centre of mass distance is <inline-formula><mml:math id="inf943"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>4</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>. If the ancestor sequence is at one of the corners (i.e. only values of 0 or 1), calculating the centre of mass in this manner is the same as calculating the population-weighted average distance from the ancestor: 20 phages are 1 mutation away, 10 are 2 mutations away, therefore the average distance is <inline-formula><mml:math id="inf944"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo>+</mml:mo><mml:mn>20</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>30</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>4</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>. However, if the ancestor sequence is not at a corner (i.e. if comparing two centres of mass), the sum of distances gives larger values than the difference of centres of mass. The sum of distances is a measure of the spread, while the change in centre of mass is a measure of the speed of evolution.</p><p>We can look at the distance of the phage and bacteria population in simulations from the ancestor sequence over time to get an idea of how the population moves through sequence space. <xref ref-type="fig" rid="fig35">Figures 35</xref> and <xref ref-type="fig" rid="fig36">36</xref> show the mutational distance for phage and bacteria over time from either the ancestor phage sequence or a centre of mass starting point later in the simulation, for low (<xref ref-type="fig" rid="fig35">Figure 35</xref>) and high (<xref ref-type="fig" rid="fig36">Figure 36</xref>) values of <inline-formula><mml:math id="inf945"><mml:mi>η</mml:mi></mml:math></inline-formula>.</p><fig id="fig35" position="float"><label>Figure 35.</label><caption><title>Phage and bacteria centre of mass distance from the original phage and bacteria sequences.</title><p>The centre of mass distance is plotted in blue for phage (left) and bacteria (centre). Grey circles represent the size of clonal subpopulations at each distance from the ancestor sequence (arbitrary scale). The third panel shows the weighted average distance of the population from the centre of mass at that timepoint, a measure of the spread in sequences present at any time. In this simulation <inline-formula><mml:math id="inf946"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf947"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf948"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf949"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and mean <inline-formula><mml:math id="inf950"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2.8</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig35-v2.tif"/></fig><fig id="fig36" position="float"><label>Figure 36.</label><caption><title>Phage and bacteria centre of mass distance from the original phage and bacteria sequences.</title><p>The centre of mass distance is plotted in blue for phage (left) and bacteria (centre). Grey circles represent the size of clonal subpopulations at each distance from the ancestor sequence (arbitrary scale). The third panel shows the weighted average distance of the population from the centre of mass at that timepoint, a measure of the spread in sequences present at any time. In this simulation <inline-formula><mml:math id="inf951"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf952"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf953"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf954"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and mean <inline-formula><mml:math id="inf955"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>14.5</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig36-v2.tif"/></fig><p>Since the maximum distance in our model is 30, there comes a point in distance where mutations back in the direction of the ancestor become likely. The fraction of available mutations <italic>f</italic><sub><italic>m</italic></sub> that move away from the ancestor decreases as the distance increases: <inline-formula><mml:math id="inf956"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mtext>distance</mml:mtext></mml:mrow><mml:mi>L</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. For <inline-formula><mml:math id="inf957"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula>, this means that at a distance of 15 the population is equally likely to move towards or away from the ancestor. This is apparent in <xref ref-type="fig" rid="fig35">Figure 35</xref> – the distance from the ancestor phage reaches 15 and then begins to decrease. In other simulations, the distance continues to increase and does not come close to 15 (<xref ref-type="fig" rid="fig36">Figure 36</xref>).</p></sec></sec><sec id="s4-6"><title>Measuring speed of evolution</title><p>The speed of evolution in this framework is the distance the population travels in spacer space in a certain amount of time. In principle, this is straightforward to calculate, but we find that the distance between populations does not increase linearly with the time interval used to calculate the distance (<xref ref-type="fig" rid="fig37">Figure 37</xref> left panel). This means that measured speed will depend on the time interval used to calculate it (<xref ref-type="fig" rid="fig37">Figure 37</xref> right panel), and there is no clear way to choose one particular time interval over another. We go to the long <inline-formula><mml:math id="inf958"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> limit and measure the maximum distance from the ancestor reached by a population in a set number of bacterial generations. The maximum distance reached by bacteria and phage populations is highly correlated with each other within a simulation and is also repeatable across independent simulations (<xref ref-type="fig" rid="fig38">Figure 38</xref>). Speed in this definintion increases with phage mutant initial fitness (<xref ref-type="fig" rid="fig39">Figure 39</xref>).</p><fig id="fig37" position="float"><label>Figure 37.</label><caption><title>Phage and bacteria centre of mass distance from the centre of mass at time <inline-formula><mml:math id="inf959"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (left) and the distance divided by the time interval <inline-formula><mml:math id="inf960"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> (right).</title><p>Distances are averaged over the entire simulation at steady state; error bars are standard deviation. Simulation parameters are <inline-formula><mml:math id="inf961"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf962"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf963"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf964"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and mean <inline-formula><mml:math id="inf965"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>14.5</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig37-v2.tif"/></fig><fig id="fig38" position="float"><label>Figure 38.</label><caption><title>Maximum distance from ancestor population for bacteria vs. phage.</title><p>The maximum distance is highly correlated, indicating that the bacteria population tracks the phage population closely. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig38-v2.tif"/></fig><fig id="fig39" position="float"><label>Figure 39.</label><caption><title>Phage mutational distance per generation vs. initial phage mutant fitness for simulations with <inline-formula><mml:math id="inf966"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf967"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf968"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</title><p>Error bars are the standard deviation across multiple independent simulations and are shown in the positive direction only.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig39-v2.tif"/></fig><p>The total number of phage establishments in a simulation determines the maximum distance that the population can move away from the ancestor, but if diversity is high, many of those establishments will not actually move the population further away. A simple approximate scaling for this process is that total distance is proportional to <inline-formula><mml:math id="inf969"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:math></inline-formula>: if there are <inline-formula><mml:math id="inf970"><mml:mi>m</mml:mi></mml:math></inline-formula> established clones and one of them is the furthest away from the ancestor, there is a <inline-formula><mml:math id="inf971"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:math></inline-formula> probability that the next establishment will come from the furthest-away clone. This is similar to <xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref> where if they have <inline-formula><mml:math id="inf972"><mml:mi>v</mml:mi></mml:math></inline-formula> protospacers per phage (and one dominant bacterial species with a spacer), there is only a <inline-formula><mml:math id="inf973"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math></inline-formula> chance that a random mutation will actually be an escape mutation.</p><p>Since <inline-formula><mml:math id="inf974"><mml:mi>m</mml:mi></mml:math></inline-formula> is a product of mutation rate, establishment probability, and extinction time, plotting distance per establishment vs. <inline-formula><mml:math id="inf975"><mml:mi>m</mml:mi></mml:math></inline-formula> is equivalent to plotting speed vs. time to extinction (<xref ref-type="disp-formula" rid="equ91">Equation 88</xref>). We have <inline-formula><mml:math id="inf976"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>est</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf977"><mml:msub><mml:mi>P</mml:mi><mml:mtext>est</mml:mtext></mml:msub></mml:math></inline-formula> is the probability of establishment for a new phage clone, <inline-formula><mml:math id="inf978"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> is the effective phage mutation rate, and <inline-formula><mml:math id="inf979"><mml:mi>T</mml:mi></mml:math></inline-formula> is the mean time to extinction for large phage clones. Let the mutational distance from the ancestor be <inline-formula><mml:math id="inf980"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf981"><mml:mi>v</mml:mi></mml:math></inline-formula> is the 'speed' and <inline-formula><mml:math id="inf982"><mml:mi>τ</mml:mi></mml:math></inline-formula> is a fixed time interval used to measure distance.<disp-formula id="equ91"><label>(88)</label><mml:math id="m91"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mfrac><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>est</mml:mtext></mml:msub><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>∝</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>est</mml:mtext></mml:msub><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>∝</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>est</mml:mtext></mml:msub><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>v</mml:mi></mml:mtd><mml:mtd><mml:mo>∝</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref> shows distance per establishment vs. <inline-formula><mml:math id="inf983"><mml:mi>m</mml:mi></mml:math></inline-formula> and speed vs. <inline-formula><mml:math id="inf984"><mml:mi>T</mml:mi></mml:math></inline-formula>. Relating distance and speed to the time to extinction gives further insight into the underlying parameter dependencies: we know from other approximations ('Analytic approximations for diversity') that <inline-formula><mml:math id="inf985"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∝</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>, and for small <inline-formula><mml:math id="inf986"><mml:mi>m</mml:mi></mml:math></inline-formula> we can substitute our approximation for <inline-formula><mml:math id="inf987"><mml:mi>m</mml:mi></mml:math></inline-formula>, giving <inline-formula><mml:math id="inf988"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∝</mml:mo><mml:msup><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf989"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∝</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>η</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Applying the same approximation here as for <inline-formula><mml:math id="inf990"><mml:mi>m</mml:mi></mml:math></inline-formula> above (<xref ref-type="disp-formula" rid="equ88">Equation 87</xref>), with <inline-formula><mml:math id="inf991"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6</xref>):<disp-formula id="equ92"><label>(89)</label><mml:math id="m92"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo>≈</mml:mo><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>μ</mml:mi><mml:mi>η</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-7"><title>Spread in sequence space</title><p>We can ask how spread out the population is in sequence space – how far is the average clone from the centre of mass? When there are more clones (larger <inline-formula><mml:math id="inf992"><mml:mi>m</mml:mi></mml:math></inline-formula>), the population spread is larger (<xref ref-type="fig" rid="fig40">Figures 40</xref> and <xref ref-type="fig" rid="fig41">41</xref>). The spread also depends on initial conditions, at least on the timescale of our simulations: simulations that start with one phage clone (<xref ref-type="fig" rid="fig40">Figure 40</xref>) have lower spread than simulations that start with 50 phage clones (<xref ref-type="fig" rid="fig41">Figure 41</xref>). In principle, waiting for a very long time in simulations that begin with 1 clone should produce results in line with simulations that start with 50 clones as different clans diverge from each other over time. This suggests that there are multiple features with which we could define steady state, and they do not all reach true steady state at the same time. Total population size equilibrates fastest, followed by diversity (<xref ref-type="fig" rid="fig8">Figure 8</xref>), and then spread in sequence space.</p><fig id="fig40" position="float"><label>Figure 40.</label><caption><title>Average population distance from the centre of mass at steady state for bacteria (left) and phages (right) vs. mean <inline-formula><mml:math id="inf993"><mml:mi>m</mml:mi></mml:math></inline-formula> for simulations with one original phage clone ancestor.</title><p>The dashed line is <inline-formula><mml:math id="inf994"><mml:mrow><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, a purely phenomenological choice. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig40-v2.tif"/></fig><fig id="fig41" position="float"><label>Figure 41.</label><caption><title>Average population distance from the centre of mass for bacteria (left) and phages (right) vs. mean <inline-formula><mml:math id="inf995"><mml:mi>m</mml:mi></mml:math></inline-formula> for simulations with 50 original phage clones.</title><p>The dashed line is <inline-formula><mml:math id="inf996"><mml:mrow><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and the solid line is <inline-formula><mml:math id="inf997"><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig41-v2.tif"/></fig></sec><sec id="s4-8"><title>Number and size of clone clans</title><p>Watching a simulation visualization of spacer and protospacer types, it is apparent that over time several different lineages may appear and become separated from each other in genome space (<xref ref-type="fig" rid="fig42">Figure 42</xref>). What determines how many separate 'clans' there are at steady state? What is the characteristic size of a clan? How does this depend on parameters? To address this question, we perform agglomerative clustering on protospacer and spacer sequences to identify separated groups of sequences. We use the L1 norm to define distance, which as described above is the most natural distance metric for sequence changes by mutation. Clusters are grouped using the ‘single’ linkage criterion in scikit-learn AgglomerativeClustering: the cluster distance is the minimum of the distances between all observations of the two sets. In other words, a collection of sequences that differ from any other sequence in the cluster by one mutation are all grouped together, even if some of the sequences differ by more than one from each other. This is a reasonable criterion for identifying groups of sequences that are related by descent and are actively feeding each other with mutations.</p><fig id="fig42" position="float"><label>Figure 42.</label><caption><title>A frame from a simulation movie at 5000 generations with <inline-formula><mml:math id="inf998"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf999"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1000"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1001"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, initial <inline-formula><mml:math id="inf1002"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</title><p>Phages are on the left, bacteria with spacers on the right.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig42-v2.tif"/></fig><p><xref ref-type="fig" rid="fig43">Figures 43</xref> and <xref ref-type="fig" rid="fig44">44</xref> show the resulting dendrogram from this clustering process for phages and bacteria at one time point for one initial phage clone and 10 initial phage clones. To determine the number of clusters, we use a distance threshold of 2. This separates groups that have no members closer than two mutations away. In reality, these groups may still be linked by descent more recently than other groups (apparent in the dendrograms), but a distance of 2 or more means these groups are likely to remain separate going forward in time since they lack a connecting clone that can be accessed by a single mutation.</p><fig id="fig43" position="float"><label>Figure 43.</label><caption><title>Dendrogram resulting from agglomerative clustering with the L1 norm and linking clusters using the minimum distance between members.</title><p>The number of clusters is determined with a cutoff at a distance of 2. <inline-formula><mml:math id="inf1003"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1004"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1005"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1006"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, initial <inline-formula><mml:math id="inf1007"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig43-v2.tif"/></fig><fig id="fig44" position="float"><label>Figure 44.</label><caption><title>Dendrogram resulting from agglomerative clustering with the L1 norm and linking clusters using the minimum distance between members.</title><p>The number of clusters is determined with a cutoff at a distance of 2. <inline-formula><mml:math id="inf1008"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1009"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1010"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1011"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, initial <inline-formula><mml:math id="inf1012"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig44-v2.tif"/></fig><p>Simulations with an initial number of clones greater than 1 converge to a steady-state number of clusters at a different rate than beginning with one clone since clones from a single ancestor remain more related on average than clones from multiple different ancestors (<xref ref-type="fig" rid="fig45">Figures 45</xref> and <xref ref-type="fig" rid="fig46">46</xref>).</p><fig id="fig45" position="float"><label>Figure 45.</label><caption><title>Clan number and size over time in a simulation with <inline-formula><mml:math id="inf1013"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1014"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1015"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1016"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, initial <inline-formula><mml:math id="inf1017"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig45-v2.tif"/></fig><fig id="fig46" position="float"><label>Figure 46.</label><caption><title>Clan number and size over time in a simulation with <inline-formula><mml:math id="inf1018"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1019"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1020"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1021"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, initial <inline-formula><mml:math id="inf1022"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig46-v2.tif"/></fig><p>We calculate the average number of clans at steady state and the average clan size for bacteria and phages across all simulations. The number of clans is proportional to <inline-formula><mml:math id="inf1023"><mml:mi>m</mml:mi></mml:math></inline-formula>; at high mutation rates the number of clans is approximately <inline-formula><mml:math id="inf1024"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Low mutation rates mean that it takes a long time for the number of clans to equilibrate, which can be seen by contrasting the mutation rate dependence of 10 initial clones (<xref ref-type="fig" rid="fig47">Figure 47</xref>) with 1 initial clone (<xref ref-type="fig" rid="fig48">Figure 48</xref>).</p><fig id="fig47" position="float"><label>Figure 47.</label><caption><title>Average clan number vs. <inline-formula><mml:math id="inf1025"><mml:mi>m</mml:mi></mml:math></inline-formula> for all simulations that begin with 10 clones.</title><p>The dashed lines are <inline-formula><mml:math id="inf1026"><mml:mi>m</mml:mi></mml:math></inline-formula> divided by the mean bacterial clan size (<inline-formula><mml:math id="inf1027"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mn>1.3</mml:mn></mml:mrow></mml:math></inline-formula>) and <inline-formula><mml:math id="inf1028"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig47-v2.tif"/></fig><fig id="fig48" position="float"><label>Figure 48.</label><caption><title>Average clan number vs. <inline-formula><mml:math id="inf1029"><mml:mi>m</mml:mi></mml:math></inline-formula> for all simulations that begin with one clone with <inline-formula><mml:math id="inf1030"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>≥</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</title><p>The dashed lines are <inline-formula><mml:math id="inf1031"><mml:mi>m</mml:mi></mml:math></inline-formula> divided by the mean bacterial clan size and <inline-formula><mml:math id="inf1032"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig48-v2.tif"/></fig><p>The regimes of low and high clan number in our model are similar to regimes of virus-host coevolution identified in <xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref>: at low virus mutation rates and low mutational jump distances, trajectories move in a straight line in antigenic space, while at higher jump distances, trajectories become more diffusive, the way ours look. At even higher mutation rates and jump sizes, trajectories split into multiple stable coexisting lineages, which is what we see at high diversity.</p><p>Based on their parameters and regimes, we expect that increasing cross-reactivity relative to mutation rate in our model should bring our results closer to the ballistic regime.</p><sec id="s4-8-1"><title>Cross-reactivity</title><p>In this section, we present additional methods and results for simulations with two types of cross-reactivity relating to results in 'Cross-reactivity leads to dynamically unique evolutionary states'.</p><p>In our standard simulations and theory, we assume that <inline-formula><mml:math id="inf1033"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is binary (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>): any mismatch between protospacers and spacers means bacteria no longer have any immune advantage against phage. Here, we discuss results of simulations where <inline-formula><mml:math id="inf1034"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> includes some cross-reactivity so that the more mutations a protospacer contains, the less immunity bacteria have against it.</p><p>We explore two types of cross-reactivity: one in which we define <inline-formula><mml:math id="inf1035"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as an exponential function of the mutational distance between a spacer and protospacer (<xref ref-type="disp-formula" rid="equ7">Equation 7</xref>), and one in which <inline-formula><mml:math id="inf1036"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a <inline-formula><mml:math id="inf1037"><mml:mi>θ</mml:mi></mml:math></inline-formula>-function of mutational distance (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>). The exponential definition of cross-reactivity is the same as that used in <xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref>; <xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref> to model viruses evolving in abstract antigen space (<xref ref-type="bibr" rid="bib87">Marchi et al., 2019</xref>) and in genomic distance space (<xref ref-type="bibr" rid="bib147">Yan et al., 2019</xref>). Note that our usual binary definition of <inline-formula><mml:math id="inf1038"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> is a special case of <xref ref-type="disp-formula" rid="equ7 equ8">Equations 7 and 8</xref> with <inline-formula><mml:math id="inf1039"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig49">Figure 49</xref> shows these different definitions of <inline-formula><mml:math id="inf1040"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf1041"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p><fig id="fig49" position="float"><label>Figure 49.</label><caption><title>Phage infection success probability <inline-formula><mml:math id="inf1042"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> as a function of mutational distance between spacers and protospacers for different definitions and degrees of cross-reactivity.</title><p>Definitions are plotted for <inline-formula><mml:math id="inf1043"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1044"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig49-v2.tif"/></fig><p>Cross-reactivity leads to a higher average bacterial immunity against phages for the same parameters (<xref ref-type="fig" rid="fig50">Figures 50</xref> and <xref ref-type="fig" rid="fig51">51</xref>). This means that our assumption that effective <inline-formula><mml:math id="inf1045"><mml:mrow><mml:mi>e</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, valid for nearly all parameters without cross-reactivity, breaks down when we introduce cross-reactivity. Importantly, this is a quasi-steady-state effect: if we start simulations with more initial clones, clone clans are genetically separated and both mean <inline-formula><mml:math id="inf1046"><mml:mi>m</mml:mi></mml:math></inline-formula> and average immunity converge to the binary <inline-formula><mml:math id="inf1047"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> case (<xref ref-type="fig" rid="fig50">Figure 50</xref> right panel).</p><fig id="fig50" position="float"><label>Figure 50.</label><caption><title>Average immunity vs. diversity with different degrees of cross-reactivity for simulations with <inline-formula><mml:math id="inf1048"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1049"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</title><p>Dashed lines are simulations with cross-reactivity, solid line is simulations without cross-reactivity. Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig50-v2.tif"/></fig><fig id="fig51" position="float"><label>Figure 51.</label><caption><title>Mean phage clone size (top) and mean bacteria clone size (bottom) relative to time of phage mutation for different definitions of <inline-formula><mml:math id="inf1050"><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>.</title><p>These simulations begin with one initial phage clone and parameters <inline-formula><mml:math id="inf1051"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1052"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1053"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1054"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig51-v2.tif"/></fig><p>Phages are less likely to establish when there is cross-reactivity because phage escape mutations are incomplete (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). However, the clones that do survive grow quicker: simulations with high cross-reactivity appear to have a faster mean growth rate for clones, regardless of conditioning on survival (<xref ref-type="fig" rid="fig51">Figure 51</xref>).</p><p>Adding cross-reactivity causes some unexpected dynamical behaviours (<xref ref-type="fig" rid="fig52">Figure 52</xref>, <xref ref-type="fig" rid="fig53">Figure 53</xref>). We observed a travelling wave regime in some simulations with large spikes in phage clone size (<xref ref-type="fig" rid="fig54">Figures 54</xref> and <xref ref-type="fig" rid="fig55">55</xref>). This happens because cross-reactivity creates a fitness gradient for new phage mutants such that some mutants are much more fit and establish much more quickly.</p><fig id="fig52" position="float"><label>Figure 52.</label><caption><title>Number of bacterial clones (top) and average immunity (bottom) for simulations beginning with either 1 phage clone (left) or 10 phage clones (right).</title><p>These simulations have parameters <inline-formula><mml:math id="inf1055"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1056"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1057"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1058"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig52-v2.tif"/></fig><fig id="fig53" position="float"><label>Figure 53.</label><caption><title>Phage clone size (top) and bacteria clone size (bottom) in a simulation with cross-reactivity (step function CRISPR effectiveness with <inline-formula><mml:math id="inf1059"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</title><p>This simulation has one initial phage clone and parameters <inline-formula><mml:math id="inf1060"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1061"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1062"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1063"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. Later times in this simulation are shown in <xref ref-type="fig" rid="fig55">Figure 55</xref>, and earlier times in this simulation are shown in <xref ref-type="fig" rid="fig54">Figure 54</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig53-v2.tif"/></fig><fig id="fig54" position="float"><label>Figure 54.</label><caption><title>Phage clone size (top) and bacteria clone size (bottom) in a simulation with cross-reactivity (step function CRISPR effectiveness with <inline-formula><mml:math id="inf1064"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</title><p>This simulation has one initial phage clone and parameters <inline-formula><mml:math id="inf1065"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1066"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1067"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1068"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. Later times in this simulation are shown in <xref ref-type="fig" rid="fig55">Figure 55</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig54-v2.tif"/></fig><fig id="fig55" position="float"><label>Figure 55.</label><caption><title>Phage clone size (top) and bacteria clone size (bottom) in a simulation with cross-reactivity (step function CRISPR effectiveness with <inline-formula><mml:math id="inf1069"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) showing the switch between a travelling wave and low turnover regime.</title><p>This simulation has one initial phage clone and parameters <inline-formula><mml:math id="inf1070"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1071"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1072"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1073"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. Earlier times in this simulation are shown in <xref ref-type="fig" rid="fig54">Figure 54</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig55-v2.tif"/></fig><p>To see this happening, let us look closely at the simulation in <xref ref-type="fig" rid="fig54">Figure 54</xref> at time 3565 (<xref ref-type="fig" rid="fig56">Figure 56</xref>). There are three large phage clones and two large bacteria clones (soon to be three). Phage clone 0 is the largest and phage clone 2 is the smallest. Phage clone 0 and phage clone 1 are both either 0 or 1 mutation away from bacteria clones 0 and 1 (<xref ref-type="fig" rid="fig57">Figure 57</xref>). Because <inline-formula><mml:math id="inf1074"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, they are all equally fit; effectively they could be considered one large clone. Phage 2, however, is 1 mutation from bacteria clone 1 but 2 mutations from bacteria clone 0, so it now has a much higher fitness than the other two phage clones and grows quickly. But now bacteria clone 1 is also fit against this new mutant, so it too continues growing. This push-pull keeps going with new phage mutants experiencing runaway fitness for a while. This also leads to an asymmetry in clone identity between the populations: because a bacterial clone may be immune to a phage clone with a different but related sequence, we see bacteria clones becoming large <italic>after</italic> their matching phage clone has gone extinct because they are still resistant to an existing phage clone that is genetically related (<xref ref-type="fig" rid="fig58">Figures 58</xref> and <xref ref-type="fig" rid="fig59">59</xref>).</p><fig id="fig56" position="float"><label>Figure 56.</label><caption><title>Phage clone size (top) and bacteria clone size (bottom) for a short time window of the simulation shown in <xref ref-type="fig" rid="fig54">Figure 54</xref>.</title><p>Large phage and bacteria clones are numbered in the legend; these numbers correspond to the numbers in <xref ref-type="fig" rid="fig57">Figure 57</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig56-v2.tif"/></fig><fig id="fig57" position="float"><label>Figure 57.</label><caption><title>Phage infection success probability matrix for each clone shown in <xref ref-type="fig" rid="fig56">Figure 56</xref>.</title><p>Dark blue is low infection success, light blue is high infection success.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig57-v2.tif"/></fig><fig id="fig58" position="float"><label>Figure 58.</label><caption><title>Mean phage clone size (top) and mean bacteria clone size (bottom) relative to the time of phage clone mutation, either normalized to surviving clones (left) or averaged over all trajectories (right) for the simulation shown in <xref ref-type="fig" rid="fig54">Figure 54</xref> (<inline-formula><mml:math id="inf1075"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1076"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1077"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>).</title><p>Clones in the travelling wave regime (4000–6200 generations, orange) grow much more quickly than clones in the initial low-turnover regime (1000–3200 generations, blue) or the final low turnover regime (7000–10,000 generations, green). The black dashed line is the mean clone size for a simulation with the same parameters but without cross-reactivity.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig58-v2.tif"/></fig><fig id="fig59" position="float"><label>Figure 59.</label><caption><title>A slow-switching cross-reactivity regime for the simulation shown in <xref ref-type="fig" rid="fig54">Figure 54</xref>.</title><p>(Left) A subset of clone trajectories for phages (top) and bacteria (bottom) in a simulation with cross-reactivity (step function CRISPR effectiveness with <inline-formula><mml:math id="inf1078"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). Three trajectories are highlighted and coloured to show increasing time. The population is in a regime where matching clones are offset: because clones that are one mutation apart have the same complete immune overlap, the highlighted clones have large bacterial clone size well after the matching phage clone goes extinct. (Right) The clone size of the highlighted trajectories shown as a function of the bacterial marginal immunity against a particular phage clone (top) or the marginal immunity of a particular bacteria clone (bottom).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig59-v2.tif"/></fig><p>This fitness and growth pattern can be seen as a function of the marginal immunity of bacterial clones to the phage population and of the bacterial population to individual phage clones (<xref ref-type="fig" rid="fig59">Figure 59</xref>). Average immunity for individual clones, which we call marginal immunity in analogy with <xref ref-type="bibr" rid="bib101">Nourmohammad et al., 2016</xref>, captures the fitness differences between individual clones that determine their dynamical behaviour. Without cross-reactivity, bacteria clones are only immune to at most one phage clone at a time, though their overall marginal immunity still changes smoothly as the matching phage clone changes size (<xref ref-type="fig" rid="fig60">Figure 60B</xref>). When cross-reactivity is added, bacteria may be immune or partially immune to multiple phage clones, and calculating marginal immunity summarizes all of these combined effects on the fitness of a particular clone. Bacteria clones grow larger once their marginal immunity is high, and phage clones grow large once bacterial marginal immunity against them is low. These opposing forces generate Lotka-Volterra oscillations even in the case with no cross-reactivity, though these oscillations are more rapid and persistent when cross-reactivity is added (<xref ref-type="fig" rid="fig60">Figure 60C and D</xref>). Phage clones grow quickly when bacteria have low marginal immunity to their sequence, while bacteria clones grow quickly when they have high marginal immunity.</p><fig id="fig60" position="float"><label>Figure 60.</label><caption><title>Cross-reactivity leads to persistent oscillations.</title><p>(<bold>A</bold>) A subset of clone trajectories for phages (top) and bacteria (bottom) in a simulation with no cross-reactivity. Transient oscillations occur. One trajectory is highlighted and coloured to show increasing time. (<bold>B</bold>) The highlighted trajectory in (<bold>A</bold>) is shown as a function of the marginal immunity for phages (top) and bacteria (bottom). Clones experience an oscillating fitness that depends on their overlap from the other population. Arrows indicate the direction of increasing time in the oscillation. (<bold>C</bold>) A subset of clone trajectories for phages (top) and bacteria (bottom) in a simulation with cross-reactivity (step function CRISPR effectiveness with <inline-formula><mml:math id="inf1079"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). The population is in a regime where several clones experience persistent and rapid oscillations. One trajectory is highlighted and coloured to show increasing time. (<bold>D</bold>) The highlighted trajectory in (<bold>C</bold>) is shown as a function of the marginal immunity for phages (top) and bacteria (bottom). Clones experience an oscillating fitness that depends on their overlap from the other population. Arrows indicate the direction of increasing time in the oscillation. For all simulations <inline-formula><mml:math id="inf1080"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1081"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig60-v2.tif"/></fig><p>Clones grow more quickly on average in the travelling wave regime than in other regimes in the same simulation (<xref ref-type="fig" rid="fig58">Figure 58</xref>).</p><p>In <xref ref-type="fig" rid="fig4">Figure 4</xref>, we show phylogenies of four simulations with different amounts and types of cross-reactivity. We used DendroPy <xref ref-type="bibr" rid="bib128">Sukumaran and Holder, 2010</xref> and Toytree <xref ref-type="bibr" rid="bib44">Eaton and Matschiner, 2020</xref> to construct and plot phylogenies for different simulations. <xref ref-type="fig" rid="fig61">Figure 61</xref> shows simulations for the same parameters as in the main text but a tenfold higher phage mutation rate: most simulations have multiple coexisting lineages, and the travelling wave regime is less long-lived before periods of low turnover. In the low-turnover regime, a relatively small number of large clones that are all outside of each other’s cross-reactivity radius can coexist for a very long time, oscillating out of phase from each other (<xref ref-type="fig" rid="fig62">Figures 62</xref> and <xref ref-type="fig" rid="fig63">63</xref>).</p><fig id="fig61" position="float"><label>Figure 61.</label><caption><title>Phage clone phylogenies for four simulations with different cross-reactivities and a higher mutation rate than shown in main text <xref ref-type="fig" rid="fig4">Figure 4</xref>: no cross-reactivity (<bold>A</bold>) and step-function cross-reactivity with <inline-formula><mml:math id="inf1082"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (B, <inline-formula><mml:math id="inf1083"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) (<bold>C</bold>), and <inline-formula><mml:math id="inf1084"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> (<bold>D</bold>).</title><p>All simulations share all other parameters: <inline-formula><mml:math id="inf1085"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Phage clones are plotted at the first time they pass a population size of 2 (to remove clutter from many new mutations destined for extinction), and the size of each circle is logarithmically proportional to the maximum size reached by that clone. Colours indicate the time of extinction of each clone. For each simulation with cross-reactivity, the left inset shows phage (top) and bacteria (bottom) clone sizes over time; colours indicate unique clone identities.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig61-v2.tif"/></fig><fig id="fig62" position="float"><label>Figure 62.</label><caption><title>Phage clone size (top) and bacteria clone size (bottom) for a short time window of the <inline-formula><mml:math id="inf1086"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> simulation shown in <xref ref-type="fig" rid="fig61">Figure 61C</xref>.</title><p>Each of the large trajectories oscillating out of phase between 5000 and 7000 generations is at least three mutations away from all of the others; they are all outside each other’s cross-reactivity radius.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig62-v2.tif"/></fig><fig id="fig63" position="float"><label>Figure 63.</label><caption><title>Matrix of mutational distance between each of the four largest phage clones shown in <xref ref-type="fig" rid="fig62">Figure 62</xref>; colours of those trajectories are labelled on the y axis.</title><p>Each clone is at least three mutations away from all other large clones.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig63-v2.tif"/></fig><p>The durability and turnover of immune memory is qualitatively different in the different regimes of the simulation with cross-reactivity shown in <xref ref-type="fig" rid="fig54">Figure 54</xref>. We calculated time-shifted average immunity for each of the three regimes (initial regime with no turnover, travelling wave regime, and persistent oscillation regime) and found that turnover was extremely low in all but the travelling wave regime, which had a rapid decay of immune memory to zero (<xref ref-type="fig" rid="fig64">Figure 64</xref>). In contrast, the immune memory for the same parameters without cross-reactivity had a much more gradual long-term decay towards zero immunity (<xref ref-type="fig" rid="fig65">Figure 65</xref>). In the travelling wave regime, different amounts of cross-reactivity result in different time-shifted immunity patterns. Turnover is slow but smooth with exponential cross-reactivity, while turnover is much more rapid with step-function cross-reactivity (<xref ref-type="fig" rid="fig66">Figure 66</xref>). The differences in rate of turnover can also be seen by comparing timescale of sequence change in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p><fig id="fig64" position="float"><label>Figure 64.</label><caption><title>Time-shifted average immunity for three regimes of the simulation shown in <xref ref-type="fig" rid="fig54">Figure 54</xref> (<inline-formula><mml:math id="inf1087"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1088"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1089"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1090"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, step-function cross-reactivity with <inline-formula><mml:math id="inf1091"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</title><p>The initial low-diversity regime (1000–3200 generations) and the low turnover, high diversity regime (7000–10,000 generations) had extremely low turnover, while the travelling wave regime (4000–6200 generations) had high average immunity near 0 delay that rapidly decayed to zero both in the past and future.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig64-v2.tif"/></fig><fig id="fig65" position="float"><label>Figure 65.</label><caption><title>Time-shifted average immunity for the corresponding simulation to <xref ref-type="fig" rid="fig64">Figure 64</xref> without cross-reactivity (<inline-formula><mml:math id="inf1092"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1093"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1094"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1095"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>). Peak average immunity is low because of high diversity, and immunity decays very gradually to zero in both the past and future.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig65-v2.tif"/></fig><fig id="fig66" position="float"><label>Figure 66.</label><caption><title>Time-shifted average immunity for four simulations with the same parameters but different types of cross-reactivity: no cross-reactivity (top), exponential cross-reactivity (middle top), step-function cross-reactivity with <inline-formula><mml:math id="inf1096"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (middle bottom), and <inline-formula><mml:math id="inf1097"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (bottom).</title><p>Shared parameters are <inline-formula><mml:math id="inf1098"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1099"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1100"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1101"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. Only the travelling-wave regime of each simulation with cross-reactivity was used to compare turnover in this regime. The grey shaded region is the standard deviation across averaged data.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig66-v2.tif"/></fig><p>Adding cross-reactivity appears to slightly decrease average clan sizes (<xref ref-type="fig" rid="fig67">Figure 67</xref>). This is what we intuitively expect since cross-reactivity means phages are under pressure to get as far away from other clones as possible.</p><fig id="fig67" position="float"><label>Figure 67.</label><caption><title>Average clan size across simulations with different parameters for different degrees of cross-reactivity with <inline-formula><mml:math id="inf1102"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>init</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>.</title><p>Error bars are the standard deviation across three or more independent simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig67-v2.tif"/></fig></sec></sec><sec id="s4-9"><title>Data analysis</title><p>This section contains details of our methods for analysing sequencing data from three published papers – groundwater metagenome data used in calculating spacer turnover (Metagenomic CRISPR spacer analysis from <xref ref-type="bibr" rid="bib15">Burstein et al., 2016</xref>), a laboratory long-term coevolution experiment used for spacer turnover and time-shifted average immunity (‘Laboratory coevolution experimental data’), and wastewater treatment plant metagenome data used for spacer turnover and time-shifted average immunity (‘Experimental data from wastewater treatment plant’). Methods and toy models relating to calculating average immunity in data are in ‘Theoretical considerations when calculating average immunity from data’.</p><sec id="s4-9-1"><title>Metagenomic CRISPR spacer analysis from <xref ref-type="bibr" rid="bib15">Burstein et al., 2016</xref></title><p>This dataset is the source for <xref ref-type="fig" rid="fig6">Figure 6F</xref> in ‘Dynamics are determined by diversity’.</p><p>We detected spacer sequences in metagenomic data from <xref ref-type="bibr" rid="bib15">Burstein et al., 2016</xref>. We analysed the 0.1 <inline-formula><mml:math id="inf1103"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> filter dataset which contains metagenomic reads at six time points, found under accession PRJNA268031. We searched for matches to the CRISPR repeats identified in the study using blast; we accessed a list of repeats from the study’s Supplementary data 2. There were 144 unique repeat sequences. Reads are 150 bp long, and we kept only blast results where a repeat had two or more matches to a read in order to accurately detect spacers and to reduce spurious matches to repeats. To further ensure match quality, we kept only alignments that were at least 85% similar to repeat queries, unless another match to the same repeat was present on the read. This 85% threshold was chosen for consistency with previous spacer identification studies (<xref ref-type="bibr" rid="bib103">Paez-Espino et al., 2013</xref>; <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>; <xref ref-type="bibr" rid="bib124">Skennerton et al., 2013</xref>).</p><p>It is possible that multiple unique repeats match the same read. For each matched read, we kept the repeat match that had the highest alignment identity (fractional alignment length times percent identity). We detected spacers between repeats, then used the detected spacer length to extract spacers on either side of matched repeats. Because we required at least two repeat matches, at most three spacers could be detected from a read, and at minimum two spacers were detected. We detected a total of 37,963 spacers of which there were 17,491 unique sequences. The most abundant sequence was present 572 times. After grouping within each unique repeat by spacer sequence similarity with an 85% average similarity threshold, there were 12022 unique types with the largest type having an abundance of 616.</p></sec><sec id="s4-9-2"><title>Theoretical considerations when calculating average immunity from data</title><p>The methods described here are used to scale the y-axis of <xref ref-type="fig" rid="fig7">Figure 7C, D</xref> in ‘Time-shifted average immunity calculated from data reveals distinctive patterns of turnover’.</p><p>In our simulations and model, we assume that each phage has a single protospacer and each bacterium has a single spacer. In reality, phages can have hundreds to thousands of possible protospacers, and bacteria can also acquire tens to hundreds of spacers (<xref ref-type="bibr" rid="bib105">Pavlova et al., 2021</xref>). If we assume that average immunity plays out at the organism level; that is, if a bacterium that contains one or more spacers matching one or more phage protospacers is immune to that phage, then calculating average immunity in practice requires knowing something about the typical numbers of protospacers and spacers in organisms.</p><p>First, let us consider the effect of changing the number of protospacers while keeping spacer array length constant at 1. This is a reasonable model for experimental data at short timescales when most bacteria acquire only one new spacer. For a set <inline-formula><mml:math id="inf1104"><mml:mi>i</mml:mi></mml:math></inline-formula> of observed spacers and a set <inline-formula><mml:math id="inf1105"><mml:mi>j</mml:mi></mml:math></inline-formula> of observed protospacers with abundances <italic>n</italic><sub><italic>i</italic></sub> and <italic>n</italic><sub><italic>j</italic></sub>, if each spacer and protospacer are assumed to belong to one organism only, then the average immunity is given by <xref ref-type="disp-formula" rid="equ93">Equation 90</xref>. We assume for simplicity that any matching spacer provides perfect immunity, that is, <inline-formula><mml:math id="inf1106"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ93"><label>(90)</label><mml:math id="m93"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1107"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> denotes <inline-formula><mml:math id="inf1108"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>If instead the same set of protospacers is divided among fewer phages so that each phage has <inline-formula><mml:math id="inf1109"><mml:mi>a</mml:mi></mml:math></inline-formula> protospacers on average, then the total number of phages is <inline-formula><mml:math id="inf1110"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:math></inline-formula>. The numerator of average immunity remains the same since each bacterium still contains only a single spacer. Average immunity is exactly the same as before but multiplied by the average number of protospacers per phage (<xref ref-type="disp-formula" rid="equ94">Equation 91</xref>).<disp-formula id="equ94"><label>(91)</label><mml:math id="m94"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi></mml:mfrac></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This agrees with the intuition that more spacer targets per phage increases the immune potential of the CRISPR system.</p><p>In data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>, we find quantitative agreement between the range of average immunity values in their data and the types of values in our simulations once we apply this simple transformation with <inline-formula><mml:math id="inf1111"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>696</mml:mn></mml:mrow></mml:math></inline-formula>, since there are 231 possible CRISPR1 protospacers and 465 possible CRISPR3 protospacers in the phage genome (determined by searching for the canonical PAM for each CRISPR locus).</p><p>If bacteria contain multiple spacers and phages contain multiple protospacers, the combinatorics of average immunity gets more interesting. Now, if a bacterium contains multiple spacers that target the same phage, we assume this does not increase its immunity (although in reality there may be a benefit to multiple matching spacers).</p><p>We simulated sets of spacers and protospacers, randomly divided them into arrays of different sizes, and calculated the organism-level average immunity in each case. <xref ref-type="fig" rid="fig68">Figure 68</xref> shows the average immunity values for several array lengths with different assumptions for how the set of spacer sequences and array lengths are distributed. We chose a set of spacer ‘sequences’ where each sequence is a letter of the alphabet, then constructed phage protospacer arrays by randomly drawing 5 unique letters 50 times to create 50 phages. We then sampled letters from the alphabet either uniformly or from an exponential distribution (where ‘A’ is the number 1, etc.). The exponential sampling captures the fact that in practice spacer abundance distributions are highly non-uniform. To create bacteria spacer arrays, we sampled from the set of spacers without replacement, either creating arrays of constant size or arrays with the same mean size but with their length either normally or exponentially distributed.</p><fig id="fig68" position="float"><label>Figure 68.</label><caption><title>Average immunity vs. bacterial spacer array length for simulated distributions of protospacers and spacers.</title><p>We simulate 50 phages, each with 5 protospacers represented by letters from the alphabet, uniformly sampled. We simulate 420 bacterial spacers, drawn from the alphabet either uniformly (top row) or following an exponential distribution with mean 6 (bottom row). We construct arrays by sampling from the set of 420 spacers without replacement, either creating arrays of constant length (left column), or of variable length with a gaussian distribution (middle column) or exponential distribution (right column). Average immunity is calculated as in <xref ref-type="disp-formula" rid="equ93">Equation 90</xref> except the indices run over all arrays and not over individual sequences, and the presence of any matching pair gives perfect immunity. Blue points are average results over 50 simulations; error bars are standard deviation. The black dashed curve is given by <inline-formula><mml:math id="inf1112"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig68-v2.tif"/></fig><p>We developed a simple theoretical model for the change in average immunity as array length increases. The baseline average immunity when bacteria are assumed to have single spacers we denote <italic>a</italic><sub>1</sub>, and define a constant <inline-formula><mml:math id="inf1113"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Then as array length increases, the total number of bacteria decreases and the overlap increases, but by a smaller factor than the population size decrease: the remaining average immunity that could be gained is reduced with the same fraction as the original average immunity so that the average immunity for an array of length <inline-formula><mml:math id="inf1114"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="inf1115"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Plotting <inline-formula><mml:math id="inf1116"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf1117"><mml:mi>n</mml:mi></mml:math></inline-formula> on a log plot gives a straight line. Plugging in <inline-formula><mml:math id="inf1118"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> gives <inline-formula><mml:math id="inf1119"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, plotted as a black dashed line in <xref ref-type="fig" rid="fig68">Figure 68</xref>. The theory agrees well with the simulated results except for when array length is exponentially distributed; in this case, we believe the presence of several very long and very short arrays means that short-array bacteria do not get the coverage of multiple spacers while the long-array bacteria have redundant spacers. This functional form for average immunity as a function of array length is very similar to a quantity derived by <xref ref-type="bibr" rid="bib72">Iranzo et al., 2013</xref> — they calculated that the probability that a random bacterium is immune to a random phage, each with a random set of spacers and protospacers is <inline-formula><mml:math id="inf1120"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf1121"><mml:mi>n</mml:mi></mml:math></inline-formula> is the average bacterial array length, <inline-formula><mml:math id="inf1122"><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is the total number of unique protospacers, and <inline-formula><mml:math id="inf1123"><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> is the number of protospacers per phage. The constant <inline-formula><mml:math id="inf1124"><mml:mi>α</mml:mi></mml:math></inline-formula> is a scaling factor that measures the degree of correlation between matching spacer and protospacer abundances. Their scaling is as a function of the <italic>phage</italic> array length instead of bacterial, but the same intuition applies.</p><p>An interesting result of this analysis is that the relative immune benefit from gaining a spacer decreases as immunity increases: a CRISPR array twice as long does not provide double the immunity. A similar diminishing-returns result has also been observed in theoretical models of vertebrate immunity where the relative decrease in immune susceptibility and increase in immune memory both decrease as the number of infections increases over an organism’s lifetime (<xref ref-type="bibr" rid="bib92">Mayer et al., 2019</xref>). Long CRISPR arrays are also subject to a dilution effect: spacers compete to form complexes with limited <italic>Cas</italic> protein machinery, and if the number of spacers is high, there is a higher chance that the needed spacer is not available in high enough numbers during an infection (<xref ref-type="bibr" rid="bib89">Martynov et al., 2017</xref>; <xref ref-type="bibr" rid="bib13">Bradde et al., 2020</xref>).</p></sec><sec id="s4-9-3"><title>Average immunity negatively correlates with diversity regardless of array size</title><p>This section describes the toy model we present in results ‘Pathogen and host diversity must be considered together.</p><p>In our simulations, we observed an inverse proportionality between average immunity and bacterial diversity (<xref ref-type="fig" rid="fig50">Figure 50</xref>). We wondered if this trend would hold for array sizes and numbers of protospacers larger than 1. Our intuition is that this trend should hold for any arrangement of spacers and protospacers into arrays, provided the following two statements are true: (a) bacteria and phage diversity is coupled; that is, phage protospacer diversity matches bacterial spacer diversity, and (b) diversity is larger than CRISPR array length.</p><p>We tested this with a toy model, described in ‘Pathogen and host diversity must be considered together’. Conceptually, there are two regimes of CRISPR immunity and phage evolution to consider. In an ‘evolutionarily late’ regime, bacteria are exposed to many diverse phages for which any one spacer may target only a few phage genotypes. In an ‘evolutionarily early’ regime, most phages are clonally similar and protospacer diversity is generated through escape mutations. In this scenario, we can imagine a set of phages that share most of their protospacers but have a small number of recently mutated protospacers. This regime can further be divided into a slow-mutation ‘successive sweeps’ regime in which each new mutation takes place in the background of the previous mutant and a fast-mutation ‘clonal interference’ regime in which many unique mutations coexist in the same background.</p><p>We explored these three scenarios by generating synthetic sets of protospacers and spacers and varying the total diversity by changing the size of the pool of available sequences, distributing sequences exponentially in abundance to qualitatively match data <xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref>. We randomly assigned sequences to individual phages and bacteria, then calculated average immunity in three scenarios of protospacer origin. First, we divided protospacers randomly among 100 phages so that each phage had <inline-formula><mml:math id="inf1125"><mml:mi>x</mml:mi></mml:math></inline-formula> unique protospacers to mimic an evolutionarily diverse population. In the second scenario, we created a set of phages that mimic a population undergoing successive sweeps by changing the first protospacer, then the first and second, and so on. In the third scenario, the set of phages share the first <inline-formula><mml:math id="inf1126"><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> protospacers and only the last protospacer is varied; this mimics an initially clonal population undergoing rapid mutations. In all scenarios, we sampled uniformly from the pool of protospacers to generate 1000 spacer sequences that were divided into bacterial arrays with either a constant array size (<xref ref-type="fig" rid="fig69">Figure 69B–D</xref>), or a Gaussian-distributed array size (<xref ref-type="fig" rid="fig70">Figure 70</xref>). We repeated the bacterial array assortment process 20 times for each total spacer diversity and combination of array sizes.</p><fig id="fig69" position="float"><label>Figure 69.</label><caption><title>Average immunity decreases with coupled CRISPR diversity.</title><p>(<bold>A</bold>) Inferred initial average immunity as a function of diversity in the experiment of <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>. Bacterial diversity was manipulated in the experiment by combining different numbers of bacterial clones defined by unique CRISPR spacers with a single phage strain that was able to infect only one of the clones. We calculated the expected initial average immunity based on the number of clones. (<bold>B–D</bold>) Results of a toy model of sorting a set of protospacers and spacers into arrays of variable length, either assigning protospacers fully randomly (<bold>B</bold>), as sequential mutations (<bold>C</bold>), or changing the last protospacer in the array only (<bold>D</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig69-v2.tif"/></fig><fig id="fig70" position="float"><label>Figure 70.</label><caption><title>Average immunity vs. diversity (number of unique types) for simulated distributions of spacers and protospacers with different bacterial array sizes (increasing top to bottom) and different numbers of protospacers per phage (increasing left to right).</title><p>Bacterial array sizes are drawn from a Gaussian distribution with mean given by the array mean for each row and a standard deviation of 2. Points are averages across 50 independent runs.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig70-v2.tif"/></fig><p>We calculated average immunity in these synthetic scenarios, assuming for simplicity that any matching spacer provides perfect immunity, that is, <inline-formula><mml:math id="inf1127"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1128"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, or <inline-formula><mml:math id="inf1129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∩</mml:mo></mml:mstyle></mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mi>∅</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. For the set of bacteria <inline-formula><mml:math id="inf1130"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> and phages <inline-formula><mml:math id="inf1131"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, the average immunity for the population is<disp-formula id="equ95"><label>(92)</label><mml:math id="m95"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∩</mml:mo></mml:mstyle></mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mi>∅</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∩</mml:mo></mml:mstyle></mml:mrow><mml:mi>J</mml:mi><mml:mo>≠</mml:mo><mml:mi>∅</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1132"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mi>I</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>I</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>I</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1133"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>V</mml:mi><mml:mi>I</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>I</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>J</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. In our base model, bacteria and phages are each limited to a single spacer or protospacer, whereas now <inline-formula><mml:math id="inf1134"><mml:mi>I</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1135"><mml:mi>J</mml:mi></mml:math></inline-formula> label the full set of spacers or protospacers in an organism. <inline-formula><mml:math id="inf1136"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>I</mml:mi></mml:msubsup></mml:math></inline-formula> is the number of bacteria with the same unique set of spacers <inline-formula><mml:math id="inf1137"><mml:mi>I</mml:mi></mml:math></inline-formula> and the Iverson bracket <inline-formula><mml:math id="inf1138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∩</mml:mo></mml:mstyle></mml:mrow><mml:mi>J</mml:mi><mml:mo>≠</mml:mo><mml:mi>∅</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> gives 1 if any of the spacers in <inline-formula><mml:math id="inf1139"><mml:mi>I</mml:mi></mml:math></inline-formula> matches any of the protospacers in <inline-formula><mml:math id="inf1140"><mml:mi>J</mml:mi></mml:math></inline-formula> and 0 if there is no overlap between sets <inline-formula><mml:math id="inf1141"><mml:mi>I</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1142"><mml:mi>J</mml:mi></mml:math></inline-formula>.</p><p>The 1-spacer 1-protospacer curve in <xref ref-type="fig" rid="fig69">Figure 69B</xref> represents the same situation as our simulations: one spacer and one protospacer (but with a random distribution of sequences), and the trend matches our simulations exactly with average immunity inversely proportional to diversity. This strict inverse dependence changes shape as the number of spacers and protospacers per organism changes.</p><p>We compared these toy model results to the experimental setup of <xref ref-type="bibr" rid="bib28">Common et al., 2020</xref>. In their experiments, they combined equal proportions of bacterial strains with a different CRISPR spacer with one phage strain that is either targeted by all spacers or escaped from one of the spacers. There is then one susceptible bacterial strain per mixture when the escape phage is used. All experiments also contained one surface mutant bacterial strain that is always immune to the phage.</p><p>We can directly calculate the expected initial average immunity based on this setup. For <inline-formula><mml:math id="inf1143"><mml:mi>m</mml:mi></mml:math></inline-formula> bacterial CRISPR strains, one surface mutant strain, and one escape phage, total bacteria <inline-formula><mml:math id="inf1144"><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula>, total phage <inline-formula><mml:math id="inf1145"><mml:msub><mml:mi>N</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula>, each bacterial strain has abundance <inline-formula><mml:math id="inf1146"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1147"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>We calculate average immunity assuming <inline-formula><mml:math id="inf1148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>We can include the surface mutant or not; it slightly shifts the total diversity but the trend is unaffected. For instance, for <inline-formula><mml:math id="inf1149"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> CRISPR clones, the phage is able to infect one of them, so average immunity is <inline-formula><mml:math id="inf1150"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>. If we included the surface mutant in equal proportions, we would get <inline-formula><mml:math id="inf1151"><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> instead.</p></sec><sec id="s4-9-4"><title>Laboratory coevolution experimental data</title><p>This dataset is the source for <xref ref-type="fig" rid="fig6">Figure 6E</xref> in ‘Dynamics are determined by diversity’ and <xref ref-type="fig" rid="fig7">Figure 7C</xref> in ‘Time-shifted average immunity calculated from data reveals distinctive patterns of turnover’.</p><p>We analysed experimental data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>. In this experiment, <italic>S. thermophilus</italic> bacteria were mixed with phage 2972 and allowed to coevolve until phage extinction, up to 232 days in one replicate. Bacteria and phage whole-genome shotgun sequencing was performed at irregular intervals (13 time points for series MOI-2B). This data is publicly available in the NCBI Sequence Read Archive under the accession <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/275232">PRJNA275232</ext-link>.</p><p>We analysed data from the MOI-2B series and detected spacers in the CRISPR1 and CRISPR3 loci by searching raw reads for matches to the <italic>S. thermophilus</italic> repeats (<named-content content-type="sequence">GTTTTTGTACTCTCAAGATTTAAGTAACTGTACAAC</named-content> for CRISPR1 and <named-content content-type="sequence">GTTTTAGAGCTGTGTTGTTTCGAATGGTTCCAAAAC</named-content> for CRISPR3) using BLAST.</p><p>The expected structure of the CRISPR locus is 36 nt repeats interspaced with 30 nt spacers. Reads are 100 nt long (Illumina), and so at most two complete spacers can be detected per read (one full repeat match near the centre of the read). To maximize the number of genuine spacers detected while removing low-quality matches, we kept only full-length alignments to the repeat (length 36), unless a shorter alignment was also present on the same read as a full-length alignment (for instance, if the repeat is partially present at the start or end of a read). If a single repeat match was present on a read, we extracted 30 nt on either side and labelled these spacers. We set a minimum spacer length to be 26 nt (<inline-formula><mml:math id="inf1152"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mrow><mml:mn>0.85</mml:mn><mml:mo>×</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>) and did not keep spacer sequences at the start or end of a read that were shorter than this. If two repeat matches were present, we extracted the spacer sequence between the matches.</p><p>To detect wild-type spacers, we searched for matches to the CRISPR repeats on the <italic>S. thermophilus</italic> DGCC7710 reference genome (accession NZ_CP025216) and extracted the sequences between repeat matches. We also searched raw reads from the day 1 data of the control replicate (no phages) for matches to the repeats and performed the same spacer extraction procedure.</p><p>We grouped all extracted spacers using the AgglomerativeClustering method from SciPy with an 85% similarity threshold and the ‘average’ linkage criterion. We performed this grouping separately for CRISPR1 and CRISPR3 spacers. Each spacer sequence was then labelled with a group type identifier. <xref ref-type="fig" rid="fig71">Figure 71</xref> shows our detected spacer counts after grouping by 85% average similarity and eliminating single counts and matches to wild-type spacers, compared with the reported results from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>; there is good agreement between our counts and the original authors’ counts.</p><fig id="fig71" position="float"><label>Figure 71.</label><caption><title>Unique spacer types detected in our analysis of data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref> after grouping by 85% average similarity and removing single spacer counts (blue bars).</title><p>Counts reported in <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref> are red points.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig71-v2.tif"/></fig><p>To detect protospacers, we first blasted all reads against the <italic>S. thermophilus</italic> DGCC7710 reference genome and the phage 2972 reference genome (accession NC_007019) (<xref ref-type="fig" rid="fig72">Figure 72</xref>). We next blasted all unique detected spacer sequences from the previous step against all the reads, removing any query sequences that are a perfect subset of another sequence and any sequences that were more than 30% N nucleotide. This detects both potential protospacer sequences and the original spacers themselves. To isolate protospacers, we kept only results that were on reads that did not match the bacterial genome and that did not match the CRISPR1 repeat (CRISPR3 repeats were not checked; however, they represent a very small number of additional reads, less than 0.1%). We kept only results that were 26 nt or larger. If there were multiple hits on a read from the same spacer type (but different sequences), we kept only the match with the lowest e-value. We extracted the matched sequence from the read and 10 nucleotides after it to check for a PAM sequence (all spacers were stored oriented in the same direction relative to the repeat to facilitate comparison and PAM detection). Since reads are paired-end, some reads will overlap, and some spacers may be double-counted in the overlap. We decremented the total spacer or protospacer count for a sequence by 1 if a spacer sequence was present on both ends of a paired read. We also removed sequences that contained long strings of 11 or more of the same nucleotide, assuming these to be sequencing errors. This removed around 1% of sequences.</p><fig id="fig72" position="float"><label>Figure 72.</label><caption><title>Total reads per time point that match phage (blue) or bacteria (orange).</title><p>Top: total reads. Middle: total reads divided by phage and bacteria genome sizes. Bottom: fraction of total reads matching bacteria or phages.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig72-v2.tif"/></fig><p>We grouped all spacer and protospacer sequences together (separated by CRISPR locus) by several different similarity thresholds between 85 and 99% to assign type labels based on each similarity threshold.</p><p>We checked the 10 nt region downstream from each potential protospacer and removed any sequences that did not have a perfect match to the PAM: AGAAW for CRISPR1 (<xref ref-type="bibr" rid="bib103">Paez-Espino et al., 2013</xref>; <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>; <xref ref-type="bibr" rid="bib119">Shah et al., 2013</xref>; <xref ref-type="bibr" rid="bib48">Garneau et al., 2010</xref> and GGNG for CRISPR3 <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>; <xref ref-type="bibr" rid="bib119">Shah et al., 2013</xref>). Since targeting is highly sensitive to PAM mutations (<xref ref-type="bibr" rid="bib119">Shah et al., 2013</xref>), we assumed that any deviation from the perfect PAM meant that the protospacer would not be successfully targeted. There are cases where the PAM sequence is incomplete because of hitting the start or end of a read; these were also assumed to be imperfect PAMs (though some would be genuine). Changing this assumption to include partial PAMs that were subsets of perfect PAMs caused total average immunity numbers to increase and the slope of each curve to decrease. Results including incomplete PAMs were qualitatively similar to the results including all protospacer matches regardless of PAM, highlighting the importance of a perfect PAM match for functional immunity (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref> and <xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3</xref>; <xref ref-type="fig" rid="fig73">Figure 73</xref>).</p><fig id="fig73" position="float"><label>Figure 73.</label><caption><title>Number of shared spacer types between bacteria and phage (top left), ratio of the number of phage types to the number of bacteria types (top right), number of bacteria types (bottom left), and number of phage types (bottom right) as a function of the sampling date for data we analysed from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>.</title><p>Colours indicate different similarity grouping thresholds. Spacer counts include wild-type spacers, and protospacers are included only if they possess a perfect PAM. Data is summed over CRISPR1 and CRISPR3. All sequences are included regardless of abundance.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig73-v2.tif"/></fig></sec></sec><sec id="s4-10"><title>Calculating average immunity</title><p>To calculate average immunity between bacteria and phage, we interpolated spacer and protospacer counts between sequenced time points using the shortest interval between experimental time points as the sampling frequency from the interpolated data. We removed the first time point and last two time points from the data because the first time point has low bacterial spacer counts and a very large phage population size, and at the last two time points, phage counts are very low because phages are about to go extinct (<xref ref-type="fig" rid="fig74">Figure 74</xref> and <xref ref-type="fig" rid="fig73">Figure 73</xref>). Results including all time points are given in <xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref>; they are qualitatively similar except for large changes at the first and last time points where only the first and last phage population are included in the average, respectively.</p><fig id="fig74" position="float"><label>Figure 74.</label><caption><title>Total phage and bacteria population size for the MOI2B experiment in Paez-Espino et al.<xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>.</title><p>Circles are points digitized from Figure 1A in <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>; squares are the population size interpolated to match the sequencing dates in the experiment.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig74-v2.tif"/></fig><p>We calculated the time-shifted average overlap between bacteria and phage spacer types by comparing bacteria and phage types separated by a time delay and averaging over all points with the same time delay (<xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref>). As described in ‘Theoretical considerations when calculating average immunity from data’, we multiplied raw average immunity values by the total number of protospacers to account for multiple protospacers on each phage genome. The number of possible protospacers in phage 2972 for the CRISPR1 locus in <italic>S. thermophilus</italic> (AGAAW PAM) is 231 and the number for CRISPR3 is 465 (696 total). Note that because PAM mutations are common, the true number of protospacers may be less than this hypothetical amount, which would cause us to slightly overestimate average immunity. However, we are also assuming that each bacterium has one effective spacer, and this is likely an underestimate based on estimates of locus length from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>.</p><p>As the similarity threshold increases, the overall overlap goes down slightly (<xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref> and following) because there are more total types (Figure 72). Interestingly, the number of shared types across the whole dataset is very stable regardless of the clustering threshold: there is a tradeoff between the total number of types (which increases as the similarity threshold increases) and the likelihood that types are shared (which increases as the similarity threshold decreases). At high similarity thresholds, we expect that many spurious types will be created from sequencing errors in spacers, while at low similarity thresholds, genuine escape mutants will be grouped with spacers meaning that the immunity information contained in the overlap is not accurate. There are about 700 unique protospacer sequences in the wild-type phage genome, so we expect the number of unique types to be on the order of 700; they are for bacteria, but the number of phage types in our analysis can be quite a bit higher. For all similarity thresholds, we see that bacterial immunity is higher to phages from the past than phages from the future.</p><p>We experimented with different trimming thresholds for the data, removing time points from the beginning and end of the data. The early and late parts of the experiment experienced large fluctuations in population sizes, so if we are interested in steady-state behaviour, it makes sense to remove some time from the beginning and end. But, how much to remove? We can remove the points that look more different from the others either in terms of population size, total reads, or number of types: this could lead us to remove the first three and last three time points. Looking just at population size alone, it makes sense to remove the first time point and last two time points. <xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref> shows results with different sets of points removed to compare the resulting overlap.</p><p>There were no protospacer matches to the reference genome wild-type spacers for CR1 and only a single protospacer match to CR3, even with a lenient 85% similarity threshold. This means the phage has effectively escaped all the wild-type spacers and only the new spacers matter. However, our results differ when wild-type spacers are removed since we also included spacer sequences from the control experiment as wild-type spacers. There are many sequence variants in the control experiment wild-type spacers that do cluster with other spacers, and there are protospacer sequences that cluster with supposed wild-type spacers at lenient grouping thresholds (<xref ref-type="fig" rid="fig75">Figure 75</xref>). This means that average immunity results with and without wild-type spacers are more similar at high similarity thresholds than at low thresholds.</p><fig id="fig75" position="float"><label>Figure 75.</label><caption><title>Total number of unique protospacer sequences after removing all sequences that cluster with wild-type sequences at different similarity thresholds.</title><p>Only protospacers with a perfect PAM are included.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig75-v2.tif"/></fig><p>Our model predicts that phage population sizes should decrease as average immunity increases and that bacterial population sizes should increase as average immunity increases. We calculated average immunity at each experimental time point and compared it to the reported phage and bacterial population size at each time point. Phage and bacteria population sizes were digitized from Figure 1A in <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>. We found that for all similarity groupings, the log-transformed phage population size was significantly negatively correlated with average immunity, while there was no significant correlation with bacterial population size (<xref ref-type="fig" rid="fig76">Figure 76</xref>). This suggests that the mechanism of phage extinction is increasing bacterial immunity over time, and indeed the average immunity just before phage extinction is very high (<xref ref-type="fig" rid="fig77">Figure 77</xref>).</p><fig id="fig76" position="float"><label>Figure 76.</label><caption><title>Phage (top) and bacteria (bottom) population size vs. average immunity calculated with data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>.</title><p>Protospacers are included if they have a perfect PAM, and all wild-type spacers are included. Spacers and protospacers are grouped with an 85% similarity threshold. Colours from blue to yellow indicate increasing time.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig76-v2.tif"/></fig><fig id="fig77" position="float"><label>Figure 77.</label><caption><title>Average immunity vs time in the MOI-2B experiment.</title><p>Protospacers are included if they have a perfect PAM, and all wild-type spacers are included. Spacers and protospacers are grouped with an 85% similarity threshold.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig77-v2.tif"/></fig><sec id="s4-10-1"><title>Experimental data from wastewater treatment plant</title><p>This dataset is the source for <xref ref-type="fig" rid="fig6">Figure 6G</xref> in ‘Dynamics are determined by diversity’ and <xref ref-type="fig" rid="fig7">Figure 7D</xref> in ‘Time-shifted average immunity calculated from data’ reveals distinctive patterns of turnover.</p><p>We analysed metagenomic sequencing data from <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>. This is a longitudinal study of a natural community of bacteria and phages in a wastewater treatment plant. Sixty samples were collected approximately biweekly over a 3-year period from a municipal sewage treatment plant, and whole-genome sequencing was performed on extracted DNA (Illumina platform, 250 bp paired-end reads). They focused on bacteria from the genus <italic>Gordonia</italic>, which is one of the most abundant taxa and was consistently present in samples. They detected CRISPR loci in <italic>Gordonia</italic> genome assemblies, then searched for matches to the two identified CRISPR repeats in all reads to detect other spacers. They constructed graphs of all the linked spacers based on spacer adjacency within reads. They searched for matches to spacers in the metagenomic data, then used matches to identify contigs that might be phages, resulting in two draft phage genomes (DC-56 and DS-92) that they followed over time. They searched for protospacers within these phage genomes using blast. They did not find matches between the <italic>Gordonia</italic> spacers and any other contigs from the dataset, suggesting that those two phages are the only two from which <italic>Gordonia</italic> is acquiring spacers. They used Crass and metaCRT to detect other possible CRISPR arrays within the unassembled data and other contigs; they did not find and/or do not discuss any other detected CRISPR loci. They found a broad fan-like network of CRISPR arrays within <italic>Gordonia</italic> that reflect new spacer acquisition, many of which matched the phage genomes. Older, conserved spacers largely did not match the phage genomes. They found that peaks in phage genome coverage (a proxy for abundance) over time were highly correlated with bacterial coverage, suggesting that their population dynamics are tightly coupled. They identified a PAM sequence, GTT (5’) for the CRISPR1 locus, but did not find that mutations occurred more frequently in the protospacer regions or PAM regions of the phage genomes than elsewhere in the genome.</p><p>Following the same analysis procedure we used for data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref> (‘Laboratory coevolution experimental data’), we used the two reported <italic>Gordonia</italic> CRISPR repeats (<named-content content-type="sequence">GTGCTCCCCGCGCGAGCGGGGATGATCCC</named-content> for CRISPR1 (type I) and <named-content content-type="sequence">ATCAAGAGCCATGTCTCGCTGAACAGCGAATTGAAAC</named-content> for CRISPR2 (type III)) to search for spacers in the raw read data using BLAST.</p><p>To detect wild-type spacers, we searched for matches to the CRISPR repeats on the <italic>Gordonia</italic> metagenome-assembled genome (MAG) provided on the study’s <ext-link ext-link-type="uri" xlink:href="https://github.com/GuerreroCRISPR/Gordonia-CRISPR/">GitHub repository</ext-link> and extracted the sequences between repeat matches. We determined that spacers from the CRISPR1 locus had an average length of 32 nt and spacers from the CRISPR2 locus had an average length of 35 nt.</p><p>We detected spacers as sequences between or adjacent to repeat sequences. To maximize the number of genuine spacers detected while removing low-quality matches, we kept only full-length alignments to the repeat, unless a shorter alignment was also present on the same read as a full-length alignment (for instance, if the repeat is partially present at the start or end of a read). If a single repeat match was present on a read, we extracted 32 (CRISPR1) or 35 (CRISPR2) nt on either side and labelled these spacers. We set a minimum spacer length of 85% of the expected spacer length and did not keep spacer sequences at the start or end of a read that were shorter than this. If multiple repeat matches were present, we extracted intervening sequences as spacers.</p><p>We grouped all extracted spacers using the AgglomerativeClustering method from SciPy with an 85% similarity threshold and the ‘average’ linkage criterion. We performed this grouping separately for CRISPR1 and CRISPR2 spacers. Each spacer sequence was then labelled with a group type identifier.</p><p>To detect protospacers, we first blasted all reads against the <italic>Gordonia</italic> MAG and the two reported phage genomes (DC-56 and DS-92). We next blasted all unique detected spacer sequences from the previous step against all the reads, removing any query sequences that are a perfect subset of another sequence and any sequences that were more than 30% N nucleotide. This detects both potential protospacer sequences and the original spacers themselves. To isolate protospacers from spacers, we kept only results that were on reads that did not match the CRISPR1 or CRISPR2 repeat. Some reads matched both the bacterial genomes and the phage genomes; we removed matches for which the log-difference in e-value between phage genome match and bacteria genome match was less than 25, that is, the phage genome e-value must be lower than the bacteria e-value by a factor of 10<sup>25</sup> to be considered not a bacteria match. <xref ref-type="fig" rid="fig78">Figure 78</xref> shows the e-value differences for reads that matched both phage and bacteria for one time point.</p><fig id="fig78" position="float"><label>Figure 78.</label><caption><title>Histogram of reads that matched both the <italic>Gordonia</italic> MAG and either phage reference genome vs the base-10 log difference in e-value between the matches for accession SRR9260993.</title><p>A positive value means the bacteria match has a lower e-value than the phage match. The vertical dashed line indicates the -25 cutoff; matches to the left were considered phage matches, matches to the right were considered bacteria matches.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig78-v2.tif"/></fig><p>We kept only potential protospacers that were 85% of the expected spacer length or larger. If there were multiple hits on a read from the same spacer type (but different sequences), we kept only the match with the lowest e-value. We extracted the matched sequence from the read and 10 nucleotides on either side to check for a PAM sequence (all spacers were stored oriented in the same direction relative to the repeat to facilitate comparison and PAM detection). Consistent with the PAM reported by Guerrero et al., we identified a GTT PAM at the 5’ end of protospacer sequences (<xref ref-type="fig" rid="fig79">Figure 79</xref>, reverse-complement).</p><fig id="fig79" position="float"><label>Figure 79.</label><caption><title>Probability logo for the four nucleotides at the 5’ end of potential protospacer sequences, generated with WebLogo; the spacer sequence starts at the right edge of the logo meaning that the reverse-complement PAM is GTT.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig79-v2.tif"/></fig><p>Since reads are paired-end, some reads will overlap, and some spacers may be double-counted in the overlap. We decremented the total spacer or protospacer count for a sequence by 1 if a spacer sequence was present on both ends of a paired read.</p><p>We grouped all spacer and protospacer sequences together (separated by CRISPR locus) by several different similarity thresholds between 85 and 99% to assign type labels based on each similarity threshold.</p><p>We checked the 10 nt region upstream from each potential protospacer and removed any sequences that did not have a perfect match to the GTT PAM. Since targeting is highly sensitive to PAM mutations <xref ref-type="bibr" rid="bib119">Shah et al., 2013</xref>, we assumed that any deviation from the perfect PAM meant that the protospacer would not be successfully targeted. There are cases where the PAM sequence is incomplete because of hitting the start or end of a read; these were also assumed to be imperfect PAMs (though some would be genuine). We detected 627,555 potential protospacers for the CRISPR1 locus and only 61 potential protospacers for the CRISPR2 locus. Since the CRISPR2 locus is a type III CRISPR system, we expect that there is no PAM for this system and so included all CRISPR2 protospacers; because there are so few, this choice does not affect results. After removing all CRISPR1 protospacers that did not have an adjacent match to the perfect PAM, we were left with 10,2761 protospacers in total representing 19,292 unique sequences and 537 unique types after grouping with an 85% similarity threshold. The total number of unique spacers detected from the CRISPR1 locus over the experiment was 5289 (2078 unique types at 85% similarity), while the total number from the CRISPR2 locus was an order of magnitude lower at 972 (357 unique types at 85% similarity). In total, 28,386 CRISPR1 spacers and 3353 CRISPR2 spacers were detected.</p><p>Our detection of reads that matched the <italic>Gordonia</italic> MAG and phage genomes is closely correlated with the reported coverage from the study (<xref ref-type="fig" rid="fig80">Figure 80</xref>).</p><fig id="fig80" position="float"><label>Figure 80.</label><caption><title>Phage genome (top) and bacteria genome (bottom) coverage, digitized from Figure 2D of <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref> vs. number of reads assigned to phage or bacteria from our analysis.</title><p>Each marker is a separate time point.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig80-v2.tif"/></fig><p>The number of unique protospacer and spacer types we detected fluctuated considerably over the course of the study (<xref ref-type="fig" rid="fig81">Figure 81</xref>, <xref ref-type="fig" rid="fig82">Figure 82</xref>). The number of shared types as well as the ratio of phage types to bacteria types also fluctuated considerably.</p><fig id="fig81" position="float"><label>Figure 81.</label><caption><title>Abundance over time for the 20 largest bacteria clones (top) and phage clones (bottom) over time for data from <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>.</title><p>The left panels show absolute counts, and the right panels show fractional abundance for the included types. None of the top types are shared between phage and bacteria.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig81-v2.tif"/></fig><fig id="fig82" position="float"><label>Figure 82.</label><caption><title>Number of shared spacer types between bacteria and phage (top left), ratio of the number of phage types to the number of bacteria types (top right), number of bacteria types (bottom left), and number of phage types (bottom right) as a function of the sampling date for data we analysed from <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>.</title><p>Colours indicate different similarity grouping thresholds. Spacer counts include wild-type spacers, and protospacers are included only if they possess a perfect PAM. Data is summed over CRISPR1 and CRISPR2.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig82-v2.tif"/></fig><p>About 40% of spacer and protospacer types remained throughout the time series without going extinct at an 85% similarity threshold (<xref ref-type="fig" rid="fig83">Figure 83</xref>). In data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>, about 20% of original types remained at the end of the experiment (<xref ref-type="fig" rid="fig6">Figure 6E</xref>); however, the fraction of types remaining decreases steadily in data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref> unlike in this dataset.</p><fig id="fig83" position="float"><label>Figure 83.</label><caption><title>Fraction of spacer types (left) and protospacer types (right) remaining as a function of time delay, averaged over the entire time series from <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>.</title><p>Types are grouped with an 85% similarity threshold. The grey shaded region is the standard deviation across averaged data.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig83-v2.tif"/></fig></sec></sec><sec id="s4-11"><title>Calculating average immunity</title><p>To calculate average immunity between bacteria and phage, we interpolated counts between sequenced time points using a 14-day spacing (the most common sampling interval in the data). We calculated the time-shifted average overlap between bacteria and phage spacer types by comparing bacteria and phage types separated by a time delay and averaging over all points with the same time delay (<xref ref-type="fig" rid="fig7s5">Figure 7—figure supplement 5</xref>). As described in ‘Theoretical considerations when calculating average immunity from data’, we multiplied raw average immunity values by the average number of protospacers with the GTT PAM from the phage DC-56 and DS-92 genomes (1956 protospacers) to account for multiple protospacers on each phage genome. Note that because PAM mutations are common, the true number of protospacers may be less than this hypothetical amount, which would cause us to slightly overestimate average immunity. However, we are also assuming that each bacterium has one effective spacer, and this is likely an underestimate. As the similarity threshold increases, the overall overlap goes down slightly because there are more total types. As in the data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>, the number of shared types across the whole dataset is insensitive to the clustering threshold: there is a tradeoff between the total number of types (which increases as the similarity threshold increases) and the likelihood that types are shared (which increases as the similarity threshold decreases) (<xref ref-type="fig" rid="fig82">Figure 82</xref>).</p><p>We experimented with different trimming thresholds for the data, removing time points from the beginning and end of the data series before calculating time-shifted average immunity (<xref ref-type="fig" rid="fig7s8">Figure 7—figure supplement 8</xref>, <xref ref-type="fig" rid="fig7s9">Figure 7—figure supplement 9</xref> and <xref ref-type="fig" rid="fig7s10">Figure 7—figure supplement 10</xref>). For all similarity thresholds and most trimming choices, there is a peak in average immunity at zero time shift that decays in both the past and future directions (<xref ref-type="fig" rid="fig7s5">Figure 7—figure supplement 5</xref>). However, if enough data is trimmed from the beginning to remove the large spikes in average immunity between days 200 and 400 (<xref ref-type="fig" rid="fig84">Figure 84</xref>), the central peak is quite diminished or removed altogether (<xref ref-type="fig" rid="fig7s9">Figure 7—figure supplement 9</xref> and <xref ref-type="fig" rid="fig7s10">Figure 7—figure supplement 10</xref>). The standard deviation of average immunity is large near the zero time shift (<xref ref-type="fig" rid="fig7s5">Figure 7—figure supplement 5</xref>), which is because average immunity is highly variable across the time series: there is a large spike in average immunity near the middle of the time series (<xref ref-type="fig" rid="fig84">Figure 84</xref>).</p><fig id="fig84" position="float"><label>Figure 84.</label><caption><title>Average immunity at each time point in the time series.</title><p>Raw values cannot be larger than 1, but plotted values are multiplied by 1956, the average number of protospacers with the GTT PAM from the phage DC-56 and DS-92 genomes, yielding some values larger than 1.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig84-v2.tif"/></fig><p>Because the variability in average immunity between time points was very high, we performed a Wilcoxon signed-rank test between the average immunity at zero time delay and the average immunity at a time delay ±200 and ±500 (arbitrarily chosen). We paired each shifted time point with its corresponding average immunity at zero delay for each bacterial abundance (<xref ref-type="fig" rid="fig85">Figure 85</xref>). Using a paired test answers the following question for each time point: is the overlap between bacteria and past phages significantly lower than the overlap in the present, and is the overlap between bacteria and future phages significantly lower than the overlap in the present? The test returns a statistic that is the sum of the ranks of differences greater than zero; a larger number indicates more asymmetry between the two compared datasets. We found that past immunity after 200 days is significantly lower than present (Wilcoxon statistic <inline-formula><mml:math id="inf1153"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1241</mml:mn></mml:mrow></mml:math></inline-formula>, p-value <inline-formula><mml:math id="inf1154"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.008</mml:mn></mml:mrow></mml:math></inline-formula>), but that immunity after 500 days is not significantly lower than present (<inline-formula><mml:math id="inf1155"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>392</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.27</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). When comparing all time points with present, only a small range of past immunity values were significantly lower than present (<xref ref-type="fig" rid="fig86">Figure 86</xref>). For both time delays, we found that future immunity is significantly lower than present (<inline-formula><mml:math id="inf1156"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>580</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0012</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for 500 days and <inline-formula><mml:math id="inf1157"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1293</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.003</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for 200 days). Interestingly, these significance values are not symmetric if we pose the question from the perspective of phage: the overlap between phage and future bacteria at 500 days is lower than the overlap for present phages (<inline-formula><mml:math id="inf1158"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>507</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.024</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>), and the overlap between phage and past bacteria is lower than the overlap at present (<inline-formula><mml:math id="inf1159"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>388</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.027</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). This asymmetry, that bacteria are generally more immune to all past phages while phage are not more infective against all past bacteria, is qualitatively the same as that reported by Dewald-Wang et al. in an explicit time shift study of bacteria and phage immunity and infectivity in chestnut trees <xref ref-type="bibr" rid="bib40">Dewald-Wang et al., 2022</xref>.</p><fig id="fig85" position="float"><label>Figure 85.</label><caption><title>Distribution of average immunity values at zero time shift (blue) and at 500 days time shift for future phages (orange) and 500 days time shift for past phages (green).</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig85-v2.tif"/></fig><fig id="fig86" position="float"><label>Figure 86.</label><caption><title>p-values for the Wilcoxon signed-rank test comparing the average immunity at zero time shift with all other time shifts.</title><p>Bacteria immunity against past phages is generally not significantly lower than bacterial immunity against current phages (blue), while bacterial immunity against future phages is significantly lower than immunity against current phages for almost all time shifts (orange). The time shifts are not symmetric; bacterial overlap with past phages is not necessarily the same as phage overlap with future bacteria and vice versa. The number of points that are available to compare decreases as the time shifts get larger (black dashed line).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig86-v2.tif"/></fig><p>We confirmed that the past and future shifted average immunity becomes less correlated with the zero-shift average immunity as the time shift increases. <xref ref-type="fig" rid="fig87">Figure 87</xref> shows the time-shifted average immunity as a function of the zero-shift average immunity for three time shift values, and we see that average immunity is highly correlated at small time shifts but becomes less correlated at larger shifts.</p><fig id="fig87" position="float"><label>Figure 87.</label><caption><title>Time-shifted average immunity for each time point as a function of the zero-shift average immunity of that data point for shifts comparing past phages (top row) and future phages (bottom row).</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig87-v2.tif"/></fig><p>We randomly shuffled time point labels for bacteria and phages separately (<xref ref-type="fig" rid="fig7s6">Figure 7—figure supplement 6</xref>) and together (<xref ref-type="fig" rid="fig7s7">Figure 7—figure supplement 7</xref>) and calculated average immunity with the bootstrapped data. The average immunity trend as a function of time shift disappears in the bootstrapped data even if bacteria and phage clone abundances remain matched at each time point.</p><p>Unlike in the data from <xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>, we did not find a correlation between phage or bacteria coverage and average immunity (<xref ref-type="fig" rid="fig88">Figure 88</xref>), though <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref> did report that bacteria and phage coverage was correlated and that periods of high phage coverage coincided with higher abundance of <italic>Gordonia</italic> strains lacking matching spacers, suggesting that the expected negative correlation between phage abundance and bacterial immunity may be playing out at some level but may be confounded by generally higher detected average immunity when coverage is high.</p><fig id="fig88" position="float"><label>Figure 88.</label><caption><title>Phage (top) and bacteria (bottom) population size vs. average immunity calculated with data from <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>.</title><p>Protospacers are included if they have a perfect PAM, and all wild-type spacers are included. Spacers and protospacers are grouped with an 85% similarity threshold. Colours from blue to yellow indicate increasing time.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-fig88-v2.tif"/></fig><sec id="s4-11-1"><title>Spacer turnover</title><p>For all sets of experimentally observed spacers (<xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>, <xref ref-type="bibr" rid="bib15">Burstein et al., 2016</xref>, and <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>), we calculated spacer turnover over time. We interpolated spacer abundances grouped by 85% similarity over time using the smallest time delay between samples, then calculated the average fraction of spacer types remaining as a function of time delay across the entire dataset.</p></sec></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Funding acquisition, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Supervision, Funding acquisition, Methodology, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-81692-mdarchecklist1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>We analysed published genetic data from three sources: PRJNA268031 (<xref ref-type="bibr" rid="bib15">Burstein et al., 2016</xref>), PRJNA275232 (<xref ref-type="bibr" rid="bib104">Paez-Espino et al., 2015</xref>), and PRJNA484416 (<xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref>). We also used phage genomes associated with <xref ref-type="bibr" rid="bib51">Guerrero et al., 2021a</xref> available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/GuerreroCRISPR/Gordonia-CRISPR">https://github.com/GuerreroCRISPR/Gordonia-CRISPR</ext-link> (<xref ref-type="bibr" rid="bib52">Guerrero et al., 2021b</xref>). Processed spacer and protospacer sequences for all datasets, along with source code and data for all main text figures, is available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/mbonsma/CRISPR-dynamics-model">https://github.com/mbonsma/CRISPR-dynamics-model</ext-link> (copy archived at <xref ref-type="bibr" rid="bib10">Bonsma-Fisher and Goyal, 2023</xref>). Raw simulation data has been uploaded to Dryad: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.sn02v6x74">https://doi.org/10.5061/dryad.sn02v6x74</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Bonsma-Fisher</surname><given-names>M</given-names></name><name><surname>Goyal</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Simulation data from: Dynamics of immune memory and learning in bacterial communities</data-title><source>Dryad Digital Repository</source><pub-id pub-id-type="doi">10.5061/dryad.sn02v6x74</pub-id></element-citation></p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><name><surname>Burstein</surname><given-names>D</given-names></name><name><surname>Sun</surname><given-names>CL</given-names></name><name><surname>Brown</surname><given-names>CT</given-names></name><name><surname>Sharon</surname><given-names>I</given-names></name><name><surname>Anantharaman</surname><given-names>K</given-names></name><name><surname>Probst</surname><given-names>AJ</given-names></name><name><surname>Thomas</surname><given-names>BC</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Rifle, CO metagenome from aquifer</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA268031">PRJNA268031</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><name><surname>Paez-Espino</surname><given-names>D</given-names></name><name><surname>Sharon</surname><given-names>I</given-names></name><name><surname>Morovic</surname><given-names>W</given-names></name><name><surname>Stahl</surname><given-names>B</given-names></name><name><surname>Thomas</surname><given-names>BC</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Streptococcus thermophilus infected with lytic phage 2972</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA275232">PRJNA275232</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset4"><person-group person-group-type="author"><name><surname>Guerrero</surname><given-names>LD</given-names></name><name><surname>Pérez</surname><given-names>MV</given-names></name><name><surname>Orellana</surname><given-names>E</given-names></name><name><surname>Piuri</surname><given-names>M</given-names></name><name><surname>Quiroga</surname><given-names>C</given-names></name><name><surname>Erijman</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Time series genome centric analysis in activated sludge microbial communities</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA484416">PRJNA484416</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We acknowledge helpful discussions and comments from all the members of the Goyal and Zilman groups. We thank Vijay Kumar for help with extinction probability of phage clones.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abreu</surname><given-names>CI</given-names></name><name><surname>Andersen Woltz</surname><given-names>VL</given-names></name><name><surname>Friedman</surname><given-names>J</given-names></name><name><surname>Gore</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Microbial communities display alternative stable states in a fluctuating environment</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1007934</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007934</pub-id><pub-id pub-id-type="pmid">32453781</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altan-Bonnet</surname><given-names>G</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Quantitative immunology for physicists</article-title><source>Physics Reports</source><volume>849</volume><fpage>1</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1016/j.physrep.2020.01.001</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Badali</surname><given-names>M</given-names></name><name><surname>Zilman</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Effects of niche overlap on coexistence, fixation and invasion in a population of two interacting species</article-title><source>Royal Society Open Science</source><volume>7</volume><elocation-id>192181</elocation-id><pub-id pub-id-type="doi">10.1098/rsos.192181</pub-id><pub-id pub-id-type="pmid">32257357</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berngruber</surname><given-names>TW</given-names></name><name><surname>Froissart</surname><given-names>R</given-names></name><name><surname>Choisy</surname><given-names>M</given-names></name><name><surname>Gandon</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Evolution of virulence in emerging epidemics</article-title><source>PLOS Pathogens</source><volume>9</volume><elocation-id>e1003209</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1003209</pub-id><pub-id pub-id-type="pmid">23516359</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernheim</surname><given-names>A</given-names></name><name><surname>Sorek</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The pan-immune system of bacteria: antiviral defence as a community resource</article-title><source>Nature Reviews. Microbiology</source><volume>18</volume><fpage>113</fpage><lpage>119</lpage><pub-id pub-id-type="doi">10.1038/s41579-019-0278-2</pub-id><pub-id pub-id-type="pmid">31695182</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Betts</surname><given-names>A</given-names></name><name><surname>Gray</surname><given-names>C</given-names></name><name><surname>Zelek</surname><given-names>M</given-names></name><name><surname>MacLean</surname><given-names>RC</given-names></name><name><surname>King</surname><given-names>KC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>High parasite diversity accelerates host adaptation and diversification</article-title><source>Science</source><volume>360</volume><fpage>907</fpage><lpage>911</lpage><pub-id pub-id-type="doi">10.1126/science.aam9974</pub-id><pub-id pub-id-type="pmid">29798882</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blanquart</surname><given-names>F</given-names></name><name><surname>Gandon</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Time-Shift experiments and patterns of adaptation across time and space</article-title><source>Ecology Letters</source><volume>16</volume><fpage>31</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1111/ele.12007</pub-id><pub-id pub-id-type="pmid">23034076</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bondy-Denomy</surname><given-names>J</given-names></name><name><surname>Pawluk</surname><given-names>A</given-names></name><name><surname>Maxwell</surname><given-names>KL</given-names></name><name><surname>Davidson</surname><given-names>AR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Bacteriophage genes that inactivate the CRISPR/Cas bacterial immune system</article-title><source>Nature</source><volume>493</volume><fpage>429</fpage><lpage>432</lpage><pub-id pub-id-type="doi">10.1038/nature11723</pub-id><pub-id pub-id-type="pmid">23242138</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonsma-Fisher</surname><given-names>M</given-names></name><name><surname>Soutière</surname><given-names>D</given-names></name><name><surname>Goyal</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>How adaptive immunity constrains the composition and fate of large bacterial populations</article-title><source>PNAS</source><volume>115</volume><fpage>E7462</fpage><lpage>E7468</lpage><pub-id pub-id-type="doi">10.1073/pnas.1802887115</pub-id><pub-id pub-id-type="pmid">30038015</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bonsma-Fisher</surname><given-names>M</given-names></name><name><surname>Goyal</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>CRISPR-dynamics-model</data-title><version designator="swh:1:rev:af68da75b617e30d744318fb88f29db2888e3a97">swh:1:rev:af68da75b617e30d744318fb88f29db2888e3a97</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:4efa8a35b18010ad9e43daf5c6f36c5fa80e6a9d;origin=https://github.com/mbonsma/CRISPR-dynamics-model;visit=swh:1:snp:357967e93acd38d135ce3ce7915b8b94e0d5246c;anchor=swh:1:rev:af68da75b617e30d744318fb88f29db2888e3a97">https://archive.softwareheritage.org/swh:1:dir:4efa8a35b18010ad9e43daf5c6f36c5fa80e6a9d;origin=https://github.com/mbonsma/CRISPR-dynamics-model;visit=swh:1:snp:357967e93acd38d135ce3ce7915b8b94e0d5246c;anchor=swh:1:rev:af68da75b617e30d744318fb88f29db2888e3a97</ext-link></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradde</surname><given-names>S</given-names></name><name><surname>Vucelja</surname><given-names>M</given-names></name><name><surname>Teşileanu</surname><given-names>T</given-names></name><name><surname>Balasubramanian</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dynamics of adaptive immunity against phage in bacterial populations</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005486</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005486</pub-id><pub-id pub-id-type="pmid">28414716</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradde</surname><given-names>S</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Cost and benefits of clustered regularly interspaced short palindromic repeats spacer acquisition</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>374</volume><elocation-id>20180095</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2018.0095</pub-id><pub-id pub-id-type="pmid">30905281</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradde</surname><given-names>S</given-names></name><name><surname>Nourmohammad</surname><given-names>A</given-names></name><name><surname>Goyal</surname><given-names>S</given-names></name><name><surname>Balasubramanian</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The size of the immune repertoire of bacteria</article-title><source>PNAS</source><volume>117</volume><fpage>5144</fpage><lpage>5151</lpage><pub-id pub-id-type="doi">10.1073/pnas.1903666117</pub-id><pub-id pub-id-type="pmid">32071241</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brodt</surname><given-names>A</given-names></name><name><surname>Lurie-Weinberger</surname><given-names>MN</given-names></name><name><surname>Gophna</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Crispr loci reveal networks of gene exchange in archaea</article-title><source>Biology Direct</source><volume>6</volume><elocation-id>65</elocation-id><pub-id pub-id-type="doi">10.1186/1745-6150-6-65</pub-id><pub-id pub-id-type="pmid">22188759</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burstein</surname><given-names>D</given-names></name><name><surname>Sun</surname><given-names>CL</given-names></name><name><surname>Brown</surname><given-names>CT</given-names></name><name><surname>Sharon</surname><given-names>I</given-names></name><name><surname>Anantharaman</surname><given-names>K</given-names></name><name><surname>Probst</surname><given-names>AJ</given-names></name><name><surname>Thomas</surname><given-names>BC</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Major bacterial lineages are essentially devoid of CRISPR-Cas viral defence systems</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>10613</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms10613</pub-id><pub-id pub-id-type="pmid">26837824</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Camaglia</surname><given-names>F</given-names></name><name><surname>Ryvkin</surname><given-names>A</given-names></name><name><surname>Greenstein</surname><given-names>E</given-names></name><name><surname>Reich-Zeliger</surname><given-names>S</given-names></name><name><surname>Chain</surname><given-names>B</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Friedman</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Population based selection shapes the T cell receptor repertoire during thymic development</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/ssrn.4048386</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>Y</given-names></name><name><surname>Gillespie</surname><given-names>DT</given-names></name><name><surname>Petzold</surname><given-names>LR</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Efficient step size selection for the tau-leaping simulation method</article-title><source>J Chem Phys</source><volume>124</volume><elocation-id>044109</elocation-id><pub-id pub-id-type="doi">10.1063/1.2159468</pub-id><pub-id pub-id-type="pmid">16460151</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chabas</surname><given-names>H</given-names></name><name><surname>van Houte</surname><given-names>S</given-names></name><name><surname>Høyland-Kroghsbo</surname><given-names>NM</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Immigration of susceptible hosts triggers the evolution of alternative parasite defence strategies</article-title><source>Proceedings. Biological Sciences</source><volume>283</volume><elocation-id>20160721</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2016.0721</pub-id><pub-id pub-id-type="pmid">27581884</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chabas</surname><given-names>H</given-names></name><name><surname>Lion</surname><given-names>S</given-names></name><name><surname>Nicot</surname><given-names>A</given-names></name><name><surname>Meaden</surname><given-names>S</given-names></name><name><surname>van Houte</surname><given-names>S</given-names></name><name><surname>Moineau</surname><given-names>S</given-names></name><name><surname>Wahl</surname><given-names>LM</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name><name><surname>Gandon</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evolutionary emergence of infectious diseases in heterogeneous host populations</article-title><source>PLOS Biology</source><volume>16</volume><elocation-id>e2006738</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2006738</pub-id><pub-id pub-id-type="pmid">30248089</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Chabas</surname><given-names>H</given-names></name><name><surname>Müller</surname><given-names>V</given-names></name><name><surname>Bonhoeffer</surname><given-names>S</given-names></name><name><surname>Regoes</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Epidemiological and Evolutionary Consequences of CRISPR-Cas Reactivity</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.01.14.426534</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chao</surname><given-names>DL</given-names></name><name><surname>Davenport</surname><given-names>MP</given-names></name><name><surname>Forrest</surname><given-names>S</given-names></name><name><surname>Perelson</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The effects of thymic selection on the range of T cell cross-reactivity</article-title><source>European Journal of Immunology</source><volume>35</volume><fpage>3452</fpage><lpage>3459</lpage><pub-id pub-id-type="doi">10.1002/eji.200535098</pub-id><pub-id pub-id-type="pmid">16285012</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chardès</surname><given-names>V</given-names></name><name><surname>Vergassola</surname><given-names>M</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Affinity maturation for an optimal balance between long-term immune coverage and short-term resource constraints</article-title><source>PNAS</source><volume>119</volume><elocation-id>e2113512119</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2113512119</pub-id><pub-id pub-id-type="pmid">35177475</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Mayer</surname><given-names>A</given-names></name><name><surname>Balasubramanian</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A scaling law in CRISPR repertoire sizes arises from the avoidance of autoimmunity</article-title><source>Current Biology</source><volume>32</volume><fpage>2897</fpage><lpage>2907</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2022.05.021</pub-id><pub-id pub-id-type="pmid">35659862</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Childs</surname><given-names>LM</given-names></name><name><surname>Held</surname><given-names>NL</given-names></name><name><surname>Young</surname><given-names>MJ</given-names></name><name><surname>Whitaker</surname><given-names>RJ</given-names></name><name><surname>Weitz</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Multiscale model of CRISPR-induced coevolutionary dynamics: diversification at the interface of Lamarck and Darwin</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>66</volume><fpage>2015</fpage><lpage>2029</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2012.01595.x</pub-id><pub-id pub-id-type="pmid">22759281</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Childs</surname><given-names>LM</given-names></name><name><surname>England</surname><given-names>WE</given-names></name><name><surname>Young</surname><given-names>MJ</given-names></name><name><surname>Weitz</surname><given-names>JS</given-names></name><name><surname>Whitaker</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>CRISPR-induced distributed immunity in microbial populations</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e101710</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0101710</pub-id><pub-id pub-id-type="pmid">25000306</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Childs</surname><given-names>LM</given-names></name><name><surname>Baskerville</surname><given-names>EB</given-names></name><name><surname>Cobey</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Trade-Offs in antibody repertoires to complex antigens</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>370</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1098/rstb.2014.0245</pub-id><pub-id pub-id-type="pmid">26194759</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Common</surname><given-names>J</given-names></name><name><surname>Morley</surname><given-names>D</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name><name><surname>van Houte</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Crispr-cas immunity leads to a coevolutionary arms race between streptococcus thermophilus and lytic phage</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>374</volume><elocation-id>20180098</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2018.0098</pub-id><pub-id pub-id-type="pmid">30905285</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Common</surname><given-names>J</given-names></name><name><surname>Walker-Sünderhauf</surname><given-names>D</given-names></name><name><surname>van Houte</surname><given-names>S</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Diversity in CRISPR-based immunity protects susceptible genotypes by restricting phage spread and evolution</article-title><source>Journal of Evolutionary Biology</source><volume>33</volume><fpage>1097</fpage><lpage>1108</lpage><pub-id pub-id-type="doi">10.1111/jeb.13638</pub-id><pub-id pub-id-type="pmid">32383796</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deecker</surname><given-names>SR</given-names></name><name><surname>Ensminger</surname><given-names>AW</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Type I-F CRISPR-cas distribution and array dynamics in legionella pneumophila</article-title><source>G3: Genes, Genomes, Genetics</source><volume>10</volume><fpage>1039</fpage><lpage>1050</lpage><pub-id pub-id-type="doi">10.1534/g3.119.400813</pub-id><pub-id pub-id-type="pmid">31937548</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Greef</surname><given-names>PC</given-names></name><name><surname>Oakes</surname><given-names>T</given-names></name><name><surname>Gerritsen</surname><given-names>B</given-names></name><name><surname>Ismail</surname><given-names>M</given-names></name><name><surname>Heather</surname><given-names>JM</given-names></name><name><surname>Hermsen</surname><given-names>R</given-names></name><name><surname>Chain</surname><given-names>B</given-names></name><name><surname>de Boer</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The naive T-cell receptor repertoire has an extremely broad distribution of clone sizes</article-title><source>eLife</source><volume>9</volume><elocation-id>e49900</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.49900</pub-id><pub-id pub-id-type="pmid">32187010</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delaney</surname><given-names>NF</given-names></name><name><surname>Balenger</surname><given-names>S</given-names></name><name><surname>Bonneaud</surname><given-names>C</given-names></name><name><surname>Marx</surname><given-names>CJ</given-names></name><name><surname>Hill</surname><given-names>GE</given-names></name><name><surname>Ferguson-Noel</surname><given-names>N</given-names></name><name><surname>Tsai</surname><given-names>P</given-names></name><name><surname>Rodrigo</surname><given-names>A</given-names></name><name><surname>Edwards</surname><given-names>SV</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Ultrafast evolution and loss of crisprs following a host shift in a novel wildlife pathogen, Mycoplasma gallisepticum</article-title><source>PLOS Genetics</source><volume>8</volume><elocation-id>e1002511</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002511</pub-id><pub-id pub-id-type="pmid">22346765</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delbrück</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1940">1940</year><article-title>Adsorption of bacteriophage under various physiological conditions of the host</article-title><source>The Journal of General Physiology</source><volume>23</volume><fpage>631</fpage><lpage>642</lpage><pub-id pub-id-type="doi">10.1085/jgp.23.5.631</pub-id><pub-id pub-id-type="pmid">19873179</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desai</surname><given-names>MM</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Beneficial mutation selection balance and the effect of linkage on positive selection</article-title><source>Genetics</source><volume>176</volume><fpage>1759</fpage><lpage>1798</lpage><pub-id pub-id-type="doi">10.1534/genetics.106.067678</pub-id><pub-id pub-id-type="pmid">17483432</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desai</surname><given-names>MM</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name><name><surname>Murray</surname><given-names>AW</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The speed of evolution and maintenance of variation in asexual populations</article-title><source>Current Biology</source><volume>17</volume><fpage>385</fpage><lpage>394</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2007.01.072</pub-id><pub-id pub-id-type="pmid">17331728</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desponds</surname><given-names>J</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fluctuating fitness shapes the clone-size distribution of immune repertoires</article-title><source>PNAS</source><volume>113</volume><fpage>274</fpage><lpage>279</lpage><pub-id pub-id-type="doi">10.1073/pnas.1512977112</pub-id><pub-id pub-id-type="pmid">26711994</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dessalles</surname><given-names>R</given-names></name><name><surname>Pan</surname><given-names>Y</given-names></name><name><surname>Xia</surname><given-names>M</given-names></name><name><surname>Maestrini</surname><given-names>D</given-names></name><name><surname>D’Orsogna</surname><given-names>MR</given-names></name><name><surname>Chou</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>How naive T-cell clone counts are shaped by heterogeneous thymic output and homeostatic proliferation</article-title><source>Frontiers in Immunology</source><volume>12</volume><elocation-id>735135</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2021.735135</pub-id><pub-id pub-id-type="pmid">35250963</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Detours</surname><given-names>V</given-names></name><name><surname>Perelson</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Explaining high alloreactivity as a quantitative consequence of affinity-driven thymocyte selection</article-title><source>PNAS</source><volume>96</volume><fpage>5153</fpage><lpage>5158</lpage><pub-id pub-id-type="doi">10.1073/pnas.96.9.5153</pub-id><pub-id pub-id-type="pmid">10220434</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Detours</surname><given-names>V</given-names></name><name><surname>Perelson</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The paradox of alloreactivity and self MHC restriction: quantitative analysis and statistics</article-title><source>PNAS</source><volume>97</volume><fpage>8479</fpage><lpage>8483</lpage><pub-id pub-id-type="doi">10.1073/pnas.97.15.8479</pub-id><pub-id pub-id-type="pmid">10900009</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deveau</surname><given-names>H</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Garneau</surname><given-names>JE</given-names></name><name><surname>Labonté</surname><given-names>J</given-names></name><name><surname>Fremaux</surname><given-names>C</given-names></name><name><surname>Boyaval</surname><given-names>P</given-names></name><name><surname>Romero</surname><given-names>DA</given-names></name><name><surname>Horvath</surname><given-names>P</given-names></name><name><surname>Moineau</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Phage response to CRISPR-encoded resistance in Streptococcus thermophilus</article-title><source>Journal of Bacteriology</source><volume>190</volume><fpage>1390</fpage><lpage>1400</lpage><pub-id pub-id-type="doi">10.1128/JB.01412-07</pub-id><pub-id pub-id-type="pmid">18065545</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dewald-Wang</surname><given-names>EA</given-names></name><name><surname>Parr</surname><given-names>N</given-names></name><name><surname>Tiley</surname><given-names>K</given-names></name><name><surname>Lee</surname><given-names>A</given-names></name><name><surname>Koskella</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Multiyear time-shift study of bacteria and phage dynamics in the phyllosphere</article-title><source>The American Naturalist</source><volume>199</volume><fpage>126</fpage><lpage>140</lpage><pub-id pub-id-type="doi">10.1086/717181</pub-id><pub-id pub-id-type="pmid">34978974</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dimitriu</surname><given-names>T</given-names></name><name><surname>Kurilovich</surname><given-names>E</given-names></name><name><surname>Łapińska</surname><given-names>U</given-names></name><name><surname>Severinov</surname><given-names>K</given-names></name><name><surname>Pagliara</surname><given-names>S</given-names></name><name><surname>Szczelkun</surname><given-names>MD</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Bacteriostatic antibiotics promote CRISPR-Cas adaptive immunity by enabling increased spacer acquisition</article-title><source>Cell Host &amp; Microbe</source><volume>30</volume><fpage>31</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2021.11.014</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doekes</surname><given-names>HM</given-names></name><name><surname>Mulder</surname><given-names>GA</given-names></name><name><surname>Hermsen</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Repeated outbreaks drive the evolution of bacteriophage communication</article-title><source>eLife</source><volume>10</volume><elocation-id>e58410</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.58410</pub-id><pub-id pub-id-type="pmid">33459590</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Downie</surname><given-names>AE</given-names></name><name><surname>Mayer</surname><given-names>A</given-names></name><name><surname>Metcalf</surname><given-names>CJE</given-names></name><name><surname>Graham</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Optimal immune specificity at the intersection of host life history and parasite epidemiology</article-title><source>PLOS Computational Biology</source><volume>17</volume><elocation-id>e1009714</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009714</pub-id><pub-id pub-id-type="pmid">34932551</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eaton</surname><given-names>DAR</given-names></name><name><surname>Matschiner</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Toytree: a minimalist tree visualization and manipulation library for python</article-title><source>Methods in Ecology and Evolution</source><volume>11</volume><fpage>187</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1111/2041-210X.13313</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frost</surname><given-names>SDW</given-names></name><name><surname>Wrin</surname><given-names>T</given-names></name><name><surname>Smith</surname><given-names>DM</given-names></name><name><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Paxinos</surname><given-names>E</given-names></name><name><surname>Chappey</surname><given-names>C</given-names></name><name><surname>Galovich</surname><given-names>J</given-names></name><name><surname>Beauchaine</surname><given-names>J</given-names></name><name><surname>Petropoulos</surname><given-names>CJ</given-names></name><name><surname>Little</surname><given-names>SJ</given-names></name><name><surname>Richman</surname><given-names>DD</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Neutralizing antibody responses drive the evolution of human immunodeficiency virus type 1 envelope during recent HIV infection</article-title><source>PNAS</source><volume>102</volume><fpage>18514</fpage><lpage>18519</lpage><pub-id pub-id-type="doi">10.1073/pnas.0504658102</pub-id><pub-id pub-id-type="pmid">16339909</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaba</surname><given-names>S</given-names></name><name><surname>Ebert</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Time-Shift experiments as a tool to study antagonistic coevolution</article-title><source>Trends in Ecology &amp; Evolution</source><volume>24</volume><fpage>226</fpage><lpage>232</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2008.11.005</pub-id><pub-id pub-id-type="pmid">19201504</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaimann</surname><given-names>MU</given-names></name><name><surname>Nguyen</surname><given-names>M</given-names></name><name><surname>Desponds</surname><given-names>J</given-names></name><name><surname>Mayer</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Early life imprints the hierarchy of T cell clone sizes</article-title><source>eLife</source><volume>9</volume><elocation-id>e61639</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.61639</pub-id><pub-id pub-id-type="pmid">33345776</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garneau</surname><given-names>JE</given-names></name><name><surname>Dupuis</surname><given-names>MÈ</given-names></name><name><surname>Villion</surname><given-names>M</given-names></name><name><surname>Romero</surname><given-names>DA</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Boyaval</surname><given-names>P</given-names></name><name><surname>Fremaux</surname><given-names>C</given-names></name><name><surname>Horvath</surname><given-names>P</given-names></name><name><surname>Magadán</surname><given-names>AH</given-names></name><name><surname>Moineau</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The CRISPR/Cas bacterial immune system cleaves bacteriophage and plasmid DNA</article-title><source>Nature</source><volume>468</volume><fpage>67</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1038/nature09523</pub-id><pub-id pub-id-type="pmid">21048762</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garrett</surname><given-names>SC</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Pruning and tending immune memories: spacer dynamics in the CRISPR array</article-title><source>Frontiers in Microbiology</source><volume>12</volume><elocation-id>664299</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2021.664299</pub-id><pub-id pub-id-type="pmid">33868219</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gómez</surname><given-names>P</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Bacteria-Phage antagonistic coevolution in soil</article-title><source>Science</source><volume>332</volume><fpage>106</fpage><lpage>109</lpage><pub-id pub-id-type="doi">10.1126/science.1198767</pub-id><pub-id pub-id-type="pmid">21454789</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guerrero</surname><given-names>LD</given-names></name><name><surname>Pérez</surname><given-names>MV</given-names></name><name><surname>Orellana</surname><given-names>E</given-names></name><name><surname>Piuri</surname><given-names>M</given-names></name><name><surname>Quiroga</surname><given-names>C</given-names></name><name><surname>Erijman</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2021">2021a</year><article-title>Long-run bacteria-phage coexistence dynamics under natural habitat conditions in an environmental biotechnology system</article-title><source>The ISME Journal</source><volume>15</volume><fpage>636</fpage><lpage>648</lpage><pub-id pub-id-type="doi">10.1038/s41396-020-00802-z</pub-id><pub-id pub-id-type="pmid">33067586</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Guerrero</surname><given-names>LD</given-names></name><name><surname>Pérez</surname><given-names>MV</given-names></name><name><surname>Orellana</surname><given-names>E</given-names></name><name><surname>Piuri</surname><given-names>M</given-names></name><name><surname>Quiroga</surname><given-names>C</given-names></name><name><surname>Year</surname><given-names>EL</given-names></name></person-group><year iso-8601-date="2021">2021b</year><data-title>Gordonia-CRISPR</data-title><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/GuerreroCRISPR/Gordonia-CRISPR">https://github.com/GuerreroCRISPR/Gordonia-CRISPR</ext-link></element-citation></ref><ref id="bib53"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Guillemet</surname><given-names>M</given-names></name><name><surname>Chabas</surname><given-names>H</given-names></name><name><surname>Nicot</surname><given-names>A</given-names></name><name><surname>Gatchich</surname><given-names>F</given-names></name><name><surname>Ortega-Abboud</surname><given-names>E</given-names></name><name><surname>Buus</surname><given-names>C</given-names></name><name><surname>Hindhede</surname><given-names>L</given-names></name><name><surname>Rousseau</surname><given-names>GM</given-names></name><name><surname>Bataillon</surname><given-names>T</given-names></name><name><surname>Moineau</surname><given-names>S</given-names></name><name><surname>Gandon</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Competition and Coevolution Drive the Evolution and the Diversification of CRISPR Immunity</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.11.12.468349</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gurney</surname><given-names>J</given-names></name><name><surname>Pleška</surname><given-names>M</given-names></name><name><surname>Levin</surname><given-names>BR</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Why put up with immunity when there is resistance: an excursion into the population and evolutionary dynamics of restriction–modification and CRISPR-cas</article-title><source>Philosophical Transactions of the Royal Society B</source><volume>374</volume><elocation-id>20180096</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2018.0096</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haerter</surname><given-names>JO</given-names></name><name><surname>Trusina</surname><given-names>A</given-names></name><name><surname>Sneppen</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Targeted bacterial immunity buffers phage diversity</article-title><source>Journal of Virology</source><volume>85</volume><fpage>10554</fpage><lpage>10560</lpage><pub-id pub-id-type="doi">10.1128/JVI.05222-11</pub-id><pub-id pub-id-type="pmid">21813617</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haerter</surname><given-names>JO</given-names></name><name><surname>Sneppen</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Spatial structure and lamarckian adaptation explain extreme genetic diversity at CRISPR locus</article-title><source>MBio</source><volume>3</volume><elocation-id>e00126-12</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.00126-12</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>AR</given-names></name><name><surname>Scanlan</surname><given-names>PD</given-names></name><name><surname>Morgan</surname><given-names>AD</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Host-Parasite coevolutionary arms races give way to fluctuating selection</article-title><source>Ecology Letters</source><volume>14</volume><fpage>635</fpage><lpage>642</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2011.01624.x</pub-id><pub-id pub-id-type="pmid">21521436</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>P</given-names></name><name><surname>Niestemski</surname><given-names>LR</given-names></name><name><surname>Barrick</surname><given-names>JE</given-names></name><name><surname>Deem</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Physical model of the immune response of bacteria against bacteriophage through the adaptive CRISPR-Cas immune system</article-title><source>Physical Biology</source><volume>10</volume><elocation-id>025004</elocation-id><pub-id pub-id-type="doi">10.1088/1478-3975/10/2/025004</pub-id><pub-id pub-id-type="pmid">23492852</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>P</given-names></name><name><surname>Deem</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Non-classical phase diagram for virus bacterial coevolution mediated by clustered regularly interspaced short palindromic repeats</article-title><source>Journal of the Royal Society, Interface</source><volume>14</volume><elocation-id>127</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2016.0905</pub-id><pub-id pub-id-type="pmid">28202591</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>F</given-names></name><name><surname>Hu</surname><given-names>XS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Hubbell’s fundamental biodiversity parameter and the simpson diversity index</article-title><source>Ecology Letters</source><volume>8</volume><fpage>386</fpage><lpage>390</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2005.00729.x</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>J</given-names></name><name><surname>Deem</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Heterogeneous diversity of spacers within CRISPR (clustered regularly interspaced short palindromic repeats)</article-title><source>Physical Review Letters</source><volume>105</volume><elocation-id>128102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.105.128102</pub-id><pub-id pub-id-type="pmid">20867676</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heilmann</surname><given-names>S</given-names></name><name><surname>Sneppen</surname><given-names>K</given-names></name><name><surname>Krishna</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Sustainability of virulence in a phage-bacterial ecosystem</article-title><source>Journal of Virology</source><volume>84</volume><fpage>3016</fpage><lpage>3022</lpage><pub-id pub-id-type="doi">10.1128/JVI.02326-09</pub-id><pub-id pub-id-type="pmid">20071588</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heilmann</surname><given-names>S</given-names></name><name><surname>Sneppen</surname><given-names>K</given-names></name><name><surname>Krishna</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Coexistence of phage and bacteria on the boundary of self-organized refuges</article-title><source>PNAS</source><volume>109</volume><fpage>12828</fpage><lpage>12833</lpage><pub-id pub-id-type="doi">10.1073/pnas.1200771109</pub-id><pub-id pub-id-type="pmid">22807479</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Held</surname><given-names>NL</given-names></name><name><surname>Herrera</surname><given-names>A</given-names></name><name><surname>Cadillo-Quiroz</surname><given-names>H</given-names></name><name><surname>Whitaker</surname><given-names>RJ</given-names></name><name><surname>Planet</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Crispr associated diversity within a population of Sulfolobus islandicus</article-title><source>PLOS ONE</source><volume>5</volume><elocation-id>e12988</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0012988</pub-id><pub-id pub-id-type="pmid">20927396</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heler</surname><given-names>R</given-names></name><name><surname>Samai</surname><given-names>P</given-names></name><name><surname>Modell</surname><given-names>JW</given-names></name><name><surname>Weiner</surname><given-names>C</given-names></name><name><surname>Goldberg</surname><given-names>GW</given-names></name><name><surname>Bikard</surname><given-names>D</given-names></name><name><surname>Marraffini</surname><given-names>LA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Cas9 specifies functional viral targets during CRISPR–cas adaptation</article-title><source>Nature</source><volume>519</volume><fpage>199</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.1038/nature14245</pub-id><pub-id pub-id-type="pmid">25707807</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heler</surname><given-names>R</given-names></name><name><surname>Wright</surname><given-names>AV</given-names></name><name><surname>Vucelja</surname><given-names>M</given-names></name><name><surname>Doudna</surname><given-names>JA</given-names></name><name><surname>Marraffini</surname><given-names>LA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spacer acquisition rates determine the immunological diversity of the type II CRISPR-Cas immune response</article-title><source>Cell Host &amp; Microbe</source><volume>25</volume><fpage>242</fpage><lpage>249</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2018.12.016</pub-id><pub-id pub-id-type="pmid">30709780</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hille</surname><given-names>F</given-names></name><name><surname>Richter</surname><given-names>H</given-names></name><name><surname>Wong</surname><given-names>SP</given-names></name><name><surname>Bratovič</surname><given-names>M</given-names></name><name><surname>Ressel</surname><given-names>S</given-names></name><name><surname>Charpentier</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The biology of CRISPR-Cas: backward and forward</article-title><source>Cell</source><volume>172</volume><fpage>1239</fpage><lpage>1259</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.11.032</pub-id><pub-id pub-id-type="pmid">29522745</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horvath</surname><given-names>P</given-names></name><name><surname>Romero</surname><given-names>DA</given-names></name><name><surname>Coûté-Monvoisin</surname><given-names>AC</given-names></name><name><surname>Richards</surname><given-names>M</given-names></name><name><surname>Deveau</surname><given-names>H</given-names></name><name><surname>Moineau</surname><given-names>S</given-names></name><name><surname>Boyaval</surname><given-names>P</given-names></name><name><surname>Fremaux</surname><given-names>C</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Diversity, activity, and evolution of CRISPR loci in Streptococcus thermophilus</article-title><source>Journal of Bacteriology</source><volume>190</volume><fpage>1401</fpage><lpage>1412</lpage><pub-id pub-id-type="doi">10.1128/JB.01415-07</pub-id><pub-id pub-id-type="pmid">18065539</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Høyland-Kroghsbo</surname><given-names>NM</given-names></name><name><surname>Paczkowski</surname><given-names>J</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Broniewski</surname><given-names>J</given-names></name><name><surname>Westra</surname><given-names>E</given-names></name><name><surname>Bondy-Denomy</surname><given-names>J</given-names></name><name><surname>Bassler</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Quorum sensing controls the <italic>Pseudomonas aeruginosa</italic> CRISPR-cas adaptive immune system</article-title><source>PNAS</source><volume>114</volume><fpage>131</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1073/pnas.1617415113</pub-id><pub-id pub-id-type="pmid">27849583</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Høyland-Kroghsbo</surname><given-names>NM</given-names></name><name><surname>Muñoz</surname><given-names>KA</given-names></name><name><surname>Bassler</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Temperature, by controlling growth rate, regulates CRISPR-cas activity in <italic>Pseudomonas aeruginosa</italic></article-title><source>mBio</source><volume>9</volume><elocation-id>e02184-18</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.02184-18</pub-id><pub-id pub-id-type="pmid">30425154</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hwang</surname><given-names>S</given-names></name><name><surname>Maxwell</surname><given-names>KL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Meet the anti-crisprs: widespread protein inhibitors of CRISPR-Cas systems</article-title><source>The CRISPR Journal</source><volume>2</volume><fpage>23</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1089/crispr.2018.0052</pub-id><pub-id pub-id-type="pmid">31021234</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iranzo</surname><given-names>J</given-names></name><name><surname>Lobkovsky</surname><given-names>AE</given-names></name><name><surname>Wolf</surname><given-names>YI</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Evolutionary dynamics of the prokaryotic adaptive immunity system CRISPR-Cas in an explicit ecological context</article-title><source>Journal of Bacteriology</source><volume>195</volume><fpage>3834</fpage><lpage>3844</lpage><pub-id pub-id-type="doi">10.1128/JB.00412-13</pub-id><pub-id pub-id-type="pmid">23794616</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>W</given-names></name><name><surname>Maniv</surname><given-names>I</given-names></name><name><surname>Arain</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Levin</surname><given-names>BR</given-names></name><name><surname>Marraffini</surname><given-names>LA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Dealing with the evolutionary downside of CRISPR immunity: bacteria and beneficial plasmids</article-title><source>PLOS Genetics</source><volume>9</volume><elocation-id>e1003844</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003844</pub-id><pub-id pub-id-type="pmid">24086164</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koonin</surname><given-names>EV</given-names></name><name><surname>Makarova</surname><given-names>KS</given-names></name><name><surname>Zhang</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Diversity, classification and evolution of CRISPR-Cas systems</article-title><source>Current Opinion in Microbiology</source><volume>37</volume><fpage>67</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2017.05.008</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koonin</surname><given-names>EV</given-names></name><name><surname>Makarova</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Origins and evolution of CRISPR-cas systems</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>374</volume><elocation-id>20180087</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2018.0087</pub-id><pub-id pub-id-type="pmid">30905284</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koonin</surname><given-names>EV</given-names></name><name><surname>Makarova</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Evolutionary plasticity and functional versatility of CRISPR systems</article-title><source>PLOS Biology</source><volume>20</volume><elocation-id>e3001481</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3001481</pub-id><pub-id pub-id-type="pmid">34986140</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koskella</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Bacteria-phage interactions across time and space: merging local adaptation and time-shift experiments to understand phage evolution</article-title><source>The American Naturalist</source><volume>184 Suppl 1</volume><fpage>9</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1086/676888</pub-id><pub-id pub-id-type="pmid">25061680</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kysela</surname><given-names>DT</given-names></name><name><surname>Turner</surname><given-names>PE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Optimal bacteriophage mutation rates for phage therapy</article-title><source>Journal of Theoretical Biology</source><volume>249</volume><fpage>411</fpage><lpage>421</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2007.08.007</pub-id><pub-id pub-id-type="pmid">17904162</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laanto</surname><given-names>E</given-names></name><name><surname>Hoikkala</surname><given-names>V</given-names></name><name><surname>Ravantti</surname><given-names>J</given-names></name><name><surname>Sundberg</surname><given-names>LR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Long-term genomic coevolution of host-parasite interaction in the natural environment</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>111</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-00158-7</pub-id><pub-id pub-id-type="pmid">28740072</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leenay</surname><given-names>RT</given-names></name><name><surname>Maksimchuk</surname><given-names>KR</given-names></name><name><surname>Slotkowski</surname><given-names>RA</given-names></name><name><surname>Agrawal</surname><given-names>RN</given-names></name><name><surname>Gomaa</surname><given-names>AA</given-names></name><name><surname>Briner</surname><given-names>AE</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Beisel</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Identifying and visualizing functional PAM diversity across CRISPR-cas systems</article-title><source>Molecular Cell</source><volume>62</volume><fpage>137</fpage><lpage>147</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2016.02.031</pub-id><pub-id pub-id-type="pmid">27041224</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levin</surname><given-names>BR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Nasty viruses, costly plasmids, population dynamics, and the conditions for establishing and maintaining CRISPR-mediated adaptive immunity in bacteria</article-title><source>PLOS Genetics</source><volume>6</volume><elocation-id>e1001171</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1001171</pub-id><pub-id pub-id-type="pmid">21060859</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levin</surname><given-names>BR</given-names></name><name><surname>Moineau</surname><given-names>S</given-names></name><name><surname>Bushman</surname><given-names>M</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The population and evolutionary dynamics of phage and bacteria with CRISPR-mediated immunity</article-title><source>PLOS Genetics</source><volume>9</volume><elocation-id>e1003312</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003312</pub-id><pub-id pub-id-type="pmid">23516369</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopatina</surname><given-names>A</given-names></name><name><surname>Medvedeva</surname><given-names>S</given-names></name><name><surname>Artamonova</surname><given-names>D</given-names></name><name><surname>Kolesnik</surname><given-names>M</given-names></name><name><surname>Sitnik</surname><given-names>V</given-names></name><name><surname>Ispolatov</surname><given-names>Y</given-names></name><name><surname>Severinov</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Natural diversity of CRISPR spacers of thermus: evidence of local spacer acquisition and global spacer exchange</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>374</volume><elocation-id>20180092</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2018.0092</pub-id><pub-id pub-id-type="pmid">30905291</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="thesis"><person-group person-group-type="author"><name><surname>Lucchini</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Genetic Diversity of Streptococcus thermophilusPhages and Development of PhD thesis</article-title><publisher-name>Swiss Federal Institute of Technology Zurich</publisher-name></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luksza</surname><given-names>M</given-names></name><name><surname>Lässig</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A predictive fitness model for influenza</article-title><source>Nature</source><volume>507</volume><fpage>57</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1038/nature13087</pub-id><pub-id pub-id-type="pmid">24572367</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Makarova</surname><given-names>KS</given-names></name><name><surname>Wolf</surname><given-names>YI</given-names></name><name><surname>Iranzo</surname><given-names>J</given-names></name><name><surname>Shmakov</surname><given-names>SA</given-names></name><name><surname>Alkhnbashi</surname><given-names>OS</given-names></name><name><surname>Brouns</surname><given-names>SJJ</given-names></name><name><surname>Charpentier</surname><given-names>E</given-names></name><name><surname>Cheng</surname><given-names>D</given-names></name><name><surname>Haft</surname><given-names>DH</given-names></name><name><surname>Horvath</surname><given-names>P</given-names></name><name><surname>Moineau</surname><given-names>S</given-names></name><name><surname>Mojica</surname><given-names>FJM</given-names></name><name><surname>Scott</surname><given-names>D</given-names></name><name><surname>Shah</surname><given-names>SA</given-names></name><name><surname>Siksnys</surname><given-names>V</given-names></name><name><surname>Terns</surname><given-names>MP</given-names></name><name><surname>Venclovas</surname><given-names>Č</given-names></name><name><surname>White</surname><given-names>MF</given-names></name><name><surname>Yakunin</surname><given-names>AF</given-names></name><name><surname>Yan</surname><given-names>W</given-names></name><name><surname>Zhang</surname><given-names>F</given-names></name><name><surname>Garrett</surname><given-names>RA</given-names></name><name><surname>Backofen</surname><given-names>R</given-names></name><name><surname>van der Oost</surname><given-names>J</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Evolutionary classification of CRISPR-Cas systems: a burst of class 2 and derived variants</article-title><source>Nature Reviews Microbiology</source><volume>18</volume><fpage>67</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1038/s41579-019-0299-x</pub-id><pub-id pub-id-type="pmid">31857715</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marchi</surname><given-names>J</given-names></name><name><surname>Lässig</surname><given-names>M</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Multi-Lineage evolution in viral populations driven by host immune systems</article-title><source>Pathogens</source><volume>8</volume><fpage>1</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.3390/pathogens8030115</pub-id><pub-id pub-id-type="pmid">31362404</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marchi</surname><given-names>J</given-names></name><name><surname>Lässig</surname><given-names>M</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Antigenic waves of virus-immune coevolution</article-title><source>PNAS</source><volume>118</volume><elocation-id>e2103398118</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2103398118</pub-id><pub-id pub-id-type="pmid">34183397</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martynov</surname><given-names>A</given-names></name><name><surname>Severinov</surname><given-names>K</given-names></name><name><surname>Ispolatov</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Optimal number of spacers in CRISPR arrays</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005891</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005891</pub-id><pub-id pub-id-type="pmid">29253874</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mayer</surname><given-names>A</given-names></name><name><surname>Balasubramanian</surname><given-names>V</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>How a well-adapted immune system is organized</article-title><source>PNAS</source><volume>112</volume><fpage>5950</fpage><lpage>5955</lpage><pub-id pub-id-type="doi">10.1073/pnas.1421827112</pub-id><pub-id pub-id-type="pmid">25918407</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mayer</surname><given-names>A</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Rivoire</surname><given-names>O</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Diversity of immune strategies explained by adaptation to pathogen statistics</article-title><source>PNAS</source><volume>113</volume><fpage>8630</fpage><lpage>8635</lpage><pub-id pub-id-type="doi">10.1073/pnas.1600663113</pub-id><pub-id pub-id-type="pmid">27432970</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mayer</surname><given-names>A</given-names></name><name><surname>Balasubramanian</surname><given-names>V</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>How a well-adapting immune system remembers</article-title><source>PNAS</source><volume>116</volume><fpage>8815</fpage><lpage>8823</lpage><pub-id pub-id-type="doi">10.1073/pnas.1812810116</pub-id><pub-id pub-id-type="pmid">30988203</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metcalf</surname><given-names>CJE</given-names></name><name><surname>Tate</surname><given-names>AT</given-names></name><name><surname>Graham</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Demographically framing trade-offs between sensitivity and specificity illuminates selection on immunity</article-title><source>Nature Ecology &amp; Evolution</source><volume>1</volume><fpage>1766</fpage><lpage>1772</lpage><pub-id pub-id-type="doi">10.1038/s41559-017-0315-3</pub-id><pub-id pub-id-type="pmid">28963489</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mills</surname><given-names>S</given-names></name><name><surname>Shanahan</surname><given-names>F</given-names></name><name><surname>Stanton</surname><given-names>C</given-names></name><name><surname>Hill</surname><given-names>C</given-names></name><name><surname>Coffey</surname><given-names>A</given-names></name><name><surname>Ross</surname><given-names>RP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Movers and shakers: influence of bacteriophages in shaping the mammalian gut microbiota</article-title><source>Gut Microbes</source><volume>4</volume><fpage>4</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.4161/gmic.22371</pub-id><pub-id pub-id-type="pmid">23022738</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Modell</surname><given-names>JW</given-names></name><name><surname>Jiang</surname><given-names>W</given-names></name><name><surname>Marraffini</surname><given-names>LA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Crispr-Cas systems exploit viral DNA injection to establish and maintain adaptive immunity</article-title><source>Nature</source><volume>544</volume><fpage>101</fpage><lpage>104</lpage><pub-id pub-id-type="doi">10.1038/nature21719</pub-id><pub-id pub-id-type="pmid">28355179</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Molari</surname><given-names>M</given-names></name><name><surname>Eyer</surname><given-names>K</given-names></name><name><surname>Baudry</surname><given-names>J</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Quantitative modeling of the effect of antigen dosage on B-cell affinity distributions in maturating germinal centers</article-title><source>eLife</source><volume>9</volume><elocation-id>e55678</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.55678</pub-id><pub-id pub-id-type="pmid">32538783</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moore</surname><given-names>PL</given-names></name><name><surname>Ranchobe</surname><given-names>N</given-names></name><name><surname>Lambson</surname><given-names>BE</given-names></name><name><surname>Gray</surname><given-names>ES</given-names></name><name><surname>Cave</surname><given-names>E</given-names></name><name><surname>Abrahams</surname><given-names>MR</given-names></name><name><surname>Bandawe</surname><given-names>G</given-names></name><name><surname>Mlisana</surname><given-names>K</given-names></name><name><surname>Abdool Karim</surname><given-names>SS</given-names></name><name><surname>Williamson</surname><given-names>C</given-names></name><name><surname>Morris</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Limited neutralizing antibody specificities drive neutralization escape in early HIV-1 subtype C infection</article-title><source>PLOS Pathogens</source><volume>5</volume><elocation-id>e1000598</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1000598</pub-id><pub-id pub-id-type="pmid">19763271</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Rényi entropy, abundance distribution, and the equivalence of ensembles</article-title><source>Physical Review. E</source><volume>93</volume><elocation-id>052418</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.93.052418</pub-id><pub-id pub-id-type="pmid">27300934</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>How many different clonotypes do immune repertoires contain?</article-title><source>Current Opinion in Systems Biology</source><volume>18</volume><fpage>104</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1016/j.coisb.2019.10.001</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morley</surname><given-names>D</given-names></name><name><surname>Broniewski</surname><given-names>JM</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name><name><surname>van Houte</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Host diversity limits the evolution of parasite local adaptation</article-title><source>Molecular Ecology</source><volume>26</volume><fpage>1756</fpage><lpage>1763</lpage><pub-id pub-id-type="doi">10.1111/mec.13917</pub-id><pub-id pub-id-type="pmid">27862566</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nourmohammad</surname><given-names>A</given-names></name><name><surname>Otwinowski</surname><given-names>J</given-names></name><name><surname>Plotkin</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Host-Pathogen coevolution and the emergence of broadly neutralizing antibodies in chronic infections</article-title><source>PLOS Genetics</source><volume>12</volume><elocation-id>e1006171</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1006171</pub-id><pub-id pub-id-type="pmid">27442127</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nourmohammad</surname><given-names>A</given-names></name><name><surname>Otwinowski</surname><given-names>J</given-names></name><name><surname>Łuksza</surname><given-names>M</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Leitner</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Fierce selection and interference in B-cell repertoire response to chronic HIV-1</article-title><source>Molecular Biology and Evolution</source><volume>36</volume><fpage>2184</fpage><lpage>2194</lpage><pub-id pub-id-type="doi">10.1093/molbev/msz143</pub-id><pub-id pub-id-type="pmid">31209469</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paez-Espino</surname><given-names>D</given-names></name><name><surname>Morovic</surname><given-names>W</given-names></name><name><surname>Sun</surname><given-names>CL</given-names></name><name><surname>Thomas</surname><given-names>BC</given-names></name><name><surname>Ueda</surname><given-names>K</given-names></name><name><surname>Stahl</surname><given-names>B</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Strong bias in the bacterial CRISPR elements that confer immunity to phage</article-title><source>Nature Communications</source><volume>4</volume><elocation-id>1430</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms2440</pub-id><pub-id pub-id-type="pmid">23385575</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paez-Espino</surname><given-names>D</given-names></name><name><surname>Sharon</surname><given-names>I</given-names></name><name><surname>Morovic</surname><given-names>W</given-names></name><name><surname>Stahl</surname><given-names>B</given-names></name><name><surname>Thomas</surname><given-names>BC</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Crispr immunity drives rapid phage genome evolution in streptococcus thermophilus</article-title><source>MBio</source><volume>6</volume><elocation-id>e00262-15</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.00262-15</pub-id><pub-id pub-id-type="pmid">25900652</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavlova</surname><given-names>YS</given-names></name><name><surname>Paez-Espino</surname><given-names>D</given-names></name><name><surname>Morozov</surname><given-names>AY</given-names></name><name><surname>Belalov</surname><given-names>IS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Searching for fat tails in CRISPR-Cas systems: data analysis and mathematical modeling</article-title><source>PLOS Computational Biology</source><volume>17</volume><elocation-id>e1008841</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008841</pub-id><pub-id pub-id-type="pmid">33770071</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Payne</surname><given-names>P</given-names></name><name><surname>Geyrhofer</surname><given-names>L</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name><name><surname>Bollback</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>CRISPR-based herd immunity can limit phage epidemics in bacterial populations</article-title><source>eLife</source><volume>7</volume><elocation-id>e32035</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.32035</pub-id><pub-id pub-id-type="pmid">29521625</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Ponce</surname><given-names>M</given-names></name><name><surname>van Zon</surname><given-names>R</given-names></name><name><surname>Northrup</surname><given-names>S</given-names></name><name><surname>Gruner</surname><given-names>D</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Ertinaz</surname><given-names>F</given-names></name><name><surname>Fedoseev</surname><given-names>A</given-names></name><name><surname>Groer</surname><given-names>L</given-names></name><name><surname>Mao</surname><given-names>F</given-names></name><name><surname>Mundim</surname><given-names>BC</given-names></name><name><surname>Nolta</surname><given-names>M</given-names></name><name><surname>Pinto</surname><given-names>J</given-names></name><name><surname>Saldarriaga</surname><given-names>M</given-names></name><name><surname>Slavnic</surname><given-names>V</given-names></name><name><surname>Spence</surname><given-names>E</given-names></name><name><surname>Yu</surname><given-names>CH</given-names></name><name><surname>Peltier</surname><given-names>WR</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Deploying a Top-100 Supercomputer for Large Parallel Workloads</article-title><conf-name>PEARC ’19</conf-name><conf-loc>Chicago IL USA</conf-loc><pub-id pub-id-type="doi">10.1145/3332186.3332195</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pourcel</surname><given-names>C</given-names></name><name><surname>Touchon</surname><given-names>M</given-names></name><name><surname>Villeriot</surname><given-names>N</given-names></name><name><surname>Vernadet</surname><given-names>JP</given-names></name><name><surname>Couvin</surname><given-names>D</given-names></name><name><surname>Toffano-Nioche</surname><given-names>C</given-names></name><name><surname>Vergnaud</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>CRISPRCasdb a successor of crisprdb containing CRISPR arrays and Cas genes from complete genome sequences, and tools to download and query Lists of repeats and spacers</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>D535</fpage><lpage>D544</lpage><pub-id pub-id-type="doi">10.1093/nar/gkz915</pub-id><pub-id pub-id-type="pmid">31624845</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Puelma Touzel</surname><given-names>M</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Inferring the immune response from repertoire sequencing</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1007873</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007873</pub-id><pub-id pub-id-type="pmid">32348312</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pyenson</surname><given-names>NC</given-names></name><name><surname>Gayvert</surname><given-names>K</given-names></name><name><surname>Varble</surname><given-names>A</given-names></name><name><surname>Elemento</surname><given-names>O</given-names></name><name><surname>Marraffini</surname><given-names>LA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Broad targeting specificity during bacterial type III CRISPR-Cas immunity constrains viral escape</article-title><source>Cell Host &amp; Microbe</source><volume>22</volume><fpage>343</fpage><lpage>353</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2017.07.016</pub-id><pub-id pub-id-type="pmid">28826839</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pyenson</surname><given-names>NC</given-names></name><name><surname>Marraffini</surname><given-names>LA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Co-evolution within structured bacterial communities results in multiple expansion of CRISPR loci and enhanced immunity</article-title><source>eLife</source><volume>9</volume><elocation-id>e53078</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.53078</pub-id><pub-id pub-id-type="pmid">32223887</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname><given-names>C</given-names></name><name><surname>Chin</surname><given-names>D</given-names></name><name><surname>Ensminger</surname><given-names>AW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Priming in a permissive type I-C CRISPR-cas system reveals distinct dynamics of spacer acquisition and loss</article-title><source>RNA</source><volume>23</volume><fpage>1525</fpage><lpage>1538</lpage><pub-id pub-id-type="doi">10.1261/rna.062083.117</pub-id><pub-id pub-id-type="pmid">28724535</pub-id></element-citation></ref><ref id="bib113"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richman</surname><given-names>DD</given-names></name><name><surname>Wrin</surname><given-names>T</given-names></name><name><surname>Little</surname><given-names>SJ</given-names></name><name><surname>Petropoulos</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Rapid evolution of the neutralizing antibody response to HIV type 1 infection</article-title><source>PNAS</source><volume>100</volume><fpage>4144</fpage><lpage>4149</lpage><pub-id pub-id-type="doi">10.1073/pnas.0630530100</pub-id><pub-id pub-id-type="pmid">12644702</pub-id></element-citation></ref><ref id="bib114"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rollie</surname><given-names>C</given-names></name><name><surname>Chevallereau</surname><given-names>A</given-names></name><name><surname>Watson</surname><given-names>BNJ</given-names></name><name><surname>Chyou</surname><given-names>T-Y</given-names></name><name><surname>Fradet</surname><given-names>O</given-names></name><name><surname>McLeod</surname><given-names>I</given-names></name><name><surname>Fineran</surname><given-names>PC</given-names></name><name><surname>Brown</surname><given-names>CM</given-names></name><name><surname>Gandon</surname><given-names>S</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Targeting of temperate phages drives loss of type I CRISPR-Cas systems</article-title><source>Nature</source><volume>578</volume><fpage>149</fpage><lpage>153</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-1936-2</pub-id><pub-id pub-id-type="pmid">31969710</pub-id></element-citation></ref><ref id="bib115"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rouzine</surname><given-names>IM</given-names></name><name><surname>Rozhnova</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Antigenic evolution of viruses in host populations</article-title><source>PLOS Pathogens</source><volume>14</volume><elocation-id>e1007291</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1007291</pub-id><pub-id pub-id-type="pmid">30208108</pub-id></element-citation></ref><ref id="bib116"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sachdeva</surname><given-names>V</given-names></name><name><surname>Husain</surname><given-names>K</given-names></name><name><surname>Sheng</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Murugan</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Tuning environmental timescales to evolve and maintain generalists</article-title><source>PNAS</source><volume>117</volume><fpage>12693</fpage><lpage>12699</lpage><pub-id pub-id-type="doi">10.1073/pnas.1914586117</pub-id><pub-id pub-id-type="pmid">32457160</pub-id></element-citation></ref><ref id="bib117"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santos</surname><given-names>SB</given-names></name><name><surname>Carvalho</surname><given-names>C</given-names></name><name><surname>Azeredo</surname><given-names>J</given-names></name><name><surname>Ferreira</surname><given-names>EC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Population dynamics of a Salmonella lytic phage and its host: implications of the host bacterial growth rate in modelling</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e102507</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0102507</pub-id><pub-id pub-id-type="pmid">25051248</pub-id></element-citation></ref><ref id="bib118"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schnaack</surname><given-names>OH</given-names></name><name><surname>Nourmohammad</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Optimal evolutionary decision-making to store immune memory</article-title><source>eLife</source><volume>10</volume><elocation-id>e61346</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.61346</pub-id><pub-id pub-id-type="pmid">33908347</pub-id></element-citation></ref><ref id="bib119"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shah</surname><given-names>SA</given-names></name><name><surname>Erdmann</surname><given-names>S</given-names></name><name><surname>Mojica</surname><given-names>FJM</given-names></name><name><surname>Garrett</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Protospacer recognition motifs: mixed identities and functional diversity</article-title><source>RNA Biology</source><volume>10</volume><fpage>891</fpage><lpage>899</lpage><pub-id pub-id-type="doi">10.4161/rna.23764</pub-id><pub-id pub-id-type="pmid">23403393</pub-id></element-citation></ref><ref id="bib120"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shmakov</surname><given-names>SA</given-names></name><name><surname>Sitnik</surname><given-names>V</given-names></name><name><surname>Makarova</surname><given-names>KS</given-names></name><name><surname>Wolf</surname><given-names>YI</given-names></name><name><surname>Severinov</surname><given-names>KV</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The CRISPR spacer space is dominated by sequences from species-specific mobilomes</article-title><source>MBio</source><volume>8</volume><elocation-id>e01397-17</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.01397-17</pub-id><pub-id pub-id-type="pmid">28928211</pub-id></element-citation></ref><ref id="bib121"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simek</surname><given-names>K</given-names></name><name><surname>Kasalický</surname><given-names>V</given-names></name><name><surname>Hornák</surname><given-names>K</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name><name><surname>Weinbauer</surname><given-names>MG</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Assessing niche separation among coexisting Limnohabitans strains through interactions with a competitor, viruses, and a bacterivore</article-title><source>Applied and Environmental Microbiology</source><volume>76</volume><fpage>1406</fpage><lpage>1416</lpage><pub-id pub-id-type="doi">10.1128/AEM.02517-09</pub-id><pub-id pub-id-type="pmid">20038688</pub-id></element-citation></ref><ref id="bib122"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simmons</surname><given-names>EL</given-names></name><name><surname>Drescher</surname><given-names>K</given-names></name><name><surname>Nadell</surname><given-names>CD</given-names></name><name><surname>Bucci</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Phage mobility is a core determinant of phage-bacteria coexistence in biofilms</article-title><source>The ISME Journal</source><volume>12</volume><fpage>531</fpage><lpage>543</lpage><pub-id pub-id-type="doi">10.1038/ismej.2017.190</pub-id><pub-id pub-id-type="pmid">29125597</pub-id></element-citation></ref><ref id="bib123"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skanata</surname><given-names>A</given-names></name><name><surname>Kussell</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Ecological memory preserves phage resistance mechanisms in bacteria</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>6817</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-26609-w</pub-id><pub-id pub-id-type="pmid">34819498</pub-id></element-citation></ref><ref id="bib124"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skennerton</surname><given-names>CT</given-names></name><name><surname>Imelfort</surname><given-names>M</given-names></name><name><surname>Tyson</surname><given-names>GW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Crass: identification and reconstruction of CRISPR from unassembled metagenomic data</article-title><source>Nucleic Acids Research</source><volume>41</volume><elocation-id>e105</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gkt183</pub-id><pub-id pub-id-type="pmid">23511966</pub-id></element-citation></ref><ref id="bib125"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soto-Perez</surname><given-names>P</given-names></name><name><surname>Bisanz</surname><given-names>JE</given-names></name><name><surname>Berry</surname><given-names>JD</given-names></name><name><surname>Lam</surname><given-names>KN</given-names></name><name><surname>Bondy-Denomy</surname><given-names>J</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Crispr-Cas system of a prevalent human gut bacterium reveals hyper-targeting against phages in a human virome catalog</article-title><source>Cell Host &amp; Microbe</source><volume>26</volume><fpage>325</fpage><lpage>335</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2019.08.008</pub-id><pub-id pub-id-type="pmid">31492655</pub-id></element-citation></ref><ref id="bib126"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Staals</surname><given-names>RHJ</given-names></name><name><surname>Jackson</surname><given-names>SA</given-names></name><name><surname>Biswas</surname><given-names>A</given-names></name><name><surname>Brouns</surname><given-names>SJJ</given-names></name><name><surname>Brown</surname><given-names>CM</given-names></name><name><surname>Fineran</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Interference-driven spacer acquisition is dominant over naive and primed adaptation in a native CRISPR-Cas system</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>12853</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms12853</pub-id><pub-id pub-id-type="pmid">27694798</pub-id></element-citation></ref><ref id="bib127"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sternberg</surname><given-names>SH</given-names></name><name><surname>LaFrance</surname><given-names>B</given-names></name><name><surname>Kaplan</surname><given-names>M</given-names></name><name><surname>Doudna</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Conformational control of DNA target cleavage by CRISPR-Cas9</article-title><source>Nature</source><volume>527</volume><fpage>110</fpage><lpage>113</lpage><pub-id pub-id-type="doi">10.1038/nature15544</pub-id><pub-id pub-id-type="pmid">26524520</pub-id></element-citation></ref><ref id="bib128"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sukumaran</surname><given-names>J</given-names></name><name><surname>Holder</surname><given-names>MT</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>DendroPy: a python library for phylogenetic computing</article-title><source>Bioinformatics</source><volume>26</volume><fpage>1569</fpage><lpage>1571</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq228</pub-id><pub-id pub-id-type="pmid">20421198</pub-id></element-citation></ref><ref id="bib129"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>CL</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Thomas</surname><given-names>BC</given-names></name><name><surname>Horvath</surname><given-names>P</given-names></name><name><surname>Fremaux</surname><given-names>C</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Phage mutations in response to CRISPR diversification in a bacterial population</article-title><source>Environmental Microbiology</source><volume>15</volume><fpage>463</fpage><lpage>470</lpage><pub-id pub-id-type="doi">10.1111/j.1462-2920.2012.02879.x</pub-id><pub-id pub-id-type="pmid">23057534</pub-id></element-citation></ref><ref id="bib130"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallade</surname><given-names>M</given-names></name><name><surname>Houchmandzadeh</surname><given-names>B</given-names></name><name><surname>Vallade</surname><given-names>M</given-names></name><name><surname>Analytical</surname><given-names>BH</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Analytical solution of a neutral model of biodiversity</article-title><source>Physical Review. E, Statistical, Nonlinear, and Soft Matter Physics</source><volume>68</volume><elocation-id>061902</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.68.061902</pub-id><pub-id pub-id-type="pmid">14754229</pub-id></element-citation></ref><ref id="bib131"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Houte</surname><given-names>S</given-names></name><name><surname>Ekroth</surname><given-names>AKE</given-names></name><name><surname>Broniewski</surname><given-names>JM</given-names></name><name><surname>Chabas</surname><given-names>H</given-names></name><name><surname>Ashby</surname><given-names>B</given-names></name><name><surname>Bondy-Denomy</surname><given-names>J</given-names></name><name><surname>Gandon</surname><given-names>S</given-names></name><name><surname>Boots</surname><given-names>M</given-names></name><name><surname>Paterson</surname><given-names>S</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The diversity-generating benefits of a prokaryotic adaptive immune system</article-title><source>Nature</source><volume>532</volume><fpage>385</fpage><lpage>388</lpage><pub-id pub-id-type="doi">10.1038/nature17436</pub-id><pub-id pub-id-type="pmid">27074511</pub-id></element-citation></ref><ref id="bib132"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vaningelgem</surname><given-names>F</given-names></name><name><surname>Zamfir</surname><given-names>M</given-names></name><name><surname>Adriany</surname><given-names>T</given-names></name><name><surname>De Vuyst</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Fermentation conditions affecting the bacterial growth and exopolysaccharide production by Streptococcus thermophilus ST 111 in milk-based medium</article-title><source>Journal of Applied Microbiology</source><volume>97</volume><fpage>1257</fpage><lpage>1273</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2672.2004.02418.x</pub-id><pub-id pub-id-type="pmid">15546417</pub-id></element-citation></ref><ref id="bib133"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Van Kampen</surname><given-names>NG</given-names></name></person-group><year iso-8601-date="1981">1981</year><source>Stochastic Processes in Physics and Chemistry</source><publisher-name>Elsevier</publisher-name><pub-id pub-id-type="doi">10.1016/B978-0-444-52965-7.X5000-4</pub-id></element-citation></ref><ref id="bib134"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voigt</surname><given-names>E</given-names></name><name><surname>Rall</surname><given-names>BC</given-names></name><name><surname>Chatzinotas</surname><given-names>A</given-names></name><name><surname>Brose</surname><given-names>U</given-names></name><name><surname>Rosenbaum</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Phage strategies facilitate bacterial coexistence under environmental variability</article-title><source>PeerJ</source><volume>9</volume><elocation-id>e12194</elocation-id><pub-id pub-id-type="doi">10.7717/peerj.12194</pub-id><pub-id pub-id-type="pmid">34760346</pub-id></element-citation></ref><ref id="bib135"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Volkov</surname><given-names>I</given-names></name><name><surname>Banavar</surname><given-names>JR</given-names></name><name><surname>Hubbell</surname><given-names>SP</given-names></name><name><surname>Maritan</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Neutral theory and relative species abundance in ecology</article-title><source>Nature</source><volume>424</volume><fpage>1035</fpage><lpage>1037</lpage><pub-id pub-id-type="doi">10.1038/nature01883</pub-id><pub-id pub-id-type="pmid">12944964</pub-id></element-citation></ref><ref id="bib136"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Mata-Fink</surname><given-names>J</given-names></name><name><surname>Kriegsman</surname><given-names>B</given-names></name><name><surname>Hanson</surname><given-names>M</given-names></name><name><surname>Irvine</surname><given-names>DJ</given-names></name><name><surname>Eisen</surname><given-names>HN</given-names></name><name><surname>Burton</surname><given-names>DR</given-names></name><name><surname>Wittrup</surname><given-names>KD</given-names></name><name><surname>Kardar</surname><given-names>M</given-names></name><name><surname>Chakraborty</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Manipulating the selection forces during affinity maturation to generate cross-reactive HIV antibodies</article-title><source>Cell</source><volume>160</volume><fpage>785</fpage><lpage>797</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.01.027</pub-id><pub-id pub-id-type="pmid">25662010</pub-id></element-citation></ref><ref id="bib137"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watson</surname><given-names>BNJ</given-names></name><name><surname>Easingwood</surname><given-names>RA</given-names></name><name><surname>Tong</surname><given-names>B</given-names></name><name><surname>Wolf</surname><given-names>M</given-names></name><name><surname>Salmond</surname><given-names>GPC</given-names></name><name><surname>Staals</surname><given-names>RHJ</given-names></name><name><surname>Bostina</surname><given-names>M</given-names></name><name><surname>Fineran</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Different genetic and morphological outcomes for phages targeted by single or multiple CRISPR-cas spacers</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>374</volume><elocation-id>20180090</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2018.0090</pub-id><pub-id pub-id-type="pmid">30905290</pub-id></element-citation></ref><ref id="bib138"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>Y</given-names></name><name><surname>Kirby</surname><given-names>A</given-names></name><name><surname>Levin</surname><given-names>BR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The population and evolutionary dynamics of <italic>Vibrio cholerae</italic> and its bacteriophage: conditions for maintaining phage-limited communities</article-title><source>The American Naturalist</source><volume>178</volume><fpage>715</fpage><lpage>725</lpage><pub-id pub-id-type="doi">10.1086/662677</pub-id><pub-id pub-id-type="pmid">22089867</pub-id></element-citation></ref><ref id="bib139"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinberger</surname><given-names>AD</given-names></name><name><surname>Sun</surname><given-names>CL</given-names></name><name><surname>Pluciński</surname><given-names>MM</given-names></name><name><surname>Denef</surname><given-names>VJ</given-names></name><name><surname>Thomas</surname><given-names>BC</given-names></name><name><surname>Horvath</surname><given-names>P</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Gilmore</surname><given-names>MS</given-names></name><name><surname>Getz</surname><given-names>WM</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2012">2012a</year><article-title>Persisting viral sequences shape microbial CRISPR-based immunity</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002475</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002475</pub-id><pub-id pub-id-type="pmid">22532794</pub-id></element-citation></ref><ref id="bib140"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinberger</surname><given-names>AD</given-names></name><name><surname>Wolf</surname><given-names>YI</given-names></name><name><surname>Lobkovsky</surname><given-names>AE</given-names></name><name><surname>Gilmore</surname><given-names>MS</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name></person-group><year iso-8601-date="2012">2012b</year><article-title>Viral diversity threshold for adaptive immunity in prokaryotes</article-title><source>MBio</source><volume>3</volume><elocation-id>e00456</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.00456-12</pub-id><pub-id pub-id-type="pmid">23221803</pub-id></element-citation></ref><ref id="bib141"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weissman</surname><given-names>JL</given-names></name><name><surname>Holmes</surname><given-names>R</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Moineau</surname><given-names>S</given-names></name><name><surname>Fagan</surname><given-names>WF</given-names></name><name><surname>Levin</surname><given-names>B</given-names></name><name><surname>Johnson</surname><given-names>PLF</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Immune loss as a driver of coexistence during host-phage coevolution</article-title><source>The ISME Journal</source><volume>12</volume><fpage>585</fpage><lpage>597</lpage><pub-id pub-id-type="doi">10.1038/ismej.2017.194</pub-id><pub-id pub-id-type="pmid">29328063</pub-id></element-citation></ref><ref id="bib142"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weissman</surname><given-names>JL</given-names></name><name><surname>Stoltzfus</surname><given-names>A</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name><name><surname>Johnson</surname><given-names>PLF</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Avoidance of self during CRISPR immunization</article-title><source>Trends in Microbiology</source><volume>28</volume><fpage>543</fpage><lpage>553</lpage><pub-id pub-id-type="doi">10.1016/j.tim.2020.02.005</pub-id><pub-id pub-id-type="pmid">32544441</pub-id></element-citation></ref><ref id="bib143"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weissman</surname><given-names>JL</given-names></name><name><surname>Alseth</surname><given-names>EO</given-names></name><name><surname>Meaden</surname><given-names>S</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name><name><surname>Fuhrman</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Immune lag is a major cost of prokaryotic adaptive immunity during viral outbreaks</article-title><source>Proceedings of the Royal Society B. Biological Sciences</source><volume>288</volume><fpage>20211555</fpage><pub-id pub-id-type="doi">10.1098/rspb.2021.1555</pub-id><pub-id pub-id-type="pmid">34666523</pub-id></element-citation></ref><ref id="bib144"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weitz</surname><given-names>JS</given-names></name><name><surname>Poisot</surname><given-names>T</given-names></name><name><surname>Meyer</surname><given-names>JR</given-names></name><name><surname>Flores</surname><given-names>CO</given-names></name><name><surname>Valverde</surname><given-names>S</given-names></name><name><surname>Sullivan</surname><given-names>MB</given-names></name><name><surname>Hochberg</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Phage-bacteria infection networks</article-title><source>Trends in Microbiology</source><volume>21</volume><fpage>82</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1016/j.tim.2012.11.003</pub-id><pub-id pub-id-type="pmid">23245704</pub-id></element-citation></ref><ref id="bib145"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Westra</surname><given-names>ER</given-names></name><name><surname>van Houte</surname><given-names>S</given-names></name><name><surname>Oyesiku-Blakemore</surname><given-names>S</given-names></name><name><surname>Makin</surname><given-names>B</given-names></name><name><surname>Broniewski</surname><given-names>JM</given-names></name><name><surname>Best</surname><given-names>A</given-names></name><name><surname>Bondy-Denomy</surname><given-names>J</given-names></name><name><surname>Davidson</surname><given-names>A</given-names></name><name><surname>Boots</surname><given-names>M</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Parasite exposure drives selective evolution of constitutive versus inducible defense</article-title><source>Current Biology</source><volume>25</volume><fpage>1043</fpage><lpage>1049</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2015.01.065</pub-id><pub-id pub-id-type="pmid">25772450</pub-id></element-citation></ref><ref id="bib146"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolda</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Similarity indices, sample size and diversity</article-title><source>Oecologia</source><volume>50</volume><fpage>296</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1007/BF00344966</pub-id><pub-id pub-id-type="pmid">28309044</pub-id></element-citation></ref><ref id="bib147"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>L</given-names></name><name><surname>Neher</surname><given-names>RA</given-names></name><name><surname>Shraiman</surname><given-names>BI</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Phylodynamic theory of persistence, extinction and speciation of rapidly adapting pathogens</article-title><source>eLife</source><volume>8</volume><elocation-id>e44205</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.44205</pub-id><pub-id pub-id-type="pmid">30854307</pub-id></element-citation></ref><ref id="bib148"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zoephel</surname><given-names>J</given-names></name><name><surname>Randau</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Rna-Seq analyses reveal CRISPR RNA processing and regulation patterns</article-title><source>Biochemical Society Transactions</source><volume>41</volume><fpage>1459</fpage><lpage>1463</lpage><pub-id pub-id-type="doi">10.1042/BST20130129</pub-id><pub-id pub-id-type="pmid">24256237</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Relationship of average immunity to Morisita–Horn index</title><p>This appendix is presented to contextualize our work with the broader language of diversity in ecology.</p><p>In certain limits, average immunity can be related to the Morisita–Horn similarity index <inline-formula><mml:math id="inf1160"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib146">Wolda, 1981</xref>; <xref ref-type="bibr" rid="bib24">Childs et al., 2012</xref>), where instead of comparing two populations from different timepoints or different regions, we are comparing bacteria and phage populations scaled by the immune benefit of CRISPR. If we assume that a matching spacer provides perfect immunity (<inline-formula><mml:math id="inf1161"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and there is no cross-reactivity, then <inline-formula><mml:math id="inf1162"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and average immunity is given by<disp-formula id="equ96"><label>(93)</label><mml:math id="m96"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This is the Morisita overlap index between bacteria and phage without the factor of <inline-formula><mml:math id="inf1163"><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>, where <inline-formula><mml:math id="inf1164"><mml:msub><mml:mi>D</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1165"><mml:msub><mml:mi>D</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> are the Simpson’s diversity indices for bacteria with spacers and phages, respectively. In the limit that all phage and bacteria clones are equal sizes (<inline-formula><mml:math id="inf1166"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1167"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>), the factor <inline-formula><mml:math id="inf1168"><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, so we have <inline-formula><mml:math id="inf1169"><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We found in most simulations that effective <inline-formula><mml:math id="inf1170"><mml:mrow><mml:mi>e</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, which implies that the Morisita overlap between bacteria and phage is constant across all parameters we study. A constant Morisita overlap implies that the population diversity evolves to attain the highest possible overlap. The full average immunity includes pairwise comparisons between all species and may be quite different from the Morisita overlap index.</p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s9"><title>A neutral model of non-coevolving bacteria</title><p>This section provides the mathematical background for the statement that neutral diversity depends linearly on mutation rate made in ‘Phages drive stable emergent sequence diversity’.</p><p>In our results for the diversity in a coevolving population of bacteria and phage, we find that diversity approximately scales like <inline-formula><mml:math id="inf1171"><mml:mrow><mml:mi>m</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>η</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> (Approximation for <inline-formula><mml:math id="inf1172"><mml:mi>m</mml:mi></mml:math></inline-formula>). Intuitively this dependence seems quite weak, but we would like to know what to compare this to: what is the expectation for diversity in a population with mutations but without coevolution? An appropriate comparison point is a neutral model of a bacterial population that grows and dies; the birth and death rates are exactly matched to give a constant size at steady state. We also include the possibility of mutations: a bacterium may mutate to a new type with probability <inline-formula><mml:math id="inf1173"><mml:mi>μ</mml:mi></mml:math></inline-formula> per division, and we assume that each mutation is to a new, never-before-seen type (infinite alleles model).</p><p>Let us consider a population of bacteria that divides with rate <inline-formula><mml:math id="inf1174"><mml:mi>g</mml:mi></mml:math></inline-formula>, dies with rate <inline-formula><mml:math id="inf1175"><mml:mi>F</mml:mi></mml:math></inline-formula>, and mutates with rate <inline-formula><mml:math id="inf1176"><mml:mi>μ</mml:mi></mml:math></inline-formula>. We can write a master equation for the number of bacterial clones of size <inline-formula><mml:math id="inf1177"><mml:mi>k</mml:mi></mml:math></inline-formula>. New mutants enter at clone size 1, and we assume that the total population size is constant at <inline-formula><mml:math id="inf1178"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Mutations effectively lower the growth rate of a particular clone.<disp-formula id="equ97"><label>(94)</label><mml:math id="m97"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec sec-type="appendix" id="s10"><title>Generating function solution</title><p>The generating function for the probability distribution <inline-formula><mml:math id="inf1179"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="inf1180"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Let us replace the birth and death rates by <inline-formula><mml:math id="inf1181"><mml:mi>β</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1182"><mml:mi>δ</mml:mi></mml:math></inline-formula>, respectively. <inline-formula><mml:math id="inf1183"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1184"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:math></inline-formula>. Multiplying <xref ref-type="disp-formula" rid="equ97">Equation 94</xref> with <inline-formula><mml:math id="inf1185"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and noting that <inline-formula><mml:math id="inf1186"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo>∂</mml:mo><mml:mi>z</mml:mi></mml:msub><mml:mo>⁡</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, we get the following differential equation:<disp-formula id="equ98"><label>(95)</label><mml:math id="m98"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The term <inline-formula><mml:math id="inf1187"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> comes from the source term with <inline-formula><mml:math id="inf1188"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p><xref ref-type="disp-formula" rid="equ98">Equation 95</xref> can be solved with the method of characteristics (<xref ref-type="bibr" rid="bib133">Van Kampen, 1981</xref>). We parameterize the function <inline-formula><mml:math id="inf1189"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with a new variable <inline-formula><mml:math id="inf1190"><mml:mi>s</mml:mi></mml:math></inline-formula>. Applying the chain rule:<disp-formula id="equ99"><label>(96)</label><mml:math id="m99"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>And by comparison with <xref ref-type="disp-formula" rid="equ98">Equation 95</xref>, the characteristic equations are<disp-formula id="equ100"><label>(97)</label><mml:math id="m100"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ101"><label>(98)</label><mml:math id="m101"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ102"><label>(99)</label><mml:math id="m102"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>From <xref ref-type="disp-formula" rid="equ100">Equation 97</xref> we see <inline-formula><mml:math id="inf1191"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, so we can choose <inline-formula><mml:math id="inf1192"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and replace <inline-formula><mml:math id="inf1193"><mml:mi>s</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf1194"><mml:mi>t</mml:mi></mml:math></inline-formula> going forward.</p><p>Solving the characteristic equation for <inline-formula><mml:math id="inf1195"><mml:mi>z</mml:mi></mml:math></inline-formula> by integrating both sides gives <xref ref-type="disp-formula" rid="equ103">Equation 100</xref>.<disp-formula id="equ103"><label>(100)</label><mml:math id="m103"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>At <inline-formula><mml:math id="inf1196"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1197"><mml:mi>z</mml:mi></mml:math></inline-formula> will pass through some point <italic>z</italic><sub>0</sub>, so we have the initial condition <inline-formula><mml:math id="inf1198"><mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. With <italic>z</italic><sub>0</sub> in <xref ref-type="disp-formula" rid="equ103">Equation 100</xref> at <inline-formula><mml:math id="inf1199"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we get <xref ref-type="disp-formula" rid="equ104">Equation 101</xref>, where <inline-formula><mml:math id="inf1200"><mml:mi>C</mml:mi></mml:math></inline-formula> is given by <xref ref-type="disp-formula" rid="equ103">Equation 100</xref>.<disp-formula id="equ104"><label>(101)</label><mml:math id="m104"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>C</mml:mi><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The variation of <inline-formula><mml:math id="inf1201"><mml:mi>G</mml:mi></mml:math></inline-formula> along this <inline-formula><mml:math id="inf1202"><mml:mi>z</mml:mi></mml:math></inline-formula>-<inline-formula><mml:math id="inf1203"><mml:mi>t</mml:mi></mml:math></inline-formula> curve is given by<disp-formula id="equ105"><label>(102)</label><mml:math id="m105"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which has the solution<disp-formula id="equ106"><label>(103)</label><mml:math id="m106"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>β</mml:mi></mml:mfrac><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The constant <inline-formula><mml:math id="inf1204"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> is a function of the characteristic <inline-formula><mml:math id="inf1205"><mml:mi>z</mml:mi></mml:math></inline-formula>-<inline-formula><mml:math id="inf1206"><mml:mi>t</mml:mi></mml:math></inline-formula> curve (<xref ref-type="disp-formula" rid="equ103">Equation 100</xref>). To find the particular form of <inline-formula><mml:math id="inf1207"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we apply the initial condition <inline-formula><mml:math id="inf1208"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula>, meaning we start with one clone of size <inline-formula><mml:math id="inf1209"><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> at <inline-formula><mml:math id="inf1210"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ107"><label>(104)</label><mml:math id="m107"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>β</mml:mi></mml:mfrac><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Let us use the temporary variable <inline-formula><mml:math id="inf1211"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Then <inline-formula><mml:math id="inf1212"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, and the solution for <inline-formula><mml:math id="inf1213"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is<disp-formula id="equ108"><label>(105)</label><mml:math id="m108"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mfrac><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>β</mml:mi></mml:mfrac><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mfrac><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now we can write the full solution for <inline-formula><mml:math id="inf1214"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, replacing <inline-formula><mml:math id="inf1215"><mml:mi>ξ</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf1216"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf1217"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ109"><label>(106)</label><mml:math id="m109"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>ϵ</mml:mi><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>ϵ</mml:mi><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>β</mml:mi></mml:mfrac><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>ϵ</mml:mi><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>ϵ</mml:mi><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>β</mml:mi></mml:mfrac><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mfrac><mml:mrow><mml:mi>ϵ</mml:mi><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>ϵ</mml:mi><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><italic>b</italic><sub><italic>k</italic></sub> can be found by Taylor-expanding <inline-formula><mml:math id="inf1218"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> about <inline-formula><mml:math id="inf1219"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. The full distribution is cumbersome for this initial condition, but the limit as <inline-formula><mml:math id="inf1220"><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>, if <inline-formula><mml:math id="inf1221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, is independent of the initial condition:<disp-formula id="equ110"><label>(107)</label><mml:math id="m110"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:mfrac><mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now we have required constant <inline-formula><mml:math id="inf1222"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which means<disp-formula id="equ111"><label>(108)</label><mml:math id="m111"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>D</mml:mi><mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>μ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>So to maintain constant population size, <inline-formula><mml:math id="inf1223"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula>, as expected. The diversity is the total number of clones, defined as <inline-formula><mml:math id="inf1224"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. We represent diversity as <inline-formula><mml:math id="inf1225"><mml:mi>m</mml:mi></mml:math></inline-formula>.</p><p>This gives the following result for steady-state diversity:<disp-formula id="equ112"><label>(109)</label><mml:math id="m112"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>β</mml:mi></mml:mfrac><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mi>δ</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>μ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mfrac><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>μ</mml:mi><mml:mi>g</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In our definition of the birth and death rates, it is implied that <inline-formula><mml:math id="inf1226"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and under that condition, the diversity is positive. If we let <inline-formula><mml:math id="inf1227"><mml:mrow><mml:mfrac><mml:mi>μ</mml:mi><mml:mi>g</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:math></inline-formula>, we can write the diversity as<disp-formula id="equ113"><label>(110)</label><mml:math id="m113"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mfrac><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>u</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For small <inline-formula><mml:math id="inf1228"><mml:mi>u</mml:mi></mml:math></inline-formula> (i.e. mutation rate much smaller than division rate, usually true), <inline-formula><mml:math id="inf1229"><mml:mrow><mml:mi>m</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ110">Equation 107</xref> is equivalent to Fisher’s logseries with <inline-formula><mml:math id="inf1230"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>β</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1231"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mi>δ</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. This is also equivalent to Hubbell’s unified neutral theory in the limit of large sample size. This result for diversity (<xref ref-type="disp-formula" rid="equ113">Equation 110</xref>) is also approximately equivalent to the result obtained in <xref ref-type="bibr" rid="bib130">Vallade et al., 2003</xref> and also in <xref ref-type="bibr" rid="bib60">He and Hu, 2005</xref> when the mutation rate is within a few orders of magnitude of <inline-formula><mml:math id="inf1232"><mml:mi>g</mml:mi></mml:math></inline-formula>.</p></sec><sec sec-type="appendix" id="s11"><title>Comparison to coevolution model</title><p>In our bacteria-phage coevolution model, we find that diversity scales approximately like <inline-formula><mml:math id="inf1233"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:math></inline-formula>, where<disp-formula id="equ114"><label>(111)</label><mml:math id="m114"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>e</mml:mi><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mfrac><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For <inline-formula><mml:math id="inf1234"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mo>&lt;&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf1235"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>&gt;&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf1236"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, the dependence of diversity on <inline-formula><mml:math id="inf1237"><mml:mi>a</mml:mi></mml:math></inline-formula> is given by <xref ref-type="disp-formula" rid="equ115">Equation 112</xref>. Note that this expression correctly captures the fold change in diversity as a function of parameters, but the value itself is off by about a factor of 10.<disp-formula id="equ115"><label>(112)</label><mml:math id="m115"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>e</mml:mi><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mover><mml:mi>η</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Is this dependence quite different from what we get under neutral evolution without coevolution? Since we are measuring bacterial diversity in the coevolution model, the spacer acquisition probability <inline-formula><mml:math id="inf1238"><mml:mi>η</mml:mi></mml:math></inline-formula> is a good analog to bacterial mutation rate in the non-coevolving model. Let us look at the change in diversity for a given change in spacer acquisition probability.</p><p>In the coevolution model, a <inline-formula><mml:math id="inf1239"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> change in spacer acquisition probability gives approximately a <inline-formula><mml:math id="inf1240"><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> change in diversity, while under the non-coevolution model, a <inline-formula><mml:math id="inf1241"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> change in mutation rate <inline-formula><mml:math id="inf1242"><mml:mi>u</mml:mi></mml:math></inline-formula> gives a <inline-formula><mml:math id="inf1243"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> change in diversity. For small <inline-formula><mml:math id="inf1244"><mml:mi>u</mml:mi></mml:math></inline-formula>, this is approximately <inline-formula><mml:math id="inf1245"><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The change is dependent on the mutation rate, but if <inline-formula><mml:math id="inf1246"><mml:mi>k</mml:mi></mml:math></inline-formula> is not very large and <inline-formula><mml:math id="inf1247"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&lt;&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, then a <inline-formula><mml:math id="inf1248"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> change in <inline-formula><mml:math id="inf1249"><mml:mi>u</mml:mi></mml:math></inline-formula> gives approximately a <inline-formula><mml:math id="inf1250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> change in diversity. A similar correspondence can be reached with a different approximation. If <inline-formula><mml:math id="inf1251"><mml:mi>a</mml:mi></mml:math></inline-formula> is large, the leading order contribution to <inline-formula><mml:math id="inf1252"><mml:mi>m</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf1253"><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, but a better approximation is given by <xref ref-type="disp-formula" rid="equ116">Equation 113</xref>.<disp-formula id="equ116"><label>(113)</label><mml:math id="m116"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf1254"><mml:mi>a</mml:mi></mml:math></inline-formula> is large, which it typically is, then the leading term is more accurately <inline-formula><mml:math id="inf1255"><mml:msup><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>. This is directly comparable to the <inline-formula><mml:math id="inf1256"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> dependence of the non-coevolving model: diversity in the coevolution model goes like <inline-formula><mml:math id="inf1257"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and in the non-coevolving model it goes like <inline-formula><mml:math id="inf1258"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Either way, there’s a 1/3 power in the coevolution model that isn’t there in the simple model.</p><p><xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref> compares the predicted diversity and fold change in diversity in each model under the simple approximation assumptions here. Diversity increases more rapidly with mutation rate in the simple model than in the coevolution model.</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Diversity vs. <inline-formula><mml:math id="inf1259"><mml:mi>η</mml:mi></mml:math></inline-formula> (left), <inline-formula><mml:math id="inf1260"><mml:mi>μ</mml:mi></mml:math></inline-formula> (centre), and <inline-formula><mml:math id="inf1261"><mml:mi>e</mml:mi></mml:math></inline-formula> (right) for <inline-formula><mml:math id="inf1262"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>.</title><p>The <inline-formula><mml:math id="inf1263"><mml:mi>η</mml:mi></mml:math></inline-formula> dependence of diversity is not very well predicted even by the full numerical solution, but for mutation rate and spacer effectiveness the approximate solutions do pretty well in this regime. The simulation data increase in diversity as a function of spacer acquisition probability actually goes more like <inline-formula><mml:math id="inf1264"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∝</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app2-fig1-v2.tif"/></fig><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Approximate predictions for diversity in our coevolution model (blue) or a simple model with mutation but no coevolution (orange).</title><p>(<bold>A</bold>) Predicted diversity as a function of spacer acquisition probability in our coevolution model as given by <xref ref-type="disp-formula" rid="equ114">Equation 111</xref> for <inline-formula><mml:math id="inf1265"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1266"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1267"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (blue). Predicted diversity in the non-coevolving model as given by <inline-formula><mml:math id="inf1268"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf1269"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> (orange). The low-<inline-formula><mml:math id="inf1270"><mml:mi>μ</mml:mi></mml:math></inline-formula> limit is <inline-formula><mml:math id="inf1271"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The high-<inline-formula><mml:math id="inf1272"><mml:mi>μ</mml:mi></mml:math></inline-formula> limit is a series expansion in <inline-formula><mml:math id="inf1273"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="inf1274"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> giving <inline-formula><mml:math id="inf1275"><mml:mrow><mml:mi>m</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>5</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mn>6</mml:mn></mml:mfrac></mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mn>6</mml:mn></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) Fold change in diversity as a function of fold change in mutation rate or spacer acquisition probability under the simple approximation that <inline-formula><mml:math id="inf1276"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (blue) and <inline-formula><mml:math id="inf1277"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∼</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:math></inline-formula> (orange).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app2-fig2-v2.tif"/></fig><fig id="app2fig3" position="float"><label>Appendix 2—figure 3.</label><caption><title>Fold change in diversity (number of species) as a function of mutation rate and <inline-formula><mml:math id="inf1278"><mml:mi>k</mml:mi></mml:math></inline-formula>, the fold change in mutation rate.</title><p>(<bold>A</bold>) Fold change in diversity as a function of fold change in mutation rate in the coevolution model: diversity increases by approximately a factor of <inline-formula><mml:math id="inf1279"><mml:msup><mml:mi>k</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:msup></mml:math></inline-formula>, independent of mutation rate (solid line). (<bold>B</bold>) Fold change in diversity as a function of both mutation rate and fold change in mutation rate in the model without coevolution.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app2-fig3-v2.tif"/></fig></sec></app><app id="appendix-3"><title>Appendix 3</title><sec sec-type="appendix" id="s12"><title>Stochastic clone dynamics</title><p>In this appendix, we calculate clone size distributions for bacteria, the probability of extinction/establishment for phage clones, and the mean time to extinction for bacteria and phage clones. These results underlie our result for diversity; in particular the phage establishment probability is a core component of our calculation of diversity in ‘Phages drive stable emergent sequence diversity’. Phage establishment is also covered in ‘What determines the fitness and establishment of new mutants?’.</p><p>In this section we define <inline-formula><mml:math id="inf1280"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as given by <xref ref-type="disp-formula" rid="equ18">Equation 18</xref>.</p></sec><sec sec-type="appendix" id="s13"><title>Clone fitness</title><p>Here we use mean-field expressions for phage and bacteria clone size from ‘Single-clone mean-field dynamics to calculate the fitness of new phage mutants’. These results are used in ‘Measuring diversity to justify our assumptions about the timescale of spacer acquisition relative to phage establishment.</p><p>We investigated the fitness of new phage mutants to understand the effect of bacterial spacer acquisition on phage mutant growth. We define the fitness of phage clones to be their per-capita average growth rate: their average growth rate in bacterial generations divided by their average size. We calculate the fitness from simulation data by calculating the mean phage clone size conditioned on survival (as in <xref ref-type="fig" rid="fig10">Figure 10</xref>, ‘Single-clone mean-field dynamics’), then taking the time derivative, then dividing by the mean phage clone size. (In principle, this is equivalent to first taking the time derivative of each individual clone trajectory and then averaging across all trajectories, but we found that edge effects from trajectories that go extinct skewed the result, so we first average across all trajectories before taking a derivative.) Phage clone fitness over time in a single simulation is plotted in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> (orange markers).</p><p>We calculate the theoretical phage clone fitness by taking the time derivative of the predicted mean phage clone size and dividing by the predicted mean clone size. The predicted mean phage clone size is piecewise-defined at short times as the numerical solution of the system of <xref ref-type="disp-formula" rid="equ22 equ23">Equations 21 and 22</xref>, and at long times as the numerical solution steady-state clone size (<xref ref-type="disp-formula" rid="equ27">Equation 26</xref>). This prediction is plotted as a solid black line in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>.</p><p>New phage mutants have a positive growth rate on average (initial fitness &gt;0), and their growth rate drops to zero on average as bacteria acquire matching spacers and gain immunity to new mutants. We can define the time or size at which phage clones become ‘established’, after which they are safe from rapid stochastic extinction and behave like neutral clones (having a fitness that is close to 0). We define one minus the long-time limit of the probability of phage clone extinction (<xref ref-type="disp-formula" rid="equ174">Equation 159</xref>) as the probability of establishment for new phage clones:<disp-formula id="equ117"><label>(114)</label><mml:math id="m117"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1281"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the average initial growth rate of phage clones and <inline-formula><mml:math id="inf1282"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the average initial death rate of phage clones (more in ‘Phage clone probability of extinction’). The establishment clone size can then be defined as the value of <inline-formula><mml:math id="inf1283"><mml:msub><mml:mi>N</mml:mi><mml:mtext>est</mml:mtext></mml:msub></mml:math></inline-formula> for which <inline-formula><mml:math id="inf1284"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>est</mml:mtext></mml:msub><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Since <inline-formula><mml:math id="inf1285"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is not necessarily small, we approximate <inline-formula><mml:math id="inf1286"><mml:msub><mml:mi>P</mml:mi><mml:mtext>est</mml:mtext></mml:msub></mml:math></inline-formula> as an exponential function and set <inline-formula><mml:math id="inf1287"><mml:msub><mml:mi>N</mml:mi><mml:mtext>est</mml:mtext></mml:msub></mml:math></inline-formula> as the scale of the exponent:<disp-formula id="equ118"><mml:math id="m118"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ119"><label>(115)</label><mml:math id="m119"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ119">Equation 115</xref> is the size at which phage clones become established on average (where <inline-formula><mml:math id="inf1288"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>). This is plotted as a horizontal dashed line for one simulation in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>. If <inline-formula><mml:math id="inf1289"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (birth-death with no bursts and positive selection), then <inline-formula><mml:math id="inf1290"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>est</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This is the expected result for a simple birth-death process with selection as given in <xref ref-type="bibr" rid="bib33">Desai and Fisher, 2007</xref>.</p><p>We can also find the time at which phage clones reach the establishment size. In the absence of matching bacterial spacers, new phage mutants grow deterministically as <inline-formula><mml:math id="inf1291"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. We condition on survival by dividing by the probability of establishment; for this calculation we use the long-time probability of establishment given by <xref ref-type="disp-formula" rid="equ171">Equation 156</xref> with <inline-formula><mml:math id="inf1292"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1293"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. This curve does not match the measured growth at short times, but in the region of phages reaching their establishment size it agrees well (solid pink line in <xref ref-type="fig" rid="fig10">Figure 10</xref>).</p><p>With these assumptions, the growth curve for phage clones is<disp-formula id="equ120"><label>(116)</label><mml:math id="m120"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Replacing <inline-formula><mml:math id="inf1294"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> with the establishment clone size (115) and solving for <inline-formula><mml:math id="inf1295"><mml:mi>t</mml:mi></mml:math></inline-formula>, we find<disp-formula id="equ121"><label>(117)</label><mml:math id="m121"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now <inline-formula><mml:math id="inf1296"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, so the second logarithm can be approximated as <inline-formula><mml:math id="inf1297"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ122"><label>(118)</label><mml:math id="m122"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can further approximate by dropping the second term entirely since <inline-formula><mml:math id="inf1298"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mn>2</mml:mn><mml:mo>&gt;&gt;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.<disp-formula id="equ123"><label>(119)</label><mml:math id="m123"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We get the same approximate value of <inline-formula><mml:math id="inf1299"><mml:msub><mml:mi>t</mml:mi><mml:mtext>est</mml:mtext></mml:msub></mml:math></inline-formula> if we take <inline-formula><mml:math id="inf1300"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> directly and assume <inline-formula><mml:math id="inf1301"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ123">Equation 119</xref> is also numerically close to the mean establishment time calculated by Desai and Fisher for positive selection, <inline-formula><mml:math id="inf1302"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>est</mml:mtext></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> (where <inline-formula><mml:math id="inf1303"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.577216</mml:mn></mml:mrow></mml:math></inline-formula>) <xref ref-type="bibr" rid="bib33">Desai and Fisher, 2007</xref>. This implies that the presence of a burst size <inline-formula><mml:math id="inf1304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> does not dramatically change the dependence of the time to establishment on phage fitness. The phage growth rate <italic>s</italic><sub>0</sub> does still depend on <inline-formula><mml:math id="inf1305"><mml:mi>B</mml:mi></mml:math></inline-formula>, however. (Note that Desai and Fisher define establishment time differently than we do, so our cases are not directly comparable.) <xref ref-type="disp-formula" rid="equ123">Equation 119</xref> is plotted as a vertical dashed line in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>.</p><p>The initial fitness <italic>f</italic><sub>0</sub> of a new phage mutant can be computed analytically by using a different early-time approximation for <inline-formula><mml:math id="inf1306"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, this time conditioning on survival using the short-time approximation for <inline-formula><mml:math id="inf1307"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> given by <xref ref-type="disp-formula" rid="equ178">Equation 163</xref>.<disp-formula id="equ124"><label>(120)</label><mml:math id="m124"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>To estimate the initial fitness, we differentiate 120 with respect to <inline-formula><mml:math id="inf1308"><mml:mi>t</mml:mi></mml:math></inline-formula>, divide by <inline-formula><mml:math id="inf1309"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to get the per-capita growth rate, and evaluate at <inline-formula><mml:math id="inf1310"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ125"><label>(121)</label><mml:math id="m125"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Interestingly, if we had not conditioned on survival, the initial per-capita growth rate would simply be <italic>s</italic><sub>0</sub>: conditioning on survival increases the apparent growth rate of phage clones by effectively ignoring their death rate.</p><p>We can evaluate <inline-formula><mml:math id="inf1311"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in terms of our original parameters for insight. We replace <inline-formula><mml:math id="inf1312"><mml:mi>B</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf1313"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to capture the decrease in phage growth clone growth due to mutations away from a clone.<disp-formula id="equ126"><label>(122)</label><mml:math id="m126"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The initial fitness does not directly depend on characteristics of CRISPR immunity such as <inline-formula><mml:math id="inf1314"><mml:mi>η</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1315"><mml:mi>e</mml:mi></mml:math></inline-formula> because new phage mutants see the bacterial population as if it did not have any CRISPR immunity; <italic>f</italic><sub>0</sub> depends only on the total bacterial population size (<xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>).</p><fig id="app3fig1" position="float"><label>Appendix 3—figure 1.</label><caption><title>Phage clone initial growth rate vs. total bacteria normalized by the initial nutrient concentration <italic>C</italic><sub>0</sub>.</title><p>Phage clone growth rate is as defined in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>; for each simulation, the average phage clone growth rate is the derivative of the average phage clone size, averaged across all trajectories after steady state; plotted points and error bars are the average across three or more simulations. The phage initial fitness depends slightly on the phage mutation rate (mutants decrease the growth rate of a particular phage clone), but this dependence is slight enough that all mutation rates collapse onto the theoretical line. Here we plot data with <inline-formula><mml:math id="inf1316"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The phage clone initial growth rate also does not depend on <inline-formula><mml:math id="inf1317"><mml:mi>e</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf1318"><mml:mi>η</mml:mi></mml:math></inline-formula> because new phage mutants see the bacteria population as if it did not have any CRISPR immunity. The theoretical initial phage clone growth rate is given by <xref ref-type="disp-formula" rid="equ126">Equation 122</xref>. The effective lower bound of <inline-formula><mml:math id="inf1319"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is set by the steady-state population size without CRISPR immunity: <inline-formula><mml:math id="inf1320"><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig1-v2.tif"/></fig></sec><sec sec-type="appendix" id="s14"><title>Bacteria clone dynamics</title><p>In this section, we calculate clone size distributions for bacteria and the time to extinction for bacterial clones. Clone size distributions from simulations are shown in <xref ref-type="fig" rid="fig2">Figure 2A</xref>.</p><p>To solve for the dynamics of individual bacteria clones, we write a one-dimensional master equation just for <inline-formula><mml:math id="inf1321"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ127">Equation 123</xref>).<disp-formula id="equ127"><label>(123)</label><mml:math id="m127"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>α</mml:mi><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>α</mml:mi><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For brevity we write <inline-formula><mml:math id="inf1322"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, the probability of having <inline-formula><mml:math id="inf1323"><mml:mi>n</mml:mi></mml:math></inline-formula> bacteria of type <inline-formula><mml:math id="inf1324"><mml:mi>i</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf1325"><mml:mi>t</mml:mi></mml:math></inline-formula> given <italic>N</italic><sub>0</sub> bacteria of type <inline-formula><mml:math id="inf1326"><mml:mi>i</mml:mi></mml:math></inline-formula> at <inline-formula><mml:math id="inf1327"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>Bacteria clone growth (<inline-formula><mml:math id="inf1328"><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula>), phage predation (<inline-formula><mml:math id="inf1329"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), outflow (<inline-formula><mml:math id="inf1330"><mml:mi>F</mml:mi></mml:math></inline-formula>), and spacer loss (<inline-formula><mml:math id="inf1331"><mml:mi>r</mml:mi></mml:math></inline-formula>) all depend on the number of bacteria <inline-formula><mml:math id="inf1332"><mml:mi>n</mml:mi></mml:math></inline-formula>, but spacer acquisition (<inline-formula><mml:math id="inf1333"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) adds new bacteria independent of the current size of the clone.</p><p>We assume that the total population is in steady state so that the total population sizes <inline-formula><mml:math id="inf1334"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf1335"><mml:mi>C</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1336"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula> are constant. In general, <inline-formula><mml:math id="inf1337"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> is time-dependent and varies for each clone <inline-formula><mml:math id="inf1338"><mml:mi>i</mml:mi></mml:math></inline-formula>, but we will assume that it is also constant at steady state.</p><p>This equation is very nearly identical in form to the bacteria clone size equation solved in our previous work <xref ref-type="bibr" rid="bib9">Bonsma-Fisher et al., 2018</xref> as well as the clone size equation described in <xref ref-type="bibr" rid="bib36">Dessalles et al., 2022</xref>, and we repeat our derivation of the solution here in brief.</p><p>We solve <xref ref-type="disp-formula" rid="equ127">Equation 123</xref> using a generating function approach: <inline-formula><mml:math id="inf1339"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Multiplying <xref ref-type="disp-formula" rid="equ127">Equation 123</xref> by <inline-formula><mml:math id="inf1340"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, we get the corresponding generating function partial differential equation:<disp-formula id="equ128"><label>(124)</label><mml:math id="m128"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf1341"><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1342"><mml:mi>d</mml:mi></mml:math></inline-formula> are the birth and death rates for bacterial clones: <inline-formula><mml:math id="inf1343"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1344"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf1345"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the rate of spacer acquisition from naive bacteria: <inline-formula><mml:math id="inf1346"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mi>η</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>We solve <xref ref-type="disp-formula" rid="equ128">Equation 124</xref> using the method of characteristics <xref ref-type="bibr" rid="bib133">Van Kampen, 1981</xref>. We parameterize the function <inline-formula><mml:math id="inf1347"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with a new variable <inline-formula><mml:math id="inf1348"><mml:mi>x</mml:mi></mml:math></inline-formula>. Applying the chain rule:<disp-formula id="equ129"><label>(125)</label><mml:math id="m129"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Comparing <xref ref-type="disp-formula" rid="equ128">Equation 124</xref> with <xref ref-type="disp-formula" rid="equ129">Equation 125</xref> gives the following characteristic equations:<disp-formula id="equ130"><label>(126)</label><mml:math id="m130"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ131"><label>(127)</label><mml:math id="m131"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ132"><label>(128)</label><mml:math id="m132"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>From <xref ref-type="disp-formula" rid="equ130">Equation 126</xref>, we see <inline-formula><mml:math id="inf1349"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, so we can choose <inline-formula><mml:math id="inf1350"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and replace <inline-formula><mml:math id="inf1351"><mml:mi>x</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf1352"><mml:mi>t</mml:mi></mml:math></inline-formula> going forward. Solving the characteristic equation for <inline-formula><mml:math id="inf1353"><mml:mi>z</mml:mi></mml:math></inline-formula> by integrating both sides gives <xref ref-type="disp-formula" rid="equ133">Equation 129</xref>.<disp-formula id="equ133"><label>(129)</label><mml:math id="m133"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>At <inline-formula><mml:math id="inf1354"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1355"><mml:mi>z</mml:mi></mml:math></inline-formula> will pass through some point <italic>z</italic><sub>0</sub>, so we have the initial condition <inline-formula><mml:math id="inf1356"><mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. With <italic>z</italic><sub>0</sub> in <xref ref-type="disp-formula" rid="equ133">Equation 129</xref> at <inline-formula><mml:math id="inf1357"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we get <xref ref-type="disp-formula" rid="equ134">Equation 130</xref>, where <italic>c</italic><sub>2</sub> is given by <xref ref-type="disp-formula" rid="equ133">Equation 129</xref>.<disp-formula id="equ134"><label>(130)</label><mml:math id="m134"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The variation of <inline-formula><mml:math id="inf1358"><mml:mi>G</mml:mi></mml:math></inline-formula> along the <inline-formula><mml:math id="inf1359"><mml:mrow><mml:mi>z</mml:mi><mml:mo>-</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> curve is<disp-formula id="equ135"><label>(131)</label><mml:math id="m135"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Integrating both sides, we get<disp-formula id="equ136"><mml:math id="m136"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The constant <inline-formula><mml:math id="inf1360"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> is a function of the characteristic <inline-formula><mml:math id="inf1361"><mml:mi>z</mml:mi></mml:math></inline-formula>-<inline-formula><mml:math id="inf1362"><mml:mi>t</mml:mi></mml:math></inline-formula> curve (<xref ref-type="disp-formula" rid="equ133">Equation 129</xref>). To find the particular form of <inline-formula><mml:math id="inf1363"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we apply the initial condition <inline-formula><mml:math id="inf1364"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> which gives <inline-formula><mml:math id="inf1365"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula>, meaning that the clone starts at size <italic>N</italic><sub>0</sub> at time <inline-formula><mml:math id="inf1366"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ137"><mml:math id="m137"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Let <inline-formula><mml:math id="inf1367"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, therefore <inline-formula><mml:math id="inf1368"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ138"><mml:math id="m138"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Solving for <inline-formula><mml:math id="inf1369"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ139"><mml:math id="m139"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The full solution for <inline-formula><mml:math id="inf1370"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be written by replacing the constant <inline-formula><mml:math id="inf1371"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with the expression for <inline-formula><mml:math id="inf1372"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and replacing <inline-formula><mml:math id="inf1373"><mml:mi>ξ</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf1374"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf1375"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the time-dependent part of the <inline-formula><mml:math id="inf1376"><mml:mrow><mml:mi>z</mml:mi><mml:mo>-</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> curve.<disp-formula id="equ140"><mml:math id="m140"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>ϵ</mml:mi><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>ϵ</mml:mi><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>ϵ</mml:mi><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mi>ϵ</mml:mi><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Finally, replacing <inline-formula><mml:math id="inf1377"><mml:mi>ξ</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf1378"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula>, we get<disp-formula id="equ141"><mml:math id="m141"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>ϵ</mml:mi><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>ϵ</mml:mi><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>ϵ</mml:mi><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>ϵ</mml:mi><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf1379"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, meaning that the total probability is conserved. Assuming <inline-formula><mml:math id="inf1380"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the limit as <inline-formula><mml:math id="inf1381"><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="inf1382"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is<disp-formula id="equ142"><mml:math id="m142"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The limit is independent of the initial clone size <italic>N</italic><sub>0</sub> as we expect. We can construct <inline-formula><mml:math id="inf1383"><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> at steady state by taking successive derivatives of <inline-formula><mml:math id="inf1384"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow/><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula><disp-formula id="equ143"><label>(132)</label><mml:math id="m143"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">[</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ144"><mml:math id="m144"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This is a negative binomial distribution with parameters <inline-formula><mml:math id="inf1385"><mml:mrow><mml:mi>D</mml:mi><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1386"><mml:mrow><mml:mi>b</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula>. We can re-write this expression using Stirling’s approximation for <inline-formula><mml:math id="inf1387"><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:math></inline-formula> to facilitate evaluation at large <inline-formula><mml:math id="inf1388"><mml:mi>n</mml:mi></mml:math></inline-formula>.<disp-formula id="equ145"><label>(133)</label><mml:math id="m145"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>n</mml:mi></mml:msqrt></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>e</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ145">Equation 133</xref> is an analytic expression describing the steady-state spacer abundance distribution that results from our simulations. To compare this prediction with our simulations, we assume that <inline-formula><mml:math id="inf1389"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> on average is equal to <inline-formula><mml:math id="inf1390"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf1391"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> is the predicted total phage population size and <inline-formula><mml:math id="inf1392"><mml:mi>m</mml:mi></mml:math></inline-formula> is the number of large phage clones approximated by the predicted bacterial diversity.</p><p><xref ref-type="fig" rid="app3fig2">Appendix 3—figure 2</xref> compares the analytic distribution to the steady-state spacer clone size distribution from our simulations at several values of the spacer acquisition probability <inline-formula><mml:math id="inf1393"><mml:mi>η</mml:mi></mml:math></inline-formula>. The theoretical prediction captures the qualitative impact of increasing <inline-formula><mml:math id="inf1394"><mml:mi>η</mml:mi></mml:math></inline-formula> fairly well: as <inline-formula><mml:math id="inf1395"><mml:mi>η</mml:mi></mml:math></inline-formula> increases, the clone size distribution gains a more pronounced peak.</p><p>The discrepancy between the theoretical prediction and simulation data at high <inline-formula><mml:math id="inf1396"><mml:mi>η</mml:mi></mml:math></inline-formula> results in part from the predicted large phage clone size being larger than the measured large phage clone size in simulations. This can happen when the predicted number of clones <inline-formula><mml:math id="inf1397"><mml:mi>m</mml:mi></mml:math></inline-formula> is smaller than the simulation result. To assess whether this influenced our prediction, we also used maximum likelihood estimation to calculate the value of <inline-formula><mml:math id="inf1398"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> that gave the best fit between <xref ref-type="disp-formula" rid="equ145">Equation 133</xref> and the data; for the two largest values of <inline-formula><mml:math id="inf1399"><mml:mi>η</mml:mi></mml:math></inline-formula>, this does return a smaller value of <inline-formula><mml:math id="inf1400"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> and hence a distribution peak further to the left.</p><p>The previous two calculations assumed that the phage clone size is single-valued and constant in time. In reality, however, the phage clone size is both broadly distributed (<xref ref-type="fig" rid="fig24">Figure 24</xref>) and changing in time (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). We relax the first assumption by calculating an average bacterial distribution using the observed distribution of phage clones: we solve <xref ref-type="disp-formula" rid="equ145">Equation 133</xref> at each observed large phage clone size, then average across the distribution of clone sizes to calculate <inline-formula><mml:math id="inf1401"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. (The large phage clone distribution is given by <xref ref-type="disp-formula" rid="equ29">Equation 28</xref>.) This average distribution more accurately predicts the presence of small bacterial clones at high <inline-formula><mml:math id="inf1402"><mml:mi>η</mml:mi></mml:math></inline-formula>, but it actually behaves worse than the single-<inline-formula><mml:math id="inf1403"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> solution at small <inline-formula><mml:math id="inf1404"><mml:mi>η</mml:mi></mml:math></inline-formula>. This is related to the deviation of the number of large phage clones from the number of bacterial clones at small <inline-formula><mml:math id="inf1405"><mml:mi>η</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig22">Figure 22</xref>): at small <inline-formula><mml:math id="inf1406"><mml:mi>η</mml:mi></mml:math></inline-formula>, bacteria do not acquire spacers as readily and so phage clones experience clonal interference largely without bacterial influence. The average distribution then predicts more small bacterial clones than there are because the large phage clone distribution includes intermediate phage clone sizes that the bacteria do not end up acquiring spacers from. Essentially, the bacteria ‘see’ fewer phage clones than the theory predicts, so the observed bacteria clone size distribution has fewer smaller clones than predicted.</p><p><xref ref-type="disp-formula" rid="equ145">Equation 133</xref> can be approximated for large <inline-formula><mml:math id="inf1407"><mml:mi>n</mml:mi></mml:math></inline-formula> as a gamma distribution:<disp-formula id="equ146"><label>(134)</label><mml:math id="m146"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mi>d</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mtext>ln</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig id="app3fig2" position="float"><label>Appendix 3—figure 2.</label><caption><title>Clone size histograms (left) and cumulative distributions (right) for four different values of the spacer acquisition probability <inline-formula><mml:math id="inf1408"><mml:mi>η</mml:mi></mml:math></inline-formula>.</title><p>In all simulations, <inline-formula><mml:math id="inf1409"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1410"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1411"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. We sample 30 evenly spaced time points between 2000 and 10,000 bacterial generations and combine the clone sizes at each of the sampled points to create the clone size distributions plotted. Solid lines show three different theoretical solutions. The solid blue line is given by <xref ref-type="disp-formula" rid="equ145">Equation 133</xref> with all population quantities predicted from solving the system of <xref ref-type="disp-formula" rid="equ13">Equations 13</xref>–17 with <inline-formula><mml:math id="inf1412"><mml:mi>m</mml:mi></mml:math></inline-formula> given by <xref ref-type="disp-formula" rid="equ33">Equation 32</xref> and <inline-formula><mml:math id="inf1413"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The solid orange line is given by <xref ref-type="disp-formula" rid="equ145">Equation 133</xref>, with the value <inline-formula><mml:math id="inf1414"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> determined by maximum likelihood estimation (MLE) to give the best fit to the data. For the two largest values of <inline-formula><mml:math id="inf1415"><mml:mi>η</mml:mi></mml:math></inline-formula>, the value of <inline-formula><mml:math id="inf1416"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> returned by the MLE fit is smaller than the theoretical value of <inline-formula><mml:math id="inf1417"><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:math></inline-formula>, while for the two smallest values of <inline-formula><mml:math id="inf1418"><mml:mi>η</mml:mi></mml:math></inline-formula> the MLE value of <inline-formula><mml:math id="inf1419"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> is larger. For large enough values of <inline-formula><mml:math id="inf1420"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula>, the bacteria clone death rate <inline-formula><mml:math id="inf1421"><mml:mi>d</mml:mi></mml:math></inline-formula> is smaller than the birth rate <inline-formula><mml:math id="inf1422"><mml:mi>b</mml:mi></mml:math></inline-formula> which violates the assumptions used to derive <xref ref-type="disp-formula" rid="equ145">Equation 133</xref>. This happens for the MLE fit at the two smallest <inline-formula><mml:math id="inf1423"><mml:mi>η</mml:mi></mml:math></inline-formula> values and hence no MLE solution is plotted. The solid green line is an average distribution calculated by solving <xref ref-type="disp-formula" rid="equ145">Equation 133</xref> at each observed large phage clone size and averaging across the distribution of clone sizes; i.e. <inline-formula><mml:math id="inf1424"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The large phage clone distribution is given by <xref ref-type="disp-formula" rid="equ29">Equation 28</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig2-v2.tif"/></fig><p>This is a gamma distribution with shape parameter <inline-formula><mml:math id="inf1425"><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:math></inline-formula> and rate parameter <inline-formula><mml:math id="inf1426"><mml:mrow><mml:mtext>ln</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that <inline-formula><mml:math id="inf1427"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mi>d</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:msup><mml:mo>≈</mml:mo><mml:mrow><mml:mtext>ln</mml:mtext><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mi>D</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, consistent with the canonical form of the gamma distribution. The shape parameter <inline-formula><mml:math id="inf1428"><mml:mrow><mml:mi>D</mml:mi><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> describes the relative balance between spacer acquisition and growth: if <inline-formula><mml:math id="inf1429"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, then spacer acquisition is the dominant means by which bacterial clones grow. This often also means that the clone size distribution has a peak at clone size <italic>gt</italic><sub>1</sub> (provided <inline-formula><mml:math id="inf1430"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>≳</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>). Specifically, the mode of the distribution is greater than 1 if <inline-formula><mml:math id="inf1431"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>. The rate parameter describes the decay constant of the exponential distribution resulting if the shape parameter equals 1.</p><sec sec-type="appendix" id="s14-1"><title>Bacteria clone extinction</title><p>When a matching phage clone exists in the population, bacteria with a particular spacer have a fitness advantage if they encounter that phage. Once the matching phage goes extinct, bacteria tend to quickly go extinct as well; in fact, bacteria often go extinct <italic>before</italic> their matching phage clone (<xref ref-type="fig" rid="app3fig3">Appendix 3—figure 3</xref>). To understand why this might be, we derive a theoretical prediction for the mean time to extinction under the assumption that bacterial clones evolve neutrally once they become large. This prediction does describe the extinction time distribution well in some regimes, but it underestimates the time to extinction at large total population sizes. If the neutral assumption is valid, this means that bacterial clones go extinct stochastically and are not necessarily driven to extinction by the extinction of their matching phage clone. This is true at small-to-medium total population sizes (<inline-formula><mml:math id="inf1432"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>). On the other hand, when population sizes are large, bacteria clones go extinct more slowly than neutral theory would predict, likely because they are still being challenged by a matching phage and are also able to acquire spacers from that phage clone.</p><fig id="app3fig3" position="float"><label>Appendix 3—figure 3.</label><caption><title>Bacteria and phage clone trajectories aligned to the time at which bacteria trajectories go extinct.</title><p>Bacteria trajectories are included if they reach size <inline-formula><mml:math id="inf1433"><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:math></inline-formula> given by <xref ref-type="disp-formula" rid="equ26">Equation 25</xref> and all corresponding phage trajectories are plotted. In this simulation <inline-formula><mml:math id="inf1434"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1435"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1436"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1437"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig3-v2.tif"/></fig><p>We calculate the time to extinction using the backward master equation corresponding to <xref ref-type="disp-formula" rid="equ127">Equation 123</xref>. The backward equation is an equation for the time to extinction <inline-formula><mml:math id="inf1438"><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> from a given state. Instead of working with frequencies, we write this in terms of the number of bacteria belonging to a clone, <inline-formula><mml:math id="inf1439"><mml:mi>n</mml:mi></mml:math></inline-formula>. Here <inline-formula><mml:math id="inf1440"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1441"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1442"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ147"><label>(135)</label><mml:math id="m147"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Notice that the rate terms in the backward equation depend only on <inline-formula><mml:math id="inf1443"><mml:mi>n</mml:mi></mml:math></inline-formula>, not on <inline-formula><mml:math id="inf1444"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf1445"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> like in the forward master equation. The forward equation is a sum of all the ways in which the system could end up at state <inline-formula><mml:math id="inf1446"><mml:mi>n</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf1447"><mml:mi>t</mml:mi></mml:math></inline-formula> from where it could have been at time <inline-formula><mml:math id="inf1448"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, so those rates depend on the other states. The backward equation goes in the other direction, looking backwards: it is a sum of all the ways in which the system <italic>could have been</italic> in state <inline-formula><mml:math id="inf1449"><mml:mi>n</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf1450"><mml:mi>T</mml:mi></mml:math></inline-formula> now that time <inline-formula><mml:math id="inf1451"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> has elapsed.</p><p>Rearranging <xref ref-type="disp-formula" rid="equ147">Equation 135</xref>, we arrive at <xref ref-type="disp-formula" rid="equ148">Equation 136</xref>.<disp-formula id="equ148"><label>(136)</label><mml:math id="m148"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For boundary conditions, we have <inline-formula><mml:math id="inf1452"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (time to extinction is 0 when already extinct) and <inline-formula><mml:math id="inf1453"><mml:mrow><mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo fence="true" stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (reflecting boundary at <inline-formula><mml:math id="inf1454"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>). The reflecting boundary is harder to justify because in reality <inline-formula><mml:math id="inf1455"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> is a flexible upper limit on clone size, but in steady state when <inline-formula><mml:math id="inf1456"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> is approximately constant, it is true that no single clone will grow larger than <inline-formula><mml:math id="inf1457"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula>.</p><p>To solve <xref ref-type="disp-formula" rid="equ148">Equation 136</xref>, we expand about <inline-formula><mml:math id="inf1458"><mml:mi>n</mml:mi></mml:math></inline-formula> and keep terms up to 2nd order to get the Fokker–Planck equation:<disp-formula id="equ149"><label>(137)</label><mml:math id="m149"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>To get an approximate solution, we drop the drift term, assuming that when clones are large their net growth rate is approximately zero so <inline-formula><mml:math id="inf1459"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (this is the same as setting <inline-formula><mml:math id="inf1460"><mml:mrow><mml:mover accent="true"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ23">Equation 22</xref>). This gives the following differential equation:<disp-formula id="equ150"><label>(138)</label><mml:math id="m150"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The solution to <xref ref-type="disp-formula" rid="equ150">Equation 138</xref> with the boundary conditions described above is<disp-formula id="equ151"><label>(139)</label><mml:math id="m151"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mtext>ln</mml:mtext><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>ln</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ151">Equation 139</xref> with <inline-formula><mml:math id="inf1461"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:mrow></mml:math></inline-formula> is plotted in <xref ref-type="fig" rid="app3fig4">Appendix 3—figure 4</xref>, <xref ref-type="fig" rid="app3fig5">Appendix 3—figures 5</xref>–<xref ref-type="fig" rid="app3fig7">7</xref> and <xref ref-type="fig" rid="app3fig10">Appendix 3—figure 10</xref>. We also solved the full Fokker–Planck equation numerically without assuming the drift term is 0 (<xref ref-type="disp-formula" rid="equ149">Equation 137</xref>). In this numerical solution, we change the value of <inline-formula><mml:math id="inf1462"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> for different values of <inline-formula><mml:math id="inf1463"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> to reflect the fact that at small bacteria clone sizes phage clones also tend to be smaller; we use the numerical solutions for average <inline-formula><mml:math id="inf1464"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1465"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> shown as dashed lines in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>. This solution is shown in <xref ref-type="fig" rid="app3fig3">Appendix 3—figure 3</xref>.</p><fig id="app3fig4" position="float"><label>Appendix 3—figure 4.</label><caption><title>Mean time to extinction for bacterial clones after reaching size <inline-formula><mml:math id="inf1466"><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf1467"><mml:mi>η</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="inf1468"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1469"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1470"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</title><p>The solid line is given by <xref ref-type="disp-formula" rid="equ151">Equation 139</xref> with <inline-formula><mml:math id="inf1471"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:mrow></mml:math></inline-formula>, and the dashed line is given by numerically solving <xref ref-type="disp-formula" rid="equ149">Equation 137</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig4-v2.tif"/></fig></sec><sec sec-type="appendix" id="s14-2"><title>Approximate time to extinction</title><p>Since we are interested in the time to extinction once bacterial clones reach a large size, we can substitute <inline-formula><mml:math id="inf1472"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ151">Equation 139</xref> to gain insight into the time to extinction for bacteria. The average clone size <inline-formula><mml:math id="inf1473"><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ152"><label>(140)</label><mml:math id="m152"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can substitute values for <inline-formula><mml:math id="inf1474"><mml:mrow><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> using the steady-state deterministic solution for <inline-formula><mml:math id="inf1475"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> and assuming <inline-formula><mml:math id="inf1476"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ153"><label>(141)</label><mml:math id="m153"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mi>ν</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>To approximate the extinction time expression, we decompose <inline-formula><mml:math id="inf1477"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf1478"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1479"><mml:mi>ν</mml:mi></mml:math></inline-formula> into series expansions in <inline-formula><mml:math id="inf1480"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, i.e. <inline-formula><mml:math id="inf1481"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:none/><mml:mn>0</mml:mn><mml:none/></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:none/><mml:mn>1</mml:mn><mml:none/></mml:mmultiscripts></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mfrac><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:none/><mml:mn>2</mml:mn><mml:none/></mml:mmultiscripts></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. We substitute these expressions into <xref ref-type="disp-formula" rid="equ152">Equation 140</xref> and perform an overall series expansion in <inline-formula><mml:math id="inf1482"><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. The zeroth-order term is shown here and plotted in <xref ref-type="fig" rid="app3fig3">Appendix 3—figure 3B</xref>, and the solution to first order is plotted in <xref ref-type="fig" rid="app3fig3">Appendix 3—figure 3A</xref>.<disp-formula id="equ154"><label>(142)</label><mml:math id="m154"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="1"><mml:mi>T</mml:mi><mml:mo>≈</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="1"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>f</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>η</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mi>η</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="1"><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="1"><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>f</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mi>η</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="1"><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>α</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="1"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>f</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mi>η</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="1"><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>÷</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>α</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>g</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This expression remains unwieldy, so we also do a series expansion in <inline-formula><mml:math id="inf1483"><mml:mi>r</mml:mi></mml:math></inline-formula> and keep the zeroth-order term (equivalent to setting <inline-formula><mml:math id="inf1484"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Spacer loss is not the dominant death rate for spacer-containing clones; the rate of spacer loss we use is an order of magnitude lower than the rate of cell death due to outflow (<inline-formula><mml:math id="inf1485"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). This expression becomes very simple:<disp-formula id="equ155"><label>(143)</label><mml:math id="m155"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can write <xref ref-type="disp-formula" rid="equ155">Equation 143</xref> in terms of total population sizes without CRISPR (<inline-formula><mml:math id="inf1486"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1487"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>) to gain insight.<disp-formula id="equ156"><label>(144)</label><mml:math id="m156"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If average immunity is low, then <inline-formula><mml:math id="inf1488"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (from the mean-field equation for <inline-formula><mml:math id="inf1489"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>).<disp-formula id="equ157"><label>(145)</label><mml:math id="m157"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>b</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ155">Equation 143</xref> is compared to the measured time to extinction in <xref ref-type="fig" rid="app3fig3">Appendix 3—figure 3C</xref>. It is not a good approximation for low <inline-formula><mml:math id="inf1490"><mml:mi>η</mml:mi></mml:math></inline-formula>, but at the two highest values of <inline-formula><mml:math id="inf1491"><mml:mi>η</mml:mi></mml:math></inline-formula> it captures the trend reasonably well. The dependence of bacterial time to extinction on clone size (<xref ref-type="disp-formula" rid="equ157">Equation 145</xref>, dropping the <inline-formula><mml:math id="inf1492"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> term) is shown in <xref ref-type="fig" rid="app3fig3">Appendix 3—figure 3</xref>.</p><p>Interestingly the dependence on <inline-formula><mml:math id="inf1493"><mml:mi>m</mml:mi></mml:math></inline-formula> in this approximate expression is identical to the dependence on <inline-formula><mml:math id="inf1494"><mml:mi>m</mml:mi></mml:math></inline-formula> in the phage extinction approximation (<xref ref-type="disp-formula" rid="equ68">Equation 67</xref>). Furthermore, there is also a proportionality to the mean clone size in the form <inline-formula><mml:math id="inf1495"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> in the bacteria extinction equation (since <inline-formula><mml:math id="inf1496"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf1497"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, which is why this approximation works best at high <inline-formula><mml:math id="inf1498"><mml:mi>η</mml:mi></mml:math></inline-formula> when <inline-formula><mml:math id="inf1499"><mml:mi>ν</mml:mi></mml:math></inline-formula> is closer to 1). This is reasonable considering that the dynamics of bacteria and phage are ultimately matched to each other at steady state. This expression still depends on <inline-formula><mml:math id="inf1500"><mml:mi>m</mml:mi></mml:math></inline-formula>, which is an emergent quantity dependent on all other parameters as well. We apply the approximation for <inline-formula><mml:math id="inf1501"><mml:mi>m</mml:mi></mml:math></inline-formula> from 'Approximation for <inline-formula><mml:math id="inf1502"><mml:mi>m</mml:mi></mml:math></inline-formula>' for more insight.<disp-formula id="equ158"><label>(146)</label><mml:math id="m158"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>bacteria</mml:mtext></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This simplified expression for time to extinction gives insight into the main drivers of extinction. Perhaps counterintuitively, the bacteria clone time to extinction decreases as the growth rate <inline-formula><mml:math id="inf1503"><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> increases — a higher growth rate means faster dynamics overall and lower time to extinction. Note, however, that a higher growth rate (for instance, with larger <italic>C</italic><sub>0</sub>) also leads to larger <inline-formula><mml:math id="inf1504"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>Bacteria extinction depends inversely on <inline-formula><mml:math id="inf1505"><mml:mi>α</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf1506"><mml:mi>B</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf1507"><mml:mi>e</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf1508"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1509"><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with the time to extinction decreasing with all parameters except the spacer loss rate <inline-formula><mml:math id="inf1510"><mml:mi>r</mml:mi></mml:math></inline-formula>. The bacteria time to extinction increases with increasing flow rate <inline-formula><mml:math id="inf1511"><mml:mi>f</mml:mi></mml:math></inline-formula>.</p></sec></sec><sec sec-type="appendix" id="s15"><title>Phage clone dynamics</title><p>In this section, we calculate the probability of establishment for new phage mutants and the time to extinction for large phage clones. The phage establishment probability is a core component of our calculation of diversity in 'Phages drive stable emergent sequence diversity' and is explored on its own in 'What determines the fitness and establishment of new mutants?'. The phage time to extinction is also related to the speed of phage evolution in <xref ref-type="fig" rid="fig6">Figure 6</xref>, 'Dynamics are determined by diversity'.</p><p>To solve for the dynamics of individual phage clones, we can write a one-dimensional master equation just for <inline-formula><mml:math id="inf1512"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ159">Equation 147</xref>). Here we neglect mutations; we assume that mutations are rare and a burst always contributes to the clonal population being tracked. This master equation is a birth-death master equation with bursts – it is in the form of a classic birth-death master equation except that the population grows with a jump of size <inline-formula><mml:math id="inf1513"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf1514"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the probability of having <inline-formula><mml:math id="inf1515"><mml:mi>n</mml:mi></mml:math></inline-formula> phages of type <inline-formula><mml:math id="inf1516"><mml:mi>i</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf1517"><mml:mi>t</mml:mi></mml:math></inline-formula> given <italic>N</italic><sub>0</sub> phages of type <inline-formula><mml:math id="inf1518"><mml:mi>i</mml:mi></mml:math></inline-formula> at <inline-formula><mml:math id="inf1519"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ159"><label>(147)</label><mml:math id="m159"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mi>e</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mi>e</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec sec-type="appendix" id="s16"><title>Phage clone probability of extinction</title><p><xref ref-type="disp-formula" rid="equ174">Equation 159</xref> is the basis for our prediction of phage establishment probability (<xref ref-type="disp-formula" rid="equ117">Equation 114</xref>).</p><p>We can find the probability of extinction <italic>P</italic><sub>0</sub> for new phage mutants under the assumption that <inline-formula><mml:math id="inf1520"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1521"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> are constant using <xref ref-type="disp-formula" rid="equ159">Equation 147</xref>. We solve this equation using a generating function approach: <inline-formula><mml:math id="inf1522"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Multiplying <xref ref-type="disp-formula" rid="equ159">Equation 147</xref> by <inline-formula><mml:math id="inf1523"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, we get the corresponding generating function partial differential equation:<disp-formula id="equ160"><label>(148)</label><mml:math id="m160"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf1524"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf1525"><mml:mi>β</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1526"><mml:mi>δ</mml:mi></mml:math></inline-formula> are the birth and death rates for phage mutants: <inline-formula><mml:math id="inf1527"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1528"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. We distinguish two cases of constant <inline-formula><mml:math id="inf1529"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, valid at early times after phage mutation, and <inline-formula><mml:math id="inf1530"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:mrow></mml:math></inline-formula>, the deterministic steady-state value of <inline-formula><mml:math id="inf1531"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> given by <xref ref-type="disp-formula" rid="equ26">Equation 25</xref>, valid at long times after phage mutation. When we are assuming <inline-formula><mml:math id="inf1532"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, we use <inline-formula><mml:math id="inf1533"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1534"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>We solve <xref ref-type="disp-formula" rid="equ160">Equation 148</xref> using the method of characteristics:<disp-formula id="equ161"><label>(149)</label><mml:math id="m161"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This gives the following characteristic equations:<disp-formula id="equ162"><label>(150)</label><mml:math id="m162"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ163"><label>(151)</label><mml:math id="m163"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Integrating these two equations, we get <inline-formula><mml:math id="inf1535"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, and<disp-formula id="equ164"><label>(152)</label><mml:math id="m164"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The initial phage clone size is <italic>N</italic><sub>0</sub>. The initial condition is<disp-formula id="equ165"><mml:math id="m165"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The last equality is from the method of characteristics: the solution for <inline-formula><mml:math id="inf1536"><mml:mi>G</mml:mi></mml:math></inline-formula> at the initial condition gives the full solution which is constant as parameterized by <inline-formula><mml:math id="inf1537"><mml:mi>x</mml:mi></mml:math></inline-formula>.</p><p>The probability of extinction is given by setting <inline-formula><mml:math id="inf1538"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="inf1539"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ166"><mml:math id="m166"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1540"><mml:mi>ζ</mml:mi></mml:math></inline-formula> solves <xref ref-type="disp-formula" rid="equ167">Equation 153</xref>, which we obtain by setting <inline-formula><mml:math id="inf1541"><mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ164">Equation 152</xref> and replacing <inline-formula><mml:math id="inf1542"><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf1543"><mml:mi>ζ</mml:mi></mml:math></inline-formula>, since <inline-formula><mml:math id="inf1544"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo fence="true" stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msup></mml:mrow><mml:mo fence="true" stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ167"><label>(153)</label><mml:math id="m167"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><sec sec-type="appendix" id="s16-1"><title>Long-time approximation for <inline-formula><mml:math id="inf1545"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></title><p>To approximate <inline-formula><mml:math id="inf1546"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at long times, we notice that since extinction probability becomes large at <inline-formula><mml:math id="inf1547"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>, then the large-<inline-formula><mml:math id="inf1548"><mml:mi>t</mml:mi></mml:math></inline-formula> limit corresponds to <inline-formula><mml:math id="inf1549"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>The denominator of <xref ref-type="disp-formula" rid="equ167">Equation 153</xref> will be smallest when <inline-formula><mml:math id="inf1550"><mml:mi>w</mml:mi></mml:math></inline-formula> is near 1, so the largest contribution to the integral will come from <inline-formula><mml:math id="inf1551"><mml:mi>w</mml:mi></mml:math></inline-formula> near 1. Expanding the denominator to second order with <inline-formula><mml:math id="inf1552"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf1553"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> is small:<disp-formula id="equ168"><mml:math id="m168"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ϵ</mml:mi><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>ϵ</mml:mi><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Changing back to the variable <inline-formula><mml:math id="inf1554"><mml:mi>w</mml:mi></mml:math></inline-formula> and substituting back into <xref ref-type="disp-formula" rid="equ167">Equation 153</xref>, the integral becomes<disp-formula id="equ169"><label>(154)</label><mml:math id="m169"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi><mml:mo>≈</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which when evaluated gives<disp-formula id="equ170"><label>(155)</label><mml:math id="m170"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>B</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ171"><label>(156)</label><mml:math id="m171"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1555"><mml:mi>t</mml:mi></mml:math></inline-formula> is in units of minutes and we introduce the variable <inline-formula><mml:math id="inf1556"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mi>p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (and <inline-formula><mml:math id="inf1557"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>). The parameter <inline-formula><mml:math id="inf1558"><mml:mi>s</mml:mi></mml:math></inline-formula> is the average growth rate of phage clones. When phage mutants first appear and <inline-formula><mml:math id="inf1559"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, this corresponds to <inline-formula><mml:math id="inf1560"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and we write <inline-formula><mml:math id="inf1561"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. As <inline-formula><mml:math id="inf1562"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>→</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1563"><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>The <inline-formula><mml:math id="inf1564"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> limit of 155 is<disp-formula id="equ172"><label>(157)</label><mml:math id="m172"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The long-time limit of 156 is<disp-formula id="equ173"><label>(158)</label><mml:math id="m173"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>B</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For a phage clone that begins at size <inline-formula><mml:math id="inf1565"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and for which there are no matching bacterial clones (<inline-formula><mml:math id="inf1566"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), <xref ref-type="disp-formula" rid="equ174">Equation 159</xref> gives the probability of that clone going extinct.<disp-formula id="equ174"><label>(159)</label><mml:math id="m174"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf1567"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (a return to a simple birth-death equation where the population grows and dies by increments of 1), <xref ref-type="disp-formula" rid="equ171">Equation 156</xref> becomes<disp-formula id="equ175"><label>(160)</label><mml:math id="m175"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This is the expected probability of extinction for a simple birth-death process with selection given in <xref ref-type="bibr" rid="bib33">Desai and Fisher, 2007</xref>. (Note that time can be rescaled so that <inline-formula><mml:math id="inf1568"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.)</p><p>The long-time limit of 160 is<disp-formula id="equ176"><label>(161)</label><mml:math id="m176"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>β</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This is the expected limit for the extinction probability for a simple birth-death process with selection. As <inline-formula><mml:math id="inf1569"><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the probability of extinction goes to 1.</p><p>Note that the probability of extinction for <inline-formula><mml:math id="inf1570"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ173">Equation 158</xref>) is larger than for <inline-formula><mml:math id="inf1571"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ176">Equation 161</xref>). Somewhat paradoxically, this implies that one effect of the burst size <inline-formula><mml:math id="inf1572"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is to increase the probability of extinction for new phage mutants. This happens because bursts are infrequent events; on average, <inline-formula><mml:math id="inf1573"><mml:mi>B</mml:mi></mml:math></inline-formula> death events must occur for every one birth event, making death a more common stochastic outcome. The extinction probability for <inline-formula><mml:math id="inf1574"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is <inline-formula><mml:math id="inf1575"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>δ</mml:mi></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> times greater than for <inline-formula><mml:math id="inf1576"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Expanding in <inline-formula><mml:math id="inf1577"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> for large <inline-formula><mml:math id="inf1578"><mml:mi>B</mml:mi></mml:math></inline-formula>, this is <inline-formula><mml:math id="inf1579"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mi>β</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec sec-type="appendix" id="s16-2"><title>Small-time approximation for <inline-formula><mml:math id="inf1580"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></title><p>When <inline-formula><mml:math id="inf1581"><mml:mi>t</mml:mi></mml:math></inline-formula> is small, <italic>P</italic><sub>0</sub> will be close to 0, which means <inline-formula><mml:math id="inf1582"><mml:mi>ζ</mml:mi></mml:math></inline-formula> will be close to 0 and therefore we can approximate <inline-formula><mml:math id="inf1583"><mml:mi>w</mml:mi></mml:math></inline-formula> as being near 0.</p><p>The denominator simplifies to <inline-formula><mml:math id="inf1584"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></inline-formula> for small <inline-formula><mml:math id="inf1585"><mml:mi>w</mml:mi></mml:math></inline-formula>, and we get<disp-formula id="equ177"><label>(162)</label><mml:math id="m177"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi><mml:mo>≈</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ178"><label>(163)</label><mml:math id="m178"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec sec-type="appendix" id="s16-3"><title>Long-time approximation for <inline-formula><mml:math id="inf1586"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with no selection</title><p>In the above derivations of the probability of phage clone extinction, we generally assumed that phages had a selective advantage because there were no bacteria with matching spacers at the time a phage clone arose by mutation. If instead a phage clone does not have a selective advantage, this corresponds to <inline-formula><mml:math id="inf1587"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, or <inline-formula><mml:math id="inf1588"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is exactly <inline-formula><mml:math id="inf1589"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf1590"><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> is given by the mean-field steady state with no CRISPR; in other words, phage clones do not have a selective advantage if the population is in steady state and there is no CRISPR immunity to distinguish clones from each other.</p><p>Expanding the denominator with <inline-formula><mml:math id="inf1591"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> as before:<disp-formula id="equ179"><mml:math id="m179"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>≈</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>ϵ</mml:mi><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>When <inline-formula><mml:math id="inf1592"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, the first two terms cancel out. We get the integral<disp-formula id="equ180"><label>(164)</label><mml:math id="m180"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mi>p</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which gives<disp-formula id="equ181"><label>(165)</label><mml:math id="m181"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mi>p</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>B</mml:mi><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>B</mml:mi><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>B</mml:mi><mml:mi>β</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>B</mml:mi><mml:mi>β</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ181">Equation 165</xref> is equivalent to <xref ref-type="disp-formula" rid="equ172">Equation 157</xref>, assuming <inline-formula><mml:math id="inf1593"><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula>. This is true when <inline-formula><mml:math id="inf1594"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, since <inline-formula><mml:math id="inf1595"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> corresponds to <inline-formula><mml:math id="inf1596"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula>.</p><fig id="app3fig5" position="float"><label>Appendix 3—figure 5.</label><caption><title>Predicted bacteria clone time to extinction with drift.</title><p>Measured vs. predicted mean time to extinction for bacterial clones after reaching size <inline-formula><mml:math id="inf1597"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>. The predicted time to extinction is the solution with drift, given by numerically solving <xref ref-type="disp-formula" rid="equ183">Equation 167</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig5-v2.tif"/></fig></sec><sec sec-type="appendix" id="s16-4"><title>Neutral time to extinction from backward master equation</title><p>The phage time to extinction calculated here is compared to the speed of phage evolution in <xref ref-type="fig" rid="fig6">Figure 6</xref>, 'Dynamics are determined by diversity'.</p><p>We can calculate the time to extinction using the backward master equation corresponding to <xref ref-type="disp-formula" rid="equ159">Equation 147</xref>. The backward equation is an equation for the time to extinction <inline-formula><mml:math id="inf1598"><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> from a given state. Instead of working with frequencies, we write this in terms of the number of phages belonging to a clone, <inline-formula><mml:math id="inf1599"><mml:mi>n</mml:mi></mml:math></inline-formula>. Here <inline-formula><mml:math id="inf1600"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1601"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ182"><label>(166)</label><mml:math id="m182"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Rearranging <xref ref-type="disp-formula" rid="equ182">Equation 166</xref>, we arrive at <xref ref-type="disp-formula" rid="equ183">Equation 167</xref>.<disp-formula id="equ183"><label>(167)</label><mml:math id="m183"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For boundary conditions, we have <inline-formula><mml:math id="inf1602"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (time to extinction is 0 when already extinct) and <inline-formula><mml:math id="inf1603"><mml:mrow><mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo fence="true" stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (reflecting boundary at <inline-formula><mml:math id="inf1604"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). As with bacteria clones, we assume here that the upper limit on phage clone size is constant at <inline-formula><mml:math id="inf1605"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> at steady state.</p><p>To solve <xref ref-type="disp-formula" rid="equ183">Equation 167</xref>, we expand about <inline-formula><mml:math id="inf1606"><mml:mi>n</mml:mi></mml:math></inline-formula> and keep terms up to second order to get the Fokker–Planck equation:<disp-formula id="equ184"><label>(168)</label><mml:math id="m184"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>At steady state and for large clones, <inline-formula><mml:math id="inf1607"><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula>, which means clones are approximately neutral and we can drop the drift term:<disp-formula id="equ185"><label>(169)</label><mml:math id="m185"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This is a straightforward second-order ordinary differential equation, which has the solution<disp-formula id="equ186"><label>(170)</label><mml:math id="m186"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Using the boundary condition <inline-formula><mml:math id="inf1608"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the constant <inline-formula><mml:math id="inf1609"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Using the second boundary condition, <inline-formula><mml:math id="inf1610"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mtext>ln</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, and the full solution is<disp-formula id="equ187"><label>(171)</label><mml:math id="m187"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>ln</mml:mtext><mml:mfrac><mml:mi>n</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Once phage clones become large (by reaching size <inline-formula><mml:math id="inf1611"><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:math></inline-formula> as given by <xref ref-type="disp-formula" rid="equ27">Equation 26</xref>), they behave neutrally and <xref ref-type="disp-formula" rid="equ187">Equation 171</xref> agrees well with observed extinction times in simulations. We set <inline-formula><mml:math id="inf1612"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:mrow></mml:math></inline-formula> and use the deterministic steady-state clone size for <inline-formula><mml:math id="inf1613"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> given by <xref ref-type="disp-formula" rid="equ26">Equation 25</xref> in <inline-formula><mml:math id="inf1614"><mml:mi>β</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1615"><mml:mi>δ</mml:mi></mml:math></inline-formula>. <xref ref-type="fig" rid="app3fig9">Appendix 3—figure 9</xref> compares observed large clone extinction times in a simulation (blue) to the prediction given by <xref ref-type="disp-formula" rid="equ187">Equation 171</xref> (orange dashed). Predicted and measured times to extinction for many simulations with <xref ref-type="disp-formula" rid="equ187">Equation 171</xref> are shown in <xref ref-type="fig" rid="app3fig10">Appendix 3—figure 10</xref>.</p><p>If <inline-formula><mml:math id="inf1616"><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts><mml:mo>≈</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, which it is at steady state, we can rewrite <xref ref-type="disp-formula" rid="equ187">Equation 171</xref> as:<disp-formula id="equ188"><label>(172)</label><mml:math id="m188"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig id="app3fig6" position="float"><label>Appendix 3—figure 6.</label><caption><title>Approximations for bacteria clone extinction.</title><p>Measured mean time to extinction for large bacterial clones vs. three successively more aggressive analytic approximations for the mean time to extinction. (A) The predicted time to extinction is given by taking a series expansion in <inline-formula><mml:math id="inf1617"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and keeping terms to 1st order. (B) A series expansion in <inline-formula><mml:math id="inf1618"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and keeping the 0th order term (<inline-formula><mml:math id="inf1619"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) only. (C) Series expansion in <inline-formula><mml:math id="inf1620"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf1621"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and keeping the 0th order term only (<xref ref-type="disp-formula" rid="equ155">Equation 143</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig6-v2.tif"/></fig><fig id="app3fig7" position="float"><label>Appendix 3—figure 7.</label><caption><title>Approximations for bacteria clone extinction as a function of mean clone size.</title><p>Bacteria extinction time as a function of mean clone size. Large bacteria clone mean time to extinction as a function of <inline-formula><mml:math id="inf1622"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf1623"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is measured from simulations and <inline-formula><mml:math id="inf1624"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the total bacteria population size. This parameter combination describes the trend in both phage and bacteria extinction reasonably well at large values of (bottom panels). The solid line is given by <xref ref-type="disp-formula" rid="equ157">Equation 145</xref> without the $1 + \ln m$ term.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig7-v2.tif"/></fig><p>The factor <inline-formula><mml:math id="inf1625"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> comes from the integral of the second-order differential equation and from the reflecting boundary assumption, and interestingly it would happen even if <inline-formula><mml:math id="inf1626"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (no burst): integrating the Fokker–Planck equation gives a factor of <inline-formula><mml:math id="inf1627"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>; if we start from the steady-state value of <inline-formula><mml:math id="inf1628"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, this becomes <inline-formula><mml:math id="inf1629"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Applying the reflecting boundary at <inline-formula><mml:math id="inf1630"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> cancels out the <inline-formula><mml:math id="inf1631"><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> term. Very simply: the integral we are solving is <inline-formula><mml:math id="inf1632"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, and this gives <inline-formula><mml:math id="inf1633"><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> up to some constants. This simplified expression for time to extinction gives insight into the main drivers of extinction. The phage time to extinction decreases as the outflow rate <inline-formula><mml:math id="inf1634"><mml:mi>f</mml:mi></mml:math></inline-formula> increases — if phages die at a higher rate, they go extinct more quickly. Interestingly, a larger burst size <inline-formula><mml:math id="inf1635"><mml:mi>B</mml:mi></mml:math></inline-formula> decreases the time to extinction for large phage clones, consistent with an overall increase in the size of fluctuations as the burst size increases.</p><p>This expression still depends on <inline-formula><mml:math id="inf1636"><mml:mi>m</mml:mi></mml:math></inline-formula>, which is an emergent quantity dependent on all other parameters as well. We apply the approximation for <inline-formula><mml:math id="inf1637"><mml:mi>m</mml:mi></mml:math></inline-formula> from ‘Approximation for <inline-formula><mml:math id="inf1638"><mml:mi>m</mml:mi></mml:math></inline-formula> for more insight.<disp-formula id="equ189"><label>(173)</label><mml:math id="m189"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>phage</mml:mtext></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>g</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>f</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Comparing with <xref ref-type="disp-formula" rid="equ158">Equation 146</xref> for bacteria, both phage and bacteria extinction depend inversely on <inline-formula><mml:math id="inf1639"><mml:mi>α</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf1640"><mml:mi>B</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf1641"><mml:mi>e</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf1642"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf1643"><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with the time to extinction decreasing with all parameters except the spacer loss rate <inline-formula><mml:math id="inf1644"><mml:mi>r</mml:mi></mml:math></inline-formula>. The bacteria time to extinction increases with increasing flow rate <inline-formula><mml:math id="inf1645"><mml:mi>f</mml:mi></mml:math></inline-formula>, while the phage time to extinction decreases with <inline-formula><mml:math id="inf1646"><mml:mi>f</mml:mi></mml:math></inline-formula>.</p><p>The clone size dependence of phage extinction is shown in <xref ref-type="fig" rid="app3fig11">Appendix 3—figure 11</xref>, comparing measured extinction times to the prediction of <xref ref-type="disp-formula" rid="equ188">Equation 172</xref> without the <inline-formula><mml:math id="inf1647"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> term. This captures the dominant trend in extinction time behaviour.</p><fig id="app3fig8" position="float"><label>Appendix 3—figure 8.</label><caption><title>Phage clone extinction times and theoretical predictions for a simulation with parameters <inline-formula><mml:math id="inf1648"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</title><p>Time zero for each trajectory is the time at which that clone arose by mutation. All simulation trajectories are plotted in blue, and a subset of trajectories that do not reach a size of <inline-formula><mml:math id="inf1649"><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>16170</mml:mn></mml:mrow></mml:math></inline-formula> as given by <xref ref-type="disp-formula" rid="equ27">Equation 26</xref> are plotted in orange. Trajectories that do not become established by this definition go extinct more quickly than ones that do. All other curves are theoretical predictions for the extinction time. The green and red solid lines and purple and brown dashed lines show a numerical solution to <xref ref-type="disp-formula" rid="equ167">Equation 153</xref> with different values for <inline-formula><mml:math id="inf1650"><mml:mi>s</mml:mi></mml:math></inline-formula>. The remaining dashed lines are a small time approximation given by <xref ref-type="disp-formula" rid="equ178">Equation 163</xref>, and a large time approximation given by <xref ref-type="disp-formula" rid="equ171">Equation 156</xref> with either <inline-formula><mml:math id="inf1651"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf1652"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. All of these predictions agree with the simulation data in different regimes; none accurately captures the entire timecourse of extinctions.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig8-v2.tif"/></fig><fig id="app3fig9" position="float"><label>Appendix 3—figure 9.</label><caption><title>Large clone extinction times from a simulation with parameters <inline-formula><mml:math id="inf1653"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</title><p>Trajectories are counted as large if the phage clone size passes <inline-formula><mml:math id="inf1654"><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>16170</mml:mn></mml:mrow></mml:math></inline-formula>, the theoretical deterministic mean phage clone size for these parameters given by <xref ref-type="disp-formula" rid="equ27">Equation 26</xref>. Once a trajectory reaches <inline-formula><mml:math id="inf1655"><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:math></inline-formula>, we count that point as time zero to measure the extinction time of large clones. The numerical solution is given by solving <xref ref-type="disp-formula" rid="equ167">Equation 153</xref> with <inline-formula><mml:math id="inf1656"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf1657"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>). The large time approximation is given by <xref ref-type="disp-formula" rid="equ172">Equation 157</xref>. The orange dashed line gives an exponential decay prediction with the mean time to extinction given by <xref ref-type="disp-formula" rid="equ187">Equation 171</xref> with <inline-formula><mml:math id="inf1658"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:none/><mml:mo>*</mml:mo></mml:mmultiscripts></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig9-v2.tif"/></fig><fig id="app3fig10" position="float"><label>Appendix 3—figure 10.</label><caption><title>Mean time to extinction for large bacteria (left) and phage (right) clones as a function of the neutral fitness mean time to extinction prediction.</title><p>The solid black lines describe approximate analytic expressions for bacteria and phage time to extinction using a neutral fitness assumption. For bacteria, the black line solves <xref ref-type="disp-formula" rid="equ151">Equation 139</xref> using the mean bacteria and phage clone sizes. For phages, the black line solves <xref ref-type="disp-formula" rid="equ187">Equation 171</xref> using the mean phage clone size in place of <inline-formula><mml:math id="inf1659"><mml:mi>n</mml:mi></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig10-v2.tif"/></fig><fig id="app3fig11" position="float"><label>Appendix 3—figure 11.</label><caption><title>Phage extinction time as a function of mean clone size.</title><p>Large phage clone mean time to extinction as a function of <inline-formula><mml:math id="inf1660"><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mi>m</mml:mi></mml:mfrac></mml:math></inline-formula>, where <inline-formula><mml:math id="inf1661"><mml:mi>m</mml:mi></mml:math></inline-formula> is measured from simulations and <inline-formula><mml:math id="inf1662"><mml:msub><mml:mi>n</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> is the total phage population size. The solid line is given by <xref ref-type="disp-formula" rid="equ188">Equation 172</xref> without the <inline-formula><mml:math id="inf1663"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> term.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81692-app3-fig11-v2.tif"/></fig></sec></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.81692.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bitbol</surname><given-names>Anne-Florence</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s376052</institution-id><institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution></institution-wrap><country>Switzerland</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.07.07.498272" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.07.07.498272"/></front-stub><body><p>In this important work, the authors develop a theory for the coevolutionary dynamics of bacteria and phages, where the major evolutionary pressure comes from CRISPR-Cas adaptive immunity in bacteria. Through extensive stochastic numerical simulations and analytical calculations, the article presents a compelling analysis of the emergent properties of immune interactions, in the regime of a single proto-spacer and a single spacer. Some of the trends highlighted by the model are recovered from experimental data. The main results concern how diversity in both phage and bacteria population is linked and is shaped by immunity, and should be of broad interest in immunology.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.81692.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bitbol</surname><given-names>Anne-Florence</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s376052</institution-id><institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution></institution-wrap><country>Switzerland</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Bravi</surname><given-names>Barbara</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/041kmwe10</institution-id><institution>Imperial College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.07.07.498272">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.07.07.498272v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Dynamics of immune memory and learning in bacterial communities&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Aleksandra Walczak as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Barbara Bravi (Reviewer #1).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Please clarify why/when the regime of a single spacer per bacterium and a single protospacer per phage is relevant. Please also perform an explicit comparison with the multiple-protospacer regime, which is biologically highly relevant (see Reviewer #3's main point), and include the associated results in the Results section.</p><p>2) To increase readability, please make the Discussion section more concise. Please also add an initial sentence to each section of the Supplementary Material that outlines what is done in it and how it connects to the main text. Please also consider moving Results section 3.4 to the Supplementary Material.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>I think the Discussion section is too long, compromising the focus on a few key messages. The authors might consider some streamlining of the text. For example, to make the point about the fact that studying CRISPR can give insight into vertebrate adaptive dynamics, a shorter section would suffice.</p><p>General remarks:</p><p>- There are 3 main experimental findings listed in lines 63-66 (a-c). I think the authors should clarify what of these findings were hard-coded in the model and what were recovered or rationalized by their analysis.</p><p>- In several points, the authors comment on the validity of certain trends across a range of parameters, but in the figures several parameters are fixed and then only η (or μ) is varied. I think the authors should refer to the supplementary figures where they show the variation wrt other parameters or have a sentence where they justify why certain parameters are fixed while mainly η is varied. As far as I am concerned, seeing how the behaviours change for lower e is interesting too.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>My main concern is the single protospacer parameter mentioned in the public review. Of the parameters mentioned in lines 553-559 (burst lag, spatial structure, autoimmunity, etc…), multiple protospacers, and in reality hundreds of possible protospacers, has the highest likelihood to significantly change the bacteria and phage dynamics. I wonder if the “counter-intuitive result” in line 561 is due to this discrepancy. The authors explore multiple protospacers with a “toy model” in the discussion, but I believe this should be more fully explored in the main Results section, similar to what was done for cross-reactivity.</p><p>This is particularly important because as soon as a phage infects, there are hundreds of potential protospacers. The likelihood that two cells will acquire the same spacer is therefore very, very small and therefore, if a phage escapes one spacer by mutation, it will still be targeted by the vast majority of cells. This is very different from the model the authors use for the bulk of their paper where a phage simultaneously escapes all spacers. I would like to see the analyses repeated with this multiple protospacer scenario which is biologically very relevant.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.81692.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Please clarify why/when the regime of a single spacer per bacterium and a single protospacer per phage is relevant. Please also perform an explicit comparison with the multiple-protospacer regime, which is biologically highly relevant (see Reviewer #3's main point), and include the associated results in the Results section.</p></disp-quote><p>Based on Reviewer #3’s comments, we have added a section to the Results (now 3.5) that extensively develops our toy model exploring the impact of multiple protospacers and spacers per organism and have shortened the related section in the Discussion.</p><disp-quote content-type="editor-comment"><p>2) To increase readability, please make the Discussion section more concise. Please also add an initial sentence to each section of the Supplementary Material that outlines what is done in it and how it connects to the main text. Please also consider moving Results section 3.4 to the Supplementary Material.</p></disp-quote><p>We have combined the Results section on clone extinction with Appendix C to reduce the length of our manuscript, have shortened the Discussion, and have added an initial sentence to each sentence of the Supplementary Material that summarizes its purpose and links to the main text. In addition, to reduce length, we removed Methods sections not referred to in the main results – “Quasi-steady-state clone size solution” and “Clone size stability analysis.”</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>I think the Discussion section is too long, compromising the focus on a few key messages. The authors might consider some streamlining of the text. For example, to make the point about the fact that studying CRISPR can give insight into vertebrate adaptive dynamics, a shorter section would suffice.</p></disp-quote><p>We feel that the comprehensiveness of the Discussion is one of its strong points, but we agree that it is long – we have shortened both the sections on vertebrate adaptive immunity and average immunity.</p><disp-quote content-type="editor-comment"><p>General remarks:</p><p>- There are 3 main experimental findings listed in lines 63-66 (a-c). I think the authors should clarify what of these findings were hard-coded in the model and what were recovered or rationalized by their analysis.</p></disp-quote><p>None of these features were explicitly hard-coded in the model; we address each as a finding of our work. To make this clear, we have rephrased some of our findings in the last paragraph of the introduction (beginning line 189 in updated draft) to parallel the structure of lines 63-66 with the following text: “We recover and reinterpret experimentally observed features: (a) we find that high diversity is not beneficial for bacteria when phage and bacterial diversity is strongly coupled, (b) we show that bacterial immunity can either track new phage mutations rapidly or keep a memory for a long time, but not both, and (c) we find emergent diversity resulting from selection for phage mutations that evade CRISPR targeting, linking diversity to the dynamical quantities of establishment and extinction.”</p><disp-quote content-type="editor-comment"><p>- In several points, the authors comment on the validity of certain trends across a range of parameters, but in the figures several parameters are fixed and then only η (or μ) is varied. I think the authors should refer to the supplementary figures where they show the variation wrt other parameters or have a sentence where they justify why certain parameters are fixed while mainly η is varied. As far as I am concerned, seeing how the behaviours change for lower e is interesting too.</p></disp-quote><p>In most plots that include many simulation data points, all four major parameters (<italic>e</italic>, <italic>µ</italic>, <italic>η</italic>, and <italic>C</italic><sub>0</sub>) are varied, but due to labelling constraints we chose two variables to highlight, usually <italic>C</italic><sub>0</sub> and <italic>η –</italic> this applies to Figures 2B, 3C, and 6B-C. For Figure 2B and we plotted all points separately in panels by parameter in figure supplements, and we have added a reference to these figure supplements in the main text. In Figures 2A-B, 7D, and 7A-B only <italic>η</italic> is varied; we have added figure supplements that show each plot varied with <italic>e</italic> and <italic>µ</italic> as well (Figure 2 supplements 3 and 4, Figure 6 supplements 3 and 4, and Figure 7 supplements 11 and 12).</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>My main concern is the single protospacer parameter mentioned in the public review. Of the parameters mentioned in lines 553-559 (burst lag, spatial structure, autoimmunity, etc…), multiple protospacers, and in reality hundreds of possible protospacers, has the highest likelihood to significantly change the bacteria and phage dynamics. I wonder if the “counter-intuitive result” in line 561 is due to this discrepancy. The authors explore multiple protospacers with a “toy model” in the discussion, but I believe this should be more fully explored in the main Results section, similar to what was done for cross-reactivity.</p><p>This is particularly important because as soon as a phage infects, there are hundreds of potential protospacers. The likelihood that two cells will acquire the same spacer is therefore very, very small and therefore, if a phage escapes one spacer by mutation, it will still be targeted by the vast majority of cells. This is very different from the model the authors use for the bulk of their paper where a phage simultaneously escapes all spacers. I would like to see the analyses repeated with this multiple protospacer scenario which is biologically very relevant.</p></disp-quote><p>We share the view of Reviewer 3 that the number of protospacers and spacers for both bacteria and phages is important for understanding dynamics in this system. We have made significant changes to reflect this, adding a section to the results titled ‘Pathogen and host diversity must be considered together’. First, we note that our results for exponential cross-reactivity are a good approximation for a situation with multiple protospacers and few spacers per bacterium – as phages gain mutations in individual protospacers, their fitness increases gradually (Section 3.5, line 449). In this section we also describe a toy model that explores the relationship between diversity and average immunity when phages and bacteria have multiple spacers and protospacers. We have included more scenarios than in our previous submission to elucidate different realistic types of protospacer diversity, and in all cases we find that average immunity either remains constant or decreases as diversity increases. We emphasize, however, that this model is not a full population dynamics simulation of the multiple-protospacer scenario. Such a simulation is a large undertaking that we believe is better-suited for a follow-up study to this already extensive work.</p></body></sub-article></article>