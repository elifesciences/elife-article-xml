<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">66750</article-id><article-id pub-id-type="doi">10.7554/eLife.66750</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Developmental Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Global constraints within the developmental program of the <italic>Drosophila</italic> wing</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-225307"><name><surname>Alba</surname><given-names>Vasyl</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-225308"><name><surname>Carthew</surname><given-names>James E</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-33625"><name><surname>Carthew</surname><given-names>Richard W</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0343-0156</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-176515"><name><surname>Mani</surname><given-names>Madhav</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5812-4167</contrib-id><email>madhav.mani@northwestern.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Engineering Sciences and Applied Mathematics, Northwestern University</institution><addr-line><named-content content-type="city">Evanston</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>NSF-Simons Center for Quantitative Biology, Northwestern University</institution><addr-line><named-content content-type="city">Evanston</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Department of Molecular Biosciences, Northwestern University</institution><addr-line><named-content content-type="city">Evanston</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Devenport</surname><given-names>Danelle</given-names></name><role>Reviewing Editor</role><aff><institution>Princeton University</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Barkai</surname><given-names>Naama</given-names></name><role>Senior Editor</role><aff><institution>Weizmann Institute of Science</institution><country>Israel</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>28</day><month>06</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e66750</elocation-id><history><date date-type="received" iso-8601-date="2021-01-21"><day>21</day><month>01</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-06-25"><day>25</day><month>06</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Alba et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Alba et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-66750-v2.pdf"/><abstract><p>Organismal development is a complex process, involving a vast number of molecular constituents interacting on multiple spatio-temporal scales in the formation of intricate body structures. Despite this complexity, development is remarkably reproducible and displays tolerance to both genetic and environmental perturbations. This robustness implies the existence of hidden simplicities in developmental programs. Here, using the <italic>Drosophila</italic> wing as a model system, we develop a new quantitative strategy that enables a robust description of biologically salient phenotypic variation. Analyzing natural phenotypic variation across a highly outbred population and variation generated by weak perturbations in genetic and environmental conditions, we observe a highly constrained set of wing phenotypes. Remarkably, the phenotypic variants can be described by a single integrated mode that corresponds to a non-intuitive combination of structural variations across the wing. This work demonstrates the presence of constraints that funnel environmental inputs and genetic variation into phenotypes stretched along a single axis in morphological space. Our results provide quantitative insights into the nature of robustness in complex forms while yet accommodating the potential for evolutionary variations. Methodologically, we introduce a general strategy for finding such invariances in other developmental contexts.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>robustness</kwd><kwd>morphometrics</kwd><kwd>evolvability</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1547394</award-id><principal-award-recipient><name><surname>Carthew</surname><given-names>James E</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1764421</award-id><principal-award-recipient><name><surname>Carthew</surname><given-names>Richard W</given-names></name><name><surname>Mani</surname><given-names>Madhav</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000893</institution-id><institution>Simons Foundation</institution></institution-wrap></funding-source><award-id>597491</award-id><principal-award-recipient><name><surname>Alba</surname><given-names>Vasyl</given-names></name><name><surname>Carthew</surname><given-names>Richard W</given-names></name><name><surname>Mani</surname><given-names>Madhav</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000893</institution-id><institution>Simons Foundation</institution></institution-wrap></funding-source><award-id>Investigator - MMLS</award-id><principal-award-recipient><name><surname>Mani</surname><given-names>Madhav</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A novel mathematical strategy for the integrated analysis of adult body structures quantifies the degree and nature of developmental robustness and its evolutionary implications.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>One of the most salient features of organismal development is its reproducibility and tolerance to environmental and genetic perturbations. The robust development of intricate body structures is striking in light of the complexity of the process, involving a vast number of molecular constituents and interactions across multiple spatial and temporal scales. Despite insights into the molecular complexity of an organism’s developmental program and the intricacies of the mechano-chemical dynamics involved, we lack a deep understanding of how robustness emerges within a complex developmental program and what its generic quantitative signatures must be (<xref ref-type="bibr" rid="bib48">Visser et al., 2003</xref>). The existence of robustness hints at the existence of global constraints within the development program that ensure that the inevitable fluctuations in underlying mechanisms invariably lead to similar outcomes.</p><p>It has been noted that there is an apparent paradox related to robustness (<xref ref-type="bibr" rid="bib50">Wagner, 2008</xref>; <xref ref-type="bibr" rid="bib23">Hansen, 2006</xref>; <xref ref-type="bibr" rid="bib37">Masel and Siegal, 2009</xref>; <xref ref-type="bibr" rid="bib28">Kirschner and Gerhart, 1998</xref>; <xref ref-type="bibr" rid="bib38">Masel and Trotter, 2010</xref>). If some body structure shows evidence of evolving within or between species, it would seem that robustness would antagonize its evolvability. It suggests that there is a conflict between the demands for developmental robustness and the requirement for evolvability. In particular, global constraints on the spectrum of developmental outcomes restrict the nature of varieties that can be selected for by the environment. One explanation to resolve this conflict supposes that the constraints can be temporarily alleviated, resulting in sudden expression of phenotypic diversity from the underlying genetic diversity (<xref ref-type="bibr" rid="bib49">Waddington, 1953</xref>; <xref ref-type="bibr" rid="bib43">Rutherford and Lindquist, 1998</xref>; <xref ref-type="bibr" rid="bib24">Hermisson and Wagner, 2004</xref>). It is unclear how the constraints are alleviated during the natural evolutionary history of organisms. Another explanation supposes that the constraints allow for many different genotypes to generate similar, though not identical, phenotypes (<xref ref-type="bibr" rid="bib50">Wagner, 2008</xref>) Thus, there are many mutations and combinations of mutations that can elicit similar phenotypic change. These very constraints might ensure that the map from an organism’s genotype to phenotype is not idiosyncratic.</p><p>To address these issues, we put forward a general mathematical strategy for the direct quantification of the degree and nature of developmental robustness of a wholly integrated body organ. Historically, developmental robustness has been measured by focusing on one or a few discrete traits that are small parts of a much larger body structure (<xref ref-type="bibr" rid="bib49">Waddington, 1953</xref>; <xref ref-type="bibr" rid="bib19">Dun and Fraser, 1958</xref>; <xref ref-type="bibr" rid="bib41">Rendel, 1959</xref>). Moreover, methods to quantify the morphology of large body structures have all relied on an arbitrary fragmentation of the structure into a handful of composite measurable traits, referred to as landmarks (<xref ref-type="bibr" rid="bib26">Kendall, 1989</xref>; <xref ref-type="bibr" rid="bib10">Bookstein, 1993</xref>; <xref ref-type="bibr" rid="bib18">Dryden and Mardia, 2016</xref>; <xref ref-type="bibr" rid="bib2">Abouchar et al., 2014</xref>; <xref ref-type="bibr" rid="bib15">Debat et al., 2009</xref>; <xref ref-type="bibr" rid="bib29">Klingenberg, 2009</xref>; <xref ref-type="bibr" rid="bib30">Klingenberg and Gidaszewski, 2010</xref>; <xref ref-type="bibr" rid="bib39">Pélabon et al., 2006</xref>). Logically then, landmark-based analysis of morphology is potentially missing important features of morphological variation and an incomplete measure of more global properties such as robustness. We propose that a landmark-free approach to align and statistically analyze a large number of individual variants defines the appropriate statistical ensemble to make apparent any global constraints in play within a developmental system.</p><p>We have chosen the model system of the wing of <italic>Drosophila melanogaster</italic> to conduct this analysis. We chose the wing as the prototype body structure to study because of the comprehensive understanding of its development, with many genes implicated in wing development (<xref ref-type="bibr" rid="bib33">Lecuit et al., 1996</xref>; <xref ref-type="bibr" rid="bib35">Lecuit and Cohen, 1998</xref>; <xref ref-type="bibr" rid="bib34">Lecuit and Cohen, 1997</xref>; <xref ref-type="bibr" rid="bib8">Blair, 2007</xref>), its complex form and function (<xref ref-type="fig" rid="fig1">Figure 1a</xref>), and its clear fitness impact for the organism (<xref ref-type="bibr" rid="bib22">Garcia-Bellido and de Celis, 1992</xref>; <xref ref-type="bibr" rid="bib13">de Celis, 2003</xref>; <xref ref-type="bibr" rid="bib14">De Celis and Diaz-Benjumea, 2003</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Landmark-free morphometrics.</title><p>(<bold>a–c</bold>) Standard landmarks (red) for Procrustes analysis of a <italic>Drosophila</italic> wing (<bold>a</bold>), the beak of a Darwin finch (<bold>b</bold>), and the face of DaVinci’s Vitruvian Man (<bold>c</bold>). (<bold>d–f</bold>), The landmark-free method involves boundary identification of wings (<bold>d</bold>), boundary alignment through conformal mapping to unit discs (<bold>e</bold>), and bulk alignment of wings through optimization in the space of conformal maps from the disc to itself (<bold>f</bold>). (<bold>g</bold>) Pixel entropy of an ensemble of wings from the outbred wildtype population. Enhanced variation of cross-veins is observed (arrows). (<bold>h</bold>) Procrustes analysis of the same ensemble of wings, highlighting variation in the 12 landmark positions. Inset shows the landmark where the L1 and L2 veins intersect.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Procrustes alignment of landmarks.</title><p>(<bold>a</bold>) Image of a <italic>Drosophila</italic> wing with axes labeled. (<bold>b</bold>) Image of a wing with the 12 standard landmarks used in Procrustes analysis. (<bold>c</bold>) Positions of landmarks of outbred wildtype male and female wings after Procrustes alignment. (<bold>d–g</bold>) In order to explain Procrustes alignment, we use a simple example with two triangles of different size, shape, and orientation (<bold>d</bold>). (<bold>e</bold>) The first step is to align their centroids. (<bold>f</bold>) The second step is to scale the two shapes to make them of equal area. (<bold>g</bold>) The last step is rotation to optimally align the shapes. (<bold>h, i</bold>) The simplest case is when the triangles have identical shape (<bold>h</bold>), and as a result, Procrustes alignment generates complete overlap of the vertex landmarks (<bold>i</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Wing boundary identification.</title><p>(<bold>a</bold>) An example of a training layer for Ilastik classification. The model has four layers: wing bulk (yellow), veins (blue), bristles (red), and background (cyan). (<bold>b</bold>) Output of Ilastik. (<bold>c</bold>) Cleaning the layers is required for boundary identification. Therefore, spurious veins appearing on the mask are not a concern. (<bold>d</bold>) Example of a wing image after the wing boundary has been segmented and cleaned. The interior of the wing is unmasked, whereas pixels outside of the wing have been uniformly dimmed. This is done merely for demonstration purposes and is not part of the pipeline. Note that there are two morphological landmarks marked with stars: the alula notch and humeral break. The complete boundary segmentation draws a line between them and excludes the hinge. (<bold>e</bold>) A polygon with vertices (red points) that we use to represent the wing boundary for conformal mapping.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Structure and form of the <italic>Drosophila</italic> wing.</title><p>(<bold>a</bold>) Contrast-limited adaptive histogram equalization (CLAHE). The part of the histogram that exceeds the clip limit redistributes equally among all histogram bins. In contrast to ordinary histogram equalization, CLAHE is applied locally to patches of the image (tiles), and therefore uses several local histograms to redistribute the lightness values of the image. Thus, it is suitable for edge enchantment and improvement of the local contrast in every tile. (<bold>b</bold>) A representative example of a male right wing from the outbred wildtype population that was imaged. (<bold>c</bold>) Schematic of the wing structure. The longitudinal veins include L1, L2, L3, L4, L5, and L6. The cross-veins include the anterior (acv), humeral (hcv), and posterior (pcv) cross-veins. Other veins include the costa (co) and subcosta (sc) veins. (<bold>d</bold>) Schematized conformal map of wing in panel (<bold>c</bold>) showing the approximate locations and paths of the various veins.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig1-figsupp3-v2.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Conformal map representation.</title><p>(<bold>a–c</bold>) An example of the conformal map between a disc (<bold>a</bold>), a triangle (<bold>b</bold>), and a square (<bold>c</bold>) showing polar grids. (<bold>d</bold>–<bold>f</bold>) An example of the conformal map between a square (<bold>d</bold>), a disc (<bold>e</bold>), and for the exponential function <italic>w</italic> = exp(<italic>z</italic>) (<bold>f</bold>) showing Cartesian grids. In all cases, grid lines remain perpendicular to each other. (<bold>g, h</bold>) An irregular polygon (<bold>g</bold>) is mapped onto a unit disc (<bold>h</bold>). The polygon’s vertices (black dots) map to the disc boundary as shown. (<bold>i</bold>) An example of the image mapping from the wing onto the disc. (<bold>j–l</bold>) We mapped polar and Cartesian grids of the same wing for demonstrational purposes. We must define a pre-image of the origin of the wing (<bold>j, k</bold>, left), that is, the point that will be mapped onto the center of the disc (<bold>j, k</bold>, right). For the <italic>Drosophila</italic> wing, it is the black dot at the intersection of the ACV and L4 veins. (<bold>l</bold>) The unit disc has an automorphism, that is, a map onto itself. It means that we can keep the boundary the same, but we still can rotate the disc and we can move the origin of the disc, as shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig1-figsupp4-v2.tif"/></fig></fig-group><p>Carrying out spatial correlation analysis of large ensembles of aligned individual wings, over many genetic and environmental perturbations, we decompose the data to reveal global features of the developmental process. Remarkably, we find that the outcomes of wing development can be statistically described by a one-dimensional (1D) linear manifold in morphological space that corresponds to a non-intuitive combination of structural variations across the wing. This dominant mode is systematically excited by variants generated by very weak mutations in signaling pathway genes as well as by thermal and dietary environmental perturbations. As such, our work provides direct empirical evidence for the presence of global constraints within the developmental program of the wing, funneling environmental inputs and genetic variation into phenotypes stretched along a single axis in morphological space. Our work is a step towards a quantitative characterization and explanation of the robustness of complex living forms. While the developmental outcomes are globally constrained, there exists the potential for morphological variation along the unconstrained direction. This provides a dissolution of the apparent conflict between robustness and evolvability. Finally, this general strategy used to study the wing formulates an approach for finding such constraints in a broader class of developmental processes.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Landmark-free morphometrics</title><p>Current approaches to morphological phenotyping are particularly problematic for body structures with complex form and pattern, where spatial information is often arbitrarily discretized into landmarks – anatomical loci that are homologous in all individuals being analyzed (<xref ref-type="fig" rid="fig1">Figure 1a–c</xref>; <xref ref-type="bibr" rid="bib25">Jones and Mahadevan, 2013</xref>; <xref ref-type="bibr" rid="bib11">Choi and Mahadevan, 2018</xref>). Analysis of phenotypic variation has additional challenges owing to the inability to perform precision alignment of complex two-dimensional (2D) and three-dimensional (3D) shapes, which cannot be achieved through simple schemes that account for rotation, scaling, and shear transformations (<xref ref-type="bibr" rid="bib26">Kendall, 1989</xref>; <xref ref-type="bibr" rid="bib10">Bookstein, 1993</xref>; <xref ref-type="bibr" rid="bib18">Dryden and Mardia, 2016</xref>).</p><p>To overcome these problems, we have developed an alignment tool that admits a landmark-free method to measure the physical totality of all traits in a body subsystem. Using the wing of <italic>D. melanogaster</italic> as the prototype subsystem, the landmark-free method comprises four steps (<xref ref-type="fig" rid="fig1">Figure 1d–f</xref>). First, each wing is imaged by transmitted light microscopy at high resolution (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3b</xref>). Second, the boundary of the wing image is accurately detected (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>; <xref ref-type="bibr" rid="bib7">Berg et al., 2019</xref>). Third, the boundary of the wing image is computationally mapped to the interior of a fixed-sized disc. The mapping of the boundary to the disc relies on an efficient numerical implementation of the Riemann mapping theorem (<xref ref-type="bibr" rid="bib42">Riemann, 1867</xref>; <xref ref-type="bibr" rid="bib4">Ahlfors, 1953</xref>; <xref ref-type="bibr" rid="bib17">Driscoll and Trefethen, 2002</xref>; <xref ref-type="bibr" rid="bib1">Ablowitz et al., 2003</xref>). In particular, the map is conformal, preserving the shape of the image, locally, by preserving angles, while manifestly distorting areas (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). This feature of the approach is both a strength and a limitation, downweighting the effects of variation in boundary shape, and upweighting the effects of the pattern of hairs and veins in the interior of the wing (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4j, k</xref>). Fourth, mapped images are globally registered to one another (<xref ref-type="fig" rid="fig1">Figure 1e, f</xref> and <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4l</xref>) since disc-mapped wings vary in their orientation and region of focus (the central point in the disc). These misalignments are spanned by the space of conformal maps of the disc onto itself, which can be optimized to produce a global registration of the images, as shown in <xref ref-type="fig" rid="fig1">Figure 1f</xref> (further details can be found in Materials and methods). We can thus generate boundary and bulk registered ensembles of wing images, whose variation we can study at single-pixel resolution in a landmark-free manner.</p><p>We imaged wings from a highly outbred population of wildtype <italic>D. melanogaster</italic>. This population was founded from 35 inbred wildtype strains collected worldwide, which were then blended together for 2 years to ensure substantial genetic variation. We visualized the quantitative variation in the ensemble of images at the single-pixel resolution, measured as per-pixel information entropy (<xref ref-type="fig" rid="fig1">Figure 1g</xref>; <xref ref-type="bibr" rid="bib31">Kozachenko and Leonenko, 1987</xref>). Entropy is a measure of the uncertainty, which here is based on variations in image intensity determined on a per-pixel basis (<xref ref-type="bibr" rid="bib36">MacKay and Mac Kay, 2003</xref>). Regions of higher entropy straddle the longitudinal veins, indicating that the positions of these veins along the anterior-posterior (AP) axis vary slightly between individuals; less than a single vein width across the ensemble of wings. However, the proximal region of the L1 vein shows considerable variation, as do some other regions near the hinge. In addition, the cross-veins substantially vary between individuals along the proximal-distal (PD) axis. The intervein region between L1 and L2 veins and the intervein regions near the distal tip also show variation owing to variation in wing hair location. A Procrustes analysis of the same wing ensemble is limited to the variation in landmarks alone, with the intersection of L1 and L2 veins being the most variable (<xref ref-type="fig" rid="fig1">Figure 1h</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1c</xref>). An anatomical description of the <italic>Drosophila</italic> wing can be found in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3c, d</xref>.</p><p>The wings of male and female <italic>Drosophila</italic> differ in their size, shape, and pattern (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1a, b</xref>), providing a setting to compare the landmark-based and landmark-free approaches to distinguishing two populations. By Procrustes landmark analysis, the intersection of L1 and L2 veins shows the greatest sexual dimorphism, with substantial non-overlap between male and female (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). The intersection of L1 and L5 veins also shows sexual dimorphism. A very different perspective is revealed using our landmark-free method (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). The relative entropy of pixel intensities across the two ensembles demonstrates that sexual dimorphism is not restricted to the landmarks. In particular, the proximal and distal regions of the L1 vein are variable between male and female. The L3 vein proximal to the cross-vein also shows considerable variation. Strikingly, the regions showing sexual dimorphism do not spatially overlap with the regions showing variation within each wildtype population. In summary, this comparative analysis demonstrates the remarkable sensitivity of our landmark-free method to make precise measurements of the variational properties of wing form, as well as demonstrating the incomplete picture of variation provided by landmarks alone.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Comparison of Procrustes and landmark-free phenotyping.</title><p>(<bold>a, b</bold>) Variation between ensembles of male and female wings from the outbred wildtype population. (<bold>a</bold>) Procrustes analysis with inset showing the landmark where L1 and L2 veins intersect. (<bold>b</bold>) Per-pixel symmetrized Kullback–Leibler divergence in landmark-free analysis detects variation along veins, undetected by landmark-based analyses. (<bold>c</bold>) The dimensions of phenotype space comprise individual pixels. Three such pixels are randomly selected here to show their 3D phenotype space. An ensemble of wings are points in this space. The direction of largest variation in the space is identified by principal component analysis (PCA) as PC1. (<bold>d</bold>) Landmark-free PCA of the outbred wildtype population reveals a novel dominant direction of variation orthogonal to sex-specific variation. Sex-specific variation aligns with PC2. (<bold>e</bold>) Pixel alignment with PC1 analysis shown in panel (<bold>d</bold>), showing vein position variation aligns with PC1. (<bold>f</bold>) Procrustes-based PCA of the same ensemble analyzed in panel (<bold>d</bold>). PC1 only detects the sex-specific variation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Accounting for the variation in wings.</title><p>(<bold>a</bold>) Area distribution of wings from outbred wildtype females and males raised on a standard rich diet at 25°C. (<bold>b</bold>) Kullback–Leibler divergence between the male and female ensembles with single-pixel resolution. It was computed using second-nearest-neighbor Kozachenko–Leonenko estimator. (<bold>c</bold>) Cross-correlation between scores for principal component (PC) derived from Procrustes (landmark-based) and landmark-free analysis. Strong correlation is only observed between PC1 of the Procrustes analysis and PC2 of the landmark-free analysis. Both were identified as the axis pertaining to sexual dimorphism. This further highlights that the novel direction identified by our landmark-free analysis is absent in the principal component analysis (PCA) of the Procrustes analysis. (<bold>d</bold>–<bold>f</bold>) PCA plots of outbred male and female wings by landmark-free analysis, visualizing wing handedness (<bold>d</bold>), background pixel intensity (<bold>e</bold>), and area of the wing (<bold>f</bold>). Neither handedness, background intensity, nor wing area are the origins of the dominant mode observed in the landmark-free analysis. (<bold>g, h</bold>) Distribution of wing area for males (<bold>g</bold>) and females (<bold>h</bold>) at 18°C, 25°C, and 29°C. (<bold>i, j</bold>) Distribution of wing area for males (<bold>i</bold>) and females (<bold>j</bold>) raised on rich or restricted diets.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Mean wing conformal maps from animals raised under different conditions or with different genotypes.</title><p>(<bold>a</bold>) Mean wings from ensembles of outbred wildtype (WT) male and female flies raised under the diet and temperature conditions, as indicated. Differences between mean wings are subtle and require quantitative analysis to discern differences. (<bold>b</bold>) Mean wings from the ensembles of WT and heterozygous mutants, as indicated. Note how qualitatively similar the mean wings are to one another by eye. (<bold>c</bold>) Per-pixel variation within the ensembles shown in panel (<bold>a</bold>) is displayed as entropy plots. The Kozachenko–Leonenko second-nearest-neighbor estimator was used.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Alignment of axis of sexual dimorphism rotates as a function of environmental stress across 4 different conditions.</title><p>(panels <bold>a-d</bold>) and the degree of alignments betweeen the axis of sexual dimorphism and the top principal components of each of the conditions (panel <bold>e</bold>). As is apparent in the scatter plots in panels a-d and the quantitative assessment in panel e, the axis of sexual dimorphism rotates into the top principal component in stressed conditions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig2-figsupp3-v2.tif"/></fig></fig-group></sec><sec id="s2-2"><title>A dominant mode of natural phenotypic variation</title><p>We note that the space in which phenotypes are parameterized via our landmark-free approach is vast. The intensity of each pixel in the space of disc-mapped images is identified with a unique dimension (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). Therefore, an individual image is a single point in this phenotype space of ~30,000 dimensions (pixels). By contrast, the standard landmark-based parameterization of the wing defines phenotype in 24 dimensions – the <italic>x</italic> and <italic>y</italic> locations of 12 landmarks. By way of illustration, we portray an ensemble of wildtype wings populating a 3D slice of this vast phenotypic space (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). The dominant mode of variation in the population is indicated as the ‘long axis’ of the cloud of points. To find the major axes of variation within the 30,000-dimensional space, we performed principal component analysis (PCA) on male and female wings from the outbred stock raised under standard environmental conditions. PC1 and PC2 axes account for 68% of the total variation, with 66% of the variation aligned along PC1 (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). Strikingly, male and female wings are separated along PC2, suggesting that the dominant mode of variability is not sex-specific. This dominant mode of variability is also not congruent with left-right patterning (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1d</xref>), variation in wing size (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1e</xref>), or variation in imaging conditions across the ensemble (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1f</xref>). We mapped pixels whose variation is most aligned with PC1 and found vein positions are most prominent, particularly in the proximal region (<xref ref-type="fig" rid="fig2">Figure 2e</xref>). We also performed PCA on the Procrustes landmark data from the wildtype ensemble and observed that sexual dimorphism is the dominant source of detected variation (<xref ref-type="fig" rid="fig2">Figure 2f</xref>). Strikingly, the dominant mode made manifest in our landmark-free analysis is undetected by a landmark-based method (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1c</xref>), demonstrating that novel, even dominant, modes of variation are rendered detectable by our more holistic analysis.</p></sec><sec id="s2-3"><title>Genetic and environmental variation</title><p>To investigate the origins of this dominant mode of variation, we performed landmark-free analysis on a published dataset of wing images from the wildtype Samarkand strain and from animals heterozygous for weak mutations in signal transduction genes (<xref ref-type="bibr" rid="bib44">Sonnenschein et al., 2015a</xref>). Specifically, these genes act in the Notch, bone morphogenetic protein (BMP), and EGF receptor (EGFR) pathways, which are required for proper growth and patterning of the developing <italic>Drosophila</italic> wing (<xref ref-type="bibr" rid="bib8">Blair, 2007</xref>). Note that all of the mutations are considered to be recessive to wildtype for wing phenotypes, and thus the heterozygous animals do not exhibit easily discernible differences in wing form from wildtype. Since stronger effect mutations produce phenotypes rarely seen in a natural population, the weak nature of these genetic perturbations is crucial to our investigations into the origins of natural variation. Mutant wing images were subjected to our landmark-free analysis. The high-dimensional phenotype space occupied by each mutant population was compared to the reference wildtype population. This was done by finding the centroid (center of mass) for each population’s cloud of points, which constitutes its average phenotype. We then considered the line joining each mutant centroid and the reference wildtype centroid, which represents the difference between the average mutant and wildtype phenotypes. For illustration, a simplified 3D example is shown in <xref ref-type="fig" rid="fig3">Figure 3a</xref>. The spatial maps of the mutant-wildtype differences in pixel intensities are revealing (<xref ref-type="fig" rid="fig3">Figure 3b–e</xref>), and they show how our method can detect even subtle effects (see Materials and methods). Mutation of the <italic>Egfr</italic> gene causes L3 and L4 veins to be slightly more distant from one another, whereas mutation of <italic>Star</italic>, which encodes an inhibitor in the EGFR pathway, has the opposite effect. The posterior cross-vein is also affected by these mutants. Both <italic>mastermind (mam)</italic>, a component in the Notch pathway, and <italic>thick veins (tkv)</italic>, a component in the BMP pathway, have common effects in that L2–L4 slightly shift anterior. However, <italic>tkv</italic> shows evidence of subtle vein thickening, which is an attribute of the homozygous mutant phenotype. We conclude that the landmark-free method is sensitive enough to robustly detect phenotypic differences in mutant alleles that are historically considered to be completely recessive to wildtype.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Variational analysis of genetic mutants.</title><p>(<bold>a</bold>) Schematic of hypothetical 3D phenotype space, with each cloud of points representing wings from an ensemble subject to a different treatment or condition. The principal component (PC)1 vector for each cloud of points can be independently calculated. The vectors joining the centroids of any two clouds of points can also be calculated. The angles between the direction of maximal variation (PC1) of the reference population and the directions from the reference to test ensembles are measured (θ<italic>A</italic> and θ<italic>B</italic>). (<bold>b-e</bold>) Per-pixel intensity difference between each mutant and the wildtype reference as measured at the center of each point cloud. Negative values are when mutant pixel intensity is smaller than wildtype, and positive values are when mutant pixel intensity is larger. Comparison between wildtype and <italic>egfr</italic> (<bold>b</bold>), <italic>mam</italic> (<bold>c</bold>), <italic>Star</italic> (<bold>d</bold>), and <italic>tkv</italic> (<bold>e</bold>) ensembles. (<bold>f</bold>) The cosine of the angle between the directions of PC1–PC4 of the outbred wildtype population, and the directions of the vectors connecting the wildtype and mutant populations. M and F refer to male and female groups, respectively. (<bold>g</bold>) The cosine of the angle when the wildtype and mutant populations analyzed in panel (<bold>f</bold>) are shuffled but the sexes are not. Shuffling leads to little or no alignment of mutant vectors with any PC.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Radon transformation.</title><p>(<bold>a</bold>) A Radon transform maps <italic>f</italic> on the (<italic>x</italic>, <italic>y</italic>) domain to <italic>Rf</italic> (<italic>r</italic>, β) on the (<italic>r</italic>, β) domain. The function <italic>f</italic> is equal to 255 in the blue squares and 0 otherwise. This simulates an 8-bit image containing only the minimum and maximum intensity values. A transformation of <italic>f</italic> onto a line with an angle of β generates values of <italic>Rf</italic> that vary as a function of <italic>r</italic>, the position along the line. Note that <italic>Rf</italic> values are not binary, unlike the original image. The range and resolution of <italic>Rf</italic> values is much greater. (<bold>b–e</bold>) How a Radon transform makes line variation easier to detect. The reference image is a simple horizontal black line on the white disc (<bold>b</bold>), while the test image used for comparison is the same line but rotated by angle α (<bold>c</bold>). The angle is systematically rotated in the test image, and the distance between test and reference images is measured and plotted. Distance is normalized to the distance between the reference image and the test image rotated by 90°. This analysis was performed in image space (<bold>d</bold>) and Radon space (<bold>e</bold>). Note how distance in image space is switch-like in dependence on angle as opposed to the dependence in Radon space. (<bold>f–i</bold>) Example binary images before Radon transformation (<bold>g, i</bold>). Radon transforms of the images showing <italic>Rf</italic> values as heat maps on the plots of distance <italic>r</italic> in pixel units and angle in degrees (<bold>f, h</bold>). (<bold>j, k</bold>) A contrast-enhanced (contrast-limited adaptive histogram equalization [CLAHE]) wing image conformally mapped to a disc (<bold>k</bold>). <italic>Rf</italic> values are shown as a heat map on the plot of distance <italic>r</italic> in pixel units and angle in degrees (<bold>j</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Eigenvalue spectrum in wings.</title><p>For each ensemble of wings, we performed alignment to the reference wing and Radon transformation. For each population, we performed principal component analysis on a single population. As a result, we obtained spectrum of the eigenvalues. We present cumulative normalized sum for these spectrums. (<bold>a</bold>) Eigenvalue spectrum for egfr mutant. (<bold>b</bold>) Eigenvalue spectrum for mam mutant. (<bold>c</bold>) Eigenvalue spectrum for wildtype. (<bold>d</bold>) Eigenvalue spectrum star mutant. (<bold>e</bold>) Eigenvalue spectrum tkv mutant.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Bootstrap for genetic ensemble.</title><p>(<bold>a</bold>) Bootstraped distributions for the degree of alignments in mutant conditions, for males and females. (<bold>b</bold>) Box whisker plots summarizing histograms in panels a. Alignment distributions of different mutants.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 4.</label><caption><title>Statistical significance (p-values) of alignments in genetic analyses relative to a shuffled label null distribution.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig3-figsupp4-v2.tif"/></fig></fig-group><p>How does the phenotypic variation in the mutants compare with the phenotypic variation in the outbred wildtype population? We measured the alignment between the top four vectors of variation in the outbred population (PC1–PC4), and the vectors connecting Samarkand and mutant centroids (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). The cosine of the angle <inline-formula><mml:math id="inf1"><mml:mi>θ</mml:mi></mml:math></inline-formula> between each PC vector and each centroid-centroid vector is reported in <xref ref-type="fig" rid="fig3">Figure 3f</xref>. There is a high degree of alignment between the dominant mode of variation (PC1) in the outbred population and almost all of the mutants (<inline-formula><mml:math id="inf2"><mml:mrow><mml:mrow> <mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> as <inline-formula><mml:math id="inf3"><mml:mi mathvariant="normal">θ</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>). With the exception of the male population of <italic>Star</italic> heterozygotes, the degrees of alignment are far above those expected by chance due to sample size effects or artifacts in the imaging and analysis pipeline (<xref ref-type="fig" rid="fig3">Figure 3g</xref>). As such, the mutant phenotypes statistically align with a single direction, which is identified as the direction of dominant variation in an outbred wildtype population. We note that the mutants affect distinct signaling pathways, which play significant and separate roles in wing development, thus highlighting the nontrivial nature of the statistical alignment we observe. Taken together, these small-effect genetic perturbations – both the recessive mutations and the variants in the outbred populations – excite variation along a single integrated mode of variation in the wing.</p><p>To investigate the nature of developmental variants generated due to perturbations in environment, we raised the outbred wildtype population at different temperatures from the standard 25°C. As previously observed, increasing temperature causes a decrease in wing size (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1g, h</xref>). The differences between the average wing phenotypes at different temperatures were spatially mapped (<xref ref-type="fig" rid="fig4">Figure 4a, b</xref>). We also raised the outbred population on nutritionally limited food, which decreases wing size (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1i, j</xref>; <xref ref-type="bibr" rid="bib21">Ferreira and Milán, 2015</xref>). The average wing phenotype due to nutrient limitation also reveals robust spatial variation (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). Remarkably, there is a strong statistical alignment of the temperature and dietary phenotypes with the dominant mode of variation within the outbred population raised under standard environmental conditions (<xref ref-type="fig" rid="fig4">Figure 4d, e</xref>). Thus, small-effect environmental perturbations are also constrained in their impact on wing phenotype, aligning with the previously identified single mode of variation.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Variational analysis of environmental perturbations.</title><p>(<bold>a–c</bold>) Per-pixel intensity difference between wings from a test condition (described on left) and a reference condition (described on the right). Difference is measured at the center of each point cloud. Negative values are when test pixel intensity is smaller than reference, and positive values are when test pixel intensity is larger. Comparison between wings from 18°C and 25°C (<bold>a</bold>), 29°C and 25°C (<bold>b</bold>), and restricted vs. rich diet (<bold>c</bold>) treatment. (<bold>d</bold>) The cosine of the angle between the directions of principal component (PC)1–PC4 of the outbred wildtype population, and the directions of the vectors connecting the populations raised under different temperature and diet conditions. M and F refer to male and female groups, respectively. (<bold>e</bold>) The cosine of the angle when the treated populations analyzed in panel (<bold>d</bold>) are shuffled but the sexes are not. Shuffling leads to little or no alignment of vectors with any PC.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Kullback–Leibler divergence between left and right wings for each populations of female flies.</title><p>(<bold>a</bold>) 25°C, low diet, (<bold>b</bold>) 25°C, (<bold>c</bold>) 29°C, (<bold>d</bold>) 18°C, and (<bold>e</bold>) 18°C random left-right label assignment for population of 18°C.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Eigenvalue spectrum in wings.</title><p>For each ensemble of wings, we performed alignment to the reference wing and Radon transformation. For each population, we performed principal component analysis on a single population. As a result, we obtained spectrum of the eigenvalues. We present cumulative normalized sum for these spectrums. (<bold>a</bold>) Eigenvalue spectrum for low diet and normal temperature (25°C). (<bold>b</bold>) Eigenvalue spectrum for rich diet and low temperature (18°C). (<bold>c</bold>) Eigenvalue spectrum for rich diet and normal temperature (25°C). (<bold>d</bold>) Eigenvalue spectrum for rich diet and high temperature (29°C).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Bootstrap for environmental ensembles.</title><p>(<bold>a</bold>) Bootstraped distributions for the degree of alignments for the environmental ensembles. Variability is far greater in the stressed populations at 29c and low diet. (<bold>b</bold>) Box whisker plots summarizing histograms in panels a. Alignment distributions of environmental ensembles.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig4-figsupp3-v2.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 4.</label><caption><title>Statistical significance (p-values) of alignments in environmental analyses relative to a shuffled label null distribution.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig4-figsupp4-v2.tif"/></fig></fig-group></sec><sec id="s2-4"><title>Geometric analysis of phenotypic variation</title><p>Why are some perturbation phenotypes, for example, <italic>Star</italic> mutant male wings, less aligned to the primary mode of natural phenotypic variation than others (<xref ref-type="fig" rid="fig3">Figures 3f</xref> and <xref ref-type="fig" rid="fig4">4d</xref>)? Either phenotype is less constrained for some perturbations or some underlying feature of the data was not being considered. Here, we demonstrate that a geometric feature of the data alone explains the observed variations in alignment.</p><p>We consider a situation where wing phenotypes of a population can lie a small distance, <inline-formula><mml:math id="inf4"><mml:mi>σ</mml:mi></mml:math></inline-formula>, away from the axis of primary variation (PC1) of a reference group (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). We define <italic>R</italic> to be the centroid-centroid distance between the two groups, the strength of the phenotypic difference, and <inline-formula><mml:math id="inf5"><mml:mi>θ</mml:mi></mml:math></inline-formula> to be the angle between the axis of primary variation of the reference group and the vector connecting the centroids of the two groups, a measure of alignment. The three quantities are related through a simple trigonometric relation, <inline-formula><mml:math id="inf6"><mml:mi>σ</mml:mi><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>θ</mml:mi></mml:msqrt></mml:math></inline-formula>, which mathematically embodies the intuitive fact that if small-effect perturbations can only access a small region of phenotype space perpendicular to the axis of primary variation, then the measure of alignment must increase with the strength of the perturbation. This would mean that <inline-formula><mml:math id="inf7"><mml:mi>σ</mml:mi><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> as <inline-formula><mml:math id="inf8"><mml:mi>R</mml:mi></mml:math></inline-formula> increases (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). Strikingly, this relation is observed for all of the environmental and mutant perturbations, analyzed by bootstrapped subsampling of the data (<xref ref-type="fig" rid="fig5">Figure 5b, c</xref>). The results suggest that for all of the genetic and environmental perturbations tested, they generate minor phenotypic deviation orthogonal to the primary mode of natural phenotypic variation. Most variations manifested by the perturbations align with the primary mode of natural variation. For example, the departure of <italic>Star</italic> mutant male wings from alignment with the primary mode of variation (<xref ref-type="fig" rid="fig3">Figure 3f</xref>) can be explained by the weak phenotypic difference they have, as demonstrated by the short distance between <italic>Star</italic> and wildtype centroids (<xref ref-type="fig" rid="fig5">Figure 5b</xref>). In summary, we demonstrate that the nature of phenotypic variation caused by diverse weak genetic and environmental perturbations in the fly wing is constrained along a single 1D manifold that aligns with the phenotypic variation seen within every population.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Geometric analysis of dominant variational mode.</title><p>(<bold>a</bold>) Schematic of a data manifold with a single dominant linear direction of variation, embedded in high-dimensional phenotype space. Variation orthogonal to the dominant direction is visualized with a characteristic scale, σ. In the presence of such a data manifold, the angle between the dominant direction of a reference population, principal component (PC)1, and the centroid-to-centroid vector connecting any two populations is predicted to decrease as a function of R, the length of the centroid-to-centroid vector. (<bold>b, c</bold>) The angle between the direction of maximal variation (PC1) in a reference population (RP) and the centroid-to-centroid vector connecting the RP and a second population as indicated. This is shown as a function of R, the distance between them. Samples are bootstrapped to indicate the in-sample variance, with each bootstrap represented by a point. Both in the mutant/wildtype (WT) (<bold>b</bold>) and environmental (<bold>c</bold>) ensembles, alignment grows as a function of distance, indicative of a single dominant direction in the data manifold. The dotted lines represent the relationship between σ /R versus R if sigma was a constant.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Geometric analysis of dominant mode.</title><p>We observe the expected increase in alignment between directions of variation and directions connecting distinct populations. We fitted power laws to the experimental value of the trigonometric quantity <inline-formula><mml:math id="inf9"><mml:msqrt><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi/><mml:mi>θ</mml:mi></mml:msqrt></mml:math></inline-formula>. One-dimensional structure may be cylinder (if <inline-formula><mml:math id="inf10"><mml:mi>α</mml:mi><mml:mi/><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>) or a cone-like structure if <inline-formula><mml:math id="inf11"><mml:mi>α</mml:mi><mml:mi/><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. An exact cylinder case means that 'noise' is constant along the axes, while other power means that 'noise' changes with distance in this space.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Robustness of manifold geometry to perturbations in image analysis pipeline.</title><p>In each panel, sigma/R vs. R is plotted. (<bold>a</bold>) Original data, (<bold>b</bold>) random perturbation to location of origin, (<bold>c</bold>) random shift of hinge cut points, and (<bold>d</bold>) boundary perturbations. The schematics in panels (<bold>e–h</bold>) provide a visual representation of the nature of perturbations explored.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig5-figsupp2-v2.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>Degree of alignment and analysis of global geometry of (<bold>a, b</bold>) log-transformed data and (<bold>c, d</bold>) log-transformed inverse data.</title><p>Representative images are included in (<bold>e–g</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-66750-fig5-figsupp3-v2.tif"/></fig></fig-group></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we present evidence for the presence of strong global constraints within the development program of the <italic>Drosophila</italic> wing. Leveraging a new mathematical strategy to statistically analyze large ensembles of wings across multiple conditions, we demonstrate that natural variants can be described by a 1D linear manifold in morphological space that corresponds to a non-intuitive combination of structural variations that are spatially extended across the wing. Strikingly, the single phenotypic mode is also excited by weak genetic perturbations in distinct developmental pathways, suggesting that its encoding is more global than any particular gene or pathway. As such, our study indicates the presence of strong constraints that limit the spectrum of phenotypic varieties when confronted with small changes in the genetic and environmental conditions of development. The spectrum of investigated phenotypes stand in contrast to the those associated with strong-effect genetic mutations that manifestly probe additional phenotypic dimensions that are absent in natural populations.</p><p>We hypothesize two developmental processes that could potentially give rise to such an integrated mode of phenotypic variation. First, thick proveins are refined into narrow veins during pupal development, allowing for the possibility to globally alter the final resting place of veins (<xref ref-type="bibr" rid="bib8">Blair, 2007</xref>). Second, the number, size, and shapes of intervein epidermal cells might vary, and after expansion, separate neighboring veins by different distances (<xref ref-type="bibr" rid="bib27">Kicheva et al., 2007</xref>; <xref ref-type="bibr" rid="bib9">Bollenbach et al., 2008</xref>; <xref ref-type="bibr" rid="bib52">Wartlick et al., 2011</xref>; <xref ref-type="bibr" rid="bib3">Aguilar-Hidalgo et al., 2018</xref>). These effects could be exacerbated in the proximal wing during hinge contraction, which occurs over an extended period of time (<xref ref-type="bibr" rid="bib5">Aigouy et al., 2010</xref>; <xref ref-type="bibr" rid="bib20">Dye et al., 2017</xref>; <xref ref-type="bibr" rid="bib46">Sui et al., 2018</xref>).</p><p>We believe that there are three distinguishing characteristics of the approach that facilitated our discovery. First, the precision boundary and bulk alignment of wings permit a more holistic, landmark-free, approach to parameterizing phenotype. Although we apply the approach to one body structure, the <italic>Drosophila</italic> wing, it can be applied to any 2D surface with no holes. This could be a simple 2D shape like the wing or the closed surface of a complex 3D shape such as a tooth, brain, or another body part. Second, transformations that are learned from the data are those that interpolate between different individuals within an outbred <italic>D. melanogaster</italic> population and those subject to mild genetic and environmental perturbations. This stands in sharp contrast to the more severe phenotypes generated by strong-effect mutations. Third, our approach is statistical, involving the analysis of large ensembles of wings, permitting a quantitative analysis of variance. We propose that it is these three features of our approach that permits the data-driven discovery of global phenotypic constraints in the <italic>Drosophila</italic> wing developmental program and lays the foundations for doing so in other developmental contexts.</p><p>Our work presents a general strategy for the quantitative case study of the emergence of robustness and evolvability in complex developmental forms. In the context of the fly wing, we quantify the degree and nature of developmental robustness, which we demonstrate funnels diverse environmental and genetic variation into a 1D, spectrum of phenotypes. Wing development is robust in that the final body structures are statistically constrained to lie along this mode and not elsewhere in morphological space. However, it indicates that the wing is also evolvable because varieties produced along this mode are highly probable. Indeed, our work suggests that the map from genotype to this constrained set of phenotypes is massively degenerate, wherein a vast number and variety of genetic and environmental changes produce similar phenotypic outcomes. As such, our study suggests that global constraints are required to insulate the system from the idiosyncratic and random nature of genes and their mutations. The correspondence between the constrained phenotypic mode identified in this study and fitness remains unclear. The mode might correspond to changes in organismal form that buffer the system from perturbations with little or no impact on fitness. Alternately, the identified mode could correspond to the most broadly conserved aspects of fitness. Disambiguating between these possibilities is central to understand the origins and consequences of such phenotypic constraints. Stepping back, since the spectrum of developmental varieties provide the menu options for the environment to select from, our discovery suggests that closely related species ought to diverge along the phenotypic axis we detect here. If found, an alignment between the statistical properties of a developmental and evolutionary ensemble would lay the groundwork for a quantitative approach to the study of evolutionary-developmental biology.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Fly husbandry</title><p>Cornmeal-molasses food was used for standard husbandry. Inbred lines were kept in bottles or vials. The outbred population was kept at 25°<italic>C</italic> in an 8.8 L population cage. The size of the cage and food availability limited the population size to 1000–2000 adults per generation. Populations were raised in Percival incubators. The temperature of incubators was monitored daily. Fly bottles or vials were monitored for moisture levels. Any condensed moisture on the inside of the container walls was absorbed using Kimwipes. Incubators were monitored for mite infestations using mite traps checked daily.</p></sec><sec id="s4-2"><title>Construction of the outbred wildtype population</title><p>A collection of 35 wildtype <italic>D. melanogaster</italic> stocks were obtained from the Bloomington Drosophila Stock Center (BDSC). These inbred stocks originated from founder individuals isolated from around the world (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). Fourteen stocks were established in the 20 century from four continents plus the island of Bermuda: one from Africa, three from Asia, one from Bermuda, four from Europe, and five from North America. The other 21 stocks were established in 2003 as isogenic lines from the Drosophila Genetics Resource Panel (DGRP). Founders of the lines were isolated in the area of Raleigh, NC, USA.</p><p>Six of the DGRP isogenic stocks were randomly paired with one another, and 20 males from one stock were mated with 20 females from the other stock (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). The offspring from these three crosses were then used in addition to the remaining 29 inbred stocks for a new round of pairwise mating – 16 F0 crosses in total (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). The assignment of stocks to pair was made randomly, as were the assigned sexes used in each paired mating. Again, 20 males from one were mated with 20 females from the other. The offspring from these 16 crosses were used for another round of pairwise mating – eight F1 crosses in total (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). The assignment of stocks to pair was made randomly, as were the sexes used in each mating. For these crosses, 50 males from one were mated with 50 females from the other. The offspring from these eight crosses were used for an F2 round of pairwise mating – four crosses in total (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). The assignment of stocks to pair was made randomly, as were the sexes used in each mating. For these crosses, 100 males from one were mated with 100 females from the other. The offspring from these four crosses were used for an F3 round of pairwise mating – two crosses in total (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). The assignment of stocks to pair was made randomly, as were the sexes used in each mating. For these crosses, 300 males from one were mated with 300 females from the other. The offspring from these two crosses were used for a final round of mating. For this cross, 800 males from one were mated with 800 females from the other. Mating was performed in a population cage. The population cage was 8.8 L in volume. Offspring from this final cross constituted the outbred stock, the net result of the systematic mixing of 35 distinct populations. The outbred stock was then propagated in population cages for another 50 generations. The purpose of this was for the population to approach equilibrium in allele frequencies.</p></sec><sec id="s4-3"><title>Temperature and diet perturbations</title><p>Twenty-five mating pairs of outbred adults were mated for 2 days in a bottle, and offspring were raised at a uniform temperature of 18°C, 25°C, or 29°C in Percival incubators. Standard cornmeal-molasses food was used. To compare the effects of rich versus limited diet, 25 mating pairs of the outbred population were mated for 2 days in a bottle, and offspring were raised on food with low yeast content. We used the food recipe described in <xref ref-type="bibr" rid="bib21">Ferreira and Milán, 2015</xref>. The low-yeast food recipe is 1 L food contains 20 g dried bakers’ yeast (Bakemark), 100 g sucrose (Sigma), 27 g Bacto Agar (Difco), 3 mL propionic acid (Sigma), and 30 mL 10% (w/v) Tegosept in ethanol (Sigma).</p></sec><sec id="s4-4"><title>Wing mounting</title><p>Young adults were sorted by sex and stored in 70% (v/v) ethanol for a minimum of 24 hr. Flies were discarded if they had a torn or wrinkled wing. A single fly was dissected in a few drops of 70% ethanol solution on a microscope slide. Wings were removed by clasping the wing joint with a pair of forceps and pulling the wing from the body, using a different pair of forceps to hold the body in place. Both left and right wings were dissected, and the carcass was discarded. Both wings were then placed in a small volume of 70% ethanol solution on the microscope slide ventral side down. A few drops of 70% (v/v) glycerol were added to the wings/ethanol on the slide. If the alula was folded onto the dorsal side of a wing, it was unfolded or removed. A coverslip was placed over the two wings, and any bubbles under the wings were removed by gently pressing down on the coverslip with a pair of blunt forceps. Only the left and right wings from one adult were mounted per slide.</p></sec><sec id="s4-5"><title>Microscopic imaging</title><p>Imaging was performed using a Zeiss Axioplan microscope. A 4× 0.1 NA Plan Apochromatic objective was used and the Optivar was set to 1.25× magnification. The camera adaptor magnification was 0.5×. This gave a total magnification of 2.5×. The condenser was focused and centered on a wing specimen, and then the stage was moved in order to define shading correction at a neutral point with no slide or wing in the image. Specific shading correction was defined before any images were taken in an imaging session. Each wing had two images taken: one with unfiltered light from the microscope’s halogen lamp at 100% power, and one with the green filter in place between the lamp and specimen. The slide remained in the exact same position for each of the two images. After one wing was imaged, its partner wing was then imaged. Wing images were taken so that the anterior side of the wing faced downwards in the image so as to eliminate confusion between right and left wing labeling. If either wing appeared damaged or if dust or debris marked either wing, we rejected that wing and its partner wing. For some female wings, the specimen was too large to be captured in one image. For these, we captured a portion of each wing in one image and then moved the stage to capture the rest of the wing in a separate image. The two images had sufficient overlap that they could be computationally stitched together post-imaging.</p><p>Images were captured as CZI files with a Zeiss Axiocam ERc 5s attached to a Dell XPS 8500 computer using ZEN Blue 3.1 imaging software. Each image had dimensions of 2560 × 1920 pixels, and each pixel intensity was recorded in 8-bit RGB mode. Each CZI file was converted to a TIFF file using the Bio-Formats 6.5.1 plugin for Matlab. Exposure time was 0.3 ms for white-lit images and 0.4 ms for green-lit images. Color balance was set to auto. The intensity level was set at 100%. This ensured that the background was not saturated, that is, background pixel intensity was not maximal. The average background pixel intensity was reproducibly between 210 and 215 for almost all wing samples (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1e</xref>). For those wing samples that were captured using two overlapping images, we used the Photomerge algorithm in Adobe Photoshop CS3 with default settings. Although both white-lit and green-lit images were captured for each wing, we only used the green channel of the green-lit RGB files for further analysis.</p><p>We analyzed both left and right wings for each individual. The datasets generated for the following conditions were 18°C (169 females and 71 males), 25°C (202 females and 202 males), 29°C (185 females and 208 males), and 25°C limited diet (216 females and 219 males).</p></sec><sec id="s4-6"><title>Image analysis of genetic mutants</title><p>We used a publicly available image database of <italic>D. melanogaster</italic> wings that had been used for landmark analysis by others (<xref ref-type="bibr" rid="bib44">Sonnenschein et al., 2015a</xref>). Briefly, P-element insertion mutants in the <italic>epidermal growth factor receptor (Egfr), mastermind (mam), Star (S), and thick veins (tkv)</italic> genes had been extensively backcrossed into the Samarkand wildtype strain in order to introgress their genetic backgrounds with Samarkand. Each P-element mutant is described as hypomorphic when homozygous, meaning that they are weak loss-of-function mutations. They were crossed to the Samarkand strain to generate heterozygous mutant offspring. These were the wings that had been imaged in addition to fully wildtype Samarkand wings, and all were deposited in a public database (<xref ref-type="bibr" rid="bib45">Sonnenschein and Chari, 2015b</xref>).</p><p>We rejected some images due to quality issues that included but were not limited to dust, non-homogeneous illumination, damage to the wings. The remaining images were used for landmark-free analysis: wildtype (214 females and 200 males), <italic>Egfr</italic> (231 females and 236 males), <italic>mam</italic> (212 females and 260 males), <italic>S</italic> (230 females and 222 males), and <italic>tkv</italic> (232 females and 232 males).</p></sec><sec id="s4-7"><title>Landmark-based morphometrics</title><p>Landmarks are defined as anatomical loci that are unambiguously identifiable and are homologous in all individuals being analyzed. In the case of the <italic>D. melanogaster</italic> wing, 12 points where wing veins intersect have been historically used as landmarks (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1a</xref>). We used the Wings 4 software tool that had been developed specifically to automatically identify the position of the 12 landmarks on each wing. The software fits a spline model of the wing to each picture of the wing. The software and manual can be found in <xref ref-type="bibr" rid="bib47">van der Linde, 2003</xref>.</p><p>Once the landmarks were identified for each image, the ensemble of landmarks was aligned using a standard Procrustes method (<xref ref-type="bibr" rid="bib12">contributors, 2020</xref>). In the Procrustes analysis, objects are superimposed by optimal translation, rotation, and uniform scaling of the objects. Both the placement in space and the size of the objects are freely adjusted. The aim is to obtain a similar placement and size by minimizing the Procrustes distance between the objects.</p><p>As a hypothetical example, we take a sample triangle and align it with a reference triangle (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1g</xref>). Once the shapes are on top of one another, the sample shape is uniformly scaled to match the area of the reference shape. The last step is to rotate the sample shape to best-align with the reference. These steps are performed until the average distance between the landmarks (vertices of the triangle) of the sample is minimally distant to the landmarks of the reference.</p><p>A measure of the goodness of the superimposition is the Procrustes distance:<disp-formula id="equ1"><mml:math id="m1"><mml:mi mathvariant="normal">d</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo></mml:msqrt><mml:mo>,</mml:mo></mml:math></disp-formula>where (<italic>x, y,. .</italic> .) and (<italic>x<sub>ref</sub>, y<sub>ref</sub>, . . .</italic> ) are coordinates of the landmarks of the sample image and reference image, respectively. There are 12 landmarks on the <italic>Drosophila</italic> wing, thus there are 24 <italic>x</italic> and <italic>y</italic> coordinates that represent each wing. In the case of triangles, <inline-formula><mml:math id="inf12"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1d–g</xref>). If two shapes are exactly the same but have different orientation and position, the Procrustes method will perfectly align them (<italic>d</italic> = 0) (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1h, i</xref>). For the <italic>Drosophila</italic> wing landmarks, we used the Wings 4 software to perform the Procrustes alignment of the landmarks.</p><p>Since there are 24 <italic>x</italic> and <italic>y</italic> coordinates that represent each wing, one can think about each wing as a vector in 24−dimensional space. One can perform PCA on these vectors for an ensemble of wings. As a result, one can get directions of the largest variation in landmark positions, but there will not be any information about the positions of the veins or other parts of the wing that have no landmarks. We performed PCA on the landmark-based data using the pca function from the Dimensionality Reduction and Feature Extraction toolbox in Matlab.</p></sec><sec id="s4-8"><title>Landmark-free morphometrics</title><p>The main concept of the method is to treat every pixel in a wing image as a variable, a trait, with a discrete intensity value. Hence, the higher the resolution of the image, the greater the number of variables. The resolution of wing images we captured are such that there are 100,000 pixels for each wing. However, the pixels are not landmarks in the traditional sense. Traditional landmark-based methods globally align identifiable anatomical loci from homologous objects of different individuals. Then, the variation in the landmark coordinate position is measured for each landmark. Our landmark-free method globally aligns the entire image from homologous objects of different individuals. Then, the variation in intensity for each pixel coordinate is measured.</p><p>Homologous body structures from different individuals can have different shapes. This can apply not only to individuals from different species (i.e., forelimb of bat and horse) but also individuals from the same species. This is why the field of morphometrics has reduced the complexity of the continuum of shape to a discretized proxy, that is, landmark-based Procrustes analysis then can estimate shape variation.</p><p>Our approach (code is available in <xref ref-type="bibr" rid="bib6">Alba, 2020</xref>) is to use a conformal map to map all homologous body structures onto the same shape, in this case, a disc of fixed size. Although we apply the approach to one body structure, the <italic>Drosophila</italic> wing, it can be applied to any 2D surface with no holes, with or without a boundary. This could be a simple 2D shape like the wing or the closed surface of a complex 3D shape such as a tooth, brain, or another body part.</p></sec><sec id="s4-9"><title>Wing boundary identification</title><p>Although the background intensity of all images was highly consistent across ensembles (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1e</xref>), there were minor differences, including uneven illumination across the field of view. This variability was most problematic with the wing images from the genetic database (<xref ref-type="bibr" rid="bib45">Sonnenschein and Chari, 2015b</xref>). To correct these issues, we apply contrast-limited adaptive histogram equalization (CLAHE) to our images (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3a</xref>; <xref ref-type="bibr" rid="bib40">Pizer et al., 1987</xref>).</p><p>We use an Ilastik segmentation model to identify pixels that belong to the wing bulk, veins, and background (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2a</xref>). The machine learning model is trained on 25 wings and after that is applied to all wings across all ensembles to remove systematic trends owing to variations in segmentation. The output of Ilastik comprises four layers (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2b</xref>). The segmentation output requires further cleaning that is done in a custom-made Matlab script. In particular, we use knowledge about the fact that background is only outside of the wing, and wing bulk is surrounded by veins, to clean up the segmentation (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2c</xref>). Once the segmentation is cleaned, we use a watershed algorithm to produce the boundary of the wing (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2d</xref>). Watershed algorithms find catchment basins in an image, treating intensity as a height of the landscape. Since wings were detached from the body by breaking the hinge region with tweezers, each wing has a slightly different hinge due to experimental manipulation. Therefore, we use two morphologically identifiable landmarks, the humeral break and the alula notch (stars in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2d</xref>). These landmarks are manually selected for each segmented wing image, and a script automatically defines the line between the two points as the proximal boundary. This defines a precise and repeatable way to delete the hinge. Area of each wing is measured as pixel number inside the wing boundary. Distribution of outbred group wing areas is shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1g–j</xref>.</p></sec><sec id="s4-10"><title>Conformal map conformal mapping</title><p>One feature of a conformal map is that it is possible to map any closed region onto another closed region if the shape is approximated as a complex polygon. For example, when we approximate the boundary of the <italic>Drosophila</italic> wing as a 100-point polygon, we can map the whole wing onto a unit disc. We distribute these points on the wing boundary with a density that is inversely proportional to the local curvature of the wing boundary (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2e</xref>). Therefore, we compute 2D curvature for every point of a segmented wing boundary using the linecurvature2D package (<xref ref-type="bibr" rid="bib32">Kroon, 2020</xref>). Once we have curvature for every point, we compute and plot the cumulative curvature and distribute points equidistantly along the cumulative direction. The cumulative curve is monotonous; therefore, we can find the position of the vertices on the boundary. This approach minimizes the difference between polygonal representation and the real boundary for a given number of points.</p><p>Once a polygonal representation is made of a wing boundary, Schwarz–Christoffel mapping generates a map from the interior of the polygon onto a unit disc. The conformal map scales each local region homogeneously, but the scaling constant depends on the position. In the case of the <italic>Drosophila</italic> wing, which is approximately the shape of an ellipse, the bulk of the wing is minimally distorted, while regions far from the I are more distorted. For instance, several peripheral pixels may be mapped onto one pixel of the unit disc (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4k</xref>). Particular distortion depends on the shape of the wing; therefore, if we would like to decouple shape from a pattern, this feature comes in handy.</p><p>We use the Schwarz–Christoffel Toolbox for Matlab (<xref ref-type="bibr" rid="bib16">Driscoll, 2002</xref>) to map each segmented wing onto a unit disc that has a diameter of 200 pixels (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4i</xref>). Schwarz–Christoffel conformal mapping requires only the boundary and I-point (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4b</xref>) of the shape. The shape’s boundary becomes the circumference and the shape’s I-point becomes the origin. This is done individually for all of the segmented wings in an ensemble.</p><p>Note that the unit disc is the same area for all segmented wings. A wing boundary is a polygon in a complex space. Therefore, conformal mapping a segmented wing image onto the unit disc depends on the size of the segmented wing image. However, the target (the unit disc) has a fixed size, and so it may be the case that several pixels in the wing image may be mapped onto one pixel in the disc. Consequently, the intensity of the target pixel is an average of the wing image pixels that map to it. For the imaging resolution that was used, this happened most often for peripheral pixels (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4k</xref>).</p><p>The Riemann mapping theorem implies that there is a biholomorphic (i.e., a bijective holomorphic mapping whose inverse is also holomorphic) mapping <italic>f</italic> from a non-empty simply connected open subset, <inline-formula><mml:math id="inf13"><mml:mi>U</mml:mi></mml:math></inline-formula>, of the complex plane <inline-formula><mml:math id="inf14"><mml:mi mathvariant="double-struck">C</mml:mi></mml:math></inline-formula> onto the open unit disc, <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mo>:</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>z</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>The Schwarz–Christoffel formula is a recipe for a conformal map <italic>f</italic> from the upper half-plane (the canonical domain) <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mo>:</mml:mo><mml:mi>I</mml:mi><mml:mi>m</mml:mi><mml:mi>z</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> to the interior of a polygon (the physical domain). The function <italic>f</italic> maps the real axis to the edges of the polygon. If the polygon has interior angles α<sub>1,</sub>α<sub>2,</sub>α<sub>3</sub>,…, then this mapping is given by<disp-formula id="equ2"><mml:math id="m2"><mml:mi>f</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>C</italic> is a constant, α<sub>j</sub> are interior angles at the vertices, and z<sub>j</sub> are pre-images of the vertices, that is, dots on the real axis. They obey inequality z<sub>1</sub> &lt; z<sub>2</sub> &lt;… &lt; z<sub>n</sub> = ∞. For wing data, the unit disc contains 31,416 pixels, which is smaller in number than the ~100,000 pixels in each segmented wing image. The reduction was achieved by reducing the weight of the peripheral pixels, and as a result, the shape of the wing has a lower weight.</p></sec><sec id="s4-11"><title>Conformal map alignment</title><p>Since wing shapes and orientations are variable, the mapped wings must be globally aligned with one another. To align the mapped images, we use the remaining freedom, which is a rotation of the disc, plus we use the movement of the origin (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4j</xref>). This freedom is an automorphism of the unit disc,<disp-formula id="equ3"><mml:math id="m3"><mml:mi>g</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mi>z</mml:mi><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mover accent="false"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>θ</italic> is a rotation angle and <inline-formula><mml:math id="inf17"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> is a movement of the origin. We perform an independent parameter sweep of angle and displacement for one mapped wing image to obtain maximal cross-correlation between it and a reference wing disc. This operation is repeated for all of the other mapped wings, aligning each one to the same reference wing disc. We wrote a script that uses the Geometric Transformation Toolbox in Matlab to perform this procedure.</p><p>Since we are comparing variation within a group as well as variation between groups, we randomly choose one mapped wing to be the reference for an entire experiment. There is only one reference wing disc for all groups within the experiment varying diet and temperature (G_25C_high_F_139_R). There is only one reference wing for all groups within the experimental data comprising the genetic mutants (G_samw_lei4X_F_110_L).</p><p>Left and right wings have a different orientation. We use the function fliplr from Matlab to flip all images of left wings prior to conformal mapping. Once flipped they are treated in the same way as right wings, but we store information about their chirality. To determine if left and right wings are different in shape or pattern, we computed the Kullback–Leibler divergence (for details, see SI.4.14 and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) between left and right ensembles for the outbred group and found no difference. We also plot PC1 vs. PC2 for the outbred group and use color labels for chirality (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1d</xref>). We find no correlation between the score for PC1/PC2 and chirality. These analyses indicate that there is no statistical difference between the left and right wings. All subsequent analysis aggregates both left and right wing data.</p></sec><sec id="s4-12"><title>Radon transformation</title><p>The <italic>Drosophila</italic> wing icomprises a sparse pattern of dark veins and lighter intervein compartments. We anticipate that much of the variation between wings will be detected as differences in vein thickness, position, and their angle relative to the body axes. A Radon transformation of a density function <italic>f</italic>(<italic>x</italic>,<italic>y</italic>) produces a function <inline-formula><mml:math id="inf18"><mml:mi>R</mml:mi><mml:mi>f</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>f</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> defined on a space of all lines <italic>L</italic>. For 2D images, a Radon transformation generates sinograms with coordinates of angle and <italic>R</italic> (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3a, f–k</xref>). Since veins resemble lines, comparing two lines that differ by an angle is more sensitive to Radon-transformed data (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3b–e</xref>). For this reason, we carry out all further analysis of the data with Radon-transformed images of aligned wing discs, obtained using the radon function in Matlab. However, when we need to present images of a wing, we use an inverse transformation iradon in Matlab.</p></sec><sec id="s4-13"><title>Pattern variation within a group</title><p>Once all images are aligned to a reference on the disc, the remaining variability reflects biological variation. We use 8-bit grayscale images, which means that each pixel has intensity ranging from 0 to 255. Therefore, a wing image with <italic>N</italic> pixels can be represented as a single vector in discrete <italic>N</italic>-dimensional space, or to be more precise it is a vector in an <italic>N</italic>-dimensional cube ([0255]<italic><sup>N</sup></italic>). For a group with <italic>M</italic> number of wings, the group can be represented as a set of <italic>M</italic> vectors in <italic>N</italic>-dimensional space. Therefore, we can use all the tools from linear algebra.</p><p>We can analyze variability within a group since each group of individuals is subject to natural variation. We analyze this variation using PCA, which finds the directions of greatest variation within the group. Each PC is a unit vector in the same <italic>N</italic>-dimensional space as the wing discs comprising a group. We use the pca function from the Dimensionality Reduction and Feature Extraction toolbox for Matlab for all PCA-related computations.</p><p>We can also analyze variability within a group using entropy. Each pixel at a fixed position may have different intensities for wings in an ensemble. If the pixel belongs to a region that has almost no variability in intensity, then it will have small entropy, but in the regions where there is pattern variability, the entropy will be larger. As an example, we can consider vein motion, which means that the position of the vein along either AP or PD axes varies between wings. If a pixel at a fixed position has identical intensity values for all aligned images, then that pixel has zero entropy. If a fixed-position pixel is within a wing vein for some but not all aligned images, then it might have larger entropy. In the intervein regions of wing images, the intensity of fixed-position pixels often varies slightly, so their entropy will be small but nonzero. We use the Kozachenko–Leonenko (<xref ref-type="bibr" rid="bib31">Kozachenko and Leonenko, 1987</xref>) entropy estimator for entropy<disp-formula id="equ4"><mml:math id="m4"><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">ψ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>d</italic> is the dimension of x and <italic>c<sub>d</sub></italic> is the volume of the <italic>d</italic>-dimensional unit ball <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mi>Γ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> for Euclidean norm, <inline-formula><mml:math id="inf20"><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is the distance of the <italic>i</italic>th sample to its <italic>k</italic>th nearest neighbor, and ψ(<italic>x</italic>) is digamma function.</p></sec><sec id="s4-14"><title>Eigenvalue spectra of intra-group variation</title><p>For each ensemble of wings, we performed alignment to the reference wing and Radon transformation. For each population, we performed PCA on a single population. As a result, we obtained spectrum of the eigenvalues; see <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>.</p></sec><sec id="s4-15"><title>Analysis of pattern variation between groups: entropy-like approach</title><p>When there are two or more groups and we would like to compute the variability between them, we can estimate the Kullback–Leibler divergence, <italic>DKL</italic>, or relative entropy. Let us consider two distributions <italic>P</italic> = <italic>P</italic>(<italic>X</italic>) and <italic>Q</italic> = <italic>Q</italic>(<italic>Y</italic>), the former one is interpreted as a real distribution (postulated prior probability) and the latter one is an assumed distribution that is measured at the experiment. The value of this functional is equal to the amount of information that is not accounted if <italic>Q</italic> be taken instead of <italic>P</italic>,<disp-formula id="equ5"><mml:math id="m5"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>P</mml:mi><mml:mo>∥</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>We use the two-nearest-neighbor non-parametric Kozachenko–Leonenko estimator (<xref ref-type="bibr" rid="bib51">Wang et al., 2009</xref>) for the Kullback–Leibler divergence,<disp-formula id="equ6"><mml:math id="m6"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>P</mml:mi><mml:mo>∥</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">ν</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is the distance from <italic>x<sub>i</sub></italic> to its <italic>k</italic>th nearest neighbor in <inline-formula><mml:math id="inf22"><mml:msub><mml:mrow><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is the distance from <italic>x<sub>i</sub></italic> to its <italic>k</italic>th nearest neighbor in <inline-formula><mml:math id="inf24"><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p></sec><sec id="s4-16"><title>Left-right patterning</title><p>We present Kullback–Leibler divergence between left and right wings for each population of female flies. For comparison, we also present Kullback–Leibler divergence between two randomly assigned groups that have the same number of wings as left and right groups correspondingly. We conclude that there is no significant difference between left and right wings as between groups and that special noise level is higher for the groups that have smaller number of flies.</p></sec><sec id="s4-17"><title>Analysis of pattern variation between groups: centroid-based analysis</title><p>Another method to compare two or more groups is by centroid-based analysis. For one group containing Z wings, the group can be represented as a set of Z vectors in <italic>N</italic>-dimensional space. The center of mass or centroid of the set can then be computed. The centroid can be thought of as the mean wing of the group (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2a, b</xref>). Since we have a large number of wings for each group (<italic>Z</italic> &gt; 100), the mean wing is a statistically robust representation of the group (also we used bootstrap to check robustness, see next section). We perform all manipulation for Radon images of the wings and transform everything back with its inverse transformation.</p><p>We compute the mean wing for each group of wings, and then we can calculate the pairwise difference between mean wings of different groups. A pairwise difference is a vector that shows how one mean wing transforms into another mean wing. For example, when we say that there is a direction from mean wing <italic>A</italic> to mean wing <italic>B</italic> we mean that there is a vector, ∆, that generates mean wing <italic>B</italic> when added pixel-wise to mean wing <italic>A: B</italic> = ∆ + <italic>A</italic>. If we normalize this vector, n = ∆/|∆|, we get a unit vector that points from the reference group to another group (i.e., wildtype group to genetic mutant group). We can compare the direction of a unit vector with the direction of any PC vector from PCA of a given group. This is done by computing a scalar product between the unit vector and the PC vector:<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p></sec><sec id="s4-18"><title>Bootstrapping and shuffling</title><p>We have to check that the findings of the analysis are statistically robust. This requires that the populations are well-sampled, that is, we have enough images so that the in-sample variance of the mean wing is small, and as a result that measured direction between populations is stable and close to the ideal direction that would be achieved if we had an infinite number of wings. For this approach, we use the bootstrap method that requires that we randomly draw subsets of wings that have a size of 50% of the ensemble. We repeat this procedure for each ensemble individually, so we do not mix wings that correspond to different populations. For pairs of such samples, we compute mean wings and the directional vector between them. We found that the numerical value of the <inline-formula><mml:math id="inf25"><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>⁡</mml:mo><mml:mi>θ</mml:mi></mml:math></inline-formula> is stable, and the difference between sampled in this way <inline-formula><mml:math id="inf26"><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>⁡</mml:mo><mml:mi mathvariant="normal">θ</mml:mi></mml:math></inline-formula> and value that is computed for whole populations is extremely low (few percent of the corresponding values), suggesting that it is well estimated.</p><p>The second important check is to confirm that the trends we observe are biological in origin and not artifacts of our analysis. We perform a shuffle test. For this check, we construct new populations from images drawn randomly from the entire ensemble, which means that we mix wings from different populations (difference environmental and genetic conditions). We find that for these shuffled populations, a variation of the <inline-formula><mml:math id="inf27"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>θ</mml:mi></mml:math></inline-formula> is relatively large, and the mean value is only a few percent of the unshuffled data. This suggests that the observed phenomenon depends on biological labels of the wings rather than artifacts introduced by the method and analysis itself.</p></sec><sec id="s4-19"><title>1D structure of the observed data</title><p>While the data is embedded in high-dimensional space, it does not imply that the structure of the data is high dimensional as well. The simplest structure of the data that we may have is a 1D cylinder, where the data is distributed along a line with noise in directions orthogonal to it. The simple structure of the data would hint at a simplifying principle that could be modeled and more deeply understood.</p><p>The angle between the <bold>n</bold> and PC vectors resides in an <italic>N</italic>-dimensional space. For a 1D cylinder, one can compute a dependence of <inline-formula><mml:math id="inf28"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi><mml:mi/></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of <italic>R</italic>, the distance between points. If the distance between the two mean wings is <italic>R</italic>, then<disp-formula id="equ8"><mml:math id="m8"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>⟹</mml:mo><mml:mfrac><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msqrt><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>θ</mml:mi></mml:msqrt><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>Thus, we get that <inline-formula><mml:math id="inf29"><mml:msqrt><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">θ</mml:mi></mml:msqrt><mml:mi mathvariant="normal"/><mml:mover accent="false"><mml:mo>→</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mi/><mml:mo>→</mml:mo><mml:mi/><mml:mi>∞</mml:mi></mml:mrow></mml:mover><mml:mn>0</mml:mn><mml:mi/><mml:mtext>as</mml:mtext><mml:mrow><mml:mrow><mml:mtext>σ</mml:mtext></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>, which suggests the presence of a long direction in the data that dominates all other directions of variation. It further suggests that where <inline-formula><mml:math id="inf30"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>θ</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, then the noise in the directions orthogonal to the cylinder is constant along it. The simplest explanation for a different exponent would be that noise level increases with distance, and the structure is a cone rather than a cylinder. We experimentally measure the value of angles θ for pairs of bootstrapped centroids, computing <inline-formula><mml:math id="inf31"><mml:msqrt><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>θ</mml:mi></mml:msqrt></mml:math></inline-formula>, and we found that it qualitatively displays a decay as a power of <italic>R</italic>:<inline-formula><mml:math id="inf32"><mml:msqrt><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>θ</mml:mi></mml:msqrt><mml:mi mathvariant="normal"/><mml:mover accent="false"><mml:mo>→</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mi/><mml:mo>→</mml:mo><mml:mi/><mml:mi>∞</mml:mi></mml:mrow></mml:mover><mml:mn>0</mml:mn><mml:mi/><mml:mtext>as </mml:mtext><mml:mfrac bevelled="true"><mml:mrow><mml:mtext>σ</mml:mtext></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula>. Values of α from fitting to an experimental data are reported in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>.</p></sec><sec id="s4-20"><title>Robustness of results to errors in image analysis</title><p>We performed three artificial perturbations of the system in order to check the robustness of the method (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2e–h</xref>). The first one is a random shift of the origin that was obtained by the maximization of the cross-correlation between individual image and reference image (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2f</xref>). We randomly shifted origin by a random value from −3 to 3 pixels in each direction. Also, we randomly shifted alula notch and humeral break by a random value from −3 to 3 pixels in each direction. Once these points shifted, new boundary is identified as presented in <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2g</xref>. The final perturbation was perturbation of the boundary segmentation. Each pixel of the initial boundary that was obtained after refinement of the segmentation part of the pipeline is shifted by random number from −1 to 1 (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2h</xref>). After these perturbations, the remaining pipeline is applied. We notice that despite small numerical differences of the analysis for the perturbation, quantitative conclusions remain the same.</p></sec><sec id="s4-21"><title>Robustness of results to log-transformed pixel data</title><p>Motion of a vein across a database corresponds to a significant variation in intensity in limited zones of the image. We performed the analysis on log-transformed data and log-transform of the inverse of data (where veins are bright as opposed to dark structures) to investigate the significance of the representation. We confirmed that all the statistical trends are maintained with intensity transformed data. We thank the referee for this and other recommendations through which we believe we have provided further evidence towards the accuracy and robustness of the computational approach/pipeline.</p></sec><sec id="s4-22"><title>Statistical significance</title><p>We were exploring previously unknown phenomena, and therefore it is a priori unknown as to what is a good observable, let alone what a sufficient sample size ought to be to help parameterize it. In light of this, our study has generated a large dataset that permits a careful analysis of statistical robustness and significance. As a rule, we leverage non-parametric approaches to assessing significance, including bootstrap with replacement and resampling from marginal distributions (also known as shuffling). We pursue a non-parametric approach to avoid any assumptions regarding the generative process of a manifestly very complex phenomena.</p><p>This section of the SI puts forward our reasoning for our confidence in our conclusions. In particular, we confirm that our sample size is sufficient to generate robust estimation of inferred parameters that we use in our study.</p><sec id="s4-22-1"><title>Parameters of interest</title><p>There are fundamentally two quantities that form the basis of our analyses of intra- and inter-population variation. Those being the first and second moments of each genetic and environmental population in the phenotype space that we define. It must be stated that these two quantities are provably the most statistically robust features of an empirical data distribution. Nonlinear analyses that are nowadays commonplace in even the most standard dimensionality reduction algorithms are more susceptible to noise. These two quantities go into helping a spectral, or principal component, analysis of the distributions. The central result of the paper is the striking dominance and importance of the first principal component (eigenvector). It must again be stated that this direction is the most statistically robust direction by construction. The only other parameter we infer is the mean phenotype of populations, which is already a quantity that goes into the construction of PCA.</p></sec><sec id="s4-22-2"><title>PCA</title><p>To demonstrate the significance of the PCs that we further analyze and base our conclusions on, we adopt a marginal resampling approach. The explicit advantage of this approach over a Marcenko Pasteur (MP) approach is that the closed-form analytic solutions for the eigenvalue distributions are based on an assumption of Gaussianity of the data. To avoid this parametric assumption, which is rarely true for real-world data, we adopt a marginal resampling approach. This approach gives a spectrum of eigenvalues that could be generated by the nature of the marginal distributions alone, and not due to any covariance in the data. For all our populations, we got at least 70 significant eigenvalues.</p></sec><sec id="s4-22-3"><title>Degree of alignments</title><p>The central feature of our analysis was to estimate the degree of alignment between the (1) direction of variation between the means of two populations and (2) the natural variation of the individual populations. (1) Is the phenotype associated with the difference, say, for example, the phenotypic difference between a genetic mutant set of wings and the WT? The mean values of the degree of alignments are presented in the main manuscript in <xref ref-type="fig" rid="fig3">Figures 3f</xref> and <xref ref-type="fig" rid="fig4">4d</xref> for the genetic and environmental analyses, respectively. Complete distributions of these alignments, achieved through bootstrapping, are presented here in <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref> and <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>, for the environmental and genetic populations, respectively.</p><p>To assess the significance of these measurements of alignment, you must compare what is measured to a null distributions. Again, in the non-parametric approach embodied in our work, the null distribution is constructed from the data itself. In particular, we compare the measured directions to directions that would emerge by chance were the labels of the different populations of wings to be shuffled. Any alignment between inter-population directions of change and intra-population directions of variance in the shuffled label data is purely due to chance or an artifact of our pipeline. <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref> and <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref> present the p-values achieved through these analyses in the environmental and genetic populations. In all instances, other than the male star population, the alignments are significant. The lack of significance of the male star population is explained in our manuscript as being a statistical consequence of its very weak effect on phenotype.</p></sec></sec><sec id="s4-23"><title>Sexual dimorphism vs. the long axis of the data</title><p>We include a more detailed description of the relative orientations of the long axis in the data and the axis corresponding to sexual dimorphism in the high-quality images of environmental variation. We observe that within stressed populations of flies, at low diet and high temperatures close to their physiological limit (29°C), the sexual dimorphism axis rotates from being orthogonal to the long axis in the data to parallel; see <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>. This conditional GxE interaction (G being sex-specific genes) provides further evidence that what we are observing is biological in origin, rather than an artifact of our pipeline. It is also consistent with our observation that alignment of mutational perturbations in signaling genes with the long axis in the data is sometimes dependent on the sex of the flies, depending on the mutation (<xref ref-type="fig" rid="fig5">Figure 5</xref>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Seppe Kuehn for fruitful conversations. This work was supported in part by NSF grant DMS-1547394 (JEC), NSF (1764421, MM and RWC), and the Simons Foundation (597491, MM and RWC). MM is a Simons Foundation Investigator.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft</p></fn><fn fn-type="con" id="con2"><p>Data curation, Investigation</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Data curation, Supervision, Funding acquisition, Investigation, Visualization, Methodology, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Description of inbred stock lines.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-66750-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Crossing scheme.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-66750-supp2-v2.xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-66750-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Data will be made publicly available at Mani, Madhav, 2021, Imaging data from &quot;Global Constraints within the Developmental Program of the <italic>Drosophila</italic> Wing&quot;, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7910/DVN/UFGJFB">https://doi.org/10.7910/DVN/UFGJFB</ext-link>, Harvard Dataverse, V1.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Alba</surname><given-names>V</given-names></name><name><surname>Carthew</surname><given-names>JE</given-names></name><name><surname>Carthew</surname><given-names>RW</given-names></name><name><surname>Mani</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Imaging data from &quot;Global Constraints within the Developmental Program of the Drosophila Wing&quot;</data-title><source>Harvard Dataverse</source><pub-id assigning-authority="other" pub-id-type="doi">10.7910/DVN/UFGJFB</pub-id></element-citation></p><p>The following previously published dataset was used:</p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Sonnenschein</surname><given-names>A</given-names></name><name><surname>Zee</surname><given-names>DV</given-names></name><name><surname>Pitchers</surname><given-names>WR</given-names></name><name><surname>Chari</surname><given-names>S</given-names></name><collab>Dworkin</collab></person-group><year iso-8601-date="2015">2015</year><data-title>Supporting material and data for &quot;An Image Database of Drosophila melanogaster Wings for Phenomic and Biometric analysis&quot;</data-title><source>GigaScience Database</source><pub-id assigning-authority="other" pub-id-type="doi">10.5524/100141</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ablowitz</surname> <given-names>MJ</given-names></name><name><surname>Fokas</surname> <given-names>AS</given-names></name><name><surname>Fokas</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2003">2003</year><source>Complex Variables: Introduction and Applications</source><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abouchar</surname> <given-names>L</given-names></name><name><surname>Petkova</surname> <given-names>MD</given-names></name><name><surname>Steinhardt</surname> <given-names>CR</given-names></name><name><surname>Gregor</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Fly wing vein patterns have spatial reproducibility of a single cell</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><elocation-id>20140443</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2014.0443</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aguilar-Hidalgo</surname> <given-names>D</given-names></name><name><surname>Werner</surname> <given-names>S</given-names></name><name><surname>Wartlick</surname> <given-names>O</given-names></name><name><surname>González-Gaitán</surname> <given-names>M</given-names></name><name><surname>Friedrich</surname> <given-names>BM</given-names></name><name><surname>Jülicher</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Critical point in Self-Organized tissue growth</article-title><source>Physical Review Letters</source><volume>120</volume><elocation-id>198102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.120.198102</pub-id><pub-id pub-id-type="pmid">29799239</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ahlfors</surname> <given-names>LV</given-names></name></person-group><year iso-8601-date="1953">1953</year><source>Complex Analysis: An Introduction to the Theory of Analytic Functions of One Complex Variable</source><publisher-name>McGraw-Hill Book Company</publisher-name></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aigouy</surname> <given-names>B</given-names></name><name><surname>Farhadifar</surname> <given-names>R</given-names></name><name><surname>Staple</surname> <given-names>DB</given-names></name><name><surname>Sagner</surname> <given-names>A</given-names></name><name><surname>Röper</surname> <given-names>JC</given-names></name><name><surname>Jülicher</surname> <given-names>F</given-names></name><name><surname>Eaton</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Cell flow reorients the Axis of planar polarity in the wing epithelium of <italic>Drosophila</italic></article-title><source>Cell</source><volume>142</volume><fpage>773</fpage><lpage>786</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2010.07.042</pub-id><pub-id pub-id-type="pmid">20813263</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Alba</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2020">2020</year><source>Conformal Magic - a Pipeline for Image Analysis Ed v Alba (Vasyl Alba, Github)</source><ext-link ext-link-type="uri" xlink:href="https://github.com/">https://github.com/</ext-link></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname> <given-names>S</given-names></name><name><surname>Kutra</surname> <given-names>D</given-names></name><name><surname>Kroeger</surname> <given-names>T</given-names></name><name><surname>Straehle</surname> <given-names>CN</given-names></name><name><surname>Kausler</surname> <given-names>BX</given-names></name><name><surname>Haubold</surname> <given-names>C</given-names></name><name><surname>Schiegg</surname> <given-names>M</given-names></name><name><surname>Ales</surname> <given-names>J</given-names></name><name><surname>Beier</surname> <given-names>T</given-names></name><name><surname>Rudy</surname> <given-names>M</given-names></name><name><surname>Eren</surname> <given-names>K</given-names></name><name><surname>Cervantes</surname> <given-names>JI</given-names></name><name><surname>Xu</surname> <given-names>B</given-names></name><name><surname>Beuttenmueller</surname> <given-names>F</given-names></name><name><surname>Wolny</surname> <given-names>A</given-names></name><name><surname>Zhang</surname> <given-names>C</given-names></name><name><surname>Koethe</surname> <given-names>U</given-names></name><name><surname>Hamprecht</surname> <given-names>FA</given-names></name><name><surname>Kreshuk</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Ilastik: interactive machine learning for (bio)image analysis</article-title><source>Nature Methods</source><volume>16</volume><fpage>1226</fpage><lpage>1232</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0582-9</pub-id><pub-id pub-id-type="pmid">31570887</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blair</surname> <given-names>SS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Wing vein patterning in <italic>Drosophila</italic> and the analysis of intercellular signaling</article-title><source>Annual Review of Cell and Developmental Biology</source><volume>23</volume><fpage>293</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.1146/annurev.cellbio.23.090506.123606</pub-id><pub-id pub-id-type="pmid">17506700</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bollenbach</surname> <given-names>T</given-names></name><name><surname>Pantazis</surname> <given-names>P</given-names></name><name><surname>Kicheva</surname> <given-names>A</given-names></name><name><surname>Bökel</surname> <given-names>C</given-names></name><name><surname>González-Gaitán</surname> <given-names>M</given-names></name><name><surname>Jülicher</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Precision of the dpp gradient</article-title><source>Development</source><volume>135</volume><fpage>1137</fpage><lpage>1146</lpage><pub-id pub-id-type="doi">10.1242/dev.012062</pub-id><pub-id pub-id-type="pmid">18296653</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bookstein</surname> <given-names>FL</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Morphometric tools for landmark data</article-title><source>American Journal of Orthodontics and Dentofacial Orthopedics</source><volume>103</volume><elocation-id>485</elocation-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choi</surname> <given-names>GPT</given-names></name><name><surname>Mahadevan</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Planar morphometrics using teichmüller maps</article-title><source>Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences</source><volume>474</volume><elocation-id>20170905</elocation-id><pub-id pub-id-type="doi">10.1098/rspa.2017.0905</pub-id><pub-id pub-id-type="pmid">30333694</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>contributors</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2020">2020</year><source>Procrustes Analysis - Wikipedia, the Free Encyclopedia</source></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Celis</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Pattern formation in the <italic>Drosophila</italic> wing: the development of the veins</article-title><source>BioEssays</source><volume>25</volume><fpage>443</fpage><lpage>451</lpage><pub-id pub-id-type="doi">10.1002/bies.10258</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Celis</surname> <given-names>JF</given-names></name><name><surname>Diaz-Benjumea</surname> <given-names>FJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Developmental basis for vein pattern variations in insect wings</article-title><source>International Journal of Developmental Biology</source><volume>47</volume><fpage>653</fpage><lpage>663</lpage></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Debat</surname> <given-names>V</given-names></name><name><surname>Debelle</surname> <given-names>A</given-names></name><name><surname>Dworkin</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Plasticity, Canalization, and developmental stability of the <italic>Drosophila</italic> wing: joint effects of mutations and developmental temperature</article-title><source>Evolution</source><volume>63</volume><fpage>2864</fpage><lpage>2876</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2009.00774.x</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Driscoll</surname> <given-names>TA</given-names></name></person-group><year iso-8601-date="2002">2002</year><source>Schwarz-Christoffel Toolbox</source></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Driscoll</surname> <given-names>TA</given-names></name><name><surname>Trefethen</surname> <given-names>LN</given-names></name></person-group><year iso-8601-date="2002">2002</year><source>Schwarz-Christoffel Mapping</source><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dryden</surname> <given-names>IL</given-names></name><name><surname>Mardia</surname> <given-names>KV</given-names></name></person-group><year iso-8601-date="2016">2016</year><source>Statistical Shape Analysis: With Applications in R</source><publisher-name>John Wiley &amp; Sons</publisher-name></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dun</surname> <given-names>RB</given-names></name><name><surname>Fraser</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="1958">1958</year><article-title>Selection for an invariant character; vibrissa number in the house mouse</article-title><source>Nature</source><volume>181</volume><fpage>1018</fpage><lpage>1019</lpage><pub-id pub-id-type="doi">10.1038/1811018a0</pub-id><pub-id pub-id-type="pmid">13541353</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dye</surname> <given-names>NA</given-names></name><name><surname>Popović</surname> <given-names>M</given-names></name><name><surname>Spannl</surname> <given-names>S</given-names></name><name><surname>Etournay</surname> <given-names>R</given-names></name><name><surname>Kainmüller</surname> <given-names>D</given-names></name><name><surname>Ghosh</surname> <given-names>S</given-names></name><name><surname>Myers</surname> <given-names>EW</given-names></name><name><surname>Jülicher</surname> <given-names>F</given-names></name><name><surname>Eaton</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Cell dynamics underlying oriented growth of the <italic>Drosophila</italic> wing imaginal disc</article-title><source>Development</source><volume>144</volume><fpage>4406</fpage><lpage>4421</lpage><pub-id pub-id-type="doi">10.1242/dev.155069</pub-id><pub-id pub-id-type="pmid">29038308</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferreira</surname> <given-names>A</given-names></name><name><surname>Milán</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dally proteoglycan mediates the autonomous and nonautonomous effects on tissue growth caused by activation of the PI3K and TOR pathways</article-title><source>PLOS Biology</source><volume>13</volume><elocation-id>e1002239</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002239</pub-id><pub-id pub-id-type="pmid">26313758</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia-Bellido</surname> <given-names>A</given-names></name><name><surname>de Celis</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Developmental genetics of the venation pattern of <italic>Drosophila</italic></article-title><source>Annual Review of Genetics</source><volume>26</volume><fpage>277</fpage><lpage>304</lpage><pub-id pub-id-type="doi">10.1146/annurev.ge.26.120192.001425</pub-id><pub-id pub-id-type="pmid">1482114</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Hansen</surname> <given-names>TF</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>The Origins of Robustness</source></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hermisson</surname> <given-names>J</given-names></name><name><surname>Wagner</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The population genetic theory of hidden variation and genetic robustness</article-title><source>Genetics</source><volume>168</volume><fpage>2271</fpage><lpage>2284</lpage><pub-id pub-id-type="doi">10.1534/genetics.104.029173</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>GW</given-names></name><name><surname>Mahadevan</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Planar morphometry, shear and optimal quasi-conformal mappings</article-title><source>Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences</source><volume>469</volume><elocation-id>20120653</elocation-id><pub-id pub-id-type="doi">10.1098/rspa.2012.0653</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kendall</surname> <given-names>DG</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>A survey of the statistical theory of shape</article-title><source>Statistical Science</source><volume>4</volume><fpage>87</fpage><lpage>99</lpage><pub-id pub-id-type="doi">10.1214/ss/1177012582</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kicheva</surname> <given-names>A</given-names></name><name><surname>Pantazis</surname> <given-names>P</given-names></name><name><surname>Bollenbach</surname> <given-names>T</given-names></name><name><surname>Kalaidzidis</surname> <given-names>Y</given-names></name><name><surname>Bittig</surname> <given-names>T</given-names></name><name><surname>Jülicher</surname> <given-names>F</given-names></name><name><surname>González-Gaitán</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Kinetics of morphogen gradient formation</article-title><source>Science</source><volume>315</volume><fpage>521</fpage><lpage>525</lpage><pub-id pub-id-type="doi">10.1126/science.1135774</pub-id><pub-id pub-id-type="pmid">17255514</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirschner</surname> <given-names>M</given-names></name><name><surname>Gerhart</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Evolvability</article-title><source>PNAS</source><volume>95</volume><fpage>8420</fpage><lpage>8427</lpage><pub-id pub-id-type="doi">10.1073/pnas.95.15.8420</pub-id><pub-id pub-id-type="pmid">9671692</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klingenberg</surname> <given-names>CP</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Morphometric integration and modularity in configurations of landmarks: tools for evaluating a priori hypotheses</article-title><source>Evolution &amp; Development</source><volume>11</volume><fpage>405</fpage><lpage>421</lpage><pub-id pub-id-type="doi">10.1111/j.1525-142X.2009.00347.x</pub-id><pub-id pub-id-type="pmid">19601974</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klingenberg</surname> <given-names>CP</given-names></name><name><surname>Gidaszewski</surname> <given-names>NA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Testing and quantifying phylogenetic signals and homoplasy in morphometric data</article-title><source>Systematic Biology</source><volume>59</volume><fpage>245</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syp106</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozachenko</surname> <given-names>L</given-names></name><name><surname>Leonenko</surname> <given-names>NN</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Sample estimate of the entropy of a random vector</article-title><source>Problems of Information Transmission</source><volume>23</volume><fpage>95</fpage><lpage>101</lpage></element-citation></ref><ref id="bib32"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Kroon</surname> <given-names>D-J</given-names></name></person-group><year iso-8601-date="2020">2020</year><source>2D Line Curvature and Normals (MATLAB Central File Exchange)</source><ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/matlabcentral/fileexchange/32696-2d-line-curvature-and-normals">https://www.mathworks.com/matlabcentral/fileexchange/32696-2d-line-curvature-and-normals</ext-link></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lecuit</surname> <given-names>T</given-names></name><name><surname>Brook</surname> <given-names>WJ</given-names></name><name><surname>Ng</surname> <given-names>M</given-names></name><name><surname>Calleja</surname> <given-names>M</given-names></name><name><surname>Sun</surname> <given-names>H</given-names></name><name><surname>Cohen</surname> <given-names>SM</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Two distinct mechanisms for long-range patterning by decapentaplegic in the <italic>Drosophila</italic> wing</article-title><source>Nature</source><volume>381</volume><fpage>387</fpage><lpage>393</lpage><pub-id pub-id-type="doi">10.1038/381387a0</pub-id><pub-id pub-id-type="pmid">8632795</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lecuit</surname> <given-names>T</given-names></name><name><surname>Cohen</surname> <given-names>SM</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Proximal-distal Axis formation in the <italic>Drosophila</italic> leg</article-title><source>Nature</source><volume>388</volume><fpage>139</fpage><lpage>145</lpage><pub-id pub-id-type="doi">10.1038/40563</pub-id><pub-id pub-id-type="pmid">9217152</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lecuit</surname> <given-names>T</given-names></name><name><surname>Cohen</surname> <given-names>SM</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Dpp receptor levels contribute to shaping the dpp morphogen gradient in the <italic>Drosophila</italic> wing imaginal disc</article-title><source>Development</source><volume>125</volume><fpage>4901</fpage><lpage>4907</lpage><pub-id pub-id-type="doi">10.1242/dev.125.24.4901</pub-id><pub-id pub-id-type="pmid">9811574</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>MacKay</surname> <given-names>DJ</given-names></name><name><surname>Mac Kay</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><source>Information Theory, Inference and Learning Algorithms</source><publisher-name>Cambridge university press</publisher-name></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masel</surname> <given-names>J</given-names></name><name><surname>Siegal</surname> <given-names>ML</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Robustness: mechanisms and consequences</article-title><source>Trends in Genetics</source><volume>25</volume><fpage>395</fpage><lpage>403</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2009.07.005</pub-id><pub-id pub-id-type="pmid">19717203</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masel</surname> <given-names>J</given-names></name><name><surname>Trotter</surname> <given-names>MV</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Robustness and evolvability</article-title><source>Trends in Genetics</source><volume>26</volume><fpage>406</fpage><lpage>414</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2010.06.002</pub-id><pub-id pub-id-type="pmid">20598394</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pélabon</surname> <given-names>C</given-names></name><name><surname>Hansen</surname> <given-names>TF</given-names></name><name><surname>Carter</surname> <given-names>AJ</given-names></name><name><surname>Houle</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Response of fluctuating and directional asymmetry to selection on wing shape in <italic>Drosophila melanogaster</italic></article-title><source>Journal of Evolutionary Biology</source><volume>19</volume><fpage>764</fpage><lpage>776</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2005.01054.x</pub-id><pub-id pub-id-type="pmid">16674573</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pizer</surname> <given-names>SM</given-names></name><name><surname>Amburn</surname> <given-names>EP</given-names></name><name><surname>Austin</surname> <given-names>JD</given-names></name><name><surname>Cromartie</surname> <given-names>R</given-names></name><name><surname>Geselowitz</surname> <given-names>A</given-names></name><name><surname>Greer</surname> <given-names>T</given-names></name><name><surname>ter Haar Romeny</surname> <given-names>B</given-names></name><name><surname>Zimmerman</surname> <given-names>JB</given-names></name><name><surname>Zuiderveld</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Adaptive histogram equalization and its variations</article-title><source>Computer Vision, Graphics, and Image Processing</source><volume>39</volume><fpage>355</fpage><lpage>368</lpage><pub-id pub-id-type="doi">10.1016/S0734-189X(87)80186-X</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rendel</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1959">1959</year><article-title>Canalization of the scute phenotype of <italic>Drosophila</italic></article-title><source>Evolution</source><volume>13</volume><fpage>425</fpage><lpage>439</lpage><pub-id pub-id-type="doi">10.2307/2406126</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Riemann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1867">1867</year><source>Grundlagen Fur Eine Allgemeine Theorie Der Functionen Einer Veränderlichen Complexen Grösse</source><publisher-name>Adalbert Rente</publisher-name></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rutherford</surname> <given-names>SL</given-names></name><name><surname>Lindquist</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Hsp90 as a capacitor for morphological evolution</article-title><source>Nature</source><volume>396</volume><fpage>336</fpage><lpage>342</lpage><pub-id pub-id-type="doi">10.1038/24550</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sonnenschein</surname> <given-names>A</given-names></name><name><surname>VanderZee</surname> <given-names>D</given-names></name><name><surname>Pitchers</surname> <given-names>WR</given-names></name><name><surname>Chari</surname> <given-names>S</given-names></name><name><surname>Dworkin</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2015">2015a</year><article-title>An image database of <italic>Drosophila melanogaster</italic> wings for phenomic and biometric analysis</article-title><source>GigaScience</source><volume>4</volume><elocation-id>s13742</elocation-id><pub-id pub-id-type="doi">10.1186/s13742-015-0065-6</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sonnenschein</surname> <given-names>A</given-names></name><name><surname>Chari</surname> <given-names>ID</given-names></name></person-group><year iso-8601-date="2015">2015b</year><source>Supporting Material and Data for &quot;An Image Database of Drosophila melanogaster Wings for Phenomic and Biometric Analysis</source><publisher-name>GigaScience Database</publisher-name></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sui</surname> <given-names>L</given-names></name><name><surname>Alt</surname> <given-names>S</given-names></name><name><surname>Weigert</surname> <given-names>M</given-names></name><name><surname>Dye</surname> <given-names>N</given-names></name><name><surname>Eaton</surname> <given-names>S</given-names></name><name><surname>Jug</surname> <given-names>F</given-names></name><name><surname>Myers</surname> <given-names>EW</given-names></name><name><surname>Jülicher</surname> <given-names>F</given-names></name><name><surname>Salbreux</surname> <given-names>G</given-names></name><name><surname>Dahmann</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Differential lateral and basal tension drive folding of <italic>Drosophila</italic> wing discs through two distinct mechanisms</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>4620</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-06497-3</pub-id><pub-id pub-id-type="pmid">30397306</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>van der Linde</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2003">2003</year><source>Wings 4</source></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Visser</surname> <given-names>JAGM</given-names></name><name><surname>Hermisson</surname> <given-names>J</given-names></name><name><surname>Wagner</surname> <given-names>GP</given-names></name><name><surname>Meyers</surname> <given-names>LA</given-names></name><name><surname>Bagheri‐Chaichian</surname> <given-names>H</given-names></name><name><surname>Blanchard</surname> <given-names>JL</given-names></name><name><surname>Chao</surname> <given-names>L</given-names></name><name><surname>Cheverud</surname> <given-names>JM</given-names></name><name><surname>Elena</surname> <given-names>SF</given-names></name><name><surname>Fontana</surname> <given-names>W</given-names></name><name><surname>Gibson</surname> <given-names>G</given-names></name><name><surname>Hansen</surname> <given-names>TF</given-names></name><name><surname>Krakauer</surname> <given-names>D</given-names></name><name><surname>Lewontin</surname> <given-names>RC</given-names></name><name><surname>Ofria</surname> <given-names>C</given-names></name><name><surname>Rice</surname> <given-names>SH</given-names></name><name><surname>Dassow</surname> <given-names>Gvon</given-names></name><name><surname>Wagner</surname> <given-names>A</given-names></name><name><surname>Whitlock</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Perspective: evolution and detection of genetic robustness</article-title><source>Evolution</source><volume>57</volume><fpage>1959</fpage><lpage>1972</lpage><pub-id pub-id-type="doi">10.1111/j.0014-3820.2003.tb00377.x</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waddington</surname> <given-names>CH</given-names></name></person-group><year iso-8601-date="1953">1953</year><article-title>Genetic assimilation of an acquired character</article-title><source>Evolution</source><volume>7</volume><fpage>118</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.2307/2405747</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Robustness and evolvability: a paradox resolved</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>275</volume><fpage>91</fpage><lpage>100</lpage><pub-id pub-id-type="doi">10.1098/rspb.2007.1137</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>Q</given-names></name><name><surname>Kulkarni</surname> <given-names>SR</given-names></name><name><surname>Verdu</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Divergence estimation for multidimensional densities via $k$-Nearest-Neighbor distances</article-title><source>IEEE Transactions on Information Theory</source><volume>55</volume><fpage>2392</fpage><lpage>2405</lpage><pub-id pub-id-type="doi">10.1109/TIT.2009.2016060</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wartlick</surname> <given-names>O</given-names></name><name><surname>Mumcu</surname> <given-names>P</given-names></name><name><surname>Kicheva</surname> <given-names>A</given-names></name><name><surname>Bittig</surname> <given-names>T</given-names></name><name><surname>Seum</surname> <given-names>C</given-names></name><name><surname>Jülicher</surname> <given-names>F</given-names></name><name><surname>González-Gaitán</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Dynamics of dpp signaling and proliferation control</article-title><source>Science</source><volume>331</volume><fpage>1154</fpage><lpage>1159</lpage><pub-id pub-id-type="doi">10.1126/science.1200037</pub-id><pub-id pub-id-type="pmid">21385708</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.66750.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Devenport</surname><given-names>Danelle</given-names></name><role>Reviewing Editor</role><aff><institution>Princeton University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This paper addresses the interesting problem of understanding how complex metazoan forms can be so robust and tolerant to perturbation. The authors have created a new landmark-free approach to morphological analysis of complex developmental structures (here, the fly wing) and use it to describe variation across individuals in a population and in response to weak genetic and environmental perturbations. Their finding that morphological variation amongst individuals follows along a low-dimensional, but spatially non-intuitive, mode is a fundamental result. The landmark-free analysis should be broadly applicable to other structures and developmental systems.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Global Constraints within the Developmental Program of the <italic>Drosophila</italic> Wing&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Naama Barkai as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential Revisions:</p><p>1) It's not entirely clear what is the 'true' answer when comparing phenotypes, and whether the dominant principle component in the data sets could just reflect the mapping method and choices made to delineate the wing. Can the authors test for this by intentionally augmenting wing shape and reference points and ask how these map to the disk? Please see reviewer2 point #1, #2, and #4 for specific recommendations.</p><p>2) The data support the notion that there is a low-dimensional character to the magnitude of variation amongst individuals in terms of developmental phenotype. It would be important to include a discussion addressing how is the size of such variations is related to fitness of individuals of a species. Could it be that weaker modes that carry less of the overall variation still are under strong selective pressure in certain environments and indeed, are strongly relevant for organismal fitness? Or is the argument that the global mode simply defines the most broadly conserved aspects of fitness? If the latter, then it is interesting to understand how much of the wing developmental program is captured in the top mode of variation.</p><p>3) The key technical feature of this work lies in the mapping of images of wing morphology to a fixed-sized disc and alignment over the ensemble of images. Could the authors discuss whether such a transform is guaranteed for any sort of structures during development? This may help readers understand how general the method developed here might be for enabling similar studies in other developmental systems.</p><p>4) Please address questions regarding technical aspects of the method – see reviewer2 point #3, #7.</p><p><italic>Reviewer #1:</italic></p><p>This paper addresses the interesting problem of understanding how the seemingly complex and even baroque developmental processes of metazoan forms can be so robust and tolerant to perturbation. The essence of the idea is to propose that there are hidden simplicities that are not obvious but that can be discovered in a data-driven manner using statistical reasoning. With this premise, the authors claim (1) they have created a new landmark-free approach to morphological analysis of complex developmental structures (here, the fly wing) in which ensembles of images are processed to identify the boundary of the structure, then mapped onto a disc while maintaining local geometry, and then aligned, (2) that this stack of aligned structures can be then statistically analyzed for pixel-by-pixel positional entropy, providing a high-dimensional feature space within which each image is embedded, (3) that the landmark-free analysis is superior to existing low-dimensional landmark-dependent approaches, (4) that eigenvalue decomposition of the ensemble shows that most of the variation amongst individuals is accounted for in just the top mode, (5) that the top modes of variation are different from what is learned by the traditional landmark-dependent approach, (6) that subtle genetic variations due to mutations or natural outbred variations project onto the top mode of this analysis, and (7) that significant perturbations due to temperature during development and or dietary fluctional largely excites variations along the same top mode. From this, the authors propose (1) that there are global, low-dimensional constraints within the development of the fly wing such that random, genetic, and environmental perturbations are largely forced to cause variations along a single mode of variation, and (2) that this mode is not obvious in traditional ways of analyzing morphological data.</p><p>In general, this is a very interesting and topical body of work. The question is important, and the specific findings seem well supported by the data presented. The finding that morphological variation amongst individuals follows along a low-dimensional (but spatially non-intuitive) mode is a fundamental result, especially if the approach of landmark-free analysis inspires other developmental biologists to check and verify the claims in many other systems. The finding that genetic and environmental variations also follow along the same global mode is a potentially deep statement about the relative simplicity underlying the vast apparent complexity of molecular mechanisms and more naively observed phenotypes associated with development. If the results of this work can be extended, it could represent an approach for a more general and simpler description of developmental processes and a route to better characterize the underlying mechanisms.</p><p>A couple specific points that the authors may wish to consider:</p><p>(1) The data support the notion that there is a low-dimensional character to the magnitude of variation amongst individuals in terms of developmental phenotype. But how is the size of such variations related to fitness of individuals of a species? Could it be that weaker modes that carry less of the overall variation still are under strong selective pressure in certain environments and indeed, are strongly relevant for organismal fitness? Or is the argument that the global mode simply defines the most broadly conserved aspects of fitness? If the latter, then it is interesting to understand how much of the wing developmental program is captured in the top mode of variation.</p><p>(2) The key technical feature of this work lies in the mapping of images of wing morphology to a fixed-sized disc and alignment over the ensemble of images. Perhaps the authors could indicate whether such a transform is guaranteed for any sort of structures during development. This may help readers understand how general the method developed here might be for enabling similar studies in other developmental systems.</p><p><italic>Reviewer #2:</italic></p><p>The authors implement a novel method for quantifying phenotypic variation in flat two dimensional structures that consists in mapping the entire image into a standard shape (a disk) by an angle preserving transformation. It eliminates the need for preselecting fiducial marks and projecting onto the space of their relative positions. They analyze the <italic>Drosophila</italic> wing, which is nicely two dimensional, and well-studied by other means, thus a good benchmark. The authors find that variation within a population and in response to various weak genetic mutations predominately fall along the same principle component.</p><p>It's not entirely clear what is the 'true' answer when comparing phenotypes, and whether the dominant principle component in the data sets could just reflect the mapping method and choices made to delineate the wing. Nevertheless, the authors new method is provocative and deserves to reach a wide audience, who can try it on other data sets.</p><p>1. It's difficult to design a data set in this area where the 'ground truth' is known, so that the degree an algorithm discovers that truth is a measure of its quality. The worry then is the authors analysis inserts some variability in a particular way and the primary principle component just 'discovers', the variability that was inserted. I do not know how to definitively test for this, but to check for the obvious things, can the authors:</p><p>i. Intentionally augment the outer boundary of the wing, and analyze as in Figure 5. Is R &gt;&gt; σ. What if some ripple was added to the boundary, what would that look like mapped to the disk?</p><p>ii. The authors need to rely on a reference feature to map to the origin of the disk. Assume the position of that was randomized by a few pixels, how would that display in Figure 5?</p><p>iii. Same set of questions for the way the authors separate the wing from the hinge</p><p>2. In Figure 2d most of the variation is in common for male-females under the landmark free methods while with landmarks the largest PCA component discovers sex. The authors claim this is a vindication of their method, but could it in fact be a problem (as suggested in 1.) Also the data in 2d seems to be bipartite, any explanation?</p><p>3. Can the authors take their conformal mapped and registered images, and extract the coordinates of the Procrustes reference points. What is the relation of the principle components based on the Procrustes variables versus their pixel based measures. It's not entirely clear to me what feature their dominant PC picks up. If I shift a vein normal to itself a lot of pixels change, but the movement is less consequential viewed as an operation on a vein. Thus as usual an information theory measure can be misleading.</p><p>4. A key finding is that genetic perturbations fall along the same PC as does intrapopulation variation. In the case of the gene tkv the authors remark that their analysis picks up the same feature displacement in the weak heterozygote as in the homozygote. Is the same true for the other mutants they examine, in particular N. The N mutants are readily visible, if they are processed as in Figure 5b,c would they fall along the primary PC? If the authors consider it too onerous to measure on new flies, can they just by photoshop impose a comparable mutation on a few of their current images and process?</p><p>5. With their environmental perturbations the authors could ascertain when in development the wings are sensitive to the environment, ie does a molt reset the phenotype of the wing?</p><p>6. The ultimate test of the unique principle component, is to measure the wings on a closely related species of <italic>Drosophila</italic> (as the authors remark at the end of their discussion). Would this be a big increment in work over what has already been done? Just 10's of individuals from a stock collection of D. simulans, D. schellia or whatever is easiest. Some of these species make sterile hybrids with <italic>D. melanogaster</italic>, so it would be interesting to know how close the wings are.</p><p>7. Some technical remarks about the mapping to the disk</p><p>i. Is there a reflection among the rotations to align the right and left wings?</p><p>ii. Is it obvious one should do PCA directly on the pixel variables, (ie not log transformed for instance). Not many pixels change, but those that do may change their gray scale by a factor of 2-10 (depending on how you are treating background). Does this matter?</p><p>The paper is clearly written and should be published after the above questions and those from other referees are addressed. If it's wrong, it's at least interesting.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.66750.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>A couple specific points that the authors may wish to consider:</p><p>(1) The data support the notion that there is a low-dimensional character to the magnitude of variation amongst individuals in terms of developmental phenotype. But how is the size of such variations related to fitness of individuals of a species? Could it be that weaker modes that carry less of the overall variation still are under strong selective pressure in certain environments and indeed, are strongly relevant for organismal fitness? Or is the argument that the global mode simply defines the most broadly conserved aspects of fitness? If the latter, then it is interesting to understand how much of the wing developmental program is captured in the top mode of variation.</p></disp-quote><p>We thank the reviewer for raising these most fundamental issues. First, we have included additional figures in a new section of the SI where the eigenvalue spectrum of each ensemble is presented. Indeed, the first mode carries significantly more variation than the remainder, combined. Second, as the reviewer no doubt recognizes, we have no empirical approach to quantitatively estimate the fitness of wings and/or individuals. That said, the relation between form and fitness is central to what we conclude from our observations. We have now included an additional discussion of the two possible scenarios that the reviewer points out in our Discussion section of the manuscript, which we recount here:</p><disp-quote content-type="editor-comment"><p>“The correspondence between the constrained phenotypic mode identified in this study and fitness remains unclear. The mode could correspond to changes in organismal form that buffer the system from perturbations with little or no impact on fitness. Alternately, the identified mode could correspond to the most broadly conserved aspects of fitness. Disambiguating between these possibilities is central to understand the origins and consequences of such phenotypic constraints.”</p><p>(2) The key technical feature of this work lies in the mapping of images of wing morphology to a fixed-sized disc and alignment over the ensemble of images. Perhaps the authors could indicate whether such a transform is guaranteed for any sort of structures during development. This may help readers understand how general the method developed here might be for enabling similar studies in other developmental systems.</p></disp-quote><p>We thank the reviewer for pointing out this gap in our discussion of the method. As the</p><p>reviewer is no doubt aware, the mathematical foundation of the method outlined in our</p><p>study is the Riemann mapping theorem, which holds for a smooth two-dimensional</p><p>surface with no holes. We now have a more detailed statement in the manuscript describing this, which we recount here:</p><p>“Our approach (code is available at (48)) is to use a conformal map to map all homologous body structures onto the same shape, in this case, a disc of fixed size. Although we apply the approach to one body structure, the <italic>Drosophila</italic> wing, it can be applied to any two-dimensional surface with no holes, with or without a boudnary. This could be a simple 2D shape like the wing or the closed surface of a complex 3D shape such as a tooth, brain, or another body part.”</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>The authors implement a novel method for quantifying phenotypic variation in flat two dimensional structures that consists in mapping the entire image into a standard shape (a disk) by an angle preserving transformation. It eliminates the need for preselecting fiducial marks and projecting onto the space of their relative positions. They analyze the Drosophila wing, which is nicely two dimensional, and well-studied by other means, thus a good benchmark. The authors find that variation within a population and in response to various weak genetic mutations predominately fall along the same principle component.</p><p>It's not entirely clear what is the 'true' answer when comparing phenotypes, and whether the dominant principle component in the data sets could just reflect the mapping method and choices made to delineate the wing. Nevertheless, the authors new method is provocative and deserves to reach a wide audience, who can try it on other data sets.</p><p>1. It's difficult to design a data set in this area where the 'ground truth' is known, so that the degree an algorithm discovers that truth is a measure of its quality. The worry then is the authors analysis inserts some variability in a particular way and the primary principle component just 'discovers', the variability that was inserted. I do not know how to definitively test for this, but to check for the obvious things, can the authors:</p><p>i. Intentionally augment the outer boundary of the wing, and analyze as in Figure 5. Is R &gt;&gt; σ. What if some ripple was added to the boundary, what would that look like mapped to the disk?</p><p>ii. The authors need to rely on a reference feature to map to the origin of the disk. Assume the position of that was randomized by a few pixels, how would that display in Figure 5?</p><p>iii. Same set of questions for the way the authors separate the wing from the hinge</p></disp-quote><p>We thank the reviewer for identifying these additional checks of the robustness and accuracy of our method. We have included an analysis of all three suggested artificial perturbations of the system in our SI. While the quantitative details of the resulting dependence of σ/R vs R are altered, the qualitative features remain invariant. Crucially, R&gt;&gt;σ for perturbations of reasonable amplitude – see Figure 5—figure supplement 2. In particular, we jiggle the location of hinge cut points and the origin by 3 pixel in each the x and y directions (f and g), and introduce noise in the segmented boundary with the same amplitude.</p><disp-quote content-type="editor-comment"><p>2. In Figure 2d most of the variation is in common for male-females under the landmark free methods while with landmarks the largest PCA component discovers sex. The authors claim this is a vindication of their method, but could it in fact be a problem (as suggested in 1.)</p></disp-quote><p>We include a more detailed description of the relative orientations of the long axis in the data and the axis corresponding to sexual dimorphism in the high-quality images of environmental variation. We observe that within stressed populations of flies, at low diet and high temperatures close to their physiological limit (29°C), the sexual dimorphism axis rotates from being orthogonal to the long axis in the data to parallel – see Figure 2—figure supplement 3. This conditional GxE interaction (G being sex-specific genes) provides further evidence that what we are observing is biological in origin, rather than an artifact of our pipeline. It is also consistent with our observation that alignment of mutational perturbations in signaling genes with the long axis in the data is sometimes dependent on the sex of the flies, depending on the mutation (Figure 5 in manuscript)</p><disp-quote content-type="editor-comment"><p>Also the data in 2d seems to be bipartite, any explanation?</p></disp-quote><p>The bipartite nature of the data at 25C high diet isn’t observed at other conditions – See figure 3 in this response document. All of this data is now included in an additional section of the SI.</p><disp-quote content-type="editor-comment"><p>3. Can the authors take their conformal mapped and registered images, and extract the coordinates of the Procrustes reference points. What is the relation of the principle components based on the Procrustes variables versus their pixel based measures. It's not entirely clear to me what feature their dominant PC picks up. If I shift a vein normal to itself a lot of pixels change, but the movement is less consequential viewed as an operation on a vein. Thus as usual an information theory measure can be misleading.</p></disp-quote><p>We thank the reviewer for identifying two issues in this recommendation. First, precisely for the reasons identified by the reviewer, we take the radon transform of the disc mapped and aligned images of wings. The reason for doing so is so that the anticipated correlated deformation of veins across the ensemble of wings is represented more suitably in radon space. All analysis is performed in the radon space, which as the reviewer is no doubt aware, is an invertible transform. We have now further emphasized this aspect of our analysis in the manuscript.</p><p>Second, following the reviewer’s recommendation we present a comparative analysis of the mapped locations of landmarks in the disc and the pixel-based measure. We indeed agree that the landmark centric view of the wing “focuses” on gross deformations of veins, while the pixel-based approach has no knowledge of these macroscopic structures. We thus wanted to assess what the relation between disc mapped landmarks and the dominant direction (PC1) of the pixel-based approach was. In Figure 4C, we present the cloud of landmark data for the 25°C high diet ensemble of wing images. In Figure 4D we present a quantitative analysis of the degree of correlation between the principal components of disc-mapped/aligned landmarks and the pixel-based approach. Most crucially, we observe that PC1 of the pixel-based approach is not captured in the landmark spectrum. Indeed, what we observe is that PC2 is the sexual dimorphism axis and that this is observable in the landmark based approach. Thus, it seems like the variation encoded in PC1 of the pixel-based approaches is not encoded in the landmarking based approach.</p><disp-quote content-type="editor-comment"><p>4. A key finding is that genetic perturbations fall along the same PC as does intrapopulation variation. In the case of the gene tkv the authors remark that their analysis picks up the same feature displacement in the weak heterozygote as in the homozygote. Is the same true for the other mutants they examine, in particular N. The N mutants are readily visible, if they are processed as in Figure 5b,c would they fall along the primary PC? If the authors consider it too onerous to measure on new flies, can they just by photoshop impose a comparable mutation on a few of their current images and process?</p></disp-quote><p>As the reviewer notes, the Notch pathway is important to wing development. One of the mutants we analyzed in heterozygous state is in the mastermind (mam) gene. Mam is a <italic>Drosophila</italic> transcriptional coactivator that specifically functions in the Notch pathway. Mam physically binds to Su(H) in the nucleus but only when Su(H) is complexed to the Notch ICD. Mam recruits p300/CBP to Notch-dependent gene enhancers where they elicit nucleosome acetylation and transcriptional activation. In the wing, mam mutants phenocopy N mutants’ effects on vein patterning. Thus, our analysis of mam heterozygous mutant wings is our proxy for a weak effect N mutant. As the reviewer can see in Figure 5B, the mam data follows the general geometric trend observed in the data as a whole.</p><disp-quote content-type="editor-comment"><p>5. With their environmental perturbations the authors could ascertain when in development the wings are sensitive to the environment, ie does a molt reset the phenotype of the wing?</p></disp-quote><p>This is precisely one of the experiments we are currently pursuing. Figuring out what developmental stage or process buffers the system from perturbations is crucial.</p><disp-quote content-type="editor-comment"><p>6. The ultimate test of the unique principle component, is to measure the wings on a closely related species of Drosophila (as the authors remark at the end of their discussion). Would this be a big increment in work over what has already been done? Just 10's of individuals from a stock collection of D. simulans, D. schellia or whatever is easiest. Some of these species make sterile hybrids with D. melanogaster, so it would be interesting to know how close the wings are.</p></disp-quote><p>Again, the reviewer has predicted what experiments we are currently pursuing. We have indeed acquired the three closely related <italic>Drosophila</italic> species to <italic>D. melanogaster</italic> (all part of the Madagascar radiation 3 Mya) and measurements of wing phenotypes within and across these ensembles are underway. We agree with the reviewer that this is the ultimate test. Additionally, the reviewer is also correct that the patterns of which species can cross is complex, and we intend to study its correlation with phenotypic distance of wings. Again, we thank the reviewer for their prescient insights.</p><disp-quote content-type="editor-comment"><p>7. Some technical remarks about the mapping to the disk</p><p>i. Is there a reflection among the rotations to align the right and left wings?</p></disp-quote><p>First, we performed an analysis to validate the lack of any left-right patterning in the wing, which is what we anticipated based on 100 years of research. An individual’s left and right wings are of course slightly different from each other, but there is no systematic trend across individuals that we observed. Thus, we batch together left and right wings to increase our numbers. This is achieved through reflection. We have now included a description of this in the manuscript.</p><disp-quote content-type="editor-comment"><p>ii. Is it obvious one should do PCA directly on the pixel variables, (ie not log transformed for instance). Not many pixels change, but those that do may change their gray scale by a factor of 2-10 (depending on how you are treating background). Does this matter?</p></disp-quote><p>The reviewer is correct that few pixels change across images, and those that change do so by a significant factor. For example, motion of a vein across a database corresponds to a significant variation in intensity in limited zones of the image. We had previously performed the analysis on log-transformed data, and log-transform of the inverse of data (where veins are bright as opposed to dark structures) to investigate the very issue that is being raised here. We confirmed that all the statistical trends are maintained with intensity transformed data. We now include this analysis in Figure 5—figure supplement 3. Again, we thank the referee for this and other recommendations through which we believe we have provided further evidence towards the accuracy and robustness of the computational approach/pipeline.</p></body></sub-article></article>