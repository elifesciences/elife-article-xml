<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">99688</article-id><article-id pub-id-type="doi">10.7554/eLife.99688</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.99688.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Modeling and simulation of neocortical micro- and mesocircuitry (Part I, anatomy)</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes"><name><surname>Reimann</surname><given-names>Michael W</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3455-2367</contrib-id><email>mwr@reimann.science</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="fn1">‡</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes"><name><surname>Bolaños-Puchet</surname><given-names>Sirio</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4049-6488</contrib-id><email>sirio.bolanospuchet@epfl.ch</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="fn1">‡</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Courcol</surname><given-names>Jean-Denis</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="fn1">‡</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Egas Santander</surname><given-names>Daniela</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9838-7992</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="fn1">‡</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Arnaudon</surname><given-names>Alexis</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Coste</surname><given-names>Benoît</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Delalondre</surname><given-names>Fabien</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Delemontex</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Devresse</surname><given-names>Adrien</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Dictus</surname><given-names>Hugo</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Dietz</surname><given-names>Alexander</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Ecker</surname><given-names>András</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9635-4169</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con12"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Favreau</surname><given-names>Cyrille</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con13"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Ficarelli</surname><given-names>Gianluca</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con14"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Gevaert</surname><given-names>Mike</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con15"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Herttuainen</surname><given-names>Joni</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con16"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Isbister</surname><given-names>James B</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con17"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Kanari</surname><given-names>Lida</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con18"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Keller</surname><given-names>Daniel</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con19"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>King</surname><given-names>James</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con20"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Kumbhar</surname><given-names>Pramod</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con21"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Lapere</surname><given-names>Samuel</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con22"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Lazovskis</surname><given-names>Jãnis</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con23"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Lu</surname><given-names>Huanxiang</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con24"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Ninin</surname><given-names>Nicolas</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con25"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Pereira</surname><given-names>Fernando</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con26"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Planas</surname><given-names>Judit</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8221-7988</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con27"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Pokorny</surname><given-names>Christoph</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con28"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Riquelme</surname><given-names>Juan Luis</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con29"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Romani</surname><given-names>Armando</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con30"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Shi</surname><given-names>Ying</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con31"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Smith</surname><given-names>Jason P</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con32"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Sood</surname><given-names>Vishal</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con33"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Srivastava</surname><given-names>Mohit</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con34"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Van Geit</surname><given-names>Werner</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con35"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Vanherpe</surname><given-names>Liesbeth</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con36"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Wolf</surname><given-names>Matthias</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con37"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Levi</surname><given-names>Ran</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="fn2">§</xref><xref ref-type="fn" rid="con38"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Hess</surname><given-names>Kathryn</given-names></name><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="fn2">§</xref><xref ref-type="fn" rid="con39"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Schürmann</surname><given-names>Felix</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="fn2">§</xref><xref ref-type="fn" rid="con40"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Muller</surname><given-names>Eilif B</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4309-8266</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="fn2">§</xref><xref ref-type="fn" rid="con41"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Markram</surname><given-names>Henry</given-names></name><email>henry.markram@epfl.ch</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="fn2">§</xref><xref ref-type="fn" rid="con42"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name><email>Srikanth.Ramaswamy@newcastle.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="fn2">§</xref><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund7"/><xref ref-type="other" rid="fund8"/><xref ref-type="other" rid="fund9"/><xref ref-type="other" rid="fund10"/><xref ref-type="fn" rid="con43"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s376052</institution-id><institution>Blue Brain Project, École polytechnique fédérale de Lausanne (EPFL), Campus Biotech</institution></institution-wrap><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00twb6c09</institution-id><institution>Riga Business School, Riga Technical University</institution></institution-wrap><addr-line><named-content content-type="city">Riga</named-content></addr-line><country>Latvia</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04xyxjd90</institution-id><institution>Nottingham Trent University</institution></institution-wrap><addr-line><named-content content-type="city">Nottingham</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02xf66n48</institution-id><institution>ELKH-University of Debrecen, Neuroscience Research Group</institution></institution-wrap><addr-line><named-content content-type="city">Debrecen</named-content></addr-line><country>Hungary</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/016476m91</institution-id><institution>University of Aberdeen</institution></institution-wrap><addr-line><named-content content-type="city">Aberdeen</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s376052</institution-id><institution>Laboratory for Topology and Neuroscience (UPHESS), Brain Mind Institute, School of Life Sciences, École polytechnique fédérale de Lausanne (EPFL)</institution></institution-wrap><addr-line><named-content content-type="city">Lausanne</named-content></addr-line><country>Switzerland</country></aff><aff id="aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01kj2bm70</institution-id><institution>Neural Circuits Laboratory, Newcastle University</institution></institution-wrap><addr-line><named-content content-type="city">Newcastle</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Naud</surname><given-names>Richard</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03c4mmv16</institution-id><institution>University of Ottawa</institution></institution-wrap><country>Canada</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Poirazi</surname><given-names>Panayiota</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01gzszr18</institution-id><institution>FORTH Institute of Molecular Biology and Biotechnology</institution></institution-wrap><country>Greece</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="other" id="fn1"><label>‡</label><p>Co-lead authors</p></fn><fn fn-type="other" id="fn2"><label>§</label><p>Co-senior authors</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>20</day><month>01</month><year>2026</year></pub-date><volume>13</volume><elocation-id>RP99688</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2024-06-12"><day>12</day><month>06</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2024-06-07"><day>07</day><month>06</month><year>2024</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.08.11.503144"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-08-13"><day>13</day><month>08</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.99688.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-11-26"><day>26</day><month>11</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.99688.2"/></event></pub-history><permissions><copyright-statement>© 2024, Reimann, Bolaños-Puchet, Courcol et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Reimann, Bolaños-Puchet, Courcol et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-99688-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-99688-figures-v1.pdf"/><related-article related-article-type="article-reference" ext-link-type="doi" xlink:href="10.7554/eLife.99693" id="ra1"/><abstract><p>The function of the neocortex is fundamentally determined by its repeating microcircuit motif, but also by its rich, interregional connectivity. We present a data-driven computational model of the anatomy of non-barrel primary somatosensory cortex of juvenile rat, integrating whole-brain scale data while providing cellular and subcellular specificity. The model consists of 4.2 million morphologically detailed neurons, placed in a digital brain atlas. They are connected by 14.2 billion synapses, comprising local, mid-range and extrinsic connectivity. We delineated the limits of determining connectivity from neuron morphology and placement, finding that it reproduces targeting by Sst+ neurons, but requires additional specificity to reproduce targeting by PV+ and VIP+ interneurons. Globally, connectivity was characterized by local clusters tied together through hub neurons in layer 5, demonstrating how local and interegional connectivity are complicit, inseparable networks. The model is suitable for simulation-based studies, and the model is made openly available to the community.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>modeling</kwd><kwd>connectomics</kwd><kwd>topology</kwd><kwd>brain anatomy</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Rat</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000266</institution-id><institution>Engineering and Physical Sciences Research Council</institution></institution-wrap></funding-source><award-id>EP/P025072/1</award-id><principal-award-recipient><name><surname>Lazovskis</surname><given-names>Jãnis</given-names></name><name><surname>Smith</surname><given-names>Jason P</given-names></name><name><surname>Levi</surname><given-names>Ran</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001703</institution-id><institution>École Polytechnique Fédérale de Lausanne</institution></institution-wrap></funding-source><award-id>collaboration grant</award-id><principal-award-recipient><name><surname>Levi</surname><given-names>Ran</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100018694</institution-id><institution>HORIZON EUROPE Marie Sklodowska-Curie Actions</institution></institution-wrap></funding-source><award-id>842492</award-id><principal-award-recipient><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000774</institution-id><institution>Newcastle University</institution></institution-wrap></funding-source><award-id>Academic Track (NUAcT) Fellowship</award-id><principal-award-recipient><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010629</institution-id><institution>Fulbright Association</institution></institution-wrap></funding-source><award-id>Research Scholarship</award-id><principal-award-recipient><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001255</institution-id><institution>Lister Institute of Preventive Medicine</institution></institution-wrap></funding-source><award-id>Prize Fellowship</award-id><principal-award-recipient><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000691</institution-id><institution>Academy of Medical Sciences</institution></institution-wrap></funding-source><award-id>Springboard Award</award-id><principal-award-recipient><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000181</institution-id><institution>Air Force Office of Scientific Research</institution></institution-wrap></funding-source><award-id>FA9550-23-1-0533</award-id><principal-award-recipient><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name></principal-award-recipient></award-group><award-group id="fund9"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001675</institution-id><institution>International Brain Research Organization</institution></institution-wrap></funding-source><award-id>Early-career Award</award-id><principal-award-recipient><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name></principal-award-recipient></award-group><award-group id="fund10"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004199</institution-id><institution>Okinawa Institute of Science and Technology Graduate University</institution></institution-wrap></funding-source><award-id>Theoretical Sciences Visiting Program</award-id><principal-award-recipient><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name></principal-award-recipient></award-group><award-group id="fund11"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100020899</institution-id><institution>ETH Board of the Swiss Federal Institutes of Technology</institution></institution-wrap></funding-source><award-id>Funding to the Blue Brain Project</award-id><principal-award-recipient><name><surname>Reimann</surname><given-names>Michael W</given-names></name><name><surname>Bolaños-Puchet</surname><given-names>Sirio</given-names></name><name><surname>Courcol</surname><given-names>Jean-Denis</given-names></name><name><surname>Arnaudon</surname><given-names>Alexis</given-names></name><name><surname>Coste</surname><given-names>Benoît</given-names></name><name><surname>Delalondre</surname><given-names>Fabien</given-names></name><name><surname>Delemontex</surname><given-names>Thomas</given-names></name><name><surname>Devresse</surname><given-names>Adrien</given-names></name><name><surname>Dictus</surname><given-names>Hugo</given-names></name><name><surname>Dietz</surname><given-names>Alexander</given-names></name><name><surname>Ecker</surname><given-names>András</given-names></name><name><surname>Favreau</surname><given-names>Cyrille</given-names></name><name><surname>Ficarelli</surname><given-names>Gianluca</given-names></name><name><surname>Gevaert</surname><given-names>Mike</given-names></name><name><surname>Herttuainen</surname><given-names>Joni</given-names></name><name><surname>Isbister</surname><given-names>James B</given-names></name><name><surname>Kanari</surname><given-names>Lida</given-names></name><name><surname>Keller</surname><given-names>Daniel</given-names></name><name><surname>King</surname><given-names>James</given-names></name><name><surname>Kumbhar</surname><given-names>Pramod</given-names></name><name><surname>Lapere</surname><given-names>Samuel</given-names></name><name><surname>Lu</surname><given-names>Huanxiang</given-names></name><name><surname>Pereira</surname><given-names>Fernando</given-names></name><name><surname>Planas</surname><given-names>Judit</given-names></name><name><surname>Pokorny</surname><given-names>Christoph</given-names></name><name><surname>Riquelme</surname><given-names>Juan Luis</given-names></name><name><surname>Romani</surname><given-names>Armando</given-names></name><name><surname>Shi</surname><given-names>Ying</given-names></name><name><surname>Sood</surname><given-names>Vishal</given-names></name><name><surname>Van Geit</surname><given-names>Werner</given-names></name><name><surname>Vanherpe</surname><given-names>Liesbeth</given-names></name><name><surname>Wolf</surname><given-names>Matthias</given-names></name><name><surname>Schürmann</surname><given-names>Felix</given-names></name><name><surname>Muller</surname><given-names>Eilif B</given-names></name><name><surname>Markram</surname><given-names>Henry</given-names></name><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A morphologically detailed model of brain region anatomy serves as the foundation for biophysically detailed simulations and provides insights into local and inter-regional connectivity.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Cortical dynamics underlie many cognitive processes and emerge from complex multi-scale interactions. These emerging dynamics can be explored in <italic>large-scale, data-driven, biophysically-detailed</italic> models (<xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>; <xref ref-type="bibr" rid="bib6">Billeh et al., 2020</xref>), which integrate different levels of organization. The strict biological and spatial context enables the integration of knowledge and theories, the testing and generation of precise hypotheses, and the opportunity to recreate and extend diverse laboratory experiments based on a single model. This approach differs from more abstract models in that it emphasizes <italic>anatomical completeness</italic> of a chosen brain volume rather than implementing a specific hypothesis. Using a ‘bottom-up’ modelling approach, many detailed constituent models are combined to produce a larger, multi-scale model. To the best possible approximation, such models should explicitly include different cell and synapse types with the same quantities, geometric configuration and connectivity patterns as the biological tissue it represents.</p><p>Investigating the multi-scale interactions that shape perception requires a model of multiple cortical subregions with inter-region connectivity, and for certain aspects, the subcellular resolution provided by a morphologically detailed model is also required. In particular, <xref ref-type="bibr" rid="bib5">Barabási et al., 2023</xref> argued that the function of the healthy or diseased brain can only be understood when the true physical nature of neurons is taken into account and no longer simplified into point-neuron networks. Also, <xref ref-type="bibr" rid="bib28">Einevoll et al., 2019</xref> pointed out that simulations of large-scale models are essential for bridging the scales between the neuron and system levels in the brain. In that regard, modern electron-microscopic datasets have reached a scale that allows the reconstruction of a ground truth wiring diagram of local connectivity between several thousand neurons (<xref ref-type="bibr" rid="bib4">Bae et al., 2021</xref>). However, this only covers a small fraction of the inputs a cortical neuron receives. While afferents from outside the reconstructed volume are detected, one can only speculate about the identity of their source neurons and connections between them. The scale required to understand inter-regional interactions is only available at lower resolutions in the form of region-to-region or voxel-to-voxel connectivity data.</p><p>To help better understand cortical structure and function, we present a general approach to create morphologically detailed models of multiple interconnected cortical regions based on the geometry of a digitized volumetric brain atlas, with synaptic connectivity predicted from anatomy and biological constraints (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We used it to build a model of the juvenile rat non-barrel somatosensory (nbS1) regions (<xref ref-type="fig" rid="fig1">Figure 1</xref>, center). These regions were selected for the wealth of available experimental data from various labs, and to build upon our previous modeling work (<xref ref-type="table" rid="table1">Table 1</xref>). The workflow is based on the work described in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>, with several additions, refinements and new data sources that have been independently described and validated in separate publications (<xref ref-type="table" rid="table1">Table 1</xref>). The model captures the morphological diversity of neurons and their placement in the actual geometry of the modeled regions through the use of voxelized atlas information. We calculated at each point represented in the atlas the distance to and direction towards the cortical surface (<xref ref-type="fig" rid="fig1">Figure 1</xref>; step 1). We used that information to select from a pool of morphological reconstructions anatomically fitting ones and orient their dendrites and axons appropriately (<xref ref-type="fig" rid="fig1">Figure 1</xref>; step 2). As a result, the model was anatomically complete in terms of the volume occupied by dendrites in individual layers. We then combined established algorithms for the prediction of local (<xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>) and mid-range (<xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref>) connectivity (<xref ref-type="fig" rid="fig1">Figure 1</xref>; step 3) as well as extrinsic connectivity from thalamic sources (<xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>, <xref ref-type="fig" rid="fig1">Figure 1</xref>; step 4) to generate a connectome at subcellular resolution that combines those scales.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of the model building and analysis workflow.</title><p>Step 1: Building was based on a volumetric atlas of the modeled regions: (1) S1J; (2) S1FL; (3) S1Tr; (4) S1HL; (5) S1Sh; (6) S1DZ; (7) S1DZO; (8) S1ULp. Additional atlases of biological cell densities and local orientation towards the surface were built. Step 2: Neuron morphologies were reconstructed and classified into 60 morphological types (<italic>m-types</italic>). They were placed in the volume according to the densities and orientations from step 1. Step 3: The anatomy of intrinsic synaptic connectivity was derived as the union of one algorithm for <italic>local</italic> connectivity and one for <italic>mid-range</italic> connectivity. Step 4: Extrinsic inputs from two thalamic sources were placed on modeled dendrites according to published methods. Step 5: Taken together, these steps allowed us to predict the topology of connectivity at scale with (sub-)cellular resolution. Step 6: The anatomical model served as the basis of a physiological model, ready to be simulated. This is presented in an accompanying manuscript. Step 7: The model, simulation and analysis tools have been made publicly available. Left: During modeling, three types of generalization had to be made to fulfill input data requirements: from mouse to rat, from adult to juvenile, and from one cortical region to another. Generalizations used are indicated in each step.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Derivation of neuron density depth profiles.</title><p>Left: A vertical profile of neuron densities, calculated from antibody stains of neuronal nuclear protein (NeuN). From left to right: Neuron densities in each bin are split into individual morphological types through antibody stains for various markers (blue boxes) and an established mapping of markers to types (green), or by applying established neuronal compositions (red). Information in this flow diagram is illustrative, not quantitative.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig1-figsupp1-v1.tif"/></fig></fig-group><p>We characterized several emerging aspects of connectivity (<xref ref-type="fig" rid="fig1">Figure 1</xref>; step 5). First, we found that brain geometry, that is differences in cortical thickness and curvature have surprisingly large effects on how much individual layers contribute to the connections a neuron partakes in. Second, we characterized the predicted structure of connectivity at an unprecedented scale and determine its implications for neuronal function. In particular, we analyzed how the widths of thalamo-cortical axons constrains the types of cortical maps emerging. Furthermore, we characterized the global topology of interacting local and mid-range connectivity, finding highly complex topology of local and mid-range connectivity that specifically requires neuronal morphologies. Finally, we systematically analyzed the higher-order structure of connectivity beyond the level of pairwise statistics, such as connection probabilities. Doing so, we characterized highly connected clusters of neurons, distributed throughout the volume that are tied together by mid-range synaptic paths mediated by neurons in layer 5, which act as ‘highway hubs’ interconnecting spatially distant neurons in the model. The highly non-random structure of higher-order interactions in the model’s connectivity was further validated in a range of follow-up publications using the model (<xref ref-type="bibr" rid="bib24">Ecker et al., 2024b</xref>; <xref ref-type="bibr" rid="bib26">Egas Santander et al., 2024a</xref>; <xref ref-type="bibr" rid="bib87">Reimann et al., 2024</xref>).</p><p>Finally, we present an accompanying manuscript that details neuronal and synaptic physiology modeled on top of these results, describes the emergence of an in vivo-like state of simulated activity, and delivers a number of in silico experiments generating insights about the neuronal mechanisms underlying published in vivo and in vitro experiments (<xref ref-type="bibr" rid="bib47">Isbister et al., 2024</xref>; <xref ref-type="fig" rid="fig1">Figure 1</xref>; step 6).</p><p>The anatomically detailed modeling approach provides a one-to-one correspondence between most types of experimental data and the model, allowing the data to be readily integrated. However, this also leads to the difficult challenge to curate the data and decide which anatomical trend should be integrated next. Due to the incredible speed of discovery in the field of neuroscience an integrative model will always be lagging behind the latest results, and due to its immense breadth, there is no clear answer to which feature is most important. We believe the solution to this is to provide a validated model with clearly characterized strengths and weaknesses, along with the computational tools to customize it to fit individual projects. We have therefore made not only the model, but also most of our tool chain openly available to the public (<xref ref-type="fig" rid="fig1">Figure 1</xref>; step 7).</p><p>Already the process of adding a new data source to drive a refinement of the model serves to provide important insights. We demonstrate this by comparing the model to connectivity characterized through electron microscopy (<xref ref-type="bibr" rid="bib4">Bae et al., 2021</xref>), finding mismatches, and describing the changes required to fix them. This allowed us to determine which rules are required to predict connectivity from the locations and densities of neuronal processes. Previously, simple overlap of distributions of axonal and dendritic segments has been proposed (Peters’ rule; <xref ref-type="bibr" rid="bib74">Peters and Feldman, 1976</xref>; <xref ref-type="bibr" rid="bib35">Garey, 1999</xref>), and contrasted with findings of preference for specific cell types or subcellular domains (<xref ref-type="bibr" rid="bib110">White and Keller, 1987</xref>; <xref ref-type="bibr" rid="bib62">Mishchenko et al., 2010</xref>). Our approach to local connectivity combines overlap with the principle of cooperative synapse formation (<xref ref-type="bibr" rid="bib29">Fares and Stepanyants, 2009</xref>; <xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>), additionally <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref> proposed a combination of overlap and targeting preferences. Our comparison to electron microscopy let us uncover the strength and nature of the targeting preferences shaping connectivity beyond neuronal and regional anatomy. We found that cooperative synapse formation explains some forms of apparent targeting. Additionally, we found that the distribution of postsynaptic compartments targeted by connections from somatostatin (Sst)-positive neurons is readily predicted from overlap only, while for parvalbumin (PV)-positive and vasoactive intestinal peptide (VIP)-positive neurons additional specificity plays a role. We found no indication of additional specificity for excitatory neurons. The model is available both with and without the characterized inhibitory specificity.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Atlas-based neuron placement</title><p>The workflow for modeling the anatomy of juvenile rat nbS1 is based on the work described in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>, with several additions and refinements. Most of the individual steps and data sources have already been independently described and validated in separate publications (<xref ref-type="table" rid="table1">Table 1</xref>). The basis of the work was a digital atlas of juvenile rat somatosensory cortex, based on the classic work of <xref ref-type="bibr" rid="bib72">Paxinos and Watson, 2007</xref> (<xref ref-type="fig" rid="fig1">Figure 1</xref>, step 1.). The atlas provides region annotations, that is each voxel is labeled by the somatosensory subregion it belongs to. It also provided a spatial context for the model, with the non-modeled barrel region being surrounded on three sides by modeled regions (specifically: S1DZ and S1ULp). The atlas was enhanced with spatial data on cortical depth and local orientation towards the cortical surface (<xref ref-type="bibr" rid="bib9">Bolaños-Puchet et al., 2024</xref>; <xref ref-type="bibr" rid="bib8">Bolaños-Puchet et al., 2023</xref>). We further added annotations for cortical layers, placing layer boundaries at fixed normalized depths (<xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>). Using laminar profiles of cell densities (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>; <xref ref-type="bibr" rid="bib55">Keller et al., 2019</xref>), we generated additional voxelized datasets with cell densities for each morphological type (see Materials and methods).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>References to publications of input data and methods employed for individual modeling steps.</title><p>An asterisk next to a reference indicates that substantial adaptations or refinements of the data or methods have been performed that will be explained in this manuscript. In the other cases, a basic summary will be provided and an exhaustive description in the Methods.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom" colspan="3">Data</th></tr></thead><tbody><tr><td align="left" valign="bottom"><bold>Stage</bold></td><td align="left" valign="bottom"><bold>Topic</bold></td><td align="left" valign="bottom"><bold>Reference</bold></td></tr><tr><td align="left" valign="bottom">Atlasing</td><td align="left" valign="bottom">Region annotation atlas</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib72">Paxinos and Watson, 2007</xref></td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Orientation, depth and flat map</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib8">Bolaños-Puchet et al., 2023</xref></td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Cell density profiles</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib55">Keller et al., 2019</xref></td></tr><tr><td align="left" valign="bottom">Volume filling</td><td align="left" valign="bottom">Neuron reconstructions</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref></td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">in vivo neuron reconstructions</td><td align="left" valign="bottom">*New, original data</td></tr><tr><td align="left" valign="top">Synaptic connectivity</td><td align="left" valign="top">Bouton densities and numbers of synapses per connection</td><td align="left" valign="top"><xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref></td></tr><tr><td align="left" valign="top"/><td align="left" valign="top">Pathway strengths,<break/>synapse density profiles and<break/>topographical mapping</td><td align="left" valign="top"><xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref></td></tr><tr><td align="left" valign="top">Thalamic inputs</td><td align="left" valign="top">Bouton density profiles</td><td align="left" valign="top"><xref ref-type="bibr" rid="bib61">Meyer et al., 2010</xref></td></tr><tr><td align="left" valign="top"/><td align="left" valign="top">Projection axon lengths and widths</td><td align="left" valign="top"><xref ref-type="bibr" rid="bib25">Economo et al., 2016</xref></td></tr><tr><td align="left" valign="bottom" colspan="3"><bold>Modeling methods</bold></td></tr><tr><td align="left" valign="bottom"><bold>Stage</bold></td><td align="left" valign="bottom"><bold>Topic</bold></td><td align="left" valign="bottom"><bold>Reference</bold></td></tr><tr><td align="left" valign="bottom">Atlasing</td><td align="left" valign="bottom">Cell density volume generation</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib55">Keller et al., 2019</xref></td></tr><tr><td align="left" valign="bottom">Volume filling</td><td align="left" valign="bottom">Neuron classification</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib52">Kanari et al., 2019</xref></td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Neuron placement</td><td align="left" valign="bottom">*<xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref></td></tr><tr><td align="left" valign="bottom">Synaptic connectivity</td><td align="left" valign="bottom">Local connectivity</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref></td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Inter-region connectivity</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref></td></tr><tr><td align="left" valign="bottom">Thalamic inputs</td><td align="left" valign="bottom">Input generation</td><td align="left" valign="bottom">*<xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref></td></tr></tbody></table></table-wrap><p>Next, we filled the modeled volume of the atlas with neurons (<xref ref-type="fig" rid="fig1">Figure 1</xref>, step 2.). Neuronal morphologies were reconstructed in slices, and repaired algorithmically (<xref ref-type="bibr" rid="bib2">Anwar et al., 2009</xref>; <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>). Out of 1017 morphologies, 58 were new in vivo stained reconstructions used for the first time in this work (see Materials and methods). The morphologies were classified into 60 morphological types (<italic>m-types</italic>, see ; 18 excitatory <xref ref-type="fig" rid="fig2">Figure 2A</xref>, 42 inhibitory), based on expert knowledge and objectively confirmed by topological classification (<xref ref-type="bibr" rid="bib52">Kanari et al., 2019</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Anatomy of the model.</title><p>(<bold>A</bold>) Exemplar 3D reconstructions of the 18 excitatory m-types. Rendering and visualization was done in NeuroMorphoVis (<xref ref-type="bibr" rid="bib1">Abdellah et al., 2018</xref>). Dendritic diameters are scaled (x3) for better resolution. (<bold>B</bold>) Modeled cortical layers, with exemplars of excitatory morphological types placed in the model. (<bold>C</bold>) The placement of each morphological type recreates the biological laminar anatomy of dendrites and axons, which then serves as the basis of local connectivity. Inset shows modeled brain regions (solid colors) in the context of the non-modeled regions (transparent).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Topological comparison as in <xref ref-type="bibr" rid="bib51">Kanari et al., 2018</xref>; <xref ref-type="bibr" rid="bib52">Kanari et al., 2019</xref> of in vivo stained and in-vitro (i.e. from slices) axonal (<bold>A</bold>) and dendritic (<bold>B</bold>) reconstructions of rat somatosensory cortex of pyramidal cells from layers 2–6.</title><p>Top row presents the topological profiles of in vivo stained reconstructions, second row presents the topological profiles of in slices stained reconstructions and bottom row the difference between them (red: in vivo stained, blue: in slices stained). Number of cells per layer are reported in individual pannels.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Comparison of representative reconstructructed morphologies that have been stained in slice (top) or in vivo (bottom).</title><p>One pyramidal cell morphology per layer is depicted.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Classification and morphometrics of excitatory morphologies.</title><p>(<bold>A</bold>) Same as <xref ref-type="fig" rid="fig2">Figure 2A</xref>. (<bold>B</bold>) Morphometrics of all morphologies belonging to the 18 excitatory m-types.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Scoring the placement of a neuron morphology for a voxel.</title><p>(<bold>A</bold>) Neurite features, here the apical tuft, were manually given a vertical <italic>annotation interval</italic> (grey) and assigned a <italic>target interval</italic>, expressed as a layer interval (red). (Note: parts of the apical dendrite visually shortened.) (<bold>B</bold>) Then the placement of a neuron morphology in a given voxel (blue) is scored as follows: Normalized depth values of the <italic>target interval</italic> are calculated (red); the normalized depth of the voxel is looked up in an atlas (blue); it is used to calculate the normalized depth of the <italic>annotation interval</italic> when the morphology is placed in the voxel (grey); a score is calculated as in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref> based on the overlap of the intervals.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig2-figsupp4-v1.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Exemplary neurons in the model, one per m-type, rendered in the context of a slice spanning all cortical layers (grey borders).</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig2-figsupp5-v1.tif"/></fig></fig-group><p>As only 58 morphologies were in vivo stained reconstructions, the rest potentially suffered from slicing artifacts (see <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> for examples), despite applying a repair algorithm (<xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>). A topological comparison (<xref ref-type="bibr" rid="bib51">Kanari et al., 2018</xref>; <xref ref-type="bibr" rid="bib52">Kanari et al., 2019</xref>) between axons and dendrites of neurons in all layers (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref> and <xref ref-type="fig" rid="fig2s3">3</xref>) revealed that in vitro reconstructions from slices could not capture detailed axonal properties beyond 1000 µm, but could faithfully reproduce dendritic arborization.</p><p>Cell bodies for all m-types were placed in atlas space according to their prescribed cell densities. At each soma location, a reconstruction of the corresponding m-type was chosen based on the size and shape of its dendritic and axonal trees (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). Additionally, it was rotated according to the orientation towards the cortical surface at that point. These steps ensured that manually identified features of the morphologies (see <xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>) landed in the correct layers (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, <xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>). Additionally, a random rotation around an axis orthogonal to layer boundaries was applied.</p></sec><sec id="s2-2"><title>Biological dendrite volume fractions emerge in the model</title><p>The distribution over 60 m-types in the model captured the great morphological diversity of cortical neurons and matched the reference data used (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, see Materials and methods). The placement of morphological reconstructions matched expectation, showing an appropriately layered structure with only small parts of neurites leaving the modeled volume (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). For a more quantitative validation, we calculated the fraction of the volume occupied by neurites in 100 depth bins of a cylindrical volume spanning all layers and with a radius of 100 µm (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). This included an estimated volume for axons forming the mid-range connectivity between modeled regions, based on its synapse count (see below and Materials and methods).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Volumetric anatomy of the model.</title><p>(<bold>A</bold>) M-type composition per layer: For each layer, stacked histograms of the relative fractions of each m-type, comparing the model (right bar for each layer) to the input data (left bar). For simplicity, the layer designation is stripped from each m-type. Left: For excitatory types; right: Inhibitory types. (<bold>B</bold>) Stacked histograms of the fraction of space filled by neurites at various depths in the model. The y-axis indicates the distance in µm from the bottom of layer 6. (<bold>B1</bold>) For neurites of neurons in different layers indicated in different colors. Grey: estimated lower bound for the volume of axons supporting the mid-range connectivity. (<bold>B2</bold>) For neurites of different m-types. Colors as in A, but inhibitory types are grouped together. (<bold>B3</bold>) For different types of neurites. (<bold>C</bold>) Comparing fractions for axons and dendrites to the literature (<xref ref-type="bibr" rid="bib89">Santuy et al., 2018</xref>). X-marks indicate overall means, other marks means in individual layers; teal: reference, black: model.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig3-v1.tif"/></fig><p>We found a clearly layered structure also for the neurite volumes, with apical dendrites contributing substantially to the volume in layers above their somas. The volume was clearly dominated by dendrites, filling between 23% and 47% of the space, compared to 2% to 11% for axons (<xref ref-type="fig" rid="fig3">Figure 3B3</xref>). The range of values for dendrites matched literature closely (between 26% and 46%, <xref ref-type="bibr" rid="bib89">Santuy et al., 2018</xref>). Conversely, values for axons were lower than literature (between 17% and 24%); however, this is explained by the vast amount of external input axons from non-somatosensory and extracortical sources that are not part of the model.</p></sec><sec id="s2-3"><title>Local, mid-range and extrinsic connectivity modeled separately</title><p>Synaptic connectivity in comparable models is often modeled by imposing experimentally characterized connection probabilities, potentially distance-dependent, onto the various neuronal pathways (<xref ref-type="bibr" rid="bib77">Potjans and Diesmann, 2014</xref>; <xref ref-type="bibr" rid="bib80">Pronold et al., 2024</xref>). As this approach directly parameterizes structural connections strengths at the population level it allows easy recreation of meso-scale architectures, as characterized in, e.g., <xref ref-type="bibr" rid="bib48">Jiang et al., 2015</xref>. On the other hand, it has been shown that top-down imposed connection probabilities, even distance-dependent ones, cannot fully capture the non-random higher order structure of connectivity at cellular resolution (<xref ref-type="bibr" rid="bib34">Gal et al., 2021</xref>). Such non-random connectivity has been repeatedly demonstrated in cortical circuitry (<xref ref-type="bibr" rid="bib98">Song et al., 2005</xref>; <xref ref-type="bibr" rid="bib73">Perin et al., 2011</xref>; <xref ref-type="bibr" rid="bib87">Reimann et al., 2024</xref>; <xref ref-type="bibr" rid="bib26">Egas Santander et al., 2024a</xref>) and has functional impact (<xref ref-type="bibr" rid="bib85">Reimann et al., 2017b</xref>; <xref ref-type="bibr" rid="bib26">Egas Santander et al., 2024a</xref>; <xref ref-type="bibr" rid="bib69">Nolte et al., 2020</xref>). Instead, we used a previously published approach (<xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>) that selects synapses as a subset of axo-dendritic, axo-somatic and axo-axonic appositions, based on biologically motivated rules (<xref ref-type="fig" rid="fig1">Figure 1</xref>, step 3; 4 A). Note that this algorithm is not equivalent to the so-called ‘Peters’ rule’ (<xref ref-type="bibr" rid="bib74">Peters and Feldman, 1976</xref>; <xref ref-type="bibr" rid="bib35">Garey, 1999</xref>; <xref ref-type="bibr" rid="bib82">Rees et al., 2017</xref>), as the subset is not selected completely randomly. Crucially, the concept of cooperative synapse formation (<xref ref-type="bibr" rid="bib29">Fares and Stepanyants, 2009</xref>) is used, which introduces statistical dependence for potential synapses between the same pair of neurons: If one is selected the probability that others are selected increases. The algorithm has been demonstrated to result in a nonrandom higher-order structure of connectivity matching biological references (<xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>; <xref ref-type="bibr" rid="bib32">Gal et al., 2017</xref>; <xref ref-type="bibr" rid="bib84">Reimann et al., 2017a</xref>; <xref ref-type="bibr" rid="bib85">Reimann et al., 2017b</xref>). Conversely, connection probabilities are not directly controlled by the modeler. We measured the emerging connection probabilities by emulating a multi-patch procedure that is often used for that purpose in vitro (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A</xref>, see Materials and methods). We compared them to connection probabilities reported in 124 literature sources gathered by <xref ref-type="bibr" rid="bib116">Zhang et al., 2019</xref> (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2B–D</xref>). We note that reported connection probabilities vary drastically, for example, ranging from zero to 88% for L2/3 EXC to L2/3 PV. Significant variability persisted when only data sources for rat or the age of the model (P14) were considered, with ranges of values stretching up to 51% and 54%, respectively. While values for the model were sometimes outside the reported range, this was mostly restricted to pathways with only one or two sources.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Intrinsic connectivity as union of local and mid-range connectivity.</title><p>(<bold>A</bold>) Local connectivity was derived as in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>; <xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>, that is based on neuron placement and morphologies. Right: Axo-dendritic appositions were considered as potential synapses. They were then filtered to yield among other biological constraints biologically realistic bouton densities. (<bold>B</bold>) Range of resulting connection probabilities within.100 µm Indicated are the minimum (inner circle) and maximum (outer circle) found over 20 repetitions of sampling 1000 pairs in a simulated multi-patch procedure (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A</xref>). See Materials and methods for mapping from morphological types to inhibitory subclasses (PV/SST/INH). (<bold>C</bold>) An exemplary layer 5 PC axon reconstruction from Janelia MouseLight (<ext-link ext-link-type="uri" xlink:href="https://mouselight.janelia.org/">mouselight.janelia.org</ext-link>, <xref ref-type="bibr" rid="bib36">Gerfen et al., 2018</xref>) that includes mid-range collaterals, shown in the context of mouse somatosensory regions. The blue circle highlights local branches all around the soma. Red highlights depict more targeted collaterals into neighboring regions. (<bold>D1</bold>) Predicted pathway strengths as indicated in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>. (<bold>D</bold>2) Pathway strength emerging from the application of the apposition-based connectivity algorithm described in <xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>. (<bold>E</bold>) Values of the diagonal of (<bold>D1</bold>) compared to the diagonal of (<bold>D2</bold>). (<bold>F</bold>) Schematic of the strategy for connectivity derivation: Within a region only apposition-based connectivity is used; across regions the union of apposition-based and mid-range connectivity. (<bold>G</bold>) Connection strength constraints for the mid-range connectivity derived by subtracting D2 from D1 and setting elements <inline-formula><alternatives><mml:math id="inf1"><mml:mstyle><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math><tex-math id="inft1">\begin{document}$  \lt 0$\end{document}</tex-math></alternatives></inline-formula> to 0 (colors as in D). (<bold>H</bold>) Resulting total density from both types of modeled synaptic connections in individual regions compared to the data in (<bold>D1</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Data sources for connectivity modeling.</title><p>(<bold>A</bold>) Mapping from mouse to equivalent rat subregions. Left: flat view of mouse somatosensory subregions, Right: equivalent flat view for rat. Corresponding subregions are indicated with matching colors. Triangles are drawn on top of each subregion (shown for SSp-ul and S1FL) using manually annotated points that are assumed to correspond to each other. Inset: These triangles define affine transformations between mouse and rat subregions. (<bold>B</bold>) Transformed rat subregions (colored outlines) are shown overlaid to their corresponding mouse subregions (colored areas). The topographical mapping of connections between subregions predicted in <xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref> (black arrows) can thus be generalized to rat connectivity. (<bold>C</bold>) Mean connection densities between rat somatosensory subregions were derived from the Allen Mouse Brain Connectivity Atlas by summing over corresponding mouse somatosensory subregions. Labels on the left side of the connection density matrix describe the mapping applied from mouse to rat subregions. (<bold>D</bold>) The topographical mapping of long-range connectivity was parameterized as in <xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref>: For each pair of subregions, for example SS1FL and S1HL, affine transformations <inline-formula><alternatives><mml:math id="inf2"><mml:mstyle><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>F</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft2">\begin{document}$  T_{S1FL}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf3"><mml:mstyle><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft3">\begin{document}$  T_{S1HL}$\end{document}</tex-math></alternatives></inline-formula> were defined that transformed the top-down views of the regions into a common coordinate system. Connectivity was then distance-dependent in the common coordinate system. Transformations that were optimized for mouse data in <xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref> were adapted through the process in A and B for use in rat. This described connectivity where parts of one subregion were predominately connecting to specific parts of another subregion. The plot indicates parts that are preferentially connecting to each other in the same color. Sharp transitions at subregion boundaries are the result of modeling connectivity separately for each pair of subregions in this iteration of the model. (<bold>E</bold>) For the vertical dimension, predicted layer profiles of connections between subregions of <xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref> are generalized to rat. One example is illustrated. E1, left: Exemplary slice through the SSp-ll region of the Allen Mouse Brain Atlas. Right: Layer profile of synapses for a feedforward connection targeting layer 4. (<bold>E2</bold>) Generalized version we used for rat. Right: Slice through the S1HL region of the atlas. Left: Generalized layer profile, still targeting layer 4.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig4-figsupp1-v1.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Comparing local connection probabilities to the literature.</title><p>(<bold>A</bold>) Local connection probabilities were measured by emulating a multi-patch clamp sampling procedure (see Materials and methods). Resulting relative locations of 1000 sampled pairs of excitatory neurons in layer 5 (L5EXC) are indicated. Black triangle location of the potential presynaptic partner. Grey: Locations of unconnected neurons. Orange: Of connected neurons. Top: In the x-y plane that is roughly parallel to layer boundaries. Bottom: In the x-z plane; the z-axis is roughly orthogonal to layer boundaries. (<bold>B</bold>) Violinplots of distributions of connection probabilities reported in 124 literature sources, gathered by <xref ref-type="bibr" rid="bib116">Zhang et al., 2019</xref>. Colors of the violins indicate means of the distributions. Numerals indicate the number of literature sources used. Arrowheads indicate the mean values measured in the model. They are black, if the value falls inside the distribution of literature values; purple if they are outside, but within 25% of the variability; red if they outside that. Where only a single literature source was available, 10% variability was assumed. Literature sources for mouse and rat were used. (<bold>C</bold>) As B, but only literature sources where the reported animal age range contained P14, the target age of the model. (<bold>D</bold>) As B, but only literature sources for rat were used.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig4-figsupp2-v1.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Validation of modeled connectivity.</title><p>(<bold>A, B</bold>) Touch connectivity is validated by comparing emerging bouton densities (<bold>A</bold>) and mean numbers of synapses per connection (<bold>B</bold>) to the target values from the data. Each data point depicts a single morphological type (<bold>A</bold>) or type-specific pathway (<bold>B</bold>). Black arrows: Bouton density for Chandelier Cells (ChC) in layers 2, 3 and 4. (<bold>C</bold>) Mean densities of synapses from the union of touch connectivity and mid-range connectivity in pathways within and between regions (<bold>C2</bold>) compared to that target values from the data (<bold>C1</bold>). (<bold>D</bold>) Structure of the topographical mapping of connections; each part of the model predominately connects to neurons at equally colored locations. (<bold>D1</bold>) Target mapping from the data. (<bold>D2</bold>) Analyzed in the union of touch connectivity and mid-range connectivity. (<bold>E</bold>) Layer profiles of synapses placed in mid-range connections between regions (blue bars) compared to the predicted target profiles from <xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref>, pink lines. Depicted is the density of synapses in a depth bin relative to the overall mean density over the entire depth.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig4-figsupp3-v1.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 4.</label><caption><title>Modeling thalamo-cortical synaptic inputs.</title><p>(<bold>A</bold>) Input vertical profiles of thalamo-cortical synapses from core-type projections (<bold>A1</bold>) and matrix-type projections (<bold>A3</bold>). A2: Exemplary model neuron with projection synapses placed on dendrites according to the prescribed densities. (<bold>B</bold>) Modeling of afferent thalamic fiber locations: Depicted is an exemplary slice of the model. Shaded vertical areas indicate the upper edges of layers, with colors consistent with the rest of the manuscript (L1: yellow, L2: orange, L3: red, L4: pink, L5: blue, L6: green). For each fiber a location at the border between layers 4 and 5 is randomly chosen (10 examples shown; white spheres). A point 1500 µm towards the bottom of layer 6 is chosen as the starting point of each fiber (black dots). A domain of influence is then assigned around a line starting at that location with the indicated direction (black arrows and red areas). Influence weakens with distance from the line with a Gaussian profile; for details, see D, E. (<bold>C</bold>) Locations of fibers in the flat view. 10% of the full density shown. Inset: Locations of approximately <inline-formula><alternatives><mml:math id="inf4"><mml:mstyle><mml:mn>1</mml:mn><mml:mi>m</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math><tex-math id="inft4">\begin{document}$  1mm^{2}$\end{document}</tex-math></alternatives></inline-formula> shown in full density. The green circle indicates a single standard deviation of the Gaussian of influence strength used for the core style projections (i.e., 120 µm). (<bold>D</bold>) For an exemplary synapse its distances to surrounding fibers is measured and the value of the Gaussian for those distances calculated. It is cut off at two standard deviations. (<bold>E</bold>) The probability that a given fiber is chosen as innervator of a synaptic location (blue bar) is proportional to its value in D (shown only for fibers with nonzero probability).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig4-figsupp4-v1.tif"/></fig></fig-group><p>To create biologically realistic overall neuron out-degrees, our algorithm requires axon reconstructions to be complete. While we try to ensure the completeness of axonal arborizations through the use of in vivo stained reconstructions and repair algorithms, this becomes more challenging, the more an axon stretches away from its soma, due to lack of dye penetration and potentially slicing artifacts. According to our analysis of the morphologies used, most axons were only accurately reconstructed up to 1000 µm from the soma (see above). This contrast between local axon around the soma and more mid-range collaterals stretching into neighboring regions can also be seen in in vivo stained reconstructions (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Therefore, to model connections at larger distances, we used a second, previously published algorithm (<xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref>). It places mid-range synapses according to three biological principles that all need to be separately parameterized based on experimental data (as detailed in the subsequent paragraphs and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>): First, connection strength: ensuring that the total number of synapses in a region-to-region pathway matches biological estimates. Second, layer profiles: ensuring that the relative number of synapses in different layers matches biological estimates. Third, topographical mapping: Ensuring that the specific locations within a region targeted by mid-range connections of neurons describe a biologically parameterized, topographical mapping. We note that in the literature on macro-scale connectomics, the pathways between somatosensory regions would be considered ‘short-range, inter-regional connections’. We will still refer to connections from the two algorithms as the <italic>local</italic> and <italic>mid-range</italic> connectomes respectively, for simplicity and because of the intuitive contrast it invokes.</p><p>To parameterize connection strengths, we used data from axon tracing experiments provided by the Allen Institute (<xref ref-type="bibr" rid="bib45">Harris et al., 2019</xref>), adapted from mouse to rat, yielding expected densities of projection synapses between pairs of regions (<xref ref-type="fig" rid="fig4">Figure 4D1</xref>). First, we asked to what degree the local connectome algorithm suffices to model the connectivity within a region. To that end, we compared the mean excitatory synapse densities of local connectivity to the target values adapted from <xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref>, diagonal <xref ref-type="fig" rid="fig4">Figure 4D1</xref> vs. <xref ref-type="fig" rid="fig4">Figure 4D2</xref>; <xref ref-type="fig" rid="fig4">Figure 4E</xref>. These target values were derived from relative region-to-region connectivity strengths, estimated by axon tracing, scaled to match overall volumetric synapse densities estimated from electron microscopy. We found that the overall average matches the data fairly well, however the variability across regions was lower in the model (<inline-formula><alternatives><mml:math id="inf5"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0.123</mml:mn><mml:mo>±</mml:mo><mml:mn>0.017</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft5">\begin{document}$  0.123\pm 0.017$\end{document}</tex-math></alternatives></inline-formula><inline-formula><alternatives><mml:math id="inf6"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft6">\begin{document}$  \mu m^{-3}$\end{document}</tex-math></alternatives></inline-formula>; mean ± std in the model vs. <inline-formula><alternatives><mml:math id="inf7"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0.097</mml:mn><mml:mo>±</mml:mo><mml:mn>0.06</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft7">\begin{document}$  0.097\pm 0.06$\end{document}</tex-math></alternatives></inline-formula><inline-formula><alternatives><mml:math id="inf8"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>μ</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft8">\begin{document}$  \mu m^{-3}$\end{document}</tex-math></alternatives></inline-formula>). Based on these results, we decided that the local connectome sufficed to model connectivity within a region. It also created a number of connections across region borders (<xref ref-type="fig" rid="fig4">Figure 4D2</xref>). Consequently, we parameterized the strengths of additional mid-range connections to be placed as the difference between the total strength from the data and the strengths resulting from local connectivity, with connection strengths within a region set to zero (<xref ref-type="fig" rid="fig4">Figure 4G</xref>). As a result synaptic connections between neighboring regions will be placed by both algorithms (<xref ref-type="fig" rid="fig4">Figure 4F</xref>), with a split ranging from 20% local to 70% local. The lower spread of apposition-based synapse density within a region (see above) will also reduce the variability of combined synapse density from both algorithms (<xref ref-type="fig" rid="fig4">Figure 4H</xref>). While this will halve the coefficient of variation of density across regions from 0.34 to 0.17, the overall mean density over all regions is largely preserved (0.23 data vs. 0.24 for the combined algorithms; <xref ref-type="fig" rid="fig4">Figure 4H</xref>, red dot).</p><p>Finally, the dendritic locations of synaptic inputs from thalamic sources were modeled as in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>, using experimental data on layer profiles of bouton densities of thalamo-cortical axons, and morphological reconstructions of these types of axons (<xref ref-type="fig" rid="fig1">Figure 1</xref>, step 4; <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4A</xref>; Materials and methods). Based on these data, each thalamic input fiber was assigned an innervated domain in the model, recreating the layer profile along an axis orthogonal to layer boundaries and spreading equally in the other dimensions (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4B–E</xref>). We modeled two types of thalamic inputs, based on the inputs into barrel cortex from the ventral posteromedial nucleus (VPM-based) and from the posterior medial nucleus (POm-based), respectively (<xref ref-type="bibr" rid="bib45">Harris et al., 2019</xref>; <xref ref-type="bibr" rid="bib95">Shepherd and Yamawaki, 2021</xref>). While barrel cortex was not a part of the model, we used these projections as examples of a <italic>core</italic>-type projection, providing feed-forward sensory input (VPM-based) and a <italic>matrix</italic>-type projection, providing higher-order information (POm-based).</p><p>The numbers of thalamic input fibers innervating the model were estimated as follows. Laminar synapse density profiles were summed over the volume to estimate the total number of thalamo-cortical synapses, and the number of synapses per neuron was estimated from the lengths of thalamo-cortical axons. The ratio of these numbers resulted in 72,950 fibers for the POm-based matrix-type projection, and 100,000 fibers for the VPM-based core-type projection. These numbers are consistent with the volume ratio of the two thalamic nuclei (<inline-formula><alternatives><mml:math id="inf9"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1.25</mml:mn><mml:mi>m</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft9">\begin{document}$  1.25mm^{3}$\end{document}</tex-math></alternatives></inline-formula> for POm to <inline-formula><alternatives><mml:math id="inf10"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1.64</mml:mn><mml:mi>m</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft10">\begin{document}$  1.64mm^{3}$\end{document}</tex-math></alternatives></inline-formula> for VPM; ratio: 0.76).</p></sec><sec id="s2-4"><title>Specificity of axonal targeting</title><p>For the axons of various inhibitory neuron types, certain aspects of connection specificity have been characterized (<xref ref-type="bibr" rid="bib105">Tremblay et al., 2016</xref>), such as a preference for peri-somatic innervation for PV+ basket cells. The local connectivity in the model is based axo-dendritic overlap, combined with a pruning rule that prefers multi-synaptic connections, but does not take the post-synaptic compartment type into account (<xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>). As such, it captures targeting preferences resulting from specific axonal morphologies, but not potential effects due to potential molecular mechanisms during synapse formation or pruning. This is based on the idea that the developmental mechanisms underlying connectivity are manifold and complicated, but their cumulative effect is at least partially visible in the characteristic shapes of the neurites. It has been demonstrated by us and other groups that anatomy-based approaches suffice to create highly nonrandom network topologies that match many biological trends (<xref ref-type="bibr" rid="bib32">Gal et al., 2017</xref>; <xref ref-type="bibr" rid="bib84">Reimann et al., 2017a</xref>; <xref ref-type="bibr" rid="bib106">Udvary et al., 2022</xref>), but the analyses have so far been focused mainly on excitatory sub-networks. To investigate to what degree the approach suffices to explain observed targeting trends, we compared the model to characterizations of targeting specificity from the literature, recreating the electron microscopy studies of <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref> and <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref> in silico.</p><p><xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref> analyzed an approximately 500,000 µm<sup>3</sup> volume of tissue in layer 4, considering the postsynaptic targets of the contained axons. As axons in the volume were fragments, specificity was assessed by comparing the data to a binomial control fit against observations of axons forming at least one synapse onto a postsynaptic compartment type (see Materials and methods). Axons with unexpectedly high fractions onto a compartment type were then considered to target that type. We calculated targeting fractions of axons forming at least 10 synapses in a comparable layer 4 volume of our model (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Compared to <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref>, fractions of synapses onto apical dendrites were elevated, and more inhibitory synapses were considered (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). As in the original study, for almost all compartment types, observed distributions were more long tailed than expected with a number of axons showing a significantly high targeting fraction (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). The fractions of axons with such specificities also matched the reference, except for an even higher fraction being specific for apical dendrites in the model (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). The match resulted from local connectivity in our model using the principle of <italic>cooperative synapse formation</italic> (<xref ref-type="bibr" rid="bib29">Fares and Stepanyants, 2009</xref>), where all synapses forming a connection are kept or pruned together. This creates a statistical dependence between the synapses that results in a significant deviation from the binomial control models. We demonstrate this with a simple stochastic model of cooperative synapse formation, fitted to the data of <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref>. For each axon in the data, we generated a random list of compartments types for potential synapses matching the overall frequencies observed in the data. For each, the number generated was 2.5 times the number of synapses of the corresponding axon. Next, we pruned synapses to the original counts in two ways: First, we grouped potential synapses onto the same type into groups of three that are kept or discarded together, thereby introducing statistical dependence. The results provide the same amount of apparent targeting as the data (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A-C</xref>). Second, we pruned without the grouping where no targeting was found (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1D-F</xref>). We do not claim that the stochastic model and its parameters provide an accurate description of the underlying biological processes, only that it demonstrates the effect of cooperative synapse formation. We conclude that the non-random trends observed by <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref> are an indication of cooperative synapse formation captured by our model.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Recreating an electron-microscopic specificity analysis In the top part we analyzed synapses, axons and dendrites in an approximately cubic volume in L4, emulating the techniques of <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref>.</title><p>In the bottom part we analyzed a 100 x 100 µm volume of the MICrONS dataset defined by <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref>. (<bold>A</bold>) Fraction of synapses placed on somata (SOM), proximal dendrites (PD), smooth dendrites (SD), apical dendrites (AD) and axon initial segments (AIS) for axon fragments in the sampled volume. Black bars indicate mean values over axons, arrows indicate binomial probabilities fit to observations of axons forming at least a single synapse; pink: for excitatory axons, black: inhibitory. Fractions missing from 100% are onto other compartment types. (<bold>B</bold>) Overall count on synapses on different postsynaptic compartment classes inside the studies volumes, comparing the data of <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref> to the model. Colors as indicated in the legend. (<bold>C</bold>) Distributions of the fractions of synapses onto different compartment types over excitatory (left) and inhibitory (right) axons. Expected from the binomial model in A (grey) against the observations in our anatomical model (black outlines). (<bold>D</bold>) Fraction of axons with significantly increased synapse counts onto different compartment types compared to the binomial control. Indicated for two values of the false detection rate criterion (q=0.05, 0.3, <xref ref-type="bibr" rid="bib100">Storey and Tibshirani, 2003</xref>). Comparing the reference data to our anatomical model. (<bold>E</bold>) Top numbers of neurons in four connectivity-derived classes in the 100x100 µm volume of the MICrONS dataset, defined by <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref>. Bottom: Numbers in a comparable volume of the model. For assignment of m-types into the four classes see the main text. (<bold>F</bold>) Derivation of alternative connectivity with targeting specificity, using the example of the ‘PeriTC’ class. The axo-dendritic appositions of an axon (top) are classified as matching the targeting (green box; here: appositions with somata or proximal dendrites) or not. Non-matching appositions are removed with probability <inline-formula><alternatives><mml:math id="inf11"><mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft11">\begin{document}$  p_{nt}$\end{document}</tex-math></alternatives></inline-formula> (middle). This is followed by a non-specific removal of connections (formed by single or multiple synapses) until the biological density of synapses on the axon is met (bottom). (<bold>G</bold>) Bouton densities resulting from the process in F. Left to right: For PeriTC neurons, targeting somata and proximal dendrites; for InhTC neurons, targeting inhibitory neurons; for SparTC neurons, targeting the first synapse of a connections; for SparTC neurons, without targeting preference. Respective optimized <inline-formula><alternatives><mml:math id="inf12"><mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft12">\begin{document}$  p_{nt}$\end{document}</tex-math></alternatives></inline-formula> values reported in the main text. (<bold>H</bold>) Resulting targeting of postsynaptic compartments, fraction of synapses in multisynaptic connections and clumped synapses (see <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref>). Red: Default model; blue: optimized alternative model with specific targeting; grey: optimized alternative model without specific targeting; orange: data of <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref> Boxes outline the characteristic feature of each class. (<bold>I</bold>) Inhibitory targeting specificities combining the best performing models.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Stochastic control of targeting.</title><p>Distributions of targeted subcellular compartments are matched to the data reported in <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref>. Subsets are then selected with (top) or without (bottom) cooperativity (for details: see Materials and methods). The results are then analyzed as in the main text.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig5-figsupp1-v1.tif"/></fig></fig-group><p>Recently, the MICrONS dataset (<xref ref-type="bibr" rid="bib4">Bae et al., 2021</xref>) has been analyzed with respect to the axonal targeting of inhibitory subtypes in a subvolume of 100 x 100 µm<sup>2</sup> surface area spanning all layers of the cortex (<xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref>). Similar to <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref> they considered their distributions of types of postsynaptic compartments. But due to the larger reconstructed volume, they were able to analyze complete or almost complete axons, allowing for a quantitative comparison rather than relying on a fitted binomial control model. Additionally, they calculated the fraction of synapses that are part of a multisynaptic connections and the fraction thereof that is within 15 µm of another synapse of the same connection.</p><p>A comparable volume of the model (see Materials and methods) contained 173 interneurons vs. 163 in the original study. Their distribution into four connectivity classes according to morphological and molecular determinants hypothesized by <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref> approximately matched as well (<xref ref-type="fig" rid="fig5">Figure 5E</xref>; perisomatic targeting: Basket Cells; distal targeting: Sst+; sparsely targeting: Neurogliaform Cells and L1; inhibitory targeting: bipolar and VIP+). The postsynaptically targeted compartments matched for the distal targeting group (<xref ref-type="fig" rid="fig5">Figure 5H</xref>, top right; <xref ref-type="fig" rid="fig5">Figure 5I</xref>), indicating that their preference can be explained by their axonal morphology, specifically its trend to ascend to and then branch in superficial layers. For the other three classes, their respective eponymous trends were not recreated (<xref ref-type="fig" rid="fig5">Figure 5H</xref>, red vs. orange).</p><p>We then explored the strengths of targeting mechanisms required to explain postsynaptic targets in a modified version of our connectivity algorithm: Beginning with all axo-dendritic appositions as potential synapses, we first remove appositions that are not placed on the preferred postsynaptic compartment with a probability <inline-formula><alternatives><mml:math id="inf13"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft13">\begin{document}$  p_{nt}$\end{document}</tex-math></alternatives></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5F</xref>; top to middle). This replaces a non-specific, but otherwise identical first pruning steps in the regular version of our algorithm. This is followed by removing connections non-specifically, until the biological density of synapses on the axon is matched (<xref ref-type="fig" rid="fig5">Figure 5F</xref>; middle to bottom). As reference for biological densities of synapses on axons, we use the sources listed in <xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>.</p><p>For the perisomatic targeting class, probability <inline-formula><alternatives><mml:math id="inf14"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft14">\begin{document}$  p_{nt}$\end{document}</tex-math></alternatives></inline-formula> to remove non-proximal, non-soma synapses was optimized against the data of <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref> to 97%. The remaining synapses had a density on the axons of perisomatic targeting cells that was three times higher than biology, which could be reduced in the second, non-specific pruning step removing two thirds of the connections (<xref ref-type="fig" rid="fig5">Figure 5G</xref>, left). This indicates substantial room for rewiring through structural plasticity while preserving the targeting specificity of perisomatic targeting cells. The resulting specificity of postsynaptic compartments and multi-synaptic connections then match the reference data (<xref ref-type="fig" rid="fig5">Figure 5H</xref>, top left, blue vs orange; <xref ref-type="fig" rid="fig5">Figure 5I</xref>).</p><p>For the inhibitory targeting class, probability <inline-formula><alternatives><mml:math id="inf15"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft15">\begin{document}$  p_{nt}$\end{document}</tex-math></alternatives></inline-formula> to remove synapses on non-inhibitory neurons was optimized to a similar value of 96.5%. Curiously, this first step already reduced the resulting axonal density of synapses to the biological value, indicating that this class of interneurons cannot perform substantial rewiring without losing its targeting specificity (<xref ref-type="fig" rid="fig5">Figure 5G</xref>, second from left).</p><p>For sparsely targeting cells, we evaluated two hypotheses: First, we note that this targeting class is associated with Neurogliaform Cells, which are known to have volumetrically transmitting synapses. It is possible that the sparseness of their targeting can be explained by very few of their synapes having an anatomical postsynaptic partner, rather than by a targeting mechanism. Indeed a non-specific removal of 96% of all synapses recreated the sparsity of these connections found in <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref> (<xref ref-type="fig" rid="fig5">Figure 5H</xref>, bottom left, grey vs orange; <xref ref-type="fig" rid="fig5">Figure 5I</xref>). This reduced the axonal density of synapses to 30% of the biological value, implying that the remaining 70% may be volumetrically transmitting (<xref ref-type="fig" rid="fig5">Figure 5G</xref>, right). Second, we randomly picked a ‘first’ synapse from each connection formed by this class that we considered to be targeted. Of the remaining synapses, we removed  <inline-formula><alternatives><mml:math id="inf16"><mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft16">\begin{document}$  p_{nt}$\end{document}</tex-math></alternatives></inline-formula> = 95%, which recreated the characteristic sparsity of the connections equally well (<xref ref-type="fig" rid="fig5">Figure 5H</xref>, bottom left, blue vs orange; <xref ref-type="fig" rid="fig5">Figure 5I</xref>). In this case, the second, non-specific pruning step was required, indicating substantial room for rewiring (<xref ref-type="fig" rid="fig5">Figure 5G</xref>, second from right).</p><p>Using a recently developed computational tool (‘Connectome-Manipulator’; <xref ref-type="bibr" rid="bib75">Pokorny et al., 2024a</xref>), we created a rewired connectome instance that combines the existing excitatory connectivity with the additional rules for the inhibitory connectivity in a single connectome. This rewired connectome is openly available in SONATA format (<xref ref-type="bibr" rid="bib20">Dai et al., 2020</xref>), see key resources table in the Materials and methods.</p></sec><sec id="s2-5"><title>Structure of thalamic inputs</title><p>Though we have found that the anatomy-based prediction of connectivity underestimates the specificity of some inhibitory connection types, it remains a powerful tool that has been demonstrated to recreate non-random trends of excitatory connections that make up the majority of synapses (<xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>; <xref ref-type="bibr" rid="bib85">Reimann et al., 2017b</xref>; <xref ref-type="bibr" rid="bib32">Gal et al., 2017</xref>). We therefore set out to characterize the anatomy and topology of connections at all scales considered in the model. We began with the thalamic input connections, whose axons were generated based on the axon density profiles and the statistics of their horizontal spread (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). Synapses were established based on their volumetric overlap with cortical dendrites to match the laminar synapse density profiles of the presynaptic thalamic axons (see Materials and methods and <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>). The individual postsynaptic dendritic morphologies, cell placement, and orientation were considered in this process. The process did not prefer the dendrites of one neuron type over another. In contrast, <xref ref-type="bibr" rid="bib17">Cruikshank et al., 2007</xref>; <xref ref-type="bibr" rid="bib18">Cruikshank et al., 2010</xref>; <xref ref-type="bibr" rid="bib94">Sermet et al., 2019</xref> found physiologically stronger thalamo-cortical inputs onto excitatory and PV-positive neurons than onto SST-positive neurons. While the authors of the studies make compelling arguments that this at least partially reflects the anatomical strength of the pathways, others have cautioned against mixing of the anatomy and physiology of connectivity (<xref ref-type="bibr" rid="bib99">Sporns, 2013</xref>). We therefore believe that further validation of the thalamo-cortical pathways is best performed in the accompanying manuscript (<xref ref-type="bibr" rid="bib47">Isbister et al., 2024</xref>), where the experimental methods of the references are closely recreated.</p><p>Regarding the laminar structure, we found for both projections that the peaks of the mean number of thalamic inputs per neuron occur at lower depths than the peaks of the synaptic density profiles (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). This is consistent with synapses on apical dendrites of PCs being higher than their somas, but the fact that most peaks occur at places where the synapse density is close to zero gives a clear indication that synapse density profiles alone can be misleading about the location of innervated neurons. At the level of individual neurons, the number of thalamic inputs varied greatly, even within the same layer (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). Overall, the matrix-type projection innervated neurons in layers 1 and 2 more strongly than the core-type projection, while in layers 3, 4, and 6, the roles were reversed. Neurons in layer 5 were innervated on average equally strongly by both projections, although layer 5a preferred the matrix-type and layer 5b the core-type projection.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Anatomy of thalamic innervation.</title><p>(<bold>A</bold>) Depth profiles of synapse densities (dashed lines) and mean number of thalamic inputs per neuron (solid lines) for core- (red) and matrix-type (blue) thalamo-cortical projections. Shaded area indicates the standard error of mean. For a region-specific validation of synapse densities (dashed lines) against experimental data, see <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>. (<bold>B</bold>) Mean and standard deviation of the number of thalamic inputs for neurons in individual layers or all neurons. Colors as in A. (<bold>C</bold>) Common thalamic innervation (CTI) of an exemplary neuron (black dot) and neurons surrounding it, calculated as the intersection over union of the sets of thalamic fibers innervating each of them. Scale bar: 200 µm. (<bold>D</bold>) CTI of pairs of neurons at various horizontal distances. Dots indicate values for 125 randomly picked pairs; lines indicate a sliding average with a window size of 40 µm. We perform a Gaussian fit to the data, extracting the amplitude at 0 µm (<bold>A</bold>) and the standard deviation (<inline-formula><alternatives><mml:math id="inf17"><mml:mstyle><mml:mi>σ</mml:mi></mml:mstyle></mml:math><tex-math id="inft17">\begin{document}$  \sigma$\end{document}</tex-math></alternatives></inline-formula>). (<bold>E</bold>) Values of A (unitless) and <inline-formula><alternatives><mml:math id="inf18"><mml:mstyle><mml:mi>σ</mml:mi></mml:mstyle></mml:math><tex-math id="inft18">\begin{document}$  \sigma$\end{document}</tex-math></alternatives></inline-formula> (in flatmap coordinates) for pairs in the individual layers or all pairs. Colors as in A.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Input data for the derivation of the locations of thalamic inputs.</title><p>(<bold>A1</bold>) Layer profile of bouton densities of VPM axons in the rat barrel field. Light red: Digitized from <xref ref-type="bibr" rid="bib61">Meyer et al., 2010</xref>. Dark red: Binned into 20 bins per peak with a lower cutoff of <inline-formula><alternatives><mml:math id="inf19"><mml:mstyle><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math><tex-math id="inft19">\begin{document}$  1/mm^{3}$\end{document}</tex-math></alternatives></inline-formula> applied. (<bold>A2</bold>) Same for POm axons. (<bold>B</bold>) Total length of 11 reconstructed axons of Janelia MouseLight neurons with somas in VPM in various somatosensory subregions. Dashed line: Median C: Standard deviation of a Gaussian fit of the reconstruction points of the same axons around their centroid in somatosensory areas. Dashed line: Median.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig6-figsupp1-v1.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Validation of thalamo-cortical density profiles.</title><p>Synapse density profiles of thalamo-cortical synapses from core-type (VPM) projections (<bold>A</bold>) and matrix-type (POm) projections (<bold>B</bold>), compared with the target profiles from <xref ref-type="bibr" rid="bib61">Meyer et al., 2010</xref> (pink lines). Depicted are the mean densities (black lines: ± SD) over voxels within depth bins relative to the respective total cortical thickness in each of the eight sub-regions.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig6-figsupp2-v1.tif"/></fig></fig-group><p>To characterize the horizontal structure, we introduced the common thalamic innervation (CTI, see Materials and methods) as a measure of the overlap in the thalamic inputs of pairs of neurons. As pairs with many common inputs are likely to have similar stimulus preferences, the magnitude and range of this effect has consequences for the emergence of functional assemblies of neurons. As expected from the horizontal extent of individual fibers, the CTI was distance-dependent (<xref ref-type="fig" rid="fig6">Figure 6C,D</xref>), and showed strong variability. Even directly neighboring pairs might not share a single thalamic afferent, leading to a sparse spatial distribution of pairs with strong overlap. A Gaussian fit of the distance dependence of CTI revealed roughly equally strong overlapping innervation for both core- and matrix-type projections (<xref ref-type="fig" rid="fig6">Figure 6E1</xref>). The strength of the overlap increased for lower layers in the case of core-type and decreased for matrix-type projections, while being equally strong in layer 5. The horizontal range of common innervation was larger for matrix-type projections in all layers (<xref ref-type="fig" rid="fig6">Figure 6E2</xref>). In summary, while the anatomy of thalamo-cortical projections introduces a spatial bias into the emergence of cortical maps, it is relatively weak on its own and supports different stimulus preferences even for neighboring pairs of neurons.</p></sec><sec id="s2-6"><title>Local brain geometry affects connectivity</title><p>Cortex is often seen as a homogeneous structure with parallel layers, but at the larger spatial scales considered in this model, significant variability in its height and curvature can be observed. Our approach to connectivity allowed us to predict the impact of local brain geometry on connectivity (see also <xref ref-type="bibr" rid="bib88">Ronan et al., 2011</xref>). We partitioned the model into columnar subvolumes with radii of approximately 230 µm (<xref ref-type="fig" rid="fig7">Figure 7A</xref>) that we then analyzed separately. We do not claim that these columns have a biological meaning on their own, they only serve to discretize the model into individual data points each representing localized circuitry affected by local geometry.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>A1, A2: Parcellation of the modeled volume into 230 µm radius columns.</title><p>Exemplary slice of columns highlighted in green. (<bold>B</bold>) Geometrical metrics of column subvolumes in the flat view. Peripheral columns masked out (grey); green outline: highlighted columns in A. Left: Conicality, defined as the slope of a linear fit of depth against column radius. Negative values indicate narrowing towards L6. Right: Column height, i.e. cortical thickness at the location of the column. (<bold>C1</bold>) Modularity of the networks of connections within each column. (<bold>C2</bold>) Column conicality and height colored by modularity; (<bold>D1</bold>) Conicality of columns against their laminar neuronal composition, normalized against the overall composition of the model. Colored lines indicate linear fits. (<bold>D2</bold>) Conicality against the density of connections in subnetworks given by the intersections of columns with individual layers. (<bold>E</bold>) Counts of afferents formed onto neurons in individual columns from neurons in the entire model. (<bold>E1</bold>) Normalized in-degrees originating from neurons in individual layers, plotted against conicality. (<bold>E2</bold>) In-degree of neurons in individual layers normalized by the overall in-degree in the model into each layer plotted against column height. (<bold>F</bold>) r-values of linear fits against generalized, n-dimensional in-degree as in E2. (<bold>F1</bold>) Of generalized in-degree against height; (<bold>F2</bold>) Of generalized in-degree against conicality.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Deviance and diversity of the morphological composition.</title><p>The morphological composition of a subvolume is a vector that specifies for reconstructed morphology how often it was placed into the subvolume. (<bold>A</bold>) For each layer and columnar subvolume the <italic>deviance</italic> of its morphological composition, a measure of its difference to the global composition of the entire layer. It is measured as the negative logarithm of the p-value of a chi-square test of the hypothesis that the composition of the layer/column intersection matches the composition of the layer. (<bold>B</bold>) For each layer and columnar subvolume the <italic>diversity</italic> of its morphological composition, a measure of the degree to which many different morphologies were placed. It is measured as the binary entropy of the morphological vector. (<bold>C</bold>) For all morphologies of layer 5 neurons their cumulative frequencies. Grey: in layer 5 globally; orange: in the column with the highest layer 5 diversity; blue: in the column with the lowest layer 5 diversity. Cumulative frequencies calculated after sorting by frequency.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig7-figsupp1-v1.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>Modularity across sub-columns.</title><p>(<bold>A</bold>) Left: Heat map of modularity values of the networks of connections within each column as parcellated in <xref ref-type="fig" rid="fig6">Figure 6</xref>. Right: The same but for ER-controls of each column, thus fixing the number of nodes and connections but modelling random connectivity. (<bold>B</bold>) Modularity is strongly correlated to the volume of the column and the number of neurons in it. The modularity values are much higher than those obtained in columns of the same size with random connectivity. Moreover, for the controls modularity is in fact anti-correlated with volume and number of neurons. (<bold>C</bold>) Modularity values of random subnetworks of the columns with highest modularity (higher than 0.4). For each column, 50% of the neurons were sampled at random 50 times, providing 50 subnetworks for each column. The modularity of these was computed in two ways. Blue restricting the modules of the full column to the sample. Pink: Re-optimizing to find the modules that maximize the modularity value (see Materials and methods). The modularity distributions are virtually the same between the two methods and coincide in their mean with the modularity value of the full column (purple cross).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig7-figsupp2-v1.tif"/></fig></fig-group><p>We quantified the two main variable factors of geometry, measuring the height and <italic>conicality</italic> (a feature that measures the convexity of a column, see Materials and methods) of each column (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). We found that differences in these factors lead to differences in relevant topological parameters, such as the modularity of the local network (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). This effect was mostly mediated by differences in the neuronal composition, both in terms of total neuron count (not shown) and relative counts for individual layers (<xref ref-type="fig" rid="fig7">Figure 7D1</xref>). However, conicality also affected the density of connections in local, layer-specific subnetworks (<xref ref-type="fig" rid="fig7">Figure 7D2</xref>), that is, a measure that is normalized against neuron counts.</p><p>Modularity in particular, is strongly correlated with column volume and neuronal count (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2A,B</xref>), which are in turn driven by the column’s height and conicality. This effect is shaped by the network structure and not just by its size, since it is not present for controls where the number of neurons and their connections are maintained but their pairing is assigned at random (i.e. ER-controls). In fact, for ER-controls, modularity is anti-correlated with volume and neuron count (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2B</xref>). One way in which the results could be artificial is as follows: Modularity is first defined for a partition of neurons into modules; next the partition maximizing the measure is considered. This can only be done heuristically, and it is possible that optimal partitions are more readily found in certain connectomes than others (see also Materials and methods). To rule this out, we focused on the most modular columns (i.e. those with modularity higher than 0.4). For these, we showed that on average random subnetworks on 50% of the neurons maintained the modularity values of the full columns and that this is not an artifact of the algorithm computing the modularity values (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2C</xref>).</p><p>Going beyond the local, purely internal networks, we considered how much each column was innervated by the individual layers of the entire model. We predict a surprisingly strong impact of geometry, for example the ratio of inputs from layer 3 to inputs from layer 6 shifts from almost 2–1 in convex regions to 1–2 in concave regions (<xref ref-type="fig" rid="fig7">Figure 7E1</xref>). On the other hand, we consider the total amount of inputs received, in each layer of a column. In layers 4, 5, and 6, neurons had a higher in-degree if they were members of tall columns (i.e. placed at locations of large cortical thickness). For layers 1, 2, and 3 the trend was weakened or nonexistent (<xref ref-type="fig" rid="fig7">Figure 7E2</xref>). The notion of in-degree can be generalized to the <italic>n-dimensional in-degree</italic> measuring participation in specific, directed motifs of n+1 neurons (see Materials and methods). While trends differed between individual layers, overall the dependence of generalized in-degree on geometrical measures increased with dimension (<xref ref-type="fig" rid="fig7">Figure 7F1 and F2</xref> ‘full’). This was particularly driven by neurons in layer 6. Curiously, in that layer the sign of the r-values, with respect to conicality, inverted from dimensions 1 and 2 to dimensions above 2, indicating the overall innervation of layer 6 is stronger in convex regions, but the participation in higher-order motifs is stronger in concave regions.</p><p>The effect of conicality can be explained by convex / concave regions allocating more or less relative space to individual layers, thereby weighing the contributions of the corresponding subnetworks differently. The effect of column height is twofold: First, taller columns will contain more neurons. Second, a different selection of neuron morphologies will be placed, depending on the column height. Briefly, taller morphologies will be selected for taller columns (see also <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). Indeed, the selected morphologies in layers 2–5 were significantly different from the overall composition in columns taller than 2 mm or shorter than 1.4 mm; in layer 6 only the short columns led to significant deviance (<xref ref-type="fig" rid="fig7">Figure 7B</xref>, <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1A</xref>). Due to the finite number of morphology reconstructions used there is the risk of an artificial effect: It is possible that in geometrically outlying columns only a small number of non-representative morphologies were placed. Testing this, we found that the morphological diversity overall increased from superficial to deeper layers, as more morphological reconstructions were available for the thicker, deeper layers (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1B</xref>). Over columns, diversity was relatively uniform. The largest decrease in diversity was observed for short columns and layer 5. In that layer, the least diverse column used around a third of the available reconstructed morphologies (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1C</xref>). As this still amounted to 909 different morphological reconstruction with significant spread between them, we do not believe that dominance by non-representative morphologies explains the qualitative differences in connectivity.</p></sec><sec id="s2-7"><title>The complexity of local and mid-range connectivity requires neuronal morphologies</title><p>So far, we have analyzed single (thalamo-cortical) pathways making up less than 5% of the synapses in the model, and connectivity at scales that are already readily achievable in electron-microscopic reconstructions. The large size of the model also allowed us to characterize predicted connectivity at cellular resolution, but scales that are experimentally only accessible with regional or voxelized resolution (<xref ref-type="bibr" rid="bib70">Oh et al., 2014</xref>; <xref ref-type="bibr" rid="bib11">Bota et al., 2015</xref>; <xref ref-type="bibr" rid="bib90">Scannell et al., 1995</xref>; <xref ref-type="bibr" rid="bib92">Scholtens et al., 2014</xref>), thereby bridging the scales as outlined in the introduction. Note that the topological methods in the following sections represent and analyze the connectome as a graph, with neurons as nodes and connections between neurons as directed edges, irrespective of the number of synapses in the connection.</p><p>We began by analyzing the global structure of neuron-to-neuron connectivity in the entire model, considering local and mid-range connectivity separately. The topology of synaptic connectivity at single neuron resolution has previously been described in terms of the over-expression of directed simplices (<xref ref-type="bibr" rid="bib85">Reimann et al., 2017b</xref>). A <italic>directed simplex of dimension</italic> <inline-formula><alternatives><mml:math id="inf20"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft20">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula> (or <inline-formula><alternatives><mml:math id="inf21"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft21">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula>-simplex, plural <inline-formula><alternatives><mml:math id="inf22"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft22">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula>-simplices) is a neuron motif of <inline-formula><alternatives><mml:math id="inf23"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft23">\begin{document}$  n+1$\end{document}</tex-math></alternatives></inline-formula> neurons that are connected in a purely feed-forward fashion, with a single <italic>source</italic> neuron sending connections to all others, a single <italic>sink</italic> neuron receiving connections from all others, and the connections between non-sink neurons forming an <inline-formula><alternatives><mml:math id="inf24"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft24">\begin{document}$  n-1$\end{document}</tex-math></alternatives></inline-formula>-simplex (<xref ref-type="fig" rid="fig8">Figure 8A1</xref> inset; <xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2A</xref>). In particular, 0-simplices correspond to single nodes, and 1-simplices to directed edges. Simplex counts of different dimensions in a network provide a metric of network complexity and can be used to discern their underlying structure (<xref ref-type="bibr" rid="bib49">Kahle, 2009</xref>; <xref ref-type="bibr" rid="bib19">Curto et al., 2013</xref>; <xref ref-type="bibr" rid="bib43">Giusti et al., 2015</xref>). Regarding function, high-dimensional simplices have been demonstrated to shape the structure of spiking correlation between neurons and membership in functional cell assemblies (<xref ref-type="bibr" rid="bib85">Reimann et al., 2017b</xref>; <xref ref-type="bibr" rid="bib23">Ecker et al., 2024a</xref>).</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Global connectivity structure local vs mid-range.</title><p>(<bold>A1</bold>) Simplex counts of the local connectivity network and several types of random controls (see text). Examples of <inline-formula><alternatives><mml:math id="inf25"><mml:mstyle><mml:mi>d</mml:mi></mml:mstyle></mml:math><tex-math id="inft25">\begin{document}$  d$\end{document}</tex-math></alternatives></inline-formula>-simplices for <inline-formula><alternatives><mml:math id="inf26"><mml:mstyle><mml:mi>d</mml:mi><mml:mo>=</mml:mo></mml:mstyle></mml:math><tex-math id="inft26">\begin{document}$  d=$\end{document}</tex-math></alternatives></inline-formula> 1, 2, and 3. Intuitively, an <inline-formula><alternatives><mml:math id="inf27"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft27">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula>-simplex is formed by taking an <inline-formula><alternatives><mml:math id="inf28"><mml:mstyle><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math><tex-math id="inft28">\begin{document}$  n-1$\end{document}</tex-math></alternatives></inline-formula>-simplex and adding a new node to which all neurons connect (sink). (<bold>A2</bold>) In orange shades, simplex counts of the mid-range connectivity network and several types of random controls. In gray, simplex counts of the combined network and in blue the sum of the local and the mid-range simplex counts. Inset: local, mid-range and the sum of simplex counts on a linear scale. (<bold>B1</bold>) Node participation per layer, normalized to add up to one in each dimension. Top/bottom row: Local/mid-range connectivity network. Left to right: Participation as source, in any position, and as a sink of a simplex. (<bold>B2</bold>) From left to right: Spatial location of the cells in the simplicial <inline-formula><alternatives><mml:math id="inf29"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft29">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula>-cores in flat coordinates for all <inline-formula><alternatives><mml:math id="inf30"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft30">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula>. Depth coordinates for each connected component in the simplicial cores (cells participating in simplices of maximal dimension) each dot marks the depth of a neuron in that component. Adjacency matrix of the simplicial cores with respect to local (green dots) and mid-range (orange dots) connections. (<bold>B3</bold>) Number of unique neurons in the simplicial cores present in each position of a simplex (i.e., position along the order from source to target. numbers: total counts, bars: counts relative to the total). (<bold>C1</bold>) Right: Distribution of path distances between pairs of neurons in the local simplicial core; green: along only local edges; grey: along all edges. Left: Euclidean distances between pairs at a given path distance. Arrows: See C2. (<bold>C2</bold>) Total Number of neurons in all paths of length 3 between neurons of the local core which are at distance 3 in the combined circuit (black arrow in C1) split by location. Red/purple: at positions 2 and 3 respectively; grey: expected from randomly assigned m-types while maintaining the global distribution. Cross-/stripe-patterned: For pairs at path distances greater/less-or-equal than 3 along local edges only (green arrows in C1).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig8-v1.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Basic properties of network connectivity.</title><p>(<bold>A</bold>) Top/bottom degree distributions of the local/mid-range networks and their corresponding control models. On the second row additional inserts are provided showing the bi-modality of the out and total degree distributions of the SBM and DBM controls. (<bold>B</bold>) Matrices showing the probability of connection between given pre/post-synpatic m-types. Vertically at the right of each matrix the probability of connection for a fixed pre-synaptic m-type. Horizontally on top of each matrix, the probability of connection for a fixed post-synaptic m-type. (<bold>C</bold>) Left and center, percentage of special nodes in both networks, sources (nodes of in-degree 0) and proper sinks (nodes of out-degree 0 that are not isolated nodes). Right: layer distribution of the special nodes of the mid-range network.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig8-figsupp1-v1.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>Rich club analysis.</title><p>(<bold>A</bold>) Depiction of simplices and non-simplices in various dimensions with distinction between the source and target nodes. (<bold>B</bold>) Rich-club analysis, top/bottom rows for the local/mid-range networks. Left column, rich-club curves for the original networks as well as their CM controls. Top left additionally shows the rich-club curves of the DBM controls of the local-networks as well as their corresponding CM controls. Middle column shows normalized rich club curves obtained by dividing the rich-club curves for the original networks by the mean of the rich-club curves of their corresponding controls. Right column shows the simplicial rich club curves for color-coded dimensions <inline-formula><alternatives><mml:math id="inf31"><mml:mstyle><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math><tex-math id="inft31">\begin{document}$  \geq 2$\end{document}</tex-math></alternatives></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig8-figsupp2-v1.tif"/></fig></fig-group><p>In line with previous results (<xref ref-type="bibr" rid="bib85">Reimann et al., 2017b</xref>), we found simplices up to dimension seven in the local connectivity (<xref ref-type="fig" rid="fig8">Figure 8A1</xref>, green). The maximal dimension did not increase compared to <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref> even with the larger scale of the present model, in accordance with using the same algorithm for local connectivity. However, the addition of mid-range connectivity did produce a major change. In mid-range connectivity alone, simplices of dimension up to 15 were observed (<xref ref-type="fig" rid="fig8">Figure 8A2</xref>, orange). This holds true even though local and mid-range connectivity have roughly the same number of edges (2.1 billion local, 2.5 billion mid-range), indicating that the higher simplex counts are not simply due to a larger number of connections. The simplex counts in the combined network of local and mid-range connections are not simply the sum of the local and mid-range simplex counts (<xref ref-type="fig" rid="fig8">Figure 8A2</xref>). They are consistently higher and also attain a higher dimensionality generating motifs of up to dimension 18, indicating a strong structural link between the two systems.</p><p>We compared the simplex counts of the model to a range of relevant controls that capture simple anatomical properties, such as the density of connections or cortical layers, but ignore the impact of neuronal morphologies (<xref ref-type="fig" rid="fig8">Figure 8A1,A2</xref>). This allowed us to assess the degree to which the neuronal geometry generates the complexity of the network. The control models and the parameters on which they capture were the following: the <italic>Erdős–Rényi (ER</italic>) model used the overall connection density, the <italic>stochastic block model (SBM</italic>) used density in m-type-specific pathways, the <italic>configuration model (CM</italic>) used sequences of in- and out-degrees, and finally the <italic>distance block model (DBM</italic>) used distance-dependence and neuron locations for individual m-type-specific pathways. See Materials and methods for details.</p><p>We found that the structure of connectivity is not only determined by the parameters captured by the controls. The CM control was the closest control for mid-range connectivity, suggesting that the effect of degree is important, as expected from the very long-tailed degree distributions of the mid-range connectome (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1A</xref>). Nonetheless, this control model still largely underestimates the complexity of the mid-range network. At the same time, the DBM control was the closest control for local connectivity, showing that much of its structure is indeed determined by spatial distance under certain morphological constraints.</p></sec><sec id="s2-8"><title>Simplicial cores define central subnetworks, tied together by mid-range connections</title><p>Next, we investigated in which layers the neurons forming these high-dimensional structures resided by measuring <italic>node participation</italic>, that is, the number of simplices to which a node belongs, and a measure of the node’s centrality (<xref ref-type="bibr" rid="bib96">Sizemore et al., 2018</xref>; see Materials and methods for details). We found that in local connectivity, most simplices of dimensions 2, 3, and 4 have their source in layer 3 and their sink in layer 5 <xref ref-type="fig" rid="fig8">Figure 8B1</xref> top. Yet, for dimensions 5 and above, we found a shift towards layer 6, with both sources and sinks found mostly in that layer. In mid-range connectivity, the structures are much more concentrated on layer 5, which contains both source and sink <xref ref-type="fig" rid="fig8">Figure 8B1</xref> bottom. Only for simplices of dimension greater than 8 does layer 4 provide more sources. Taken together, this indicates a robust local flow of information from superficial to deeper layers and within deep layers, with layer 5 forming a backbone of structurally strong mid-range connectivity. Neurons in layer 6 form numerous simplices among themselves with no apparent output outside of layer 6, but they are known to be the source of many cortico-thalamic connections (<xref ref-type="bibr" rid="bib95">Shepherd and Yamawaki, 2021</xref>) that are not a part of this model.</p><p>The model made an explicit distinction between m-types forming outgoing mid-range connections (i.e. projecting m-types) and those that do not (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1C</xref>, ‘proper sinks’) leading to bimodal distributions of out-and total degrees in the corresponding DBM and SBM controls (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1A</xref>). In contrast, the actual mid-range network has a unimodal, long-tailed degree distribution, similar to biological neuronal networks (<xref ref-type="bibr" rid="bib42">Giacopelli et al., 2021</xref>). This further demonstrates that the m-types alone can not capture the specific targeting between neuron groups without their actual morphologies.</p><p>One type of connectivity specificity that has been found in biological neuronal networks (<xref ref-type="bibr" rid="bib104">Towlson et al., 2013</xref>) is the formation of a rich club (<xref ref-type="bibr" rid="bib117">Zhou and Mondragon, 2004</xref>; <xref ref-type="bibr" rid="bib108">van den Heuvel and Sporns, 2011</xref>). This is characterized by a rich-club curve, which measures whether high degree nodes are more likely to connect together, compared to the CM control (see Materials and methods). We observe that the local network has a rich-club effect, but it is not stronger than expected in a spatially finite model with distance-dependent connectivity (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2B1/2</xref>). On the other hand, the mid-range network does not exhibit a rich-club effect, see <xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2B2</xref> bottom, showing that high degree nodes are not central to the network.</p><p>When we generalized the rich club analysis to higher dimensions by considering node participation instead of degree (<xref ref-type="bibr" rid="bib71">Opsahl et al., 2008</xref>; see Materials and methods for details) a different picture emerged (see <xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2B3</xref>). We found that the rich club coefficients in the mid-range network increased with dimension, while the opposite happens for the local network. We speculate that this effect persists after normalization with respect to relevant controls. Unfortunately, this cannot be currently verified since generating appropriate random controls for these curves is an open problem currently investigated in the field of random topology (<xref ref-type="bibr" rid="bib107">Unger and Krebs, 2024</xref>). Nonetheless, this indicates that central nodes strongly connect to each other forming a structural backbone of the network that is not determined by degree alone.</p><p>We studied these structural backbones, by focusing on the <italic>simplicial cores</italic> of the networks, which is a higher dimensional generalization of the notion of network core, which is determined by degree alone (see Materials and methods). The general trend observed is that the local network is distributed, while the mid-range network is highly localized. First in terms of the locations of neurons participating in the cores (<xref ref-type="fig" rid="fig8">Figure 8B2</xref> left; green vs. orange), and their laminar locations (<xref ref-type="fig" rid="fig8">Figure 8B2</xref> right). Second, even though the numbers of neurons in the local and mid-range cores are in the same order of magnitude, the local core has 26 disconnected component while the mid-range core is fully connected (<xref ref-type="fig" rid="fig8">Figure 8B3</xref> bottom). Finally, the mid-range core was successively more strongly localized towards the source position, where only seven unique neurons were the sources of all of the 15,108 highest-dimensional mid-range simplices (<xref ref-type="fig" rid="fig8">Figure 8B3</xref> top).</p><p>Finally, we studied the interactions between the local and mid-range networks, specifically, the ability of mid-range connnectivity to form short-cuts between neurons of the local core. Even though the sub-network on the nodes in the local core has multiple connected components (<xref ref-type="fig" rid="fig8">Figure 8B2</xref>), when paths through nodes outside the core are allowed, it is fully connected. When only local connectivity was considered, the path distances between core neurons were widely distributed between one and seven with a median of four and a strong dependence on their Euclidean distance (<xref ref-type="fig" rid="fig8">Figure 8C1</xref>, green). On the other hand, when mid-range connections were added the maximum path distance drops to five, with a negligible number of pairs at that path distance. The median path distance drops to three, and the dependence of the path distance on the Euclidean distance of the pairs nearly disappears (<xref ref-type="fig" rid="fig8">Figure 8C1</xref>, grey). Crucially, even though the number of edges almost doubled with the addition of mid-range connections, the number of direct connections remained negligible; instead paths of length three seem to be dominant for information exchange between neurons.</p><p>We therefore studied these paths of length three in the combined circuit in more detail, labeling the neurons along them from position 1 (start-node) to position 4 (end-node). We found that layer 5 (the layer with the highest outgoing edge probability, see <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1B</xref>) is over-represented in nodes in positions 2 and 3 compared to a random assignment of m-types (<xref ref-type="fig" rid="fig8">Figure 8C2</xref>). Moreover, the over-representation depends on the path distance between the start-node and end-node within the local network: when the value is larger than three (bars hatched by crosses), the effect is stronger than for pairs at a distance three or less (bars hatched by horizontal bars). This demonstrates and quantifies how neurons in layer 5 act as ‘highway hubs’ providing shortcuts between neurons that are far away from each other in the local circuit.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have presented a model of the non-barrel primary somatosensory cortex of the juvenile rat that represents its neuronal and - particularly - synaptic anatomy in high detail. The model comprises a spatial scale that allows for the study of cortical circuits not only as isolated functional units, but also their interactions along inter-regional connections. It also demonstrates how novel insights that are not readily apparent in disparate data and individual models can be gained when they are combined in a way that creates a coherent whole. Specifically, we were able to make multiple predictions about the structure of cortical connectivity that required integration of all anatomical aspects potentially affecting connectivity. At the scale of this model, anatomical aspects affecting connectivity went beyond individual neuronal morphologies and their placement, and included intrinsic cortical curvature and other anatomical variability. This was taken into account during the modeling of the anatomical composition, for example by using three-dimensional, layer-specific neuron density profiles that match biological measurements, and by ensuring the biologically correct orientation of model neurons with respect to the orientation towards the cortical surface. As local connectivity was derived from axo-dendritic appositions in the anatomical model, it was strongly affected by these aspects.</p><p>One type of literature resource our approach to connectivity did not use is experimental measurements of local connection probabilities. While these resources are valuable data for our understanding of cortical processing, they are difficult to use in a biophysically detailed model covering large spatial scales. First, connection probabilities are often identified through a PSP response at the soma (<xref ref-type="bibr" rid="bib98">Song et al., 2005</xref>; <xref ref-type="bibr" rid="bib73">Perin et al., 2011</xref>; <xref ref-type="bibr" rid="bib102">Thomson et al., 2002</xref>). However, for connections formed by low numbers of synapses on distal dendrites the PSP may be attenuated too much to be measurable at the soma (<xref ref-type="bibr" rid="bib66">Neher, 1992</xref>). The connection may still be relevant, e.g., by collaboratively triggering non-linear dendritic events or affecting plasticity of nearby synapses (<xref ref-type="bibr" rid="bib30">Farinella et al., 2014</xref>; <xref ref-type="bibr" rid="bib46">Iacaruso et al., 2017</xref>; <xref ref-type="bibr" rid="bib101">Tazerart et al., 2020</xref>). These effects are not considered in simplified models, leading to a focus on somatically visible connections only. However, in our case, we want to be able to study these effects with our model. Second, some studies report connection probabilities, but only incidentally, being primarily interested in the physiology of a synaptic pathway (<xref ref-type="bibr" rid="bib102">Thomson et al., 2002</xref>; <xref ref-type="bibr" rid="bib58">Markram et al., 1997</xref>; <xref ref-type="bibr" rid="bib60">Mason et al., 1991</xref>). Hence, they employ sampling strategies that aim to maximize the number of connected pairs encountered. Third, even studies aiming to characterize the anatomy of circuitry can provide contradictory estimates: <xref ref-type="bibr" rid="bib48">Jiang et al., 2015</xref> report 0 connections for 150 sampled pairs of PCs in layer 5 of adult mouse V1, while in the proofread portion of the data of <xref ref-type="bibr" rid="bib4">Bae et al., 2021</xref> 13 out of 154 pairs (8.4%) within 100 µm are connected. Fourth, connection probabilities are often measured by sampling pairs of neurons at inter-soma distances below 100 µm or even only 50 µm (see Table 4.1 of <xref ref-type="bibr" rid="bib116">Zhang et al., 2019</xref> for an overview). While connection probabilities drop with distance, in a model covering large spatial dimensions, the number of potentially connected pairs grows with the square of distance. Consequently, a connection probability of, for example 0.15% at 500 µm would represent as many connections as a probability of 15% at 50 µm, and it cannot be rounded to zero. Recently, unbiased connection sampling techniques have been developed that provide estimates at larger distances (<xref ref-type="bibr" rid="bib15">Chou et al., 2023</xref>), that are likely to solve some of these issues in the future.</p><p>Connectivity derived from axo-dendritic appositions alone was insufficient at the large spatial scale of the model, as it was limited to connections at distances below 1000 µm. While we found that it generated the right amount of connectivity within a somatosensory subregion, we combined it with a second algorithm for inter-regional connectivity. The algorithm is parameterized by a combination of overall pathway strength, topographical mapping and layer profiles, which together describe a probability distribution for the segments of mid-range axons, that is, an average axonal morphology, using established concepts. On the dendritic side, the algorithm takes individual neuronal morphologies and their placement into account. We have demonstrated that the sum of local and non-local synapse densities matches the reference. It is important to consider whether such a mixture of two independent algorithms captures potentially important statistical interactions between the local and mid-range connectivity of individual neurons. We note that local connectivity is fully constrained by morphology, and the non-local connectivity is parameterized independently for individual morphological types. The combined connectome therefore captures important correlations at that level, such as stronger and weaker non-local cortico-cortical connections from slender-tufted and thick-tufted layer 5 PCs, respectively. When the model was created, interactions beyond this level had not yet been described because local axon reconstructions are reconstructed from slices, which prevents the possibility of obtaining long range information. Even in vivo staining still only reconstructs axons within a region (<xref ref-type="bibr" rid="bib14">Buzás et al., 2006</xref>). On the other hand, long-range axon reconstructions are obtained through whole brain staining, which has low accuracy for local connectivity (<xref ref-type="bibr" rid="bib111">Winnubst et al., 2019</xref>). Analysis of new EM datasets, such as a characterization of distance-dependent targeting of excitatory/inhibitory neurons by the axons of L5 thick-tufted pyramidal cells (<xref ref-type="bibr" rid="bib7">Bodor et al., 2023</xref>) using the data of <xref ref-type="bibr" rid="bib4">Bae et al., 2021</xref> could be incorporated in future models. Finding non-random correlations between local and non-local connections would require a strong null model to compare measurements to and our model can serve as that.</p><p>Recreating electron-microscopic analyses of connectivity in silico, we could then predict limitations of predicting connectivity from neuron placement and morphology and characterize the additional mechanisms shaping connectivity. Conceptually, a number of mechanisms determine the structure of synaptic connectivity, which we will list from general and large-scale to specific and micro-scale: First, large-scale anatomical trends over hundreds of µm, given by non-homogeneous (e.g. layered) soma placement and broad morphological trends (e.g. ascending axons). These are trends that can be captured by simple distance or offset-dependent connectivity models (<xref ref-type="bibr" rid="bib33">Gal et al., 2020</xref>). Second, small-scale morphological trends captured by axonal and dendritic morphometrics such as branching angles and tortuosity. These are trends that require the consideration of individual morphologies and their variability instead of average ones. Third, the principle of cooperative synapse formation (<xref ref-type="bibr" rid="bib29">Fares and Stepanyants, 2009</xref>) formalizing an avoidance of structurally weak connections. Fourth, any type-specific trends not captured by neuronal morphologies, such as local molecular mechanisms and type-specific synaptic pruning. Fifth, non-type specific synaptic rewiring, for example through structural plasticity. We will refer to these aspects as (L)arge-scale, (S)mall-scale, (C)ooperativity, (T)ype-specificity and (P)lasticity respectively, and we argue that for the explanation of the connectome, the more general explanations should be exhausted first, before moving on to more specific ones. Also note that this classification is not considering the underlying developmental <italic>causes</italic>, but instead associates anatomical and non-anatomical predictors with the structure of the connectome. (L) has been shown to accurately predict large-scale connectivity trends, giving rise to <italic>Peters’ rule</italic> (<xref ref-type="bibr" rid="bib74">Peters and Feldman, 1976</xref>; <xref ref-type="bibr" rid="bib35">Garey, 1999</xref>, although the exact meaning of Peters’ rule is debated, see <xref ref-type="bibr" rid="bib82">Rees et al., 2017</xref>). It has been demonstrated that (L) alone does not suffice to explain non-random higher order trends in excitatory connectivity, while the combination of (L,S,C) does (<xref ref-type="bibr" rid="bib32">Gal et al., 2017</xref>; <xref ref-type="bibr" rid="bib84">Reimann et al., 2017a</xref>; <xref ref-type="bibr" rid="bib33">Gal et al., 2020</xref>; <xref ref-type="bibr" rid="bib106">Udvary et al., 2022</xref>). More specifically, <xref ref-type="bibr" rid="bib85">Reimann et al., 2017b</xref> found that (L,C) explains overexpression of reciprocal connectivity in cortical circuits, but (L,S,C) is required to match the biological trend for clustered connectivity, and <xref ref-type="bibr" rid="bib106">Udvary et al., 2022</xref> found (L,S) recreates non-random triplet motifs. <xref ref-type="bibr" rid="bib6">Billeh et al., 2020</xref> combined (L) with highly refined (P)-type rules, demonstrating great <italic>functional</italic> match of the resulting model.</p><p>Our comparison to the results of <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref> cannot capture the role of (L), as the scale of the considered volume is too small. But it demonstrates that some non-random targeting trends can be explained by (S,C) and highlights the importance of (C). Further, the overall lower specificity of excitatory axon fragments indicates that (T) may not play a role for them. Similarly, the comparison to <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref> shows that (T) is not required to explain the connectivity of ‘distal-targeting’ (i.e., Sst+) neuron types. Conversely, for ‘perisomatic-targeting’ types (i.e., PV+ basket cells) (T) was required to match the distribution of postsynaptic compartment types. Additionally, the number of potential synapses remaining after applying an optimized (T)-type mechanism was too large to be sustained by the axons, implying a crucial role of (P) in reducing it further. This is in contrast to ‘inhibitory-targeting’ neurons, where an optimized (T)-type pruning lowered the synapse count so much that no space for (P) remained. For the ‘sparsely-targeting’ neurons of <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref> we developed two competing hypotheses, one predicting no role for (T) and 70% of their synapses volumetrically transmitting, that is, without clear postsynaptic partner, and the other predicting a role for (T) similar to the perisomatic-targeting neurons. We summarize our predictions in <xref ref-type="table" rid="table2">Table 2</xref>.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Anatomical, morphological and other aspects affecting connectivity and our predictions for their relevance for efferents of different neuron types.</title><p>See main text for an explanation of the individual aspects. The signs in the table indicate whether we predict a certain aspect to be not relevant (-), relevant (+), or highly relevant (++) for a given neuron type.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Axon type</th><th align="left" valign="bottom">(L)arge-scalemorphological</th><th align="left" valign="bottom">(S)mall-scalemorphological</th><th align="left" valign="bottom">(C)ooperativity</th><th align="left" valign="bottom">(T)ype-specificity</th><th align="left" valign="bottom">(P)lasticity</th></tr></thead><tbody><tr><td align="left" valign="bottom">EXC.</td><td align="char" char="plus" valign="bottom">+</td><td align="char" char="plus" valign="bottom">++</td><td align="char" char="plus" valign="bottom">++</td><td align="left" valign="bottom">-</td><td align="char" char="plus" valign="bottom">+</td></tr><tr><td align="left" valign="bottom">BCs</td><td align="char" char="plus" valign="bottom">+</td><td align="char" char="plus" valign="bottom">+</td><td align="char" char="plus" valign="bottom">+</td><td align="char" char="plus" valign="bottom">+</td><td align="char" char="plus" valign="bottom">+</td></tr><tr><td align="left" valign="bottom">Sst+</td><td align="char" char="plus" valign="bottom">++</td><td align="char" char="plus" valign="bottom">+</td><td align="char" char="plus" valign="bottom">+</td><td align="left" valign="bottom">-</td><td align="char" char="plus" valign="bottom">+</td></tr><tr><td align="left" valign="bottom">VIP+</td><td align="char" char="plus" valign="bottom">+</td><td align="left" valign="bottom">-</td><td align="char" char="plus" valign="bottom">+</td><td align="char" char="plus" valign="bottom">++</td><td align="left" valign="bottom">-</td></tr><tr><td align="left" valign="bottom">NGC and L1</td><td align="char" char="plus" valign="bottom">++</td><td align="char" char="plus" valign="bottom">+</td><td align="left" valign="bottom">-</td><td align="char" char="plus" valign="bottom">+/-</td><td align="char" char="plus" valign="bottom">+</td></tr></tbody></table></table-wrap><p>In addition to targeting specificity, we predict the following: First, we were able to predict the effect of cortical anatomical variability on neuronal composition by increasing or decreasing the space available for individual layers. If we assume that each layer has a given computational purpose (<xref ref-type="bibr" rid="bib31">Felleman and Van Essen, 1991</xref>), then this may have functional consequences. It is possible that cortical circuits compensate for this effect, either anatomically (e.g. using different axon or dendrite morphologies), or non-anatomically. Either case would imply the existence of an active mechanism with the possibility of malfunction. Alternatively, function of cortical circuits is robust against the differences in wiring we characterized. This can be studied either in vivo, or in silico based on this model.</p><p>Second, we predicted constraints on the emergence of cortical maps from the anatomy of thalamo-cortical innervation, that is, from the combination of: shape and placement of cortical dendrites, the specific layer pattern formed by thalamo-cortical axons, and their horizontal reach. We demonstrated how differences in these parameters may affect the distances between neuron pairs with similar stimulus preferences. At the lower end, very different preferences are supported even between neighboring neurons. At the higher end, neurons further than ∼350 µm apart are likely to sample from non-overlapping sets of thalamic inputs. Other mechanisms will ultimately affect this - chief among them structural synaptic plasticity - this can be thought of as the ground state that plasticity is operating on.</p><p>Third, we predicted the topology of synaptic connectivity with neuronal resolution at an unprecedented scale, that is, combining local and mid-range connectivity. We found that the structure of neither can be explained by connection probabilities, degree-distributions, or distance-dependence alone, not even when individual pathways formed between morphological types are taken into account. We expect the mid-range network to have a small-world topology, but computing small-world coefficients for a network of this size is infeasible (see Materials and methods).</p><p>Fourth, we predict that the mid-range connectivity forms a strong structural backbone distributing information between a small number of highly connected clusters. The paths within the mid-range network strongly rely on neurons in layer 5 and form short-cut paths for neurons further away than ∼2  mm; for smaller distances, local connectivity provides equivalent or shorter paths.</p><p>All these insights required the construction of an anatomically detailed model in a three-dimensional brain atlas; additionally, most of them required the large spatial scale we used. Their functional and computational implications are difficult to predict without also considering data on neuron activity. To that end, an accompanying manuscript describes our modeling of the physiology of neurons and synapses, along with a number of in silico simulation campaigns and their results. Additionally, more insights were gained from using the model in several publications: In <xref ref-type="bibr" rid="bib24">Ecker et al., 2024b</xref>; <xref ref-type="bibr" rid="bib23">Ecker et al., 2024a</xref>; <xref ref-type="bibr" rid="bib26">Egas Santander et al., 2024a</xref> it has been demonstrated that non-random higher order structure affects functional plasticity, assembly formation and the reliability and efficiency of coding of subpopulations. Moreover, two of these insights were validated against electron microscopy data. Furthermore, in <xref ref-type="bibr" rid="bib87">Reimann et al., 2024</xref> the model served as an important null model to compare an electron microscopic connectome to, enabling the discovery of specific targeting of inhibition at the cellular level.</p><p>This iteration of the model is incomplete in several ways. First, several compromises and generalizations were made to be able to parameterize the process with biological data, most importantly, generalizing from mouse to rat. We note that such mixing is the accepted state-of-the-art in the field, and also neuroscience in general. All 19 data-driven models of rodent microcircuitry listed in <xref ref-type="fig" rid="fig2">Figure 2</xref> of the recent review of <xref ref-type="bibr" rid="bib81">Ramaswamy, 2024</xref> conduct some sort of mixing, including the very advanced mouse V1 model of the Allen Institute (<xref ref-type="bibr" rid="bib6">Billeh et al., 2020</xref>). In this iteration we focused on investigating the general features of the (multi-region) mammalian cortex, e.g., high-order motifs, connected by L5 neurons across subregions or the effect of curvature on connectivity. In the future, more specific aspects of different cortical regions could be investigated using more specific data sources. This would lead to different versions of the model for different regions that can be compared and contrasted using the various structural metrics we developed in this work. Further, we made a number of assumptions about the biological systems that we explicitly list in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>. Should improved and more specific data sources, such as EM-based connectomes or whole-brain neuron reconstructions, become available in the future, our modeling pipepline is designed to readily utilize them for refinement. There are also known limitations to the actual model building steps. While we enforce cell density profiles along the depth-dimension, densities are assumed to be otherwise uniform within a given subregion. For additional structure, the algorithms will need to be updated; this will be required for example, for the modeling of the barrel field. Similarly, during volume filling, orientation and placement of neuron morphologies is considered only along the depth-axis. Modeling of the barrel system will also require the consideration of orientation and location with respect to nearby barrel centers. Furthermore, we assumed uniform relative layer thickness throughout the modeled region, due to sparsity of the required data. However, given that <xref ref-type="bibr" rid="bib115">Yusufoğulları et al., 2015</xref> has demonstrated there are substantial differences in layer thickness between rat hindlimb and barrel field regions and <xref ref-type="bibr" rid="bib65">Narayanan et al., 2017</xref> and <xref ref-type="bibr" rid="bib109">Wagstyl et al., 2020</xref> found lower but still significant differences within developed rat barrel cortex and human somatosensory cortex respectively, the model pipeline should be updated once sufficient data becomes available.</p><p>This demonstrates that detailed modeling requires constant iteration, as a model can never be proven to be right, only to be wrong. Thus, we made the tools to improve our model also openly available (see Data and Code availability section). <xref ref-type="fig" rid="fig1">Figure 1</xref> provides a technical overview of individual modeling steps, the software tools involved and the duration required to run them, to serve as a guide to interested contributors.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reagent type (species) or resource</th><th align="left" valign="bottom">Designation</th><th align="left" valign="bottom">Source or reference</th><th align="left" valign="bottom">Identifiers</th><th align="left" valign="bottom">Additional information</th></tr></thead><tbody><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Model loading and interaction</td><td align="char" char="." valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8026852">https://doi.org/10.5281/zenodo.8026852</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Model analysis</td><td align="char" char="." valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://doi.org/110.5281/zenodo.8016989">https://doi.org/110.5281/zenodo.8016989</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Topological analysis of connectivity</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib27">Egas Santander et al., 2024b</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/danielaegassan/connectome_analysis">https://github.com/danielaegassan/connectome_analysis</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">see also <xref ref-type="bibr" rid="bib26">Egas Santander et al., 2024a</xref>; version 0.0.1</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">atlas-splitter</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib38">Gevaert et al., 2024a</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/atlas-splitter/tree/v0.1.5">https://github.com/BlueBrain/atlas-splitter/tree/v0.1.5</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">Release 0.1.5</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">atlas-densities</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib39">Gevaert et al., 2024b</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/atlas-densities/tree/v0.2.5">https://github.com/BlueBrain/atlas-densities/tree/v0.2.5</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">Release 0.2.5</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Brainbuilder</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib79">Povolotsky et al., 2024</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/brainbuilder/tree/v0.20.0">https://github.com/BlueBrain/brainbuilder/tree/v0.20.0</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">Release 0.20.</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">NeuroR</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib3">Arnaudon et al., 2024</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/NeuroR/tree/v1.7.0">https://github.com/BlueBrain/NeuroR/tree/v1.7.0</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">Release 1.7.0</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">NeuroC</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib40">Gevaert et al., 2024c</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/neuroc/tree/v0.3.0">https://github.com/BlueBrain/neuroc/tree/v0.3.0</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">Release 0.3.0</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">placement-algorithm</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib78">Povolotsky et al., 2023</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/placement-algorithm/releases/tag/placement-algorithm-v2.4.0">https://github.com/BlueBrain/placement-algorithm/releases/tag/placement-algorithm-v2.4.0</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">Release 2.4.0</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Appositionizer</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib112">Wolf and Berchet, 2024</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/appositionizer/releases/tag/v1.0.0">https://github.com/BlueBrain/appositionizer/releases/tag/v1.0.0</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">see also <xref ref-type="bibr" rid="bib56">Kozloski et al., 2008</xref>; release 1.0.0</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Functionalizer</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib113">Wolf et al., 2024</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/functionalizer/releases/tag/v1.0.0">https://github.com/BlueBrain/functionalizer/releases/tag/v1.0.0</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">Release 1.0.0</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Projectionizer</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib37">Gevaert and Herttuainen, 2022</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/projectionizer/releases/tag/projectionizer-v3.0.0.dev0">https://github.com/BlueBrain/projectionizer/releases/tag/projectionizer-v3.0.0.dev0</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">Release 3.0.0.dev0</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Connectome-Manipulator</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib76">Pokorny et al., 2024b</xref>; <ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/connectome-manipulator/tree/v1.0.0">https://github.com/BlueBrain/connectome-manipulator/tree/v1.0.0</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom">see also <xref ref-type="bibr" rid="bib75">Pokorny et al., 2024a</xref>; release 1.0.0</td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Method details</title><p>An overview of the model building steps, tools used and approximate durations can be found in <xref ref-type="fig" rid="fig9">Figure 9</xref>.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Overview of the building workflow and tools used.</title><p>Names of individual software tools are bold in the description (see also Key resources table); descriptions of required inputs in italics. Where not listed, the inputs of a step are outputs of the previous step. For completeness, also physiological modeling steps not described in this work are also depicted, but indicated semi-transparent. Note that the Key resources table only lists tools related to anatomical modeling.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-99688-fig9-v1.tif"/></fig><sec id="s4-1-1"><title>Preparation of voxelized atlases</title><p>First and foremost, the departure from a simplified hexagonal geometry (as in the NMC model <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>), required a digital brain atlas defining the anatomy of the region. To that end, we took as starting point the <xref ref-type="bibr" rid="bib72">Paxinos and Watson, 2007</xref> adult rat brain atlas, processed individual digitized slices, aligned them and labeled them to assemble a smooth three-dimensional volume with region annotations. The resulting atlas was then scaled down from the dimensions of adult rat to juvenile (P14) rat brain by reducing the size of individual voxels from 40 µm to 38.7348 µm. The scaling factor was based on the ratio of S1HL thicknesses at those ages (2082 µm for juvenile vs. 2150 µm for adult). Finally, supplementary atlas datasets were generated as described in <xref ref-type="bibr" rid="bib9">Bolaños-Puchet et al., 2024</xref>; <xref ref-type="bibr" rid="bib8">Bolaños-Puchet et al., 2023</xref>. These datasets provide additional spatial information required to ensure biologically accurate placement and orientation of dendritic trees (see below). First, the normalized cortical depth (between 0 and 1) at each point; second, the local orientation as a vector pointing towards the cortical surface at each point; third, the total cortical thickness at each point, that is, the length of the shortest path from the cortical surface to the bottom of layer 6 passing through that point.</p><p>Additionally, we followed <xref ref-type="bibr" rid="bib9">Bolaños-Puchet et al., 2024</xref>; <xref ref-type="bibr" rid="bib8">Bolaños-Puchet et al., 2023</xref> to produce a <italic>flat map</italic> of somatosensory regions, that is, a coordinate transformation associating each voxel with a two-dimensional projection into the plane. This can be used to create a flat view of region annotations that is crucial for the description of the topographical mapping of mid-range synaptic connectivity (see below). In short, to produce the flat map, a projection surface was defined by reconstructing a mesh from all points at a relative cortical depth of 0.5. Next, the local orientation field in the supplementary atlas was numerically integrated, yielding streamlines that were used to project each voxel center onto the projection surface. Finally, the projection surface was flattened with an authalic (area-preserving) algorithm. The main property of the resulting flat map is that in any flat view derived from it, each pixel represents a subvolume of cortex that spans all layers, akin to a cortical column.</p></sec><sec id="s4-1-2"><title>Reconstruction of neuron morphologies</title><p>Neuronal reconstructions were collected with two techniques: neurons were either filled with biocytin in a brain slice and reconstructed (<xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>; <xref ref-type="bibr" rid="bib64">Muralidhar et al., 2013</xref>), or were filled with a fluorescent dye in vivo and reconstructed (<xref ref-type="bibr" rid="bib13">Buzás et al., 1998</xref>; <xref ref-type="bibr" rid="bib54">Karube and Kisvárday, 2011</xref>). In total 1017 unique reconstructions were used, 896 of which were previously used in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>, 63 were new in vitro reconstructions, and 58 were new in vivo stained reconstructions.</p><sec id="s4-1-2-1"><title>Animal surgery</title><p>Normal C57BL/6 mice (P52-60) were used which were bred and maintained in the animal house facility of Department of Anatomy, Physiology and Embryology under appropriately controlled conditions (approval of Local Ethics Committee for Animal Research Studies at the University of Debrecen in line with European Union guidelines for the care of laboratory animals, Directive 2010/63/EU).</p><p>For initial anesthesia, animals were injected with pentobarbital (0.15 ml (6 mg/ml), i.p.). Prolonged anesthesia was achieved by injecting 0.05 ml every 60–90 minutes depending on the reaction to the toe-test. Head restraining was used and craniotomy performed in both hemispheres at coordinates ML 1.5–2 mm; AP 0.5–1 mm (<xref ref-type="bibr" rid="bib72">Paxinos and Watson, 2007</xref>) in order to expose the primary somatosensory cortex at the representation of the (hind-limb and fore-limb). We applied the topical anesthetic Lidocaine (Xylocaine gel, Egis Gyógyszergyár ZRT, Hungary) to all surgical wounds and pressure points. A custom-made plastic chamber (prepared by cutting a ring from a 1 ml plastic syringe) was mounted on the skull using super glue and was surrounded by 4% agar (VWR International Kft, Hungary). Then, the cortex was exposed by making a slit on the dura mater with the bent tip of a 14 gauge hypodermic needle.</p></sec><sec id="s4-1-2-2"><title>Single neuron labelling</title><p>For this purpose, borosilicate glass pipettes (GB150F-8P, Science Products GmbH, Germany) were pulled (Model P-97, Sutter Instrument Co., USA) with a resistance in the range of 60–80 MΩ (bevelled on a BV-10M beveler, Sutter Instrument Co., USA) and filled with 1 M KCl containing 2% biocytin (Sigma-Aldrich Chemie GmbH, Germany). The microelectrode was attached to a hydraulic microdrive (MHW-4 Narishige, Japan) and the tip guided in the cortex under the guidance of a surgical microscope (OP-MI, Zeiss). Then the chamber was then filled with 4% agar (VWR International Kft, Hungary) for better stability of the micropipette. Neuronal activity was recorded and amplified with AxoClamp-2A (Axon Instruments Inc, USA). After filtering, the signal was displayed on an oscilloscope and an audio monitor to aid and control intracellular penetration. Successful penetration of the cell membrane was indicated by a sudden drop of the resting membrane potential (below –40 mV) while applying 0.05 nA in the step-current mode (put here stimulus configuration from Master-8). Then, biocytin was injected with +2 nA using a duty cycle of 400 msec on and 200 msec off typically for 20 min. In each hemisphere 1–3 penetrations were made with approximately 0.3 mm spacing from each other. Neuronal activity was searched blindly across the entire cortical depth.</p></sec><sec id="s4-1-2-3"><title>Histology</title><p>The animals received a lethal dose of anesthetics and were perfused transcardially first with the washing medium (oxygenated Tyrode’s solution) for 2 min or until the blood showed clearing and then with a fixative (approx. 100 ml) containing 2% paraformaldehyde (VWR International Kft, Hungary) and 1% glutaraldehyde (Sigma-Aldrich Chemie Gmbh, Germany) in 0.1 M phosphate buffer (PB, pH 7.4) for 50 minutes. Next, the brain was removed from the skull and tissue blocks containing the region of interest were dissected. A series of 60–80 um thick vibratome (Leica VT1000S, Leica Biosystem) sections were cut in the coronal plane and collected in 5x10 lots in glass vials. The sections were washed in 0.05 M Tris-buffer saline (TBS, 10 min) and 0.05 M TBS containing 0.1% Triton X-100 (2x10 min) and incubated at 4 °C in avidin-biotin complexed-HRP (ABC-Elite kit, Vector Laboratories, Inc, USA), diluted 1:200 in 0.05 M TBS containing 0.1% Triton X-100 (Sigma-Aldrich Chemie Gmbh, Germany) for overnight. Then the sections were washed in TBS for 2x10 min and in TB for 10 min. They were treated with 0.05% DAB (3.3’ diaminobenzidine-4HCl, Sigma-Aldrich Chemie Gmbh, Germany) diluted in 0.05 M TB containing 0.0025% CoCl2 for 30 min while agitating on an electric shaker. Finally the labelling was visualized in the presence of 0.1% H2O2 (5 min to 10 mins). After washing the sections in 0.05 M TBS (3x10 min) and 10 min in 0.1 M PB the quality of the DAB reaction and the presence of intracellularly labelled cells were inspected while wet under a light microscope (x10 objective). All sections of blocks containing strongly labelled neurons underwent osmification, dehydration and resin embedding in order to retain the 3D structure of their axons and dendrites. Accordingly, sections were treated with 1% OsO4 (osmium tetroxide, PI Chem Supplies, USA) diluted in 0.1% PB for 15 minutes. After rinsing in 0.1 M PB for 3x10 min, they were dehydrated in ascending series of ethanol (50, 70, 90, 95 per cent and abs ethanol), propylene oxide, each step for 2x10 min, and submerged in resin (Durcupan, Sigma-Aldrich Chemie GmbH, Germany) overnight at room temperature. Finally, the sections were mounted on glass slides, coversliped and cured at 56 oC for 24 hours (<xref ref-type="bibr" rid="bib97">Somogyi and Freund, 1989</xref>).</p></sec><sec id="s4-1-2-4"><title>Morphological neuron reconstruction</title><p>Labelled neurons were reconstructed in 3D using the Neurolucida neuron reconstruction system running on Windows XP platform (Neurolucida v.8.23, MicroBrightField Inc, Williston, USA). For this purpose a Leica DMRB microscope (x100 objective) was coupled to a motorized XY-stage and a z-motor via a stage controller (Märzhäuser Wetzlar GmbH &amp; Co. KG, Wetzlar, Germany). Each neuron was reconstructed from 20 to 32 adjoining sections. Neighboring sections were aligned using the 3-point alignment and the least-squares algorithm for the cut ends of labelled processes and fiducial landmarks such as the contour of cut blood vessels. The cell body, dendrites, axons and axon terminals were reconstructed together with their thickness value.</p></sec></sec></sec><sec id="s4-2"><title>Morphology curation and classification</title><p>All morphological neuron reconstructions (see Reconstruction of neuron morphologies) were curated and repaired to correct reconstruction errors and slicing artifacts, as described in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>. They were then classified based on the following strategy. Both interneurons and pyramidal cells were first classified by expert reconstructors according to their observed shapes by inspection through the microscope. The expert classification of pyramidal cells, which is based on the shape of the apical dendrites, was then used as input for the training of the algorithms for the objective classification as presented in <xref ref-type="bibr" rid="bib52">Kanari et al., 2019</xref>. The objective classification was performed based on the <italic>topological morphology descriptor</italic> (TMD) (<xref ref-type="bibr" rid="bib51">Kanari et al., 2018</xref>), which encodes the branching structure of neuronal trees. The TMD of apical trees was extracted from all morphological reconstructions and was used to train different classifiers for the objective classification of cells into distinct groups. See <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref> for exemplary excitatory morphologies and their features.</p><p>The expert-proposed scheme comprised 60 morphological types (m-types) (18 excitatory and 42 inhibitory). The m-types of pyramidal cells are distinguished first by layer and further by shape of their tuft, such as untufted (UPC) and tufted (TPC) cells; and finally into subclasses (A:large tufted, B:late bifurcating, C:small tufted). The results of the objective classification of pyramidal cells were then used to validate this classification scheme. A classification scheme was deemed valid if the TMD was significantly different between classes. This was the case for classes in all layers except for a distinction between two subgroups in layer 3 (L3_TPC:A vs. L3_TPC:B), which was consequently discarded. Instead we performed an unsupervised clustering of all tufted pyramidal cells in layer 3 based on their TMD and found a different split into two classes, best described as large tufted (L3_TPC:A) and small tufted (L3_TPC:C), which we then used in the model. The resulting list of m-types is found in .</p><p>For the remaining layers, the results of the objective classification were published in a paper <xref ref-type="bibr" rid="bib53">Kanari et al., 2024</xref> describing a variety of methodologies, using TMD <xref ref-type="bibr" rid="bib51">Kanari et al., 2018</xref> in combination with advanced machine learning tools, such as <italic>Convolutional Neural Networks</italic> and <italic>Graph Neural Networks</italic>. The expert classification could be supported by a variety of methods, ranging from 60% in interneurons to 80-90% in pyramidal cells. Consequently, we considered the expert classification to be sufficiently accurate to build the model. To increase the morphological variability in the model we combined axon reconstructions with soma and dendrite reconstructions from other neurons of the same m-type (<italic>mix &amp; match</italic>; <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>).</p></sec><sec id="s4-3"><title>Preparation of cell density data</title><p>Inhibitory cell densities were constrained following <xref ref-type="bibr" rid="bib55">Keller et al., 2019</xref>. In brief, several datasets were combined to provide depth profiles of densities for successively more granular neuron classes (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). The first dataset consists of neuronal soma density estimations, using antibody stains of neuronal nuclear protein (NeuN) and <inline-formula><alternatives><mml:math id="inf32"><mml:mstyle><mml:mi>γ</mml:mi></mml:mstyle></mml:math><tex-math id="inft32">\begin{document}$  \gamma$\end{document}</tex-math></alternatives></inline-formula>-aminobutyric acid (GABA) from rat neocortex (n=6, <xref ref-type="bibr" rid="bib55">Keller et al., 2019</xref>). Cell counts provided mean densities and a measure of inter-individual variability (<xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>). Cell counts were obtained from a single rat in this dataset, and their positions were annotated and divided into 100 equal-width bins extending from the top of layer 1 (L1) to the bottom of layer 6 (L6) (<xref ref-type="bibr" rid="bib55">Keller et al., 2019</xref>). This provided depth profiles of both total neuron (from NeuN) and inhibitory neuron densities (from GABA). A similar profile was also estimated from immunostaining with calbindin (CB), calretinin (CR), neuropeptide Y (NPY), parvalbumin (PV), somatostatin (SOM) and vasoactive intestinal peptide (VIP) (at least three slices from at least two rats) (<xref ref-type="bibr" rid="bib55">Keller et al., 2019</xref>). All stains were corrected for shrinkage (<xref ref-type="bibr" rid="bib41">Ghobril, 2015</xref>). A single-neuron reverse transcription polymerase chain reaction (RT-PCR) dataset (<xref ref-type="bibr" rid="bib103">Toledo‐Rodriguez et al., 2005</xref>) allowed mapping of biochemical markers to morphological types, by finding spatial distributions of morphological cell types that would reproduce the biochemical marker distribution (<xref ref-type="bibr" rid="bib55">Keller et al., 2019</xref>). Whenever the classification could not be resolved down to morphological types (i.e., excitatory cells, neurogliaform cells, L1 cells, etc.), an estimation of the fractions of subtypes was used (<xref ref-type="bibr" rid="bib64">Muralidhar et al., 2013</xref>). The depth profile of excitatory neuron densities was further subdivided into subtypes, maintaining the same layerwise proportions of these types as in previous work (<xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>). The final output of this process was a dataset of neuron density as a function of cortical depth for each of the 60 morphological types.</p></sec><sec id="s4-4"><title>Voxelized neuronal composition</title><p>To prepare the modeled volume for cell placement, we first associated each voxel of the atlas with a cortical layer. We assumed layer boundaries to be at the same normalized depth at each point of the region. The depths, derived from <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>, are listed in <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>. As a voxel atlas of normalized depths was provided as an input, layer identities could be readily looked up from that table. Similarly, neuron densities for each voxel of the atlas were produced from the vertical density profiles that served as inputs (see Preparation of cell density data) by looking up the corresponding values using the normalized depth.</p></sec><sec id="s4-5"><title>Neuron placement</title><p>Neurons were placed into the volume by first generating soma positions and annotating them with a morphological type according to the voxelized densities generated. Next, for each location we selected a reconstructed morphology from the annotated morphological type. As previously (<xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>), we tried to select an appropriate reconstruction taking also the variability within a morphological type into account. For instance, the largest exemplars of layer 5 pyramidal cells cannot be placed close to the top of the layer, as otherwise their tuft would stick out of the top of layer 1. We selected morphologies by scoring them according to how well manually identified features, such as dendritic tufts or horizontal axonal branching, would land in the biologically appropriate layers, when placed at any given location. The placement rules that were used were the same as in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref> and are listed in <xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>.</p><p>Previously, this process was aided by the use of a simplified geometry where layer boundaries were formed by parallel planes. To execute the algorithm in a realistic brain volume, we used auxiliary voxel atlasses (see Preparation of voxelized atlases). The first atlas contained for each voxel the normalized depth of its center point, that is, a value between 0 and 1 where 0 would indicate its placement at the top of layer 1 and 1 the bottom of layer 6. The second atlas contained for each voxel the total thickness of the cortex at that location. As layer boundaries in the model were always placed at fixed normalized depths (<xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>), we could calculate the absolute distance of the voxel to any layer boundary by subtracting their normalized depths and multiplying the result with the local cortical thickness. Based on this, we calculated the overlap of the dendritic and axonal features of a candidate morphology with the target layer interval (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). Morphology selection was then performed as previously (<xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>), that is, a morphology was selected randomly from the top 10% scorers for a given position.</p></sec><sec id="s4-6"><title>Modeling synaptic connectivity</title><sec id="s4-6-1"><title>Local connectivity</title><p>To determine the structure of synaptic connectivity between neurons, data on numbers of synapses and their locations were required. Previous data for mean bouton densities on axons of various neuron types, and number of synapses per connection (<xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>), were used and generalized to all nbS1 subregions. The data was then used as described in <xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>. Similar to neuronal morphologies (see above), there is no evidence for anatomical differences in connectivity between nbS1 subregions, with the exception of barrel cortex (not included in the model).</p></sec><sec id="s4-6-2"><title>Mid-range connectivity</title><p>Due to the larger spatial scale of the present model compared to <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>, additional data was required to further constrain synaptic connectivity at a global scale. To that end, we referred to data on relative strengths of synaptic connections from the Allen Mouse Brain Connectivity Atlas (<xref ref-type="bibr" rid="bib45">Harris et al., 2019</xref>), and generalized it for use with a rat model. We began by scaling the relative connection densities of <xref ref-type="bibr" rid="bib45">Harris et al., 2019</xref> to absolute densities in units of synapses per µm<sup>3</sup>. That is, the entire voxel-to-voxel connection matrix of intra-cortical connectivity was scaled to match the average total density of synapses measured in electron microscopy (<xref ref-type="bibr" rid="bib93">Schüz and Palm, 1989</xref>).</p><p>Next, we summed the densities over voxels belonging to pairs of nbS1 subregions, resulting in a 6 x 6 connection matrix of synapse densities in pathways between and within regions. We mapped this matrix to rat nbS1 by finding corresponding regions in the mouse and rat atlases (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>). Here, we assumed that synapse densities in these pathways are comparable between mouse and rat, although the larger dimensions of the rat brain resulted in larger absolute synapse counts (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>).</p><p>We used the same mapping to generalize the spatial structure of the targeting of connections between regions from mouse to rat. This refers to the question of which specific parts of a region are innervated by individual axons in a different region. <xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref> modeled this innervation as a topographical mapping between pairs of regions in a flat view of neocortex. We used a flat map (see Preparation of voxelized atlases) to create a flat view of rat nbS1 subregions and recreated a matching topographical mapping between them as follows (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>).</p><p>First, three points were identified inside the flat view of a mouse region such that the area of the enclosed triangle is maximized. Color labels (‘red’, ‘green’ and ‘blue’) are arbitrarily assigned to the three points. Next, another three points defining a maximal area triangle were placed in the flat map of the corresponding rat region(s). The same color labels were then manually assigned to these points to best recreate their spatial context in the mouse triangle, e.g., if the point in SSp-n closest to the SSp-bfd border was labeled ‘red’, then the point in S1ULp closest to the S1BF border will also be labeled ‘red’. We then assume that any point in a rat region corresponds to the equally labeled point in the corresponding mouse region, with linear interpolation and extrapolation between points (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>). This assumption transplants the existing prediction of the topographical mapping from mouse to rat, resulting in the mapping depicted in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1D</xref>. We scaled the mapping variance by a factor of 2 to account for the larger size of S1 in our rat flatmap (160 flat units) than in the mouse flatmap (80 flat units).</p><p>Finally, we derived predictions for the relative distributions of synapse locations across cortical layers for connections between subregions. <xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref> provided predictions for all pairs of source and target regions in mouse, which we applied to the corresponding pairs of subregions of rat nbS1. That is, we assumed these layer profiles generalize to rat, albeit using the thicker cortical layers of rats (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1E1 vs E2</xref>).</p><p>These constraints were then used to build mid-range connections as described in <xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref>.</p></sec></sec><sec id="s4-7"><title>Preparation of thalamic input data</title><p>As previously described in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>, we aimed to add synaptic connections from thalamic regions to the circuit model. While they will ultimately serve as one of the controllable inputs for the simulation of in vivo-like experiments, they can also be used to predict innervation strengths in our anatomical model. Specifically, we modeled two such inputs: one ‘bottom-up’ input with a <italic>core</italic>-type laminar profile, and one ‘top-down’ input with a <italic>matrix</italic>-type laminar profile (<xref ref-type="bibr" rid="bib45">Harris et al., 2019</xref>; <xref ref-type="bibr" rid="bib44">Guo et al., 2020</xref>; <xref ref-type="bibr" rid="bib95">Shepherd and Yamawaki, 2021</xref>). To create biologically realistic thalamo-cortical projections with a meaningful distinction between core- and matrix-type inputs, we needed data on the strengths of these pathways and the laminar profiles of their synapses.</p><p>As in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>, we used data on cortical innervation by thalamic sources from <xref ref-type="bibr" rid="bib61">Meyer et al., 2010</xref>, which yielded information on the depth profiles of thalamo-cortical projections in barrel cortex. To extrapolate to non-barrel somatosensory cortex, we considered data for the VPM-S1BF pathway to be representative of core-type inputs, and generalized it to all nbS1 regions (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A1</xref>, left). Similarly, we considered data for the POm-S1BF pathway as representative of matrix-type inputs (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A2</xref>, left), and generalized it to all nbS1 regions. Since the data is reported as absolute volumetric bouton density of thalamo-cortical axons, we were able to derive the total number of synapses to place by assuming one synapse per bouton and summing over the entire innervated volume. The depth profiles for both pathways featured two clearly separated peaks. We digitized the depth profiles and split them into 10 bins per peak. Furthermore, we applied a threshold of <inline-formula><alternatives><mml:math id="inf33"><mml:mstyle><mml:mn>0.01</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math><tex-math id="inft33">\begin{document}$  0.01/\mu m^{3}$\end{document}</tex-math></alternatives></inline-formula> below which values were set to 0 (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>).</p><p>To constrain the innervation strength and targeting of individual thalamic axons, we used morphological reconstructions of thalamo-cortical projection neurons from the Janelia MouseLight project (<ext-link ext-link-type="uri" xlink:href="https://mouselight.janelia.org/">mouselight.janelia.org</ext-link>; <xref ref-type="bibr" rid="bib25">Economo et al., 2016</xref>). This is a generalization of mouse data to a rat model, made necessary by the lack of a comparable resource for rat. To parameterize core-type projections, we calculated the total axonal length in somatosensory areas of <inline-formula><alternatives><mml:math id="inf34"><mml:mstyle><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>11</mml:mn></mml:mstyle></mml:math><tex-math id="inft34">\begin{document}$  n=11$\end{document}</tex-math></alternatives></inline-formula> reconstructions with somata in VPM and axons reaching the somatosensory areas. We found lengths between 5 and 60 mm (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>) with a median of 27 mm that we combined with an assumed synapse density of 0.2/µm <xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref> to get an average number of 5400 synapses per projection fiber. To estimate the lateral spread of the area innervated by individual axons (the vertical component is covered by the layer profiles), we considered the locations of reconstructed axon segments contained within the somatosensory regions. We then fit a Gaussian to the lateral distance of the segments from their center (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>), resulting in a median value of 120 µm.</p><p>Unfortunately, the MouseLight database contained only a single neuron with its soma in the POm region and its axon reaching somatosensory areas (labeled as AA604). Visual inspection revealed that its axon mostly avoided these areas to target more medial motor-related regions. As such, to parameterize the matrix-type projections, we instead calculated the lateral spread of the single axon in the motor areas (300 µm in MOp; 172 µm in MOs; mean: 236 µm). Its total length in cortical regions was 28 mm.</p></sec><sec id="s4-8"><title>Modeling the structure of thalamo-cortical innervation</title><p>We determined the dendritic locations of thalamo-cortical input synapses as previously described in <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>, but adapted for the more complex geometry of this model. Briefly, binned depth profiles of densities of thalamo-cortical synapses were used as input (see Preparation of thalamic input data, <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4A1,A2</xref>). Next, we used the region atlas (see Preparation of voxelized atlases) to find the corresponding depth bins in the model. This allowed the identification of all dendritic sections in the model whose center point fell within a depth bin. We then performed a random selection of those sections and placed synapses at random locations on each selected section, until the prescribed number of synapses for a given depth bin was reached (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4A2</xref>). Sections were selected with probabilities proportional to their lengths and with replacement.</p><p>After all synapses for a thalamo-cortical projection had been placed, we mapped each of them to a presynaptic thalamic neuron. These neurons were not fully modeled, that is, they were not assigned a soma position or morphology, and the mapping simply allowed us to determine which synapses would be activated together. To parameterize the process, we used an estimate of the number of synapses formed by a single fiber and its horizontal spread (see Preparation of thalamic input data). We divided the total number of synapses placed (<inline-formula><alternatives><mml:math id="inf35"><mml:mstyle><mml:mn>590</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math><tex-math id="inft35">\begin{document}$  590\cdot 10^{6}$\end{document}</tex-math></alternatives></inline-formula> core-type; <inline-formula><alternatives><mml:math id="inf36"><mml:mstyle><mml:mn>380</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math><tex-math id="inft36">\begin{document}$  380\cdot 10^{6}$\end{document}</tex-math></alternatives></inline-formula> matrix-type) by the number per fiber to estimate the number of innervating fibers (approximately 100’000 for the ‘core’-type projection; 73’000 ‘matrix’-type). These numbers were split between the eight subregions according to their relative volumes (see <xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>), with the following steps being executed separately for each of them.</p><p>We then abstractly modeled thalamo-cortical afferent axons as lines entering their respective subregion at the bottom of layer 6 with a certain horizontal reach for the formation of synapses.</p><p>This was done by first randomly distributing locations (one per fiber) across the boundary of layers 4 and 5 (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4B</xref>) and then moving them 1500 µm along the negative voxel orientation (towards layer 6; <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4B</xref>, black dots). The resulting positions and orientation vectors were used as the starting position of the fibers and their directions, respectively (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4B</xref>, black arrows). The presynaptic fiber of a synapse was then determined by a stochastic process based on the horizontal reach of individual fibers around their respective location (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4B</xref>, red areas). This was parameterized as a Gaussian with a <inline-formula><alternatives><mml:math id="inf37"><mml:mstyle><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>120</mml:mn><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:mstyle></mml:math><tex-math id="inft37">\begin{document}$  \sigma=120\mu m$\end{document}</tex-math></alternatives></inline-formula> for core-type, and <inline-formula><alternatives><mml:math id="inf38"><mml:mstyle><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>235</mml:mn><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:mstyle></mml:math><tex-math id="inft38">\begin{document}$  \sigma=235\mu m$\end{document}</tex-math></alternatives></inline-formula> for matrix-type projections (see Preparation of thalamic input data). For each placed synapse, its distance to neighboring fibers was calculated and used as inputs into the Gaussian (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4D</xref>). This distance was calculated as the distance between the location of the synapse and the line defined by the fiber’s starting point and direction. The probability that any fiber was chosen as innervating fiber of the synapse was then proportional to the values (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4E</xref>).</p></sec><sec id="s4-9"><title>Estimated volume of intrinsic mid-range axons</title><p>As the model did not contain mid-range axons, we estimated their volume based on mid-range synapse counts instead. We first counted the number of mid-range synapes on dendrites inside the volume of interest. We then converted the count into a volume by assuming that an axonal segment with a length of 5.4 µm and a diameter of 0.21 µm supported each synapse. The length was based on the inverse of the mean bouton density of excitatory axons in cortex (<xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>); the diameter was the mean diameter of axons in the model. As this excludes parts of the axon not forming boutons, this is a lower bound estimate.</p></sec><sec id="s4-10"><title>Measuring local connection probabilities</title><p>Local connection probabilities of the model were measured by emulating a multi-patch clamp sampling procedure as is often employed to measure connectivity in vitro. First, a pathway to sample, that is, pre- and post-synaptic neuron types, was selected and all neurons of non-participating types were discarded. Of the remaining neurons, one was randomly selected as an initial seed. Next, eleven additional neurons were selected by repeating the following procedure: Let <inline-formula><alternatives><mml:math id="inf39"><mml:mstyle><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>s</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math><tex-math id="inft39">\begin{document}$  \mathcal{S}={s_{0},s_{1},...,s_{n}}$\end{document}</tex-math></alternatives></inline-formula> be the set of already sampled neurons and <inline-formula><alternatives><mml:math id="inf40"><mml:mstyle><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">T</mml:mi></mml:mrow></mml:mstyle></mml:math><tex-math id="inft40">\begin{document}$  \mathcal{T}$\end{document}</tex-math></alternatives></inline-formula> the remaining neurons. We calculate for all neurons <inline-formula><alternatives><mml:math id="inf41"><mml:mstyle><mml:msub><mml:mi>t</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">T</mml:mi></mml:mrow></mml:mstyle></mml:math><tex-math id="inft41">\begin{document}$  t_{i}\in\mathcal{T}$\end{document}</tex-math></alternatives></inline-formula>:<disp-formula id="equ1"><label>(1)</label><alternatives><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mtext/><mml:mtext>if</mml:mtext><mml:mtext/><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>10</mml:mn><mml:mi>μ</mml:mi><mml:mi>m</mml:mi><mml:mtext/><mml:mtext>else</mml:mtext><mml:mtext/><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:math><tex-math id="t1">\begin{document}$$\displaystyle  W_i = \prod_j\phi\left(\frac{D(t_i, s_j)}{\sigma} \right)\ \text{if}\ D(t_i, s_j) \gt 10 \mu m\ \text{else}\ 0,$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf42"><mml:mstyle><mml:mi>ϕ</mml:mi></mml:mstyle></mml:math><tex-math id="inft42">\begin{document}$  \phi$\end{document}</tex-math></alternatives></inline-formula> refers to the standard normal distribution and <inline-formula><alternatives><mml:math id="inf43"><mml:mstyle><mml:mi>D</mml:mi></mml:mstyle></mml:math><tex-math id="inft43">\begin{document}$  D$\end{document}</tex-math></alternatives></inline-formula> refers to the distance between two neuron somata in two dimensions. If the sampled pathway was intralaminar, the first dimension was orthogonal to the layer boundaries at the location of the first sampled neuron, and the second dimension was orthogonal to the first at a randomly chosen angle. If the sampled pathway was interlaminar, both dimensions were parallel to layer boundaries at the location of the first sampled neuron. The value of <inline-formula><alternatives><mml:math id="inf44"><mml:mstyle><mml:mi>σ</mml:mi></mml:mstyle></mml:math><tex-math id="inft44">\begin{document}$  \sigma$\end{document}</tex-math></alternatives></inline-formula> was set to <inline-formula><alternatives><mml:math id="inf45"><mml:mstyle><mml:mn>38.82</mml:mn></mml:mstyle></mml:math><tex-math id="inft45">\begin{document}$  38.82$\end{document}</tex-math></alternatives></inline-formula>. Then, the next sampled neuron would be randomly picked from <inline-formula><alternatives><mml:math id="inf46"><mml:mstyle><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">T</mml:mi></mml:mrow></mml:mstyle></mml:math><tex-math id="inft46">\begin{document}$  \mathcal{T}$\end{document}</tex-math></alternatives></inline-formula> with probabilities proportional to their respective <inline-formula><alternatives><mml:math id="inf47"><mml:mstyle><mml:msub><mml:mi>W</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft47">\begin{document}$  W_{i}$\end{document}</tex-math></alternatives></inline-formula>.</p><p>This roughly approximates the mainly two-dimensional sampling in slices of brain tissue while remaining comparable between intra- and interlaminar pathways. The value of <inline-formula><alternatives><mml:math id="inf48"><mml:mstyle><mml:mi>σ</mml:mi></mml:mstyle></mml:math><tex-math id="inft48">\begin{document}$  \sigma$\end{document}</tex-math></alternatives></inline-formula> was determined to yield pairs at distances below 100 µm with high probability. Specifically, this puts <inline-formula><alternatives><mml:math id="inf49"><mml:mstyle><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:mstyle></mml:math><tex-math id="inft49">\begin{document}$  D=100\mu m$\end{document}</tex-math></alternatives></inline-formula> at around 2.5 standard deviations or the 95th percentile of the normal distribution used.</p></sec><sec id="s4-11"><title>Literature sources for connection probabilities</title><p>We used the data collected in ‘Figure 4-1, XLSX file’ of <xref ref-type="bibr" rid="bib116">Zhang et al., 2019</xref>. Reported connection probability values were classified into a pathway as follows. An initial classification of source and target into excitatory or inhibitory was extracted from the column ‘Connection type’. Next, source and target layers were determined based on the columns ‘Presynaptic Type’ and ‘Postsynaptic Type’. This was straightforward, as the values were consistently formatted to list the layer first, followed by additional specification, e.g. ‘L4 FS IN’. Inhibitory types were further broken down: If ‘Presynaptic Type’ or ‘Postsynaptic Type’ specified one of ‘PV’ or ‘BC’ it was classified as ‘PV’; if it specified one of ‘SOM’, ‘MC’ or ‘DBC’ it was classified as ‘SST’; otherwise it was classified as ‘INH’.</p><p>For <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2B</xref> we used all sources where the value of ‘Species’ was either ‘rat’ or ‘mouse’. For <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2C</xref> we additionally ensured that the value of ‘Age’ was prescribed in postnatal days and the reported interval contained P14. For <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2D</xref> only sources where the value of ‘Species’ was ‘rat’ were used.</p></sec><sec id="s4-12"><title>Connection probability of L5_PCs in the MICrONS data</title><p>We analyzed the ‘minnie65_public_v117’ release of the MICrONS data (<ext-link ext-link-type="uri" xlink:href="https://www.microns-explorer.org/cortical-mm3">https://www.microns-explorer.org/cortical-mm3</ext-link>). We restricted the analysis to neurons where the proofreading status was listed as ‘clean’ or ‘extended’. We then considered neurons where the type of the ‘allen soma coarse cell class model’ was listed as ‘5 P_IT’, ‘5 P_PT’ or ‘5 P_NP’, resulting in 37 neurons. In that group, 154 pairs were within 100 µm. Of those, 13 were connected according to the ‘synapses_pni_2’ table of the data release.</p></sec><sec id="s4-13"><title>Validation of synaptic connectivity</title><p>The part of the connectome derived with a apposition-based approach (local connectivity) was constrained by anatomical data on bouton densities and mean numbers of synapses per connection for different morphological types (<xref ref-type="bibr" rid="bib83">Reimann et al., 2015</xref>). As such, we validated that the results match these data (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3A,B</xref>). As previously found, the only mismatch lied in the emerging bouton densities of Chandelier Cells. These neurons form synapses only onto the axon initial segment of other neurons, which we model by disregarding appositions on the dendrites. For two Chandelier types, this resulted in an insufficient number of appositions to fulfill bouton density constraints (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3A</xref>, black arrow).</p><p>Arguably the most important constraint is the number or density of excitatory synapses in pathways between individual subregions, as it determines the overall excitability of the model and the velocity of the spread of activity. Here, we compared the total number of excitatory synapses, that is, the union of the output of both algorithms to the data (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3C</xref>), finding a robust qualitative match. Due to the stochastic nature of the connectivity algorithms, an exact match cannot be expected.</p><p>Finally, the mid-range connectivity algorithm was further constrained by predicted topographical mapping between regions (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3D</xref>) and synapse layer profiles (Modeling synaptic connectivity), which we validated against the data.</p></sec><sec id="s4-14"><title>Validation of thalamo-cortical innervation</title><p>In silico synapse density profiles of VPM and POm projections were validated against the in vitro layer profiles from <xref ref-type="bibr" rid="bib61">Meyer et al., 2010</xref> that were used as the input recipes (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2A,B</xref>). To account for non-uniform thicknesses across regions, the depth values of the density profiles were normalized to the maximum thickness of each of the eight subregions. There is a decent match between the recipe and the actual layer profiles, but with a 15% overshoot at peak densities. This can be explained by the fact that the numbers of synapses to be placed were computed based on region bounding boxes which were larger than the actual volumes. Therefore, the actual densities are slightly higher when computing them on a voxel basis as it was done in this validation.</p></sec><sec id="s4-15"><title>Calculation of common thalamic innervation</title><p>For a given thalamo-cortical pathway we calculated the common thalamic innervation (CTI) as follows for all neurons: First, for each neuron the set of thalamic fibers innervating it with at least one synapse was identified. Next, we iterated over all pairs of neurons in the model, comparing their sets of innervating fibers. Specifically, we calculated the size of the intersection of the sets and divided it by the size of their union. The resulting CTI was a measure between 0 (no overlap) and 1 (complete overlap).</p></sec><sec id="s4-16"><title>Generation of columnar subvolumes</title><p>We partitioned the modeled volume into subvolumes with shapes approximating hexagonal prisms. To that end, we represented each voxel by the flattened location of its center. In the resulting two-dimensional coordinate system, we distributed seed points in a hexagonal grid with a distance of 460 µm (based on the 230 µm column radius of <xref ref-type="bibr" rid="bib59">Markram et al., 2015</xref>) between neighboring points. Next, for each voxel we determined to which seed point it was closest. All voxels that were closest to the same seed point were then grouped together as parts of the same subvolume. As subvolumes near the periphery of the model could be incomplete, that is, not form complete hexagonal prisms, we excluded them from further analysis if either of the following two conditions was met: (1) The subvolume had fewer than six neighbors in the hexagonal grid; (2) Its volume was less than 0.166 mm<sup>3</sup>. That threshold is based on the volume of a circular prism with a radius of 230 µm and a height of 1000 µm.</p></sec><sec id="s4-17"><title>Columnar volumes and their conicality</title><p>Columnar volumes were defined in a flat view of the model, generated as in <xref ref-type="bibr" rid="bib9">Bolaños-Puchet et al., 2024</xref>; <xref ref-type="bibr" rid="bib8">Bolaños-Puchet et al., 2023</xref>. In the two-dimensional coordinate system, we defined a hexagonal grid with a radius (large diagonal of a hexagon) as indicated in the text. Then, each voxel (38.7348 µm resolution) was associated with the hexagon that contained the flat coordinates of its central point. Thus, each hexagon defined a continuous columnar volume that sampled all cortical layers. To calculate its conicality, we first found its central vertical axis (orthogonal to layer boundaries). Then we conducted a linear fit of cortical depth against distance from the vertical axis of all voxels contained in a column. The slope of the linear fit was defined as the conicality measure.</p></sec><sec id="s4-18"><title>Generation of random connectivity control models</title><p>This section contains definitions of the random connectivity control models and explains how these were generated, presented in weakly increasing order of complexity.</p><p>The <italic>Erdős–Rényi</italic> controls (ER) are random directed networks where the edges are added with a fixed probability independently at random. The controls were constructed by taking each ordered pair of nodes <inline-formula><alternatives><mml:math id="inf50"><mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math><tex-math id="inft50">\begin{document}$  (i,j)$\end{document}</tex-math></alternatives></inline-formula> and adding an edge from <inline-formula><alternatives><mml:math id="inf51"><mml:mstyle><mml:mi>i</mml:mi></mml:mstyle></mml:math><tex-math id="inft51">\begin{document}$  i$\end{document}</tex-math></alternatives></inline-formula> to <inline-formula><alternatives><mml:math id="inf52"><mml:mstyle><mml:mi>j</mml:mi></mml:mstyle></mml:math><tex-math id="inft52">\begin{document}$  j$\end{document}</tex-math></alternatives></inline-formula> at random with probability <inline-formula><alternatives><mml:math id="inf53"><mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>E</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math><tex-math id="inft53">\begin{document}$p=\frac{E}{N(N-1)}$\end{document}</tex-math></alternatives></inline-formula>, where <inline-formula><alternatives><mml:math id="inf54"><mml:mstyle><mml:mi>E</mml:mi></mml:mstyle></mml:math><tex-math id="inft54">\begin{document}$  E$\end{document}</tex-math></alternatives></inline-formula> (respectively <inline-formula><alternatives><mml:math id="inf55"><mml:mstyle><mml:mi>N</mml:mi></mml:mstyle></mml:math><tex-math id="inft55">\begin{document}$  N$\end{document}</tex-math></alternatives></inline-formula>) is the number of edges (respectively nodes) in the original network.</p><p>The <italic>stochastic block model</italic> controls (SBM) are random networks where the edges are added independently at random with a fixed probability dependent on the m-type pathway of the pre- and post-synaptic neurons. These controls were built as for the ER-controls, but with a different probability for each pathway. More precisely, if <inline-formula><alternatives><mml:math id="inf56"><mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math><tex-math id="inft56">\begin{document}$  (i,j)$\end{document}</tex-math></alternatives></inline-formula> are two neurons of m-types <inline-formula><alternatives><mml:math id="inf57"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft57">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf58"><mml:mstyle><mml:mi>B</mml:mi></mml:mstyle></mml:math><tex-math id="inft58">\begin{document}$  B$\end{document}</tex-math></alternatives></inline-formula>, then their probability of connection is<disp-formula id="equ2"><alternatives><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="center left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if </mml:mtext><mml:mrow><mml:mi>A</mml:mi><mml:mo>≠</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mtext>,</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if </mml:mtext><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mtext>,</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t2">\begin{document}$$\displaystyle  p_{AB}=\left\lbrace\begin{array}{cl} \frac{E_{AB}}{(N_{AB})^2} &amp; \text{if $A\neq B$,}\\  \frac{E_{AA}}{(N_{AA})(N_{AA}-1)} &amp; \text{if $A=B$,}\end{array}\right.$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf59"><mml:mstyle><mml:msub><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft59">\begin{document}$  N_{AB}$\end{document}</tex-math></alternatives></inline-formula> is the number of neurons of m-type <inline-formula><alternatives><mml:math id="inf60"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft60">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf61"><mml:mstyle><mml:mi>B</mml:mi></mml:mstyle></mml:math><tex-math id="inft61">\begin{document}$  B$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf62"><mml:mstyle><mml:msub><mml:mi>E</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft62">\begin{document}$  E_{AB}$\end{document}</tex-math></alternatives></inline-formula> is the number of edges from neurons of type <inline-formula><alternatives><mml:math id="inf63"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft63">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula> to neurons of type <inline-formula><alternatives><mml:math id="inf64"><mml:mstyle><mml:mi>B</mml:mi></mml:mstyle></mml:math><tex-math id="inft64">\begin{document}$  B$\end{document}</tex-math></alternatives></inline-formula> in the original network.</p><p>The <italic>directed configuration model</italic> controls (CM) are random networks that closely approximate a given in/out-degree sequence, that is, a vector of length the number of nodes, whose entries are their in/out-degrees. To build these controls, we encode the edges of the original matrix by two vectors, <inline-formula><alternatives><mml:math id="inf65"><mml:mstyle><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mstyle></mml:math><tex-math id="inft65">\begin{document}$  sources$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf66"><mml:mstyle><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mstyle></mml:math><tex-math id="inft66">\begin{document}$  targets$\end{document}</tex-math></alternatives></inline-formula>, such that <inline-formula><alternatives><mml:math id="inf67"><mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:math><tex-math id="inft67">\begin{document}$  (sources[i],targets[i]$\end{document}</tex-math></alternatives></inline-formula>) is a directed edge of the matrix (this corresponds to a binary matrix in coordinate format, useful when working with sparse matrices). Then, we shuffle the entries of both vectors <inline-formula><alternatives><mml:math id="inf68"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft68">\begin{document}$sources$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf69"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft69">\begin{document}$ targets$\end{document}</tex-math></alternatives></inline-formula> independently, which gives a new directed network, with the same degree sequence as the original. This new network might contain loops or parallel edges, so we remove them, thus this construction only approximates the original degree sequence. The density of loops and parallel edges tends to decrease as the number of nodes increases (<xref ref-type="bibr" rid="bib67">Newman, 2003</xref>), so the approximation is good. Indeed, in our controls for local connectivity, <inline-formula><alternatives><mml:math id="inf70"><mml:mstyle><mml:mn>235</mml:mn><mml:mo>,</mml:mo><mml:mn>574.0</mml:mn><mml:mo>±</mml:mo><mml:mn>376.0</mml:mn></mml:mstyle></mml:math><tex-math id="inft70">\begin{document}$  235,574.0\pm 376.0$\end{document}</tex-math></alternatives></inline-formula> (mean ± std) connections out of <inline-formula><alternatives><mml:math id="inf71"><mml:mstyle><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>050</mml:mn><mml:mo>,</mml:mo><mml:mn>028</mml:mn><mml:mo>,</mml:mo><mml:mn>490</mml:mn></mml:mstyle></mml:math><tex-math id="inft71">\begin{document}$  2,050,028,490$\end{document}</tex-math></alternatives></inline-formula> were missing, which is less than 0.012% of all connections. For mid-range connectivity the number was <inline-formula><alternatives><mml:math id="inf72"><mml:mstyle><mml:mn>629</mml:mn><mml:mo>,</mml:mo><mml:mn>493.4</mml:mn><mml:mo>±</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>228.0</mml:mn></mml:mstyle></mml:math><tex-math id="inft72">\begin{document}$  629,493.4\pm 2,228.0$\end{document}</tex-math></alternatives></inline-formula> out of <inline-formula><alternatives><mml:math id="inf73"><mml:mstyle><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>482</mml:mn><mml:mo>,</mml:mo><mml:mn>296</mml:mn><mml:mo>,</mml:mo><mml:mn>102</mml:mn></mml:mstyle></mml:math><tex-math id="inft73">\begin{document}$  2,482,296,102$\end{document}</tex-math></alternatives></inline-formula>, which is less that 0.026% of all connections.</p><p>Finally, the distance block model controls (DBM) are random networks where the edges are added independently at random with a probability <inline-formula><alternatives><mml:math id="inf74"><mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math><tex-math id="inft74">\begin{document}$  p_{A}(d)=\alpha_{A}\cdot e^{-\beta_{A}\cdot d}$\end{document}</tex-math></alternatives></inline-formula>, that is, exponentially decreasing with distance <inline-formula><alternatives><mml:math id="inf75"><mml:mstyle><mml:mi>d</mml:mi></mml:mstyle></mml:math><tex-math id="inft75">\begin{document}$  d$\end{document}</tex-math></alternatives></inline-formula>, where <inline-formula><alternatives><mml:math id="inf76"><mml:mstyle><mml:msub><mml:mi>α</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft76">\begin{document}$  \alpha_{A}$\end{document}</tex-math></alternatives></inline-formula> is the probability at distance zero and <inline-formula><alternatives><mml:math id="inf77"><mml:mstyle><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft77">\begin{document}$  \beta_{A}$\end{document}</tex-math></alternatives></inline-formula> the decay constant, both depending only on the pre-synaptic cell m-type <inline-formula><alternatives><mml:math id="inf78"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft78">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula>. For local connectivity, the distance between a pair of neurons used was the Euclidean distance of their position in space (in µm). For mid-range connectivity, the specific method used to originally construct the connectome (<xref ref-type="bibr" rid="bib86">Reimann et al., 2019</xref>) was taken into account, preferentially connecting neurons at one location within a subregion <inline-formula><alternatives><mml:math id="inf79"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft79">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula> to neurons in another subregion <inline-formula><alternatives><mml:math id="inf80"><mml:mstyle><mml:mi>B</mml:mi></mml:mstyle></mml:math><tex-math id="inft80">\begin{document}$  B$\end{document}</tex-math></alternatives></inline-formula> by first parameterizing linear transformations of the flattened coordinates of the two regions. The resulting <italic>virtual coordinate system</italic><inline-formula><alternatives><mml:math id="inf81"><mml:mstyle><mml:msub><mml:mi>V</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft81">\begin{document}$  V_{A,B}$\end{document}</tex-math></alternatives></inline-formula> is then used to connect pairs of neurons from <inline-formula><alternatives><mml:math id="inf82"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft82">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf83"><mml:mstyle><mml:mi>B</mml:mi></mml:mstyle></mml:math><tex-math id="inft83">\begin{document}$  B$\end{document}</tex-math></alternatives></inline-formula> in a distance-dependent way. Therefore, the distance considered in this control between pairs of neurons was the Euclidean distance between these virtual coordinates.</p><p>For computational reasons, the model coefficients <inline-formula><alternatives><mml:math id="inf84"><mml:mstyle><mml:msub><mml:mi>α</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft84">\begin{document}$  \alpha_{A}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf85"><mml:mstyle><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft85">\begin{document}$  \beta_{A}$\end{document}</tex-math></alternatives></inline-formula> were estimated by randomly sub-sampling (up to) 100000 pre-synaptic neurons of m-type <inline-formula><alternatives><mml:math id="inf86"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft86">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula> and 100000 post-synaptic neurons of any type and computing their pairwise distances. For local connectivity, distances from 0 to 1000 µm were then divided into 20 evenly spaced 50 µm bins. For mid-range connectivity, distances from 0 to 400(a.u.) were divided into 20 evenly spaced 20 (a.u) bins. Connection probabilities were estimated in each bin by dividing the number of existing connections by the number of possible connections between all pairs of neurons within that bin (excluding connections at distance zero, that is, between one neuron with itself). Model coefficients were then determined by fitting the exponential probability function <inline-formula><alternatives><mml:math id="inf87"><mml:mstyle><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math><tex-math id="inft87">\begin{document}$  p(d)$\end{document}</tex-math></alternatives></inline-formula> to these data points. The whole procedure was repeated ten times with different random sub-samples of neurons, and the averaged model coefficients over these ten estimates were used to build the controls. Overall, the relative standard errors of the mean over the ten estimates were on average across all m-types less than 1%. For local connectivity, model coefficients of all 60 pre-synaptic m-types were found to be on average <inline-formula><alternatives><mml:math id="inf88"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mover><mml:mi>α</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.138</mml:mn><mml:mo>±</mml:mo><mml:mn>0.102</mml:mn><mml:mo>∼</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft88">\begin{document}$ \overline{\alpha}=0.138\pm 0.102\thicksim (SD)$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf89"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.0096</mml:mn><mml:mo>±</mml:mo><mml:mn>0.002</mml:mn><mml:mo>∼</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft89">\begin{document}$\bar{\beta}=0.0096\pm 0.002\thicksim(SD)$\end{document}</tex-math></alternatives></inline-formula> respectively. For mid-range connectivity, the model coefficients of all 18 m-types that had any outgoing mid-range connections were on average <inline-formula><alternatives><mml:math id="inf90"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mover><mml:mi>α</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.0006</mml:mn><mml:mo>±</mml:mo><mml:mn>0.001</mml:mn><mml:mo>∼</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft90">\begin{document}$\overline{\alpha}=0.0006\pm 0.001\thicksim(SD)$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf91"><mml:mstyle><mml:mrow><mml:mstyle displaystyle="false"><mml:mrow><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.012</mml:mn><mml:mo>±</mml:mo><mml:mn>0.001</mml:mn><mml:mo>∼</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="inft91">\begin{document}$\bar{\beta}=0.012\pm 0.001\thicksim(SD)$\end{document}</tex-math></alternatives></inline-formula> respectively.</p></sec><sec id="s4-19"><title>Modularity</title><p>The <italic>modularity</italic> of a network is a metric that determines to which extent it is structured by modules or communities. Intuitively, a network has high modularity if nodes within the modules are densely interconnected, while nodes of different modules are sparsely interconnected.</p><p>Formally, consider a directed network with no loops or double edges. It can be represented by a binary matrix <inline-formula><alternatives><mml:math id="inf92"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft92">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula> with zeros in the diagonal where the entry <inline-formula><alternatives><mml:math id="inf93"><mml:mstyle><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft93">\begin{document}$  A_{ij}$\end{document}</tex-math></alternatives></inline-formula> is 1 if there is an edge from <inline-formula><alternatives><mml:math id="inf94"><mml:mstyle><mml:mi>i</mml:mi></mml:mstyle></mml:math><tex-math id="inft94">\begin{document}$  i$\end{document}</tex-math></alternatives></inline-formula> to <inline-formula><alternatives><mml:math id="inf95"><mml:mstyle><mml:mi>j</mml:mi></mml:mstyle></mml:math><tex-math id="inft95">\begin{document}$  j$\end{document}</tex-math></alternatives></inline-formula> and 0 otherwise. The <italic>modularity of a partition</italic> <inline-formula><alternatives><mml:math id="inf96"><mml:mstyle><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">C</mml:mi></mml:mrow></mml:mstyle></mml:math><tex-math id="inft96">\begin{document}$  \mathcal{C}$\end{document}</tex-math></alternatives></inline-formula> of the nodes of the network into modules is given by:<disp-formula id="equ3"><alternatives><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi class="mathcal" mathvariant="script">Q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi class="mathcal" mathvariant="script">C</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>m</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t3">\begin{document}$$\displaystyle  \mathcal{Q}_{\mathcal{C}}=\sum_{i,j}\left(\frac{A_{ij}}{m}-P_{ij}\right)\delta(c_{i},c_{j}),$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf97"><mml:mstyle><mml:mi>m</mml:mi></mml:mstyle></mml:math><tex-math id="inft97">\begin{document}$  m$\end{document}</tex-math></alternatives></inline-formula> is the number of edges that is, the number of non-zero entries in <inline-formula><alternatives><mml:math id="inf98"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft98">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf99"><mml:mstyle><mml:msub><mml:mi>P</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft99">\begin{document}$  P_{ij}$\end{document}</tex-math></alternatives></inline-formula> is the probability of having an edge from <inline-formula><alternatives><mml:math id="inf100"><mml:mstyle><mml:mi>i</mml:mi></mml:mstyle></mml:math><tex-math id="inft100">\begin{document}$  i$\end{document}</tex-math></alternatives></inline-formula> to <inline-formula><alternatives><mml:math id="inf101"><mml:mstyle><mml:mi>j</mml:mi></mml:mstyle></mml:math><tex-math id="inft101">\begin{document}$  j$\end{document}</tex-math></alternatives></inline-formula> in a directed configuration model of <inline-formula><alternatives><mml:math id="inf102"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft102">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula>, and<disp-formula id="equ4"><alternatives><mml:math id="m4"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mtext> and </mml:mtext><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mtext> are in the same module,</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>otherwise.</mml:mtext></mml:mtd></mml:mtr></mml:mtable><mml:mi/></mml:mrow></mml:mrow></mml:math><tex-math id="t4">\begin{document}$$\displaystyle \delta(c_{i},c_{j})=\left\{\begin{array}[]{cl}1&amp;\text{if }i\text{ and }j\text{ are in the same module,}\\0&amp;\text{otherwise.}\end{array}\right.$$\end{document}</tex-math></alternatives></disp-formula></p><p>Thus, the function <inline-formula><alternatives><mml:math id="inf103"><mml:mstyle><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">Q</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">C</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft103">\begin{document}$  \mathcal{Q}_{\mathcal{C}}$\end{document}</tex-math></alternatives></inline-formula> contrasts the existence of an edge between two nodes in the same module with the probability that it would appear by chance. This probability is given by<disp-formula id="equ5"><alternatives><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t5">\begin{document}$$\displaystyle  P_{ij}=\frac{d_{i}^{out}d_{j}^{in}}{m^{2}},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf104"><mml:mstyle><mml:msubsup><mml:mi>d</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:math><tex-math id="inft104">\begin{document}$  d_{i}^{out},d_{j}^{in}$\end{document}</tex-math></alternatives></inline-formula> are the in- and out-degrees of the nodes <inline-formula><alternatives><mml:math id="inf105"><mml:mstyle><mml:mi>i</mml:mi></mml:mstyle></mml:math><tex-math id="inft105">\begin{document}$  i$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf106"><mml:mstyle><mml:mi>j</mml:mi></mml:mstyle></mml:math><tex-math id="inft106">\begin{document}$  j$\end{document}</tex-math></alternatives></inline-formula> respectively. The <italic>modularity of the network</italic> <inline-formula><alternatives><mml:math id="inf107"><mml:mstyle><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">Q</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft107">\begin{document}$  \mathcal{Q}_{A}$\end{document}</tex-math></alternatives></inline-formula> is the maximal value attained by <inline-formula><alternatives><mml:math id="inf108"><mml:mstyle><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">Q</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">C</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft108">\begin{document}$  \mathcal{Q}_{\mathcal{C}}$\end{document}</tex-math></alternatives></inline-formula> across all possible partitions of the nodes of <inline-formula><alternatives><mml:math id="inf109"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft109">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula>. See <xref ref-type="bibr" rid="bib68">Nicosia et al., 2009</xref> for further details. It has been shown that computing the modularity of a network is NP-complete (<xref ref-type="bibr" rid="bib12">Brandes et al., 2007</xref>), thus only heuristic approximations are possible. To approximate the modularity of each of the columns in the parcellation described in <xref ref-type="fig" rid="fig7">Figure 7</xref>, we used the Louvain algorithm for directed networks (<xref ref-type="bibr" rid="bib22">Dugué and Perez, 2015</xref>) implemented in Scikit-network (<xref ref-type="bibr" rid="bib10">Bonald et al., 2020</xref>). To control for the effect of size and density of the columns on their modularity we also computed the modularity of corresponding ER-controls.</p><p>Note that the output of the Louvain algorithm is not deterministic. To further asses the its effect on the modularity approximation we focused on the columns with high modularity values that is, those with modularity values higher than 0.4. For each of these columns, we recomputed the modularity of a subnetwork obtained by subsampling 50% of the nodes at random. We computed the modularity of the subnetwork with respect to two partitions: First, where the modules are inherited from the modules determined by the Louvain algorithm in the full column, we called these the <italic>original labels</italic>. Second, by re-running the Louvain algorithm from scratch on the subcolumn and thus determining new modules of the subnetwork, we called these the <italic>new labels</italic>. We repeated this procedure for 50 different random samples for each column and contrasted the distribution of the modularity values obtained in both modalities as well as those obtained for the full column.</p></sec><sec id="s4-20"><title>Node participation and simplicial core</title><p>For any given node in a directed network, its <italic>node participation</italic> is the number of simplices that it is part of. This value can be further split by dimension, giving rise to the notion of <inline-formula><alternatives><mml:math id="inf110"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft110">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula>-node participation. Given that any directed simplex has a single source and a single target, node participation can be further refined to participation as a source or participation as a sink. For <inline-formula><alternatives><mml:math id="inf111"><mml:mstyle><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math><tex-math id="inft111">\begin{document}$  n=1$\end{document}</tex-math></alternatives></inline-formula>, source node participation is equivalent to out-degree, sink node participation is equivalent to in-degree and node participation is equivalent to the total degree (i.e., the sum of in- and out-degrees). Thus, node participation can be thought of as a higher dimensional version of degree. The <inline-formula><alternatives><mml:math id="inf112"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft112">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula>-<italic>simplicial core</italic> of a network is the sub-network on the nodes that participate in simplices of dimension <inline-formula><alternatives><mml:math id="inf113"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft113">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula> or higher, or equivalently on the nodes whose <inline-formula><alternatives><mml:math id="inf114"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft114">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula>-node participation is greater than 0. The <italic>simplicial core</italic> is the sub-network on the nodes that participate in simplices of maximal dimension. These concepts are a generalization of the notion of core of a network, which is a notion that is solely based on degree, by taking into account higher order interactions. We refer to the (<inline-formula><alternatives><mml:math id="inf115"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft115">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula>-) simplicial core of the local/mid-range network as the (<inline-formula><alternatives><mml:math id="inf116"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft116">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula>-)<italic>local/mid-range core</italic>, and we refer to the union of both as <italic>the core</italic>.</p></sec><sec id="s4-21"><title>Finding and counting simplices in connectivity networks</title><p>Directed simplices were computed using the custom-made C++ package flagser-count. This code is a variation of the flagser package (<xref ref-type="bibr" rid="bib57">Lütgehetmann et al., 2020</xref>). The code takes as input the adjacency matrix of a directed network in compressed sparse row (or column) format, outputs the number of directed cliques in the network, and includes the option to print all simplices. There is also the option to output node participation, so for every node <inline-formula><alternatives><mml:math id="inf117"><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle></mml:math><tex-math id="inft117">\begin{document}$  v$\end{document}</tex-math></alternatives></inline-formula> and every dimension <inline-formula><alternatives><mml:math id="inf118"><mml:mstyle><mml:mi>d</mml:mi></mml:mstyle></mml:math><tex-math id="inft118">\begin{document}$  d$\end{document}</tex-math></alternatives></inline-formula> a value is given for the number of <inline-formula><alternatives><mml:math id="inf119"><mml:mstyle><mml:mi>d</mml:mi></mml:mstyle></mml:math><tex-math id="inft119">\begin{document}$  d$\end{document}</tex-math></alternatives></inline-formula>-simplices that contain <inline-formula><alternatives><mml:math id="inf120"><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle></mml:math><tex-math id="inft120">\begin{document}$  v$\end{document}</tex-math></alternatives></inline-formula>. The algorithm considers each node independently as a source node and then performs a depth-first search on that node to find all simplices, where at each step it creates a new simplex by adding any node that is an out-neighbor of all nodes in the current simplex.</p><p>Since each source node is considered independently, the computations can be easily parallelized. The simplex count computations were conducted on the Blue Brain high performance computing system. Each computation was run on two Intel Xeon Gold 6248 CPUs using a total of 40 physical cores. To compute the simplex counts for the local network took 3 hours and 15 minutes using 8.2 GB of memory, the mid-range network took 14 hours and 44 minutes using 9.8 GB of memory and the combined network took 115 days and 20 hours using 69.5 GB of memory. The transpose adjacency matrices of the mid-range and combined networks were used, which have the same simplex counts, because these were significantly faster to compute due to the degree distributions. The computation for the combined network was attempted on the non-transposed matrix and ran for 121 days, and computed partial counts, but encountered 898 nodes for which the counts could not be computed within 24 hours, such nodes were deemed too computational expensive and skipped.</p></sec><sec id="s4-22"><title>Rich-club and generalized rich-club</title><p>The <inline-formula><alternatives><mml:math id="inf121"><mml:mstyle><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft121">\begin{document}$  k$\end{document}</tex-math></alternatives></inline-formula><italic>-rich-club coefficient</italic> of an undirected network is the density of the subnetwork on the nodes of degree greater than <inline-formula><alternatives><mml:math id="inf122"><mml:mstyle><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft122">\begin{document}$  k$\end{document}</tex-math></alternatives></inline-formula>, and is given by the formula<disp-formula id="equ6"><alternatives><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t6">\begin{document}$$\displaystyle  \phi(k)=\frac{2E_{ \gt k}}{N_{ \gt k}(N_{ \gt k}-1)},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf123"><mml:mstyle><mml:msub><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft123">\begin{document}$  N_{ \gt k}$\end{document}</tex-math></alternatives></inline-formula> is the number of nodes of degree greater than <inline-formula><alternatives><mml:math id="inf124"><mml:mstyle><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft124">\begin{document}$  k$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="inf125"><mml:mstyle><mml:msub><mml:mi>E</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft125">\begin{document}$  E_{ \gt k}$\end{document}</tex-math></alternatives></inline-formula> is the number of edges between the nodes in <inline-formula><alternatives><mml:math id="inf126"><mml:mstyle><mml:msub><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft126">\begin{document}$  N_{ \gt k}$\end{document}</tex-math></alternatives></inline-formula>. We call the function <inline-formula><alternatives><mml:math id="inf127"><mml:mstyle><mml:mi>ϕ</mml:mi></mml:mstyle></mml:math><tex-math id="inft127">\begin{document}$  \phi$\end{document}</tex-math></alternatives></inline-formula> the <italic>rich-club curve</italic>. For a directed network we obtain three variations of this curve depending on whether we consider in-degree, out-degree, or total-degree (the sum of in- and out-degree), and we remove the coefficient 2 due to the fact that the maximum number of edges is now <inline-formula><alternatives><mml:math id="inf128"><mml:mstyle><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math><tex-math id="inft128">\begin{document}$  N(N-1)$\end{document}</tex-math></alternatives></inline-formula> instead of <inline-formula><alternatives><mml:math id="inf129"><mml:mstyle><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:math><tex-math id="inft129">\begin{document}$  N(N-1)/2$\end{document}</tex-math></alternatives></inline-formula>. This gives us three formulas<disp-formula id="equ7"><label>(2)</label><alternatives><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>E</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="10pt"/><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>E</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="10pt"/><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>E</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:math><tex-math id="t7">\begin{document}$$\displaystyle  \phi^{total}(k)=\frac{E^{total}_{ \gt k}}{N^{total}_{ \gt k}(N^{total}_{ \gt k}-1)},\hspace{10pt}\phi^{in}(k)=\frac{E^{in}_{ \gt k}}{N^{in}_{ \gt k}(N^{in}_{ \gt k}-1)},\hspace{10pt}\phi^{out}(k)=\frac{E^{out}_{ \gt k}}{N^{out}_{ \gt k}(N^{out}_{ \gt k}-1)},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf130"><mml:mstyle><mml:msubsup><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:math><tex-math id="inft130">\begin{document}$  N^{total}_{ \gt k}$\end{document}</tex-math></alternatives></inline-formula> (resp. <inline-formula><alternatives><mml:math id="inf131"><mml:mstyle><mml:msubsup><mml:mi>E</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:math><tex-math id="inft131">\begin{document}$  E^{total}_{ \gt k}$\end{document}</tex-math></alternatives></inline-formula>) is equivalent to <inline-formula><alternatives><mml:math id="inf132"><mml:mstyle><mml:msub><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft132">\begin{document}$  N_{ \gt k}$\end{document}</tex-math></alternatives></inline-formula> (resp. <inline-formula><alternatives><mml:math id="inf133"><mml:mstyle><mml:msub><mml:mi>E</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft133">\begin{document}$  E_{ \gt k}$\end{document}</tex-math></alternatives></inline-formula>) but restricted to the total degree, and similarly for in and out.</p><p>The rich-club coefficient can be naturally generalized by replacing the degree with any network metric (<xref ref-type="bibr" rid="bib71">Opsahl et al., 2008</xref>). In particular, we define the <italic>simplicial rich-club coefficient</italic> by<disp-formula id="equ8"><label>(3)</label><alternatives><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>E</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:math><tex-math id="t8">\begin{document}$$\displaystyle  \phi^d(k)=\frac{E^d_{ \gt k}}{N^d_{ \gt k}(N^d_{ \gt k}-1)},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf134"><mml:mstyle><mml:msubsup><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:math><tex-math id="inft134">\begin{document}$  N^{d}_{ \gt k}$\end{document}</tex-math></alternatives></inline-formula> is the number of nodes with <inline-formula><alternatives><mml:math id="inf135"><mml:mstyle><mml:mi>d</mml:mi></mml:mstyle></mml:math><tex-math id="inft135">\begin{document}$  d$\end{document}</tex-math></alternatives></inline-formula>-node participation at least <inline-formula><alternatives><mml:math id="inf136"><mml:mstyle><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft136">\begin{document}$  k$\end{document}</tex-math></alternatives></inline-formula>, and <inline-formula><alternatives><mml:math id="inf137"><mml:mstyle><mml:msubsup><mml:mi>E</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:math><tex-math id="inft137">\begin{document}$  E^{d}_{ \gt k}$\end{document}</tex-math></alternatives></inline-formula> is the number of edges between them. Note that <inline-formula><alternatives><mml:math id="inf138"><mml:mstyle><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math><tex-math id="inft138">\begin{document}$  \phi^{1}=\phi^{total}$\end{document}</tex-math></alternatives></inline-formula> since a 1-simplex is simply an edge of the network.</p><p>A large rich-club coefficient value is said to indicate a preference of high degree nodes to connect together. However, it is shown in <xref ref-type="bibr" rid="bib16">Colizza et al., 2006</xref> that the rich-club coefficient is increasing even in Erdős–Rényi networks, and is actually a consequence of higher degree nodes naturally being more likely to connect. Therefore, it is important to normalize the rich-club coefficient by dividing by the rich-club of an appropriate control, that is, a control with the same degree distribution such as a configuration model, see Generation of random connectivity control models. Hence we define the <italic>normalized rich-club coefficient</italic> as<disp-formula id="equ9"><label>(4)</label><alternatives><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t9">\begin{document}$$\displaystyle  \rho^{total}(k)=\frac{\phi^{total}(k)}{\phi_{rand}^{total}(k)},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf139"><mml:mstyle><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math><tex-math id="inft139">\begin{document}$  \phi_{rand}^{total}(k)$\end{document}</tex-math></alternatives></inline-formula> is the rich-club coefficient of a configuration model control of the original network, and we similarly define <inline-formula><alternatives><mml:math id="inf140"><mml:mstyle><mml:msup><mml:mi>ρ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math><tex-math id="inft140">\begin{document}$  \rho^{in}(k)$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf141"><mml:mstyle><mml:msup><mml:mi>ρ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math><tex-math id="inft141">\begin{document}$  \rho^{out}(k)$\end{document}</tex-math></alternatives></inline-formula>. A network is said to have a <italic>rich-club effect</italic> if <inline-formula><alternatives><mml:math id="inf142"><mml:mstyle><mml:msup><mml:mi>ρ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math><tex-math id="inft142">\begin{document}$  \rho^{total}(k) \gt 1$\end{document}</tex-math></alternatives></inline-formula>, as this indicates the high degree nodes connect together more than is ‘expected’. The importance of this normalization can be seen in <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>, where B1 seems to indicate the presence of a rich-club effect for the mid-range network, which disappears when normalized in B2.</p><p>Normalizing the simplicial rich-club is difficult as it requires a control model on directed flag complexes that fixes node participation. Randomly sampling simplicial complexes with fixed simplex counts or other high dimensional network properties is an active area of research (<xref ref-type="bibr" rid="bib50">Kahle, 2014</xref>; <xref ref-type="bibr" rid="bib114">Young et al., 2017</xref>; <xref ref-type="bibr" rid="bib107">Unger and Krebs, 2024</xref>), but as of yet there is no known appropriate control model for the simplicial rich-club, and it is a topic that warrants further investigation.</p></sec><sec id="s4-23"><title>Paths and path distances</title><p>Let <inline-formula><alternatives><mml:math id="inf143"><mml:mstyle><mml:mi>G</mml:mi></mml:mstyle></mml:math><tex-math id="inft143">\begin{document}$  G$\end{document}</tex-math></alternatives></inline-formula> be a directed network on <inline-formula><alternatives><mml:math id="inf144"><mml:mstyle><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft144">\begin{document}$  n$\end{document}</tex-math></alternatives></inline-formula> nodes, with adjacency matrix <inline-formula><alternatives><mml:math id="inf145"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft145">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula>. A <italic>path</italic> of length <inline-formula><alternatives><mml:math id="inf146"><mml:mstyle><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft146">\begin{document}$  k$\end{document}</tex-math></alternatives></inline-formula> (or <inline-formula><alternatives><mml:math id="inf147"><mml:mstyle><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft147">\begin{document}$  k$\end{document}</tex-math></alternatives></inline-formula>-path) from node <inline-formula><alternatives><mml:math id="inf148"><mml:mstyle><mml:mi>u</mml:mi></mml:mstyle></mml:math><tex-math id="inft148">\begin{document}$  u$\end{document}</tex-math></alternatives></inline-formula> to node <inline-formula><alternatives><mml:math id="inf149"><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle></mml:math><tex-math id="inft149">\begin{document}$  v$\end{document}</tex-math></alternatives></inline-formula> is a sequence of nodes <inline-formula><alternatives><mml:math id="inf150"><mml:mstyle><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>v</mml:mi></mml:mstyle></mml:math><tex-math id="inft150">\begin{document}$  u=x_{1},\ldots,x_{k+1}=v$\end{document}</tex-math></alternatives></inline-formula> such that <inline-formula><alternatives><mml:math id="inf151"><mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math><tex-math id="inft151">\begin{document}$  (x_{i},x_{i+1})$\end{document}</tex-math></alternatives></inline-formula> is an edge of <inline-formula><alternatives><mml:math id="inf152"><mml:mstyle><mml:mi>G</mml:mi></mml:mstyle></mml:math><tex-math id="inft152">\begin{document}$  G$\end{document}</tex-math></alternatives></inline-formula> for all <inline-formula><alternatives><mml:math id="inf153"><mml:mstyle><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft153">\begin{document}$  i=1,\ldots,k$\end{document}</tex-math></alternatives></inline-formula>. The <italic>path distance</italic> between <inline-formula><alternatives><mml:math id="inf154"><mml:mstyle><mml:mi>u</mml:mi></mml:mstyle></mml:math><tex-math id="inft154">\begin{document}$  u$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf155"><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle></mml:math><tex-math id="inft155">\begin{document}$  v$\end{document}</tex-math></alternatives></inline-formula> is the length of the shortest path from <inline-formula><alternatives><mml:math id="inf156"><mml:mstyle><mml:mi>u</mml:mi></mml:mstyle></mml:math><tex-math id="inft156">\begin{document}$  u$\end{document}</tex-math></alternatives></inline-formula> to <inline-formula><alternatives><mml:math id="inf157"><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle></mml:math><tex-math id="inft157">\begin{document}$  v$\end{document}</tex-math></alternatives></inline-formula>. A path from <inline-formula><alternatives><mml:math id="inf158"><mml:mstyle><mml:mi>u</mml:mi></mml:mstyle></mml:math><tex-math id="inft158">\begin{document}$  u$\end{document}</tex-math></alternatives></inline-formula> to <inline-formula><alternatives><mml:math id="inf159"><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle></mml:math><tex-math id="inft159">\begin{document}$  v$\end{document}</tex-math></alternatives></inline-formula> is <italic>geodesic</italic> if its length is the path distance from <inline-formula><alternatives><mml:math id="inf160"><mml:mstyle><mml:mi>u</mml:mi></mml:mstyle></mml:math><tex-math id="inft160">\begin{document}$  u$\end{document}</tex-math></alternatives></inline-formula> to <inline-formula><alternatives><mml:math id="inf161"><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle></mml:math><tex-math id="inft161">\begin{document}$  v$\end{document}</tex-math></alternatives></inline-formula>.</p><p>The number of <inline-formula><alternatives><mml:math id="inf162"><mml:mstyle><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft162">\begin{document}$  k$\end{document}</tex-math></alternatives></inline-formula>-paths between all nodes in <inline-formula><alternatives><mml:math id="inf163"><mml:mstyle><mml:mi>G</mml:mi></mml:mstyle></mml:math><tex-math id="inft163">\begin{document}$  G$\end{document}</tex-math></alternatives></inline-formula> can be easily computed using matrix multiplication, since the number of <inline-formula><alternatives><mml:math id="inf164"><mml:mstyle><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft164">\begin{document}$  k$\end{document}</tex-math></alternatives></inline-formula>-paths between <inline-formula><alternatives><mml:math id="inf165"><mml:mstyle><mml:mi>u</mml:mi></mml:mstyle></mml:math><tex-math id="inft165">\begin{document}$  u$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf166"><mml:mstyle><mml:mi>v</mml:mi></mml:mstyle></mml:math><tex-math id="inft166">\begin{document}$  v$\end{document}</tex-math></alternatives></inline-formula> is given by <inline-formula><alternatives><mml:math id="inf167"><mml:mstyle><mml:msubsup><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:math><tex-math id="inft167">\begin{document}$  A^{k}_{u,v}$\end{document}</tex-math></alternatives></inline-formula>, where <inline-formula><alternatives><mml:math id="inf168"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft168">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula> is the adjacency matrix of <inline-formula><alternatives><mml:math id="inf169"><mml:mstyle><mml:mi>G</mml:mi></mml:mstyle></mml:math><tex-math id="inft169">\begin{document}$  G$\end{document}</tex-math></alternatives></inline-formula> (<xref ref-type="bibr" rid="bib21">Diestel, 2005</xref>). Consequently, the number of <inline-formula><alternatives><mml:math id="inf170"><mml:mstyle><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft170">\begin{document}$  k$\end{document}</tex-math></alternatives></inline-formula>-paths from the nodes <inline-formula><alternatives><mml:math id="inf171"><mml:mstyle><mml:msub><mml:mi>i</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft171">\begin{document}$  i_{1},\ldots,i_{t}$\end{document}</tex-math></alternatives></inline-formula> to all other nodes in <inline-formula><alternatives><mml:math id="inf172"><mml:mstyle><mml:mi>G</mml:mi></mml:mstyle></mml:math><tex-math id="inft172">\begin{document}$  G$\end{document}</tex-math></alternatives></inline-formula> is given by<disp-formula id="equ10"><alternatives><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>A</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t10">\begin{document}$$\displaystyle  A^{k}_{[i_{1},\ldots,i_{t}]}=A_{[i_{1},\ldots,i_{t}]}A^{k-1}=A_{[i_{1},\ldots,i_{t}]}^{k-1}A,$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf173"><mml:mstyle><mml:msub><mml:mi>A</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft173">\begin{document}$  A_{[i_{1},\ldots,i_{t}]}$\end{document}</tex-math></alternatives></inline-formula> is the <inline-formula><alternatives><mml:math id="inf174"><mml:mstyle><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mstyle></mml:math><tex-math id="inft174">\begin{document}$  t\times n$\end{document}</tex-math></alternatives></inline-formula> matrix obtained from <inline-formula><alternatives><mml:math id="inf175"><mml:mstyle><mml:mi>A</mml:mi></mml:mstyle></mml:math><tex-math id="inft175">\begin{document}$  A$\end{document}</tex-math></alternatives></inline-formula> by taking only the rows <inline-formula><alternatives><mml:math id="inf176"><mml:mstyle><mml:msub><mml:mi>i</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft176">\begin{document}$  i_{1},\ldots,i_{t}$\end{document}</tex-math></alternatives></inline-formula>. Note that the smallest <inline-formula><alternatives><mml:math id="inf177"><mml:mstyle><mml:mi>k</mml:mi></mml:mstyle></mml:math><tex-math id="inft177">\begin{document}$  k$\end{document}</tex-math></alternatives></inline-formula> for which entry <inline-formula><alternatives><mml:math id="inf178"><mml:mstyle><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mstyle></mml:math><tex-math id="inft178">\begin{document}$  i,j$\end{document}</tex-math></alternatives></inline-formula> is nonzero is the path distance from <inline-formula><alternatives><mml:math id="inf179"><mml:mstyle><mml:mi>i</mml:mi></mml:mstyle></mml:math><tex-math id="inft179">\begin{document}$  i$\end{document}</tex-math></alternatives></inline-formula> to <inline-formula><alternatives><mml:math id="inf180"><mml:mstyle><mml:mi>j</mml:mi></mml:mstyle></mml:math><tex-math id="inft180">\begin{document}$  j$\end{document}</tex-math></alternatives></inline-formula>.</p><p>Using this approach, we were able to compute the path distances in the combined network between pairs of all 396 nodes in the local and mid-range cores. We ran the computation in parallel by partitioning the nodes into 13 sets <inline-formula><alternatives><mml:math id="inf181"><mml:mstyle><mml:msub><mml:mi>C</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>13</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft181">\begin{document}$  C_{1},\ldots,C_{13}$\end{document}</tex-math></alternatives></inline-formula> of approximately 23 nodes each and computing<disp-formula id="equ11"><alternatives><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>…</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>A</mml:mi><mml:mo>…</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t11">\begin{document}$$\displaystyle  A^{k}_{[C_{i}]}=(\ldots(A_{[C_{i}]}\underbrace{A)A\ldots A}_{\times k-1}).$$\end{document}</tex-math></alternatives></disp-formula></p><p>Note that the order of the brackets ensures that at each step a <inline-formula><alternatives><mml:math id="inf182"><mml:mstyle><mml:mn>23</mml:mn><mml:mo>×</mml:mo><mml:mn>4234929</mml:mn></mml:mstyle></mml:math><tex-math id="inft182">\begin{document}$  23\times 4234929$\end{document}</tex-math></alternatives></inline-formula> matrix is computed, rather than a <inline-formula><alternatives><mml:math id="inf183"><mml:mstyle><mml:mn>4234929</mml:mn><mml:mo>×</mml:mo><mml:mn>4234929</mml:mn></mml:mstyle></mml:math><tex-math id="inft183">\begin{document}$  4234929\times 4234929$\end{document}</tex-math></alternatives></inline-formula> matrix.</p><p>Once we had the path distances between the nodes in the local and mid-range cores, we computed the geodesic paths between them. This was done using the custom C++ package pathfinder. This code functions in a similar way to flagser-count, except that at each step it creates a new path by considering any node that is an out-neighbor of the final node in the current path. At input the start-nodes, end-nodes, and path distances can be specified. To compute all geodesic paths of length at most three between nodes within the local and mid-range cores took 8 hr and 47 min, using 51.9 GB of memory. Between these 396 nodes there are 6,383 geodesic 1-paths, 1,039,814 geodesic 2-paths, and 21,701,345 geodesic 3-paths. To compute all geodesic 4-paths was attempted, but after running for 24 hr failed to finish, and is likely to be computationally infeasible due to the exponential growth of the number of paths.</p></sec><sec id="s4-24"><title>Generation of EM-like volumes</title><p>We emulated the specificities of the electron microscopic studies of <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref> and <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref> as follows. First, in <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref> the fragments of axons and dendrites inside a volume are reconstructed as well as their synaptic connections. Then, axon and dendrite fragments with at least 10 synapses inside the volume are considered for analysis. In the model, we began by loading the three-dimensional locations of all synapses between neurons in a 100 µm columnar volume. Next, we determined which synapses are contained in a box-shaped subvolume at the top of layer 4 of the model. The size of the box was determined to contain the same number of synapses (approximately 145,000) as the volume of <xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref>. This was achieved at <inline-formula><alternatives><mml:math id="inf184"><mml:mstyle><mml:mn>110</mml:mn><mml:mi>x</mml:mi><mml:mn>110</mml:mn><mml:mi>x</mml:mi><mml:mn>85</mml:mn><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:mstyle></mml:math><tex-math id="inft184">\begin{document}$  110x110x85\mu m$\end{document}</tex-math></alternatives></inline-formula>, about twice as large as the reference volume, as it does not contain synapses extrinsic to the model (also we do not know to what degree the dimensions of the reference volume were corrected for shrinkage). We then determined the types of postsynaptic compartments. Synapses onto somata and axon initial segments were labeled as such; of the rest, if the soma of the targeted neuron was inside the box volume, it was tagged as proximal dendrite; of the rest, if the targeted neuron was inhibitory, it was tagged as smooth dendrite; remaining synapses onto apical dendrites were tagged as such; all others were tagged ‘other’. We applied the same filtering as the reference, removing axons, dendrites (and their synapses) with less than 10 synaptic contacts.</p><p>On the other hand, <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref> determined which neurons had their somata inside a volume, and then reconstructed their entire dendritic and axonal trees, even parts outside the volume. The volume sampled all layers and was approximately <inline-formula><alternatives><mml:math id="inf185"><mml:mstyle><mml:mn>100</mml:mn><mml:mi>x</mml:mi><mml:mn>100</mml:mn><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:mstyle></mml:math><tex-math id="inft185">\begin{document}$  100x100\mu m$\end{document}</tex-math></alternatives></inline-formula> wide, but was not exactly box-shaped, as it followed the main direction of contained apical dendrites. We emulated this by defining a subvolume in flat mapped coordinates (<xref ref-type="bibr" rid="bib9">Bolaños-Puchet et al., 2024</xref>; <xref ref-type="bibr" rid="bib8">Bolaños-Puchet et al., 2023</xref>): We considered all neurons whose flattened coordinates were inside a <inline-formula><alternatives><mml:math id="inf186"><mml:mstyle><mml:mn>100</mml:mn><mml:mi>x</mml:mi><mml:mn>100</mml:mn><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:mstyle></mml:math><tex-math id="inft186">\begin{document}$  100x100\mu m$\end{document}</tex-math></alternatives></inline-formula> square. As the flat map flattens away the vertical dimension along which apical dendrites are oriented in the model, this corresponded to the the sampling of <xref ref-type="bibr" rid="bib91">Schneider-Mizell et al., 2024</xref>. Then, all synaptic connections between the sampled neurons were analyzed as in the reference.</p></sec><sec id="s4-25"><title>Binomial ‘first hit’ model</title><p>Control models to compare the distributions of postsynaptic compartments against were generated as described in the reference (<xref ref-type="bibr" rid="bib63">Motta et al., 2019</xref>). The binomial model assumes that each synapse of an axon is formed with a fixed probability <inline-formula><alternatives><mml:math id="inf187"><mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft187">\begin{document}$  p_{type}$\end{document}</tex-math></alternatives></inline-formula> onto a given postsynaptic compartment type, hence the expected distribution of the number of synapses onto that type is a binomial one. A binomial model is fitted for each combination of axon type (excitatory vs. inhibitory) and postsynaptic compartment type as follows. For all axon fragments of the given type, we consider the total number of synapses formed and whether it forms at least one synapse onto the given compartment type. For a given axon fragment, the likelihood of the observation is <inline-formula><alternatives><mml:math id="inf188"><mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mstyle></mml:math><tex-math id="inft188">\begin{document}$  (1-p_{type})^{n_{axon}}$\end{document}</tex-math></alternatives></inline-formula> if no synapse onto the type is observed and <inline-formula><alternatives><mml:math id="inf189"><mml:mstyle><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mstyle></mml:math><tex-math id="inft189">\begin{document}$  1-(1-p_{type})^{n_{axon}}$\end{document}</tex-math></alternatives></inline-formula> otherwise, where <inline-formula><alternatives><mml:math id="inf190"><mml:mstyle><mml:msub><mml:mi>n</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft190">\begin{document}$  n_{axon}$\end{document}</tex-math></alternatives></inline-formula> is the number of synapses of the axon fragment in the volume. Then, <inline-formula><alternatives><mml:math id="inf191"><mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math><tex-math id="inft191">\begin{document}$  p_{type}$\end{document}</tex-math></alternatives></inline-formula> is estimated by maximizing the joint likelihood of all observations, that is, over all axons of the given type.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, eLife</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Supervision, Validation, Investigation, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Formal analysis, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Resources, Software, Supervision</p></fn><fn fn-type="con" id="con4"><p>Formal analysis, Investigation, Visualization, Methodology, Writing – original draft</p></fn><fn fn-type="con" id="con5"><p>Software, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Software</p></fn><fn fn-type="con" id="con7"><p>Software</p></fn><fn fn-type="con" id="con8"><p>Software</p></fn><fn fn-type="con" id="con9"><p>Software</p></fn><fn fn-type="con" id="con10"><p>Software, Validation</p></fn><fn fn-type="con" id="con11"><p>Validation</p></fn><fn fn-type="con" id="con12"><p>Software, Formal analysis, Validation, Visualization, Writing – review and editing</p></fn><fn fn-type="con" id="con13"><p>Visualization</p></fn><fn fn-type="con" id="con14"><p>Software</p></fn><fn fn-type="con" id="con15"><p>Software, Validation</p></fn><fn fn-type="con" id="con16"><p>Software</p></fn><fn fn-type="con" id="con17"><p>Writing – review and editing</p></fn><fn fn-type="con" id="con18"><p>Data curation, Formal analysis, Validation, Visualization, Methodology, Writing – original draft</p></fn><fn fn-type="con" id="con19"><p>Data curation, Methodology, Writing – original draft</p></fn><fn fn-type="con" id="con20"><p>Resources, Software, Supervision</p></fn><fn fn-type="con" id="con21"><p>Resources, Software</p></fn><fn fn-type="con" id="con22"><p>Project administration</p></fn><fn fn-type="con" id="con23"><p>Software, Visualization, Methodology</p></fn><fn fn-type="con" id="con24"><p>Data curation, Software</p></fn><fn fn-type="con" id="con25"><p>Methodology</p></fn><fn fn-type="con" id="con26"><p>Resources, Software</p></fn><fn fn-type="con" id="con27"><p>Project administration</p></fn><fn fn-type="con" id="con28"><p>Validation, Visualization, Writing – original draft</p></fn><fn fn-type="con" id="con29"><p>Software</p></fn><fn fn-type="con" id="con30"><p>Supervision, Methodology, Project administration</p></fn><fn fn-type="con" id="con31"><p>Data curation</p></fn><fn fn-type="con" id="con32"><p>Software, Investigation, Methodology, Writing – original draft</p></fn><fn fn-type="con" id="con33"><p>Software, Validation</p></fn><fn fn-type="con" id="con34"><p>Investigation, Writing – original draft</p></fn><fn fn-type="con" id="con35"><p>Validation, Methodology</p></fn><fn fn-type="con" id="con36"><p>Software</p></fn><fn fn-type="con" id="con37"><p>Software</p></fn><fn fn-type="con" id="con38"><p>Supervision, Methodology, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con39"><p>Supervision, Methodology, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con40"><p>Resources, Supervision, Project administration</p></fn><fn fn-type="con" id="con41"><p>Conceptualization</p></fn><fn fn-type="con" id="con42"><p>Conceptualization, Supervision, Funding acquisition, Project administration</p></fn><fn fn-type="con" id="con43"><p>Conceptualization, Supervision, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Approval of Local Ethics Committee for Animal Research Studies at the University of Debrecen in line with European Union guidelines for the care of laboratory animals, Directive 2010/63/EU.</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Descriptions of indvidual validations and their results.</title></caption><media xlink:href="elife-99688-supp1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>List of assumptions made in model building.</title></caption><media xlink:href="elife-99688-supp2-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 4.</label><caption><title>List of predictions made and experiments to test them.</title></caption><media xlink:href="elife-99688-supp3-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 5.</label><caption><title>Normalized depths used for layer boundaries.</title></caption><media xlink:href="elife-99688-supp4-v1.csv" mimetype="application" mime-subtype="octet-stream"/></supplementary-material><supplementary-material id="supp5"><label>Supplementary file 6.</label><caption><title>Placement features used for modeling.</title><p>The right column denotes the vertical target interval by specifying a layer and a relative offset within the layer, with 0.0 indication the bottom and 1.0 the top of the layer.</p></caption><media xlink:href="elife-99688-supp5-v1.csv" mimetype="application" mime-subtype="octet-stream"/></supplementary-material><supplementary-material id="supp6"><label>Supplementary file 7.</label><caption><title>Number of thalamic fibers providing inputs to the model and each of its subregions.</title></caption><media xlink:href="elife-99688-supp6-v1.csv" mimetype="application" mime-subtype="octet-stream"/></supplementary-material><supplementary-material id="supp7"><label>Supplementary file 9.</label><caption><title>Morphological types (m-types) used in the model.</title></caption><media xlink:href="elife-99688-supp7-v1.csv" mimetype="application" mime-subtype="octet-stream"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-99688-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Data on cell densities, bouton densities and mean numbers of synapses per connection were reported in original publications. Data on synapse densities of thalamo-cortical inputs and their projection axon widths are reported in figures and text in this publication. Volumetric atlases, neuron reconstructions and the description of the model in SONATA format have been deposited at Zenodo or Harvard Dataverse and are publicly available as of the date of the publication. Deposited models include reconstructed neuron morphologies. DOIs of these datasets are listed below in the list of newly generated datasets. Original code has been deposited at Zenodo or github and is publicly available as of the date of publication. DOIs or links are listed in the key resources table. Any additional information required to reanalyze the data reported in this paper is available from the lead contact upon request: Michael W. Reimann (mwr@reimann.science).</p><p>The following datasets were generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>A Model of Rat Non-barrel Somatosensory Cortex Anatomy</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.8155899</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset2"><person-group person-group-type="author"><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Brain atlas data for the BBP Somatosensory Cortex model</data-title><source>Harvard Dataverse</source><pub-id pub-id-type="doi">10.7910/DVN/QREN2T</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset3"><person-group person-group-type="author"><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>BBP Somatosensory Cortex model - SONATA version</data-title><source>Harvard Dataverse</source><pub-id pub-id-type="doi">10.7910/DVN/HISHXN</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset4"><person-group person-group-type="author"><name><surname>Pokorny</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Rewired connectome of an SSCX model with inhibitory targeting based on trends found in MICrONS data</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.10677883</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset5"><person-group person-group-type="author"><name><surname>Isbister</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>A Model of Rodent Neocortical Micro- and Mesocircuitry</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.11113043</pub-id></element-citation></p><p>The following previously published dataset was used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset6"><person-group person-group-type="author"><name><surname>Bolanos-Puchet</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Enhanced atlases and flatmaps of rodent neocortex</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.11218079</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>The authors would like to thank Giuseppe Chindemi, Javier DeFelipe and Rajnish Ranjan for help with the scientific development of the model; Tristan Carel, James Dynes, Stefan Eilemann, Bruno Magalhães, Juan Hernando Vieites and Arseny Povolotsky for contributions and support to the engineering challenges; the BBP Core Services team for responding to IT requests and services surrounding the research; Marwan Abdellah, Elvis Boci and Nadir Roman Guerrero for help with visualizations of the model; Zoltán Kisvárday for supervision of morphology reconstruction efforts; Eva Kenny, Silvia Scarabelli and Riccardo Sinsi for help with project management; and Karin Holm, Akiko Sato and Georges Khazen for support of manuscript development and helpful discussions. Funding This study was supported by funding to the Blue Brain Project, a research center of the École polytechnique fédérale de Lausanne (EPFL), from the Swiss government’s ETH Board of the Swiss Federal Institutes of Technology. RL, JPS and JL were supported by EPSRC under grant number EP/P025072/1. RL was supported by a collaboration grant from EPFL. S.R. is supported by a Marie Skłodowska-Curie Global Fellowship Agreement 842492; Newcastle University Academic Track (NUAcT) Fellowship; Fulbright Research Scholarship; Lister Institute Prize Fellowship; Academy of Medical Sciences Springboard Award; Research grant from the Air Force Office of Scientific Research (FA9550-23-1-0533); International Brain Research Organization (IBRO) Early-career Award; Theoretical Sciences Visiting Program (TSVP) at the Okinawa Institute of Science and Technology (OIST).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abdellah</surname><given-names>M</given-names></name><name><surname>Hernando</surname><given-names>J</given-names></name><name><surname>Eilemann</surname><given-names>S</given-names></name><name><surname>Lapere</surname><given-names>S</given-names></name><name><surname>Antille</surname><given-names>N</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Schürmann</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>NeuroMorphoVis: a collaborative framework for analysis and visualization of neuronal morphology skeletons reconstructed from microscopy stacks</article-title><source>Bioinformatics</source><volume>34</volume><fpage>i574</fpage><lpage>i582</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty231</pub-id><pub-id pub-id-type="pmid">29949998</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Anwar</surname><given-names>H</given-names></name><name><surname>Riachi</surname><given-names>I</given-names></name><name><surname>Hill</surname><given-names>S</given-names></name><name><surname>Schürmann</surname><given-names>F</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><chapter-title>An approach to capturing neuron morphological diversity</chapter-title><person-group person-group-type="editor"><name><surname>De Schutter</surname><given-names>E</given-names></name></person-group><source>Computational Modeling Methods for Neuroscientists</source><publisher-name>The MIT Press</publisher-name><fpage>211</fpage><lpage>232</lpage></element-citation></ref><ref id="bib3"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Arnaudon</surname><given-names>A</given-names></name><name><surname>Berchet</surname><given-names>A</given-names></name><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>Zisis</surname><given-names>E</given-names></name><name><surname>Courcol</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>NeuroR</data-title><version designator="1.7.0">1.7.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/NeuroR/tree/v1.7.0">https://github.com/BlueBrain/NeuroR/tree/v1.7.0</ext-link></element-citation></ref><ref id="bib4"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Bae</surname><given-names>JA</given-names></name><name><surname>Baptiste</surname><given-names>M</given-names></name><name><surname>Bishop</surname><given-names>CA</given-names></name><name><surname>Bodor</surname><given-names>AL</given-names></name><name><surname>Brittain</surname><given-names>D</given-names></name><name><surname>Buchanan</surname><given-names>J</given-names></name><name><surname>Bumbarger</surname><given-names>DJ</given-names></name><name><surname>Castro</surname><given-names>MA</given-names></name><name><surname>Celii</surname><given-names>B</given-names></name><collab>MICrONS-Consortium</collab></person-group><year iso-8601-date="2021">2021</year><article-title>Functional connectomics spanning multiple areas of mouse visual cortex</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.07.28.454025</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barabási</surname><given-names>DL</given-names></name><name><surname>Bianconi</surname><given-names>G</given-names></name><name><surname>Bullmore</surname><given-names>E</given-names></name><name><surname>Burgess</surname><given-names>M</given-names></name><name><surname>Chung</surname><given-names>S</given-names></name><name><surname>Eliassi-Rad</surname><given-names>T</given-names></name><name><surname>George</surname><given-names>D</given-names></name><name><surname>Kovács</surname><given-names>IA</given-names></name><name><surname>Makse</surname><given-names>H</given-names></name><name><surname>Nichols</surname><given-names>TE</given-names></name><name><surname>Papadimitriou</surname><given-names>C</given-names></name><name><surname>Sporns</surname><given-names>O</given-names></name><name><surname>Stachenfeld</surname><given-names>K</given-names></name><name><surname>Toroczkai</surname><given-names>Z</given-names></name><name><surname>Towlson</surname><given-names>EK</given-names></name><name><surname>Zador</surname><given-names>AM</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Barabási</surname><given-names>A-L</given-names></name><name><surname>Bernard</surname><given-names>A</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Neuroscience needs network science</article-title><source>The Journal of Neuroscience</source><volume>43</volume><fpage>5989</fpage><lpage>5995</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1014-23.2023</pub-id><pub-id pub-id-type="pmid">37612141</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Billeh</surname><given-names>YN</given-names></name><name><surname>Cai</surname><given-names>B</given-names></name><name><surname>Gratiy</surname><given-names>SL</given-names></name><name><surname>Dai</surname><given-names>K</given-names></name><name><surname>Iyer</surname><given-names>R</given-names></name><name><surname>Gouwens</surname><given-names>NW</given-names></name><name><surname>Abbasi-Asl</surname><given-names>R</given-names></name><name><surname>Jia</surname><given-names>X</given-names></name><name><surname>Siegle</surname><given-names>JH</given-names></name><name><surname>Olsen</surname><given-names>SR</given-names></name><name><surname>Koch</surname><given-names>C</given-names></name><name><surname>Mihalas</surname><given-names>S</given-names></name><name><surname>Arkhipov</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Systematic integration of structural and functional data into multi-scale models of mouse primary visual cortex</article-title><source>Neuron</source><volume>106</volume><fpage>388</fpage><lpage>403</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2020.01.040</pub-id><pub-id pub-id-type="pmid">32142648</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Bodor</surname><given-names>AL</given-names></name><name><surname>Schneider-Mizell</surname><given-names>CM</given-names></name><name><surname>Zhang</surname><given-names>C</given-names></name><name><surname>Elabbady</surname><given-names>L</given-names></name><name><surname>Mallen</surname><given-names>A</given-names></name><name><surname>Bergeson</surname><given-names>A</given-names></name><name><surname>Brittain</surname><given-names>D</given-names></name><name><surname>Buchanan</surname><given-names>J</given-names></name><name><surname>Bumbarger</surname><given-names>DJ</given-names></name><name><surname>Dalley</surname><given-names>R</given-names></name><name><surname>Gamlin</surname><given-names>C</given-names></name><name><surname>Joyce</surname><given-names>E</given-names></name><name><surname>Kapner</surname><given-names>D</given-names></name><name><surname>Kinn</surname><given-names>S</given-names></name><name><surname>Mahalingam</surname><given-names>G</given-names></name><name><surname>Seshamani</surname><given-names>S</given-names></name><name><surname>Suckow</surname><given-names>S</given-names></name><name><surname>Takeno</surname><given-names>M</given-names></name><name><surname>Torres</surname><given-names>R</given-names></name><name><surname>Yin</surname><given-names>W</given-names></name><name><surname>Bae</surname><given-names>JA</given-names></name><name><surname>Castro</surname><given-names>MA</given-names></name><name><surname>Dorkenwald</surname><given-names>S</given-names></name><name><surname>Halageri</surname><given-names>A</given-names></name><name><surname>Jia</surname><given-names>Z</given-names></name><name><surname>Jordan</surname><given-names>C</given-names></name><name><surname>Kemnitz</surname><given-names>N</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>K</given-names></name><name><surname>Lu</surname><given-names>R</given-names></name><name><surname>Macrina</surname><given-names>T</given-names></name><name><surname>Mitchell</surname><given-names>E</given-names></name><name><surname>Mondal</surname><given-names>SS</given-names></name><name><surname>Mu</surname><given-names>S</given-names></name><name><surname>Nehoran</surname><given-names>B</given-names></name><name><surname>Popovych</surname><given-names>S</given-names></name><name><surname>Silversmith</surname><given-names>W</given-names></name><name><surname>Turner</surname><given-names>NL</given-names></name><name><surname>Yu</surname><given-names>S</given-names></name><name><surname>Wong</surname><given-names>W</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Celii</surname><given-names>B</given-names></name><name><surname>Campagnola</surname><given-names>L</given-names></name><name><surname>Seeman</surname><given-names>SC</given-names></name><name><surname>Jarsky</surname><given-names>T</given-names></name><name><surname>Ren</surname><given-names>N</given-names></name><name><surname>Arkhipov</surname><given-names>A</given-names></name><name><surname>Reimer</surname><given-names>J</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name><name><surname>Reid</surname><given-names>RC</given-names></name><name><surname>Collman</surname><given-names>F</given-names></name><name><surname>Maçarico da Costa</surname><given-names>N</given-names></name><collab>The MICrONS Consortium</collab></person-group><year iso-8601-date="2023">2023</year><article-title>The synaptic architecture of layer 5 thick tufted excitatory neurons in the visual cortex of mice</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.10.18.562531</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bolaños-Puchet</surname><given-names>S</given-names></name><name><surname>Teska</surname><given-names>A</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Enhanced atlases and flat maps of rodent neocortex</data-title><version designator="v4.1">v4.1</version><source>Zenodo</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8165004">https://doi.org/10.5281/zenodo.8165004</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolaños-Puchet</surname><given-names>S</given-names></name><name><surname>Teska</surname><given-names>A</given-names></name><name><surname>Hernando</surname><given-names>JB</given-names></name><name><surname>Lu</surname><given-names>H</given-names></name><name><surname>Romani</surname><given-names>A</given-names></name><name><surname>Schürmann</surname><given-names>F</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Enhancement of brain atlases with laminar coordinate systems: Flatmaps and barrel column annotations</article-title><source>Imaging Neuroscience</source><volume>2</volume><fpage>1</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1162/imag_a_00209</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonald</surname><given-names>T</given-names></name><name><surname>Lutz</surname><given-names>Q</given-names></name><name><surname>Charpentier</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Scikit-network: graph analysis in python</article-title><source>Journal of Machine Learning Research</source><volume>21</volume><fpage>1</fpage><lpage>6</lpage></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bota</surname><given-names>M</given-names></name><name><surname>Sporns</surname><given-names>O</given-names></name><name><surname>Swanson</surname><given-names>LW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Architecture of the cerebral cortical association connectome underlying cognition</article-title><source>PNAS</source><volume>112</volume><fpage>E2093</fpage><lpage>E2101</lpage><pub-id pub-id-type="doi">10.1073/pnas.1504394112</pub-id><pub-id pub-id-type="pmid">25848037</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Brandes</surname><given-names>U</given-names></name><name><surname>Delling</surname><given-names>D</given-names></name><name><surname>Gaertler</surname><given-names>M</given-names></name><name><surname>Görke</surname><given-names>R</given-names></name><name><surname>Hoefer</surname><given-names>M</given-names></name><name><surname>Nikoloski</surname><given-names>Z</given-names></name><name><surname>Wagner</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2007">2007</year><chapter-title>On finding graph clusterings with maximum modularity</chapter-title><person-group person-group-type="editor"><name><surname>Brandstädt</surname><given-names>A</given-names></name><name><surname>Kratsch</surname><given-names>D</given-names></name></person-group><source>International Workshop on Graph-Theoretic Concepts in Computer Science</source><publisher-name>Springer</publisher-name><fpage>121</fpage><lpage>132</lpage><pub-id pub-id-type="doi">10.1007/978-3-540-74839-7_12</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzás</surname><given-names>P</given-names></name><name><surname>Eysel</surname><given-names>UT</given-names></name><name><surname>Kisvárday</surname><given-names>ZF</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Functional topography of single cortical cells: an intracellular approach combined with optical imaging</article-title><source>Brain Research. Brain Research Protocols</source><volume>3</volume><fpage>199</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1016/s1385-299x(98)00041-5</pub-id><pub-id pub-id-type="pmid">9813324</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzás</surname><given-names>P</given-names></name><name><surname>Kovács</surname><given-names>K</given-names></name><name><surname>Ferecskó</surname><given-names>AS</given-names></name><name><surname>Budd</surname><given-names>JML</given-names></name><name><surname>Eysel</surname><given-names>UT</given-names></name><name><surname>Kisvárday</surname><given-names>ZF</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Model-based analysis of excitatory lateral connections in the visual cortex</article-title><source>The Journal of Comparative Neurology</source><volume>499</volume><fpage>861</fpage><lpage>881</lpage><pub-id pub-id-type="doi">10.1002/cne.21134</pub-id><pub-id pub-id-type="pmid">17072837</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Chou</surname><given-names>CYC</given-names></name><name><surname>Wong</surname><given-names>HHW</given-names></name><name><surname>Guo</surname><given-names>C</given-names></name><name><surname>Boukoulou</surname><given-names>KE</given-names></name><name><surname>Huang</surname><given-names>C</given-names></name><name><surname>Jannat</surname><given-names>J</given-names></name><name><surname>Klimenko</surname><given-names>T</given-names></name><name><surname>Li</surname><given-names>VY</given-names></name><name><surname>Liang</surname><given-names>TA</given-names></name><name><surname>Wu</surname><given-names>VC</given-names></name><name><surname>Sjöström</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Principles of visual cortex excitatory microcircuit organization</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.12.30.573666</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colizza</surname><given-names>V</given-names></name><name><surname>Flammini</surname><given-names>A</given-names></name><name><surname>Serrano</surname><given-names>MA</given-names></name><name><surname>Vespignani</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Detecting rich-club ordering in complex networks</article-title><source>Nature Physics</source><volume>2</volume><fpage>110</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1038/nphys209</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruikshank</surname><given-names>SJ</given-names></name><name><surname>Lewis</surname><given-names>TJ</given-names></name><name><surname>Connors</surname><given-names>BW</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Synaptic basis for intense thalamocortical activation of feedforward inhibitory cells in neocortex</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>462</fpage><lpage>468</lpage><pub-id pub-id-type="doi">10.1038/nn1861</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruikshank</surname><given-names>SJ</given-names></name><name><surname>Urabe</surname><given-names>H</given-names></name><name><surname>Nurmikko</surname><given-names>AV</given-names></name><name><surname>Connors</surname><given-names>BW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Pathway-specific feedforward circuits between thalamus and neocortex revealed by selective optical stimulation of axons</article-title><source>Neuron</source><volume>65</volume><fpage>230</fpage><lpage>245</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.12.025</pub-id><pub-id pub-id-type="pmid">20152129</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Curto</surname><given-names>C</given-names></name><name><surname>Giusti</surname><given-names>C</given-names></name><name><surname>Marku</surname><given-names>K</given-names></name><name><surname>Pastalkova</surname><given-names>E</given-names></name><name><surname>Itskov</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Pairwise correlation graphs from hippocampal population activity have highly non-random, low-dimensional clique topology</article-title><source>BMC Neuroscience</source><volume>14</volume><fpage>1</fpage><lpage>2</lpage><pub-id pub-id-type="doi">10.1186/1471-2202-14-S1-P182</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dai</surname><given-names>K</given-names></name><name><surname>Hernando</surname><given-names>J</given-names></name><name><surname>Billeh</surname><given-names>YN</given-names></name><name><surname>Gratiy</surname><given-names>SL</given-names></name><name><surname>Planas</surname><given-names>J</given-names></name><name><surname>Davison</surname><given-names>AP</given-names></name><name><surname>Dura-Bernal</surname><given-names>S</given-names></name><name><surname>Gleeson</surname><given-names>P</given-names></name><name><surname>Devresse</surname><given-names>A</given-names></name><name><surname>Dichter</surname><given-names>BK</given-names></name><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>King</surname><given-names>JG</given-names></name><name><surname>Van Geit</surname><given-names>WAH</given-names></name><name><surname>Povolotsky</surname><given-names>AV</given-names></name><name><surname>Muller</surname><given-names>E</given-names></name><name><surname>Courcol</surname><given-names>JD</given-names></name><name><surname>Arkhipov</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The SONATA data format for efficient description of large-scale network models</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1007696</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007696</pub-id><pub-id pub-id-type="pmid">32092054</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Diestel</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><source>Graph Theory</source><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib22"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Dugué</surname><given-names>N</given-names></name><name><surname>Perez</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><source>Directed Louvain: maximizing modularity in directed networks</source><publisher-name>Université d’Orléans</publisher-name></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ecker</surname><given-names>A</given-names></name><name><surname>Egas Santander</surname><given-names>D</given-names></name><name><surname>Abdellah</surname><given-names>M</given-names></name><name><surname>Alonso</surname><given-names>JB</given-names></name><name><surname>Bolaños-Puchet</surname><given-names>S</given-names></name><name><surname>Chindemi</surname><given-names>G</given-names></name><name><surname>Gowri Mariyappan</surname><given-names>DP</given-names></name><name><surname>Isbister</surname><given-names>JB</given-names></name><name><surname>King</surname><given-names>JG</given-names></name><name><surname>Kumbhar</surname><given-names>P</given-names></name><name><surname>Magkanaris</surname><given-names>I</given-names></name><name><surname>Muller</surname><given-names>EB</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2024">2024a</year><article-title>Assemblies, synapse clustering and network topology interact with plasticity to explain structure-function relationships of the cortical connectome</article-title><source>eLife</source><volume>13</volume><elocation-id>e101850</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.101850</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ecker</surname><given-names>A</given-names></name><name><surname>Egas Santander</surname><given-names>D</given-names></name><name><surname>Bolaños-Puchet</surname><given-names>S</given-names></name><name><surname>Isbister</surname><given-names>JB</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2024">2024b</year><article-title>Cortical cell assemblies and their underlying connectivity: An in silico study</article-title><source>PLOS Computational Biology</source><volume>20</volume><elocation-id>e1011891</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1011891</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Economo</surname><given-names>MN</given-names></name><name><surname>Clack</surname><given-names>NG</given-names></name><name><surname>Lavis</surname><given-names>LD</given-names></name><name><surname>Gerfen</surname><given-names>CR</given-names></name><name><surname>Svoboda</surname><given-names>K</given-names></name><name><surname>Myers</surname><given-names>EW</given-names></name><name><surname>Chandrashekar</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A platform for brain-wide imaging and reconstruction of individual neurons</article-title><source>eLife</source><volume>5</volume><elocation-id>e10566</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.10566</pub-id><pub-id pub-id-type="pmid">26796534</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Egas Santander</surname><given-names>D</given-names></name><name><surname>Pokorny</surname><given-names>C</given-names></name><name><surname>Ecker</surname><given-names>A</given-names></name><name><surname>Lazovskis</surname><given-names>J</given-names></name><name><surname>Santoro</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>JP</given-names></name><name><surname>Hess</surname><given-names>K</given-names></name><name><surname>Levi</surname><given-names>R</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2024">2024a</year><article-title>Heterogeneous and higher-order cortical connectivity undergirds efficient, robust and reliable neural codes</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2024.03.15.585196</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Egas Santander</surname><given-names>D</given-names></name><name><surname>Pokorny</surname><given-names>C</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name><name><surname>Smith</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2024">2024b</year><data-title>Connectome analysis</data-title><version designator="0.0.1">0.0.1</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/danielaegassan/connectome_analysis">https://github.com/danielaegassan/connectome_analysis</ext-link></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Einevoll</surname><given-names>GT</given-names></name><name><surname>Destexhe</surname><given-names>A</given-names></name><name><surname>Diesmann</surname><given-names>M</given-names></name><name><surname>Grün</surname><given-names>S</given-names></name><name><surname>Jirsa</surname><given-names>V</given-names></name><name><surname>de Kamps</surname><given-names>M</given-names></name><name><surname>Migliore</surname><given-names>M</given-names></name><name><surname>Ness</surname><given-names>TV</given-names></name><name><surname>Plesser</surname><given-names>HE</given-names></name><name><surname>Schürmann</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The scientific case for brain simulations</article-title><source>Neuron</source><volume>102</volume><fpage>735</fpage><lpage>744</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.03.027</pub-id><pub-id pub-id-type="pmid">31121126</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fares</surname><given-names>T</given-names></name><name><surname>Stepanyants</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Cooperative synapse formation in the neocortex</article-title><source>PNAS</source><volume>106</volume><fpage>16463</fpage><lpage>16468</lpage><pub-id pub-id-type="doi">10.1073/pnas.0813265106</pub-id><pub-id pub-id-type="pmid">19805321</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farinella</surname><given-names>M</given-names></name><name><surname>Ruedt</surname><given-names>DT</given-names></name><name><surname>Gleeson</surname><given-names>P</given-names></name><name><surname>Lanore</surname><given-names>F</given-names></name><name><surname>Silver</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Glutamate-bound NMDARs arising from in vivo-like network activity extend spatio-temporal integration in a L5 cortical pyramidal cell model</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003590</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003590</pub-id><pub-id pub-id-type="pmid">24763087</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felleman</surname><given-names>DJ</given-names></name><name><surname>Van Essen</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Distributed hierarchical processing in the primate cerebral cortex</article-title><source>Cerebral Cortex</source><volume>1</volume><fpage>1</fpage><lpage>47</lpage><pub-id pub-id-type="doi">10.1093/cercor/1.1.1-a</pub-id><pub-id pub-id-type="pmid">1822724</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gal</surname><given-names>E</given-names></name><name><surname>London</surname><given-names>M</given-names></name><name><surname>Globerson</surname><given-names>A</given-names></name><name><surname>Ramaswamy</surname><given-names>S</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name><name><surname>Muller</surname><given-names>E</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Segev</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Rich cell-type-specific network topology in neocortical microcircuitry</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>1004</fpage><lpage>1013</lpage><pub-id pub-id-type="doi">10.1038/nn.4576</pub-id><pub-id pub-id-type="pmid">28581480</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Gal</surname><given-names>E</given-names></name><name><surname>Perin</surname><given-names>R</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>London</surname><given-names>M</given-names></name><name><surname>Segev</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Neuron geometry underlies universal network features in cortical microcircuits</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/656058</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gal</surname><given-names>E</given-names></name><name><surname>Amsalem</surname><given-names>O</given-names></name><name><surname>Schindel</surname><given-names>A</given-names></name><name><surname>London</surname><given-names>M</given-names></name><name><surname>Schürmann</surname><given-names>F</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Segev</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The role of hub neurons in modulating cortical dynamics</article-title><source>Frontiers in Neural Circuits</source><volume>15</volume><elocation-id>718270</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2021.718270</pub-id><pub-id pub-id-type="pmid">34630046</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garey</surname><given-names>L</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Cortex: statistics and geometry of neuronal connectivity, 2nd edn</article-title><source>Journal of Anatomy</source><volume>194</volume><fpage>153</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1046/j.1469-7580.1999.194101535.x</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerfen</surname><given-names>CR</given-names></name><name><surname>Economo</surname><given-names>MN</given-names></name><name><surname>Chandrashekar</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Long distance projections of cortical pyramidal neurons</article-title><source>Journal of Neuroscience Research</source><volume>96</volume><fpage>1467</fpage><lpage>1475</lpage><pub-id pub-id-type="doi">10.1002/jnr.23978</pub-id><pub-id pub-id-type="pmid">27862192</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>Herttuainen</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Projectionizer</data-title><version designator="3.0.0.dev0">3.0.0.dev0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/projectionizer/releases/tag/projectionizer-v3.0.0.dev0">https://github.com/BlueBrain/projectionizer/releases/tag/projectionizer-v3.0.0.dev0</ext-link></element-citation></ref><ref id="bib38"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>Guyot</surname><given-names>L</given-names></name><name><surname>Cristella</surname><given-names>L</given-names></name><name><surname>Zisis</surname><given-names>E</given-names></name><name><surname>Teska</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2024">2024a</year><data-title>Atlas splitter</data-title><version designator="0.1.5">0.1.5</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/atlas-splitter/tree/v0.1.5">https://github.com/BlueBrain/atlas-splitter/tree/v0.1.5</ext-link></element-citation></ref><ref id="bib39"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>Rodarie</surname><given-names>D</given-names></name><name><surname>Šubert</surname><given-names>E</given-names></name><name><surname>Zisis</surname><given-names>E</given-names></name><name><surname>Cristella</surname><given-names>L</given-names></name><name><surname>Guyot</surname><given-names>L</given-names></name><name><surname>Keller</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2024">2024b</year><data-title>Atlas densities</data-title><version designator="0.2.5">0.2.5</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/atlas-densities/tree/v0.2.5">https://github.com/BlueBrain/atlas-densities/tree/v0.2.5</ext-link></element-citation></ref><ref id="bib40"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>Ficarelli</surname><given-names>G</given-names></name><name><surname>Berchet</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2024">2024c</year><data-title>NeuroC</data-title><version designator="0.3.0">0.3.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/neuroc/tree/v0.3.0">https://github.com/BlueBrain/neuroc/tree/v0.3.0</ext-link></element-citation></ref><ref id="bib41"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ghobril</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><source>Doctoral Dissertation: Large Volume Imaging of Rodent Brain Anatomy with Emphasis on Selective Plane Illumination Microscopy</source><publisher-name>École polytechnique fédérale de Lausanne</publisher-name></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giacopelli</surname><given-names>G</given-names></name><name><surname>Tegolo</surname><given-names>D</given-names></name><name><surname>Spera</surname><given-names>E</given-names></name><name><surname>Migliore</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>On the structural connectivity of large-scale models of brain networks at cellular level</article-title><source>Scientific Reports</source><volume>11</volume><elocation-id>4345</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-021-83759-z</pub-id><pub-id pub-id-type="pmid">33623053</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giusti</surname><given-names>C</given-names></name><name><surname>Pastalkova</surname><given-names>E</given-names></name><name><surname>Curto</surname><given-names>C</given-names></name><name><surname>Itskov</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Clique topology reveals intrinsic geometric structure in neural correlations</article-title><source>PNAS</source><volume>112</volume><fpage>13455</fpage><lpage>13460</lpage><pub-id pub-id-type="doi">10.1073/pnas.1506407112</pub-id><pub-id pub-id-type="pmid">26487684</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>KH</given-names></name><name><surname>Yamawaki</surname><given-names>N</given-names></name><name><surname>Barrett</surname><given-names>JM</given-names></name><name><surname>Tapies</surname><given-names>M</given-names></name><name><surname>Shepherd</surname><given-names>GMG</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Cortico-thalamo-cortical circuits of mouse forelimb s1 are organized primarily as recurrent loops</article-title><source>The Journal of Neuroscience</source><volume>40</volume><fpage>2849</fpage><lpage>2858</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2277-19.2020</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>JA</given-names></name><name><surname>Mihalas</surname><given-names>S</given-names></name><name><surname>Hirokawa</surname><given-names>KE</given-names></name><name><surname>Whitesell</surname><given-names>JD</given-names></name><name><surname>Choi</surname><given-names>H</given-names></name><name><surname>Bernard</surname><given-names>A</given-names></name><name><surname>Bohn</surname><given-names>P</given-names></name><name><surname>Caldejon</surname><given-names>S</given-names></name><name><surname>Casal</surname><given-names>L</given-names></name><name><surname>Cho</surname><given-names>A</given-names></name><name><surname>Feiner</surname><given-names>A</given-names></name><name><surname>Feng</surname><given-names>D</given-names></name><name><surname>Gaudreault</surname><given-names>N</given-names></name><name><surname>Gerfen</surname><given-names>CR</given-names></name><name><surname>Graddis</surname><given-names>N</given-names></name><name><surname>Groblewski</surname><given-names>PA</given-names></name><name><surname>Henry</surname><given-names>AM</given-names></name><name><surname>Ho</surname><given-names>A</given-names></name><name><surname>Howard</surname><given-names>R</given-names></name><name><surname>Knox</surname><given-names>JE</given-names></name><name><surname>Kuan</surname><given-names>L</given-names></name><name><surname>Kuang</surname><given-names>X</given-names></name><name><surname>Lecoq</surname><given-names>J</given-names></name><name><surname>Lesnar</surname><given-names>P</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Luviano</surname><given-names>J</given-names></name><name><surname>McConoughey</surname><given-names>S</given-names></name><name><surname>Mortrud</surname><given-names>MT</given-names></name><name><surname>Naeemi</surname><given-names>M</given-names></name><name><surname>Ng</surname><given-names>L</given-names></name><name><surname>Oh</surname><given-names>SW</given-names></name><name><surname>Ouellette</surname><given-names>B</given-names></name><name><surname>Shen</surname><given-names>E</given-names></name><name><surname>Sorensen</surname><given-names>SA</given-names></name><name><surname>Wakeman</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Williford</surname><given-names>A</given-names></name><name><surname>Phillips</surname><given-names>JW</given-names></name><name><surname>Jones</surname><given-names>AR</given-names></name><name><surname>Koch</surname><given-names>C</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hierarchical organization of cortical and thalamic connectivity</article-title><source>Nature</source><volume>575</volume><fpage>195</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1716-z</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iacaruso</surname><given-names>MF</given-names></name><name><surname>Gasler</surname><given-names>IT</given-names></name><name><surname>Hofer</surname><given-names>SB</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Synaptic organization of visual space in primary visual cortex</article-title><source>Nature</source><volume>547</volume><fpage>449</fpage><lpage>452</lpage><pub-id pub-id-type="doi">10.1038/nature23019</pub-id><pub-id pub-id-type="pmid">28700575</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Isbister</surname><given-names>JB</given-names></name><name><surname>Ecker</surname><given-names>A</given-names></name><name><surname>Pokorny</surname><given-names>C</given-names></name><name><surname>Bolaños-Puchet</surname><given-names>S</given-names></name><name><surname>Santander</surname><given-names>DE</given-names></name><name><surname>Arnaudon</surname><given-names>A</given-names></name><name><surname>Awile</surname><given-names>O</given-names></name><name><surname>Barros-Zulaica</surname><given-names>N</given-names></name><name><surname>Alonso</surname><given-names>JB</given-names></name><name><surname>Boci</surname><given-names>E</given-names></name><name><surname>Chindemi</surname><given-names>G</given-names></name><name><surname>Courcol</surname><given-names>J</given-names></name><name><surname>Damart</surname><given-names>T</given-names></name><name><surname>Delemontex</surname><given-names>T</given-names></name><name><surname>Dietz</surname><given-names>A</given-names></name><name><surname>Ficarelli</surname><given-names>G</given-names></name><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>Herttuainen</surname><given-names>J</given-names></name><name><surname>Ivaska</surname><given-names>G</given-names></name><name><surname>Ji</surname><given-names>W</given-names></name><name><surname>Keller</surname><given-names>D</given-names></name><name><surname>King</surname><given-names>J</given-names></name><name><surname>Kumbhar</surname><given-names>P</given-names></name><name><surname>Lapere</surname><given-names>S</given-names></name><name><surname>Litvak</surname><given-names>P</given-names></name><name><surname>Mandge</surname><given-names>D</given-names></name><name><surname>Muller</surname><given-names>EB</given-names></name><name><surname>Pereira</surname><given-names>F</given-names></name><name><surname>Planas</surname><given-names>J</given-names></name><name><surname>Ranjan</surname><given-names>R</given-names></name><name><surname>Reva</surname><given-names>M</given-names></name><name><surname>Romani</surname><given-names>A</given-names></name><name><surname>Rössert</surname><given-names>C</given-names></name><name><surname>Schürmann</surname><given-names>F</given-names></name><name><surname>Sood</surname><given-names>V</given-names></name><name><surname>Teska</surname><given-names>A</given-names></name><name><surname>Tuncel</surname><given-names>A</given-names></name><name><surname>Wolf</surname><given-names>M</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Ramaswamy</surname><given-names>S</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Modeling and simulation of neocortical micro- and mesocircuitry</article-title><source>eLife</source><volume>13</volume><elocation-id>RP99693</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.99693.1</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>X</given-names></name><name><surname>Shen</surname><given-names>S</given-names></name><name><surname>Cadwell</surname><given-names>CR</given-names></name><name><surname>Berens</surname><given-names>P</given-names></name><name><surname>Sinz</surname><given-names>F</given-names></name><name><surname>Ecker</surname><given-names>AS</given-names></name><name><surname>Patel</surname><given-names>S</given-names></name><name><surname>Tolias</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Principles of connectivity among morphologically defined cell types in adult neocortex</article-title><source>Science</source><volume>350</volume><elocation-id>aac9462</elocation-id><pub-id pub-id-type="doi">10.1126/science.aac9462</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kahle</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Topology of random clique complexes</article-title><source>Discrete Mathematics</source><volume>309</volume><fpage>1658</fpage><lpage>1671</lpage><pub-id pub-id-type="doi">10.1016/j.disc.2008.02.037</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kahle</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Topology of random simplicial complexes: a survey</article-title><source>AMS Contemp Math</source><volume>620</volume><fpage>201</fpage><lpage>222</lpage><pub-id pub-id-type="doi">10.1090/conm/620</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanari</surname><given-names>L</given-names></name><name><surname>Dłotko</surname><given-names>P</given-names></name><name><surname>Scolamiero</surname><given-names>M</given-names></name><name><surname>Levi</surname><given-names>R</given-names></name><name><surname>Shillcock</surname><given-names>J</given-names></name><name><surname>Hess</surname><given-names>K</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A topological representation of branching neuronal morphologies</article-title><source>Neuroinformatics</source><volume>16</volume><fpage>3</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1007/s12021-017-9341-1</pub-id><pub-id pub-id-type="pmid">28975511</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanari</surname><given-names>L</given-names></name><name><surname>Ramaswamy</surname><given-names>S</given-names></name><name><surname>Shi</surname><given-names>Y</given-names></name><name><surname>Morand</surname><given-names>S</given-names></name><name><surname>Meystre</surname><given-names>J</given-names></name><name><surname>Perin</surname><given-names>R</given-names></name><name><surname>Abdellah</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Hess</surname><given-names>K</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Objective morphological classification of neocortical pyramidal cells</article-title><source>Cerebral Cortex</source><volume>29</volume><fpage>1719</fpage><lpage>1735</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhy339</pub-id><pub-id pub-id-type="pmid">30715238</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Kanari</surname><given-names>L</given-names></name><name><surname>Schmidt</surname><given-names>S</given-names></name><name><surname>Casalegno</surname><given-names>F</given-names></name><name><surname>Delattre</surname><given-names>E</given-names></name><name><surname>Banjac</surname><given-names>J</given-names></name><name><surname>Negrello</surname><given-names>T</given-names></name><name><surname>Shi</surname><given-names>Y</given-names></name><name><surname>Meystre</surname><given-names>J</given-names></name><name><surname>Defferrard</surname><given-names>M</given-names></name><name><surname>Schürmann</surname><given-names>F</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Deep learning for classifying neuronal morphologies: combining topological data analysis and graph neural networks</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2024.09.13.612635</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karube</surname><given-names>F</given-names></name><name><surname>Kisvárday</surname><given-names>ZF</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Axon topography of layer IV spiny cells to orientation map in the cat primary visual cortex (area 18)</article-title><source>Cerebral Cortex</source><volume>21</volume><fpage>1443</fpage><lpage>1458</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhq232</pub-id><pub-id pub-id-type="pmid">21062952</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname><given-names>D</given-names></name><name><surname>Meystre</surname><given-names>J</given-names></name><name><surname>Veettil</surname><given-names>RV</given-names></name><name><surname>Burri</surname><given-names>O</given-names></name><name><surname>Guiet</surname><given-names>R</given-names></name><name><surname>Schürmann</surname><given-names>F</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A derived positional mapping of inhibitory subtypes in the somatosensory cortex</article-title><source>Frontiers in Neuroanatomy</source><volume>13</volume><elocation-id>78</elocation-id><pub-id pub-id-type="doi">10.3389/fnana.2019.00078</pub-id><pub-id pub-id-type="pmid">31447655</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozloski</surname><given-names>J</given-names></name><name><surname>Sfyrakis</surname><given-names>K</given-names></name><name><surname>Hill</surname><given-names>S</given-names></name><name><surname>Schurmann</surname><given-names>F</given-names></name><name><surname>Peck</surname><given-names>C</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Identifying, tabulating, and analyzing contacts between branched neuron morphologies</article-title><source>IBM Journal of Research and Development</source><volume>52</volume><fpage>43</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1147/rd.521.0043</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lütgehetmann</surname><given-names>D</given-names></name><name><surname>Govc</surname><given-names>D</given-names></name><name><surname>Smith</surname><given-names>JP</given-names></name><name><surname>Levi</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Computing persistent homology of directed flag complexes</article-title><source>Algorithms</source><volume>13</volume><elocation-id>19</elocation-id><pub-id pub-id-type="doi">10.3390/a13010019</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Lübke</surname><given-names>J</given-names></name><name><surname>Frotscher</surname><given-names>M</given-names></name><name><surname>Roth</surname><given-names>A</given-names></name><name><surname>Sakmann</surname><given-names>B</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Physiology and anatomy of synaptic connections between thick tufted pyramidal neurones in the developing rat neocortex</article-title><source>The Journal of Physiology</source><volume>500</volume><fpage>409</fpage><lpage>440</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1997.sp022031</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Muller</surname><given-names>E</given-names></name><name><surname>Ramaswamy</surname><given-names>S</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name><name><surname>Abdellah</surname><given-names>M</given-names></name><name><surname>Sanchez</surname><given-names>CA</given-names></name><name><surname>Ailamaki</surname><given-names>A</given-names></name><name><surname>Alonso-Nanclares</surname><given-names>L</given-names></name><name><surname>Antille</surname><given-names>N</given-names></name><name><surname>Arsever</surname><given-names>S</given-names></name><name><surname>Kahou</surname><given-names>GAA</given-names></name><name><surname>Berger</surname><given-names>TK</given-names></name><name><surname>Bilgili</surname><given-names>A</given-names></name><name><surname>Buncic</surname><given-names>N</given-names></name><name><surname>Chalimourda</surname><given-names>A</given-names></name><name><surname>Chindemi</surname><given-names>G</given-names></name><name><surname>Courcol</surname><given-names>JD</given-names></name><name><surname>Delalondre</surname><given-names>F</given-names></name><name><surname>Delattre</surname><given-names>V</given-names></name><name><surname>Druckmann</surname><given-names>S</given-names></name><name><surname>Dumusc</surname><given-names>R</given-names></name><name><surname>Dynes</surname><given-names>J</given-names></name><name><surname>Eilemann</surname><given-names>S</given-names></name><name><surname>Gal</surname><given-names>E</given-names></name><name><surname>Gevaert</surname><given-names>ME</given-names></name><name><surname>Ghobril</surname><given-names>JP</given-names></name><name><surname>Gidon</surname><given-names>A</given-names></name><name><surname>Graham</surname><given-names>JW</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Haenel</surname><given-names>V</given-names></name><name><surname>Hay</surname><given-names>E</given-names></name><name><surname>Heinis</surname><given-names>T</given-names></name><name><surname>Hernando</surname><given-names>JB</given-names></name><name><surname>Hines</surname><given-names>M</given-names></name><name><surname>Kanari</surname><given-names>L</given-names></name><name><surname>Keller</surname><given-names>D</given-names></name><name><surname>Kenyon</surname><given-names>J</given-names></name><name><surname>Khazen</surname><given-names>G</given-names></name><name><surname>Kim</surname><given-names>Y</given-names></name><name><surname>King</surname><given-names>JG</given-names></name><name><surname>Kisvarday</surname><given-names>Z</given-names></name><name><surname>Kumbhar</surname><given-names>P</given-names></name><name><surname>Lasserre</surname><given-names>S</given-names></name><name><surname>Le Bé</surname><given-names>JV</given-names></name><name><surname>Magalhães</surname><given-names>BRC</given-names></name><name><surname>Merchán-Pérez</surname><given-names>A</given-names></name><name><surname>Meystre</surname><given-names>J</given-names></name><name><surname>Morrice</surname><given-names>BR</given-names></name><name><surname>Muller</surname><given-names>J</given-names></name><name><surname>Muñoz-Céspedes</surname><given-names>A</given-names></name><name><surname>Muralidhar</surname><given-names>S</given-names></name><name><surname>Muthurasa</surname><given-names>K</given-names></name><name><surname>Nachbaur</surname><given-names>D</given-names></name><name><surname>Newton</surname><given-names>TH</given-names></name><name><surname>Nolte</surname><given-names>M</given-names></name><name><surname>Ovcharenko</surname><given-names>A</given-names></name><name><surname>Palacios</surname><given-names>J</given-names></name><name><surname>Pastor</surname><given-names>L</given-names></name><name><surname>Perin</surname><given-names>R</given-names></name><name><surname>Ranjan</surname><given-names>R</given-names></name><name><surname>Riachi</surname><given-names>I</given-names></name><name><surname>Rodríguez</surname><given-names>JR</given-names></name><name><surname>Riquelme</surname><given-names>JL</given-names></name><name><surname>Rössert</surname><given-names>C</given-names></name><name><surname>Sfyrakis</surname><given-names>K</given-names></name><name><surname>Shi</surname><given-names>Y</given-names></name><name><surname>Shillcock</surname><given-names>JC</given-names></name><name><surname>Silberberg</surname><given-names>G</given-names></name><name><surname>Silva</surname><given-names>R</given-names></name><name><surname>Tauheed</surname><given-names>F</given-names></name><name><surname>Telefont</surname><given-names>M</given-names></name><name><surname>Toledo-Rodriguez</surname><given-names>M</given-names></name><name><surname>Tränkler</surname><given-names>T</given-names></name><name><surname>Van Geit</surname><given-names>W</given-names></name><name><surname>Díaz</surname><given-names>JV</given-names></name><name><surname>Walker</surname><given-names>R</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Zaninetta</surname><given-names>SM</given-names></name><name><surname>DeFelipe</surname><given-names>J</given-names></name><name><surname>Hill</surname><given-names>SL</given-names></name><name><surname>Segev</surname><given-names>I</given-names></name><name><surname>Schürmann</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Reconstruction and simulation of neocortical microcircuitry</article-title><source>Cell</source><volume>163</volume><fpage>456</fpage><lpage>492</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.09.029</pub-id><pub-id pub-id-type="pmid">26451489</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mason</surname><given-names>A</given-names></name><name><surname>Nicoll</surname><given-names>A</given-names></name><name><surname>Stratford</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Synaptic transmission between individual pyramidal neurons of the rat visual cortex in vitro</article-title><source>The Journal of Neuroscience</source><volume>11</volume><fpage>72</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.11-01-00072.1991</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>HS</given-names></name><name><surname>Wimmer</surname><given-names>VC</given-names></name><name><surname>Hemberger</surname><given-names>M</given-names></name><name><surname>Bruno</surname><given-names>RM</given-names></name><name><surname>de Kock</surname><given-names>CPJ</given-names></name><name><surname>Frick</surname><given-names>A</given-names></name><name><surname>Sakmann</surname><given-names>B</given-names></name><name><surname>Helmstaedter</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Cell type–specific thalamic innervation in a column of rat vibrissal cortex</article-title><source>Cerebral Cortex</source><volume>20</volume><fpage>2287</fpage><lpage>2303</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhq069</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mishchenko</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>T</given-names></name><name><surname>Spacek</surname><given-names>J</given-names></name><name><surname>Mendenhall</surname><given-names>J</given-names></name><name><surname>Harris</surname><given-names>KM</given-names></name><name><surname>Chklovskii</surname><given-names>DB</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Ultrastructural analysis of hippocampal neuropil from the connectomics perspective</article-title><source>Neuron</source><volume>67</volume><fpage>1009</fpage><lpage>1020</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.08.014</pub-id><pub-id pub-id-type="pmid">20869597</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Motta</surname><given-names>A</given-names></name><name><surname>Berning</surname><given-names>M</given-names></name><name><surname>Boergens</surname><given-names>KM</given-names></name><name><surname>Staffler</surname><given-names>B</given-names></name><name><surname>Beining</surname><given-names>M</given-names></name><name><surname>Loomba</surname><given-names>S</given-names></name><name><surname>Hennig</surname><given-names>P</given-names></name><name><surname>Wissler</surname><given-names>H</given-names></name><name><surname>Helmstaedter</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dense connectomic reconstruction in layer 4 of the somatosensory cortex</article-title><source>Science</source><volume>366</volume><elocation-id>eaay3134</elocation-id><pub-id pub-id-type="doi">10.1126/science.aay3134</pub-id><pub-id pub-id-type="pmid">31649140</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muralidhar</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Synaptic and cellular organization of layer 1 of the developing rat somatosensory cortex</article-title><source>Frontiers in Neuroanatomy</source><volume>7</volume><elocation-id>52</elocation-id><pub-id pub-id-type="doi">10.3389/fnana.2013.00052</pub-id><pub-id pub-id-type="pmid">24474905</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Narayanan</surname><given-names>RT</given-names></name><name><surname>Udvary</surname><given-names>D</given-names></name><name><surname>Oberlaender</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Cell type-specific structural organization of the six layers in rat barrel cortex</article-title><source>Frontiers in Neuroanatomy</source><volume>11</volume><elocation-id>91</elocation-id><pub-id pub-id-type="doi">10.3389/fnana.2017.00091</pub-id><pub-id pub-id-type="pmid">29081739</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neher</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Correction for liquid junction potentials in patch clamp experiments</article-title><source>Methods in Enzymology</source><volume>207</volume><fpage>123</fpage><lpage>131</lpage><pub-id pub-id-type="doi">10.1016/0076-6879(92)07008-C</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newman</surname><given-names>MEJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The structure and function of complex networks</article-title><source>SIAM Review</source><volume>45</volume><fpage>167</fpage><lpage>256</lpage><pub-id pub-id-type="doi">10.1137/S003614450342480</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nicosia</surname><given-names>V</given-names></name><name><surname>Mangioni</surname><given-names>G</given-names></name><name><surname>Carchiolo</surname><given-names>V</given-names></name><name><surname>Malgeri</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Extending the definition of modularity to directed graphs with overlapping communities</article-title><source>Journal of Statistical Mechanics</source><volume>2009</volume><elocation-id>03024</elocation-id><pub-id pub-id-type="doi">10.1088/1742-5468/2009/03/P03024</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nolte</surname><given-names>M</given-names></name><name><surname>Gal</surname><given-names>E</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Impact of higher order network structure on emergent cortical activity</article-title><source>Network Neuroscience</source><volume>4</volume><fpage>292</fpage><lpage>314</lpage><pub-id pub-id-type="doi">10.1162/netn_a_00124</pub-id><pub-id pub-id-type="pmid">32181420</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oh</surname><given-names>SW</given-names></name><name><surname>Harris</surname><given-names>JA</given-names></name><name><surname>Ng</surname><given-names>L</given-names></name><name><surname>Winslow</surname><given-names>B</given-names></name><name><surname>Cain</surname><given-names>N</given-names></name><name><surname>Mihalas</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Lau</surname><given-names>C</given-names></name><name><surname>Kuan</surname><given-names>L</given-names></name><name><surname>Henry</surname><given-names>AM</given-names></name><name><surname>Mortrud</surname><given-names>MT</given-names></name><name><surname>Ouellette</surname><given-names>B</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Sorensen</surname><given-names>SA</given-names></name><name><surname>Slaughterbeck</surname><given-names>CR</given-names></name><name><surname>Wakeman</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Feng</surname><given-names>D</given-names></name><name><surname>Ho</surname><given-names>A</given-names></name><name><surname>Nicholas</surname><given-names>E</given-names></name><name><surname>Hirokawa</surname><given-names>KE</given-names></name><name><surname>Bohn</surname><given-names>P</given-names></name><name><surname>Joines</surname><given-names>KM</given-names></name><name><surname>Peng</surname><given-names>H</given-names></name><name><surname>Hawrylycz</surname><given-names>MJ</given-names></name><name><surname>Phillips</surname><given-names>JW</given-names></name><name><surname>Hohmann</surname><given-names>JG</given-names></name><name><surname>Wohnoutka</surname><given-names>P</given-names></name><name><surname>Gerfen</surname><given-names>CR</given-names></name><name><surname>Koch</surname><given-names>C</given-names></name><name><surname>Bernard</surname><given-names>A</given-names></name><name><surname>Dang</surname><given-names>C</given-names></name><name><surname>Jones</surname><given-names>AR</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A mesoscale connectome of the mouse brain</article-title><source>Nature</source><volume>508</volume><fpage>207</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1038/nature13186</pub-id><pub-id pub-id-type="pmid">24695228</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Opsahl</surname><given-names>T</given-names></name><name><surname>Colizza</surname><given-names>V</given-names></name><name><surname>Panzarasa</surname><given-names>P</given-names></name><name><surname>Ramasco</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Prominence and control: the weighted rich-club effect</article-title><source>Physical Review Letters</source><volume>101</volume><elocation-id>168702</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.101.168702</pub-id><pub-id pub-id-type="pmid">18999722</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Paxinos</surname><given-names>G</given-names></name><name><surname>Watson</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007</year><source>The Rat Brain in Stereotaxic Coordinates</source><publisher-name>Academic Press</publisher-name></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perin</surname><given-names>R</given-names></name><name><surname>Berger</surname><given-names>TK</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A synaptic organizing principle for cortical neuronal groups</article-title><source>PNAS</source><volume>108</volume><fpage>5419</fpage><lpage>5424</lpage><pub-id pub-id-type="doi">10.1073/pnas.1016051108</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peters</surname><given-names>A</given-names></name><name><surname>Feldman</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>The projection of the lateral geniculate nucleus to area 17 of the rat cerebral cortex. I. General description</article-title><source>Journal of Neurocytology</source><volume>5</volume><fpage>63</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1007/BF01176183</pub-id><pub-id pub-id-type="pmid">1249593</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pokorny</surname><given-names>C</given-names></name><name><surname>Awile</surname><given-names>O</given-names></name><name><surname>Isbister</surname><given-names>JB</given-names></name><name><surname>Kurban</surname><given-names>K</given-names></name><name><surname>Wolf</surname><given-names>M</given-names></name><name><surname>Reimann</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2024">2024a</year><article-title>A connectome manipulation framework for the systematic and reproducible study of structure–function relationships through simulations</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2024.05.24.593860</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Pokorny</surname><given-names>C</given-names></name><name><surname>Wolf</surname><given-names>M</given-names></name><name><surname>Zisis</surname><given-names>E</given-names></name><name><surname>Grosheintz</surname><given-names>L</given-names></name><name><surname>Blanco Alonso</surname><given-names>J</given-names></name><name><surname>Kurban</surname><given-names>K</given-names></name><name><surname>Pereira</surname><given-names>F</given-names></name><name><surname>Gevaert</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2024">2024b</year><data-title>Connectome-manipulator</data-title><version designator="1.0.0">1.0.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/connectome-manipulator/tree/v1.0.0">https://github.com/BlueBrain/connectome-manipulator/tree/v1.0.0</ext-link></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Potjans</surname><given-names>TC</given-names></name><name><surname>Diesmann</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The cell-type specific cortical microcircuit: relating structure and activity in a full-scale spiking network model</article-title><source>Cerebral Cortex</source><volume>24</volume><fpage>785</fpage><lpage>806</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhs358</pub-id><pub-id pub-id-type="pmid">23203991</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Povolotsky</surname><given-names>A</given-names></name><name><surname>Ficarelli</surname><given-names>G</given-names></name><name><surname>Berchet</surname><given-names>A</given-names></name><name><surname>Arnaudon</surname><given-names>A</given-names></name><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>Vanherpe</surname><given-names>L</given-names></name><name><surname>Muller</surname><given-names>EB</given-names></name><name><surname>Zisis</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Placement hints</data-title><version designator="2.4.0">2.4.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/placement-algorithm/releases/tag/placement-algorithm-v2.4.0">https://github.com/BlueBrain/placement-algorithm/releases/tag/placement-algorithm-v2.4.0</ext-link></element-citation></ref><ref id="bib79"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Povolotsky</surname><given-names>A</given-names></name><name><surname>Riquelme</surname><given-names>JL</given-names></name><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>Ficarelli</surname><given-names>G</given-names></name><name><surname>Vanherpe</surname><given-names>L</given-names></name><name><surname>Courcol</surname><given-names>JD</given-names></name><name><surname>Zisis</surname><given-names>E</given-names></name><name><surname>Guyot</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>BrainBuilder</data-title><version designator="0.20.0">0.20.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/brainbuilder/tree/v0.20.0">https://github.com/BlueBrain/brainbuilder/tree/v0.20.0</ext-link></element-citation></ref><ref id="bib80"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pronold</surname><given-names>J</given-names></name><name><surname>Morales-Gregorio</surname><given-names>A</given-names></name><name><surname>Rostami</surname><given-names>V</given-names></name><name><surname>van Albada</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Cortical multi-area model with joint excitatory-inhibitory clusters accounts for spiking statistics, inter-area propagation, and variability dynamics</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2024.01.30.577979</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramaswamy</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Data-driven multiscale computational models of cortical and subcortical regions</article-title><source>Current Opinion in Neurobiology</source><volume>85</volume><elocation-id>102842</elocation-id><pub-id pub-id-type="doi">10.1016/j.conb.2024.102842</pub-id><pub-id pub-id-type="pmid">38320453</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rees</surname><given-names>CL</given-names></name><name><surname>Moradi</surname><given-names>K</given-names></name><name><surname>Ascoli</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Weighing the evidence in Peters’ rule: does neuronal morphology predict connectivity?</article-title><source>Trends in Neurosciences</source><volume>40</volume><fpage>63</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2016.11.007</pub-id><pub-id pub-id-type="pmid">28041634</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reimann</surname><given-names>MW</given-names></name><name><surname>King</surname><given-names>JG</given-names></name><name><surname>Muller</surname><given-names>EB</given-names></name><name><surname>Ramaswamy</surname><given-names>S</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>An algorithm to predict the connectome of neural microcircuits</article-title><source>Frontiers in Computational Neuroscience</source><volume>9</volume><elocation-id>120</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2015.00120</pub-id><pub-id pub-id-type="pmid">26500529</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reimann</surname><given-names>MW</given-names></name><name><surname>Horlemann</surname><given-names>A-L</given-names></name><name><surname>Ramaswamy</surname><given-names>S</given-names></name><name><surname>Muller</surname><given-names>EB</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017a</year><article-title>Morphological diversity strongly constrains synaptic connectivity and plasticity</article-title><source>Cerebral Cortex</source><volume>27</volume><fpage>4570</fpage><lpage>4585</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhx150</pub-id><pub-id pub-id-type="pmid">28637203</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reimann</surname><given-names>MW</given-names></name><name><surname>Nolte</surname><given-names>M</given-names></name><name><surname>Scolamiero</surname><given-names>M</given-names></name><name><surname>Turner</surname><given-names>K</given-names></name><name><surname>Perin</surname><given-names>R</given-names></name><name><surname>Chindemi</surname><given-names>G</given-names></name><name><surname>Dłotko</surname><given-names>P</given-names></name><name><surname>Levi</surname><given-names>R</given-names></name><name><surname>Hess</surname><given-names>K</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017b</year><article-title>Cliques of neurons bound into cavities provide a missing link between structure and function</article-title><source>Frontiers in Computational Neuroscience</source><volume>11</volume><elocation-id>48</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2017.00048</pub-id><pub-id pub-id-type="pmid">28659782</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reimann</surname><given-names>MW</given-names></name><name><surname>Gevaert</surname><given-names>M</given-names></name><name><surname>Shi</surname><given-names>Y</given-names></name><name><surname>Lu</surname><given-names>H</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Muller</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A null model of the mouse whole-neocortex micro-connectome</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>3903</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-11630-x</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reimann</surname><given-names>MW</given-names></name><name><surname>Egas Santander</surname><given-names>D</given-names></name><name><surname>Ecker</surname><given-names>A</given-names></name><name><surname>Muller</surname><given-names>EB</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Specific inhibition and disinhibition in the higher-order structure of a cortical connectome</article-title><source>Cerebral Cortex</source><volume>34</volume><elocation-id>bhae433</elocation-id><pub-id pub-id-type="doi">10.1093/cercor/bhae433</pub-id><pub-id pub-id-type="pmid">39526523</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronan</surname><given-names>L</given-names></name><name><surname>Pienaar</surname><given-names>R</given-names></name><name><surname>Williams</surname><given-names>G</given-names></name><name><surname>Bullmore</surname><given-names>E</given-names></name><name><surname>Crow</surname><given-names>TJ</given-names></name><name><surname>Roberts</surname><given-names>N</given-names></name><name><surname>Jones</surname><given-names>PB</given-names></name><name><surname>Suckling</surname><given-names>J</given-names></name><name><surname>Fletcher</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Intrinsic curvature: a marker of millimeter-scale tangential cortico-cortical connectivity?</article-title><source>International Journal of Neural Systems</source><volume>21</volume><fpage>351</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1142/S0129065711002948</pub-id><pub-id pub-id-type="pmid">21956929</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santuy</surname><given-names>A</given-names></name><name><surname>Turégano-López</surname><given-names>M</given-names></name><name><surname>Rodríguez</surname><given-names>JR</given-names></name><name><surname>Alonso-Nanclares</surname><given-names>L</given-names></name><name><surname>DeFelipe</surname><given-names>J</given-names></name><name><surname>Merchán-Pérez</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A quantitative study on the distribution of mitochondria in the neuropil of the juvenile rat somatosensory cortex</article-title><source>Cerebral Cortex</source><volume>28</volume><fpage>3673</fpage><lpage>3684</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhy159</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scannell</surname><given-names>JW</given-names></name><name><surname>Blakemore</surname><given-names>C</given-names></name><name><surname>Young</surname><given-names>MP</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Analysis of connectivity in the cat cerebral cortex</article-title><source>The Journal of Neuroscience</source><volume>15</volume><fpage>1463</fpage><lpage>1483</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.15-02-01463.1995</pub-id><pub-id pub-id-type="pmid">7869111</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Schneider-Mizell</surname><given-names>CM</given-names></name><name><surname>Bodor</surname><given-names>AL</given-names></name><name><surname>Brittain</surname><given-names>D</given-names></name><name><surname>Buchanan</surname><given-names>J</given-names></name><name><surname>Bumbarger</surname><given-names>DJ</given-names></name><name><surname>Elabbady</surname><given-names>L</given-names></name><name><surname>Gamlin</surname><given-names>C</given-names></name><name><surname>Kapner</surname><given-names>D</given-names></name><name><surname>Kinn</surname><given-names>S</given-names></name><name><surname>Mahalingam</surname><given-names>G</given-names></name><name><surname>Seshamani</surname><given-names>S</given-names></name><name><surname>Suckow</surname><given-names>S</given-names></name><name><surname>Takeno</surname><given-names>M</given-names></name><name><surname>Torres</surname><given-names>R</given-names></name><name><surname>Yin</surname><given-names>W</given-names></name><name><surname>Dorkenwald</surname><given-names>S</given-names></name><name><surname>Bae</surname><given-names>JA</given-names></name><name><surname>Castro</surname><given-names>MA</given-names></name><name><surname>Halageri</surname><given-names>A</given-names></name><name><surname>Jia</surname><given-names>Z</given-names></name><name><surname>Jordan</surname><given-names>C</given-names></name><name><surname>Kemnitz</surname><given-names>N</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>K</given-names></name><name><surname>Lu</surname><given-names>R</given-names></name><name><surname>Macrina</surname><given-names>T</given-names></name><name><surname>Mitchell</surname><given-names>E</given-names></name><name><surname>Mondal</surname><given-names>SS</given-names></name><name><surname>Mu</surname><given-names>S</given-names></name><name><surname>Nehoran</surname><given-names>B</given-names></name><name><surname>Popovych</surname><given-names>S</given-names></name><name><surname>Silversmith</surname><given-names>W</given-names></name><name><surname>Turner</surname><given-names>NL</given-names></name><name><surname>Wong</surname><given-names>W</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Reimer</surname><given-names>J</given-names></name><name><surname>Tolias</surname><given-names>AS</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name><name><surname>Reid</surname><given-names>RC</given-names></name><name><surname>Collman</surname><given-names>F</given-names></name><name><surname>Maçarico da Costa</surname><given-names>N</given-names></name><collab>MICrONS Consortium</collab></person-group><year iso-8601-date="2024">2024</year><article-title>Cell-type-specific inhibitory circuitry from a connectomic census of mouse visual cortex</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.01.23.525290</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scholtens</surname><given-names>LH</given-names></name><name><surname>Schmidt</surname><given-names>R</given-names></name><name><surname>de Reus</surname><given-names>MA</given-names></name><name><surname>van den Heuvel</surname><given-names>MP</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Linking macroscale graph analytical organization to microscale neuroarchitectonics in the macaque connectome</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>12192</fpage><lpage>12205</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0752-14.2014</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schüz</surname><given-names>A</given-names></name><name><surname>Palm</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Density of neurons and synapses in the cerebral cortex of the mouse</article-title><source>Journal of Comparative Neurology</source><volume>286</volume><fpage>442</fpage><lpage>455</lpage><pub-id pub-id-type="pmid">2778101</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sermet</surname><given-names>BS</given-names></name><name><surname>Truschow</surname><given-names>P</given-names></name><name><surname>Feyerabend</surname><given-names>M</given-names></name><name><surname>Mayrhofer</surname><given-names>JM</given-names></name><name><surname>Oram</surname><given-names>TB</given-names></name><name><surname>Yizhar</surname><given-names>O</given-names></name><name><surname>Staiger</surname><given-names>JF</given-names></name><name><surname>Petersen</surname><given-names>CC</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Pathway-, layer- and cell-type-specific thalamic input to mouse barrel cortex</article-title><source>eLife</source><volume>8</volume><elocation-id>e52665</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.52665</pub-id><pub-id pub-id-type="pmid">31860443</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shepherd</surname><given-names>GMG</given-names></name><name><surname>Yamawaki</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Untangling the cortico-thalamo-cortical loop: cellular pieces of a knotty circuit puzzle</article-title><source>Nature Reviews. Neuroscience</source><volume>22</volume><fpage>389</fpage><lpage>406</lpage><pub-id pub-id-type="doi">10.1038/s41583-021-00459-3</pub-id><pub-id pub-id-type="pmid">33958775</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sizemore</surname><given-names>AE</given-names></name><name><surname>Giusti</surname><given-names>C</given-names></name><name><surname>Kahn</surname><given-names>A</given-names></name><name><surname>Vettel</surname><given-names>JM</given-names></name><name><surname>Betzel</surname><given-names>RF</given-names></name><name><surname>Bassett</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Cliques and cavities in the human connectome</article-title><source>Journal of Computational Neuroscience</source><volume>44</volume><fpage>115</fpage><lpage>145</lpage><pub-id pub-id-type="doi">10.1007/s10827-017-0672-6</pub-id><pub-id pub-id-type="pmid">29143250</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Somogyi</surname><given-names>P</given-names></name><name><surname>Freund</surname><given-names>TF</given-names></name></person-group><year iso-8601-date="1989">1989</year><chapter-title>Immunocytochemistry and synaptic relationships of physiologically characterized HRP-filled neurons</chapter-title><person-group person-group-type="editor"><name><surname>Heimer</surname><given-names>L</given-names></name><name><surname>Záborszky</surname><given-names>L</given-names></name></person-group><source>Neuroanatomical Tract-Tracing Methods 2</source><publisher-name>Elsevier</publisher-name><fpage>239</fpage><lpage>264</lpage><pub-id pub-id-type="doi">10.1007/978-1-4757-2055-6_9</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>S</given-names></name><name><surname>Sjöström</surname><given-names>PJ</given-names></name><name><surname>Reigl</surname><given-names>M</given-names></name><name><surname>Nelson</surname><given-names>S</given-names></name><name><surname>Chklovskii</surname><given-names>DB</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Highly nonrandom features of synaptic connectivity in local cortical circuits</article-title><source>PLOS Biology</source><volume>3</volume><elocation-id>e68</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0030068</pub-id><pub-id pub-id-type="pmid">15737062</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sporns</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Structure and function of complex brain networks</article-title><source>Dialogues in Clinical Neuroscience</source><volume>15</volume><fpage>247</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.31887/DCNS.2013.15.3/osporns</pub-id><pub-id pub-id-type="pmid">24174898</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storey</surname><given-names>JD</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Statistical significance for genomewide studies</article-title><source>PNAS</source><volume>100</volume><fpage>9440</fpage><lpage>9445</lpage><pub-id pub-id-type="doi">10.1073/pnas.1530509100</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tazerart</surname><given-names>S</given-names></name><name><surname>Mitchell</surname><given-names>DE</given-names></name><name><surname>Miranda-Rottmann</surname><given-names>S</given-names></name><name><surname>Araya</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A spike-timing-dependent plasticity rule for dendritic spines</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>4276</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-17861-7</pub-id><pub-id pub-id-type="pmid">32848151</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomson</surname><given-names>AM</given-names></name><name><surname>West</surname><given-names>DC</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Bannister</surname><given-names>AP</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Synaptic connections and small circuits involving excitatory and inhibitory neurons in layers 2-5 of adult rat and cat neocortex: triple intracellular recordings and biocytin labelling in vitro</article-title><source>Cerebral Cortex</source><volume>12</volume><fpage>936</fpage><lpage>953</lpage><pub-id pub-id-type="doi">10.1093/cercor/12.9.936</pub-id><pub-id pub-id-type="pmid">12183393</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Toledo‐Rodriguez</surname><given-names>M</given-names></name><name><surname>Goodman</surname><given-names>P</given-names></name><name><surname>Illic</surname><given-names>M</given-names></name><name><surname>Wu</surname><given-names>C</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Neuropeptide and calcium‐binding protein gene expression profiles predict neuronal anatomical type in the juvenile rat</article-title><source>The Journal of Physiology</source><volume>567</volume><fpage>401</fpage><lpage>413</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2005.089250</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Towlson</surname><given-names>EK</given-names></name><name><surname>Vértes</surname><given-names>PE</given-names></name><name><surname>Ahnert</surname><given-names>SE</given-names></name><name><surname>Schafer</surname><given-names>WR</given-names></name><name><surname>Bullmore</surname><given-names>ET</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The rich club of the <italic>C. elegans</italic> neuronal connectome</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>6380</fpage><lpage>6387</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3784-12.2013</pub-id><pub-id pub-id-type="pmid">23575836</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tremblay</surname><given-names>R</given-names></name><name><surname>Lee</surname><given-names>S</given-names></name><name><surname>Rudy</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>GABAergic interneurons in the neocortex: from cellular properties to circuits</article-title><source>Neuron</source><volume>91</volume><fpage>260</fpage><lpage>292</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.06.033</pub-id><pub-id pub-id-type="pmid">27477017</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Udvary</surname><given-names>D</given-names></name><name><surname>Harth</surname><given-names>P</given-names></name><name><surname>Macke</surname><given-names>JH</given-names></name><name><surname>Hege</surname><given-names>H-C</given-names></name><name><surname>de Kock</surname><given-names>CPJ</given-names></name><name><surname>Sakmann</surname><given-names>B</given-names></name><name><surname>Oberlaender</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The impact of neuron morphology on cortical network architecture</article-title><source>Cell Reports</source><volume>39</volume><elocation-id>110677</elocation-id><pub-id pub-id-type="doi">10.1016/j.celrep.2022.110677</pub-id><pub-id pub-id-type="pmid">35417720</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Unger</surname><given-names>F</given-names></name><name><surname>Krebs</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>MCMC sampling of directed flag complexes with fixed undirected graphs</article-title><source>Journal of Applied and Computational Topology</source><volume>8</volume><fpage>1881</fpage><lpage>1916</lpage><pub-id pub-id-type="doi">10.1007/s41468-024-00178-5</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van den Heuvel</surname><given-names>MP</given-names></name><name><surname>Sporns</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Rich-club organization of the human connectome</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>15775</fpage><lpage>15786</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3539-11.2011</pub-id><pub-id pub-id-type="pmid">22049421</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagstyl</surname><given-names>K</given-names></name><name><surname>Larocque</surname><given-names>S</given-names></name><name><surname>Cucurull</surname><given-names>G</given-names></name><name><surname>Lepage</surname><given-names>C</given-names></name><name><surname>Cohen</surname><given-names>JP</given-names></name><name><surname>Bludau</surname><given-names>S</given-names></name><name><surname>Palomero-Gallagher</surname><given-names>N</given-names></name><name><surname>Lewis</surname><given-names>LB</given-names></name><name><surname>Funck</surname><given-names>T</given-names></name><name><surname>Spitzer</surname><given-names>H</given-names></name><name><surname>Dickscheid</surname><given-names>T</given-names></name><name><surname>Fletcher</surname><given-names>PC</given-names></name><name><surname>Romero</surname><given-names>A</given-names></name><name><surname>Zilles</surname><given-names>K</given-names></name><name><surname>Amunts</surname><given-names>K</given-names></name><name><surname>Bengio</surname><given-names>Y</given-names></name><name><surname>Evans</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>BigBrain 3D atlas of cortical layers: Cortical and laminar thickness gradients diverge in sensory and motor cortices</article-title><source>PLOS Biology</source><volume>18</volume><elocation-id>e3000678</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000678</pub-id><pub-id pub-id-type="pmid">32243449</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>EL</given-names></name><name><surname>Keller</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Intrinsic circuitry involving the local axon collaterals of corticothalamic projection cells in mouse SmI cortex</article-title><source>The Journal of Comparative Neurology</source><volume>262</volume><fpage>13</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1002/cne.902620103</pub-id><pub-id pub-id-type="pmid">3624546</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winnubst</surname><given-names>J</given-names></name><name><surname>Bas</surname><given-names>E</given-names></name><name><surname>Ferreira</surname><given-names>TA</given-names></name><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Economo</surname><given-names>MN</given-names></name><name><surname>Edson</surname><given-names>P</given-names></name><name><surname>Arthur</surname><given-names>BJ</given-names></name><name><surname>Bruns</surname><given-names>C</given-names></name><name><surname>Rokicki</surname><given-names>K</given-names></name><name><surname>Schauder</surname><given-names>D</given-names></name><name><surname>Olbris</surname><given-names>DJ</given-names></name><name><surname>Murphy</surname><given-names>SD</given-names></name><name><surname>Ackerman</surname><given-names>DG</given-names></name><name><surname>Arshadi</surname><given-names>C</given-names></name><name><surname>Baldwin</surname><given-names>P</given-names></name><name><surname>Blake</surname><given-names>R</given-names></name><name><surname>Elsayed</surname><given-names>A</given-names></name><name><surname>Hasan</surname><given-names>M</given-names></name><name><surname>Ramirez</surname><given-names>D</given-names></name><name><surname>Dos Santos</surname><given-names>B</given-names></name><name><surname>Weldon</surname><given-names>M</given-names></name><name><surname>Zafar</surname><given-names>A</given-names></name><name><surname>Dudman</surname><given-names>JT</given-names></name><name><surname>Gerfen</surname><given-names>CR</given-names></name><name><surname>Hantman</surname><given-names>AW</given-names></name><name><surname>Korff</surname><given-names>W</given-names></name><name><surname>Sternson</surname><given-names>SM</given-names></name><name><surname>Spruston</surname><given-names>N</given-names></name><name><surname>Svoboda</surname><given-names>K</given-names></name><name><surname>Chandrashekar</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Reconstruction of 1,000 projection neurons reveals new cell types and organization of long-range connectivity in the mouse brain</article-title><source>Cell</source><volume>179</volume><fpage>268</fpage><lpage>281</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.07.042</pub-id><pub-id pub-id-type="pmid">31495573</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>M</given-names></name><name><surname>Berchet</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Appositionizer</data-title><version designator="1.0.0">1.0.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/appositionizer/releases/tag/v1.0.0">https://github.com/BlueBrain/appositionizer/releases/tag/v1.0.0</ext-link></element-citation></ref><ref id="bib113"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>M</given-names></name><name><surname>Pereira</surname><given-names>F</given-names></name><name><surname>Ji</surname><given-names>W</given-names></name><name><surname>Lupton</surname><given-names>O</given-names></name><name><surname>Carel</surname><given-names>T</given-names></name><name><surname>Grosheintz</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Functionalizer</data-title><version designator="1.0.0">1.0.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/BlueBrain/functionalizer/releases/tag/v1.0.0">https://github.com/BlueBrain/functionalizer/releases/tag/v1.0.0</ext-link></element-citation></ref><ref id="bib114"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>JG</given-names></name><name><surname>Petri</surname><given-names>G</given-names></name><name><surname>Vaccarino</surname><given-names>F</given-names></name><name><surname>Patania</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Construction of and efficient sampling from the simplicial configuration model</article-title><source>Physical Review. E</source><volume>96</volume><elocation-id>032312</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.96.032312</pub-id><pub-id pub-id-type="pmid">29346916</pub-id></element-citation></ref><ref id="bib115"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Yusufoğulları</surname><given-names>S</given-names></name><name><surname>Kılınç</surname><given-names>D</given-names></name><name><surname>Vardar</surname><given-names>B</given-names></name><name><surname>Güçlü</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Histological study of layer thickness in different cortical areas in rat</article-title><conf-name>2015 19th National Biomedical Engineering Meeting (BIYOMUT</conf-name><conf-loc>Istanbul, Turkey</conf-loc><fpage>1</fpage><lpage>4</lpage><pub-id pub-id-type="doi">10.1109/BIYOMUT.2015.7369435</pub-id></element-citation></ref><ref id="bib116"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>C</given-names></name><name><surname>Stepanyants</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Robust associative learning is sufficient to explain the structural and dynamical properties of local cortical circuits</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>6888</fpage><lpage>6904</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3218-18.2019</pub-id><pub-id pub-id-type="pmid">31270161</pub-id></element-citation></ref><ref id="bib117"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>S</given-names></name><name><surname>Mondragon</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The rich-club phenomenon in the internet topology</article-title><source>IEEE Communications Letters</source><volume>8</volume><fpage>180</fpage><lpage>182</lpage><pub-id pub-id-type="doi">10.1109/LCOMM.2004.823426</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.99688.3.sa0</article-id><title-group><article-title>eLife Assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Naud</surname><given-names>Richard</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>University of Ottawa</institution><country>Canada</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Solid</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Valuable</kwd></kwd-group></front-stub><body><p>This manuscript reports a detailed model of juvenile rat somatosensory cortex, consisting of 4.2 million morphologically and biophysically detailed neuron models, arranged in space and connected according to diverse experimental data - a <bold>valuable</bold> tool for the field. The construction of the model is based on a methodology with <bold>solid</bold> supporting evidence. It should be noted that, by necessity, such a large-scale model development involves many assumptions, interpolations, and decisions that could have compounding downstream effects on further analyses that may be difficult to disambiguate.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.99688.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>In this study, the authors describe the construction of an extremely large-scale anatomical model of juvenile rat somatosensory cortex (excluding the barrel region), which extends earlier iterations of these models by expanding across multiple interconnected cortical areas. The models are constructed in a way to maintain biological detail from a granular scale - for example, individual cell morphologies are maintained, and synaptic connectivity is founded on anatomical contacts. The authors use this model to investigate a variety of properties, from cell-type specific targeting (where the model results are compared to findings from recent large-scale electron microscopy studies) to network metrics. The model is also intended to serve as a platform and resource for the community by being a foundation for simulations of neuronal circuit activity and for additional anatomical studies that rely on the detailed knowledge of cellular identity and connectivity.</p><p>Strengths:</p><p>As the authors point out, the combination of scale and granularity of their model are what make this study valuable and unique. The comparisons with recent electron microscopy findings are some of the most compelling results presented in the study, showing that certain connectivity patterns can arise directly from the anatomical configuration, while other discrepancies highlight where more selective targeting rules (perhaps based on molecular cues) are likely employed. They also describe intriguing effects of cortical thickness and curvature on circuit connectivity and characterize the magnitude of those effects on different cortical layers.</p><p>The detailed construction of the model is drawn on wide range of data sources (cellular and synaptic density measures, neuronal morphologies, cellular composition measures, brain geometry, etc.) that are integrated together; other data sources are used for comparison and validation. This consolidation and comparison also represents a valuable contribution to the overall understanding of the modeled system.</p><p>Weaknesses:</p><p>The scale of the model, which is a primary strength, also can carry some drawbacks. In order to integrate all the diverse data sources together, many specific decisions must be made about, for example, translating findings from different species or regions to the modeled system, or deciding which aspects of the system can be assumed to be same and which should vary. All these decisions will have effects on the predicted results from the model, which could limit the types of conclusions that can be made (both by the others and by others in the community who may wish to use the model for their own work). However, the public release of the models and most of the associated tools does provide others a somewhat easier path to modify and evaluate this iteration of the model for their own studies.</p><p>Overall, the model presented in this study represents an enormous amount of work and stands as the basis for other work by the same group as well as a unique resource for the community, even while acknowledging that it may be somewhat unwieldy for the community to employ due to the weight of its manifold specific construction decisions, size, and complexity.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.99688.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The authors build a colossal anatomical model of juvenile rat non-barrel primary somatosensory cortex, including inputs from the thalamus. This enhances past models by incorporating information on the shape of the cortex and estimated densities of various types of excitatory and inhibitory neuron across layers. This is intended to enable analysis of the micro- and mesoscopic organisation of cortical connectivity and to be a base anatomical model for large-scale simulations of physiology.</p><p>Strengths:</p><p>• The authors incorporate many diverse data sources on morphology and connectivity.</p><p>• This paper takes on the challenging task of linking micro- and meso-scale connectivity</p><p>• By building in the shape of the cortex, the authors were able to link cortical geometry to connectivity. In particular they make an unexpected prediction that cortical conicality affects the modularity of local connectivity, which should be testable.</p><p>• The author's analysis of the model led to the interesting prediction that layer 5 neurons' connect local modules, which may be testable in the future, and provide a basis to link from detailed anatomy to functional computations.</p><p>• The visualisation of the anatomy in various forms is excellent</p><p>• The model is openly shared</p><p>Weaknesses:</p><p>• There is no effort to determine how specific or generalisable the findings here are to other parts of cortex.</p><p>• Although there is a link to physiological modelling in another paper, there is no clear pathway to go from this type of model to understanding how the specific function of the modelled areas may emerge here (and not in other cortical areas).</p><p>• Some of the decisions seem a little ad-hoc, and the means to assess those decisions is not always easily available to the reader</p><p>• The shape of the juvenile cortex - a key novelty of this work - was based on merely a scalar reduction of the adult cortex. This is very surprising, and surely an oversimplification. Huge efforts have gone into modelling the complex nonlinear development of cortex, by teams including the developing Human Connectome Project. For such a fundamental aspect of this work, why isn't it possible to reconstruct the shape of this relatively small part of juvenile rat cortex?</p><p>• The same relative laminar depths are used for all subregions. This will have a large impact on the model. However, relative laminar depths can change drastically across the cortex (see e.g. many papers by Palomero-Gallagher, Zilles and colleagues). The authors should incorporate the real laminar depths, or, failing that, show evidence to show that the laminar depth differences across the subregions included in the model are negligible.</p><p>• The authors perform an affine mapping between mouse and rat cortex. This is again surprising. In human imaging, affine mappings are insufficient to map between two individual brains of the same species, and nonlinear transformations are instead used. That an affine transformation should be considered sufficient to map between two different species is then very surprising. For some models, this may be fine, but there is a supposed emphasis here on biological precision in terms of anatomical location.</p><p>o Live nature of the model. This is such a colossal model, and effort, that I worry that it may be quite difficult to update in light of new data. For example, how much person and compute time would it take to update the model to account for different layer sizes across subregions? Or to more precisely account for the shape of juvenile rat cortex?</p></body></sub-article><sub-article article-type="referee-report" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.99688.3.sa3</article-id><title-group><article-title>Reviewer #3 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>This manuscript reports a detailed model of the rat non-barrel somatosensory cortex, consisting of 4.2 million morphologically and biophysically detailed neuron models, arranged in space and connected according to highly sophisticated rules informed by diverse experimental data. Due to its breadth and sophistication the model will undoubtedly be of interest to the community, and the reporting of anatomical details of modeling in this paper is important for understanding all the assumptions and procedures involved in constructing the model. While a useful contribution to this field, the model and the manuscript could be improved by employing data more directly and comparing simple features of the model's connectivity - in particular, connection probabilities - with relevant experimental data.</p><p>The manuscript is overall well-written, but contains a substantial number of confusing or unclear statements, and some important information is not provided.</p><p>Comments on revisions:</p><p>The authors mostly addressed all my points and improved the paper substantially. I do not have further extensive comments except one general point below.</p><p>Regarding section 2.3 and metrics of connectivity like pairwise connection probabilities, it is great that the authors rewrote that section and added comparisons with experimental data in Figs. 4 and S9. Unfortunately, what one finds when direct comparisons are made is that the modeled pairwise connectivity is quite different from the data. Fig. S9 shows that the model's results do not agree with data in about half of the cases (purple and red arrows). Similarly large discrepancies can be seen for some other metrics, like in Fig. S10B and S10C1,C2. (And similar concerns apply to thalamocortical connections in section 2.5, where it looks like little to no data are available to verify the pairwise connectivity between the thalamic and cortical neurons via a direct comparison.)</p><p>This is concerning since this model forms the basis for multiple other studies of cortical dynamics and function by the same group and potentially others in the community, with multiple papers relying on it, whereas basic properties of connectivity are apparently not captured well.</p><p>On the other hand, this is also a &quot;glass half full&quot; situation, showing that the sophisticated algorithms for establishing connections, developed by the authors, are working well in at least half of the connection types explored. It is therefore imperative that the authors continue refining these algorithms to capture the remaining half in future iterations and producing improved models that the community can better rely on.</p><p>Please also note that Fig. S11 does not have a caption.</p></body></sub-article><sub-article article-type="author-comment" id="sa4"><front-stub><article-id pub-id-type="doi">10.7554/eLife.99688.3.sa4</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Reimann</surname><given-names>Michael W</given-names></name><role specific-use="author">Author</role><aff><institution>École polytechnique fédérale de Lausanne (EPFL), Campus Biotech</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Bolaños-Puchet</surname><given-names>Sirio</given-names></name><role specific-use="author">Author</role><aff><institution>École polytechnique fédérale de Lausanne (EPFL), Campus Biotech</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Courcol</surname><given-names>Jean-Denis</given-names></name><role specific-use="author">Author</role><aff><institution>École polytechnique fédérale de Lausanne (EPFL), Campus Biotech</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Egas Santander</surname><given-names>Daniela</given-names></name><role specific-use="author">Author</role><aff><institution>École polytechnique fédérale de Lausanne (EPFL), Campus Biotech</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Arnaudon</surname><given-names>Alexis</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Coste</surname><given-names>Benoît</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Delalondre</surname><given-names>Fabien</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Delemontex</surname><given-names>Thomas</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Devresse</surname><given-names>Adrien</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Dictus</surname><given-names>Hugo</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Dietz</surname><given-names>Alexander</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Ecker</surname><given-names>Andras</given-names></name><role specific-use="author">Author</role><aff><institution>École polytechnique fédérale de Lausanne (EPFL), Campus Biotech</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Favreau</surname><given-names>Cyrille</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Ficarelli</surname><given-names>Gianluca</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Gevaert</surname><given-names>Mike</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Switzerland</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Herttuainen</surname><given-names>Joni</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Isbister</surname><given-names>James</given-names></name><role specific-use="author">Author</role><aff><institution>University of Oxford</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff></contrib><contrib contrib-type="author"><name><surname>Kanari</surname><given-names>Lida</given-names></name><role specific-use="author">Author</role><aff><institution>École polytechnique fédérale de Lausanne (EPFL), Campus Biotech</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Keller</surname><given-names>Daniel X</given-names></name><role specific-use="author">Author</role><aff><institution>EPFL</institution><addr-line><named-content content-type="city">Lausanne</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>King</surname><given-names>James</given-names></name><role specific-use="author">Author</role><aff><institution>EPFL</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Kumbhar</surname><given-names>Pramod</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Lapere</surname><given-names>Samuel</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Lazovskis</surname><given-names>Jānis</given-names></name><role specific-use="author">Author</role><aff><institution>Riga Technical University</institution><addr-line><named-content content-type="city">Riga</named-content></addr-line><country>Latvia</country></aff></contrib><contrib contrib-type="author"><name><surname>Lu</surname><given-names>Huanxiang</given-names></name><role specific-use="author">Author</role><aff><institution>École polytechnique fédérale de Lausanne (EPFL), Campus Biotech</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Ninin</surname><given-names>Nicolas</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Pereira</surname><given-names>Fernando</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Planas</surname><given-names>Judit</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Pokorny</surname><given-names>Christoph</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Riquelme</surname><given-names>Juan Luis</given-names></name><role specific-use="author">Author</role><aff><institution>Max Planck Institute for Brain Research</institution><addr-line><named-content content-type="city">Frankfurt</named-content></addr-line><country>Germany</country></aff></contrib><contrib contrib-type="author"><name><surname>Romani</surname><given-names>Armando</given-names></name><role specific-use="author">Author</role><aff><institution>École polytechnique fédérale de Lausanne (EPFL), Campus Biotech</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Shi</surname><given-names>Ying</given-names></name><role specific-use="author">Author</role><aff><institution>EPFL</institution><addr-line><named-content content-type="city">Lausanne</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Smith</surname><given-names>Jason P</given-names></name><role specific-use="author">Author</role><aff><institution>Charleston</institution><addr-line><named-content content-type="city">Charleston, SC</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Sood</surname><given-names>Vishal</given-names></name><role specific-use="author">Author</role><aff><institution>École Polytechnique Fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Srivastava</surname><given-names>Mohit</given-names></name><role specific-use="author">Author</role><aff><institution>Hungarian Research Network</institution><addr-line><named-content content-type="city">Budapest</named-content></addr-line><country>Hungary</country></aff></contrib><contrib contrib-type="author"><name><surname>Van Geit</surname><given-names>Wener</given-names></name><role specific-use="author">Author</role><aff><institution>Ecole polytechnique f´ed´erale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Vanherpe</surname><given-names>Liesbeth</given-names></name><role specific-use="author">Author</role><aff><institution>École polytechnique fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Wolf</surname><given-names>Matthias</given-names></name><role specific-use="author">Author</role><aff><institution>École polytechnique fédérale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Levi</surname><given-names>Ran</given-names></name><role specific-use="author">Author</role><aff><institution>University of Aberdeen</institution><addr-line><named-content content-type="city">Aberdeen</named-content></addr-line><country>United Kingdom</country></aff></contrib><contrib contrib-type="author"><name><surname>Hess</surname><given-names>Kathryn</given-names></name><role specific-use="author">Author</role><aff><institution>EPFL</institution><addr-line><named-content content-type="city">Lausanne</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Schuermann</surname><given-names>Felix</given-names></name><role specific-use="author">Author</role><aff><institution>Brain Mind Institute, EPFL</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Muller</surname><given-names>Eilif B</given-names></name><role specific-use="author">Author</role><aff><institution>University of Montreal</institution><addr-line><named-content content-type="city">Montreal</named-content></addr-line><country>Canada</country></aff></contrib><contrib contrib-type="author"><name><surname>Markram</surname><given-names>Henry</given-names></name><role specific-use="author">Author</role><aff><institution>´Ecole polytechnique f´ed´erale de Lausanne</institution><addr-line><named-content content-type="city">Geneva</named-content></addr-line><country>Switzerland</country></aff></contrib><contrib contrib-type="author"><name><surname>Ramaswamy</surname><given-names>Srikanth</given-names></name><role specific-use="author">Author</role><aff><institution>Newcastle University</institution><addr-line><named-content content-type="city">Newcastle</named-content></addr-line><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Public Reviews:</bold></p><p><bold>Reviewer #1 (Public Review):</bold></p><p>Summary:</p><p>In this study, the authors describe the construction of an extremely large-scale anatomical model of juvenile rat somatosensory cortex (excluding the barrel region), which extends earlier iterations of these models by expanding across multiple interconnected cortical areas. The models are constructed in such a way as to maintain biological detail from a granular scale - for example, individual cell morphologies are maintained, and synaptic connectivity is founded on anatomical contacts. The authors use this model to investigate a variety of properties, from cell-type specific targeting (where the model results are compared to findings from recent large-scale electron microscopy studies) to network metrics. The model is also intended to serve as a platform and resource for the community by being a foundation for simulations of neuronal circuit activity and for additional anatomical studies that rely on the detailed knowledge of cellular identity and connectivity.</p><p>Strengths:</p><p>As the authors point out, the combination of scale and granularity of their model is what makes this study valuable and unique. The comparisons with recent electron microscopy findings are some of the most compelling results presented in the study, showing that certain connectivity patterns can arise directly from the anatomical configuration, while other discrepancies highlight where more selective targeting rules (perhaps based on molecular cues) are likely employed. They also describe intriguing effects of cortical thickness and curvature on circuit connectivity and characterize the magnitude of those effects on different cortical layers.</p><p>The detailed construction of the model is drawn on a wide range of data sources (cellular and synaptic density measures, neuronal morphologies, cellular composition measures, brain geometry, etc.) that are integrated together; other data sources are used for comparison and validation. This consolidation and comparison also represent a valuable contribution to the overall understanding of the modeled system.</p></disp-quote><p>We thank the reviewer for the kind comments.</p><disp-quote content-type="editor-comment"><p>Weaknesses:</p><p>The scale of the model, which is a primary strength, also can carry some drawbacks. In order to integrate all the diverse data sources together, many specific decisions must be made about, for example, translating findings from different species or regions to the modeled system, or deciding which aspects of the system can be assumed to be the same and which should vary. All these decisions will have effects on the predicted results from the model, which could limit the types of conclusions that can be made (both by the others and by others in the community who may wish to use the model for their own work).</p></disp-quote><p>We agree that this is a downside of the principle of biophysically detailed modeling that is best addressed by continuous refinement in collaboration with the community. We would like to once again invite any interested party to participate in this process.</p><disp-quote content-type="editor-comment"><p>As an example, while it is interesting that broad brain geometry has effects on network structure (Figure 7), it is not clear how those effects are actually manifested. I am not sure if some of the effects could be due to the way the model is constructed - perhaps there may be limited sets of morphologies that fit into columns of particular thicknesses, and those morphologies may have certain idiosyncrasies that could produce different statistics of connectivities where they are heavily used. That may be true to biology, but it may also be somewhat artifactual if, for example, the only neurons in the library that fit into that particular part of the cortex differ from the typical neurons that are actually found in that region (but may not have been part of the morphological sampling).</p></disp-quote><p>We agree that the limited pool of morphological reconstructions can lead to artifactual results in the way the reviewer pointed out. To investigate that hypothesis, we added a supplementary figure (S14) where we characterize (1): to what degree the morphological composition of a columnar subvolume reflects the overall composition of the model; and (2): The level of morphological diversity in each columnar subvolume. We discuss the results at the end of section 2.6. Briefly, while we cannot fully rule out the possibility of an artificial result, we found a high and virtually uniform level of morphological diversity in all columns and layers. This makes it unlikely that individual idiosyncratic morphologies strongly affect the local connectivity. However, we acknowledge that the minimum level of morphological diversity required is unknown. We believe that at this stage all we can do is characterize this and leave final interpretation to the reader.</p><disp-quote content-type="editor-comment"><p>I also wonder how much the assumption that the layers have the same relative thicknesses everywhere in the cortex affects these findings, since layer thicknesses do in fact vary across the cortex.</p></disp-quote><p>We agree that layer thickness variation would affect circuit properties. Variability of layer thickness can be split into two components: variability stemming from differences in total thickness, which our model covers, and variability of relative, i.e., normalized layer thickness, which we miss. In this region of cortex, though, data on the relative thickness of cortical layers is sparse. The Waxholm Atlas does not distinguish somatosensory cortical layers in its labels [Kleven et al, 2023]. Yusufoğulları (2015) compares layer thicknesses of rat hindlimb and barrel field regions. After normalization against total thickness, the relative difference increased towards the superficial layers from 0 in L6 to 33% in L1. Variability of normalized thicknesses within developed rat barrel cortex, based on layer boundaries reported in Narayanan et al. (2017) vary by 2% to 5% over approximately 2 mm. One major effect of such variability would be to scale the number of neurons in a given layer locally by the corresponding factors. For comparison, the resulting variability in neuron counts due to differences in conicality (Fig. 7D1) was around +-25%. A further effect of variable relative layer thickness would be its impact on the selection of suitable morphologies to be placed in the volume.</p><p>In summary, adjustment of layer thickness is a refinement which should be done in future versions of the model, once more data is available. The discussion section has been updated to acknowledge this limitation. However, as outlined at the beginning of this point-by-point reply, we will not conduct such updates to the model in the context of this manuscript, as it describes the version of the model used for a number of follow-up studies.</p><disp-quote content-type="editor-comment"><p>In addition, the complexity of the model means that some complicated analyses and decisions are only presented in this manuscript with perhaps a single panel and not much textual explanation. I find, for example, that the panels of Figure S2 seem to abstract or simplify many details to the point where I am not clear about what they are actually illustrating - how does Figure S2D represent the results of &quot;the process illustrated in B&quot;? Why are there abrupt changes in connectivity at region borders (shown as discontinuous colors), when dendrites and axons span those borders and so would imply interconnectivity across the borders? What do the histograms in E1 and E2 portray, and how are they related to each other?</p></disp-quote><p>We apologize for the confusion. We have updated the figure caption of Figure S2 to better explain its contents.</p><disp-quote content-type="editor-comment"><p>Overall, the model presented in this study represents an enormous amount of work and stands as a unique resource for the community, but also is made somewhat unwieldy for the community to employ due to the weight of its manifold specific construction decisions, size, and complexity.</p><p><bold>Reviewer #2 (Public Review):</bold></p><p>Summary:</p><p>The authors build a colossal anatomical model of juvenile rat non-barrel primary somatosensory cortex, including inputs from the thalamus. This enhances past models by incorporating information on the shape of the cortex and estimated densities of various types of excitatory and inhibitory neurons across layers. This is intended to enable an analysis of the micro- and mesoscopic organisation of cortical connectivity and to be a base anatomical model for large-scale simulations of physiology.</p><p>Strengths:</p><p>• The authors incorporate many diverse data sources on morphology and connectivity.</p><p>• This paper takes on the challenging task of linking micro- and mesoscale connectivity.</p><p>• By building in the shape of the cortex, the authors were able to link cortical geometry to connectivity. In particular, they make an unexpected prediction that cortical conicality affects the modularity of local connectivity, which should be testable.</p><p>• The author's analysis of the model led to the interesting prediction that layer 5 neurons connect local modules, which may be testable in the future, and provide a basis to link from detailed anatomy to functional computations.</p><p>• The visualisation of the anatomy in various forms is excellent.</p><p>• A subnetwork of the model is openly shared (but see question below).</p></disp-quote><p>We thank the reviewer for their kind comments.</p><disp-quote content-type="editor-comment"><p>Weaknesses:</p><p>• Why was non-barrel S1 of the juvenile rat cortex selected as the target for this huge modelling effort? This is not explained.</p></disp-quote><p>We have added an explanation of this decision to the third paragraph of the introduction.</p><disp-quote content-type="editor-comment"><p>• There is no effort to determine how specific or generalisable the findings here are to other parts of the cortex. Although there is a link to physiological modelling in another paper, there is no clear pathway to go from this type of model to understand how the specific function of the modelled areas may emerge here (and not in other cortical areas).</p></disp-quote><p>With respect to generality against specific findings, our philosophy is as follows: Despite the fact that most of our source data comes from juvenile rat somatosensory cortex, we also had to generalize many data sources across organisms, ages or regions. Hence, in this iteration we focused on investigating the general features of the (multi-region) mammalian cortex, e.g., high-order motifs, connected by L5 neurons across subregions or the effect of curvature on the connectivity. In the future, more specific data sources can be used to build diverging versions of the model, e.g. one for adult vs. juvenile rat. They can then be used to contrast the ages and focus on more specific findings. We already defined a number of structural metrics that can be used to contrast more specific versions of the model quantitatively.</p><p>We now clarify this pathway to understanding more specific function in the last paragraph of the discussion.</p><disp-quote content-type="editor-comment"><p>• In a few places the manuscript could be improved by being more specific in the language, for example:</p><p>- &quot;our anatomy-based approach has been shown to be powerful&quot;, I would prefer instead to read about specific contributions of past papers to the field, and how this builds on them.</p><p>- similarly: &quot;ensuring that the total number of synapses in a region-to-region pathway matches biology.&quot; Biology here is a loose term and implies too much confidence in the matching to some ground truth. Please instead describe the source of the data, including the type of experiment.</p></disp-quote><p>We have removed or rewritten the mentioned parts. We now clarify that we work based on biological estimates from experiments and cite the experiment sources. We also provide brief descriptions of the types of data and how they were derived.</p><disp-quote content-type="editor-comment"><p>• Some of the decisions seem a little ad-hoc, and the means to assess those decisions are not always available to the reader e.g.</p><p>- pg. 10. &quot;Based on these results, we decided that the local connectome sufficed to model connectivity within a region.&quot;. What is the basis for this decision? Can it be formalised?</p><p>- &quot;In the remaining layers the results of the objective classification were used to validate the class assignments of individual pyramidal cells. We found the objective classification to match the expert classification closely (i.e., for 80-90% of the morphologies). Consequently, we considered the expert classification to be sufficiently accurate to build the model.&quot; The description of the validation is a little informal. How many experts were there? What are their initials? Was inter-rater or intra-rater reliability assessed? What are these numbers? The match with Kanari's classification accuracy should be reported exactly. There are clearly experts among the author list, but we are all fallible without good controls in place, and they should be more explicit about those controls here, in my opinion.</p><p>- &quot;Morphology selection was then performed as previously (Markram et al., 2015), that is, a morphology was selected randomly from the top 10% scorers for a given position.&quot; A lot of the decisions seem a little ad-hoc, without justification other than this group had previously done the same thing. For example, why 10% here? Shouldn't this be based on selecting from all of the reasonable morphologies?</p></disp-quote><p>We have clarified that the density of local connectivity is verified against the validation datasets by comparing the diagonals in Figure 4B, in addition to the quantification of Figure 4C.</p><p>For the classification, we have now published a detailed preprint describing the objective confirmation of expert classification by a variety of methods (see Kanari et al. 2024 https://www.biorxiv.org/content/10.1101/2024.09.13.612635v1). We cannot include the full methodology in the current paper, due to its large extent. For the benefit of the reader, we have included the appropriate citation and extended the short description of the methodology. As described in this paper, the classification accuracy varies per layer, cell type, etc. We have now described in more details these results, that can be accessed in details in out preprint.</p><disp-quote content-type="editor-comment"><p>• I would like to know if one of the key results relating to modularity and cortical geometry can be further explored. In particular, there seem to be sharp changes in the data at the end of the modelled cortical regions, which need to be explored or explained further.</p></disp-quote><p>We now explore these results further in supplementary figure S15, which we discuss in the results Section 2.6.</p><disp-quote content-type="editor-comment"><p>• The shape of the juvenile cortex - a key novelty of this work - was based on merely a scalar reduction of the adult cortex. This is very surprising, and surely an oversimplification. Huge efforts have gone into modelling the complex nonlinear development of the cortex, by teams including the developing Human Connectome Project. For such a fundamental aspect of this work, why isn't it possible to reconstruct the shape of this relatively small part of the juvenile rat cortex?</p></disp-quote><p>We agree that a more complex approach should be used in the future. However, as outlined at the beginning of this point-by-point reply, we will not conduct such updates to the model in the context of this manuscript, as it describes the version of the model used for a number of follow-up studies.</p><disp-quote content-type="editor-comment"><p>• The same relative laminar depths are used for all subregions. This will have a large impact on the model. However, relative laminar depths can change drastically across the cortex (see e.g. many papers by Palomero-Gallagher, Zilles, and colleagues). The authors should incorporate the real laminar depths, or, failing that, show evidence to show that the laminar depth differences across the subregions included in the model are negligible.</p></disp-quote><p>This point has also been raised by reviewer #1 above. For convenience, we repeat our reply below.</p><p>We agree that layer thickness variation would affect circuit properties. Variability of layer thickness can be split into two components: variability stemming from differences in total thickness, which our model covers, and variability of relative, i.e., normalized layer thickness, which we miss. In this region of cortex, though, data on the relative thickness of cortical layers is sparse. The Waxholm Atlas does not distinguish somatosensory cortical layers in its labels [Kleven et al, 2023]. Yusufoğulları (2015) compares layer thicknesses of rat hindlimb and barrel field regions. After normalization against total thickness, the relative difference increased towards the superficial layers from 0 in L6 to 33% in L1. Variability of normalized thicknesses within developed rat barrel cortex, based on layer boundaries reported in Narayanan et al. (2017) vary by 2% to 5% over approximately 2 mm. One major effect of such variability would be to scale the number of neurons in a given layer locally by the corresponding factors. For comparison, the resulting variability in neuron counts due to differences in conicality (Fig. 7D1) was around +-25%. A further effect of variable relative layer thickness would be its impact on the selection of suitable morphologies to be placed in the volume.</p><p>In summary, adjustment of layer thickness is a refinement which should be done in future versions of the model, once more data is available. The discussion section has been updated to acknowledge this limitation. However, as outlined at the beginning of this point-by-point reply, we will not conduct such updates to the model in the context of this manuscript, as it describes the version of the model used for a number of follow-up studies.</p><disp-quote content-type="editor-comment"><p>• The authors perform an affine mapping between mouse and rat cortex. This is again surprising. In human imaging, affine mappings are insufficient to map between two individual brains of the same species and nonlinear transformations are instead used. That an affine transformation should be considered sufficient to map between two different species is then very surprising. For some models, this may be fine, but there is a supposed emphasis here on biological precision in terms of anatomical location.</p></disp-quote><p>We agree that this is a weakness that we will address in future revisions of the model.</p><disp-quote content-type="editor-comment"><p>• One of the most interesting conclusions, that the connectivity pattern observed is in part due to cooperative synapse formation, is based on analyses that are unfortunately not shown.</p></disp-quote><p>We originally decided not to show this part as we underestimated the interest in this particular result. We have now included the result in supplementary figure S10 and discuss the figure in the results.</p><disp-quote content-type="editor-comment"><p>• Open code:</p><p>- Why is only a subvolume available to the community?</p></disp-quote><p>We have now made the entire model available under <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.7910/DVN/HISHXN">doi.org/10.7910/DVN/HISHXN.</ext-link> The Data and Code availability section has been updated to clarify this.</p><disp-quote content-type="editor-comment"><p>- Live nature of the model. This is such a colossal model, and effort, that I worry that it may be quite difficult to update in light of new data. For example, how much person and computer time would it take to update the model to account for different layer sizes across subregions? Or to more precisely account for the shape of the juvenile rat cortex?</p></disp-quote><p>To provide more information to people interested in participating in model refinements, we have added a new Figure 9. We discuss potential opportunities for refinement at the end of the discussion section.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Public Review):</bold></p><p>This manuscript reports a detailed model of the rat non-barrel somatosensory cortex, consisting of 4.2 million morphologically and biophysically detailed neuron models, arranged in space and connected according to highly sophisticated rules informed by diverse experimental data. Due to its breadth and sophistication, the model will undoubtedly be of interest to the community, and the reporting of anatomical details of modeling in this paper is important for understanding all the assumptions and procedures involved in constructing the model. While a useful contribution to this field, the model and the manuscript could be improved by employing data more directly and comparing simple features of the model's connectivity - in particular, connection probabilities - with relevant experimental data.</p><p>The manuscript is well-written overall but contains a substantial number of confusing or unclear statements, and some important information is not provided.</p><p>Below, major concerns are listed, followed by more specific but still important issues.</p><p>Major issues</p><p>(1) Cortical connectivity.</p><p>Section 2.3, &quot;Local, mid-range and extrinsic connectivity modeled separately&quot;, and Figure 4: I am confused about what is done here and why. The authors have target data for connectivity (Figure 4B1). But then they use an apposition-based algorithm that results in connectivity that is quite different from the data (Figure 4B2, C). They then use a correction based on the data (Figure 4E) to arrive at a more realistic connectivity. Why not set the connectivity based on the data right away then? That would seem like a more straightforward approach.</p></disp-quote><p>We have completely re-written our description and discussion of connectivity in the model. We now more explicitly motivate our connectivity modeling choices in the first paragraph of section 2.3 of the results and in the second paragraph of the discussion.</p><disp-quote content-type="editor-comment"><p>The same comment applies to Section 2.4., &quot;Specificity of axonal targeting&quot;: the distributions of synapses on different types of target cell compartments were not well captured by the original model based on axon-dendrite overlap and pruning, so the authors introduced further pruning to match data specificity. While details of this process and what worked and what didn't may be interesting to some, overall it is not surprising, as it has been well known that cell types exhibit connectivity that is much more specific than &quot;Peters rule&quot; or its simple variations. The question is, since one has the data, why not use the data in the first place to set up the connectivity, instead of using the convoluted process of employing axon-dendrite overlap followed by multiple corrections?</p></disp-quote><p>We would like to point out that we are not employing “Peters rule”, we now make this explicit in the revision in the first paragraph of section 2.3 of the results. Furthermore, we would argue that the match to the Motta et al. data indicates that our approach is more than just a “simple variation”. Finally, we believe that there is important insight in: 1. The specific ways in which the algorithm had to be changed to match the Schneider-Mizell data, e.g. that the connectivity of SST positive neurons did not have to be adapted at all. 2. That the specificity of the other two types could still be matched by a selection of a subset of axonal appositions (i.e., of potential synapses).</p><disp-quote content-type="editor-comment"><p>Most importantly, what is missing from the whole paper is the characterization of connection probabilities, at least for the local circuit within one area. Such connection probabilities can be obtained from the data that the authors already use here, such as the MICRONS dataset. Another good source of such data is Campagnola et al., Science, 2022. Both datasets are for mouse V1, but they provide a comprehensive characterization across all cortical layers, thus offering a good benchmark for comparison of the model with the data. It would be important for the authors to show how connection probabilities realized in their model for different cell types compared to these data.</p></disp-quote><p>We now report connection probabilities in the reworked figure 4 and compare them to reported connection probabilities from many different sources and labs in supplementary figure S8. We prefer a comparison to a wide range of sources to relying on a single report.</p><disp-quote content-type="editor-comment"><p>(2) Section 2.5, &quot;Structure of thalamic inputs&quot; and Figure 6.</p><p>The text in section 2.5 should provide more details on what was done - namely, that the thalamic axons were generated based on the axon density profiles and then synapses were established based on their overall with cortical dendrites. Figure S10 where the target axon densities from data and the model axon densities are compared is not even mentioned here. Now, Figure S10 only shows that the axon densities were generated in a way that matches the data reasonably well. However, how can we know that it results in connectivity that agrees with data? Are there data sources that can be used for that purpose? For example, the authors show that in their model &quot;the peaks of the mean number of thalamic inputs per neuron occur at lower depths than the peaks of the synaptic density&quot;. Is this prediction of the model consistent with any available data?</p><p>Most importantly, the authors should show how the different cell types in their model are targeted by the thalamic inputs in each layer. Experimental studies have been done suggesting specificity in targeting of interneuron types by thalamic axons, such as PV cells being targeted strongly whereas SST and VIP cells being targeted less.</p></disp-quote><p>We have updated the Results section to provide context for the thalamic axon placement, and referred the reader to the methods for more detail. A reference to Figure S10 has now been added to this section as well.</p><p>As for validations of the structure of the thalamo-cortical inputs: We found that the existing literature on the topic, such as Cruikshank et al., 2007, 2010 and more recently Sermet et al., 2019, is predominately on the physiological strengths of the pathways. We acknowledge that the authors provide compelling arguments that their findings are likely partially due to differences in the anatomical innervation strengths. On the other hand, Sporns, 2013 cautioned against mixing up structural and functional connectivity. Overall, we believe that it is simply cleaner to perform this validation in the accompanying manuscript (“Part II: Physiology and Experimentation”), using the full physiological model. Note that we have actually performed that validation in the manuscript (see preprint under the following doi: 10.1101/2023.05.17.541168, Figure 3H1).</p><p>Note that a higher physiological strength onto PV+ neurons is observed.</p><disp-quote content-type="editor-comment"><p>(3) &quot;We have therefore made not only the model but also most of our tool chain openly available to the public (Figure 1; step 7).&quot;</p><p>In fact it is not the whole model that is made publicly available, but only about 5% of it (211,000 out of 4,200,000 neurons). Also, why is &quot;most&quot; of the tool chain made openly available, and not the whole tool chain?</p></disp-quote><p>We have now made the entire model available under doi.org/10.7910/DVN/HISHXN. This has also been added to the Key resource table.</p><p>With regard to the tool chain, everything is on our public github (https://github.com/BlueBrain/) except for the algorithm for detecting axonal appositions. For that tool there are currently unresolved potential copyright issues with former collaboration partners. We are working to resolve them.</p><disp-quote content-type="editor-comment"><p>Other issues</p><p>&quot;At each soma location, a reconstruction of the corresponding m-type was chosen based on the size and shape of its dendritic and axonal trees (Figure S6). Additionally, it was rotated to according to the orientation towards the cortical surface at that point.&quot;</p><p>After this procedure, were cells additionally rotated around the white matter-pia axis? If yes, then how much and randomly or not? If not, then why not? Such rotations would seem important because otherwise additional order potentially not present in the real cortex is introduced in the model affecting connectivity and possibly also in vivo physiology (such as the dynamics of the extracellular electric field).</p></disp-quote><p>They are indeed additionally randomly rotated. We have clarified this in the revision.</p><disp-quote content-type="editor-comment"><p>The term &quot;new in vivo reconstructions&quot; for the 58 neurons used in this paper in addition to &quot;in vitro reconstructions&quot; is a misnomer. It is not straightforward to see where the procedure is described, but then one finds that the part of Methods that describes experimental manipulations is mostly about that (so, a clearer pointer to that part of Methods could be useful). However, the description in Methods makes it clear that it is only labeling that is done in vivo; the microscopy and reconstruction are done subsequently in vitro. I would recommend changing the terminology here, as it is confusing. Also, can the authors show reconstructions of these neurons in the supplementary figures? Is the reconstruction shown in Figure 4A representative?</p></disp-quote><p>The term is used because the staining is done in vivo. To the best of our knowledge, the reconstruction process cannot be performed in vivo. However, to avoid any confusion we modified the text to clarify this distinction to in-vivo stained.</p><p>With respect to the reconstruction in Figure 4: The intent of the panel is to demonstrate the concept of targeted long-range axons that our morphologies are missing, necessitating the use of a second algorithm for longer-range connectivity. As such, it is not one of the reconstructions we used, but one of Janelia MouseLight. While we mentioned MouseLight in the figure caption, we formulated it in a way that could be misunderstood to mean that we merely used the MouseLight browser to render one of our morphologies. We apologize for the confusion, and we have fixed the figure caption.</p><p>In this revision we have added exemplars of representative morphology reconstructions (in slice stained and in vivo stained) in a new supplementary figure, as requested (Figure S5). It is referenced in the last paragraph of section 2.1.</p><disp-quote content-type="editor-comment"><p>In the Discussion, &quot;This was taken into account during the modeling of the anatomical composition, e.g. by using three-dimensional, layer-specific neuron density profiles that match biological measurements, and by ensuring the biologically correct orientation of model neurons with respect to the orientation towards the cortical surface. As local connectivity was derived from axo-dendritic appositions in the anatomical model, it was strongly affected by these aspects.</p><p>However, this approach alone was insufficient at the large spatial scale of the model, as it was limited to connections at distances below 1000μm.&quot;</p><p>As mentioned above, it is not clear that this approach was sufficient for local connectivity either. It would be great if the authors showed a systematic comparison of local connection probabilities between different cell types in their model with experimental data and commented here in the Discussion about how well the model agrees with the data.</p></disp-quote><p>As mentioned in the reply to a previous comment, we now report connection probabilities.</p><disp-quote content-type="editor-comment"><p>In the Discussion: &quot;The combined connectome therefore captures important correlations at that level, such as slender-tufted layer 5 PCs sending strong non-local cortico-cortical connections, but thick-tufted layer 5 PCs not.&quot; (Also the corresponding findings in Results.)</p><p>If I understand this statement correctly, it may not agree with biological data. See analysis from MICRONS dataset in Bodor et al., <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2023.10.18.562531v1">https://www.biorxiv.org/content/10.1101/2023.10.18.562531v1</ext-link>.</p></disp-quote><p>Our statement was indeed misleading and formulated too strongly. While thick-tufted pyramidal cells do form long-range intra-cortical connections, the structural strength of these pathways is weaker than for slender-tufted PCs, which are associated with the IT (intra-telencephalic) projection type. We have made this clear in the revision.</p><disp-quote content-type="editor-comment"><p>Table 2 is confusing. What do pluses and minuses mean? What does it mean that some entries have two pluses? This table is not mentioned anywhere else in the text. If pluses mean some meaningful predictions of the model, then their distribution in the table seems quite liberal and arbitrary. It is not clear to me that the model makes that many predictions, especially for type-specificity and plasticity. Also, why is the hippocampus mentioned in this table? I don't see anything about the hippocampus anywhere else in the paper.</p></disp-quote><p>We have clarified the description of the table in its caption and removed references to hippocampus, which were left from an earlier draft of the paper.</p><disp-quote content-type="editor-comment"><p>In the Discussion, &quot;Thus, we made the tools to improve our model also openly available (see Data and Code availability section).&quot;</p><p>As mentioned before, the authors themselves write that they made &quot;most of our tool chain openly available to the public&quot;, but not all of it.</p></disp-quote><p>With regard to the tool chain, everything is on our public github (https://github.com/BlueBrain/) except for the algorithm for detecting axonal appositions. For that tool there are currently unresolved potential copyright issues with former collaboration partners. We are working to resolve them.</p><disp-quote content-type="editor-comment"><p>Table S2 has multiple question marks. It is not clear whether the &quot;predictions&quot; listed in that table are truly well-thought-out and/or whether experimental confirmations are real.</p></disp-quote><p>Some of the citations in that table were broken due to technical difficulties with the citation manager used. We apologize and have fixed this in the revision.</p><disp-quote content-type="editor-comment"><p>Introduction: It would be quite appropriate to cite here Einevoll et al., Neuron, 2019 (&quot;The Scientific Case for Brain Simulations&quot;).</p></disp-quote><p>We now reference this important work.</p><disp-quote content-type="editor-comment"><p><bold>Recommendations for the authors:</bold></p><p><bold>Reviewing Editor's note:</bold></p><p>Consultation with the reviewers highlighted three main issues: the integration of connection probability profiles, non-uniform cortical thickness, and the overall organization of the manuscript.</p><p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p><p>Apart from the points discussed in the public review, my main concern is that the manuscript itself is not as tightly constructed as it should be, to the detriment of the reader's ability to understand the model itself and the conclusions from the presented analyses.</p><p>There are places where the text references seemingly incorrect figure panels or refers to panels that don't exist:</p><p>- Section 2.2, first paragraph - refers to Figure 2D, E but those panels do not exist in Figure 2.</p><p>- Section 2.2, second paragraph - refers to Figure 3D3 - perhaps it should be 3B3?</p><p>- Section 2.8, first paragraph - has no figure references but seems like it should be referring to parts of Figure 8 (perhaps Figure 8B1 specifically?)</p><p>- Is the reference to Figure S11A on page 16 supposed to be to S12A?</p><p>In other places, figure labels and descriptions are not clear, and terminology is not always well-defined or explained.</p><p>- Figure 8 and the associated section 2.8 are very difficult to draw conclusions from as presented - several of the terms used are opaque and not clearly defined in the text or legends. I could not easily infer how the normalization works for the &quot;normalized node participation per layer&quot;, or what &quot;position in simplex&quot; means for &quot;unique neurons in core&quot;, and what their &quot;relative counts&quot; are relative to.</p><p>- Are &quot;targets&quot; in Figure S12A the same as &quot;sinks&quot;? If so, it would be better to use a single term consistently throughout.</p><p>- Figure S12 - figures in part B do not have enough labels to interpret - what is the y-axis of the &quot;rich-club analysis&quot; graph? Also, the figures in part B bottom are labeled &quot;long-range&quot; rather than &quot;mid-range&quot; connections.</p><p>In general, I found the use of both letters and numbers for figure panels (e.g. Figure 7E1) more confusing than helpful - it didn't seem like panels with the same letter were visually grouped consistently, and it sometimes made it more difficult to follow the flow of a figure. I would recommend using only letters in nearly every case here.</p></disp-quote><p>We thank the reviewer for directing our attention to these issues. We have fixed them in the revision. However, we have decided to keep our original panel numbering scheme. Panels with the same letter are meant to be conceptually grouped as they address related or similar measures.</p><disp-quote content-type="editor-comment"><p>Other minor points:</p><p>- Section 2.4 - paragraph 2 - sentence 5 &quot;inhbititory&quot; -&gt; &quot;inhibitory&quot;.</p><p>- Figure 5B figure legend - references Schneider-Mizell et al. 2023 but probably should be Motta et al. 2019?</p><p>- Figure 5C - figure key &quot;expcected&quot; -&gt; &quot;expected&quot;.</p><p>- The lower part of Figure 7C looks like it belongs to panel D2 instead of panel C due to relative spacing.</p></disp-quote><p>We once again thank the reviewer, and we have fixed the listed issues.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p><p>(1) Abstract:</p><p>- Is it really 'integrating whole brain-scale data'? This seems a bit misleading.</p><p>- &quot;We delineated the limits of determining connectivity from anatomy&quot; - here I think you mean determining connectivity from morphology, or dendrite/axon appositions. Electron microscopy is still anatomy and presumably would be much closer to function.</p></disp-quote><p>We originally used the term “anatomy” as connectivity depends on the correct placement of neurons in addition to their morphology. However, as the reviewer points out, this term is misleading as it would encompass electron microscopy, which can go beyond what we do with the model. We have updated the text to read “morphology and placement”.</p><disp-quote content-type="editor-comment"><p>(2) Introduction:</p><p>&quot;Investigating the multi-scale interactions that shape perception requires a model of multiple cortical subregions with inter-region connectivity, but it also requires the subcellular resolution provided by a morphologically detailed model.&quot; - This statement, as written, is not true in my opinion. You can argue for the value of morphologically-detailed neuron models to the study of perception, but they are not required for the investigation of perception.</p></disp-quote><p>We have updated the text to be clearer: subcellular resolution is only required for certain aspects that are related to perception.</p><disp-quote content-type="editor-comment"><p>(3) Results:</p><p>- Pg. 9/10. There are three sentences in a row that are of the style: &quot;ensuring that the total number of synapses in a region-to-region pathway matches biology.&quot; Biology here is a loose term and implies too much confidence in the matching to some ground truth. Please instead describe the source of the data, including the type of experiment here already. o Pg. 10. On the first read, I found it quite hard to follow what exactly was done in Figure 4.</p><p>What are the target values adapted from Reimann et al., 2019, for example?</p><p>- Pg. 10. &quot;Based on these results, we decided that the local connectome sufficed to model connectivity within a region.&quot;. What is the basis for this decision? Can it be formalised? o Pg. 16, Figure 7 B-C. The apparent effect of geometry on modularity is potentially very interesting. However, are the sharp drop-offs in values for modularity (but also conicality and height) true, or are some artefacts due to columns at the edges of the sampled area?</p></disp-quote><p>We have discussed these points above in the general comments and strengths and weaknesses.</p><disp-quote content-type="editor-comment"><p>- Pg. 18. Simplicial cores define central subnetworks, tied together by mid-range connections. This work, in particular leading to the conclusion of the layer 5 highway hubs, stands out as being a successful attempt to simplify the highly detailed model to a degree that it generates useable new understanding.</p></disp-quote><p>We thank the reviewer for the kind comment.</p><disp-quote content-type="editor-comment"><p>(4) Figures:</p><p>Figure 2: The caption doesn't seem to match the Figure (e.g. there are no brain regions depicted in A). o Figure 4f. This is a key panel, but is squished into a small corner of Figure 4, and therefore hard-to-read.</p></disp-quote><p>We have fixed this in the revision.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p><p>In Major comments, point (1) discusses the issue of connectivity known from data. For all the aspects of connectivity mentioned there, I would recommend the authors re-build their model using the connectivity data directly. It would be interesting to test whether a model constructed in such a way would have any difference in simulated neural activity relative to the model they have constructed.</p></disp-quote><p>This is indeed a very interesting avenue of research. However, we believe that it is best conducted in separate manuscripts. First, in Pokorny et al., 2024 (https://doi.org/10.1101/2024.05.24.593860) we conduct this investigation, comparing the emerging activity in the model to the one for simpler connectivity models. Additionally, in Egas-Santander et al., 2024 (https://www.biorxiv.org/content/10.1101/2024.03.15.585196v3) we found that simpler connectomes lead to less reliable spiking activity globally. Finally, in the accompanying manuscript (https://www.biorxiv.org/content/10.1101/2023.05.17.541168v5) we compare activity with and without the targeting specificity of Schneider-Mizell et al.</p><disp-quote content-type="editor-comment"><p>In Major comments, point (2) discusses thalamic inputs. I would recommend the authors to address the issues mentioned there.</p></disp-quote><p>We have replied to those comments above.</p><disp-quote content-type="editor-comment"><p>In addition, panels F and G of Figure 6 are mentioned in the caption but are not shown in the figure. In panel B, the choice of visualization is strange. It would make sense to show box plots for all the data instead of bars for mean values and points for randomly selected 50 cells. Panels E1 and E2 lack units.</p></disp-quote><p>We have removed mentions of panels F and G and changed the style of plot. Units for E1 and E2 are now explained in the figure caption.</p><disp-quote content-type="editor-comment"><p>In Major comments, point (3) touches upon model and tool sharing. I would recommend making such statements more accurate and reflecting what exactly is provided to the community since not everything is shared.</p></disp-quote><p>We have now made the entire model available under doi.org/10.7910/DVN/HISHXN.</p><p>With regard to the tool chain, everything is on our public github (https://github.com/BlueBrain/) except for the algorithm for detecting axonal appositions. For that tool there are currently unresolved potential copyright issues with former collaboration partners. We are working to resolve them.</p><disp-quote content-type="editor-comment"><p>I would recommend the authors address all the other points mentioned in the public review as well. In addition, below are some smaller issues that should be fixed.</p><p>Figure 2: the caption appears to be partially wrong and partially misassigned to the figure panels.</p></disp-quote><p>We fixed the issue.</p><disp-quote content-type="editor-comment"><p>Also, note that in L6 the types L6_TPC:A and L6_TPC:C are listed in the figure, but L6_TPC:B is not mentioned.</p></disp-quote><p>There is indeed no TPC:B type in layer 6. The distinction between TPC:A and TPC:B is based on early or late bifurcations of the apical dendrite and is only observed in layer 5.</p><disp-quote content-type="editor-comment"><p>Figure 3, panel B2: the caption refers to colors in panel (C), but the authors probably meant to refer to panel (A).</p></disp-quote><p>We fixed the issue.</p><disp-quote content-type="editor-comment"><p>&quot;The placement of morphological reconstructions matched expectation, showing an appropriately layered structure with only small parts of neurites leaving the modeled volume (Figure 2D, E).&quot;</p><p>Figure 2 does not have panels D and E.</p><p>&quot;The volume was clearly dominated by dendrites, filling between 23% and 47% of the space, compared to 2% to 11% for axons (Figure 3D3).&quot; There is no panel D or D3 in Figure 3.</p><p>&quot;Recently, the MICrONS dataset (MICrONS-Consortium et al., 2021) has been analyzed with respect to the axonal targeting of inhibitory subtypes in a 100 x 100 μm subvolume spanning all layers (Schneider-Mizell et al., 2023).&quot;</p><p>100 x 100 μm is an area (and should be 100 x 100 μm^2), not a volume.</p><p>Figure S11B requires a legend for the color map.</p></disp-quote><p>We fixed the issues.</p><disp-quote content-type="editor-comment"><p>Table S1: What is the difference between L6_BP and L6_BPC? They both are referred to as L6 bipolar cells.</p></disp-quote><p>We have changed the description of L6_BPC to “Layer 6 bitufted pyramidal cell”.</p></body></sub-article></article>