<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">75842</article-id><article-id pub-id-type="doi">10.7554/eLife.75842</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Heterogeneity of the GFP fitness landscape and data-driven protein design</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-262992"><name><surname>Gonzalez Somermeyer</surname><given-names>Louisa</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9139-5383</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-36147"><name><surname>Fleiss</surname><given-names>Aubin</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-19441"><name><surname>Mishin</surname><given-names>Alexander S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4935-7030</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-262993"><name><surname>Bozhanova</surname><given-names>Nina G</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2164-5698</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-221296"><name><surname>Igolkina</surname><given-names>Anna A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8851-9621</contrib-id><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-262994"><name><surname>Meiler</surname><given-names>Jens</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8945-193X</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-262995"><name><surname>Alaball Pujol</surname><given-names>Maria-Elisenda</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1868-2674</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-262996"><name><surname>Putintseva</surname><given-names>Ekaterina V</given-names></name><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-188484"><name><surname>Sarkisyan</surname><given-names>Karen S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5375-6341</contrib-id><email>karen.s.sarkisyan@gmail.com</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-4128"><name><surname>Kondrashov</surname><given-names>Fyodor A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8243-4694</contrib-id><email>fyodor.kondrashov@oist.jp</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff9">9</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03gnh5541</institution-id><institution>Institute of Science and Technology Austria</institution></institution-wrap><addr-line><named-content content-type="city">Klosterneuburg</named-content></addr-line><country>Austria</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05p1n6x86</institution-id><institution>Synthetic Biology Group, MRC London Institute of Medical Sciences</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/041kmwe10</institution-id><institution>Institute of Clinical Sciences, Faculty of Medicine and Imperial College Centre for Synthetic Biology, Imperial College London</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05qrfxd25</institution-id><institution>Shemyakin-Ovchinnikov Institute of Bioorganic Chemistry, Russian Academy of Sciences</institution></institution-wrap><addr-line><named-content content-type="city">Moscow</named-content></addr-line><country>Russian Federation</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02vm5rt34</institution-id><institution>Department of Chemistry, Center for Structural Biology, Vanderbilt University</institution></institution-wrap><addr-line><named-content content-type="city">Nashville</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03anc3s24</institution-id><institution>Gregor Mendel Institute, Austrian Academy of Sciences, Vienna BioCenter</institution></institution-wrap><addr-line><named-content content-type="city">Vienna</named-content></addr-line><country>Austria</country></aff><aff id="aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03s7gtk40</institution-id><institution>Institute for Drug Discovery, Medical School, Leipzig University</institution></institution-wrap><addr-line><named-content content-type="city">Leipzig</named-content></addr-line><country>Germany</country></aff><aff id="aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01y659x67</institution-id><institution>LabGenius</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02qg15b79</institution-id><institution>Evolutionary and Synthetic Biology Unit, Okinawa Institute of Science and Technology Graduate University</institution></institution-wrap><addr-line><named-content content-type="city">Okinawa</named-content></addr-line><country>Japan</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Kliebenstein</surname><given-names>Daniel J</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05rrcem69</institution-id><institution>University of California, Davis</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Barkai</surname><given-names>Naama</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0316ej306</institution-id><institution>Weizmann Institute of Science</institution></institution-wrap><country>Israel</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>05</day><month>05</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e75842</elocation-id><history><date date-type="received" iso-8601-date="2021-11-25"><day>25</day><month>11</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-03-25"><day>25</day><month>03</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2021-12-09"><day>09</day><month>12</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.12.08.471728"/></event></pub-history><permissions><copyright-statement>© 2022, Gonzalez Somermeyer et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Gonzalez Somermeyer et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-75842-v3.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-75842-figures-v3.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="commentary" xlink:href="10.7554/eLife.79310"/><abstract><p>Studies of protein fitness landscapes reveal biophysical constraints guiding protein evolution and empower prediction of functional proteins. However, generalisation of these findings is limited due to scarceness of systematic data on fitness landscapes of proteins with a defined evolutionary relationship. We characterized the fitness peaks of four orthologous fluorescent proteins with a broad range of sequence divergence. While two of the four studied fitness peaks were sharp, the other two were considerably flatter, being almost entirely free of epistatic interactions. Mutationally robust proteins, characterized by a flat fitness peak, were not optimal templates for machine-learning-driven protein design – instead, predictions were more accurate for fragile proteins with epistatic landscapes. Our work paves insights for practical application of fitness landscape heterogeneity in protein engineering.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>fitness landscape</kwd><kwd>molecular evolution</kwd><kwd>protein engineering</kwd><kwd>machine learning</kwd><kwd>GFP</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>771209-CharFL</award-id><principal-award-recipient><name><surname>Kondrashov</surname><given-names>Fyodor A</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution>MRC London Institute of Medical Sciences</institution></institution-wrap></funding-source><award-id>UKRI MC-A658-5QEA0</award-id><principal-award-recipient><name><surname>Sarkisyan</surname><given-names>Karen S</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution>President's Grant</institution></institution-wrap></funding-source><award-id>МК-5405.2021.1.4</award-id><principal-award-recipient><name><surname>Sarkisyan</surname><given-names>Karen S</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution>Marie Skłodowska-Curie Fellowship</institution></institution-wrap></funding-source><award-id>898203</award-id><principal-award-recipient><name><surname>Fleiss</surname><given-names>Aubin</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100006769</institution-id><institution>Russian Science Foundation</institution></institution-wrap></funding-source><award-id>19-74-10102</award-id><principal-award-recipient><name><surname>Sarkisyan</surname><given-names>Karen S</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution>Marie Skłodowska-Curie Grant Agreement</institution></institution-wrap></funding-source><award-id>665385</award-id><principal-award-recipient><name><surname>Gonzalez Somermeyer</surname><given-names>Louisa</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002428</institution-id><institution>FWF Austrian Science Fund</institution></institution-wrap></funding-source><award-id>I5127-B</award-id><principal-award-recipient><name><surname>Kondrashov</surname><given-names>Fyodor A</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Orthologous proteins display different mutational robustness that can be leveraged to improve prediction of functional sequences.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Understanding the relationship between genotype and phenotype, the fitness landscape, elucidates the fundamental laws of heredity (<xref ref-type="bibr" rid="bib10">Canale et al., 2018</xref>; <xref ref-type="bibr" rid="bib16">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="bib21">Ferretti et al., 2018</xref>; <xref ref-type="bibr" rid="bib22">Fragata et al., 2019</xref>; <xref ref-type="bibr" rid="bib72">Wright, 1932</xref>) and may ultimately create novel methods of protein design (<xref ref-type="bibr" rid="bib1">Alley et al., 2019</xref>; <xref ref-type="bibr" rid="bib9">Bryant et al., 2021</xref>; <xref ref-type="bibr" rid="bib28">Hirabayashi and Arai, 2019</xref>; <xref ref-type="bibr" rid="bib71">Wrenbeck et al., 2017</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2019</xref>). The fitness landscape is often conceptualised as a multidimensional surface (<xref ref-type="bibr" rid="bib16">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="bib21">Ferretti et al., 2018</xref>; <xref ref-type="bibr" rid="bib36">Kondrashov and Kondrashov, 2015</xref>; <xref ref-type="bibr" rid="bib72">Wright, 1932</xref>) with one dimension representing fitness, or another phenotype, and the other dimensions each representing a genotype’s locus. Originally, the fitness landscape was introduced to describe the relationship between fitness and the entire genome (<xref ref-type="bibr" rid="bib16">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="bib72">Wright, 1932</xref>). Over time, the usefulness of the concept of the fitness landscape led to the adaptation of this term to describe the relationship between protein function and its protein-coding gene sequence (<xref ref-type="bibr" rid="bib8">Biswas et al., 2021</xref>; <xref ref-type="bibr" rid="bib49">Ogden et al., 2019</xref>; <xref ref-type="bibr" rid="bib57">Romero and Arnold, 2009</xref>; <xref ref-type="bibr" rid="bib70">Wittmann et al., 2021</xref>; <xref ref-type="bibr" rid="bib75">Zheng et al., 2020</xref>). Absolute knowledge of the fitness landscape would reveal the phenotypes conferred by any arbitrary genotype (<xref ref-type="bibr" rid="bib16">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="bib21">Ferretti et al., 2018</xref>; <xref ref-type="bibr" rid="bib22">Fragata et al., 2019</xref>), with immense and obvious practical implications (<xref ref-type="bibr" rid="bib1">Alley et al., 2019</xref>; <xref ref-type="bibr" rid="bib9">Bryant et al., 2021</xref>; <xref ref-type="bibr" rid="bib28">Hirabayashi and Arai, 2019</xref>; <xref ref-type="bibr" rid="bib33">Kemble et al., 2019</xref>; <xref ref-type="bibr" rid="bib71">Wrenbeck et al., 2017</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2019</xref>). However, sparse experimental data, even for specific genes, and the concomitant lack of understanding of the rules by which fitness landscapes are formed, limit the accuracy of phenotype predictions based on sequence alone (<xref ref-type="bibr" rid="bib40">Lässig et al., 2017</xref>) but see <xref ref-type="bibr" rid="bib9">Bryant et al., 2021</xref>; <xref ref-type="bibr" rid="bib56">Rocklin et al., 2017</xref>; <xref ref-type="bibr" rid="bib63">Senior et al., 2020</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2019</xref>.</p><p>While several experimentally characterized fitness landscapes for specific proteins have been reported (<xref ref-type="bibr" rid="bib26">Hartman and Tullman-Ercek, 2019</xref>; <xref ref-type="bibr" rid="bib29">Jacquier et al., 2013</xref>; <xref ref-type="bibr" rid="bib38">Kuo et al., 2020</xref>; <xref ref-type="bibr" rid="bib45">Melamed et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Olson et al., 2014</xref>; <xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>), such surveys of large proteins are still hindered by the enormity of the genotype space (<xref ref-type="bibr" rid="bib16">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="bib72">Wright, 1932</xref>). Even for the Green Fluorescent Protein (GFP), which is only ~250 amino acids long, there are 20<sup>250</sup> possible genotypes. Without complex epistatic interactions between amino acid sites the fitness landscape could be deduced from the independent contribution of each amino acid at each site (<xref ref-type="bibr" rid="bib36">Kondrashov and Kondrashov, 2015</xref>), requiring just 5000 (20*250) measurements of the effects of all single mutations in GFP. However, epistatic interactions between amino acid sites are common (<xref ref-type="bibr" rid="bib59">Russ et al., 2020</xref>) and many of them are too complex to predict with available data (<xref ref-type="bibr" rid="bib53">Pokusaeva et al., 2019</xref>). Despite some advances in the development of data-driven approaches to protein design (<xref ref-type="bibr" rid="bib8">Biswas et al., 2021</xref>; <xref ref-type="bibr" rid="bib7">Biswas et al., 2018</xref>; <xref ref-type="bibr" rid="bib9">Bryant et al., 2021</xref>; <xref ref-type="bibr" rid="bib33">Kemble et al., 2019</xref>), it is still not clear what fraction of the 20<sup>250</sup> sequences of the GFP, or any other gene, must be characterized to approach the coveted absolute knowledge of the fitness landscape (<xref ref-type="bibr" rid="bib33">Kemble et al., 2019</xref>; <xref ref-type="bibr" rid="bib60">Sailer et al., 2020</xref>; <xref ref-type="bibr" rid="bib76">Zhou and McCandlish, 2020</xref>).</p><p>Despite lack of data, experiments and theory provide some insights on the global fitness landscape (<xref ref-type="bibr" rid="bib22">Fragata et al., 2019</xref>; <xref ref-type="bibr" rid="bib33">Kemble et al., 2019</xref>). Each extant genotype, one that is found in an extant species, is a point of high fitness, or a fitness peak, on the highly dimensional and extraordinarily large genotype space (<xref ref-type="bibr" rid="bib16">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="bib22">Fragata et al., 2019</xref>; <xref ref-type="bibr" rid="bib64">Smith, 1970</xref>; <xref ref-type="bibr" rid="bib72">Wright, 1932</xref>). These extant genotypes had a common ancestor, so they must be connected by ridges of high fitness (<xref ref-type="bibr" rid="bib24">Gong et al., 2013</xref>; <xref ref-type="bibr" rid="bib64">Smith, 1970</xref>; <xref ref-type="bibr" rid="bib54">Povolotskaya and Kondrashov, 2010</xref>). Nevertheless, only an infinitesimally small fraction of all genotypes are functional (fewer than 10<sup>–11</sup>), those that correspond to fitness peaks and ridges, and the remaining genotypes confer low fitness (<xref ref-type="bibr" rid="bib31">Keefe and Szostak, 2001</xref>). The fitness peaks are sharp (<xref ref-type="bibr" rid="bib4">Bank et al., 2015</xref>; <xref ref-type="bibr" rid="bib45">Melamed et al., 2013</xref>; <xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>) and the ridges are narrow (<xref ref-type="bibr" rid="bib24">Gong et al., 2013</xref>; <xref ref-type="bibr" rid="bib37">Kumar et al., 2017</xref>; <xref ref-type="bibr" rid="bib53">Pokusaeva et al., 2019</xref>; <xref ref-type="bibr" rid="bib60">Sailer et al., 2020</xref>) and, on average, only a few random mutations in a wildtype sequence reduce its fitness to zero (<xref ref-type="bibr" rid="bib26">Hartman and Tullman-Ercek, 2019</xref>; <xref ref-type="bibr" rid="bib33">Kemble et al., 2019</xref>). The sharpness of the peaks is enhanced by negative epistasis, such that a genotype with several random mutations has a lower fitness than expected if mutations acted independently (<xref ref-type="bibr" rid="bib25">Haddox et al., 2018</xref>; <xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>). Thus, a random walk from a fitness peak eventually leads to an area of the genotype space where only an infinitesimally small fraction of sequences are functional, likely explaining why accurate prediction of functional genotypes at a substantial distance away from a functional genotype remains a challenge (<xref ref-type="bibr" rid="bib1">Alley et al., 2019</xref>; <xref ref-type="bibr" rid="bib28">Hirabayashi and Arai, 2019</xref>; <xref ref-type="bibr" rid="bib59">Russ et al., 2020</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2019</xref>).</p><p>The shape of fitness peaks and ridges, and their distribution in genotype space has implications for fundamental questions in evolution (<xref ref-type="bibr" rid="bib16">de Visser and Krug, 2014</xref>) and practical applications (<xref ref-type="bibr" rid="bib61">Sardanyés et al., 2008</xref>). Evolution starting at a sharp fitness peak is expected to proceed at a different pace than evolution on a flat one (<xref ref-type="bibr" rid="bib6">Bershtein et al., 2006</xref>; <xref ref-type="bibr" rid="bib13">Codoñer et al., 2006</xref>; <xref ref-type="bibr" rid="bib15">de Visser et al., 2003</xref>; <xref ref-type="bibr" rid="bib17">Draghi et al., 2010</xref>; <xref ref-type="bibr" rid="bib68">Wagner, 2008</xref>). Furthermore, it has been suggested that flat fitness peaks, representing robust genotypes, may be evolutionarily preferable to sharp peaks, which represent fragile genotypes (<xref ref-type="bibr" rid="bib6">Bershtein et al., 2006</xref>; <xref ref-type="bibr" rid="bib15">de Visser et al., 2003</xref>; <xref ref-type="bibr" rid="bib17">Draghi et al., 2010</xref>; <xref ref-type="bibr" rid="bib35">Klug et al., 2019</xref>; <xref ref-type="bibr" rid="bib75">Zheng et al., 2020</xref>). However, how different shapes of fitness peaks may be distributed in genotype space has not been explored (<xref ref-type="bibr" rid="bib11">Chan et al., 2017</xref>; <xref ref-type="bibr" rid="bib33">Kemble et al., 2019</xref>). Furthermore, the exploration of the fitness landscape of specific proteins is one of the approaches in protein engineering (<xref ref-type="bibr" rid="bib9">Bryant et al., 2021</xref>; <xref ref-type="bibr" rid="bib57">Romero and Arnold, 2009</xref>; <xref ref-type="bibr" rid="bib59">Russ et al., 2020</xref>; <xref ref-type="bibr" rid="bib70">Wittmann et al., 2021</xref>). Such studies explore the fitness landscape of the protein of interest through deep mutational scan of a known protein sequence. This information is then used to predict novel functional protein sequences that are designed by introducing mutations into the original sequence. Here, we explored the interplay of the heterogeneity of fitness peaks of orthologous sequences and prediction of novel functional protein sequences (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). To this end, we compared the fitness peaks of four GFPs that had different levels of sequence divergence from each other. We then used this information to accurately predict novel functional GFPs at considerable sequence divergence to any known GFP sequence.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Comparison of four GFP fitness peaks.</title><p>(<bold>a</bold>) A conceptual representation of the GFP fitness landscape following the visualization proposed by <xref ref-type="bibr" rid="bib72">Wright, 1932</xref>. The black dotted lines represent the unknown regions of the fitness landscape and the green lines the surveyed local fitness peak. Wildtype GFPs (black +) and the predicted functional GFPs (green +) are shown at an approximate scale of sequence divergence from each other. Between the four wildtype fitness peaks there must also be some unknown but large number of other functional and wildtype GFP sequences. For clarity, we do not draw them in the figure. (<bold>b</bold>) Amino acid sequence identity between different orthologs, displayed in percent. (<bold>c</bold>) Distribution of fluorescence of mutant libraries (colour), control wildtype protein sequences (white), and protein sequences containing loss-of-function mutations in the chromophore (black).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig1-v3.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Distributions of wild-type protein genotypes with and without synonymous mutations.</title><p>Fluorescence level distributions of individual barcodes linked to wild-type nucleotide sequences (colour) versus sequences containing only synonymous mutations (dotted line). The minimum number of observations per barcode was 50. The differences between barcoded wildtypes and synonymous variants in all four libraries was not significant (p-value &gt;0.17, two-tailed Mann Whitney U-test).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig1-figsupp1-v3.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Effects of mutations across the GFP sequences.</title><p>(<bold>a</bold>) Median effects of single mutations according to sequence position. Amino acid residues on one single strand of the beta barrel of GFP monomers. The chromophore sites are hatched (positions 67–69) and sites with buried amino acid side chains are labeled with tick marks. The overlaid protein secondary structure was obtained with Pymol from the respective crystal structures. (<bold>b</bold>), Median effects of single mutations visualized on protein 3D structures, left-to-right: avGFP (2WUR), amacGFP (7LG4), cgreGFP (2HPW), and ppluGFP2 (2G3O). In each case, a single example beta sheet is represented as spheres in order to better illustrate the difference in mutational effects on residues with internally- versus externally-oriented side chains.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig1-figsupp2-v3.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Mutational bias in datasets generated from different mutagenesis strategies.</title><p>(<bold>a</bold>) Observed frequencies of nucleotide mutation types in the four landscapes. Libraries of amacGFP, cgreGFP, and ppluGFP2 were generated with the Mutazyme II kit under the same conditions while the avGFP library was generated by <xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref> employing different dNTP ratios with an in-house error-prone polymerase. ‘Subsampled avGFP’ refers to subsets of 15,000 genotypes of the avGFP library, sampled to mimic the mutational patterns of the Mutazyme-generated libraries. (<bold>b</bold>) Median brightness of genotypes as a function of the number of nucleotide mutations. Black X marks indicate the values for the complete avGFP dataset, and the colored line shows the values for the subsampled datasets whose mutational patterns are shown in the hatched bars in (<bold>a</bold>). Error bars indicate standard deviation for 100 simulations. The horizontal red line indicates the threshold used in <xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>, under which genotypes were considered non-functional. (<bold>c</bold>) Fractions of non-synonymous mutations which result in a significant change in the chemical properties (<xref ref-type="bibr" rid="bib14">Creighton and Creighton, 1993</xref>) of the amino acid. With the exception of histidine (aromatic and positively charged), we considered amino acids as belonging to one of six categories: positively charged (Arg, Lys, His), negatively charged (Glu, Asp), polar uncharged (Ser, Thr, Gln, Asn), aromatic (Tyr, Trp, Phe, His), aliphatic (Ala, Iso, Leu, Met, Val), and other (Gly, Pro, Cys). A type change was considered to occur when a mutation resulted in the new amino acid belonging to a different category from the original. The difference in percentages between the avGFP ratios and the average amacGFP/cgreGFP/ppluGFP2 ratios were not statistically significant (Fisher’s exact test, <italic>P</italic>=0.3).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig1-figsupp3-v3.tif"/></fig></fig-group></sec><sec id="s2" sec-type="results"><title>Results</title><p>To complement the available data on the avGFP fitness peak (<xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>; GFP from <italic>Aequorea victoria,</italic> Hydrozoa), we experimentally characterized three additional GFP sequences, each with a different degree of sequence divergence from avGFP: amacGFP (<italic>Aequorea macrodactyla,</italic> Hydrozoa), cgreGFP (<italic>Clytia gregaria,</italic> Hydrozoa), and ppluGPF2 (<italic>Pontellina plumata</italic>, Copepoda), with 18%, 59%, and 82% sequence divergence, respectively (<xref ref-type="fig" rid="fig1">Figure 1b</xref>; <xref ref-type="table" rid="table1">Table 1</xref>). For simplicity, we refer to all of these sequences as ‘wildtype’, even though only cgreGFP and ppluGPF2 were identical to the true wildtype sequences, while avGFP and amacGFP contain one and three amino acid substitutions, respectively. amacGFP, ppluGFP2, and cgreGFP were subject to a similar experimental pipeline (<xref ref-type="fig" rid="fig2">Figure 2</xref>) as avGFP (<xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>). For each sequence a library of genotypes containing random mutations in the respective GFP sequence was generated by error-prone PCR, in which each GFP gene variant was labelled downstream of its stop codon by a primary barcode, a random combination of nucleotides. This mutant library was expressed as a fusion protein with the red fluorescent protein mKate2 in <italic>E. coli</italic> cells, which were then sorted based on green fluorescence intensity within a narrow red fluorescence gate, to control for gene expression level and other errors (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). The DNA barcodes of the sorted cells were sequenced and these data were used to perform a statistical analysis estimating the level of fluorescence of tens of thousands of GFP genotypes. Three notable improvements to the original experimental pipeline were implemented: gene sequence-agnostic library sequencing, genome integration of the construct, and use of secondary barcodes that introduced internal replicas in the experiment (see Materials and methods). These changes resulted in more physiologically relevant expression levels, made the pipeline more scalable, and reduced the variance of fluorescent genotype measurements by a factor of 7 (<xref ref-type="fig" rid="fig1">Figure 1c</xref>; <xref ref-type="table" rid="table1">Table 1</xref>). The new dataset contained 25,000–35,000 genotypes per each of the three additional fitness peaks, with each mutant genotype harboring on average 3–4 mutations relative to its respective wildtype sequence (<xref ref-type="table" rid="table1">Table 1</xref>). These data, together with data from avGFP, were then used in our comparative study of the GFP fitness peaks (<xref ref-type="fig" rid="fig1">Figure 1a</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Flowthrough of the experimental methodology.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig2-v3.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Distribution of cells during FACS sorting.</title><p>Entire mutant libraries are shown in grey, non-fluorescent negative controls are shown in black. Sorted cells, falling within the selected gate in the mKate2 channel and corresponding to around 10% of all bacterial cells, are shown in red. Vertical dashed lines in the upper histogram indicate the eight gates in the green channel that cells were recovered from. The histograms indicate the distribution of cells in a single channel.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig2-figsupp1-v3.tif"/></fig></fig-group><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>The dataset in numbers.</title><p>The avGFP data is from <xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Gene</th><th align="center" valign="bottom">amacGFP</th><th align="center" valign="bottom">cgreGFP</th><th align="center" valign="bottom">ppluGFP2</th><th align="center" valign="bottom">avGFP</th></tr></thead><tbody><tr><td align="left" valign="bottom">Number of protein genotypes surveyed</td><td align="center" valign="bottom">35,500</td><td align="center" valign="bottom">26,165</td><td align="center" valign="bottom">32,260</td><td align="center" valign="bottom">51,715</td></tr><tr><td align="left" valign="bottom">Average (median) number of AA substitutions per genotype</td><td align="center" valign="bottom">4.37 (3)</td><td align="center" valign="bottom">4.23 (3)</td><td align="center" valign="bottom">3.7 (2)</td><td align="center" valign="bottom">3.93 (4)</td></tr><tr><td align="left" valign="bottom">Average (median) number of barcode replicates per protein genotype</td><td align="center" valign="bottom">8.7 (5)</td><td align="center" valign="bottom">6.8 (5)</td><td align="center" valign="bottom">12 (7)</td><td align="center" valign="bottom">1.2 (1)</td></tr><tr><td align="left" valign="bottom">Amino acid identity</td><td align="center" valign="bottom">avGFP: 82% cgreGFP: 43% ppluGFP2: 17%</td><td align="center" valign="bottom">avGFP: 41% amacGFP: 43% ppluGFP2: 19%</td><td align="center" valign="bottom">avGFP: 18% amacGFP: 17% cgreGFP: 19%</td><td align="center" valign="bottom">amacGFP: 82% cgreGFP: 41% ppluGFP2: 18%</td></tr><tr><td align="left" valign="bottom">False positive rate<xref ref-type="table-fn" rid="table1fn2">*</xref></td><td align="center" valign="bottom">0.55% (9 of 1635)</td><td align="center" valign="bottom">0.75% (14 of 1860)</td><td align="center" valign="bottom">0.49% (11 of 2242)</td><td align="center" valign="bottom">0.24% (2 of 839)</td></tr><tr><td align="left" valign="bottom">False negative rate<xref ref-type="table-fn" rid="table1fn2">*</xref></td><td align="center" valign="bottom">0% (0 of 1084)</td><td align="center" valign="bottom">0% (0 of 1583)</td><td align="center" valign="bottom">0% (0 of 2744)</td><td align="center" valign="bottom">0.08% (2 of 2444)</td></tr><tr><td align="left" valign="bottom">Mean wildtype log10 fluorescence level ± standard deviation</td><td align="center" valign="bottom">3.97±0.031<break/>(3.96±0.030 for amacGFP:V12L)</td><td align="center" valign="bottom">4.50±0.028</td><td align="center" valign="bottom">4.23±0.027</td><td align="center" valign="bottom">3.72±0.082</td></tr><tr><td align="left" valign="bottom">Fraction of genotypes in which epistasis cannot be ascertained<xref ref-type="table-fn" rid="table1fn3">†</xref></td><td align="center" valign="bottom">7.4%</td><td align="center" valign="bottom">15.9%</td><td align="center" valign="bottom">4.5%</td><td align="center" valign="bottom">16.5%</td></tr><tr><td align="left" valign="bottom">Fraction of genotypes displaying |epistasis|&gt;0.3 (&gt;1) <xref ref-type="table-fn" rid="table1fn4">‡</xref></td><td align="center" valign="bottom">5.3% (0.2%)</td><td align="center" valign="bottom">14.4% (5.6%)</td><td align="center" valign="bottom">6.8% (0.9%)</td><td align="center" valign="bottom">21.4% (11.6%)</td></tr><tr><td align="left" valign="bottom">Mutational LD50, loss of function <xref ref-type="table-fn" rid="table1fn5"><sup>§</sup></xref></td><td align="center" valign="bottom">5.8<break/>(5.7 for amacGFP:V12L)</td><td align="center" valign="bottom">3.2</td><td align="center" valign="bottom">6.2</td><td align="center" valign="bottom">4.1</td></tr><tr><td align="left" valign="bottom">Mutational LD50, loss of wildtype-level fluorescence level <xref ref-type="table-fn" rid="table1fn5"><sup>§</sup></xref></td><td align="center" valign="bottom">1.7<break/>(1.8 for amacGFP:V12L)</td><td align="center" valign="bottom">0.9</td><td align="center" valign="bottom">1.7</td><td align="center" valign="bottom">2.2</td></tr><tr><td align="left" valign="bottom">Proportion of machine-learning predicted genotypes displaying epistasis &lt;–0.3 (&lt;-1)</td><td align="center" valign="bottom">78% (46%)</td><td align="center" valign="bottom">57% (21%)</td><td align="center" valign="bottom">81% (64%)</td><td align="center" valign="bottom">NA</td></tr></tbody></table><table-wrap-foot><fn id="table1fn2"><label>*</label><p>False positive rates refer to the fraction of genotypes which are expected to be dark or dim due to chromophore mutations but which were assigned a bright fitness; false negative rates refer to genotypes encoding wildtype protein which were assigned dim or dark fitnesses.</p></fn><fn id="table1fn3"><label>†</label><p>Calculation of epistasis requires knowledge of a genotype’s expected fluorescence, i.e. the sum of contributions of individual mutations. For genotypes with multiple mutations, all individual mutations comprising the genotype must have been measured in isolation.</p></fn><fn id="table1fn4"><label>‡</label><p>An absolute epistasis value of 0.3 or 1 implies a two-fold or ten-fold difference between the observed and expected fluorescence levels, respectively.</p></fn><fn id="table1fn5"><label>§</label><p>“Mutational LD50, loss of function” refers to the number of mutations at which 50% of genotypes are rendered non-functional (i.e. assigned to the darkest FACS gate), obtained by fitting a logistic curve to the fraction of non-functional genotypes at each mutational step (see values in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>) and solving for f(<italic>x</italic>)=0.5; “Mutational LD50, loss of wildtype fluorescence level” refers instead to the number of mutations at which 50% of genotypes maintain a fluorescence level within two standard deviations of the WT level.</p></fn></table-wrap-foot></table-wrap><p>The four fitness peaks shared substantial similarities (also see <xref ref-type="bibr" rid="bib7">Biswas et al., 2018</xref> for sfGFP). In all cases, synonymous variants had no measurable effect on fitness, which may be a consequence of the experimental design aimed to be insensitive to expression levels and, thus, they were pooled for all subsequent analyses (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Mutations in the chromophore eliminated fluorescence (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>) and mutations of buried amino acid residues had a stronger effect than mutations of residues on the protein surface (<xref ref-type="fig" rid="fig3">Figure 3b</xref>; <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). In all four fitness peaks, a threshold effect of accumulating multiple random mutations was found, such that the median level of fluorescence dropped sharply once a certain number of mutations was reached (<xref ref-type="fig" rid="fig3">Figure 3a</xref>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). The fitness peak shape differed substantially among different GFP sequences. Only 3–4 mutations were necessary for avGFP and cgreGFP, so the corresponding fitness peaks were sharp (<xref ref-type="table" rid="table1">Table 1</xref>). By contrast, the fitness peaks of amacGFP and ppluGFP2 were substantially flatter, with each tolerating twice as many mutations (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). Furthermore, we compared the sharpness of the wildtype fitness peaks with the fitness peaks corresponding to sequences harbouring a single mutation relative to the wildtype sequence. Fitness peaks of most single-mutation neighbours with high levels of fluorescence were sharper than the respective wildtype fitness peaks (<xref ref-type="fig" rid="fig3">Figure 3c</xref>), suggesting a local optimization of robustness of each wildtype sequence (<xref ref-type="bibr" rid="bib17">Draghi et al., 2010</xref>; <xref ref-type="bibr" rid="bib75">Zheng et al., 2020</xref>; <xref ref-type="bibr" rid="bib17">Draghi et al., 2010</xref>). Notably, the shape of the wildtype fitness peak showed no straightforward relationship with its respective level of fluorescence (<xref ref-type="table" rid="table1">Table 1</xref>), as may have been expected (<xref ref-type="bibr" rid="bib30">Johnson et al., 2019</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Distributions of fluorescence.</title><p>(<bold>a</bold>) Fluorescence level distributions of genotypes at varying distances from the wildtype and the logistic curves fitted to the median fluorescence for each category (black line). (<bold>b</bold>), Distribution of fluorescence of genotypes with a single amino acid mutation at exposed (colour) versus buried (white) sites. (<bold>c</bold>) Starting from genotypes with one mutation away from the wildtype sequence, each line represents the median fluorescence as a function of sequence divergence away from such genotypes. Only points with at least 15 available genotypes are shown. The median fluorescence level at varying distances for the wildtype sequence, black lines, are shown for comparison. (<bold>d</bold>) The fraction of genotypes without epistasis was calculated as the ratio of the number of observed functional genotypes divided by and the number of genotypes expected to be functional under the assumption of no epistatic interactions between amino acid sites. In the absence of epistasis, the expectation is a constant value of 100% independent of the number of amino acid changes relative to the wildtype.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig3-v3.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Epistatic interactions of mutations in GFP.</title><p>(<bold>a</bold>) Epistasis in genotypes with two mutations, highlighting negative epistatic interactions between individually neutral or slightly deleterious mutations. The values of impact on fluorescence have an upper and a lower bound. For example, when two mutations that each have an effect of –1.2 (they reduce fluorescence to zero) are present in a single genotype their expected additive effect is still –1.2 because a GFP cannot have a fluorescence less than zero. Thus, negative epistasis is observed for mutations with a weak effect and cannot be observed for strongly deleterious mutations. (<bold>b</bold>) Fraction of genotypes that display strong epistasis (&gt;1 or 10-fold change) at different distances from the wildtype.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig3-figsupp1-v3.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Effect of extant and non-extant mutations.</title><p>(<bold>a</bold>) Fraction of wildtype states in extant green fluorescent proteins which become deleterious in our data, as a function of the sequence divergence (from 0 to 100) between the two proteins. (<bold>b</bold>) Distribution of fitnesses of mutant genotypes containing only known extant states, or containing no known extant states, at increasing distances from the reference.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig3-figsupp2-v3.tif"/></fig></fig-group><p>We compared the fluorescence of each genotype to the expected level under an assumption that each mutation influences fluorescence level independently, that is without any epistasis (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>):<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">o</mml:mi><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic"> </mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic"> </mml:mi><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic"> </mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic"> </mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>∙</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where F<sub>i</sub>, <italic>F<sub>m</sub></italic> F<sub>wt</sub> are measured levels of fluorescence of a genotype with a single mutation <italic>i</italic>, of genotype <italic>m</italic>, or of the wildtype sequence, respectively, and <italic>x<sub>i</sub></italic> = 1 when mutation <italic>i</italic> is contained within the genotype <italic>m</italic> and <italic>x<sub>i</sub></italic> = 0 when it is not. We then calculated the fraction of genotypes that do not require epistatic interactions to predict their fluorescence. On all four fitness peaks, genotypes with two mutations away from the wildtype sequence rarely exhibited any epistatic interactions. However, a notable difference between the fitness peaks was observed when considering genotypes with multiple mutations. The level of fluorescence for a vast majority of genotypes with &gt;5 mutations cannot be explained without epistasis in sharp fitness peaks, avGFP and cgreGFP. By contrast, few genotypes with &gt;5 mutations in flat fitness peaks required epistasis to explain their fluorescence level, with amacGFP requiring almost no epistasis at all (<xref ref-type="fig" rid="fig3">Figure 3d</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Interestingly, the sharpness of the fitness peaks and the concomitant extent of epistatic interactions did not correlate with the sequence divergence between the fitness peaks. Indeed, the two closest sequences (82% identity), derived from the same genus, are the sharp, epistatic avGFP peak and the flat, non-epistatic amacGFP peak (<xref ref-type="fig" rid="fig3">Figure 3d</xref>).</p><p>Flat fitness peaks correspond to mutationally robust proteins, those that are capable of withstanding multiple mutations without losing function, while sharp fitness peaks correspond to mutationally fragile ones. The observed differences in mutational robustness of different proteins may be explained by thermodynamic stability (<xref ref-type="bibr" rid="bib6">Bershtein et al., 2006</xref>; <xref ref-type="bibr" rid="bib18">Echave and Wilke, 2017</xref>; <xref ref-type="bibr" rid="bib24">Gong et al., 2013</xref>; <xref ref-type="bibr" rid="bib39">Kurahashi et al., 2018</xref>; <xref ref-type="bibr" rid="bib52">Poelwijk et al., 2019</xref>; <xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>). Therefore, we performed an array of assays aimed at the biophysical characterisation of the four wildtype proteins and an additional genotype, amacGFP:V12L, which differed from amacGFP by the V12L mutation that was extremely common in the amacGFP mutant library. We have assayed the thermal stability of the proteins, using Differential Scanning Fluorimetry (DSF), Differential Scanning Calorimetry (DSC), Circular dichroism (CD), as well as simple measurements of fluorescence in a qPCR machine at different temperatures. We also assayed refolding kinetics of urea-denatured proteins (<xref ref-type="bibr" rid="bib51">Pédelacq et al., 2006</xref>). Finally, we assessed oligomeric states of each of the proteins using multi-angle light scattering with size-exclusion chromatography (SEC-MALS).</p><p>The different methods yielded complementary results (<xref ref-type="fig" rid="fig4">Figure 4</xref>; <xref ref-type="table" rid="table2">Table 2</xref>). Specifically, we observed that the most mutationally fragile protein, cgreGFP is also the most kinetically unstable protein and the most mutationally robust protein, ppluGFP2, was also the most kinetically stable (<xref ref-type="table" rid="table2">Table 2</xref>; <xref ref-type="fig" rid="fig4">Figure 4</xref>; <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). These data tentatively suggest that the shape of the GFP fitness peaks, as characterized by mutational robustness, may in part be shaped by the underlying protein stability. This relationship does not appear to be perfect, as the mutationally fragile avGFP is stable, while amacGFP has mutational robustness comparable to ppluGFP2 (<xref ref-type="table" rid="table1">Table 1</xref>), but a substantially lower stability (<xref ref-type="table" rid="table2">Table 2</xref>). Indeed, there may be other factors that influence this relationship, such as the impact of protein folding on the GFP chromophore maturation, GFP folding histeresis (<xref ref-type="bibr" rid="bib2">Andrews et al., 2009</xref>), the oligomeric protein state and the propensity of the mutant genotypes to aggregate. Indeed, avGFP is the only exclusive monomer from among the four wildtype sequences (<xref ref-type="table" rid="table2">Table 2</xref>; <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>) while ppluGFP2 is exclusively tetrameric. The propensity for aggregation also appears variable between the genotypes, with amacGFP showing the highest aggregation of non-fluorescent genotypes (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Furthermore, our measurements of GFP thermostability through refolding may not reflect GFP folding as it occurs in vivo in the course of translation.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Thermal sensitivity of GFP orthologs.</title><p>(<bold>a</bold>) Thermal unfolding measured by differential scanning fluorimetry (DSF) showing the first derivative of the ratio of 350/330 nm emission. Shaded areas indicate standard deviation of triplicates. (<bold>b</bold>) Melting curves of green fluorescence emission (510 nm) as a function of temperature measured on a qPCR machine. Shaded areas indicate standard deviations of eight technical replicates. (<bold>c</bold>) Thermal aggregation measured by DSF showing the first derivative of the light scattering. Shaded areas indicate standard deviation of triplicates. (<bold>d</bold>) Specific heat capacities measured by differential scanning calorimetry in duplicate. (<bold>e</bold>) Circular dichroism (CD) spectra measured before (30 °C) and after (98 °C) with the melting curves depicted in (<bold>f</bold>) where vertical dotted lines indicate the monitored wavelength in (<bold>f</bold>). f, CD melting curves monitored at 218 nm (and additionally 208 nm in the case of avGFP, where 218 nm did not show a transition), fitted with a logistic curve. In (<bold>a</bold>), (<bold>b</bold>), (<bold>c</bold>), (<bold>d</bold>), (<bold>f</bold>), vertical dashed lines indicate the melting temperature, except ppluGFP2 in (<bold>b</bold>). In (<bold>a</bold>), (<bold>b</bold>), (<bold>d</bold>), (<bold>f</bold>), temperature was increased at a rate of 1 °C per minute, in (<bold>c</bold>), at a rate of ~2 °C per minute, the slowest allowed by the LightCycler.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig4-v3.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Urea denaturation and refolding of orthologues.</title><p>(<bold>a</bold>) Absorbance (grey) and fluorescence (green) spectra of purified protein in 9 M urea, or (<bold>b</bold>), 1 x PBS, measured at 42 °C every 30 min for 60 hr; darker lines correspond to later time points. Plotted values are the means of eight technical replicates. (<bold>c</bold>), Decrease in fluorescence over time during exposure to 9 M urea. avGFP and ppluGFP2 fluorescence loss curves are fitted with one exponential function (<italic>f(x</italic>) = <inline-formula><mml:math id="inf1"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi> </mml:mi><mml:mo>+</mml:mo><mml:mi> </mml:mi><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mo>⋅</mml:mo><mml:mi> </mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>), amacGFP and amacGFP:V12L curves are fitted with two exponential functions (black lines), while a good fit using only exponential functions could not be achieved for cgreGFP. Data points from eight technical replicates are shown. (<bold>d</bold>,<bold> e</bold>), Fluorescence recovery curves of 9M-urea-denatured proteins upon dilution with 20 volumes of 1 x PBS. Fluorescence (excitation 485 nm, emission 520 nm) was measured every second for twenty minutes in (<bold>d</bold>), and every 50 s for over 13 hours in (<bold>e</bold>). Values are normalized to the end points. Recovery curves in (<bold>d</bold>) were fitted with three exponential functions (black). Shaded areas in (<bold>e</bold>) represent standard deviations of six technical replicates.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig4-figsupp1-v3.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Aggregation and oligomeric states in GFP orthologues.</title><p>(<bold>a</bold>) Coomassie-stained gels (top) of full lysate, pellet, and supernatant of pooled functional (bright) or non-functional (dark) genome-integrated library variants for amacGFP, cgreGFP, and ppluGFP2. Western blot (bottom) of the same samples using an anti-His-tag antibody, showing different aggregation tendency (i.e. pellet localization) for dark versus bright variants. Expected molecular weight of the mKate2-GFP fusion is 53–56 kDa depending on the GFP ortholog. Negative controls are cells of the same strain, but without integrated GFP constructs. Lane identity in both gels is the same, and displayed on the right. (<bold>b</bold>) SEC-MALS analysis of wild-type proteins, showing protein peaks. Peak analysis is consistent with the following oligomeric states for each gene: amacGFP: primarily mono- and dimeric, with small fractions of tri- and/or tetramers; avGFP: primarily monomeric, with a small dimeric fraction; cgreGFP: primarily dimeric, with a small tetrameric fraction; ppluGFP2: primarily tetrameric, with a small fraction forming large aggregates or oligomers. Mw/Mn ratios for all peaks were between 1 and 1.002, with the exception of the large ppluGFP2 aggregates (Mw/Mn = 1.147).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig4-figsupp2-v3.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Correlation between fluorescence and ddG predicted by Rosetta.</title><p>(<bold>a</bold>) Distribution of ddG predictions for single mutations observed to either maintain wildtype-level fluorescence (white) or render a genotype non-functional (color). Differences between the two distributions were found to be significant for all genes (Two-tailed Mann Whitney U test, p=0.02 for amacGFP:V12L, and p&lt;0.00002 for all other genes). ddG predictions for mutations to and from proline and glycine were not considered. (<bold>b</bold>), Correlation between ddG predictions and observed fluorescence of single mutations. The indicated Spearman’s rank correlation coefficient (<bold>r</bold>) was significant for all genes (p&lt;7 · 10<sup>–15</sup>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig4-figsupp3-v3.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 4.</label><caption><title>Effects of mutations in amacGFP and amacGFP:V12L.</title><p>(<bold>a</bold>) Correlation between effects of specific mutations in amacGFP backgrounds with and without the V12L (position 14 in our alignment) mutation (Pearson’s <italic>r</italic>=0.96). (<bold>b</bold>), Median (solid lines) and mean (dashed lines) fluorescence values of genotypes as a function of the number of mutations relative to amacGFP or amacGFP:V12L sequences. (<bold>c</bold>), Fraction of observed fluorescent genotypes versus expected to be fluorescent under the assumption of no epistasis as a function of the number of mutations away from amacGFP and amacGFP:V12L. (<bold>d</bold>), Median difference of the effect of mutations in amacGFP:V12L relative to amacGFP, colored on the crystal structure of amacGFP. Position 12 is colored black. Residues, mutations of which have a stronger effect in amacGFP:V12L are red, those in which the effect of the mutation is stronger in amacGFP are blue. Atoms of residues with a median difference &lt;−0.1 are shown as spheres. (<bold>e</bold>) Differences in mutation effect between amacGFP:V12L and amacGFP, at the 12 most affected positions. The majority of mutations have a difference in effect between –0.07 and 0.07 (shaded region, for reference see position 1 S).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig4-figsupp4-v3.tif"/></fig><fig id="fig4s5" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 5.</label><caption><title>Spatial proximity of amino acid residues and detected pairwise epistasis.</title><p>Heatmaps show the minimal distance in Angstroms between two residues, with pairs showing epistatic interactions &gt;0.3 (representing twofold change in fluorescence compared to the additive expectation) shown by white dots. Inset violin plots show the distribution of distances between non-epistatic (green) and epistatic (blue) pairs; in all four cases, the epistatic pairs tended to be physically closer (Two-sided Mann-Whitney U-test, p&lt;10<sup>–13</sup>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig4-figsupp5-v3.tif"/></fig></fig-group><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Biophysical and biochemical characterisation of wildtype GFPs.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="center" valign="bottom">amacGFP:V12L</th><th align="center" valign="bottom">amacGFP</th><th align="center" valign="bottom">cgreGFP</th><th align="center" valign="bottom">ppluGFP</th><th align="center" valign="bottom">avGFP</th></tr></thead><tbody><tr><td align="left" valign="bottom">Unfolding Tm (DSF)</td><td align="center" valign="bottom">80.8 °C</td><td align="center" valign="bottom">82.6 °C</td><td align="center" valign="bottom">74.1 °C</td><td align="center" valign="bottom">91.8 °C</td><td align="center" valign="bottom">86.8 °C</td></tr><tr><td align="left" valign="bottom">Aggregation Tm (DSF)</td><td align="center" valign="bottom">79.5 °C</td><td align="center" valign="bottom">82.0 °C</td><td align="center" valign="bottom">73.9 °C</td><td align="center" valign="bottom">90.2 °C</td><td align="center" valign="bottom">86.6 °C</td></tr><tr><td align="left" valign="bottom">Tm (CD)</td><td align="center" valign="bottom">80.4 °C</td><td align="center" valign="bottom">82.6 °C</td><td align="center" valign="bottom">71.2 °C</td><td align="center" valign="bottom">86.4 °C</td><td align="center" valign="bottom">83.7 °C</td></tr><tr><td align="left" valign="bottom">Transition slope (CD)</td><td align="center" valign="bottom">0.86</td><td align="center" valign="bottom">0.72</td><td align="center" valign="bottom">1.27</td><td align="center" valign="bottom">0.63</td><td align="center" valign="bottom">0.67</td></tr><tr><td align="left" valign="bottom">Tm (DSC)</td><td align="center" valign="bottom">80.2 °C</td><td align="center" valign="bottom">82.4 °C</td><td align="center" valign="bottom">72.9 °C</td><td align="center" valign="bottom">90.3 °C</td><td align="center" valign="bottom">86.3 °C</td></tr><tr><td align="left" valign="bottom">Enthalpy of denaturation (DSC)</td><td align="center" valign="bottom">744 kJ/mol</td><td align="center" valign="bottom">768 kJ/mol</td><td align="center" valign="bottom">755 kJ/mol</td><td align="center" valign="bottom">515 kJ/mol</td><td align="center" valign="bottom">1012 kJ/mol</td></tr><tr><td align="left" valign="bottom">Fluorescence loss Tm (qPCR)</td><td align="center" valign="bottom">81.1 °C</td><td align="center" valign="bottom">82.6 °C</td><td align="center" valign="bottom">72.9 °C</td><td align="center" valign="bottom">-</td><td align="center" valign="bottom">87.5 °C</td></tr><tr><td align="left" valign="bottom">Urea denaturation: initial rate<xref ref-type="table-fn" rid="table2fn1">*</xref></td><td align="center" valign="bottom">–0.87</td><td align="center" valign="bottom">–0.35</td><td align="center" valign="bottom">–0.18</td><td align="center" valign="bottom">–0.02</td><td align="center" valign="bottom">–0.009</td></tr><tr><td align="left" valign="bottom">Kinetic parameters for urea denaturation curves<xref ref-type="table-fn" rid="table2fn1">*</xref></td><td align="center" valign="bottom"><italic>a<sub>1</sub></italic>=0.71<break/><italic>k<sub>1</sub></italic>=0.96 h<sup>–1</sup><break/><italic>a<sub>2</sub></italic>=0.28<break/><italic>k<sub>2</sub></italic>=0.25 h<sup>–1</sup></td><td align="center" valign="bottom"><italic>a<sub>1</sub></italic>=0.52<break/><italic>k<sub>1</sub></italic>=0.54 h<sup>–1</sup><break/><italic>a<sub>2</sub></italic>=0.43<break/><italic>k<sub>2</sub></italic>=0.12 h<sup>–1</sup></td><td align="center" valign="bottom">-</td><td align="center" valign="bottom"><italic>a<sub>1</sub></italic>=0.92<break/><italic>k<sub>1</sub></italic>=0.02 h<sup>–1</sup></td><td align="center" valign="bottom"><italic>a<sub>1</sub></italic>=0.92<break/><italic>k<sub>1</sub></italic>=0.01 h<sup>–1</sup></td></tr><tr><td align="left" valign="bottom">Refolding: initial rate<xref ref-type="table-fn" rid="table2fn2">†</xref></td><td align="center" valign="bottom">0.01</td><td align="center" valign="bottom">0.01</td><td align="center" valign="bottom">0.000014</td><td align="center" valign="bottom">0.05</td><td align="center" valign="bottom">0.007</td></tr><tr><td align="left" valign="bottom">Kinetic parameters for refolding curves<xref ref-type="table-fn" rid="table2fn2"><sup>†</sup></xref></td><td align="center" valign="bottom"><italic>a<sub>1</sub></italic>=–0.35<break/><italic>k<sub>1</sub></italic>=0.025 s<sup>–1</sup><break/><italic>a<sub>2</sub></italic>=–0.36<break/><italic>k<sub>2</sub></italic>=0.005 s<sup>–1</sup><break/><italic>a<sub>3</sub></italic>=–0.38<break/><italic>k<sub>3</sub></italic>=0.001 s<sup>–1</sup></td><td align="center" valign="bottom"><italic>a<sub>1</sub></italic>=–0.057<break/><italic>k<sub>1</sub></italic>=0.057 s<sup>–1</sup><break/><italic>a<sub>2</sub></italic>=–0.39<break/><italic>k<sub>2</sub></italic>=0.013 s<sup>–1</sup><break/><italic>a<sub>3</sub></italic>=–0.63<break/><italic>k<sub>3</sub></italic>=0.002 s<sup>–1</sup></td><td align="center" valign="bottom"><italic>a<sub>1</sub></italic>=0.16<break/><italic>k<sub>1</sub></italic>=0.036 s<sup>–1</sup><break/><italic>a<sub>2</sub></italic>=–0.45<break/><italic>k<sub>2</sub></italic>=0.01 s<sup>–1</sup><break/><italic>a<sub>3</sub></italic>=–0.87<break/><italic>k<sub>3</sub></italic>=0.001 s<sup>–1</sup></td><td align="center" valign="bottom"><italic>a<sub>1</sub></italic>=–0.32<break/><italic>k<sub>1</sub></italic>=0.14 s<sup>–1</sup><break/><italic>a<sub>2</sub></italic>=–0.45<break/><italic>k<sub>2</sub></italic>=0.02 s<sup>–1</sup><break/><italic>a<sub>3</sub></italic>=–0.21<break/><italic>k<sub>3</sub></italic>=0.003 s<sup>–1</sup></td><td align="center" valign="bottom"><italic>a<sub>1</sub></italic>=–0.4<break/><italic>k<sub>1</sub></italic>=0.016 s<sup>–1</sup><break/><italic>a<sub>2</sub></italic>=–0.36<break/><italic>k<sub>2</sub></italic>=0.001 s<sup>–1</sup><break/><italic>a<sub>3</sub></italic>=–0.31<break/><italic>k<sub>3</sub></italic>=0.001 s<sup>–1</sup></td></tr><tr><td align="left" valign="bottom">Expected monomer size</td><td align="center" valign="bottom">28.1 kDa</td><td align="center" valign="bottom">28.1 kDa</td><td align="center" valign="bottom">27.4 kDa</td><td align="center" valign="bottom">25.7 kDa</td><td align="center" valign="bottom">27.9 kDa</td></tr><tr><td align="left" valign="bottom">Primary oligomeric state (SEC-MALS)</td><td align="center" valign="bottom">Monomer (67%), dimer (31%)</td><td align="center" valign="bottom">Monomer (51%), dimer (46%)</td><td align="center" valign="bottom">Dimer (&gt;99%)</td><td align="center" valign="bottom">Tetramer (&gt;97%)</td><td align="center" valign="bottom">Monomer (&gt;99%)</td></tr></tbody></table><table-wrap-foot><fn id="table2fn1"><label>*</label><p>Curves monitoring loss of fluorescence in 9 M urea were fitted with two exponential functions in the case of amacGFP and amacGFP:V12L and one exponential function for avGFP and ppluGFP2, while cgreGFP fluorescence loss could not be well modeled using only exponential functions (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Initial rates were estimated by calculating the derivative at time t=0.</p></fn><fn id="table2fn2"><label>†</label><p>Curves monitoring the recovery of fluorescence after urea denaturation over the course of 20 minutes were fitted with three exponential functions (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Initial rates were estimated by calculating the derivative at time t=0.</p></fn></table-wrap-foot></table-wrap><p>We then used a computational approach to further explore the relationship between protein stability and the shape of the fitness landscapes. We solved the crystal structure of amacGFP and analysed it along with structures already available for other proteins. We found that mutations causing a substantial reduction of fluorescence tended to have a higher effect on protein stability (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>), estimated by predicted ΔΔG (Two-sided Mann Whitney U test, p&lt;10<sup>–6</sup>). Furthermore, we found a statistically significant correlation between predicted ΔΔG and the effect of a mutation, which was stronger in sharp fitness peaks, avGFP and cgreGFP, and weaker in the flat fitness peaks, amacGFP and ppluGFP2 (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>; Spearman’s correlation <italic>r</italic>=0.6 and <italic>r</italic>=0.3, respectively). Interestingly, the V12L mutation in amacGFP:V12L appears to have shifted the distribution of the mutation effects, substantially increasing the effect of mutations on the barrel lid in proximity to residue 12, without impacting the overall mutational robustness (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>). Across the whole landscape, epistatically interacting amino acid residues were slightly more likely to be spatially proximal (<xref ref-type="bibr" rid="bib45">Melamed et al., 2013</xref>; <xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>) and the effect was more pronounced in the flatter fitness peaks (<xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>). Taken together, these data suggest that the heterogeneity in the shape of the orthologous GFP fitness peaks may be related to the stability of the underlying protein sequences.</p><p>The apparent lack of a relationship between sequence divergence and fitness peak shape suggests that the shape changes on a scale that is smaller than the distances between the four GFP proteins. Therefore, the difference of the impact of mutations on different fitness peaks should be independent from the sequence divergence between them. We found that the probability that a neutral mutation in one protein becomes deleterious in another one was independent of the sequence divergence, except when considering two protein sequences that were different by a single amino acid change (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). A complementary pattern was observed when we considered if there is a difference in which pairs of sites are interacting epistatically. The probability that a pair of epistatically interacting sites in one protein is also epistatically interacting in another protein was largely independent of sequence divergence between the two proteins, with the two highly similar sequences showing the highest degree of similarity (<xref ref-type="fig" rid="fig5">Figure 5b</xref>). Taken together, these data indicate that underlying rules that determine epistatic interactions and fitness peak shape change on a scale smaller than 20% of sequence divergence.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Differences in mutational effects in GFP orthologues.</title><p>(<bold>a</bold>) The proportion of single amino acid mutations which were observed to be neutral (maintaining fluorescence within two standard deviations of the wildtype level) in one GFP sequence and deleterious (reducing fluorescence by over five standard deviations) in another GFP, out of all mutations surveyed in both. The total number of amino acid states considered is indicated beneath the bars. (<bold>b</bold>), For each pairwise GFP comparisons, first we selected all pairs of amino acid sites for which epistasis was measured. Then, out of these pairs of sites we calculated the number that had epistasis &gt;0.3 in either of the two GFP genes (reported underneath each bar). Finally, we calculated the percent of epistatically interacting sites that were measured to be epistatically interacting in both (y-axis). In (<bold>a</bold>) and (<bold>b</bold>), pairs of genes are arranged in order of increasing sequence divergence.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig5-v3.tif"/></fig><p>The identification of two mutationally robust proteins presented an opportunity to predict novel GFP sequences. Two lines of reasoning led us to hypothesize that it would be easier to create functional genotypes by introducing mutations into mutationally robust, rather than fragile, proteins. First, robust proteins had a higher fraction of fit genotypes with &gt;5 mutations and, therefore, it should be easier to find other genotypes that are farther away. Second, a robust protein should be more tolerant of mistakes in predictions.</p><p>Prediction of functional genotypes many mutations away from known functional sequence is akin to looking for a needle in a haystack. There are <inline-formula><mml:math id="inf2"><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:mn>222</mml:mn></mml:mrow><mml:mrow><mml:mn>48</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>∙</mml:mo><mml:mi> </mml:mi><mml:msup><mml:mrow><mml:mn>19</mml:mn></mml:mrow><mml:mrow><mml:mn>48</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> or ~10<sup>110</sup> genotypes that are 48 mutations away from a 222 amino acid long ppluGFP2. Out of all of these sequences, only an infinitesimally small proportion is expected to be functional, perhaps as few as 10<sup>–11</sup> (<xref ref-type="bibr" rid="bib31">Keefe and Szostak, 2001</xref>) and finding any appreciable number of these sequences requires extraordinary precision. Therefore, we used a machine learning approach, training neural networks on the genotype-to-phenotype relationships revealed by our data (see Materials and methods, <xref ref-type="fig" rid="fig6">Figure 6</xref>). We split this data into non-overlapping training and validation sets. Models were trained on the training set and after training, model goodness was calculated as the coefficient of determination between predicted and actual fluorescence values for all genotypes in the validation set. We started with a linear model fitted to the one-hot encoded protein sequences. The validation score of the resulting models indicated that between 59% and 82% of the variance could be explained in all landscapes by the simple linear contribution of mutations in the protein sequence (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). This simple estimate of the fluorescence, which is called fitness potential (<xref ref-type="bibr" rid="bib34">Kimura and Crow, 1978</xref>; <xref ref-type="bibr" rid="bib46">Milkman, 1978</xref>), is simply the summed contribution of weighted mutations and does not account for possible interactions between them. We then trained models of increasing capacity and aimed at maximising the validation score while reducing overfitting. In all landscapes, the majority of genotypes were either non-functional or of near-wildtype brightness; this scarcity of genotypes with intermediate fluorescence levels suggests that an abrupt threshold function transforms the fitness potential into the final fluorescence level, as has been observed previously (<xref ref-type="bibr" rid="bib53">Pokusaeva et al., 2019</xref>; <xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>). Therefore, we decided to train sigmoid models, resulting in the successful capture of an additional 13%, 78%, 53%, and 39% of the remaining unexplained variance for amacGFP, avGFP, cgreGFP, and ppluGFP2, respectively, compared to the results of the linear model (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). This minute transformation of the fitness potential noticeably improves the models’ power, especially for the two genes that display the highest levels of epistatic interactions, avGFP and cgreGFP. To capture the functions that transform the fitness potential into the predicted fluorescence, we decided to train models with an output subnetwork of several sigmoid nodes (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). These functions are shown in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>. Theorising that models accounting for interactions between residues would push further the predictive power of the models, we optimised the architecture of two-layered networks, one for each dataset using a grid search approach. This resulted in models capturing 0.88, 0.95, 0.86, and 0.90 of variance for amacGFP, avGFP, cgreGFP, and ppluGFP2 respectively, as shown in <xref ref-type="fig" rid="fig6">Figure 6b</xref>. Using the trained model as the evaluation function of a genetic algorithm, we made fitness peak-specific predictions, using the data of each fitness peak to predict fluorescent genotypes containing up to 48 mutations relative to the wildtype sequence.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Neural network structure.</title><p>(<bold>a</bold>) 1. Each genotype in the dataset was denoted by the mutations it contained relative to its parental wildtype sequence. 2. Genotypes were one-hot encoded. For each position in the sequence, a binary vector indicated present (red = 1) and absent (white = 0) amino acid states. 3. One-hot encoded sequences were flattened and provided to the neural network as input. 4. The first hidden layer contained linear nodes followed by a dropout layer of the same size. 5. The second hidden layer contained sigmoid nodes followed by a dropout layer of the same size. Grey arrows indicate layer widths that were optimised by a random search. Greyed-out neurons without output connections represent randomly inactivated neurons in dropout layers. During training, randomly inactivated neurons prevented overfitting. At inference time, randomly inactivated neurons allowed the model to provide different estimates of the fluorescence each time a prediction was run on a genotype. 6. Linear node outputting predicted fluorescence values. For each predicted genotype, the median of several fluorescence estimates was used as the final fluorescence level. (<bold>b</bold>) Correlations between observed and predicted levels of fluorescence with an optimized architecture. Datapoint density is represented in color.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig6-v3.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Correlations between observed and predicted levels of fluorescence.</title><p>(<bold>a</bold>) With a linear model, (<bold>b</bold>), with a linear model and a sigmoid output node, (<bold>c</bold>), with an output subnetwork, and (<bold>d</bold>), non-trivial sigmoidal functions transform fitness potentials into predicted fluorescence. Datapoint density is represented in color.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig6-figsupp1-v3.tif"/></fig></fig-group><p>Amino acids observed in homologous sequences, or extant states, are more likely to be neutral when introduced into a sequence of interest (<xref ref-type="bibr" rid="bib53">Pokusaeva et al., 2019</xref>; <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). Therefore, one approach to predict a novel functional sequence would be to prefer the introduction of extant amino acid states. However, we wanted to push the envelope of our predictions in exploring uncharted regions of the GFP fitness landscape, avoiding the genotype space between known GFP sequences (space between fitness peaks in <xref ref-type="fig" rid="fig1">Figure 1a</xref>). Thus, we aimed to predict genotypes as distant as possible from any known functional GFP sequences, corresponding to an area of GFP genotype space not known to be explored by evolution. Therefore, for experimental verification from among the predictions made by the machine learning algorithm, we selected sequences with the maximum amino acid states that were observed in our libraries but not present in any natural GFP (<xref ref-type="supplementary-material" rid="sdata8">Source data 8</xref>).</p><p>Contrary to our expectation, experimental verification showed that the accuracy of our predictions was substantially higher for genotypes predicted by using data from the sharp cgreGFP fitness peak (<xref ref-type="fig" rid="fig7">Figure 7</xref>). For genotypes with 48 mutations (&gt;20% sequence divergence of GFP), our predictions had an 8% accuracy when using data for the mutationally robust ppluGFP2 and a 50–60% accuracy for the mutationally fragile cgreGFP (<xref ref-type="fig" rid="fig7">Figure 7</xref>). These results may be relatively trivial, if the predictions were based on universally neutral mutations (<xref ref-type="bibr" rid="bib36">Kondrashov and Kondrashov, 2015</xref>), those that are neutral in any GFP sequence. However, three lines of evidence show that our high rate of prediction cannot be explained by universally neutral mutations (also see <xref ref-type="bibr" rid="bib52">Poelwijk et al., 2019</xref>). First, individual mutations which were strongly deleterious in some genetic contexts were successfully incorporated into functional predictions (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>), and these conditionally deleterious mutations comprised a significant fraction of all mutations used in predictions, particularly in the case of the epistatic cgreGFP protein (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). Second, the mutations used in successful predictions occur in evolution at a rate two times slower than neutral synonymous substitutions (0.057 dn rate vs 0.11 ds rate, respectively, two-sided Mann-Whitney U-test p&lt;0.00001), demonstrating that they are under negative selection. Finally, successful identification of universally neutral mutations would lead to a successful prediction of distant derivatives of any GFP sequence, not just the mutationally fragile cgreGFP. Furthermore, the ML-designed variants derived from the more robust amacGFP and ppluGFP2 proteins were rendered non-fluorescent by negative epistasis substantially more frequently than those derived from the fragile and epistatic cgreGFP (<xref ref-type="table" rid="table1">Table 1</xref>). This indicates that the success of the neural network was dependent on being able to learn epistatic interactions from the data, which were abundant in cgreGFP but rare in amacGFP and ppluGFP2, and to avoid non-favorable epistatic interactions, rather than relying on universally neutral mutations.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Predicting functional GFP mutants.</title><p>Violin plots show the distribution of fluorescence of all genotypes (black) and combinations of only individually neutral mutations (color). Experimental measurements of the level of fluorescence in genotypes predicted by the neural network are shown as black dots (12 genotypes per distance). Black dashed lines show the median fluorescent values for each group. Red dashed lines indicate the cutoff of detectable fluorescence. Photos of agar plates with <italic>E. coli</italic> spots expressing predicted GFP variants are shown on the right. Spots of bacteria expressing GFP variants are arranged in circles around the wildtype gene at increasing distance with the number of mutations (6, 12, 18, 24, 30, 36, 42, 48 mutations). For each group of genotypes, the brightest ones were inoculated at the top, with fluorescence decreasing clockwise.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig7-v3.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Mutations used in machine learning-generated genotypes.</title><p>(<bold>a</bold>) For all genotypes generated by the neural network model (see <xref ref-type="fig" rid="fig5">Figure 5</xref>), we show the measured fluorescence as a function of the strongest deleterious effect of any mutation in that genotype that was measured in any genotype in the initial library. In the library of genotypes, individual mutations were observed in multiple genetic contexts, allowing for the measurement of their effect in different backgrounds. Many mutations were neutral in some contexts but deleterious in others. The X axis shows, for each neural network-generated genotype, the strongest deleterious measured effect of any mutation in that genotype. Each colored dot represents one genotype. The threshold for functionality is shown by the dashed red line. (<bold>b</bold>) In functional neural net-generated genotypes, the proportion of the mutations which were observed to be deleterious (causing over two-fold loss of fluorescence) in at least one genetic context in our data. The total number of mutations used in functional predictions is indicated below the gene name.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75842-fig7-figsupp1-v3.tif"/></fig></fig-group></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Experimental survey of the fitness landscape of a protein of interest is increasingly used in protein engineering to discover novel sequences with specific functions (<xref ref-type="bibr" rid="bib9">Bryant et al., 2021</xref>; <xref ref-type="bibr" rid="bib57">Romero and Arnold, 2009</xref>; <xref ref-type="bibr" rid="bib59">Russ et al., 2020</xref>; <xref ref-type="bibr" rid="bib70">Wittmann et al., 2021</xref>). While this approach remains challenging for proteins with a function that cannot be easily ascertained in a high-throughput manner (<xref ref-type="bibr" rid="bib57">Romero and Arnold, 2009</xref>), it is likely to be more widely used in the future due to technological advances of experimental (<xref ref-type="bibr" rid="bib57">Romero and Arnold, 2009</xref>) and analytical (<xref ref-type="bibr" rid="bib70">Wittmann et al., 2021</xref>; <xref ref-type="bibr" rid="bib73">Wu et al., 2019</xref>) tools. Our description of heterogeneity of fitness peaks of orthologous GFPs suggests some practical considerations for such surveys of other proteins. Researchers applying such methods to their protein of interest will inevitably have to choose a specific protein sequence to experimentally assay (<xref ref-type="bibr" rid="bib57">Romero and Arnold, 2009</xref>). When the goal is to discover as many distant functional proteins as possible (i.e. <xref ref-type="bibr" rid="bib9">Bryant et al., 2021</xref>; <xref ref-type="bibr" rid="bib57">Romero and Arnold, 2009</xref>; <xref ref-type="bibr" rid="bib59">Russ et al., 2020</xref>; <xref ref-type="bibr" rid="bib70">Wittmann et al., 2021</xref>) it may seem natural to select a structurally or mutationally robust protein. Indeed, a robust protein, one that is known to be able to maintain function upon the introduction of many mutations, seems a good starting point to introduce even more mutations. Our results counter this intuition, and our recommendation is to select a fragile protein as the original template for a mutational scan. For the data of the fitness landscape to be useful for a downstream model to predict distant sequences, it has to contain information about epistatic interactions between mutations. Thus, a useful fitness landscape should contain many genotypes that have been rendered non-functional through negative epistatic interactions among a handful of mutations. Our results for cgreGFP demonstrate this principle. Out of 188 genotypes six mutations away from cgreGFP that were expected to be functional by an additive model only 61 (32%) were actually fluorescent. The rest were non-fluorescent, revealing extensive negative epistasis among those mutations. By contrast, our model correctly predicted 100% (12/12) of genotypes 6 mutations away from cgreGFP, learning to avoid combinations of individually neutral mutations that combine to create a non-functional genotype. Without this information, such as for amacGFP that shows almost no epistatic interactions within the surveyed genotypes, the model cannot learn which genotypes to avoid (<xref ref-type="fig" rid="fig7">Figure 7</xref>). The reported ~20% prediction accuracy at 40 mutations for sfGFP is also consistent with the sharpness of its fitness peak (<xref ref-type="bibr" rid="bib7">Biswas et al., 2018</xref>).</p><p>Without direct knowledge of mutational robustness of a protein sequence our data indicate that researchers may rely on thermodynamic stability to choose the initial template protein, although the relationship between mutational and thermodynamic robustness may be more complex (<xref ref-type="table" rid="table2">Table 2</xref>). However, given that for many proteins it is likely to be easier to measure stability than mutational robustness, choosing a structurally unstable protein from several available candidates may prove to be an acceptable compromise.</p><p>Despite the high accuracy of prediction with our model, there are still substantial limits to the prediction of functional proteins. Indeed, the relatively accurate prediction of functional GFP sequences up to 20% divergence from cgreGFP does not imply an ability to predict all <inline-formula><mml:math id="inf3"><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:mn>235</mml:mn></mml:mrow><mml:mrow><mml:mn>48</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mn>19</mml:mn></mml:mrow><mml:mrow><mml:mn>48</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> or ~10<sup>112</sup> possible functional sequences at this level of divergence. The substantial heterogeneity between fitness peaks of the highly similar avGFP and amacGFP (18% divergence) suggests that predictions based on a single fitness peak may have lower accuracy of prediction of sequences not governed by the same set of epistatic interactions (<xref ref-type="bibr" rid="bib1">Alley et al., 2019</xref>; <xref ref-type="bibr" rid="bib42">Lee et al., 2018</xref>). However, the understanding of the heterogeneity of such predictions would require random sampling of all 10<sup>110</sup> sequences, which is not presently feasible.</p><p>The four proteins in our study function in different species so the heterogeneity of their fitness landscape may be related to some aspect of the environment in which these species are typically found, such as temperature. By contrast, our experimental setup measures the fluorescence of these proteins in an identical, controlled but an artificial environment. If GFPs mutational robustness, fitness peak shape, was adapted to environmental conditions it implies that mutational robustness is driven by natural selection. Indeed, experimental data suggests that mutational robustness of GFP is a selectable trait (<xref ref-type="bibr" rid="bib75">Zheng et al., 2020</xref>), so a correlation between sequence divergence and mutational robustness may have been expected. However, selectable traits are generally expected to evolve slowly, which translates to the expectation that similar sequences confer similar phenotypes. The lack of a correlation in our data between sequence similarity and mutational robustness implies that selection for the phenotype of mutational robustness in GFP is weak or that it changes rapidly on an evolutionary timescale.</p><p>The heterogeneity of the shape of the fitness peaks is remarkable. Up to 17% of all genotypes six random mutations away from the ppluGFP2 wildtype sequence have the same level of fluorescence as the wildtype. By contrast, only 0.9% of such genotypes derived from the fragile cgreGFP exhibited wildtype fluorescence (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). However, it remains unclear whether this heterogeneity influences protein evolution. It is tempting to suggest that these data indicate that ppluGFP2 is a more ‘evolvable’ protein compared to cgreGFP. However, 2% of all genotypes 6 mutations away from wildtype cgreGFP were observed to be functional, which is still 2.10<sup>17</sup> (<inline-formula><mml:math id="inf4"><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:mn>235</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>∙</mml:mo><mml:msup><mml:mrow><mml:mn>19</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo>∙</mml:mo><mml:mn>0.02</mml:mn></mml:math></inline-formula>) total functional genotypes, so even such a relatively fragile protein may not be restricted in its long-term evolution (<xref ref-type="bibr" rid="bib54">Povolotskaya and Kondrashov, 2010</xref>). What fraction of all genotypes ~250 amino acids in length are functional GFPs, and what factors govern differences in the shape of fitness peaks of orthologous proteins, remain unknown.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Selection of genes</title><p>Candidate fluorescent proteins were selected based on several criteria: fluorescence in the green spectrum, ability to mature and fluoresce in <italic>E. coli</italic> under standard culture conditions, and varying degrees of sequence divergence from each other. We also preferred candidates with an available solved crystal structure. Eight genes from six species (<italic>Aldersladia magnificus</italic>, <italic>Aequorea macrodactyla</italic>, <italic>Clytia gregaria</italic>, <italic>Clytia hemisphaerica</italic>, <italic>Pontellina plumata</italic>, and <italic>Asymmetron lucayanum</italic>) were selected as initial candidates. The <italic>A. macrodactyla</italic> protein contained three point mutations, as the wildtype was previously reported to mature poorly in <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib44">Luo et al., 2006</xref>). After testing their expression in <italic>E. coli</italic>, the three brightest proteins were chosen for further experiments: amacGFP, cgreGFP, and ppluGFP2, respectively from <italic>A. macrodactyla</italic>, <italic>C. gregaria</italic>, and <italic>P. plumata</italic>. Protein sequences of the chosen genes were aligned using the T-Coffee Expresso structural alignment (<xref ref-type="bibr" rid="bib3">Armougom et al., 2006</xref>).</p></sec><sec id="s4-2"><title>Golden gate cloning</title><p>Single-step digestion/ligation Golden Gate protocols were adapted from <xref ref-type="bibr" rid="bib69">Weber et al., 2011</xref>. All MoClo reaction mixtures contained 50 ng each of insert DNA and destination vector, 10 U of T4 DNA ligase (ThermoFisher), 20 U of type IIS restriction enzyme (BsaI, BpiI, or BsmBI; ThermoFisher), in T4 ligase buffer at a final concentration of 1 X and volume of 20 ul. Thermocycler conditions were as follows: 10 min at 37℃, 25 cycles of 1.5 min at 16℃ and 3 min at 37℃, 5 min at 50℃, and 10 min at 80℃.</p></sec><sec id="s4-3"><title>Generation of mutant libraries</title><p>Selected genes were ordered as synthetic dsDNA (Twist Biosciences), codon-optimized for bacteria and compatible with common modular cloning (MoClo) standards (<xref ref-type="bibr" rid="bib69">Weber et al., 2011</xref>). For positions occupied by the same amino acid in different genes, the same codon was used in all genes. The same constant, 20-nucleotide region was included in each gene after the stop codon, for future primer-annealing purposes. All genes were cloned into non-expression storage vectors via MoClo. We generated mutant libraries of each gene via random mutagenesis with the Mutazyme II kit (Agilent), using 200 ng of DNA template and eight cycles of mutagenic PCR, in order to achieve an average of ~4 mutations per clone. Primers (Sigma) included type IIS restriction sites for later cloning, and 20 N random nucleotide barcodes to label each molecule with a unique identifier, hereafter referred to as ‘primary barcode’. PCR product was gel-purified and cloned into a spectinomycin-resistant storage vector (MoClo Toolkit) via Golden Gate cloning, and transformed into high-efficiency chemically competent <italic>E. coli</italic> cells (Lucigen E. cloni 10 G); post-heat shock recovery time was limited to 15–20 min to avoid cell division during recovery and ensure that each resulting colony was the result of an independent transformation event. Up to 150 thousand colonies were recovered and pooled; DNA was extracted following standard maxiprep plasmid extraction protocol (ThermoFisher, GeneJet maxiprep kit) using 2–4 g of pooled colonies instead of liquid culture. Mutation rates were confirmed by Sanger sequencing (Microsynth) for random 25 clones per library prior to colony pooling.</p><p>The mutagenesis kit for creating mutant libraries for amacGFP, cgreGFP and ppluGFP2 was different than that used to create the avGFP mutant library, which led to a slightly different mutational signature, which has not affected our results (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>).</p></sec><sec id="s4-4"><title>Generation of expression cassettes</title><p>We assembled an expression vector via MoClo from the following parts: a 5600 bp homology arm to the <italic>E. coli</italic> genome; an mKate2-LacZ fusion under the T5 promoter, followed by a placeholder sequence flanked by IIS restriction sites, and lambda T0 terminator; a zeocin resistance cassette; and a 3600 bp homology arm. The placeholder was subsequently replaced by 10 N random nucleotide barcodes, hereafter referred to as ‘secondary barcodes’, in order to create a library of around 10 thousand expression vector variants differing only by this barcode.</p><p>Mutant libraries were then shuttled from their storage vectors into the pooled expression vectors, replacing LacZ with GFP in-frame with mKate2 and allowing for color-based determination of cloning efficiency upon plating with X-Gal. Final constructs thus expressed GFP mutants as a fusion protein with mKate2, ensuring the two proteins are equimolar inside each cell and allowing mKate2’s red fluorescence to be used as a control for GFP expression level (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). mKate2 was selected as previously (<xref ref-type="bibr" rid="bib62">Sarkisyan et al., 2016</xref>) due to its spectral properties (minimum overlap with GFP spectra, and lack of green emission phase during maturation) and monomeric activity, and is separated from GFP by a rigid alpha-helix linker to avoid any potential interactions between the two proteins. An N-terminal 6-His-tag was also included in the mKate2-GFP fusion design.</p><p>GFP mutant libraries were shuttled into the expression vector via modular cloning protocols described above. MoClo reactions were transformed into high-efficiency chemically competent <italic>E. coli</italic> cells (Lucigen E. cloni 10 G). Around 800 thousand colonies were recovered; each mutant genotype, identifiable by its primary barcode, is thus expected to be associated with multiple secondary barcodes. This approach created internal replicates for each genotype, with each primary/secondary barcode combination having been the result of independent cloning and transformation events, allowing for independent measurements of the same genotype during a single experimental set-up.</p></sec><sec id="s4-5"><title>Genome integration</title><p>Genome integration is expected to produce less expression noise compared with expression from a plasmid (<xref ref-type="bibr" rid="bib41">Lee et al., 2015</xref>). Final expression-ready cassettes were excised from the vector backbone via digestion at SpeI sites flanking the homology arms, and gel-purified. Linear fragments were integrated into a safe harbor in the <italic>E. coli</italic> chromosome via CRISPR-Cas9-mediated homologous recombination, using a protocol adapted from <xref ref-type="bibr" rid="bib5">Bassalo et al., 2016</xref>. In brief, we transformed cells with Court lab’s pSIM5, a temperature-inducible plasmid containing genes necessary for homologous recombination, and pX2-Cas9 (Addgene #85811), an arabinose-inducible Cas9 vector. Cells were grown to the exponential phase (OD<sub>600</sub>=0.6, measured via NanoDrop) at 30℃ in the presence of 0.2% arabinose and then heat-shocked at 42℃ for fifteen minutes to activate pSIM5. We observed increased efficiency when cells were grown with arabinose from the start, rather than only provided with it during the recovery phase. Cells were then placed on ice for 20 min, washed thrice with ice-cold distilled water, and electroporated with the linear library DNA as well as the SS9_RNA (Addgene #71656) vector containing the guide RNA for Cas9 to target the safe harbor. Cells were plated on 50 mg/L zeocin plates after two hours of recovery at 30℃ in 0.2% arabinose-supplemented LB, grown overnight at 30℃ and an additional day at room temperature, then recovered from plates and resuspended in LB for sorting. Approximately, 5 million colonies were recovered in each case.</p></sec><sec id="s4-6"><title>Fluorescence-activated cell sorting</title><p>Resuspended cells were sorted in parallel on two independent BD FACS Aria III cell sorters (‘machine A’ and ‘machine B’) at a rate of around 20 thousand events per second. Each library was processed independently, but a small amount of wild-type avGFP, amacGFP, cgreGFP, and ppluGFP2 genotypes with known barcodes were added to each library as positive controls and for the purposes of cross-library comparisons. A narrow gate in the red channel was selected, corresponding to a fixed mKate2 expression level, and this was subdivided into eight sub-gates based on green intensity (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>) and these were sorted into eight separate tubes. For each library, around 28 million cells were sorted in total, leading to an estimated average of ~35 recovered cells for each colony in the pool.</p><p>After library sorting, we separately added 5000 cells each of four known barcodes to each tube, to serve as controls for the number of cells sorted and determine how many reads are generated per cell. ‘Count control’ cells were generated separately from the mutant libraries, so their barcodes are not expected to be present in any of the libraries.</p><p>The use of mKate2 controls for the influence of variability in gene expression, but also can be used to control for the impact of mutations on mRNA structure, stability, or translation. Such mutations could be either synonymous or non-synonymous. If mutations had a substantial probability of impacting green fluorescence through mRNA structure, stability or through their impact on translation, we would expect for our data to contain a non-negligible amount of such synonymous mutations. However, since synonymous mutations do not influence fluorescence (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), these effects are not present on a detectable level.</p></sec><sec id="s4-7"><title>Circularization of mutant libraries</title><p>For each gene, approximately 5 μg of DNA (mutant libraries in storage vectors) was digested with BsaI and the GFP fragment was recovered via gel purification, leaving known 5’ overhangs. A short dsDNA filler sequence with compatible overhangs was used to tie the N- and C-terminal GFP ends together. The filler was obtained by annealing two complementary primers (mixed together in equal amounts, heated to 95℃, and gradually cooled down to 20℃ at a rate of 0.1℃ per second using a thermocycler); compatible overhangs with the GFP fragment were generated by BsaI digestion.</p><p>Circularization was performed at room temperature in a volume of 500 μl 1X T4 DNA ligase buffer, with 100 U BsaI and 60U T4 DNA ligase, and starting quantities of 50 ng each of linear GFP library fragment and dsDNA filler. Another 50 ng of each were added every 30 min until reaching a combined total amount of 2 μg. DNA addition was performed gradually in order to minimize the concentration of unligated linear DNA and thereby avoid formation of tandem multimers; once ligated, circular products cannot be cut again due to restriction site destruction. The circular monomer fraction was isolated by gel purification of the appropriate band. Successful circularization was confirmed by PCR.</p></sec><sec id="s4-8"><title>Preparation of mutant libraries for sequencing of coding region</title><p>Mutant GFP libraries were sequenced via MiSeq 300bp-paired-end Illumina sequencing, performed by the Vienna Biocenter Core Facilities. In order not to exceed the maximum total read length of 600 bp, N-terminal and C-terminal halves – each between 400 and 500 bp – were prepared separately.</p><p>C-terminal halves were PCR’d directly from the storage vectors containing the mutant libraries. For N-terminal halves, libraries were first circularized in order to place the barcode adjacent to the start codon. In each case, a first round of 10 PCR cycles was performed, using three pairs of primers incorporating part of the constant region of Illumina TrueSeq adapters; the three pairs differed only by the addition of 1–2 N bases, in order to create sequence shifts and increase complexity for NGS purposes. These products were gel-purified and used as templates for a further 10 PCR cycles with primers incorporating Illumina indices. Final PCR products were gel-purified, eluted in nuclease-free water and sent for sequencing. Different indices were used for different halves and for different genes, allowing pooling of samples to be sequenced in the same MiSeq lane. A total of four lanes were used for MiSeq library sequencing.</p></sec><sec id="s4-9"><title>MiSeq data processing</title><p>Sample de-multiplexing was performed by the sequencing facility. Raw Illumina sequencing data was converted from .bam to .fastq format using Bamtools; all further processing was performed with custom Python scripts. BioPython was used for pairwise alignments.</p><p>MiSeq reads were first checked for the presence of the constant region located in between the stop codon and the barcode; reads lacking this motif were discarded. Barcodes were extracted, corresponding to the 20 nucleotides adjacent to the constant region. Primer sequences were trimmed from all reads. Reads with matching barcodes were pooled, and consensus sequences of the GFP-coding region were obtained independently for the C-terminal and N-terminal halves, as well as for the forward and reverse reads of each half. Barcodes with fewer than five reads in one or both halves were discarded, as well as barcodes with less than 80% agreement for any given position. Consensus sequences of forward and reverse reads were merged, then N- and C-terminal halves were merged to obtain the full coding sequence; barcodes where the expected overlap was less than a 100% match between sequences to be merged were discarded.</p><p>Final coding sequences for each barcode were then compared with the wild-type template by global pairwise alignment and mutations were extracted. Coding nucleotide sequences were translated to obtain amino acid sequences.</p></sec><sec id="s4-10"><title>Preparation of samples for HiSeq barcode sequencing</title><p>Sorted cells were recovered periodically during sorting, and kept on ice to avoid cell division. In order to increase the genetic material available for PCR, recovered cells were plated on LB-zeocin agar and incubated overnight at 37℃. Colonies were pooled and mixed and used as PCR template to amplify the barcode region, as we previously found PCRs directly on the sorted cells to be inefficient.</p><p>As with MiSeq sample preparation, two rounds of PCR were performed. The first round consisted of 15 cycles (Encyclo polymerase, Evrogen) and used N-shifted primers to increase complexity, and was gel-purified and used as the template for the second round, which consisted of 9 cycles and added full Illumina TrueSeq adapters. Final products were gel-purified and sent for HiSeq SR100 sequencing. Different Illumina indices were used for different samples, allowing pooling of multiple samples into the same sequencing lane. Sample ratios in each lane corresponded approximately to the numbers of sorted cells. A total of four HiSeq lanes were used, with twelve samples per lane.</p></sec><sec id="s4-11"><title>HiSeq data processing</title><p>As with MiSeq data, HiSeq sample demultiplexing was performed by the sequencing facility, raw data was converted from.bam to.fastq using Bamtools, and further processing was done with custom Python scripts.</p><p>HiSeq reads encompassed the barcode region only: a 20 N primary barcode and a 10 N secondary barcode, with a 10bp-length constant region in between. Reads lacking the constant motif were discarded. Primary and secondary barcodes were extracted from each read, and reads with matching primary barcodes were pooled. If a secondary barcode had fewer than six reads, and differed from another secondary associated to the same primary by two or fewer nucleotides, it was considered to be the product of sequencing errors and its reads were merged together with the more abundant barcode. For each primary-secondary barcode combination, the distribution of reads across the eight green sorting gates was determined.</p><p>In order to estimate the actual number of sorted cells from the number of reads, we used ‘count control’ barcodes mentioned previously: cells of known barcode of which a fixed amount was sorted into each tube. For each gate, the read counts of all barcodes were normalized according to the average ‘count control’ read count of that gate.</p></sec><sec id="s4-12"><title>Estimating fluorescence for each genotype from HiSeq sequencing of sorted populations</title><p>To determine the genotype distribution across brightness populations we used Illumina HiSeq (single-end 100 bp reads). The fluorescence for each genotype was assessed by fitting the calculated number of cells across the sorting gates to the cumulative density function of normal distribution (provided by scipy.stats.norm Python module), taking into account gate border values for every sorter run (<xref ref-type="supplementary-material" rid="sdata1">Source data 1</xref>). The fitting was performed with the scipy.optimize.curve_fit Python module, with the initial guess corresponding to the gate with the highest cell count observed. The initial guess for the sigma equaled the width of the gate with maximum cell count. In order to correct for slightly different settings between two FACS machines, the brightness values were matched by linear regression of fluorescence values of known wild-type genotypes.</p></sec><sec id="s4-13"><title>Genotype data filtering</title><p>Our experimental setup allowed for various sources of replication for each mutant: cells with the same genotype and primary barcode but different secondary barcodes; or the same genotype but different primary barcodes; or the same genotype as well as primary and secondary barcode but sorted on different machines. Such replicates were merged, and assigned a fitness corresponding to the mean of the fitnesses of each individual replicate, weighted by their cell counts (<xref ref-type="supplementary-material" rid="sdata2">Source data 2</xref>).</p><p>Two sources of internal controls allowed us to check data quality: genotypes corresponding to wild-type proteins, known to be bright, and genotypes corresponding to chromophore-mutated variants known to be dark. Due to the physical limitations of FACS, it is not unexpected for some number of cells to be mis-sorted into the wrong gate, but we expect such events to be associated to low read counts, and for mis-sorted cells to be associated to different fitnesses than correctly sorted cells of the same genotype. Therefore, we discarded nucleotide genotypes with too few replicates, or with too low a cell count, or whose replicates covered too wide a range of measured fitnesses (as determined according to their index of dispersion). Due to differences in library diversity and measurement range between libraries, the particular cutoffs for amacGFP, cgreGFP, and ppluGFP2 differed slightly, and were selected such as to minimize the numbers of false positives and false negatives, while maximizing the total number of retained genotypes. In brief, amacGFP, cgreGFP, and ppluGFP2 genotypes were required to have, respectively: a minimum of 2, 3, and 3 replicates; cell counts over 26, 14, and 23; and indices of dispersion under 525, 575, and 1000. In each case, the final dataset showed no false negatives, that is wild-type proteins measured as dark (based on data from over 1000 nucleotide genotypes with synonymous mutations), while false positive rates, that is genotypes with chromophore mutations measured as having non-zero fluorescence, ranged from 0.24% (ppluGFP2) to 0.47% (amacGFP) to 0.71% (cgreGFP).</p><p>Of the surviving nucleotide genotypes, those with synonymous mutations coding for the same protein were merged, and assigned a fitness corresponding to the mean of the fitnesses of the different nucleotide genotypes, weighted by their cell count. The final dataset (<xref ref-type="supplementary-material" rid="sdata3">Source data 3</xref>) included 35500, 26165, and 32,260 unique protein sequences respectively for amacGFP, cgreGFP, and ppluGFP2.</p></sec><sec id="s4-14"><title>Calculation of epistasis</title><p>Our mutant generation strategy created genotypes with an average of 3–4 mutations each. This also led to &gt;1100 single mutants in each gene (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>) for which we could directly calculate their individual effects. This allowed us to determine the contribution of epistasis to the fluorescence of genotypes with multiple mutants. Epistasis was calculated as the difference between the measured fluorescence of a genotype and its expected fluorescence under the assumption that the joint effect of multiple mutations is equal to the sum of their individual effects, according to the following equality:<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow/></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where F<sub>i</sub>, <italic>F<sub>m</sub></italic> F<sub>wt</sub> are measured levels of fluorescence of a genotype with mutation <italic>i</italic>, of a genotype <italic>m</italic> containing one or more mutations, or of the wildtype sequence, respectively, and <italic>x<sub>i</sub></italic> = 1 when mutation <italic>i</italic> is contained within the genotype <italic>m</italic> and <italic>x<sub>i</sub></italic> = 0 when it is not. In order to avoid detecting false epistasis, expected values are capped and cannot be greater than the dataset’s maximum observed measurement, nor less than the minimum observed measurement. Instances of genotypes harbouring multiple mutations for which one or more of the mutations has not been observed in isolation were not included in this analysis.</p><p>We selected –1 or 1 and –0.3 or 0.3 cutoffs representing strong and weak epistatic interactions, respectively. The fluorescence values used in the study are log10-transformed from the original FACS values. Thus, the –1 or 1 cutoff corresponds to a 10-fold change in fluorescence, while –0.3 or 0.3 is an approximately twofold change. The wildtype sequence measurements fell in a relatively narrow range of fluorescence (<xref ref-type="fig" rid="fig1">Figure 1c</xref>), with a standard deviation of around 0.03 for three GFP sequences, slightly higher for avGFP (<xref ref-type="table" rid="table1">Table 1</xref>). As the value of ~0.03 was similar regardless of the mean fluorescence, we expect it to hold across other genotypes in the libraries, and would therefore expect that ~99% of measurements should fall within a+/-0.09 interval of the true value (3 standard deviations, which corresponds to a&lt;25% change in fluorescence when converted back to non-log10 values). Both thresholds, 0.3 and 1, for moderate and strong epistasis, respectively, fall comfortably far outside the range of measurement errors caused by experimental noise.</p></sec><sec id="s4-15"><title>Protein purification</title><p>Wildtype sequences with N-terminal His-tags were cloned into T7 expression vectors via MoClo. Chemically competent BL21-DE3 (New England Biolabs) were transformed and plated on LB agar supplemented with antibiotic and 20 µM IPTG, grown overnight at 30°C and left at room temperature an additional day to allow extensive time for fluorescent protein maturation. Colonies from twenty 12 × 12 cm plates were scraped and recovered in 40 ml of binding buffer (500 mM NaCl, 20 mM Tris-HCl, 25 mM imidazole, pH 8), lysed in a Qsonica Q700 sonicator (20 kHz, amplitude 10, 1 s on/4 s off, 20 min of active sonication time), and centrifuged for 30 min at 20,000 g. The supernatant was recovered and incubated with rotation for 1 hr at 4°C with 3 ml of nickel-sepharose protein purification resin (Cytiva). Before use, resin was washed with 5 volumes of binding buffer, and 5 volumes of distilled water.</p><p>After incubation, the protein/resin solution was passed through an empty chromatography column (BioRad Econo-Pac), washed thrice with 20 ml of binding buffer, then protein was recovered in 2–5 ml of elution buffer (500 mM NaCl, 20 mM Tris-HCl, 500 mM imidazole, pH 8).</p></sec><sec id="s4-16"><title>Crystallization, data collection, and structure determination</title><p>AmacGFP (12 mg/mL in 20 mM Tris-HCl buffer, pH 7.5) was crystallized at 21 °C in 8% PEG 6 K, 3% glycerol, 0.1 M sodium acetate, pH 5.0 supplemented with 5.0% Jeffamine M-600 pH 7.0 according to the Hampton Research Additive Screen protocol using the sitting drop vapor diffusion technique. Crystals grew within 1 week and were flash frozen in liquid nitrogen using mother liquor supplemented with 20% PEG 400 as cryoprotectant.</p><p>Diffraction data were collected using the D8 Venture (Bruker AXS, Madison, WI) system that includes an Excillum D2 +MetalJet X-ray source with Helios MX optics providing Ga Kα radiation at a wavelength of 1.3418 Å and a PHOTON III charge-integrating pixel array detector. Data were reduced using Proteum3 software (Bruker AXS). The crystal structures were solved by molecular replacement with MOLREP (<xref ref-type="bibr" rid="bib67">Vagin and Teplyakov, 1997</xref>) using a avGFP mutant as a search model (PDB ID 2AWK). Model building and iterative refinement were performed with Coot (<xref ref-type="bibr" rid="bib20">Emsley and Cowtan, 2004</xref>) and REFMAC (<xref ref-type="bibr" rid="bib47">Murshudov et al., 1997</xref>), respectively. The final statistics of the structure are shown in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>. The model has been deposited into the Protein Data Bank (PDB ID 7LG4).</p></sec><sec id="s4-17"><title>∆∆G prediction and residue distance measurements</title><p>Calculations were performed using the following structures: avGFP (PDB ID 2WUR), ppluGFP2 (PDB ID 2G3O), cgreGFP (PDB ID 2HPW), and amacGFP (PDB ID 7LG4, this study). For each structure, one (the first) chain was extracted and minimized using Rosetta Relax application (<xref ref-type="bibr" rid="bib48">Nivón et al., 2013</xref>) with constraints to starting coordinates. The total of 50 structures were generated for each protein and the model with the lowest total score was chosen for further calculations. The GFP chromophores’ (GYG and SYG) geometries were optimized in Gaussian using density functionals at the B3LYP/6–31++G(d,p) level of theory. The chromophores were treated as non-canonical amino acids (<xref ref-type="bibr" rid="bib55">Renfrew et al., 2012</xref>). ∆∆G calculations (<xref ref-type="supplementary-material" rid="sdata4">Source data 4</xref>) were performed for all single mutations except for nonsense mutations, mutations in the chromophore triade, and positions that are not present in the corresponding crystal structure using Rosetta ddg_monomer application (<xref ref-type="bibr" rid="bib32">Kellogg et al., 2011</xref>). All runs were performed with Rosetta version 3.10. Distances between amino acid residue pairs are available in <xref ref-type="supplementary-material" rid="sdata5">Source data 5</xref>.</p></sec><sec id="s4-18"><title>Urea sensitivity assays</title><p>Absorbance and fluorescence spectra were measured on Biotek SynergyH1 plate readers. For fluorescence, samples consisted of 200 μl of 0.15 μM purified protein in 1 X PBS and either 0 M or 9 M urea, and emission was measured in 5 nm steps from 450 nm to 700 nm upon excitation at 420 nm. For absorbance, samples were identical except for protein concentration, here 18.5 μM, and absorbance was measured in 5 nm steps from 300 nm to 700 nm. In both cases, spectra were continuously measured for around sixty hours, at 42 °C, and a minimum of eight technical replicates were measured for each condition. All plates used were 96-well clear- and flat-bottomed plates; for fluorescence measurements, plates were also black-walled. Blanks containing elution buffer instead of protein (see: Protein purification) were also measured, and their values subtracted from those of the protein samples (<xref ref-type="supplementary-material" rid="sdata6">Source data 6</xref>).</p><p>To measure refolding kinetics, samples were first denatured by diluting in 9 M urea to a final protein concentration of 0.5 mg/ml and heating at 95 °C for 5 min. 10 μl were then transferred to a 96-well flat-bottomed plate and baseline fluorescence (excitation at 485 nm, emission at 520 nm) was measured on a Biotek SynergyH1 plate reader. A total of 200 μl of 1 X PBS was added via injection and fluorescence was immediately measured for 20 min at intervals of 1 s, or for 13.8 hr at intervals of 50 s.</p></sec><sec id="s4-19"><title>Thermosensitivity assays</title><p>Thermal unfolding and/or aggregation of purified green fluorescent proteins was monitored by differential scanning fluorimetry (DSF), circular dichroism (CD), and differential scanning calorimetry (DSC), and fluorescence emission during heating was monitored in a Roche Lightcycler 480. Protein samples were diluted in imidazole-free elution buffer (see: Protein purification) from 20 mg/ml stocks in 500 mM imidazole elution buffer. Raw data are available in <xref ref-type="supplementary-material" rid="sdata7">Source data 7</xref>.</p><sec id="s4-19-1"><title>Differential scanning fluorimetry</title><p>Samples were run in triplicate on a Prometheus NT.48 (NanoTemper Technologies) machine set at 100% excitation power. Samples consisted of 10 μl of 1 mg/ml protein, heated from 20°C to 110°C at a ramp rate of 1 °C per minute; melting temperatures for unfolding and aggregation were determined from the peaks of the first derivatives of either the 350/330 nm emission ratio or the light scattering, respectively. Although all considered GFPs contained a low content of tryptophan, the primary signal source in NanoDSF, all GFPs contained high enough tyrosine content to generate a good signal (avGFP: 1 Trp, 11 Tyr; amacGFP: 1 Trp, 10 Tyr; cgreGFP: 3 Trp, 14 Tyr; ppluGFP2: 0 Trp, 12 Tyr).</p></sec><sec id="s4-19-2"><title>Circular dichroism</title><p>Samples consisting of 200 μl of 0.1 mg/ml protein in a 1 mm thickness cuvette were analyzed on a Jasco J-815 CD spectropolarimeter. Initial protein spectra were measured at 30 °C, from 260 nm to 200 nm, and the spectrum of protein-free buffer was subtracted; protein spectra were not measured beyond 200 nm as the high tension voltage in this region increased beyond 700 V, making CD measurements unreliable. The following settings were used for spectra measurements: scanning speed of 100 nm/min; data pitch of 1 nm; digital integration time of 2 s with 1 nm bandwidth; 10 accumulations. After measuring the initial spectra, samples were heated to 98 °C at a rate of 1 °C per minute, and monitored throughout at 218 nm (208 nm in the case of avGFP), a wavelength corresponding to a peak in the spectra. The full spectra were then measured again at 98 °C, under the same settings described above. The single-wavelength melting curves were fitted with a logistic curve, <inline-formula><mml:math id="inf5"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfrac><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi> </mml:mi><mml:mo>+</mml:mo><mml:mi> </mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mi> </mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mi> </mml:mi><mml:mo>-</mml:mo><mml:mi> </mml:mi><mml:mi>x</mml:mi><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula> , using the Python module scipy.optimize.curve_fit, in order to obtain the melting temperature (<italic>x0</italic>) and the logistic growth rate (<italic>k</italic>).</p></sec><sec id="s4-19-3"><title>Differential scanning calorimetry</title><p>One mg/ml protein samples were run in duplicate on a MicroCal PEAQ-DSC (Malvern Panalytical), and measured from 20°C to 110°C at a ramp rate of 1 °C per minute. Melting temperatures (temperature corresponding to the peak in specific heat capacity or Cp) and enthalpies of denaturation (area under the peak) were determined automatically. DSC runs were performed by the BIC facility of CEITEC MU, Brno.</p></sec><sec id="s4-19-4"><title>Green fluorescence emission upon heating</title><p>Fluorescence emission of purified protein samples (0.1 mg/ml, final volume 20 μl in white 96-well plates) during heating from 20°C to 99°C at a ramp rate of ~2 °C/min was measured on a Roche LightCycler 480 monitoring the SYBR-Green channel (excitation at 465 nm, collection at 510 nm). (<xref ref-type="supplementary-material" rid="sdata7">Source data 7</xref>). Melting temperatures were determined automatically from the melting curve peak.</p></sec></sec><sec id="s4-20"><title>SEC-MALS</title><p>Size exclusion chromatography/multiangle light scattering analysis was performed on an OmniSEC system (Malvern Panalytical). Samples consisted of 0.2μm-filtered, 1 mg/ml purified proteins in 20 mM Tris pH 8, 150 mM NaCl, 25 mM imidazole buffer. Injection volumes were 50 μl. Samples were measured at 30 °C with a flow rate of 0.7 mL/min. SEC-MALS runs were performed by the BIC facility of CEITEC MU, Brno.</p></sec><sec id="s4-21"><title>SDS-PAGE and western blots</title><p>Genome-integrated mutant libraries were plated on LB-Zeocin agar plates, colonies were recovered (pelled weight of 0.25 g) and resuspended in 30 mL of lysis buffer (1 X PBS pH 7.4, 150 mM NaCl, supplemented with 50 μl protease inhibitor cocktail (Sigma Aldrich, ref P8340)). Cells were sonicated on a QSonica Q700 (20 kHz, amplitude 10, 1 s on/4 s off, 10 minutes of active sonication). To separate soluble and insoluble fractions, 15 μl of lysate were centrifuged for 10 minutes at 20,000 g, supernatant was collected and the pellet resuspended in 15 μl of lysis buffer. 5 μl of 4 X Laemmli loading dye (BioRad) was added to 15 μl of either total lysate, supernatant, or resuspended pellet. Samples were boiled at 95 °C for 5 min, and run in 4–20% polyacrylamide Mini-Protean precast gels (BioRad) at 100 V for 1 hr. The Protein Precision Plus Standard (BioRad) was used as a molecular weight marker. Gels were stained with a colloidal Coomassie dye, ReadyBlue (Sigma-Aldrich), overnight at room temperature.</p><p>For Western blot, gels were transferred to PVDF membranes (BioRad) using a Trans-Blot Turbo Transfer system (BioRad), blocked with EveryBlot blocking buffer (BioRad) for 15 min at room temperature, and incubated overnight at 4 °C with a mouse monoclonal anti-His-tag primary antibody (Abcam, ref ab18184) diluted 1:1000. Membranes were washed in 1 X PBS/0.05% Tween-20 (five 5-min washes), incubated for two hours at room temperature with 1:1000 anti-mouse HRP secondary antibody (Cell Signal, ref #7076), washed, and incubated with SuperSignal West Pico-Plus ECL substrate and imaged on a ChemiDoc MP system (BioRad).</p></sec><sec id="s4-22"><title>Experimental testing of predictions</title><p>Coding sequences for neural network-generated genotypes (<xref ref-type="supplementary-material" rid="sdata8">Source data 8</xref>) were ordered as dsDNA from Twist Biosciences, flanked by BsaI restriction sites for MoClo insertion into destination vectors. GFP sequences were cloned into a medium/low-copy vector conferring zeocin resistance, under a constitutive T5 promoter and lambda t0 terminator, and transformed into XL10-Gold chemically competent cells. Cells were plated on LB-zeocin agar supplemented with ink (1%) to improve fluorescence visualization. Colonies of each construct were picked and sent for Sanger sequence confirmation (Microsynth). Photographs of plates were taken with a Canon EOS 600D SLR camera. For comparison of fluorescence of different genotypes, photographs of plates containing streaks of all wild-types and mutants were photographed under identical conditions (aperture 2.8, ISO 100, 0.8 s exposure time), images were converted to 8 bit in FIJI and median pixel values were determined for each streak. Brightness, contrast, or other image parameters were not altered, and none of the images used contained any saturated pixels.</p></sec><sec id="s4-23"><title>Sequence and evolutionary analysis</title><p>A total of 68 GFP sequences with confirmed emission in the green spectrum were selected using available information from the literature. These sequences (<xref ref-type="supplementary-material" rid="sdata9">Source data 9</xref>) were used in the analysis of the fraction of deleterious amino acids in one of the four wildtype sequences that were neutral in another genotype (<xref ref-type="fig" rid="fig5">Figure 5</xref>) and in determining extant amino acid states (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). To calculate the rate of evolution of mutations that were used in successful predictions of distant functional GFPs, we aligned these 68 amino acid sequences with muscle (<xref ref-type="bibr" rid="bib19">Edgar, 2004</xref>), trimmed the alignment and made a phylogenetic reconstruction with MrBayes (<xref ref-type="bibr" rid="bib58">Ronquist et al., 2012</xref>), reconstructed the ancestral state of a non-trimmel codon alignments and calculated the ds per each branch of the tree by codeml (<xref ref-type="bibr" rid="bib74">Yang, 2007</xref>). Finally, we compared the rate of evolution between the two amino acid states (the one found in the wildtype and the other corresponding to an amino acid state used in at least one of the successful neural network predictions) to the rate of synonymous evolution (ds) at the same branches (<xref ref-type="supplementary-material" rid="sdata10">Source data 10</xref>).</p></sec><sec id="s4-24"><title>Modeling the fitness landscape of GFPs with neural networks</title><p>For all 4 fitness landscapes, the log10-transformed fluorescence (fluorescence for short) is a bimodal distribution of two normals with very little overlap. One mode corresponds to non-functional genotypes while the other mode corresponds to functional genotypes of near wild-type fluorescence levels. In each dataset, genotypes associated with negative fluorescence have been excluded to ensure that the four distributions cover similar ranges. The genotype-phenotype datasets were split randomly into training, validation and test sets (60%, 20–20%). To evaluate the complexity of the genotype-phenotype relationship in the four landscapes, we trained neural networks of increasing complexity on one-hot encoded protein sequences with the task of predicting fluorescence level. One-hot is a binary encoding that represents which amino acid is present or absent for each position in a sequence. All models were built using Keras (<xref ref-type="bibr" rid="bib12">Chollet, 2015</xref>). Model goodness was measured as the coefficient of determination between known and predicted fluorescence values associated with genotypes in the validation set.</p><p>For each dataset, a linear model defined as a neural network containing only an input layer and one layer of a single neuron with linear activation was trained for a maximum of 30 epochs with the objective to minimise the loss as defined by the mean squared error (MSE) between actual and predicted fluorescence levels. Overfitting was prevented by monitoring the validation loss with a patience of 10 epochs. These baseline models output a simple estimate of the fluorescence level, the fitness potential, associated with each genotype. It is simply the summed contribution of mutations assigned individual weights. Models with a sigmoid output node were obtained by adding a single neuron with sigmoid activation function to these architectures and retraining on the training set.</p><p>In order to capture and visualise the non-trivial functions transforming the fitness potential into the predicted fluorescence, we trained models containing an input layer, a hidden layer with one linear node, computing the fitness potential, a second hidden layer of 10 sigmoid nodes and one linear output node outputting the fluorescence. The output subnetwork of 10 sigmoids allows the models to approximate a wide variety of sophisticated functions. For each genotype in the validation set, we computed the fitness potential as the output of the first hidden layer, and the predicted fluorescence. The output subnetworks were able to accurately capture the functions transforming the fitness potential into fluorescence level, revealing non-trivial sigmoid functions (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>).</p><p>Optimisation of artificial neural nets was performed using a random grid search approach. Tested architectures contained one input layer, one hidden layer with linear nodes, a second hidden layer with sigmoid nodes, and one linear output node. The two hidden layers were built with random numbers of neurons, picked from 1 to 10, 20, 50, 100, 200. The models also contained one Monte Carlo dropout layer after each hidden layer (rate = 0.1, training = True), but not after the output node (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). MC Dropout layers present the double advantage of preventing overfitting and allowing the model to predict the fluorescence of each genotype with uncertainty estimates (<xref ref-type="bibr" rid="bib27">Hinton et al., 2012</xref>; <xref ref-type="bibr" rid="bib66">Srivastava et al., 2014</xref>). Each architecture was trained for 10 epochs and the architecture with the smallest loss (MSE) on the validation set was selected for further training to a maximum of 30 epochs. To ensure fair training of the optimised models, the training set was filtered to exclude genotypes containing mutations present in less than 10 distinct genotypes. Since removing a genotype with a rare mutation also decreases the number of occurrences of the other mutations this genotype may contain, the filtration process was repeated until all mutations in the training set were present in at least 10 genotypes and therefore no further genotype had to be removed. To ensure fair scoring of the optimised models, the validation set was filtered to remove genotypes that contained mutations absent from the training set. This ensures the neural networks are trained on enough examples for each mutation, and the model’s final score is not underestimated due to poorly trained mutations present in the validation set. These models were then used as part of a genetic algorithm to predict distant functional genotypes.</p><p>For each gene, an additional model with 10, 100 and 1 leaky ReLU nodes was trained and validated independently on 90% and 10% of the dataset respectively for a maximum of 500 epochs, minimising MSE loss. Overfitting was prevented by monitoring the validation loss with a patience of 10 epochs. Coefficients of determination were 0.710, 0.740, and 0.810 for amacGFP, cgreGFP and ppluGFP2, respectively. These models were used to filter genetic algorithm predictions a posteriori with an independent predictor.</p></sec><sec id="s4-25"><title>Prediction of distant functional genotypes</title><p>Prediction of distant functional genotypes was performed using a genetic algorithm approach. An initial population of 50 wild-type genotypes is initialised. At each generation, the genotypes were shuffled and half of the population was put aside to remain untouched. The other half undergoes crossing-overs and mutations. Crossing-overs were performed randomly along pairs of genotypes without gene conversion. Crossing-overs had a 0.7 probability of occuring in each couple of sequences and the number of crossing-overs was chosen randomly in the range of 0–5. Resulting genotypes (some of which may not have been crossed) underwent a mutagenesis step. Mutations were picked from a random pool containing mutated states but also wild-type states to allow the algorithm a chance to revert evolutionary dead-ends. If the targeted number of mutations defined by the user was exceeded in a genotype, the algorithm removed one previously added mutation from the genotype, allowing heavily mutated sequences to gradually bounce back to the target value. Per amino-acid mutation probabilities were defined empirically in the range of 0.01–0.015. After crossing-overs and mutations, the new genotypes were added to the rest of the population.</p><p>Mutations available to the genetic algorithm were selected using the following approach: we excluded mutations that had been seen by the model in less than 10 distinct genotypes during training of the optimised neural nets. From the remaining mutations, we kept those for which we could find in the dataset both genotypes that had those mutations and identical counterparts or ‘background’ genotypes without these mutations. If at least five pairs of corresponding genotypes could be found, the impact of the mutation was computed by subtracting the fluorescence levels of the genotypes without the mutation to the fluorescence levels of the genotypes that contain the mutation and taking the median. Last, only mutations with a median impact greater or equal to –0.1 log10 fluorescence units were fed into the genetic algorithm. In short, this approach excludes severely deleterious mutations from the genetic algorithm.</p><p>Finally, to ensure predicted genotypes did not converge to ‘known’ functional genotypes, the pool of usable mutations was enriched in mutations that do not lead to states observed in natural GFP sequences. To do so, all sequences were scraped from FPbase (June 2020), filtered to keep green natural ones and aligned on a profile obtained from the wild-type sequence of amacGFP, avGFP, cgreGFP, and ppluGFP2. We then applied in the pool of mutations available to the genetic algorithm, a ratio of 0.6 in favor of mutations that could not be found in natural GFPs.</p><p>After the crossing-over and mutation steps, the genotypes were one-hot encoded and their fluorescence level was updated by taking the median of 20 outcomes computed by the optimised neural network. The genotypes were sorted by descending fluorescence and only top genotypes were kept to maintain a constant population size. This process was repeated for several generations. Crossing-over and mutation rates, number of generations, and the ratio between mutated or wild-type available states were adjusted empirically to allow most genotypes in the population to reach the desired number of mutations while evolving to improved fluorescence levels. Notably, the algorithm was stopped a few generations after the median of predicted fluorescence levels in the population reached a plateau. This was to ensure the algorithm selects the best performing genotypes at the desired number of mutations while maintaining sequence diversity in the population. The entire algorithm was repeated until all unique mutations in the pool had been sampled, with a minimum of 10 replicates.</p><p>The resulting predictions were filtered to keep unique genotypes that contained the required number of mutations and whose fluorescence ± standard deviation as computed by the optimised and the posteriori neural networks was greater than fluorescence level of their wild-type counterpart. Finally, we used cd-hit (<xref ref-type="bibr" rid="bib23">Fu et al., 2012</xref>; <xref ref-type="bibr" rid="bib43">Li and Godzik, 2006</xref>) iteratively with a similarity threshold decreasing at each iteration until the remaining set of candidate sequences could be separated into the desired number of clusters. One representative sequence per cluster was picked for experimental validation.</p></sec><sec id="s4-26"><title>Software</title><p>Visualization of proteins was done in PyMOL (The PyMOL Molecular Graphics System, Version 2.0 Schrödinger, LLC.). Custom scripts for data processing and analysis were written in Python 3, with the most frequently used libraries being NumPy (v. 1.18.1), Pandas (v. 1.3.4), and SciPy (v. 1.7.2). Matplotlib (v. 3.1.3), Seaborn (v. 0.11.2), and cmocean (v. 2.0) were used for data visualization.</p></sec><sec id="s4-27"><title>Data availability</title><p>All data and programs relevant to our methodology is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/aequorea238/Orthologous_GFP_Fitness_Peaks">https://github.com/aequorea238/Orthologous_GFP_Fitness_Peaks</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:a97c49ae0b37c660abe44c9df23be5e58e4110f5;origin=https://github.com/aequorea238/Orthologous_GFP_Fitness_Peaks;visit=swh:1:snp:7c7427977413dc6f094c67f1d445906ffd525625;anchor=swh:1:rev:4bb2791013567442a8ea4d7735ca79311502bdee">swh:1:rev:4bb2791013567442a8ea4d7735ca79311502bdee</ext-link>; <xref ref-type="bibr" rid="bib65">Somermeyer, 2022</xref>). Cell libraries are available upon reasonable request and subject to a material transfer agreement.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Investigation, Methodology, Project administration, Validation, Visualization, Writing – original draft</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Investigation, Software, Validation, Visualization, Writing – original draft</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Investigation, Supervision, Validation</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Formal analysis, Investigation, Methodology, Resources, Validation, Visualization, Writing – original draft</p></fn><fn fn-type="con" id="con5"><p>Formal analysis, Investigation, Methodology</p></fn><fn fn-type="con" id="con6"><p>Funding acquisition, Methodology, Project administration, Resources, Supervision</p></fn><fn fn-type="con" id="con7"><p>Formal analysis, Investigation</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Formal analysis, Investigation, Methodology, Supervision, Visualization</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Formal analysis, Funding acquisition, Investigation, Methodology, Project administration, Resources, Software, Supervision, Validation, Visualization</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Formal analysis, Funding acquisition, Investigation, Methodology, Project administration, Resources, Supervision, Validation, Visualization, Writing – original draft</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-75842-transrepform1-v3.docx"/></supplementary-material><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Selected statistics of genotypes at different divergence from five GFP sequences.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-75842-supp1-v3.docx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Data Collection and Refinement Statistics.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-75842-supp2-v3.docx"/></supplementary-material><supplementary-material id="sdata1"><label>Source data 1.</label><caption><title>Absolute values for the borders between gates in the green channel during sorting, for all genes and machines, and the corrections applied to match values between the machines.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-75842-data1-v3.xlsx"/></supplementary-material><supplementary-material id="sdata2"><label>Source data 2.</label><caption><title>Dataframes containing the distribution across gates of all primary-secondary barcode combinations, along with their fitted fitness values (see Materials and methods).</title><p>Data are not filtered according to cell count, number of replicates, etc. One dataframe per gene and machine.</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-75842-data2-v3.zip"/></supplementary-material><supplementary-material id="sdata3"><label>Source data 3.</label><caption><title>Dataframes linking nucleotide or protein genotypes to their measured fluorescence level (see Materials and methods).</title><p>Mutations in genotypes are labeled in the format AiB, where A is the original wildtype state, B is the mutated state, and i is the position (counting starts from Methionine = 0). In the nucleotide dataset, 'n_replicates' refers to the combined number of distinct barcodes representing a genotype and machines it was measured on. In the amino acid dataset, 'n_replicates' refers to the number of synonymous nucleotide sequences measured for each protein sequence. Nucleotide genotypes and amino acid genotypes are on separate tabs in the file.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-75842-data3-v3.xlsx"/></supplementary-material><supplementary-material id="sdata4"><label>Source data 4.</label><caption><title>Table containing ddG predictions for single mutations in avGFP, amacGFP, amacGFP:V12L, cgreGFP, and ppluGFP2.</title><p>Residue positions are labeled starting from 0 (methionine).</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-75842-data4-v3.csv"/></supplementary-material><supplementary-material id="sdata5"><label>Source data 5.</label><caption><title>Dataframes containing the minimum physical distance between pairs of residues inside the 3D GFP structures, in Angstroms.</title><p>Row and column indices represent the residue position within the protein, starting from 0 for the initial methionine. Matrices for different proteins are included in different tabs in the file.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-75842-data5-v3.xlsx"/></supplementary-material><supplementary-material id="sdata6"><label>Source data 6.</label><caption><title>Table containing absorbance values (from 300 to 700nm) and fluorescence emission values (from 450nm to 700nm, upon 420nm excitation) for all genes, in 9M urea and PBS, measured on a plate reader at multiple consecutive time points.</title><p>Blank control values are already subtracted. Absorbance and fluorescence data are listed on separate tabs</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-75842-data6-v3.xlsx"/></supplementary-material><supplementary-material id="sdata7"><label>Source data 7.</label><caption><title>Raw data from differential scanning fluorimetry and calorimetry, circular dichroism, and qPCR melting curves.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-75842-data7-v3.xlsx"/></supplementary-material><supplementary-material id="sdata8"><label>Source data 8.</label><caption><title>Coding sequences for neural network-generated genotypes, and their predicted and observed levels of fluorescence.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-75842-data8-v3.csv"/></supplementary-material><supplementary-material id="sdata9"><label>Source data 9.</label><caption><title>Table of over 70 documented natural fluorescent proteins used during analyses, including name, species, sequence, original reference and, where possible, accession numbers and measured excitation/emission peaks.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-75842-data9-v3.csv"/></supplementary-material><supplementary-material id="sdata10"><label>Source data 10.</label><caption><title>Estimated rates of evolution of amino acid states used in prediction of novel GFP sequences on each branch of the phylogeny of extant GFPs.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-75842-data10-v3.xlsx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting file and are available on GitHub <ext-link ext-link-type="uri" xlink:href="https://github.com/aequorea238/Orthologous_GFP_Fitness_Peaks">https://github.com/aequorea238/Orthologous_GFP_Fitness_Peaks</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Somermeyer</surname><given-names>LG</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Heterogeneity of the GFP fitness landscape and data-driven protein design</data-title><source>GitHub</source><pub-id pub-id-type="accession" xlink:href="https://github.com/aequorea238/Orthologous_GFP_Fitness_Peaks">Fitness_Peaks</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Ondřej Draganov, Rodrigo Redondo, Bor Kavčič, Mia Juračić and Andrea Pauli for discussion and technical advice. We thank Anita Testa Salmazo for advice on resin protein purification, Dmitry Bolotin and the Milaboratory (<ext-link ext-link-type="uri" xlink:href="https://milaboratory.com/">milaboratory.com</ext-link>) for access to computing and storage infrastructure, and Josef Houser and Eva Fujdiarova for technical assistance and data interpretation. Core facility Biomolecular Interactions and Crystallization of CEITEC Masaryk University is gratefully acknowledged for the obtaining of the scientific data presented in this paper. This research was supported by the Scientific Service Units (SSU) of IST-Austria through resources provided by the Bioimaging Facility (BIF), and the Life Science Facility (LSF). MiSeq and HiSeq NGS sequencing was performed by the Next Generation Sequencing Facility at Vienna BioCenter Core Facilities (VBCF), member of the Vienna BioCenter (VBC), Austria. FACS was performed at the BioOptics Facility of the Institute of Molecular Pathology (IMP), Austria. We also thank the Biomolecular Crystallography Facility in the Vanderbilt University Center for Structural Biology. We are grateful to Joel M Harp for help with X-ray data collection. This work was supported by the ERC Consolidator grant to FAK (771209—CharFL). KSS acknowledges support by President’s Grant МК–5405.2021.1.4, the Imperial College Research Fellowship and the MRC London Institute of Medical Sciences (UKRI MC-A658-5QEA0). AF is supported by the Marie Skłodowska-Curie Fellowship (H2020-MSCA-IF-2019, Grant Agreement No. 898203, Project acronym &quot;FLINDIP&quot;). Experiments were partially carried out using equipment provided by the Institute of Bioorganic Chemistry of the Russian Academy of Sciences Сore Facility (CKP IBCH). This work was supported by a Russian Science Foundation grant 19-74-10102. This project has received funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie Grant Agreement No. 665,385.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alley</surname><given-names>EC</given-names></name><name><surname>Khimulya</surname><given-names>G</given-names></name><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>AlQuraishi</surname><given-names>M</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Unified rational protein engineering with sequence-based deep representation learning</article-title><source>Nature Methods</source><volume>16</volume><fpage>1315</fpage><lpage>1322</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0598-1</pub-id><pub-id pub-id-type="pmid">31636460</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname><given-names>BT</given-names></name><name><surname>Roy</surname><given-names>M</given-names></name><name><surname>Jennings</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Chromophore packing leads to hysteresis in GFP</article-title><source>Journal of Molecular Biology</source><volume>392</volume><fpage>218</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2009.06.072</pub-id><pub-id pub-id-type="pmid">19577576</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Armougom</surname><given-names>F</given-names></name><name><surname>Moretti</surname><given-names>S</given-names></name><name><surname>Poirot</surname><given-names>O</given-names></name><name><surname>Audic</surname><given-names>S</given-names></name><name><surname>Dumas</surname><given-names>P</given-names></name><name><surname>Schaeli</surname><given-names>B</given-names></name><name><surname>Keduas</surname><given-names>V</given-names></name><name><surname>Notredame</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Expresso: automatic incorporation of structural information in multiple sequence alignments using 3D-Coffee</article-title><source>Nucleic Acids Research</source><volume>34</volume><fpage>604</fpage><lpage>608</lpage><pub-id pub-id-type="doi">10.1093/nar/gkl092</pub-id><pub-id pub-id-type="pmid">16845081</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bank</surname><given-names>C</given-names></name><name><surname>Hietpas</surname><given-names>RT</given-names></name><name><surname>Jensen</surname><given-names>JD</given-names></name><name><surname>Bolon</surname><given-names>DNA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A systematic survey of an intragenic epistatic landscape</article-title><source>Molecular Biology and Evolution</source><volume>32</volume><fpage>229</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu301</pub-id><pub-id pub-id-type="pmid">25371431</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bassalo</surname><given-names>MC</given-names></name><name><surname>Garst</surname><given-names>AD</given-names></name><name><surname>Halweg-Edwards</surname><given-names>AL</given-names></name><name><surname>Grau</surname><given-names>WC</given-names></name><name><surname>Domaille</surname><given-names>DW</given-names></name><name><surname>Mutalik</surname><given-names>VK</given-names></name><name><surname>Arkin</surname><given-names>AP</given-names></name><name><surname>Gill</surname><given-names>RT</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Rapid and Efficient One-Step Metabolic Pathway Integration in <italic>E. coli</italic></article-title><source>ACS Synthetic Biology</source><volume>5</volume><fpage>561</fpage><lpage>568</lpage><pub-id pub-id-type="doi">10.1021/acssynbio.5b00187</pub-id><pub-id pub-id-type="pmid">27072506</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bershtein</surname><given-names>S</given-names></name><name><surname>Segal</surname><given-names>M</given-names></name><name><surname>Bekerman</surname><given-names>R</given-names></name><name><surname>Tokuriki</surname><given-names>N</given-names></name><name><surname>Tawfik</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Robustness-epistasis link shapes the fitness landscape of a randomly drifting protein</article-title><source>Nature</source><volume>444</volume><fpage>929</fpage><lpage>932</lpage><pub-id pub-id-type="doi">10.1038/nature05385</pub-id><pub-id pub-id-type="pmid">17122770</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>Kuznetsov</surname><given-names>G</given-names></name><name><surname>Ogden</surname><given-names>PJ</given-names></name><name><surname>Conway</surname><given-names>NJ</given-names></name><name><surname>Adams</surname><given-names>RP</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Toward Machine-Guided Design of Proteins</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/337154</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>Khimulya</surname><given-names>G</given-names></name><name><surname>Alley</surname><given-names>EC</given-names></name><name><surname>Esvelt</surname><given-names>KM</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Low-N protein engineering with data-efficient deep learning</article-title><source>Nature Methods</source><volume>18</volume><fpage>389</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1038/s41592-021-01100-y</pub-id><pub-id pub-id-type="pmid">33828272</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bryant</surname><given-names>DH</given-names></name><name><surname>Bashir</surname><given-names>A</given-names></name><name><surname>Sinai</surname><given-names>S</given-names></name><name><surname>Jain</surname><given-names>NK</given-names></name><name><surname>Ogden</surname><given-names>PJ</given-names></name><name><surname>Riley</surname><given-names>PF</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name><name><surname>Colwell</surname><given-names>LJ</given-names></name><name><surname>Kelsic</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Deep diversification of an AAV capsid protein by machine learning</article-title><source>Nature Biotechnology</source><volume>39</volume><fpage>691</fpage><lpage>696</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-00793-4</pub-id><pub-id pub-id-type="pmid">33574611</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Canale</surname><given-names>AS</given-names></name><name><surname>Cote-Hammarlof</surname><given-names>PA</given-names></name><name><surname>Flynn</surname><given-names>JM</given-names></name><name><surname>Bolon</surname><given-names>DN</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evolutionary mechanisms studied through protein fitness landscapes</article-title><source>Current Opinion in Structural Biology</source><volume>48</volume><fpage>141</fpage><lpage>148</lpage><pub-id pub-id-type="doi">10.1016/j.sbi.2018.01.001</pub-id><pub-id pub-id-type="pmid">29351890</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>YH</given-names></name><name><surname>Venev</surname><given-names>SV</given-names></name><name><surname>Zeldovich</surname><given-names>KB</given-names></name><name><surname>Matthews</surname><given-names>CR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Correlation of fitness landscapes from three orthologous TIM barrels originates from sequence and structure constraints</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>14614</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms14614</pub-id><pub-id pub-id-type="pmid">28262665</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Chollet</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Keras</data-title><version designator="a8d5bb9">a8d5bb9</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/keras-team/keras">https://github.com/keras-team/keras</ext-link></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Codoñer</surname><given-names>FM</given-names></name><name><surname>Darós</surname><given-names>JA</given-names></name><name><surname>Solé</surname><given-names>RV</given-names></name><name><surname>Elena</surname><given-names>SF</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The fittest versus the flattest: experimental confirmation of the quasispecies effect with subviral pathogens</article-title><source>PLOS Pathogens</source><volume>2</volume><elocation-id>e136</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.0020136</pub-id><pub-id pub-id-type="pmid">17196038</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Creighton</surname><given-names>TE</given-names></name><name><surname>Creighton</surname><given-names>TE</given-names></name></person-group><year iso-8601-date="1993">1993</year><source>Proteins: Structures and Molecular Properties</source><publisher-name>W. H. Freeman</publisher-name></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Visser</surname><given-names>J</given-names></name><name><surname>Hermisson</surname><given-names>J</given-names></name><name><surname>Wagner</surname><given-names>GP</given-names></name><name><surname>Ancel Meyers</surname><given-names>L</given-names></name><name><surname>Bagheri-Chaichian</surname><given-names>H</given-names></name><name><surname>Blanchard</surname><given-names>JL</given-names></name><name><surname>Chao</surname><given-names>L</given-names></name><name><surname>Cheverud</surname><given-names>JM</given-names></name><name><surname>Elena</surname><given-names>SF</given-names></name><name><surname>Fontana</surname><given-names>W</given-names></name><name><surname>Gibson</surname><given-names>G</given-names></name><name><surname>Hansen</surname><given-names>TF</given-names></name><name><surname>Krakauer</surname><given-names>D</given-names></name><name><surname>Lewontin</surname><given-names>RC</given-names></name><name><surname>Ofria</surname><given-names>C</given-names></name><name><surname>Rice</surname><given-names>SH</given-names></name><name><surname>von Dassow</surname><given-names>G</given-names></name><name><surname>Wagner</surname><given-names>A</given-names></name><name><surname>Whitlock</surname><given-names>MC</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Perspective: Evolution and detection of genetic robustness</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>57</volume><fpage>1959</fpage><lpage>1972</lpage><pub-id pub-id-type="doi">10.1111/j.0014-3820.2003.tb00377.x</pub-id><pub-id pub-id-type="pmid">14575319</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Visser</surname><given-names>J</given-names></name><name><surname>Krug</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Empirical fitness landscapes and the predictability of evolution</article-title><source>Nature Reviews. Genetics</source><volume>15</volume><fpage>480</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1038/nrg3744</pub-id><pub-id pub-id-type="pmid">24913663</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Draghi</surname><given-names>JA</given-names></name><name><surname>Parsons</surname><given-names>TL</given-names></name><name><surname>Wagner</surname><given-names>GP</given-names></name><name><surname>Plotkin</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Mutational robustness can facilitate adaptation</article-title><source>Nature</source><volume>463</volume><fpage>353</fpage><lpage>355</lpage><pub-id pub-id-type="doi">10.1038/nature08694</pub-id><pub-id pub-id-type="pmid">20090752</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Echave</surname><given-names>J</given-names></name><name><surname>Wilke</surname><given-names>CO</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Biophysical Models of Protein Evolution: Understanding the Patterns of Evolutionary Sequence Divergence</article-title><source>Annual Review of Biophysics</source><volume>46</volume><fpage>85</fpage><lpage>103</lpage><pub-id pub-id-type="doi">10.1146/annurev-biophys-070816-033819</pub-id><pub-id pub-id-type="pmid">28301766</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title><source>Nucleic Acids Research</source><volume>32</volume><fpage>1792</fpage><lpage>1797</lpage><pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id><pub-id pub-id-type="pmid">15034147</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emsley</surname><given-names>P</given-names></name><name><surname>Cowtan</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Coot: model-building tools for molecular graphics</article-title><source>Acta Crystallographica. Section D, Biological Crystallography</source><volume>60</volume><fpage>2126</fpage><lpage>2132</lpage><pub-id pub-id-type="doi">10.1107/S0907444904019158</pub-id><pub-id pub-id-type="pmid">15572765</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferretti</surname><given-names>L</given-names></name><name><surname>Weinreich</surname><given-names>D</given-names></name><name><surname>Tajima</surname><given-names>F</given-names></name><name><surname>Achaz</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evolutionary constraints in fitness landscapes</article-title><source>Heredity</source><volume>121</volume><fpage>466</fpage><lpage>481</lpage><pub-id pub-id-type="doi">10.1038/s41437-018-0110-1</pub-id><pub-id pub-id-type="pmid">29993041</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fragata</surname><given-names>I</given-names></name><name><surname>Blanckaert</surname><given-names>A</given-names></name><name><surname>Dias Louro</surname><given-names>MA</given-names></name><name><surname>Liberles</surname><given-names>DA</given-names></name><name><surname>Bank</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Evolution in the light of fitness landscape theory</article-title><source>Trends in Ecology &amp; Evolution</source><volume>34</volume><fpage>69</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2018.10.009</pub-id><pub-id pub-id-type="pmid">30583805</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>L</given-names></name><name><surname>Niu</surname><given-names>B</given-names></name><name><surname>Zhu</surname><given-names>Z</given-names></name><name><surname>Wu</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title><source>Bioinformatics (Oxford, England)</source><volume>28</volume><fpage>3150</fpage><lpage>3152</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts565</pub-id><pub-id pub-id-type="pmid">23060610</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gong</surname><given-names>LI</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name><name><surname>Bloom</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Stability-mediated epistasis constrains the evolution of an influenza protein</article-title><source>eLife</source><volume>2</volume><elocation-id>e00631</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00631</pub-id><pub-id pub-id-type="pmid">23682315</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haddox</surname><given-names>HK</given-names></name><name><surname>Dingens</surname><given-names>AS</given-names></name><name><surname>Hilton</surname><given-names>SK</given-names></name><name><surname>Overbaugh</surname><given-names>J</given-names></name><name><surname>Bloom</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Mapping mutational effects along the evolutionary landscape of HIV envelope</article-title><source>eLife</source><volume>7</volume><elocation-id>34420</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34420</pub-id><pub-id pub-id-type="pmid">29590010</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartman</surname><given-names>EC</given-names></name><name><surname>Tullman-Ercek</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Learning from protein fitness landscapes: a review of mutability, epistasis, and evolution</article-title><source>Current Opinion in Systems Biology</source><volume>14</volume><fpage>25</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.1016/j.coisb.2019.02.006</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Hinton</surname><given-names>GE</given-names></name><name><surname>Srivastava</surname><given-names>N</given-names></name><name><surname>Krizhevsky</surname><given-names>A</given-names></name><name><surname>Sutskever</surname><given-names>I</given-names></name><name><surname>Salakhutdinov</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Improving Neural Networks by Preventing Co-Adaptation of Feature Detectors</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1207.0580">https://arxiv.org/abs/1207.0580</ext-link></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hirabayashi</surname><given-names>J</given-names></name><name><surname>Arai</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Lectin engineering: the possible and the actual</article-title><source>Interface Focus</source><volume>9</volume><elocation-id>20180068</elocation-id><pub-id pub-id-type="doi">10.1098/rsfs.2018.0068</pub-id><pub-id pub-id-type="pmid">30842871</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacquier</surname><given-names>H</given-names></name><name><surname>Birgy</surname><given-names>A</given-names></name><name><surname>Le Nagard</surname><given-names>H</given-names></name><name><surname>Mechulam</surname><given-names>Y</given-names></name><name><surname>Schmitt</surname><given-names>E</given-names></name><name><surname>Glodt</surname><given-names>J</given-names></name><name><surname>Bercot</surname><given-names>B</given-names></name><name><surname>Petit</surname><given-names>E</given-names></name><name><surname>Poulain</surname><given-names>J</given-names></name><name><surname>Barnaud</surname><given-names>G</given-names></name><name><surname>Gros</surname><given-names>PA</given-names></name><name><surname>Tenaillon</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Capturing the mutational landscape of the beta-lactamase TEM-1</article-title><source>PNAS</source><volume>110</volume><fpage>13067</fpage><lpage>13072</lpage><pub-id pub-id-type="doi">10.1073/pnas.1215206110</pub-id><pub-id pub-id-type="pmid">23878237</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>MS</given-names></name><name><surname>Martsul</surname><given-names>A</given-names></name><name><surname>Kryazhimskiy</surname><given-names>S</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Higher-fitness yeast genotypes are less robust to deleterious mutations</article-title><source>Science (New York, N.Y.)</source><volume>366</volume><fpage>490</fpage><lpage>493</lpage><pub-id pub-id-type="doi">10.1126/science.aay4199</pub-id><pub-id pub-id-type="pmid">31649199</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keefe</surname><given-names>AD</given-names></name><name><surname>Szostak</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Functional proteins from a random-sequence library</article-title><source>Nature</source><volume>410</volume><fpage>715</fpage><lpage>718</lpage><pub-id pub-id-type="doi">10.1038/35070613</pub-id><pub-id pub-id-type="pmid">11287961</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kellogg</surname><given-names>EH</given-names></name><name><surname>Leaver-Fay</surname><given-names>A</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Role of conformational sampling in computing mutation-induced changes in protein structure and stability</article-title><source>Proteins</source><volume>79</volume><fpage>830</fpage><lpage>838</lpage><pub-id pub-id-type="doi">10.1002/prot.22921</pub-id><pub-id pub-id-type="pmid">21287615</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kemble</surname><given-names>H</given-names></name><name><surname>Nghe</surname><given-names>P</given-names></name><name><surname>Tenaillon</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Recent insights into the genotype-phenotype relationship from massively parallel genetic assays</article-title><source>Evolutionary Applications</source><volume>12</volume><fpage>1721</fpage><lpage>1742</lpage><pub-id pub-id-type="doi">10.1111/eva.12846</pub-id><pub-id pub-id-type="pmid">31548853</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>M</given-names></name><name><surname>Crow</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Effect of overall phenotypic selection on genetic change at individual loci</article-title><source>PNAS</source><volume>75</volume><fpage>6168</fpage><lpage>6171</lpage><pub-id pub-id-type="doi">10.1073/pnas.75.12.6168</pub-id><pub-id pub-id-type="pmid">282633</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klug</surname><given-names>A</given-names></name><name><surname>Park</surname><given-names>SC</given-names></name><name><surname>Krug</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Recombination and mutational robustness in neutral fitness landscapes</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1006884</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006884</pub-id><pub-id pub-id-type="pmid">31415555</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kondrashov</surname><given-names>DA</given-names></name><name><surname>Kondrashov</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Topological features of rugged fitness landscapes in sequence space</article-title><source>Trends in Genetics</source><volume>31</volume><fpage>24</fpage><lpage>33</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2014.09.009</pub-id><pub-id pub-id-type="pmid">25438718</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Natarajan</surname><given-names>C</given-names></name><name><surname>Moriyama</surname><given-names>H</given-names></name><name><surname>Witt</surname><given-names>CC</given-names></name><name><surname>Weber</surname><given-names>RE</given-names></name><name><surname>Fago</surname><given-names>A</given-names></name><name><surname>Storz</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Stability-Mediated Epistasis Restricts Accessible Mutational Pathways in the Functional Evolution of Avian Hemoglobin</article-title><source>Molecular Biology and Evolution</source><volume>34</volume><fpage>1240</fpage><lpage>1251</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx085</pub-id><pub-id pub-id-type="pmid">28201714</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuo</surname><given-names>ST</given-names></name><name><surname>Jahn</surname><given-names>RL</given-names></name><name><surname>Cheng</surname><given-names>YJ</given-names></name><name><surname>Chen</surname><given-names>YL</given-names></name><name><surname>Lee</surname><given-names>YJ</given-names></name><name><surname>Hollfelder</surname><given-names>F</given-names></name><name><surname>Wen</surname><given-names>JD</given-names></name><name><surname>Chou</surname><given-names>HHD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Global fitness landscapes of the Shine-Dalgarno sequence</article-title><source>Genome Research</source><volume>30</volume><fpage>711</fpage><lpage>723</lpage><pub-id pub-id-type="doi">10.1101/gr.260182.119</pub-id><pub-id pub-id-type="pmid">32424071</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurahashi</surname><given-names>R</given-names></name><name><surname>Sano</surname><given-names>S</given-names></name><name><surname>Takano</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Protein Evolution is Potentially Governed by Protein Stability: Directed Evolution of an Esterase from the Hyperthermophilic Archaeon Sulfolobus tokodaii</article-title><source>Journal of Molecular Evolution</source><volume>86</volume><fpage>283</fpage><lpage>292</lpage><pub-id pub-id-type="doi">10.1007/s00239-018-9843-y</pub-id><pub-id pub-id-type="pmid">29679096</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lässig</surname><given-names>M</given-names></name><name><surname>Mustonen</surname><given-names>V</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Predicting evolution</article-title><source>Nature Ecology &amp; Evolution</source><volume>1</volume><elocation-id>77</elocation-id><pub-id pub-id-type="doi">10.1038/s41559-017-0077</pub-id><pub-id pub-id-type="pmid">28812721</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>ME</given-names></name><name><surname>DeLoache</surname><given-names>WC</given-names></name><name><surname>Cervantes</surname><given-names>B</given-names></name><name><surname>Dueber</surname><given-names>JE</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A Highly Characterized Yeast Toolkit for Modular, Multipart Assembly</article-title><source>ACS Synthetic Biology</source><volume>4</volume><fpage>975</fpage><lpage>986</lpage><pub-id pub-id-type="doi">10.1021/sb500366v</pub-id><pub-id pub-id-type="pmid">25871405</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>JM</given-names></name><name><surname>Huddleston</surname><given-names>J</given-names></name><name><surname>Doud</surname><given-names>MB</given-names></name><name><surname>Hooper</surname><given-names>KA</given-names></name><name><surname>Wu</surname><given-names>NC</given-names></name><name><surname>Bedford</surname><given-names>T</given-names></name><name><surname>Bloom</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Deep mutational scanning of hemagglutinin helps predict evolutionary fates of human H3N2 influenza variants</article-title><source>PNAS</source><volume>115</volume><fpage>E8276</fpage><lpage>E8285</lpage><pub-id pub-id-type="doi">10.1073/pnas.1806133115</pub-id><pub-id pub-id-type="pmid">30104379</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Godzik</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title><source>Bioinformatics (Oxford, England)</source><volume>22</volume><fpage>1658</fpage><lpage>1659</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id><pub-id pub-id-type="pmid">16731699</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>WX</given-names></name><name><surname>Cheng</surname><given-names>T</given-names></name><name><surname>Guan</surname><given-names>BQ</given-names></name><name><surname>Li</surname><given-names>SW</given-names></name><name><surname>Miao</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Xia</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Variants of green fluorescent protein GFPxm</article-title><source>Marine Biotechnology (New York, N.Y.)</source><volume>8</volume><fpage>560</fpage><lpage>566</lpage><pub-id pub-id-type="doi">10.1007/s10126-006-6006-8</pub-id><pub-id pub-id-type="pmid">17072681</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Melamed</surname><given-names>D</given-names></name><name><surname>Young</surname><given-names>DL</given-names></name><name><surname>Gamble</surname><given-names>CE</given-names></name><name><surname>Miller</surname><given-names>CR</given-names></name><name><surname>Fields</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Deep mutational scanning of an RRM domain of the <italic>Saccharomyces cerevisiae</italic> poly(A)-binding protein</article-title><source>RNA (New York, N.Y.)</source><volume>19</volume><fpage>1537</fpage><lpage>1551</lpage><pub-id pub-id-type="doi">10.1261/rna.040709.113</pub-id><pub-id pub-id-type="pmid">24064791</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milkman</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Selection differentials and selection coefficients</article-title><source>Genetics</source><volume>88</volume><fpage>391</fpage><lpage>403</lpage><pub-id pub-id-type="doi">10.1093/genetics/88.2.391</pub-id><pub-id pub-id-type="pmid">17248802</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murshudov</surname><given-names>GN</given-names></name><name><surname>Vagin</surname><given-names>AA</given-names></name><name><surname>Dodson</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Refinement of macromolecular structures by the maximum-likelihood method</article-title><source>Acta Crystallographica. Section D, Biological Crystallography</source><volume>53</volume><fpage>240</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1107/S0907444996012255</pub-id><pub-id pub-id-type="pmid">15299926</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nivón</surname><given-names>LG</given-names></name><name><surname>Moretti</surname><given-names>R</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A Pareto-optimal refinement method for protein design scaffolds</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e59004</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0059004</pub-id><pub-id pub-id-type="pmid">23565140</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogden</surname><given-names>PJ</given-names></name><name><surname>Kelsic</surname><given-names>ED</given-names></name><name><surname>Sinai</surname><given-names>S</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Comprehensive AAV capsid fitness landscape reveals a viral gene and enables machine-guided design</article-title><source>Science (New York, N.Y.)</source><volume>366</volume><fpage>1139</fpage><lpage>1143</lpage><pub-id pub-id-type="doi">10.1126/science.aaw2900</pub-id><pub-id pub-id-type="pmid">31780559</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olson</surname><given-names>CA</given-names></name><name><surname>Wu</surname><given-names>NC</given-names></name><name><surname>Sun</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A comprehensive biophysical description of pairwise epistasis throughout an entire protein domain</article-title><source>Current Biology</source><volume>24</volume><fpage>2643</fpage><lpage>2651</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.09.072</pub-id><pub-id pub-id-type="pmid">25455030</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pédelacq</surname><given-names>JD</given-names></name><name><surname>Cabantous</surname><given-names>S</given-names></name><name><surname>Tran</surname><given-names>T</given-names></name><name><surname>Terwilliger</surname><given-names>TC</given-names></name><name><surname>Waldo</surname><given-names>GS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Engineering and characterization of a superfolder green fluorescent protein</article-title><source>Nature Biotechnology</source><volume>24</volume><fpage>79</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.1038/nbt1172</pub-id><pub-id pub-id-type="pmid">16369541</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poelwijk</surname><given-names>FJ</given-names></name><name><surname>Socolich</surname><given-names>M</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Learning the pattern of epistasis linking genotype and phenotype in a protein</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>4213</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-12130-8</pub-id><pub-id pub-id-type="pmid">31527666</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pokusaeva</surname><given-names>VO</given-names></name><name><surname>Usmanova</surname><given-names>DR</given-names></name><name><surname>Putintseva</surname><given-names>EV</given-names></name><name><surname>Espinar</surname><given-names>L</given-names></name><name><surname>Sarkisyan</surname><given-names>KS</given-names></name><name><surname>Mishin</surname><given-names>AS</given-names></name><name><surname>Bogatyreva</surname><given-names>NS</given-names></name><name><surname>Ivankov</surname><given-names>DN</given-names></name><name><surname>Akopyan</surname><given-names>AV</given-names></name><name><surname>Avvakumov</surname><given-names>SY</given-names></name><name><surname>Povolotskaya</surname><given-names>IS</given-names></name><name><surname>Filion</surname><given-names>GJ</given-names></name><name><surname>Carey</surname><given-names>LB</given-names></name><name><surname>Kondrashov</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>An experimental assay of the interactions of amino acids from orthologous sequences shaping a complex fitness landscape</article-title><source>PLOS Genetics</source><volume>15</volume><elocation-id>e1008079</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1008079</pub-id><pub-id pub-id-type="pmid">30969963</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Povolotskaya</surname><given-names>IS</given-names></name><name><surname>Kondrashov</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Sequence space and the ongoing expansion of the protein universe</article-title><source>Nature</source><volume>465</volume><fpage>922</fpage><lpage>926</lpage><pub-id pub-id-type="doi">10.1038/nature09105</pub-id><pub-id pub-id-type="pmid">20485343</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Renfrew</surname><given-names>PD</given-names></name><name><surname>Choi</surname><given-names>EJ</given-names></name><name><surname>Bonneau</surname><given-names>R</given-names></name><name><surname>Kuhlman</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Incorporation of noncanonical amino acids into Rosetta and use in computational protein-peptide interface design</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e32637</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0032637</pub-id><pub-id pub-id-type="pmid">22431978</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rocklin</surname><given-names>GJ</given-names></name><name><surname>Chidyausiku</surname><given-names>TM</given-names></name><name><surname>Goreshnik</surname><given-names>I</given-names></name><name><surname>Ford</surname><given-names>A</given-names></name><name><surname>Houliston</surname><given-names>S</given-names></name><name><surname>Lemak</surname><given-names>A</given-names></name><name><surname>Carter</surname><given-names>L</given-names></name><name><surname>Ravichandran</surname><given-names>R</given-names></name><name><surname>Mulligan</surname><given-names>VK</given-names></name><name><surname>Chevalier</surname><given-names>A</given-names></name><name><surname>Arrowsmith</surname><given-names>CH</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Global analysis of protein folding using massively parallel design, synthesis, and testing</article-title><source>Science (New York, N.Y.)</source><volume>357</volume><fpage>168</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1126/science.aan0693</pub-id><pub-id pub-id-type="pmid">28706065</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Romero</surname><given-names>PA</given-names></name><name><surname>Arnold</surname><given-names>FH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Exploring protein fitness landscapes by directed evolution</article-title><source>Nature Reviews. Molecular Cell Biology</source><volume>10</volume><fpage>866</fpage><lpage>876</lpage><pub-id pub-id-type="doi">10.1038/nrm2805</pub-id><pub-id pub-id-type="pmid">19935669</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronquist</surname><given-names>F</given-names></name><name><surname>Teslenko</surname><given-names>M</given-names></name><name><surname>van der Mark</surname><given-names>P</given-names></name><name><surname>Ayres</surname><given-names>DL</given-names></name><name><surname>Darling</surname><given-names>A</given-names></name><name><surname>Höhna</surname><given-names>S</given-names></name><name><surname>Larget</surname><given-names>B</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>MrBayes 3.2: efficient Bayesian phylogenetic inference and model choice across a large model space</article-title><source>Systematic Biology</source><volume>61</volume><fpage>539</fpage><lpage>542</lpage><pub-id pub-id-type="doi">10.1093/sysbio/sys029</pub-id><pub-id pub-id-type="pmid">22357727</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russ</surname><given-names>WP</given-names></name><name><surname>Figliuzzi</surname><given-names>M</given-names></name><name><surname>Stocker</surname><given-names>C</given-names></name><name><surname>Barrat-Charlaix</surname><given-names>P</given-names></name><name><surname>Socolich</surname><given-names>M</given-names></name><name><surname>Kast</surname><given-names>P</given-names></name><name><surname>Hilvert</surname><given-names>D</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Weigt</surname><given-names>M</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>An evolution-based model for designing chorismate mutase enzymes</article-title><source>Science (New York, N.Y.)</source><volume>369</volume><fpage>440</fpage><lpage>445</lpage><pub-id pub-id-type="doi">10.1126/science.aba3304</pub-id><pub-id pub-id-type="pmid">32703877</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sailer</surname><given-names>ZR</given-names></name><name><surname>Shafik</surname><given-names>SH</given-names></name><name><surname>Summers</surname><given-names>RL</given-names></name><name><surname>Joule</surname><given-names>A</given-names></name><name><surname>Patterson-Robert</surname><given-names>A</given-names></name><name><surname>Martin</surname><given-names>RE</given-names></name><name><surname>Harms</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Inferring a complete genotype-phenotype map from a small number of measured phenotypes</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1008243</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008243</pub-id><pub-id pub-id-type="pmid">32991585</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sardanyés</surname><given-names>J</given-names></name><name><surname>Elena</surname><given-names>SF</given-names></name><name><surname>Solé</surname><given-names>RV</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Simple quasispecies models for the survival-of-the-flattest effect: The role of space</article-title><source>Journal of Theoretical Biology</source><volume>250</volume><fpage>560</fpage><lpage>568</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2007.10.027</pub-id><pub-id pub-id-type="pmid">18054366</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarkisyan</surname><given-names>KS</given-names></name><name><surname>Bolotin</surname><given-names>DA</given-names></name><name><surname>Meer</surname><given-names>MV</given-names></name><name><surname>Usmanova</surname><given-names>DR</given-names></name><name><surname>Mishin</surname><given-names>AS</given-names></name><name><surname>Sharonov</surname><given-names>GV</given-names></name><name><surname>Ivankov</surname><given-names>DN</given-names></name><name><surname>Bozhanova</surname><given-names>NG</given-names></name><name><surname>Baranov</surname><given-names>MS</given-names></name><name><surname>Soylemez</surname><given-names>O</given-names></name><name><surname>Bogatyreva</surname><given-names>NS</given-names></name><name><surname>Vlasov</surname><given-names>PK</given-names></name><name><surname>Egorov</surname><given-names>ES</given-names></name><name><surname>Logacheva</surname><given-names>MD</given-names></name><name><surname>Kondrashov</surname><given-names>AS</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name><name><surname>Putintseva</surname><given-names>EV</given-names></name><name><surname>Mamedov</surname><given-names>IZ</given-names></name><name><surname>Tawfik</surname><given-names>DS</given-names></name><name><surname>Lukyanov</surname><given-names>KA</given-names></name><name><surname>Kondrashov</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Local fitness landscape of the green fluorescent protein</article-title><source>Nature</source><volume>533</volume><fpage>397</fpage><lpage>401</lpage><pub-id pub-id-type="doi">10.1038/nature17995</pub-id><pub-id pub-id-type="pmid">27193686</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Senior</surname><given-names>AW</given-names></name><name><surname>Evans</surname><given-names>R</given-names></name><name><surname>Jumper</surname><given-names>J</given-names></name><name><surname>Kirkpatrick</surname><given-names>J</given-names></name><name><surname>Sifre</surname><given-names>L</given-names></name><name><surname>Green</surname><given-names>T</given-names></name><name><surname>Qin</surname><given-names>C</given-names></name><name><surname>Žídek</surname><given-names>A</given-names></name><name><surname>Nelson</surname><given-names>AWR</given-names></name><name><surname>Bridgland</surname><given-names>A</given-names></name><name><surname>Penedones</surname><given-names>H</given-names></name><name><surname>Petersen</surname><given-names>S</given-names></name><name><surname>Simonyan</surname><given-names>K</given-names></name><name><surname>Crossan</surname><given-names>S</given-names></name><name><surname>Kohli</surname><given-names>P</given-names></name><name><surname>Jones</surname><given-names>DT</given-names></name><name><surname>Silver</surname><given-names>D</given-names></name><name><surname>Kavukcuoglu</surname><given-names>K</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Improved protein structure prediction using potentials from deep learning</article-title><source>Nature</source><volume>577</volume><fpage>706</fpage><lpage>710</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1923-7</pub-id><pub-id pub-id-type="pmid">31942072</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="1970">1970</year><article-title>Natural selection and the concept of a protein space</article-title><source>Nature</source><volume>225</volume><fpage>563</fpage><lpage>564</lpage><pub-id pub-id-type="doi">10.1038/225563a0</pub-id><pub-id pub-id-type="pmid">5411867</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Somermeyer</surname><given-names>LG</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Orthologous_GFP_Fitness_Peaks</data-title><version designator="swh:1:rev:4bb2791013567442a8ea4d7735ca79311502bdee">swh:1:rev:4bb2791013567442a8ea4d7735ca79311502bdee</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:a97c49ae0b37c660abe44c9df23be5e58e4110f5;origin=https://github.com/aequorea238/Orthologous_GFP_Fitness_Peaks;visit=swh:1:snp:7c7427977413dc6f094c67f1d445906ffd525625;anchor=swh:1:rev:4bb2791013567442a8ea4d7735ca79311502bdee">https://archive.softwareheritage.org/swh:1:dir:a97c49ae0b37c660abe44c9df23be5e58e4110f5;origin=https://github.com/aequorea238/Orthologous_GFP_Fitness_Peaks;visit=swh:1:snp:7c7427977413dc6f094c67f1d445906ffd525625;anchor=swh:1:rev:4bb2791013567442a8ea4d7735ca79311502bdee</ext-link></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srivastava</surname><given-names>N</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name><name><surname>Krizhevsky</surname><given-names>A</given-names></name><name><surname>Sutskever</surname><given-names>I</given-names></name><name><surname>Salakhutdinov</surname><given-names>R.</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dropout: a simple way to prevent neural networks from overfitting</article-title><source>J Mach Learn Res</source><volume>15</volume><fpage>1929</fpage><lpage>1958</lpage></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vagin</surname><given-names>A</given-names></name><name><surname>Teplyakov</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title><italic>MOLREP</italic> : an Automated Program for Molecular Replacement</article-title><source>Journal of Applied Crystallography</source><volume>30</volume><fpage>1022</fpage><lpage>1025</lpage><pub-id pub-id-type="doi">10.1107/S0021889897006766</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Robustness and evolvability: a paradox resolved</article-title><source>Proceedings. Biological Sciences</source><volume>275</volume><fpage>91</fpage><lpage>100</lpage><pub-id pub-id-type="doi">10.1098/rspb.2007.1137</pub-id><pub-id pub-id-type="pmid">17971325</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname><given-names>E</given-names></name><name><surname>Engler</surname><given-names>C</given-names></name><name><surname>Gruetzner</surname><given-names>R</given-names></name><name><surname>Werner</surname><given-names>S</given-names></name><name><surname>Marillonnet</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A modular cloning system for standardized assembly of multigene constructs</article-title><source>PLOS ONE</source><volume>6</volume><elocation-id>e16765</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0016765</pub-id><pub-id pub-id-type="pmid">21364738</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wittmann</surname><given-names>BJ</given-names></name><name><surname>Yue</surname><given-names>Y</given-names></name><name><surname>Arnold</surname><given-names>FH</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Informed training set design enables efficient machine learning-assisted directed protein evolution</article-title><source>Cell Systems</source><volume>12</volume><fpage>1026</fpage><lpage>1045</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2021.07.008</pub-id><pub-id pub-id-type="pmid">34416172</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wrenbeck</surname><given-names>EE</given-names></name><name><surname>Faber</surname><given-names>MS</given-names></name><name><surname>Whitehead</surname><given-names>TA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Deep sequencing methods for protein engineering and design</article-title><source>Current Opinion in Structural Biology</source><volume>45</volume><fpage>36</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1016/j.sbi.2016.11.001</pub-id><pub-id pub-id-type="pmid">27886568</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>S.</given-names></name></person-group><year iso-8601-date="1932">1932</year><article-title>The roles of mutation, inbreeding, crossbreeding and selection in evolution</article-title><source>Proc Sixth Int Congr Genet</source><volume>1</volume><fpage>356</fpage><lpage>366</lpage></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Kan</surname><given-names>SBJ</given-names></name><name><surname>Lewis</surname><given-names>RD</given-names></name><name><surname>Wittmann</surname><given-names>BJ</given-names></name><name><surname>Arnold</surname><given-names>FH</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Machine learning-assisted directed protein evolution with combinatorial libraries</article-title><source>PNAS</source><volume>116</volume><fpage>8852</fpage><lpage>8858</lpage><pub-id pub-id-type="doi">10.1073/pnas.1901979116</pub-id><pub-id pub-id-type="pmid">30979809</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>PAML 4: phylogenetic analysis by maximum likelihood</article-title><source>Molecular Biology and Evolution</source><volume>24</volume><fpage>1586</fpage><lpage>1591</lpage><pub-id pub-id-type="doi">10.1093/molbev/msm088</pub-id><pub-id pub-id-type="pmid">17483113</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>J</given-names></name><name><surname>Guo</surname><given-names>N</given-names></name><name><surname>Wagner</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Selection enhances protein evolvability by increasing mutational robustness and foldability</article-title><source>Science (New York, N.Y.)</source><volume>370</volume><elocation-id>eabb5962</elocation-id><pub-id pub-id-type="doi">10.1126/science.abb5962</pub-id><pub-id pub-id-type="pmid">33273072</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>J</given-names></name><name><surname>McCandlish</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Minimum epistasis interpolation for sequence-function relationships</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>1782</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-15512-5</pub-id><pub-id pub-id-type="pmid">32286265</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.75842.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kliebenstein</surname><given-names>Daniel J</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05rrcem69</institution-id><institution>University of California, Davis</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" link-type="continued-by" object-id="10.1101/2021.12.08.471728" object-id-type="id" xlink:href="https://sciety.org/articles/activity/10.1101/2021.12.08.471728"/></front-stub><body><p>Using high throughput mutagenesis, this work shows that evolutionary distance between homologous genes is not predictive of how these genes' functions will change in response to similar mutations. This suggests that the starting gene sequence will influence how the synthetic design of new protein functions can occur and also supports a role for conditionality in the natural evolution of protein functions.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.75842.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Kliebenstein</surname><given-names>Daniel J</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05rrcem69</institution-id><institution>University of California, Davis</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.12.08.471728">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.12.08.471728v1">the preprint</ext-link> for the benefit of readers; ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Heterogeneity of the GFP fitness landscape and data-driven protein design&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Naama Barkai as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1. More clarity in what is and what is not new with more caution on the claims.</p><p>2. Support on the choice of a single absolute epistatic threshold for all tests.</p><p>3. How much of the total amino acid space was tested for each protein considering the median level of non-synonymous changes?</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>The authors compare different fluorescence proteins for their mutational spectrum to compare the differential sensitivity of the proteins. This shows that the four proteins even though structurally similar have very different mutational spectra both for additive and epistatic interactions.</p><p>The main conclusion is interesting but it has a cold absence of discussion about the host organisms and treats the four proteins as almost random samples of this protein space. However, is it possible that the natural differences in the environment of these four species may have shaped these proteins by selection to different temps, temp variability that could be influencing the results such that there is an underlying basis for why these proteins may not behave as expected?</p><p>I understand the intent of the graphical representation in Figure 1A and the presentation of sharp vs flat peaks. But is it correct to imply that the valleys in between these peaks have been sampled to ascertain if there are unoccupied peaks? Presently the conceptual representation does give an impression of an absence of any other peaks in this genetic space which I am not sure is supported. This comes from the fact that the space around peak is only sampled using 3-4 amino acid substitutions. Admittedly it is not currently possible to simply test the entire space, I'm simply asking if there is a way to show this unknown possibility within the conceptual figure.</p><p>I may have missed this but is there a way to estimate false negative rates on epistasis when comparing the four proteins? The mutational analysis is random so I would presume that there is some imbalance in sampling which could create a false negative issue when comparing between proteins. I'm presuming that this is not enough to change the pattern but would help to clarify.</p><p>Are Figure 3a and 3b swapped? In the text, 3a is about neutrality while it seems to be 3b in the figure by the y-axis label.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>I have summarized some of my concerns below and hope that revising the manuscript improve readability and clarity of the work.</p><p>FACS sorting condition – Figure S2 showed their experimental conditions for the gating in FACS. I feel odd that they put horizontal gating when you see the simple tendency in diagonal. It is very common to see such diagonal line as it reflects the noise of expression (or cell size). Then putting a gate in horizontal manner essentially make some bias in sampling. It might be ok, but did the authors ensured their screening/deep mutational scanning strategy by comparing isolated variants (I don't see any figure in this paper)?</p><p>The data presentation in Figure 2. Figure 2A and 2C are very misleading as it looks like almost no variant lost fitness up to 2-3 mutations while the distribution of single mutational effects (Figure 2) clearly showed some fraction of mutations killed the protein. I am not sure why the authors decided to generate figures based on the median (figure 2a) or &quot;representative median at least 15 available genotypes (figure 2c)&quot;. It is clearly biasing the data presentation toward what the authors want to claim &quot;much difference in mutational robustness&quot;. Figure S3-b is far better presentation as it is transparent and actually much more understandable. They should remove Figure 2a and 2c and replaced by Figure S3-b</p><p>Related to the above, I do not understand Figure 2d either. Figure S3-b showed the accumulation of 7 mutations looks to me about 50% of variants are dead for amacGFP, while the line in Figure 2d showed more than 90% genotypes are functional. Is that they calculated from single point mutations? I am not sure why this is needed when they have the data. Even if they calculated from single point mutations, about 5% of single point mutations are dead (Table S1), so the accumulation of 7 should read to only about 70% variants are functional (0.95<sup>7</sup>)? Anyway, I believe that FigS3-b showed the all information. Figures 2d seem to be just misleading figures.</p><p>I certainly appreciate the efforts that the authors put to measure various biophysical parameters, and tried to correlate them to the mutational robustness. Regardless much effort, they did not see the correlation and they have spent quite substantial arguments for the reasons why they did not see a clear correlation. This certainly reflect the complication of protein folding and measuring the effect of mutations on protein folding. A conventional theory of protein stability and mutational robustness is too simplified and people use this argument tend to ignore the fact that thermostability (of the folded state) does not reflect &quot;folding ability&quot; of each protein in the cell. Moreover, what the authors missed to discuss is that, as far as I understand, GFPs generates the chromophore when they are translated and folded in the cell. So the denatured GFP molecules are different from newly translated polypeptide and the biophysical and biochemical parameters obtained from refolding experiments of GFP may not even reflect the folding process in the cell. Also it is known that refolding of GFP is very slow as they showed in Figure S7 (it takes over hour in the test tube), suggesting refolding (and folding) process of GFPs are highly complicated. Thus it is not surprising at all that the authors did not see any correlation between the thermostability/refolding rate and mutational robustness.</p><p>While the authors claimed that it is surprising that the sequence distance does not correlate with the mutational robustness, I don't think it is the case anymore based on what we already know from previous literature. For example, it has been shown that (e.g., Bloom et al., PNAS 2005 PMID 15644440, similar work by Bershtein JMB 2008 PMID 18495157) single point mutation can alter the robustness to mutations of a protein. Moreover, it is general knowledge that most mutations affect protein stability (PMID: 17482644) and the accumulation of multiple mutations would expect to alter the stability (or foldability) of the protein substantially. Thus, It would be much more common to think that four distinct sequences (at least more than 40 mutations separate each other) would exhibit distinct behaviours depending on each sequence's property.</p><p>Epistasis calculation – the authors have calculated epistasis and decided '1&quot; is the cutoff for significant and nonsignificant epistasis. What is the bases for the decision? I don't see anything in the main text and may be hidden in the methods. But the justification should be clearly described in the main text based on their experimental noise as it looks to me affecting the results (Figure S5) significantly when they use different cut-offs.</p><p>The data presented in Figure 3 is very hard to understand how the authors calculated. As their mutational design is based on error-prone mutations, they do not cover all possible mutations. Also each GFP templates exhibit different WT sequences, there must be only a handful of mutations were commonly observed among the four different experiments. It is not clear how they calculate those numbers in Figure 3, and they should provide much more detailed explanations for this. e.g., How many identical mutations are observed out of X all possible mutations? How they calculate epistasis when the wild type sequence is different? For example, in a 81% diverged pair, only 19% of the positions are calculated? How many mutations actually are observed in both templates? Then 4% out of 19% of the positions exhibit epistasis (figure a – that means only 2 positions showed epistasis)? In any case, more detailed numbers and data processing should be described in the methods as well as in the main text.</p><p>While it is interesting that ML can successfully predicted functional variants from a highly fragile GFP (cgreGFP), the authors did not provide much insights into the details. The authors mentioned that the deep mutational scanning data captured negatively epistatic pairs and ML avoided for the prediction. Is that something that the authors can dig and present as data? Currently, it is just a general interpretation and not beyond a hypothesis. In Figure S11, the authors presented epistasis between mutations, and thus they should be able to comment about the designed sequences, e.g., how ML predicted sequences are recapitulated the sequence space around each GFP. All designed sequences just eliminated negative epistatic combinations or even identified any positive epistasis that can compensate each other. Also, it was not clear to me that they only used amino acid mutations that were observed in either phylogeny or their deep mutational scanning dataset (for each GFP)? Or they went to other amino acids that they experimentally did not observe.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>In Figure 3, the description of panels A and B appears to be swapped with respect to the Y axis labels.</p><p>The results shown in Figure S5A are unexpected. Taking amacGFP as an example, the graph shows that genotypes with two large-effect mutations, shown in the bottom left corner of this graph, typically show no epistasis (yellow points). According to equation 1, this indicates that the fluorescence of such genotypes should be equal to the sum of effects of the two mutations, i.e. close to -2.4 (-1.2 + -1.2). However, fluorescence = -2.4 appears to be lower than the dynamic range of fluorescence for amacGFP (see for example Figure 1C, where the fluorescence effect of all genotypes appears to be in the range from 0 to -1.5). Can you clarify this? Perhaps a non-additive model of epistasis was used in this figure?</p><p>Figure S9 legend: amacGFP:V14L should be V12L.</p><p>Figure S9: why were ddG predictions excluded for proline and glycine mutations?</p><p>It would be good to discuss the generality of these results. The fitness landscapes of GFP homologues are bimodal, with mutations tending to have either very little effect, or to cause large reduction of fluorescence. Is that a common property of fitness landscapes, or is it specific to GFP, or to the experimental technique used to measure fitness?</p><p>Can the data be used to discriminate between second and higher-order epistasis?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.75842.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential Revisions (for the authors):</p><p>1. More clarity in what is and what is not new with more caution on the claims.</p></disp-quote><p>To improve clarity and to ensure appropriately cautious note with our claims we have implemented the following changes.</p><p>a) We have rewritten the discussion to note the possibility that heterogeneity of fitness shape may be related to the environment that the species typically inhabit. We also put this possibility into a greater context of selection on mutational robustness.</p><p>b) Clarified the conceptual nature of Figure 1a in the figure legend.</p><p>c) As asked by Referee 2, we have replaced Figure 2a (Figure 3a now) by what used to be Figure S3b.</p><p>d) We clarified our meaning in figure legends of Figure 2c and Figure 2d (they are Figure 3c and 3d in the revision).</p><p>e) In the main text we now mention chromophore maturation as a possible factor in the thermostability and fluorescence relationship.</p><p>f) We added a discussion of the evolutionary expectations that arise from the observation that mutational robustness may be a selectable trait.</p><p>g) We added information on the number of amino acid states shared between the pairwise comparisons in Figure 3 (Figure 5 in the revision), and rewritten the associated main text and the figure legend to make the meaning of the figure clearer.</p><p>h) We now mention in the main text that our Machine Learning algorithm used only those amino acid states that were seen in our data and for experimental verification we selected those sequences that had the most amino acid states that were not observed in any wildtype GFP sequence available in GenBank. The exact numbers are available in Supplementary Data 8, which is also now mentioned in the main text.</p><p>i) We rewrote the figure legend of Supplementary Figure 5 (Figure 3—figure supplement 1 in the revision) to make its meaning clearer.</p><p>j) We deleted supplementary tables S3 (genetic construct sequences) and S4 (primer sequences) and integrated them into the Key Resources Table, and recoloured many of the figures to make colour schemes more consistent and visually intuitive.</p><p>k) We have gone through the entire manuscript and softened any claims that may be construed as lacking an abundance of caution. Specifically, we deleted the word “counterintuitively” from the abstract, replaced “striking” with “notable”, “surprisingly” with “contrary to our expectation” in the main text and removed the characterization of the observed heterogeneity of the fitness peaks as “unexpected”. We believe that in the present text we do not make any strong unsubstantiated claims or claim novelty where none is found. If there are other parts of the manuscript that the referees or editors feel we need to modify, we hope that they will be pointed out.</p><disp-quote content-type="editor-comment"><p>2. Support on the choice of a single absolute epistatic threshold for all tests.</p></disp-quote><p>We now include a new paragraph in the section “Calculation of epistasis” that describes our rationale for selecting the epistasis thresholds of a 10-fold and 2-fold difference. These thresholds are only applied to data presented in Table 1, and Figure 3—figure supplement 1 and Figure 4—figure supplement 5. All other data, figures or tables are not subject to these thresholds.</p><disp-quote content-type="editor-comment"><p>3. How much of the total amino acid space was tested for each protein considering the median level of non-synonymous changes?</p></disp-quote><p>We have now expanded Supplementary Table 1 to include the count of the fraction of amino acid spaces tested as a function of the mutational distance from each of the four GFP sequences.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>The authors compare different fluorescence proteins for their mutational spectrum to compare the differential sensitivity of the proteins. This shows that the four proteins even though structurally similar have very different mutational spectra both for additive and epistatic interactions.</p><p>The main conclusion is interesting but it has a cold absence of discussion about the host organisms and treats the four proteins as almost random samples of this protein space. However, is it possible that the natural differences in the environment of these four species may have shaped these proteins by selection to different temps, temp variability that could be influencing the results such that there is an underlying basis for why these proteins may not behave as expected?</p></disp-quote><p>The referee is correct, that the assayed proteins come from different species and, therefore, may not be equivalent with regard to what environment they are adapted to. Indeed, among the environmental influences may be temperature, salinity, intracellular environment, interaction with other proteins, etc, etc. Without an experimental assay of how the mutants behave in their natural environment it is not possible to formulate a good answer about which of these factors may be important. However, we test fluorescence of the mutants of all four proteins in the same environment, which is the cell of <italic>E. coli</italic>, which is, at least phylogenetically, equidistant to all of the four species and all of our conclusions are specific to the in vitro environment in which we test. We now add this point in the discussion.</p><disp-quote content-type="editor-comment"><p>I understand the intent of the graphical representation in Figure 1A and the presentation of sharp vs flat peaks. But is it correct to imply that the valleys in between these peaks have been sampled to ascertain if there are unoccupied peaks? Presently the conceptual representation does give an impression of an absence of any other peaks in this genetic space which I am not sure is supported. This comes from the fact that the space around peak is only sampled using 3-4 amino acid substitutions. Admittedly it is not currently possible to simply test the entire space, I'm simply asking if there is a way to show this unknown possibility within the conceptual figure.</p></disp-quote><p>The referee is correct, on the scale of sequence divergence this figure aims to represent there are undoubtedly many other functional GFP sequences we have not assayed. There could literally be trillions of them, or maybe just a few hundred, we simply have no idea how many. Thus, instead of trying to represent this unknown value in a conceptual figure we have now expanded the description of Figure 1a to make sure that the readers understand this point.</p><disp-quote content-type="editor-comment"><p>I may have missed this but is there a way to estimate false negative rates on epistasis when comparing the four proteins? The mutational analysis is random so I would presume that there is some imbalance in sampling which could create a false negative issue when comparing between proteins. I'm presuming that this is not enough to change the pattern but would help to clarify.</p></disp-quote><p>We are not entirely sure what the referee is asking here. We do report the false negative (and false positive) rates of observations specific to each protein we assayed (Table 1), i.e. control genotypes whose functionality is known but are classified as non-functional in our data, and vice versa. As epistasis is defined as the difference between the expected and observed values, any accuracy of estimation of epistasis follows from accuracy of the fluorescence measurements of the genotypes in question. As error rates among the control barcodes are low (Table 1), we do not expect a significant underestimation of the pervasiveness of epistasis. The previous study of the avGFP landscape (Sarkisyan et al., 2016) did include an estimation of false epistasis discovery due to data noise and found it to be negligible.</p><p>Having said that, the only analysis reported in our manuscript that compares the impact of the same mutations in different proteins is in Figure 3 (Figure 5 in the revision). For that analysis, when comparing two proteins we considered only those amino acid states that were observed in both sequences. The false negative rate for this analysis, however, is derived in the same manner as for all others. For increased clarity, we now added the number of amino acid substitutions that were considered in each pairwise comparison.</p><disp-quote content-type="editor-comment"><p>Are Figure 3a and 3b swapped? In the text, 3a is about neutrality while it seems to be 3b in the figure by the y-axis label.</p></disp-quote><p>We thank the referee for catching this. Panels a and b in Figure 3 (Figure 5 in the revision) are now labelled correctly.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>I have summarized some of my concerns below and hope that revising the manuscript improve readability and clarity of the work.</p><p>FACS sorting condition – Figure S2 showed their experimental conditions for the gating in FACS. I feel odd that they put horizontal gating when you see the simple tendency in diagonal. It is very common to see such diagonal line as it reflects the noise of expression (or cell size). Then putting a gate in horizontal manner essentially make some bias in sampling. It might be ok, but did the authors ensured their screening/deep mutational scanning strategy by comparing isolated variants (I don't see any figure in this paper)?</p></disp-quote><p>The reviewer is correct in noting the diagonal tendency in the FACS data. This is expected, as the mKate2-GFP fusion protein setup necessarily results in a 1:1 ratio of mKate2:GFP, making the red and green signals directly proportional to each other for any given functional variant. The possibility of selecting diagonal gates to accommodate this was indeed considered and discussed with FACS facility staff at the time, but unfortunately there appeared to be no straightforward way of setting gates in this manner -- at least, for the FACS Aria III / Diva software -- short of manually drawing and lining up polygons side by side, which would be an extra source of human error as well as potentially lead to the sampling of cells with different expression levels. We expect that the narrowness of the selected red gate, as well as use of multiple barcode replicates for the same genotype, should minimise any noise due to this.</p><p>We have not compared the fluorescence of isolated variants to our high throughput screening data in this work, however, it was done in Sarkisyan et al., (2016) for avGFP, so we felt it is not necessary to demonstrate this again for the three new proteins.</p><disp-quote content-type="editor-comment"><p>The data presentation in Figure 2. Figure 2A and 2C are very misleading as it looks like almost no variant lost fitness up to 2-3 mutations while the distribution of single mutational effects (Figure 2) clearly showed some fraction of mutations killed the protein. I am not sure why the authors decided to generate figures based on the median (figure 2a) or &quot;representative median at least 15 available genotypes (figure 2c)&quot;. It is clearly biasing the data presentation toward what the authors want to claim &quot;much difference in mutational robustness&quot;. Figure S3-b is far better presentation as it is transparent and actually much more understandable. They should remove Figure 2a and 2c and replaced by Figure S3-b</p></disp-quote><p>We have now replaced Figure 2a (Figure 3a in the revision) with Figure S3b. We have chosen to keep Figure 2c (Figure 3c in the revision) because it is displaying a very different representation of the fitness landscapes of these four proteins not found in any other figure – it is the median fluorescence of genotypes derived not from the wildtype sequences but from sequences one mutation away from the wildtype. We, therefore, kept Figure 2c (Figure 3c in the revision) and we have rewritten the figure legend for Figure 2c (Figure 3c in the revision) to make sure that it is clearer exactly what it represents.</p><disp-quote content-type="editor-comment"><p>Related to the above, I do not understand Figure 2d either. Figure S3-b showed the accumulation of 7 mutations looks to me about 50% of variants are dead for amacGFP, while the line in Figure 2d showed more than 90% genotypes are functional. Is that they calculated from single point mutations? I am not sure why this is needed when they have the data. Even if they calculated from single point mutations, about 5% of single point mutations are dead (Table S1), so the accumulation of 7 should read to only about 70% variants are functional (0.95<sup>7</sup>)? Anyway, I believe that FigS3-b showed the all information. Figures 2d seem to be just misleading figures.</p></disp-quote><p>The referee is correct, if 5% of single mutants are dead then genotypes with 7 mutations should be, on average, 70% dead (0.95<sup>7</sup>). However, if we observe that 90% of genotypes with 7 mutations are dead we can infer that for 20% of genotypes their low fluorescence has to be explained by epistatic interactions. The data reported in Figure 2d (Figure 3d in the revision) is actually more specific than that: for each genotype with &gt;1 mutation we calculate if it is expected to be functional if the mutations in that genotype were non-epistatic and then we compare this estimate to its observed fluorescence. Thus, the figure shows what fraction of genotypes require epistasis to explain its fluorescence level. We have now rewritten the figure legend to make this point clearer. We have also changed the Y-axis label to make sure that the readers do not mistake it for the actual fraction of functional genotypes (it is the fraction of functional genotypes without epistasis).</p><disp-quote content-type="editor-comment"><p>I certainly appreciate the efforts that the authors put to measure various biophysical parameters, and tried to correlate them to the mutational robustness. Regardless much effort, they did not see the correlation and they have spent quite substantial arguments for the reasons why they did not see a clear correlation. This certainly reflect the complication of protein folding and measuring the effect of mutations on protein folding. A conventional theory of protein stability and mutational robustness is too simplified and people use this argument tend to ignore the fact that thermostability (of the folded state) does not reflect &quot;folding ability&quot; of each protein in the cell. Moreover, what the authors missed to discuss is that, as far as I understand, GFPs generates the chromophore when they are translated and folded in the cell. So the denatured GFP molecules are different from newly translated polypeptide and the biophysical and biochemical parameters obtained from refolding experiments of GFP may not even reflect the folding process in the cell. Also it is known that refolding of GFP is very slow as they showed in Figure S7 (it takes over hour in the test tube), suggesting refolding (and folding) process of GFPs are highly complicated. Thus it is not surprising at all that the authors did not see any correlation between the thermostability/refolding rate and mutational robustness.</p></disp-quote><p>We agree with the referee that there could be many reasons why the complexity of protein folding may not be reflected in the measured effect of mutations on fluorescence. As the referee suggested, in the main text we have now added a statement about the possibility of the impact of GFP folding on chromophore maturation as one of the factors that may be influencing its relationship between fluorescence and thermostability. We also now mention in the main text that our measurements of GFP thermostability in vitro may not necessarily be identical to the folding ability of natively folded GFPs.</p><disp-quote content-type="editor-comment"><p>While the authors claimed that it is surprising that the sequence distance does not correlate with the mutational robustness, I don't think it is the case anymore based on what we already know from previous literature. For example, it has been shown that (e.g., Bloom et al., PNAS 2005 PMID 15644440, similar work by Bershtein JMB 2008 PMID 18495157) single point mutation can alter the robustness to mutations of a protein. Moreover, it is general knowledge that most mutations affect protein stability (PMID: 17482644) and the accumulation of multiple mutations would expect to alter the stability (or foldability) of the protein substantially. Thus, It would be much more common to think that four distinct sequences (at least more than 40 mutations separate each other) would exhibit distinct behaviours depending on each sequence's property.</p></disp-quote><p>We disagree with the referee’s logic here. Undoubtedly a single mutation can reduce robustness (the Bloom et al., 2005 and Bernstein et al., 2008 are examples of this) but it does not follow that robustness as a trait is not expected to be conserved. For example, most mutations in an enzyme are expected to alter its catalytic activity but the null expectation is that similar enzymes have similar function. The reason why we expect a correlation between enzymatic function and sequence divergence is because function is under negative selection and the abundant mutations that change the functional properties of the enzyme are eliminated by selection. It has been recently claimed that robustness of GFP is exactly such a trait under selection (Zheng et al., Science, 2020) leading to the null hypothesis that the degree of robustness as a selected trait must also correlate with sequence divergence. We have now modified the manuscript to better reflect this logic and removed the word “unexpected” from the discussion.</p><disp-quote content-type="editor-comment"><p>Epistasis calculation – the authors have calculated epistasis and decided '1&quot; is the cutoff for significant and nonsignificant epistasis. What is the bases for the decision? I don't see anything in the main text and may be hidden in the methods. But the justification should be clearly described in the main text based on their experimental noise as it looks to me affecting the results (Figure S5) significantly when they use different cut-offs.</p></disp-quote><p>Indeed, the cut-offs are somewhat arbitrary. They have been selected for arithmetic simplicity and to ensure a low false positive and negative rates. The fluorescence values used in the study are log10-transformed from the original FACS values. An effect of -1 or 1 therefore indicates a 10-fold change in fluorescence, while -0.3 or 0.3 indicates an approximately 2-fold change. The wildtype sequence measurements fell in a relatively narrow range (Figure 1c), with a standard deviation of around 0.03 for all genes, slightly higher for avGFP that was measured before with a slightly different setup (Table 1). As the value of ~0.03 was similar regardless of the mean fluorescence, we expect it to hold across other genotypes in the libraries, and would therefore expect that ~99% of measurements should fall within a +/- 0.09 interval of the true value (3 standard deviations, which corresponds to a &lt;25% change in fluorescence when converted back to non-log10 values). Both thresholds, 0.3 and 1, for moderate and strong epistasis, respectively, fall comfortably far outside the range of measurement errors caused by experimental noise. Additionally, we opted for the 0.3 cut-off because 2-fold-changes is a common cutoff in a variety of fields (and it was used by Sarkisyan et al., 2016).</p><p>These cutoffs are only used to report data in two rows of Table 1 and Figure 3—figure supplement 1 and Figure 4—figure supplement 5. Thus, we thought it overkill to add this discussion in the main text, but we expanded the supplementary methods section “Calculation of epistasis” to include these arguments there.</p><disp-quote content-type="editor-comment"><p>The data presented in Figure 3 is very hard to understand how the authors calculated. As their mutational design is based on error-prone mutations, they do not cover all possible mutations. Also each GFP templates exhibit different WT sequences, there must be only a handful of mutations were commonly observed among the four different experiments. It is not clear how they calculate those numbers in Figure 3, and they should provide much more detailed explanations for this. e.g., How many identical mutations are observed out of X all possible mutations? How they calculate epistasis when the wild type sequence is different? For example, in a 81% diverged pair, only 19% of the positions are calculated? How many mutations actually are observed in both templates? Then 4% out of 19% of the positions exhibit epistasis (figure a – that means only 2 positions showed epistasis)? In any case, more detailed numbers and data processing should be described in the methods as well as in the main text.</p></disp-quote><p>Figure 3 (Figure 5 in the revision) answers two rather straightforward questions. Figure 3a (Figure 5a in the revision) asks “out of all mutations in our dataset that are neutral in one GFP sequence, what fraction are deleterious in another GFP sequence?”. Figure 3b (Figure 5b in the revision )asks “out of all pairs of sites that interact epistatically in one GFP sequence, what fraction also interacts epistatically in another GFP sequence?”. We have now added the numbers of observations on which this is based and rewritten the figure legend to make it clearer.</p><p>The reviewer is correct that we do not cover all possible mutations at all sites. However, the effects of over 1000 single mutations (&gt;90%) were measured in each of the libraries (reported in Table S1). Several hundred specific mutations were shared between any given pair of genes, meaning that we observed variants of both genes where the same (structurally aligned) position was mutated to the same final amino acid state (regardless of the initial, wildtype state at that position). We have added the exact number of amino acid states considered in each pairwise protein comparison of neutrality change in Figure 3a (Figure 5a in the revision), and clarified the figure legend to reflect this. Only genotypes with a single mutation were considered in this analysis.</p><p>The calculation of epistasis is not dependent on the template sequence. The presence of several thousand double-mutant genotypes in all libraries (Table S1) allowed us to estimate epistasis (or lack thereof) between many pairs of sites within the same gene, leading to a list of site pairs where epistasis was detected in each gene. We then compare these lists of sites and their overlap across genes. In sum, while Figure 3a (Figure 5a in the revision) is about the change in effect of single mutations as a function of the background they occur in, Figure 3b (Figure 5b in the revision) is about whether the spatial positions of epistatic sites are maintained in different backgrounds.</p><disp-quote content-type="editor-comment"><p>While it is interesting that ML can successfully predicted functional variants from a highly fragile GFP (cgreGFP), the authors did not provide much insights into the details. The authors mentioned that the deep mutational scanning data captured negatively epistatic pairs and ML avoided for the prediction. Is that something that the authors can dig and present as data? Currently, it is just a general interpretation and not beyond a hypothesis. In Figure S11, the authors presented epistasis between mutations, and thus they should be able to comment about the designed sequences, e.g., how ML predicted sequences are recapitulated the sequence space around each GFP. All designed sequences just eliminated negative epistatic combinations or even identified any positive epistasis that can compensate each other.</p></disp-quote><p>To answer this question, we will take a few steps back to discuss what machine learning does. Generally, machine learning methods are used to approximate the underlying mathematical function that describes the relationship between the input and the output. In our case, the input are the protein sequences and the output are the fluorescence intensities of those proteins.</p><p>The way these functions are approximated is through iterative comparison of the predicted and true values and tweaking the parameters, so that these values get more similar. The higher the complexity of the underlying function is, the more time, effort and data it takes to accurately approximate it. In the simplest case scenario, if there was no epistasis at all, we would have been able to describe the sequence-to-function relationship with a linear function. In that case, during the training phase the weight of each mutation would have been iteratively optimised, so that the weighted sum of all of the observed mutations is as close to the true fluorescence value as possible. It would have been easy to interpret the results of such a linear function optimisation, because all we would need to do would be to look at the assigned weights and see which mutations were beneficial, deleterious or neutral.</p><p>However, the higher the complexity of the underlying sequence-to-function is, the harder it is to interpret its meaning. In our case, the underlying mathematical function describing the sequence-to-function relationship of cgreGFP had ~200 dimensions (as opposed to a linear function, which is two-dimensional). At the same time, comparing the fluorescence values predicted by our model with the values obtained assuming no epistatic interactions at all, we can conclude that the mathematical approximation of the sequence-to-fluorescence relationship we have identified does account for the interactions between positions.</p><p>While all final models effectively captured the signal contained in the 4 datasets (Figure 6—figure supplement 1), this signal is fractionated differently in the different landscapes: ppluGFP2 and amacGFP, the least epistatic genes, are fairly well recapitulated by linear models (no interactions); avGFP required the addition of a sigmoid node and cgreGFP required the addition of a subnetwork to fix the linear estimate and yield a correlation that was as good as the models describing other proteins (Figure 6—figure supplement 1). This mirrors the amount of epistasis observed in the different landscapes, which is mostly negative epistasis (Figure 3—figure supplement 1). Furthermore, even though the correlation of the final models is similarly good for all four genes, it is the fragile, highly epistatic cgreGFP which yielded the best predictions. Although the inner workings of neural nets remain a black box, our data does seem to suggest that the epistatic signal of cgreGFP is illustrated well enough in the data for the model to capture it and learn about negative epistatic interactions.</p><p>We have added a new Figure 7—figure supplement 1 to highlight the successful incorporation of sometimes-deleterious mutations into functional predictions, which suggests that the model was able to identify and avoid unfavourable interactions.</p><disp-quote content-type="editor-comment"><p>Also, it was not clear to me that they only used amino acid mutations that were observed in either phylogeny or their deep mutational scanning dataset (for each GFP)? Or they went to other amino acids that they experimentally did not observe.</p></disp-quote><p>We used amino acid states observed in our libraries (our ML approach cannot describe mutations not present within the training set) but that were, whenever possible, not observed in phylogeny. We now mention this in the main text and refer the reader to the dataset where this information can be found for each specific genotype we tested.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>In Figure 3, the description of panels A and B appears to be swapped with respect to the Y axis labels.</p></disp-quote><p>Thank you, this is now corrected.</p><disp-quote content-type="editor-comment"><p>The results shown in Figure S5A are unexpected. Taking amacGFP as an example, the graph shows that genotypes with two large-effect mutations, shown in the bottom left corner of this graph, typically show no epistasis (yellow points). According to equation 1, this indicates that the fluorescence of such genotypes should be equal to the sum of effects of the two mutations, i.e. close to -2.4 (-1.2 + -1.2). However, fluorescence = -2.4 appears to be lower than the dynamic range of fluorescence for amacGFP (see for example Figure 1C, where the fluorescence effect of all genotypes appears to be in the range from 0 to -1.5). Can you clarify this? Perhaps a non-additive model of epistasis was used in this figure?</p></disp-quote><p>The reviewer is correct that the standard calculation of “expected” fluorescence is simply the addition of all individual mutation effects, however, the possible output values of this calculation are bounded by the lower and upper limits of what was experimentally measurable (i.e., cannot be lower than the minimum, non-fluorescent values, nor higher than the highest measured fluorescence). While the X and Y axes indicate the individual effects of single mutations, their expected joint effect cannot violate these upper and lower bounds. A single mutation with an effect of -1.2 already results in a non-functional protein, and the addition of a second -1.2 mutation cannot decrease fluorescence beyond this already-attained minimum. For this reason, negative epistasis can never be detected between two such highly individually deleterious mutations, because the non-epistatic expectation is already non-functional; dots in this region will therefore always be yellow except in cases of positive epistasis -- when individually deleterious mutations are not deleterious together -- however, positive epistasis was rare in our data. We have updated the figure legend to clarify this point.</p><disp-quote content-type="editor-comment"><p>Figure S9 legend: amacGFP:V14L should be V12L.</p></disp-quote><p>Thank you, corrected.</p><disp-quote content-type="editor-comment"><p>Figure S9: why were ddG predictions excluded for proline and glycine mutations?</p></disp-quote><p>Mutations from/to proline and glycine tend to alter the backbone conformation and require specific handling, for example, an intensive backbone sampling. However, more aggressive remodelling was shown to decrease the ability of the used method to recapitulate mutant structure and can have correspondingly negative impact on ddG prediction for other amino acids. We decided to exclude this small subset of mutations instead of combining data obtained using different methods.</p><disp-quote content-type="editor-comment"><p>It would be good to discuss the generality of these results. The fitness landscapes of GFP homologues are bimodal, with mutations tending to have either very little effect, or to cause large reduction of fluorescence. Is that a common property of fitness landscapes, or is it specific to GFP, or to the experimental technique used to measure fitness?</p></disp-quote><p>To some degree, this issue has recently been reviewed (Kemble et al., Evolutionary Applications, 2019). We also talk about this in the third paragraph of our introduction, but there we are using the language typically used to describe fitness landscape rather than protein structure (but essentially the point is the same). However, the real issue is that there are so few examples of extensive fitness landscape with multiple mutations across an entire protein that we feel it is not possible yet to make generalisations based on comparisons between proteins. So far, we count three such characterizations of fitness landscapes: for Β-lactamase, Hsp90 and GFP protein-coding genes, all three are globular proteins. Would the fitness landscape be different in a membrane protein? In a disordered protein? All of these are interesting questions that we feel require solid experimental data to address. Taken together, we feel that such a generalisation at this point would be premature – the field needs another decade of data gathering. We suspect that the bimodality will be a common feature, but we hardly have the data to support this argument.</p><disp-quote content-type="editor-comment"><p>Can the data be used to discriminate between second and higher-order epistasis?</p></disp-quote><p>Yes, it may. However, we were not interested in this particular analysis. As discussed in the previous question the GFP fitness landscape is generally “bimodal”, the protein is either fluorescent or not. For such fitness functions epistasis is expected to be of maximal order – this is a mathematical feature of phase transition-like functions that was discussed in Pokusaeva et al., PLoS Gen, 2019. Therefore, some higher-order epistasis is likely to be detected in GFPs with a sharp fitness peak, but showing that this is the case, in our opinion, does not offer mechanistic or conceptual understanding of the corresponding fitness landscape. Generally speaking, the sheer volume of the data we produced is such that many other analyses may be performed. We hope that the research community will take advantage of the availability of these data and ask questions we did not think of asking.</p></body></sub-article></article>