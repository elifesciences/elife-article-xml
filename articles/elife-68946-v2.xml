<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">68946</article-id><article-id pub-id-type="doi">10.7554/eLife.68946</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Structural Biology and Molecular Biophysics</subject></subj-group></article-categories><title-group><article-title>Locating macromolecular assemblies in cells by 2D template matching with cisTEM</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-233150"><name><surname>Lucas</surname><given-names>Bronwyn A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9162-0421</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-233151"><name><surname>Himes</surname><given-names>Benjamin A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7777-0298</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-233152"><name><surname>Xue</surname><given-names>Liang</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4368-2526</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-192700"><name><surname>Grant</surname><given-names>Timothy</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4855-8703</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-235371"><name><surname>Mahamid</surname><given-names>Julia</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6968-041X</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-6967"><name><surname>Grigorieff</surname><given-names>Nikolaus</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1506-909X</contrib-id><email>niko@grigorieff.org</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution>Howard Hughes Medical Institute, Janelia Research Campus</institution><addr-line><named-content content-type="city">Ashburn</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Howard Hughes Medical Institute, RNA Therapeutics Institute, The University of Massachusetts Medical School</institution><addr-line><named-content content-type="city">Worcester</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Structural and Computational Biology Unit, European Molecular Biology Laboratory (EMBL)</institution><addr-line><named-content content-type="city">Heidelberg</named-content></addr-line><country>Germany</country></aff><aff id="aff4"><label>4</label><institution>Collaboration for joint PhD degree between EMBL and Heidelberg University, Faculty of Biosciences</institution><addr-line><named-content content-type="city">Heidelberg</named-content></addr-line><country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Egelman</surname><given-names>Edward H</given-names></name><role>Reviewing Editor</role><aff><institution>University of Virginia</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Aldrich</surname><given-names>Richard W</given-names></name><role>Senior Editor</role><aff><institution>The University of Texas at Austin</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>11</day><month>06</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e68946</elocation-id><history><date date-type="received" iso-8601-date="2021-03-30"><day>30</day><month>03</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-06-09"><day>09</day><month>06</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Lucas et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Lucas et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-68946-v2.pdf"/><abstract><p>For a more complete understanding of molecular mechanisms, it is important to study macromolecules and their assemblies in the broader context of the cell. This context can be visualized at nanometer resolution in three dimensions (3D) using electron cryo-tomography, which requires tilt series to be recorded and computationally aligned, currently limiting throughput. Additionally, the high-resolution signal preserved in the raw tomograms is currently limited by a number of technical difficulties, leading to an increased false-positive detection rate when using 3D template matching to find molecular complexes in tomograms. We have recently described a 2D template matching approach that addresses these issues by including high-resolution signal preserved in single-tilt images. A current limitation of this approach is the high computational cost that limits throughput. We describe here a GPU-accelerated implementation of 2D template matching in the image processing software <italic>cis</italic>TEM that allows for easy scaling and improves the accessibility of this approach. We apply 2D template matching to identify ribosomes in images of frozen-hydrated <italic>Mycoplasma pneumoniae</italic> cells with high precision and sensitivity, demonstrating that this is a versatile tool for in situ visual proteomics and in situ structure determination. We benchmark the results with 3D template matching of tomograms acquired on identical sample locations and identify strengths and weaknesses of both techniques, which offer complementary information about target localization and identity.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>M. pneumoniae</kwd><kwd>cryo-EM</kwd><kwd>tomography</kwd><kwd>image analysis</kwd><kwd>ribosome</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>B. subtilis</italic></kwd><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>760067</award-id><principal-award-recipient><name><surname>Mahamid</surname><given-names>Julia</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Lucas</surname><given-names>Bronwyn A</given-names></name><name><surname>Himes</surname><given-names>Benjamin A</given-names></name><name><surname>Grigorieff</surname><given-names>Nikolaus</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>2D template matching complements 3D template matching of tomograms, providing fast and specific detection of molecules in cryo-EM images of cells, as well as generating 3D reconstructions from detected targets.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A major goal in structural biology is to understand the molecular mechanisms of biological processes that occur inside cells by studying the underlying proteins and their assemblies, collectively referred to here as ‘complexes.’ To realize this goal, X-ray crystallography and electron cryo-microscopy (cryo-EM) have been used to generate high-resolution density maps of purified complexes that could be interpreted by atomic models (<xref ref-type="bibr" rid="bib6">Berman et al., 2002</xref>).</p><p>While the list of high-resolution structures is rapidly growing, a full understanding of molecular mechanisms requires the broader context of the cell (<xref ref-type="bibr" rid="bib2">Alberts, 1998</xref>). This context is necessary to understand the functional coupling of different complexes, for example by transient interaction between them, by efficient shuttling of substrates and products, or by a common regulatory mechanism (<xref ref-type="bibr" rid="bib8">Braunger et al., 2018</xref>; <xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref>). Cryo-EM can be used to image complexes directly inside frozen-hydrated cells and tissues, making it one of the most promising approaches to add cellular context to structures that have been visualized in vitro. To date, the most developed cryo-EM technique to visualize the ‘molecular sociology’ of cells (<xref ref-type="bibr" rid="bib5">Beck and Baumeister, 2016</xref>) is electron cryo-tomography (cryo-ET) (<xref ref-type="bibr" rid="bib41">Oikonomou and Jensen, 2017</xref>).</p><p>Similar to single-particle cryo-EM, cryo-ET has seen significant development over the past decade (<xref ref-type="bibr" rid="bib64">Wan and Briggs, 2016</xref>), including the extension of subtomogram averaging to sub-nm resolution (<xref ref-type="bibr" rid="bib52">Schur et al., 2013</xref>). Rather than recording a single view, cryo-ET involves collection and alignment of a series of images of an incrementally tilted specimen. The images are merged by reconstruction algorithms to form a tomogram, yielding 3D reconstructions of cells. However, the average resolution of a tomogram is inherently limited to ~20 Å (<xref ref-type="bibr" rid="bib17">Frank, 2006</xref>) due to the finite angular sampling allowed by tolerable radiation damage, the increased specimen thickness at higher tilt angles, inaccuracy in the tilt series alignment caused by the weak signal present in individual tilted views, and local distortions in the sample during imaging (<xref ref-type="bibr" rid="bib30">Himes and Zhang, 2018</xref>; <xref ref-type="bibr" rid="bib63">Voortman et al., 2014</xref>). By adapting techniques from single-particle cryo-EM, subtomogram averaging can boost the resolution of reconstructions of complexes visualized in situ (<xref ref-type="bibr" rid="bib3">Bartesaghi et al., 2008</xref>; <xref ref-type="bibr" rid="bib65">Winkler, 2007</xref>). This approach has recently been extended to include the iterative refinement of tilt series alignment using a subtomogram average as a reference (<xref ref-type="bibr" rid="bib30">Himes and Zhang, 2018</xref>; <xref ref-type="bibr" rid="bib60">Tegunov et al., 2021</xref>).</p><p>Structure determination by subtomogram averaging relies on the initial detection of the complexes of interest in the raw tomogram (<xref ref-type="bibr" rid="bib43">Pfeffer and Mahamid, 2018</xref>; <xref ref-type="bibr" rid="bib67">Zhang, 2019</xref>). Semi-automated complex detection can be accomplished by matching with a 3D template (<xref ref-type="bibr" rid="bib16">Frangakis et al., 2002</xref>), obtained by averaging a small set of manually selected subtomograms, or derived from another imaging modality, for example single-particle cryo-EM. 3D template matching (3DTM) has been particularly successful in the study of large cytoplasmic complexes, such as ribosomes, proteasomes and chaperonins (<xref ref-type="bibr" rid="bib1">Albert et al., 2017</xref>; <xref ref-type="bibr" rid="bib13">Eibauer et al., 2012</xref>; <xref ref-type="bibr" rid="bib26">Guo et al., 2018</xref>; <xref ref-type="bibr" rid="bib43">Pfeffer and Mahamid, 2018</xref>). However, this semi-automated detection requires extensive manual curation and the false positive rate is usually difficult to determine. Classification of subtomograms is required to both exclude false positives and to discriminate between structurally similar complexes (<xref ref-type="bibr" rid="bib15">Förster et al., 2008</xref>, <xref ref-type="bibr" rid="bib66">Xu et al., 2012</xref>). This process is computationally demanding and requires thousands of particles to yield well-defined class averages. As a consequence, it is practically impossible to reliably locate all but the most abundant complexes in tomograms. More generally, tomogram annotation depends critically on recognizing the overall shape, that is, the particle envelope, which may be obscured in regions of the cell with high molecular density, or in regions where several complexes connect to form a single continuous density (<xref ref-type="bibr" rid="bib24">Grünewald et al., 2002</xref>). Methods that improve low-resolution contrast have been employed to aid in manual annotation, for example, imaging with a Volta phase plate (<xref ref-type="bibr" rid="bib11">Danev et al., 2017</xref>) and using computational denoising, including classical linear and non-linear image filters and reconstruction algorithms (<xref ref-type="bibr" rid="bib14">Fernandez, 2012</xref>) and more recently, deep-learning-based approaches (<xref ref-type="bibr" rid="bib10">Buchholz et al., 2019</xref>). Although these strategies improve the sensitivity of detection in tomograms, they do not address the difficulty of detecting rare complexes or discriminating related structures in raw tomograms.</p><p>Recently, we described a 2D template matching (2DTM) technique that may overcome some of the limitations of 3DTM (<xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>). 2DTM matches projections of 3D templates to features found in single-exposure (2D) images of nominally untilted specimens, at 4 Å or higher resolution depending on the sample and targets to be localized (<xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>). Avoiding multiple exposures and high specimen tilt angles helps preserve the high-resolution signal in these 2D images (<xref ref-type="bibr" rid="bib9">Brilot et al., 2012</xref>), and therefore, 2DTM can utilize this signal to detect complexes with high precision, as well as high angular and positional in-plane accuracy (x,y coordinates). In crowded environments such as the cell, this added signal comes at the expense of increased background (structural noise) in the images due to overlapping density from other molecules, and a relatively large error in localizing the depth of the targets within the sample (z coordinate) (<xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>). The matching of high-resolution details in 2DTM requires a fine-grained angular search composed of millions of reference projections and correlation maps to be calculated, making the computational workload of a 2D template search relatively high compared to a more coarse-grained search that is normally done with 3DTM. We describe here an implementation of 2DTM in the software package <italic>cis</italic>TEM (<xref ref-type="bibr" rid="bib19">Grant et al., 2018</xref>), providing a user-friendly graphical interface and GPU-acceleration to speed up computation. We applied 2DTM to a set of images of <italic>Mycoplasma pneumoniae</italic> using a bacterial 50S large ribosomal subunit as a template. <italic>M. pneumoniae</italic> cells are small and do not require additional sample thinning (<xref ref-type="bibr" rid="bib33">Kühner et al., 2009</xref>), for example via controlled cell lysis (<xref ref-type="bibr" rid="bib18">Fu et al., 2014</xref>) or more commonly by using focused ion beam milling (<xref ref-type="bibr" rid="bib35">Marko et al., 2007</xref>; <xref ref-type="bibr" rid="bib46">Rigort et al., 2012</xref>; <xref ref-type="bibr" rid="bib57">Strunk et al., 2012</xref>). We benchmark the results of 2DTM in situ, using 3DTM to directly compare detection efficiency by collecting a subsequent tomogram of the same specimen area analyzed by 2DTM. We show that 2DTM is a versatile method, with comparable sensitivity and improved precision relative to 3DTM, pointing to potentially broad applications for both in situ visual proteomics and in situ structure determination, including de novo structure determination.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>GPU-accelerated 2DTM implemented in <italic>cis</italic>TEM</title><p>The large search space required for 2DTM makes this method computationally demanding; a single 1850 × 1850 pixel image required 1000 CPU-hours per search in the proof-of-principle MATLAB implementation (<xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>) and was improved about twofold by GPU-acceleration (<xref ref-type="bibr" rid="bib45">Rickgauer et al., 2020</xref>) when comparing hardware of similar purchase price. To make 2DTM accessible to more users and a broader range of biological questions, we implemented 2DTM in <italic>cis</italic>TEM (<xref ref-type="bibr" rid="bib19">Grant et al., 2018</xref>) using C++ (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). This achieved a roughly 23x speed-up compared to the MATLAB CPU implementation, as measured on similar hardware, with measured times scaled to account for generational differences in CPU models. The core 2DTM algorithm is unchanged from its original description as depicted in the flowchart in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. The <italic>cis</italic>TEM implementation may be run as a standalone from the command line interface, or alternatively, using the <italic>cis</italic>TEM graphical user interface (GUI). In addition to a user-friendly interface, the GUI affords several advantages: Firstly, project metadata and image-specific information, such as CTF estimation, are tracked in a database; secondly, the search is easily divided over many CPUs or computers using <italic>cis</italic>TEM’s MPI-like dispatch via run-profiles; and thirdly, the results are displayed in an interactive manner allowing for easy interpretation and comparison across multiple search conditions. A screenshot showing the results of a template matching search in the <italic>cis</italic>TEM GUI is shown in <xref ref-type="fig" rid="fig1">Figure 1a</xref>. The GUI displays the image searched (<xref ref-type="fig" rid="fig1">Figure 1b</xref>), maximum intensity projection (MIP) (<xref ref-type="fig" rid="fig1">Figure 1c</xref>) and the plotted results (<xref ref-type="fig" rid="fig1">Figure 1d</xref>), enabling rapid qualitative interrogation of the template matching results.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title><italic>cis</italic>TEM GUI implementation of 2DTM.</title><p>(<bold>a</bold>) Screenshot showing the results of a 2DTM search in the <italic>cis</italic>TEM GUI (located in the ‘Experimental’ tab). The panel on the left shows all images searched. Images may be searched individually (column #1) or as batch jobs (column #2). The Results tab shows the locations, orientations and SNR values of each detected target in a list, as well as the original image (<bold>b</bold>) (membrane highlighted in yellow), the maximum intensity projection (MIP, <bold>c</bold>) and the plotted result (<bold>d</bold>), which shows the best-matching orientation of the template at each detected location. The survival histogram (subpanel in (<bold>a</bold>)) shows the SNR values for all search locations (blue line) and compares this with the survival histogram of Gaussian noise (red line). This is used to establish the threshold at which a single false positive is expected per image. Scale bar in (<bold>b</bold>) = 500 Å.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>The 2DTM matching algorithm as implemented in <italic>cis</italic>TEM.</title><p>Inputs to various stages are in hexagons. If the GPU is used, all memory allocations are handled by the TemplateMatchingCore class via calls to the underlying GpuImage class. The whitening filter and CTF are combined on the host and if needed, copied to the GPU once for each defocus plane searched. The inner loop (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>) is executed and results returned to the host.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig1-figsupp1-v2.tif"/></fig></fig-group><p>Even with these improvements, searching a more typically sized image, like that from a Gatan K3 detector (5760 × 4092 pixels) requires ~7100 CPU-hours when searching 13 focal planes, which are needed to determine the z coordinates of targets and resolve overlapping densities in a 150- to 200-nm-thick sample. Further substantial gains in the CPU-based code are not likely, given that about 85% of the computation for 2DTM is spent on calculating fast Fourier transforms (FFTs) using the already highly optimized Intel Math-Kernel library. To circumvent these limitations, we developed a GPU image class in <italic>cis</italic>TEM that has a subset of the same underlying member variables and methods as the corresponding CPU image class. Both implementations use positions on the Euler sphere to divide the search space (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). The GPU implementation exploits further parallelism via threading, which combined with CUDA streams allows for multiple kernels to execute on the GPU simultaneously (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). This in turn allows us to create a dynamic load balancing that results in full occupancy of the GPU over a wide range of problem sizes.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>GPU acceleration of 2DTM in <italic>cis</italic>TEM.</title><p>(<bold>a</bold>) The angular search space is distributed among any number of processors using the home-grown MPI-like socket communication in the <italic>cis</italic>TEM GUI (<xref ref-type="bibr" rid="bib19">Grant et al., 2018</xref>). Unlike MPI, if fewer processors are available than requested (shaded box) processing may still proceed. (<bold>b</bold>) To expose further parallelism, additional host threads may be requested to subdivide each angular group to maximize occupancy on the GPU. Each host thread queues up a series of GPU kernels into its respective stream, and then returns to calculate the next projection and initiates its transfer to the GPU (green box). This way, close to 100% of the CPU and GPU is used during computation. (<bold>c</bold>) GPU acceleration relative to optimized CPU-based calculation, of which 85% is spent on MKL-based FFTs. Kernel-fusion using cuFFT callbacks and custom data structures combined with flexible kernel launch parameters ensure the GPUs stay saturated, enabling an 8x speedup. A total of 10.5x speedup is achieved by optimizing data throughput using the vectorized FP16 format for storing results. (<bold>d</bold>) The code scales nearly linearly with the number of GPUs and tracks with the total memory bandwidth of a given model. All timings were obtained using a padded K3 image with 4096 × 5832 pixels, and searching one defocus plane with 2.5°/1.5° angular steps.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>GPU implementation and runtime profiling.</title><p>(<bold>a</bold>) The 2DTM matching inner loop as implemented on the GPU in <italic>cis</italic>TEM. (<bold>b</bold>) Approximate percentage of run time for each step. The relative percentages can vary based on the automatic load balancing due to the combination of CUDA streams and mixed kernel launch configurations that restrain some low-complexity operations to a small subset of available streaming multi-processors via grid-stride loops.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig2-figsupp1-v2.tif"/></fig></fig-group><p>To evaluate the performance improvements of our GPU 2DTM implementation relative to the CPU 2DTM implementation, we compared two high-end GPUs (Nvidia GV100) against two high-end 28-core CPUs (Intel Xeon Platinum 8280) installed in the same general-purpose workstation, with all other hardware and variables unchanged. By this metric, the GPU-accelerated implementation of 2DTM achieved an 8.5x speed up relative to the CPU-only implementation (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). Using IEEE 754 half-precision floating point values (FP16) for the arrays used to track search statistics, namely the pixel-wise sum and sum-of-squares over all orientations, resulted in further acceleration and a reduced memory footprint. The total speed-up was 10.5x (<xref ref-type="fig" rid="fig2">Figure 2c</xref>), relative to the CPU-only C++ implementation. The algorithm scales nearly linearly with the number of GPUs used, as shown for different NVIDIA GPU architectures in <xref ref-type="fig" rid="fig2">Figure 2d</xref>. The relative computational cost of each step of the GPU-accelerated 2DTM inner loop algorithm is detailed in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>.</p><p>To avoid cumulative rounding errors at the reduced precision of FP16, we implemented a cascading summation where the sums and sum-of-squares are accumulated over ten search positions. Every tenth search, the results are accumulated in 32-bit single precision into a separate array. Every one-hundredth search, the results from the lower tier are accumulated, and so on, resulting in similar-sized numbers being added. An additional consideration for the sum-of-squares array was needed as the smallest positive number that can be represented by FP16 without being rounded to zero is 2<sup>−14</sup>. To prevent these subnormal numbers from being flushed to zero, we temporarily multiply the array by a factor of 10<sup>3</sup> until conversion to higher precision farther down the cascade.</p></sec><sec id="s2-2"><title>Detection of 50S ribosomal subunits by 2DTM</title><p>The improved speed and increased throughput of 2DTM enabled us to perform an initial screen of template and search parameters that affect target detection in situ. To this end, we collected 2D images of plunge-frozen <italic>M. pneumoniae, bacteria that</italic> lack a cell wall and can be less than 200 nm thick, making them sufficiently thin to allow TEM imaging of whole cells in ice without the need for thinning (<xref ref-type="bibr" rid="bib33">Kühner et al., 2009</xref>). We performed 2DTM using the <italic>M. pneumoniae</italic> 50S (PDB: 7OOD) (<xref ref-type="bibr" rid="bib60">Tegunov et al., 2021</xref>) as a template (<xref ref-type="fig" rid="fig3">Figure 3a</xref>) and identified 6558 50S large ribosomal subunits in 220 2D images. This search did not distinguish between isolated subunits and subunits bound to the 30S small ribosomal subunit.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>2DTM detects ribosomes in <italic>Mycoplasma pneumoniae</italic> cells.</title><p>(<bold>a</bold>) An overview of 2DTM: a cryoEM-like density was generated from an <italic>M. pneumoniae</italic> 50S model, a B-factor was applied and the resulting template used to identify locations and orientations of 50S in 2D images of <italic>M. pneumoniae</italic> cells with 2DTM implemented in <italic>cis</italic>TEM. Scale bar = 500 Å (<bold>b</bold>) 20 Å filtered 3D reconstruction generated using the locations and orientations of 5080 50S subunits detected in 220 images using 2DTM with a <italic>M. pneumoniae</italic> 50S template, showing clear density for the 30S ribosomal subunit (not included in the template). (<bold>c</bold>) Difference map showing the regions of the 3D reconstruction that differ from the 50S 2DTM search template. Arrows indicate additional density consistent with 70S ribosome structures. The difference map was generated with the same threshold as in (<bold>b</bold>). (<bold>d</bold>) A region of the difference map shown in (<bold>c</bold>), showing tRNAs in characteristic arrangements in the E, P, and A sites of the 30S subunit. <italic>M.p.: M. pneumoniae</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>2DTM results obtained using different settings.</title><p>(<bold>a</bold>) Boxplot showing the distribution of 2DTM SNR values in a representative image using an <italic>M. pneumoniae</italic> 50S template with the indicated B-factor applied. The boxes indicate the interquartile range, the middle line indicates the median, the whiskers indicate the 10-90th percentiles and the dots indicate 50S peaks with SNRs outside this range. (<bold>b</bold>) As in (<bold>a</bold>), showing the distribution of 2DTM SNRs in images whereby 8 (12.8 e/Å<sup>2</sup>) or 20 (32 e/Å<sup>2</sup>) frames with or without exposure weighting were used to generate the final image as indicated. (<bold>c</bold>) Bar chart showing the number of detected 50S when 13 defocus planes are searched, relative to the number when a single defocus plane is searched. Individual images of indicated thickness are shown separately. (<bold>d</bold>) Scatterplot showing the mean 2DTM SNR of 50S identified in images with &gt;10 peaks relative to the mean defocus of the image calculated using <italic>CTFFIND4</italic>. (<bold>e</bold>) FSC obtained for the 3D reconstruction (shown in <xref ref-type="fig" rid="fig3">Figure 3b</xref>) calculated from the targets found by 2DTM.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig3-figsupp1-v2.tif"/></fig></fig-group><p>The output from a 2DTM search are SNR values that depend on both the agreement between the template and the target as well as noise in the image (<xref ref-type="bibr" rid="bib53">Sigworth, 2004</xref>). The noise is predominantly shot noise, as well as background generated by molecules and other cellular material overlapping the target in projection. A target is detected when the SNR value exceeds a threshold determined by the permitted number of false positives per search (usually one), as specified by the user (<xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>). To improve the match between template and recorded signal, the template can be low-pass filtered to approximate physical blurring of the image due to radiation damage and beam-induced motion, as well as discrepancies between the target in the template, for example due to conformational differences. To low-pass filter the template, we applied a range of B-factors to the initial map generated using <italic>pdb2mrc</italic> (<xref ref-type="bibr" rid="bib59">Tang et al., 2007</xref>, see Materials and methods) and found that the average SNR was maximized using a B-factor of about 85 Å<sup>2</sup> (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a</xref>). Using this value, we found that searching an image composed of exposure-weighted frames (32 e<sup>-</sup>/Å<sup>2</sup>) (<xref ref-type="bibr" rid="bib20">Grant and Grigorieff, 2015</xref>) increased the average SNR compared to using only the first eight frames (12.8 e<sup>-</sup>/Å<sup>2</sup>) with or without exposure weighting (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1b</xref>). We conclude that including additional frames with exposure weighting does not diminish the 2DTM SNR, indicating the constructive contribution of lower-resolution features to the detected signal. Consistent with SNR values being sensitive to defocus errors (<xref ref-type="bibr" rid="bib45">Rickgauer et al., 2020</xref>; <xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>), searching each image with templates sampling a defocus range of 2400 Å in 200 Å steps (13 defocus planes) increased the number of detected targets by ~40% in a 100 nm thick sample and ~400% in a 220-nm-thick sample (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1c</xref>). In addition to increasing the number of detected targets, the defocus search also provides a rough estimate of the out-of-plane position of each 50S. Earlier simulations predicted that protein background would result in reduced target detection in images collected at higher defocus (<xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>). In the present experiment, we did not observe a consistent relationship between mean SNR and image defocus over the range of ~500 to ~2200 nm underfocus (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1d</xref>), suggesting that detection of complexes as large as 50S ribosomal subunits is not prevented by collecting images farther from focus.</p></sec><sec id="s2-3"><title>3D reconstructions of complexes localized by 2DTM</title><p>In our current 2DTM implementation, each detected target is assigned an x,y location, three Euler angles and a defocus value (z coordinate) (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). These parameters can be used to calculate a 3D reconstruction using standard single-particle methods. It is well known that a reconstruction calculated from particles that were identified using a template may suffer from significant template bias (<xref ref-type="bibr" rid="bib28">Henderson, 2013</xref>), reproducing only features of the template and not the targets. However, as shown by <xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref> and discussed below, applying an absolute (rather than relative) threshold based on a known noise distribution, also limits template bias and new features not present in the template may be visible in a reconstruction derived from detected targets. To test this, we calculated a reconstruction using the results from searching 220 images of <italic>M. pneumoniae</italic> cells (see above), selecting targets only from the best images that had more than nine detected targets and at least one target with an SNR value above 9. Using the 5080 targets that met these criteria, out of the total of 6558 detected targets, we calculated a 3D reconstruction (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). The reconstruction had a nominal resolution of 4.3 Å (FSC threshold of 0.143, <xref ref-type="bibr" rid="bib48">Rosenthal and Henderson, 2003</xref>; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1e</xref>). However, visible density of known ribosome features (not shown) suggested that this resolution estimate was unrealistically high, as expected due to the well-known effect of template bias (<xref ref-type="bibr" rid="bib56">Stewart and Grigorieff, 2004</xref>). We used the masked FSC curve between the <italic>M. pneumoniae</italic> 30S structure, which was not included in the template search, and the 3D reconstruction to define an appropriate resolution to filter the reconstruction (see Materials and methods, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1d</xref>). The 20 Å-filtered reconstruction reproduces the 50S template as expected, but also shows clear, albeit weaker density for the 30S subunit that was not present in the template, and thus cannot be due to template bias (<xref ref-type="fig" rid="fig3">Figure 3b,c</xref>).</p><p>The difference map calculated using <italic>diffmap</italic> (<xref ref-type="bibr" rid="bib21">Grigorieff, 2021a</xref>), between the <italic>M. pneumoniae</italic> 50S template and the 3D reconstruction shows density in regions of the 50S that have been shown to be flexible from in vitro reconstructions of the ribosome, specifically around the L1 stalk and the L7/L12 stalk (<xref ref-type="fig" rid="fig3">Figure 3c</xref>). The <italic>Escherichia coli</italic> L1 stalk moves ~45–60 Å relative to 50S during translocation (reviewed in <xref ref-type="bibr" rid="bib34">Ling and Ermolenko, 2016</xref>), and the C-terminal domain of L10 and N-terminal domain of L12 are known to be flexible (<xref ref-type="bibr" rid="bib12">Diaconu et al., 2005</xref>). Moreover, we observed density in each of the three tRNA-binding sites on the small subunit, which were not present in the template (<xref ref-type="fig" rid="fig3">Figure 3d</xref>). The density is consistent with tRNAs representing multiple states and may also reflect the binding of other factors, such as translational GTPases in the A-site. It is therefore likely that the calculated reconstruction represents an average of different conformations adopted by the ribosome in vivo, as expected in actively growing cells. This average differs therefore from the single conformation used for the template, giving rise to the features observed in the difference map. Smaller features in the difference map may also correspond to noise in the reconstruction, as well as features that result from inaccuracies in the resolution-dependent scaling of the template against the reconstruction before subtraction. More accurate scaling may be achieved by scaling according to local resolution estimates, which were not obtained here, as well as masking to exclude non-overlapping parts in both maps.</p></sec><sec id="s2-4"><title>2DTM reveals species-specific structural features</title><p>To test the precision of 2DTM and to evaluate whether species-specific structural differences would preclude detection by 2DTM, we searched the same 220 images of <italic>M. pneumoniae</italic> with a 50S template derived from <italic>Bacillus subtilis</italic> (PDB: 3J9W). <italic>B. subtilis</italic> 50S is structurally closely related to <italic>M. pneumoniae</italic> 50S but displays differences in rRNA sequence and protein composition (<xref ref-type="bibr" rid="bib23">Grosjean et al., 2014</xref>; <xref ref-type="bibr" rid="bib55">Sohmen et al., 2015</xref>; <xref ref-type="fig" rid="fig4">Figure 4a</xref>). Comparing the two models by FSC and taking 0.5 as a similarity threshold (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1a</xref>) suggests that the effective resolution of the <italic>B. subtilis</italic> template is limited to ~4.7 Å. Using <italic>B. subtilis</italic> 50S as a template, we identified 2874 50S locations, less than half than were identified using the <italic>M. pneumoniae</italic> template (<xref ref-type="fig" rid="fig4">Figure 4b</xref>), and with significantly lower 2DTM SNR values (p&lt;0.0001, Mann-Whitney U test, <xref ref-type="fig" rid="fig4">Figure 4c</xref>). Again, to limit targets to the best images, we included only images with more than two detected targets and at least one target with an SNR value above 9. Using the 1172 targets from these images, we calculated a 3D reconstruction (<xref ref-type="fig" rid="fig4">Figure 4d</xref>). As before, the 20 Å-filtered reconstruction reproduces the 50S template with clear density for the 30S subunit and shows features consistent with translating ribosomes (<xref ref-type="fig" rid="fig4">Figure 4d–e</xref>). However, unlike before, the 3D reconstruction also shows extensive differences in the 50S subunit relative to the <italic>B. subtilis</italic> 50S template (<xref ref-type="fig" rid="fig4">Figure 4e</xref>). Since this reconstruction was generated using ~fivefold fewer particles, some of the additional density likely reflects an expected higher level of noise. Despite this, the 3D reconstruction revealed that some of the features visible in the 50S density deviate from the <italic>B. subtilis</italic> template and likely result from <italic>M. pneumoniae-</italic>specific features (<xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref>; <xref ref-type="fig" rid="fig4">Figure 4e</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1c</xref>). Specifically, the 3D reconstruction showed density consistent with <italic>M. pneumoniae-</italic>specific C-terminal extensions of proteins L29 and L22, and protein L9 (<xref ref-type="fig" rid="fig4">Figure 4f</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1c</xref>; <xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref>). The latter was absent from the <italic>B. subtilis</italic> model despite being encoded in the <italic>B. subtilis</italic> genome (<xref ref-type="bibr" rid="bib55">Sohmen et al., 2015</xref>). The 3D reconstruction also lacked density for protein uL30, which is present in the <italic>B. subtilis</italic> template, but absent from the <italic>M. pneumoniae</italic> genome (<xref ref-type="bibr" rid="bib23">Grosjean et al., 2014</xref>; <xref ref-type="fig" rid="fig4">Figure 4g</xref>). Moreover, the 3D reconstruction shared additional unattributed features with the previously determined reconstruction (<xref ref-type="fig" rid="fig3">Figure 3b</xref>) that do not derive from either template (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1c</xref>). We conclude that a <italic>B. subtilis</italic> 50S template can be used as a homology model to identify <italic>M. pneumoniae</italic> ribosomes and distinguish species-specific features, and that including high-resolution signal in 2DTM does not overly bias the 3D reconstruction when an appropriately high SNR threshold is used. These results further demonstrate the reliability of 2DTM and its potential to directly resolve complex structure in situ.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>2DTM using a <italic>B. subtilis</italic> 50S template reveals species-specific structures.</title><p>(<bold>a</bold>) Molecular models of <italic>B. subtilis</italic> (red) and <italic>M. pneumoniae</italic> (blue) 50S ribosomal subunits aligned using <italic>UCSF Chimera</italic> (<xref ref-type="bibr" rid="bib42">Pettersen et al., 2004</xref>). (<bold>b</bold>) Venn diagram showing the number of 50S subunits detected in the same dataset of 220 images of <italic>M. pneumoniae</italic> cells using the indicated template. (<bold>c</bold>) Boxplot showing the distribution of 2DTM SNR values of the locations quantified in the diagram in (<bold>b</bold>). The width of the box indicates the interquartile range, the middle line indicates the median and the whiskers indicate the range. The dashed vertical line indicates the 2DTM SNR threshold used. (<bold>d</bold>) 20 Å filtered 3D reconstruction generated using the locations and orientations of 1172 50S subunits detected in 220 images using 2DTM with a <italic>B. subtilis</italic> 50S template, showing clear density for the 30S ribosomal subunit and L7/L12 (not included in the template). The threshold was selected to reflect the threshold used in <xref ref-type="fig" rid="fig3">Figure 3b and c</xref>. (<bold>e</bold>) Difference map showing the regions of the 3D reconstructions that differ from the 50S 2DTM search template. Arrows indicate additional density consistent with 70S ribosome structures. (<bold>f</bold>) Difference map as described in (<bold>e</bold>) (gray mesh), aligned to the <italic>B. subtilis</italic> 50S template (red) and both <italic>M. pneumoniae</italic> (<italic>M.p.</italic>, blue) and <italic>B. subtilis</italic> (red, not visible) molecular models. The difference map is shown at the same threshold as in (<bold>d</bold>). (<bold>g</bold>) 3D reconstruction as described in (<bold>d</bold>) (transparent gray), aligned to <italic>M. pneumoniae</italic> (<italic>M.p.</italic>, blue) and <italic>B. subtilis</italic> (<italic>B.s.</italic>, red) molecular models.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Comparison of 2DTM results using different 50S templates.</title><p>(<bold>a</bold>) FSC curve showing the correlation between the <italic>M.pneumoniae</italic> and <italic>B. subtilis</italic> templates. (<bold>b</bold>) FSC obtained for the 3D reconstruction calculated from the targets found by 2DTM (shown in <xref ref-type="fig" rid="fig4">Figure 4d</xref>). (<bold>c</bold>) Image showing the <italic>B. subtilis</italic> 50S template (red) aligned with the <italic>M. pneumoniae</italic> 50S model (blue), <italic>B. subtilis</italic> 50S model (not visible), the difference map from <xref ref-type="fig" rid="fig4">Figure 4e</xref> (gray mesh) and the difference map from <xref ref-type="fig" rid="fig3">Figure 3c</xref>. White arrow indicates the <italic>M. pneumoniae</italic>-specific C-terminal extension of L22, the black arrows indicate unattributed density that is common to both difference maps. (<bold>d</bold>) FSC curves showing the correlation between the 3D reconstructions generated from the targets identified with the indicated 50S templates and masked in the area of the 30S subunit, and the <italic>M. pneumoniae</italic> 30S structure. The 0.5 threshold indicates the resolution limit in each case.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig4-figsupp1-v2.tif"/></fig></fig-group></sec><sec id="s2-5"><title>Benchmarking of 50S ribosomal subunit detection by 3DTM</title><p>Cryo-ET combined with 3DTM is currently one of the most commonly used approaches for locating molecules within cells using available structural information. Rather than using high-resolution templates as is done in 2DTM, 3DTM locates molecules in tomograms with templates filtered to 30 Å or lower (<xref ref-type="bibr" rid="bib30">Himes and Zhang, 2018</xref>). To compare the detection of 50S ribosomal subunits by 2DTM and 3DTM, we collected 19 2D images of <italic>M. pneumoniae</italic> cells followed by tomograms of an overlapping area. These tomograms were collected after the 32 e<sup>-</sup>/Å<sup>2</sup> exposure for images used with 2DTM, using standard protocols (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). The pre-exposure of 32 e<sup>-</sup>/Å<sup>2</sup> affects the signal in the tomograms at higher resolution but is expected to have only a small effect in the resolution range relevant for 3DTM, that is, 20 Å and lower (<xref ref-type="bibr" rid="bib20">Grant and Grigorieff, 2015</xref>). Consistent with this prediction, we estimated an effective B-factor for the subtomograms of 2000 Å<sup>2</sup> using <italic>RELION</italic>, compared to 1700 Å<sup>2</sup> without pre-irradiation (<xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref>). The difference of 300 Å<sup>2</sup> attenuates the signal at 30 Å by only an additional 8%. Furthermore, the large B-factors in both cases confirm the loss of high-resolution signal in the raw tomograms (see Introduction), which currently limits 3DTM to low-resolution.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Comparison of ribosome detection by 2DTM and 3DTM.</title><p>(<bold>a</bold>) Images of untilted cryo-EM grids of <italic>M. pneumoniae</italic> were collected with a total exposure of 32 e<sup>-</sup>/Å<sup>2</sup>, followed by a tilt series of an overlapping region with a total exposure of 129 e<sup>-</sup>/Å<sup>2</sup> to reconstruct a tomogram. (<bold>b</bold>) 50S ribosomal subunits were identified in the 2D images by 2DTM with the <italic>M. pneumoniae</italic> 50S (left) and in the 3D tomogram by 3DTM using the 50S subunit as a template (right). The 2DTM and 3DTM templates were aligned to ensure that the respective coordinate systems were aligned, and that the x,y coordinates of the detected 50S subunits in each search could be aligned. (<bold>c</bold>) The proportion of 2DTM and 3DTM coordinates within 100 Å and 20° in each of the three Euler angles in 19 images was calculated using an SNR threshold that allowed either one false positive per image (upper), or detection of ~2 times more potential 50S targets (lower). (<bold>d</bold>) Plot showing the proportion of 2DTM targets that were also detected by 3DTM as a function of sample thickness. (<bold>e</bold>) Plot showing the proportion of 3DTM targets that were also detected by 2DTM as a function of sample thickness. (<bold>f</bold>) Plot showing the proportion of 2DTM 50S targets with a positional and rotational 3DTM match at the indicated 2DTM SNR threshold (dashed line). (<bold>g</bold>) Plot showing the number of expected false positives in the 2DTM search assuming a Gaussian noise model (black) and the observed number of 2DTM targets without a matching 3DTM target (blue) at the indicated 2DTM SNR.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Analysis of targets detected by 3DTM.</title><p>(<bold>a</bold>) Cross-correlation scores for the top 600 hits detected in 3DTM using a 50S template. (<bold>b</bold>) Classification of the subtomograms in <italic>RELION</italic>. (<bold>c</bold>) Bar chart showing the proportion of ranked 3DTM hits classified as false positives (yellow), 50S (green; used as a template) or 70S (purple) by classification in <italic>RELION</italic>. The ranked hits are binned in sets of 3.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Comparison of 2DTM and 3DTM results.</title><p>(<bold>a</bold>) Scatterplot showing the mean 2DTM SNR of the 19 images searched in <xref ref-type="fig" rid="fig5">Figure 5</xref> relative to the sample thickness calculated from a tomogram. The size of each point is proportional to the total number of 50S detected with 2DTM as shown in the legend (right). (<bold>b</bold>) As in (<bold>a</bold>), showing the number of 50S detected with 3DTM in the area of the tomogram overlapping the 2D image. (<bold>c</bold>) Scatterplot showing the 2DTM SNR relative to the 3DTM cross-correlation (CC) score of all 576 targets identified in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig5-figsupp2-v2.tif"/></fig></fig-group><p>To identify 50S subunits with 3DTM, we followed established protocols using PyTom and a 30 Å low-pass filtered 50S template generated in a previous study (<xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref>). The found targets were ranked according to their cross-correlation score and the top 600 hits were selected for each tomogram, followed by alignment and 3D classification with <italic>RELION</italic> 3.0.8 (<xref ref-type="bibr" rid="bib68">Zivanov et al., 2018</xref>). The selection of the top 600 hits ensured that more than 90% of potential targets in one tomogram, including free 50S and 50S in assembled 70S, were included. Combining <italic>RELION</italic> classification results with cross-correlation ranking (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>) shows that the hits with the lowest scores contained fewer than 10% of 50S and 70S targets. The proportion of false positives was consistent with a previous study (<xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref>), indicating that pre-irradiation did not noticeably affect 50S or 70S detection by 3DTM.</p><p>We aligned the coordinates of the 652 50S subunits identified by 2DTM with 983 50S subunits identified by 3DTM (see Materials and methods), both containing 50S targets corresponding to single 50S subunits and 70S ribosomes (<xref ref-type="fig" rid="fig5">Figure 5b</xref>). Within the area common to the 2D images and tomograms, we identified 576 2DTM targets that were within a 100 Å distance in the x,y plane, and within 20° in each Euler angle of a 3DTM target. These limits included ~95% of all paired targets (<xref ref-type="fig" rid="fig5">Figure 5c–d</xref>). The paired targets represent ~90% of all 2DTM targets and ~60% of all 3DTM targets in this area (<xref ref-type="fig" rid="fig5">Figure 5c</xref>, upper). We found that the proportion of 2DTM targets with a corresponding 3DTM target was consistent across the images examined (<xref ref-type="fig" rid="fig5">Figure 5d</xref>). In contrast, the proportion of the 3DTM targets detected in the 2DTM search was variable and showed a negative correlation with sample thickness (<xref ref-type="fig" rid="fig5">Figure 5e</xref>). This agrees with our and prior observations that 2DTM is particularly sensitive to sample thickness (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>; <xref ref-type="bibr" rid="bib45">Rickgauer et al., 2020</xref>; <xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>), which likely contributes to the high false negative rate of 2DTM relative to 3DTM.</p><p>The number of targets detected in 2DTM depends on the SNR threshold, which is determined by the desired false-positive rate. Assuming a Gaussian noise distribution, we calculated a threshold SNR of 7.61 to allow for a false positive rate of one per image (<xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>). To test if a lower SNR threshold improves the agreement between 2DTM and 3DTM, we determined the proportion of detected 2DTM 50S targets with a matched 3DTM target at different SNR thresholds (<xref ref-type="fig" rid="fig5">Figure 5f</xref>). Decreasing the SNR threshold to 7.00 increased the number of detected targets more than twofold (from 652 to 1442), but the number of 2DTM targets with a corresponding 3DTM target increased only ~1.2 fold (from 576 to 714) (<xref ref-type="fig" rid="fig5">Figure 5c</xref>, lower). The plot of matching targets in <xref ref-type="fig" rid="fig5">Figure 5f</xref> shows that at SNR thresholds &gt; 7.6, the proportion of 2DTM/3DTM paired targets was ~90–100%, while lowering the SNR threshold below 7.6 resulted in a sharp decrease, indicating that below this threshold, more non-matching targets were found than matching targets, many of them likely false positives. The value of 7.6 agrees closely with the 7.61 threshold at which one false positive per image is expected (<xref ref-type="fig" rid="fig5">Figure 5f</xref>, dashed line). This experimentally validates our use of a Gaussian noise model and the Neyman-Pearson threshold criterion and shows that the SNR threshold can be used to set a desired false positive rate suitable for a particular experimental design.</p><p>At a threshold of 7.61, the number of 2DTM targets not detected in the 3DTM search was 76, &gt; 4 times higher than the expected 19 false positives for the 19 searched images and representing ~12% of the 2DTM peaks (<xref ref-type="fig" rid="fig5">Figure 5g</xref>). This is consistent with the estimated 3DTM false negative rate of ~10% (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>), and suggests that these indeed represent false negatives in the 3DTM search. We also noted that in samples of ~100 nm thickness we detected ~90% of the 50S subunits identified with 3DTM (<xref ref-type="fig" rid="fig5">Figure 5e</xref>). We therefore estimate that given optimum sample parameters, 2DTM can detect 50S subunits with comparable sensitivity to 3DTM.</p></sec><sec id="s2-6"><title>2DTM can validate targets identified by 3DTM</title><p>While 2DTM tends to miss targets close to the chosen SNR threshold, one of the key limitations of 3DTM is a high false discovery rate and the difficulty in discriminating between true and false positives. This shortcoming can be partially mitigated by manually curating the detected 3DTM targets and subsequent classification of the subtomograms. The manual curation requires experience, is time-consuming and generally not reproducible. Progress has been made to improve the discrimination between true and false positives using deep learning algorithms as demonstrated with synthetic data (<xref ref-type="bibr" rid="bib25">Gubins et al., 2019</xref>), although on real data they currently perform only as well as 3DTM (<xref ref-type="bibr" rid="bib39">Moebel et al., 2020</xref>).</p><p>We investigated the use of 2DTM as an independent screen to validate 3DTM targets, by comparing the list of detected 3DTM targets before manual curation and 3D classification with the list of high-confidence 2DTM targets. We found that 2DTM detects ~60% of the 3DTM targets that are classified as 50S or 70S, while only detecting &lt;5% of the 3DTM targets that likely represent false positives (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). Thus 2DTM can clearly discriminate targets that were excluded by classification of 3DTM targets with <italic>RELION</italic> (<xref ref-type="bibr" rid="bib7">Bharat and Scheres, 2016</xref>). This demonstrates that 2DTM, unlike 3DTM, can directly and reliably locate targets in situ without the need for additional refinement or curation. It also shows that 2DTM provides complementary evidence that could be used to validate targets identified by 3DTM without the need for subtomogram averaging and classification.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>2DTM is precise, excludes non-ribosome particles and permits detection of ribosomes overlapping along the projection direction.</title><p>(<bold>a</bold>) Pie chart showing the results of a comparison of a set of 1380 3DTM coordinates initially identified by PyTom followed by 3D classification in <italic>RELION</italic> that identified 989 targets as 50S or 70S (left) and 391 targets as non-ribosomal particles (right), with a list of 652 50S 2DTM targets. Red indicates the proportion aligning with 50S coordinates identified by 2DTM; gray indicates non-matching 3DTM coordinates. (<bold>b</bold>) Pie charts showing the proportion of 50S detected by 2DTM with the <italic>M. pneumoniae</italic> template with a bound 30S target as determined by performing a local search with <italic>refine_template</italic> (see Materials and methods) (left), and the ratio of 3DTM 50S targets classified as 70S or 50S by <italic>RELION</italic> (right). (<bold>c</bold>) Histogram showing the distribution of the in-plane distance between matched 3DTM and 2DTM after 3DTM refinement of the subtomograms with <italic>RELION</italic>. (<bold>d</bold>) As in (<bold>c</bold>), showing the angular distance. (<bold>e</bold>) As in (<bold>c</bold>), showing the out-of-plane difference (z coordinate) before (blue) or after (yellow) 2DTM refinement of z coordinates. (<bold>f</bold>) Plotted result from a 2DTM search showing template projections at the locations and Euler angles of detected 50S subunits (left), inset showing two overlapping 50S subunits when viewed parallel to the image plane. (<bold>g</bold>) As in (<bold>f</bold>), showing the plotted result from 3DTM of the same area aligned to show the same perspective. (<bold>h</bold>) The template projections in (<bold>f</bold>) rotated 90° to show the overlapping 50S subunits perpendicular to the image plane. (<bold>i</bold>) As in (<bold>h</bold>), showing the result from 3DTM in the same area.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Proportional bar chart showing the percentage of all 983.</title><p>3DTM targets in the area of the tomogram overlapping with the 2D image, and the 576 3DTM targets that were also detected by 2DTM, indicating 50S (orange) or 70S (blue) in each case as classified by <italic>RELION</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68946-fig6-figsupp1-v2.tif"/></fig></fig-group><p>To evaluate whether we could locate 30S subunits associated with 50S by template matching, and to compare the results to the <italic>RELION</italic> classification of the 3DTM results as 50S or 70S, we used the locations and orientations of the 50S targets detected with the <italic>M. pneumoniae</italic> template to perform a local search for the 30S subunit (PDB: 7OOC) with and without the flexible head domain (see Methods), sampling a range of ±12.5 degrees, that is, larger than the rotational range of the 30S relative to the 50S. Of the 700 50S locations searched, 314 (~45%) had detectable 30S (<xref ref-type="fig" rid="fig6">Figure 6b</xref>), fewer than the ~70% of the 3DTM targets that were classified as 70S using <italic>RELION</italic>. We speculate that this is due to structural discrepancies that likely exist between the 30S template and specific instances of the small ribosomal subunit in our images. The 30S subunit is known to undergo significant conformational changes during the functional cycle of the ribosome in addition to inter-subunit rotation (see Discussion).</p><p>We also compared the x,y locations (<xref ref-type="fig" rid="fig6">Figure 6c</xref>), z coordinates (<xref ref-type="fig" rid="fig6">Figure 6e</xref>), and orientations (<xref ref-type="fig" rid="fig6">Figure 6d</xref>) assigned by 2DTM to those assigned by 3DTM. Comparing the 2DTM results with the refined 3DTM results shows that ~ 95% (576 out of 603) of the targets aligned in x and y had an angular distance of 20° or less, with a median of 7° (using <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>; <xref ref-type="fig" rid="fig6">Figure 6d</xref>). The median in-plane distance of 12 Å is likely due to deformation of the sample under the electron beam, which is more pronounced with the higher electron dose used in tilt series, and to a lesser extent due to the lower resolution of 3DTM. In contrast to the x,y locations, which were calculated in steps of one pixel (1.27 Å), the defocus values of 2DTM were sampled in 200 Å steps and, correspondingly the median out-of-plane distance between detected 2DTM and 3DTM targets was much higher at ±84 Å (<xref ref-type="fig" rid="fig6">Figure 6e</xref>). We used the program <italic>refine_template</italic> (see Materials and methods) to perform a local defocus refinement, which reduced the median out-of-plane distance to ±59 Å (<xref ref-type="fig" rid="fig6">Figure 6e</xref>), less than 1/3 the diameter of the 50S. The fivefold greater error in z relative to the x,y plane is consistent with the previously reported weaker dependence of the 2DTM SNR values on defocus (<xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>).</p><p>We note that some of the 50S subunits detected by 2DTM overlap in the image and were found in comparable locations by 3DTM (e.g. <xref ref-type="fig" rid="fig6">Figure 6f–i</xref>). This confirms that 2DTM, as previously proposed (<xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>) can effectively detect overlapping particles without sample tilt.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we provide strategies to overcome some of the major limitations of molecular localization in cells using 2DTM. Firstly, we present a new implementation of 2DTM in <italic>cis</italic>TEM, which offers a user-friendly interface and substantial acceleration by running the most demanding computations on GPUs. Secondly, we show that averaging of complexes identified with 2DTM can reveal differences between the template and the target and allows identification of interacting complexes that may be difficult to detect alone. Thirdly, we demonstrate that 2DTM detects bona fide ribosomes in <italic>M. pneumoniae</italic> cells with high precision and comparable sensitivity relative to 3DTM. In the following, we highlight some of the technical advances of our implementation, discuss applications of, and possible improvements to 2DTM, and how 2DTM and 3DTM can benefit from each other.</p><sec id="s3-1"><title>GPU acceleration increases the throughput of 2DTM</title><p>To make 2DTM useful in practice, we have increased its speed by more than 10-fold, socket-to-socket, relative to our C++ CPU implementation in <italic>cis</italic>TEM via GPU acceleration, making it possible to search multiple images in hours instead of days. To fully utilize the GPU capacity, we have introduced flexible load balancing via CUDA streams, accessible to the user by including additional CPU threads in their <italic>cis</italic>TEM run profile. This ensures a simple mechanism to take full advantage of computers containing variable Nvidia GPU hardware architectures and adapt to different problem sizes.</p><p>GPUs have so many processing units (cores) that efficient algorithms, like the FFT, are often limited by memory transfers. We have ameliorated this problem by taking advantage of the FP16 format, storing two variables in the low and high 16 bits of a 32 bit __half2 vector data type, thereby roughly doubling the memory bandwidth. Due to the low SNR intrinsic to cryo-EM data, the loss of numeric precision associated with FP16 does not substantially alter the effective SNR of the data stored in FP16 format. We expect that this could be useful for computation in other modalities of cryo-EM.</p><p>With a few precautions, we can retain sufficient precision, that is, greater than what is used for our detection threshold, to obtain the same net results as with the 64-bit double precision accumulators used in the CPU code. We have also taken advantage of increased memory bandwidth of FP16 by converting the FFT of the input image, which is only transformed once at the outset of the algorithm, into FP16 format. When this array is read into the GPU’s streaming multi-processors for cross-correlation, it is converted to 32-bit single precision as part of our cuFFT callback routine prior to the conjugate multiplication and inverse FFT. Due to the limited range of FP16, we did not investigate whether this reduced precision could be used directly in the FFT in 2DTM. In principle, this could yield another ~1.6x speedup by doubling the inverse FFT computation speed. Additionally, it may be possible to exploit the fact that each template is padded with zeros to the full image size prior to taking the FFT, resulting in many redundant zero-valued 1D FFTs in the common row-column transform approach for 2D FFTs.</p><p>Support for the new Bfloat16 floating-point format, which has a larger range than FP16, and hardware acceleration for asynchronous memory movement on chip in the new Nvidia Ampere architecture, may also provide additional opportunities to accelerate the current algorithm, which is predominantly memory-bandwidth limited. Finally, further acceleration may be gained by improving the algorithm itself, perhaps via a hierarchical search as is done in single-particle cryo-EM. For example, a coarse search followed by a local refinement may improve both the speed and overall accuracy of 2DTM.</p></sec><sec id="s3-2"><title>Template matching and noise overfitting</title><p>Template matching is a well-established method to pick particles in single-particle cryo-EM images for further processing and 3D reconstruction (<xref ref-type="bibr" rid="bib50">Scheres, 2015</xref>; <xref ref-type="bibr" rid="bib54">Sigworth et al., 2010</xref>). The advantage of using a template that matches the structure of the particle to be reconstructed is more discriminatory picking, and the possibility to exclude contaminants and other features in an image that do not represent valid particles. Using a template for picking can also lead to template bias, that is, a 3D reconstruction that reproduces the template rather than the true particle structure (<xref ref-type="bibr" rid="bib28">Henderson, 2013</xref>; <xref ref-type="bibr" rid="bib58">Subramaniam, 2013</xref>; <xref ref-type="bibr" rid="bib62">van Heel, 2013</xref>). It is therefore important to validate features in a reconstruction derived from particles identified by template matching. This is commonly done by observing features in the reconstruction that were not present in the template, and that are known to be true. For example, templates can be low-pass filtered to 20 Å or lower (<xref ref-type="bibr" rid="bib51">Scheres and Chen, 2012</xref>), and the emergence of high-resolution features such as secondary structure or amino acid side chains will then validate the reconstruction. In the current release of <italic>cis</italic>TEM (<xref ref-type="bibr" rid="bib19">Grant et al., 2018</xref>), a Gaussian blob is used for particle picking, and recognizable low- and high-resolution features visible in the reconstruction serve as validation. Since 2DTM uses high-resolution features to identify targets, reconstructions have to be validated differently, for example by identifying additional a priori-known density features that were not present in the template. In the case of using the 50S templates for 2DTM, the reconstructions showed clear density for the 30S subunit, as well as at tRNA binding sites, both of which validate the reconstructions (<xref ref-type="fig" rid="fig3">Figure 3c–d</xref>). However, despite this validation, there may still be a template bias in the reconstruction (<xref ref-type="bibr" rid="bib56">Stewart and Grigorieff, 2004</xref>). While it is not possible to quantify this bias without knowledge of the unbiased reconstruction, the strength of the bias will depend on the number of degrees of freedom accessible during template matching, that is, the number of search locations. By increasing the SNR threshold to a value where only one false positive per search is expected on average, almost all search locations that do not contain matching signal are excluded. The high SNR threshold used in our 50S template search, therefore, limits the template bias in the reconstruction. Indeed, apart from the large additional density corresponding to the 30S subunit, there are also several smaller differences between the template and the reconstruction within the region of the 50S subunit that can be related to conformational changes occurring during translation (<xref ref-type="fig" rid="fig3">Figure 3c–d</xref>, see Results). This confirms that template bias in this reconstruction must be small relative to the unbiased signal represented by the reconstruction.</p></sec><sec id="s3-3"><title>Template optimization</title><p>In this study, we found that applying a B-factor of 85 Å<sup>2</sup> to the 50S template maximized the mean detection SNR in this dataset (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a</xref>). This value matches closely the B-factor of 86 Å<sup>2</sup> used to correct the in situ reconstruction of the <italic>M. pneumoniae</italic> 70S from subtomograms (<xref ref-type="bibr" rid="bib60">Tegunov et al., 2021</xref>). Since this B-factor affects all atoms in the template equally, we expect that a more accurate method of generating templates that uses variable B-factors to account for local differences in mobility will further improve detection. We propose that given a sufficiently accurate method to calculate template densities, 2DTM could be used to investigate the relative impact of these and other, not yet considered, factors. For example, we could use biochemical restraints to control conformational/compositional heterogeneity and thereby investigate the process of radiation damage which likely varies based on a complex’s chemical composition and environment. Alternatively, if we can correctly model sample motion and radiation damage, we could use 2DTM to probe for more detailed aspects of an individual target’s structural identity and composition, which may vary based on location in the cell or lifecycle of the organism to be investigated. It will therefore be important in the further development of 2DTM to also develop more reliable and accurate methods to generate templates from atomic coordinates, and to comprehensively model cryo-EM images.</p><p>Templates in the present study used density maps generated by <italic>pdb2mrc</italic> (<xref ref-type="bibr" rid="bib59">Tang et al., 2007</xref>), and projections were calculated using the simple linear interpolation algorithms implemented in <italic>cis</italic>TEM (<xref ref-type="bibr" rid="bib19">Grant et al., 2018</xref>). These simplifications contributed to the acceleration of our 2DTM implementation, compared to the more accurate density modeling and projection calculation used previously (<xref ref-type="bibr" rid="bib45">Rickgauer et al., 2020</xref>; <xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>). The simplifications, as well as noticeable blurring in some of our images due to deformation of the <italic>M. pneumoniae</italic> cells under the electron beam (<xref ref-type="bibr" rid="bib60">Tegunov et al., 2021</xref>), likely affect the SNR values obtained in our template searches. Indeed, the SNR values we observe are lower on average than expected based on the molecular mass of our template (about 1.2 MDa), as well as previously observed values obtained with different samples and template structures (<xref ref-type="bibr" rid="bib45">Rickgauer et al., 2020</xref>; <xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>). Furthermore, the <italic>M. pneumoniae</italic> 50S atomic model built into a 3.5 Å map (<xref ref-type="bibr" rid="bib60">Tegunov et al., 2021</xref>) may contain atomic coordinate errors that are larger than those in the 60S model used by <xref ref-type="bibr" rid="bib45">Rickgauer et al., 2020</xref>, which was built into a 2.9 Å map. Coordinate errors will further decrease the SNR values obtained in a template search. Accurate atomic models and methods to simulate realistic cryo-EM images (e.g. <xref ref-type="bibr" rid="bib29">Himes and Grigorieff, 2021</xref>) will therefore be important to maximize the detectability of molecules by 2DTM.</p></sec><sec id="s3-4"><title>2DTM with multiple templates</title><p>2DTM employs the matched filter, which is the statistically optimal detector for a deterministic signal in wide-sense stationary noise (<xref ref-type="bibr" rid="bib38">McDonough and Whalen, 1995</xref>). With zero-mean Gaussian noise, the output of the matched filter is an SNR determined by the ratio of the matching signal cross-correlation coefficient to the standard deviation of correlation coefficients in areas of the image devoid of matching signal. Given that the noise is roughly constant for a given image, the SNR measured in 2DTM is ultimately limited by the template’s molecular mass, making smaller complexes more difficult to detect. In our earlier work, we limited the SNR threshold to a value allowing, on average, one false positive per search. This threshold is, however, not optimal for every experiment and should be adjusted based on the experimental rationale and design.</p><p>A match in 2DTM indicates that the template is sufficiently similar to the target to yield an SNR above the significance threshold but does not indicate that the target conforms to the exact structure of the template. Indeed, significant peaks were detected using the <italic>B. subtilis</italic> 50S as a template which has substantial differences to the <italic>M. pneumoniae</italic> 50S (discussed below). Moreover, since target detection depends on pre-existing structures, detection by 2DTM is necessarily biased towards targets that are sufficiently similar to the state represented by the template, and other states may be missed. As a consequence, targets detected with 2DTM likely reflect a subset of the total complement of in vivo states. To reduce bias, variable regions could be removed from the template, thereby also reducing the potentially detectable signal in a template search. To detect targets that are in different states without loss of signal, multiple templates representing different states might be used. The problem of mismatched states is particularly evident when performing a local search for bound 30S subunits using the coordinates of detected 50S subunits. Despite the 30S subunits having a molecular mass of ~700 kDa, well above the 300–400 kDa limit expected to be detectable by 2DTM in images of samples with a thickness of 150–200 nm (<xref ref-type="bibr" rid="bib45">Rickgauer et al., 2020</xref>; <xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>), we found only ~45% of the identified 50S bound with 30S subunits, just over half of the expected 70% based on the analysis of tomograms from <italic>M. pneumonia</italic> (<xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref>, <xref ref-type="fig" rid="fig6">Figure 6b</xref>). It is unlikely that this low detection rate is due to a bias of 2DTM toward detecting isolated 50S subunits because (i) a 3D reconstruction based on detected 50S subunits shows clear density for the 30S subunit (<xref ref-type="fig" rid="fig3">Figure 3d</xref>) and (ii) there was no significant difference in the detection of 50S and 70S targets, as validated by 3DTM (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). Since the 30S subunit is highly dynamic and can adopt multiple conformations, it is likely that our false negatives arose from conformations that are not sufficiently similar to the 30S template that we used in our search.</p><p>Below an SNR of 7.2, the number of detected 2DTM targets without a 3DTM match is less than statistically expected (<xref ref-type="fig" rid="fig5">Figure 5g</xref>). This suggests that the statistics, which are based on a Gaussian noise model, might suffer from bias, for example because the correlation coefficients calculated for each search location are not completely independent from each other. While further investigation will be needed to model the noise in correlation maps more accurately, the current bias due to residual correlations between search locations results in a slight overestimation of the number of false positives at a given SNR. Incorporating more accurate noise models, and properly accounting for uncertainty in the model (reference structure) will require the replacement of the SNR values currently used to evaluate 2DTM results by a more general probabilistic framework. The use of likelihood ratios, for example, will make 2DTM more robust, as well as open up new avenues to explore molecular heterogeneity.</p></sec><sec id="s3-5"><title>2DTM as a tool to investigate diverse species</title><p>One of the limitations of 2DTM is a reliance on pre-existing high-resolution structures. Outside of a few model organisms, high-resolution structures are not available for the vast majority of species. We show that, despite differences in their structures, a <italic>B. subtilis</italic> 50S template can detect 50S in <italic>M. pneumoniae</italic> cells (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Thus, it is possible to use structures from related organisms to identify the locations and orientations of complexes with 2DTM. Mismatches between the template and cellular target resulting from species-specific structures reduce the 2DTM SNR (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). By comparing the 2DTM SNRs of a series of structures from different species, it may be possible to infer evolutionary relationships in a manner analogous to DNA sequence comparison. Structural comparison with 2DTM would present the additional advantage of defining structural conservation, which may not be evident by sequence comparison alone, without the need to build a detailed molecular model of homologs in each species.</p><p>We have shown that it is possible to generate in situ 3D reconstructions of ribosomes from 2D images of cells, without the need to collect a tilt series (<xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref>). Template bias (discussed above) becomes especially pertinent when using a template from a different species when there is no existing structure to validate the obtained map. In a 3D reconstruction from 50S located by 2DTM with a <italic>B. subtilis</italic> 50S template we identified density corresponding to <italic>M. pneumoniae-</italic>specific protein structures, and failed to detect density corresponding to a <italic>B. subtilis-</italic>specific protein (<xref ref-type="fig" rid="fig4">Figure 4f–g</xref>). This demonstrates that by using a sufficiently high threshold to prevent a preponderance of false positives, targets identified using 2DTM templates from different species can be averaged to generate in situ 3D reconstructions with minimal template bias. Many biologically important organisms are difficult to grow at scales necessary for protein purification and in vitro structure determination. Cryo-ET is also currently limited by computationally demanding image processing, and is thus low throughput for routine in situ structure determination. 2DTM could be used as an alternative tool to accelerate in situ structure determination in non-model organisms.</p></sec><sec id="s3-6"><title>2DTM and 3DTM complement each other</title><p>A significant challenge in using cryo-EM to study complexes in situ arises from the thick and crowded nature of the sample. In tomograms, the background generated by neighboring and overlapping molecules can be partially ‘disentangled’ from the search targets by resolving all spatial dimensions. This provides an advantage of 3DTM over 2DTM when detecting targets that can be clearly separated in 3D. However, while overlapping density cannot be removed in single-tilt images used for 2DTM, overlapping targets can still be separated based on their different x,y coordinates, views, and defocus values (z coordinate). For example, using 2DTM we were able to discern overlapping 50S ribosomes, as validated by comparison with the 3DTM results (<xref ref-type="fig" rid="fig6">Figure 6f–i</xref>). Thus, separating overlapping particles does not require collecting a tilt series.</p><p>The results of 3DTM do not seem to be correlated with sample thickness within the tested range (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). It is difficult to tell if this is due to a better overall performance of 3DTM in thicker samples, for example due to the separation of overlapping densities, or if 3DTM is simply less sensitive to the signal degradation associated with thicker samples, for example by multiple and inelastic scattering. The latter seems more likely since 3DTM depends primarily on low-resolution signal, which in cryo-EM data is usually substantially stronger than high-resolution signal and therefore remains detectable in thicker samples despite signal degradation. While the stronger reliance on low-resolution features makes 3DTM less sensitive to sample thickness and image-degrading factors, its high false positive rate requires extensive expert curation, often exceeding the computational run time of the original search. Even where time is not a concern, manual curation is difficult if not impossible in dense regions of a cell, like the nucleus, or for particles smaller than a ribosome that are not easily visually discernible. Particle classification approaches such as those implemented in <italic>RELION</italic> can be useful for removing false positives. However, their performance on noisy subtomograms of relatively small or rare complexes remains problematic.</p><p>Using the full electron dose in a single exposure allows for the inclusion of high-resolution information in a 2DTM search, which improves its precision and enables detection of rare complexes in dense molecular environments, thereby alleviating some of the major constraints of 3DTM. However, as we show, the higher precision of 2DTM comes at the expense of lower sensitivity in thick samples. The lack of multiple sample tilts makes larger features such as membranes more difficult to map in 3D and lowers the positional accuracy perpendicular to the image plane. In principle, 3DTM could also take advantage of high-resolution information, but in practice this is currently not achieved, possibly due to increased specimen motion on multiple exposures, errors in the CTF determination from very low-dose exposures, difficulty in aligning tilt series, and increasing sample thickness as a function of tilt (<xref ref-type="bibr" rid="bib63">Voortman et al., 2014</xref>). New approaches that take into account sample deformation (<xref ref-type="bibr" rid="bib30">Himes and Zhang, 2018</xref>; <xref ref-type="bibr" rid="bib60">Tegunov et al., 2021</xref>) may help boost the high-resolution signal in tomograms.</p><p>Better overall performance of template matching may be achieved by combining the high precision of 2DTM with the high sensitivity of 3DTM and broader cellular context in tomograms, making this approach an effective and informative strategy for visual proteomics. In such a strategy, a zero-tilt image with higher dose is collected before collecting a tilt series. The molecules of interest are then identified in both 2D image and 3D tomogram, the 2D search is used to validate hits in the tomogram, and the 3D coordinates provide cellular context in 3D space and higher accuracy in the z coordinates (e.g. <xref ref-type="fig" rid="fig5">Figure 5a–b</xref>). Other approaches that leverage the different information available from 2D images and 3D tomograms have been suggested previously (<xref ref-type="bibr" rid="bib4">Bartesaghi et al., 2012</xref>; <xref ref-type="bibr" rid="bib49">Sanchez et al., 2020</xref>). Moreover, since the image modalities (2D vs. 3D) are distinct in the two methods, the noise and background in the data are only partially related: (i) Layers of the sample overlapping in the 2D image can be separated in the tomogram. (ii) The imaging parameters (effective image contrast/defocus, electron dose) as well as the random noise accompanying all cryo-EM data differ between the 2D and 3D data. (iii) Template matching in 2D and 3D relies on different resolution ranges – 3DTM depends strongly on shape information (~20 Å) while 2DTM depends on 3–5 Å resolution. Overlapping hits can therefore be considered to be true positives with high confidence. The requirement of dual detection may allow the detection threshold to be lowered in each search, increasing the overall number of true positives. Such an approach could speed up workflows by avoiding the need for labor-intensive classification and refinement of 3DTM datasets, while incorporating the additional structural context provided by a tomogram. We anticipate that a combined 2DTM-3DTM approach could extend high-confidence complex detection to rare molecules in thicker samples.</p></sec><sec id="s3-7"><title>Future of template matching and conclusions</title><p>We describe here the implementation of a GPU-accelerated 2DTM method into the graphical user interface of the open-source software <italic>cis</italic>TEM. 2DTM effectively detects ribosomes in 2D images of frozen <italic>M. pneumoniae</italic> cells at higher precision, but lower sensitivity than 3DTM in samples thicker than 100 nm. The significance threshold in 2DTM prevents the need for additional manual curation, refinement, averaging or classification, substantially streamlining the process. We propose that an effective, high-confidence strategy for in situ visual proteomics would combine 2DTM and 3DTM and would not be limited to species for which high-resolution structures are available. We also propose that the search space of 2DTM could be further expanded to include a more detailed analysis of the signal present in an image, allowing for interrogation of conformational or compositional variability, by searching with a multi-template library. We demonstrated that 3D reconstructions from targets detected by 2DTM reveal new features not present in the template. This technique, therefore, has the potential to deliver in situ structures at high resolution, similar to subtomogram averaging but requiring less experience and time. While it requires prior knowledge of the target structure to be reconstructed, that is, a template, the 2DTM workflow (including data collection) is significantly faster than tomography and may therefore be more suitable for high-throughput studies. Finally, the need for averaging limits detailed interrogation of molecular structures to more abundant complexes. The spatial organization, structures, composition, and functional states of rare complexes can still be studied in cells by 2DTM, provided they are detectable in 2D images. With further improvements, we expect 2DTM to reveal new insights into the molecular mechanisms of biological processes in their native cellular context.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th valign="top">Reagent type <break/>(species) or <break/>resource</th><th valign="top">Designation</th><th valign="top">Source or <break/>reference</th><th valign="top">Identifiers</th><th valign="top">Additional information</th></tr></thead><tbody><tr><td valign="top">Cell line <italic>(Mycoplasma pneumonia)</italic></td><td valign="top">M129</td><td valign="top"><xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref></td><td valign="top">ATCC 29342</td><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top"><italic>cis</italic>TEM</td><td valign="top">This paper and Grant <xref ref-type="bibr" rid="bib19">Grant et al., 2018</xref>.</td><td valign="top">doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.4603401">10.5281/zenodo.4603401</ext-link></td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://cistem.org/">https://cistem.org/</ext-link></td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Cell culture, grid preparation, and cryo-EM imaging</title><p><italic>Mycoplasma pneumoniae</italic> sample preparation and cryo-EM imaging were carried out as described previously (<xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref>; <xref ref-type="bibr" rid="bib61">Tichelaar et al., 2020</xref>). In brief, <italic>M. pneumoniae</italic> cells were grown on Quantifoil gold grids in modified Hayflick medium and the grid was quickly washed with PBS buffer with 10 nm gold fiducial beads (Aurion, Germany) before plunge-freezing. The grids were imaged in a 300 keV Krios TEM (ThermoFisher) equipped with a direct detector (Gatan) and a quantum post-column energy filter (Gatan). Data collection was done using SerialEM (<xref ref-type="bibr" rid="bib36">Mastronarde, 2005</xref>).</p><p>For the 2D images paired with tilt series data, 19 cells were first imaged with parameters commonly used for single-particle cryo-EM, with a magnification of 215,000 (pixel size 0.65 Å), exposure time of 2 s (20 frames, total exposure 32 e<sup>-</sup>/Å<sup>2</sup>), and a target defocus between 0.2 μm and 0.5 μm. Tilt series were collected using the dose-symmetric scheme (<xref ref-type="bibr" rid="bib27">Hagen et al., 2017</xref>) with the following settings: magnification 81,000 (pixel size 1.7 Å), tilt range −60° to 60° with 3° increment, 1 s exposure per tilt, and a total exposure of ~129 e<sup>-</sup>/Å<sup>2</sup>. The target defocus remained the same within tilt series, and ranged from 1.5 μm to 3.5 µm between tilt series.</p><p>A dataset of 220 2D images of <italic>M. pneumoniae</italic> was collected on a K3 camera (Gatan) and at a magnification of 81,000 (pixel size 1.053 Å). The K3 camera was run in non-CDS mode with the following settings: exposure time 1.678 s, 24 frames, total exposure ~31 e<sup>-</sup>/Å<sup>2</sup>.</p></sec><sec id="s4-2"><title>2D template generation</title><p>To generate templates for 2DTM, we used the computer program <italic>pdb2mrc</italic> (<xref ref-type="bibr" rid="bib59">Tang et al., 2007</xref>) to convert PDB-formatted atomic coordinates into 3D density. To reduce potential aliasing, we initially generated an over-sampled density map at half the pixel size of the image to be searched. The sampling rate was then halved to the final pixel size by Fourier cropping using the program <italic>resample</italic> from the <italic>cis</italic>TEM software package (<xref ref-type="bibr" rid="bib19">Grant et al., 2018</xref>). The resulting 3D density was low-pass filtered with the standalone program <italic>bfactor</italic> (<xref ref-type="bibr" rid="bib22">Grigorieff, 2021b</xref>) using a B-factor of 85 Å<sup>2</sup> and placed into a 256 × 256×256 voxel box, about twice the size of the 50S ribosomal subunit it contained. The final pixel size for searching the 19-image dataset of <italic>M. pneumoniae</italic> that was compared with tomograms was 1.27 Å. For computational efficiency, we used a final pixel size of 1.5 Å to search the 220-image dataset. As template models, we used the <italic>M. pneumoniae</italic> ribosome (PDB: 7OOC and 7OOD) and the <italic>B. subtilis</italic> ribosome (PDB: 3J9W). We separated the small and large ribosomal subunits and, for the <italic>B. subtilis</italic> ribosome, removed the mRNA, tRNAs and MifM protein from the coordinate file using custom Perl scripts. The resulting coordinates were aligned with <italic>USCF Chimera</italic> (<xref ref-type="bibr" rid="bib42">Pettersen et al., 2004</xref>) to the 50S template used for 3DTM to place them in a common coordinate system. This ensured that the 3D positions and Euler angles found by 2DTM and 3DTM referred to the same coordinate system and could be directly compared. For local 30S searches, the atomic coordinates corresponding to the body of the <italic>M. pneumoniae</italic> 30S were used to generate a template as described above. For this we combined the results of searches with two templates, one with the proteins and rRNA sequence corresponding to the 30S head and one without, to account for the greater conformational variability of the small subunit relative to the large subunit.</p></sec><sec id="s4-3"><title>2D template matching in <italic>cis</italic>TEM</title><p>Movie frames were aligned with <italic>unblur</italic> using the ‘optimal exposure filter’ (<xref ref-type="bibr" rid="bib20">Grant and Grigorieff, 2015</xref>) and including all frames in the final sum, unless otherwise indicated. Defocus was determined by <italic>CTFFIND4</italic> (<xref ref-type="bibr" rid="bib47">Rohou and Grigorieff, 2015</xref>) from within the <italic>cis</italic>TEM GUI (<xref ref-type="bibr" rid="bib19">Grant et al., 2018</xref>). Templates for 2DTM were imported into <italic>cis</italic>TEM as 3D volumes and 2DTM was performed on all images, including a defocus search over a 2400 Å range centered on the average defocus determined by <italic>CTFFIND4</italic> with a 200 Å step, using a 2.5° out-of-plane angular search step and a 1.5° in-plane angular search step, assuming C1 symmetry and a minimum target - target distance (peak radius) of 10 pixels (~13 Å). As previously described, the SNR values resulting from 2DTM were further normalized by subtracting the mean of the SNR values for all orientations at each location, and dividing by their standard deviation (<xref ref-type="bibr" rid="bib45">Rickgauer et al., 2020</xref>; <xref ref-type="bibr" rid="bib44">Rickgauer et al., 2017</xref>). The best peak radius to use in a search depends on the B-factor affecting the signal in the images and may, therefore, vary for different experiments.</p></sec><sec id="s4-4"><title>Detection of 30S by local search using 50S 2DTM coordinates</title><p>To detect 30S subunits bound to 50S subunits, we wrote <italic>refine_template</italic>, a computer program that is accessible through <italic>cis</italic>TEM’s GUI, or as a command line tool. <italic>refine_template</italic> reads the 3D template and the output files of a template search, including the MIP and alignment parameters for detected targets. Using these data, it calculates template projections and performs a local refinement of the projection parameters. This refinement can be used, for example, to find the defocus values that maximize the cross-correlation coefficient between projection and image. It can also be used to detect molecules and complexes bound to already detected targets. In this case, <italic>refine_template</italic> is used with the search results obtained for the detected targets, but with the bound complex to be detected as the input template. The locally refined alignment parameters found for the bound complex will be close to those found for the original template, provided both the original template used in the search and the bound complex in the refinement share the same coordinate system.</p><p>To ensure the coordinate systems of the <italic>M. pneumoniae</italic> 30S and 50S subunits were aligned, the coordinates for the 30S and 50S subunits were separated from the 70S into two coordinate files and used to generate 3D templates for 2DTM for each of them (see above). For this last step, it was important not to use the <italic>-center</italic> flag of <italic>pdb2mrc</italic> to make sure the 3D densities remained in their correct locations relative to the other subunit. 50S targets were then detected using the 50S template, followed by local refinement with <italic>refine_template</italic> and the 30S template. For the refinement, we searched within an angular range of ±12.5° using a 2.5° step. A 30S subunit was deemed to be present when the refined x,y coordinates were within 20 Å of the original coordinates found for the 50S template.</p></sec><sec id="s4-5"><title>3D reconstruction using 50S 2DTM coordinates</title><p>We wrote a new computer program called <italic>prepare_stack_matchtemplate</italic>, as part of the <italic>cis</italic>TEM image processing package. It reads the results of a template search, including the MIP with the peaks indicating detected targets, as well as the Euler angles of the detected targets, the original image that was searched, and other imaging parameters (defocus, amplitude contrast, lens aberrations, beam energy, and pixel size). On output, it generates a stack of boxed-out targets and a list of alignment parameters that can be used for 3D reconstruction with <italic>cis</italic>TEM. Using <italic>prepare_stack_matchtemplate</italic> and <italic>cis</italic>TEM, we generated a reconstructions from 5080 and 1172 50S targets detected in 220 images of <italic>M. pneumoniae</italic> cells, using the Euler angles and x,y locations assigned by the <italic>M. pneumoniae</italic> and <italic>B. subtilis</italic> 50S template search, respectively. The reconstructions had nominal resolutions of 4.3 Å and 5.5 Å, respectively (FSC threshold of 0.143, <xref ref-type="bibr" rid="bib48">Rosenthal and Henderson, 2003</xref>; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1e</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1b</xref>). The masked FSC curves between the <italic>M. pneumoniae</italic> 30S structure and the 3D reconstructions from targets found with the <italic>M. pneumoniae</italic> and <italic>B. subtilis</italic> 50S templates revealed interpretable information out to 15 Å and 20 Å resolution, respectively (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1d</xref>). We therefore low-pass filtered the reconstructions to the common 20 Å resolution.</p></sec><sec id="s4-6"><title>3D template matching</title><p>For tilt series data, movie frames were aligned on-the-fly using the SerialEM plug-in <italic>alignframes</italic>. Tilt series alignment was carried out in IMOD (<xref ref-type="bibr" rid="bib37">Mastronarde and Held, 2017</xref>). Warp was used to estimate CTF, import tilt series alignments from IMOD, reconstruct tomograms and subtomograms (<xref ref-type="bibr" rid="bib60">Tegunov et al., 2021</xref>). Cell thickness was estimated based on central y,z sections of the tomograms.</p><p>We used PyTom to perform 3DTM of tomograms as described previously (<xref ref-type="bibr" rid="bib31">Hrabe et al., 2012</xref>; <xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref>), binning the tomograms to a pixel size of 6.8 Å and using an angular sampling step of 19.95°. The 50S ribosome template was generated from a previous 50S class average from <italic>M. pneumoniae</italic> (<xref ref-type="bibr" rid="bib40">O'Reilly et al., 2020</xref>). The density was low-pass filtered to 30 Å resolution prior to template matching in PyTom. 3DTM hits were extracted from the scores map generated by PyTom and were ranked by cross-correlation scores for each tomogram. Subtomograms for the top 600 hits in each tomogram were reconstructed using Warp. 3D classification and refinement were done in <italic>RELION</italic> 3.0.8 (<xref ref-type="bibr" rid="bib68">Zivanov et al., 2018</xref>). In total, 3062 70S and 6336 50S subtomograms were classified, after removing 1827 false positives, that is, particles that could not be aligned (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p></sec><sec id="s4-7"><title>Comparison of 2DTM and 3DTM</title><p>To compare targets found by 2DTM and 3DTM, we wrote a new computer program, <italic>align_coordinates</italic>, as part of <italic>cis</italic>TEM (<xref ref-type="bibr" rid="bib19">Grant et al., 2018</xref>), to identify and align target coordinates. <italic>align_coordinates</italic> assumes that the z axes of the coordinate systems of the 2DTM and 3DTM searches are aligned, that is, they refer to the same sample tilt. Therefore, to find the angular alignment and x,y offset between a set of reference coordinates and a second set of sample coordinates, only the x,y coordinates need to be considered. In a first step, <italic>align_coordinates</italic> calculates all possible vectors between any two x,y coordinates in a coordinate set. A rotation matrix is applied to the sample coordinate vectors, and the vector with the smallest vector difference within a given tolerance is found with respect to each reference vector. The algorithm performs a systematic search of the rotation angle in 0.5° steps to find the rotation that produces the largest number of matching vectors while giving a higher weight to better matching vectors. The result of this systematic search is a rough rotation angle and a list of corresponding coordinates that define a coordinate transform. The search also identifies coordinates in each set that do not have corresponding coordinates in the other set. The coordinate transform is then refined, and the list of corresponding coordinates is updated using a finer local search with angular step of 0.01° and 1 Å steps along the x and y axes. The best coordinate transform is selected based on a least-squares fit between the corresponding coordinates.</p><p>In the comparison of 2DTM and 3DTM coordinates, the latter were used as a reference set, and the distance threshold for correspondence was set to 110 Å. The final list of corresponding targets was further reduced by limiting distances to 100 Å and below. By providing the dimensions of the field of view of the images used for 2DTM, it was also possible to identify the corresponding area within the larger field of view of tomograms analyzed by 3DTM. For the calculation of percentages of corresponding targets identified by each search, only targets in the overlapping areas were counted.</p><p>To compare the angular orientations for a given coordinate pair, the 2DTM template was first aligned relative to the 3DTM template (see above), and the Euler angles of the detected targets were recorded. The total angular distance between each orientation, represented by the rotation matrices <inline-formula><mml:math id="inf1"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf2"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, given by the Euler angles, was calculated using the equation (<xref ref-type="bibr" rid="bib32">Huynh, 2009</xref>)<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:msub><mml:mrow><mml:mo>∆</mml:mo><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mn>2,3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi/><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We are grateful to Wim Hagen for advice on cryo-EM data acquisition, and Peter Rickgauer for providing numerous fruitful discussions and advice on implementing template matching in <italic>cis</italic>TEM. JM acknowledges support from the EMBL and the European Research Council (760067).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Data curation, Formal analysis, Validation, Visualization, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Software, Visualization, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Resources, Supervision, Funding acquisition, Validation, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-68946-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All the code used for the 2D template matching has an open source license and is freely available from the cisTEM github repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/timothygrant80/cisTEM">https://github.com/timothygrant80/cisTEM</ext-link>. A snapshot of the code used for this study is available on Zenodo, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.4603401">https://doi.org/10.5281/zenodo.4603401</ext-link>. The images of M. pneumoniae analyzed for this work, as well as the 70S reconstructions have been deposited in the EMPIAR and EMDB databases, <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/">https://www.ebi.ac.uk/pdbe/emdb/empiar/</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb">https://www.ebi.ac.uk/pdbe/emdb</ext-link>.</p><p>The following datasets were generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Lucas</surname><given-names>BA</given-names></name><name><surname>Himes</surname><given-names>BA</given-names></name><name><surname>Xue</surname><given-names>L</given-names></name><name><surname>Grant</surname><given-names>T</given-names></name><name><surname>Mahamid</surname><given-names>J</given-names></name><name><surname>Grigorieff</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>3D reconstruction generated using the locations and orientations of 1172 50S subunits detected in 220 image</data-title><source>Electron Microscopy Data Bank</source><pub-id assigning-authority="EBI" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/pdbe/entry/emdb/EMD-23772">EMD-23772</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Lucas</surname><given-names>BA</given-names></name><name><surname>Himes</surname><given-names>BA</given-names></name><name><surname>Xue</surname><given-names>L</given-names></name><name><surname>Grant</surname><given-names>T</given-names></name><name><surname>Mahamid</surname><given-names>J</given-names></name><name><surname>Grigorieff</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>3D reconstruction generated using the locations and orientations of 5080 50S subunits detected in 220 image</data-title><source>Electron Microscopy Data Bank</source><pub-id assigning-authority="EBI" pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/pdbe/entry/emdb/EMD-23771">EMD-23771</pub-id></element-citation></p><p><element-citation id="dataset3" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Lucas</surname><given-names>BA</given-names></name><name><surname>Himes</surname><given-names>BA</given-names></name><name><surname>Xue</surname><given-names>L</given-names></name><name><surname>Grant</surname><given-names>T</given-names></name><name><surname>Mahamid</surname><given-names>J</given-names></name><name><surname>Grigorieff</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Locating Macromolecular Assemblies in Cells by 2D Template Matching with cisTEM</data-title><source>EMPIAR</source><pub-id assigning-authority="EBI" pub-id-type="doi">10.6019/EMPIAR-10731</pub-id></element-citation></p><p><element-citation id="dataset4" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Lucas</surname><given-names>BA</given-names></name><name><surname>Himes</surname><given-names>BA</given-names></name><name><surname>Xue</surname><given-names>L</given-names></name><name><surname>Grant</surname><given-names>T</given-names></name><name><surname>Mahamid</surname><given-names>J</given-names></name><name><surname>Grigorieff</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Locating Macromolecular Assemblies in Cells by 2D Template Matching with cisTEM</data-title><source>EMPIAR</source><pub-id assigning-authority="EBI" pub-id-type="doi">10.6019/EMPIAR-10727</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albert</surname> <given-names>S</given-names></name><name><surname>Schaffer</surname> <given-names>M</given-names></name><name><surname>Beck</surname> <given-names>F</given-names></name><name><surname>Mosalaganti</surname> <given-names>S</given-names></name><name><surname>Asano</surname> <given-names>S</given-names></name><name><surname>Thomas</surname> <given-names>HF</given-names></name><name><surname>Plitzko</surname> <given-names>JM</given-names></name><name><surname>Beck</surname> <given-names>M</given-names></name><name><surname>Baumeister</surname> <given-names>W</given-names></name><name><surname>Engel</surname> <given-names>BD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Proteasomes tether to two distinct sites at the nuclear pore complex</article-title><source>PNAS</source><volume>114</volume><fpage>13726</fpage><lpage>13731</lpage><pub-id pub-id-type="doi">10.1073/pnas.1716305114</pub-id><pub-id pub-id-type="pmid">29229809</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alberts</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>The cell as a collection of protein machines: preparing the next generation of molecular biologists</article-title><source>Cell</source><volume>92</volume><fpage>291</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(00)80922-8</pub-id><pub-id pub-id-type="pmid">9476889</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartesaghi</surname> <given-names>A</given-names></name><name><surname>Sprechmann</surname> <given-names>P</given-names></name><name><surname>Liu</surname> <given-names>J</given-names></name><name><surname>Randall</surname> <given-names>G</given-names></name><name><surname>Sapiro</surname> <given-names>G</given-names></name><name><surname>Subramaniam</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Classification and 3D averaging with missing wedge correction in biological electron tomography</article-title><source>Journal of structural biology</source><volume>162</volume><fpage>436</fpage><lpage>450</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2008.02.008</pub-id><pub-id pub-id-type="pmid">18440828</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartesaghi</surname> <given-names>A</given-names></name><name><surname>Lecumberry</surname> <given-names>F</given-names></name><name><surname>Sapiro</surname> <given-names>G</given-names></name><name><surname>Subramaniam</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Protein secondary structure determination by constrained single-particle cryo-electron tomography</article-title><source>Structure</source><volume>20</volume><fpage>2003</fpage><lpage>2013</lpage><pub-id pub-id-type="doi">10.1016/j.str.2012.10.016</pub-id><pub-id pub-id-type="pmid">23217682</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beck</surname> <given-names>M</given-names></name><name><surname>Baumeister</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cryo-Electron Tomography: Can it Reveal the Molecular Sociology of Cells in Atomic Detail?</article-title><source>Trends in cell biology</source><volume>26</volume><fpage>825</fpage><lpage>837</lpage><pub-id pub-id-type="doi">10.1016/j.tcb.2016.08.006</pub-id><pub-id pub-id-type="pmid">27671779</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname> <given-names>HM</given-names></name><name><surname>Battistuz</surname> <given-names>T</given-names></name><name><surname>Bhat</surname> <given-names>TN</given-names></name><name><surname>Bluhm</surname> <given-names>WF</given-names></name><name><surname>Bourne</surname> <given-names>PE</given-names></name><name><surname>Burkhardt</surname> <given-names>K</given-names></name><name><surname>Feng</surname> <given-names>Z</given-names></name><name><surname>Gilliland</surname> <given-names>GL</given-names></name><name><surname>Iype</surname> <given-names>L</given-names></name><name><surname>Jain</surname> <given-names>S</given-names></name><name><surname>Fagan</surname> <given-names>P</given-names></name><name><surname>Marvin</surname> <given-names>J</given-names></name><name><surname>Padilla</surname> <given-names>D</given-names></name><name><surname>Ravichandran</surname> <given-names>V</given-names></name><name><surname>Schneider</surname> <given-names>B</given-names></name><name><surname>Thanki</surname> <given-names>N</given-names></name><name><surname>Weissig</surname> <given-names>H</given-names></name><name><surname>Westbrook</surname> <given-names>JD</given-names></name><name><surname>Zardecki</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The protein data bank</article-title><source>Acta Crystallographica Section D Biological Crystallography</source><volume>58</volume><fpage>899</fpage><lpage>907</lpage><pub-id pub-id-type="doi">10.1107/S0907444902003451</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bharat</surname> <given-names>TA</given-names></name><name><surname>Scheres</surname> <given-names>SH</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Resolving macromolecular structures from electron cryo-tomography data using subtomogram averaging in RELION</article-title><source>Nature Protocols</source><volume>11</volume><fpage>2054</fpage><lpage>2065</lpage><pub-id pub-id-type="doi">10.1038/nprot.2016.124</pub-id><pub-id pub-id-type="pmid">27685097</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Braunger</surname> <given-names>K</given-names></name><name><surname>Pfeffer</surname> <given-names>S</given-names></name><name><surname>Shrimal</surname> <given-names>S</given-names></name><name><surname>Gilmore</surname> <given-names>R</given-names></name><name><surname>Berninghausen</surname> <given-names>O</given-names></name><name><surname>Mandon</surname> <given-names>EC</given-names></name><name><surname>Becker</surname> <given-names>T</given-names></name><name><surname>Förster</surname> <given-names>F</given-names></name><name><surname>Beckmann</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Structural basis for coupling protein transport and N-glycosylation at the mammalian endoplasmic reticulum</article-title><source>Science</source><volume>360</volume><fpage>215</fpage><lpage>219</lpage><pub-id pub-id-type="doi">10.1126/science.aar7899</pub-id><pub-id pub-id-type="pmid">29519914</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brilot</surname> <given-names>AF</given-names></name><name><surname>Chen</surname> <given-names>JZ</given-names></name><name><surname>Cheng</surname> <given-names>A</given-names></name><name><surname>Pan</surname> <given-names>J</given-names></name><name><surname>Harrison</surname> <given-names>SC</given-names></name><name><surname>Potter</surname> <given-names>CS</given-names></name><name><surname>Carragher</surname> <given-names>B</given-names></name><name><surname>Henderson</surname> <given-names>R</given-names></name><name><surname>Grigorieff</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Beam-induced motion of vitrified specimen on holey carbon film</article-title><source>Journal of structural biology</source><volume>177</volume><fpage>630</fpage><lpage>637</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2012.02.003</pub-id><pub-id pub-id-type="pmid">22366277</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Buchholz</surname> <given-names>TO</given-names></name><name><surname>Jordan</surname> <given-names>M</given-names></name><name><surname>Pigino</surname> <given-names>G</given-names></name><name><surname>Jug</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Cryo-CARE: content-aware image restoration for cryo-transmission electron microscopy data</article-title><conf-name>Proc Int Symp Biomed Imaging</conf-name><fpage>502</fpage><lpage>506</lpage><pub-id pub-id-type="doi">10.1109/ISBI.2019.8759519</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danev</surname> <given-names>R</given-names></name><name><surname>Tegunov</surname> <given-names>D</given-names></name><name><surname>Baumeister</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Using the volta phase plate with defocus for cryo-EM single particle analysis</article-title><source>eLife</source><volume>6</volume><elocation-id>e23006</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.23006</pub-id><pub-id pub-id-type="pmid">28109158</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diaconu</surname> <given-names>M</given-names></name><name><surname>Kothe</surname> <given-names>U</given-names></name><name><surname>Schlünzen</surname> <given-names>F</given-names></name><name><surname>Fischer</surname> <given-names>N</given-names></name><name><surname>Harms</surname> <given-names>JM</given-names></name><name><surname>Tonevitsky</surname> <given-names>AG</given-names></name><name><surname>Stark</surname> <given-names>H</given-names></name><name><surname>Rodnina</surname> <given-names>MV</given-names></name><name><surname>Wahl</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Structural basis for the function of the ribosomal L7/12 stalk in factor binding and GTPase activation</article-title><source>Cell</source><volume>121</volume><fpage>991</fpage><lpage>1004</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2005.04.015</pub-id><pub-id pub-id-type="pmid">15989950</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eibauer</surname> <given-names>M</given-names></name><name><surname>Hoffmann</surname> <given-names>C</given-names></name><name><surname>Plitzko</surname> <given-names>JM</given-names></name><name><surname>Baumeister</surname> <given-names>W</given-names></name><name><surname>Nickell</surname> <given-names>S</given-names></name><name><surname>Engelhardt</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Unraveling the structure of membrane proteins in situ by transfer function corrected cryo-electron tomography</article-title><source>Journal of Structural Biology</source><volume>180</volume><fpage>488</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2012.09.008</pub-id><pub-id pub-id-type="pmid">23000705</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fernandez</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Computational methods for electron tomography</article-title><source>Micron</source><volume>43</volume><fpage>1010</fpage><lpage>1030</lpage><pub-id pub-id-type="doi">10.1016/j.micron.2012.05.003</pub-id><pub-id pub-id-type="pmid">22658288</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Förster</surname> <given-names>F</given-names></name><name><surname>Pruggnaller</surname> <given-names>S</given-names></name><name><surname>Seybert</surname> <given-names>A</given-names></name><name><surname>Frangakis</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Classification of cryo-electron sub-tomograms using constrained correlation</article-title><source>Journal of Structural Biology</source><volume>161</volume><fpage>276</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2007.07.006</pub-id><pub-id pub-id-type="pmid">17720536</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frangakis</surname> <given-names>AS</given-names></name><name><surname>Böhm</surname> <given-names>J</given-names></name><name><surname>Förster</surname> <given-names>F</given-names></name><name><surname>Nickell</surname> <given-names>S</given-names></name><name><surname>Nicastro</surname> <given-names>D</given-names></name><name><surname>Typke</surname> <given-names>D</given-names></name><name><surname>Hegerl</surname> <given-names>R</given-names></name><name><surname>Baumeister</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Identification of macromolecular complexes in cryoelectron tomograms of phantom cells</article-title><source>PNAS</source><volume>99</volume><fpage>14153</fpage><lpage>14158</lpage><pub-id pub-id-type="doi">10.1073/pnas.172520299</pub-id><pub-id pub-id-type="pmid">12391313</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Frank</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Electron Tomography: Methods for Three-Dimensional Visualization of Structures in the Cell</source><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/978-0-387-69008-7</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname> <given-names>X</given-names></name><name><surname>Himes</surname> <given-names>BA</given-names></name><name><surname>Ke</surname> <given-names>D</given-names></name><name><surname>Rice</surname> <given-names>WJ</given-names></name><name><surname>Ning</surname> <given-names>J</given-names></name><name><surname>Zhang</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Controlled bacterial lysis for electron tomography of native cell membranes</article-title><source>Structure</source><volume>22</volume><fpage>1875</fpage><lpage>1882</lpage><pub-id pub-id-type="doi">10.1016/j.str.2014.09.017</pub-id><pub-id pub-id-type="pmid">25456413</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname> <given-names>T</given-names></name><name><surname>Rohou</surname> <given-names>A</given-names></name><name><surname>Grigorieff</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title><italic>cis</italic>TEM, user-friendly software for single-particle image processing</article-title><source>eLife</source><volume>7</volume><elocation-id>e35383</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.35383</pub-id><pub-id pub-id-type="pmid">29513216</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname> <given-names>T</given-names></name><name><surname>Grigorieff</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Measuring the optimal exposure for single particle cryo-EM using a 2.6 Å reconstruction of rotavirus VP6</article-title><source>eLife</source><volume>4</volume><elocation-id>e06980</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06980</pub-id><pub-id pub-id-type="pmid">26023829</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Grigorieff</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021a</year><data-title>diffmap.exe</data-title><source>Grigoriefflab</source><version designator="3">3</version><ext-link ext-link-type="uri" xlink:href="https://grigoriefflab.umassmed.edu/diffmap">https://grigoriefflab.umassmed.edu/diffmap</ext-link></element-citation></ref><ref id="bib22"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Grigorieff</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021b</year><data-title>bfactor.exe</data-title><source>Grigoriefflab</source><version designator="3">3</version><ext-link ext-link-type="uri" xlink:href="https://grigoriefflab.umassmed.edu/bfactor">https://grigoriefflab.umassmed.edu/bfactor</ext-link></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grosjean</surname> <given-names>H</given-names></name><name><surname>Breton</surname> <given-names>M</given-names></name><name><surname>Sirand-Pugnet</surname> <given-names>P</given-names></name><name><surname>Tardy</surname> <given-names>F</given-names></name><name><surname>Thiaucourt</surname> <given-names>F</given-names></name><name><surname>Citti</surname> <given-names>C</given-names></name><name><surname>Barré</surname> <given-names>A</given-names></name><name><surname>Yoshizawa</surname> <given-names>S</given-names></name><name><surname>Fourmy</surname> <given-names>D</given-names></name><name><surname>de Crécy-Lagard</surname> <given-names>V</given-names></name><name><surname>Blanchard</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Predicting the minimal translation apparatus: lessons from the reductive evolution of mollicutes</article-title><source>PLOS Genetics</source><volume>10</volume><elocation-id>e1004363</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004363</pub-id><pub-id pub-id-type="pmid">24809820</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grünewald</surname> <given-names>K</given-names></name><name><surname>Medalia</surname> <given-names>O</given-names></name><name><surname>Gross</surname> <given-names>A</given-names></name><name><surname>Steven</surname> <given-names>AC</given-names></name><name><surname>Baumeister</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Prospects of electron cryotomography to visualize macromolecular complexes inside cellular compartments: implications of crowding</article-title><source>Biophysical Chemistry</source><volume>100</volume><fpage>577</fpage><lpage>591</lpage><pub-id pub-id-type="doi">10.1016/S0301-4622(02)00307-1</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gubins</surname> <given-names>I</given-names></name><name><surname>Der</surname> <given-names>SGV</given-names></name><name><surname>Veltkamp</surname> <given-names>RC</given-names></name><name><surname>Förster</surname> <given-names>F</given-names></name><name><surname>Du</surname> <given-names>X</given-names></name><name><surname>Zeng</surname> <given-names>X</given-names></name><name><surname>Zhu</surname> <given-names>Z</given-names></name><name><surname>Chang</surname> <given-names>L</given-names></name><name><surname>Xu</surname> <given-names>M</given-names></name><name><surname>Moebel</surname> <given-names>E</given-names></name><name><surname>Lai</surname> <given-names>TM</given-names></name><name><surname>Han</surname> <given-names>X</given-names></name><name><surname>Terashi</surname> <given-names>G</given-names></name><name><surname>Kihara</surname> <given-names>D</given-names></name><name><surname>Himes</surname> <given-names>BA</given-names></name><name><surname>Wan</surname> <given-names>X</given-names></name><name><surname>Zhang</surname> <given-names>J</given-names></name><name><surname>Gao</surname> <given-names>S</given-names></name><name><surname>Hao</surname> <given-names>Y</given-names></name><name><surname>Lv</surname> <given-names>Z</given-names></name><name><surname>Yang</surname> <given-names>Z</given-names></name><name><surname>Ding</surname> <given-names>Z</given-names></name><name><surname>Cui</surname> <given-names>X</given-names></name><name><surname>Zhang</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>SHREC’ 19 Track : Classification in Cryo-Electron Tomograms</article-title><source>Eurographics Work 3D Object Retr</source><volume>10</volume><fpage>1</fpage><lpage>6</lpage></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname> <given-names>Q</given-names></name><name><surname>Lehmer</surname> <given-names>C</given-names></name><name><surname>Martínez-Sánchez</surname> <given-names>A</given-names></name><name><surname>Rudack</surname> <given-names>T</given-names></name><name><surname>Beck</surname> <given-names>F</given-names></name><name><surname>Hartmann</surname> <given-names>H</given-names></name><name><surname>Pérez-Berlanga</surname> <given-names>M</given-names></name><name><surname>Frottin</surname> <given-names>F</given-names></name><name><surname>Hipp</surname> <given-names>MS</given-names></name><name><surname>Hartl</surname> <given-names>FU</given-names></name><name><surname>Edbauer</surname> <given-names>D</given-names></name><name><surname>Baumeister</surname> <given-names>W</given-names></name><name><surname>Fernández-Busnadiego</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>In situ structure of neuronal C9orf72 Poly-GA aggregates reveals proteasome recruitment</article-title><source>Cell</source><volume>172</volume><fpage>696</fpage><lpage>705</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.12.030</pub-id><pub-id pub-id-type="pmid">29398115</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hagen</surname> <given-names>WJH</given-names></name><name><surname>Wan</surname> <given-names>W</given-names></name><name><surname>Briggs</surname> <given-names>JAG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Implementation of a cryo-electron tomography tilt-scheme optimized for high resolution subtomogram averaging</article-title><source>Journal of Structural Biology</source><volume>197</volume><fpage>191</fpage><lpage>198</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2016.06.007</pub-id><pub-id pub-id-type="pmid">27313000</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henderson</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Avoiding the pitfalls of single particle cryo-electron microscopy: einstein from noise</article-title><source>PNAS</source><volume>110</volume><fpage>18037</fpage><lpage>18041</lpage><pub-id pub-id-type="doi">10.1073/pnas.1314449110</pub-id><pub-id pub-id-type="pmid">24106306</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Himes</surname> <given-names>BA</given-names></name><name><surname>Grigorieff</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Cryo-TEM simulations of amorphous radiation-sensitive samples using multislice wave propagation</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.02.19.431636</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Himes</surname> <given-names>BA</given-names></name><name><surname>Zhang</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>emClarity: software for high-resolution cryo-electron tomography and subtomogram averaging</article-title><source>Nature Methods</source><volume>15</volume><fpage>955</fpage><lpage>961</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0167-z</pub-id><pub-id pub-id-type="pmid">30349041</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hrabe</surname> <given-names>T</given-names></name><name><surname>Chen</surname> <given-names>Y</given-names></name><name><surname>Pfeffer</surname> <given-names>S</given-names></name><name><surname>Cuellar</surname> <given-names>LK</given-names></name><name><surname>Mangold</surname> <given-names>AV</given-names></name><name><surname>Förster</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>PyTom: a python-based toolbox for localization of macromolecules in cryo-electron tomograms and subtomogram analysis</article-title><source>Journal of Structural Biology</source><volume>178</volume><fpage>177</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2011.12.003</pub-id><pub-id pub-id-type="pmid">22193517</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huynh</surname> <given-names>DQ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Metrics for 3D rotations: comparison and analysis</article-title><source>Journal of Mathematical Imaging and Vision</source><volume>35</volume><fpage>155</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1007/s10851-009-0161-2</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kühner</surname> <given-names>S</given-names></name><name><surname>van Noort</surname> <given-names>V</given-names></name><name><surname>Betts</surname> <given-names>MJ</given-names></name><name><surname>Leo-Macias</surname> <given-names>A</given-names></name><name><surname>Batisse</surname> <given-names>C</given-names></name><name><surname>Rode</surname> <given-names>M</given-names></name><name><surname>Yamada</surname> <given-names>T</given-names></name><name><surname>Maier</surname> <given-names>T</given-names></name><name><surname>Bader</surname> <given-names>S</given-names></name><name><surname>Beltran-Alvarez</surname> <given-names>P</given-names></name><name><surname>Castaño-Diez</surname> <given-names>D</given-names></name><name><surname>Chen</surname> <given-names>WH</given-names></name><name><surname>Devos</surname> <given-names>D</given-names></name><name><surname>Güell</surname> <given-names>M</given-names></name><name><surname>Norambuena</surname> <given-names>T</given-names></name><name><surname>Racke</surname> <given-names>I</given-names></name><name><surname>Rybin</surname> <given-names>V</given-names></name><name><surname>Schmidt</surname> <given-names>A</given-names></name><name><surname>Yus</surname> <given-names>E</given-names></name><name><surname>Aebersold</surname> <given-names>R</given-names></name><name><surname>Herrmann</surname> <given-names>R</given-names></name><name><surname>Böttcher</surname> <given-names>B</given-names></name><name><surname>Frangakis</surname> <given-names>AS</given-names></name><name><surname>Russell</surname> <given-names>RB</given-names></name><name><surname>Serrano</surname> <given-names>L</given-names></name><name><surname>Bork</surname> <given-names>P</given-names></name><name><surname>Gavin</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Proteome organization in a genome-reduced bacterium</article-title><source>Science</source><volume>326</volume><fpage>1235</fpage><lpage>1240</lpage><pub-id pub-id-type="doi">10.1126/science.1176343</pub-id><pub-id pub-id-type="pmid">19965468</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ling</surname> <given-names>C</given-names></name><name><surname>Ermolenko</surname> <given-names>DN</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Structural insights into ribosome translocation</article-title><source>Wiley Interdisciplinary Reviews: RNA</source><volume>7</volume><fpage>620</fpage><lpage>636</lpage><pub-id pub-id-type="doi">10.1002/wrna.1354</pub-id><pub-id pub-id-type="pmid">27117863</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marko</surname> <given-names>M</given-names></name><name><surname>Hsieh</surname> <given-names>C</given-names></name><name><surname>Schalek</surname> <given-names>R</given-names></name><name><surname>Frank</surname> <given-names>J</given-names></name><name><surname>Mannella</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Focused-ion-beam thinning of frozen-hydrated biological specimens for cryo-electron microscopy</article-title><source>Nature Methods</source><volume>4</volume><fpage>215</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1038/nmeth1014</pub-id><pub-id pub-id-type="pmid">17277781</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mastronarde</surname> <given-names>DN</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Automated electron microscope tomography using robust prediction of specimen movements</article-title><source>Journal of Structural Biology</source><volume>152</volume><fpage>36</fpage><lpage>51</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2005.07.007</pub-id><pub-id pub-id-type="pmid">16182563</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mastronarde</surname> <given-names>DN</given-names></name><name><surname>Held</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Automated tilt series alignment and tomographic reconstruction in IMOD</article-title><source>Journal of structural biology</source><volume>197</volume><fpage>102</fpage><lpage>113</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2016.07.011</pub-id><pub-id pub-id-type="pmid">27444392</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>McDonough</surname> <given-names>RN</given-names></name><name><surname>Whalen</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="1995">1995</year><source>Detection of Signals in Noise</source><edition>Second Edition</edition><publisher-loc>San Diego</publisher-loc><publisher-name>Academic Press</publisher-name></element-citation></ref><ref id="bib39"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Moebel</surname> <given-names>E</given-names></name><name><surname>Martinez-Sanchez</surname> <given-names>A</given-names></name><name><surname>Larivière</surname> <given-names>D</given-names></name><name><surname>Fourmentin</surname> <given-names>E</given-names></name><name><surname>Ortiz</surname> <given-names>J</given-names></name><name><surname>Baumeister</surname> <given-names>W</given-names></name><name><surname>Kervrann</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Deep learning improves macromolecules localization and identification in 3D cellular Cryo-Electron tomograms</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.04.15.042747</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Reilly</surname> <given-names>FJ</given-names></name><name><surname>Xue</surname> <given-names>L</given-names></name><name><surname>Graziadei</surname> <given-names>A</given-names></name><name><surname>Sinn</surname> <given-names>L</given-names></name><name><surname>Lenz</surname> <given-names>S</given-names></name><name><surname>Tegunov</surname> <given-names>D</given-names></name><name><surname>Blötz</surname> <given-names>C</given-names></name><name><surname>Singh</surname> <given-names>N</given-names></name><name><surname>Hagen</surname> <given-names>WJH</given-names></name><name><surname>Cramer</surname> <given-names>P</given-names></name><name><surname>Stülke</surname> <given-names>J</given-names></name><name><surname>Mahamid</surname> <given-names>J</given-names></name><name><surname>Rappsilber</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>In-cell architecture of an actively transcribing-translating expressome</article-title><source>Science</source><volume>369</volume><fpage>554</fpage><lpage>557</lpage><pub-id pub-id-type="doi">10.1126/science.abb3758</pub-id><pub-id pub-id-type="pmid">32732422</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oikonomou</surname> <given-names>CM</given-names></name><name><surname>Jensen</surname> <given-names>GJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Cellular electron cryotomography: toward structural biology in situ</article-title><source>Annual Review of Biochemistry</source><volume>86</volume><fpage>873</fpage><lpage>896</lpage><pub-id pub-id-type="doi">10.1146/annurev-biochem-061516-044741</pub-id><pub-id pub-id-type="pmid">28426242</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pettersen</surname> <given-names>EF</given-names></name><name><surname>Goddard</surname> <given-names>TD</given-names></name><name><surname>Huang</surname> <given-names>CC</given-names></name><name><surname>Couch</surname> <given-names>GS</given-names></name><name><surname>Greenblatt</surname> <given-names>DM</given-names></name><name><surname>Meng</surname> <given-names>EC</given-names></name><name><surname>Ferrin</surname> <given-names>TE</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>UCSF Chimera--a visualization system for exploratory research and analysis</article-title><source>Journal of computational chemistry</source><volume>25</volume><fpage>1605</fpage><lpage>1612</lpage><pub-id pub-id-type="doi">10.1002/jcc.20084</pub-id><pub-id pub-id-type="pmid">15264254</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeffer</surname> <given-names>S</given-names></name><name><surname>Mahamid</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Unravelling molecular complexity in structural cell biology</article-title><source>Current opinion in structural biology</source><volume>52</volume><fpage>111</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1016/j.sbi.2018.08.009</pub-id><pub-id pub-id-type="pmid">30339965</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rickgauer</surname> <given-names>JP</given-names></name><name><surname>Grigorieff</surname> <given-names>N</given-names></name><name><surname>Denk</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Single-protein detection in crowded molecular environments in cryo-EM images</article-title><source>eLife</source><volume>6</volume><elocation-id>e25648</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.25648</pub-id><pub-id pub-id-type="pmid">28467302</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Rickgauer</surname> <given-names>JP</given-names></name><name><surname>Choi</surname> <given-names>H</given-names></name><name><surname>Lippincott-Schwartz</surname> <given-names>J</given-names></name><name><surname>Denk</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Label-free single-instance protein detection in vitrified cells</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.04.22.053868</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rigort</surname> <given-names>A</given-names></name><name><surname>Bäuerlein</surname> <given-names>FJ</given-names></name><name><surname>Villa</surname> <given-names>E</given-names></name><name><surname>Eibauer</surname> <given-names>M</given-names></name><name><surname>Laugks</surname> <given-names>T</given-names></name><name><surname>Baumeister</surname> <given-names>W</given-names></name><name><surname>Plitzko</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Focused ion beam micromachining of eukaryotic cells for cryoelectron tomography</article-title><source>PNAS</source><volume>109</volume><fpage>4449</fpage><lpage>4454</lpage><pub-id pub-id-type="doi">10.1073/pnas.1201333109</pub-id><pub-id pub-id-type="pmid">22392984</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohou</surname> <given-names>A</given-names></name><name><surname>Grigorieff</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>CTFFIND4: fast and accurate defocus estimation from electron micrographs</article-title><source>Journal of Structural Biology</source><volume>192</volume><fpage>216</fpage><lpage>221</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2015.08.008</pub-id><pub-id pub-id-type="pmid">26278980</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenthal</surname> <given-names>PB</given-names></name><name><surname>Henderson</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Optimal determination of particle orientation, absolute hand, and contrast loss in single-particle electron cryomicroscopy</article-title><source>Journal of Molecular Biology</source><volume>333</volume><fpage>721</fpage><lpage>745</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2003.07.013</pub-id><pub-id pub-id-type="pmid">14568533</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanchez</surname> <given-names>RM</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Chen</surname> <given-names>W</given-names></name><name><surname>Dietrich</surname> <given-names>L</given-names></name><name><surname>Kudryashev</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Subnanometer-resolution structure determination in situ by hybrid subtomogram averaging - single particle cryo-EM</article-title><source>Nature Communications</source><volume>11</volume><fpage>1</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1038/s41467-020-17466-0</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheres</surname> <given-names>SH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Semi-automated selection of cryo-EM particles in RELION-1.3</article-title><source>Journal of Structural Biology</source><volume>189</volume><fpage>114</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2014.11.010</pub-id><pub-id pub-id-type="pmid">25486611</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheres</surname> <given-names>SH</given-names></name><name><surname>Chen</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Prevention of overfitting in cryo-EM structure determination</article-title><source>Nature Methods</source><volume>9</volume><fpage>853</fpage><lpage>854</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2115</pub-id><pub-id pub-id-type="pmid">22842542</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schur</surname> <given-names>FK</given-names></name><name><surname>Hagen</surname> <given-names>WJ</given-names></name><name><surname>de Marco</surname> <given-names>A</given-names></name><name><surname>Briggs</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Determination of protein structure at 8.5Å resolution using cryo-electron tomography and sub-tomogram averaging</article-title><source>Journal of Structural Biology</source><volume>184</volume><fpage>394</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2013.10.015</pub-id><pub-id pub-id-type="pmid">24184468</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sigworth</surname> <given-names>FJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Classical detection theory and the cryo-EM particle selection problem</article-title><source>Journal of Structural Biology</source><volume>145</volume><fpage>111</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2003.10.025</pub-id><pub-id pub-id-type="pmid">15065679</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sigworth</surname> <given-names>FJ</given-names></name><name><surname>Doerschuk</surname> <given-names>PC</given-names></name><name><surname>Carazo</surname> <given-names>JM</given-names></name><name><surname>Scheres</surname> <given-names>SH</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>An introduction to maximum-likelihood methods in cryo-EM</article-title><source>Methods in Enzymology</source><volume>482</volume><fpage>263</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1016/S0076-6879(10)82011-7</pub-id><pub-id pub-id-type="pmid">20888965</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sohmen</surname> <given-names>D</given-names></name><name><surname>Chiba</surname> <given-names>S</given-names></name><name><surname>Shimokawa-Chiba</surname> <given-names>N</given-names></name><name><surname>Innis</surname> <given-names>CA</given-names></name><name><surname>Berninghausen</surname> <given-names>O</given-names></name><name><surname>Beckmann</surname> <given-names>R</given-names></name><name><surname>Ito</surname> <given-names>K</given-names></name><name><surname>Wilson</surname> <given-names>DN</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Structure of the Bacillus subtilis 70S ribosome reveals the basis for species-specific stalling</article-title><source>Nature Communications</source><volume>6</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1038/ncomms7941</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stewart</surname> <given-names>A</given-names></name><name><surname>Grigorieff</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Noise Bias in the refinement of structures derived from single particles</article-title><source>Ultramicroscopy</source><volume>102</volume><fpage>67</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1016/j.ultramic.2004.08.008</pub-id><pub-id pub-id-type="pmid">15556702</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strunk</surname> <given-names>KM</given-names></name><name><surname>Wang</surname> <given-names>K</given-names></name><name><surname>Ke</surname> <given-names>D</given-names></name><name><surname>Gray</surname> <given-names>JL</given-names></name><name><surname>Zhang</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Thinning of large mammalian cells for cryo-TEM characterization by cryo-FIB milling</article-title><source>Journal of Microscopy</source><volume>247</volume><fpage>220</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2818.2012.03635.x</pub-id><pub-id pub-id-type="pmid">22906009</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramaniam</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Structure of trimeric HIV-1 envelope glycoproteins</article-title><source>PNAS</source><volume>110</volume><fpage>E4172</fpage><lpage>E4174</lpage><pub-id pub-id-type="doi">10.1073/pnas.1313802110</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname> <given-names>G</given-names></name><name><surname>Peng</surname> <given-names>L</given-names></name><name><surname>Baldwin</surname> <given-names>PR</given-names></name><name><surname>Mann</surname> <given-names>DS</given-names></name><name><surname>Jiang</surname> <given-names>W</given-names></name><name><surname>Rees</surname> <given-names>I</given-names></name><name><surname>Ludtke</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>EMAN2: an extensible image processing suite for electron microscopy</article-title><source>Journal of Structural Biology</source><volume>157</volume><fpage>38</fpage><lpage>46</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2006.05.009</pub-id><pub-id pub-id-type="pmid">16859925</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tegunov</surname> <given-names>D</given-names></name><name><surname>Xue</surname> <given-names>L</given-names></name><name><surname>Dienemann</surname> <given-names>C</given-names></name><name><surname>Cramer</surname> <given-names>P</given-names></name><name><surname>Mahamid</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Multi-particle cryo-EM refinement with M visualizes ribosome-antibiotic complex at 3.5 Å in cells</article-title><source>Nature Methods</source><volume>18</volume><fpage>186</fpage><lpage>193</lpage><pub-id pub-id-type="doi">10.1038/s41592-020-01054-7</pub-id><pub-id pub-id-type="pmid">33542511</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tichelaar</surname> <given-names>W</given-names></name><name><surname>Hagen</surname> <given-names>WJH</given-names></name><name><surname>Gorelik</surname> <given-names>TE</given-names></name><name><surname>Xue</surname> <given-names>L</given-names></name><name><surname>Mahamid</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>TEM bright field imaging of thick specimens: nodes in thon ring patterns</article-title><source>Ultramicroscopy</source><volume>216</volume><elocation-id>113023</elocation-id><pub-id pub-id-type="doi">10.1016/j.ultramic.2020.113023</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Heel</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Finding trimeric HIV-1 envelope glycoproteins in random noise</article-title><source>PNAS</source><volume>110</volume><fpage>E4175</fpage><lpage>E4177</lpage><pub-id pub-id-type="doi">10.1073/pnas.1314353110</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voortman</surname> <given-names>LM</given-names></name><name><surname>Vulović</surname> <given-names>M</given-names></name><name><surname>Maletta</surname> <given-names>M</given-names></name><name><surname>Voigt</surname> <given-names>A</given-names></name><name><surname>Franken</surname> <given-names>EM</given-names></name><name><surname>Simonetti</surname> <given-names>A</given-names></name><name><surname>Peters</surname> <given-names>PJ</given-names></name><name><surname>van Vliet</surname> <given-names>LJ</given-names></name><name><surname>Rieger</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Quantifying resolution limiting factors in subtomogram averaged cryo-electron tomography using simulations</article-title><source>Journal of structural biology</source><volume>187</volume><fpage>103</fpage><lpage>111</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2014.06.007</pub-id><pub-id pub-id-type="pmid">24998892</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wan</surname> <given-names>W</given-names></name><name><surname>Briggs</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cryo-Electron tomography and subtomogram averaging</article-title><source>Methods in Enzymology</source><volume>579</volume><fpage>329</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1016/bs.mie.2016.04.014</pub-id><pub-id pub-id-type="pmid">27572733</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winkler</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>3d reconstruction and processing of volumetric data in cryo-electron tomography</article-title><source>Journal of Structural Biology</source><volume>157</volume><fpage>126</fpage><lpage>137</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2006.07.014</pub-id><pub-id pub-id-type="pmid">16973379</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname> <given-names>M</given-names></name><name><surname>Beck</surname> <given-names>M</given-names></name><name><surname>Alber</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>High-throughput subtomogram alignment and classification by fourier space constrained fast volumetric matching</article-title><source>Journal of Structural Biology</source><volume>178</volume><fpage>152</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2012.02.014</pub-id><pub-id pub-id-type="pmid">22420977</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Advances in cryo-electron tomography and subtomogram averaging and classification</article-title><source>Current Opinion in Structural Biology</source><volume>58</volume><fpage>249</fpage><lpage>258</lpage><pub-id pub-id-type="doi">10.1016/j.sbi.2019.05.021</pub-id><pub-id pub-id-type="pmid">31280905</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zivanov</surname> <given-names>J</given-names></name><name><surname>Nakane</surname> <given-names>T</given-names></name><name><surname>Forsberg</surname> <given-names>BO</given-names></name><name><surname>Kimanius</surname> <given-names>D</given-names></name><name><surname>Hagen</surname> <given-names>WJ</given-names></name><name><surname>Lindahl</surname> <given-names>E</given-names></name><name><surname>Scheres</surname> <given-names>SH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>New tools for automated high-resolution cryo-EM structure determination in RELION-3</article-title><source>eLife</source><volume>7</volume><elocation-id>e42166</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.42166</pub-id><pub-id pub-id-type="pmid">30412051</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.68946.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Egelman</surname><given-names>Edward H</given-names></name><role>Reviewing Editor</role><aff><institution>University of Virginia</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Egelman</surname><given-names>Edward H</given-names></name><role>Reviewer</role><aff><institution>University of Virginia</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Villa</surname><given-names>Elizabeth</given-names> </name><role>Reviewer</role><aff><institution>University of California, San Diego</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>Our editorial process produces two outputs: i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.04.20.440648">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.04.20.440648v1">the preprint</ext-link> for the benefit of readers; ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>You have fully addressed the concerns of the reviewers. While in some cases you have explained that resolving certain issues is beyond the scope of the present paper, the manuscript as it currently exists will be a useful contribution to the area of template matching for locating complexes in cells.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Locating Macromolecular Assemblies in Cells by 2D Template Matching with cisTEM&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Edward H Egelman as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Richard Aldrich as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Elizabeth Villa (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) A point of concern is the degree of reference-bias in the results of the 2DTM approach. The authors acknowledge this concern and that conventional use of the FSC is not a suitable validation metric for this approach nor for determining an appropriate filtering cutoff for a resulting reconstruction. The proposed validation metric of the emergence of additional known density features in a reconstruction, which are not present in the template, resulting from 2DTM hits is sensible. However, emergence of additional unknown densities in a reconstruction resulting from cellular data will be difficult to segregate from noise, especially since filtering of the reconstruction is determined ad hoc instead of by an objective metric.</p><p>2) The work remains on an empirical level as surprising advantages of the 2D approach compared to 3D are revealed, but there is little effort to get to the basis of these observations. Moreover, details on the compared 3D approach (and its parameter optimization analogous to the 2D approach), which the rather general conclusions would require, are missing. Lastly, the 3D approach has been applied to the strongly pre-irradiated sample, which may make observations such as a lower specificity in the 3D case almost a self-fulfilling prophecy. Thus, the 2D vs 3D comparison is not convincing in the current form. The 2D implementation of in situ structure determination is interesting and of potential interest to a large audience. However, the comparison to the 3D equivalent appears somewhat incomplete and the rather general conclusions require further validation. In the absence of further validation, the conclusions need to be toned down.</p><p>3) Which concrete recommendations do the authors provide with regards to data acquisition? The researcher has to make a decision whether to spend the most valuable first ~30 e-/Å<sup>2</sup> on a projection or a tilt series. In this manuscript, the authors argue for the former, while Mahamid and colleagues have obtained beyond 4 Å resolution using the latter strategy (Tegunov et al., 2021). This leaves people somewhat puzzled.</p><p>4) In this work, the provided FSCs suggest that resolutions in the range of 5 Å are achieved, but all figures are low pass filtered to ~20 Å, which appears odd. Of note, the FSCs do not exhibit an extended plateau with FSC approx. 1 at low frequencies, which is normally observed. Please explain.</p><p>5) Cross-resolutions of reconstructions and 30S (from B. subtilis and M. pneumoniae) should be provided as an assessment.</p><p>6) L. 298: &quot;The pre-exposure of 32 e-/Å<sup>2</sup> affects the signal in the tomograms at higher resolution but is expected to have only a small effect in the resolution range relevant for 3DTM, i.e., 20 Å and lower (Grant and Grigorieff, 2015).&quot; This is a very key assumption of the entire study that must be validated experimentally. Nucleic acids are known to considerably more beam sensitive than amino acids and hence 32 e-/Å<sup>2</sup> is typically considered a very high dose for ribosomes. The authors must do the reverse experiment to validate the stated assumption, which is to spend the first 32 e-/Å<sup>2</sup> on a tilt series, then acquire the 32 e-/Å<sup>2</sup> 2D image, and finally resume the tilt series.</p><p>7) For 3D template matching essential computational details are omitted. Importantly, the spatial and rotational sampling (i.e., voxel size and rotational increment/number of rotated templates) is not specified. Given that the authors point out the importance of rotational sampling this omission is surprising.</p><p>8) Regarding the above remark: what is the authors' expectation if sampling is increased for the 3D case (and first 30 e/Å<sup>2</sup> on the tilt series): will the suggested trends on 3D vs 2D approach still hold? In other words: is (limited) computation the problem in the 3D case or is there a conceptual advantage resulting in higher specificity for the 2D approach?</p><p>9) To make general statements about 2D vs 3D template matching the authors must ensure that they use comparable sampling – or use some other normalization of their approaches (e.g. computation time).</p><p>10) The paper lacks any discussion of the 2D vs 3D results in the light of the dose fractionation theorem, as stated by Hegerl and Hoppe theoretically and experimentally confirmed by McEwen. This theorem states that the information content of 2D image or 3D volume imaged with the same dose is the same, albeit different structure factors are sampled in Fourier space.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.68946.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) A point of concern is the degree of reference-bias in the results of the 2DTM approach. The authors acknowledge this concern and that conventional use of the FSC is not a suitable validation metric for this approach nor for determining an appropriate filtering cutoff for a resulting reconstruction. The proposed validation metric of the emergence of additional known density features in a reconstruction, which are not present in the template, resulting from 2DTM hits is sensible. However, emergence of additional unknown densities in a reconstruction resulting from cellular data will be difficult to segregate from noise, especially since filtering of the reconstruction is determined ad hoc instead of by an objective metric.</p></disp-quote><p>Validation of unknown features that do not reach a resolution where secondary or primary structural features can be recognized is difficult, as decades of “blobology” preceding the cryoEM resolution revolution have shown. However, in the case of template bias with no additional refinement, the emergence of any additional features above the noise level cannot arise only from noise and will therefore reliably indicate true additional density in the detected targets at that location. Nevertheless, we have added an evaluation of the 3D reconstructions (lines 230 – 232, lines 764 – 768, Figure 4—figure supplement 1d) obtained from targets detected by 2DTM by local cross-FSC with the <italic>M. pneumoniae</italic> 30S template.</p><p>Another issue that the reviewers may have had in mind is that the additional density may represent a mixture of structures and/or conformations (heterogeneity) and therefore cannot easily be interpreted without further classification. 3D reconstruction and classification to assess structural heterogeneity by will be the subject of a future study.</p><disp-quote content-type="editor-comment"><p>2) The work remains on an empirical level as surprising advantages of the 2D approach compared to 3D are revealed, but there is little effort to get to the basis of these observations. Moreover, details on the compared 3D approach (and its parameter optimization analogous to the 2D approach), which the rather general conclusions would require, are missing. Lastly, the 3D approach has been applied to the strongly pre-irradiated sample, which may make observations such as a lower specificity in the 3D case almost a self-fulfilling prophecy. Thus, the 2D vs 3D comparison is not convincing in the current form. The 2D implementation of in situ structure determination is interesting and of potential interest to a large audience. However, the comparison to the 3D equivalent appears somewhat incomplete and the rather general conclusions require further validation. In the absence of further validation, the conclusions need to be toned down.</p></disp-quote><p>We would like to reiterate that the purpose of our work is to evaluate target detection in cells by 2DTM. We do not suggest replacing 3DTM with 2DTM, nor do we suggest that calculating 3D reconstructions from 2DTM targets is superior to reconstructions obtained through subtomogram averaging. Both approaches have their different strengths and weaknesses, as described in our manuscript, and therefore, they are complementary to each other. We agree with the reviewers that it is helpful to recapitulate the parameters used for 3DTM. Our 3DTM protocol follows standard procedures that are well-established in the field of cryo-tomography and optimize the identification of targets. As mentioned in our manuscript and described by Hrabe et al. (2012), we used PyTom to search our tomograms. The pixel size in the tomograms was 6.8 Å, and 3DTM used angular sampling with points separated by 19.95°, which was previously shown to produce good results for ribosomes. We have now added these details to the Methods section of our manuscript.</p><p>Regarding pre-irradiation of the sample for 2DTM, we understand the reviewers’ concern that this may affect 3DTM of the subsequently recorded tomograms. However, the effective B-factor of the subtomograms estimated by <italic>RELION</italic> was 1700 Å2 for non-pre-irradiated tomograms, as determined for data processed in O’Reilly et al. (2020), and 2000 Å2 for pre-irradiated tomograms collected for the present study. At 30 Å, the resolution of the template commonly used for 3DTM (see Methods), these B-factors will attenuate the signal by factors of 0.62 and 0.57, respectively, a difference of 8%. Another indication that the pre-exposure has only a small effect on 3DTM is provided in Figure S5 of O’Reilly et al. (2020). This figure shows a plot similar to our plot in Figure 5—figure supplement 1c. Both figures show the rate of false positives of targets detected by 3DTM, based on 3D classification in <italic>RELION</italic>. For example, for the top-scoring targets, both plots indicate a false-positive rate of about 5%. For targets ranked around 200 from the top, about 50% are false positives, and for targets ranked around 400 from the top, the false-positive rate is about 65% in both cases. We have amended our Discussion of the effect of pre-irradiation in our revised manuscript (lines 299 – 301, 311 – 313), citing the comparisons with O’Reilly et al. (2020), and acknowledge that there is a small difference in the signal attenuation between non-pre-irradiated and pre-irradiated samples that may introduce a small bias in our analysis in favor of 2DTM.</p><disp-quote content-type="editor-comment"><p>3) Which concrete recommendations do the authors provide with regards to data acquisition? The researcher has to make a decision whether to spend the most valuable first ~30 e-/Å<sup>2</sup> on a projection or a tilt series. In this manuscript, the authors argue for the former, while Mahamid and colleagues have obtained beyond 4 Å resolution using the latter strategy (Tegunov et al., 2021). This leaves people somewhat puzzled.</p></disp-quote><p>In the present study, our goal is to investigate the potential of 3D reconstruction from 2DTM targets, in analogy to subtomogram averaging, to show that additional features can be visualized in detected targets that are not present in the template, despite the well-known problem of template bias. We do not envision that 2DTM will replace de novo 3D reconstruction of whole complexes by subtomogram averaging since 2DTM, by design, requires a large part of the structure to be known at high resolution to find 2D targets. A full investigation of how to optimize 3D reconstruction from detected 2DTM targets, including recommendations for how to collect data for this purpose, will be done in a future study. We hope that the 2DTM approach will be useful in projects where at least part of the 3D structure is known, and where their localization in the cell helps in understanding their biological function. Following future efforts, we hope to develop this approach to dissect their conformational heterogeneity.</p><disp-quote content-type="editor-comment"><p>4) In this work, the provided FSCs suggest that resolutions in the range of 5 Å are achieved, but all figures are low pass filtered to ~20 Å, which appears odd. Of note, the FSCs do not exhibit an extended plateau with FSC approx. 1 at low frequencies, which is normally observed. Please explain.</p></disp-quote><p>We agree with the reviewers that additional justification for the 20-Å low-pass filtering of the reconstructions will improve the manuscript. We have evaluated the local cross-FSC with the <italic>M. pneumoniae</italic> 30S template since template bias will not affect this part of the reconstruction (see new Figure 4—figure supplement 1d). The FSC = 0.5 threshold, as required for map-to-model comparison, indicates an estimated resolution of ~15 Å for the reconstruction obtained from targets found with the <italic>M. pneumoniae</italic> template, and ~20 Å for the reconstruction obtained from targets found with the <italic>B. subtilis</italic> template. As described in the revised manuscript (lines 230 – 232, lines 764 – 768), we have filtered all reconstructions with a 20-Å low-pass filter for consistency.</p><p>Regarding the shapes of the reported FSC curves, the 3D reconstructions we obtained differ in several ways from those commonly reported, and these differences will have an effect on the FSC curves. Compared to most single-particle reconstructions, our images contain cellular background, particle poses were not refined (angles, x-y positions, and defocus), and they contain a mixture of conformations, especially in the 30S region.</p><disp-quote content-type="editor-comment"><p>5) Cross-resolutions of reconstructions and 30S (from B. subtilis and M. pneumoniae) should be provided as an assessment.</p></disp-quote><p>We thank the reviewers for this suggestion. This information is now included (lines 230 – 232, lines 764 – 768). Please see also our reply to comment #4.</p><disp-quote content-type="editor-comment"><p>6) L. 298: &quot;The pre-exposure of 32 e-/Å<sup>2</sup> affects the signal in the tomograms at higher resolution but is expected to have only a small effect in the resolution range relevant for 3DTM, i.e., 20 Å and lower (Grant and Grigorieff, 2015).&quot; This is a very key assumption of the entire study that must be validated experimentally. Nucleic acids are known to considerably more beam sensitive than amino acids and hence 32 e-/Å<sup>2</sup> is typically considered a very high dose for ribosomes. The authors must do the reverse experiment to validate the stated assumption, which is to spend the first 32 e-/Å<sup>2</sup> on a tilt series, then acquire the 32 e-/Å<sup>2</sup> 2D image, and finally resume the tilt series.</p></disp-quote><p>We agree with the reviewers that this statement requires further justification. Please see our reply to comment #2. We would like to note that reversing the experiment would be uninformative since 2DTM relies on the high-resolution signal much more strongly than 3DTM (see above).</p><disp-quote content-type="editor-comment"><p>7) For 3D template matching essential computational details are omitted. Importantly, the spatial and rotational sampling (i.e., voxel size and rotational increment/number of rotated templates) is not specified. Given that the authors point out the importance of rotational sampling this omission is surprising.</p></disp-quote><p>We agree and now provide these details in the Methods, lines 776 – 778 (see our reply to comment #2).</p><disp-quote content-type="editor-comment"><p>8) Regarding the above remark: what is the authors' expectation if sampling is increased for the 3D case (and first 30 e/Å<sup>2</sup> on the tiltseries): will the suggested trends on 3D vs 2D approach still hold? In other words: is (limited) computation the problem in the 3D case or is there a conceptual advantage resulting in higher specificity for the 2D approach?</p></disp-quote><p>The tomograms we searched using 3DTM are limited by the inherent B-factor of 1700 – 2000 Å2 (see our reply to comment #2). This means that finer sampling will not increase the number of detected targets. Looking ahead, image processing of tomographic data is likely to improve steadily and we expect that this will result in better preservation of the high-resolution signal in the reconstructed tomograms. In the ideal case, the signal across all resolution ranges is preserved perfectly. Provided a good model for the noise in tomograms can also be developed, 3DTM may be as effective as, or even superior to 2DTM in terms of detection precision and sensitivity. As the reviewers point out, there might be other reasons to prefer 2DTM over 3DTM. A major advantage arises from the time it takes to acquire 2D images, compared to tilt series and their subsequent alignment and reconstruction (not required for 2DTM), in addition to computational efficiency (when using similar spatial and angular sampling rates). We have added these points in our revised Discussion, lines 619 – 624.</p><disp-quote content-type="editor-comment"><p>9) To make general statements about 2D vs 3D template matching the authors must ensure that they use comparable sampling – or use some other normalization of their approaches (e.g. computation time).</p></disp-quote><p>As explained in our replies to comments #2 and #8, we performed 3DTM under well-established conditions, which have been previously optimized to produce optimal detection for each approach.</p><disp-quote content-type="editor-comment"><p>10) The paper lacks any discussion of the 2D vs 3D results in the light of the dose fractionation theorem, as stated by Hegerl and Hoppe theoretically and experimentally confirmed by McEwen. This theorem states that the information content of 2D image or 3D volume imaged with the same dose is the same, albeit different structure factors are sampled in Fourier space.</p></disp-quote><p>The publications by Hegerl and Hoppe (1976), and McEwen et al. (1995) revolve around the visualization of sample features at a given significance (i.e., signal-to-noise ratio) using different dose fractionation schemes, ranging from a single exposure, to tilt series of tens to hundreds of exposures. A primary reason for investigating this question stems from the fact that the distribution of noise in the resulting image or reconstruction depends on the distribution of tilts. This is nicely demonstrated in Figure 3 of McEwen et al. where the slices through the 3D reconstruction (third row) are noticeably low-pass filtered compared to the single-tilt images (second row), both recorded with the same total exposure. As explained in our manuscript (lines 633 – 639), the signal-to-noise profiles of 2D images and tomograms are quite different, for multiple reasons including interpolation and weighting in 3D reconstructions, alignment errors in the tilt series, and tilt-dependent sample thickness and radiation damage. These differences results in different detection characteristics of 2DTM and 3DTM. The definition of detection also differs fundamentally between the various studies. While Hegerl and Hoppe consider the (low-resolution) contrast of a sphere and McEwen et al. use the more qualitative criterion of being able to see features in difference images, we use a matched filter and a significance threshold based on a statistical criterion. Finally, neither Hegerl and Hoppe nor McEwen et al. address the question of detecting molecules against a background of other molecules, and how 3D information can be used to remove some of the overlapping density that is present in 2D images. We therefore think that a discussion of these publications in our manuscript would be confusing and not appropriate to include.</p></body></sub-article></article>