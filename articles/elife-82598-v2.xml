<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">82598</article-id><article-id pub-id-type="doi">10.7554/eLife.82598</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>The impact of task context on predicting finger movements in a brain-machine interface</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-289127"><name><surname>Mender</surname><given-names>Matthew J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1562-3289</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-290509"><name><surname>Nason-Tomaszewski</surname><given-names>Samuel R</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-290511"><name><surname>Temmar</surname><given-names>Hisham</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4464-4911</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-290512"><name><surname>Costello</surname><given-names>Joseph T</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-290513"><name><surname>Wallace</surname><given-names>Dylan M</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-290510"><name><surname>Willsey</surname><given-names>Matthew S</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-290514"><name><surname>Ganesh Kumar</surname><given-names>Nishant</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-290515"><name><surname>Kung</surname><given-names>Theodore A</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-31479"><name><surname>Patil</surname><given-names>Parag</given-names></name><email>pgpatil@med.umich.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund8"/><xref ref-type="other" rid="fund10"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-86370"><name><surname>Chestek</surname><given-names>Cynthia A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9671-7051</contrib-id><email>cchestek@umich.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund9"/><xref ref-type="other" rid="fund10"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00jmfr291</institution-id><institution>Department of Biomedical Engineering, University of Michigan</institution></institution-wrap><addr-line><named-content content-type="city">Ann Arbor</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00jmfr291</institution-id><institution>Department of Electrical Engineering and Computer Science, University of Michigan</institution></institution-wrap><addr-line><named-content content-type="city">Ann Arbor</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00jmfr291</institution-id><institution>Department of Robotics, University of Michigan</institution></institution-wrap><addr-line><named-content content-type="city">Ann Arbor</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00jmfr291</institution-id><institution>Department of Neurosurgery, University of Michigan Medical School</institution></institution-wrap><addr-line><named-content content-type="city">Ann Arbor</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00jmfr291</institution-id><institution>Section of Plastic Surgery, Department of Surgery, University of Michigan</institution></institution-wrap><addr-line><named-content content-type="city">Ann Arbor</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Pruszynski</surname><given-names>J Andrew</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Western University</institution></institution-wrap><country>Canada</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Makin</surname><given-names>Tamar R</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>07</day><month>06</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e82598</elocation-id><history><date date-type="received" iso-8601-date="2022-08-10"><day>10</day><month>08</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-05-22"><day>22</day><month>05</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-08-26"><day>26</day><month>08</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.08.26.505422"/></event></pub-history><permissions><copyright-statement>© 2023, Mender et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Mender et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-82598-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-82598-figures-v2.pdf"/><abstract><p>A key factor in the clinical translation of brain-machine interfaces (BMIs) for restoring hand motor function will be their robustness to changes in a task. With functional electrical stimulation (FES) for example, the patient’s own hand will be used to produce a wide range of forces in otherwise similar movements. To investigate the impact of task changes on BMI performance, we trained two rhesus macaques to control a virtual hand with their physical hand while we added springs to each finger group (index or middle-ring-small) or altered their wrist posture. Using simultaneously recorded intracortical neural activity, finger positions, and electromyography, we found that decoders trained in one context did not generalize well to other contexts, leading to significant increases in prediction error, especially for muscle activations. However, with respect to online BMI control of the virtual hand, changing either the decoder training task context or the hand’s physical context during online control had little effect on online performance. We explain this dichotomy by showing that the structure of neural population activity remained similar in new contexts, which could allow for fast adjustment online. Additionally, we found that neural activity shifted trajectories proportional to the required muscle activation in new contexts. This shift in neural activity possibly explains biases to off-context kinematic predictions and suggests a feature that could help predict different magnitude muscle activations while producing similar kinematics.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>motor control</kwd><kwd>brain-machine interface</kwd><kwd>spinal cord injury</kwd><kwd>hand</kwd><kwd>EMG</kwd><kwd>fingers</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Rhesus macaque</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>Grant Number 1926576</award-id><principal-award-recipient><name><surname>Mender</surname><given-names>Matthew J</given-names></name><name><surname>Temmar</surname><given-names>Hisham</given-names></name><name><surname>Patil</surname><given-names>Parag</given-names></name><name><surname>Chestek</surname><given-names>Cynthia A</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>Graduate Research Fellowship Program</award-id><principal-award-recipient><name><surname>Costello</surname><given-names>Joseph T</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100009633</institution-id><institution>Eunice Kennedy Shriver National Institute of Child Health and Human Development</institution></institution-wrap></funding-source><award-id>Grant Number F31HD098804</award-id><principal-award-recipient><name><surname>Nason-Tomaszewski</surname><given-names>Samuel R</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000065</institution-id><institution>National Institute of Neurological Disorders and Stroke</institution></institution-wrap></funding-source><award-id>Grant Number T32NS007222</award-id><principal-award-recipient><name><surname>Willsey</surname><given-names>Matthew S</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000065</institution-id><institution>National Institute of Neurological Disorders and Stroke</institution></institution-wrap></funding-source><award-id>Grant Number R01NS105132</award-id><principal-award-recipient><name><surname>Ganesh Kumar</surname><given-names>Nishant</given-names></name><name><surname>Kung</surname><given-names>Theodore A</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution>The D. Dan and Betty Kahn Foundation</institution></institution-wrap></funding-source><award-id>Grant AWD011321</award-id><principal-award-recipient><name><surname>Wallace</surname><given-names>Dylan M</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution>University of Michigan Robotics Institute</institution></institution-wrap></funding-source><award-id>Graduate student fellowship</award-id><principal-award-recipient><name><surname>Wallace</surname><given-names>Dylan M</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008456</institution-id><institution>A. Alfred Taubman Medical Research Institute</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Patil</surname><given-names>Parag</given-names></name></principal-award-recipient></award-group><award-group id="fund9"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005191</institution-id><institution>Craig H. Neilsen Foundation</institution></institution-wrap></funding-source><award-id>Project 315108</award-id><principal-award-recipient><name><surname>Chestek</surname><given-names>Cynthia A</given-names></name></principal-award-recipient></award-group><award-group id="fund10"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>Grant Number R01GM111293</award-id><principal-award-recipient><name><surname>Patil</surname><given-names>Parag</given-names></name><name><surname>Chestek</surname><given-names>Cynthia A</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Task changes, like increased force production or altered posture, decrease the accuracy of brain-machine interfaces predicting intended finger movements, however, understanding how neural activity changes with the altered biomechanics of the task may provide insights for generalizable decoder development.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Spinal cord injury affects an estimated 296,000 people in the United States (<xref ref-type="bibr" rid="bib41">National Spinal Cord Injury Statistical Center, 2021</xref>). People with quadriplegia have ranked the restoration of hand and arm function as very important for quality of life (<xref ref-type="bibr" rid="bib3">Anderson, 2004</xref>; <xref ref-type="bibr" rid="bib10">Collinger et al., 2013a</xref>). Functional electrical stimulation (FES) is a therapy that can restore hand and arm function by electrically stimulating muscles in order to cause contractions. Studies have demonstrated the use of FES to restore at least some hand function since the 1980s (<xref ref-type="bibr" rid="bib34">Kilgore et al., 1989</xref>; <xref ref-type="bibr" rid="bib45">Peckham et al., 1980</xref>), which has resulted in commercially available systems such as the Freehand System (<xref ref-type="bibr" rid="bib46">Peckham et al., 2001</xref>) that was available until the late 2000s. These systems, however, typically relied on external motion or myoelectric commands from residual muscles. These control schemes for FES require residual function and can be unintuitive to use, especially when controlling more than 1-degree-of-freedom.</p><p>Brain-machine interfaces (BMIs) have the potential to provide more intuitive control signals that enable people with paralysis to interact with computers, prostheses, or control therapies like FES. These BMIs capabilities have been made possible by a history of neuroscience studies finding that motor cortex activity is correlated with a multitude of movement variables, from intrinsic variables like joint angle and muscle activation (<xref ref-type="bibr" rid="bib15">Evarts, 1968</xref>), to extrinsic variables like movement direction (<xref ref-type="bibr" rid="bib21">Georgopoulos et al., 1986</xref>). Taking advantage of these correlations allows linear models to predict these movement variables from neural activity. This approach has been used in BMIs to allow nonhuman primates to control computer cursors (<xref ref-type="bibr" rid="bib22">Gilja et al., 2012</xref>; <xref ref-type="bibr" rid="bib56">Serruya et al., 2002</xref>; <xref ref-type="bibr" rid="bib61">Taylor et al., 2002</xref>), prosthetic arms (<xref ref-type="bibr" rid="bib7">Carmena et al., 2003</xref>; <xref ref-type="bibr" rid="bib63">Velliste et al., 2008</xref>), and FES (<xref ref-type="bibr" rid="bib4">Badi et al., 2021</xref>; <xref ref-type="bibr" rid="bib14">Ethier et al., 2012</xref>; <xref ref-type="bibr" rid="bib37">Moritz et al., 2008</xref>). Additionally, success in animal BMIs led to the use of similar models in clinical trials as well (<xref ref-type="bibr" rid="bib1">Ajiboye et al., 2017</xref>; <xref ref-type="bibr" rid="bib6">Bouton et al., 2016</xref>; <xref ref-type="bibr" rid="bib11">Collinger et al., 2013b</xref>; <xref ref-type="bibr" rid="bib23">Gilja et al., 2015</xref>; <xref ref-type="bibr" rid="bib66">Wodlinger et al., 2015</xref>). These studies, however, are generally performed in a controlled lab environment, and use relatively simple linear models to make predictions. One key factor in the translation of lab BMI FES systems to tasks of daily living will be how robust they are to the varying environments and tasks found in patient’s homes. While some groups have included object interaction in their tasks, for example grabbing single objects (<xref ref-type="bibr" rid="bib1">Ajiboye et al., 2017</xref>; <xref ref-type="bibr" rid="bib13">Downey et al., 2017</xref>), or different size objects (<xref ref-type="bibr" rid="bib66">Wodlinger et al., 2015</xref>), there has not yet been a systematic effort to understand how task context affects BMI performance.</p><p>Studies of how motor cortex controls movement have helped to inform how well we can expect BMI models to generalize. This work has shown that the linear encoding of movements in motor cortex can change with many factors such as posture or task duration (<xref ref-type="bibr" rid="bib8">Churchland and Shenoy, 2007</xref>; <xref ref-type="bibr" rid="bib33">Kakei et al., 1999</xref>; <xref ref-type="bibr" rid="bib42">Naufel et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Scott et al., 2001</xref>; <xref ref-type="bibr" rid="bib55">Sergio et al., 2005</xref>). Recent studies have emphasized instead that the role of motor cortex is to generate movements rather than represent movements (<xref ref-type="bibr" rid="bib9">Churchland et al., 2012</xref>; <xref ref-type="bibr" rid="bib47">Russo et al., 2018</xref>; <xref ref-type="bibr" rid="bib58">Shenoy et al., 2013</xref>). In this view, the activations of single neurons are coordinated. The underlying network connectivity constrains population activity to a low-dimensional manifold and activations on this low-dimensional manifold then form the basis for neural dynamics which generate movements (<xref ref-type="bibr" rid="bib18">Gallego et al., 2017</xref>; <xref ref-type="bibr" rid="bib58">Shenoy et al., 2013</xref>). A key feature of these dynamics that is different from a representation model is that they may have a more computational function, for example ensuring that outgoing commands can be generated reliably (<xref ref-type="bibr" rid="bib47">Russo et al., 2018</xref>). The resulting activity may then change when the same movements are done in different ways because a different computation is needed to generate the movements. As a result, an individual neuron’s activity, which is related to the latent activity in this low-dimensional manifold, could correlate with movements differently when the task is changed to one that requires different neural dynamics. With respect to BMI applications, the decoding models assuming a linear relationship, and nonlinear models that do not account for these changes, would then be unable to make accurate predictions in the new tasks.</p><p>It is still unclear how large of a task change will require different neural dynamics and thus a different decoding strategy. It has been shown that different dynamics are required for large changes in a task, such as forward versus backward arm pedaling (<xref ref-type="bibr" rid="bib47">Russo et al., 2018</xref>), reaching or walking (<xref ref-type="bibr" rid="bib36">Miri et al., 2017</xref>), or using one arm or the other (<xref ref-type="bibr" rid="bib2">Ames and Churchland, 2019</xref>). At the same time, there is evidence that tasks with the same movements performed differently may have similar neural dynamics. A recent study found that cycling at different speeds led to similar elliptical trajectories in high variance neural dimensions, with a lower variance dimension encoding task speed (<xref ref-type="bibr" rid="bib49">Saxena et al., 2022</xref>). Additionally, a study of isometric, resisted, and free-moving wrist movements found a neural manifold that explained a large amount of neural variance in all tasks (<xref ref-type="bibr" rid="bib19">Gallego et al., 2018</xref>) and a similar study comparing the same wrist movements found that they could still predict muscle activations between the contexts although it required a gain factor related to required muscle activation (<xref ref-type="bibr" rid="bib42">Naufel et al., 2019</xref>). These observations suggest that the neural dynamics may be similar across tasks with small changes, such as a change in speed or muscle exertion, with differences occurring in lower variance dimensions of population activity.</p><p>Which tasks require a change in neural dynamics is a particularly important question to study for hand movements, as the hand is the major end effector interacting with the environment in varying postures and with different loads. However, this work has not yet been extended to continuous finger movements. Finger movements are less studied than arm reaches but initial studies show that grasping movements may show different dynamics due to the increased proprioceptive and tactile feedback present (<xref ref-type="bibr" rid="bib26">Goodman et al., 2019</xref>; <xref ref-type="bibr" rid="bib59">Suresh et al., 2020</xref>). In a promising start to studying decoder generalization for individuated finger movements, it has been shown previously that multiple finger movements can be predicted simultaneously, in real time, and that a linear model trained with data from individual finger movements from two finger groups could also predict combined finger movements (<xref ref-type="bibr" rid="bib39">Nason et al., 2021</xref>), suggesting that individual finger movements and combined finger movements may have similar neural dynamics.</p><p>In this study, we investigate how well the decoding of finger movements from intracortical neural activity in nonhuman primates can generalize to realistic alterations of the context in which a task is performed, similar to those that may be found in a BMI user’s home. These context shifts represent a small range of the possible shifts but relate back to common musculoskeletal changes in the task, that is muscle length and activation. We ask how the relationship between intracortical neural activity, non-prehensile finger movements, and the corresponding muscle activations are impacted by context changes, such as spring-like resistances and postural changes. We show that these context changes reduce our ability to predict finger kinematics and finger-related muscle activations offline. However, in an online kinematic-based finger BMI task, the monkey can accommodate for the changed task context and achieve near equivalent performance with or without the context change. We explain this by showing that the underlying neural manifolds stay well aligned between contexts, the neural dynamics are shifted due to context, and the shift in neural dynamics can be related to the muscle activation required in the new context.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Context changes alter muscle activations and neural activity</title><p>We are ultimately interested in understanding the impact of context changes, such as wrist flexion or spring resistance, on BMI decoding performance. In the virtual finger movement task (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), the monkey moves their fingers within a manipulandum in order to move virtual fingers on a screen in front of them. Cortical spiking activity is recorded during these movements. The monkeys perform center-out and back movements in which they individuate index and middle-ring-small (MRS) finger groups to make one of eight movements (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) starting from rest, hold the target, then return to rest. In some versions of the task the monkeys performed these movements with all fingers held together for 1-degree-of-freedom (1-DOF, <xref ref-type="fig" rid="fig1">Figure 1B</xref> bottom). Monkey N additionally had eight chronic electromyography (EMG) leads implanted in muscles of the hand and wrist (see Methods, Table 2) which were recorded from during manipulandum control trials. During the BMI task, a Kalman filter (KF) model is trained to relate cortical activity to finger movements, and the monkey controls the virtual hand with their brain activity through this model. We first asked whether introducing context changes during the manipulandum controlled virtual finger movement task causes any change in behavior, muscle activation, or neural channel activation. Our first manipulations were the addition of torsional springs or the static flexion of the wrist by 23 degrees (<xref ref-type="fig" rid="fig1">Figure 1C</xref>), referred to as the spring and wrist contexts, respectively, during the 1-DOF center-out task. The torsional springs resist flexion such that more force is required to flex the fingers but less force is required to extend the fingers.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Illustration of the behavioral task and context changes.</title><p>(<bold>A</bold>) Experimental setup during manipulandum control and brain-machine interface (BMI) control experiments. The monkey individuates their index and middle-ring-small finger group, moving each in the manipulandum in order to acquire targets on the screen in front of them. During this task, neural activity and finger positions are both recorded. A model relating neural activity to intended finger movements can be trained and then used in real time to control the virtual hand in front of them. (<bold>B</bold>) Illustration of the possible finger movements. For 2-degree-of-freedom (2-DOF) movements, the index flexion is represented on the x-axis and MRS flexion is represented on the y-axis. In some tasks the monkeys also did a 1-DOF movement, which required flexing or extending all fingers together. (<bold>C</bold>) To alter the context of the task, the manipulandum could be rotated so that the wrist was flexed and torsion springs could be added to the underside of the finger doors. The torsion springs were at rest when the finger doors were at full extension and thus resisted flexion and assisted with extension.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig1-v2.tif"/></fig><p>We expected the springs to cause minimal change in finger velocity during movements but a large increase in muscle activation for flexor muscles during flexion and a decrease in activation for extensor muscles during extension. The springs were chosen to be as strong as possible without decreasing the monkey’s motivation during the 2-DOF task. As a result, the task could still be completed close to as fast as their reactions allow. <xref ref-type="fig" rid="fig2">Figure 2A</xref> shows finger position and velocity traces averaged over all flexion trials (solid lines) and all extension trials (dashed lines) on one representative day with the 1-DOF task for Monkey N where the spring manipulation was tested. We see small changes between the velocities in normal trials (black traces) and spring trials (blue traces). To quantify this change, we compared the peak velocities between normal trials and other context trials for one representative session with each context (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Each monkey had slight behavioral differences in how quickly they performed the task with context changes leading to small changes in peak velocities. We found that the largest changes in peak velocity were Monkey N extending fingers 12.5% faster during wrist trials (p=5e-24, two-sample t-test), and Monkey W flexing fingers 22.3% faster during wrist trials (p=2.6e-11, two-sample t-test), with both monkeys showing small changes in peak movement velocity for at least one movement in each context (p&lt;0.05, two-sample t-test).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>The impact of context changes on kinematics and muscle activation.</title><p>(<bold>A</bold>) Trial-averaged traces of index finger position and index finger flexion velocity for an example 1-degree-of-freedom (1-DOF) spring session with Monkey N. Trials are aligned to peak movement (vertical gray line). Black traces are normal trials, blue are trials with springs in the manipulandum, solid traces are for flexion trials, and dotted traces are for extension trials. Shaded area shows one standard deviation. (<bold>B</bold>) Trial-averaged traces of flexor digitorum profundus (FDP) muscle activation and extensor digitorum communis (EDC) muscle activation for an example spring session with Monkey N. Formatted the same as (<bold>A</bold>). (<bold>C</bold>) Change in peak velocity between normal trials and trials with either springs present or the wrist flexed for both Monkey N (left) and Monkey W (right). Trials are split by movement direction, either flexion or extension. Error bars indicate 99% confidence interval based on a two-sample t-test. (<bold>D, E</bold>) Change in average muscle activation in a window around peak movement between normal trials and trials in the spring (blue) or wrist context (yellow) for all eight muscles recorded in Monkey N. Trials are split between flexion (<bold>D</bold>) and extension (<bold>E</bold>) movements. Error bars indicate 99% confidence interval based on a two-sample t-test.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig2-v2.tif"/></fig><p>In contrast, during the same 1-DOF task, muscle activations change substantially for trials toward both targets (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), showing trends such as increased flexor digitorum profundus (FDP) muscle activation for flexion and less extensor digitorum communis (EDC) activation for extension. All muscles implanted for Monkey N are included in Table 2 (Methods) while Monkey W did not have EMG electrodes. Using the same representative sessions for Monkey N, we compared the average muscle activations from Monkey N in a 420ms window around peak movement between normal trials and off-context trials (<xref ref-type="fig" rid="fig2">Figure 2D, E</xref>). During spring trials, we found that every muscle except FCR required significantly higher than normal muscle activation for flexion (<xref ref-type="fig" rid="fig2">Figure 2D</xref> blue, p&lt;0.004 two-sample t-test), an average increase of 91.9% for the finger flexor muscles (FDPid, FDPip, FDP), and every muscle except FDP and FCU required less muscle activation for extension (<xref ref-type="fig" rid="fig2">Figure 2E</xref> blue, p&lt;1e-5 two-sample t-test), an average decrease of 8.2% in finger extensor muscles (EIP, EDC). Interestingly, even extensor muscles were more activated during spring flexion trials, indicating that Monkey N was co-contracting muscles more and moving with more stiffness. During wrist trials, finger flexor muscles showed an average 53.3% increase in activation for flexion trials (<xref ref-type="fig" rid="fig2">Figure 2D</xref> yellow) and finger extensor muscles had an average 32% decrease in activation for extension trials (<xref ref-type="fig" rid="fig2">Figure 2E</xref> yellow).</p><p>After establishing that context had a large effect on muscle activity with a relatively small effect on finger kinematics, we next evaluated whether neural activity changed due to the addition of springs or altered wrist posture. For each neural channel we recorded two features, the threshold crossing firing rate (TCFR) and spiking band power (SBP). SBP is a low-power feature that has been previously shown to be well correlated with the firing rate of the largest amplitude unit (<xref ref-type="bibr" rid="bib38">Nason et al., 2020</xref>), often enabling us to identify more tuned channels. For both Monkey N and Monkey W, we evaluated how many channels were tuned to movement and how many of these tuned channels modulated activity with context change. Tuning and context modulation were determined by regressing finger kinematics with channel activity and channel activity multiplied by a dummy variable for context, as described in the Methods, one channel at a time. Regression coefficients were tested for significance with a t-test, a significant channel activity coefficient indicated that channel was tuned, and a significant dummy variable coefficient indicated that context modulated the channel’s tuning. The results are included in <xref ref-type="table" rid="table1">Table 1</xref>. The SBP feature resulted in an average of 86.9 and 28 tuned channels of 96 for Monkey N and Monkey W, respectively, while TCFR resulted in an average of 36.7 and 11.8 tuned channels of 96 for Monkey N and Monkey W, respectively. An average of 24.4% of the tuned TCFR channels and 37.7% of the tuned SBP channels significantly changed activity with the wrist context and an average of 56.8% of the tuned TCFR channels and 52.3% of the tuned SBP channels significantly changed activity with the spring context. As both features had a similar proportion of tuned channels that were modulated by context changes, we opted to use SBP as the primary feature for the subsequent analyses in order to increase the number of tuned channels available for analysis.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>The number of channels tuned to any movement using two features (threshold crossing firing rate [TCFR] and spiking band power [SBP]) and the percentage of tuned channels that showed a significant change in neural feature between normal trials and trials in the tested context for four types of experimental sessions (Monkey N or Monkey W with the spring or wrist context).</title><p>Standard deviation (SD) is calculated across sessions of the same type and n is the number of sessions of that type which is indicated in the first column.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"/><th align="left" valign="top" colspan="2">TCFR</th><th align="left" valign="top" colspan="2">SBP</th></tr></thead><tbody><tr><td align="left" valign="top"/><td align="left" valign="top">Tuned channels</td><td align="left" valign="top">% Context modulated channels</td><td align="left" valign="top">Tuned channels</td><td align="left" valign="top">% Context modulated channels</td></tr><tr><td align="left" valign="top">Monkey N spring days (n=3)</td><td align="left" valign="top"><bold>38.3</bold> (SD = 4.0)</td><td align="left" valign="top"><bold>47.0%</bold> (SD = 2.8)</td><td align="left" valign="top"><bold>89.3</bold> (SD = 2.1)</td><td align="left" valign="top"><bold>61.7%</bold> (SD = 12.0)</td></tr><tr><td align="left" valign="top">Monkey N wrist days (n=2)</td><td align="left" valign="top"><bold>35.0</bold> (SD = 1.4)</td><td align="left" valign="top"><bold>43.1%</bold> (SD = 9.8)</td><td align="left" valign="top"><bold>84.5</bold> (SD = 7.8)</td><td align="left" valign="top"><bold>54.4%</bold> (SD = 0.8)</td></tr><tr><td align="left" valign="top">Monkey W spring days (n=3)</td><td align="left" valign="top"><bold>12.0</bold> (SD = 1.0)</td><td align="left" valign="top"><bold>66.5%</bold> (SD = 2.8)</td><td align="left" valign="top"><bold>35.0</bold> (SD = 6.9)</td><td align="left" valign="top"><bold>42.8%</bold> (SD = 7.1)</td></tr><tr><td align="left" valign="top">Monkey W wrist days (n=2)</td><td align="left" valign="top"><bold>11.5</bold> (SD = 3.5)</td><td align="left" valign="top"><bold>5.6%</bold> (SD = 7.9)</td><td align="left" valign="top"><bold>21.0</bold> (SD = 5.7)</td><td align="left" valign="top"><bold>20.9%</bold> (SD = 4.5)</td></tr></tbody></table></table-wrap></sec><sec id="s2-2"><title>Decoding neural activity across task context</title><p>After confirming that these context changes had large impacts on muscle activation (<xref ref-type="fig" rid="fig2">Figure 2</xref>) and affected many channels of neural activity (<xref ref-type="table" rid="table1">Table 1</xref>), we next asked how this will impact the ability to decode intended movements for BMI applications. Typically, BMIs use linear models to relate neural firing rates to the desired control variable (<xref ref-type="bibr" rid="bib1">Ajiboye et al., 2017</xref>; <xref ref-type="bibr" rid="bib39">Nason et al., 2021</xref>; <xref ref-type="bibr" rid="bib66">Wodlinger et al., 2015</xref>). Given the work showing that task changes similar to those tested here can alter how motor cortex linearly encodes muscle activations during different wrist movements across tasks (<xref ref-type="bibr" rid="bib42">Naufel et al., 2019</xref>), we next ask if the same is true for individuated finger movements. To test this, we recorded kinematics for both monkeys and muscle activations for Monkey N during the 2-DOF task and then trained linear models with data from normal trials to predict muscle activations or kinematics in unseen normal trials or other context trials.</p><p>We first present the results for decoding Monkey N’s muscle activations across context. <xref ref-type="fig" rid="fig3">Figure 3A</xref> shows average predictions of FDP and EDC muscle activations for normal trials and spring context trials from one example experimental day, both using a linear model trained on normal trials. We found that within-context linear models, that is models trained and tested on trials of the same context, could predict muscle activations well during individuated finger movements, with accuracy comparable to predictions of kinematics (<xref ref-type="supplementary-material" rid="supp1 supp2">Supplementary files 1 and 2</xref>). However, models trained on normal trials are consistently unable to predict muscle activations well in the off-context trials (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). For example, when springs are present the predictions do not account for the large changes in FDP activation magnitude or EDC activation during flexion trials (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, <xref ref-type="fig" rid="fig4">Figure 4</xref>). Across three sessions in each context including the wrist, spring, or both wrist and spring contexts, prediction mean-squared error (MSE) increased significantly from the normal trial baseline. This held true for both flexor muscles (FDP, FDPip) and extensor muscles (EDC, EIP) (evaluated by paired t-test, p&lt;2e-9), in each tested context, with an average increase of 188.7% across all context changes and muscles. The increases in error varied widely, ranging from a 21% increase (flexor muscles with wrist-flexed) to a 356% increase (flexor muscles with both wrist-flexed and springs).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Offline predictions of muscle activations.</title><p>(<bold>A</bold>) Recorded and predicted muscle activation traces for flexor digitorum profundus (FDP) muscle (top half) and extensor digitorum communis (EDC) muscle (bottom half) from one example session with Monkey N. Traces are aligned to peak movement and averaged over trials to the same target, shading represents one standard deviation. Predictions are from a model trained only on normal trials and the model is evaluated either on normal trials (top) or trials with springs present (bottom). r indicates the linear correlation coefficient between recorded and predicted muscle activations using all trials in the specified context for that session, excluding the normal context trials used for training the model where applicable. IF – index flexion, MF – MRS flexion, F – both fingers flexion, IE – index extension, ME – MRS extension, (<bold>E</bold>) – both fingers extension. (<bold>B</bold>) Change in prediction mean-squared error (MSE) when a model trained on normal trials is evaluated on trials in a different context. Color indicates which context is being tested, yellow is wrist, blue is spring, and both is red. Each dashed line and pair of dots represent one session during which the same model was used for both measurements. Error bars on the dots indicate one standard deviation for model performance calculated with 10-fold cross-validation. (<bold>C</bold>) Same as (<bold>B</bold>) but model performance is measured with prediction correlation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig3-v2.tif"/></fig><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Offline predictions of kinematics.</title><p>(<bold>A</bold>) Recorded and predicted position traces for index finger position (top) and middle-ring-small (MRS) finger group position (bottom), averaged across all trials toward each target. Shading represents one standard deviation. Predictions are from a model trained only on normal trials and the model is evaluated either on normal trials or trials with springs present. r indicates the linear correlation coefficient between recorded and predicted finger positions using all trials in the specified context for that session, excluding the normal context trials used for training the model where applicable. (<bold>B</bold>) Change in prediction mean-squared error (MSE) when a model trained on normal trials is evaluated on trials in a different context. Color indicates which context is being tested, yellow is wrist, blue is spring, and both is red. Each dashed line and pair of dots represent one session during which the same model was used for both measurements. Error bars on the dots indicate one standard deviation for model performance calculated with 10-fold cross-validation. (<bold>C</bold>) Same as (<bold>B</bold>) but model performance is measured with prediction correlation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig4-v2.tif"/></fig><p>We next asked whether this dramatic increase in prediction error is driven by a simple offset or magnitude change, or a reduced linear relationship with recorded muscle activations. For example, while the off-context predictions of FDP activation during flexion in <xref ref-type="fig" rid="fig3">Figure 3A</xref> both do not account for the offset in muscle activation at the beginning of trials and do not predict a large enough change in the magnitude of muscle activation throughout the trial, the same linear correlation is maintained. As a result, these predictions might only need a bias and scaling adjustment to recover performance. Alternatively, during flexion, the off-context predictions of EDC activation are less correlated with measured EDC activation because the model predicts EDC inactivation, which occurs during normal trials. However, in spring trials, measured EDC activation actually increases for flexion due to Monkey N co-contracting to move more stiffly. Since MSE is influenced by both changes to linear correlation and changes to offsets and scaling, we also measured prediction correlation (<xref ref-type="fig" rid="fig3">Figure 3C</xref>) which is less affected by the changes to offsets and scaling. Using the same sessions and models trained on normal trials as when we measured MSE, we found that prediction correlation decreased from normal baseline by an average of 25.8% across tested contexts and muscles. This change was significant for all tested contexts (paired t-test), ranging from a 2.4% decrease for FDPip in the wrist context (p=0.03) to a 69.4% decrease for EDC in the both context (p=1.3e-17). While significant, the change in correlation was a smaller effect than the change in MSE.</p><p>Kinematics are used as a control signal in BMI applications more frequently than muscle activation so we next examined the error in predicting finger position and velocity across contexts. <xref ref-type="fig" rid="fig4">Figure 4A</xref> shows trial-averaged predictions for each target from training a linear model on normal trials and predicting normal trials or spring trials for an example session with Monkey N. In both index and MRS flexion predictions, we observed the off-context predictions to be worse than the normal trial predictions. Predictions during the spring trials often showed a bias towards flexion. We measured changes in prediction accuracies on three days for each context – spring, wrist, and both – for Monkey N, and one additional day with each context for Monkey W (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, <xref ref-type="fig" rid="fig4">Figure 4C</xref>). All context changes resulted in significantly higher prediction MSE (paired t-test, p&lt;1e-4), averaging 68.2% for finger position and 11.4% for finger velocity. All context changes also resulted in small but significant decreases in prediction correlation (paired t-test, p&lt;1e-4), averaging -18.6% for finger position and -12.8% for finger velocity. The smaller change in the correlation of position predictions indicates that much of the prediction error is coming from offsets or magnitude differences in the predictions.</p></sec><sec id="s2-3"><title>Changing task context has small effects on online BMI performance</title><p>Based on these offline prediction results, we might expect that in a real-time BMI when cortical activity is controlling the virtual hand, a model trained on normal trials will be more difficult to use when controlling a virtual hand in a new context. We investigated this by training either a KF or a ReFIT Kalman filter (RFKF), as done previously by <xref ref-type="bibr" rid="bib39">Nason et al., 2021</xref>, and having the monkey control the virtual hand with the model while we applied context changes to this virtual task. Briefly, the KFs are standard position/velocity KFs that update virtual finger position by integrating the predicted finger velocity in the current time step. We introduced context changes in two separate ways. First, we added springs, a static wrist flexion, or both to the manipulandum and had the monkey control the virtual hand with an RFKF trained on normal trials. Second, we trained different KFs using training data collected in different contexts and had the monkeys use the KFs in the online task without any context changes applied to the manipulandum. Due to the quality of recorded neural signals, Monkey W controlled only 1-DOF online while Monkey N controlled 2-DOF online.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Online performance when context changes are tested by adding changes to the manipulandum during online trials.</title><p>(<bold>A</bold>) Example online session in which both the spring and the wrist context are tested. Each dot indicates acquisition time of one trial, each grouping of dots is a series of trials before the context was changed. Red bars and numbers above each grouping illustrate the median acquisition time (in seconds) for that series of trials. (<bold>B</bold>) Change in performance metrics between normal online trials and online trials with the context change indicated by the bar color in the manipulandum. Each bar indicates one session where off-context online trials are compared to the normal online trials immediately before and after them. Error bars indicate 99% confidence interval in performance metric change. Dashed line separates Monkey N sessions from Monkey W sessions. (<bold>C</bold>) Average acquisition time during the first five trials each time online trials were started, split between normal trials and trials with context changes applied to the hand (off-context). Acquisition times were z-scored within a series of trials in the same context. Red lines indicate the median. (<bold>D</bold>) Neural activity patterns for one example session. Neural activity patterns are velocity predictions at the time point of peak brain-machine interface (BMI) movement using a single linear regression model trained on normal offline trials. Each dot indicates the readout velocity for one trial using the same linear model but for either a normal trial (black) or an off-context trial (red). Larger open circles indicate the centroid of velocity readouts for trials to one of eight target directions split by normal and off-context trials. Shaded areas bound patterns for all trials excluding trials outside the 95th percentile of index or middle-ring-small (MRS) velocities.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>The correlation between hand position and online decode during the trials for each online comparison in <xref ref-type="fig" rid="fig5">Figure 5B</xref>.</title><p>Colors represent the type of context change (yellow – wrist, blue – springs, red – both wrist and springs), and shape indicates which monkey the session was with. Dotted line indicates equal hand-decode correlation in both types of trial.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Change in ‘pushing’ magnitude, that is the predicted velocity along the target direction, with predictions made by a linear regression model.</title><p>This was trained on normal trials offline and evaluated on neural data during online trials at the time point of peak movement. The change is between trials during normal online control and trials with a context changed added during online control. One dot indicates the two-sample t-score of this change calculated using all trials of one type (blue – flexion, red – extension, or black – split) in one session for Monkey N (top) or Monkey W (bottom). A change greater than 0 indicates a larger magnitude during the off-context trials, that is pushing harder.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig5-figsupp2-v2.tif"/></fig></fig-group><p>We first tested whether online BMI performance changed when using a standard RFKF with context changes added to the manipulandum, referred to as the manipulandum context change BMI experiments. One RFKF model could be tested on multiple context changes in a single session. For example, <xref ref-type="fig" rid="fig5">Figure 5A</xref> shows the acquisition times during an experimental session where two contexts, spring and wrist, were tested in sets of separate trials. <xref ref-type="fig" rid="fig5">Figure 5B</xref> summarizes the changes in online performance over six experimental sessions for Monkey N and four sessions for Monkey W. During these 10 sessions the context changes were tested 15 times: four times for the wrist context, seven times for the spring context, and four times for the combined wrist and spring context. Each bar compares the performance during one of the 15 tests between normal trials and one off-context condition in a session when using the same model for both. In two of these tests with Monkey N (one spring and one combined wrist and spring), random target presentation was used instead of center-out to increase task difficulty. Ultimately, both monkeys reached the same levels of performance despite added context changes to the manipulandum. Of the 15 tests, only one test resulted in a significant change in at least one of the performance metrics (p&lt;0.01, two-sample t-test). In this case, Monkey N using the RFKF while his wrist was flexed resulted in a 13.0% increase in time to target (p=6.7e-3), the equivalent of 86 ms. This overall lack of change was somewhat surprising since the offline decoding results had greater prediction error. The expectation was that when the monkey moved their hand along with the BMI task, the performance would be impacted due to the context change. However, the data show that the monkeys made small adjustments to how their hand moved with the online task (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p><p>To measure the amount that the monkeys had to adjust during online trials to get to average performance, we calculated the average acquisition time, defined as the time to reach the target plus the time to finish orbiting the target, for the first five trials after the start of online trials and compared that between normal and off-context runs of BMI trials. Acquisition times were z-scored within a series of trials performed in the same context before calculating the average in the first five trials. <xref ref-type="fig" rid="fig5">Figure 5C</xref> shows the distribution of these average acquisition times for every instance the online trials were started, split between normal trials and off-context trials. Monkey N had slightly worse initial performance during normal online BMI use as the average acquisition time during the first five trials was significantly greater than zero (p=0.002, one-sample Kolmogorov-Smirnov test). Monkey W, on the other hand, did not have significant adaptation from the first five BMI trials (p=0.22, one-sample Kolmogorov-Smirnov test). Interestingly, the performance in the first five off-context trials is not different from normal trials for both monkeys (two-sample Kolmogorov-Smirnov test, p=0.88 for Monkey N, p=0.79 for Monkey W). This suggests that adaptation to BMI with the context changes tested here is as difficult as adaptation from hand control to BMI control.</p><p>To help explain this minimal change in online performance, we examined the monkeys’ neural activity during online trials. Similar to other BMI adaptation work (<xref ref-type="bibr" rid="bib25">Golub et al., 2018</xref>), we used predicted velocities as a low-dimensional behaviorally relevant readout of neural activity during online trials. The velocity predictions are made using a linear regression model trained on SBP from the normal offline training trials in that session with an additional 250 ms history (five 50 ms bins) of SBP from each channel appended as additional features. We call the predicted index and MRS velocity at the time of peak online velocity the ‘neural activity pattern’ for that trial. An example session for Monkey N is shown in <xref ref-type="fig" rid="fig5">Figure 5D</xref> with trials split between normal BMI trials (black dots) and off-context BMI trials (red dots). This session was one of two sessions near the median change in online acquisition time between contexts across the 10 sessions for Monkey N. Open circles show the centroid of velocity readouts for all trials in that context toward the same target. The close proximity of the centroids and the overlap of the cluster of normal and off-context points in general indicate that similar neural activity patterns were being produced. This suggests that the monkey was using the same strategy in both types of trials even though the precise patterns may have differed. Across 13 online tests, the target neural activity pattern centroids did not change their magnitude along the target direction when compared between context for flexion targets, extension targets, and split targets (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>, two-sample t-test with 5% false discovery rate correction). Note that we excluded the two sessions with random target presentation from this analysis because trials did not have consistent target directions for calculating centroids.</p><p>In a second online experiment, referred to as the two decoder BMI experiments, the monkeys alternated between using two KFs: one trained on normal trials and another trained on off-context trials. In this paradigm the context change is added to the model used in closed loop BMI so that it directly impacts BMI control. Monkeys N and W performed these tests on 9 and 6 separate days, respectively. On each day, two decoders were trained in order to compare one context change. <xref ref-type="fig" rid="fig6">Figure 6A</xref> shows an example session alternating between a decoder trained on normal trials and a decoder trained on wrist trials. <xref ref-type="fig" rid="fig6">Figure 6B</xref> shows the performance changes for 15 sessions with five, six, and four sessions testing the wrist, spring, and combined wrist and spring contexts, respectively. In 15 sessions, this experiment revealed small but significant changes in at least one performance metric for 11 sessions (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, p&lt;0.01, two-sample t-test) although only two sessions had worse online performance for all three metrics. The significant decreases in performance averaged 32.6% for time to target, 46.5% for orbit time, and 8.5% for path efficiency, with the combined context having the largest effect.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Online performance when context changes were tested by using decoders trained with normal training data or off-context training data.</title><p>(<bold>A</bold>) Example online session in which the wrist context was tested. Each dot indicates acquisition time of one trial, and each grouping of dots is a series of trials before the context was changed. Red bars and numbers above each grouping illustrate the median acquisition time (in seconds) for that series of trials. (<bold>B</bold>) Change in performance metrics between normal online trials and online trials with the context change indicated by the bar color. Each bar represents one session where off-context online trials are compared to the normal online trials immediately before and after them. Error bars indicate 99% confidence interval in performance metric change. The dashed line separates Monkey N sessions from Monkey W sessions. (<bold>C</bold>) Average acquisition time during the first five trials each time online trials were started, split between trials performed with the model trained on normal trials and the model trained on off-context trials. Acquisition times were z-scored within a series of trials with the same model. Red lines indicate the median. (<bold>D</bold>) Neural activity patterns for one example session. Neural activity patterns are velocity predictions at the time point of peak brain-machine interface (BMI) movement using a single linear regression model trained on normal offline trials. Each dot indicates the readout velocity for one trial using the same linear model but for either a normal trial (black) or an off-context trial (red). Larger open circles indicate the centroid of velocity readouts for trials to one of eight target directions split by normal vs off-context trials. Shaded areas bound patterns for all trials excluding trials outside the 95th percentile of index or middle-ring-small (MRS) velocities.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Correlation between the velocity predictions made with each Kalman filter used in the two-model brain-machine interface (BMI) experiments for Monkey N.</title><p>Each Kalman filter was evaluated on all online trials in a session. One point indicates the correlation between these predictions with both Kalman filters used in one session.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Change in ‘pushing’ magnitude, that is the predicted velocity along the target direction, with predictions made by a linear regression model.</title><p>This was trained on normal trials offline and evaluated on neural data during online trials at the time point of peak movement. The change is between trials during normal online control and trials with a context changed added during online control. One dot indicates the two-sample t-score of this change calculated using all trials of one type (blue – flexion, red – extension, or black – split) in one session for Monkey N (top) or Monkey W (bottom). A change greater than 0 indicates a larger magnitude during the off-context trials, that is pushing harder. White asterisks indicate significant changes.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig6-figsupp2-v2.tif"/></fig></fig-group><p>We compared the acquisition time in the first five trials while using the normal decoder or an off-context decoder (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). Normal and off-context trials on average did not show different relative performance in the first five trials. Similar to <xref ref-type="fig" rid="fig5">Figure 5C</xref>, Monkey N had higher acquisition times in the first five trials (p=0.008, one-sample Kolmogorov-Smirnov test) that is the same between using the normal model and off-context models (p=0.99, two-sample Kolmogorov-Smirnov test). Monkey W once again did not show a significant initial adaptation (p=0.17, one-sample Kolmogorov-Smirnov test) which was the same between using the normal model and off-context models (p=0.5, two-sample Kolmogorov-Smirnov test). This indicates that for both monkeys, adapting to the off-context decoder was as difficult as adapting to the normal decoder.</p><p>As the off-context online performance was worse in many of the two decoder BMI sessions, we next asked if this BMI task required more adaptation than when context changes were added to the manipulandum. As done previously, we calculated neural activity patterns, that is velocity readouts from neural activity for each online trial. These patterns were calculated using one linear regression model trained on the normal context offline training trials from the same session. Ultimately, observed adaptation was a small effect, likely due to very high correlations between the velocity decodes with both KFs (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). Neural activity patterns for an example session for Monkey N with the median change in acquisition time are shown in <xref ref-type="fig" rid="fig6">Figure 6D</xref>. Neural activity patterns for trials using the normal model are represented in black and patterns for trials using the off-context model are represented in red. While the overall repertoire of neural activation patterns largely overlaps, we saw small shifts in the centroids of patterns for individual targets. These shifts in this session included higher velocity for flexion and smaller velocities for extension in the off-context trials. A shift toward higher velocities suggests that the monkey was ‘pushing’ harder during those trials. When comparing these centroids in all sessions the shifts along the target direction were generally larger for these two decoder sessions than the manipulandum context changing sessions (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). Additionally, across the 15 sessions there was a trend that if the monkey had to push harder, that would happen during flexion trials (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>), all three significant increases (two-sample t-test with 5% false discovery rate correction) were for flexion targets. Altogether, this indicates a small trend that the monkeys would re-aim during off-context flexion trials in the two decoder sessions by aiming for a target further from center (i.e. pushing harder).</p></sec><sec id="s2-4"><title>Context shifts population neural activity</title><p>To help explain how the monkeys were able to adjust to different contexts during the online task, we further examined changes in neural activity during the offline task in different contexts. First, we ask if there are any obvious trends in how the channel activity changes during simple 1-DOF movements, for example increasing neural activation when flexion requires more muscle activation. In one experimental session, Monkey N performed the 1-DOF task normally as well as in the wrist, spring, and rubber band contexts. The rubber bands altered the required muscle activations for the task in the same way as the springs, however to a larger extent, and as such were only used in this 1-DOF task. In two additional sessions, Monkey W performed the 1-DOF task normally as well as in the wrist context in one session and spring context in the other session. <xref ref-type="fig" rid="fig7">Figure 7A</xref> shows trial-averaged neural activation traces from two example modulated channels, one from each monkey, both comparing the activation during spring trials and normal trials. We found that neural channels showed a mix of changes with context. For example, Monkey W’s channel 12 was activated more compared to normal for spring flexion targets (blue solid), similar to the muscle activations of the finger flexors. However, other example channels like Monkey N’s channel 90 show less neural activation during movement in the spring contexts for both flexion and extension targets.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>The impact of context changes on neural activity.</title><p>(<bold>A</bold>) Trial-averaged spiking band power (SBP) for two channels during a spring session for each monkey. Trials were aligned to peak movement before averaging, vertical dashed lines indicate peak movement. Black traces show normal trials, blue traces show trials with springs present, solid traces are flexion trials, and dotted traces are extension trials. (<bold>B</bold>) Change in average SBP in a window around peak movement for each tuned channel for a spring session (left) and wrist session (right), both for Monkey W. Black dots indicate significant differences according to a two-sample t-test (p&lt;0.01). (<bold>C</bold>) Same as (<bold>B</bold>) but for Monkey N and using one session where the task was performed normally and in the spring, wrist, and rubber band contexts. (<bold>D</bold>) Principal angles between the PCA space calculated for normal trials and the PCA spaces calculated for spring trials (blue), band trials (green), or wrist trials (yellow). Black lines are average angles between PCA spaces for two random sets of normal trials, with gray shading indicating one standard deviation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig7-v2.tif"/></fig><p>To quantify changes in activation for the population of tuned channels, we compared the average channel activation in a window spanning 420 ms around peak movement for each type of trial. <xref ref-type="fig" rid="fig7">Figure 7B and C</xref> shows the change in SBP for all tuned channels between off-context trials and normal trials, split by flexion and extension trials, for Monkey W and Monkey N, respectively. Black dots indicate channels with significantly different trial SBP between off-context and normal trials toward that target according to a two-sample t-test (p&lt;0.01). During spring trials, context modulated channels were activated significantly less on average for extension and were activated significantly more for flexion with both monkeys (p&lt;0.01, paired t-test). During wrist trials, context modulated channels were activated significantly less for extension for Monkey N only (p&lt;0.01, paired t-test) and there were no trends for channels increasing or decreasing activation on average for flexion or extension for Monkey W. Notably, the majority of changes in neural activation are on the order of 10% or less for individual channels, fairly small relative to the large changes in muscle activation observed in <xref ref-type="fig" rid="fig2">Figure 2</xref>, which is consistent with the results from <xref ref-type="bibr" rid="bib42">Naufel et al., 2019</xref>, with wrist movements.</p><p>We next investigated how consistent the covariance structure of the neural activity is across different task contexts. We calculated the principal components (PCs) underlying the neural activity in each context in order to obtain one manifold for each context. We then found the minimum angles, also known as the principal angles, required to align the PCs from each type of off-context trial with the PCs calculated from normal trials (<xref ref-type="fig" rid="fig7">Figure 7D</xref>), similar to what has been previously presented (<xref ref-type="bibr" rid="bib19">Gallego et al., 2018</xref>). Principal angles were also calculated between manifolds calculated from random sets of normal trials to create a set of control angles. Two sessions with normal, spring, wrist flexed, and rubber band trials in the same session are included for Monkey N (<xref ref-type="fig" rid="fig7">Figure 7D</xref> Left), and two sessions, one with normal and wrist flexed and one with normal and spring trials, are included for Monkey W (<xref ref-type="fig" rid="fig7">Figure 7D</xref> Right). We found that the principal angles between off-context trial neural activity and normal trial neural activity match the normal control angles well. This indicates that the activity in each context falls within well-aligned manifolds.</p><p>Next we looked at how much variance in neural activity is due to the context changes. We calculated 16-dimensional demixed PCA (dPCA, <xref ref-type="bibr" rid="bib35">Kobak et al., 2016</xref>) components for a neural manifold spanning neural activity during trials from all contexts in a single session. <xref ref-type="fig" rid="fig8">Figure 8A</xref> shows the dPCA components for one session with Monkey N. The components are organized in rows according to which behavioral parameter they explain the most variance for: time (condition-independent), context, target, or context-target interaction. Using the four sessions included in <xref ref-type="fig" rid="fig7">Figure 7D</xref> and one additional session for Monkey N that included normal, spring, and rubber band trials, the amount of variance explained by each behavioral parameter is summarized in <xref ref-type="fig" rid="fig8">Figure 8B</xref> for both monkeys. The condition-independent and target components together explain the majority of the neural variance. On average, the target components explain 36.4% of neural variance, the condition-independent components explain 47.2% of neural variance, and the context and context-target interaction components together explain 24.1% of neural variance for Monkey N and 8.6% of neural variance for Monkey W.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Dimensionally reduced representation of neural activity across multiple context changes.</title><p>(<bold>A</bold>) Demixed PCA (dPCA) components for an example session with Monkey N performing normal trials (black), wrist trials (yellow), spring trials (blue), and rubber band trials (green). Solid traces are flexion trials, and dashed traces are extension trials. Components are organized by which behavioral parameter they explain the most neural variance for. Component numbers are ordered by how much neural variance they account for and the percent in brackets is the neural variance accounted for. (<bold>B</bold>) Percent of neural variance accounted for by each behavioral parameter. Bars with solid edges are for Monkey N, and bars with dashed edges are for Monkey W. Error bars indicate standard deviation across sessions. Three sessions are included for Monkey N, and two sessions are included for Monkey W. (<bold>C</bold>) Average muscle activation around peak movement for flexor muscles (top) or extensor muscles (bottom) during trials for each context and target plotted against the average activation of the first context-dependent dPCA component during the same trials. Each point represents the average activations in a series of trials in one context toward one target. Markers indicate which session the sample is from. Correlations are calculated within samples for one target, either flexion (red) or extension (black).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82598-fig8-v2.tif"/></fig><p>In inspecting the activation of components in <xref ref-type="fig" rid="fig8">Figure 8A</xref>, the context-related components add a shift to neural activity before and after movement (component #3) and separate normal and wrist trials from spring and rubber band trials during movement (component #6). This creates the picture of trajectories that are largely the same between context but slightly shifted, perhaps in response to a change in proprioceptive input or to generate more muscle activation. We compared the average activation around peak movement of the context-dependent dPCA component that explained the most neural variance with the average muscle activation of flexor or extensor muscles during flexion or extension trials in each context. <xref ref-type="fig" rid="fig8">Figure 8C</xref> shows this comparison for the three sessions with Monkey N included in <xref ref-type="fig" rid="fig8">Figure 8B</xref>. Note that one session only included normal, spring, and rubber band trials (no wrist). Interestingly, we found that the first context-dependent component correlated very strongly with the activation of the active muscle (i.e. flexor muscles during flexion or extensor muscles during extension) across contexts, with correlations of 0.91 for flexor muscles and –0.89 for extensor muscles. This result may suggest that a feature from neural activity could be used to account for changes in required muscle activation between contexts.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study we examined the impact of altering the context of a motor task, either adding an elastic resistance or postural change, while using a BMI for continuous finger control. These context changes represent a small sample of alterations found in activities of daily living but they include common changes to musculoskeletal properties of the hand during the task such as muscle tendon length and muscle activation range that give insight into how the results would extend to a wider range of changes. We found that changes in context increase the error of offline BMI decoder predictions significantly for both kinematics (<xref ref-type="fig" rid="fig4">Figure 4</xref>) and muscle activations (<xref ref-type="fig" rid="fig3">Figure 3</xref>). This effect was larger for predicting muscle activations than for predicting kinematics. In online trials using a kinematic-based BMI, the monkeys were able to quickly adjust for context changes and achieved comparable performance to normal online trials. We tested this in two ways. First, we added context changes to the manipulandum during online trials (<xref ref-type="fig" rid="fig5">Figure 5</xref>), which resulted in almost no change in online performance. Second, we trained two decoders (one on normal trials and the other on off-context trials) and swapped between them for closed-loop control (<xref ref-type="fig" rid="fig6">Figure 6</xref>), which resulted in small but significant decreases in online performance for the model trained on off-context trials.</p><p>During the offline tasks, many channels changed neural activity with context, with 20.9–61.7% of tuned SBP channels modulating activity with context (<xref ref-type="table" rid="table1">Table 1</xref>). The magnitude of these shifts were relatively small, especially when compared to the large changes in required muscle activation (<xref ref-type="fig" rid="fig2">Figure 2D–E</xref>), with weak trends to require greater activation for resisted flexion and lesser for assisted extension (<xref ref-type="fig" rid="fig7">Figure 7B–C</xref>). Additionally, the neural manifolds underlying movements in each context were well aligned (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). Using dPCA we found that while a large proportion of neural variance was explained by dPCA components that did not change with context, a significant proportion of the neural variance is associated with components that are context-dependent (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). Visually, the context components are shifting the trajectories without changing the overall shape and the shift in neural activity is strongly correlated with muscle activations in new contexts (<xref ref-type="fig" rid="fig8">Figure 8C</xref>). This agrees with other studies which found lower variance activity may be related to the actual motor commands (<xref ref-type="bibr" rid="bib19">Gallego et al., 2018</xref>; <xref ref-type="bibr" rid="bib47">Russo et al., 2018</xref>; <xref ref-type="bibr" rid="bib49">Saxena et al., 2022</xref>).</p><p>The similar online performance in each context, despite large offline mismatch, may be explained by a few possible factors. First would be if normal online trials are performed using a model that already does not capture the relationship between neural activity and intended finger movements well. In a control-systems perspective, online BMI control changes the ‘plant’ from native fingers to the virtual fingers on the screen. There is evidence that as a result of this, neural activity is different during online BMI control (<xref ref-type="bibr" rid="bib7">Carmena et al., 2003</xref>; <xref ref-type="bibr" rid="bib17">Fan et al., 2014</xref>; <xref ref-type="bibr" rid="bib20">Ganguly et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">Gilja et al., 2015</xref>; <xref ref-type="bibr" rid="bib32">Jarosiewicz et al., 2013</xref>; <xref ref-type="bibr" rid="bib44">Orsborn et al., 2012</xref>; <xref ref-type="bibr" rid="bib61">Taylor et al., 2002</xref>). Additionally, it is unlikely that a linear model like those used here robustly capture the relationship between motor cortex activity and kinematics. Due to the change in neural activity during online trials and inaccuracies in the decoding model, there is likely adjustment required by the monkey to use the BMI online during the normal setup. In this case, performing the online task in a new context is swapping one non-optimal decoder for a new one. In both BMI experiments, the initial BMI performance, that is the first five trials, was not worse for off-context trials as compared to normal online BMI trials, suggesting that both types of trials were of similar difficulty to adjust to (<xref ref-type="fig" rid="fig5">Figures 5C</xref> and <xref ref-type="fig" rid="fig6">6C</xref>).</p><p>The similar online performance could also be observed if the context change does not have a large impact on task-relevant neural activity. Studies into neural plasticity have shown that during a session of online trials, subjects can adjust to decoder perturbations that are within the same intrinsic manifold (<xref ref-type="bibr" rid="bib48">Sadtler et al., 2014</xref>). We found that individual channel activations change on up to 61.7% of channels that are important for decoding movements (<xref ref-type="table" rid="table1">Table 1</xref>), and this introduces error into model predictions. However, if the perturbations we introduced did not shift activity outside of the intrinsic manifold, then it may have been easy to adjust to the new context. Our data show a near instantaneous adaptation to the perturbations whereas Sadtler et al. found some within-manifold perturbations required on the order of hundreds of trials to adapt to, indicating that our perturbation was intuitive to adapt to. Analyzing the monkey’s strategy during the BMI task revealed that they were able to do the BMI task with perturbations to the hand without adjusting their strategy (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). This likely follows from the BMI task being driven by neural activity and visual feedback rather than movements of the hand itself. In the two decoder BMI task where off-context performance was often slightly worse, the monkeys did make small adjustments to perform the task (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). For example, they tended to ‘push’ harder to flex the virtual hand during off-context trials. This re-aiming strategy is similar to what has been described in other work on short-term learning with motor BMI (<xref ref-type="bibr" rid="bib25">Golub et al., 2018</xref>; <xref ref-type="bibr" rid="bib31">Jarosiewicz et al., 2008</xref>). In this case re-aiming likely stems from the need to reproduce a higher or lower neural activation online in order to use a model trained on data where channel activation increased for flexion and decreased for extension for the spring context (<xref ref-type="fig" rid="fig7">Figure 7B–C</xref>).</p><p>The online BMI experiments in this study used a kinematic-based BMI decoder. BMI studies typically predict kinematic variables for applications such as prosthesis control (<xref ref-type="bibr" rid="bib29">Hochberg et al., 2012</xref>; <xref ref-type="bibr" rid="bib66">Wodlinger et al., 2015</xref>) and cursor or virtual movement control (<xref ref-type="bibr" rid="bib23">Gilja et al., 2015</xref>; <xref ref-type="bibr" rid="bib28">Hochberg et al., 2006</xref>; <xref ref-type="bibr" rid="bib67">Young et al., 2019</xref>). In the offline predictions using linear models, we found that neither kinematics nor muscle activations could be predicted at the same accuracy in new contexts. While significant, kinematics, specifically flexion velocity, did show a smaller decrease in offline performance between contexts (<xref ref-type="fig" rid="fig4">Figure 4B–C</xref>). These results suggest that when designing BMI, using kinematic variables as a command signal may allow for better generalization when the biomechanics of the task are not important, such as virtual tasks.</p><p>However, in FES applications (<xref ref-type="bibr" rid="bib1">Ajiboye et al., 2017</xref>; <xref ref-type="bibr" rid="bib6">Bouton et al., 2016</xref>; <xref ref-type="bibr" rid="bib40">Nason-Tomaszewski et al., 2022</xref>), biomechanics are important. The final outputs are stimulation parameters that cause a desired amount of muscle contraction. Importantly, the required stimulation parameters could change with context due to the change in required muscle activation. As a result, even if predictions of position or velocity generalize well to new contexts, the mapping from kinematics to stimulation parameters would no longer be accurate. Our results with online BMI indicate that the monkeys are able to adapt by re-aiming with the BMI to restore some ability to do the virtual online task, which indicates they may also be able to re-aim in FES applications as well. However, in our task this adaptation occurred with a performance loss (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). Instead it would be better to account for how context changes the biomechanics of the task with the BMI. This could be done either through incorporating a better control system into the BMI, for example developing a controller to update stimulation parameters to match the decoded joint angle or velocity, or by better estimating the intended muscle activations from neural activity. Decoded intended muscle activations can be mapped to stimulation parameters as done by some FES studies (<xref ref-type="bibr" rid="bib14">Ethier et al., 2012</xref>; <xref ref-type="bibr" rid="bib27">Hasse et al., 2022</xref>).</p><p>With regard to decoding intended muscle activations, non-prehensile finger movements are less studied than arm movements and grasping, partly due to experimental difficulty, with much work coming from only a few datasets (<xref ref-type="bibr" rid="bib57">Shah et al., 2009</xref>; <xref ref-type="bibr" rid="bib50">Schieber, 1991</xref>). Although predictions of muscle activations from neural activity for muscles overlapping with those in this study have been done for movements of the wrist (<xref ref-type="bibr" rid="bib42">Naufel et al., 2019</xref>; <xref ref-type="bibr" rid="bib43">Oby et al., 2013</xref>) and grasp (<xref ref-type="bibr" rid="bib14">Ethier et al., 2012</xref>), predicting finger-related muscle activations during non-prehensile finger movements has to our knowledge not been attempted yet. Here, we found that we could decode muscle activations within each context during this individuated finger task with similar accuracy as decoding kinematics (<xref ref-type="supplementary-material" rid="supp1 supp2">Supplementary files 1 and 2</xref>).</p><p>Predicting muscle activation also led to the poorest offline generalization. The off-context predictions of muscle activation had both a large unaccounted for magnitude change and a lower correlation. We observed that neural features change by a relatively small magnitude (<xref ref-type="fig" rid="fig7">Figure 7B–C</xref>) whereas the muscle activation changes by large amounts (<xref ref-type="fig" rid="fig2">Figure 2D–E</xref>), resulting in linear models failing to predict a large enough scaling for off-context muscle activation. This observation matches studies of wrist movements where predicting muscle activation also did not generalize well (<xref ref-type="bibr" rid="bib42">Naufel et al., 2019</xref>). The lower correlation was partially driven by muscle activation patterns not observed in normal context training data, such as increased co-contracting flexor and extensor muscles during flexion trials to modulate stiffness when springs were present, as seen in <xref ref-type="fig" rid="fig3">Figure 3A</xref> where the predicted EDC activation does not increase for flexion in the spring condition. With a better model, it might be possible to pick out the relationship between neural activity and muscle activations. Determining for example that the intention is to activate EDC more, whether that is to co-contract with FDP or to extend the fingers may not matter as long as the intention can be accurately decoded. Based on these results, it’s likely that linear models are not able to pick out this relationship. Additionally, some prediction generalization error can be associated with the muscle activations being a higher dimensional variable than kinematics, with evidence that motor cortex can selectively activate or inactivate specific muscles (<xref ref-type="bibr" rid="bib51">Schieber et al., 2009</xref>). In this study there was no effort to estimate lower dimensional muscle synergies that may be underlying the observed muscle activations, but it is possible that cortical activity would relate more linearly to muscle synergies than to individual muscle activations.</p><p>An alternative BMI design approach to decoding movements is to use task-specific features to augment decoder models (<xref ref-type="bibr" rid="bib52">Schroeder et al., 2022</xref>). The context shifts studied here represent a small and discrete subset of the shifts found in activities of daily living, however they relate to continuous musculoskeletal properties that are shifting with the context, that is muscle length, co-contraction, or muscle activation magnitude. Identifying a feature in neural activity that accounts for the change in muscle activation across contexts would assist in decoder generalization. For example, the context-dependent neural activity that strongly correlated with muscle activations in new contexts (<xref ref-type="fig" rid="fig8">Figure 8C</xref>) could provide a feature for accounting for the scaling change while predicting muscle activation or allow models to modulate force or muscle activation while producing the same kinematics. More work is needed to understand if a neural feature like this would remain stable in different cognitive contexts, for example grasping or freely moving fingers as opposed to doing this virtual target acquisition task.</p><p>Nonlinear models could also improve predictions of intended muscle activation or kinematics from neural activity. Complex models are becoming more widely used in order to better model the relationship between motor cortex and intended movements (<xref ref-type="bibr" rid="bib24">Glaser et al., 2020</xref>; <xref ref-type="bibr" rid="bib53">Schwemmer et al., 2018</xref>; <xref ref-type="bibr" rid="bib60">Sussillo et al., 2012</xref>; <xref ref-type="bibr" rid="bib64">Willett et al., 2021</xref>; <xref ref-type="bibr" rid="bib65">Willsey et al., 2022</xref>). While a general concern for these nonlinear models is that they will overfit to the training data and not generalize well, given the correct training data they also may be able to identify less obvious trends that will distinguish between contexts and allow for better predictions. For example, <xref ref-type="bibr" rid="bib42">Naufel et al., 2019</xref>, were able to predict muscle activations in multiple wrist tasks after training an LSTM decoder on data from all of the tasks. This indicates that there may be enough information in neural features to distinguish between the different tasks. Our dPCA results indicate that around 24% of neural variance can be accounted for by context-specific activity (<xref ref-type="fig" rid="fig8">Figure 8B</xref>), so it is likely that a neural network would be able to take advantage of that information to make predictions in multiple contexts. More work will be needed to characterize how much training data these nonlinear models need in order to generalize to all the contexts experienced during activities of daily living.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><p>All procedures were approved by the University of Michigan Institutional Animal Care and Use Committee (protocol numbers PRO00010076 and PRO00008138).</p><sec id="s4-1"><title>Implants</title><p>We implanted two male rhesus macaques (Monkey N age 8–9, Monkey W age 8–9) with Utah microelectrode arrays (Blackrock Microsystems, Salt Lake City, UT, USA) in the hand area of precentral gyrus, as described previously (<xref ref-type="bibr" rid="bib30">Irwin et al., 2017</xref>; <xref ref-type="bibr" rid="bib39">Nason et al., 2021</xref>; <xref ref-type="bibr" rid="bib62">Vaskov et al., 2018</xref>). Two monkeys were chosen to ensure results are consistent between subjects. Monkey N was implanted with two 64-channel arrays in right hemisphere primary motor cortex and Monkey W was also implanted with two 96-channel arrays in right hemisphere primary motor cortex. Channels from both of Monkey N’s motor cortex arrays and from Monkey W’s lateral motor cortex array were used in this study, for a total of 96 channels from each monkey for analysis. The number of channels simultaneously recorded was limited to 96 due to the available recording hardware. Monkey N was between 511 and 1168 days post-cortical implant and Monkey W was between 254 and 411 days post-cortical implant during data collection.</p><p>Monkey N was also implanted with chronic bipolar intramuscular EMG recording electrodes (Synapse Biomedical, Inc, Oberlin, OH, USA) in a separate surgery as described previously (<xref ref-type="bibr" rid="bib39">Nason et al., 2021</xref>). The list of muscles targeted along with their function are included in <xref ref-type="table" rid="table2">Table 2</xref>. Briefly, muscles were accessed via dorsal and ventral incisions on the left forearm and specific muscles were surgically identified with the assistance of intraoperative stimulation. Bipolar electrodes were inserted and sutured into the muscle belly near the point of innervation and then tunneled over the elbow and shoulder to an interscapular exit site. The percutaneous electrodes were connected to a 16-channel PermaLoc connector. Monkey N was between 120 and 496 days post-EMG electrode implant for all EMG data collected.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>List of muscles targeted during surgery with their associated function.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Muscle</th><th align="left" valign="top">Function</th></tr></thead><tbody><tr><td align="left" valign="top">Extensor indicis proprius (EIP)</td><td align="left" valign="top">Index finger extensor</td></tr><tr><td align="left" valign="top">Flexor digitorum profundus, targeting MRS (FDP)</td><td align="left" valign="top">Finger flexor</td></tr><tr><td align="left" valign="top">Extensor digitorum communis (EDC)</td><td align="left" valign="top">Finger extensor</td></tr><tr><td align="left" valign="top">Extensor carpi radialis brevis (ECRB)</td><td align="left" valign="top">Wrist extensor</td></tr><tr><td align="left" valign="top">Flexor carpi ulnaris (FCU)</td><td align="left" valign="top">Wrist flexor/adductor</td></tr><tr><td align="left" valign="top">Flexor carpi radialis (FCR)</td><td align="left" valign="top">Wrist flexor</td></tr><tr><td align="left" valign="top">Flexor digitorum profundus, targeting index, proximal and distal sites (FDPip, FDPid)</td><td align="left" valign="top">Index finger flexor</td></tr></tbody></table></table-wrap></sec><sec id="s4-2"><title>Feature extraction</title><p>(TCFR and SBP) were recorded in real time during experiments using the Cerebus neural signal processor (Blackrock Microsystems). Threshold crossings were acquired by configuring the Cerebus to threshold each channel at –4.5 times the signal root-mean-square. For each threshold crossing, spike snippets were sent to a computer running xPC Target version 2012b (Mathworks) which saved the channel and time for each threshold crossing. SBP is an estimate of power in the 300–1000 Hz frequency band and was acquired by configuring the Cerebus to bandpass filter the raw signals to 300–1000 Hz using the Digital Filter Editor feature in the Central Software Suite version 6.5.4 (Blackrock Microsystems), then sample at 2 kHz. The filtered 2 kHz recording was then sent to the computer running xPC Target, which rectified and summed the samples on each channel received in each 1 ms iteration and counted the quantity of samples received each 1 ms so that SBP could later be averaged within longer time bins. Both the threshold crossings and SBP were saved by xPC synchronized with other real-time experimental information. Artifacts were removed for TCFR by removing threshold crossing times if 20 or more channels had threshold crossings in the same millisecond. Features were binned into non-overlapping bins of length 32 ms for online and offline decoding, or bins with a length of 20 ms for calculating tuning and comparing features across trials. SBP is summed for every 1 ms in the time bin and then divided by the total number of raw 2 kHz samples in the bin. For TCFR the spike counts are summed within a bin and then divided by the bin size to get a threshold crossing rate.</p><p>EMG from Monkey N’s eight bipolar electrodes was recorded for later offline synchronization. The percutaneous PermaLoc connector was connected to a CerePlex Direct (CPD) via a 64-channel splitter box and CerePlex A (Blackrock Microsystems) which converted the signals to the digital domain with unity gain. The CPD was configured to record 16 channels of raw signal at 10 kHz and for each bipolar pair the electrode implanted further inside the muscle was software referenced to the second electrode. These eight bipolar referenced channels are used in analyses. To synchronize EMG offline, we used the Sync Pulse functionality in Central to create unique pulses that were recorded by both the Cerebus and CPD and could later be used to align the Cerebus and CPD recordings. For offline analysis, muscle activations are estimated from the 10 kHz EMG recording by filtering with a second-order Butterworth bandpass filter between 100 and 500 Hz and then taking the mean absolute value of the filtered signal during every binning period.</p></sec><sec id="s4-3"><title>Experimental setup</title><p>During experiments the monkeys performed a virtual finger task while motor cortex activity and optionally arm muscle activity were recorded as described. Similar to previously described experiments (<xref ref-type="bibr" rid="bib30">Irwin et al., 2017</xref>; <xref ref-type="bibr" rid="bib39">Nason et al., 2021</xref>; <xref ref-type="bibr" rid="bib62">Vaskov et al., 2018</xref>), we used xPC Target to coordinate the experiment in real time. The xPC Target computer acquired and stored task parameters and neural features in real time, coordinated target presentation, acquired finger positions from the flex sensors on each finger group (FS-L-0073-103-ST, Spectra Symbol, Salt Lake City, UT, USA), and sent finger positions and target locations to a computer simulating movements of a virtual monkey hand (MusculoSkeletal Modeling Software) (<xref ref-type="bibr" rid="bib12">Davoodi et al., 2007</xref>). For online experiments, the xPC Target computer also binned threshold crossings and SBP in customizable bin sizes and evaluated the decoder model to predict finger positions in real time using an RFKF (see details below).</p></sec><sec id="s4-4"><title>Behavioral task</title><p>Monkeys N and W were trained to acquire virtual targets by moving their physical fingers in a manipulandum to control virtual fingers on a screen in front of them. All sessions took place in a shielded chamber with the monkey’s head fixed and arms restrained at their side with elbows bent 90 degrees and hands resting on a table in front of them. The left hand was placed in a manipulandum described previously (<xref ref-type="bibr" rid="bib39">Nason et al., 2021</xref>), with openings separating the index finger and the MRS finger group (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). The monkeys were trained to move the index finger independently of the MRS finger group (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), that is 2-DOF, although in some trials they moved both finger groups as 1-DOF. Each trial began with spherical targets appearing for each active finger group with each target occupying 15% of the full range of motion of the fingers. In the 1-DOF task the target was presented to the index finger.</p><p>Target presentation followed a center-out-and-back pattern with every other target presented at a center position, equivalent to 50% on a scale from 0% (full extension) to 100% (full flexion). Additionally, center was presented after any failed trial. The non-center targets were randomly selected from a set of targets. For 2-DOF the targets included any combination of index flexion, rest, or extension, and MRS flexion, rest, or extension, with a randomly chosen magnitude of 20%, 30%, or 40% of the full movement range. The split movements (index flexion with MRS extension or vice versa) did not have a 40% movement magnitude because the monkeys had difficulty splitting the finger groups that far. The 1-DOF movements were also center-out with the fingers flexing or extending either 40% from rest or a randomly chosen magnitude of 20%, 30%, or 40% from rest depending on the session, the former generally being used for tuning analyses and offline comparisons and the latter being used for online experiments. In each trial the monkey had to hold their fingers within the target(s) for 750 ms. During online decoding experiments, the same center-out-and-back target presentation order was used but the hold time was reduced to 500 ms. In one session used in offline analysis and four online sessions, the hold time was 2 ms longer than expected due to a minor bug. In two online experiments with the manipulandum context changing BMI task, targets were presented in a random order instead of center-out. In this target presentation, a target separation up to 50% of the movement range and a center position were randomly generated and one target for each finger group was presented at the generated target separation from each other, equidistant from the generated center position.</p><p>Task context was altered through four potential task alterations. One alteration was the addition of torsional springs to both finger groups (180 degree deflection angle, 0.028 in or 0.04 in wire diameter, Gardner Spring Inc, Tulsa, OK, USA), referred to as the ‘spring context’. The second alteration was the rotation of the manipulandum by 23 degrees in the flexion direction, referred to as the ‘wrist context’. A third alteration was introduced by attaching rubber bands from the back of the manipulandum to the door for each finger group, thereby resisting flexion, referred to as the ‘rubber band context’. A last alteration was addition of torsional springs and the rotation of the manipulandum by 23 degrees at the same time, referred to as the ‘both context’. Trials performed with one of these alterations are referred to as ‘off-context’ trials, while trials performed without alterations are referred to as ‘normal’ trials. As the index finger alone is much weaker than the MRS finger group, the index finger used a smaller spring when applicable. The added springs increased the force required for full flexion by 9.5 N (for MRS) and 3.3 N (for index), while the rubber bands increased the force required for full flexion by 16.5 N. The rubber band context was only done by Monkey N and in a 1-DOF task due to task difficulty. For reference, full flexion required approximately 1.3 N of force without the springs or bands.</p></sec><sec id="s4-5"><title>Comparison of kinematics and muscle activation between contexts</title><p>Three representative sessions for both Monkey N and Monkey W, 1 day for each context – spring or wrist – were used to compare kinematics across contexts. During data collection, normal trials and off-context trials were interleaved by alternating context type every 175–350 trials in order to control for changes in behavior over time. During these representative days, there was an average of 1134 normal trials and 1118 off-context trials per day for Monkey N and 526 normal trials and 504 off-context trials per day for Monkey W. To compute how finger velocity changed between normal trials and off-context trials, the peak velocity of finger movements was found for every trial. For every trial, the recorded finger flexions were downsampled to 20 ms and filtered with a second-order Savitzky-Golay FIR filter. Finger velocity was estimated from the downsampled and filtered finger positions and maximum finger speeds were found. The peak movement time was taken at the time of the largest peak in speed after trial start. Trials were then split by context and target direction (flexion vs. extension), and a two-sample t-test was used to compare peak speeds and compute a 99% confidence interval, once for flexion targets and again for extension targets. Comparisons were made only between trials to the same target, leaving about 281 trials per group and 129 trials per group for each comparison for Monkey N and Monkey W, respectively.</p><p>The same sessions for Monkey N used to compare kinematics were also used to compare muscle activations. The recorded EMG was filtered and the mean absolute value was taken in 20 ms bins as described previously. Binned muscle activations were then smoothed with a 100 ms Gaussian kernel. One value was obtained for every trial by taking the average muscle activation in a 420 ms window around peak movement, including 10 bins before peak movement, the bin that included peak movement, and 10 bins after peak movement. These muscle activation values were grouped by context and target, then compared with a two-sample t-test.</p></sec><sec id="s4-6"><title>Computation of neural tuning and context modulation</title><p>During five representative experiments for each monkey, three that tested the spring context and two that tested the wrist context, we calculated the number of channels that were significantly modulated by any finger movement and the number of channels with a change in activity between normal trials and off-context trials. During these sessions, the monkeys performed the task with all fingers moving together (1-DOF), in a center-out task as described, to targets at either plus or minus 40% from center. Trials that were unsuccessful and trials following unsuccessful trials were removed. Unsuccessful trials were rare, often only occurring on the first or last trial of a block of trials. There was an average of 1072 normal trials and 747 off-context trials for Monkey N and 544 normal trials and 387 off-context trials for Monkey W were used during these sessions.</p><p>Channel tuning and context modulation was calculated with both the SBP features and TCFR features. On each day, features and kinematics were averaged into non-overlapping 20 ms bins, data from normal trials and off-context trials were concatenated together, and the SBP and TCFR were each normalized to zero mean and unit standard deviation. An optimal lag was calculated for each channel by maximizing the L2-norm of regression coefficients between a feature and finger position and velocity. Features at that optimal lag were then regressed with finger position and velocity one at a time with an added effect for context following these equations:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the T × 1 vector containing T bins of channel SBP or TCFR for channel n, c is an indicator variable that equals one if that sample was during an off-context trial or zero otherwise, Y is a T × 2 matrix containing finger position and velocity, B is the trained linear offset, and W<sub>n</sub> is the 2×2 matrix of trained weights relating channel n’s activity to finger position and velocity. A channel was called tuned if the regression coefficient between the neural feature and either finger position or velocity, that is w<sub>1,1</sub> or w<sub>1,2</sub>, were significantly different from zero, via a t-test on the regression coefficient. A channel was also called context modulated if either coefficient in the second row of W<sub>n</sub>, which includes the effect of context, was significantly different from zero, also via a t-test, indicating a different slope relating neural activity and kinematics between normal trials and off-context trials. False discovery rate correction was applied to each session at a level of 0.1%.</p><p>To quantify the change in neural activity between contexts as in <xref ref-type="fig" rid="fig7">Figure 7</xref>, we used one representative session for Monkey N in which trials were done in the normal, spring, wrist, and rubber band contexts. An additional two representative sessions for Monkey W were used, one session comparing normal and spring trials and another session comparing normal and wrist trials, both performed with 1-DOF movements and with targets to 40% flexion or extension from rest only. Tuned channels were calculated as previously described using the SBP feature. For every trial, the SBP was binned into 20 ms bins and then smoothed with a 100 ms Gaussian kernel. Then the average activity in a window spanning 200 ms before and 200 ms after the bin containing peak movement was calculated for each tuned channel. The trials were then split by context and by target, and the trial SBP values were compared between contexts with a two-sample t-test.</p></sec><sec id="s4-7"><title>Offline predictions</title><p>Data from nine sessions with Monkey N, three for each context (springs, wrist, and both), were used for offline muscle activation and kinematic predictions, and three sessions for Monkey W, one for each context, were used for offline kinematic predictions. During these sessions, both monkeys performed the 2-DOF center-out task. Blocks of normal trials and off-context trials were interleaved by alternating context in order to control for changes in neural activity over time. Trials that were unsuccessful were removed before analysis. There was an average of 803 normal trials and 470 off-context trials for Monkey N and 737 normal trials and 329 off-context trials for Monkey W. To account for changes in monkey motivation, sessions chosen were those with consistent prediction accuracy between early and late normal trials within a session. These sessions spanned 165 days starting 792 days post-cortical array implant and 120 days post-EMG electrode implant for Monkey N, and 63 days starting 285 days post-cortical array implant for Monkey W.</p><p>In each session, SBP and muscle activations or kinematics were binned into 32 ms bins and features were concatenated across trials of the same context. The SBP channels were masked to those with an average TCFR greater than 1 Hz across a session and 12 bins of history from each of these channels were used as additional features. Ridge regression relating SBP to muscle activations or kinematics was trained on normal trials and then tested on both normal trials and off-context trials with 10-fold cross-validation. To do this, the normal trials were split into 10 folds with an equivalent number of bins in each fold, a model was trained on nine folds, and then tested on the left-out fold as well as on data from off-context trials. We used two metrics to evaluate prediction accuracy. First we used the Pearson correlation coefficient between the predicted and measured muscle activations or kinematics to establish how well the predictions are linearly correlated with measurements. The second metric was MSE normalized by the variance of the measured data (MSE). Normalizing by the variance allows for better comparison across test datasets as they may have different variances. In this formulation, the MSE is the fraction of unexplained variance or one minus the variance accounted for or coefficient of determination used in previous studies (<xref ref-type="bibr" rid="bib16">Fagg et al., 2009</xref>; <xref ref-type="bibr" rid="bib42">Naufel et al., 2019</xref>). Values greater than one indicate that the predictions are introducing variance compared to the worst possible least-squares predictor, that is predicting the mean.</p></sec><sec id="s4-8"><title>Online decoding</title><p>We used either a KF or an RFKF (<xref ref-type="bibr" rid="bib22">Gilja et al., 2012</xref>) to predict intended finger movements for all BMI experiments, as done previously (<xref ref-type="bibr" rid="bib30">Irwin et al., 2017</xref>; <xref ref-type="bibr" rid="bib39">Nason et al., 2021</xref>; <xref ref-type="bibr" rid="bib62">Vaskov et al., 2018</xref>). We performed two types of online experiments. In the first experiments, an RFKF was trained on normal trials and then used during trials with context changes in the manipulandum or without any additions to the manipulandum. To train the model, monkeys first performed at least 300 trials of center-out manipulandum control with 750 ms hold time. Using these trials, we trained a position/velocity KF which the monkeys used online for at least 200 trials, with a 32 ms update rate and a 500 ms hold time. To use the KF, virtual finger position was updated by integrating the predicted velocity in the current time step to update the previous step’s finger position. An RFKF was then trained, as done previously (<xref ref-type="bibr" rid="bib39">Nason et al., 2021</xref>), by rotating incorrect velocities during online control with the KF to be toward the intended target represented in a two-dimensional space, setting finger velocity equal to zero when in the correct target, and then retraining regression coefficient matrices. The RFKF was used online for blocks of 100–200 trials with different context changes applied to the manipulandum, alternating between normal trials and other contexts. Multiple contexts could be tested in one session during these experiments by switching out the context manipulations present in the manipulandum.</p><p>In the second set of online experiments, two KFs were trained in one session and then used alternatingly in online control without any changes present in the manipulandum. During these sessions, the monkeys first performed at least 300 trials of center-out manipulandum control, followed by another 300 or more trials of center-out manipulandum control with a context change present. One model was trained using each set of trials. The monkeys then used these models in online control for sets of 100–200 trials, and then the models were alternated. Hold times and update rates were kept consistent between types of experiments and sessions.</p></sec><sec id="s4-9"><title>Online performance measures</title><p>We estimated online performance with acquisition time, time to target, orbiting time, and path efficiency. Acquisition time was measured as the total time from target presentation to the end of the trial minus the hold time, therefore ending with the target being successfully acquired. Time to target was taken as the time from target presentation to the first time where all fingers with targets were in their targets. Orbiting time was then calculated as the time from all fingers first reaching their targets to the end of the trial minus the hold time. Trials where the fingers reached the targets and never left therefore had an orbiting time of 0 ms. Failed trials were excluded when comparing online performance between context but not for evaluating the monkeys adaptation within the first five trials. Path efficiency was calculated as the ratio of the shortest distance between the fingers’ starting positions and the target positions projected onto a two-dimensional space, to the length of the path traveled by the fingers.</p></sec><sec id="s4-10"><title>Online neural activity patterns</title><p>To visualize neural activity during online trials, the normal offline training trials used to train the KF were used to train a new linear readout between neural activity and finger velocities. Neural activity from these trials was binned in 50 ms intervals, then neural activity in the current bin and the five most recent bins were regressed with the finger velocities during these trials to obtain one set of weights for that session. This model was then used to predict velocities from neural activity during the online trials. The predictions at the time point in the trial with the peak online velocity toward the target during the online trial were taken as the online neural activity patterns. To compare neural activity patterns across multiple targets in multiple sessions, the neural activity patterns for each trial were projected onto the target direction for each trial to obtain one ‘pushing magnitude’, or the velocity magnitude that they were pushing toward the target direction. Pushing magnitudes were collected for each trial, separated for flexion trials (IF, MF, IF+MF), extension trials (IE, ME, IE+ME), and split trials (IF+ME, IE+MF), and then the pushing magnitudes for each set of trials were compared between normal trials and off-context trials using a two-sample t-test.</p></sec><sec id="s4-11"><title>Dimensionality reduction</title><p>To investigate changes in population neural activity due to changes in context, two sessions of 1-DOF center-out trials with targets of 40% flexion or extension from rest were used for each monkey. For Monkey N, both sessions included trials where the task was performed in the normal, spring, rubber band, and wrist contexts. For Monkey W, one session included trials in the normal and spring contexts, and the other session included trials in the normal and wrist contexts. SBP was binned into 20 ms bins, masked to only include channels with TCFR greater than 1 Hz, and then for each trial a time frame 400 ms before to 740 ms after the bin containing peak movement was taken from each trial. The neural activity for trials within a single context was concatenated and averaged across trials with the same context and target forming an N × T × D data structure for each context, where N is the number of channels, T is the number of bins per trial used, and D is the number of targets. Neural data was then concatenated across targets to form an N × (T*D) matrix and then we used PCA to calculate a manifold for each context, keeping the top 16 components for Monkey N and eight components for Monkey W, which explained 86% of variance on average. Principal angles were found between the manifolds following methods used previously (<xref ref-type="bibr" rid="bib5">Björck and Golub, 1973</xref>; <xref ref-type="bibr" rid="bib19">Gallego et al., 2018</xref>). These principal angles are the minimal angles required to align the manifolds and serve as a measure for how well aligned two manifolds are. As a control, two sets of 50 trials were taken from the normal trials and used to calculate two manifolds in the same way. The principal angles between these manifolds were then calculated. The sampling and angle calculations were repeated 100 times to obtain a control distribution of principal angles.</p><p>We also calculated one manifold spanning trials from all contexts tested in one session. This was done using dPCA (<xref ref-type="bibr" rid="bib35">Kobak et al., 2016</xref>). This approach finds a single neural manifold that reduces the dimensionality of the data while maintaining a linear readout that can reconstruct the mean neural activation associated with manually chosen behavioral variables. In this instance, the behavioral parameters chosen were target, that is either flexion or extension, and which context the task was done in. MATLAB code for calculating dPCA components was downloaded from <ext-link ext-link-type="uri" xlink:href="http://github.com/machenslab/dPCA">http://github.com/machenslab/dPCA</ext-link>, SBP was binned into 20 ms bins, masked to include only channels with TCFR greater than 1 Hz, and then concatenated into an N × C × D × T × n data structure where N, D, and T follow the same structure as the PCA calculations, n is the number of trials per condition, and C is the number of contexts tested in that session. SBP was averaged over the number of trials, n, to form the peristimulus-time-histograms for each target and context combination, after which dPCA components were calculated. Neural variance of a behavioral parameter was obtained by calculating the variance within the marginalization of neural data based on each behavioral parameter and taking the ratio of the total variance in a marginalization to the total variance in the neural data.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Software, Investigation, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Validation, Investigation, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Validation, Investigation, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Validation, Investigation, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Writing - review and editing</p></fn><fn fn-type="con" id="con7"><p>Writing - review and editing</p></fn><fn fn-type="con" id="con8"><p>Writing - review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Supervision, Funding acquisition, Writing - review and editing</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Supervision, Funding acquisition, Methodology, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>All protocols were in accord with the National Institutes of Health guidelines and approved by the University of Michigan Institutional Animal Care and Use Committee (protocol numbers PRO00010076 and PRO00008138).</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Average prediction correlation when using ridge regression models to predict muscle activations or kinematics with the same or different test contexts.</title><p>Results for Monkey N using the same sessions included in <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref> and for Monkey W using the same sessions included in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p></caption><media xlink:href="elife-82598-supp1-v2.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Average prediction mean-squared error (MSE) when using ridge regression models to predict muscle activations or kinematics with the same or different test contexts.</title><p>Results for Monkey N using the same sessions included in <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref> and for Monkey W using the same sessions included in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p></caption><media xlink:href="elife-82598-supp2-v2.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-82598-mdarchecklist1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Neural, behavioral, EMG, and online BMI performance data has been deposited in the Dryad repository (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.p2ngf1vtn">https://doi.org/10.5061/dryad.p2ngf1vtn</ext-link>).</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Mender</surname><given-names>MJ</given-names></name><name><surname>Nason-Tomaszewski</surname><given-names>SR</given-names></name><name><surname>Temmar</surname><given-names>H</given-names></name><name><surname>Costello</surname><given-names>JT</given-names></name><name><surname>Wallace</surname><given-names>DM</given-names></name><name><surname>Willsey</surname><given-names>MS</given-names></name><name><surname>Ganesh Kumar</surname><given-names>N</given-names></name><name><surname>Kung</surname><given-names>TA</given-names></name><name><surname>Patil</surname><given-names>P</given-names></name><name><surname>Chestek</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Data from: The impact of task context on predicting finger movements in a brain-machine interface</data-title><source>Dryad Digital Repository</source><pub-id pub-id-type="doi">10.5061/dryad.p2ngf1vtn</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Eric Kennedy for animal and experimental support and the University of Michigan Unit for Laboratory Animal Medicine for expert veterinary and surgical support. We appreciate Chris Andrew’s expert statistical assistance and the support of the University of Michigan Biointerfaces Institute.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ajiboye</surname><given-names>AB</given-names></name><name><surname>Willett</surname><given-names>FR</given-names></name><name><surname>Young</surname><given-names>DR</given-names></name><name><surname>Memberg</surname><given-names>WD</given-names></name><name><surname>Murphy</surname><given-names>BA</given-names></name><name><surname>Miller</surname><given-names>JP</given-names></name><name><surname>Walter</surname><given-names>BL</given-names></name><name><surname>Sweet</surname><given-names>JA</given-names></name><name><surname>Hoyen</surname><given-names>HA</given-names></name><name><surname>Keith</surname><given-names>MW</given-names></name><name><surname>Peckham</surname><given-names>PH</given-names></name><name><surname>Simeral</surname><given-names>JD</given-names></name><name><surname>Donoghue</surname><given-names>JP</given-names></name><name><surname>Hochberg</surname><given-names>LR</given-names></name><name><surname>Kirsch</surname><given-names>RF</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Restoration of reaching and grasping movements through brain-controlled muscle stimulation in a person with Tetraplegia: a proof-of-concept demonstration</article-title><source>The Lancet</source><volume>389</volume><fpage>1821</fpage><lpage>1830</lpage><pub-id pub-id-type="doi">10.1016/S0140-6736(17)30601-3</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ames</surname><given-names>KC</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Motor cortex signals for each arm are mixed across hemispheres and neurons yet Partitioned within the population response</article-title><source>eLife</source><volume>8</volume><elocation-id>e46159</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.46159</pub-id><pub-id pub-id-type="pmid">31596230</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Targeting recovery: priorities of the spinal cord-injured population</article-title><source>Journal of Neurotrauma</source><volume>21</volume><fpage>1371</fpage><lpage>1383</lpage><pub-id pub-id-type="doi">10.1089/neu.2004.21.1371</pub-id><pub-id pub-id-type="pmid">15672628</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Badi</surname><given-names>M</given-names></name><name><surname>Wurth</surname><given-names>S</given-names></name><name><surname>Scarpato</surname><given-names>I</given-names></name><name><surname>Roussinova</surname><given-names>E</given-names></name><name><surname>Losanno</surname><given-names>E</given-names></name><name><surname>Bogaard</surname><given-names>A</given-names></name><name><surname>Delacombaz</surname><given-names>M</given-names></name><name><surname>Borgognon</surname><given-names>S</given-names></name><name><surname>C Vanc Ara</surname><given-names>P</given-names></name><name><surname>Fallegger</surname><given-names>F</given-names></name><name><surname>Su</surname><given-names>DK</given-names></name><name><surname>Schmidlin</surname><given-names>E</given-names></name><name><surname>Courtine</surname><given-names>G</given-names></name><name><surname>Bloch</surname><given-names>J</given-names></name><name><surname>Lacour</surname><given-names>SP</given-names></name><name><surname>Stieglitz</surname><given-names>T</given-names></name><name><surname>Rouiller</surname><given-names>EM</given-names></name><name><surname>Capogrosso</surname><given-names>M</given-names></name><name><surname>Micera</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Intrafascicular peripheral nerve stimulation produces fine functional hand movements in primates</article-title><source>Science Translational Medicine</source><volume>13</volume><elocation-id>eabg6463</elocation-id><pub-id pub-id-type="doi">10.1126/scitranslmed.abg6463</pub-id><pub-id pub-id-type="pmid">34705521</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Björck</surname><given-names>Ȧke</given-names></name><name><surname>Golub</surname><given-names>GH</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>Numerical methods for computing angles between linear subspaces</article-title><source>Mathematics of Computation</source><volume>27</volume><fpage>579</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1090/S0025-5718-1973-0348991-3</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouton</surname><given-names>CE</given-names></name><name><surname>Shaikhouni</surname><given-names>A</given-names></name><name><surname>Annetta</surname><given-names>NV</given-names></name><name><surname>Bockbrader</surname><given-names>MA</given-names></name><name><surname>Friedenberg</surname><given-names>DA</given-names></name><name><surname>Nielson</surname><given-names>DM</given-names></name><name><surname>Sharma</surname><given-names>G</given-names></name><name><surname>Sederberg</surname><given-names>PB</given-names></name><name><surname>Glenn</surname><given-names>BC</given-names></name><name><surname>Mysiw</surname><given-names>WJ</given-names></name><name><surname>Morgan</surname><given-names>AG</given-names></name><name><surname>Deogaonkar</surname><given-names>M</given-names></name><name><surname>Rezai</surname><given-names>AR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Restoring cortical control of functional movement in a human with Quadriplegia</article-title><source>Nature</source><volume>533</volume><fpage>247</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1038/nature17435</pub-id><pub-id pub-id-type="pmid">27074513</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carmena</surname><given-names>JM</given-names></name><name><surname>Lebedev</surname><given-names>MA</given-names></name><name><surname>Crist</surname><given-names>RE</given-names></name><name><surname>O’Doherty</surname><given-names>JE</given-names></name><name><surname>Santucci</surname><given-names>DM</given-names></name><name><surname>Dimitrov</surname><given-names>DF</given-names></name><name><surname>Patil</surname><given-names>PG</given-names></name><name><surname>Henriquez</surname><given-names>CS</given-names></name><name><surname>Nicolelis</surname><given-names>MAL</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Learning to control a brain-machine interface for reaching and grasping by primates</article-title><source>PLOS Biology</source><volume>1</volume><elocation-id>E42</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0000042</pub-id><pub-id pub-id-type="pmid">14624244</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Churchland</surname><given-names>MM</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Temporal complexity and heterogeneity of single-neuron activity in Premotor and motor cortex</article-title><source>Journal of Neurophysiology</source><volume>97</volume><fpage>4235</fpage><lpage>4257</lpage><pub-id pub-id-type="doi">10.1152/jn.00095.2007</pub-id><pub-id pub-id-type="pmid">17376854</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Churchland</surname><given-names>MM</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Kaufman</surname><given-names>MT</given-names></name><name><surname>Foster</surname><given-names>JD</given-names></name><name><surname>Nuyujukian</surname><given-names>P</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neural population Dynamics during reaching</article-title><source>Nature</source><volume>487</volume><fpage>51</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1038/nature11129</pub-id><pub-id pub-id-type="pmid">22722855</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collinger</surname><given-names>JL</given-names></name><name><surname>Boninger</surname><given-names>ML</given-names></name><name><surname>Bruns</surname><given-names>TM</given-names></name><name><surname>Curley</surname><given-names>K</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Weber</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2013">2013a</year><article-title>Functional priorities, Assistive technology, and brain-computer interfaces after spinal cord injury</article-title><source>Journal of Rehabilitation Research and Development</source><volume>50</volume><fpage>145</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1682/jrrd.2011.11.0213</pub-id><pub-id pub-id-type="pmid">23760996</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collinger</surname><given-names>JL</given-names></name><name><surname>Wodlinger</surname><given-names>B</given-names></name><name><surname>Downey</surname><given-names>JE</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Tyler-Kabara</surname><given-names>EC</given-names></name><name><surname>Weber</surname><given-names>DJ</given-names></name><name><surname>McMorland</surname><given-names>AJC</given-names></name><name><surname>Velliste</surname><given-names>M</given-names></name><name><surname>Boninger</surname><given-names>ML</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2013">2013b</year><article-title>High-performance Neuroprosthetic control by an individual with Tetraplegia</article-title><source>Lancet</source><volume>381</volume><fpage>557</fpage><lpage>564</lpage><pub-id pub-id-type="doi">10.1016/S0140-6736(12)61816-9</pub-id><pub-id pub-id-type="pmid">23253623</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davoodi</surname><given-names>R</given-names></name><name><surname>Urata</surname><given-names>C</given-names></name><name><surname>Hauschild</surname><given-names>M</given-names></name><name><surname>Khachani</surname><given-names>M</given-names></name><name><surname>Loeb</surname><given-names>GE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Model-based development of neural Prostheses for movement</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>54</volume><fpage>1909</fpage><lpage>1918</lpage><pub-id pub-id-type="doi">10.1109/TBME.2007.902252</pub-id><pub-id pub-id-type="pmid">18018686</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Downey</surname><given-names>JE</given-names></name><name><surname>Brane</surname><given-names>L</given-names></name><name><surname>Gaunt</surname><given-names>RA</given-names></name><name><surname>Tyler-Kabara</surname><given-names>EC</given-names></name><name><surname>Boninger</surname><given-names>ML</given-names></name><name><surname>Collinger</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Motor cortical activity changes during Neuroprosthetic-controlled object interaction</article-title><source>Scientific Reports</source><volume>7</volume><elocation-id>16947</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-017-17222-3</pub-id><pub-id pub-id-type="pmid">29209023</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ethier</surname><given-names>C</given-names></name><name><surname>Oby</surname><given-names>ER</given-names></name><name><surname>Bauman</surname><given-names>MJ</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Restoration of grasp following paralysis through brain-controlled stimulation of muscles</article-title><source>Nature</source><volume>485</volume><fpage>368</fpage><lpage>371</lpage><pub-id pub-id-type="doi">10.1038/nature10987</pub-id><pub-id pub-id-type="pmid">22522928</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evarts</surname><given-names>EV</given-names></name></person-group><year iso-8601-date="1968">1968</year><article-title>Relation of pyramidal tract activity to force exerted during voluntary movement</article-title><source>Journal of Neurophysiology</source><volume>31</volume><fpage>14</fpage><lpage>27</lpage><pub-id pub-id-type="doi">10.1152/jn.1968.31.1.14</pub-id><pub-id pub-id-type="pmid">4966614</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fagg</surname><given-names>AH</given-names></name><name><surname>Ojakangas</surname><given-names>GW</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name><name><surname>Hatsopoulos</surname><given-names>NG</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Kinetic trajectory decoding using motor cortical ensembles</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source><volume>17</volume><fpage>487</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2009.2029313</pub-id><pub-id pub-id-type="pmid">19666343</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fan</surname><given-names>JM</given-names></name><name><surname>Nuyujukian</surname><given-names>P</given-names></name><name><surname>Kao</surname><given-names>JC</given-names></name><name><surname>Chestek</surname><given-names>CA</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Intention estimation in brain machine interfaces</article-title><source>Journal of Neural Engineering</source><volume>11</volume><elocation-id>016004</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/11/1/016004</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallego</surname><given-names>JA</given-names></name><name><surname>Perich</surname><given-names>MG</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name><name><surname>Solla</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Neural Manifolds for the control of movement</article-title><source>Neuron</source><volume>94</volume><fpage>978</fpage><lpage>984</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.05.025</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallego</surname><given-names>JA</given-names></name><name><surname>Perich</surname><given-names>MG</given-names></name><name><surname>Naufel</surname><given-names>SN</given-names></name><name><surname>Ethier</surname><given-names>C</given-names></name><name><surname>Solla</surname><given-names>SA</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Cortical population activity within a preserved neural manifold underlies multiple motor behaviors</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>4233</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-06560-z</pub-id><pub-id pub-id-type="pmid">30315158</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ganguly</surname><given-names>K</given-names></name><name><surname>Dimitrov</surname><given-names>DF</given-names></name><name><surname>Wallis</surname><given-names>JD</given-names></name><name><surname>Carmena</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Reversible large-scale modification of cortical networks during Neuroprosthetic control</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>662</fpage><lpage>667</lpage><pub-id pub-id-type="doi">10.1038/nn.2797</pub-id><pub-id pub-id-type="pmid">21499255</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Georgopoulos</surname><given-names>AP</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name><name><surname>Kettner</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Neuronal population coding of movement direction</article-title><source>Science</source><volume>233</volume><fpage>1416</fpage><lpage>1419</lpage><pub-id pub-id-type="doi">10.1126/science.3749885</pub-id><pub-id pub-id-type="pmid">3749885</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilja</surname><given-names>V</given-names></name><name><surname>Nuyujukian</surname><given-names>P</given-names></name><name><surname>Chestek</surname><given-names>CA</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name><name><surname>Fan</surname><given-names>JM</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name><name><surname>Kaufman</surname><given-names>MT</given-names></name><name><surname>Kao</surname><given-names>JC</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A high-performance neural Prosthesis enabled by control algorithm design</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1752</fpage><lpage>1757</lpage><pub-id pub-id-type="doi">10.1038/nn.3265</pub-id><pub-id pub-id-type="pmid">23160043</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilja</surname><given-names>V</given-names></name><name><surname>Pandarinath</surname><given-names>C</given-names></name><name><surname>Blabe</surname><given-names>CH</given-names></name><name><surname>Nuyujukian</surname><given-names>P</given-names></name><name><surname>Simeral</surname><given-names>JD</given-names></name><name><surname>Sarma</surname><given-names>AA</given-names></name><name><surname>Sorice</surname><given-names>BL</given-names></name><name><surname>Perge</surname><given-names>JA</given-names></name><name><surname>Jarosiewicz</surname><given-names>B</given-names></name><name><surname>Hochberg</surname><given-names>LR</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Henderson</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Clinical translation of a high-performance neural Prosthesis</article-title><source>Nature Medicine</source><volume>21</volume><fpage>1142</fpage><lpage>1145</lpage><pub-id pub-id-type="doi">10.1038/nm.3953</pub-id><pub-id pub-id-type="pmid">26413781</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaser</surname><given-names>JI</given-names></name><name><surname>Benjamin</surname><given-names>AS</given-names></name><name><surname>Chowdhury</surname><given-names>RH</given-names></name><name><surname>Perich</surname><given-names>MG</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name><name><surname>Kording</surname><given-names>KP</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Machine learning for neural decoding</article-title><source>ENeuro</source><volume>7</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1523/ENEURO.0506-19.2020</pub-id><pub-id pub-id-type="pmid">32737181</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golub</surname><given-names>MD</given-names></name><name><surname>Sadtler</surname><given-names>PT</given-names></name><name><surname>Oby</surname><given-names>ER</given-names></name><name><surname>Quick</surname><given-names>KM</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Tyler-Kabara</surname><given-names>EC</given-names></name><name><surname>Batista</surname><given-names>AP</given-names></name><name><surname>Chase</surname><given-names>SM</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Learning by neural Reassociation</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>607</fpage><lpage>616</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0095-3</pub-id><pub-id pub-id-type="pmid">29531364</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodman</surname><given-names>JM</given-names></name><name><surname>Tabot</surname><given-names>GA</given-names></name><name><surname>Lee</surname><given-names>AS</given-names></name><name><surname>Suresh</surname><given-names>AK</given-names></name><name><surname>Rajan</surname><given-names>AT</given-names></name><name><surname>Hatsopoulos</surname><given-names>NG</given-names></name><name><surname>Bensmaia</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Postural representations of the hand in the Primate sensorimotor cortex</article-title><source>Neuron</source><volume>104</volume><fpage>1000</fpage><lpage>1009</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.09.004</pub-id><pub-id pub-id-type="pmid">31668844</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasse</surname><given-names>BA</given-names></name><name><surname>Sheets</surname><given-names>DEG</given-names></name><name><surname>Holly</surname><given-names>NL</given-names></name><name><surname>Gothard</surname><given-names>KM</given-names></name><name><surname>Fuglevand</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Restoration of complex movement in the paralyzed upper limb</article-title><source>Journal of Neural Engineering</source><volume>19</volume><elocation-id>046002</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2552/ac7ad7</pub-id><pub-id pub-id-type="pmid">35728568</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hochberg</surname><given-names>LR</given-names></name><name><surname>Serruya</surname><given-names>MD</given-names></name><name><surname>Friehs</surname><given-names>GM</given-names></name><name><surname>Mukand</surname><given-names>JA</given-names></name><name><surname>Saleh</surname><given-names>M</given-names></name><name><surname>Caplan</surname><given-names>AH</given-names></name><name><surname>Branner</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>D</given-names></name><name><surname>Penn</surname><given-names>RD</given-names></name><name><surname>Donoghue</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Neuronal ensemble control of prosthetic devices by a human with Tetraplegia</article-title><source>Nature</source><volume>442</volume><fpage>164</fpage><lpage>171</lpage><pub-id pub-id-type="doi">10.1038/nature04970</pub-id><pub-id pub-id-type="pmid">16838014</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hochberg</surname><given-names>LR</given-names></name><name><surname>Bacher</surname><given-names>D</given-names></name><name><surname>Jarosiewicz</surname><given-names>B</given-names></name><name><surname>Masse</surname><given-names>NY</given-names></name><name><surname>Simeral</surname><given-names>JD</given-names></name><name><surname>Vogel</surname><given-names>J</given-names></name><name><surname>Haddadin</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Cash</surname><given-names>SS</given-names></name><name><surname>van der Smagt</surname><given-names>P</given-names></name><name><surname>Donoghue</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Reach and grasp by people with Tetraplegia using a Neurally controlled Robotic arm</article-title><source>Nature</source><volume>485</volume><fpage>372</fpage><lpage>375</lpage><pub-id pub-id-type="doi">10.1038/nature11076</pub-id><pub-id pub-id-type="pmid">22596161</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Irwin</surname><given-names>ZT</given-names></name><name><surname>Schroeder</surname><given-names>KE</given-names></name><name><surname>Vu</surname><given-names>PP</given-names></name><name><surname>Bullard</surname><given-names>AJ</given-names></name><name><surname>Tat</surname><given-names>DM</given-names></name><name><surname>Nu</surname><given-names>CS</given-names></name><name><surname>Vaskov</surname><given-names>A</given-names></name><name><surname>Nason</surname><given-names>SR</given-names></name><name><surname>Thompson</surname><given-names>DE</given-names></name><name><surname>Bentley</surname><given-names>JN</given-names></name><name><surname>Patil</surname><given-names>PG</given-names></name><name><surname>Chestek</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Neural control of finger movement via Intracortical brain-machine interface</article-title><source>Journal of Neural Engineering</source><volume>14</volume><elocation-id>066004</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2552/aa80bd</pub-id><pub-id pub-id-type="pmid">28722685</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jarosiewicz</surname><given-names>B</given-names></name><name><surname>Chase</surname><given-names>SM</given-names></name><name><surname>Fraser</surname><given-names>GW</given-names></name><name><surname>Velliste</surname><given-names>M</given-names></name><name><surname>Kass</surname><given-names>RE</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Functional network reorganization during learning in a brain-computer interface paradigm</article-title><source>PNAS</source><volume>105</volume><fpage>19486</fpage><lpage>19491</lpage><pub-id pub-id-type="doi">10.1073/pnas.0808113105</pub-id><pub-id pub-id-type="pmid">19047633</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jarosiewicz</surname><given-names>B</given-names></name><name><surname>Masse</surname><given-names>NY</given-names></name><name><surname>Bacher</surname><given-names>D</given-names></name><name><surname>Cash</surname><given-names>SS</given-names></name><name><surname>Eskandar</surname><given-names>E</given-names></name><name><surname>Friehs</surname><given-names>G</given-names></name><name><surname>Donoghue</surname><given-names>JP</given-names></name><name><surname>Hochberg</surname><given-names>LR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Advantages of closed-loop calibration in Intracortical brain-computer interfaces for people with Tetraplegia</article-title><source>Journal of Neural Engineering</source><volume>10</volume><elocation-id>046012</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/10/4/046012</pub-id><pub-id pub-id-type="pmid">23838067</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kakei</surname><given-names>S</given-names></name><name><surname>Hoffman</surname><given-names>DS</given-names></name><name><surname>Strick</surname><given-names>PL</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Muscle and movement representations in the primary motor cortex</article-title><source>Science</source><volume>285</volume><fpage>2136</fpage><lpage>2139</lpage><pub-id pub-id-type="doi">10.1126/science.285.5436.2136</pub-id><pub-id pub-id-type="pmid">10497133</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kilgore</surname><given-names>KL</given-names></name><name><surname>Peckham</surname><given-names>PH</given-names></name><name><surname>Thrope</surname><given-names>GB</given-names></name><name><surname>Keith</surname><given-names>MW</given-names></name><name><surname>Gallaher-Stone</surname><given-names>KA</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Synthesis of hand grasp using functional neuromuscular stimulation</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>36</volume><fpage>761</fpage><lpage>770</lpage><pub-id pub-id-type="doi">10.1109/10.32109</pub-id><pub-id pub-id-type="pmid">2787284</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobak</surname><given-names>D</given-names></name><name><surname>Brendel</surname><given-names>W</given-names></name><name><surname>Constantinidis</surname><given-names>C</given-names></name><name><surname>Feierstein</surname><given-names>CE</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name><name><surname>Mainen</surname><given-names>ZF</given-names></name><name><surname>Qi</surname><given-names>XL</given-names></name><name><surname>Romo</surname><given-names>R</given-names></name><name><surname>Uchida</surname><given-names>N</given-names></name><name><surname>Machens</surname><given-names>CK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Demixed principal component analysis of neural population data</article-title><source>eLife</source><volume>5</volume><elocation-id>e10989</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.10989</pub-id><pub-id pub-id-type="pmid">27067378</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miri</surname><given-names>A</given-names></name><name><surname>Warriner</surname><given-names>CL</given-names></name><name><surname>Seely</surname><given-names>JS</given-names></name><name><surname>Elsayed</surname><given-names>GF</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name><name><surname>Jessell</surname><given-names>TM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Behaviorally selective engagement of short-latency Effector pathways by motor cortex</article-title><source>Neuron</source><volume>95</volume><fpage>683</fpage><lpage>696</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.06.042</pub-id><pub-id pub-id-type="pmid">28735748</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moritz</surname><given-names>CT</given-names></name><name><surname>Perlmutter</surname><given-names>SI</given-names></name><name><surname>Fetz</surname><given-names>EE</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Direct control of paralysed muscles by cortical neurons</article-title><source>Nature</source><volume>456</volume><fpage>639</fpage><lpage>642</lpage><pub-id pub-id-type="doi">10.1038/nature07418</pub-id><pub-id pub-id-type="pmid">18923392</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nason</surname><given-names>SR</given-names></name><name><surname>Vaskov</surname><given-names>AK</given-names></name><name><surname>Willsey</surname><given-names>MS</given-names></name><name><surname>Welle</surname><given-names>EJ</given-names></name><name><surname>An</surname><given-names>H</given-names></name><name><surname>Vu</surname><given-names>PP</given-names></name><name><surname>Bullard</surname><given-names>AJ</given-names></name><name><surname>Nu</surname><given-names>CS</given-names></name><name><surname>Kao</surname><given-names>JC</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Jang</surname><given-names>T</given-names></name><name><surname>Kim</surname><given-names>HS</given-names></name><name><surname>Blaauw</surname><given-names>D</given-names></name><name><surname>Patil</surname><given-names>PG</given-names></name><name><surname>Chestek</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A low-power band of neuronal Spiking activity dominated by local single units improves the performance of brain–machine interfaces</article-title><source>Nature Biomedical Engineering</source><volume>4</volume><fpage>973</fpage><lpage>983</lpage><pub-id pub-id-type="doi">10.1038/s41551-020-0591-0</pub-id><pub-id pub-id-type="pmid">32719512</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nason</surname><given-names>SR</given-names></name><name><surname>Mender</surname><given-names>MJ</given-names></name><name><surname>Vaskov</surname><given-names>AK</given-names></name><name><surname>Willsey</surname><given-names>MS</given-names></name><name><surname>Ganesh Kumar</surname><given-names>N</given-names></name><name><surname>Kung</surname><given-names>TA</given-names></name><name><surname>Patil</surname><given-names>PG</given-names></name><name><surname>Chestek</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Real-time linear prediction of simultaneous and independent movements of two finger groups using an Intracortical brain-machine interface</article-title><source>Neuron</source><volume>109</volume><fpage>3164</fpage><lpage>3177</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2021.08.009</pub-id><pub-id pub-id-type="pmid">34499856</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Nason-Tomaszewski</surname><given-names>SR</given-names></name><name><surname>Mender</surname><given-names>MJ</given-names></name><name><surname>Kennedy</surname><given-names>E</given-names></name><name><surname>Lambrecht</surname><given-names>JM</given-names></name><name><surname>Kilgore</surname><given-names>KL</given-names></name><name><surname>Chiravuri</surname><given-names>S</given-names></name><name><surname>Kumar</surname><given-names>NG</given-names></name><name><surname>Kung</surname><given-names>TA</given-names></name><name><surname>Willsey</surname><given-names>MS</given-names></name><name><surname>Chestek</surname><given-names>CA</given-names></name><name><surname>Patil</surname><given-names>PG</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Brain-Controlled Electrical Stimulation Restores Continuous Finger Function</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.06.15.496349</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="book"><person-group person-group-type="author"><collab>National Spinal Cord Injury Statistical Center</collab></person-group><year iso-8601-date="2021">2021</year><source>National Spinal Cord Injury Statistical Center, Facts and Figures at a Glance</source><publisher-loc>Birmingham, AL</publisher-loc><publisher-name>University of Alabama at Birmingham</publisher-name></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naufel</surname><given-names>S</given-names></name><name><surname>Glaser</surname><given-names>JI</given-names></name><name><surname>Kording</surname><given-names>KP</given-names></name><name><surname>Perreault</surname><given-names>EJ</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A muscle-activity-dependent gain between motor cortex and EMG</article-title><source>Journal of Neurophysiology</source><volume>121</volume><fpage>61</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1152/jn.00329.2018</pub-id><pub-id pub-id-type="pmid">30379603</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oby</surname><given-names>ER</given-names></name><name><surname>Ethier</surname><given-names>C</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Movement representation in the primary motor cortex and its contribution to Generalizable EMG predictions</article-title><source>Journal of Neurophysiology</source><volume>109</volume><fpage>666</fpage><lpage>678</lpage><pub-id pub-id-type="doi">10.1152/jn.00331.2012</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orsborn</surname><given-names>AL</given-names></name><name><surname>Dangi</surname><given-names>S</given-names></name><name><surname>Moorman</surname><given-names>HG</given-names></name><name><surname>Carmena</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Closed-loop Decoder adaptation on intermediate time-scales facilitates rapid BMI performance improvements independent of Decoder Initialization conditions</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source><volume>20</volume><fpage>468</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2012.2185066</pub-id><pub-id pub-id-type="pmid">22772374</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peckham</surname><given-names>PH</given-names></name><name><surname>Marsolais</surname><given-names>EB</given-names></name><name><surname>Mortimer</surname><given-names>JT</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Restoration of key grip and release in the C6 Tetraplegic patient through functional electrical stimulation</article-title><source>The Journal of Hand Surgery</source><volume>5</volume><fpage>462</fpage><lpage>469</lpage><pub-id pub-id-type="doi">10.1016/s0363-5023(80)80076-1</pub-id><pub-id pub-id-type="pmid">6968764</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peckham</surname><given-names>PH</given-names></name><name><surname>Keith</surname><given-names>MW</given-names></name><name><surname>Kilgore</surname><given-names>KL</given-names></name><name><surname>Grill</surname><given-names>JH</given-names></name><name><surname>Wuolle</surname><given-names>KS</given-names></name><name><surname>Thrope</surname><given-names>GB</given-names></name><name><surname>Gorman</surname><given-names>P</given-names></name><name><surname>Hobby</surname><given-names>J</given-names></name><name><surname>Mulcahey</surname><given-names>MJ</given-names></name><name><surname>Carroll</surname><given-names>S</given-names></name><name><surname>Hentz</surname><given-names>VR</given-names></name><name><surname>Wiegner</surname><given-names>A</given-names></name><collab>Implantable Neuroprosthesis Research Group</collab></person-group><year iso-8601-date="2001">2001</year><article-title>Efficacy of an implanted Neuroprosthesis for restoring hand grasp in Tetraplegia: A multicenter study</article-title><source>Archives of Physical Medicine and Rehabilitation</source><volume>82</volume><fpage>1380</fpage><lpage>1388</lpage><pub-id pub-id-type="doi">10.1053/apmr.2001.25910</pub-id><pub-id pub-id-type="pmid">11588741</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russo</surname><given-names>AA</given-names></name><name><surname>Bittner</surname><given-names>SR</given-names></name><name><surname>Perkins</surname><given-names>SM</given-names></name><name><surname>Seely</surname><given-names>JS</given-names></name><name><surname>London</surname><given-names>BM</given-names></name><name><surname>Lara</surname><given-names>AH</given-names></name><name><surname>Miri</surname><given-names>A</given-names></name><name><surname>Marshall</surname><given-names>NJ</given-names></name><name><surname>Kohn</surname><given-names>A</given-names></name><name><surname>Jessell</surname><given-names>TM</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Motor cortex Embeds muscle-like commands in an Untangled population response</article-title><source>Neuron</source><volume>97</volume><fpage>953</fpage><lpage>966</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.01.004</pub-id><pub-id pub-id-type="pmid">29398358</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sadtler</surname><given-names>PT</given-names></name><name><surname>Quick</surname><given-names>KM</given-names></name><name><surname>Golub</surname><given-names>MD</given-names></name><name><surname>Chase</surname><given-names>SM</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Tyler-Kabara</surname><given-names>EC</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name><name><surname>Batista</surname><given-names>AP</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Neural constraints on learning</article-title><source>Nature</source><volume>512</volume><fpage>423</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1038/nature13665</pub-id><pub-id pub-id-type="pmid">25164754</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saxena</surname><given-names>S</given-names></name><name><surname>Russo</surname><given-names>AA</given-names></name><name><surname>Cunningham</surname><given-names>J</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Motor cortex activity across movement speeds is predicted by network-level strategies for generating muscle activity</article-title><source>eLife</source><volume>11</volume><elocation-id>e67620</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.67620</pub-id><pub-id pub-id-type="pmid">35621264</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schieber</surname><given-names>MH</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Individuated finger movements of Rhesus monkeys: A means of Quantifying the independence of the digits</article-title><source>Journal of NEUROPHYSIOLOGY</source><volume>65</volume><fpage>1381</fpage><lpage>1391</lpage><pub-id pub-id-type="doi">10.1152/jn.1991.65.6.1381</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schieber</surname><given-names>MH</given-names></name><name><surname>Lang</surname><given-names>CE</given-names></name><name><surname>Reilly</surname><given-names>KT</given-names></name><name><surname>McNulty</surname><given-names>P</given-names></name><name><surname>Sirigu</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Selective activation of human finger muscles after stroke or amputation</article-title><source>Advances in Experimental Medicine and Biology</source><volume>629</volume><fpage>559</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1007/978-0-387-77064-2_30</pub-id><pub-id pub-id-type="pmid">19227521</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schroeder</surname><given-names>KE</given-names></name><name><surname>Perkins</surname><given-names>SM</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Cortical control of virtual self-motion using task-specific subspaces</article-title><source>The Journal of Neuroscience</source><volume>42</volume><fpage>220</fpage><lpage>239</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2687-20.2021</pub-id><pub-id pub-id-type="pmid">34716229</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwemmer</surname><given-names>MA</given-names></name><name><surname>Skomrock</surname><given-names>ND</given-names></name><name><surname>Sederberg</surname><given-names>PB</given-names></name><name><surname>Ting</surname><given-names>JE</given-names></name><name><surname>Sharma</surname><given-names>G</given-names></name><name><surname>Bockbrader</surname><given-names>MA</given-names></name><name><surname>Friedenberg</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Meeting brain–computer interface user performance expectations using a deep neural network decoding framework</article-title><source>Nature Medicine</source><volume>24</volume><fpage>1669</fpage><lpage>1676</lpage><pub-id pub-id-type="doi">10.1038/s41591-018-0171-y</pub-id><pub-id pub-id-type="pmid">30250141</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scott</surname><given-names>SH</given-names></name><name><surname>Gribble</surname><given-names>PL</given-names></name><name><surname>Graham</surname><given-names>KM</given-names></name><name><surname>Cabel</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Dissociation between hand motion and population vectors from neural activity in motor cortex</article-title><source>Nature</source><volume>413</volume><fpage>161</fpage><lpage>165</lpage><pub-id pub-id-type="doi">10.1038/35093102</pub-id><pub-id pub-id-type="pmid">11557980</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sergio</surname><given-names>LE</given-names></name><name><surname>Hamel-Pâquet</surname><given-names>C</given-names></name><name><surname>Kalaska</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Motor cortex neural correlates of output Kinematics and Kinetics during Isometric-force and arm-reaching tasks</article-title><source>Journal of Neurophysiology</source><volume>94</volume><fpage>2353</fpage><lpage>2378</lpage><pub-id pub-id-type="doi">10.1152/jn.00989.2004</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Serruya</surname><given-names>MD</given-names></name><name><surname>Hatsopoulos</surname><given-names>NG</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Fellows</surname><given-names>MR</given-names></name><name><surname>Donoghue</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Instant neural control of a movement signal</article-title><source>Nature</source><volume>416</volume><fpage>141</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.1038/416141a</pub-id><pub-id pub-id-type="pmid">11894084</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Shah</surname><given-names>SA</given-names></name><name><surname>Baker</surname><given-names>JL</given-names></name><name><surname>Ryou</surname><given-names>JW</given-names></name><name><surname>Purpura</surname><given-names>KP</given-names></name><name><surname>Schiff</surname><given-names>ND</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Modulation of arousal regulation with central thalamic deep brain stimulation</article-title><conf-name>Annual International Conference of the IEEE Engineering in Medicine and Biology Society. IEEE Engineering in Medicine and Biology Society. Annual International Conference</conf-name><fpage>3314</fpage><lpage>3317</lpage><pub-id pub-id-type="doi">10.1109/IEMBS.2009.5333751</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Sahani</surname><given-names>M</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cortical control of arm movements: A dynamical systems perspective</article-title><source>Annual Review of Neuroscience</source><volume>36</volume><fpage>337</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-062111-150509</pub-id><pub-id pub-id-type="pmid">23725001</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suresh</surname><given-names>AK</given-names></name><name><surname>Goodman</surname><given-names>JM</given-names></name><name><surname>Okorokova</surname><given-names>EV</given-names></name><name><surname>Kaufman</surname><given-names>M</given-names></name><name><surname>Hatsopoulos</surname><given-names>NG</given-names></name><name><surname>Bensmaia</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Neural population Dynamics in motor cortex are different for reach and grasp</article-title><source>eLife</source><volume>9</volume><elocation-id>e58848</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.58848</pub-id><pub-id pub-id-type="pmid">33200745</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sussillo</surname><given-names>D</given-names></name><name><surname>Nuyujukian</surname><given-names>P</given-names></name><name><surname>Fan</surname><given-names>JM</given-names></name><name><surname>Kao</surname><given-names>JC</given-names></name><name><surname>Stavisky</surname><given-names>SD</given-names></name><name><surname>Ryu</surname><given-names>S</given-names></name><name><surname>Shenoy</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A recurrent neural network for closed-loop Intracortical brain-machine interface Decoders</article-title><source>Journal of Neural Engineering</source><volume>9</volume><elocation-id>026027</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/9/2/026027</pub-id><pub-id pub-id-type="pmid">22427488</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>DM</given-names></name><name><surname>Tillery</surname><given-names>SIH</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Direct cortical control of 3D Neuroprosthetic devices</article-title><source>Science</source><volume>296</volume><fpage>1829</fpage><lpage>1832</lpage><pub-id pub-id-type="doi">10.1126/science.1070291</pub-id><pub-id pub-id-type="pmid">12052948</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vaskov</surname><given-names>AK</given-names></name><name><surname>Irwin</surname><given-names>ZT</given-names></name><name><surname>Nason</surname><given-names>SR</given-names></name><name><surname>Vu</surname><given-names>PP</given-names></name><name><surname>Nu</surname><given-names>CS</given-names></name><name><surname>Bullard</surname><given-names>AJ</given-names></name><name><surname>Hill</surname><given-names>M</given-names></name><name><surname>North</surname><given-names>N</given-names></name><name><surname>Patil</surname><given-names>PG</given-names></name><name><surname>Chestek</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Cortical decoding of individual finger group motions using Refit Kalman filter</article-title><source>Frontiers in Neuroscience</source><volume>12</volume><elocation-id>751</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2018.00751</pub-id><pub-id pub-id-type="pmid">30455621</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Velliste</surname><given-names>M</given-names></name><name><surname>Perel</surname><given-names>S</given-names></name><name><surname>Spalding</surname><given-names>MC</given-names></name><name><surname>Whitford</surname><given-names>AS</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Cortical control of a prosthetic arm for self-feeding</article-title><source>Nature</source><volume>453</volume><fpage>1098</fpage><lpage>1101</lpage><pub-id pub-id-type="doi">10.1038/nature06996</pub-id><pub-id pub-id-type="pmid">18509337</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Willett</surname><given-names>FR</given-names></name><name><surname>Avansino</surname><given-names>DT</given-names></name><name><surname>Hochberg</surname><given-names>LR</given-names></name><name><surname>Henderson</surname><given-names>JM</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>High-performance brain-to-text communication via handwriting</article-title><source>Nature</source><volume>593</volume><fpage>249</fpage><lpage>254</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03506-2</pub-id><pub-id pub-id-type="pmid">33981047</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Willsey</surname><given-names>MS</given-names></name><name><surname>Nason-Tomaszewski</surname><given-names>SR</given-names></name><name><surname>Ensel</surname><given-names>SR</given-names></name><name><surname>Temmar</surname><given-names>H</given-names></name><name><surname>Mender</surname><given-names>MJ</given-names></name><name><surname>Costello</surname><given-names>JT</given-names></name><name><surname>Patil</surname><given-names>PG</given-names></name><name><surname>Chestek</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Real-time brain-machine interface in non-human primates achieves high-velocity prosthetic finger movements using a shallow Feedforward neural network Decoder</article-title><source>Nature Communications</source><volume>13</volume><elocation-id>6899</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-34452-w</pub-id><pub-id pub-id-type="pmid">36371498</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wodlinger</surname><given-names>B</given-names></name><name><surname>Downey</surname><given-names>JE</given-names></name><name><surname>Tyler-Kabara</surname><given-names>EC</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name><name><surname>Boninger</surname><given-names>ML</given-names></name><name><surname>Collinger</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Ten-dimensional anthropomorphic arm control in a human brain-machine interface: difficulties, solutions, and limitations</article-title><source>Journal of Neural Engineering</source><volume>12</volume><elocation-id>016011</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/12/1/016011</pub-id><pub-id pub-id-type="pmid">25514320</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>D</given-names></name><name><surname>Willett</surname><given-names>F</given-names></name><name><surname>Memberg</surname><given-names>WD</given-names></name><name><surname>Murphy</surname><given-names>B</given-names></name><name><surname>Rezaii</surname><given-names>P</given-names></name><name><surname>Walter</surname><given-names>B</given-names></name><name><surname>Sweet</surname><given-names>J</given-names></name><name><surname>Miller</surname><given-names>J</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Hochberg</surname><given-names>LR</given-names></name><name><surname>Kirsch</surname><given-names>RF</given-names></name><name><surname>Ajiboye</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Closed-loop cortical control of virtual reach and posture using Cartesian and joint velocity commands</article-title><source>Journal of Neural Engineering</source><volume>16</volume><elocation-id>026011</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2552/aaf606</pub-id><pub-id pub-id-type="pmid">30523839</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82598.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Pruszynski</surname><given-names>J Andrew</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Western University</institution></institution-wrap><country>Canada</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.08.26.505422" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.08.26.505422"/></front-stub><body><p>This study provides valuable findings about how brain machine interfaces cope with changes in context, an important consideration for deploying such devices in the real world. The evidence supporting the claims is solid, and the findings will be of interest to motor neuroscientists and engineers developing brain machine interfaces.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82598.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Pruszynski</surname><given-names>J Andrew</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Western University</institution></institution-wrap><country>Canada</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Éthier</surname><given-names>Christian</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04sjchr03</institution-id><institution>Université Laval</institution></institution-wrap><country>Canada</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.08.26.505422">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.08.26.505422v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;The Impact of Task Context on Predicting Finger Movements in a Brain-Machine Interface&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by Andrew Pruszynski as the Reviewing Editor and Tamar Makin as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Christian Éthier (Reviewer #1). We apologize for the delay in returning these reviews.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1. Provide a convincing explanation as to why the two BMI experiments (Figure 5A and B) gave different results. This is an important consideration as it forms the basis for a key conclusion of the study. This likely requires further data analysis.</p><p>2. The authors need to dive deeper into their data, specifically that which surrounds contextual shifts and the associated adjustment. There is a lot left on the table here that could broaden the scope and impact of the present study. All reviewers raise this point. For example, Reviewer 3 asks whether this adjustment reflects a 're-aiming' strategy. Again, this likely requires further data analysis.</p><p>3. The authors should provide a clearer description of how the present findings, which are in a very limited and narrow set of conditions, further BMI design principles in general. That is, how do the authors think the present results acquired in a limited context will generalize to the much wider set of contextual shifts that would be encountered in the real world.</p><p>4. There are a number of typos and general quality concerns with respect to the figures and the associated captions that are at the level that negatively influence the interpretability of the study and its findings. Specific suggestions are provided by the individual reviewers but a thorough revision is required in this respect.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>A figure with pictures or drawings of the manipulandum in different context would be useful to better understand the experiment. Same for the virtual task/virtual hand. I'm not sure what the monkey</p><p>Perhaps the main body of the manuscript should contain a few words about what it means for channels to be 'tuned'. What criterion? Same for the definition of &quot;changing activity&quot;.</p><p>On line 205 and Figure 2: if the spring resist flexion, why does the monkey activate is extensor muscle during flexion? To resist flexing too much? In this condition, is there tonic extensor muscle activity at the beginning of the trials? Moreover, this change in extensor and flexor synergy means that the monkeys not only scale their muscle activity for a different load, but seem to change their motor strategy. The different contexts thus require a non-linear change in muscle activity, but require more or less the same kinematics. How this impacts the decoders ability to generalize should be discussed.</p><p>Line 252-253: &quot;This overall lack of change was surprising…&quot; I fail to see how changing the hand configuration should impact online BMI performance. Because of differences in afferent, proprioceptive activity reaching the motor cortex? If the task is purely virtual, and the decoder good, the monkey can simply continue to try doing the &quot;normal&quot; task, rely on virtual feedback and should succeed. The &quot;plant&quot; in this case, does not change. It would be good to clarify if and how this was really an unexpected result.</p><p>Line 312: it would be helpful if the &quot;window&quot; was described here within the main manuscript</p><p>Figure 7: make it clear in the axes labels of panel C that &quot;component 1 activation&quot; refers to the first context-dependent component, not the first PC.</p><p>Methods line 561: indicate that the rotation is the direction of wrist flexion.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>1. The authors state that BMI performance was minimally affected by context shifts because the animals were able to make fast adjustments online. However, they do not really dig into this adjustment. I recognize that there are only a few adjustment trials per context shift, but given the number of days and shifts on some of those days, I would imagine one could still examine the process of this adaptation in some detail. There are some nice examples of this in the literature, for example Golub et al. 2018 &quot;Learning by neural reassociation&quot; and Athalye et al. 2018. &quot;Emergence of Coordinated Neural Dynamics Underlies Neuroprosthetic Learning and Skillful Control&quot;.</p><p>This seems like a missed opportunity to shed light on what cognitive strategies and/or neural tuning shifts. That in turn would lead to a more satisfying deeper story, which right now is essentially &quot;neural activity changes between contexts, but BMI performance is okay, whew!&quot;.</p><p>2. As I alluded to in my summary statement, the difference in results between Figure 5A and 5B are quite substantial; the decoder trained off-context was quite a bit worse, and my view is that the current writing does not bring this finding to sufficient attention (e.g., the next paragraph starts with &quot;To help explain how the monkeys were able to adjust to different contexts so well…&quot;). A convincing explanation of why the two BMI experiments gave different results was not provided, but would be helpful for establishing confidence in the key conclusion. Rather, there's a greater focus on the lack of detrimental effect in figure 5A. To further explain my perspective: if this was a decoder innovation paper, a 32.6% improvement in times to target would be a big deal! So the performance decrease observed (and the asymmetry in what decoder+context mismatch is or is not compensated for) seems noteworthy. The Discussion should address this result, compared to the current &quot;In both cases, the monkeys adjusted for the new context as quickly as they adjusted to normal online BMI trials.&quot;</p><p>3. Figure 1C – can the authors comment on why they think there are rather different changes in peak velocity between the two monkeys in response to the same experimental manipulations (e.g., opposite sign effect for flexion in the wrist condition)?</p><p>4. Lines 259-260 &quot;This indicates that during the off-context online trials they adjusted and moved their hand differently to account for the context change&quot;. Couldn't it also be that they tried to move their hand the same as in the normal context (i.e., send the same descending motor command, with correspondingly the same firing rate patterns that the decoder picks up on and decodes &quot;normally&quot;), but the mechanical perturbation (e.g., springs) resulted in different hand movements. Said another way: imagine the (hypothetical, thought-experiment) scenario where there's no sensory feedback and the monkey is doing this all open-loop using whatever strategy they learned for the normal condition BCI. How are your Figure 4D results different from what we'd expect in this scenario?</p><p>5. Line 371-372: &quot;In both cases, the monkeys adjusted for the new context as quickly as they adjusted to normal online BMI trials&quot;. Where was this shown? This sounds like a quantitative statement about how quickly performance reached the same level; but in the two-model (Figure 5b) tests off-context performance was substantially worse. And, I don't think the rate of adaption to normal BCI blocks was reported anywhere? Perhaps the authors meant something else and can rephrase to clarify?</p><p>6. Results are mostly consistent across both monkeys, but not every experiment or analysis is available from both muscles (e.g., EMG was only recorded from monkey N). While all the necessary information is present in the manuscript (e.g., via tables, figure legends, methods), I think the manuscript could be more clear in the main text to clarify which results are one-monkey results and which are two-monkey results. This helps the reader better assess the strength of evidence for each finding.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>I have a number of specific.</p><p>1) It was not very easy to visualize what exactly the manipulandum was or what the effects of the springs were. A methods figure, perhaps as supplemental information would be useful. Related to this, it was not clear what the actual biomechanical effect of the springs were. Did they resist motion at specific joints, or across the entire digit. Can you also provide some details on the relative scale of the change in force (9.5N) to the range of grasp forces that normally be applied by the animal, or that would typically be applied in this task?</p><p>2) Based on the comment in the public review about whether M1 represents or generates movements, I would make two potential suggestions. You could simplify/reduce this text and streamline the introduction, or you could weave this idea and narrative throughout the manuscript, returning to it in the discussion. As it stands, this potentially important idea is raised, but then largely ignored for the rest of the paper.</p><p>3) In Figure 1D, what is the explanation for significantly increased activity in finger extensors during flexion in the spring context? Is this evidence of increased digit stiffness? If so, this could have interesting effects on population activity, as there is some evidence that stiffness control might be encoded in the cortex.</p><p>4) The method of calculating the Acquisition Time was not clear. Specifically, please provide a clearer description of how each dot in figure 4C and 5C are calculated. In the text description of 4C and 5C, it was difficult to interpret the text regarding which differences were significant and which were not, and what the differences in the text were referring to. For example, in Lines 263-266, it states that Monkey N had a short adaptation time (p = 0.002) and that Monkey W did not (p=0.22). I can't tell what exactly this is referring to in Figure 4C. Lastly, around line 290-292, it is stated that monkey W had no significant adaptation period. While I understand that the median z-score was close to 0, the range of z-scores in all cases in Figure 4C and 5C are very large. Were these randomly distributed across time? Was there a pattern? Can you say anything at all about the range of the z-scores themselves?</p><p>5) In the text, Figures 4D and 5D are discussed before 4C and 5C. Consider reorganizing the text or figure layout.</p><p>6) Regarding Figures 4D and 5D, is it possible to examine the distributions of the correlations in the normal and off-context trials and show this as error bars on each point? Can you statistically test whether the correlations really were different from each other to help support the claims in lines 280-290?</p><p>7) Throughout the discussion, it would be helpful to refer back to specific figures to support claims about the results of the manuscript.</p><p>8) The description of SBP data processing is unclear around Lines 497 and 504. What does it mean to sum the samples and track the quantity of samples? Please elaborate on what was done.</p><p>9) EMG channel differencing is unclear. On Lines 512-514, it sounds like you just did the difference of the 2 channels, which is fine. Was this done digitally after the fact? Please explain. This may help clarify the statement about also recording the 'partner' electrode.</p><p>10) Line 517: Provide additional details on the bandpass filter. What was the type and order of the filter?</p><p>11) Line 645: How common were unsuccessful trials?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82598.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1. Provide a convincing explanation as to why the two BMI experiments (Figure 5A and B) gave different results. This is an important consideration as it forms the basis for a key conclusion of the study. This likely requires further data analysis.</p></disp-quote><p>This is an excellent point, we added additional explanatory text and analysis to the results to help explain why the BMI task with context changes added to the manipulandum did not see a large impact. As described in Common Response #2, we have added analysis related to how the monkeys adapt to the online task. Additionally, we bring up the difference between the two online experiments in the discussion now, starting line 486:</p><p>“Our data show a near instantaneous adaptation to the perturbations whereas Sadtler et al. found some within-manifold perturbations required on the order of hundreds of trials to adapt to, indicating that our perturbation was intuitive to adapt to. Analyzing the monkey’s strategy during the BMI task revealed that they were able to do the BMI task with perturbations to the hand without adjusting their strategy (Figure 5D). This likely follows from the BMI task being driven by neural activity and visual feedback rather than movements of the hand itself. In the two decoder BMI task where off-context performance was often slightly worse, the monkeys did make small adjustments to perform the task (Figure 6D). For example, they tended to “push” harder to flex the virtual hand during off-context trials.…”</p><disp-quote content-type="editor-comment"><p>2. The authors need to dive deeper into their data, specifically that which surrounds contextual shifts and the associated adjustment. There is a lot left on the table here that could broaden the scope and impact of the present study. All reviewers raise this point. For example, Reviewer 3 asks whether this adjustment reflects a 're-aiming' strategy. Again, this likely requires further data analysis.</p></disp-quote><p>This is an excellent suggestion. Using the analysis of online adaptation described in Common Response #2, we found that there are small changes to the monkey’s strategy using the BMI. We have reframed a discussion paragraph to include this adaptation analysis, starting line 480:</p><p>“The similar online performance could also be observed if the context change does not have a large impact on task-relevant neural activity. Studies into neural plasticity have shown that during a session of online trials, subjects can adjust to decoder perturbations that are within the same intrinsic manifold (Sadtler et al., 2014). We found that individual channel activations change on up to 61.7% of channels that are important for decoding movements (Table I), and this introduces error into model predictions. However, if the perturbations we introduced did not shift activity outside of the intrinsic manifold, then it may have been easy to adjust to the new context. Our data show a near instantaneous adaptation to the perturbations whereas Sadtler et al. found some within-manifold perturbations required on the order of hundreds of trials to adapt to, indicating that our perturbation was intuitive to adapt to. Analyzing the monkey’s strategy during the BMI task revealed that they were able to do the BMI task with perturbations to the hand without adjusting their strategy (Figure 5D). This likely follows from the BMI task being driven by neural activity and visual feedback rather than movements of the hand itself. In the two decoder BMI task where off-context performance was often slightly worse, the monkeys did make small adjustments to perform the task (Figure 6D). For example, they tended to “push” harder to flex the virtual hand during off-context trials. This reaiming strategy is similar to what has been described in other work on short-term learning with motor BMI (Golub et al., 2018; Jarosiewicz et al., 2008). In this case re-aiming likely stems from the need to reproduce a higher or lower neural activation online in order to use a model trained on data where channel activation increased for flexion and decreased for extension for the spring context (Figure 7B-C).”</p><disp-quote content-type="editor-comment"><p>3. The authors should provide a clearer description of how the present findings, which are in a very limited and narrow set of conditions, further BMI design principles in general. That is, how do the authors think the present results acquired in a limited context will generalize to the much wider set of contextual shifts that would be encountered in the real world.</p></disp-quote><p>We thank the reviewers for the suggestion. We have added text to relate the context changes to the wider range of shifts experienced in activities of daily living.</p><p>Introduction starting line 107:</p><p>“These context shifts represent a small range of the possible shifts but relate back to common musculoskeletal changes in the task, i.e. muscle length and activation.”</p><p>Discussion starting line 438:</p><p>“These context changes represent a small sample of alterations found in activities of daily living but they include common changes to musculoskeletal properties of the hand during the task such as muscle tendon length and muscle activation range that allow us to infer how the results would extend to a wider range of changes.”</p><p>Additionally, we have expanded the discussion on how these findings further BMI design principles as well as rewording the current discussion to emphasize how the results affect BMI design. Discussion starting line 500:</p><p>“The online BMI experiments in this study used a kinematic-based BMI decoder. BMI studies typically predict kinematic variables for applications such as prosthesis control (Hochberg et al., 2012; Wodlinger et al., 2015) and cursor or virtual movement control (Gilja et al., 2015; Hochberg et al., 2006; Young et al., 2019). In the offline predictions using linear models, we found that neither kinematics nor muscle activations could be predicted at the same accuracy in new contexts. While significant, kinematics, specifically flexion velocity, did show a smaller decrease in offline performance between contexts (Figure 4B-C). These results suggest that when designing BMI, using kinematic variables as a command signal may allow for better generalization when the biomechanics of the task are not important, such as virtual tasks.</p><p>However, in FES applications (Ajiboye et al., 2017; Bouton et al., 2016; Nason-Tomaszewski et al., 2022), biomechanics are important. The final outputs are stimulation parameters that cause a desired amount of muscle contraction. Importantly, the required stimulation parameters could change with context due to the change in required muscle activation. As a result, even if predictions of position or velocity generalize well to new contexts, the mapping from kinematics to stimulation parameters would no longer be accurate. Our results with online BMI indicate that the monkeys are able to adapt by re-aiming with the BMI to restore some ability to do the virtual online task, which indicates they may also be able to re-aim in FES applications as well. However, in our task this adaptation occurred with a performance loss (Figure 6B). Instead it would be better to account for how context changes the biomechanics of the task with the BMI. This could be done either through incorporating a better control system into the BMI, e.g. developing a controller to update stimulation parameters to match the decoded joint angle or velocity, or by better estimating the intended muscle activations from neural activity. Decoded intended muscle activations can be mapped to stimulation parameters as done by some FES studies (Ethier et al., 2012; Hasse et al., 2022).”</p><p>Also discussion paragraph starting line 553 on how to make better predictions:</p><p>“An alternative BMI design approach to decoding movements is to use task-specific features to augment decoder models (Schroeder et al., 2022). The context shifts studied here represent a small and discrete subset of the shifts found in activities of daily living, however they relate to continuous musculoskeletal properties that are shifting with the context, i.e. muscle length, co-contraction, or muscle activation magnitude. Identifying a feature in neural activity that accounts for the change in muscle activation across contexts would assist in decoder generalization. For example, the contextdependent neural activity that strongly correlated with muscle activations in new contexts (Figure 8C) could provide a feature for accounting for the scaling change while predicting muscle activation or allow models to modulate force or muscle activation while producing the same kinematics. More work is needed to understand if a neural feature like this would remain stable in different cognitive contexts, for example grasping or freely moving fingers as opposed to doing this virtual target acquisition task.”</p><disp-quote content-type="editor-comment"><p>4. There are a number of typos and general quality concerns with respect to the figures and the associated captions that are at the level that negatively influence the interpretability of the study and its findings. Specific suggestions are provided by the individual reviewers but a thorough revision is required in this respect.</p></disp-quote><p>A thorough revision has been done, checking for typos and grammar as well as editing figures and fonts for clarity.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>A figure with pictures or drawings of the manipulandum in different context would be useful to better understand the experiment. Same for the virtual task/virtual hand. I'm not sure what the monkey.</p></disp-quote><p>We thank the reviewer for pointing this out. As described in common response #1, we have included a new Figure 1 that better illustrates the experimental setup.</p><disp-quote content-type="editor-comment"><p>Perhaps the main body of the manuscript should contain a few words about what it means for channels to be 'tuned'. What criterion? Same for the definition of &quot;changing activity&quot;.</p></disp-quote><p>We thank the reviewer for the suggestion. We have added the following sentences in the Results section line 177, before table I, briefly explaining how tuning and activity changes are determined:</p><p>“Tuning and context modulation were determined by regressing finger kinematics with channel activity and channel activity multiplied by a dummy variable for context, as described in the methods, one channel at a time. Regression coefficients were tested for significance with a t-test, a significant channel activity coefficient indicated that channel was tuned, and a significant dummy variable coefficient indicated that context modulated the channel’s tuning.”</p><disp-quote content-type="editor-comment"><p>On line 205 and Figure 2: if the spring resist flexion, why does the monkey activate is extensor muscle during flexion? To resist flexing too much? In this condition, is there tonic extensor muscle activity at the beginning of the trials? Moreover, this change in extensor and flexor synergy means that the monkeys not only scale their muscle activity for a different load, but seem to change their motor strategy. The different contexts thus require a non-linear change in muscle activity, but require more or less the same kinematics. How this impacts the decoders ability to generalize should be discussed.</p></disp-quote><p>This is an excellent discussion point. We believe that the extensor muscle activation during flexion reflects the monkey’s strategy of moving more stiffly (i.e. co-contracting flexor and extensor muscles) in order to make controlled movements. We have added text noting this effect for Figure 2 and Figure 3 (the old Figure 1 and Figure 2).</p><p>Results line 165:</p><p>“Interestingly, even extensor muscles were more activated during spring flexion trials, indicating that monkey N was co-contracting muscles more and moving with more stiffness.”</p><p>Results line 228:</p><p>“Alternatively, during flexion, the off-context predictions of EDC activation are less correlated with measured EDC activation because the model predicts EDC inactivation, which occurs during normal trials. However, in spring trials, measured EDC activation actually increases for flexion due to Monkey N co-contracting to move more stiffly.”</p><p>This is also now discussed in the Discussion section, starting line 539:</p><p>“The lower correlation was partially driven by muscle activation patterns not observed in normal context training data, such as increased co-contracting flexor and extensor muscles during flexion trials to modulate stiffness when springs were present, as seen in Figure 3A where the predicted EDC activation does not increase for flexion in the spring condition. With a better model, it might be possible to pick out the relationship between neural activity and muscle activations. Determining for example that the intention is to activate EDC more, whether that is to co-contract with FDP or to extend the fingers may not matter as long as the intention can be accurately decoded. Based on these results, it’s likely that linear models are not able to pick out this relationship.”</p><disp-quote content-type="editor-comment"><p>Line 252-253: &quot;This overall lack of change was surprising…&quot; I fail to see how changing the hand configuration should impact online BMI performance. Because of differences in afferent, proprioceptive activity reaching the motor cortex? If the task is purely virtual, and the decoder good, the monkey can simply continue to try doing the &quot;normal&quot; task, rely on virtual feedback and should succeed. The &quot;plant&quot; in this case, does not change. It would be good to clarify if and how this was really an unexpected result.</p></disp-quote><p>This is a good question. The text overstates the surprise at the experimental results. We expected that if we were decoding from motor potent neural activity then the monkey would move their hand with the task and that the effort to move their fingers after the context change would affect the ability to do the BMI task. However, we have also seen that the monkeys can do the task with their hands restrained relying on virtual feedback. We have reworded that sentence now on line 284:</p><p>“This overall lack of change was somewhat surprising since the offline decoding results had greater prediction error. The expectation was that when the monkey moved their hand along with the BMI task, the performance would be impacted due to the context change. However, the data show that the monkeys made small adjustments to how their hand moved with the online task (Figure 5 Supplement 1).”</p><disp-quote content-type="editor-comment"><p>Line 312: it would be helpful if the &quot;window&quot; was described here within the main manuscript</p></disp-quote><p>Thank you for pointing this out, we clarified in this line (now line 383) that the window is 420ms around peak movement.</p><disp-quote content-type="editor-comment"><p>Figure 7: make it clear in the axes labels of panel C that &quot;component 1 activation&quot; refers to the first context-dependent component, not the first PC.</p></disp-quote><p>Thank you for the suggestion. We have changed the axes label to “Context-Dependent Component 1 Activation”.</p><disp-quote content-type="editor-comment"><p>Methods line 561: indicate that the rotation is the direction of wrist flexion.</p></disp-quote><p>Thank you for the suggestion. We have clarified in the Methods, line 688, that the wrist rotation is towards flexion:</p><p>“The second alteration was the rotation of the manipulandum by 23 degrees in the flexion direction, referred to as the “wrist context”<italic>.”</italic></p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>1. The authors state that BMI performance was minimally affected by context shifts because the animals were able to make fast adjustments online. However, they do not really dig into this adjustment. I recognize that there are only a few adjustment trials per context shift, but given the number of days and shifts on some of those days, I would imagine one could still examine the process of this adaptation in some detail. There are some nice examples of this in the literature, for example Golub et al. 2018 &quot;Learning by neural reassociation&quot; and Athalye et al. 2018. &quot;Emergence of Coordinated Neural Dynamics Underlies Neuroprosthetic Learning and Skillful Control&quot;.</p><p>This seems like a missed opportunity to shed light on what cognitive strategies and/or neural tuning shifts. That in turn would lead to a more satisfying deeper story, which right now is essentially &quot;neural activity changes between contexts, but BMI performance is okay, whew!&quot;.</p></disp-quote><p>Thank you for the specific suggestions. We have now implemented a re-aiming analysis similar to that done in Golub et al., 2018. The specific changes are detailed in the common response #2 and response to essential revision #1 and #2 at the beginning of this document. To summarize them, we find that there are some small adjustments during the online task although the effect isn’t present with every session. It’s possible that not every session required large adjustments as the Kalman filters are highly similar in their velocity predictions and the BMI task is velocity controlled (now included in the supplement). Example results with this reaiming analysis are included in the online results figures (Figure 5 and Figure 6), and an analysis including all sessions is included in the supplement. We added new discussion around these results and the implications.</p><disp-quote content-type="editor-comment"><p>2. As I alluded to in my summary statement, the difference in results between Figure 5A and 5B are quite substantial; the decoder trained off-context was quite a bit worse, and my view is that the current writing does not bring this finding to sufficient attention (e.g., the next paragraph starts with &quot;To help explain how the monkeys were able to adjust to different contexts so well…&quot;). A convincing explanation of why the two BMI experiments gave different results was not provided, but would be helpful for establishing confidence in the key conclusion. Rather, there's a greater focus on the lack of detrimental effect in figure 5A. To further explain my perspective: if this was a decoder innovation paper, a 32.6% improvement in times to target would be a big deal! So the performance decrease observed (and the asymmetry in what decoder+context mismatch is or is not compensated for) seems noteworthy. The Discussion should address this result, compared to the current &quot;In both cases, the monkeys adjusted for the new context as quickly as they adjusted to normal online BMI trials.&quot;</p></disp-quote><p>Thank you for the feedback. As part of the re-aiming analysis detailed in common response #2 and essential revision #1 and #2, we also discuss why the results were different in the two types of BMI trials.</p><p>Additionally, we now highlight the different results more throughout the results and discussion.</p><p>For example, line 346 in the Results:</p><p>“As the off-context online performance was worse in many of the two-decoder BMI sessions, we next asked if this BMI task required more adaptation than when context changes were added to the manipulandum.”</p><p>Line 366 in the Results:</p><p>“To help explain how the monkeys were able to adjust to different contexts during the online task, we further examined changes in neural activity during the offline task in different contexts.”</p><p>Line 444 in the Discussion:</p><p>“In online trials using a kinematic based BMI, the monkeys were able to quickly adjust for context changes and achieved comparable performance to normal online trials. We tested this in two ways. First, we added context changes to the manipulandum during online trials (Figure 5), which resulted in almost no change in online performance. Second, we trained two decoders (one on normal trials and the other on off-context trials) and swapped between them for closed-loop control (Figure 6), which resulted in small but significant decreases in online performance for the model trained on off-context trials.”</p><p>Line 489 in the Discussion:</p><p>“Analyzing the monkey’s strategy during the BMI task revealed that they were able to do the BMI task with perturbations to the hand without adjusting their strategy (Figure 5D). This likely follows from the BMI task being driven by neural activity and visual feedback rather than movements of the hand itself. In the two decoder BMI task where off-context performance was often slightly worse, the monkeys did make small adjustments to perform the task (Figure 6D). For example, they tended to “push” harder to flex the virtual hand during off-context trials.”</p><disp-quote content-type="editor-comment"><p>3. Figure 1C – can the authors comment on why they think there are rather different changes in peak velocity between the two monkeys in response to the same experimental manipulations (e.g., opposite sign effect for flexion in the wrist condition)?</p></disp-quote><p>These different changes in peak velocity suggest that the monkeys had slightly different approaches to do the task when the wrist was flexed. Monkey N moved a little more stiffly and slowly whereas Monkey W moved more quickly to reach the targets and had to correct more after the fact. We added text to the results starting at line 147 to point out these behavioral differences:</p><p>“Each monkey had slight behavioral differences in how quickly they performed the task with context changes leading to small changes in peak velocities.”</p><disp-quote content-type="editor-comment"><p>4. Lines 259-260 &quot;This indicates that during the off-context online trials they adjusted and moved their hand differently to account for the context change&quot;. Couldn't it also be that they tried to move their hand the same as in the normal context (i.e., send the same descending motor command, with correspondingly the same firing rate patterns that the decoder picks up on and decodes &quot;normally&quot;), but the mechanical perturbation (e.g., springs) resulted in different hand movements. Said another way: imagine the (hypothetical, thought-experiment) scenario where there's no sensory feedback and the monkey is doing this all open-loop using whatever strategy they learned for the normal condition BCI. How are your Figure 4D results different from what we'd expect in this scenario?</p></disp-quote><p>This is an excellent point. In our additional analyses described in common response #2 and essential revisions #1 and #2, we found that it appears that very similar neural activity is being produced during different context trials. This suggests that the monkey is likely attempting to make the same movements in the closed loop decode but the changes added to the manipulandum are altering the trajectory of their hand. This similar neural activity is now discussed rather than the hand movements so this line has been removed.</p><disp-quote content-type="editor-comment"><p>5. Line 371-372: &quot;In both cases, the monkeys adjusted for the new context as quickly as they adjusted to normal online BMI trials&quot;. Where was this shown? This sounds like a quantitative statement about how quickly performance reached the same level; but in the two-model (Figure 5b) tests off-context performance was substantially worse. And, I don't think the rate of adaption to normal BCI blocks was reported anywhere? Perhaps the authors meant something else and can rephrase to clarify?</p></disp-quote><p>This line is referring to the average acquisition time in the first 5 trials for each type of trials that is reported in Figure 6C in order to illustrate that the initial difficulty in normal and off-context trials is similar. We agree that somewhat misrepresented the analysis and the line has been removed.</p><disp-quote content-type="editor-comment"><p>6. Results are mostly consistent across both monkeys, but not every experiment or analysis is available from both muscles (e.g., EMG was only recorded from monkey N). While all the necessary information is present in the manuscript (e.g., via tables, figure legends, methods), I think the manuscript could be more clear in the main text to clarify which results are one-monkey results and which are two-monkey results. This helps the reader better assess the strength of evidence for each finding.</p></disp-quote><p>Thank you for the suggestion. We have now added wording in multiple places calling out whether a result was with one or both monkeys. For example, results line 206:</p><p>“We first present the results for decoding Monkey N’s muscle activations across contexts.”</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>I have a number of specific.</p><p>1) It was not very easy to visualize what exactly the manipulandum was or what the effects of the springs were. A methods figure, perhaps as supplemental information would be useful. Related to this, it was not clear what the actual biomechanical effect of the springs were. Did they resist motion at specific joints, or across the entire digit. Can you also provide some details on the relative scale of the change in force (9.5N) to the range of grasp forces that normally be applied by the animal, or that would typically be applied in this task?</p></disp-quote><p>Thank you for the suggestion, we have included a new Figure 1 which illustrates the task setup as illustrated in common response #1.</p><p>Spring strengths were chosen to make the task difficult but still achievable. To give a scale for the amount of change this was to the task, text was added in the methods to give the typical force required in the task, starting line 696:</p><p>“The added springs increased the force required for full flexion by 9.5N (for MRS) and 3.3N (for index), while the rubber bands increased the force required for full flexion by 16.5N. The rubber band context was only done by Monkey N and in a 1-DOF task due to task difficulty. For reference, full flexion required approximately 1.3N of force without the springs or bands.”</p><disp-quote content-type="editor-comment"><p>2) Based on the comment in the public review about whether M1 represents or generates movements, I would make two potential suggestions. You could simplify/reduce this text and streamline the introduction, or you could weave this idea and narrative throughout the manuscript, returning to it in the discussion. As it stands, this potentially important idea is raised, but then largely ignored for the rest of the paper.</p></disp-quote><p>Thank you for the comment, as detailed in the response to the public review, we have written a new paragraph relating these results to the concept of generating movement.</p><disp-quote content-type="editor-comment"><p>3) In Figure 1D, what is the explanation for significantly increased activity in finger extensors during flexion in the spring context? Is this evidence of increased digit stiffness? If so, this could have interesting effects on population activity, as there is some evidence that stiffness control might be encoded in the cortex.</p></disp-quote><p>This is an excellent discussion point. We believe that the extensor muscle activation during flexion reflects the monkey’s strategy of moving more stiffly (i.e. co-contracting flexor and extensor muscles) in order to make controlled movements. We have added text noting this effect for Figure 2 and Figure 3.</p><p>Results line 165:</p><p>“Interestingly, even extensor muscles were more activated during spring flexion trials, indicating that monkey N was co-contracting muscles more and moving with more stiffness.”</p><p>Results line 228:</p><p>“Alternatively, during flexion, the off-context predictions of EDC activation are less correlated with measured EDC activation because the model predicts EDC inactivation, which occurs during normal trials. However, in spring trials, measured EDC activation actually increases for flexion due to Monkey N co-contracting to move more stiffly.</p><p>This is also now discussed in the Discussion section, starting line 539:</p><p>“The lower correlation was partially driven by muscle activation patterns not observed in normal context training data, such as increased co-contracting flexor and extensor muscles during flexion trials to modulate stiffness when springs were present, as seen in Figure 3A where the predicted EDC activation does not increase for flexion in the spring condition. With a better model, it might be possible to pick out the relationship between neural activity and muscle activations. Determining for example that the intention is to activate EDC more, whether that is to co-contract with FDP or to extend the fingers may not matter as long as the intention can be accurately decoded. Based on these results, it’s likely that linear models are not able to pick out this relationship.”</p><disp-quote content-type="editor-comment"><p>4) The method of calculating the Acquisition Time was not clear. Specifically, please provide a clearer description of how each dot in figure 4C and 5C are calculated. In the text description of 4C and 5C, it was difficult to interpret the text regarding which differences were significant and which were not, and what the differences in the text were referring to. For example, in Lines 263-266, it states that Monkey N had a short adaptation time (p = 0.002) and that Monkey W did not (p=0.22). I can't tell what exactly this is referring to in Figure 4C. Lastly, around line 290-292, it is stated that monkey W had no significant adaptation period. While I understand that the median z-score was close to 0, the range of z-scores in all cases in Figure 4C and 5C are very large. Were these randomly distributed across time? Was there a pattern? Can you say anything at all about the range of the z-scores themselves?</p></disp-quote><p>Thank you for the suggestions. A description of acquisition time and the z-scoring method has been added to the results the first time it is introduced. Additionally, we have clarified the text describing Figures 4C and 5C which previously worded the differences in z-scored acquisition times as time to adapt. The analysis was aimed at quantifying how difficult the BMI was to use initially. Results section starting line 289:</p><p>To measure the amount that the monkeys had to adjust during online trials to get to average performance, we calculated the average acquisition time, defined as the time to reach the target plus the time to finish orbiting the target, for the first five trials after the start of online trials and compared that between normal and off-context runs of BMI trials.</p><p>Also the Results section starting line 341:</p><p>“Monkey W once again did not show a significant initial adaptation (p=0.17, one-sample KolmogorovSmirnov test) which was the same between using the normal model and off-context models (p=0.5, two-sample Kolmogorov-Smirnov test).”</p><disp-quote content-type="editor-comment"><p>5) In the text, Figures 4D and 5D are discussed before 4C and 5C. Consider reorganizing the text or figure layout.</p></disp-quote><p>Figures 4D and 5D have been replaced (4D moved to the supplement) and the new text discussing these Figures was placed after the text discussing Figures 4C and 5C.</p><disp-quote content-type="editor-comment"><p>6) Regarding Figures 4D and 5D, is it possible to examine the distributions of the correlations in the normal and off-context trials and show this as error bars on each point? Can you statistically test whether the correlations really were different from each other to help support the claims in lines 280-290?</p></disp-quote><p>Figure 5D has been replaced and Figure 4D has been moved to the supplement.</p><disp-quote content-type="editor-comment"><p>7) Throughout the discussion, it would be helpful to refer back to specific figures to support claims about the results of the manuscript.</p></disp-quote><p>Thank you for the suggestion, multiple references to figures have been added to the discussion, for example discussion starting line 452:</p><p>“During the offline tasks, many channels changed neural activity with context, with 20.9% to 61.7% of tuned SBP channels modulating activity with context (Table I). The magnitude of these shifts were relatively small, especially when compared to the large changes in required muscle activation (Figure 2D-E), with weak trends to require greater activation for resisted flexion and lesser for assisted extension (Figure 7B-C). Additionally, the neural manifolds underlying movements in each context were well-aligned (Figure 7D). Using dPCA we found that while a large proportion of neural variance was explained by dPCA components that did not change with context, a significant proportion of the neural variance is associated with components that are context-dependent (Figure 8B). Visually, the context components are shifting the trajectories without changing the overall shape and the shift in neural activity is strongly correlated with muscle activations in new contexts (Figure 8C). This agrees with other studies which found lower variance activity may be related to the actual motor commands (Gallego et al., 2018; Russo et al., 2018; Saxena et al., 2022).”</p><disp-quote content-type="editor-comment"><p>8) The description of SBP data processing is unclear around Lines 497 and 504. What does it mean to sum the samples and track the quantity of samples? Please elaborate on what was done.</p></disp-quote><p>The purpose of summing samples and tracking the quantity has been elaborated in the Methods, starting line 620:</p><p>“The filtered 2kHz recording was then sent to the computer running xPC Target, which rectified and summed the samples on each channel received in each 1ms iteration and counted the quantity of samples received each 1ms so that SBP could later be averaged within longer time bins.”</p><disp-quote content-type="editor-comment"><p>9) EMG channel differencing is unclear. On Lines 512-514, it sounds like you just did the difference of the 2 channels, which is fine. Was this done digitally after the fact? Please explain. This may help clarify the statement about also recording the 'partner' electrode.</p></disp-quote><p>This was a software reference implemented on the analog input via Blackrock Microsystems Central software. The reference to partner electrodes has been removed as they were not used in analysis. Starting Methods line 634:</p><p>“The CPD was configured to record 16 channels of raw signal at 10 kHz and for each bipolar pair the electrode implanted further inside the muscle was software referenced to the second electrode. These eight bipolar referenced channels are used in analyses.”</p><disp-quote content-type="editor-comment"><p>10) Line 517: Provide additional details on the bandpass filter. What was the type and order of the filter?</p></disp-quote><p>Additional details about the filter have been added, Methods line 639:</p><p>“For offline analysis, muscle activations are estimated from the 10kHz EMG recording by filtering with a second-order Butterworth bandpass filter between 100 and 500 Hz and then taking the mean absolute value of the filtered signal during every binning period.”</p><disp-quote content-type="editor-comment"><p>11) Line 645: How common were unsuccessful trials?</p></disp-quote><p>Added Methods line 732:</p><p>“Unsuccessful trials were rare, often only occurring on the first or last trial of a block of trials.”</p></body></sub-article></article>