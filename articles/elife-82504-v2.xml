<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">82504</article-id><article-id pub-id-type="doi">10.7554/eLife.82504</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Ecology</subject></subj-group></article-categories><title-group><article-title>Spatial structure favors microbial coexistence except when slower mediator diffusion weakens interactions</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-321023"><name><surname>Lobanov</surname><given-names>Alexander</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-291135"><name><surname>Dyckman</surname><given-names>Samantha</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-291134"><name><surname>Kurkjian</surname><given-names>Helen</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3610-5344</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-114044"><name><surname>Momeni</surname><given-names>Babak</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1271-5196</contrib-id><email>momeni@bc.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02n2fzt79</institution-id><institution>Biology Department, Boston College</institution></institution-wrap><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00pc48d59</institution-id><institution>Department of Aquatic Ecology, Swiss Federal Institute of Aquatic Science and Technology</institution></institution-wrap><addr-line><named-content content-type="city">Dübendorf</named-content></addr-line><country>Switzerland</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Mitri</surname><given-names>Sara</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/019whta54</institution-id><institution>University of Lausanne</institution></institution-wrap><country>Switzerland</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0243gzr89</institution-id><institution>Max Planck Institute for Biology Tübingen</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>23</day><month>06</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e82504</elocation-id><history><date date-type="received" iso-8601-date="2022-08-06"><day>06</day><month>08</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-06-20"><day>20</day><month>06</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-08-01"><day>01</day><month>08</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.08.01.502385"/></event></pub-history><permissions><copyright-statement>© 2023, Lobanov, Dyckman et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Lobanov, Dyckman et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-82504-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-82504-figures-v2.pdf"/><abstract><p>Microbes often exist in spatially structured environments and many of their interactions are mediated through diffusible metabolites. How does such a context affect microbial coexistence? To address this question, we use a model in which the spatial distributions of species and diffusible interaction mediators are explicitly included. We simulate the enrichment process, examining how microbial species spatially reorganize and how eventually a subset of them coexist. In our model, we find that slower motility of cells promotes coexistence by allowing species to co-localize with their facilitators and avoid their inhibitors. We additionally find that a spatially structured environment is more influential when species mostly facilitate each other, rather than when they are mostly competing. More coexistence is observed when species produce many mediators and consume some (not many or few) mediators, and when overall consumption and production rates are balanced. Interestingly, coexistence appears to be disfavored when mediators are diffusing slowly because that leads to weaker interaction strengths. Overall, our results offer new insights into how production, consumption, motility, and diffusion intersect to determine microbial coexistence in a spatially structured environment.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>spatial structure</kwd><kwd>spatial organization</kwd><kwd>microbial communities</kwd><kwd>coexistence</kwd><kwd>community ecology</kwd><kwd>mathematical modeling</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100001341</institution-id><institution>Richard and Susan Smith Family Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Dyckman</surname><given-names>Samantha</given-names></name><name><surname>Kurkjian</surname><given-names>Helen</given-names></name><name><surname>Momeni</surname><given-names>Babak</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005303</institution-id><institution>Boston College</institution></institution-wrap></funding-source><award-id>URF</award-id><principal-award-recipient><name><surname>Lobanov</surname><given-names>Alexander</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection, and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Investigating microbial communities in a spatial environment in silico suggests that spatial structure promotes higher coexistence by allowing spatial self-organization, but can hinder coexistence by weakening interactions mediated through diffusible metabolites.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Microbes are rarely found in isolation in nature. Instead, they are found coexisting with one another in complex networks of interactions (<xref ref-type="bibr" rid="bib20">Ma et al., 2020</xref>). Given the differences among taxa and the competitive forces that act between them, a fundamental question in microbial community ecology is how this coexistence is maintained (<xref ref-type="bibr" rid="bib6">Chesson, 2000b</xref>; <xref ref-type="bibr" rid="bib34">Solé and Bascompte, 2006</xref>; <xref ref-type="bibr" rid="bib42">Widder et al., 2016</xref>). And because many important industrial, environmental, and health-related processes rely on microbial communities to function (e.g. anaerobic granules, microbial mats, and gut microbiota, respectively), understanding the conditions that favor microbial coexistence is critical to sustaining these systems.</p><p>Spatial structure and organization may shape coexistence via numerous mechanisms (<xref ref-type="bibr" rid="bib36">Tilman, 1994</xref>; <xref ref-type="bibr" rid="bib7">Durrett and Levin, 1994</xref>; <xref ref-type="bibr" rid="bib37">Tilman and Kareiva, 1998</xref>; <xref ref-type="bibr" rid="bib8">Durrett and Levin, 1998</xref>; <xref ref-type="bibr" rid="bib13">Kerr et al., 2002</xref>; <xref ref-type="bibr" rid="bib4">Brockhurst et al., 2006</xref>; <xref ref-type="bibr" rid="bib2">Amarasekare, 2003</xref>), often by modulating the interactions among individuals. For example, in a spatially structured environment where progeny is more likely to be in the vicinity of parents, intensified intrapopulation competition can give less competitive species a chance to survive (<xref ref-type="bibr" rid="bib5">Chesson, 2000a</xref>). In other conditions, spatial isolation can allow organisms with conflicting abiotic needs to flourish in appropriate environments (<xref ref-type="bibr" rid="bib15">Kim et al., 2011</xref>; <xref ref-type="bibr" rid="bib32">Satoh et al., 2007</xref>). The interplay between dispersal and competition can also allow coexistence between species that are more competitive growers and species that are better at dispersing and colonizing (<xref ref-type="bibr" rid="bib35">Tilman, 1990</xref>).</p><p>Spatial heterogeneity has been invoked as a mechanism for microbial coexistence since the pioneering work by <xref ref-type="bibr" rid="bib9">Gause, 1934</xref>. And although general concepts of coexistence are expected to apply equally to microbes, microbial communities may be affected by spatial structure in unique ways because of the scale and multiplicity of microbial interactions. An important and ubiquitous example of this are microbial interactions that are mediated via diffusible metabolites—including resources and metabolic byproducts. Spatial structure can stabilize these interactions and support coexistence, for example, by allowing cheaters to be excluded from beneficial interactions (<xref ref-type="bibr" rid="bib24">Momeni et al., 2013b</xref>; <xref ref-type="bibr" rid="bib31">Pande et al., 2016</xref>), or by permitting facilitative chemical interactions while preventing the inhibitory effects of an interacting organism’s physical presence (<xref ref-type="bibr" rid="bib14">Kim et al., 2008</xref>). And while it is clear that the outcomes of interactions via diffusible mediators in structured environments may depend on mediator diffusion rates (<xref ref-type="bibr" rid="bib17">Kümmerli et al., 2014</xref>; <xref ref-type="bibr" rid="bib1">Allison, 2005</xref>) and the larger network of antagonistic and cooperative interactions (<xref ref-type="bibr" rid="bib28">Nadell et al., 2016</xref>), how such factors translate into community-level consequences is not well understood.</p><p>Prior reports that address coexistence of metabolically interacting microbes in a spatially structured environment are scarce. In an implicit model, <xref ref-type="bibr" rid="bib27">Murrell and Law, 2003</xref> have shown in a modified Lotka–Volterra model that when interspecific competition operates over shorter distances than intraspecific competition a spatially structured environment can lead to species coexistence by allowing for aggregation. And in recent work with explicit modeling of space, <xref ref-type="bibr" rid="bib41">Weiner et al., 2019</xref> examined coexistence in territorial populations interacting through diffusible mediators and found that metabolic tradeoffs allow for the coexistence of more species than the number of nutrients.</p><p>Our model is distinct from previous work in that we allow overlap and dispersal of populations through the shared space. Our motivation is to capture situations in which microbes can disperse inside a matrix that defines the spatial structure. An example of this is the mucosal layer of the digestive or respiratory tract, in which stratification is possible, yet the distribution of different species populations can overlap. Another example is in yogurt or cheese, where spatial structure exists, but populations are not territorial. We modify a previously developed mediator-explicit model (<xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>) to account for spatial structure and the dispersion of species in the same space. Here, we limit our study to one-dimensional (1D) spatial structure as a starting point. We examine in our model conditions under which coexistence is favored. We should emphasize that even though we choose our parameters within the range of typical values observed among microbial communities, the purpose of this work is not to recapture a specific community. Instead, by examining a range of values for parameters such as metabolite diffusion and species dispersal, we hope to gain a better understanding of how rates of these processes can affect species coexistence.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A spatial mediator-explicit model of microbial communities</title><p>In our mediator-explicit model, species interact through metabolites that they produce and/or consume (<xref ref-type="fig" rid="fig1">Figure 1A, B</xref>; <xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>). Each species can produce a subset of metabolites and consume a subset of metabolites. Each of the metabolites in the shared environment can in turn influence any of the species by increasing or decreasing their growth rate (i.e. facilitation or inhibition, respectively) compared to how each species grows in the absence of interactions (<xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>). We also assume that different interaction mediators additively influence the overall growth rate of each species (see Model description in Methods).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>A spatial environment favors coexistence more when interspecies facilitation is prevalent in the initial species pool.</title><p>(<bold>A</bold>) Species are engaged in metabolite-mediated interactions with other species. Each species produces a subset of mediators and consumes a subset. Each mediator can positively or negatively modulate the growth rate of the species it influences. In our model, consumption is present whenever there is an influence from a mediator on a species, regardless of whether the influence is facilitative or inhibitory. Production and consumption of mediators are indicated by open arrows. (<bold>B</bold>) In a one-dimensional (1D) spatial context, species and mediators are defined as functions of space that change over time because of population growth and dispersal as well as mediator production, consumption, and diffusion. A cartoon representation of the distributions of four species and three mediators are shown here over the spatial context (<italic>z</italic>). (<bold>C</bold>) Simulations were run at different ratios of facilitative to inhibitory interactions (fac:inh) for spatial (open blue squares) and well-mixed (filled blue circles) communities. Each ratio was run 500 times with the richness (number of species stably surviving at the end of a simulation) averaged over all the simulations. Each simulation started with 10 species and 5 mediators and ran for 100 generations. The error bars are 95% confidence intervals generated by bootstrapping 100 samples. Here, the species dispersal coefficient is <inline-formula><mml:math id="inf1"><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> cm<sup>2</sup>/hr. Boxes mark fac:inh ratios used in later simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>There is little change in community composition after 100 generations of growth.</title><p>Here, we examine a simple case with five species and three mediators. Markers and error bars show mean and standard deviation of the percentage change in the community composition over 10 generations of growth (one round of growth between dilutions). There was minimal change (less than 1% difference) after 100 generations of growth in both well-mixed and spatial contexts. This observation was consistent regardless of the initial ratio of facilitation to inhibition interactions, at fac:inh = 10:90 (top), 50:50 (middle), and 90:10 (bottom). In all cases, <italic>D<sub>Cell</sub></italic> = 5 × 10<sup>−9</sup> cm<sup>2</sup>/hr and <italic>D<sub>Med</sub></italic> = 1.8 × 10<sup>−2</sup> cm<sup>2</sup>/hr.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Shannon index shows the same overall trend as richness when comparing spatial versus well-mixed communities.</title><p>Similar to <xref ref-type="fig" rid="fig1">Figure 1C</xref>, simulations were run at different fac:inh ratios for both spatial communities (blue squares) and well-mixed communities (red circles). Each ratio was run 500 times with the richness (number of species stably surviving at the end of a simulation) averaged over all the simulations. Each simulation started with 10 species and 5 mediators and ran for 100 generations. The error bars are 95% confidence intervals generated by bootstrapping 100 samples. Here, the species dispersal coefficient is <inline-formula><mml:math id="inf2"><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> cm<sup>2</sup>/hr.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Comparing the spatial distribution of species at different dispersal rates illustrates the impact of dispersal on coexistence.</title><p>(<bold>A</bold>) Species are initially stacked over the spatial extent of the community. We examine a simple case with five species and three mediators (interaction network shown in the inset). Different progressions are observed at high (<bold>B</bold>, <italic>D<sub>Cell</sub></italic> = 5 × 10<sup>−6</sup> cm<sup>2</sup>/hr) versus low (<bold>C</bold>, <italic>D<sub>Cell</sub></italic> = 5 × 10<sup>−9</sup> cm<sup>2</sup>/hr) dispersal rates, leading to different coexistence outcome. In both cases, <italic>D<sub>Med</sub></italic> = 1.8 × 10<sup>−2</sup> cm<sup>2</sup>/hr.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig1-figsupp3-v2.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Species interactions and dynamics are different in spatial versus well-mixed environments, leading to different coexistence outcomes.</title><p>For simplicity, we consider an initial pool of five species with three mediators. We kept the same interaction network (<bold>A</bold>) in both spatial and well-mixed conditions and simulated the species dynamics. In the interaction network, hollow arrows indicate the flow of mediators (either production or consumption). The thickness of the lower end of each arrow shows the production rate and the thickness of the upper end of the arrow shows the strength of the mediator influence on the corresponding species. The basal growth rate of each species is shown as different shades of gray, with darker shades indicating larger basal growth rates. For spatial communities, the population density represents the sum of all densities across different spatial extents. We ran the simulation in both cases through 10 rounds of growth and dilution. Different population dynamics and ultimately different coexistence outcomes are observed in these cases after simulating 100 generations. Note that even though Species 4 and 5 in the spatial community and Species 1, 4, and 5 in the well-mixed community are still present in the final communities, because they exhibit a trend of decline in relative frequency, we consider them not to coexist (in accordance with our coexistence criterion, see Methods). (<bold>B, C</bold>) In this example, proximity of Species 1 to a beneficial Species 2 in the spatial community allows a strong boost in the growth of Species 1, leading to its coexistence with Species 2 and 3. In contrast, Species 1 in the well-mixed community receives a smaller portion of C<sub>1</sub>, not enough to allow Species 1 to keep up with the other species. In C, only coexisting species and mediators related to them are shown.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig1-figsupp4-v2.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 5.</label><caption><title>Species interactions and dynamics are different in spatial versus well-mixed environments, even when inhibition is prevalent.</title><p>For simplicity, we consider an initial pool of five species with three mediators, but rather than fac:inh = 90:10 in <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>, here we initially assign fac:inh = 10:90. We kept the same interaction network (<bold>A</bold>) in both spatial and well-mixed conditions and simulated the species dynamics. In the interaction network, hollow arrows indicate the flow of mediators (either production or consumption). The thickness of the lower end of each arrow shows the production rate and the thickness of the upper end of the arrow shows the strength of the mediator influence on the corresponding species. The basal growth rate of each species is shown as different shades of gray, with darker shades indicating larger basal growth rates. For spatial communities, the population density represents the sum of all densities across different spatial extents. We ran the simulation in both cases through 10 rounds of growth and dilution. Different population dynamics are observed in these cases. Note that even though Species 4 in the spatial community is still present in the final communities, because they exhibit a trend of decline in relative frequency, we consider them not to coexist (in accordance with our coexistence criterion, see Methods). (<bold>B, C</bold>) In this example, proximity of Species 1 to an inhibitory Species 2 in the spatial community leads to rapid exclusion of Species 1. Early extinction of Species 1 removes its inhibition of Species 4 and allows Species 4 to sustain longer in the spatial context compared to the well-mixed community. In C, only coexisting species and mediators related to them are shown.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig1-figsupp5-v2.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 6.</label><caption><title>Spatial distance between species can modulate the strength of their interaction.</title><p>For simplicity, here we consider only two species engaged in commensalism (Species 1 providing a benefit to Species 2) through a single mediator (see insets). We examined a no-interaction control (<bold>A</bold>), versus when the species were initially close (<bold>B</bold>) or far (<bold>C</bold>) from each other within the spatial extent of the communities. All parameters are similar to <xref ref-type="table" rid="table1">Table 1</xref>, except the mediator diffusion coefficient which is chosen at <italic>D<sub>Med</sub></italic> = 1.8 × 10<sup>−3</sup> cm<sup>2</sup>/hr to exaggerate the impact of mediator diffusion in space. The panel on the left shows the initial distribution of the two populations in space and the panel on the right shows the population dynamics. Notably, the ratio of Species 1 to Species 2 drops by 10-fold, when Species 2 is farther away from Species 1 (<bold>C</bold> versus <bold>B</bold>). The basal growth rate of Species 1 and 2 are 0.1 and 0.08/hr, respectively. We ran the simulation for five rounds of growth and dilution.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig1-figsupp6-v2.tif"/></fig><fig id="fig1s7" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 7.</label><caption><title>Within the same order of magnitude, the community’s spatial extent does not have a large impact on spatial coexistence.</title><p>All parameters other than the community’s spatial extent are kept fixed. Here, (<bold>A</bold>) <italic>D<sub>Cell</sub></italic> = 5 × 10<sup>−8</sup> cm<sup>2</sup>/hr and (<bold>B</bold>) <italic>D<sub>Cell</sub></italic> = 5 × 10<sup>−9</sup> cm<sup>2</sup>/hr. Legend shows the values of fac:inh assigned in the initial pool. In these simulations, the spatial resolution <italic>dz</italic> is kept at 0.05 mm in all cases and the initial extent of each species is 1/10th of the total spatial extent at the beginning of each simulation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig1-figsupp7-v2.tif"/></fig><fig id="fig1s8" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 8.</label><caption><title>Imposing a local carrying capacity favors species coexistence.</title><p>All parameters other than the local carrying capacity <italic>k</italic><sub><italic>Y</italic></sub> are kept fixed. Imposing a local carrying capacity on the total cell number (see the equations described in Methods) lowers the competitive advantage of the most successful species and allows more coexistence. This is similar to the idea of strengthened intrapopulation competition in a spatially structured environment that has been discussed in depth in the past as one of the reasons that spatial environments can support more coexistence. To focus on the effect of interspecies interaction, we assume <italic>k</italic><sub><italic>Y</italic></sub> = 10<sup>9</sup> cells/ml in our other simulations throughout this manuscript to minimize the impact of <italic>k</italic><sub><italic>Y</italic></sub> (i.e. a forced intrapopulation competition) on our results.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig1-figsupp8-v2.tif"/></fig><fig id="fig1s9" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 9.</label><caption><title>Rearranging the order of species can modulate the strength of interspecies interactions and impact spatial coexistence outcomes.</title><p>For simplicity, here we use the same examples as <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref> with five species and three mediators in the initial pool. We keep the same interaction network (<bold>A</bold>), but rearrange the initial order of species in the spatial community (original: 1, 2, 3, 4, 5; reorder: 1, 3, 4, 5, 2). We ran the simulation in both cases through 10 rounds of growth and dilution. Different population dynamics and ultimately different coexistence outcomes are observed in these cases after simulating 100 generations. Note that even though Species 4 and 5 in the original community and Species 1 and 3 in the reorder community are still present in the final communities, because they exhibit a trend of decline in relative frequency, we consider them not to coexist (in accordance with our coexistence criterion, see Methods). (<bold>B, C</bold>) In this particular example, after changing the order, Species 1 and 3 receive less of the benefits from Species 2, leading to the emergence of Species 2, 4, and 5 as an alternative stable coexistence. In C, only coexisting species and mediators related to them are shown.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig1-figsupp9-v2.tif"/></fig></fig-group><p>We assume a 1D spatial structure which preserves the spatial context but allows the diffusion of metabolites and dispersal of species. Multiple metabolites and species can be present in a single location. Both metabolite diffusion and species dispersal are modeled as random walk processes, characterized with a diffusion coefficient and a dispersal coefficient, respectively. In a typical simulation, we start from an initial distribution in which populations occupy adjacent, non-overlapping spatial locations at low initial density. This choice is made to impose a reproducible initial condition that emphasizes the role of space. Each simulation starts with a network of interactions in which interaction strengths, production and consumption links, and production and consumption rates are assigned randomly. The initial pool typically contains 10 species and 5 interaction mediators. We simulate community enrichment through rounds of growth and dilution (<xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>; <xref ref-type="bibr" rid="bib10">Goldford et al., 2018</xref>) for 100 generations, and assess the richness of each resulting community (i.e., the number of species stably persisting in the community). We have chosen 100 generations of growth, because we have observed that often this is enough to reliably decide which species stably persist in the community (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). At each dilution step, we assume that the overall spatial distribution of the community is preserved and all populations at all locations are diluted with the same factor. We recognize that this assumption is not universally true; however, we adopt it as an approximation, in the absence of additional information about a particular community. Such a dilution preserves some of the spatial structure of the community in the next round of growth and could represent a biofilm getting partially washed away by rain or in a microfluidic device, gut microbiota after a defecation event, or a broken-off portion of a granule initiating a new granule. We use a well-mixed version (<xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>)—devoid of any spatial context—with the same set of parameters for species properties and interactions (i.e. consumption and production rates, basal growth rates, mediator influences, etc.) for all comparisons. <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> shows an example of the population distributions and dynamics during the course of enrichment. In a simple example, we show that interactions and subsequently the population dynamics are affected by growing in a well-mixed versus spatial environment (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). We explored the impact of the overall spatial extent of the community and found that within an order of magnitude of change, the outcomes remained the same (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>).</p><p>The shift from interspecies competition to intraspecies competition can favor coexistence in a spatially structured environment. To assess this impact, we imposed a cap on total cell number at each location in space. As this cap became more restrictive, it suppressed the most competitive species and led to higher coexistence (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>). Since our focus in this manuscript is the impact of interspecies interactions, in the rest of this manuscript we pick the total cell number cap at a level (<italic>k<sub>Y</sub></italic> = 10<sup>9</sup> cells/ml) that minimizes the impact of imposed intrapopulation competition.</p></sec><sec id="s2-2"><title>A spatial environment favors coexistence more when facilitation among species is prevalent</title><p>We first examined how the prevalence of facilitative versus inhibitory interactions impacted coexistence in spatial communities. In our simulations, we dictated the ratio of facilitative and inhibitory interactions in the initial pool of species. Our results show that, similar to a well-mixed environment, more facilitative interactions lead to higher richness in communities that emerge from enrichment (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, along the <italic>x</italic>-axis). Additionally, we observe that spatial communities show more coexistence than well-mixed communities when facilitation among species is prevalent (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, spatial versus well-mixed). The same pattern, although less pronounced, was present when instead of richness we used the Shannon index to assess the diversity of resulting communities (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). Our explanation is that species locally grow better when adjacent to a facilitative partner and grow worse when in the vicinity of an inhibitory partner. The resulting spatial self-organization in effect amplifies facilitative interactions and dampens inhibitory interactions, leading to more coexistence. This is supported by our data which shows that the position of specific species with respect to other species that facilitate or inhibit it can impact the population dynamics (<xref ref-type="fig" rid="fig1s8">Figure 1—figure supplement 8</xref>). Because of the marked impact of the fac:inh ratio (i.e. the ratio of the number of facilitative interactions to the number of inhibitory interactions), moving forward, we will examine three conditions, with equal fractions of facilitative and inhibitory influences (fac:inh = 50:50), mostly inhibitory (fac:inh = 10:90), or mostly facilitative (fac:inh = 90:10) to scope the impact on coexistence.</p><p>At low species dispersal, self-organization is one of the mechanisms that can lead to a difference between spatial and well-mixed communities (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). In a simplified interpretation, self-organization can be in the form of co-localization driven by facilitation or segregation driven by inhibition. In our simulations, we observed that co-localization had a stronger effect on coexistence. The positive influence was reinforced by more growth in the vicinity of the partner, leading to a stronger representation of facilitation in spatial communities. In contrast, segregation only had a modest effect on weakening the impact of inhibition. As a result, there is more similarity between well-mixed and spatial communities in the absence of strong facilitative interactions (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).</p></sec><sec id="s2-3"><title>Coexistence is favored when many metabolites are produced and influence an intermediate number of species</title><p>Because metabolites are at the center of interspecies interactions in our model, we examined their impact on spatial coexistence of the average number of metabolites produced by each species and the average number of species influenced by each mediator. We found that coexistence is favored when the number of metabolites produced is larger (<xref ref-type="fig" rid="fig2">Figure 2</xref>, along the <italic>y</italic>-axis). This effect was stronger when the metabolite influences were mostly facilitative (fac:inh = 90:10, versus 50:50 or 10:90). In contrast, coexistence achieved its maximum values at intermediate ranges of mediator influence (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <italic>x</italic>-axis), that is lower coexistence was observed when each mediator influenced too many or too few species on average. We note that these trends were largely the same between spatial and well-mixed communities.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>The number of metabolites produced and number of species influenced affect coexistence in spatial and well-mixed communities.</title><p>Different ranges of production and mediator influence values were analyzed for both well-mixed and spatial communities at three different fractions of fac:inh influences in the initial pool of species (10:90, 50:50, and 90:10). Mean richness (i.e. average number of species stably present at the end of a simulation) was calculated for 500 simulated instances and marked on the color bar. Each simulation started with 10 species and 5 mediators and ran for 100 generations. The <italic>x</italic>-axis represents the average number of species influenced by a mediator and the <italic>y</italic>-axis represents the average number of mediators produced by each species. Other simulation parameters are listed in <xref ref-type="table" rid="table1">Table 1</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>The number of metabolites produced and number of species influenced affect coexistence in spatial and well-mixed communities.</title><p>Different ranges of production and mediator influence values were analyzed for both well-mixed and spatial communities at three different fractions of fac:inh influences in the initial pool of species (10:90, 50:50, and 90:10). The ratio of spatial to well-mixed mean richness values is calculated for 500 simulated instances and marked on the color bar. Each simulation started with 10 species and 5 mediators and ran for 100 generations. The <italic>x</italic>-axis represents the average number of species influenced by a mediator and the <italic>y</italic>-axis represents the average number of mediators produced by each species.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Coexistence is favored when many metabolites are produced and influence an intermediate number of species, even with weaker interactions.</title><p>Different ranges of production and mediator influence values were analyzed for both well-mixed and spatial communities at three different fractions of fac:inh influences in the initial pool of species (10:90, 50:50, and 90:10). Mean richness (i.e. average number of species stably present at the end of a simulation) was calculated for 500 simulated instances and marked on the color bar. Each simulation started with 10 species and 5 mediators and ran for 100 generations. The <italic>x</italic>-axis represents the average number of species influenced by a mediator and the <italic>y</italic>-axis represents the average number of mediators produced by each species. Here, the maximum interaction strength magnitude  <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.05.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Coexistence is favored when many metabolites are produced and influence an intermediate number of species, even with stronger interactions.</title><p>Different ranges of production and mediator influence values were analyzed for both well-mixed and spatial communities at three different fractions of fac:inh influences in the initial pool of species (10:90, 50:50, and 90:10). Mean richness (i.e. average number of species stably present at the end of a simulation) was calculated for 500 simulated instances and marked on the color bar. Each simulation started with 10 species and 5 mediators and ran for 100 generations. The <italic>x</italic>-axis represents the average number of species influenced by a mediator and the <italic>y</italic>-axis represents the average number of mediators produced by each species. Here, the maximum interaction strength magnitude  <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.5.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Self-facilitation is prominent among low-diversity outcomes.</title><p>We separated the outcomes based on whether one (No coexistence) or more species (With coexistence) emerged from enrichment and examined the occurrence of self-facilitation. Occurrence is defined here as the average number of self-facilitation links (i.e. production of a mediator that benefits its producer) divided by the number of species present in the community. Each simulation started with 10 species and 5 mediators and ran for 100 generations. Here <italic>q<sub>c</sub></italic> = 0.5 and <italic>q<sub>p</sub></italic> = 0.5. Diamond markers (◊) show the occurrence in the initial pool of species before enrichment. The error bars are 95% confidence intervals generated by bootstrapping 100 samples using 500 total instances simulated. Mann–Whitney <italic>U</italic> test was used for comparison of occurrences between ‘No coexistence’ and ‘With coexistence’ cases to calculate the p values. More self-facilitation occurrence was associated with absence of coexistence when fac:inh was 50:50 or 90:10, but the reverse trend held when interactions within the initial pool were mostly inhibitory (fac:inh = 10:90).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig2-figsupp4-v2.tif"/></fig></fig-group><p>Our explanation is that a larger range of production offers more opportunities for interaction, which through the enrichment process lead to the selection of facilitative subsets that coexist (<xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>). A low mediator influence range works in the opposite direction, reduces opportunities for interactions and results in lower coexistence. Very high mediator influence range potentially leads to more self-facilitation (i.e. producing a metabolite that is beneficial to the producer species), which our data suggest can lead to take-over by a single species and a lower coexistence as a result (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p></sec><sec id="s2-4"><title>Coexistence is higher when there is balance between production and consumption of mediators</title><p>We next asked how the rates of production and consumption of mediators would influence coexistence. To address this question, we surveyed a range of average rates of production and consumption. We observed that the highest levels of coexistence occurred when there was a balance between consumption and production rates among species, with slightly higher production than consumption (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Coexistence is higher where there is a balance between production and consumption of mediators.</title><p>Different average production and consumption rates were analyzed for both well-mixed and spatial communities at three different fractions of fac:inh influences in the initial pool of species (10:90, 50:50, and 90:10). Mean richness (i.e. average number of species stably present at the end of a simulation) is calculated for 500 simulated instances. Each simulation started with 10 species and 5 mediators and ran for 100 generations. Color bar represents the average richness. The <italic>x</italic>-axis represents the average production rate of mediators and the <italic>y</italic>-axis represents the average consumption rate of mediators. Other simulation parameters are listed in <xref ref-type="table" rid="table1">Table 1</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>In spatial communities with many facilitation interactions among species, coexistence is favored at lower consumption rates of mediators.</title><p>Different average production and consumption rates were analyzed for both well-mixed and spatial communities at three different fractions of fac:inh influences in the initial pool of species (10:90, 50:50, and 90:10). The ratio of spatial to well-mixed mean richness values is calculated for 500 simulated instances and marked on the color bar. Each simulation started with 10 species and 5 mediators and ran for 100 generations. The <italic>x</italic>-axis represents the average production rate of mediators and the <italic>y</italic>-axis represents the average consumption rate of mediators.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Coexistence is higher where there is a balance between production and consumption of mediators independent of the interaction strength (here, with weaker interactions).</title><p>Different average production and consumption rates were analyzed for both well-mixed and spatial communities at three different fractions of fac:inh influences in the initial pool of species (10:90, 50:50, and 90:10). Mean richness (i.e. average number of species stably present at the end of a simulation) is calculated for 500 simulated instances. Each simulation started with 10 species and 5 mediators and ran for 100 generations. Color bar represents the average richness. The <italic>x</italic>-axis represents the average production rate of mediators and the <italic>y</italic>-axis represents the average consumption rate of mediators. Here, the maximum interaction strength magnitude  <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.05.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Coexistence is higher where there is a balance between production and consumption of mediators, independent of the interaction strength (here, with stronger interactions).</title><p>Different average production and consumption rates were analyzed for both well-mixed and spatial communities at three different fractions of fac:inh influences in the initial pool of species (10:90, 50:50, and 90:10). Mean richness (i.e. average number of species stably present at the end of a simulation) is calculated for 500 simulated instances. Each simulation started with 10 species and 5 mediators and ran for 100 generations. Color bar represents the average richness. The <italic>x</italic>-axis represents the average production rate of mediators and the <italic>y</italic>-axis represents the average consumption rate of mediators. Here, the maximum interaction strength magnitude  <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.5.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig3-figsupp3-v2.tif"/></fig></fig-group><p>Our justification for the observed pattern is that in one extreme where production is too high (lower right corner of each plot), mediators will build up in the environment. This will put the community in a regime in which consumption is not enough to create a feedback, that is ‘reusable mediators’ as discussed in <xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>, which leads to lower coexistence. In the other extreme, when consumption is too high (upper left corner of each plot), metabolites that mediate the interactions will be depleted from the environment, leading to an effectively weaker interaction and thus lower coexistence. However, when production is slightly higher than consumption, metabolite quantities are sufficient to create strong interactions and facilitation feedbacks, leading to higher coexistence. While coexistence is slightly higher in the spatial communities compared to well-mixed ones, the production–consumption trends apply equally to spatial and well-mixed communities, as expected.</p></sec><sec id="s2-5"><title>Limited species dispersal in a spatial environment allows more coexistence, especially when facilitation is common</title><p>Because species dispersal is a major factor in preserving community spatial structure, we examined how the dispersal coefficient affected coexistence outcomes. For this, we kept the diffusion coefficient of the mediators fixed and surveyed mean richness among many instances of communities randomly assembled (<italic>n</italic> = 500). When the diffusion coefficient for species approaches zero and cells remain in their original spatial location, we observe higher levels of coexistence (<xref ref-type="fig" rid="fig4">Figure 4</xref>). We also observed that the impact of lower dispersal is stronger in communities in which most interactions are facilitative rather than inhibitory. Our explanation is that lower dispersal rates mean that species grow best in spatial locations that are more supportive for their growth, which is in the vicinity of their beneficial partners and away from competitors or inhibitors. As discussed in <xref ref-type="fig" rid="fig1">Figure 1</xref>, such self-organization effectively amplifies facilitative interactions and de-emphasizes inhibitory interactions, leading to a higher coexistence. This is also consistent with the observation that the effect of dispersal rate is strongest when the proportion of facilitative interactions is highest. As the dispersal coefficient increases, the self-organization gets washed away by dispersal of cells to less than ideal locations for their growth and its benefit for coexistence diminishes.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Lower dispersal rates allow more microbial coexistence.</title><p>Communities in spatially structured environments were simulated with different dispersal coefficients at three different fractions of fac:inh influences (10:90, 50:50, and 90:10). Mean richness (i.e. average number of species stably present at the end of a simulation) was calculated for 500 simulated instances. Each simulation started with 10 species and 5 mediators and ran for 100 generations. Other simulation parameters are listed in <xref ref-type="table" rid="table1">Table 1</xref>. The error bars are 95% confidence intervals generated by bootstrapping 100 samples.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Lower dispersal rates allow more microbial coexistence.</title><p>Communities in spatially structured environments were simulated with different dispersal coefficients at three different fractions of fac:inh influences (10:90, 50:50, and 90:10). Mean richness (here based on the average number of species present at the end of a simulation) was calculated for 500 simulated instances. Each simulation started with 10 species and 5 mediators and ran for 100 generations (top) or 200 generations (bottom). Other simulation parameters are listed in <xref ref-type="table" rid="table1">Table 1</xref>. The error bars are 95% confidence intervals generated by bootstrapping 100 samples. As expected, assessing species presence after 200 generations shows lower richness compared to 100 generations, since some species go extinct during the additional 100 generations. Nevertheless, both cases show a decreasing richness in spatial communities with larger dispersal coefficients (still richness stays higher than the well-mixed levels).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Self-facilitation contributes to lower richness at intermediate levels of dispersal.</title><p>For these cases, we use fac:inh = 90:10, because it showed the strongest change at intermediate dispersal values. Mean richness (i.e. average number of species stably present at the end of a simulation) was calculated for 500 simulated instances. In each instance, we simulated the enrichment and coexistence in the baseline case (100% <italic>ρ</italic><sub><italic>ij</italic></sub>) as well as the same community when for self-facilitation links, the influence of the corresponding mediator on its producer was reduced by a factor of 5 (20% <italic>ρ</italic><sub><italic>ij</italic></sub>). This is shown visually in the top schematic. This allows us to assess the impact of self-facilitation links in different conditions. We acknowledge that this assessment is not perfect, because weakening self-facilitation links in this way also reduces the beneficial influence of other species on <italic>S<sub>i</sub></italic> that may happen via <italic>C<sub>j</sub></italic>. Nevertheless, we observe that at intermediate dispersal levels (Intermed. Dispersal, spatial; <italic>D<sub>Cell</sub></italic> = 5 × 10<sup>−6</sup> cm<sup>2</sup>/hr), weakening self-facilitation links leads to more coexistence. In contrast, this effect is absent when dispersal levels are low (Low dispersal, spatial; <italic>D<sub>Cell</sub></italic> = 5 × 10<sup>−9</sup> cm<sup>2</sup>/hr) or in well-mixed communities (Well-mixed). Each simulation started with 10 species and 5 mediators and ran for 100 generations. Other simulation parameters are listed in <xref ref-type="table" rid="table1">Table 1</xref>. The error bars are 95% confidence intervals generated by bootstrapping 100 samples.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Rearranging the order of species affects spatial coexistence.</title><p>For each of the cases of (<bold>A</bold>) fac:inh = 10:90, (<bold>B</bold>) fac:inh = 50:50, and (<bold>C</bold>) fac:inh = 90:10, we simulated 100 instances and in each instance, we examined coexistence outcome (final richness) in 100 permutations of the order of species (as an example, 10, 3, 6, 1, 5, 7, 4, 2, 9, 8 would be a permutation of the order of the 10 species). Asterisks (*) show the calculated richness for the corresponding well-mixed community, and the circle (o) and the error bar show the mean and standard deviation of the richness values obtained for the 100 permutations tested. Overall, we observe that it is common to reach a different richness value when the order of species is changed.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig4-figsupp3-v2.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 4.</label><caption><title>Rearranging the order of species affects spatial coexistence more in communities in which facilitation is prevalent.</title><p>Similar to <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>, we simulated 100 instances each of fac:inh = 10:90, 50:50, and 90:10, and in each instance, we examined coexistence outcome (final richness) in 100 permutations of the order of species. Red circles (○) show the calculated richness for the corresponding well-mixed community, and the blue filled circles (●). The standard deviation of the richness values obtained for the 100 permutations are shown in (<bold>A</bold>). The 95% confidence interval for the slope of the standard deviation of richness with respect to <italic>f<sub>p</sub></italic> was 1.01 ± 0.13. The trend was maintained for the coefficient of variations of the 100 permutations as well (<bold>B</bold>). The 95% confidence interval for the slope of the standard deviation of richness with respect to <italic>f<sub>p</sub></italic> was 0.48 ± 0.10. The Matlab function fitlm was used to estimate the slope and its standard error. Confidence intervals are calculated as <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>0.975</mml:mn><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>∙</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the inverse <italic>t</italic> coefficient, <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of data points, and <italic>SE</italic> is the standard error of the slope.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig4-figsupp4-v2.tif"/></fig></fig-group><p>At intermediate levels of dispersal, the trend reversed and well-mixed communities showed more coexistence compared to spatial communities. This is interesting because at the limit of extremely rapid diffusion (shown with a ‘∞’ sign in <xref ref-type="fig" rid="fig4">Figure 4</xref>) when we kept the species distribution uniform across the spatial extent, coexistence outcomes matched the well-mixed case, as expected. We found two factors that contributed to this trend. The first contribution came from longer-term changes in dynamics at intermediate levels of dispersal. Even after 100 generations, which is the typical extent of our studies, at intermediate levels of dispersal (e.g. <italic>D<sub>Cell</sub></italic> = 5 × 10<sup>−6</sup> cm<sup>2</sup>/hr), the spatial distribution of populations is still changing considerably. As a result, our strict criteria for stable coexistence removes some of the populations that are still temporally not stable enough, leading to a lower overall assessment of coexistence in these cases. To show this, we examined the range of dispersal coefficients again, but kept all the species that were present after 100 generations, rather than those with stable population fractions at that point (see Model implementation in Methods). The results show that higher dispersal coefficients using this measure lowers the richness of resulting communities (based on presence, rather than stable presence), but not below the levels expected from well-mixed communities (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). As a second factor, we hypothesized that self-facilitation interactions contribute to the decrease in coexistence at intermediate dispersal levels. Our rationale was that self-facilitation interactions are amplified in communities in which the spatial context is preserved, because the distribution of producers matches the distribution of self, but not other recipients in such a case. This can lead to community overtake by a self-facilitating species. This effect will be weaker in communities at intermediate dispersal rates: at low dispersal rates self-facilitating species will be more confined in space and some of the metabolite will leak out to other species; in the other extreme, in the very high dispersal rates all distributions will become uniform and the distinction between self and others diminishes. To test this, we tested weaker self-facilitation links in our simulations and observed that this change led to higher coexistence in communities with intermediate dispersal coefficients but not in well-mixed communities or communities with low dispersal coefficients (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). It is a matter of debate how prevalent self-facilitation interactions are within microbial communities. Self-facilitation interactions do exist, for example when a species breaks down a recalcitrant substrate such as cellulose into smaller molecules that can be beneficial. However, if they are not as prevalent as what our model assumes, some of our predictions might be affected.</p></sec><sec id="s2-6"><title>Coexistence is disrupted when the diffusion of mediators is too slow</title><p>The rate of diffusion of metabolites also has the potential to affect coexistence. We investigated coexistence over a range of mediator diffusion coefficients. We still typically observe a higher mean richness for spatial communities compared with the well-mixed communities (<xref ref-type="fig" rid="fig5">Figure 5</xref>). However, unlike the conventional wisdom, as the diffusion of mediators becomes slower, coexistence in spatial communities decreases. At low diffusion coefficients, coexistence drops even below that of corresponding well-mixed communities. We associate this trend to weaker effective interactions among species at lower diffusion coefficients. Mediators that are involved in facilitation play a major part in allowing coexistence of species (<xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>); if these mediators get consumed by nearby species and do not travel long enough to reach other members of the community, the interaction-driven mechanism of coexistence is disrupted.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>At higher diffusion coefficients of mediators more coexistence is possible.</title><p>A range of metabolite diffusion coefficients were simulated in spatial communities (squares) at three different fractions of fac:inh influences (10:90, 50:50, and 90:10). We simulated corresponding well-mixed communities (circles) for comparison. Each condition was run 500 times with the richness (number of species stably surviving at the end of a simulation) averaged over all the simulations. Each simulation started with 10 species and 5 mediators and ran for 100 generations. Other simulation parameters are listed in <xref ref-type="table" rid="table1">Table 1</xref>. The error bars are 95% confidence intervals generated by bootstrapping 100 samples.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-fig5-v2.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Our results dispel the common presumption that a spatially structured environment will universally lead to more coexistence. We find that, compared to a well-mixed environment, a spatial environment can favor or disfavor coexistence depending on the balance between species dispersal and the diffusion of interaction mediators. Interestingly, a lower species dispersal rate favors coexistence, but this effect can be diminished or even reversed if accompanied by low mediator diffusion rates. Coexistence is favored when species have a broad range of consumption and an intermediate range of production of interaction mediators. Additionally, we predict more coexistence when there is a balance between overall production and consumption rates for mediators.</p><p>The spatial structure of microbial communities has been extensively studied for example in simulating the development of biofilms (<xref ref-type="bibr" rid="bib39">Wang and Zhang, 2010</xref>; <xref ref-type="bibr" rid="bib16">Kreft et al., 2001</xref>; <xref ref-type="bibr" rid="bib43">Xavier and Foster, 2007</xref>; <xref ref-type="bibr" rid="bib38">von der Schulenburg et al., 2009</xref>), for specific interactions among species (<xref ref-type="bibr" rid="bib24">Momeni et al., 2013b</xref>; <xref ref-type="bibr" rid="bib23">Momeni et al., 2013a</xref>; <xref ref-type="bibr" rid="bib12">Kang et al., 2014</xref>), or for modeling game-theory dynamics (<xref ref-type="bibr" rid="bib29">Nakamaru et al., 1997</xref>; <xref ref-type="bibr" rid="bib3">Brauchli et al., 1999</xref>; <xref ref-type="bibr" rid="bib33">Saxer et al., 2009</xref>; <xref ref-type="bibr" rid="bib11">Hauert and Doebeli, 2004</xref>). However, as there is often a tradeoff between the incorporation of detailed mechanisms and generality of conclusions (<xref ref-type="bibr" rid="bib18">Levins, 1966</xref>; <xref ref-type="bibr" rid="bib22">Momeni et al., 2011</xref>), we chose in this work to explore a simple, general model of chemically mediated microbial interactions. We assumed, for example, that mediators affected species by additively influencing their growth rates. Although it is possible (and even probable) that mediator effects could be multiplicative, nonlinear, or otherwise context dependent and that they may impact other model parameters, we chose here to present what we felt to be the simplest case. Exploration of alternative implementations of mediator effects would make a fascinating follow-up to this work.</p><p>We have made assumptions in our model to simplify the configuration and make the analyses and interpretations easier. We asked if making these assumptions more realistic would affect our conclusions. For example, we have assumed no carrying capacity limit for the growth of our populations. We explored the effect of imposing a total population limit, enforced at each spatial location, and found that it did alter our conclusions (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>). However, because the relationship between carrying capacity and coexistence has been explored extensively elsewhere, we chose parameters to minimize this impact, allowing us to focus on other interspecies interactions (beyond competition) and relative rates of diffusion and dispersal. We also tested the impact of the spatial extent of the community (<italic>Z</italic>), and observed that our results were largely unaffected if the community’s spatial extent was changed by an order of magnitude (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). The effect of larger changes in the spatial extent can be examined by scaling the diffusion and dispersal coefficients accordingly.</p><p>Beyond the details of our assumptions, there are also alternative representations of interactions among species, including a simplified Lotka–Volterra model and its variations (<xref ref-type="bibr" rid="bib40">Wangersky, 1978</xref>), a consumer-resource model (<xref ref-type="bibr" rid="bib10">Goldford et al., 2018</xref>; <xref ref-type="bibr" rid="bib21">Marsland et al., 2019</xref>), or a reduced metabolic model (<xref ref-type="bibr" rid="bib19">Liao et al., 2020</xref>). There are trade-offs in tractability and complexity in choosing which model to use. Our reasoning for adopting the mediator-explicit model was to (1) explicitly include metabolites that mediate the interactions in the model (<xref ref-type="bibr" rid="bib25">Momeni et al., 2017</xref>); (2) incorporate both metabolites that support the growth of other species as well as those that are inhibitory, such as waste products and toxins (<xref ref-type="bibr" rid="bib25">Momeni et al., 2017</xref>); and (3) keep the model simple to allow a clear interpretation of mechanisms and processes when analyzing the results. We think it will be worthwhile to compare the predictions of other models to clarify what assumptions are necessary to generate the trends we have obtained and how general the conclusions are.</p><p>If spatial organization of cells matters, we also expect that the initial spatial position of species in the community impacts coexistence. To test this, we started from 100 simulations instances and in each case, we tried 100 rearrangements, each obtained by shuffling the spatial position of species, while keeping the species properties and interactions intact. Interestingly, in many cases coexistence was affected (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>), indicating that the adjacency to partners is an important determinant of spatial coexistence (as also suggested by <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref> and <xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>). When we examined the effect of the fac:inh ratio on these outcomes, we observed that larger changes in richness when facilitation interactions were more prevalent in the community (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>), which aligns with many of our other results showing that facilitation amplifies the positive effect of spatial structure on coexistence. Although these results are tantalizing, a detailed examination of the spatial organization of populations and metabolites within the community requires a dedicated investigation and is beyond the scope of this work.</p><p>Finally, our model assumes that dispersal and diffusion rates are uniform across species and metabolites, respectively. However, dispersal ability can vary widely across microbial taxa, depending on cell size, motility type, chemotaxis, quorum sensing, and other factors. And how the dispersal rates of individuals scale up to affect population- and community-level dynamics is not well understood. Likewise, the diffusion rates of metabolites have the potential to vary greatly with molecule size and shape. Although outside the scope of this work, we are exploring heterogeneity in these rates of movement as an interesting follow-up.</p><p>Overall, we believe this work revisits how spatial structure—and spatial self-organization—affects community assembly and coexistence. In our model, which emphasizes the contributions of interspecies interactions, we find that the impact of spatial structure on coexistence largely arises from two processes: (1) spatial self-organization, which can improve coexistence by favoring facilitation over inhibition, and (2) localization of interactions, which can promote coexistence in association with self-organization or hamper coexistence by slowing down and weakening species interactions.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Model description</title><p>Our model is an extension of a model introduced earlier (<xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>) in which a set of species interact with each other through diffusible mediators. Each mediator is produced by a subset of species, consumed by a subset of species, and has a positive or negative influence on the growth rate of some species (<xref ref-type="fig" rid="fig1">Figure 1</xref>).<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mtable columnalign="center center" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ2"><mml:math id="m2"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the spatiotemporal density of species <italic>i</italic> (<italic>i</italic> = 1, …, <italic>N<sub>c</sub></italic>). <inline-formula><mml:math id="inf11"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the spatiotemporal concentration of mediator <italic>j</italic> (<italic>j</italic> = 1, …, <italic>N<sub>m</sub></italic>). <italic>D<sub>Cell</sub></italic> is the dispersal coefficient for cells. <italic>D<sub>Med</sub></italic> is the diffusion coefficient for mediators. <inline-formula><mml:math id="inf12"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the local carrying capacity (for the total density of cells) at each location. <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the interaction coefficient expressed as the impact of mediator <italic>j</italic> on species <italic>i</italic>. Additionally,<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf14"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the interaction strength saturation level. <inline-formula><mml:math id="inf15"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are average production rate and consumption rates, respectively, between species <italic>i</italic> and mediator <italic>j</italic>. Similar to <xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>, each species has a basal growth rate (in the absence of interactions with other species), and influential mediators additively modulate this growth rate. At <italic>z</italic> = 0 and <italic>z</italic> = <italic>Z</italic>, no-flow boundary conditions are enforced for both species and mediators by setting the local spatial derivatives of these parameters to zero at the boundaries.</p><p>Typical parameters used in our simulations (unless otherwise stated) are listed in <xref ref-type="table" rid="table1">Table 1</xref>. These parameters are chosen in the expected realistic range of values; for example, the typical diffusion coefficient of small molecules in water is in the range of 100–1000 µm<sup>2</sup>/s, and we have used 500 µm<sup>2</sup>/s as a generic value. When comparing spatial communities with their well-mixed counterparts, exactly the same parameters for basal growth rates, production and consumption rates, mediator influences, and networks of production and consumption are used. This choice is made to reduce the stochasticity caused by other parameters and to focus only on the impact of spatial structure.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Parameters used in our simulations are listed.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Parameter</th><th align="left" valign="bottom">Value (unit)</th></tr></thead><tbody><tr><td align="left" valign="bottom">Number of instances examined (<inline-formula><mml:math id="inf17"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">500</td></tr><tr><td align="left" valign="bottom">Number of cell types in the initial pool (<inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">10</td></tr><tr><td align="left" valign="bottom">Number of interaction mediators (<inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">5</td></tr><tr><td align="left" valign="bottom">Total initial cell density (<italic>TID</italic>)</td><td align="char" char="." valign="bottom">10<sup>4</sup> (cells/ml)</td></tr><tr><td align="left" valign="bottom">Interaction strength saturation level (<inline-formula><mml:math id="inf20"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">10<sup>4</sup> (cells/ml)</td></tr><tr><td align="left" valign="bottom">Population extinction threshold (<italic>ExtTh</italic>)</td><td align="char" char="." valign="bottom">0.1 (cells/ml)</td></tr><tr><td align="left" valign="bottom">Population dilution threshold (<italic>DilTh</italic>)</td><td align="char" char="." valign="bottom">10<sup>7</sup> (cells/ml)</td></tr><tr><td align="left" valign="bottom">Consumption rate (<inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="left" valign="bottom">0.075–2.25 (fmol per cell per hour; avg. 0.15)<break/>Stochastic with a uniform distribution</td></tr><tr><td align="left" valign="bottom">Production rate (<inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="left" valign="bottom">0.1–0.2 (fmol per cell per hour; avg. 0.1)<break/>Stochastic with a uniform distribution</td></tr><tr><td align="left" valign="bottom">Probability of production link per population (<inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">0.5</td></tr><tr><td align="left" valign="bottom">Probability of influence link per mediator (<inline-formula><mml:math id="inf24"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">0.5</td></tr><tr><td align="left" valign="bottom">Maximum interaction strength magnitude (<inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">0.2 (1/hr)</td></tr><tr><td align="left" valign="bottom">Basal growth rate of species (<inline-formula><mml:math id="inf26"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>)</td><td align="left" valign="bottom">0.1–0.2 (1/hr); stochastic with a uniform distribution</td></tr><tr><td align="left" valign="bottom">Number of generations for enrichment (<italic>nGen</italic>)</td><td align="char" char="." valign="bottom">100</td></tr><tr><td align="left" valign="bottom">Dispersal coefficient for cells (<italic>D<sub>Cell</sub></italic>)</td><td align="char" char="ndash" valign="bottom">5 × 10<sup>−9</sup> (cm<sup>2</sup>/hr)</td></tr><tr><td align="left" valign="bottom">Diffusion coefficient for mediators (<italic>D<sub>Med</sub></italic>)</td><td align="char" char="ndash" valign="bottom">1.8 × 10<sup>−2</sup> (cm<sup>2</sup>/hr)</td></tr><tr><td align="left" valign="bottom">Local carrying capacity per dz (<italic>k<sub>Y</sub></italic>)</td><td align="char" char="." valign="bottom">10<sup>9</sup> cells/ml</td></tr><tr><td align="left" valign="bottom">Total community spatial extent (<italic>Z</italic>)</td><td align="char" char="." valign="bottom">0.5 cm</td></tr><tr><td align="left" valign="bottom">Spatial resolution for species distributions (<italic>dz</italic>)</td><td align="char" char="." valign="bottom">0.005 cm</td></tr><tr><td align="left" valign="bottom">Cell growth update and uptake timescale (<italic>dtau</italic>)</td><td align="char" char="." valign="bottom">0.01 hr</td></tr><tr><td align="left" valign="bottom">Mediator diffusion time-step (<italic>dt</italic>)</td><td align="char" char="." valign="bottom">0.1<italic>dz</italic><sup>2</sup>/<italic>D<sub>Med</sub></italic></td></tr><tr><td align="left" valign="bottom">Cell dispersal simulation time-step (<italic>dc</italic>)</td><td align="char" char="." valign="bottom">0.1<italic>dz</italic><sup>2</sup>/<italic>D<sub>Cell</sub></italic></td></tr></tbody></table></table-wrap><p>To sample different possibilities, the interaction terms as well as production and consumption rates are randomly assigned in each instance of the simulation. Similar to our previous work (<xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>), the production/consumption matrices are random, that is each element of the matrix has a binomial distribution with a fixed probability of being present (<inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf28"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for production and consumption/influence links, respectively). The production and consumption rates have a uniform distribution between 0.5 and 1.5 times a set value each (<inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for production and consumption rates, respectively). The interaction matrix which represents the influence of mediators on species has the same structure as the consumption matrix. The magnitude of the influence in this matrix has a uniform distribution between 0 and a maximum value, <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> . The sign of the influence is chosen from a binomial distribution based on the ratio of fac:inh.</p></sec><sec id="s4-2"><title>Model implementation</title><p>We solve the equations in ‘Model description’ numerically in Matlab using a finite difference discrete version of the equations. Mediator diffusion and cell dispersal take place often at very different time scales. To simulate these processes, we use different numerical time-steps to update the mediator and cell distributions. To allow flexibility in modeling different diffusion and dispersal coefficients, we used asynchronous updates with two independent time-steps: one for updating the diffusion of metabolites and another one for growth and dispersal of cells. The source codes are shared for transparency and reproducibility (see Code availability).</p><p>To assess coexistence, we use a criterion similar to <xref ref-type="bibr" rid="bib30">Niehaus et al., 2019</xref>. In short, any species whose density drops below a pre-specified extinction threshold (<italic>ExtTh</italic>) is considered extinct. Among species that persist throughout the simulation, only those are considered to coexist whose relative frequency does not decrease by more than 10% of its value in the last 20 generations of the simulation. We consider these species to be ‘stably present’ in the community. Species whose relative frequency declines faster than this threshold are assumed to go extinct later and are not considered to be part of coexisting communities. The only exception to this criterion is the data in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, in which all present species (rather than stably present species) are included in the assessment of final richness.</p></sec><sec id="s4-3"><title>Statistics</title><p>Mean richness values are calculated by averaging the richness values calculated over all simulated instances for a given condition. Confidence intervals for mean richness values are calculated by bootstrapping over all simulated instances for a given condition. The standard routine in Matlab, bootci, is used in all cases for bootstrapping.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, eLife</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Software, Formal analysis, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Software, Formal analysis, Supervision, Funding acquisition, Investigation, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-82504-mdarchecklist1-v2.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Codes used to generate the data in this study are shared on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/bmomeni/spatial-coexistence">https://github.com/bmomeni/spatial-coexistence</ext-link> (copy archived at <xref ref-type="bibr" rid="bib26">Momeni, 2022</xref>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>BM would like to acknowledge the Award for Excellence from Smith Family Foundation that supported this work. BM would like to also thank the biology department at Boston College for their continued support. We would like to acknowledge the support for AL through an Undergraduate Research Fellowship from Boston College.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allison</surname><given-names>SD</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Cheaters, diffusion and nutrients constrain decomposition by microbial enzymes in spatially structured environments</article-title><source>Ecology Letters</source><volume>8</volume><fpage>626</fpage><lpage>635</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2005.00756.x</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amarasekare</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Competitive coexistence in spatially structured environments: a synthesis</article-title><source>Ecology Letters</source><volume>6</volume><fpage>1109</fpage><lpage>1122</lpage><pub-id pub-id-type="doi">10.1046/j.1461-0248.2003.00530.x</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brauchli</surname><given-names>K</given-names></name><name><surname>Killingback</surname><given-names>T</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Evolution of cooperation in spatially structured populations</article-title><source>Journal of Theoretical Biology</source><volume>200</volume><fpage>405</fpage><lpage>417</lpage><pub-id pub-id-type="doi">10.1006/jtbi.1999.1000</pub-id><pub-id pub-id-type="pmid">10525399</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brockhurst</surname><given-names>MA</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name><name><surname>Rainey</surname><given-names>PB</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Spatial heterogeneity and the stability of host-parasite coexistence</article-title><source>Journal of Evolutionary Biology</source><volume>19</volume><fpage>374</fpage><lpage>379</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2005.01026.x</pub-id><pub-id pub-id-type="pmid">16599913</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chesson</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2000">2000a</year><article-title>General theory of competitive coexistence in spatially-varying environments</article-title><source>Theoretical Population Biology</source><volume>58</volume><fpage>211</fpage><lpage>237</lpage><pub-id pub-id-type="doi">10.1006/tpbi.2000.1486</pub-id><pub-id pub-id-type="pmid">11120650</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chesson</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2000">2000b</year><article-title>Mechanisms of maintenance of species diversity</article-title><source>Annual Review of Ecology and Systematics</source><volume>31</volume><fpage>343</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1146/annurev.ecolsys.31.1.343</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durrett</surname><given-names>R</given-names></name><name><surname>Levin</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>The importance of being discrete (and spatial)</article-title><source>Theoretical Population Biology</source><volume>46</volume><fpage>363</fpage><lpage>394</lpage><pub-id pub-id-type="doi">10.1006/tpbi.1994.1032</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durrett</surname><given-names>R</given-names></name><name><surname>Levin</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Spatial aspects of interspecific competition</article-title><source>Theoretical Population Biology</source><volume>53</volume><fpage>30</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1006/tpbi.1997.1338</pub-id><pub-id pub-id-type="pmid">9500909</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gause</surname><given-names>GF</given-names></name></person-group><year iso-8601-date="1934">1934</year><source>The Struggle for Existence</source><publisher-name>Williams &amp; Wilkins</publisher-name><pub-id pub-id-type="doi">10.5962/bhl.title.4489</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldford</surname><given-names>JE</given-names></name><name><surname>Lu</surname><given-names>N</given-names></name><name><surname>Bajić</surname><given-names>D</given-names></name><name><surname>Estrela</surname><given-names>S</given-names></name><name><surname>Tikhonov</surname><given-names>M</given-names></name><name><surname>Sanchez-Gorostiaga</surname><given-names>A</given-names></name><name><surname>Segrè</surname><given-names>D</given-names></name><name><surname>Mehta</surname><given-names>P</given-names></name><name><surname>Sanchez</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Emergent simplicity in microbial community assembly</article-title><source>Science</source><volume>361</volume><fpage>469</fpage><lpage>474</lpage><pub-id pub-id-type="doi">10.1126/science.aat1168</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hauert</surname><given-names>C</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Spatial structure often inhibits the evolution of cooperation in the snowdrift game</article-title><source>Nature</source><volume>428</volume><fpage>643</fpage><lpage>646</lpage><pub-id pub-id-type="doi">10.1038/nature02360</pub-id><pub-id pub-id-type="pmid">15074318</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>S</given-names></name><name><surname>Kahan</surname><given-names>S</given-names></name><name><surname>Momeni</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Simulating microbial community patterning using Biocellion</article-title><source>Methods in Molecular Biology</source><volume>1151</volume><fpage>233</fpage><lpage>253</lpage><pub-id pub-id-type="doi">10.1007/978-1-4939-0554-6_16</pub-id><pub-id pub-id-type="pmid">24838890</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kerr</surname><given-names>B</given-names></name><name><surname>Riley</surname><given-names>MA</given-names></name><name><surname>Feldman</surname><given-names>MW</given-names></name><name><surname>Bohannan</surname><given-names>BJM</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Local dispersal promotes biodiversity in a real-life game of rock-paper-scissors</article-title><source>Nature</source><volume>418</volume><fpage>171</fpage><lpage>174</lpage><pub-id pub-id-type="doi">10.1038/nature00823</pub-id><pub-id pub-id-type="pmid">12110887</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>HJ</given-names></name><name><surname>Boedicker</surname><given-names>JQ</given-names></name><name><surname>Choi</surname><given-names>JW</given-names></name><name><surname>Ismagilov</surname><given-names>RF</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Defined spatial structure stabilizes a synthetic multispecies bacterial community</article-title><source>PNAS</source><volume>105</volume><fpage>18188</fpage><lpage>18193</lpage><pub-id pub-id-type="doi">10.1073/pnas.0807935105</pub-id><pub-id pub-id-type="pmid">19011107</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>HJ</given-names></name><name><surname>Du</surname><given-names>W</given-names></name><name><surname>Ismagilov</surname><given-names>RF</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Complex function by design using spatially pre-structured synthetic microbial communities: degradation of pentachlorophenol in the presence of Hg(Ii)</article-title><source>Integrative Biology</source><volume>3</volume><fpage>126</fpage><lpage>133</lpage><pub-id pub-id-type="doi">10.1039/c0ib00019a</pub-id><pub-id pub-id-type="pmid">20717565</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kreft</surname><given-names>JU</given-names></name><name><surname>Picioreanu</surname><given-names>C</given-names></name><name><surname>Wimpenny</surname><given-names>JW</given-names></name><name><surname>van Loosdrecht</surname><given-names>MC</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Individual-based modelling of biofilms</article-title><source>Microbiology</source><volume>147</volume><fpage>2897</fpage><lpage>2912</lpage><pub-id pub-id-type="doi">10.1099/00221287-147-11-2897</pub-id><pub-id pub-id-type="pmid">11700341</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kümmerli</surname><given-names>R</given-names></name><name><surname>Schiessl</surname><given-names>KT</given-names></name><name><surname>Waldvogel</surname><given-names>T</given-names></name><name><surname>McNeill</surname><given-names>K</given-names></name><name><surname>Ackermann</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Habitat structure and the evolution of diffusible siderophores in bacteria</article-title><source>Ecology Letters</source><volume>17</volume><fpage>1536</fpage><lpage>1544</lpage><pub-id pub-id-type="doi">10.1111/ele.12371</pub-id><pub-id pub-id-type="pmid">25250530</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levins</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1966">1966</year><article-title>The strategy of model building in population biology</article-title><source>American Scientist</source><volume>54</volume><fpage>421</fpage><lpage>431</lpage></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>T</given-names></name><name><surname>Maslov</surname><given-names>S</given-names></name><name><surname>Xavier</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Modeling microbial cross-feeding at intermediate scale portrays community dynamics and species coexistence</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1008135</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008135</pub-id><pub-id pub-id-type="pmid">32810127</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>B</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Ye</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Stirling</surname><given-names>E</given-names></name><name><surname>Gilbert</surname><given-names>JA</given-names></name><name><surname>Faust</surname><given-names>K</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Jansson</surname><given-names>JK</given-names></name><name><surname>Cardona</surname><given-names>C</given-names></name><name><surname>Röttjers</surname><given-names>L</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Earth microbial co-occurrence network reveals interconnection pattern across microbiomes</article-title><source>Microbiome</source><volume>8</volume><elocation-id>82</elocation-id><pub-id pub-id-type="doi">10.1186/s40168-020-00857-2</pub-id><pub-id pub-id-type="pmid">32498714</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marsland</surname><given-names>R</given-names></name><name><surname>Cui</surname><given-names>W</given-names></name><name><surname>Goldford</surname><given-names>J</given-names></name><name><surname>Sanchez</surname><given-names>A</given-names></name><name><surname>Korolev</surname><given-names>K</given-names></name><name><surname>Mehta</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Energy fluxes drive a transition in the diversity, stability, and functional structure of microbial communities</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1006793</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006793</pub-id><pub-id pub-id-type="pmid">30721227</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Momeni</surname><given-names>B</given-names></name><name><surname>Chen</surname><given-names>CC</given-names></name><name><surname>Hillesland</surname><given-names>KL</given-names></name><name><surname>Waite</surname><given-names>A</given-names></name><name><surname>Shou</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Using artificial systems to explore the ecology and evolution of symbioses</article-title><source>Cellular and Molecular Life Sciences</source><volume>68</volume><fpage>1353</fpage><lpage>1368</lpage><pub-id pub-id-type="doi">10.1007/s00018-011-0649-y</pub-id><pub-id pub-id-type="pmid">21424911</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Momeni</surname><given-names>B</given-names></name><name><surname>Brileya</surname><given-names>KA</given-names></name><name><surname>Fields</surname><given-names>MW</given-names></name><name><surname>Shou</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013a</year><article-title>Strong inter-population cooperation leads to partner Intermixing in microbial communities</article-title><source>eLife</source><volume>2</volume><elocation-id>e00230</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00230</pub-id><pub-id pub-id-type="pmid">23359860</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Momeni</surname><given-names>B</given-names></name><name><surname>Waite</surname><given-names>AJ</given-names></name><name><surname>Shou</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013b</year><article-title>Spatial self-organization favors heterotypic cooperation over cheating</article-title><source>eLife</source><volume>2</volume><elocation-id>e00960</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00960</pub-id><pub-id pub-id-type="pmid">24220506</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Momeni</surname><given-names>B</given-names></name><name><surname>Xie</surname><given-names>L</given-names></name><name><surname>Shou</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Lotka-Volterra Pairwise modeling fails to capture diverse pairwise microbial interactions</article-title><source>eLife</source><volume>6</volume><elocation-id>e25051</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.25051</pub-id><pub-id pub-id-type="pmid">28350295</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Momeni</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Spatial-coexistence</data-title><version designator="swh:1:rev:22ccb5cb7fa51823068f24ee7bfc232a87ca6350">swh:1:rev:22ccb5cb7fa51823068f24ee7bfc232a87ca6350</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:82dde7c8414fb422837472b039e9f62edd42b7d7;origin=https://github.com/bmomeni/spatial-coexistence;visit=swh:1:snp:7d7f511cc27e43577eb122f413df51ad4e770d8e;anchor=swh:1:rev:22ccb5cb7fa51823068f24ee7bfc232a87ca6350">https://archive.softwareheritage.org/swh:1:dir:82dde7c8414fb422837472b039e9f62edd42b7d7;origin=https://github.com/bmomeni/spatial-coexistence;visit=swh:1:snp:7d7f511cc27e43577eb122f413df51ad4e770d8e;anchor=swh:1:rev:22ccb5cb7fa51823068f24ee7bfc232a87ca6350</ext-link></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murrell</surname><given-names>DJ</given-names></name><name><surname>Law</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Heteromyopia and the spatial coexistence of similar competitors</article-title><source>Ecology Letters</source><volume>6</volume><fpage>48</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1046/j.1461-0248.2003.00397.x</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadell</surname><given-names>CD</given-names></name><name><surname>Drescher</surname><given-names>K</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Spatial structure, cooperation and competition in biofilms</article-title><source>Nature Reviews. Microbiology</source><volume>14</volume><fpage>589</fpage><lpage>600</lpage><pub-id pub-id-type="doi">10.1038/nrmicro.2016.84</pub-id><pub-id pub-id-type="pmid">27452230</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakamaru</surname><given-names>M</given-names></name><name><surname>Matsuda</surname><given-names>H</given-names></name><name><surname>Iwasa</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The evolution of cooperation in a lattice-structured population</article-title><source>Journal of Theoretical Biology</source><volume>184</volume><fpage>65</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1006/jtbi.1996.0243</pub-id><pub-id pub-id-type="pmid">9039401</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niehaus</surname><given-names>L</given-names></name><name><surname>Boland</surname><given-names>I</given-names></name><name><surname>Liu</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Fu</surname><given-names>D</given-names></name><name><surname>Henckel</surname><given-names>C</given-names></name><name><surname>Chaung</surname><given-names>K</given-names></name><name><surname>Miranda</surname><given-names>SE</given-names></name><name><surname>Dyckman</surname><given-names>S</given-names></name><name><surname>Crum</surname><given-names>M</given-names></name><name><surname>Dedrick</surname><given-names>S</given-names></name><name><surname>Shou</surname><given-names>W</given-names></name><name><surname>Momeni</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Microbial coexistence through chemical-mediated interactions</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>2052</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-10062-x</pub-id><pub-id pub-id-type="pmid">31053707</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pande</surname><given-names>S</given-names></name><name><surname>Kaftan</surname><given-names>F</given-names></name><name><surname>Lang</surname><given-names>S</given-names></name><name><surname>Svatoš</surname><given-names>A</given-names></name><name><surname>Germerodt</surname><given-names>S</given-names></name><name><surname>Kost</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Privatization of cooperative benefits stabilizes mutualistic cross-feeding interactions in spatially structured environments</article-title><source>The ISME Journal</source><volume>10</volume><fpage>1413</fpage><lpage>1423</lpage><pub-id pub-id-type="doi">10.1038/ismej.2015.212</pub-id><pub-id pub-id-type="pmid">26623546</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satoh</surname><given-names>H</given-names></name><name><surname>Miura</surname><given-names>Y</given-names></name><name><surname>Tsushima</surname><given-names>I</given-names></name><name><surname>Okabe</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Layered structure of bacterial and archaeal communities and their in situ activities in anaerobic granules</article-title><source>Applied and Environmental Microbiology</source><volume>73</volume><fpage>7300</fpage><lpage>7307</lpage><pub-id pub-id-type="doi">10.1128/AEM.01426-07</pub-id><pub-id pub-id-type="pmid">17905889</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saxer</surname><given-names>G</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name><name><surname>Travisano</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Spatial structure leads to ecological breakdown and loss of diversity</article-title><source>Proceedings of the Royal Society B</source><volume>276</volume><fpage>2065</fpage><lpage>2070</lpage><pub-id pub-id-type="doi">10.1098/rspb.2008.1827</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Solé</surname><given-names>RV</given-names></name><name><surname>Bascompte</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Self-Organization in Complex Ecosystems</source><publisher-name>Princeton University Press</publisher-name><pub-id pub-id-type="doi">10.1515/9781400842933</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tilman</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Constraints and tradeoffs: toward a predictive theory of competition and succession</article-title><source>Oikos</source><volume>58</volume><elocation-id>3</elocation-id><pub-id pub-id-type="doi">10.2307/3565355</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tilman</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Competition and biodiversity in spatially structured Habitats</article-title><source>Ecology</source><volume>75</volume><fpage>2</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.2307/1939377</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Tilman</surname><given-names>D</given-names></name><name><surname>Kareiva</surname><given-names>P</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Spatial Ecology</source><publisher-name>Princeton University Press</publisher-name><pub-id pub-id-type="doi">10.1515/9780691188362</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>von der Schulenburg</surname><given-names>DA</given-names></name><name><surname>Pintelon</surname><given-names>TRR</given-names></name><name><surname>Picioreanu</surname><given-names>C</given-names></name><name><surname>Van Loosdrecht</surname><given-names>MCM</given-names></name><name><surname>Johns</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Three-dimensional simulations of biofilm growth in porous media</article-title><source>AIChE Journal</source><volume>55</volume><fpage>494</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1002/aic.11674</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Zhang</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Review of mathematical models for biofilms</article-title><source>Solid State Communications</source><volume>150</volume><fpage>1009</fpage><lpage>1022</lpage><pub-id pub-id-type="doi">10.1016/j.ssc.2010.01.021</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wangersky</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Lotka-Volterra population models</article-title><source>Annual Review of Ecology and Systematics</source><volume>9</volume><fpage>189</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1146/annurev.es.09.110178.001201</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiner</surname><given-names>BG</given-names></name><name><surname>Posfai</surname><given-names>A</given-names></name><name><surname>Wingreen</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spatial ecology of territorial populations</article-title><source>PNAS</source><volume>116</volume><fpage>17874</fpage><lpage>17879</lpage><pub-id pub-id-type="doi">10.1073/pnas.1911570116</pub-id><pub-id pub-id-type="pmid">31434790</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Widder</surname><given-names>S</given-names></name><name><surname>Allen</surname><given-names>RJ</given-names></name><name><surname>Pfeiffer</surname><given-names>T</given-names></name><name><surname>Curtis</surname><given-names>TP</given-names></name><name><surname>Wiuf</surname><given-names>C</given-names></name><name><surname>Sloan</surname><given-names>WT</given-names></name><name><surname>Cordero</surname><given-names>OX</given-names></name><name><surname>Brown</surname><given-names>SP</given-names></name><name><surname>Momeni</surname><given-names>B</given-names></name><name><surname>Shou</surname><given-names>W</given-names></name><name><surname>Kettle</surname><given-names>H</given-names></name><name><surname>Flint</surname><given-names>HJ</given-names></name><name><surname>Haas</surname><given-names>AF</given-names></name><name><surname>Laroche</surname><given-names>B</given-names></name><name><surname>Kreft</surname><given-names>J-U</given-names></name><name><surname>Rainey</surname><given-names>PB</given-names></name><name><surname>Freilich</surname><given-names>S</given-names></name><name><surname>Schuster</surname><given-names>S</given-names></name><name><surname>Milferstedt</surname><given-names>K</given-names></name><name><surname>van der Meer</surname><given-names>JR</given-names></name><name><surname>Groβkopf</surname><given-names>T</given-names></name><name><surname>Huisman</surname><given-names>J</given-names></name><name><surname>Free</surname><given-names>A</given-names></name><name><surname>Picioreanu</surname><given-names>C</given-names></name><name><surname>Quince</surname><given-names>C</given-names></name><name><surname>Klapper</surname><given-names>I</given-names></name><name><surname>Labarthe</surname><given-names>S</given-names></name><name><surname>Smets</surname><given-names>BF</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><collab>Isaac Newton Institute Fellows</collab><name><surname>Soyer</surname><given-names>OS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Challenges in microbial ecology: building predictive understanding of community function and dynamics</article-title><source>The ISME Journal</source><volume>10</volume><fpage>2557</fpage><lpage>2568</lpage><pub-id pub-id-type="doi">10.1038/ismej.2016.45</pub-id><pub-id pub-id-type="pmid">27022995</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xavier</surname><given-names>JB</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Cooperation and conflict in microbial biofilms</article-title><source>PNAS</source><volume>104</volume><fpage>876</fpage><lpage>881</lpage><pub-id pub-id-type="doi">10.1073/pnas.0607651104</pub-id><pub-id pub-id-type="pmid">17210916</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82504.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Mitri</surname><given-names>Sara</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/019whta54</institution-id><institution>University of Lausanne</institution></institution-wrap><country>Switzerland</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.08.01.502385" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.08.01.502385"/></front-stub><body><p>This important study uses computational simulations to explore when spatial structure can promote the coexistence between different microbial species and when not, ultimately helping to explain diversity in microbial communities. The evidence supporting the conclusions is convincing, based on extensive parameter sweeps. The conclusion that spatial structure only promotes coexistence under certain conditions is a testable hypothesis that is very interesting to microbial ecologists quite broadly.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82504.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Mitri</surname><given-names>Sara</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/019whta54</institution-id><institution>University of Lausanne</institution></institution-wrap><country>Switzerland</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Amor</surname><given-names>Daniel R</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01faaaf77</institution-id><institution>University of Graz</institution></institution-wrap><country>Austria</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.08.01.502385">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.08.01.502385v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Spatial structure may favor or disfavor microbial coexistence&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Naama Barkai as the Senior Editor. The following individuals involved in the review of your submission have agreed to reveal their identity: Daniel R Amor (Reviewer #1).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>As you can read in more detail below, the three reviewers all made similar recommendations to improve your manuscript. Please address at least the following points:</p><p>1) Justify the definition of coexistence (the 90% threshold);</p><p>2) Justify the way dispersal is implemented and the choice of diffusion coefficients;</p><p>3) Check for typos in the equations and the implementation of the carrying capacity;</p><p>4) Explore how relaxing these assumptions or using more realistic parameter values would affect current conclusions;</p><p>5) Explore not only coexistence but also population composition and the resulting spatial patterns.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>I present here more concrete suggestions and concerns related to my comments in the public review.</p><p>1. I believe that there might be some errors in how the model's equations for species dynamics (line 298) were written in the manuscript. In the equation in line 299, should the term above the total cell carrying capacity (Ky) be a sum of all the species abundances instead of all the metabolites abundances? I believe that this is not the way that the matlab code was implemented, but it would be worth it for the authors to double-check this in all the scripts.</p><p>Ksat should have the same units as Cj(z,t), which is in disagreement with the units proposed in table 1. Similarly, Ky should have the same units as Si(z,t). Furthermore, it was not very clear how interactions, production, and consumption rates were assigned. Do they exist with a certain probability and, provided that they exist, their strength is sampled from a uniform distribution?</p><p>2. Line 321 defines the criteria to determine coexistence: 'only those with relative frequencies equal to or larger than 90% of the fastest growing species in the last 20 generations of the simulation are considered to coexist'. I am surprised by the relatively high (90%) threshold. This means that a pair of species that reaches a stable equilibrium of e.g. 10^7cells/ mL and 8*10^6 cells/mL is not classified as a pair of coexisting species. Please, discuss why the criteria imply such a high evenness of species abundances (experimental measures often report stable coexistence of species at many different fractions). I wonder if relaxing this strong requirement would significantly affect the results of community richness.</p><p>3. The text should be more clear from the beginning that the 'slow dispersal' scenario that is analyzed through the first sections (Figures1-3) is qualitatively very similar to a 'zero dispersal' scenario. Just to illustrate why I think this, one can use the Fisher's front speed solution v = 2*sqrt (r*D) to have an estimate (based on the proposed parameter values) of how much distance a monoculture could travel in the absence of interactions. The result, taking into account the timescale of the simulations (~350 hr, assuming r0 = 0.2/hr), is a total distance of ~0.02cm, which is consistent with the results in Figure S2. This means that, in this regime, microbial dynamics are mostly driven by growth, not by dispersal. On the other hand, considering the value of D in the 'fast dispersal' scenario gives an approximate front speed of 2*10^(-3)cm/hr (travelling ~0.7cm in 350 hours) for a monoculture in the absence of interactions. This is closer to observed speeds for colonies of non-motile bacteria growing on hard agar, and still falls on the slower end for such speeds. If one thinks about motile bacteria in soft agar, the speeds are even faster. Overall, I wonder about the kind of system that the 'slow dispersal' scenario could be modelling and, more importantly, whether the authors would consider analyzing the implications of 'fast dispersal' scenarios in more depth. How would Figures2 and 3 look under fast dispersal?</p><p>4. The figures of the main text could incorporate more analysis and results that further support the main message of each figure. Most of the figures contain only one panel (or one type of panel) and further information on the many parameters that could affect that result is left to the Supplementary Information. In some cases, just bringing some of the supplementary analysis to the main figures would make them more comprehensive while increasing the readability of the paper. Just to give some examples, figure 1 could incorporate the cartoon that explains the model (Figure S1), a time series, and some spatial profiles of species abundances to illustrate the typical dynamics of the system (e.g. incorporate some of the data in Figure S2). More snapshots of spatial profiles would help understand what happens in different scenarios, e.g. in Figure S6. In figures 2 and 3, how do these results depend on the average interaction strength (growth rate impact) of metabolites-to-bacteria?</p><p>5. The work will benefit from the additional analysis that can strengthen certain interpretations of the current results. For example, Figure S5 shows the dependence of species richness on the carrying capacity of the system. The authors claim that a shift towards intraspecies competition is responsible for such dependence and that a limited carrying capacity suppresses the more competitive species, but no statistical analysis on individual species performance is provided to back this argument (and species competitiveness is lacking a working definition). The criteria to determine the length of the simulations is another example, the authors said that 100 generations are 'often' enough to reach stability, but a more rigorous analysis or definition of stability would be better. Regarding the statement in line 116, an analysis of how much better or worse species grow when close to facilitative/inhibitory partners would be helpful.</p><p>6. The lack of analysis/visualization of spatial profiles for metabolite abundances leaves the reader wondering about the spatial scale of the interactions. Some representative cases could appear in the supplement, or be incorporated into one of the main figures.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The authors extend a mathematical model that they previously developed (Niehaus..Momeni, Nature Comm., 2019) for the study of microbial communities growing in well-mixed settings, to the case where species grow in spatial settings. They find that spatial structure promotes the coexistence of species when interactions are more facilitating than inhibiting, and when species dispersal is low. We found the paper well-written and well-organized. However, we have a number of comments: the main contribution of the paper is to extend a well-mixed model to a spatial model; It is thus fundamental that the assumptions made by the authors to model the spatial dynamics are well justified; we think that several physical parameters are chosen to values that do not represent realistic values for spatially structured communities and that the authors should discuss if the results hold also for more realistic values.</p><p>Line 84: The Authors state that they start each simulation from an initial distribution in which populations occupy adjacent, overlapping spatial locations at low initial density. What is the variation in the steady state distribution of species if they run many simulations with the same initial state and with the same parameters?</p><p>Line 88: &quot;We have chosen 100 generations of growth because we have observed that often this is enough to reliably decide which species stably persist in the community.&quot; We think that the concept of generation is not clear. Can the authors define what generation means exactly? Also, can they provide a quantification for &quot;reliably&quot; when they say that the system converges reliably?</p><p>Line 91: The authors define a specific dilution procedure. We do not understand how they motivate this specific choice of dilution procedure. At each dilution step, they assume that the overall spatial distribution of the community is preserved and all populations at all locations are diluted by the same factor. Regarding this assumption, the authors say that they &quot;adopt it as the least biased possibility, in the absence of additional information about a particular community.&quot; We have two questions regarding this assumption:</p><p>i) Is this really the least biased assumption? We suggest that a random distribution of the initial species is more a null model than the current choice. Or is there a reason to think that cells forming a new community by default inherit the spatial configuration of the parent community?</p><p>ii) Do the authors have a natural mechanism of community propagation in mind that they could refer to, which would correspond to their assumption?</p><p>Having in mind the concept of metacommunities, we don't understand how spatial distribution can be inherited by the new community.</p><p>Line 101: The authors say that a shift from competition to competition can favor coexistence in a spatially structured environment. When doing this analysis, the authors impose a cap on the total cell number that can exist at each location in space. The more restrictive the cap is, the more coexistence they find.</p><p>Regarding this conclusion, we would like the author to comment on the choice of the cap. The cap they pick is 10^9 cells/ml. This density is quite a low density for a spatially structured system. A back-of-the-envelope calculation can show that at 10^9 cells/ml, the volume ratio between cells and environment is 1:1000, if we consider that a cell occupies approximately 1 μm cube (e.g. <italic>E. coli</italic> in Minimal media+glucose is about that size. See: https://www.ncbi.nlm.nih.gov/books/NBK224751/). These are the order of magnitude estimates of course, but they suggest that the authors use a density that is much lower than expected in a spatially structured community, like a biofilm. In fact,10^9 cells/ml is about the density of cells in an overnight of <italic>E. coli</italic> grown in Minimal media (M9) with 0.2% glucose. We would suggest picking values closer to a dense community, and our expectation is that spatially structured communities should be at least 10^11 cells/ml. Following the calculation above, this would lead to a volume ratio between cells and the environment of 1:10, if we consider that a cell occupies 1 μm cube.</p><p>We would like the authors to comment on the following two points:</p><p>i) Why do they pick 10^9 cells/ml as a maximum cap, which seems such a low density?</p><p>ii) The authors pick 10^9 cells/ml because this cap maximizes coexistence. In light of the calculation we do here, what would happen if they used higher values of cell densities?</p><p>Line 101: 10^9 cells/ml is not 10^9 cells/cm as stated in Table 1. Can we think of these units as being the same? If yes, can units be homogenized? At the moment most of the units suggest that the effective dynamics is a 3D dynamics (e.g. diffusion constants, densities of cells), even if then they implement a 1D world, where there exists a line of &quot;cubes&quot; filled with sub-communities.</p><p>Table 1: The authors state that &quot;Diffusion coefficient for mediators (DMed) 1.8 10-3 (cm2/hr)&quot;.</p><p>Again we do not understand the choice of parameters. When we look at realistic values of molecules diffusing, we see that these are more than 10 times faster. Here are two examples for glucose and for one amino acid:</p><p>For Glucose, the diffusion constant in water is 600 um^2 /sec, which is about 21*10-3 cm2/hr. See: https://bionumbers.hms.harvard.edu/bionumber.aspx?s=n&amp;v=7&amp;id=104089</p><p>For amino acids, the diffusion constant in water is 800 um^2/sec. See Wu, Y., Ma, P., Liu, Y. &amp; Li, S. Diffusion coefficients of l-proline, l-threonine and l-arginine in aqueous solutions at 25◦C. Fluid Phase Equilibria 186, 27-38 (2001).</p><p>Table 1: Can they comment on the value of diffusion of species? This value represents somehow a fraction of individuals that move away from the local patch into another patch. What should we think this fraction to be?</p><p>Figure 1: what is the explanation for which, at a low fraction of facilitative interactions, coexistence in well-mixed and spatial communities is the same? Can they comment on this?</p><p>Figure 5: Do the authors expect that by increasing diffusion even further, coexistence should decrease again? Does the exploration stop at the maximum diffusion expected in liquid?</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>– I think there is a typo in the equations shown in the &quot;Model description&quot; section. In the population dynamics equation, the carrying capacity term (the one with k_Y) appears to contain a sum over the C_j rather than the expected sum over the S_i. In the supplied code, it appears that this term sums over the populations.</p><p>– Assuming the carrying capacity term is meant to contain a sum over the S_i rather than the C_j, the current formulation of this model may lead to non-physical outcomes. Consider a population that is above carrying capacity, such that the carrying capacity term is negative. If this population is also surrounded by highly detrimental chemical mediators (such that its interaction term is negative), the product of the negative carrying capacity and interaction terms will result in a positive growth rate. From the code I have looked at (Spatial1DInteraction_DpMM_ExMTC_flexibleTimeStep.m, lines 103-110), there doesn't seem to be any mechanism to prevent this. However, from the supplementary plots, it does not appear that the steady-state population abundances exceed the k_Y. The authors should assess whether these non-physical dynamics occur in their simulations, as it could artificially inflate coexistence. One possible solution is to set the population growth to zero if the carrying capacity is exceeded.</p><p>– One limitation of the authors' current analyses is that it is based only on richness, which does not reflect population abundance. Equivalent comparisons between the spatial and non-spatial models could be made with a metric like the Shannon entropy, which does consider population abundance. To compute the Shannon entropy in the spatial model, one could measure the total population of each cell type by integrating over the domain. From these abundances, a relative abundance distribution compatible with the Shannon entropy could be calculated. It would be worthwhile to assess whether the observed trends are similar when other metrics are used.</p><p>– I think it would be worthwhile for the authors to quantify the spatial patterns of coexistence in their model. I understand the authors' reasoning for focusing on a metric that does not consider spatial structure, as such metrics are the only ones that can be used to compare directly between spatial and well-mixed systems. However, from the plots shown in Figure S2, it appears that coexistence in this model can manifest as quite non-trivial spatial patterns. Spatial coexistence patterns of natural microbial communities are often strikingly beautiful, and it would be interesting to assess how this model's parameters influence its resulting spatial coexistence patterns. For example, one could examine the relationship between the mediator and microbe diffusion rates and the size/overlap of microbial domains, or analyze the existence of the seeming &quot;dead-zones&quot; of the domain seen in the bottom right panel of Figure S2.</p><p>– I find the result that changing the order of species in the initial condition can change the final richness to be very interesting (Figure S8). This result implies that there is a great deal of multistability in the dynamics. In a metapopulation context, this could be its own diversity-generating mechanism. I think discussing this multistability more explicitly in the main text would be worthwhile: is this multistability a result of spatial dynamics?</p><p>– The authors should specify the distribution of mediator production/consumption and interaction coefficients. Currently, I'm not sure what distribution these parameters are drawn from.</p><p>– In the figures with well-mixed vs. spatial heatmaps, it may be worthwhile to include a plot that directly depicts the ratio of the two model's richness values. As it stands, I found it a bit difficult to immediately see the differences between the well-mixed and spatial results.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82504.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>As you can read in more detail below, the three reviewers all made similar recommendations to improve your manuscript. Please address at least the following points:</p><p>1) Justify the definition of coexistence (the 90% threshold);</p></disp-quote><p>As explained below in response to reviewers’ comments, in our definition of coexistence, we assess the changes in the relative frequency of species in the last 20 generations (compared to the fastest growing species) of our simulations. If the relative frequency of a species drops by more than 10% within 20 generations, we assume that they are destined to go extinct in the long-term. The idea is to eliminate species that are slowly going extinct, but are still present after 100 generations (the typical extent of each of our simulations). To be clear, there is no threshold on the steady state relative frequency of each species; i.e. the ratio of fastest growing to slowest growing coexisting species can be 1e6:1, 1:1, or 1:1e6, as long as the ratio does not change considerably during the last 20 generations of our simulations. We have reworded the sentence to 'only those species whose relative frequency do not drop by more than 10% compared to the fastest growing species in the last 20 generations of the simulation are considered to coexist.' We have also included Figure 4—figure supplement 1 as an example of a modified criterion to examine the final richness based on which species are present, rather than which species are stably present.</p><disp-quote content-type="editor-comment"><p>2) Justify the way dispersal is implemented and the choice of diffusion coefficients;</p></disp-quote><p>The primary reason for choosing the dispersal coefficients to be relatively small was to maintain the spatial structure of the community. This choice was made to highlight how spatial structure can contribute to coexistence. Our vision of an example of a community being discussed was a microbial mat in which there can be dispersal but a strong stratification is maintained. We agree with the reviewers that including a wider range of parameters would be informative; we have thus expanded our scope and included a wider range of parameters (including higher dispersal rates) in the revised version.</p><disp-quote content-type="editor-comment"><p>3) Check for typos in the equations and the implementation of the carrying capacity;</p></disp-quote><p>Thank you for pointing this out. The typo is fixed in the revised version.</p><disp-quote content-type="editor-comment"><p>4) Explore how relaxing these assumptions or using more realistic parameter values would affect current conclusions;</p></disp-quote><p>Our focus here is on general concepts, based on the relative rates of mediator diffusion and cell dispersal, rather than on attempting to recreate a particular community. Nevertheless, the choices made about the parameters are such that they are relevant to some examples of microbial communities such as microbial mats. We have included additional sentences to the introduction section to make it clear that in this paper we examine different ranges of parameters (some of them intentionally close to extremes) to explore different mechanisms and general principles.</p><disp-quote content-type="editor-comment"><p>5) Explore not only coexistence but also population composition and the resulting spatial patterns.</p></disp-quote><p>To address this comment, we have added more instances of spatial patterns of the communities along with coexistence results. We have also used Shannon index as a measure of evenness of the community in some of our comparisons of well-mixed versus spatial communities. We would like to emphasize that a detailed examination of the spatial organization of populations and metabolites within the community requires a dedicated investigation and is beyond the scope of this work. We plan to address these spatial organization aspects in future work.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>I present here more concrete suggestions and concerns related to my comments in the public review.</p><p>1. I believe that there might be some errors in how the model's equations for species dynamics (line 298) were written in the manuscript. In the equation in line 299, should the term above the total cell carrying capacity (Ky) be a sum of all the species abundances instead of all the metabolites abundances? I believe that this is not the way that the matlab code was implemented, but it would be worth it for the authors to double-check this in all the scripts.</p><p>Ksat should have the same units as Cj(z,t), which is in disagreement with the units proposed in table 1. Similarly, Ky should have the same units as Si(z,t). Furthermore, it was not very clear how interactions, production, and consumption rates were assigned. Do they exist with a certain probability and, provided that they exist, their strength is sampled from a uniform distribution?</p></disp-quote><p>Thank you for pointing out the typo. You are correct, that term is in fact the sum of all species abundances and we have confirmed that this was correctly implemented in our simulation codes in Matlab. We have fixed the Equation in the revised version.</p><p>We have added the following paragraph to clarify how the interactions and production/consumption rates were assigned (lines 393-402):</p><p>“To sample different possibilities, the interaction terms as well as production and consumption rates are randomly assigned in each instance of the simulation. Similar to our previous work [25], the production/consumption matrices are random, i.e. each element of the matrix has a binomial distribution with a fixed probability of being present (<italic>q<sub>p</sub></italic> and <italic>q<sub>c</sub></italic> for production and consumption/influence links, respectively). The production rate and consumption rates have a uniform distribution between 0.5 and 1.5 times a set value each (β<sub>ij</sub> and α<sub>ij</sub> for production and consumption rates, respectively). The interaction matrix which represents the influence of mediators on species has the same structure as the consumption matrix. The magnitude of the influence in this matrix has a uniform distribution between 0 and a maximum value, <italic>r<sub>int,0</sub></italic>. The sign of the influence is chosen from a binomial distribution based on the ratio of fac:inh.”</p><disp-quote content-type="editor-comment"><p>2. Line 321 defines the criteria to determine coexistence: 'only those with relative frequencies equal to or larger than 90% of the fastest growing species in the last 20 generations of the simulation are considered to coexist'. I am surprised by the relatively high (90%) threshold. This means that a pair of species that reaches a stable equilibrium of e.g. 10^7cells/ mL and 8*10^6 cells/mL is not classified as a pair of coexisting species. Please, discuss why the criteria imply such a high evenness of species abundances (experimental measures often report stable coexistence of species at many different fractions). I wonder if relaxing this strong requirement would significantly affect the results of community richness.</p></disp-quote><p>Sorry for the confusion. The 90% threshold applies to the changes in the relative frequency in the last 20 generations compared to the fastest growing species. Coexisting species can have any relative frequency compared to each other (1:1 or 1:10<sup>6</sup>) in terms of the composition of the community. However, if the relative frequency of a population drops by more than 10% in 20 generations, we assume that they are destined to go extinct in the long-term. The idea is to eliminate species that are slowly going extinct, but are still present after 100 generations which is the typical extent of each run. We have reworded the sentence to the following (lines 412-420):</p><p>“To assess coexistence, we use a criterion similar to [25]. In short, any species whose density drops below a pre-specified extinction threshold (ExtTh) is considered extinct. Among species that persist throughout the simulation, only those with relative frequencies equal to or larger than 90% of the fastest growing species in the last 20 generations of the simulation are considered to coexist. We consider these species to be ‘stably present’ in the community. Species with a declining relative frequency are assumed to go extinct later and are not considered to be part of coexisting communities. The only exception to this criterion is the data in Figure 4—figure supplement 1, in which all ‘present’ species (rather than stably present species) are included in the assessment of final richness.”</p><p>We have also changed the terminology to call species that satisfy this criterion and coexist in a community as ‘stably present’ to make the distinction clearer.</p><disp-quote content-type="editor-comment"><p>3. The text should be more clear from the beginning that the 'slow dispersal' scenario that is analyzed through the first sections (Figures1-3) is qualitatively very similar to a 'zero dispersal' scenario. Just to illustrate why I think this, one can use the Fisher's front speed solution v = 2*sqrt (r*D) to have an estimate (based on the proposed parameter values) of how much distance a monoculture could travel in the absence of interactions. The result, taking into account the timescale of the simulations (~350 hr, assuming r0 = 0.2/hr), is a total distance of ~0.02cm, which is consistent with the results in Figure S2. This means that, in this regime, microbial dynamics are mostly driven by growth, not by dispersal. On the other hand, considering the value of D in the 'fast dispersal' scenario gives an approximate front speed of 2*10^(-3)cm/hr (travelling ~0.7cm in 350 hours) for a monoculture in the absence of interactions. This is closer to observed speeds for colonies of non-motile bacteria growing on hard agar, and still falls on the slower end for such speeds. If one thinks about motile bacteria in soft agar, the speeds are even faster. Overall, I wonder about the kind of system that the 'slow dispersal' scenario could be modelling and, more importantly, whether the authors would consider analyzing the implications of 'fast dispersal' scenarios in more depth. How would Figures2 and 3 look under fast dispersal?</p></disp-quote><p>We agree with the reviewer about the range of dispersal represented in Figures1-3. The low dispersal regime was initially chosen as a way to make a clear distinction from the well-mixed condition and exaggerate the spatial aspects. We would like to emphasize that even changes in this regime, which would be perhaps considered minor differences in motility, still have an impact on coexistence. We have included additional results of ‘fast dispersal’ in the supplementary information of the revised manuscript (Figure 1—figure supplement 2). We have also expanded Figure 4 to include ‘fast dispersal’ and added the corresponding discussions and two supplementary figures (Figure 4—figure supplement 1 and Figure 4—figure supplement 2) in the revised manuscript (lines 236-274).</p><p>“At intermediate levels of dispersal, the trend reversed and well-mixed communities showed more coexistence compared to spatial communities. This is interesting because at the limit of extremely rapid diffusion (shown with a ‘∞’ sign in Figure 4) when we kept the species distribution uniform across the spatial extent, coexistence outcomes matched the well-mixed case, as expected. We found two factors that contributed to this trend. The first contribution came from longer-term changes in dynamics at intermediate levels of dispersal. Even after 100 generations, which is the typical extent of our studies, at intermediate levels of dispersal (e.g. DCell = 5×10-6 cm2/hr), the spatial distribution of populations is still changing considerably. As a result, our strict criteria for stable coexistence removes some of the populations that are still temporally not stable enough, leading to a lower overall assessment of coexistence in these cases. To show this, we examined the range of dispersal coefficients again, but kept all the species that were present after 100 generations, rather than those with stable population fractions at that point (see Model implementation in Methods). The results show that higher dispersal coefficients using this measure lowers the richness of resulting communities (based on presence, rather than stable presence), but not below the levels expected from well-mixed communities (Figure 4—figure supplement 1). As a second factor, we hypothesized that self-facilitation interactions contribute to the decrease in coexistence at intermediate dispersal levels. Our rationale was that self-facilitation interactions are amplified in communities in which the spatial context is preserved, because the distribution of producers matches the distribution of self, but not other recipients in such a case. This can lead to community overtake by a self-facilitating species. This effect will be weaker in communities at intermediate dispersal rates: at low dispersal rates self-facilitating species will be more confined in space and some of the metabolite will leak out to other species; in the other extreme, in the very high dispersal rates all distributions will become uniform and the distinction between self and others diminishes. To test this, we tested weaker self-facilitation links in our simulations and observed that this change led to higher coexistence in communities with intermediate dispersal coefficients but not in well-mixed communities or communities with low dispersal coefficients (Figure 4—figure supplement 2). It is a matter of debate how prevalent self-facilitation interactions are within microbial communities. Self-facilitation interactions do exist, for example when a species breaks down a recalcitrant substrate such as cellulose into smaller molecules that can be beneficial. However, if they are not as prevalent as what our model assumes, some of our predictions might be affected.”</p><disp-quote content-type="editor-comment"><p>4. The figures of the main text could incorporate more analysis and results that further support the main message of each figure. Most of the figures contain only one panel (or one type of panel) and further information on the many parameters that could affect that result is left to the Supplementary Information. In some cases, just bringing some of the supplementary analysis to the main figures would make them more comprehensive while increasing the readability of the paper. Just to give some examples, figure 1 could incorporate the cartoon that explains the model (Figure S1), a time series, and some spatial profiles of species abundances to illustrate the typical dynamics of the system (e.g. incorporate some of the data in Figure S2). More snapshots of spatial profiles would help understand what happens in different scenarios, e.g. in Figure S6. In figures 2 and 3, how do these results depend on the average interaction strength (growth rate impact) of metabolites-to-bacteria?</p></disp-quote><p>Thank you for the suggestion. We have combined former Figure S1 with Figure 1, in response to your suggestion. To make the relevant figures more accessible, we have also renamed the supplementary figures as Figure 1-S1, Figure 1-S2, etc. to take advantage of the <italic>eLife</italic> format that aggregates all supplementary figures related to each main figure. We believe this format will make it easier for the reader to see additional aspects related to the message of each figure (which are provided in supplementary figures).</p><p>We have also added supplementary figures to show that the trends in Figures2 and 3 are preserved at weaker and stronger interaction levels (Figure 2—figure supplement 2, Figure 2—figure supplement 3, Figure 3figure supplement 2, and Figure 3—figure supplement 3).</p><p>Figure 1—figure supplement 3 in the revised version addresses your concern about more snapshots of the spatial profile by comparing the low-dispersal and high-dispersal cases.</p><disp-quote content-type="editor-comment"><p>5. The work will benefit from the additional analysis that can strengthen certain interpretations of the current results. For example, Figure S5 shows the dependence of species richness on the carrying capacity of the system. The authors claim that a shift towards intraspecies competition is responsible for such dependence and that a limited carrying capacity suppresses the more competitive species, but no statistical analysis on individual species performance is provided to back this argument (and species competitiveness is lacking a working definition). The criteria to determine the length of the simulations is another example, the authors said that 100 generations are 'often' enough to reach stability, but a more rigorous analysis or definition of stability would be better. Regarding the statement in line 116, an analysis of how much better or worse species grow when close to facilitative/inhibitory partners would be helpful.</p></disp-quote><p>To show our rationale behind the choice of 100 generations as a representative time for the outcome of the communities, we have added a supplementary figure (Figure 1—figure supplement 1). It demonstrates that the community composition after 100 generations typically only undergoes small fluctuations in both well-mixed and spatial communities.</p><p>Regarding the statement in line 116, we have added Figure 1—figure supplement 6 as an example of commensalism when the distance between the provider and recipient was changed. In this example, the benefit received depended on the diffusion of the mediator. As a result, stronger interaction was observed when species are closer to each other.</p><disp-quote content-type="editor-comment"><p>6. The lack of analysis/visualization of spatial profiles for metabolite abundances leaves the reader wondering about the spatial scale of the interactions. Some representative cases could appear in the supplement, or be incorporated into one of the main figures.</p></disp-quote><p>Thank you for the suggestion. We have added more representative cases of both spatial patterns (Figure 1—figure supplement 3) and community dynamics (Figure 1—figure supplement 4 and Figure 1—figure supplement 5) in the revised version of the manuscript.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>The authors extend a mathematical model that they previously developed (Niehaus..Momeni, Nature Comm., 2019) for the study of microbial communities growing in well-mixed settings, to the case where species grow in spatial settings. They find that spatial structure promotes the coexistence of species when interactions are more facilitating than inhibiting, and when species dispersal is low. We found the paper well-written and well-organized. However, we have a number of comments: the main contribution of the paper is to extend a well-mixed model to a spatial model; It is thus fundamental that the assumptions made by the authors to model the spatial dynamics are well justified; we think that several physical parameters are chosen to values that do not represent realistic values for spatially structured communities and that the authors should discuss if the results hold also for more realistic values.</p></disp-quote><p>Thank you for your constructive feedback. We have revised the manuscript to explain the model assumptions and fixed some of the errors that had created the impression that the model parameters were not realistic.</p><disp-quote content-type="editor-comment"><p>Line 84: The Authors state that they start each simulation from an initial distribution in which populations occupy adjacent, overlapping spatial locations at low initial density. What is the variation in the steady state distribution of species if they run many simulations with the same initial state and with the same parameters?</p></disp-quote><p>With the same initial state and the same parameters, the simulations are deterministic and there is no stochasticity in the results. The stochasticity is intentionally introduced in the properties of the species (e.g. basal growth rates, rates of consumption and production, etc.) to assess the outcomes in many instances of simulated communities.</p><disp-quote content-type="editor-comment"><p>Line 88: &quot;We have chosen 100 generations of growth because we have observed that often this is enough to reliably decide which species stably persist in the community.&quot; We think that the concept of generation is not clear. Can the authors define what generation means exactly? Also, can they provide a quantification for &quot;reliably&quot; when they say that the system converges reliably?</p></disp-quote><p>Generation is defined as the amount of time in which the sum of population density of all species doubles. Practically, the number of generations in each time step (dt) is calculated as ln(ΣS<sub>t+dt</sub>/ΣS<sub>t</sub>)/ln(2). We use this convention to describe the progression of communities in a unified way, instead of using the actual time which will need to be normalized between cases with different growth rates.</p><p>To show our rationale behind the choice of 100 generations as a representative time for the outcome of simulated communities, we have added a supplementary figure (Figure 1—figure supplement 1). It demonstrates that the community composition after 100 generations typically only undergoes small fluctuations in both well-mixed and spatial communities.</p><disp-quote content-type="editor-comment"><p>Line 91: The authors define a specific dilution procedure. We do not understand how they motivate this specific choice of dilution procedure. At each dilution step, they assume that the overall spatial distribution of the community is preserved and all populations at all locations are diluted by the same factor. Regarding this assumption, the authors say that they &quot;adopt it as the least biased possibility, in the absence of additional information about a particular community.&quot; We have two questions regarding this assumption:</p><p>i) Is this really the least biased assumption? We suggest that a random distribution of the initial species is more a null model than the current choice. Or is there a reason to think that cells forming a new community by default inherit the spatial configuration of the parent community?</p><p>ii) Do the authors have a natural mechanism of community propagation in mind that they could refer to, which would correspond to their assumption?</p><p>Having in mind the concept of metacommunities, we don't understand how spatial distribution can be inherited by the new community.</p></disp-quote><p>We acknowledge that this choice is one among several possible options. One motivation for this choice was to preserve the spatial patterns that set spatial communities apart from well-mixed communities. We have revised the text to justify our choice and address your concern (lines 95102):</p><p>“At each dilution step, we assume that the overall spatial distribution of the community is preserved and all populations at all locations are diluted with the same factor. We recognize that this assumption is not universally true; however, we adopt it as an approximation, in the absence of additional information about a particular community. Such a dilution preserves some of the spatial structure of the community in the next round of growth and could represent a biofilm getting partially washed away by rain or in a microfluidic device, gut microbiota after a defecation event, or a broken-off portion of a granule initiating a new granule.”</p><disp-quote content-type="editor-comment"><p>Line 101: The authors say that a shift from competition to competition can favor coexistence in a spatially structured environment. When doing this analysis, the authors impose a cap on the total cell number that can exist at each location in space. The more restrictive the cap is, the more coexistence they find.</p><p>Regarding this conclusion, we would like the author to comment on the choice of the cap. The cap they pick is 10^9 cells/ml. This density is quite a low density for a spatially structured system. A back-of-the-envelope calculation can show that at 10^9 cells/ml, the volume ratio between cells and environment is 1:1000, if we consider that a cell occupies approximately 1 μm cube (e.g. <italic>E. coli</italic> in Minimal media+glucose is about that size. See: https://www.ncbi.nlm.nih.gov/books/NBK224751/). These are the order of magnitude estimates of course, but they suggest that the authors use a density that is much lower than expected in a spatially structured community, like a biofilm. In fact,10^9 cells/ml is about the density of cells in an overnight of <italic>E. coli</italic> grown in Minimal media (M9) with 0.2% glucose. We would suggest picking values closer to a dense community, and our expectation is that spatially structured communities should be at least 10^11 cells/ml. Following the calculation above, this would lead to a volume ratio between cells and the environment of 1:10, if we consider that a cell occupies 1 μm cube.</p><p>We would like the authors to comment on the following two points:</p><p>i) Why do they pick 10^9 cells/ml as a maximum cap, which seems such a low density?</p><p>ii) The authors pick 10^9 cells/ml because this cap maximizes coexistence. In light of the calculation we do here, what would happen if they used higher values of cell densities?</p></disp-quote><p>The focus of our investigation was on the trend, rather than the exact value of the cap. There is an aspect of arbitrariness in our choice of the cap. Similarly, while we agree with the reviewer’s calculations, the choice of <italic>E. coli</italic> for the calculations is arbitrary. These numbers will be different by around two orders of magnitude, for example if we consider a larger yeast cell (~4 μm cube) as the unit. The value of the cap only becomes important in relation to the other parameters of choice. In our simulations we have chosen k<sub>Y</sub> to be large enough to not affect the coexistence outcomes. Any value of k<sub>Y</sub> above our chosen value will have little impact on the outcome. Instead, lower values of k<sub>Y</sub> will have an impact. k<sub>Y</sub> becomes important if some of the species reach this cap. Under such a condition, the fastest growing species will slow down when it reaches the cap, allowing other species to catch up before the next dilution step. As a result, more coexistence will be supported when k<sub>Y</sub> is more restrictive, as shown in Figure 1—figure supplement 8.</p><disp-quote content-type="editor-comment"><p>Line 101: 10^9 cells/ml is not 10^9 cells/cm as stated in Table 1. Can we think of these units as being the same? If yes, can units be homogenized? At the moment most of the units suggest that the effective dynamics is a 3D dynamics (e.g. diffusion constants, densities of cells), even if then they implement a 1D world, where there exists a line of &quot;cubes&quot; filled with sub-communities.</p></disp-quote><p>Your interpretation is correct. To allow direct comparison between the spatial and well-mixed cases, we have formulated all equations based on the three-dimensional (3D) densities of cells and concentrations of mediators. All the densities in both spatial and well-mixed simulations are based on volumetric densities of cells, matching your description as a line of cubes (with variations only in a single dimension).</p><disp-quote content-type="editor-comment"><p>Table 1: The authors state that &quot;Diffusion coefficient for mediators (DMed) 1.8 10-3 (cm2/hr)&quot;.</p><p>Again we do not understand the choice of parameters. When we look at realistic values of molecules diffusing, we see that these are more than 10 times faster. Here are two examples for glucose and for one amino acid:</p><p>For Glucose, the diffusion constant in water is 600 um^2 /sec, which is about 21*10-3 cm2/hr. See: https://bionumbers.hms.harvard.edu/bionumber.aspx?s=n&amp;v=7&amp;id=104089</p><p>For amino acids, the diffusion constant in water is 800 um^2/sec. See Wu, Y., Ma, P., Liu, Y. &amp; Li, S. Diffusion coefficients of l-proline, l-threonine and l-arginine in aqueous solutions at 25◦C. Fluid Phase Equilibria 186, 27-38 (2001).</p></disp-quote><p>Our apologies for the typo. The typical diffusion coefficient for mediators (D<sub>Med</sub>) is 1.8 x 10<sup>-2</sup> cm<sup>2</sup>/hr (or 500 µm<sup>2</sup> /sec), which is consistent with the reports you have listed. The correct value was used in the simulations, but the wrong value was listed in Table 1. We have fixed this typo in the revised version.</p><disp-quote content-type="editor-comment"><p>Table 1: Can they comment on the value of diffusion of species? This value represents somehow a fraction of individuals that move away from the local patch into another patch. What should we think this fraction to be?</p></disp-quote><p>The dispersal coefficient (D<sub>Cell</sub>) as defined in our manuscript represents a one-dimensional random walk. In the overly simplified case that the population cell density is a spike of with no neighboring cells present, the fraction of cells transferred to a small distance Del_z in each direction within a small time-step Δt is D<sub>Cell</sub>*Δt/(Δz)^2. If we set the parameters to D<sub>Cell</sub> = 5e-9 cm<sup>2</sup>/hr, Δt = 0.01 hr, and Δz = 0.005 cm, this fraction is 2e-6. Numerically, this fraction has to be small, so that we can track the dispersal process accurately.</p><disp-quote content-type="editor-comment"><p>Figure 1: what is the explanation for which, at a low fraction of facilitative interactions, coexistence in well-mixed and spatial communities is the same? Can they comment on this?</p></disp-quote><p>Between the two mechanisms of self-organization, co-localization driven by facilitation versus segregation driven by inhibition, the former has a stronger effect on coexistence in our simulations. The positive influence is further enforced by more growth in the vicinity of the partner, leading to a stronger representation of facilitation in spatial communities. In contrast, segregation only has a modest effect on weakening the impact of inhibition. As a result, there is more similarity between well-mixed and spatial communities in the absence of strong facilitative interactions. We have added this explanation to the revised text.</p><disp-quote content-type="editor-comment"><p>Figure 5: Do the authors expect that by increasing diffusion even further, coexistence should decrease again? Does the exploration stop at the maximum diffusion expected in liquid?</p></disp-quote><p>We have updated Figure 5 with higher values of the diffusion coefficient. Even at diffusion coefficients faster than what we would expect to see in practice, coexistence remained steady. We agree with the reviewer that if diffusion is fast enough the results should resemble the well-mixed situation. However, with the parameters selected for our configuration and with physically plausible diffusion coefficients we do not reach that regime.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>– I think there is a typo in the equations shown in the &quot;Model description&quot; section. In the population dynamics equation, the carrying capacity term (the one with k_Y) appears to contain a sum over the C_j rather than the expected sum over the S_i. In the supplied code, it appears that this term sums over the populations.</p></disp-quote><p>Thank you for bringing this to our attention. We have fixed the typo in that equation.</p><disp-quote content-type="editor-comment"><p>– Assuming the carrying capacity term is meant to contain a sum over the S_i rather than the C_j, the current formulation of this model may lead to non-physical outcomes. Consider a population that is above carrying capacity, such that the carrying capacity term is negative. If this population is also surrounded by highly detrimental chemical mediators (such that its interaction term is negative), the product of the negative carrying capacity and interaction terms will result in a positive growth rate. From the code I have looked at (Spatial1DInteraction_DpMM_ExMTC_flexibleTimeStep.m, lines 103-110), there doesn't seem to be any mechanism to prevent this. However, from the supplementary plots, it does not appear that the steady-state population abundances exceed the k_Y. The authors should assess whether these non-physical dynamics occur in their simulations, as it could artificially inflate coexistence. One possible solution is to set the population growth to zero if the carrying capacity is exceeded.</p></disp-quote><p>Thank you for pointing this out. Because in our typical runs we had simulated the populations growing to saturation from an initially low density, we never encountered the non-physical situation that the reviewer has correctly pointed out. To avoid potential issues in the future, we have revised the code. In the revised code, the baseline growth rate is used instead of the net growth rate of the interactions whenever a population density exceeds its corresponding carrying capacity. The updated codes are posted to GitHub for future reference.</p><disp-quote content-type="editor-comment"><p>– One limitation of the authors' current analyses is that it is based only on richness, which does not reflect population abundance. Equivalent comparisons between the spatial and non-spatial models could be made with a metric like the Shannon entropy, which does consider population abundance. To compute the Shannon entropy in the spatial model, one could measure the total population of each cell type by integrating over the domain. From these abundances, a relative abundance distribution compatible with the Shannon entropy could be calculated. It would be worthwhile to assess whether the observed trends are similar when other metrics are used.</p></disp-quote><p>We have repeated our analysis using Shannon entropy as the measure of diversity. We have reported the results in a supplementary figure (Figure 1—figure supplement 2 in the revised version), showing that a trend similar to mean richness is observed, but the magnitude of the effect is smaller with the Shannon index.</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82504-sa2-fig1-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>– I think it would be worthwhile for the authors to quantify the spatial patterns of coexistence in their model. I understand the authors' reasoning for focusing on a metric that does not consider spatial structure, as such metrics are the only ones that can be used to compare directly between spatial and well-mixed systems. However, from the plots shown in Figure S2, it appears that coexistence in this model can manifest as quite non-trivial spatial patterns. Spatial coexistence patterns of natural microbial communities are often strikingly beautiful, and it would be interesting to assess how this model's parameters influence its resulting spatial coexistence patterns. For example, one could examine the relationship between the mediator and microbe diffusion rates and the size/overlap of microbial domains, or analyze the existence of the seeming &quot;dead-zones&quot; of the domain seen in the bottom right panel of Figure S2.</p></disp-quote><p>Quantifying and investigating the spatial patterns and their link to creation/depletion of spatial niches by other species is certainly interesting and worthwhile. However, it requires extensive work that we feel distracts from the current message of this manuscript. Our lab is pursuing this line of study, but we feel a thorough investigation of spatial patterns is beyond the scope of this paper.</p><disp-quote content-type="editor-comment"><p>– I find the result that changing the order of species in the initial condition can change the final richness to be very interesting (Figure S8). This result implies that there is a great deal of multistability in the dynamics. In a metapopulation context, this could be its own diversity-generating mechanism. I think discussing this multistability more explicitly in the main text would be worthwhile: is this multistability a result of spatial dynamics?</p></disp-quote><p>We agree with the reviewer that the observation of multiple distinct stable states in these spatial communities is tantalizing. However, since this paper focused on the comparison of well-mixed versus spatial communities, detailed discussions of the spatial distributions and their impact on coexistence is beyond the scope of this manuscript. We plan to address these aspects in follow-up work.</p><disp-quote content-type="editor-comment"><p>– The authors should specify the distribution of mediator production/consumption and interaction coefficients. Currently, I'm not sure what distribution these parameters are drawn from.</p></disp-quote><p>This point was also a concern for Reviewer #1. We have added a description to clarify this point in the revised manuscript (lines 393-402):</p><p>“To sample different possibilities, the interaction terms as well as production and consumption rates are randomly assigned in each instance of the simulation. Similar to our previous work [25], the production/consumption matrices are random, i.e. each element of the matrix has a binomial distribution with a fixed probability of being present (<italic>q<sub>p</sub></italic> and <italic>q<sub>c</sub></italic> for production and consumption/influence links, respectively). The production rate and consumption rates have a uniform distribution between 0.5 and 1.5 times a set value each (β<sub>ij</sub> and α<sub>ij</sub> for production and consumption rates, respectively). The interaction matrix which represents the influence of mediators on species has the same structure as the consumption matrix. The magnitude of the influence in this matrix has a uniform distribution between 0 and a maximum value, <italic>r<sub>int,0</sub></italic>. The sign of the influence is chosen from a binomial distribution based on the ratio of fac:inh.”</p><disp-quote content-type="editor-comment"><p>– In the figures with well-mixed vs. spatial heatmaps, it may be worthwhile to include a plot that directly depicts the ratio of the two model's richness values. As it stands, I found it a bit difficult to immediately see the differences between the well-mixed and spatial results.</p></disp-quote><p>Thank you for the suggestion. In the revised version we have included the ratios of richness values as additional figures associated with Figures 2 and 3.</p></body></sub-article></article>