<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">82599</article-id><article-id pub-id-type="doi">10.7554/eLife.82599</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Schema-based predictive eye movements support sequential memory encoding</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-289133"><name><surname>Huang</surname><given-names>Jiawen</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1362-0412</contrib-id><email>jh4290@columbia.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-290071"><name><surname>Velarde</surname><given-names>Isabel</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5639-0907</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-15827"><name><surname>Ma</surname><given-names>Wei Ji</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9835-9083</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-241909"><name><surname>Baldassano</surname><given-names>Christopher</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3540-5019</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj8s172</institution-id><institution>Department of Psychology, Columbia University</institution></institution-wrap><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0190ak572</institution-id><institution>Center for Neural Science and Department of Psychology, New York University</institution></institution-wrap><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Luo</surname><given-names>Huan</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02v51f717</institution-id><institution>Peking University</institution></institution-wrap><country>China</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Behrens</surname><given-names>Timothy E</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>27</day><month>03</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e82599</elocation-id><history><date date-type="received" iso-8601-date="2022-08-10"><day>10</day><month>08</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-03-24"><day>24</day><month>03</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-07-20"><day>20</day><month>07</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.31234/osf.io/gej7q"/></event></pub-history><permissions><copyright-statement>© 2023, Huang et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Huang et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-82599-v2.pdf"/><abstract><p>When forming a memory of an experience that is unfolding over time, we can use our schematic knowledge about the world (constructed based on many prior episodes) to predict what will transpire. We developed a novel paradigm to study how the development of a complex schema influences predictive processes during perception and impacts sequential memory. Participants learned to play a novel board game (‘four-in-a-row’) across six training sessions and repeatedly performed a memory test in which they watched and recalled sequences of moves from the game. We found that participants gradually became better at remembering sequences from the game as their schema developed, driven by improved accuracy for schema-consistent moves. Eye tracking revealed that increased predictive eye movements during encoding, which were most prevalent in expert players, were associated with better memory. Our results identify prediction as a mechanism by which schematic knowledge can improve episodic memory.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>episodic memory</kwd><kwd>prediction</kwd><kwd>schema</kwd><kwd>eye-tracking</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100006474</institution-id><institution>Columbia University</institution></institution-wrap></funding-source><award-id>Graduate Student Fellowship</award-id><principal-award-recipient><name><surname>Huang</surname><given-names>Jiawen</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100006474</institution-id><institution>Columbia University</institution></institution-wrap></funding-source><award-id>start-up funding</award-id><principal-award-recipient><name><surname>Baldassano</surname><given-names>Christopher</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R21MH126269</award-id><principal-award-recipient><name><surname>Ma</surname><given-names>Wei Ji</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01MH118925</award-id><principal-award-recipient><name><surname>Ma</surname><given-names>Wei Ji</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100008982</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>2008331</award-id><principal-award-recipient><name><surname>Ma</surname><given-names>Wei Ji</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The development of knowledge for a board game facilitates memory for sequences in the game, demonstrating a new mechanism for the facilitation by enabling complicated predictions.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A key benefit of having a memory system is that it enables us to use the past to make predictions about the future, which is adaptive for survival (<xref ref-type="bibr" rid="bib13">Cowan et al., 2021</xref>). Prediction can be defined as a top-down process in which people generate expectations about what they will experience next, based on their previous experiences and the current context. A particularly important source of prediction is schemas, which are adaptable knowledge structures reflecting generalized information abstracted from multiple episodic experiences (<xref ref-type="bibr" rid="bib20">Ghosh and Gilboa, 2014</xref>). For example, we may have schemas about the kinds of objects that tend to occur at a beach, the social norms for ordering food at different kinds of restaurants, or the typical stages of a chess game.</p><p>Previous research has shown that having a detailed and robust schema yields improvements in memory (<xref ref-type="bibr" rid="bib1">Alba and Hasher, 1983</xref>). This memory improvement has been attributed in part to processes during recall since schemas provide cues that can be used to retrieve episodic details that would otherwise be forgotten (<xref ref-type="bibr" rid="bib2">Anderson and Pichert, 1978</xref>; <xref ref-type="bibr" rid="bib52">Watkins and Gardiner, 1979</xref>). Additionally, schemas could play a role during memory encoding, by helping people represent information more meaningfully (<xref ref-type="bibr" rid="bib10">Bransford and Johnson, 1972</xref>; <xref ref-type="bibr" rid="bib11">Chase and Simon, 1973</xref>).</p><p>One question that has been relatively unexplored in this literature is whether schemas improve episodic memory by enabling sophisticated predictions during encoding. In the past 20 years, there has been a growing recognition of the importance of prediction on how we perceive, understand, and interact with the world (<xref ref-type="bibr" rid="bib6">Bar, 2009</xref>; <xref ref-type="bibr" rid="bib12">Clark, 2013</xref>; <xref ref-type="bibr" rid="bib19">Friston, 2010</xref>; <xref ref-type="bibr" rid="bib38">Rao and Ballard, 1999</xref>). There is evidence that domain experts (i.e. people with a strong schema in a specific field) automatically engage these predictive processes; for example, basketball experts shown a clip from a game tended to remember the final positions of the players as being ahead of their actual positions (<xref ref-type="bibr" rid="bib24">Gorman et al., 2012</xref>). These predictive processes are only possible with a pre-existing schema and might partially explain the large literature showing selective memory improvement for schema-consistent (i.e. predictable) information (<xref ref-type="bibr" rid="bib3">Anderson, 1981</xref>) and highly unexpected information (i.e. prediction errors, <xref ref-type="bibr" rid="bib8">Bonasia et al., 2018</xref>; <xref ref-type="bibr" rid="bib36">Quent et al., 2021</xref>).</p><p>Previous prediction research has typically used two types of approaches. The first approach uses people’s pre-existing real-world knowledge, such as the regularity of language structure (<xref ref-type="bibr" rid="bib22">Goldstein et al., 2022</xref>; <xref ref-type="bibr" rid="bib42">Shain et al., 2020</xref>) or event sequences in a familiar setting (<xref ref-type="bibr" rid="bib5">Baldassano et al., 2018</xref>). Due to their complexity, however, it is difficult to build a ground-truth model for these schemas. These types of knowledge are also learned slowly, making it difficult to study their development in a lab setting. The second paradigm, commonly used in memory research, teaches participants simple and novel sequences of discrete stimuli like abstract shapes and pictures (e.g. <xref ref-type="bibr" rid="bib40">Schapiro et al., 2012</xref>; <xref ref-type="bibr" rid="bib43">Sherman and Turk-Browne, 2020</xref>). Due to their simplicity, it is possible for participants to learn these sequences in a short period of time and they are easy to model. However, the predictive processes examined in these studies might not engage the same mechanisms as when predictions are based on more complex schemas that generalize to new stimuli.</p><p>In this study, we investigate prediction as a potential mechanism for schema-related memory improvement, in a domain that avoids the issues with overly simplistic or poorly defined schemas. Specifically, we have participants remember sequences from a simple board game recently developed by <xref ref-type="bibr" rid="bib51">van Opheusden et al., 2021</xref> called four-in-a-row. In this two-player game, a generalization of tic-tac-toe, players compete to be the first to connect four pieces in a row on a 4 × 9 board. The schema of the game encompasses not just this rule (which is easily learned), but an understanding of what kinds of move sequences are typical, an emergent property of the game rules that requires playing experience to learn. Expertise in four-in-a-row has been shown to change how individual game boards are remembered, with experts better representing arrangements of pieces that are strategically important (<xref ref-type="bibr" rid="bib51">van Opheusden et al., 2021</xref>). The game has a complexity far exceeding typical tasks in previous schema and prediction research, yet it is possible to capture near-optimal play with a linear model. The novelty and simplicity of the game ensure that participants start the experiment without a schema but can acquire the schema over several hours of practice, allowing us to tractably study how schema development is related to changes in prediction and memory longitudinally in a lab setting. The fact that possible moves correspond to different spatial locations allows us to use eye movements as an indication of people’s predictive processes, as in previous paradigms with spatial actions (e.g. <xref ref-type="bibr" rid="bib46">Tal et al., 2021</xref>).</p><p>Based on findings in previous schema research, we hypothesized that people’s memory for move sequences would improve over training sessions, alongside improvements in a schema, operationalized as improved gameplay ability. Although previous research has sometimes found novelty-driven memory improvements for schema-inconsistent information (reviewed in <xref ref-type="bibr" rid="bib17">Frank and Kafkas, 2021</xref>), studies of memory for complex memoranda such as chess boards have shown an advantage for schema-consistent stimuli (e.g. board positions from actual chess games) (<xref ref-type="bibr" rid="bib21">Gobet and Waters, 2003</xref>). Thus, we hypothesized that the memory improvement resulting from the development of schema in four-in-a-row should similarly be specific to moves that are schema-consistent. People’s schema quality should also be related to their memory performance, such that people with stronger gameplay abilities will have better sequence memory. If the prediction is indeed a potential mechanism for schema-related improvement, we would expect people’s eye movements to become more anticipatory as they gain more experience playing the game and can rely more on internal predictive models. The extent of predictive eye movements should also mediate the relationship between schema quality and memory performance, providing a mechanism through which schematic knowledge can impact episodic memory. Here, we find support for all these hypotheses.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Memory and gameplay improvement</title><p>Over six sessions (each separated by 2.15 days on average), participants performed two separate tasks (<xref ref-type="fig" rid="fig1">Figure 1</xref>). In the memory task, participants were presented with a novel gameplay sequence and asked to remember it. After a distractor task, they were shown the first board of the sequence and they were given an unlimited amount of time to reconstruct the rest of the sequence from memory. In the first session, participants were not told that these stimuli came from a game, and were only instructed to remember circles appearing on a grid. The first session therefore provided a no-schema baseline, since participants could not use a game model to make predictions about upcoming moves. In a post-task questionnaire, we confirmed that in session 1 most participants did not suspect that the stimuli were from a game or guess the rules of the game (14 out of 19 in the online study, and 13 out of 16 in the in-person study). In a separate gameplay task (occurring after the memory task on all but the last day), they were provided with the rules of the game and played the four-in-a-row game against an AI opponent, staircase to match the skill level of the player.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>A schematic of the experimental method.</title><p>(<bold>a</bold>) Task structure across six (non-consecutive) days. (<bold>b</bold>) Memory task. In each of the 30 trials, participants saw an initial board for 5 s, and then a move was added to the board every 5 s. After viewing a sequence of 4four to eight moves and completing a distractor task, participants were shown the initial board and asked to reconstruct the sequence by placing the pieces on the board. (<bold>c</bold>) Gameplay task. Participants played 40 games against an adaptive-difficulty AI agent.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82599-fig1-v2.tif"/></fig><p>Participants recall accuracy (combined across the online and in-lab data), calculated as the percent of moves they recalled at the right location in the right order, improved across training sessions, improving from 61.6% (SD = 18.1%) in session 1 to 69.5% (SD = 20.6%) in session 6 (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). At the same time, participants’ playing strength, measured with an Elo rating (<xref ref-type="bibr" rid="bib16">Elo, 1978</xref>), increased (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). Elo ratings are computed based on how often people win against opponents of varying skill levels, and we use Elo as a measure of schema quality – the better a player is, the better knowledge they have about the move probabilities during near-optimal gameplay. We fit mixed-effect models with a fixed effect of the session and a random slope for the participant to predict recall accuracy and Elo. The fixed effect of the session was significant in both models (for memory, <italic>β</italic>=0.015, <italic>t=</italic>3.215<italic>,</italic> p=0.003; for Elo, <italic>β</italic>=24.92, <italic>t</italic>=5.102, p&lt;0.001), demonstrating improvement in both recall accuracy and gameplay over time. We also found that Elo’s rating in a session was correlated with memory performance in the following session, Pearson <italic>r</italic>=0.298, p&lt;0.001 (<xref ref-type="fig" rid="fig2">Figure 2c</xref>), showing that having a better schema for the game was associated with better episodic memory for move sequences. To understand whether this relationship was present within individual participants, we fit a linear mixed-effect model to predict memory performance from Elo with per-participant intercepts and slopes as random effects. We found that the relationship between Elo and memory accuracy was not significant in this model (<italic>β</italic>=0.012, <italic>t</italic>=1.196, p=0.242), suggesting that this effect was primarily driven by individual differences (people with better schema tend to have better memory) rather than across-session improvements in Elo.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Participants’ performance in memory and gameplay.</title><p>(<bold>a</bold>) On average, Participants become better at remembering sequences over the course of the training (red line, N = 35). In each session, memory accuracy is much higher than the performance that would be achieved if people were simply guessing according to the gameplay model (green line, simulated, N = 100). (<bold>b</bold>) On average, participants become better at playing the game across sessions. Error bars represent the standard error of the mean. (<bold>c</bold>) There is a positive correlation between people’s playing strength and their recall accuracy (each dot corresponds to one session of one participant).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82599-fig2-v2.tif"/></fig><p>Out of the 30 sequences shown to participants in each session, 10 of them ended with one player successfully getting four pieces in a row (more details in Methods). After learning the rules of the game, the presence of such a win could be a salient event for the participant and could lead to changes in the memory performance. Indeed, we found that in sessions 2–6, memory for sequences that ended in a win state was significantly better (<italic>t</italic>=6.67, p&lt;0.001). We did not observe this pattern in the first session (before participants were taught the game rules) and actually found a marginally significant effect in the opposite direction, with worse memory for winning sequences (<italic>t</italic>=–2.01, p=0.052). This result provides additional evidence that schema-related features of a sequence play a role in the memory performance.</p></sec><sec id="s2-2"><title>Modeling schema-related memory improvement</title><p>To investigate how schema consistency is related to memory for individual moves and how this relationship evolves, we trained a model of the schema for the game on moves played by a near-optimal AI agent. The model identifies the features each move forms (such as three-in-a-row, a line of three pieces of the same color) and assigns a value to each feature based on the training data (described in more detail in the Method section). Given a current board position, the model outputs a probability distribution over the next move that would likely be played by a very strong player (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). Using this model, we can measure the extent to which each move shown to participants is likely (schema-consistent) vs unlikely (schema-inconsistent), and how this is linked to recall accuracy. Here, schema consistency is used as an objective, the subject-independent measure of how good a move is. Each subject will exhibit different degrees of alignment to this ‘ground-truth’ schema.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>The effect of schema consistency on memory and its development across training sessions.</title><p>(<bold>a</bold>) An example of the model’s evaluation of a board where the next player is black. Based on features that would be generated by each possible next move (e.g. creating three-in-a-row), the model generates a probability distribution over potential next moves. We apply this model to the stimuli in the memory task to estimate the probability of each move. (<bold>b</bold>) The effect of schema consistency of a move on the recall accuracy for the move. The x-axis is the log probability of a move, which reflects schema consistency. The y-axis is the probability that a participant will remember the move. In session 1, there is no relationship between the probability of moves and subsequent memory. In sessions 2–6, people are more likely to remember schema-consistent moves. The histogram at the top and bottom of the figure is the frequency of moves with certain log probabilities that are remembered and forgotten, respectively (<bold>c</bold>) The relationship between move probability and recall accuracy over the 6 sessions. (*** denotes p&lt;0.001). (<bold>d</bold>) The relationship between move probability and reaction time at recall for correctly remembered moves. (*** denotes p&lt;0001). (<bold>e</bold>) The proportion of times the first mistake in a sequence is a more probable move than the actual move that was observed. Error bars represent the standard error of the mean, and the sample size is 35 participants.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82599-fig3-v2.tif"/></fig><p>Separately for each session, we ran a mixed-effects logistic regression with subsequent memory (right or wrong) as the outcome variable, with the probability of the move as the fixed effect, and with a participant random intercept. As shown in <xref ref-type="fig" rid="fig3">Figure 3b</xref>, there was initially no relationship between the probability of a move and the probability that the move will be remembered in session 1 (<italic>β</italic>=–0.031, <italic>z</italic>=–1.813, p=0.07), but in sessions 2 through 6, schema-consistent moves were more likely to be remembered (all p&lt;0.001). This effect emerged over the first four sessions of learning (<xref ref-type="fig" rid="fig3">Figure 3c</xref>) and then dropped slightly in sessions 5 and 6.</p><p>To see whether this increase in the relationship between move probability and recall accuracy over time is significant, we aggregated the data from all the sessions and ran a mixed-effects logistic regression with subsequent memory as the outcome variable, with the probability of the move, the session the move was in, and their interactions as fixed effects, and with a participant random slope of the session and move probability. We found a main effect of session on memory (<italic>β</italic>=0.164, <italic>z</italic>=5.763, p&lt;0.001) but no main effect of move probability (<italic>β</italic>=–0.0046, <italic>z</italic>=–0.249, p=0.804). However, there was a significant interaction between move probability and session on memory (<italic>β</italic>=0.035, <italic>z</italic>=7.561, p&lt;0.001), indicating that participants became better at remembering schema-consistent moves over the time.</p><p>In addition to recall accuracy, we looked at reaction time for placing moves at recall. We only looked at moves that were correctly recalled in each session and removed outliers with reaction times longer than 30 s (0.6% of all the correct moves were removed this way). Similar to accuracy, we found that reaction time during retrieval was initially not related to the probability of the move (<italic>β</italic>=–30.5, <italic>t</italic>=0.975, p=0.329) but consistently faster for more schema-consistent moves in sessions 2 through 6 (all p&lt;0.001, <xref ref-type="fig" rid="fig3">Figure 3d</xref>). Running a mixed-effects model as for the accuracy (using linear rather than logistic regression), we found a main effect of session on reaction time (<italic>β</italic>=–156.3, <italic>t</italic>=–2.39, p=0.017), such that participants were faster in later training sessions. There was no main effect of move probability (<italic>β</italic>=- 46.1, <italic>t</italic>=−0.440, p=0.660) but a significant interaction between move probability and the session on reaction time (<italic>β</italic>=−71.06, <italic>t</italic>=–2.593, p=0.010), with faster responses when remembering more schema-consistent moves.</p><p>If participants are using a schema as part of their recall process, we would expect a bias toward schema-consistent moves when participants make mistakes during sequence reconstruction. To test whether this is the case, we looked at the mistakes participants made in each sequence reconstruction, measuring the fraction of the time that their answer was <italic>more</italic> schema-consistent than the correct answer, indicating a bias toward schema-consistent moves during recall. We only considered the first mistake, since after that mistake, the encoding and retrieval boards are different, and therefore the likely moves are no longer comparable. As can be seen in <xref ref-type="fig" rid="fig3">Figure 3e</xref>, the proportion of schema-consistent mistakes increased over the first 4 training sessions. After that, there is a drop similar to the drop in accuracy in sessions 5 and 6. We ran a mixed-effects model with a participant random slope, the proportion of schema-consistent mistakes as the outcome variable, and session as a fixed-effect predictor, and found a significant effect of the session (<italic>β</italic>=0.032, <italic>t</italic>=5.413, <italic>p</italic>&lt;0.001).</p><p>Although an overall increase across sessions was observed in both schema-consistent mistakes and the relationship between recall accuracy and move probability, these effects were significantly weaker at session 5 (for schema-consistent mistakes, <italic>t</italic>=–2.51, p=0.02; for the relationship between recall accuracy and move probability, <italic>t</italic>=–3.24, p=0.001), and numerically weaker at session 6 (for schema consistent mistakes, <italic>t</italic>=–1.70, p=0.099; for the relationship between recall accuracy and move probability, <italic>t</italic>=–1.93, p=0.053). One potential explanation for this drop is that people developed new strategies in later sessions to remember schema-inconsistent moves. As can be seen in <xref ref-type="fig" rid="fig3">Figure 3b</xref>, the modeled recall accuracy for highly schema-inconsistent moves (low x values) increased from session 4–5 while the recall accuracy for schema-consistent moves remained relatively stable. This is consistent with the highest overall accuracy that occurred in session 6 (<xref ref-type="fig" rid="fig2">Figure 2a</xref>), suggesting that this decrease in slope does not come at a cost for memory accuracy. Note that reaction time did not show this weakening relationship with move probability in sessions 5 and 6, as its slope continues to decrease.</p><p>The results demonstrate that the memory benefit from gameplay training is driven in part by enhanced memory for schema-consistent moves. A possible alternative explanation of this effect is that rather than using generalized schematic knowledge, participants are in fact using episodic memories of specific move sequences that they have seen in past gameplay sessions. To test this possibility, we examined all the boards that participants saw during gameplay and the moves played on these boards, and found the repetition of exact move sequences to be very rare; out of over 1000 moves across 6 sessions there were on average 1.0 repeats (SD = 1.67) that participants experienced during gameplay and were later part of a memory sequence. Thus, the mere repetition of schema-consistent moves could not be driving the observed differences in memory. Another potential explanation could be a change in the participants’ strategy. In the beginning, participants can only use their episodic memory, but over time participants could start to use a purely schema-based strategy in which they simply place moves as if they are playing the game from this board position. We simulated this strategy by drawing moves probabilistically from the gameplay (schema) model for each initial board that participants saw during the memory task in each session. We found that purely schema-based guessing can only achieve an average accuracy of 13.39% across the ix sessions (<xref ref-type="fig" rid="fig2">Figure 2a</xref>), which is much lower than participants’ average recall accuracy of 65.91%. This low accuracy is due to the fact that, for most of the sequences, there are multiple plausible moves that could be played and it is therefore difficult to guess the sequence without episodic knowledge. Therefore, the improvement in performance after learning the schema is unlikely due to mere guessing of the boards.</p></sec><sec id="s2-3"><title>Eye movements became more predictive over training</title><p>A potential driver of memory improvements could be a change in encoding strategy. In particular, schemas allow people to make online predictions, which allows additional encoding time if moves are successfully predicted or generate prediction errors otherwise, both of which have been shown to be beneficial for memory (e.g. <xref ref-type="bibr" rid="bib36">Quent et al., 2021</xref>). We used eye-tracking data to understand how participants’ encoding strategies were related to schemas and later memory. We modeled fixations as a linear combination of six different possible strategies (<xref ref-type="fig" rid="fig4">Figure 4</xref>), including a ‘prediction’ strategy (regressor 3) in which fixation durations are related to the model-derived probabilities for the next move. The coefficient for each fitted regressor reflects the extent to which the strategy is used during encoding.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Using eye movements to reveal encoding strategies.</title><p>Left: A participant’s fixation heatmaps over a 5 s encoding period. right: the 6 regressors that we consider as potential encoding strategies. 1: Participants could look at the last (most recent) move, which is what they need to remember. 2: Participants could look at occupied tiles that might be relevant to the most recent move, to try to see what features the move forms. 3: Participants could be anticipating the upcoming move, meaning they will look at the empty squares on the board that are likely to be the next move. 4: Participants could also look at current pieces that are relevant for predicting the next move, i.e., pieces related to empty squares that are likely to be the next moves. 5: Participants could be looking at moves that previously appeared, in order to rehearse the observed move sequence. 6: Participants might have an overall tendency to look at occupied or unoccupied tiles.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82599-fig4-v2.tif"/></fig><p>To look at whether the eye movements become more predictive over time, we first ran a linear mixed-effects model with prediction coefficient as the outcome variable, session as the predictor variable, and a participant random slope, to see if eye movements became more predictive over time. There was a significant fixed effect of session, <italic>β</italic>=0.009, <italic>t</italic>=4.261, p&lt;0.001, providing evidence that people’s eye movements became more predictive over training (<xref ref-type="fig" rid="fig5">Figure 5a</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>The relationship between prediction, playing strengths, and recall accuracy.</title><p>(<bold>a</bold>) The extent to which eye movements on empty squares align with the gameplay model (prediction coefficient; see <xref ref-type="fig" rid="fig4">Figure 4</xref>) increases over training sessions. (<bold>b</bold>) Correlation between Elo (playing strength) and prediction coefficient in the 35 participants. (<bold>c</bold>) Correlation between prediction coefficient and recall accuracy. (<bold>d</bold>) Mediation analysis: the effect of playing strength on recall accuracy is mediated by the amount of prediction participants made during encoding. The values on the arrows represent regression coefficients for standardized measures of Elo, prediction coefficient, and recall accuracy (* denotes p&lt;0.05, ** denotes p&lt;0.01). (<bold>e</bold>) Move-level analysis on the effect of schema consistency on memory, predicting whether a move will be remembered based on the probability of the move (brighter colors are more schema-consistent) and prediction coefficient in the previous move. Error bars represent the standard error of the mean.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82599-fig5-v2.tif"/></fig></sec><sec id="s2-4"><title>Better performance in better players is mediated by more schema-based predictions</title><p>We next sought to test whether this increase in predictive eye movements could serve as a mechanism through which expertise improves memory performance. We found that, on a session-by-session basis, more sophisticated gameplay (higher Elo) was associated with more prediction in the next memory session (Pearson <italic>r</italic>=0.33, p=0.002), demonstrating that better players predict more during encoding (<xref ref-type="fig" rid="fig5">Figure 5b</xref>). Memory sessions in which a player exhibited high levels of predictive eye movements also showed better reconstruction accuracy (Pearson <italic>r</italic>=0.40, p&lt;0.001), despite there being no explicit demand to generate predictions during encoding (<xref ref-type="fig" rid="fig5">Figure 5c</xref>). A mediation analysis was performed to assess the mediating role of the prediction coefficient on the link between Elo and recall accuracy (<xref ref-type="fig" rid="fig5">Figure 5d</xref>). The total effect of Elo on recall accuracy was significant (<italic>β</italic>=0.35, <italic>t</italic>=3.26, p=0.002). The effect of Elo on the prediction coefficient was also significant, (<italic>β</italic>=0.33, <italic>t</italic>=3.13. p=0.002). The bootstrapped indirect effect was 0.10, 95% <italic>CI</italic> = [0.03, 0.19], p=0.006, suggesting that improved memory for better players is partially mediated by improved predictions during encoding. Significant mediation was not found for any of the other regressors (all p&gt;0.3, except previously shown moves, p=0.056), suggesting that better prediction is uniquely important for driving the memory benefit from better gameplay. With the inclusion of the prediction coefficient, the impact of Elo on recall accuracy was reduced but remained significant (<italic>β</italic>=0.24, <italic>t</italic>=2.26, p=0.03), indicating that expertise also improves memory accuracy through additional mechanisms (at encoding and/or retrieval). We again tested whether these effects were present at the individual-participant level by running a linear mixed-effect model with participant random intercepts and slopes. Due to model convergence issues, we employed a Bayesian version of this model to regularize the coefficient estimates (see Methods). We found that the 95% credibility interval for the fixed effect of Elo on the prediction coefficient overlapped with 0 (<italic>β</italic>=0.007, 95% CI = [–0.003, 0.016]). The 95% credibility interval for the fixed effect of the prediction coefficient on recall accuracy also overlapped with 0 (<italic>β</italic>=0.164, 95% CI = [–0.54, 0.87]). Together with previous findings, these results suggest that the observed mediation effect is primarily driven by individual differences rather than within-subject development over time.</p><p>The above analysis demonstrated that making more schema-consistent predictions is correlated with better memory at the level of experimental sessions. We next constructed a logistic regression model to predict subsequent memory at the scale of individual moves, as a function of the move’s probability and the prediction coefficient during the 5 s window before the move appeared with a subject random slope for the prediction coefficient (<xref ref-type="fig" rid="fig5">Figure 5e</xref>). There was a main effect of log probability of the move (<italic>β</italic>=0.083, <italic>z</italic>=5.882, p&lt;0.001), consistent with our session-level results demonstrating a memory benefit for more likely moves. We also found a significant effect on the prediction coefficient (<italic>β</italic>=0.508, <italic>z</italic>=3.187, p=0.001). There is no interaction between the move probability and prediction coefficient (<italic>β</italic>=0.024, <italic>z</italic>=0.395, p=0.693). This result shows that making schema-consistent predictions before a move appears is correlated with better memory for the move, independent of the schema-consistency of the move.</p></sec><sec id="s2-5"><title>Model-free measures of prediction confidence and surprise</title><p>In addition to the prediction coefficient, which measured the extent to which eye movements are consistent with next-move predictions from our gameplay model, we considered two model-free aspects of eye movements on empty squares (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). The first is prediction <italic>confidence</italic>, measuring the extent to which a participant was attending to a specific empty square (vs. looking evenly at many empty squares or at occupied squares). We use this as a measure of whether participants have a specific expectation about the next move position. The second measure is <italic>surprise</italic>, which is the negative log of the proportion of fixation time spent looking at the correct next move position. A high level of surprise indicates that a participant spent very little time looking at the square where the next move ended up appearing, which indicates low prediction accuracy. We then conducted a move-level logistic regression similar to the one described above, to predict whether a move will be remembered or not based on both prediction confidence and surprise while looking at the previous board (<xref ref-type="fig" rid="fig6">Figure 6b</xref>), with the subject random slope for both prediction confidence and surprise. We found the main effects of both factors, indicating that (a) making confident predictions before a move is related to better memory for that move (<italic>β</italic>=0.375, <italic>z</italic>=4.372, p&lt;0.001) and (b) unexpected (surprising) moves are more poorly remembered (<italic>β</italic>=–0.015, <italic>z</italic>=–2.448, p=0.014).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Model-free measure of prediction and their relationship with memory.</title><p>(<bold>a</bold>) Example fixation heatmaps (in red) of high and low prediction confidence and surprise. Confidence measures the extent to which fixations were focused on a small number of unoccupied squares, while surprise measures how well these fixations aligned with the actual next move (indicated with an empty circle). (<bold>b</bold>) Recall accuracy was best when prediction confidence was high and surprise was low. Error bars represent the standard error of the mean.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82599-fig6-v2.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The main goal of the current study was to look at how schema-based predictive processes support sequential memory encoding. Participants learned a novel schema (likely move sequences and board configurations in our-in-a-row) with much higher complexity than most artificial schemas learned in the lab. Developing a schema for moves in the game requires a significant amount of playing experience (reflected in the slow improvement in Elo ratings we observed across sessions), but can still be accomplished within a single experiment, unlike games like chess. We observed schema-related effects on sequence memory and found that these effects emerge over time as the schema develops. We also investigated the role predictions during encoding played in the relationship between schema and memory, finding that making schema-consistent predictions, making confident predictions, and making accurate predictions were all related to successful recall at the level of individual moves.</p><sec id="s3-1"><title>Schema-related memory effects and how they develop</title><p>Our behavioral findings showed that previously-studied schema effects from previous studies extend to this more complex experimental paradigm, and demonstrated how these effects developed over time. First, memory gradually improved as people’s schemas gradually improved. People with a better schema had better memory, consistent with the literature on how expertise influences memory (<xref ref-type="bibr" rid="bib11">Chase and Simon, 1973</xref>; <xref ref-type="bibr" rid="bib21">Gobet and Waters, 2003</xref>). Second, the memory benefit over the training session was driven by the improved recall for schema-consistent information, consistent with schema literature (e.g. <xref ref-type="bibr" rid="bib3">Anderson, 1981</xref>). Previous work has also shown that in some situations, schema-<italic>inconsistent</italic> information is better remembered (<xref ref-type="bibr" rid="bib17">Frank and Kafkas, 2021</xref>), which we did not observe in this study. All the sequences we used were generated by a gameplay agent, so highly schema-inconsistent moves were rare, and none of our stimuli exhibited the extreme kind of ‘contextual novelty’ (<xref ref-type="bibr" rid="bib37">Ranganath and Rainer, 2003</xref>; <xref ref-type="bibr" rid="bib45">Stark et al., 2018</xref>) that often drives these effects; for example, we never showed a move that broke the rules of the game or played an expected sound. Future work could test whether highly schema-inconsistent items exhibit memory benefits equal to or greater than highly schema-consistent items. Third, participants’ mistakes became more schema-consistent across sessions. These errors could reflect false memories for schema-consistent sequences that never occurred, similar to false memories generated by naturalistic videos or stories conforming to schematic scripts (<xref ref-type="bibr" rid="bib29">Lampinen et al., 2000</xref>; <xref ref-type="bibr" rid="bib32">Neuschatz et al., 2002</xref>). Alternatively, participants may be guessing schema-consistent moves when they failed to encode or retrieve the sequence; in future work, confidence responses could be used to distinguish between these possibilities. Note that some of the overall accuracy increase in the memory task across sessions could be attributable to a practice effect, but general practice-related improvement does not explain the schema-related effects that we observed on individual trials.</p><p>Interestingly, the relationship between recall accuracy and memory is attenuated in the last two sessions, driven by improved memory for schema-inconsistent moves. Expertise effects that partially extend to non-schematic situations have been previously observed; although chess experts’ memory advantage was primarily driven by very high accuracy for schema-consistent (legitimate) boards in <xref ref-type="bibr" rid="bib21">Gobet and Waters, 2003</xref>, experts also exhibited memory for random boards that was better than that of weaker players. One possibility is that experts may be able to devote fewer attentional resources to schematic moves, freeing up additional resources to handle more unusual moves. Participants in our study may have also developed an effortful strategy to remember schema-inconsistent moves (such as switching to a shape-based encoding for these moves), consistent with the longer reaction times observed for low-probability moves in later sessions.</p><p>There are other potential mechanisms for the schema-related memory improvement that were not explored in the current study. For example, the ways in which moves are represented in the brain may shift with schema learning, moving from a purely spatial system (e.g. remembering that a move occurred at row three, column two) to a more feature-based representation (e.g. remembered a move as ‘blocking opponent’s three-in-a-row’), which makes remembering easier and more robust. Future neuroimaging work can use techniques such as representational similarity analysis (<xref ref-type="bibr" rid="bib28">Kriegeskorte et al., 2008</xref>) to model the representational geometry of remembered board positions and track how it changes over sessions.</p></sec><sec id="s3-2"><title>The development of predictions and their influences on memory</title><p>The eye-tracking study showed that participants spontaneously exhibited predictive eye movements consistent with the game schema, without any explicit prediction demands. This is consistent with earlier work showing automatic predictive representations in basketball experts (<xref ref-type="bibr" rid="bib15">Didierjean and Marmèche, 2005</xref>). We also found that schema-based predictions were associated with improved memory (at the level of participants and the level of individual moves) and that these encoding-time predictions provide a mechanism for the impact of schema quality on memory performance. There are several reasons why within-participant increases in Elo across sessions were not predictive of improvements in prediction and memory. First, our estimate of Elo during each memory task was based on gameplay performance on the prior day, which may not be a precise measure of the participant’s current schema. Second, the biggest increase in prediction occurred between sessions one and two, but the session one memory-task data cannot be included in this prediction model since participants have not yet played the game (and we therefore cannot estimate their Elo). Third, we may simply be underpowered to detect within-participant effects, since we only collected data from six sessions for each subject. Despite the lack of within-subject effect, the session-level analysis provided the novel insight that the memory advantage for more-expert players may be driven by superior predictive processes during encoding.</p><p>Despite the numerous studies looking at how item novelty impacts memory (<xref ref-type="bibr" rid="bib25">Greve et al., 2017</xref>; <xref ref-type="bibr" rid="bib36">Quent et al., 2021</xref>; <xref ref-type="bibr" rid="bib50">van Kesteren et al., 2012</xref>), relatively few studies have looked at the impact of temporal schematic prediction on memory for upcoming items. In a recent study, <xref ref-type="bibr" rid="bib43">Sherman and Turk-Browne, 2020</xref> showed that making predictions does not benefit memory for the upcoming item and impairs the encoding of the current item, which is inconsistent with our findings. One possibility is that their study (in which participants implicitly learned arbitrary statistical dependencies between image categories presented in a continuous stream) engages a predictive process that relies on the hippocampus (<xref ref-type="bibr" rid="bib41">Schapiro et al., 2017</xref>), creating interference between prediction and encoding processes. On the other hand, the explicit schematic predictions in our study that are based on rules and progression toward goal states might rely on a different network such as the medial prefrontal cortex (<xref ref-type="bibr" rid="bib8">Bonasia et al., 2018</xref>; <xref ref-type="bibr" rid="bib39">Robin and Moscovitch, 2017</xref>; <xref ref-type="bibr" rid="bib50">van Kesteren et al., 2012</xref>).</p><p>Our eye movement data suggest that making high-confidence predictions is related to better memory, even when that prediction is inaccurate. This is in line with the generation effect (e.g. <xref ref-type="bibr" rid="bib34">Potts and Shanks, 2014</xref>; <xref ref-type="bibr" rid="bib44">Slamecka and Graf, 1978</xref>), which showed that people better remember unfamiliar study materials (meaning of foreign words) if they make a guess before seeing the correct answer. <xref ref-type="bibr" rid="bib34">Potts and Shanks, 2014</xref> demonstrated a benefit even for minimal predictions when predictions are based on random guessing and are wrong almost all the time. In our study, although participants never made explicit predictions, high-confidence fixations (even to the wrong square) could benefit memory through a similar predictive process.</p><p>Memory is also best when predictions are most accurate (the observed move is the least surprising, coming exactly where participants anticipated it to be). Surprise or atypicality has sometimes been shown to improve memory since it attracts attention and can result in stronger encoding (<xref ref-type="bibr" rid="bib17">Frank and Kafkas, 2021</xref>; <xref ref-type="bibr" rid="bib32">Neuschatz et al., 2002</xref>; <xref ref-type="bibr" rid="bib36">Quent et al., 2021</xref>). On the other hand, unexpected events can sometimes be difficult to retrieve at recall, since they are less connected to the schema (<xref ref-type="bibr" rid="bib9">Bower et al., 1979</xref>; <xref ref-type="bibr" rid="bib18">Frankenstein et al., 2020</xref>). It is possible that the degree of surprise makes a difference; as discussed above, we never presented invalid moves or unexpected categories of stimuli, which could have strongly driven attention. The type of task used might also matter, as it has been previously shown that schema-inconsistent object-location pairs are better recognized, but not better recalled when given only location as a cue (<xref ref-type="bibr" rid="bib31">Lew and Howe, 2017</xref>).</p><p>Previous research has found a relationship between pupil dilation and surprise (<xref ref-type="bibr" rid="bib4">Antony et al., 2021</xref>; <xref ref-type="bibr" rid="bib30">Lavín et al., 2014</xref>; <xref ref-type="bibr" rid="bib35">Preuschoff et al., 2011</xref>), but our study was not well-suited to measure subtle changes in pupil diameter. Studies of pupil dilation generally require tight control over the experimental stimuli, using either purely non-visual stimuli (<xref ref-type="bibr" rid="bib35">Preuschoff et al., 2011</xref>), or by presenting luminance-controlled stimuli at fixation (<xref ref-type="bibr" rid="bib30">Lavín et al., 2014</xref>). In our study, the luminance at fixation is highly variable since eye movements are not controlled and squares can be unoccupied (gray) or occupied by white or black pieces. Future work could attempt to study pupil dilation in this paradigm using models to control for local and global luminance (<xref ref-type="bibr" rid="bib4">Antony et al., 2021</xref>) or by modifying the stimuli to ensure that all board spaces are isoluminant.</p><p>To conclude, we showed that people spontaneously engage in more sophisticated predictive processes as their schemas develop, which are beneficial for memory. The current study adds to the literature showing the adaptive values of making predictions for perception and action, and extends its benefit into the memory domain. It also provides a novel mechanism for the benefit of schemas on memory. Our paradigm uses a complex temporal schema that is much more complicated than most artificial schemas (e.g. <xref ref-type="bibr" rid="bib48">Tompary et al., 2020</xref>; <xref ref-type="bibr" rid="bib49">van Buuren et al., 2014</xref>) but does not take years to develop, like a chess schema (e.g. <xref ref-type="bibr" rid="bib11">Chase and Simon, 1973</xref>; <xref ref-type="bibr" rid="bib21">Gobet and Waters, 2003</xref>). This makes four-in-a-row an exciting testbed for future studies of the cognitive and neural mechanisms of schema development and its impact on episodic memory.</p></sec></sec><sec id="s4" sec-type="methods"><title>Methods</title><p>The study used a longitudinal design, in which participants completed six sessions over a period of about one to two weeks (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). The mean interval between sessions was 2.15 days. In sessions 1–5, participants completed 2 (practice) + 30 (formal) trials of the memory task, followed by playing 40 games against an AI opponent. The gameplay task was designed to both develop participants’ schema and measure their playing strength in each session. On day six, participants completed 30 trials of the memory task only. Both the memory task and the gameplay were built on Psiturk (<xref ref-type="bibr" rid="bib26">Gureckis et al., 2016</xref>) and hosted on Heroku (<ext-link ext-link-type="uri" xlink:href="https://www.heroku.com/">https://www.heroku.com/</ext-link>).</p><sec id="s4-1"><title>Participants</title><p>The first set of 19 participants (12 female, six male, and two non-binary) completed the task online on their home computers (and were instructed to maximize their browser windows during the task). The online study participants had a mean age of 20.95 years (SD = 2.84). Participants were paid $70 upon completion of the study. A second set of 16 participants (nine female, six male, and one declined to answer) performed an identical task in the lab while eye-tracking data was collected. The eye-tracking study participants had a mean age of 21.81 years (SD = 3.21). Participants were paid $100, plus up to $20 performance-based bonus. For both versions of the study, we recruited participants via online ads and personal contacts. All participants were over 18 years of age with normal or corrected-to-normal vision and gave informed consent for the study. The experimental protocol was approved by the Institutional Review Board of Columbia University (AAAS0252). One participant from the online study did not complete the last session of the study, and we have included their data for the first five sessions. All the other participants completed all six sessions of the study. Two in-person participants experienced technical issues in one of their sessions, resulting in the loss of data from one game for one participant and 15 games for the other participant. The same technical issues during the eye-tracking study resulted in a small number of trials being shown more than once to several participants; we included only data from the first presentation of each trial in the dataset.</p></sec><sec id="s4-2"><title>Experimental design</title><p>The memory task (<xref ref-type="fig" rid="fig1">Figure 1b</xref>) required participants to watch a sequence of moves and then recall the moves from memory. In each trial, participants saw an initial board for 5 s. Then one move was added to the board every 5 s. After all moves in the sequence had been added, participants completed 14 s of simple distractor math problems asking them to judge whether an equation is true or false. They had 6 s to respond to each question. After the distractor, they were shown the initial board and instructed to reconstruct the sequence in the right locations and in the right order. To account for motor mistakes, they could undo the most recent move they placed.</p><p>The first two memory trials on each day were always practice trials that had four-move sequences, and participants were given feedback on whether a move they just placed was correct or not during retrieval. Participants needed to get all moves correct in the practice trials to proceed to the formal study. The practice trials made sure participants understood the task and followed the instruction. No one was excluded from the study for failing to follow the instructions. Participants then completed 30 trials of the main memory task where they did not receive feedback during the retrieval.</p><p>The sequences of moves were generated using an AI agent from <xref ref-type="bibr" rid="bib51">van Opheusden et al., 2021</xref> with an relatively weak Elo rating similar to participants’ average playing strengths during their first session. We sampled from 180 unique games, each longer than 16 moves and shorter than 36 moves (i.e. the game did not end with a draw). For each session, 30 game segments with lengths ranging from four to eight moves were extracted from unique games. To ensure that meaningful schematic predictions were always possible, the first move of the sequence was always after the fifth move of the game. For example, if a game was 30 moves long and the sequence length was four, the beginning of the sequence could be anywhere between the 5<sup>th</sup> move and the 26<sup>th</sup> move of the game. Of the 30 sequences in each session, 10 sequences (two of each length) ended with one player winning (i.e. the last move created a four-in-a-row). This single set of 30 sequences for this session was shown to all participants in a randomized order (with a different set for each session). The whole memory task takes about 50 min.</p><p>At the beginning of day one, the participants were told that the stimuli were ‘circles appearing on a grid.’ After the memory tasks, they were told that the stimuli were actually drawn from a game that they were about to play. They were then shown the rules of the game and played 40 games against an AI agent (<xref ref-type="fig" rid="fig1">Figure 1c</xref>), which takes about 40 min. We used a staircasing procedure, such that the agent became stronger if the participant won and weaker if the participant lost. We used the Elo rating to measure participants’ playing strength (<xref ref-type="bibr" rid="bib16">Elo, 1978</xref>). The ratings were computed using BayesElo (<xref ref-type="bibr" rid="bib27">Hunter, 2004</xref>) to measure participants’ playing strength in each session based on their performance against the AI agents. After they finished playing the games, they were asked whether they had guessed the stimuli in the memory tasks were from a game, and if so, whether they guessed the rules of the game. We did not include a control group that completed six memory sessions without being told the rules of the game or playing against the AI agent. Ensuring that participants never develop a game schema would be difficult since even without explicit instruction they could still learn the schema through implicit statistical learning or by guessing the (simple) rules of the game. Due to these challenges, we instead used the first-session performance of each participant as our no-schema control.</p><p>From Day two onwards, they were reminded of the rules of the four-in-a-row game at the beginning of the memory task. On Day six, after completing the memory task, participants completed a questionnaire asking them what strategies they used for the memory and whether their strategies changed over the course of the training.</p></sec><sec id="s4-3"><title>Gameplay model</title><p>The original model in <xref ref-type="bibr" rid="bib51">van Opheusden et al., 2021</xref> used a tree search model. However, obtaining accurate move probabilities from this model would require extensive sampling. Instead, we used a feature-based myopic model of gameplay. We first defined features relevant for gameplay, which represent the relationship between the potential next move and the current board state:</p><list list-type="order"><list-item><p>Distance of the move from the horizontal center</p></list-item><list-item><p>Distance of the move from the vertical center</p></list-item><list-item><p>How many four-in-a-rows the move forms?</p></list-item><list-item><p>How many three-in-a-rows the move forms? There are three sub-categories based on the type of three-in-a-row formed: connected, disconnected, and horizontally connected that were not blocked on either side (force a win after the opponent’s move, so it might have a higher value).</p></list-item><list-item><p>How many two-in-a-rows the move forms? There are two sub-categories based on the type of two-in-a-row formed: connected, disconnected.</p></list-item><list-item><p>How many opponent’s three-in-a-rows the move blocks?</p></list-item><list-item><p>How many opponent’s two-in-a-rows the move blocks? There are two sub-categories based on the type of two-in-a-row blocked: horizontally connected two-in-a-row that was not blocked in either direction (if not blocked, the opponent can force a win, so it might have a higher value), or other situations.</p></list-item></list><p>We then used a very strong AI agent to generate 800 games. This agent has an Elo of 365, a level similar to the best players in our study, so its move decisions can be considered an approximation of the schema of a very strong player. To fit the model, for each board state in the 800 games, we represented every possible move <inline-formula><mml:math id="inf1"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as a feature vector <inline-formula><mml:math id="inf2"><mml:mi>F</mml:mi></mml:math></inline-formula> based on the features described above. Each move was assigned a value V that is a weighted combination of the features it forms, with weights defined by a vector <inline-formula><mml:math id="inf3"><mml:mi>w</mml:mi></mml:math></inline-formula>:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mo>⋅</mml:mo><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>We then applied a softmax function to get the probability distribution over possible moves, <inline-formula><mml:math id="inf4"><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> . We used Pytorch (<xref ref-type="bibr" rid="bib33">Paszke et al., 2019</xref>) backpropagation to learn the feature weights <inline-formula><mml:math id="inf5"><mml:mi>w</mml:mi></mml:math></inline-formula> that minimized the cross-entropy loss of the moves actually made by the agent. We trained eight models using the data from 100 of the 800 games for each model and averaged the weight vectors across models to obtain a final weight vector <inline-formula><mml:math id="inf6"><mml:mi>w</mml:mi></mml:math></inline-formula>.</p><p>We use the model’s evaluation of each move as a measure of the schema consistency of a move, assuming that stronger and weaker players have qualitatively the same schema for what makes a good move. An alternative possibility is that individuals develop schemas that are qualitatively distinct from the gameplay model, which will be reflected in some people playing moves that have a very low probability in our gameplay model. We did not find evidence for this possibility in our dataset; during the gameplay sessions, all participants tended to play moves with relatively high probability under the gameplay model (M=0.213, range=0.143–0.297, compared to a random-move baseline of 0.040). We also observed a strong correlation between Elo and this move probability measure (<italic>r</italic>=0.40, p&lt;0.001), showing that stronger players are more aligned with our model. Future work (with more extensive gameplay sessions) could attempt to model unique feature weights for each specific individual.</p><p>We evaluated each move in the stimulus set with this model to determine the probability of each move under a very good strategy. Note that the stimuli were generated by a non-optimal AI agent, and, therefore, move quality varies over a wide range; the moves participants observe are often not the optimal move for a given board configuration. We also used this model to measure the probability of the move participants recalled during retrieval when they made a mistake.</p></sec><sec id="s4-4"><title>Eye-tracking</title><p>For the in-lab subset of participants, eye-tracking data was collected during the memory task on each day. The design was otherwise identical to the online experiment. Participants were seated 100 centimeters in front of a monitor and placed their heads in a chin rest 45 centimeters away from the eye-tracker. They were instructed to remain as still as possible while the eye-tracker was running and were told that they could take breaks during the experiment in between trials. Before beginning the experiment and when the participants returned from their breaks, the eye-tracker calibration and subsequent validation were done using a nine-point grid. We recorded binocular eye movement using EyeLink 1000 plus at 1000 Hz recording frequency. Light levels remained constant for the duration of the 50 min memory portion of the study. The stimuli were displayed on a 24-inch LED monitor, with a resolution of 1920 by 1080 pixels and a refresh rate of 60 Hz. The outputted EDF files were converted to asc files and parsed with PyGaze (<xref ref-type="bibr" rid="bib14">Dalmaijer et al., 2014</xref>).</p><p>Fixation maps were created for each 5 s period during which an initial board was shown or a move was shown. To handle uncertainty in assigning gaze to squares, we performed a soft assignment to board locations based on distance. For a fixation at the position <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> with duration <inline-formula><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the square with center coordinate <inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was assigned a fixation weight of<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>25</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>25</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Here, distance is in the unit of pixels. Since the length of the square is 136 pixels, the smoothing temperature of 25 is approximately 1/5 the length of a square and, therefore, is only relevant for fixations close to square boundaries. The weights for all fixations during the 5 s window were summed to obtain a final map of fixation weights for all board squares.</p></sec><sec id="s4-5"><title>Eye movement regression model</title><p>We modeled fixation maps as a linear combination of six potential strategies that could be used during memory encoding. For each board, the regressors, described below, are length-36 vectors that correspond to the 36 tiles in the game.</p><list list-type="order"><list-item><p>The most recent move: has a value of one in the square that corresponds to the most recent move, and 0 s elsewhere (all 0 s at the initial board). This regressor captures the extent to which participants are looking at the move that just appeared on the board.</p></list-item><list-item><p>Pieces related to the most recent move: has a value of one in occupied squares that are related to the most recent move (within three tiles from the most recent move in any direction), and 0 s elsewhere. This regressor captures the behavior of looking at how a move relates to previously-placed pieces (e.g. to detect whether it adds onto a line of same-color pieces).</p></list-item><list-item><p>Anticipation of the upcoming move (prediction): for the unoccupied squares, is equal to the probabilities of that square being the location of the next move, as calculated by the near-optimal gameplay model. For occupied squares, has a constant value equal to the mean value of the unoccupied squares. This regressor measures how well participants’ eye movements predict likely positions for the next move.</p></list-item><list-item><p>Piece relevance to the next move: for each occupied square, is the sum of the next-move probabilities for all empty squares that are related to it (within three squares). For unoccupied squares, its value is equal to the mean value of the occupied squares. This regressor reflects the tendency to focus on squares that are likely to be related to the next move.</p></list-item><list-item><p>Observed previous moves: has a value of one for the moves seen earlier in the sequence (excluding the most recent move), 0 s elsewhere. This reflects a strategy of reviewing previous moves during memory encoding.</p></list-item><list-item><p>Occupied tiles: has values of 1 s on occupied tiles and 0 s on unoccupied tiles. This measures the preference for looking at occupied squares versus empty squares.</p></list-item></list><p>Each regressor and the eye movement fixation maps were z-scored within each board. We concatenated each of these across all the boards that each participant saw during a session and ran a multiple linear regression (with the fixation maps as the outcome variable, and the six regressors as the predictor variables). The coefficient for each regressor reflects the extent to which this participant used this eye movement strategy when encoding boards in this session. We also ran this regression separately for each individual board (for each move shown during encoding) to obtain trial-level estimates of eye movement strategy.</p></sec><sec id="s4-6"><title>Regression models</title><p>For each model, we started with the most complex frequentist model, including a subject slope for all of the predictors. In case they did not converge, we used simpler models with either fewer random slopes or just a random intercept. If this happens, we also checked whether the effect holds with a more complex model using a Bayesian model. The reported effects with more simpler frequentist models have been shown to hold with a more complex Bayesian model. If a different result was obtained, we report the results of the more complex Bayesian model. For frequentist models, we use lme4 pacakge (<xref ref-type="bibr" rid="bib7">Bates et al., 2015</xref>). For the Bayesian models, we used the default settings of rstanarm package (<xref ref-type="bibr" rid="bib23">Goodrich et al., 2022</xref>).</p></sec><sec id="s4-7"><title>Mediation analysis</title><p>The total effect was calculated by running a linear regression predicting recall accuracy from Elo. Next, we calculated the effect of Elo on the prediction coefficient and the effect of Elo and the prediction coefficient on recall accuracy. The significance of the mediation was computed with the package <italic>mediation</italic> (<xref ref-type="bibr" rid="bib47">Tingley et al., 2014</xref>) that used a bootstrapping procedure. Standardized indirect effects were computed for each of the 10,000 bootstrapped samples, and the 95% CI was computed by determining the indirect effects at the 2.5<sup>th</sup> and 97.5<sup>th</sup> percentiles.</p></sec><sec id="s4-8"><title>Estimating trial-level prediction confidence and surprise</title><p>We constructed two trial-level measures of fixation statistics which allowed us to describe eye movement strategies at a finer scale and in a model-free way (without assuming that participants were making predictions according to our schema model). The first is prediction confidence, which measured the extent to which a participant spent time focused on specific empty squares. High values of confidence indicate that a participant spent a large fraction of the trial looking at only a small number of empty squares, indicating a strong prediction about the upcoming move. We compute this as the expected information gain between a uniform distribution over all empty squares and the fixation distribution. Given the fixation time <inline-formula><mml:math id="inf10"><mml:mi>T</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> for each square <inline-formula><mml:math id="inf11"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , we define <inline-formula><mml:math id="inf12"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> as the fraction of the 5 s window spent fixating on empty squares, and <inline-formula><mml:math id="inf13"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> as the normalized fixation distribution over empty squares. The information gained from a fixation is 0 for fixations on occupied squares, and for fixations on empty squares reflects the entropy difference between a uniform distribution and the fixation distribution. Therefore, we define:<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The second is prediction surprise, indicating the extent to which a participant failed to look at the location where the next move was going to appear. High values of surprise indicate that the move appeared in a location that the participant spent very little time looking at. This is defined as the negative log of the percentage of time participants looked at the correct upcoming move position <inline-formula><mml:math id="inf14"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> :<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Software, Supervision, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Software, Formal analysis, Supervision, Funding acquisition, Validation, Visualization, Methodology, Project administration, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>The experimental protocol was approved by the Institutional Review Board of Columbia University. (AAAS0252) All participants were over 18 years of age with normal or corrected-to-normal vision, and gave informed consent.</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-82599-mdarchecklist1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All the data is openly available through <ext-link ext-link-type="uri" xlink:href="https://osf.io/29cpg/">https://osf.io/29cpg/</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Jiawen</surname><given-names>H</given-names></name><name><surname>Isabel</surname><given-names>V</given-names></name><name><surname>Wei</surname><given-names>JM</given-names></name><name><surname>Christopher</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Schema-based predictive eye movements support sequential memory encoding</data-title><source>Open Science Framework</source><pub-id pub-id-type="doi">10.17605/OSF.IO/29CPG</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alba</surname><given-names>JW</given-names></name><name><surname>Hasher</surname><given-names>L</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Is memory schematic?</article-title><source>Psychological Bulletin</source><volume>93</volume><fpage>203</fpage><lpage>231</lpage><pub-id pub-id-type="doi">10.1037/0033-2909.93.2.203</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>RC</given-names></name><name><surname>Pichert</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Recall of previously unrecallable information following a shift in perspective</article-title><source>Journal of Verbal Learning and Verbal Behavior</source><volume>17</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1016/S0022-5371(78)90485-1</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Effects of prior knowledge on memory for new information</article-title><source>Memory &amp; Cognition</source><volume>9</volume><fpage>237</fpage><lpage>246</lpage><pub-id pub-id-type="doi">10.3758/BF03196958</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Antony</surname><given-names>JW</given-names></name><name><surname>Hartshorne</surname><given-names>TH</given-names></name><name><surname>Pomeroy</surname><given-names>K</given-names></name><name><surname>Gureckis</surname><given-names>TM</given-names></name><name><surname>Hasson</surname><given-names>U</given-names></name><name><surname>McDougle</surname><given-names>SD</given-names></name><name><surname>Norman</surname><given-names>KA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Behavioral, physiological, and neural signatures of surprise during naturalistic sports viewing</article-title><source>Neuron</source><volume>109</volume><fpage>377</fpage><lpage>390</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2020.10.029</pub-id><pub-id pub-id-type="pmid">33242421</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baldassano</surname><given-names>C</given-names></name><name><surname>Hasson</surname><given-names>U</given-names></name><name><surname>Norman</surname><given-names>KA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Representation of real-world event schemas during narrative perception</article-title><source>The Journal of Neuroscience</source><volume>38</volume><fpage>9689</fpage><lpage>9699</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0251-18.2018</pub-id><pub-id pub-id-type="pmid">30249790</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bar</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The proactive brain: memory for predictions</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>364</volume><fpage>1235</fpage><lpage>1243</lpage><pub-id pub-id-type="doi">10.1098/rstb.2008.0310</pub-id><pub-id pub-id-type="pmid">19528004</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bates</surname><given-names>D</given-names></name><name><surname>Mächler</surname><given-names>M</given-names></name><name><surname>Bolker</surname><given-names>B</given-names></name><name><surname>Walker</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Fitting linear mixed-effects models using lme4</article-title><source>Journal of Statistical Software</source><volume>67</volume><fpage>1</fpage><lpage>48</lpage><pub-id pub-id-type="doi">10.18637/jss.v067.i01</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonasia</surname><given-names>K</given-names></name><name><surname>Sekeres</surname><given-names>MJ</given-names></name><name><surname>Gilboa</surname><given-names>A</given-names></name><name><surname>Grady</surname><given-names>CL</given-names></name><name><surname>Winocur</surname><given-names>G</given-names></name><name><surname>Moscovitch</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Prior knowledge modulates the neural substrates of encoding and retrieving naturalistic events at short and long delays</article-title><source>Neurobiology of Learning and Memory</source><volume>153</volume><fpage>26</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1016/j.nlm.2018.02.017</pub-id><pub-id pub-id-type="pmid">29474955</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bower</surname><given-names>GH</given-names></name><name><surname>Black</surname><given-names>JB</given-names></name><name><surname>Turner</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Scripts in memory for text</article-title><source>Cognitive Psychology</source><volume>11</volume><fpage>177</fpage><lpage>220</lpage><pub-id pub-id-type="doi">10.1016/0010-0285(79)90009-4</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bransford</surname><given-names>JD</given-names></name><name><surname>Johnson</surname><given-names>MK</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Contextual prerequisites for understanding: some investigations of comprehension and recall</article-title><source>Journal of Verbal Learning and Verbal Behavior</source><volume>11</volume><fpage>717</fpage><lpage>726</lpage><pub-id pub-id-type="doi">10.1016/S0022-5371(72)80006-9</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chase</surname><given-names>WG</given-names></name><name><surname>Simon</surname><given-names>HA</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>Perception in chess</article-title><source>Cognitive Psychology</source><volume>4</volume><fpage>55</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1016/0010-0285(73)90004-2</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Whatever next? predictive brains, situated agents, and the future of cognitive science</article-title><source>The Behavioral and Brain Sciences</source><volume>36</volume><fpage>181</fpage><lpage>204</lpage><pub-id pub-id-type="doi">10.1017/S0140525X12000477</pub-id><pub-id pub-id-type="pmid">23663408</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cowan</surname><given-names>ET</given-names></name><name><surname>Schapiro</surname><given-names>AC</given-names></name><name><surname>Dunsmoor</surname><given-names>JE</given-names></name><name><surname>Murty</surname><given-names>VP</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Memory consolidation as an adaptive process</article-title><source>Psychonomic Bulletin &amp; Review</source><volume>28</volume><fpage>1796</fpage><lpage>1810</lpage><pub-id pub-id-type="doi">10.3758/s13423-021-01978-x</pub-id><pub-id pub-id-type="pmid">34327677</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dalmaijer</surname><given-names>ES</given-names></name><name><surname>Mathôt</surname><given-names>S</given-names></name><name><surname>Van der Stigchel</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>PyGaze: an open-source, cross-platform toolbox for minimal-effort programming of eyetracking experiments</article-title><source>Behavior Research Methods</source><volume>46</volume><fpage>913</fpage><lpage>921</lpage><pub-id pub-id-type="doi">10.3758/s13428-013-0422-2</pub-id><pub-id pub-id-type="pmid">24258321</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Didierjean</surname><given-names>A</given-names></name><name><surname>Marmèche</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Anticipatory representation of visual basketball scenes by novice and expert players</article-title><source>Visual Cognition</source><volume>12</volume><fpage>265</fpage><lpage>283</lpage><pub-id pub-id-type="doi">10.1080/13506280444000021A</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Elo</surname><given-names>AE</given-names></name></person-group><year iso-8601-date="1978">1978</year><source>The Rating of Chessplayers, Past and Present</source><publisher-loc>New York</publisher-loc><publisher-name>Arco Pub</publisher-name></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>D</given-names></name><name><surname>Kafkas</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Expectation-driven novelty effects in episodic memory</article-title><source>Neurobiology of Learning and Memory</source><volume>183</volume><elocation-id>107466</elocation-id><pub-id pub-id-type="doi">10.1016/j.nlm.2021.107466</pub-id><pub-id pub-id-type="pmid">34048914</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frankenstein</surname><given-names>AN</given-names></name><name><surname>McCurdy</surname><given-names>MP</given-names></name><name><surname>Sklenar</surname><given-names>AM</given-names></name><name><surname>Pandya</surname><given-names>R</given-names></name><name><surname>Szpunar</surname><given-names>KK</given-names></name><name><surname>Leshikar</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Future thinking about social targets: the influence of prediction outcome on memory</article-title><source>Cognition</source><volume>204</volume><elocation-id>104390</elocation-id><pub-id pub-id-type="doi">10.1016/j.cognition.2020.104390</pub-id><pub-id pub-id-type="pmid">32711183</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The free-energy principle: a unified brain theory?</article-title><source>Nature Reviews. Neuroscience</source><volume>11</volume><fpage>127</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1038/nrn2787</pub-id><pub-id pub-id-type="pmid">20068583</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghosh</surname><given-names>VE</given-names></name><name><surname>Gilboa</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>What is A memory schema? A historical perspective on current neuroscience literature</article-title><source>Neuropsychologia</source><volume>53</volume><fpage>104</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1016/j.neuropsychologia.2013.11.010</pub-id><pub-id pub-id-type="pmid">24280650</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gobet</surname><given-names>F</given-names></name><name><surname>Waters</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The role of constraints in expert memory</article-title><source>Journal of Experimental Psychology. Learning, Memory, and Cognition</source><volume>29</volume><fpage>1082</fpage><lpage>1094</lpage><pub-id pub-id-type="doi">10.1037/0278-7393.29.6.1082</pub-id><pub-id pub-id-type="pmid">14622048</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldstein</surname><given-names>A</given-names></name><name><surname>Zada</surname><given-names>Z</given-names></name><name><surname>Buchnik</surname><given-names>E</given-names></name><name><surname>Schain</surname><given-names>M</given-names></name><name><surname>Price</surname><given-names>A</given-names></name><name><surname>Aubrey</surname><given-names>B</given-names></name><name><surname>Nastase</surname><given-names>SA</given-names></name><name><surname>Feder</surname><given-names>A</given-names></name><name><surname>Emanuel</surname><given-names>D</given-names></name><name><surname>Cohen</surname><given-names>A</given-names></name><name><surname>Jansen</surname><given-names>A</given-names></name><name><surname>Gazula</surname><given-names>H</given-names></name><name><surname>Choe</surname><given-names>G</given-names></name><name><surname>Rao</surname><given-names>A</given-names></name><name><surname>Kim</surname><given-names>C</given-names></name><name><surname>Casto</surname><given-names>C</given-names></name><name><surname>Fanda</surname><given-names>L</given-names></name><name><surname>Doyle</surname><given-names>W</given-names></name><name><surname>Friedman</surname><given-names>D</given-names></name><name><surname>Dugan</surname><given-names>P</given-names></name><name><surname>Melloni</surname><given-names>L</given-names></name><name><surname>Reichart</surname><given-names>R</given-names></name><name><surname>Devore</surname><given-names>S</given-names></name><name><surname>Flinker</surname><given-names>A</given-names></name><name><surname>Hasenfratz</surname><given-names>L</given-names></name><name><surname>Levy</surname><given-names>O</given-names></name><name><surname>Hassidim</surname><given-names>A</given-names></name><name><surname>Brenner</surname><given-names>M</given-names></name><name><surname>Matias</surname><given-names>Y</given-names></name><name><surname>Norman</surname><given-names>KA</given-names></name><name><surname>Devinsky</surname><given-names>O</given-names></name><name><surname>Hasson</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Shared computational principles for language processing in humans and deep language models</article-title><source>Nature Neuroscience</source><volume>25</volume><fpage>369</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1038/s41593-022-01026-4</pub-id><pub-id pub-id-type="pmid">35260860</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Goodrich</surname><given-names>B</given-names></name><name><surname>Gabry</surname><given-names>J</given-names></name><name><surname>Brilleman</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Rstanarm: bayesian applied regression modeling via stan</data-title><version designator="version 2.21.1">version 2.21.1</version><source>R Package</source><ext-link ext-link-type="uri" xlink:href="https://mc-stan.org/rstanarm/">https://mc-stan.org/rstanarm/</ext-link></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorman</surname><given-names>AD</given-names></name><name><surname>Abernethy</surname><given-names>B</given-names></name><name><surname>Farrow</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Classical pattern recall tests and the prospective nature of expert performance</article-title><source>Quarterly Journal of Experimental Psychology</source><volume>65</volume><fpage>1151</fpage><lpage>1160</lpage><pub-id pub-id-type="doi">10.1080/17470218.2011.644306</pub-id><pub-id pub-id-type="pmid">22414197</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greve</surname><given-names>A</given-names></name><name><surname>Cooper</surname><given-names>E</given-names></name><name><surname>Kaula</surname><given-names>A</given-names></name><name><surname>Anderson</surname><given-names>MC</given-names></name><name><surname>Henson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Does prediction error drive one-shot declarative learning?</article-title><source>Journal of Memory and Language</source><volume>94</volume><fpage>149</fpage><lpage>165</lpage><pub-id pub-id-type="doi">10.1016/j.jml.2016.11.001</pub-id><pub-id pub-id-type="pmid">28579691</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gureckis</surname><given-names>TM</given-names></name><name><surname>Martin</surname><given-names>J</given-names></name><name><surname>McDonnell</surname><given-names>J</given-names></name><name><surname>Rich</surname><given-names>AS</given-names></name><name><surname>Markant</surname><given-names>D</given-names></name><name><surname>Coenen</surname><given-names>A</given-names></name><name><surname>Halpern</surname><given-names>D</given-names></name><name><surname>Hamrick</surname><given-names>JB</given-names></name><name><surname>Chan</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>PsiTurk: an open-source framework for conducting replicable behavioral experiments online</article-title><source>Behavior Research Methods</source><volume>48</volume><fpage>829</fpage><lpage>842</lpage><pub-id pub-id-type="doi">10.3758/s13428-015-0642-8</pub-id><pub-id pub-id-type="pmid">26428910</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname><given-names>DR</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>MM algorithms for generalized bradley-terry models</article-title><source>The Annals of Statistics</source><volume>32</volume><fpage>384</fpage><lpage>406</lpage><pub-id pub-id-type="doi">10.1214/aos/1079120141</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kriegeskorte</surname><given-names>N</given-names></name><name><surname>Mur</surname><given-names>M</given-names></name><name><surname>Bandettini</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Representational similarity analysis - connecting the branches of systems neuroscience</article-title><source>Frontiers in Systems Neuroscience</source><volume>2</volume><elocation-id>4</elocation-id><pub-id pub-id-type="doi">10.3389/neuro.06.004.2008</pub-id><pub-id pub-id-type="pmid">19104670</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lampinen</surname><given-names>JM</given-names></name><name><surname>Faries</surname><given-names>JM</given-names></name><name><surname>Neuschatz</surname><given-names>JS</given-names></name><name><surname>Toglia</surname><given-names>MP</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Recollections of things schematic: the influence of scripts on recollective experience</article-title><source>Applied Cognitive Psychology</source><volume>14</volume><fpage>543</fpage><lpage>554</lpage><pub-id pub-id-type="doi">10.1002/1099-0720(200011/12)14:6&lt;543::AID-ACP674&gt;3.0.CO;2-K</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lavín</surname><given-names>C</given-names></name><name><surname>San Martín</surname><given-names>R</given-names></name><name><surname>Rosales Jubal</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Pupil dilation signals uncertainty and surprise in a learning gambling task</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>7</volume><elocation-id>218</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2013.00218</pub-id><pub-id pub-id-type="pmid">24427126</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lew</surname><given-names>AR</given-names></name><name><surname>Howe</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Out of place, out of mind: schema-driven false memory effects for object-location bindings</article-title><source>Journal of Experimental Psychology. Learning, Memory, and Cognition</source><volume>43</volume><fpage>404</fpage><lpage>421</lpage><pub-id pub-id-type="doi">10.1037/xlm0000317</pub-id><pub-id pub-id-type="pmid">27504681</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neuschatz</surname><given-names>JS</given-names></name><name><surname>Lampinen</surname><given-names>JM</given-names></name><name><surname>Preston</surname><given-names>EL</given-names></name><name><surname>Hawkins</surname><given-names>ER</given-names></name><name><surname>Toglia</surname><given-names>MP</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The effect of memory schemata on memory and the phenomenological experience of naturalistic situations</article-title><source>Applied Cognitive Psychology</source><volume>16</volume><fpage>687</fpage><lpage>708</lpage><pub-id pub-id-type="doi">10.1002/acp.824</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Paszke</surname><given-names>A</given-names></name><name><surname>Gross</surname><given-names>S</given-names></name><name><surname>Massa</surname><given-names>F</given-names></name><name><surname>Lerer</surname><given-names>A</given-names></name><name><surname>Bradbury</surname><given-names>J</given-names></name><name><surname>Chanan</surname><given-names>G</given-names></name><name><surname>Killeen</surname><given-names>T</given-names></name><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Gimelshein</surname><given-names>N</given-names></name><name><surname>Antiga</surname><given-names>L</given-names></name><name><surname>Desmaison</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><chapter-title>Pytorch: an imperative style, high-performance deep learning library</chapter-title><person-group person-group-type="editor"><name><surname>Jordan</surname><given-names>MI</given-names></name></person-group><source>Advances in Neural Information Processing Systems</source><publisher-name>MIT Press</publisher-name><fpage>8026</fpage><lpage>8037</lpage></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Potts</surname><given-names>R</given-names></name><name><surname>Shanks</surname><given-names>DR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The benefit of generating errors during learning</article-title><source>Journal of Experimental Psychology. General</source><volume>143</volume><fpage>644</fpage><lpage>667</lpage><pub-id pub-id-type="doi">10.1037/a0033194</pub-id><pub-id pub-id-type="pmid">23815457</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Preuschoff</surname><given-names>K</given-names></name><name><surname>’t Hart</surname><given-names>BM</given-names></name><name><surname>Einhäuser</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Pupil dilation signals surprise: evidence for noradrenaline’s role in decision making</article-title><source>Frontiers in Neuroscience</source><volume>5</volume><elocation-id>115</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2011.00115</pub-id><pub-id pub-id-type="pmid">21994487</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quent</surname><given-names>JA</given-names></name><name><surname>Henson</surname><given-names>RN</given-names></name><name><surname>Greve</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A predictive account of how novelty influences declarative memory</article-title><source>Neurobiology of Learning and Memory</source><volume>179</volume><elocation-id>107382</elocation-id><pub-id pub-id-type="doi">10.1016/j.nlm.2021.107382</pub-id><pub-id pub-id-type="pmid">33476747</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ranganath</surname><given-names>C</given-names></name><name><surname>Rainer</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Neural mechanisms for detecting and remembering novel events</article-title><source>Nature Reviews. Neuroscience</source><volume>4</volume><fpage>193</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.1038/nrn1052</pub-id><pub-id pub-id-type="pmid">12612632</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname><given-names>RPN</given-names></name><name><surname>Ballard</surname><given-names>DH</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Predictive coding in the visual cortex: a functional interpretation of some extra-classical receptive-field effects</article-title><source>Nature Neuroscience</source><volume>2</volume><fpage>79</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1038/4580</pub-id><pub-id pub-id-type="pmid">10195184</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robin</surname><given-names>J</given-names></name><name><surname>Moscovitch</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Details, GIST and schema: hippocampal–neocortical interactions underlying recent and remote episodic and spatial memory</article-title><source>Current Opinion in Behavioral Sciences</source><volume>17</volume><fpage>114</fpage><lpage>123</lpage><pub-id pub-id-type="doi">10.1016/j.cobeha.2017.07.016</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schapiro</surname><given-names>AC</given-names></name><name><surname>Kustner</surname><given-names>LV</given-names></name><name><surname>Turk-Browne</surname><given-names>NB</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Shaping of object representations in the human medial temporal lobe based on temporal regularities</article-title><source>Current Biology</source><volume>22</volume><fpage>1622</fpage><lpage>1627</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.06.056</pub-id><pub-id pub-id-type="pmid">22885059</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schapiro</surname><given-names>AC</given-names></name><name><surname>Turk-Browne</surname><given-names>NB</given-names></name><name><surname>Botvinick</surname><given-names>MM</given-names></name><name><surname>Norman</surname><given-names>KA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Complementary learning systems within the hippocampus: a neural network modelling approach to reconciling episodic memory with statistical learning</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>372</volume><elocation-id>20160049</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2016.0049</pub-id><pub-id pub-id-type="pmid">27872368</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shain</surname><given-names>C</given-names></name><name><surname>Blank</surname><given-names>IA</given-names></name><name><surname>van Schijndel</surname><given-names>M</given-names></name><name><surname>Schuler</surname><given-names>W</given-names></name><name><surname>Fedorenko</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>FMRI reveals language-specific predictive coding during naturalistic sentence comprehension</article-title><source>Neuropsychologia</source><volume>138</volume><elocation-id>107307</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuropsychologia.2019.107307</pub-id><pub-id pub-id-type="pmid">31874149</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sherman</surname><given-names>BE</given-names></name><name><surname>Turk-Browne</surname><given-names>NB</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Statistical prediction of the future impairs episodic encoding of the present</article-title><source>PNAS</source><volume>117</volume><fpage>22760</fpage><lpage>22770</lpage><pub-id pub-id-type="doi">10.1073/pnas.2013291117</pub-id><pub-id pub-id-type="pmid">32859755</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slamecka</surname><given-names>NJ</given-names></name><name><surname>Graf</surname><given-names>P</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>The generation effect: delineation of a phenomenon</article-title><source>Journal of Experimental Psychology</source><volume>4</volume><fpage>592</fpage><lpage>604</lpage><pub-id pub-id-type="doi">10.1037/0278-7393.4.6.592</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stark</surname><given-names>SM</given-names></name><name><surname>Reagh</surname><given-names>ZM</given-names></name><name><surname>Yassa</surname><given-names>MA</given-names></name><name><surname>Stark</surname><given-names>CEL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>What’s in a context? cautions, limitations, and potential paths forward</article-title><source>Neuroscience Letters</source><volume>680</volume><fpage>77</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1016/j.neulet.2017.05.022</pub-id><pub-id pub-id-type="pmid">28529173</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tal</surname><given-names>A</given-names></name><name><surname>Bloch</surname><given-names>A</given-names></name><name><surname>Cohen-Dallal</surname><given-names>H</given-names></name><name><surname>Aviv</surname><given-names>O</given-names></name><name><surname>Schwizer Ashkenazi</surname><given-names>S</given-names></name><name><surname>Bar</surname><given-names>M</given-names></name><name><surname>Vakil</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Oculomotor anticipation reveals a multitude of learning processes underlying the serial reaction time task</article-title><source>Scientific Reports</source><volume>11</volume><elocation-id>6190</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-021-85842-x</pub-id><pub-id pub-id-type="pmid">33737700</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tingley</surname><given-names>D</given-names></name><name><surname>Yamamoto</surname><given-names>T</given-names></name><name><surname>Hirose</surname><given-names>K</given-names></name><name><surname>Keele</surname><given-names>L</given-names></name><name><surname>Imai</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mediation: R package for causal mediation analysis</article-title><source>Journal of Statistical Software</source><volume>59</volume><elocation-id>05</elocation-id><pub-id pub-id-type="doi">10.18637/jss.v059.i05</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tompary</surname><given-names>A</given-names></name><name><surname>Zhou</surname><given-names>W</given-names></name><name><surname>Davachi</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Schematic memories develop quickly, but are not expressed unless necessary</article-title><source>Scientific Reports</source><volume>10</volume><elocation-id>16968</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-020-73952-x</pub-id><pub-id pub-id-type="pmid">33046766</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Buuren</surname><given-names>M</given-names></name><name><surname>Kroes</surname><given-names>MCW</given-names></name><name><surname>Wagner</surname><given-names>IC</given-names></name><name><surname>Genzel</surname><given-names>L</given-names></name><name><surname>Morris</surname><given-names>RGM</given-names></name><name><surname>Fernández</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Initial investigation of the effects of an experimentally learned schema on spatial associative memory in humans</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>16662</fpage><lpage>16670</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2365-14.2014</pub-id><pub-id pub-id-type="pmid">25505319</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Kesteren</surname><given-names>MTR</given-names></name><name><surname>Ruiter</surname><given-names>DJ</given-names></name><name><surname>Fernández</surname><given-names>G</given-names></name><name><surname>Henson</surname><given-names>RN</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>How schema and novelty augment memory formation</article-title><source>Trends in Neurosciences</source><volume>35</volume><fpage>211</fpage><lpage>219</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2012.02.001</pub-id><pub-id pub-id-type="pmid">22398180</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>van Opheusden</surname><given-names>B</given-names></name><name><surname>Galbiati</surname><given-names>G</given-names></name><name><surname>Kuperwajs</surname><given-names>I</given-names></name><name><surname>Bnaya</surname><given-names>Z</given-names></name><name><surname>li</surname><given-names>Y</given-names></name><name><surname>Ma</surname><given-names>WJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Revealing the Impact of Expertise on Human Planning with a Two-Player Board Game</article-title><source>PsyArXiv</source><pub-id pub-id-type="doi">10.31234/osf.io/rhq5j</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watkins</surname><given-names>MJ</given-names></name><name><surname>Gardiner</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>An appreciation of generate-recognize theory of recall</article-title><source>Journal of Verbal Learning and Verbal Behavior</source><volume>18</volume><fpage>687</fpage><lpage>704</lpage><pub-id pub-id-type="doi">10.1016/S0022-5371(79)90397-9</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82599.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Luo</surname><given-names>Huan</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02v51f717</institution-id><institution>Peking University</institution></institution-wrap><country>China</country></aff></contrib></contrib-group></front-stub><body><p>This work designed a novel board game paradigm (4-in-a-row, a sort of tic-tack-toe expansion) in combination with eye movement recordings to examine how schemas gradually learned in the game influence memory. They provide impressive evidence that, in both behavior and eye movements, schema indeed guides the encoding of sequential events and facilitates memory performance. This paper would be of great interest to many fields, such as memory, learning, and decision-making.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82599.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Luo</surname><given-names>Huan</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02v51f717</institution-id><institution>Peking University</institution></institution-wrap><country>China</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Reagh</surname><given-names>Zachariah M</given-names></name><role>Reviewer</role></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Schema-based predictive eye movements support sequential memory encoding&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Timothy Behrens as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Zachariah M. Reagh (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission. All the reviewers agree that it is an impressive and well-done study to explore a very important question, i.e., the nature and origins of schema-based effect on memory. The clever experimental paradigm strikes a nice balance between complexity in capturing elements of naturalistic human behavior and simplicity in terms of analyses. Meanwhile, the reviewers also raised several critical concerns that need further control experiments and analyses to support the conclusion.</p><p>Essential revisions:</p><p>1) Instead of memorizing the board positions, subjects might simply consider how they play from that position, a strategy that could account for all the observations. To decouple the schema-based and purely-memory-based influences, a further control study needs to be conducted (see details in Reviewer 3's comments);</p><p>2) There lacks a control group who neither knows the rule nor play the game before. The prediction is that the control group will show (1) worse memory; (2) their error patterns are different and unrelated to p (move);</p><p>3) Reanalyzing the data to address the potential mixture of session-level and participant-level variability (see Reviewer 1's 2nd concern)；</p><p>4) Further clarifications are needed, such as the drop-off in late sessions, reasons for not looking at pupil dilation, the rationale for schema-based memory facilitation hypothesis, and presentation of RT data (see Reviewer 2's comments)</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>This paper develops an interesting and new experimental paradigm to investigate how schema participates in memory and helps to generate predictions, using behavioral measurements, eye movement recordings, and computational modeling. The results show the correlation between memory accuracy, game performance, and predictive eye movements, supporting that schema significantly boosts memory and guide prediction. This paper would be of potential interest to many fields, such as memory, learning, and decision-making.</p><p>We see two major strengths in the paper. First, although schema-based memory is crucial, it is very hard to study it in a natural and also controllable way in the lab. This work develops a complex game paradigm with proper difficulty levels, enabling the examination of the characteristics of the process. Second, the combination of memory behavior, eye movement, and game playing provides a comprehensive framework to tackle the question.</p><p>The major weakness of the work mainly lies in its lack of a control group, that is, subjects who neither know the rule nor play the game before. This would be important evidence to support the advantage of schema-based memory boosting. Moreover, the source of the effects needs to be further clarified using additional analyses.</p><p>Concerns:</p><p>1. Schema-based boost in memory and predictive eye movement lacks a control group who neither know the rule nor play the game before. The prediction is that the control group will show (1) worse memory; (2) their error patterns are different and unrelated to p (move).</p><p>2. Most of the correlation analyses mixed the variability levels and thus confused the source of the memory boosting effects. For example, when calculating the correlation results (Figure 2C), each data point represents a session of a participant. In this case, the source of the effect could come from either session-level variability that is due to training or participant-level variability. In fact, all the linear mixed-effect models have the same problem and need to be fixed. I would not suggest excluding the random effect for slopes since that would increase the probability of Type I error and as a consequence, the observed effect might arise from individual differences rather than experimental manipulation (see Brauer and Curtin, Psychol Methods, 2018 and Bates, arXiv, 2018 for guides). It is important to include individual-level random effects in the analysis.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>This paper by Huang and colleagues uses a simple board game, &quot;4-in-a-row,&quot; to test the relationship between schemas and episodic memory. Specifically, the goal here was to examine the way schemas can guide encoding of sequential events as the game unfolded. In sum, the authors report that memory for move sequences in the game improved with player skill, and that memory was particularly improved for schema-consistent sequences. Further, eye movements during encoding were associated with stronger memory for move sequences, which was most prevalent in expert players.</p><p>We think this study does a fine job of answering how the development of schema aid in prediction and thereby memory through use of a stimulus that is at once naturalistic but learnable by participants in laboratory time. This is a difficult set of boxes to check. While 4-in-a-row is certainly a simplistic way of testing encoding and retrieval of &quot;events,&quot; it nonetheless tests memory in a fairly rich and meaningful way compared to much existing research, especially with regard to sequential order. The approach itself strikes a really nice balance between complexity in capturing elements of naturalistic human behavior, and simplicity in terms of analyses. Overall we think this experiment is sound, and the paper is well-written.</p><p>We have some requests for expansion/clarification and a few suggestions for strengthening the paper.</p><p>1. Looking at Figure 3c and 3d, it struck us that the slope of recall accuracy increases linearly across sessions 1-4, but then drops pretty markedly to sessions 5 and 6. If things simply leveled-off or dropped slightly, it would seem less important or interesting, but the drop-off is quite stark. What could be happening here? What do the authors make of this?</p><p>2. It was actually a bit surprising to us that the authors didn't use pupillometry when evaluating surprise. Pupil dilation has been strongly linked to the constructs of surprise and prediction error, more so than gaze. We are not necessarily suggesting that the authors rerun their model using pupillometry, but some rationale for why gaze rather than pupil dilation was optimal for testing surprise in this context would help. As it stands, we felt that this disconnect left the reasoning behind the surprise model feeling unclear, and we think a more explicit discussion of this would be helpful.</p><p>3. As the authors themselves flesh out in the Discussion, there is a fair amount of inconsistency in the literature as to whether schema-consistent (or &quot;congruent,&quot; as others often say) or schema-inconsistent information provides relative a boost to episodic memory. And although we think their points related to this in the Discussion are fine, we think it would be worth laying out the reasoning for the prediction that schema-consistency should benefit memory in the Introduction. Our reasoning here is that, from our point of view, it could have easily gone either way. And we think that the field can benefit at this point from clear logic laying out predictions related to schema and memory.</p><p>4. Did the authors analyze reaction time data at all? To be clear, we are not making a strong suggestion to do so, but given links between surprise and response time variability, and the logical relationship between increasing experience and time taken to do something, it seems a logical thing to do in characterizing performance.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>This paper presents a series of analyses of the relationship between predictive schemas – representations that allow people to form predictions about events in their environment – and performance in a memory task. Participants in the experiments learned to play a novel board game over a period of several days, and also performed a memory task in which they had to recall sequences of board positions. The first time they performed the memory task they had no experience with the game, so these just looked like random configurations of black and white circles. As players became more familiar with the game, the memory performance also improved.</p><p>Several analyses dig deeper into this phenomenon, examining how participants' memory for specific board positions are related to the probability of the corresponding moves in the game, as estimated by an AI agent. This analysis shows that people have better memory for higher probability moves. By bringing another group of participants into the laboratory and performing eye tracking, it was shown that people's eyes movements also seem to be influenced by the probability of moves. Further analyses that express confidence and surprise in terms of these eye movements – how focused people seem to be on a specific position and how long they spend looking at the correct position – show that these quantities are also related to memory.</p><p>Overall, I think this is an impressive piece of work that does a nice job of exploring several questions about the nature and origins of schema-based effects on memory performance through the clever use of a novel task. However, I do think there is one substantial potential confound. As people are getting better at playing the game, it seems like one potential strategy they might use is to worry less about memorizing the board positions and instead to simply consider how they would play from that position. People following this strategy would seem to account for all of the results that are presented: it would result in a higher probability of being correct on higher probability moves, and potentially produce the associated effects involving eye-movements since those eye-movements tend to be concentrated on the high probability moves as well.</p><p>This kind of confound is likely to arise in studies looking at schema effects on memory, because if people have a schema they can use that schema to make informed guesses that are more likely to be right for schema-consistent items. However, in this setting it seems like there is actually an opportunity to address this confound directly. I think this could be done by conducting a further study in which people play from the same board positions that are used to initiate the memory recall sequences – perhaps doing so on different days so as to remove concerns about interference. By measuring the actual play sequences that people generate, it would be possible to focus the analyses on cases where the memory sequences differ from these play sequences. In fact, if the play sequences are generated the day before the memory test, the memory test could include two kinds of trials: one set where the memory sequence corresponds to that produced by the participant on the previous day, and one where it diverges. If the reported effects are observed in both of these conditions, that helps to decouple simulated play from generic schema use (that is, if a move in a memory sequence that has high probability but wasn't played by the participant the previous day is still remembered well, it provides strong support for a schema effect rather than a play-based strategy).</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Schema-based predictive eye movements support sequential memory encoding&quot; for further consideration by <italic>eLife</italic>. Your revised article has been evaluated by Timothy Behrens (Senior Editor) and a Reviewing Editor.</p><p>Since the original two reviewers were not available to review the revised version, we have invited Reviewer 4 to evaluate the revision.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below:</p><p>1) Providing the learning curve of the control group (first session here) instead of the averaged results;</p><p>2) Please see detailed comments by Reviewer 4.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>About the two major comments or experiments I raised, the authors have done a fine job addressing them. They have performed a simulation analysis to exclude the alternative explanation raised in the first question. They chose to use the first session of the data as the control group to answer the second question.</p><p>Their answers are fine but I would like to clarify my original point that may have been unclear. That is, showing the learning curve rather than a single point of the control group's performance, i.e., the first session, as a control.</p><p><italic>Reviewer #4 (Recommendations for the authors):</italic></p><p>Huang et al. examined the influence of schemas on prediction and sequence memory for a novel board game. Participants' memory for sequences of moves was tested across several sessions as they learned the game and improved. Over the sessions, and accompanied by a skill increase, participants' memory for the sequences improved. This learning was also related to eye-movements during encoding which were predictive of memory for the sequences.</p><p>This study does an excellent job of linking schema development to prediction/attention and memory.</p><p>Comments:</p><p>In the first paragraph of the Results section, it was unclear whether during the game play task participants were provided instructions or whether they had to learn the game through some kind of trial and error. It should be specified that they were provided with rules since early in the paragraph it notes that the participants were naive to the fact that a game was being shown in the initial memory test phase.</p><p>&quot;Modeling schema-related memory improvement&quot; In this section a model is trained based on moves from a near optimal AI. A probability distribution is made for upcoming moves based on the likelihood a move would be made by a near optimal AI. This probability is interpreted to be related to the schema consistency of a move. This may be true for an expert player. However, a near optimal move may not be schema-consistent for a new player or maybe even an average player. The participant's internal schema when they are beginners and progress may not map on to the near optimal AI moves. This is an interesting analysis, but calling the near optimal AI move schema consistent just slightly seems like a miswording for me.</p><p>Discussion &quot;One possibility is that their study (in which participants implicitly learned statistical dependencies between image categories presented in a continuous stream) engages a predictive process that relies on the hippocampus (Schapiro et al., 2017), creating interference between prediction and encoding processes, while the explicit schematic predictions in our study could rely on a different network such as the medial prefrontal cortex &quot; While this is a compelling assertion, can you describe anything that psychologically varies between these tasks? For example, Shapiro et al. had participants learn arbitrary statistical sequences, but here the sequences could be understood in the context of rules, goals, and progression towards goal states.</p><p>Methods: During the memory task, 10 out of the 30 sequences ended in a win state. Since a win-state caps off a sequence this could be thought of as an event boundary. Was there any effect of these 10 sequences that differed from the other 20 or interacted with other effects? For example, if a win-state is an event boundary, is particularly salient, and is better remembered, then a participant merely has to reconstruct the sequence from probe to win-state, rather than remembering each move.</p><p>Modeling schema-related memory improvement&quot; In this section the authors missed a period in &quot;near- optimal AI agent The model identifies&quot;.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82599.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Instead of memorizing the board positions, subjects might simply consider how they play from that position, a strategy that could account for all the observations. To decouple the schema-based and purely-memory-based influences, a further control study needs to be conducted (see details in Reviewer 3's comments);</p></disp-quote><p>We have now conducted an additional analysis, in which we simulate schema-consistent guessing on the memory task using our AI game-playing model. Because this model was trained on gameplay distribution similar to those used in the memory task, this provides an upper bound on the best-possible performance achievable without using any episodic memory. We included a discussion of this simulation in the result section:</p><p>“Another potential explanation could be a change in participants’ strategy. In the beginning, participants can only use their episodic memory, but over time participants could start to use a purely schema-based strategy in which they simply place moves as if they are playing the game from this board position. We simulated this strategy by drawing moves probabilistically from the gameplay (schema) model for each initial board that participants saw during the memory task in each session. We found that purely schema-based guessing can only achieve an average accuracy of 13.39% across the 6 sessions (Figure 2a), which is much lower than participants’ average recall accuracy of 65.91%. This low accuracy is due to the fact that, for most of the sequences, there are multiple plausible moves that could be played and it is therefore difficult to guess the sequence without episodic knowledge. Therefore, the improvement in performance after learning the schema is unlikely due to mere guessing of the boards.” (line 268-280)</p><p>This simulation demonstrates that, even under optimal guessing, it is not possible for a non-episodic strategy to produce our observed results. We therefore do not believe it is necessary to run the proposed behavioral experiment with human participants, since selecting moves based on how the participant would play the game cannot yield performance higher than 13.39%.</p><p>Additionally, if participants were no longer attempting to memorize the specific moves being played, the time spent looking at the most recent move on the board would drop sharply after participants developed a schema. We therefore looked at the change across sessions for the last-move coefficient in our eye-movement analysis, which describes the extent to which participants look at the most recently-placed move. Although the last move coefficient did reduce numerically over time, this reduction is small and not significant (p = .114).</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82599-sa2-fig1-v2.tif"/></fig><p>Based on the analyses presented above, we believe that a purely schema-based strategy is unlikely to explain the effects we observed in the study.</p><disp-quote content-type="editor-comment"><p>2) There lacks a control group who neither knows the rule nor play the game before. The prediction is that the control group will show (1) worse memory; (2) their error patterns are different and unrelated to p (move);</p></disp-quote><p>The first session for each participant did serve as exactly this control group, which we have now emphasized in the beginning of the result section.</p><p>“In the first session, participants were not told that these stimuli came from a game, and were only instructed to remember circles appearing on a grid. The first session therefore provided a no-schema baseline, since participants could not use a game model to make predictions about upcoming moves. In a post-task questionnaire, we confirmed that in session 1 most participants did not suspect that the stimuli were from a game or guess the rule of the game (14 out of 19 in the online study, and 13 out of 16 in the in-person study).” (line 111-114)</p><p>We found that subjects indeed had worse memory in this first session (figure 1) and that their recall accuracy was not related to the probability of the move (figure 3b, top left figure).</p><disp-quote content-type="editor-comment"><p>3) Reanalyzing the data to address the potential mixture of session-level and participant-level variability (see Reviewer 1's 2nd concern);</p></disp-quote><p>We now include random participant intercepts and slopes for <italic>all</italic> our regression models in the study, following the approach of <italic>Brauer and Curtin, Psychol Methods, 2018</italic> (as recommended by Reviewer #1). In cases where this model failed to converge, we <italic>simplify the model,</italic> and used Bayesian priors to stabilize the coefficient estimates. This approach yielded conclusions largely similar to our previous (random-intercept-only) models for almost all analyses (lines 126-128, 171, 180-181, 197, 223, 295-296, 352-356, 372-377).</p><p>We described our approach for using frequentist and Bayesian models in the Methods:</p><p>“Regression Models</p><p>For each model, we started with the most complex frequentist model, including a subject slope and intercept for all the predictors. In cases where this model did not converge, we took two parallel approaches. First, we simplified the frequentist model by removing random slopes for some or all of the effects until the model converged. We also fit a Bayesian version of the complex model (with all random slopes). If these two approaches yielded the same result (with the same coefficients statistically different from zero), we reported the simpler frequentist model; if the results differed, we reported the result for the full Bayesian model. For frequentist models, we use lme4 pacakge (Bates et al., 2015). For the Bayesian models, we used the default settings of rstanarm package (Goodrich et al., 2022).” (line 719-727)</p><p>Accounting for across-subject variability did yield a different outcome for our analyses examining the relationship between Elo, prediction coefficient, and memory accuracy:</p><p>“To understand whether this relationship was present within individual participants, we fit a linear mixed effect model to predict memory performance from Elo with per-participant intercepts and slopes as random effects. We found that the relationship between Elo and memory accuracy was not significant in this model (β = 0.012, t = 1.196, p = .242), suggesting that this effect was primarily driven by individual differences (people with better schema tend to have better memory) rather than across-session improvements in Elo.” (line 143-148)</p><p>“We again tested whether these effects were present at the individual-participant level by running a linear mixed effect model with participant random intercepts and slopes. Due to model convergence issues, we employed a Bayesian version of this model to regularize the coefficient estimates (see Methods). We found that the 95% credibility interval for the fixed effect of Elo on prediction coefficient overlapped with 0 (β = 0.007, 95% CI = [-0.003, 0.016]). The 95% credibility interval for the fixed effect of prediction coefficient on recall accuracy also overlapped with 0 (β = 0.164, 95% CI = [-0.54, 0.87]). Together with previous findings, these results suggest that the observed mediation effect is primarily driven by individual differences rather than within-subject development over time.” (line 317-328)</p><p>We included in the discussion some interpretation of this results.</p><p>“There are several reasons why within-participant increases in Elo across sessions were not predictive of improvements in prediction and memory. First, our estimate of Elo during each memory task was based on gameplay performance on the prior day, which may not be a precise measure of the participant’s current schema. Second, the biggest increase in prediction occurred between sessions one and two, but the session one memory-task data cannot be included in this prediction model since participants have not yet played the game (and we therefore cannot estimate their Elo). Third, we may simply be underpowered to detect within-participant effects, since we only collected data from six sessions for each subject. Despite the lack of within-subject effect, the session-level analysis provided the novel insight that the memory advantage for more-expert players may be driven by superior predictive processes during encoding.” (line 419-429)</p><disp-quote content-type="editor-comment"><p>4) Further clarifications are needed, such as the drop-off in late sessions, reasons for not looking at pupil dilation, the rationale for schema-based memory facilitation hypothesis, and presentation of RT data (see Reviewer 2's comments)</p></disp-quote><p>Presentation of RT data</p><p>Thank you for the suggestion to include the RT data. It indeed showed a similar pattern to what we observed in accuracy data, further strengthening our conclusions about the relationship between schema-consistency and memory. We’ve included a discussion about this in the results:</p><p>“In addition to recall accuracy, we looked at reaction time for placing moves at recall. We only looked at moves that were correctly recalled in each session and removed outliers with reaction times longer than 30 sec (0.6% of all the correct moves were removed this way). Similar to accuracy, we found that reaction time during retrieval was initially not related to the probability of the move (<italic>β</italic> = -30.5, <italic>t</italic> = 0.975, <italic>p</italic> = .329) but consistently faster for more schema-consistent moves in session 2 through 6 (all <italic>p</italic> &lt;.001, figure 3d). Running a mixed-effects model as for the accuracy (using linear rather than logistic regression), we found a main effect of session on reaction time (<italic>β</italic> = -156.3, <italic>t</italic> = -2.39, <italic>p</italic> = .017), such that participants were faster in later training sessions. There was no main effect of move probability (<italic>β</italic> = – 46.1, <italic>t</italic> = -0.440, <italic>p</italic> = .660) but a significant interaction between move probability and session on reaction time (<italic>β</italic> = – 71.06, <italic>t</italic> = -2.593, <italic>p</italic> = .010), with faster responses when remembering more schema-consistent moves.” (line 200-210)</p><p>We also modified figure 3 to include the figure showing the change in slope.</p><p>Drop-off in late sessions:</p><p>The reviewers are correct that, in the late sessions, move probability is less strongly related to memory accuracy and memory errors. We now statistically quantify this drop-off and discuss how participants may be changing their memory strategies in the final sessions of the experiment in order to further improve their accuracy:</p><p>“Although an overall increase across sessions was observed in both schema-consistent mistakes and the relationship between recall accuracy and move probability, these effects were significantly weaker at session 5 (for schema-consistent mistakes, <italic>t</italic> = -2.51, <italic>p</italic> = .02; for the relationship between recall accuracy and move probability, <italic>t</italic> = -3.24, <italic>p</italic> = .001), and numerically weaker at session 6 (for schema consistent mistakes, <italic>t</italic> = -1.70, <italic>p</italic> = 0.099; for the relationship between recall accuracy and move probability, <italic>t</italic> = -1.93, <italic>p</italic> = .053). One potential explanation for this drop is that people developed new strategies in later sessions to remember schema-inconsistent moves. As can be seen in figure 3b, the modeled recall accuracy for highly schema-inconsistent moves (low x values) increased from session 4 to 5 while the recall accuracy for schema-consistent moves remained relatively stable. This is consistent with the highest overall accuracy occurred in session 6 (figure 2a), suggesting that this decrease in slope does not come at a cost for memory accuracy. Note that reaction time did not show this weakening relationship with move probability in session 5 and 6, as its slope continues to decrease.” (line 225-237)</p><p>We also included a paragraph in the discussion about possible explanations for the observed effects.</p><p>“Interestingly, the relationship between recall accuracy and memory is attenuated in the last 2 sessions, driven by improved memory for schema-inconsistent moves. Expertise effects that partially extend to non-schematic situations have been previously observed; although chess experts’ memory advantage was primarily driven by very high accuracy for schema-consistent (legitimate) boards in Gobet and Waters (2003), experts also exhibited memory for random boards that was better than that of weaker players. One possibility is that experts may be able to devote fewer attentional resources to schematic moves, freeing up additional resources to handle more unusual moves. Participants in our study may have also developed an effortful strategy to remember schema-inconsistent moves (such as switching to a shape-based encoding for these moves), consistent with the longer reaction times observed for low-probability moves in later sessions.” (line 435-445)</p><p>The rationale for schema-based memory facilitation hypothesis</p><p>We modified the introduction to provide more justification for the hypothesis of schema-consistent memory benefits.</p><p>“Although previous research has sometimes found novelty-driven memory improvements for schema-inconsistent information (reviewed in Frank and Kafkas, 2021), studies of expert memory for complex memoranda such as chess boards have shown an advantage for schema-consistent stimuli (e.g., board positions from actual chess games) (Gobet and Waters, 2003). Thus, we hypothesized that the memory improvement resulting from the development of schema in 4-in-a-row should similarly be specific to moves that are schema-consistent.” (line 82-88)</p><p>Reasons for not looking at pupil dilation</p><p>The study was not designed to measure subtle changes in pupil diameter, and we have now added a paragraph about this limitation to the Discussion:</p><p>“Previous research has found a relationship between pupil dilation and surprise (e.g., Antony et al., 2021; Lavín et al., 2014; Preuschoff et al., 2011), but our study was not well-suited to measure subtle changes in pupil diameter. Studies of pupil dilation generally require tight control over the experimental stimuli, using either purely non-visual stimuli (Preuschoff et al., 2011), or by presenting luminance-controlled stimuli at fixation (Lavín et al., 2014). In our study the luminance at fixation is highly variable, since eye movements are not controlled and squares can be unoccupied (grey) or occupied by white or black pieces. Future work could attempt to study pupil dilation in this paradigm using models to control for local and global luminance (Antony et al. 2021) or by modifying the stimuli to ensure that all board spaces are isoluminant.” (Line 508-516)</p><p>That said, we did look at the time course of pupil size over time (5 sec before a move shows up and 5 sec after, downsampled to 100 Hz) when surprise (as defined by the extent to which pre-move fixations were in the incorrect location) is high (top 25%), low (bottom 25%), and medium (50% in the middle). We found that there was a consistent pattern of pupil size across trials, a ramp in size during each trial peaking about 300 ms after the presentation of the next move, and followed by a sharp constriction. This kind of decrease at event switches has also been observed at event boundaries in movies, and is hypothesized to be due to a drop in cognitive load at boundaries (Smith et al., 2006). As shown in <xref ref-type="fig" rid="sa2fig2">Author response image 2</xref>, high-surprise moves did indeed have larger pupil sizes just after the move (at 300ms) and after the constriction (at 500-800ms). However, this effect is present even before the move is shown (starting at -4000ms), suggesting that surprise may be related to pre-move attentional state or may be more likely to occur on certain kinds of boards (e.g. boards with many pieces). Although this is an interesting result, we believe that it is out of the scope for the current paper. We are conducting a follow-up study in which the move participants see is independently manipulated to have different levels of surprise, and hope to more comprehensively explore the question about pupil size and surprise in this paradigm.</p><fig id="sa2fig2" position="float"><label>Author response image 2.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82599-sa2-fig2-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>This paper develops an interesting and new experimental paradigm to investigate how schema participates in memory and helps to generate predictions, using behavioral measurements, eye movement recordings, and computational modeling. The results show the correlation between memory accuracy, game performance, and predictive eye movements, supporting that schema significantly boosts memory and guide prediction. This paper would be of potential interest to many fields, such as memory, learning, and decision-making.</p><p>We see two major strengths in the paper. First, although schema-based memory is crucial, it is very hard to study it in a natural and also controllable way in the lab. This work develops a complex game paradigm with proper difficulty levels, enabling the examination of the characteristics of the process. Second, the combination of memory behavior, eye movement, and game playing provides a comprehensive framework to tackle the question.</p><p>The major weakness of the work mainly lies in its lack of a control group, that is, subjects who neither know the rule nor play the game before. This would be important evidence to support the advantage of schema-based memory boosting. Moreover, the source of the effects needs to be further clarified using additional analyses.</p><p>Concerns:</p><p>1. Schema-based boost in memory and predictive eye movement lacks a control group who neither know the rule nor play the game before. The prediction is that the control group will show (1) worse memory; (2) their error patterns are different and unrelated to p (move).</p></disp-quote><p>Please see our response to Essential revisions comment #2.</p><disp-quote content-type="editor-comment"><p>2. Most of the correlation analyses mixed the variability levels and thus confused the source of the memory boosting effects. For example, when calculating the correlation results (Figure 2C), each data point represents a session of a participant. In this case, the source of the effect could come from either session-level variability that is due to training or participant-level variability. In fact, all the linear mixed-effect models have the same problem and need to be fixed. I would not suggest excluding the random effect for slopes since that would increase the probability of Type I error and as a consequence, the observed effect might arise from individual differences rather than experimental manipulation (see Brauer and Curtin, Psychol Methods, 2018 and Bates, arXiv, 2018 for guides). It is important to include individual-level random effects in the analysis.</p></disp-quote><p>Please see our response to Essential revisions comment #3.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>This paper by Huang and colleagues uses a simple board game, &quot;4-in-a-row,&quot; to test the relationship between schemas and episodic memory. Specifically, the goal here was to examine the way schemas can guide encoding of sequential events as the game unfolded. In sum, the authors report that memory for move sequences in the game improved with player skill, and that memory was particularly improved for schema-consistent sequences. Further, eye movements during encoding were associated with stronger memory for move sequences, which was most prevalent in expert players.</p><p>We think this study does a fine job of answering how the development of schema aid in prediction and thereby memory through use of a stimulus that is at once naturalistic but learnable by participants in laboratory time. This is a difficult set of boxes to check. While 4-in-a-row is certainly a simplistic way of testing encoding and retrieval of &quot;events,&quot; it nonetheless tests memory in a fairly rich and meaningful way compared to much existing research, especially with regard to sequential order. The approach itself strikes a really nice balance between complexity in capturing elements of naturalistic human behavior, and simplicity in terms of analyses. Overall we think this experiment is sound, and the paper is well-written.</p><p>We have some requests for expansion/clarification and a few suggestions for strengthening the paper.</p><p>1. Looking at Figure 3c and 3d, it struck us that the slope of recall accuracy increases linearly across sessions 1-4, but then drops pretty markedly to sessions 5 and 6. If things simply leveled-off or dropped slightly, it would seem less important or interesting, but the drop-off is quite stark. What could be happening here? What do the authors make of this?</p></disp-quote><p>Please see our response to Essential revisions comment #4.</p><disp-quote content-type="editor-comment"><p>2. It was actually a bit surprising to us that the authors didn't use pupillometry when evaluating surprise. Pupil dilation has been strongly linked to the constructs of surprise and prediction error, more so than gaze. We are not necessarily suggesting that the authors rerun their model using pupillometry, but some rationale for why gaze rather than pupil dilation was optimal for testing surprise in this context would help. As it stands, we felt that this disconnect left the reasoning behind the surprise model feeling unclear, and we think a more explicit discussion of this would be helpful.</p></disp-quote><p>Here, we sought to operationalize surprise in terms of prediction accuracy. High surprise means that the specific move prediction made by the participant (as measured via gaze position) was not confirmed. We have now clarified our definition of surprise in the Results:</p><p>“The second measure is <italic>surprise</italic>, which is the negative log of the proportion of fixation time spent looking at the correct next move position. A high level of surprise indicates that a participant spent very little time looking at the square where the next move ended up appearing, which indicates low prediction accuracy.” (line 366-370)</p><p>For a discussion of pupil dilation effects in the study, please see our response to Essential revisions comment #4.</p><disp-quote content-type="editor-comment"><p>3. As the authors themselves flesh out in the Discussion, there is a fair amount of inconsistency in the literature as to whether schema-consistent (or &quot;congruent,&quot; as others often say) or schema-inconsistent information provides relative a boost to episodic memory. And although we think their points related to this in the Discussion are fine, we think it would be worth laying out the reasoning for the prediction that schema-consistency should benefit memory in the Introduction. Our reasoning here is that, from our point of view, it could have easily gone either way. And we think that the field can benefit at this point from clear logic laying out predictions related to schema and memory.</p></disp-quote><p>Please see our response to Essential revisions comment #4.</p><disp-quote content-type="editor-comment"><p>4. Did the authors analyze reaction time data at all? To be clear, we are not making a strong suggestion to do so, but given links between surprise and response time variability, and the logical relationship between increasing experience and time taken to do something, it seems a logical thing to do in characterizing performance.</p></disp-quote><p>Please see our response to Essential revisions comment #4.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>This paper presents a series of analyses of the relationship between predictive schemas – representations that allow people to form predictions about events in their environment – and performance in a memory task. Participants in the experiments learned to play a novel board game over a period of several days, and also performed a memory task in which they had to recall sequences of board positions. The first time they performed the memory task they had no experience with the game, so these just looked like random configurations of black and white circles. As players became more familiar with the game, the memory performance also improved.</p><p>Several analyses dig deeper into this phenomenon, examining how participants' memory for specific board positions are related to the probability of the corresponding moves in the game, as estimated by an AI agent. This analysis shows that people have better memory for higher probability moves. By bringing another group of participants into the laboratory and performing eye tracking, it was shown that people's eyes movements also seem to be influenced by the probability of moves. Further analyses that express confidence and surprise in terms of these eye movements – how focused people seem to be on a specific position and how long they spend looking at the correct position – show that these quantities are also related to memory.</p><p>Overall, I think this is an impressive piece of work that does a nice job of exploring several questions about the nature and origins of schema-based effects on memory performance through the clever use of a novel task. However, I do think there is one substantial potential confound. As people are getting better at playing the game, it seems like one potential strategy they might use is to worry less about memorizing the board positions and instead to simply consider how they would play from that position. People following this strategy would seem to account for all of the results that are presented: it would result in a higher probability of being correct on higher probability moves, and potentially produce the associated effects involving eye-movements since those eye-movements tend to be concentrated on the high probability moves as well.</p><p>This kind of confound is likely to arise in studies looking at schema effects on memory, because if people have a schema they can use that schema to make informed guesses that are more likely to be right for schema-consistent items. However, in this setting it seems like there is actually an opportunity to address this confound directly. I think this could be done by conducting a further study in which people play from the same board positions that are used to initiate the memory recall sequences – perhaps doing so on different days so as to remove concerns about interference. By measuring the actual play sequences that people generate, it would be possible to focus the analyses on cases where the memory sequences differ from these play sequences. In fact, if the play sequences are generated the day before the memory test, the memory test could include two kinds of trials: one set where the memory sequence corresponds to that produced by the participant on the previous day, and one where it diverges. If the reported effects are observed in both of these conditions, that helps to decouple simulated play from generic schema use (that is, if a move in a memory sequence that has high probability but wasn't played by the participant the previous day is still remembered well, it provides strong support for a schema effect rather than a play-based strategy).</p></disp-quote><p>Please see our response to Essential revisions comment #1.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>About the two major comments or experiments I raised, the authors have done a fine job addressing them. They have performed a simulation analysis to exclude the alternative explanation raised in the first question. They chose to use the first session of the data as the control group to answer the second question.</p><p>Their answers are fine but I would like to clarify my original point that may have been unclear. That is, showing the learning curve rather than a single point of the control group's performance, i.e., the first session, as a control.</p></disp-quote><p>Also, in response to our request for additional clarification, an editor wrote:</p><p>(1) providing the learning curve of a control group who are naïve to game rules, instead of using only the first session of the old data as a control. The authors chose to use the first session of data as a control group to answer the second question raised by Reviewer 1. Meanwhile, to demonstrate that the memory improvement after the first gameplay task is due to schema as claimed by the authors rather than training practice, it would be helpful to show the learning curve of a control group who are naïve to game rules throughout the whole experiment, rather than only the first-day memory performance.</p><p>Our response: Providing a full learning curve for a control group presents some logistical challenges, since this would require at least three months of new data collection using our department’s shared eye-tracking equipment. There is also a more fundamental challenge, in that participants are likely to eventually learn the rules of the game through pure exposure, even without explicit instruction. We now address these issues in the Methods:</p><p>“We did not include a control group that completed six memory sessions without being told the rules of the game or playing against the AI agent. Ensuring that participants never develop a game schema would be difficult, since even without explicit instruction they could still learn the schema through implicit statistical learning or by guessing the (simple) rules of the game. Due to these challenges, we instead used the first-session performance of each participant as our no-schema control.”</p><p>We also discuss the limitations of our one-session control in our Discussion:</p><p>“Note that some of the overall accuracy increase in the memory task across sessions could be attributable to a practice effect, but general practice-related improvement does not explain the schema-related effects that we observed on individual trials.”</p><disp-quote content-type="editor-comment"><p>Reviewer #4 (Recommendations for the authors):</p><p>Huang et al. examined the influence of schemas on prediction and sequence memory for a novel board game. Participants' memory for sequences of moves was tested across several sessions as they learned the game and improved. Over the sessions, and accompanied by a skill increase, participants' memory for the sequences improved. This learning was also related to eye-movements during encoding which were predictive of memory for the sequences.</p><p>This study does an excellent job of linking schema development to prediction/attention and memory.</p><p>Comments:</p><p>In the first paragraph of the Results section, it was unclear whether during the game play task participants were provided instructions or whether they had to learn the game through some kind of trial and error. It should be specified that they were provided with rules since early in the paragraph it notes that the participants were naive to the fact that a game was being shown in the initial memory test phase.</p></disp-quote><p>Thank you for your comments. We have now clarified this in the Results section.</p><p>“In a separate game play task (occurring after the memory task on all but the last day), the player was provided with the rules of the game and played the 4-in-a-row game against an AI opponent, staircased to match the skill level of the player.”</p><disp-quote content-type="editor-comment"><p>&quot;Modeling schema-related memory improvement&quot; In this section a model is trained based on moves from a near optimal AI. A probability distribution is made for upcoming moves based on the likelihood a move would be made by a near optimal AI. This probability is interpreted to be related to the schema consistency of a move. This may be true for an expert player. However, a near optimal move may not be schema-consistent for a new player or maybe even an average player. The participant's internal schema when they are beginners and progress may not map on to the near optimal AI moves. This is an interesting analysis, but calling the near optimal AI move schema consistent just slightly seems like a miswording for me.</p></disp-quote><p>Thank you for your comments on the use of the term &quot;near-optimal AI&quot; and its relation to schema consistency. Upon reflection, we realize that describing our gameplay model as &quot;near-optimal&quot; might be misleading. Our model was trained on near-optimal gameplay generated by near-optimal AI used in van Opheusden et al. (2021). However, our model is a simplified myopic model, which only captures some of the features of the near-optimal gameplay. We have removed the words “optimal” or “near-optimal” when they are used to describe our gameplay model.</p><p>We have clarified our use of “schema consistency” in the result section.</p><p>“Here, schema consistency is used as an objective, subject-independent measure of how good a move is. Each subject will exhibit different degrees of alignment to this “ground-truth” schema.”</p><p>We agree that individual participants’ schemas (especially those of the novices) will not always match exactly with our gameplay model. This difference in schema across people is one of the things that leads to the variability in our dependent measures (like how much schema-dependent prediction they exhibit). We would also like to note that although people have different degrees of alignment to the optimal AI schema, these schemas are qualitatively the same. We’ve included a discussion of this in Method section:</p><p>“We use the model’s evaluation of each move as a measure of the schema consistency of a move, assuming that stronger and weaker players have qualitatively the same schema for what makes a good move. An alternative possibility is that individuals develop schemas that are qualitatively distinct from the gameplay model, which will be reflected in some people playing moves that have very low probability in our gameplay model. We did not find evidence for this possibility in our dataset; during the gameplay sessions, all participants tended to play moves with relatively high probability under the gameplay model (<italic>M</italic> = 0.213, range = 0.143 – 0.297, compared to a random-move baseline of 0.040). We also observed a strong correlation between Elo and this move probability measure (<italic>r</italic> = .40, <italic>p</italic> &lt;.001), showing that stronger players are more aligned with our model. Future work (with more extensive gameplay sessions) could attempt to model unique feature weights for each specific individual.”</p><disp-quote content-type="editor-comment"><p>Discussion &quot;One possibility is that their study (in which participants implicitly learned statistical dependencies between image categories presented in a continuous stream) engages a predictive process that relies on the hippocampus (Schapiro et al., 2017), creating interference between prediction and encoding processes, while the explicit schematic predictions in our study could rely on a different network such as the medial prefrontal cortex &quot; While this is a compelling assertion, can you describe anything that psychologically varies between these tasks? For example, Shapiro et al. had participants learn arbitrary statistical sequences, but here the sequences could be understood in the context of rules, goals, and progression towards goal states.</p></disp-quote><p>Thank you for your points about the cognitive difference between tasks. We have now incorporated these cognitive differences into our description of why they might rely on different neural mechanisms:</p><p>“One possibility is that their study (in which participants implicitly learned arbitrary statistical dependencies between image categories presented in a continuous stream) engages a predictive process that relies on the hippocampus (Schapiro et al., 2017), creating interference between prediction and encoding processes. On the other hand, the explicit schematic predictions in our study that are based on rules and progression towards goal states might rely on a different network such as the medial prefrontal cortex (Bonasia et al., 2018; Robin and Moscovitch, 2017; van Kesteren et al., 2012).”</p><disp-quote content-type="editor-comment"><p>Methods: During the memory task, 10 out of the 30 sequences ended in a win state. Since a win-state caps off a sequence this could be thought of as an event boundary. Was there any effect of these 10 sequences that differed from the other 20 or interacted with other effects? For example, if a win-state is an event boundary, is particularly salient, and is better remembered, then a participant merely has to reconstruct the sequence from probe to win-state, rather than remembering each move.</p></disp-quote><p>Thank you for your suggestions. We have now conducted additional analyses that indeed show that memory for sequences that ended in a win state differ from the rest of other sequences after people developed a schema. We discussed this finding in the Results:</p><p>“Out of the 30 sequences shown to participants in each session, ten of them ended with one player successfully getting four pieces in a row (more details in Methods). After learning the rules of the game, the presence of such a win could be a salient event for the participant and could lead to changes in memory performance. Indeed, we found that in sessions 2-6, memory for sequences that ended in a win state was significantly better (t = 6.67, p &lt;.001). We did not observe this pattern in the first session (before participants were taught the game rules), and actually found a marginally significant effect in the opposite direction, with worse memory for winning sequences (t = -2.01, p = .052). This result provides additional evidence that schema-related features of a sequence play a role in memory performance.”</p><disp-quote content-type="editor-comment"><p>Modeling schema-related memory improvement&quot; In this section the authors missed a period in &quot;near- optimal AI agent The model identifies&quot;</p></disp-quote><p>Fixed.</p></body></sub-article></article>