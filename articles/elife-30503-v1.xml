<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">30503</article-id><article-id pub-id-type="doi">10.7554/eLife.30503</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Exploratory search during directed navigation in <italic>C. elegans</italic> and <italic>Drosophila</italic> larva</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-47039"><name><surname>Klein</surname><given-names>Mason</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8211-077X</contrib-id><email>klein@miami.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-93715"><name><surname>Krivov</surname><given-names>Sergei V</given-names></name><email>s.krivov@leeds.ac.uk</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-53397"><name><surname>Ferrer</surname><given-names>Anggie J</given-names></name><email>aferr028@fiu.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-65878"><name><surname>Luo</surname><given-names>Linjiao</given-names></name><email>linjiao@gmail.com</email><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-93716"><name><surname>Samuel</surname><given-names>Aravinthan DT</given-names></name><email>samuel@physics.harvard.edu</email><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-89812"><name><surname>Karplus</surname><given-names>Martin</given-names></name><email>marci@tammy.harvard.edu</email><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Physics</institution><institution>University of Miami</institution><addr-line><named-content content-type="city">Coral Gables</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Astbury Centre for Structural Molecular Biology</institution><institution>University of Leeds</institution><addr-line><named-content content-type="city">Leeds</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Key Laboratory of Modern Acoustics, Ministry of Education, Department of Physics</institution><institution>Nanjing University</institution><addr-line><named-content content-type="city">Nanjing</named-content></addr-line><country>China</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Center for Brain Science, Department of Physics</institution><institution>Harvard University</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Department of Chemistry and Chemical Biology</institution><institution>Harvard University</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Laboratoire de Chimie Biophysique, ISIS</institution><institution>Université de Strasbourg</institution><addr-line><named-content content-type="city">Strasbourg</named-content></addr-line><country>France</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-4398"><name><surname>Shan</surname><given-names>Yibing</given-names></name><role>Reviewing Editor</role><aff><institution>DE Shaw Research</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>30</day><month>10</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e30503</elocation-id><history><date date-type="received" iso-8601-date="2017-07-20"><day>20</day><month>07</month><year>2017</year></date><date date-type="accepted" iso-8601-date="2017-10-11"><day>11</day><month>10</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Klein et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Klein et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-30503-v1.pdf"/><related-object ext-link-type="url" xlink:href="https://elifesciences.org/articles/e30503v1"><date date-type="v1" iso-8601-date="2017-10-30"><day>30</day><month>10</month><year>2017</year></date></related-object><abstract><object-id pub-id-type="doi">10.7554/eLife.30503.001</object-id><p>Many organisms—from bacteria to nematodes to insect larvae—navigate their environments by biasing random movements. In these organisms, navigation in isotropic environments can be characterized as an essentially diffusive and undirected process. In stimulus gradients, movement decisions are biased to drive directed navigation toward favorable environments. How does directed navigation in a gradient modulate random exploration either parallel or orthogonal to the gradient? Here, we introduce methods originally used for analyzing protein folding trajectories to study the trajectories of the nematode <italic>Caenorhabditis elegans</italic> and the <italic>Drosophila</italic> larva in isotropic environments, as well as in thermal and chemical gradients. We find that the statistics of random exploration in any direction are little affected by directed movement along a stimulus gradient. A key constraint on the behavioral strategies of these organisms appears to be the preservation of their capacity to continuously explore their environments in all directions even while moving toward favorable conditions.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>behavior</kwd><kwd>navigation</kwd><kwd>markov model</kwd><kwd>diffusion</kwd><kwd>thermotaxis</kwd><kwd>chemotaxis</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>C. elegans</italic></kwd><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>BRAIN Initiative EAGER Award</award-id><principal-award-recipient><name><surname>Samuel</surname><given-names>Aravinthan DT</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>1P01GM103770</award-id><principal-award-recipient><name><surname>Samuel</surname><given-names>Aravinthan DT</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution>CHARMM Development Project</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Karplus</surname><given-names>Martin</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Crawling <italic>Drosophila</italic> larvae and <italic>C. elegans</italic> exhibit diffusive behavior alongside directed motion, and the dynamics of this navigation can be analyzed with techniques developed in understanding protein folding, using a Markov state model.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The trajectories of small organisms often involve stochastic transitions between distinct motor states. A classic example is the swimming behavior of <italic>Escherichia coli</italic> (; <xref ref-type="bibr" rid="bib3">Berg, 1993</xref>), which is characterized by an alternating sequence of runs and tumbles. During runs, the bacteria swim in roughly straight lines, while during tumbles, the bacteria move erratically in place, ultimately picking the direction of a new run at random. The trajectories of larger animals like nematodes and insect larvae are qualitatively similar (<xref ref-type="bibr" rid="bib21">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib19">Luo et al., 2010</xref>). <italic>Caenorhabditis elegans</italic> alternate periods of forward movement with either large angle reorientation maneuvers called pirouettes or small angle turns. Crawling <italic>Drosophila</italic> larvae alternate periods of forward movement with turns (<xref ref-type="bibr" rid="bib15">Lahiri et al., 2011</xref>) where they pause forward motion and use the angle of head swings to pick a new forward orientation.</p><p><italic>C. elegans</italic> also modulates its random exploration in isotropic environments over time (<xref ref-type="bibr" rid="bib27">Wakabayashi et al., 2004</xref>; <xref ref-type="bibr" rid="bib5">Chalasani et al., 2007</xref>). When a worm is placed in a new environment, it first executes a local search, where runs are short. Over time, worms transition to a global search with longer runs. It has been suggested that the transition between local and global searching is discontinuous (<xref ref-type="bibr" rid="bib4">Calhoun et al., 2014</xref>), and that local search and global search represent two distinct behavioral states.</p><p>In stimulus gradients, bacteria, nematodes, and insect larvae bias their random walks toward favorable environments by modulating the statistics of transitions between forward-moving runs and reorientation events. For example, all three organisms exhibit longer runs when pointed toward favorable conditions. Worms and larvae further augment the time spent pointed toward favorable directions by increasing the probability of ending reorientation events with a run pointed in a favorable direction or by gradually steering runs toward favorable directions.</p><p>The navigational dynamics of worms and larvae have some parallels with the complex dynamics of a polypeptide chain navigating to the native structure of the protein to which it corresponds. Both are examples of stochastic search processes: the protein needs to fold to the correct native structure, while an organism needs to find food and favorable temperatures, for example. Neither search can be purely random, because it would not be effective. For the protein folding case, it would lead to the Levinthal paradox; that is, it would take an essentially infinite amount of time to fold, while in fact it takes on the order of seconds to minutes (<xref ref-type="bibr" rid="bib28">Zwanzig et al., 1992</xref>; <xref ref-type="bibr" rid="bib8">Karplus, 1997</xref>). The stochastic search of a protein is biased toward the native structure by the potential energy, which is encoded in the sequence as the result of evolutionary selection. The stochastic component of the biased search is necessary to avoid being trapped in local minima on the potential energy surface. Trapping in such metastable states has been observed in protein folding trajectories, where an escape is made possible only by the stochastic nature of the dynamics.</p><p>Analogous considerations apply to the navigation dynamics of worms and fly larvae. A purely random search would by very inefficient due to the large size of the space accessible in their normal environment. Thus, living organisms use cues to bias their search. An example is a temperature gradient which plays the role of the potential energy. A purely deterministic search would not be effective here either, because there can be traps (local minima) in the accessible space. These minima could have a physical origin or be due to a complex non-monotonic nature of the cues. A stochastic component in the biased search allows the organisms to overcome the trapping problem. The actual details of the navigational dynamics are specified by the neural circuitry that enervates the muscles. This is optimized by evolution, in analogy to the amino acid sequence in proteins.</p><p>The correspondence outlined above suggests that it would be of interest to see whether approaches developed for understanding protein folding dynamics can be used to study the navigational dynamics of worms and larvae. The folding dynamics can be quantitatively described as diffusion (random walk) on a free-energy landscape. In particular, the free energy, <inline-formula><mml:math id="inf1"><mml:mi>F</mml:mi></mml:math></inline-formula>, defines the equilibrium probability of the system to be found at a particular position <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>P</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, that is, the system prefers regions with low free energy. The free-energy barrier between unfolded and folded states defines the bottleneck of the folding reaction. The diffusion coefficient describes how quickly the system—whether a worm, larvae, or peptide sequence—explores the configuration space. Together, the free-energy barrier and the diffusion coefficient determine the rate of the process. Such a picture provides a simplified and intuitive, while quantitatively accurate, description of the dynamics. We note also that the free-energy landscape framework is generic and has been successfully applied to many different types of complex dynamics, for example, the dynamics of the game of chess (<xref ref-type="bibr" rid="bib13">Krivov, 2011b</xref>) or patient recovery dynamics after kidney transplant (<xref ref-type="bibr" rid="bib14">Krivov et al., 2014</xref>), as well as to protein folding.</p><p>Detailed descriptions of worm or larva dynamics (i.e. how run — turn — run — <inline-formula><mml:math id="inf3"><mml:mi mathvariant="normal">…</mml:mi></mml:math></inline-formula> sequences are chained together) are important to show how complex navigational dynamics are realized in a particular case. However, there are many variants of detailed motions, which are likely to result in very similar larger scale navigational dynamics. Thus, it is of interest to understand and accurately characterize the invariants of large-scale dynamics. It is precisely these invariants that are expected to be optimized by evolution. Moreover, a description making use of the free-energy landscape framework can provide an intuitive picture of the complex navigational dynamics as a whole, versus the localized description of dynamics. It could be used, in particular, to locate equilibrium populations, biases, and bottlenecks during the navigation toward the target in complex environments.</p><p>The free-energy landscape of a protein can be determined from long equilibrium trajectories (<xref ref-type="bibr" rid="bib11">Krivov and Karplus, 2004</xref>; <xref ref-type="bibr" rid="bib12">Krivov, 2011a</xref>; <xref ref-type="bibr" rid="bib1">Banushkina and Krivov, 2016</xref>). However, the experimental trajectories of the crawling animals treated here are too short to be considered to be at equilibrium in comparison with those in the reversible folding/unfolding of proteins at equilibrium (<xref ref-type="bibr" rid="bib26">Shaw et al., 2010</xref>). To determine the equilibrium properties, which are required for the construction of the free-energy landscape, we introduce another general approach to random dynamics, the Markov state model (MSM). This exploits the information contained in a large number of short trajectories measured under identical conditions (<xref ref-type="bibr" rid="bib16">Lane et al., 2011</xref>; <xref ref-type="bibr" rid="bib24">Rao and Caflisch, 2004</xref>; <xref ref-type="bibr" rid="bib10">Krivov et al., 2002</xref>). One refers to the dynamics as Markovian if the next crawling step of an animal depends only on its current spatial position; that is, it quickly forgets the history of its motion. A collection of short trajectories can then be used to determine a probability distribution of future positions of the animal starting from a current position. In particular, the steady state probability distribution can be determined in this way. The analysis is based on the construction of the transition probability matrix, as described in Materials and methods, where it is shown that the steady state distribution is, in fact, the equilibrium distribution for the worms. This matrix provides a complete description of the stochastic dynamics and can be used to determine long time scale behavior.</p><p>We first observed the power of this approach when investigating <italic>C. elegans</italic> trajectories in a thermal gradient, with worms placed at their cultivation temperature. It had been thought that the worms would equally avoid both lower and higher temperatures. The analysis of a large number of trajectories with the MSM showed that worms do not strictly avoid warmer temperatures, potentially uncovering a different interpretation of isothermal tracking behavior (see Results section). Encouraged by this result, we extend the protein folding approach for combining trajectories to a more general study of <italic>C. elegans</italic> and <italic>Drosophila</italic> larvae. Specifically, we employ the diffusion coefficient, <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which represents the rate of change of the mean square displacement as a function of time for the data set. For both species, in the presence of environmental gradients (e.g. thermal or chemical), it is found that <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> increases linearly with time for short times (ballistic dynamics), while it approaches a constant value at longer times (stochastic dynamics).</p><p>In what follows we investigate the behavior of <italic>C. elegans</italic> and <italic>Drosophila</italic> larvae in the presence of different environmental gradients within this framework. Given the recent interest in search strategies in the absence of information (<xref ref-type="bibr" rid="bib23">Polani, 2009</xref>; <xref ref-type="bibr" rid="bib4">Calhoun et al., 2014</xref>), we also study the motion of both species in a uniform environment (i.e. in the absence of applied gradients).</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Diffusion and search patterns under isotropic conditions</title><p>Navigation in <italic>C. elegans</italic>, <italic>Drosophila</italic>, and other organisms has been treated as a biased random walk (<xref ref-type="bibr" rid="bib3">Berg, 1993</xref>; <xref ref-type="bibr" rid="bib21">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib25">Ryu and Samuel, 2002</xref>), where animals repeatedly transition between bouts of relatively straight forward crawling (‘runs’) and distinct, often large changes in heading (‘turns’). To investigate the relationship between trajectories built in this fashion and more general phenomena of diffusion and Markovian processes, we first studied 2D free crawling behavior in both worm and larva systems in isotropic environments with no applied stimulus. These trajectories (<xref ref-type="fig" rid="fig1">Figure 1A,A’</xref>) do exhibit diffusive behavior, but do not demonstrate active movement in a particular direction, as demonstrated by their very small values for the dimensionless drift velocity (see Materials and methods).</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.30503.002</object-id><label>Figure 1.</label><caption><title>Diffusive searching in <italic>C. elegans</italic> and <italic>Drosophila</italic> larva.</title><p>(<bold>A</bold>) Sample trajectories (left) from 18 worms under isotropic conditions, for 60 min. Tracks have been shifted to all begin at the same location for clarity. A single track (red) is magnified (right) to show the abrupt changes in crawling orientation, flagged as ‘turns’ (gray circles), with comparatively straight-crawling ‘runs’ in between. Runs are characterized by their duration <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, and turns by their change in heading <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) Diffusion in the <inline-formula><mml:math id="inf8"><mml:mi>x</mml:mi></mml:math></inline-formula>- and <inline-formula><mml:math id="inf9"><mml:mi>y</mml:mi></mml:math></inline-formula>-directions and turning rate reduction over time. Worms diffuse in both directions (left), while the rate of turning events steadily decreases over 3000 s (right); it fits an exponential decay (red) with a 765 s time constant. (<bold>C</bold>) Diffusion in the <inline-formula><mml:math id="inf10"><mml:mi>x</mml:mi></mml:math></inline-formula>- and <inline-formula><mml:math id="inf11"><mml:mi>y</mml:mi></mml:math></inline-formula>-directions, splitting the time window into <inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>900</mml:mn></mml:mrow></mml:math></inline-formula> s (left) and <inline-formula><mml:math id="inf13"><mml:mrow><mml:mn>900</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1800</mml:mn></mml:mrow></mml:math></inline-formula> s (right). (<bold>A’</bold>) Sample trajectories from 25<italic> Drosophila</italic> larvae navigating under isotropic conditions for 15 min. (<bold>B’</bold>) Diffusion and turning rate over time for crawling <italic>Drosophila</italic>. <inline-formula><mml:math id="inf14"><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> reach similar values, substantially higher than <italic>C. elegans</italic> (left), and the turning rate does not show a dramatic drop, instead increasing for the first ~2 min. before stabilizing. (<bold>C’</bold>) Split <inline-formula><mml:math id="inf16"><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> graphs covering the first (<inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>450</mml:mn></mml:mrow></mml:math></inline-formula> s) and second (<inline-formula><mml:math id="inf19"><mml:mrow><mml:mn>450</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>900</mml:mn></mml:mrow></mml:math></inline-formula> s) halves of the trajectory time, converging to similar values in each. Results for (<bold>B,C</bold>) are based on seven experiments, with 56 tracks and a total of 1608 turns. Results for (<bold>B’,C’</bold>) are based on 30 experiments, with 434 tracks and 11,294 turns. The directions of overall population drift for (<bold>A,A’</bold>) are indicated by green arrows, with the numbers indicating the dimensionless drift velocity, in this case extremely small (see Materials and methods). Error bars for (<bold>B,B’</bold>) are <inline-formula><mml:math id="inf20"><mml:mo>±</mml:mo></mml:math></inline-formula>s.e.m.</p><p><supplementary-material id="fig1sdata1"><object-id pub-id-type="doi">10.7554/eLife.30503.004</object-id><label>Figure 1—source data 1.</label><caption><title>Values and s.e.m. for diffusion coefficient vs. time plots</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-30503-fig1-data1-v1.zip"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-30503-fig1-v1"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.30503.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Consecutive run durations for individual <italic>C. elegans</italic> tracks under isotropic conditions.</title><p>56 sequences are shown (red), with a blue vertical line indicating the change point, found by maximizing the difference in average <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> below and above a particular time in the experiment. Change point times have a wide range, in many cases occurring near the end of trajectories, indicating a steady rise with high variance, rather than an abrupt transition in mean run duration. We note that in more than half the tracks, the difference in mean before and after the change point is less than twice the standard deviation of the data prior to the change point.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-30503-fig1-figsupp1-v1"/></fig></fig-group><p>We observed that worm and larvae dynamics at small time scales are close to deterministic—that is, the animals maintain direction and their trajectories are smooth. At longer time scales movement becomes stochastic or diffusive; in other words, the dynamics in configuration space can be approximately described as Markovian. To estimate the time scale of the transition between these regimes, we inspect the time dependence of the diffusion coefficient, <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, defined in Materials and methods (<xref ref-type="fig" rid="fig1">Figure 1B,B’</xref>). For deterministic ballistic dynamics in the <inline-formula><mml:math id="inf23"><mml:mi>x</mml:mi></mml:math></inline-formula> direction, <inline-formula><mml:math id="inf24"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf25"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> increases linearly with time, while for diffusive dynamics, <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is constant. <xref ref-type="fig" rid="fig1">Figure 1B,B’</xref> suggest that the transition from deterministic to diffusive regimes happens at <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∼</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> s.</p><p><italic>C. elegans</italic> crawling under isotropic conditions drastically reduce their turning rate (i.e. make longer runs) throughout an experiment (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), as also noted in previous work (<xref ref-type="bibr" rid="bib4">Calhoun et al., 2014</xref>); here, it is studied over a substantially longer time of ~1 hr. We define the turning rate of a population as the total number of turns made, divided by the total time all animals put together spend in forward-crawling runs (i.e. the total time where animals could have turned, but did not—see Materials and methods for details). In particular, the turning rate decreases exponentially with a time constant of approximately 800 s (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Inspecting the run durations for individual worm trajectories (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), we do not see strong evidence of the turning rate undergoing an abrupt transition from local to global searching, but rather a regular decline, which in the population averages to steady exponential decay.</p><p>Turning rate has a clear connection to the dynamics, as frequent turns within a random walk will reduce the diffusion rate. Noting the dramatic reduction in turning rate in <xref ref-type="fig" rid="fig1">Figure 1B</xref>, we determined the diffusion coefficients in <inline-formula><mml:math id="inf28"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf29"><mml:mi>y</mml:mi></mml:math></inline-formula> from the first part of the experiment, <inline-formula><mml:math id="inf30"><mml:mn>0</mml:mn></mml:math></inline-formula> to 900 s, and then separately for the next 900 s. As expected, the diffusion coefficients converge to different limiting values, with diffusion during the second part of the experiments nearly double that during the first part. This dependence agrees with the simple mean free path estimate of the diffusion coefficient <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf32"><mml:mi>v</mml:mi></mml:math></inline-formula> is the crawling speed, and the mean turn rate <inline-formula><mml:math id="inf33"><mml:mi>R</mml:mi></mml:math></inline-formula> in the first half of the trajectory is approximately double of that in the second part. We note that <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> are essentially identical throughout the experiments, only diverging slightly at longer times where the uncertainty has increased (fewer individual tracks last up to 1000 s).</p><p><italic>Drosophila</italic> larvae under isotropic conditions (<xref ref-type="fig" rid="fig1">Figure 1A’–C’</xref>) exhibit similar behavior in terms of trajectory structure (<xref ref-type="fig" rid="fig1">Figure 1A’</xref>) and the transition to a diffusive regime, but they do not exhibit a marked decline in turning rate (<xref ref-type="fig" rid="fig1">Figure 1B’</xref>), which stabilizes after only a few minutes and remains constant throughout their searching behavior. Thus, the transition from local to global searching does not appear on the ~15-min time scales we measured for larva behavior. Given the relatively constant turning rate, it follows that diffusion coefficients calculated for the first (<inline-formula><mml:math id="inf36"><mml:mn>0</mml:mn></mml:math></inline-formula> to 450 s) and second (450 to 900 s) halves of the experiments converge to similar values. Further, in this larger data set <inline-formula><mml:math id="inf37"><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> are essentially identical throughout (<xref ref-type="fig" rid="fig1">Figure 1C’</xref>). We also note that while <inline-formula><mml:math id="inf39"><mml:mi>D</mml:mi></mml:math></inline-formula> and the turning rate both increase in the first 100 s, the system has not entered a diffusive regime, and the increase in <inline-formula><mml:math id="inf40"><mml:mi>D</mml:mi></mml:math></inline-formula> can be attributed to the ballistic character of the trajectories at this stage.</p><p>Taken together, these data show similarity between <italic>C. elegans</italic> and <italic>Drosophila</italic> in the makeup of run — turn — run — <inline-formula><mml:math id="inf41"><mml:mi mathvariant="normal">…</mml:mi></mml:math></inline-formula> sequences in crawling behavior, and both conform to a model of diffusion at longer times, but the two animals differ in their long time scale search strategies.</p></sec><sec id="s2-2"><title>Diffusion persists alongside thermotaxis and chemotaxis</title><p>We next sought to determine what happens to the behavior as animals navigate while exposed to a stimulus along one axis of the crawling surface. Is the diffusive behavior maintained along the axis perpendicular to the stimulus gradient while motion along the parallel axis transforms into a new mode? To investigate this, we observed both <italic>C. elegans</italic> and <italic>Drosophila</italic> navigating along a 1D spatial temperature gradient. The apparatus (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), as previously described (<xref ref-type="bibr" rid="bib9">Klein et al., 2015</xref>), maintains a stable linear gradient in <inline-formula><mml:math id="inf42"><mml:mi>x</mml:mi></mml:math></inline-formula>, and constant temperature in the <inline-formula><mml:math id="inf43"><mml:mi>y</mml:mi></mml:math></inline-formula>-direction for fixed <inline-formula><mml:math id="inf44"><mml:mi>x</mml:mi></mml:math></inline-formula>-values. Worms cultivated at 15°C and placed in a gradient centered at 20°C exhibited negative thermotaxis (also called ‘cryophilic’ behavior), while larvae placed at 17.5°C in the same gradient crawled away from cold conditions, exhibiting positive thermotaxis to a preferred range that is independent of cultivation conditions.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.30503.005</object-id><label>Figure 2.</label><caption><title>Diffusion and navigation in <italic>C. elegans</italic> and <italic>Drosophila</italic> thermotaxis.</title><p>(<bold>A</bold>) Schematic of the apparatus (left), where animals crawl atop an agar substrate while exposed to a 1D linear temperature gradient. Sample thermotaxis trajectories (right) from 18 <italic>C. elegans</italic> crawling for 60 min and 25 <italic>Drosophila</italic> crawling for 15 min, where the red dots indicate the starting position for all trajectories. Worms start at 20°C and exhibit negative thermotaxis, moving toward their 15°C cultivation temperature, while larvae start at 17.5°C and crawl away from aversive cold temperatures. The wheel indicates labels for crawling direction ranges, with octant 1 parallel to the gradient heading toward warmer temperatures and octant 5 heading antiparallel towards cooler temperatures. (<bold>B</bold>) Diffusion over time (left) in the <italic>x</italic>- and <italic>y</italic>-directions for <italic>C. elegans</italic>. <inline-formula><mml:math id="inf45"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> throughout the experiment, indicating diminished, but highly significant, diffusion along the navigation direction. The average turning rate (upper right) diminishes over time, as in the <xref ref-type="fig" rid="fig1">Figure 1B,B’</xref> isotropic case; the turning rate ratio <inline-formula><mml:math id="inf46"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (lower right) remains below 1 and nearly constant throughout the experiment. (<bold>C</bold>) Equilibrium probability distributions in the <italic>x</italic> (top) and <italic>y</italic> (bottom) directions (both use the same scale), extrapolated from empirical trajectories using the Markov state model (MSM). The lag time used is 750 s. Red lines are smoothed traces to guide the eye. The free-energy picture of equilibrium conditions (right), to place the analysis in context with the protein folding analysis tools employed here. Lower-free energy corresponds to higher population as <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>P</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where here <inline-formula><mml:math id="inf48"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>B’</bold>) Diffusion, and turning rates for <italic>Drosophila</italic> larvae, also showing <inline-formula><mml:math id="inf49"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The average turning rate stabilizes early, and the turning rate ratio <inline-formula><mml:math id="inf50"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, the primary behavioral modulation underlying thermotaxis, remains nearly constant. (<bold>C’</bold>) Equilibrium probability distributions for <italic>Drosophila</italic> larvae (left), and the corresponding free-energy landscape (right), determined from the MSM. Analysis is based on 30 experiments, 131 tracks, and 3061 turns for worms, and 20 experiments, 303 tracks, and 7771 turns for larvae. The directions of overall population drift for (<bold>A</bold>) are indicated by green arrows, with the numbers indicating the dimensionless drift velocity, approximately 10 times greater than for the isotropic navigation cases (see Materials and methods). Error bars are <inline-formula><mml:math id="inf51"><mml:mo>±</mml:mo></mml:math></inline-formula>s.e.m. where shown; in the other cases the error bar size is smaller than the line thickness, and therefore not seen.</p><p><supplementary-material id="fig2sdata1"><object-id pub-id-type="doi">10.7554/eLife.30503.007</object-id><label>Figure 2—source data 1.</label><caption><title>Values and s.e.m. for diffusion coefficient vs. time plots</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-30503-fig2-data1-v1.zip"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-30503-fig2-v1"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.30503.006</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Reversability, detailed balance, and sampling intervals in the Markov state model approach.</title><p>(<bold>A</bold>) Analysis of the reversibility of the dynamics. Fluxes in positive (red) and negative (blue dashed) directions are shown. The topmost lines show <inline-formula><mml:math id="inf52"><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf53"><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; the lines are almost identical. The lowermost lines show <inline-formula><mml:math id="inf54"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf55"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>; the lines agree, with residual difference due to statistical noise. The intermediate lines show that increasing the statistics decreases the noise and improves the agreement. (<bold>B</bold>) Equilibrium probability distribution as a function of lag time used to construct the MSM. With increasing lag time the dynamics becomes more Markovian and the determined equilibrium probabilities converge to the limiting one.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-30503-fig2-figsupp1-v1"/></fig></fig-group><p><xref ref-type="fig" rid="fig2">Figure 2B,B’</xref> shows significant diffusion in both <inline-formula><mml:math id="inf57"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf58"><mml:mi>y</mml:mi></mml:math></inline-formula> directions, even though both types of animals are migrating along the <inline-formula><mml:math id="inf59"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis. This suggests that navigation does not eliminate stochasticity along the axis of purposeful navigation. That is, the animals conduct a random search in all directions irrespective of whether they have adopted a target direction. At the same time, the limiting values of <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> are not equal, with diffusion in the <inline-formula><mml:math id="inf62"><mml:mi>y</mml:mi></mml:math></inline-formula>-direction greater than diffusion in the <inline-formula><mml:math id="inf63"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction. This suggests that there is a tradeoff between searching along an axis and purposeful travel in that direction.</p><p>Both animals move along the <inline-formula><mml:math id="inf64"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction toward more favorable environmental conditions by biasing their turning rates. For example, worms undergoing negative thermotaxis reorient their crawling direction more frequently when heading up the temperature gradient, and maintain longer runs when heading down the gradient (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, lower right). Thermotaxing larvae, similarly, have a higher turning rate when crawling toward aversive colder conditions, and maintain longer runs crawling up the gradient (<xref ref-type="fig" rid="fig2">Figure 2B’</xref>, lower right). As was true for isotropic conditions, worms decrease their turning rate over time (and larvae maintain a stable level). However, both animals maintain an approximately constant ratio between toward-warm turning rates and toward-cold turning rates. That is, the primary navigational bias that produces thermotaxis is not altered, even at long time scales. Importantly, this supports the method of using early behavior to model long term behavior.</p><p>When the dynamics are Markovian, as described in the Introduction, one can use short experimental trajectories to determine the long term equilibrium probability distribution of worms and larvae. <xref ref-type="fig" rid="fig2">Figure 2C,C’</xref> shows the distribution of both types of animals along the <inline-formula><mml:math id="inf65"><mml:mi>x</mml:mi></mml:math></inline-formula>- and <inline-formula><mml:math id="inf66"><mml:mi>y</mml:mi></mml:math></inline-formula>-axes, as determined using the Markov state model (see Materials and methods). Distributions are computed using lag times near the transition to diffusive dynamics. As lag time increases, the dynamics become more Markovian and the distributions converge to the limiting distribution(<xref ref-type="fig" rid="fig2s1"> Figure 2—figure supplement 1B</xref>). The remaining fluctuations are due to relatively small statistics at long times. The limiting distribution along the <inline-formula><mml:math id="inf67"><mml:mi>y</mml:mi></mml:math></inline-formula> axis, <inline-formula><mml:math id="inf68"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is constant (up to fluctuations around the boundaries), in agreement with absence of any stimulus along <inline-formula><mml:math id="inf69"><mml:mi>y</mml:mi></mml:math></inline-formula>. For worms, the limiting distribution along the <inline-formula><mml:math id="inf70"><mml:mi>x</mml:mi></mml:math></inline-formula> axis, <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is approximately constant for <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>19.5</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>C and then decreases exponentially for <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:msup><mml:mn>19.5</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>C. For larvae, the distribution is approximately constant for <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:msup><mml:mn>17.5</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>C and then decreases exponentially for <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>17.5</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>C. This demonstrates that the worms and larvae diffuse towards <inline-formula><mml:math id="inf76"><mml:mi>x</mml:mi></mml:math></inline-formula> values of their preference, as well as remaining in the regions of their preference, if they are already there. We indicate a more direct connection to the protein folding methods by showing the <inline-formula><mml:math id="inf77"><mml:mi>x</mml:mi></mml:math></inline-formula>-distributions in terms of the free energy <inline-formula><mml:math id="inf78"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2C,C’</xref>, right).</p><p>To confirm that these crawling dynamics are not unique to a temperature response, we examined navigation of <italic>C. elegans</italic> exposed to a chemical stimulus corresponding to a 1D linear salt concentration gradient, previously described in <xref ref-type="bibr" rid="bib20">Luo et al. (2014)</xref>. Worms chemotax either up or down salt gradients, depending on the baseline salt level (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). At low baseline salt concentrations (25 mM), worms move toward higher salt levels, and at high concentrations (75 mM) they crawl down the gradient toward lower salt levels. As with thermal navigation, worm behavior converges to diffusive behavior at longer times (<xref ref-type="fig" rid="fig3">Figure 3B</xref>), and local searching transitions gradually to global searching via a reduced turning rate (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). The Markov state model predicts equilibrium population distributions consistent with the net motion of the population (<xref ref-type="fig" rid="fig3">Figure 3D</xref>).</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.30503.008</object-id><label>Figure 3.</label><caption><title>Diffusion and navigation in <italic>C. elegans</italic> salt chemotaxis.</title><p>(<bold>A</bold>) Sample trajectories (25 worms each) of crawling on an agar substrate with a salt concentration gradient increasing toward the right, under a low-salt concentration baseline (25 mM, left) and high-salt concentration baseline (75 mM, right). The wheel indicates labels for crawling direction ranges, with octant 1 pointing directly to higher salt concentrations and octant 5 directly toward low concentrations. The directions of overall population drift are indicated by green arrows, with the numbers indicating the dimensionless drift velocity, approximately 10 times greater than for the isotropic navigation cases (see Materials and methods). (<bold>B</bold>) Diffusion over time in the <inline-formula><mml:math id="inf79"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf80"><mml:mi>y</mml:mi></mml:math></inline-formula> directions for a low-salt baseline (left) and high-salt baseline (right). Error bars are <inline-formula><mml:math id="inf81"><mml:mo>±</mml:mo></mml:math></inline-formula>s.e.m. (<bold>C</bold>) Average turning rate across all crawling directions (top) decays over time for both low and high baseline salt concentration gradients. The turning rate ratio between octant 5 (toward lower concentration) and octant 1 (toward higher concentration) does not stabilize as clearly as for thermotaxis, likely indicative of a reduced level of movement toward preferred salt conditions and a smaller data set. Error bars are <inline-formula><mml:math id="inf82"><mml:mo>±</mml:mo></mml:math></inline-formula>s.e.m. (<bold>D</bold>) Equilibrium probability distributions for worms in low- (left) and high (right)-salt concentration environments, determined by using the Markov state model (MSM). Analysis is based on 14 experiments, 126 tracks, and 4422 turns for low-salt concentration, and 16 experiments, 166 tracks, and 6159 turns for high-salt concentration.</p><p><supplementary-material id="fig3sdata1"><object-id pub-id-type="doi">10.7554/eLife.30503.009</object-id><label>Figure 3—source data 1.</label><caption><title>Values and s.e.m. for diffusion coefficient vs. time plots</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-30503-fig3-data1-v1.zip"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-30503-fig3-v1"/></fig><p>Despite relatively deterministic movement along one axis, the equilibrium distributions show that the worms and larvae are dispersed over a significant range. This enables them to avoid local 'traps’ arising from chemical or thermal cues.</p></sec><sec id="s2-3"><title><italic>C. elegans</italic> diffuse towards warmer temperatures during isothermal tracking</title><p>As noted in the Introduction, we applied our diffusion analysis to the distinctive <italic>C. elegans</italic> behavior of isothermal tracking (<xref ref-type="bibr" rid="bib7">Hedgecock and Russell, 1975</xref>; <xref ref-type="bibr" rid="bib18">Luo et al., 2006</xref>). In this behavior, worms placed near their original cultivation temperature (<inline-formula><mml:math id="inf83"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) will follow isotherms with extreme precision, indicating a high degree of sensitivity in their thermal response. Since the temperature in our 1D thermal gradient is approximately constant in the <inline-formula><mml:math id="inf84"><mml:mi>y</mml:mi></mml:math></inline-formula>-direction, we expect to observe qualitatively different trajectories, with more prominent movement in that direction, and very limited navigation in the perpendicular <inline-formula><mml:math id="inf85"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction.</p><p>Although we do observe greater diffusion and navigation in the <inline-formula><mml:math id="inf86"><mml:mi>y</mml:mi></mml:math></inline-formula>-direction (<xref ref-type="fig" rid="fig4">Figure 4B</xref>), an examination of <inline-formula><mml:math id="inf87"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction navigation revealed a significant asymmetry. The long-term equilibrium position probability distributions (<inline-formula><mml:math id="inf88"><mml:msub><mml:mi>P</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf89"><mml:msub><mml:mi>P</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>) are approximately constant in <inline-formula><mml:math id="inf90"><mml:mi>y</mml:mi></mml:math></inline-formula>, but not in <inline-formula><mml:math id="inf91"><mml:mi>x</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). In particular, there is an extremely low probability for the worms to be in the <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>T</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> region, and a substantially higher probability for them to occupy warmer regions. This suggests either a mild preference for <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, specific aversion to <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>T</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, or some other disruption of the traditional interpretation of isothermal tracking behavior.</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.30503.010</object-id><label>Figure 4.</label><caption><title>Isothermal tracking in <italic>C. elegans</italic> includes diffusion in the <inline-formula><mml:math id="inf95"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction.</title><p>(<bold>A</bold>) Experimental trajectories under temperature gradient conditions, with worms initially placed at their cultivation temperature of 15°C. Colors are used for the reader to distinguish between individual tracks. (<bold>B</bold>) The diffusion constants along the <inline-formula><mml:math id="inf96"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf97"><mml:mi>y</mml:mi></mml:math></inline-formula> directions, with <inline-formula><mml:math id="inf98"><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> dominating, but <inline-formula><mml:math id="inf99"><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> highly significant. Error bars are <inline-formula><mml:math id="inf100"><mml:mo>±</mml:mo></mml:math></inline-formula>s.e.m. (<bold>C</bold>) MSM-generated equilibrium probabilities along the temperature gradient (<inline-formula><mml:math id="inf101"><mml:mi>x</mml:mi></mml:math></inline-formula> axis) showing the long time scale distribution of the population of worms, and perpendicular to the temperature gradient along isotherms (<inline-formula><mml:math id="inf102"><mml:mi>y</mml:mi></mml:math></inline-formula> axis). In <inline-formula><mml:math id="inf103"><mml:mi>x</mml:mi></mml:math></inline-formula>, worms avoid regions with low temperatures, but freely explore regions with higher temperature; in <inline-formula><mml:math id="inf104"><mml:mi>y</mml:mi></mml:math></inline-formula>, worms explore the axis with approximately equal probability. Analysis based on 25 experiments, with 688 tracks.</p><p><supplementary-material id="fig4sdata1"><object-id pub-id-type="doi">10.7554/eLife.30503.011</object-id><label>Figure 4—source data 1.</label><caption><title>Values and s.e.m. for diffusion coefficient vs. time plots</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-30503-fig4-data1-v1.zip"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-30503-fig4-v1"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We studied the navigation of <italic>C. elegans</italic> and <italic>Drosophila</italic> larvae in both isotropic environments and stimulus gradients to assess the relationship between directed movement toward target conditions and the diffusive properties of the overall search patterns. We also studied the negative thermotaxis of <italic>C. elegans</italic> moving toward colder temperatures and the positive thermotaxis of <italic>Drosophila</italic> larvae moving towards warmer temperatures. These behavioral modes represent the better studied forms of thermotaxis in these animals. We then examined the ascent and descent of <italic>C. elegans</italic> moving toward preferred salt concentrations.</p><p>Treating the motion of small animals in isotropic environments as diffusive random walks is an established method (<xref ref-type="bibr" rid="bib2">Berg and Brown, 1972</xref>; <xref ref-type="bibr" rid="bib3">Berg, 1993</xref>), even yielding analytic solutions under certain conditions (<xref ref-type="bibr" rid="bib17">Lovely and Dahlquist, 1975</xref>). Here, we have focused on diffusion along perpendicular axes, and used Markov analysis techniques to investigate the combination of exploratory diffusion and targeted navigation. We found that the general framework of diffusion and Markov processes can be used to combine a large number of short trajectories obtained under identical conditions in both isotropic environments and in the presence of stimulus gradients. This approach made it possible for the first time to quantify the statistics of a random search that is concurrent with steady progression towards favorable environments. In both animals and across stimulus types, we found importantly that random exploration in all directions and across all time scales is remarkably robust to progression in a selected direction in a graded environment. That is, the animals undergo diffusive motion (as opposed to ballistic) in both the <inline-formula><mml:math id="inf105"><mml:mi>x</mml:mi></mml:math></inline-formula>- and <inline-formula><mml:math id="inf106"><mml:mi>y</mml:mi></mml:math></inline-formula>-directions, even during persistent navigation along the <inline-formula><mml:math id="inf107"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis. The diffusion coefficients <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> are not equal during thermotaxis and chemotaxis, but <inline-formula><mml:math id="inf110"><mml:mi>D</mml:mi></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf111"><mml:mi>t</mml:mi></mml:math></inline-formula> plots become approximately constant, indicating a diffusive regime. When nematodes and insect larvae encounter stimuli that bias their random walks in specific directions, the effectiveness of random searching is largely unaffected either parallel or orthogonal to the direction of motion. In these animals, a constraint on the mechanisms that generate navigation in a preferred direction appears to be the preservation of the statistics of random exploration in all directions across time scales. Analysis of the entropy of trajectory configurations, which avoids settling into traps, provides information that is not readily apparent in conventional metrics of drift rates and stimulus-evoked turn rates. Moreover, the approach makes possible large-scale and long time descriptions of the navigational dynamics beyond those available from the standard localized run — turn — run measurements.</p><p>We found, in both animal model systems investigated here, that the transition from ballistic to diffusive motion during navigation occurs over a ~1000 s time scale, which is longer than most behavior experiments in studies of these animals. Experiments are typically limited by animals leaving the arena, especially for faster moving late instar <italic>Drosophila</italic> larvae. Combined with the observation, in broad agreement with recent results from other experimenters (<xref ref-type="bibr" rid="bib4">Calhoun et al., 2014</xref>), that the rate of behavioral transitions changes over time (especially in worms), it is possible that further behavioral transitions at longer time scales have yet to observed. Experimental techniques that enable long-time-scale measurements may be essential for uncovering a more complete picture of the behavior in these animal systems. This would also enable further testing of the probability distributions predicted by the Markov state model.</p><p>Additionally, we note that the transition to more global searching (lower turning rate) occurs at very different times in the two model systems under consideration here. We speculate that the much greater mass of the second instar <italic>Drosophila</italic> larva would allow it to delay the transition, as it can afford more time without food. While the global search transition in larvae was not observed on the time scales used here, further experiments could illuminate the issue, such as comparisons in turning rates between fed and starved larvae of the same age—starved animals effectively perform searches, even if not placed in a behavioral arena.</p><p>By drawing distinctions between the behavioral transition rates in different crawling directions, we note that the overall changes in the average turning rate (<xref ref-type="fig" rid="fig2">Figure 2</xref>) are not accompanied by changes in the ratios of the turning rates. This means the navigational bias is preserved, while other aspects of search strategy are modulated. However, the navigational dynamics studied in the cases presented here are rather simple. Consequently, this work may be considered a proof of principle of the utility of employing methods developed for protein folding to understand the behavior of worms and larvae. It will be of interest to study their navigational dynamics in complex conditions with various obstacles, which in the language of protein folding give rise to both enthalpic and entropic barriers. It is important to know where the bottlenecks are in the navigational dynamics towards the target. How the dynamics changes with time (i.e. learning or habituation) in response to different stimuli and different cultivation conditions should also be examined. We expect that to study such questions the description of the dynamics as diffusion on a free-energy landscape will be useful for obtaining a global understanding of the processes involved.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Worm and larva handling</title><p>Adult N2 wild-type worms were raised on agar plates (<inline-formula><mml:math id="inf112"><mml:mrow><mml:mn>2</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula> wt./vol) with NGM food. For each experiment, around 20 worms (each approximately 1 mm long) were selected under a dissection microscope, rinsed, and placed with a pipette onto the behavior arena in small water droplets. Upon evaporation of the water droplets, the worms began crawling and their movement was recorded.</p><p>Wild-type (Canton-S) adult flies were kept in cages (Genesee Scientific) with 6 cm Petri dishes with grape juice and yeast food, with new plates exchanged every 24 hr. Larvae were collected from the plates, with second instar larvae selected by age (24-72 hr AEL) and spiracle development of each individual. The typical larva size at this instar is 1-2 mm in length. For each experiment, between 20 and 30 larvae were rinsed in distilled water, allowed to crawl on agar gel (3% wt./vol) for 5 min, then placed in the behavior arena for video tracking of navigation.</p><p>For both worms and larvae, all animals for the experiment are placed on the agar surface together, near the center, with approximately 1 cm separating each animal. Given the small fraction of the available space taken up by the animals, collisions are infrequent. Importantly, when a collision does occur, the event is not flagged as a turn for the purposes of turning rate computation (see below), so if the collision rate decreases over time as animals spread out, the extracted turning rate is not affected.</p></sec><sec id="s4-2"><title>Video acquisition and behavioral analysis</title><p>A 5 MP CCD camera placed above the arena recorded crawling, with images acquired at 5 Hz. Movies were processed using the MAGAT Analyzer software (<xref ref-type="bibr" rid="bib6">Gershow et al., 2012</xref>), which extracts the position and shape of each animal. Subsequent analysis using custom MATLAB scripts (source code download available, <xref ref-type="supplementary-material" rid="scode1">Source code 1</xref>) segmented the path of each crawling animal into tracks comprised of a sequence of runs (periods of straight crawling) and turns (cessation of forward movement and orientation to a new direction). The run-turn-run-… sequences were used for navigation analysis, and the raw trajectories used for diffusion and Markov state model distributions.</p><p>The turning rate describes how often animals alter their crawling direction, and changing turning rate as a function of crawling direction is the primary behavioral modulation that leads to navigation. We compute the turning rate in the following way. In a given time window, animal <inline-formula><mml:math id="inf113"><mml:mi>i</mml:mi></mml:math></inline-formula> makes <inline-formula><mml:math id="inf114"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> turns, with periods of forward crawling (‘runs’) in between, each run <inline-formula><mml:math id="inf115"><mml:mi>j</mml:mi></mml:math></inline-formula> of duration <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig1">Figure 1A,A’</xref>). The total time spent during runs for this animal is <inline-formula><mml:math id="inf117"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The turning rate for the individual animal <inline-formula><mml:math id="inf118"><mml:mi>i</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf119"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and the total turning rate for the population during this window is <inline-formula><mml:math id="inf120"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf122"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. In particular, <inline-formula><mml:math id="inf123"><mml:mi>T</mml:mi></mml:math></inline-formula> is the total time where an animal could have turned but failed to do so. In <xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig3">3</xref> turning rates <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>R</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> are computed for different crawling directions, where only turns and runs that occur within the specified cone of crawling direction are counted.</p><p>For a navigation strength metric, we used the dimensionless drift velocity, <inline-formula><mml:math id="inf125"><mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>&gt;</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>v</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the average velocity of the population in the <inline-formula><mml:math id="inf126"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction, normalized by the overall average speed during runs. This serves as a dimensionless measure of navigation strength. A value of +1 would correspond to every animal crawling directly along the <inline-formula><mml:math id="inf127"><mml:mrow><mml:mo>+</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> direction for the entire experiment; a value of <inline-formula><mml:math id="inf128"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> would correspond to <inline-formula><mml:math id="inf129"><mml:mrow><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> direction crawling; and a value of <inline-formula><mml:math id="inf130"><mml:mn>0</mml:mn></mml:math></inline-formula> would indicate no movement at all, or no bias in crawling direction. For both worms and fly larvae, isotropic conditions result in a very small (order 0.01) navigation strength, while in thermal or chemical gradient environments the navigation strength is of order <inline-formula><mml:math id="inf131"><mml:mn>0.1</mml:mn></mml:math></inline-formula>. This metric is also employed in (<xref ref-type="bibr" rid="bib19">Luo et al., 2010</xref>; <xref ref-type="bibr" rid="bib6">Gershow et al., 2012</xref>; <xref ref-type="bibr" rid="bib9">Klein et al., 2015</xref>). Green arrows in <xref ref-type="fig" rid="fig1">Figure 1A,A’</xref>, <xref ref-type="fig" rid="fig2">Figure 2A</xref>, and <xref ref-type="fig" rid="fig3">Figure 3A</xref> indicate the navigation strengths for the full population measured.</p></sec><sec id="s4-3"><title>Stimulus delivery</title><p>For both <italic>Drosophila</italic> larvae and adult <italic>C. elegans</italic>, a temperature-controlled 2D platform established a 1D linear spatial gradient. A large aluminum metal block one each side was maintained at a constant temperature. The cold side was maintained with two thermoelectric coolers (TECs) under PID control, with chilled circulating liquid (a water and anti-freeze mixture) acting as a dissipation reservoir. The hot side was maintained using resistive heaters under PID control. A thin aluminum slab connected the two blocks, which established a smooth linear gradient in the <inline-formula><mml:math id="inf132"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction and constant temperature for fixed <inline-formula><mml:math id="inf133"><mml:mi>x</mml:mi></mml:math></inline-formula> in the <inline-formula><mml:math id="inf134"><mml:mi>y</mml:mi></mml:math></inline-formula>-direction. An agar gel (3% wt./vol. for larvae, 2% wt./vol. for worms) was placed on the slab. For larva experiments, the temperature across the gel ranged from 13°C to 21°C (17°C in the center, 0.36°C/cm gradient); for worm experiments, the temperature range was 18°C to 22°C (20°C in the center, 0.19°C/cm gradient).</p><p>For <italic>C. elegans</italic> experiments using salt concentration gradients, agar gels were poured in two stages to establish a stable, linear salt concentration gradient. We followed the procedure outlined in <xref ref-type="bibr" rid="bib20">Luo et al. (2014)</xref>.</p></sec><sec id="s4-4"><title>Determination of steady state and equilibrium probabilities</title><p>The equilibrium probabilities (<inline-formula><mml:math id="inf135"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf136"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) were computed using the Markov state model (MSM) formalism. To this end, the coordinate (either <inline-formula><mml:math id="inf137"><mml:mi>x</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf138"><mml:mi>y</mml:mi></mml:math></inline-formula>) was partitioned into bins with size <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and the numbers of transitions from bin <inline-formula><mml:math id="inf140"><mml:mi>i</mml:mi></mml:math></inline-formula> to bin <inline-formula><mml:math id="inf141"><mml:mi>j</mml:mi></mml:math></inline-formula> after time interval <inline-formula><mml:math id="inf142"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf143"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) were computed. The transition probability matrix <inline-formula><mml:math id="inf144"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the probability to move to bin <inline-formula><mml:math id="inf145"><mml:mi>j</mml:mi></mml:math></inline-formula> from bin <inline-formula><mml:math id="inf146"><mml:mi>i</mml:mi></mml:math></inline-formula> after time interval <inline-formula><mml:math id="inf147"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> was estimated as <inline-formula><mml:math id="inf148"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. This matrix describes the time evolution of the probability vector as <inline-formula><mml:math id="inf149"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The stationary, steady state probability distribution <inline-formula><mml:math id="inf150"><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is computed as the solution of equation <inline-formula><mml:math id="inf151"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>We have also checked whether reversibility and detailed balance are satisfied. First, we computed the steady state fluxes in positive <inline-formula><mml:math id="inf152"><mml:mrow><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and negative <inline-formula><mml:math id="inf153"><mml:mrow><mml:mrow><mml:msup><mml:mi>J</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> directions, where <inline-formula><mml:math id="inf154"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the steady state flux from bin <inline-formula><mml:math id="inf155"><mml:mi>j</mml:mi></mml:math></inline-formula> to bin <inline-formula><mml:math id="inf156"><mml:mi>i</mml:mi></mml:math></inline-formula>. The fluxes agree with high accuracy (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>), meaning that the net flux is zero and we can consider the steady state probability as the equilibrium probability.</p><p>The detailed balance, is a more stringent condition, where the fluxes between any two bins must be equal <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Due to the limited statistics, and thus higher noise, direct comparison of the fluxes between bins is not informative. We compared a related quantity —the steady state fluxes in positive <inline-formula><mml:math id="inf158"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and negative <inline-formula><mml:math id="inf159"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> directions, restricted to transitions to or from a particular node (<inline-formula><mml:math id="inf160"><mml:mi>a</mml:mi></mml:math></inline-formula>). The fluxes between bin <inline-formula><mml:math id="inf161"><mml:mi>x</mml:mi></mml:math></inline-formula> and bin <inline-formula><mml:math id="inf162"><mml:mi>a</mml:mi></mml:math></inline-formula> are proportional to the derivatives <inline-formula><mml:math id="inf163"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>x</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf164"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>x</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and hence from <inline-formula><mml:math id="inf165"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> it follows that <inline-formula><mml:math id="inf166"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig2">Figure 2</xref> supplemental A compares <inline-formula><mml:math id="inf167"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf168"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for e.g., <inline-formula><mml:math id="inf169"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Increasing statistics by considering all the bins in <inline-formula><mml:math id="inf170"><mml:mrow><mml:mn>1.5</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2.5</mml:mn></mml:mrow></mml:math></inline-formula> improves the agreement.</p><p>The sampling interval (the lag time) <inline-formula><mml:math id="inf171"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> should be chosen sufficiently large so that the dynamics become Markovian. <xref ref-type="fig" rid="fig2">Figure 2</xref> supplemental B shows how with increasing lag time the determined equilibrium probabilities converge to the limiting one.</p><p>Inclusion of other parameters such as the body angle and whether the animals were stationary or moving did not significantly change the results.</p></sec><sec id="s4-5"><title>Determination of diffusion coefficients</title><p>For flat free-energy profiles, with no drift term, <inline-formula><mml:math id="inf172"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mi>const</mml:mi></mml:mrow></mml:math></inline-formula>, the diffusion coefficient can be estimated as <inline-formula><mml:math id="inf173"><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. For free-energy profiles with constant drift term, <inline-formula><mml:math id="inf174"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf175"><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf176"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the averages of the corresponding displacements after the time interval <inline-formula><mml:math id="inf177"><mml:mi>t</mml:mi></mml:math></inline-formula>. The statistical uncertainties were estimated by bootstrapping.</p></sec><sec id="s4-6"><title>Change-point detection in <italic>C. elegans</italic> trajectories</title><p>The change points in <xref ref-type="fig" rid="fig1">Figure 1</xref> (supplemental) were computed using the ‘findchangepts’ function in MATLAB, which detects the point in a sequence with the maximum difference between the means of values below the point and the mean of the values above the point.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors thank Kevin Collins and Sheyum Syed for comments on the manuscript. ADTS is supported by grants from the NSF and NIH. MKa is partially supported by the CHARMM Development Project.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Software, Formal analysis, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Formal analysis, Investigation, Visualization</p></fn><fn fn-type="con" id="con4"><p>Formal analysis, Investigation</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Supervision, Funding acquisition, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Formal analysis, Supervision, Investigation, Writing—original draft, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="scode1"><object-id pub-id-type="doi">10.7554/eLife.30503.012</object-id><label>Source code 1.</label><caption><title>Scripts used in conjunction with MAGAT Analyzer software</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-30503-code1-v1.zip"/></supplementary-material><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.30503.013</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-30503-transrepform-v1.pdf"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Banushkina</surname> <given-names>PV</given-names></name><name><surname>Krivov</surname> <given-names>SV</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Optimal reaction coordinates</article-title><source>Wiley Interdisciplinary Reviews: Computational Molecular Science</source><volume>6</volume><fpage>748</fpage><lpage>763</lpage><pub-id pub-id-type="doi">10.1002/wcms.1276</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname> <given-names>HC</given-names></name><name><surname>Brown</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Chemotaxis in <italic>Escherichia coli</italic> analysed by three-dimensional tracking</article-title><source>Nature</source><volume>239</volume><fpage>500</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1038/239500a0</pub-id><pub-id pub-id-type="pmid">4563019</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Berg</surname> <given-names>HC</given-names></name></person-group><year iso-8601-date="1993">1993</year><source>Random Walks in Biology</source><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calhoun</surname> <given-names>AJ</given-names></name><name><surname>Chalasani</surname> <given-names>SH</given-names></name><name><surname>Sharpee</surname> <given-names>TO</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Maximally informative foraging by Caenorhabditis elegans</article-title><source>eLife</source><volume>3</volume><elocation-id>e04220</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.04220</pub-id><pub-id pub-id-type="pmid">25490069</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chalasani</surname> <given-names>SH</given-names></name><name><surname>Chronis</surname> <given-names>N</given-names></name><name><surname>Tsunozaki</surname> <given-names>M</given-names></name><name><surname>Gray</surname> <given-names>JM</given-names></name><name><surname>Ramot</surname> <given-names>D</given-names></name><name><surname>Goodman</surname> <given-names>MB</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Dissecting a circuit for olfactory behaviour in <italic>Caenorhabditis elegans</italic></article-title><source>Nature</source><volume>450</volume><fpage>63</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1038/nature06292</pub-id><pub-id pub-id-type="pmid">17972877</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gershow</surname> <given-names>M</given-names></name><name><surname>Berck</surname> <given-names>M</given-names></name><name><surname>Mathew</surname> <given-names>D</given-names></name><name><surname>Luo</surname> <given-names>L</given-names></name><name><surname>Kane</surname> <given-names>EA</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Controlling airborne cues to study small animal navigation</article-title><source>Nature Methods</source><volume>9</volume><fpage>290</fpage><lpage>296</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1853</pub-id><pub-id pub-id-type="pmid">22245808</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedgecock</surname> <given-names>EM</given-names></name><name><surname>Russell</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Normal and mutant thermotaxis in the nematode <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>72</volume><fpage>4061</fpage><lpage>4065</lpage><pub-id pub-id-type="doi">10.1073/pnas.72.10.4061</pub-id><pub-id pub-id-type="pmid">1060088</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karplus</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The Levinthal paradox: yesterday and today</article-title><source>Folding and Design</source><volume>2</volume><fpage>S69</fpage><lpage>S75</lpage><pub-id pub-id-type="doi">10.1016/S1359-0278(97)00067-9</pub-id><pub-id pub-id-type="pmid">9269572</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname> <given-names>M</given-names></name><name><surname>Afonso</surname> <given-names>B</given-names></name><name><surname>Vonner</surname> <given-names>AJ</given-names></name><name><surname>Hernandez-Nunez</surname> <given-names>L</given-names></name><name><surname>Berck</surname> <given-names>M</given-names></name><name><surname>Tabone</surname> <given-names>CJ</given-names></name><name><surname>Kane</surname> <given-names>EA</given-names></name><name><surname>Pieribone</surname> <given-names>VA</given-names></name><name><surname>Nitabach</surname> <given-names>MN</given-names></name><name><surname>Cardona</surname> <given-names>A</given-names></name><name><surname>Zlatic</surname> <given-names>M</given-names></name><name><surname>Sprecher</surname> <given-names>SG</given-names></name><name><surname>Gershow</surname> <given-names>M</given-names></name><name><surname>Garrity</surname> <given-names>PA</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sensory determinants of behavioral dynamics in <italic>Drosophila</italic> thermotaxis</article-title><source>PNAS</source><volume>112</volume><fpage>E220</fpage><lpage>E229</lpage><pub-id pub-id-type="doi">10.1073/pnas.1416212112</pub-id><pub-id pub-id-type="pmid">25550513</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krivov</surname> <given-names>SV</given-names></name><name><surname>Chekmarev</surname> <given-names>SF</given-names></name><name><surname>Karplus</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Potential energy surfaces and conformational transitions in biomolecules: a successive confinement approach applied to a solvated tetrapeptide</article-title><source>Physical Review Letters</source><volume>88</volume><elocation-id>038101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.88.038101</pub-id><pub-id pub-id-type="pmid">11801090</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krivov</surname> <given-names>SV</given-names></name><name><surname>Karplus</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Hidden complexity of free energy surfaces for peptide (protein) folding</article-title><source>PNAS</source><volume>101</volume><fpage>14766</fpage><lpage>14770</lpage><pub-id pub-id-type="doi">10.1073/pnas.0406234101</pub-id><pub-id pub-id-type="pmid">15466711</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krivov</surname> <given-names>SV</given-names></name></person-group><year iso-8601-date="2011">2011a</year><article-title>The free energy landscape analysis of protein (FIP35) folding dynamics</article-title><source>The Journal of Physical Chemistry B</source><volume>115</volume><fpage>12315</fpage><lpage>12324</lpage><pub-id pub-id-type="doi">10.1021/jp208585r</pub-id><pub-id pub-id-type="pmid">21902225</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krivov</surname> <given-names>SV</given-names></name></person-group><year iso-8601-date="2011">2011b</year><article-title>Optimal dimensionality reduction of complex dynamics: the chess game as diffusion on a free-energy landscape</article-title><source>Physical Review E</source><volume>84</volume><elocation-id>011135</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.84.011135</pub-id><pub-id pub-id-type="pmid">21867141</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krivov</surname> <given-names>SV</given-names></name><name><surname>Fenton</surname> <given-names>H</given-names></name><name><surname>Goldsmith</surname> <given-names>PJ</given-names></name><name><surname>Prasad</surname> <given-names>RK</given-names></name><name><surname>Fisher</surname> <given-names>J</given-names></name><name><surname>Paci</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Optimal reaction coordinate as a biomarker for the dynamics of recovery from kidney transplant</article-title><source>PLoS Computational Biology</source><volume>10</volume><elocation-id>e1003685</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003685</pub-id><pub-id pub-id-type="pmid">24967678</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lahiri</surname> <given-names>S</given-names></name><name><surname>Shen</surname> <given-names>K</given-names></name><name><surname>Klein</surname> <given-names>M</given-names></name><name><surname>Tang</surname> <given-names>A</given-names></name><name><surname>Kane</surname> <given-names>E</given-names></name><name><surname>Gershow</surname> <given-names>M</given-names></name><name><surname>Garrity</surname> <given-names>P</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Two alternating motor programs drive navigation in <italic>Drosophila</italic> larva</article-title><source>PLoS One</source><volume>6</volume><elocation-id>e23180</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0023180</pub-id><pub-id pub-id-type="pmid">21858019</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lane</surname> <given-names>TJ</given-names></name><name><surname>Bowman</surname> <given-names>GR</given-names></name><name><surname>Beauchamp</surname> <given-names>K</given-names></name><name><surname>Voelz</surname> <given-names>VA</given-names></name><name><surname>Pande</surname> <given-names>VS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Markov state model reveals folding and functional dynamics in ultra-long MD trajectories</article-title><source>Journal of the American Chemical Society</source><volume>133</volume><fpage>18413</fpage><lpage>18419</lpage><pub-id pub-id-type="doi">10.1021/ja207470h</pub-id><pub-id pub-id-type="pmid">21988563</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lovely</surname> <given-names>PS</given-names></name><name><surname>Dahlquist</surname> <given-names>FW</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Statistical measures of bacterial motility and chemotaxis</article-title><source>Journal of Theoretical Biology</source><volume>50</volume><fpage>477</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1016/0022-5193(75)90094-6</pub-id><pub-id pub-id-type="pmid">1094203</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname> <given-names>L</given-names></name><name><surname>Clark</surname> <given-names>DA</given-names></name><name><surname>Biron</surname> <given-names>D</given-names></name><name><surname>Mahadevan</surname> <given-names>L</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Sensorimotor control during isothermal tracking in <italic>Caenorhabditis elegans</italic></article-title><source>Journal of Experimental Biology</source><volume>209</volume><fpage>4652</fpage><lpage>4662</lpage><pub-id pub-id-type="doi">10.1242/jeb.02590</pub-id><pub-id pub-id-type="pmid">17114399</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname> <given-names>L</given-names></name><name><surname>Gershow</surname> <given-names>M</given-names></name><name><surname>Rosenzweig</surname> <given-names>M</given-names></name><name><surname>Kang</surname> <given-names>K</given-names></name><name><surname>Fang-Yen</surname> <given-names>C</given-names></name><name><surname>Garrity</surname> <given-names>PA</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Navigational decision making in <italic>Drosophila</italic> thermotaxis</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>4261</fpage><lpage>4272</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4090-09.2010</pub-id><pub-id pub-id-type="pmid">20335462</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname> <given-names>L</given-names></name><name><surname>Wen</surname> <given-names>Q</given-names></name><name><surname>Ren</surname> <given-names>J</given-names></name><name><surname>Hendricks</surname> <given-names>M</given-names></name><name><surname>Gershow</surname> <given-names>M</given-names></name><name><surname>Qin</surname> <given-names>Y</given-names></name><name><surname>Greenwood</surname> <given-names>J</given-names></name><name><surname>Soucy</surname> <given-names>ER</given-names></name><name><surname>Klein</surname> <given-names>M</given-names></name><name><surname>Smith-Parker</surname> <given-names>HK</given-names></name><name><surname>Calvo</surname> <given-names>AC</given-names></name><name><surname>Colón-Ramos</surname> <given-names>DA</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dynamic encoding of perception, memory, and movement in a <italic>C. elegans</italic> chemotaxis circuit</article-title><source>Neuron</source><volume>82</volume><fpage>1115</fpage><lpage>1128</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.05.010</pub-id><pub-id pub-id-type="pmid">24908490</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierce-Shimomura</surname> <given-names>JT</given-names></name><name><surname>Morse</surname> <given-names>TM</given-names></name><name><surname>Lockery</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>The fundamental role of pirouettes in <italic>Caenorhabditis elegans</italic> chemotaxis</article-title><source>Journal of Neuroscience</source><volume>19</volume><fpage>9557</fpage><lpage>9569</lpage><pub-id pub-id-type="pmid">10531458</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierce-Shimomura</surname> <given-names>JT</given-names></name><name><surname>Dores</surname> <given-names>M</given-names></name><name><surname>Lockery</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Analysis of the effects of turning bias on chemotaxis in <italic>C. elegans</italic></article-title><source>Journal of Experimental Biology</source><volume>208</volume><fpage>4727</fpage><lpage>4733</lpage><pub-id pub-id-type="doi">10.1242/jeb.01933</pub-id><pub-id pub-id-type="pmid">16326954</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Polani</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Information: currency of life?</article-title><source>HFSP Journal</source><volume>3</volume><fpage>307</fpage><lpage>316</lpage><pub-id pub-id-type="doi">10.2976/1.3171566</pub-id><pub-id pub-id-type="pmid">20357888</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname> <given-names>F</given-names></name><name><surname>Caflisch</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The protein folding network</article-title><source>Journal of Molecular Biology</source><volume>342</volume><elocation-id>299</elocation-id><lpage>306</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2004.06.063</pub-id><pub-id pub-id-type="pmid">15313625</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname> <given-names>WS</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Thermotaxis in <italic>Caenorhabditis elegans</italic> analyzed by measuring responses to defined Thermal stimuli</article-title><source>Journal of Neuroscience</source><volume>22</volume><fpage>5727</fpage><lpage>5733</lpage><pub-id pub-id-type="pmid">12097525</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shaw</surname> <given-names>DE</given-names></name><name><surname>Maragakis</surname> <given-names>P</given-names></name><name><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name><name><surname>Piana</surname> <given-names>S</given-names></name><name><surname>Dror</surname> <given-names>RO</given-names></name><name><surname>Eastwood</surname> <given-names>MP</given-names></name><name><surname>Bank</surname> <given-names>JA</given-names></name><name><surname>Jumper</surname> <given-names>JM</given-names></name><name><surname>Salmon</surname> <given-names>JK</given-names></name><name><surname>Shan</surname> <given-names>Y</given-names></name><name><surname>Wriggers</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Atomic-level characterization of the structural dynamics of proteins</article-title><source>Science</source><volume>330</volume><fpage>341</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1126/science.1187409</pub-id><pub-id pub-id-type="pmid">20947758</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wakabayashi</surname> <given-names>T</given-names></name><name><surname>Kitagawa</surname> <given-names>I</given-names></name><name><surname>Shingai</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Neurons regulating the duration of forward locomotion in <italic>Caenorhabditis elegans</italic></article-title><source>Neuroscience Research</source><volume>50</volume><fpage>103</fpage><lpage>111</lpage><pub-id pub-id-type="doi">10.1016/j.neures.2004.06.005</pub-id><pub-id pub-id-type="pmid">15288503</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zwanzig</surname> <given-names>R</given-names></name><name><surname>Szabo</surname> <given-names>A</given-names></name><name><surname>Bagchi</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Levinthal's paradox</article-title><source>PNAS</source><volume>89</volume><fpage>20</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1073/pnas.89.1.20</pub-id><pub-id pub-id-type="pmid">1729690</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.30503.014</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Shan</surname><given-names>Yibing</given-names></name><role>Reviewing Editor</role><aff><institution>DE Shaw Research</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Exploratory search during directed navigation in <italic>C. elegans</italic> and <italic>Drosophila</italic> larva&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, and the evaluation has been overseen by a Reviewing Editor and K VijayRaghavan as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>In this manuscript, the authors attempted to apply the framework of diffusion processes and Markov State Models (MSMs) to analyze the navigational dynamics of <italic>C. elegans</italic> and <italic>Drosophila</italic> larva in an isotropic environment and environments with temperature or salt concentration gradients. They found that in the absence of external stimuli, both organisms follow deterministic dynamics at small time scales, while switch to stochastic (or diffusive) dynamics at long time scales. It was further shown that the introduction of temperature or chemical stimuli has little impact on the diffusive random motion, even though worms eventually navigate towards the favorable environments. Overall, the results provide new insights in understanding navigational dynamics of different organisms and point at possibilities of applying methodologies of analyzing protein folding simulations to these navigational trajectories.</p><p>Essential revisions:</p><p>The analogy made between the navigation organisms and protein folding should be better explained in the text, especially in the introduction part. The manuscript will be stronger if the authors can elaborate further the link between the search process approaching to non-equilibrium steady state, and the free energy landscape of protein folding, beyond stating that &quot;the navigational dynamics of worms and larvae have some parallels with the complex dynamics of a polypeptide chain navigating to the native structure of the protein to which it corresponds. Both dynamics are stochastic, both need to avoid traps due to local minima, and both were developed by evolution. Hence it is of interest to see whether approaches developed for understanding protein folding dynamics can be used to study the navigational dynamics of worms and larvae.…&quot; Protein folding free energy landscape is rugged and contains numerous metastable states leading to the separation of timescales. For the navigational dynamics of worms, are there also metastable states along the direction of the gradient? Judging from <xref ref-type="fig" rid="fig2">Figure 2C and C</xref>' (right panel), it seems that a number of metastable regions do exist. If so, what are the features of these states?</p><p>The manuscript needs to further demonstrate the Markovian nature of the studied diffusive and thus the applicability of MSM analysis? When MSMs are applied to protein folding, it is implied that the detailed balance is satisfied due to the reversibility of molecular dynamics simulations. Is this the case also for worms' navigational trajectories? When the authors calculate the transition counts, do they observe a symmetric pattern? In particular, do they observe substantially more counts moving forward than backward along the stimulus gradient (e.g. the first panel in <xref ref-type="fig" rid="fig2">Figure 2C</xref>)? If their data is largely deviated from the detailed balance, the authors may not obtain faithful estimation of the equilibrium populations.</p><p>It would be great if the authors can provide evidence to show that, as stated in the manuscript, there are no active movements. For example, histograms of displacements showing in average there is no net movement will serve this purpose.</p><p>The organisms or active particles do reveal biased movements in the short time scale (ballistic motions). The authors should comment on why no biased movements appear in the long time scale (no stimulus), even though there is basically no energetic constraint for the active particles.</p><p><italic>C. elegans</italic> and <italic>Drosophila</italic> larva display different behaviors in their navigational dynamics. For example, the transition from local to global search for <italic>C. elegans</italic> occurs at ~900s (with turn rate reduced by half), while this transition occurs at a longer timescale (relatively constant turn rate). From the biological point of view, could the authors provide some explanation?</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.30503.015</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Improve the explanation of the analogy between navigating animals and protein folding.</p></disp-quote><p>We have expanded our Introduction section with an additional two paragraphs that make more explicit the connection between protein folding and the navigational dynamics of the two invertebrate systems. We have added more specific examples of traps and free energy landscapes, and noted that this framework has been applied to other systems as well (Introduction, fourth, fifth and sixth paragraphs).</p><disp-quote content-type="editor-comment"><p>2) Demonstrate in more detail that Markovian description is applicable</p></disp-quote><p>We have expanded the Materials and methods section to make the Markovian formulation clearer and shown how to obtain steady state probabilities. In addition (and this is not required for Markovian behavior), we demonstrate that detailed balance is satisfied, which means that equilibrium probabilities are obtained from the analysis. New text in the Materials and methods section explains how this was done by looking at fluxes between bins, and a new figure panel (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplemental 1A</xref>) visualizes it (subsection “Determination of steady state and equilibrium probabilities”, second paragraph; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><disp-quote content-type="editor-comment"><p>3) Evidence of “no active movement” under isotropic conditions</p><p>4) Comment on why no biased movement appears at long time scales</p></disp-quote><p>For all figure panels that show representative trajectories we have added a green arrow that indicates the drift velocity of the population in the x-direction. This denotes a dimensionless drift velocity, normalized to the average speed of animals, and gives the strength/efficiency of navigation. Details of how this is computed (this metric has been used in other work, which we have cited) is included in Materials and methods. We note here that under isotropic conditions the navigation strength is approximately 10x weaker than during thermotaxis or chemotaxis. Individual animals may show biased movement, but the population on average does not (subsection “Diffusion and search patterns under isotropic conditions”, first paragraph; subsection “Video acquisition and behavioral analysis”, last paragraph and <xref ref-type="fig" rid="fig1">Figures 1</xref>, <xref ref-type="fig" rid="fig2">2</xref>, <xref ref-type="fig" rid="fig3">3</xref> and legends).</p><disp-quote content-type="editor-comment"><p>5) Local → Global search transitions in worms vs. larvae</p></disp-quote><p>While we claim that this transition is not as abrupt as previously thought, it is true that it is not observed during the ~1000 s time frame of our larva experiments. We suspect this could be mainly due to much greater mass of larvae compared to worms, and have added this speculation as a paragraph in the Discussion section, along with an idea of how this could be measured in <italic>Drosophila</italic> with systematically starved animals (Discussion, fourth paragraph).</p></body></sub-article></article>