<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">70129</article-id><article-id pub-id-type="doi">10.7554/eLife.70129</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Advance</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Subpopulations of neurons in lOFC encode previous and current rewards at time of choice</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-237538"><name><surname>Hocker</surname><given-names>David L</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3091-421X</contrib-id><email>dh148@nyu.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-3699"><name><surname>Brody</surname><given-names>Carlos D</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4201-561X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-214065"><name><surname>Savin</surname><given-names>Cristina</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-237572"><name><surname>Constantinople</surname><given-names>Christine M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4435-4460</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Center for Neural Science, New York University</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Princeton Neuroscience Institute, Princeton University</institution><addr-line><named-content content-type="city">Princeton</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Department of Molecular Biology, Princeton University</institution><addr-line><named-content content-type="city">Princeton</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Howard Hughes Medical Institute, Princeton University</institution><addr-line><named-content content-type="city">Princeton</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution>Center for Data Science, New York University</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Salinas</surname><given-names>Emilio</given-names></name><role>Reviewing Editor</role><aff><institution>Wake Forest School of Medicine</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>de Lange</surname><given-names>Floris P</given-names></name><role>Senior Editor</role><aff><institution>Radboud University</institution><country>Netherlands</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>25</day><month>10</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e70129</elocation-id><history><date date-type="received" iso-8601-date="2021-05-14"><day>14</day><month>05</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-10-20"><day>20</day><month>10</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Hocker et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Hocker et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-70129-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-70129-figures-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="article-reference" xlink:href="10.7554/eLife.49744"/><abstract><p>Studies of neural dynamics in lateral orbitofrontal cortex (lOFC) have shown that subsets of neurons that encode distinct aspects of behavior, such as value, may project to common downstream targets. However, it is unclear whether reward history, which may subserve lOFC’s well-documented role in learning, is represented by functional subpopulations in lOFC. Previously, we analyzed neural recordings from rats performing a value-based decision-making task, and we documented trial-by-trial learning that required lOFC (Constantinople et al., 2019). Here, we characterize functional subpopulations of lOFC neurons during behavior, including their encoding of task variables. We found five distinct clusters of lOFC neurons, either based on clustering of their trial-averaged peristimulus time histograms (PSTHs), or a feature space defined by their average conditional firing rates aligned to different task variables. We observed weak encoding of reward attributes, but stronger encoding of reward history, the animal’s left or right choice, and reward receipt across all clusters. Only one cluster, however, encoded the animal’s reward history at the time shortly preceding the choice, suggesting a possible role in integrating previous and current trial outcomes at the time of choice. This cluster also exhibits qualitatively similar responses to identified corticostriatal projection neurons in a recent study (Hirokawa et al., 2019), and suggests a possible role for subpopulations of lOFC neurons in mediating trial-by-trial learning.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>orbitofrontal cortex</kwd><kwd>decision-making</kwd><kwd>sequential bias</kwd><kwd>clustering</kwd><kwd>generalized linear model</kwd><kwd>learning</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Rat</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>R00MH111926</award-id><principal-award-recipient><name><surname>Constantinople</surname><given-names>Christine M</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>R01MH125571</award-id><principal-award-recipient><name><surname>Savin</surname><given-names>Cristina</given-names></name><name><surname>Constantinople</surname><given-names>Christine M</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000879</institution-id><institution>Alfred P. Sloan Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Constantinople</surname><given-names>Christine M</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution>Klingenstein-Simons Fellowship Award in Neuroscience</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Constantinople</surname><given-names>Christine M</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1922658</award-id><principal-award-recipient><name><surname>Savin</surname><given-names>Cristina</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A distinct subpopulation of neurons in the rat orbitofrontal cortex encodes reward history at the time of choice, providing a potential neural substrate by which reward history may influence decisions.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Previous experience can profoundly influence subsequent behavior and choices. In trial-based tasks, the effects of previous choices and outcomes on subsequent ones are referred to as ‘sequential effects,’ and while they are advantageous in dynamic environments, they produce suboptimal biases when outcomes on each trial are independent. The orbitofrontal cortex (OFC) has been implicated in updating behavior based on previous experience, particularly when task contingencies are partially observable (<xref ref-type="bibr" rid="bib53">Rushworth et al., 2011</xref>; <xref ref-type="bibr" rid="bib58">Stalnaker et al., 2014</xref>; <xref ref-type="bibr" rid="bib69">Wallis, 2007</xref>; <xref ref-type="bibr" rid="bib72">Wilson et al., 2014</xref>). However, it is unclear whether behavioral flexibility in OFC is mediated by dedicated subpopulations of neurons exhibiting distinct encoding and/or connectivity. We previously trained rats on a value-based decision-making task, in which they chose between explicitly cued, guaranteed and probabilistic rewards on each trial (<xref ref-type="bibr" rid="bib9">Constantinople et al., 2019b</xref>; <xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>). Despite the fact that outcomes were independent on each trial, we observed several distinct sequential effects that contributed to behavioral variability. Optogenetic perturbations of the lateral orbitofrontal cortex (lOFC) eliminated one particular sequential effect, an increased willingness to take risks following risky wins, but spared other types of trial-by-trial learning, such as spatial ‘win-stay/lose-switch’ biases. We interpreted this data as evidence that (1) different sequential effects may be mediated by distinct neural circuits and (2) lOFC promotes learning of abstract biases that reflect the task structure (here, biases for the risky option), but not spatial ones (<xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>).</p><p>Electrophysiological recordings from lOFC during this task revealed encoding of reward history and reward outcomes on each trial at the population level, which could in principle support sequential effects (<xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>). Recent studies of rodent OFC have suggested that despite the apparent heterogeneity of neural responses in prefrontal cortex, neurons can be grouped into distinct clusters that exhibit similar task-related responses and, in some cases, project to a common downstream target (<xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>; <xref ref-type="bibr" rid="bib36">Namboodiri et al., 2019</xref>). In light of these results, we hypothesized that reward history might be encoded by a distinct cluster of neurons in lOFC. This would suggest that the lOFC-dependent sequential effect we observed (an increased willingness to take risks following risky wins) may derive from a subpopulation of neurons encoding reward history, and may potentially project to a common downstream target.</p><p>Here, we analyzed an electrophysiological dataset from lOFC during a task in which independent and variable sensory cues conveyed dissociable reward attributes on each trial (reward probability and amount; <xref ref-type="bibr" rid="bib9">Constantinople et al., 2019b</xref>; <xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>). Our previous analysis investigated single unit responses for sensitivity to task parameters, and here we found that clustering of lOFC neurons based on either their trial-averaged peristimulus time histograms (PSTHs), or a feature space defined by their average conditional firing rates aligned to different task variables (<xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>), both revealed five clusters of neurons with different response profiles. We exploited the temporal variability of task events to fit a generalized linear model (GLM) to lOFC firing rates, generating a rich description of the encoding of various task variables over time in individual neurons. All the clusters exhibited weak encoding of reward attributes, and stronger encoding of reward history, the animal’s left or right choice, and reward receipt. Encoding of these variables was broadly distributed across clusters. Only one cluster, however, encoded the animal’s reward history at the time shortly preceding the choice. This distinct encoding was observable by three independent metrics (coefficient of partial determination, mutual information, and discriminability or <inline-formula><mml:math id="inf1"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>) and two separate clustering methods. Intriguingly, this cluster exhibited qualitatively similar responses to identified corticostriatal cells in a previous study (<xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>), and also exhibited the strongest encoding of reward outcomes, suggesting that these neurons are well-situated to integrate previous and current reward experience. We hypothesize that this subpopulation of neurons, which were identifiable based on their temporal response profiles alone, may mediate sequential learning effects by integrating previous and current trial outcomes at the time of choice.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>Rats’ behavior on this task has been previously described (<xref ref-type="bibr" rid="bib9">Constantinople et al., 2019b</xref>; <xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>). Briefly, rats initiated a trial by poking their nose in a central nose port (<xref ref-type="fig" rid="fig1">Figure 1A–C</xref>). They were then presented with a series of pseudo-randomly timed light flashes, the number of which conveyed information about reward probability on each trial. Simultaneously, they were presented with randomly timed auditory clicks, the rate of which conveyed the volume of water reward (6–48 µl) baited on each side. After a cue period of <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>2.5</mml:mn><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, rats reported their choice by poking in one of the two side ports. Reward volume and probability of reward (<inline-formula><mml:math id="inf3"><mml:mi>p</mml:mi></mml:math></inline-formula>) were randomly chosen on each trial. On each trial, the left or right port was randomly designated as risky (<inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) or safe (<inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). Well-trained rats tended to choose the side offering the greater subjective value, and trial history effects contributed to behavioral variability (<xref ref-type="bibr" rid="bib9">Constantinople et al., 2019b</xref>; <xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>). We analyzed 659 well-isolated single-units in the lOFC with minimum firing rates of 1 Hz, obtained from tetrode recordings (<xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Task description and PSTH clustering.</title><p>Single units in lOFC belong to clusters with distinct temporal response profiles. (<bold>A</bold>) Behavioral task: rats chose between a guaranteed and probabilistic water reward on each trial, that could each be one of four water volumes. Rats were well-trained and tended to choose the option with the greater subjective value. Reward probability and volume were cued by visual flashes and auditory click rates, respectively. (<bold>B</bold>) Mapping between the visual flashes/auditory clicks and reward attributes. (<bold>C</bold>) Range of reward attributes. (<bold>D</bold>) Cluster-specific, mean responses of the trial-averaged, z-scored PSTHs. Error bars denote s.e.m. (<bold>E</bold>). Z-scored PSTHs for neurons in each cluster, sorted by time to peak within each cluster. Colored bars on the left indicate the cluster identities from panel D. Panels A-C reproduced and modified from <xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Clustering aligned to different task events.</title><p>PSTH-based clustering of responses, aligned to different events in the task. (<bold>A-B</bold>) Results aligned to exiting the center port. (<bold>C-D</bold>) Results aligned to choice.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig1-figsupp1-v2.tif"/></fig></fig-group><sec id="s2-1"><title>Single units in lOFC belong to clusters with distinct temporal response profiles</title><p>To characterize the temporal dynamics of the neural responses during this task, we performed k-means clustering on trial-averaged PSTHs (‘PSTH clustering’), aligned to trial initiation. We used the gap statistic (<xref ref-type="bibr" rid="bib65">Tibshirani et al., 2001</xref>), which quantifies the improvement in cluster quality with additional clusters relative to a null distribution (Materials and methods), to choose a principled number of clusters, and identified five distinct clusters of responses (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). Each cluster has a stereotyped period of elevated activity during the task: at trial start, during the cue period, and at or near reward delivery, with the largest cluster (cluster 3) having activity just before the rat entered the reward port (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Cluster two is the only cluster that exhibited persistent activity during the cue period. These data indicate that despite the well-documented heterogeneity of neural responses in prefrontal cortex, responses in lOFC belonged to one of a relatively small, distinct set of temporal response profiles aligned to different task events.</p><p>A recent study in rat lOFC similarly found discrete clusters of neural responses by clustering the conditional firing rates of neurons for different task-related variables (‘conditional clustering’) (<xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>). We sought to compare results from clustering on PSTHs and conditional firing rates. Therefore, we generated conditional response profiles for each neuron (<xref ref-type="fig" rid="fig2">Figure 2B</xref>; Materials and methods), and performed clustering on these conditional responses via the same procedure. This also revealed five distinct clusters that exhibited qualitatively similar temporal response profiles as the clusters that were based on the average PSTHs (<xref ref-type="fig" rid="fig2">Figure 2C–E</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). Moreover, clusters 2 and 3 were comprised of highly similar groups of neurons across both procedures, where similarity was quantified by the consistency of being labeled in a given cluster across clustering approaches (<xref ref-type="fig" rid="fig2">Figure 2E</xref>, 66% overlap of cluster 2 neurons and 70% of cluster three neurons). This indicates that neurons in these two clusters are robustly identified by either their temporal response profiles or their encoding of task variables (<xref ref-type="fig" rid="fig2">Figure 2E</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Conditional feature space clustering.</title><p>(<bold>A</bold>) Feature-conditioned PSTHs of an example neuron. The average z-scored firing rate in each gray time window comprises an element in the feature space. (<bold>B</bold>) Feature space for conditional clustering for the sample neuron from A. The average firing rate for each condition is concatenated to yield a 19-dimensional feature space. Here, features are grouped into three qualitative types (for presentation purposes only): responses for choice and trial outcome (left); responses to expected value of left and right offers (middle); and responses to received reward volume (right). (<bold>C</bold>) Cluster-averaged PSTHs, aligned to trial initiation, using this conditional feature space. Error bars denote s.e.m. (<bold>D</bold>) Z-scored PSTHs for all neurons, sorted by time to peak within each cluster. (<bold>E</bold>) Consistency of cluster labeling, calculated as the conditional probability <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>conditional</mml:mtext></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>PSTH</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of belonging in any ‘conditional’ cluster (<inline-formula><mml:math id="inf7"><mml:msub><mml:mi>C</mml:mi><mml:mtext>conditional</mml:mtext></mml:msub></mml:math></inline-formula>), given that a unit belongs to a certain PSTH-defined cluster (<inline-formula><mml:math id="inf8"><mml:msub><mml:mi>C</mml:mi><mml:mtext>PSTH</mml:mtext></mml:msub></mml:math></inline-formula>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Gap statistic.</title><p>Gap statistic evaluation for both clustering approaches (see Materials and methods for details). Error bars denote ±2 s.e.m. (<bold>A</bold>) PSTH-based clustering results. (<bold>B</bold>) Alternative clustering approach based upon a conditional feature space. Vertical black lines denote largest significant number of clusters.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Similarity across clustering methods.</title><p>Similarity of clusters in feature space. (<bold>A</bold>) t-SNE embedding of the PSTH feature space: Dots are individual neurons, and colors denote the cluster identity. (<bold>B</bold>) Similar t-SNE embedding of the conditional feature space. Quantification of the cluster similarity through the cluster-averaged Mahalanobis distance of neurons from a given cluster distribution from all other clusters for (<bold>C</bold>) the PSTH feature space clustering result and (<bold>D</bold>) the conditional feature space clustering result.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Clustering aligned to different task events.</title><p>Results of clustering on conditional features space, aligned to different events in the task. (<bold>A-B</bold>) Results aligned to exiting the center port. (<bold>C-D</bold>) Results aligned to choice.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>PAIRS analysis.</title><p>PAIRS statistic analysis. (<bold>A</bold>) Average angles between k = 3 nearest neighbors in the PSTH-based feature space (red) compared to a Gaussian distribution in the same dimension (blue). (<bold>B</bold>) Similar distribution for the conditional feature space representation of neural responses, for k = 8 nearest neighbors. The Kolomolgorov Smirnov (KS) statistic comparing the data distributions to the reference distribution yielded <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>125</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for the PSTH clustering, and <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>72</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for the conditional clustering. PAIRS statistics were 0.13 (<inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>229</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) and 0.06 (<inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>59</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). Details on the reference data are provided in Methods.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig2-figsupp4-v2.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Silhouette score and adjusted Rand index evaluation of cluster number.</title><p>Silhouette score and adjusted Rand index (ARI) in different features spaces. (<bold>A</bold>) Mean ARI values for clustering on PSTHs. ARI was calculated between the full dataset and 100 samples of subsampled data, created by sampling 90% of the population without replacement. Error bars are s.e.m. (<bold>B</bold>) Silhouette score for clustering on PSTHs. (<bold>C-D</bold>) Same analysis, but for the conditional feature space.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig2-figsupp5-v2.tif"/></fig><fig id="fig2s6" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 6.</label><caption><title>Synthetic data study of silhouette score performance.</title><p>Silhouette score underestimates the number of clusters on ground-truth data in the same data regime as lOFC responses. The covariance structure lOFC data in the PSTH feature space was used to generated ground-truth, synthetic data containing <inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> clusters, and the total-data covariance was scaled to investigate the ratio of across-cluster and within-cluster variance (See Methods for full details). (<bold>A</bold>) Performance of silhouette score for varying scaling of total-data covariance, where scaling = 1.0 (yellow) is the same regime as lOFC responses. Error bars are 1 s.e.m over 100 ground-truth datasets (<bold>B</bold>) Frequency of cluster number chosen for each dataset when using the silhouette score. For data scaled similarly to lOFC responses, silhouette scores predominantly choose K = 2 clusters, and do not identify the true cluster number until the data is scaled to be very separated (scaling = 5.0, light blue) (<bold>C</bold>) Performance of the gap statistic on the same synthetic data, where error bars are 1 s.e.m. (<bold>D</bold>) Frequency of chosen cluster number using the gap statistic. The gap statistic also understimates cluster number in the lOFC data regime, but does so in a less severe manner: It predicts a range of values for scaling = 1.0, and quickly converges to predicting the correct number of clusters at only modest scaling of the data (scaling = 2.0, purple). (<bold>E</bold>) t-SNE visualization of ground-truth data for different total-data covariance scaling.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig2-figsupp6-v2.tif"/></fig></fig-group><p>We evaluated the quality of clustering using two additional methods. First, we visualized clustering using t-SNE projections of data into two dimensions, and further quantified cluster separation using the Mahalanobis distance among clusters, which in this context can be interpreted as an average z-score for data in a cluster from a given cluster mean (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). We found that lOFC responses obtained by both procedures were qualitatively clustered in feature space, and demonstrated Mahalahobis distances with smaller intracluster distances than across-cluster distances. Second, we used the PAIRS statistic to more directly test whether lOFC responses belong to distinct clusters (<xref ref-type="bibr" rid="bib49">Raposo et al., 2014</xref>). PAIRS examines the angle between neural responses in feature space, and obtains an average angle for the data points closest to it. Intuitively, a small average angle among neighboring points implies that the data is tightly packed together into clusters, whereas larger angles suggest broadly distributed, unclustered data. We found that our neural responses were more tightly packed together than would be observed for an unclustered, Gaussian reference distribution (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>).</p><p>Finally, we also compared the estimated the number of clusters in the data to those obtained using other clustering metrics, in particular the silhouette score and adjusted Rand Index (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>). The silhouette score quantifies cluster quality with two components: it provides high scores when points within a cluster are close in feature space, and penalizes small inter-cluster distances that arise when clusters are nearby in feature space. The adjusted Rand Index (ARI) does not assess cluster quality through distances among datapoints in feature space, but instead is a measure of reproducibility of a clustering result. Specifically, it quantifies the probability that two labels from separate clustering results would arise by chance. We generated labels for ARI by subsampling our data (90% sampling without replacement) and calculated ARI on the subsampled dataset and the full dataset. ARI results demonstrated a broad range of possible numbers of clusters with reproducible cluster labels (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5A</xref>). In contrast, the silhouette score gave inconclusive results on our lOFC data (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5B</xref>). The dimensionality and covariance of our lOFC responses lies in a regime in which clusters are tightly packed in feature space, a regime in which silhouette score is known to underestimate the number of clusters in other contexts (<xref ref-type="bibr" rid="bib14">Garcia-Dias et al., 2020</xref>; <xref ref-type="bibr" rid="bib13">Garcia-Dias et al., 2018</xref>). To assess this more directly, we compared the results from different clustering metrics on artificial data with known statistics (deriving from five clusters). We found that in the data-like regime, the silhouette score substantially underestimated the optimal number of clusters (two clusters, <xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6</xref>, see Discussion and Materials and methods). The gap statistic underestimated cluster number on synthetic data, but to a lesser degree. Taken together, these analyses suggest that the gap statistic is a conservative but principled metric for determining the number of clusters in the statistical regime of the lOFC data.</p></sec><sec id="s2-2"><title>Neural responses in lOFC are well-captured by a generalized linear model that includes attributes of offered rewards, choice, and reward history</title><p>We next sought to characterize the encoding properties of neurons in each cluster. To that end, we modeled each neuron’s trial-by-trial spiking activity with a generalized linear model with Poisson noise (<xref ref-type="fig" rid="fig3">Figure 3</xref>). This approach has been previously used in sensory areas to model the effects of external stimuli upon neural firing (<xref ref-type="bibr" rid="bib47">Pillow et al., 2005</xref>; <xref ref-type="bibr" rid="bib48">Pillow et al., 2008</xref>), and more recently has been extended to higher order areas of cortex during decision-making tasks (<xref ref-type="bibr" rid="bib45">Park et al., 2014</xref>). In this model, the time-dependent firing rate (<inline-formula><mml:math id="inf14"><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>) of a neuron is the exponentiated sum of a set of linear terms.<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo mathvariant="bold" movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∗</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>GLM analysis.</title><p>(<bold>A</bold>) Model schematic: the timing of external stimuli conveying reward attributes, as well as timing of choices and outcomes on each trial are model inputs. Nonlinear response kernels convolved with each input generate time dependent responses that are summed and exponentiated to give a mean firing rate, <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, in each time bin. Spikes are generated from a Poisson process with mean firing rate <inline-formula><mml:math id="inf16"><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>. (<bold>B</bold>) Task schematic illustrating the key choice and outcome inputs to the model. (<bold>C</bold>) Kernel fits for a sample neuron. Kernels are grouped by the aspects of the task that they model. Error bars denote estimated kernel standard deviation (Materials and methods). (<bold>D</bold>) Timing of each kernel’s contribution in an example trial. The kernels in bold from panel C are the kernels that are active in this trial. The resulting model-predicted firing rate is shown in the bottom row. (<bold>E</bold>) Representative PSTHs to held-out testing data from five different neurons (black) and model prediction (red). (<bold>F</bold>). Variance explained for each neuron, with sample neurons from E denoted by correspondingly colored crosses. The distribution of <inline-formula><mml:math id="inf17"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values is presented along edge of the panel.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Model comparison.</title><p>Model ‘best’ was the model utilized in this work, and detailed in <xref ref-type="fig" rid="fig3">Figure 3</xref>. Two more complex models (+ vol,+ prevVol), as well as two simpler models (-RewRate,-RewHist) were compared through model comparison on held-out data log-likelihood.+ prevVol substituted previous wins with rewarded volume on the previous trial, and+ vol additionally substituted trial wins with rewarded volume. -RewRate omitted the sessionProgress, prevRewardRate, and previousOptOut kernels, and -RewHist further omitted the remaining reward history kernels. (<bold>A-D</bold>) Individual model comparisons. (Left) Histograms of the population-level changes in held-out negative log-likelihood demonstrate when a model performs significantly better if the median <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> is different than 0. Significance is assessed through Wilcoxon signed rank test. <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> in all comparisons. Median <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> values were <inline-formula><mml:math id="inf21"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>best</mml:mtext><mml:mo>,</mml:mo><mml:mtext>+vol</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.62</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf22"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>best</mml:mtext><mml:mo>,</mml:mo><mml:mtext>+prevVol</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1.77</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf23"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>best</mml:mtext><mml:mo>,</mml:mo><mml:mtext>-RewRate</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>4.14</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf24"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>best</mml:mtext><mml:mo>,</mml:mo><mml:mtext>-RewHist</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>15.13</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. Sample neuron fits demonstrating the most extreme change in <inline-formula><mml:math id="inf25"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> are shown in the middle columns, and neurons demonstrating the median change in <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> are shown in right columns. (<bold>E</bold>) Performance of models assessed through the mean-squared error on PSTHs from held-out test data as compared to model predictions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Variance explained.</title><p>Variance explained, R<sup>2</sup> , for all model fits. For 69 units (10.5%), the model had R<sup>2</sup> &lt; 0. These units were excluded from further analysis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig3-figsupp2-v2.tif"/></fig></fig-group><p>where the variables <inline-formula><mml:math id="inf27"><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> are the stimuli and behavioral events against which neural activity is regressed; <inline-formula><mml:math id="inf28"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denote the response kernels that are convolved with the task variables to model time-dependent responses to each variable (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). The probability that a given number of spikes would occur in a discrete time bin of <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is given by a homogeneous Poisson process with mean <inline-formula><mml:math id="inf30"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>The task variables and example kernels for our model are shown for a sample neuron in <xref ref-type="fig" rid="fig3">Figure 3C</xref>. Variables were binarized such that 1 (0) denoted the occurrence (absence) of an event. The task variables included reward (win or loss on the current or previous trial), choice (left or right), and the timing of cues indicating reward attributes for the left and right offers (reward volume conveyed by auditory clicks and reward probability conveyed by visual flashes). We also included the average reward rate prior to starting each trial and the location of the trial within the session (not shown). Given the large number of model parameters, we used a smooth, log-raised cosine temporal basis and L2 regularization to prevent overfitting (Materials and methods). Based on model comparison, we found that including a spike history term as in other GLM approaches did not improve our model, presumably due to the fact that we are modeling longer timescale responses.</p><p>The chosen model parameters were selected by model comparison against several alternative models using cross-validation. Model comparison favored a simpler binary win/loss representation of rewarded outcomes over richer representations of reward volume on the current or previous trial (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). The model reproduced the trial-averaged PSTHs of individual neurons (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). To quantify model performance, we calculated the proportion of variance explained (<inline-formula><mml:math id="inf31"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>) for held-out testing data (<xref ref-type="fig" rid="fig3">Figure 3F</xref>). The model captured a high percentage of variance for most of the neurons in our dataset. A small fraction of neurons exhibited negative <inline-formula><mml:math id="inf32"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values (69 units, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), indicating that the model produced a worse fit of the test data than the data average. Our liberal inclusion criteria did not require neurons to exhibit task-modulation of their firing rates, so these neurons were likely not task-modulated, and were excluded from subsequent analyses.</p></sec><sec id="s2-3"><title>Clustering reveals distributed encoding of most task variables across subpopulations of lOFC neurons</title><p>We next sought to characterize the extent to which neurons that belonged to different clusters might be ‘functionally distinct,’ and encode different task-related variables (<xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>; <xref ref-type="bibr" rid="bib36">Namboodiri et al., 2019</xref>). To address this question, we computed two complementary but independent metrics, both based on the GLM fit: the coefficient of partial determination and mutual information. The coefficient of partial determination (CPD) quantifies the contribution of a single covariate (e.g. left/right choice) to a neuron’s response by comparing the goodness-of-fit of the encoding model with and without that covariate. In other words, the CPD quantifies the amount of variance that is explained by kernels representing different aspects of the model. We computed the CPD in a sliding time window throughout the trial, and compared CPD values to a shuffle test, in which trial indices were randomly shuffled relative to the design matrix before generating model predictions. CPD values that were within the 95% confidence intervals of the shuffled distribution were set to 0 before averaging CPD values over neurons in a cluster. The average CPD values for different task variables is shown for clusters based on each clustering procedure in <xref ref-type="fig" rid="fig4">Figure 4A and C</xref>. Note that CPD plots are aligned to different events, depending on the covariate.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Coefficient of partial determination (CPD) and mutual information (MI) reveal broad encoding of all task parameters in each cluster.</title><p>(<bold>A</bold>) CPD for choice and reward outcome encoding: Reward history panels quantify encoding of outcome on the previous trial (previous win/loss/opt out), choice panels convey encoding of choices on the current trial (left/right), and reward panels quantify encoding of outcomes on the current trial (win/loss). (<bold>B</bold>) Mutual information for same task parameters. (<bold>C</bold>) CPD of flashes (left panels) and clicks (right panels) that encode reward probability and reward volume, respectively. CPD and MI values are averaged over neurons in each cluster; error bars show s.e.m. Results for PSTH clustering are in the left columns, and results for conditional clustering are in the right columns.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Waveform analysis.</title><p>Waveform action potential (AP) and after-hyperpolarization (AHP) widths are equally distributed across clusters. (<bold>A</bold>) The half-width of the AP peak (black), and full width of the AHP trough (red) were taken as key features of the waveform from each neuron. Waveforms were standardized by mean-subtracting and normalizing by the maximum amplitude range. (<bold>B</bold>) AP and AHP for the population of units clustered into two putative groups: Regular spiking units (RSU, solid circles), and fast spiking units (FSU, open circles). (<bold>C</bold>) Probability of an RSU or FSU neuron occurring in each N = 5 clusters from the PSTH-based clustering labeling. Error bars denote the 95% binomial distribution confidence interval. The means of the two putative FSU and RSU clusters were significantly different (<inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>4.65</mml:mn><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>FSU</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>9.66</mml:mn><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, signed-rank test, not shown).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig4-figsupp1-v2.tif"/></fig></fig-group><p>We also computed the mutual information (MI) between neural spike trains and different model covariates (Materials and methods). Our approach relates the statistics of trial-level events to firing rates, which allows us to assess the information content for each stimulus throughout the entire time course of a trial. Such an approach does not easily generalize to the statistics of within-trial events such as the information represented in stimulus clicks and flashes, so we restricted the MI analysis to the other covariates: reward history, choice, and reward outcome. The average MI for these variables is shown for clusters based on the trial-averaged PSTHs in <xref ref-type="fig" rid="fig4">Figure 4B</xref>.</p><p>In general, regardless of the metric (CPD or MI) or clustering procedure (PSTH clustering or conditional clustering), task variables appear to be broadly encoded across neural subpopulations, with similar temporal dynamics and average CPD/MI values across clusters. All clusters encoded cues conveying reward volume and probability during the cue period (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), although it is worth noting that the magnitude of CPD for clicks and flashes was an order of magnitude lower than for the other task variables. Therefore, encoding of cues representing reward attributes was substantially weaker than encoding of reward history, choice, and outcome. It may be surprising that neurons with strikingly different PSTHs appear to encode task variables with similar time courses. However, PSTHs marginalize out all conditional information, so a PSTH carries no information about encoding of task or behavioral variables, per se. Additionally, to assess whether different clusters may have a different composition across neuron types, we classified single units based on their waveforms into regular spiking units with broad action potential (AP) and after-hyperpolarization (AFP) widths, or fast-spiking units with narrow AP and AHP widths. We found the distribution of these two unit types to be similar across clusters (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><p>Reward history was most strongly encoded at the time of trial initiation and decayed over the course of the trial, consistent with previous analyses (<xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>). Neurons belonging to cluster 2, which strongly overlap in both clustering procedures (<xref ref-type="fig" rid="fig2">Figure 2E</xref>), seem to exhibit slightly more pronounced encoding of reward history during the trial, compared to the other clusters, although these neurons were also persistently active during this time period. Encoding of choice and reward outcomes were phasic, peaking as the animal made his choice and received outcome feedback, respectively, and were broadly distributed across clusters (<xref ref-type="fig" rid="fig4">Figure 4A–B</xref>).</p></sec><sec id="s2-4"><title>Reward history re-emerges before choice in a distinct subset of lOFC neurons</title><p>The CPD and MI analysis revealed one aspect of encoding that is unique to cluster 3. Both clustering methods identified largely overlapping populations of neurons in this cluster (<xref ref-type="fig" rid="fig2">Figure 2E</xref>), indicating that these neurons exhibited similar temporal response profiles as well as encoding. Like neurons in the other clusters, neurons in cluster 3 encoded reward history at trial initiation, and that encoding decreased through the cue period. However, for neurons in this cluster, encoding of reward history re-emerged at the time preceding the animal’s choice on the current trial (<xref ref-type="fig" rid="fig5">Figure 5A–B</xref>, green lines). This ‘bump’ of reward history encoding late in the trial was unique to cluster 3 regardless of the clustering method, and was observable in both CPD and MI (<xref ref-type="fig" rid="fig4">Figure 4A–B</xref>). This result was further corroborated by computing the average discriminability index (<inline-formula><mml:math id="inf36"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>) for reward history, which is a model-agnostic metric that quantifies the difference in mean firing rate in each condition, accounting for response variance over trials. Cluster 3 was unique from the other clusters for having a subset of neurons with high <inline-formula><mml:math id="inf37"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> values for reward history at the time preceding the animal’s choice (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). We additionally found that encoding of previous wins and losses during this time period only extended to the previous trial, and did not encode the outcome of additional past trials (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Clustering of PSTHs aligned to later events in the trial showed more detailed structure of this late-in-trial encoding of reward history, with some neurons encoding the previous trial just before the choice, and others at the time of choice (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2C</xref>). We note that clustering on PSTHs aligned to later events produced similar results, in terms of the number of clusters and the within-cluster responses (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2B</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Encoding of reward history emerges late in the trial for cluster 3.</title><p>(<bold>A</bold>) CPD for reward history, aligned to leaving the center poke after the cue period. Note the peak in encoding that is isolated to cluster 3 (black arrow). (<bold>B</bold>) CPD similarly aligned to choice, demonstrates that this encoding occurs before reward delivery on the current trial. (<bold>C</bold>) Sensitivity, <inline-formula><mml:math id="inf38"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>, across time and neurons for reward history has activity isolated to cluster 3 (magenta circle). <inline-formula><mml:math id="inf39"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> is sorted within the PSTH-based clusters by time-to-peak.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Linear regression on recent trial history.</title><p>Linear regression of the pre-choice epoch based on recent trial history. (<bold>A</bold>) Average regression coefficients for all statistically significant models with significant <inline-formula><mml:math id="inf40"><mml:msubsup><mml:mi>c</mml:mi><mml:mtext>win/loss</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> (<inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> for F-test comparing full model to mean-rate baseline model, <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> for t-test of <inline-formula><mml:math id="inf43"><mml:msubsup><mml:mi>c</mml:mi><mml:mtext>win/loss</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>). Regression coefficients one trial back have both positive and negative coefficients for reward outcome one trial back that convey different coding schemes for rewarded value, but coefficients for increasingly further trials back are not significant. (<bold>B</bold>) Number of neurons with significant models containing either positive (shaded) or negative (not shaded) <inline-formula><mml:math id="inf44"><mml:msubsup><mml:mi>c</mml:mi><mml:mtext>win/loss</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> coefficients, separated by cluster. Cluster 3 contains the majority of statistically significant neurons.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Clustering on later trial events.</title><p>Clustering on PSTHs aligned to the later trial event of exiting the center port yields consistent responses to start-aligned PSTH clustering. (<bold>A</bold>) Consistency of cluster labeling, calculated as the conditional probability <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>exit center port</mml:mtext></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>start</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of belonging in any cluster from the exit center port clustering procedure (<inline-formula><mml:math id="inf46"><mml:msub><mml:mi>C</mml:mi><mml:mtext>exit center port</mml:mtext></mml:msub></mml:math></inline-formula>), given that a unit belongs to a certain start-aligned PSTH cluster (<inline-formula><mml:math id="inf47"><mml:msub><mml:mi>C</mml:mi><mml:mtext>start</mml:mtext></mml:msub></mml:math></inline-formula>). Responses in clusters 1–4 in <inline-formula><mml:math id="inf48"><mml:msub><mml:mi>C</mml:mi><mml:mtext>start</mml:mtext></mml:msub></mml:math></inline-formula> are similar to <inline-formula><mml:math id="inf49"><mml:msub><mml:mi>C</mml:mi><mml:mtext>exit center port</mml:mtext></mml:msub></mml:math></inline-formula>, and cluster 5 in <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>C</mml:mi><mml:mtext>exit center port</mml:mtext></mml:msub></mml:math></inline-formula> is also similar to cluster 3. (<bold>B</bold>) Z-scored PSTH responses within each cluster, sorted by cluster and time to peak. Response profiles are similar to the original clustering procedure (compare to <xref ref-type="fig" rid="fig1">Figure 1B</xref>). (<bold>C</bold>) Sensitivity, <inline-formula><mml:math id="inf51"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>, across time and neurons for reward history has more detailed structure when clustering on PSTHS aligned to later trial events. Cluster 3 still maintains sensitivity just before choice, although additional substructure is now visible in Cluster 5 right at choice on the current trial (magenta circles). <inline-formula><mml:math id="inf52"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> is sorted within the PSTH-based clusters by time-to-peak. Encoding of other task attributes, assessed through CPD was similar between the two clustering procedures (not shown).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig5-figsupp2-v2.tif"/></fig></fig-group><p>Notably, cluster 3 also exhibited the most prominent encoding of reward outcome compared to the other clusters (<xref ref-type="fig" rid="fig4">Figure 4A–B</xref>, green, bottom row). This suggests that this subset of neurons may be specialized for representing or even integrating information about reward outcomes on previous and current trials. We wondered if this might reflect adaptive value coding, in which value representations in OFC have been observed to dynamically reflect the statistics of offered rewards (<xref ref-type="bibr" rid="bib23">Kobayashi et al., 2010</xref>; <xref ref-type="bibr" rid="bib70">Webb et al., 2014</xref>; <xref ref-type="bibr" rid="bib74">Yamada et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">Padoa-Schioppa, 2009</xref>; <xref ref-type="bibr" rid="bib54">Rustichini et al., 2017</xref>; <xref ref-type="bibr" rid="bib7">Conen and Padoa-Schioppa, 2019</xref>). Adaptive value coding, which is thought to reflect a divisive normalization or range adaptation mechanism, allows the circuit to efficiently represent values in diverse contexts in which their magnitudes may differ substantially. As such, it provides key computational advantages, such as efficient coding, or the maximization of mutual information between neural signaling and the statistics of the environment (<xref ref-type="bibr" rid="bib70">Webb et al., 2014</xref>; <xref ref-type="bibr" rid="bib74">Yamada et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">Padoa-Schioppa, 2009</xref>; <xref ref-type="bibr" rid="bib54">Rustichini et al., 2017</xref>; <xref ref-type="bibr" rid="bib57">Simoncelli and Olshausen, 2001</xref>; <xref ref-type="bibr" rid="bib6">Carandini and Heeger, 2011</xref>; <xref ref-type="bibr" rid="bib67">Tymula and Glimcher, 2020</xref>; <xref ref-type="bibr" rid="bib28">Louie and Glimcher, 2012</xref>).</p><p>According to divisive normalization models of subjective value, the value of an option or outcome is divided by a recency-weighted average of previous rewards (<xref ref-type="bibr" rid="bib67">Tymula and Glimcher, 2020</xref>; <xref ref-type="bibr" rid="bib28">Louie and Glimcher, 2012</xref>; <xref ref-type="bibr" rid="bib70">Webb et al., 2014</xref>). Therefore, if neurons in OFC exhibit adaptive value coding, we would predict that they would exhibit stronger reward responses following unrewarded trials, and weaker responses following rewarded trials (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). Put another way, regressing the firing rate against current and previous rewards should reveal coefficients with opposite signs (<xref ref-type="bibr" rid="bib22">Kennerley et al., 2011</xref>). Neurons with regression coefficients for current and previous rewards with the same sign would be modulated by current and previous rewards, but not in a way that is consistent with the adaptive value coding hypothesis (<xref ref-type="fig" rid="fig6">Figure 6D</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Adaptive value coding analysis using linear regression of firing rates for the 1s period following reward delivery against current and previous reward outcomes.</title><p>(<bold>A</bold>) Regression coefficients for the current reward outcome, <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>c</mml:mi><mml:mtext>win/loss</mml:mtext></mml:msub></mml:math></inline-formula> (parameterized as win = 1, and loss=-1), and previous trial outcome, <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>c</mml:mi><mml:mtext>rewhist</mml:mtext></mml:msub></mml:math></inline-formula>. 180 neurons had significant coefficients for both regressors (<inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, t-test), and 81 neurons had coefficients with opposite signs, consistent with adaptive value coding (blue dots). The remaining neurons have differential responses due to reward history, but inconsistent with adaptive value coding (red crosses). (<bold>B</bold>) Probability that a model with significant regressors for both current and past reward outcome would come from a given cluster. Shaded regions denote all models from panel A, and blue bars show the probability for adaptive neurons only. Error bars are the 95% confidence interval of the mean for a binomial distribution with observed counts from each cluster. (<bold>C</bold>) Example cell demonstrating adaptive value coding. Shaded gray region denotes time window used to compute mean firing rate for the regression. (<bold>D</bold>) Sample cell demonstrating significant modulation due to reward history, but with a relationship inconsistent with adaptive value coding.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Linear regression of RPE.</title><p>Linear regression of RPE in the post-choice epoch indicates that no RPE is present. Plotted is the variance explained for each neuron for two separate models: the binary win/loss model analyzed in <xref ref-type="fig" rid="fig6">Figure 6</xref>, and an equivalent model that replaces the current trial win/loss and past trial win/loss regressors with an RPE regressor. Blue dots indicate models with significant linear models, while red dots indicate non-significant models (threshold <inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, F-test). The binary win/loss model captures more variance than the RPE model, indicating that wins and losses better explain that data. Further, model comparison between the two models by held out data log-likelihood reveals that the win/loss model is a better model (median <inline-formula><mml:math id="inf57"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>5.9</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, Wilcoxon signed rank test). The large proportion of RPE models that are significant is likely a reflection of the high correlation between RPE and win/loss regressors (<inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.80</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Adaptive value coding of rewarded volume.</title><p>Adaptation of rewarded volume representation is present in fewer neurons than the reward outcome representation, but is still distributed across all clusters. Figure convention is similar to <xref ref-type="fig" rid="fig6">Figure 6</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig6-figsupp2-v2.tif"/></fig></fig-group><p>To test this hypothesis, we regressed the firing rates of neurons in a 1s window after reward receipt against reward win/loss outcomes on the current trial, as well as the win/loss outcome from the previous trial (<xref ref-type="fig" rid="fig6">Figure 6</xref>, Materials and methods). We found that 180 neurons (27% of population) exhibited significant coefficients for both current reward and reward history regressors, and 45% of these units demonstrated adaptive value coding indicated by the opposite signs of regression coefficients for current and previous reward outcomes (81 units, <xref ref-type="fig" rid="fig6">Figure 6A</xref>, blue). To determine if these adaptive neurons preferentially resided in a particular cluster, we calculated the cluster-specific probability of a neuron demonstrating either significant coefficients for rewarded volume and reward history, or having coefficients with opposite signs, consistent with adaptive value coding (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). We found that no cluster preferentially contained adaptive units with higher probability (comparison of 95% binomial confidence intervals). We also investigated whether adaptive value coding was present for rewarded volume representations, and similarly found that neurons did not preferentially reside in any one cluster (30 adaptive units out of 79 significant units, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). Notably, activity during the reward epoch did not appear to encode a reward prediction error (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>), defined as the difference between the expected value and the outcome of the chosen option, as has been previously reported in rat and primate OFC (<xref ref-type="bibr" rid="bib32">McDannald et al., 2011</xref>; <xref ref-type="bibr" rid="bib62">Takahashi et al., 2009</xref>; <xref ref-type="bibr" rid="bib63">Takahashi et al., 2013</xref>; <xref ref-type="bibr" rid="bib22">Kennerley et al., 2011</xref>; <xref ref-type="bibr" rid="bib34">Miller et al., 2018</xref>).</p></sec><sec id="s2-5"><title>Neurons in Cluster 3 have similar responses to previously reported striatum projection neurons</title><p>Studies of OFC indicate that long-range projections to different downstream circuits exhibit distinct encoding and/or make distinct contributions to behavior (<xref ref-type="bibr" rid="bib17">Groman et al., 2019</xref>; <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>; <xref ref-type="bibr" rid="bib36">Namboodiri et al., 2019</xref>). For instance, previous work from <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref> used optogenetic tagging to record from OFC neurons that project to the ventral striatum, and found that these cells exhibited responses that seemed to correspond to a distinct cluster with stereotyped responses. This cluster encoded the trial outcome just after reward delivery, with larger responses following unrewarded trials, and also encoded the negative integrated value of the chosen option during the inter-trial interval, until the start of the next trial (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). We examined the average PSTHs of each cluster aligned to trial outcome and the start of the next trial, to see if any cluster resembled the corticostriatal responses described in <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>. Specifically, we plotted the cluster-averaged firing rates for trials classified as a loss, a low-reward trial (6 or 12 µl), or a high-reward trial (24 or 48 µl) (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). We found that several clusters prominently encoded the reward outcome after reward (clusters 1, 3, 5); however, only cluster 3 encoded the negative (i.e., inverted) value of the reward during the inter-trial interval until the start of the next trial. Therefore, one of the clusters that we identified in our data exhibits qualitatively similar responses to the corticostriatal projection neurons identified by clustering in <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Rewarded volume encoding by cluster.</title><p>(<bold>A</bold>) Schematic of the encoding properties of a cluster of putative corticostriatal projection neurons from <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>. Neurons from this cluster encode the outcome of a trial just after choice, as well as negative (i.e. inverted) integrated value during the intertrial interval, until the start of the next trial. (<bold>B</bold>) Cluster-averaged response to rewarded volume magnitude. Each sub-panel shows the average response to either a trial loss (blue), a low reward (6 or 12 µl, green), or a high reward (24 or 48 µl, orange).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70129-fig7-v2.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We analyzed neural responses in lOFC from rats performing a value-based decision-making task, in which they chose between left and right offers with explicitly cued reward probabilities and volumes. Despite the apparent response heterogeneity in our dataset, two independent clustering methods revealed that neurons belonged to one of a small number of distinct clusters. We clustered based on the marginalized PSTHs over all trials, and found that subpopulations of neurons exhibited characteristic temporal response profiles. To our knowledge, using temporal responses that do not explicitly contain conditional information is a novel approach for identifying distinct neural response profiles in prefrontal cortex. We also clustered based on a conditional feature space for each neuron, consistent with previous work (<xref ref-type="bibr" rid="bib36">Namboodiri et al., 2019</xref>; <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>). The feature space for each neuron corresponded to its average firing rate on different trial types, in select time windows that most closely corresponded to the differentiating covariate on each trial (e.g. wins vs. losses at the time of reward feedback). Notably, these independent clustering methods identified robustly identifiable groups of neurons for two of the clusters, indicating that neurons in these clusters can be identified by either their temporal response profiles or their task variable encoding, as defined by the feature space.</p><p>Previous studies that clustered using a conditional feature space identified a larger number of clusters than we did here (<xref ref-type="bibr" rid="bib36">Namboodiri et al., 2019</xref>; <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>). This could reflect the different metrics used to select the number of clusters (the gap statistic in this study; compared to PCA and silhouette scores [<xref ref-type="bibr" rid="bib36">Namboodiri et al., 2019</xref>], or adjusted Rand index [<xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>]). Another difference is the time window that was used to generate the conditional feature space. In <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>, for instance, the authors used the same time window for each feature, which was after the rat made a choice but before it received feedback about the outcome of that choice. There was no such epoch in our behavioral paradigm, precluding a more direct comparison. However, a principled choice of clusters using the gap statistic still provided a useful tool for investigating the encoding of task variables in lOFC.</p><sec id="s3-1"><title>Rat lOFC weakly encodes reward attributes</title><p>Our task design allowed us to isolate neural responses to sensory cues that conveyed information about distinct reward attributes, because these cues were presented independently and variably in time. However, our GLM revealed weak encoding of these reward attributes – reward probability and volume – across all clusters, regardless of the clustering method. This was observable by examination of the relative magnitude of the flash and click kernels in individual neurons, and also by the CPD metric. The average flash and click CPD values were an order of magnitude smaller than for the other covariates, indicating that flashes and clicks did not contribute substantially to neural firing. Therefore, while behavioral analyses have shown that rats used the flashes and clicks to guide their choices (<xref ref-type="bibr" rid="bib9">Constantinople et al., 2019b</xref>), these cues were not strongly represented in lOFC. This weak encoding of reward attributes, whose combination would specify the subjective value of each offer (<xref ref-type="bibr" rid="bib9">Constantinople et al., 2019b</xref>), is potentially consistent with a recent study of rat lOFC during a multi-step decision-making task that enabled dissociation of choice and outcome values (<xref ref-type="bibr" rid="bib33">Miller et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Miller et al., 2018</xref>). Recordings in that study revealed weak encoding of choice values, but strong encoding of outcome values, and optogenetic perturbations suggested a critical role for lOFC in guiding learning but not choice (<xref ref-type="bibr" rid="bib34">Miller et al., 2018</xref>). Other studies in rat lOFC have reported strong encoding of reward and outcome values specifically following action selection, but not preceding choice (<xref ref-type="bibr" rid="bib61">Sul et al., 2010</xref>; <xref ref-type="bibr" rid="bib34">Miller et al., 2018</xref>; <xref ref-type="bibr" rid="bib60">Steiner and Redish, 2014</xref>; <xref ref-type="bibr" rid="bib59">Steiner and Redish, 2012</xref>; <xref ref-type="bibr" rid="bib30">Mainen and Kepecs, 2009</xref>; <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>). However, recordings from rat lOFC in sensory preconditioning paradigms have revealed cue-evoked responses that may reflect inferred value (<xref ref-type="bibr" rid="bib55">Sadacca et al., 2018</xref>; <xref ref-type="bibr" rid="bib63">Takahashi et al., 2013</xref>). Studies in non-human primates have also reported strong encoding of offer values in OFC after presentation of a stimulus, and before choice (<xref ref-type="bibr" rid="bib41">Padoa-Schioppa and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib22">Kennerley et al., 2011</xref>; <xref ref-type="bibr" rid="bib27">Lin et al., 2020</xref>; <xref ref-type="bibr" rid="bib50">Rich and Wallis, 2016</xref>). A recent study in mouse OFC used olfactory cues to convey reward attributes (juice identity and volume) and reported encoding of offer values before choice (<xref ref-type="bibr" rid="bib24">Kuwabara et al., 2020</xref>). It is unclear what factors may account for the pronounced encoding of offer value before choice in <xref ref-type="bibr" rid="bib24">Kuwabara et al., 2020</xref>, but minimal encoding of offer value before choice in our data. One important difference is that the cues that conveyed reward attributes in the present study needed to be integrated over time. The integration process itself likely does not occur in OFC (<xref ref-type="bibr" rid="bib27">Lin et al., 2020</xref>). It is possible that OFC would only represent the offer value once the animal had accumulated enough sensory evidence to infer it. If that inference occurred at a different time on each trial, depending on the strength of the sensory evidence and stochasticity of the accumulation process, then representations of offer value would not be observable in the trial-averaged neural response.</p></sec><sec id="s3-2"><title>Adaptive coding in rat lOFC</title><p>Previous studies in primate medial (<xref ref-type="bibr" rid="bib74">Yamada et al., 2018</xref>) and central-lateral (<xref ref-type="bibr" rid="bib22">Kennerley et al., 2011</xref>; <xref ref-type="bibr" rid="bib66">Tremblay and Schultz, 1999</xref>; <xref ref-type="bibr" rid="bib42">Padoa-Schioppa, 2009</xref>; <xref ref-type="bibr" rid="bib54">Rustichini et al., 2017</xref>) OFC have reported subsets of neurons that adjust the gain of their firing rates to reflect the range of offered rewards, a phenomenon referred to as adaptive value coding. This type of coding is efficient because it would allow OFC to accurately encode values in diverse contexts that may vary substantially in reward statistics (<xref ref-type="bibr" rid="bib70">Webb et al., 2014</xref>), analogous to divisive normalization in sensory systems (<xref ref-type="bibr" rid="bib6">Carandini and Heeger, 2011</xref>; <xref ref-type="bibr" rid="bib57">Simoncelli and Olshausen, 2001</xref>).</p><p>According to divisive normalization models of subjective value, the value of an option is divided by a recency-weighted average of previous rewards (<xref ref-type="bibr" rid="bib28">Louie and Glimcher, 2012</xref>; <xref ref-type="bibr" rid="bib67">Tymula and Glimcher, 2020</xref>; <xref ref-type="bibr" rid="bib70">Webb et al., 2014</xref>). Therefore, we would predict that neurons implementing adaptive value coding would exhibit stronger responses following unrewarded trials, and weaker responses following rewarded trials. Consistent with this hypothesis, we identified a subset of neurons that had significant coefficients for rewards on current and previous trials, with opposite signs, and while this fraction was somewhat modest (∼15%), it was comparable to the proportion of adaptive value coding neurons observed in central-lateral primate OFC (<xref ref-type="bibr" rid="bib22">Kennerley et al., 2011</xref>). Notably, we did not find any evidence of encoding of a reward prediction error during this epoch, or the difference between the expected value of the chosen lottery and the outcome. Therefore, the differential encoding of reward outcomes depending on reward history reflected a discrepancy between reward outcomes and recent experience, not a discrepancy between reward outcomes and expectations (as in a reward prediction error). These were dissociable in our task, due to the sensory cues that explicitly indicated expected value on each trial. We emphasize that adaptive value coding is likely not a specialization of lOFC, but probably occurs broadly in brain areas that represent subjective value.</p></sec><sec id="s3-3"><title>Mixed selectivity in OFC</title><p>The complexity and diversity of responses found in the prefrontal cortex, including the OFC, has led to questions about whether or not neurons with mixed selectivity or specialized responses represent behavioral and cognitive variables (<xref ref-type="bibr" rid="bib51">Rigotti et al., 2013</xref>; <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>; <xref ref-type="bibr" rid="bib49">Raposo et al., 2014</xref>; <xref ref-type="bibr" rid="bib31">Mante et al., 2013</xref>; <xref ref-type="bibr" rid="bib36">Namboodiri et al., 2019</xref>). We tested if OFC neural responses belonged to clusters in our task using two separate methods: the gap statistic, and the PAIRS statistic. Both methods confirm that there is statistically significant clustering in our data. We emphasize, however, that mixed selectivity is fundamentally a property of individual neurons. We did not directly investigate whether individual lOFC neurons in our dataset exhibited mixed selectivity, but instead focused on encoding at the level of clusters. The broad encoding of task variables in each cluster suggests that lOFC neurons probably exhibit mixed selectivity, but a formal assessment was beyond the scope of our study.</p></sec><sec id="s3-4"><title>Representations of reward history in OFC</title><p>In studies that require animals to learn and update the value of actions and outcomes from experience (i.e. in accordance with reinforcement learning), values are often manipulated or changed over the course of the experiment to assess behavioral flexibility, value-updating, and goal-directed behavior. In rodents and primates, lesion and perturbation studies have shown that the OFC is critical for inferring value in these contexts, suggesting an important role in learning and dynamically updating value estimates for model-based reinforcement learning (<xref ref-type="bibr" rid="bib12">Gallagher et al., 1999</xref>; <xref ref-type="bibr" rid="bib21">Izquierdo et al., 2004</xref>; <xref ref-type="bibr" rid="bib46">Pickens et al., 2005</xref>; <xref ref-type="bibr" rid="bib40">Noonan et al., 2010</xref>; <xref ref-type="bibr" rid="bib71">West et al., 2011</xref>; <xref ref-type="bibr" rid="bib16">Gremel and Costa, 2013</xref>; <xref ref-type="bibr" rid="bib33">Miller et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Miller et al., 2018</xref>). Neural recordings in these dynamic paradigms have revealed activity in OFC that reflects reward history and outcome values, which could subserve evaluative processing and learning (<xref ref-type="bibr" rid="bib39">Nogueira et al., 2017</xref>; <xref ref-type="bibr" rid="bib61">Sul et al., 2010</xref>; <xref ref-type="bibr" rid="bib34">Miller et al., 2018</xref>).</p><p>Other studies, including this one, have used sensory cues (e.g. static images, odors) to convey information about reward attributes. Once learned, the mapping between these cues and reward attributes is fixed, and the subject must choose between options with explicitly cued values. Neurons in the central-lateral primate OFC and rat lOFC have been shown to represent the values associated with these sensory cues in their firing rates, as well as reward outcomes and outcome values (<xref ref-type="bibr" rid="bib64">Thorpe et al., 1983</xref>; <xref ref-type="bibr" rid="bib56">Schoenbaum et al., 1998</xref>; <xref ref-type="bibr" rid="bib66">Tremblay and Schultz, 1999</xref>; <xref ref-type="bibr" rid="bib68">Wallis and Miller, 2003</xref>; <xref ref-type="bibr" rid="bib41">Padoa-Schioppa and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib61">Sul et al., 2010</xref>; <xref ref-type="bibr" rid="bib43">Padoa-Schioppa, 2011</xref>; <xref ref-type="bibr" rid="bib26">Levy and Glimcher, 2012</xref>; <xref ref-type="bibr" rid="bib52">Rudebeck and Murray, 2014</xref>; <xref ref-type="bibr" rid="bib55">Sadacca et al., 2018</xref>; <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>; <xref ref-type="bibr" rid="bib27">Lin et al., 2020</xref>). However, the extent to which OFC is causally required for these tasks is a point of contention, and may differ across species (<xref ref-type="bibr" rid="bib3">Ballesta et al., 2020</xref>; <xref ref-type="bibr" rid="bib15">Gardner et al., 2020</xref>; <xref ref-type="bibr" rid="bib24">Kuwabara et al., 2020</xref>). Notably, even when reward contingencies are fixed over trials, animals often show sequential learning effects (<xref ref-type="bibr" rid="bib25">Lak et al., 2020</xref>; <xref ref-type="bibr" rid="bib9">Constantinople et al., 2019b</xref>), and reward history representations in OFC have been reported in tasks with stable reward contingencies (<xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>; <xref ref-type="bibr" rid="bib44">Padoa-Schioppa, 2013</xref>; <xref ref-type="bibr" rid="bib22">Kennerley et al., 2011</xref>).</p><p>In this study, we have described dynamic trial-by-trial changes in firing rates that reflected reward history just preceding the choice. These reward history representations might influence ongoing neural dynamics supporting the upcoming choice (<xref ref-type="bibr" rid="bib35">Mochol et al., 2021</xref>), and/or mediate learning. In contrast to broadly distributed adaptive value coding, this activity was restricted to a particular subset of neurons that were identifiable by two independent clustering methods, and that exhibited the strongest encoding of reward outcomes. Intriguingly, the responses of neurons in this cluster (cluster 3) are qualitatively similar to the responses of identified corticostriatal cells in <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>, raising the possibility that cluster 3 neurons also project to the striatum. lOFC neurons that project to the striatum likely mediate learning: ablating OFC projections to the ventral striatum during a reversal learning task demonstrated that this projection specifically supports learning from negative outcomes (<xref ref-type="bibr" rid="bib17">Groman et al., 2019</xref>).</p><p>In reinforcement learning accounts of basal ganglia function, it is thought that cortical inputs to the striatum encode information about the state the animal is in, and corticostriatal synapses store the learned values of performing actions in particular states in their synaptic weights (i.e. Q-values), which can be updated and modulated by dopamine-dependent plasticity (<xref ref-type="bibr" rid="bib2">Averbeck and Costa, 2017</xref>; <xref ref-type="bibr" rid="bib11">Doya, 2000</xref>). Coincident activation of cortical inputs and striatal spiking can tag corticostriatal synapses for plasticity in the presence of dopamine (<xref ref-type="bibr" rid="bib73">Yagishita et al., 2014</xref>). One reason that lOFC neurons might encode reward history at the time of choice is so that contextual inputs reflecting the animal’s state would include its recent reward history. We have previously shown that optogenetic perturbations of lOFC in this task, triggered when rats exited the center port, disrupted sequential trial-by-trial learning effects (<xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>). These sequential learning effects are not optimal for decision making in this task, as trials were independent and contained explicitly cued reward contingencies. Suboptimal sequential biases are observed across species and domains (<xref ref-type="bibr" rid="bib5">Blanchard et al., 2014</xref>; <xref ref-type="bibr" rid="bib10">Croson and Sundali, 2005</xref>; <xref ref-type="bibr" rid="bib37">Neiman and Loewenstein, 2011</xref>), and reflect an innate difficulty in judging true randomness in an environment (<xref ref-type="bibr" rid="bib38">Nickerson, 2002</xref>). The neural circuits supporting these sequential biases could potentially derive from the subpopulation of lOFC neurons in cluster 3, which may mediate the effect of previous trials on the animal’s behavior either by influencing lOFC dynamics supporting the upcoming choice (<xref ref-type="bibr" rid="bib35">Mochol et al., 2021</xref>), or via projections to the striatum that mediate learning.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Animal subjects and behavior</title><p>The details for the animal subjects, behavioral task, and electrophysiological recordings have been described elsewhere (<xref ref-type="bibr" rid="bib8">Constantinople et al., 2019a</xref>; <xref ref-type="bibr" rid="bib9">Constantinople et al., 2019b</xref>). Briefly, neural recordings from three male Long-Evans rats were used in this work. Animal use procedures were approved by the Princeton University Institutional Animal Care and Use Committee and carried out in accordance with National Institutes of Health standards.</p><p>Rats were trained in a high-throughput facility using a computerized training protocol. The task was performed in operant training boxes with three nose ports, each containing an LED. When the LED from the center port was illuminated, the animal was free to initiate a trial by poking his nose in that port (trial start epoch). While in the center port, rats were continuously presented with a train of randomly timed auditory clicks from a left and right speaker. The click trains were generated by Poisson processes with different underlying rates (<xref ref-type="bibr" rid="bib18">Hanks et al., 2015</xref>); the rates from each speaker conveyed the water volume baited at each side port. Following a variable pre-flash interval ranging from 0 to 350 ms, rats were also presented with light flashes from the left and right side ports, where the number of flashes conveyed reward probability at each port. Each flash was 20 ms in duration, presented in fixed bins, and spaced every 250 ms to avoid perceptual fusion of consecutive flashes. After a variable post-flash delay period from 0 to 500 ms, there was an auditory ‘go’ cue and the center LED turned back on. The animal was then free to leave the center port (exit center port epoch) and choose the left or right port to potentially collect reward (choice epoch).</p></sec><sec id="s4-2"><title>Electrophysiology and data pre-processing for spike train analyses and model inputs</title><p>Tetrodes were constructed from twisted wires that were either PtIr (18 µm, California Fine Wire) or NiCr (25 µm, Sandvik). Tetrode tips were platinum- or gold-plated to reduce impedances to 100–250 kΩ at 1 kHz using a nanoZ (White Matter LLC). Microdrive assemblies were custom-made as described previously (<xref ref-type="bibr" rid="bib1">Aronov and Tank, 2014</xref>). Each drive contained eight independently movable tetrodes, plus an immobile PtIR reference electrode. Each animal was implanted over the right OFC. On the day of implantation, electrodes were lowered to 4.1 mm DV. Animals were allowed to recover for 2–3 weeks before recording. Shuttles were lowered 30–60 µm approximately every 2–4 days.</p><p>Data were acquired using a Neuralynx data acquisition system. Spikes were manually sorted using MClust software. Units with fewer than 1% inter-spike intervals less than 2 ms were deemed single units. For clustering and model fitting, we restricted our analysis to single units that had a mean firing rate greater that 1 Hz (659 units). To convert spikes to firing rates, spike counts were binned in 50 ms bins and smoothed using Matlab’s smooth.m function with a 250 ms moving window. Similarly, our neural response model fit spike counts in discretized bins of 50 ms. When parsing data into cross-validated sets of trials balanced across conditions, a single trial was considered as the window of [–2,6]s around trial start. In all other analyses, conditional responses were calculated on trials with a window [–2,4]s for data aligned to trial start, and [–4,4]s for choice-aligned or exit center port-aligned responses.</p></sec><sec id="s4-3"><title>Clustering of lOFC responses</title><sec id="s4-3-1"><title>Feature space parametrization</title><p>To analyze the heterogeneity in time-dependent lOFC responses, our first clustering procedure utilized trial-averaged PSTHs from each neuron to construct the feature space for clustering. Specifically, for a set of <inline-formula><mml:math id="inf60"><mml:mi>N</mml:mi></mml:math></inline-formula> neurons and trials of <inline-formula><mml:math id="inf61"><mml:mi>T</mml:mi></mml:math></inline-formula> timepoints, we z-scored the PSTH of each neuron and combined all responses into a matrix <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, then performed PCA to obtain principal components, <inline-formula><mml:math id="inf63"><mml:mi>W</mml:mi></mml:math></inline-formula>, and score, <inline-formula><mml:math id="inf64"><mml:mi>M</mml:mi></mml:math></inline-formula>, as <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. We found that <inline-formula><mml:math id="inf66"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:math></inline-formula> components explained &gt;95% of the covariance in <inline-formula><mml:math id="inf67"><mml:mi>Z</mml:mi></mml:math></inline-formula> and used the first <inline-formula><mml:math id="inf68"><mml:mi>k</mml:mi></mml:math></inline-formula> columns of <inline-formula><mml:math id="inf69"><mml:mi>M</mml:mi></mml:math></inline-formula>, the PSTH projected onto the top <inline-formula><mml:math id="inf70"><mml:mi>k</mml:mi></mml:math></inline-formula> PC, as our feature space on which to perform clustering.</p><p>Our second clustering procedure used time-averaged, conditional neural responses to construct the feature space for k-means clustering. This is similar in form to the approach in <xref ref-type="bibr" rid="bib20">Hirokawa et al., 2019</xref>. The feature space consisted of its z-scored firing rate conditioned on choice, reward outcome, reward history, presented offer value (EV of left and right offers), and rewarded volume, in time bins that most often corresponded to differential encoding of each variable (<xref ref-type="fig" rid="fig2">Figure 2A and B</xref>). Specifically, we used conditional PSTHs that depend on a single condition, and marginalized away all other conditions. The conditions, <inline-formula><mml:math id="inf71"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, are grouped into three categories for our task. Choice and outcome information is <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">reward</mml:mtext><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mtext>win,loss</mml:mtext><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">rewardHistory</mml:mtext><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mtext>previous Win,previous loss</mml:mtext><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">choice</mml:mtext><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mtext>left,right</mml:mtext><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Presented offer attributes on left and right ports are the expected value of reward as <inline-formula><mml:math id="inf75"><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf76"><mml:mi>p</mml:mi></mml:math></inline-formula> is reward probability conveyed through flashes, and <inline-formula><mml:math id="inf77"><mml:mi>V</mml:mi></mml:math></inline-formula> is the volume offer conveyed through Poisson clicks. Values were binned on a log-2 scale: <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">L</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">R</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>12</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>12</mml:mn><mml:mo>,</mml:mo><mml:mn>24</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>24</mml:mn><mml:mo>,</mml:mo><mml:mn>48</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mi>μ</mml:mi><mml:mtext>l</mml:mtext><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Rewarded value is <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">rewVol</mml:mtext><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>12</mml:mn><mml:mo>,</mml:mo><mml:mn>24</mml:mn><mml:mo>,</mml:mo><mml:mn>48</mml:mn><mml:mi>μ</mml:mi><mml:mtext>l</mml:mtext><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>The conditional PSTH responses were z-scored, and then each conditional PSTH was averaged over the time window in which the behavioral variable was maximally encoded (dictated by peak location in CPD, see Materials and methods below) to obtain a conditional firing rate as a single feature for clustering. Specifically, the time windows for reward and reward volume information were averaged over <inline-formula><mml:math id="inf80"><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> after reward delivery, <inline-formula><mml:math id="inf81"><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> after trial start for reward history, <inline-formula><mml:math id="inf82"><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> after exiting the center port for left/right choice, and <inline-formula><mml:math id="inf83"><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> before the animal’s choice (i.e. entering the side port) for expected value of presented offers. These 19 features were combined and pre-processed using PCA in the same way as the PSTH-based clustering to yield 11 features.</p></sec><sec id="s4-3-2"><title>Evaluation of k-means cluster quality: gap statistic</title><p>For each clustering procedure, we utilized k-means clustering to locate groups of functionally distinct responses in lOFC, and used the gap statistic criterion to determine a principled choice of the best number of clusters (evalclusters.m in Matlab) (<xref ref-type="bibr" rid="bib65">Tibshirani et al., 2001</xref>). Specifically, we locate the largest cluster size <inline-formula><mml:math id="inf84"><mml:mi>K</mml:mi></mml:math></inline-formula> for which there was a significant jump in gap score <inline-formula><mml:math id="inf85"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>,<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≥</mml:mo><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This is similar to a standard option in evalclusters.m (‘SearchMethod’ = ‘firstMaxSE’), which finds the smallest instance in which a non-significant jump in cluster size is located. The two methods often agree. Finally, we used 5000 samples for the reference distribution to ensure convergence of results in the gap statistic.</p></sec><sec id="s4-3-3"><title>Alternative cluster evaluation metrics: silhouette score and adjusted Rand index (ARI)</title><p>The silhouette score calculates a weighted difference between inter- and intra-cluster distances. It yields high values for data that are tightly packed in the feature space and also far away from neighboring clusters. Intra-cluster distances for a data point <italic>i</italic> quantify the similarity of data within a cluster as,<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>J</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the Euclidean distance between points <italic>i</italic> and <inline-formula><mml:math id="inf87"><mml:mi>j</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf88"><mml:msub><mml:mi>N</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> is the number of data points in cluster <inline-formula><mml:math id="inf89"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. Similarly, the inter-cluster distance of data point <italic>i</italic> to data points of the closest neighboring cluster is given by<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mi>min</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The silhouette score is given by<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mstyle><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf90"><mml:mi>N</mml:mi></mml:math></inline-formula> is the number of data points. Silhouette scores were calculated in python using sklearn.metrics.silhouette_score with the default options (<italic>i.e</italic>, metric=‘euclidean’).</p><p>The adjusted Rand index is a measure of reproducibility of a dataset. In this context, it calculates the probability that two cluster labelings on related data would arise by chance. We calculated ARI in python using sklearn.metrics.adjusted_rand_score. To estimate statistics, we calculated ARI between a set of labels generated from our full dataset and a sub-sampled dataset for each cluster number <inline-formula><mml:math id="inf91"><mml:mi>K</mml:mi></mml:math></inline-formula>. We sampled 90% of the population without replacement, and generated 100 such datasets to get a distribution of ARI values for each value of <inline-formula><mml:math id="inf92"><mml:mi>K</mml:mi></mml:math></inline-formula>.</p><p>To study the behavior of the silhouette score in the same data regime as the lOFC neural data, we generated ground-truth datasets of <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula> data points with different ratios of within-cluster and total data covariance. In particular, we generated datasets with a K = 5 clusters (100 data points per cluster) that had the same dimensionality (D = 121) and the same total data covariance as the neural data. These clusters had within-cluster covariance that matched the average within-cluster covariance of the lOFC data. We then preprocessed this surrogate data in the same manner as our true data by projecting onto the PC components capturing <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi/><mml:mo>§gt;</mml:mo><mml:mrow><mml:mn>95</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> variance (total-data covariance and average within-cluster covariance shown in <xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6A,B</xref>), and performed silhouette score analysis in this dimensionality-reduced subspace. We investigated different ratios of within-cluster and across-cluster by scaling the total-data covariance by a constant factor <inline-formula><mml:math id="inf95"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to determine to what extent the silhouette score can detect clusters that are tightly packed in the feature space. To gather statistics for each ratio of variances, we generated 100 datasets with random cluster means (drawn from a multivariate normal distribution) and plotted the mean ± s.e.m silhouette scores (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6B</xref>). As a comparison, we also performed the gap statistic analysis on the same datasets (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6C</xref>). Finally, we visualized the groupings of these clusters by nonlinear projections (tSNE) in a two-dimensional feature space (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6D</xref>).</p></sec><sec id="s4-3-4"><title>Cluster labeling consistency and cluster similarity</title><p>To compare the consistency of results between the PSTH clustering and conditional clustering (<xref ref-type="fig" rid="fig2">Figure 2E</xref>), we calculated <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>conditional</mml:mtext></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>PSTH</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the conditional probability of a neuron being assigned to cluster <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>C</mml:mi><mml:mtext>conditional</mml:mtext></mml:msub></mml:math></inline-formula> from the conditional clustering procedure, given that it was assigned to cluster <inline-formula><mml:math id="inf98"><mml:msub><mml:mi>C</mml:mi><mml:mtext>PSTH</mml:mtext></mml:msub></mml:math></inline-formula> in the PSTH cluster procedure. We evaluated the similarity of clusters within a given clustering procedure in two ways. First, we performed TSNE embedding of the features space to visualize cluster similarity in two dimensions (sklearn.manifold.TSNE in python, perplexity = 50, n_iter = 5000) (<xref ref-type="bibr" rid="bib19">Hinton and Roweis, 2002</xref>). We then colored each sample in this 2-D space based on cluster identity (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A, B</xref>). We quantified the distance amongst clusters by calculating the cluster averaged Mahalanobis distance to the other clusters (<xref ref-type="bibr" rid="bib29">Mahalanobis, 1936</xref>). The Mahalanobis distance <inline-formula><mml:math id="inf99"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> calculates the distance of a sample <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> to a distribution <inline-formula><mml:math id="inf101"><mml:mi>B</mml:mi></mml:math></inline-formula> with a known mean, <inline-formula><mml:math id="inf102"><mml:msub><mml:mi>μ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, and covariance, <inline-formula><mml:math id="inf103"><mml:msub><mml:mi>S</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The cluster-averaged distances in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2C, D</xref> average <inline-formula><mml:math id="inf104"><mml:msub><mml:mi>D</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:math></inline-formula> over all samples from a given cluster <inline-formula><mml:math id="inf105"><mml:mi>A</mml:mi></mml:math></inline-formula> as<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-3-5"><title>PAIRS statistic</title><p>To test the null hypothesis that the data is not clustered at all, we followed the approach provided in <xref ref-type="bibr" rid="bib49">Raposo et al., 2014</xref>. We used our pre-processed PSTH and conditional feature spaces that were dimensionality reduced using PCA, and further processed them with a whitening transform so that the data had zero mean and unit covariance. For each data point, we estimated the average angle with <inline-formula><mml:math id="inf106"><mml:mi>k</mml:mi></mml:math></inline-formula> of its closest neighbors, <inline-formula><mml:math id="inf107"><mml:msub><mml:mi>θ</mml:mi><mml:mtext>data</mml:mtext></mml:msub></mml:math></inline-formula>. We then compared the data to independent draws from a reference Gaussian distribution (<inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">I</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>)), with the same number of data points and the same dimensionality as our data. To gather statistics, we generated <inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> of these null model datasets, and aggregated the estimated angles <inline-formula><mml:math id="inf110"><mml:msubsup><mml:mi>θ</mml:mi><mml:mtext>ref</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> into a grand reference distribution. We chose our number of nearest neighbors <inline-formula><mml:math id="inf111"><mml:mi>k</mml:mi></mml:math></inline-formula> for averaging by locating the <inline-formula><mml:math id="inf112"><mml:mi>k</mml:mi></mml:math></inline-formula> such that our reference distribution had a median angle greater than <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, following the approach in <xref ref-type="bibr" rid="bib49">Raposo et al., 2014</xref> (<italic>k</italic>=3 for PSTH clustering, <italic>k</italic>=8 for conditional clustering). Distributions of angles between neighboring datapoints are presented in <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>. We further quantified the similarity of these two distributions through a Kolmogorov Smirnov test.</p><p>PAIRS is a summary statistic of the entire population, using the median from the data distribution, <inline-formula><mml:math id="inf114"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mtext>data</mml:mtext></mml:msub></mml:math></inline-formula>, and the median of the grand reference distributions <inline-formula><mml:math id="inf115"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mtext>ref</mml:mtext></mml:msub></mml:math></inline-formula>,<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mtext>PAIRS</mml:mtext><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mtext>ref</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mtext>data</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mtext>ref</mml:mtext></mml:msub></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Reference PAIRS statistics were generated for each of the reference data sets, and statistical significance of the PAIRS statistic was assessed by calculating the two-sided p value for the data PAIRS compared to the distribution of reference PAIRS values. We assumed a normal distribution for the PAIRS reference values.</p></sec></sec><sec id="s4-4"><title>Generalized linear model of neural responses in lOFC</title><p>Our neural response model is a generalized linear model with an exponential link function that estimates the probability that spiking from a neuron will occur in time bin <inline-formula><mml:math id="inf116"><mml:mi>t</mml:mi></mml:math></inline-formula> with a rate <inline-formula><mml:math id="inf117"><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, and with Poisson noise, given a set of time-dependent task parameters. Specifically, for a design matrix <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> with <inline-formula><mml:math id="inf119"><mml:mi>S</mml:mi></mml:math></inline-formula> columns of task variables <inline-formula><mml:math id="inf120"><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>, the probability of observing <italic>y</italic><sub><italic>t</italic></sub> spikes from a neuron in time bin <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is modeled as,<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∗</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf122"><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is the rate parameter of the Poisson process. Task variables are linearly convolved with a set of response kernels <inline-formula><mml:math id="inf123"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that allow for a time-dependent response from a neuron that may occur after (causal) or before (acausal) the event in the trial. The kernels are composed of a set of <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> basis functions, <inline-formula><mml:math id="inf125"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>, linearly weighted by model parameters <inline-formula><mml:math id="inf126"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:munderover></mml:mstyle><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Additionally, we include a parameter <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> that captures the background firing rate of each neuron.</p><p>We used 15 time-dependent task variables in our model that indicate both the timing of an event in the task, as well as behavioral or conditional information. Parameterization of the model in this manner with a one-hot encoding of each condition per variable allows for asymmetric responses to different outcomes (e.g. wins vs. losses), and also captures the variable timing of each event in the task. The task variables were the following: (4) stimulus variables of left and right clicks and flashes (aligned to trial start). (4) Choice variables for choosing either the left of the right port (aligned to exit center port). Similarly, we included an alternate parameterization of choosing either the safe port (<inline-formula><mml:math id="inf128"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) or the risky port (<inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). (5) Outcome variables were wins or losses on the current trial (aligned to choice); and reward history variables of previous wins, losses, or a previous opt-opt (aligned to trial start). We included a previous reward rate task variable that was calculated as the average rewarded volume from all previous trials in the session (aligned to trial start). We also included a ‘session progress’ variable as the normalized [0,1] trial number in the session (aligned to trial start). This covariate captures motivational or satiety effects on firing rate over the course of a session. Finally, model comparison of cross-validated log-likelihood indicated that an autoregressive spike-history kernel was not necessary for our model.</p><sec id="s4-4-1"><title>Parameter learning, hyperparameter choice, and model validation</title><p>The set of parameters <inline-formula><mml:math id="inf130"><mml:mi>θ</mml:mi></mml:math></inline-formula> of the model are the kernel weights <inline-formula><mml:math id="inf131"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and the background firing rate <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and were fit by minimizing <inline-formula><mml:math id="inf133"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, the negative-log likelihood <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> with an additional <italic>L</italic><sub>2</sub> penalty acting as a prior over model parameters (<xref ref-type="bibr" rid="bib45">Park et al., 2014</xref>):<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mi>θ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Model parameters were chosen through four-fold cross validation, and <inline-formula><mml:math id="inf135"><mml:mi>ξ</mml:mi></mml:math></inline-formula> was found through a grid search optimization on a held-out test set. Specifically, we split the data from each neuron into five equal parts that were balanced among trial contingencies (i.e. equal amounts of wins/losses, previous wins/losses, and left/right choices per partition). One partition (test set) was not utilized in fitting <inline-formula><mml:math id="inf136"><mml:mi>θ</mml:mi></mml:math></inline-formula>, and was held out for later model comparison and hyperparameter choice. The remaining four partitions were used in cross validation to fit four models, with each model fit on three partitions and assessed on the fourth ‘validation’ partition. The model with the lowest negative log-likelihood on the validation set was chosen for further analysis. This procedure was repeated iteratively on an increasingly smaller grid of initial hyperparameter values <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the hyperparameter yielding the lowest negative log-likelihood on the test partition was chosen. We chose this approach for hyperparameter optimization in lieu of approximations such as calculating evidence (<xref ref-type="bibr" rid="bib4">Bishop, 2006</xref>), as we found the underlying approximations to be limiting for our data. In general, when building our model we assessed the aspects of other hyperparameter choices (i.e. kernel length, symmetric vs. asymmetric conditional kernels, number of task variables) with cross-validated negative log-likelihood on held-out test data. See the model comparison section below for further details. Finally, kernel covariances and standard deviations were estimated using the inverse of the Hessian of <inline-formula><mml:math id="inf138"><mml:mi class="ltx_font_mathcaligraphic">ℒ</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s4-4-2"><title>Basis functions</title><p>We utilized a log-scaled, raised cosine basis function set for our model (<xref ref-type="bibr" rid="bib45">Park et al., 2014</xref>). These functions offer the ability to generate impulse-like responses shortly after stimulus presentation, as well as broader, longer time-scale effects. The form of the basis function is given as<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf139"><mml:mi>a</mml:mi></mml:math></inline-formula> is parameter that controls breadth of support of each basis function, and <italic>b</italic><sub><italic>j</italic></sub> controls the location of its maxima. The parameters <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> were chosen to spread the set of basis functions <inline-formula><mml:math id="inf141"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> in roughly a log-linear placement across their range of support. This gives a better coverage than linear spacing, as the basis functions increase in breadth as <italic>b</italic><sub><italic>j</italic></sub> increases. We used 7 such functions, and additionally augmented our basis set with two decaying exponential basis functions placed in the first two time bins to capture any impulse-like behavior at the onset of the task variable. This gives <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> basis functions for all kernels in the study. After a cursory model comparison of different kernel lengths we took a conservative approach and utilized a range of support of 4 s for each kernel.</p></sec><sec id="s4-4-3"><title>Model comparison</title><p>To choose the best-fit model to our data, we performed model comparison on held-out testing data. For comparison, we considered models with additional task variables such as current and previously rewarded volume; as well as reduced models that omitted the variables relating to previous opt out trials, the previous reward rate, and the session progress. We also considered a reduced model that omitted the reward history contribution entirely. In each case, we assessed the population level change in model performance via a Wilcoxon signed rank test (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Our chosen model demonstrated a significantly lower population median in its negative log-likelihood than other models. We note that while our chosen model performed better than the reduced model at the population level, the median changes in neural responses were relatively slight (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1C</xref>, left panel). However, some neurons showed relatively strong improvement from introducing previousOptOut, previousRewardRate, and sessionProgress; which motivated us to keep them for the entire population (<italic>i.e</italic>., <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1C</xref>, middle panel). Additionally, we investigated a symmetrized form of our model that used a binary (±1) encoding of task variables, as opposed to a one-hot encoding. This model was rejected at the population level via model comparison (not shown).</p></sec></sec><sec id="s4-5"><title>Coefficient of partial determination</title><p>The coefficient of partial determination (CPD) is a measure of the relative amount of % variance explained by a given covariate, and here we use it to quantify the encoding of behavioral information in single units. The CPD is defined as <xref ref-type="bibr" rid="bib34">Miller et al., 2018</xref>:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:mi>P</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>all</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> is the trial-summed, squared error between data and model. <inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>all</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> refers to the full model with all covariates. <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> implies a reduced model with the effect of <inline-formula><mml:math id="inf146"><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> omitted. Since our model utilized a one-hot encoding for each condition, we calculated CPD by omitting the following groups of covariates: <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">reward</mml:mtext><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>win</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>loss</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">rewardHistory</mml:mtext><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>prevWin</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext> prevLoss</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>prevOptOut</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">choice</mml:mtext><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>left</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>right</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">clicks</mml:mtext><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Lclick</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Rclick</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">flashes</mml:mtext><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Lflash</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Rflash</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Our measure of CPD assessed the encoding of the covariate of interest (<italic>e.g</italic>., previous win or loss) separately from encoding of the general event-aligned response (<italic>e.g</italic>., trial start). As such, our reduced model averaged the kernels that corresponded to the event-aligned response to create behaviorally irrelevant task variables. For example, for CPD of reward encoding: <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>win</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>loss</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">→</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>win </mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>loss</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. For reward, reward history, and choice CPD calculations, we additionally weighted each trial type in <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> such that each condition contributed equally to CPD, and omitted any bias due to an imbalance in trial statistics. Due to data limitations, we utilized the full set of training, testing, and validation data to calculate CPD. Units with a model fit of <inline-formula><mml:math id="inf154"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>§gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (590/659 units) were used in CPD calculation. Additionally, we found that CPD measures for neurons can sometimes be noisy, and we further excluded neurons as outliers in the cluster-averaged CPD calculation if they had a CPD value &gt;0.5. This excluded a further 10 neurons.</p><p>We assessed the significance of the CPD result by comparing it to a null distribution of 500 CPD values that were generated by shuffling the trial labels among the relevant covariates (e.g. shuffle win and loss labels across trials, keeping timing of event and all other covariates fixed). CPD was deemed significant if it fell outside of the one-sided 95% confidence interval of the shuffle distribution, and plotted values in <xref ref-type="fig" rid="fig4">Figure 4</xref> subtract off the mean of the shuffle distribution from the CPD.</p></sec><sec id="s4-6"><title>Mutual information</title><p>Mutual information (MI) was used to calculate how much information about task variables is contained in lOFC firing rates, in different time windows throughout a trial. We calculated MI between spikes <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and a group of covariates <inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (detailed in the above section) as:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>M</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>The first term is the entropy of the stimulus, which is calculated from the empirical distribution. The second term is the conditional entropy of spiking, and requires calculation of the conditional distribution <inline-formula><mml:math id="inf157"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by marginalizing over the fully conditional distribution that contains all other covariates from the model.</p><p>We modeled the fully conditional distribution <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> via sampling of a doubly stochastic process, in which normal distributions of model parameters were propagated through our GLM and Poisson spiking. Specifically, for each time bin within each trial we sampled 500 parameter values from the normal distribution for each <inline-formula><mml:math id="inf159"><mml:mi>θ</mml:mi></mml:math></inline-formula>, where the covariance of <inline-formula><mml:math id="inf160"><mml:mi>θ</mml:mi></mml:math></inline-formula> was estimated as the inverse of the Hessian of <inline-formula><mml:math id="inf161"><mml:mi class="ltx_font_mathcaligraphic">ℒ</mml:mi></mml:math></inline-formula>. These samples were the passed through the exponential nonlinearity to generate a log-normal distribution of <inline-formula><mml:math id="inf162"><mml:mi>λ</mml:mi></mml:math></inline-formula> values, which were used as the rate parameter for a Poisson process that generated spikes. This spiking distribution of 500 samples was truncated at 10 spikes/50 ms bin (a 200 Hz cutoff), and the conditional distribution <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was then taken as the average over trials in which <inline-formula><mml:math id="inf164"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Units with a model fit of <inline-formula><mml:math id="inf165"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>§gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> were used in MI calculations. We assessed significance of MI in each time bin by comparing to an analogously created distribution of 500 MI values in which trial labels were shuffled. Significant MI fell outside of the 95% confidence interval of this distribution.</p></sec><sec id="s4-7"><title>Waveform analysis</title><p>To investigate if different types of neurons may underlie different clusters, we extracted the action potential (AP) peak and after-hyperpolarization (AHP) peak from the waveform associated with each single unit. Waveforms were recorded on tetrodes, and the channel with the highest amplitude signal was used for waveform analysis. An initial manual curation of the waveforms excluded 18/659 units with poor isolation of the largest-amplitude channel, due to damage of the electrode. The remaining waveforms were standardized by upsampling the waveform by a factor of 20, and then mean-subtracting and normalizing by their maximum range. AP and AHP peaks were identified, then a threshold around zero (<inline-formula><mml:math id="inf166"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>) was set to identify the beginning and end of the peak. We used the AP half-width rather than full width, as we found this to be a more robust measure of AP activity. Clustering of the two putative RSU and FSU units was performed using k-means.</p></sec><sec id="s4-8"><title>Discriminability for reward history</title><p>The discriminability between previous wins and previous losses in <xref ref-type="fig" rid="fig5">Figure 5C</xref> was calculated in its unsigned form<disp-formula id="equ16"><mml:math id="m16"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mtext>(prevWin)</mml:mtext></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mtext>(prevLoss)</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mtext>(prevWin)</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mtext>(prevLoss)</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To account for an inflated range of nonsignificant <inline-formula><mml:math id="inf167"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> values around zero due to the unsigned form of <inline-formula><mml:math id="inf168"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>, we subtracted from this quantity the mean <inline-formula><mml:math id="inf169"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> of a trial-shuffled distribution. The shuffled distribution was generated by shuffling trial labels 1,000 times. Significant <inline-formula><mml:math id="inf170"><mml:msup><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> values were identified as being outside of the one-sided 95% confidence interval of the shuffled distribution. Trial types were balanced when generating the shuffle distributions.</p></sec><sec id="s4-9"><title>Linear regression models of pre-choice and post-choice epochs</title><p>For the linear regression of pre-choice epoch in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>, the model used the trial history of wins and losses on the previous five trials as regressors, <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, the choice on that trial, <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and an offset term, <italic>c</italic><sub>0</sub>:<disp-formula id="equ17"><label>(16)</label><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mtext>choice</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mtext>win/loss</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mtext>win/loss</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The regressors were binary +1/–1 variables for win( + 1)/loss(–1) outcomes and left( + 1)/right(–1) choice. Model coefficients <inline-formula><mml:math id="inf173"><mml:mi>c</mml:mi></mml:math></inline-formula> were fit with Matlab’s fitlm function, and significance was assessed via an F-test comparing to the baseline model containing only <italic>c</italic><sub>0</sub>. The significance of each coefficient was assessed via a t-test with a cutoff of <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi>p</mml:mi><mml:mo>§lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> for significance.</p><p>Similarly, the results in <xref ref-type="fig" rid="fig6">Figure 6</xref> and <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref> investigating the adaptation of reward representations regressed <italic>r</italic><sub><italic>n</italic></sub>, the average firing rate in the 1 s interval after reward onset on each trial <inline-formula><mml:math id="inf175"><mml:mi>n</mml:mi></mml:math></inline-formula> (post-choice epoch), against previous and current trial outcomes. The first model investigated adaptation of the rewarded outcome representation by including a binary win( + 1)/loss(–1) regressor for current trial reward outcome, a binary win( + 1)/loss(–1) regressor for previous reward outcome, the left( + 1)/right(–1) choice on that trial, and an offset term:<disp-formula id="equ18"><label>(17)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>win/loss</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>win/loss</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>rewhist</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>win/loss</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>choice</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>choice</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Similarly, the other model investigating adaptation of reward volume representations instead used a regressor for rewarded volume, and a binary loss(1/0) regressor for outcome on the current trial:<disp-formula id="equ19"><label>(18)</label><mml:math id="m19"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>vol</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>vol</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>loss</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>loss</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>rewhist</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>win/loss</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>choice</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>choice</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Finally, the regression in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> modeled the post-choice epoch using a reward prediction error as a regressor:<disp-formula id="equ20"><label>(19)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>rpe</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>rpe</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>choice</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>choice</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where the RPE regressor was the difference in rewarded volume and the expected value of the chosen option on that trial: <inline-formula><mml:math id="inf176"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>rpe</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mtext>reward</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mtext>choose</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Formal analysis, Methodology, Software, Visualization, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Senior author on associated article, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Funding acquisition, Methodology, Project administration, Supervision, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Data curation, Funding acquisition, Investigation, Methodology, Project administration, Supervision, Writing - original draft, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>This study was performed in accordance with the National Institutes of Health standards. Animal use procedures were approved by the Princeton University Institutional Animal Care and Use Committee (protocol #1853).</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-70129-transrepform1-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Physiology, behavior, GLM statistical modeling, and clustering results source data are publicly available on Zenodo (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.5592702">https://doi.org/10.5281/zenodo.5592702</ext-link>). Code for the GLM model fit, clustering, and all subsequent analysis will also be provided publicly via Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/constantinoplelab/published">https://github.com/constantinoplelab/published</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:cd86802e0efc64e9d6b78408f260bd0982000b8c">https://archive.softwareheritage.org/swh:1:rev:cd86802e0efc64e9d6b78408f260bd0982000b8c</ext-link>).</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Hokcer</surname><given-names>D</given-names></name><name><surname>Savin</surname><given-names>C</given-names></name><name><surname>Constantinople</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Subpopulations of neurons in lOFC encode previous and current rewards at time of choice</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.5592702</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Carla Golden, Alex Piet, Abby Muthusamy, and Anne Churchland for helpful discussions and comments on the manuscript.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aronov</surname><given-names>D</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Engagement of neural circuits underlying 2d spatial navigation in a rodent virtual reality system</article-title><source>Neuron</source><volume>84</volume><fpage>442</fpage><lpage>456</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.08.042</pub-id><pub-id pub-id-type="pmid">25374363</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Averbeck</surname><given-names>BB</given-names></name><name><surname>Costa</surname><given-names>VD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Motivational neural circuits underlying reinforcement learning</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>505</fpage><lpage>512</lpage><pub-id pub-id-type="doi">10.1038/nn.4506</pub-id><pub-id pub-id-type="pmid">28352111</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ballesta</surname><given-names>S</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Conen</surname><given-names>KE</given-names></name><name><surname>Padoa-Schioppa</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Values encoded in orbitofrontal cortex are causally related to economic choices</article-title><source>Nature</source><volume>588</volume><fpage>450</fpage><lpage>453</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2880-x</pub-id><pub-id pub-id-type="pmid">33139951</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bishop</surname><given-names>CM</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Pattern Recognition and Machine Learning</source><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blanchard</surname><given-names>TC</given-names></name><name><surname>Wilke</surname><given-names>A</given-names></name><name><surname>Hayden</surname><given-names>BY</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Hot-hand bias in rhesus monkeys</article-title><source>Journal of Experimental Psychology</source><volume>40</volume><fpage>280</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1037/xan0000033</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Heeger</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Normalization as a canonical neural computation</article-title><source>Nature Reviews. Neuroscience</source><volume>13</volume><fpage>51</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1038/nrn3136</pub-id><pub-id pub-id-type="pmid">22108672</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conen</surname><given-names>KE</given-names></name><name><surname>Padoa-Schioppa</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Partial adaptation to the value range in the macaque orbitofrontal cortex</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>3498</fpage><lpage>3513</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2279-18.2019</pub-id><pub-id pub-id-type="pmid">30833513</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Constantinople</surname><given-names>CM</given-names></name><name><surname>Piet</surname><given-names>AT</given-names></name><name><surname>Bibawi</surname><given-names>P</given-names></name><name><surname>Akrami</surname><given-names>A</given-names></name><name><surname>Kopec</surname><given-names>C</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2019">2019a</year><article-title>Lateral orbitofrontal cortex promotes trial-by-trial learning of risky, but not spatial, biases</article-title><source>eLife</source><volume>8</volume><elocation-id>e49744</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.49744</pub-id><pub-id pub-id-type="pmid">31692447</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Constantinople</surname><given-names>CM</given-names></name><name><surname>Piet</surname><given-names>AT</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2019">2019b</year><article-title>An analysis of decision under risk in rats</article-title><source>Current Biology</source><volume>29</volume><fpage>2066</fpage><lpage>2074</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2019.05.013</pub-id><pub-id pub-id-type="pmid">31155352</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croson</surname><given-names>R</given-names></name><name><surname>Sundali</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The gambler’s fallacy and the hot hand: Empirical data from casinos</article-title><source>Journal of Risk and Uncertainty</source><volume>30</volume><fpage>195</fpage><lpage>209</lpage><pub-id pub-id-type="doi">10.1007/s11166-005-1153-2</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doya</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Complementary roles of basal ganglia and cerebellum in learning and motor control</article-title><source>Current Opinion in Neurobiology</source><volume>10</volume><fpage>732</fpage><lpage>739</lpage><pub-id pub-id-type="doi">10.1016/S0959-4388(00)00153-7</pub-id><pub-id pub-id-type="pmid">11240282</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallagher</surname><given-names>M</given-names></name><name><surname>McMahan</surname><given-names>RW</given-names></name><name><surname>Schoenbaum</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Orbitofrontal cortex and representation of incentive value in associative learning</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>6610</fpage><lpage>6614</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.19-15-06610.1999</pub-id><pub-id pub-id-type="pmid">10414988</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia-Dias</surname><given-names>R</given-names></name><name><surname>Prieto</surname><given-names>CA</given-names></name><name><surname>Almeida</surname><given-names>JS</given-names></name><name><surname>Ordovás-Pascual</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Machine learning in APOGEE: Unsupervised spectral classification with K-means</article-title><source>Astronomy &amp; Astrophysics</source><volume>612</volume><elocation-id>A98</elocation-id><pub-id pub-id-type="doi">10.1051/0004-6361/201732134</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Garcia-Dias</surname><given-names>R</given-names></name><name><surname>Vieira</surname><given-names>S</given-names></name><name><surname>Pinaya</surname><given-names>WHL</given-names></name><name><surname>Mechelli</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><chapter-title>Clustering analysis</chapter-title><person-group person-group-type="editor"><name><surname>Garcia-Dias</surname><given-names>R</given-names></name></person-group><source>Machine Learning</source><publisher-name>Elsevier</publisher-name><fpage>227</fpage><lpage>247</lpage></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname><given-names>MPH</given-names></name><name><surname>Sanchez</surname><given-names>D</given-names></name><name><surname>Conroy</surname><given-names>JC</given-names></name><name><surname>Wikenheiser</surname><given-names>AM</given-names></name><name><surname>Zhou</surname><given-names>J</given-names></name><name><surname>Schoenbaum</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Processing in lateral orbitofrontal cortex is required to estimate subjective preference during initial, but not established, economic choice</article-title><source>Neuron</source><volume>108</volume><fpage>526</fpage><lpage>537</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2020.08.010</pub-id><pub-id pub-id-type="pmid">32888408</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gremel</surname><given-names>CM</given-names></name><name><surname>Costa</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Orbitofrontal and striatal circuits dynamically encode the shift between goal-directed and habitual actions</article-title><source>Nature Communications</source><volume>4</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1038/ncomms3264</pub-id><pub-id pub-id-type="pmid">23921250</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Groman</surname><given-names>SM</given-names></name><name><surname>Keistler</surname><given-names>C</given-names></name><name><surname>Keip</surname><given-names>AJ</given-names></name><name><surname>Hammarlund</surname><given-names>E</given-names></name><name><surname>DiLeone</surname><given-names>RJ</given-names></name><name><surname>Pittenger</surname><given-names>C</given-names></name><name><surname>Lee</surname><given-names>D</given-names></name><name><surname>Taylor</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Orbitofrontal circuits control multiple reinforcement-learning processes</article-title><source>Neuron</source><volume>103</volume><fpage>734</fpage><lpage>746</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.05.042</pub-id><pub-id pub-id-type="pmid">31253468</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanks</surname><given-names>TD</given-names></name><name><surname>Kopec</surname><given-names>CD</given-names></name><name><surname>Brunton</surname><given-names>BW</given-names></name><name><surname>Duan</surname><given-names>CA</given-names></name><name><surname>Erlich</surname><given-names>JC</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Distinct relationships of parietal and prefrontal cortices to evidence accumulation</article-title><source>Nature</source><volume>520</volume><fpage>220</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1038/nature14066</pub-id><pub-id pub-id-type="pmid">25600270</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Hinton</surname><given-names>G</given-names></name><name><surname>Roweis</surname><given-names>ST</given-names></name></person-group><year iso-8601-date="2002">2002</year><conf-name>Stochastic neighbor embedding</conf-name><article-title>NIPS Citeseer</article-title><fpage>833</fpage><lpage>840</lpage></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hirokawa</surname><given-names>J</given-names></name><name><surname>Vaughan</surname><given-names>A</given-names></name><name><surname>Masset</surname><given-names>P</given-names></name><name><surname>Ott</surname><given-names>T</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Frontal cortex neuron types categorically encode single decision variables</article-title><source>Nature</source><volume>576</volume><fpage>446</fpage><lpage>451</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1816-9</pub-id><pub-id pub-id-type="pmid">31801999</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izquierdo</surname><given-names>A</given-names></name><name><surname>Suda</surname><given-names>RK</given-names></name><name><surname>Murray</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Bilateral orbital prefrontal cortex lesions in rhesus monkeys disrupt choices guided by both reward value and reward contingency</article-title><source>The Journal of Neuroscience</source><volume>24</volume><fpage>7540</fpage><lpage>7548</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1921-04.2004</pub-id><pub-id pub-id-type="pmid">15329401</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennerley</surname><given-names>SW</given-names></name><name><surname>Behrens</surname><given-names>TEJ</given-names></name><name><surname>Wallis</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Double dissociation of value computations in orbitofrontal and anterior cingulate neurons</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>1581</fpage><lpage>1589</lpage><pub-id pub-id-type="doi">10.1038/nn.2961</pub-id><pub-id pub-id-type="pmid">22037498</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobayashi</surname><given-names>S</given-names></name><name><surname>Pinto de Carvalho</surname><given-names>O</given-names></name><name><surname>Schultz</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Adaptation of reward sensitivity in orbitofrontal neurons</article-title><source>The Journal of Neuroscience</source><volume>30</volume><fpage>534</fpage><lpage>544</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4009-09.2010</pub-id><pub-id pub-id-type="pmid">20071516</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuwabara</surname><given-names>M</given-names></name><name><surname>Kang</surname><given-names>N</given-names></name><name><surname>Holy</surname><given-names>TE</given-names></name><name><surname>Padoa-Schioppa</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Neural mechanisms of economic choices in mice</article-title><source>eLife</source><volume>9</volume><elocation-id>e49669</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.49669</pub-id><pub-id pub-id-type="pmid">32096761</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lak</surname><given-names>A</given-names></name><name><surname>Hueske</surname><given-names>E</given-names></name><name><surname>Hirokawa</surname><given-names>J</given-names></name><name><surname>Masset</surname><given-names>P</given-names></name><name><surname>Ott</surname><given-names>T</given-names></name><name><surname>Urai</surname><given-names>AE</given-names></name><name><surname>Donner</surname><given-names>TH</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Tonegawa</surname><given-names>S</given-names></name><name><surname>Uchida</surname><given-names>N</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Reinforcement biases subsequent perceptual decisions when confidence is low, a widespread behavioral phenomenon</article-title><source>eLife</source><volume>9</volume><elocation-id>e49834</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.49834</pub-id><pub-id pub-id-type="pmid">32286227</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname><given-names>DJ</given-names></name><name><surname>Glimcher</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The root of all value: a neural common currency for choice</article-title><source>Current Opinion in Neurobiology</source><volume>22</volume><fpage>1027</fpage><lpage>1038</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2012.06.001</pub-id><pub-id pub-id-type="pmid">22766486</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Nie</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Yang</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Evidence accumulation for value computation in the prefrontal cortex during decision making</article-title><source>PNAS</source><volume>117</volume><fpage>30728</fpage><lpage>30737</lpage><pub-id pub-id-type="doi">10.1073/pnas.2019077117</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louie</surname><given-names>K</given-names></name><name><surname>Glimcher</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Efficient coding and the neural representation of value</article-title><source>Annals of the New York Academy of Sciences</source><volume>1251</volume><fpage>13</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1111/j.1749-6632.2012.06496.x</pub-id><pub-id pub-id-type="pmid">22694213</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Mahalanobis</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="1936">1936</year><conf-name>On the generalized distance in statistics</conf-name><article-title>Proceedings of the National Institute of Sciences (Calcutta) National Institute of Science of India; 1936</article-title></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mainen</surname><given-names>ZF</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Neural representation of behavioral outcomes in the orbitofrontal cortex</article-title><source>Current Opinion in Neurobiology</source><volume>19</volume><fpage>84</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2009.03.010</pub-id><pub-id pub-id-type="pmid">19427193</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mante</surname><given-names>V</given-names></name><name><surname>Sussillo</surname><given-names>D</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Newsome</surname><given-names>WT</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Context-dependent computation by recurrent dynamics in prefrontal cortex</article-title><source>Nature</source><volume>503</volume><fpage>78</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1038/nature12742</pub-id><pub-id pub-id-type="pmid">24201281</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDannald</surname><given-names>MA</given-names></name><name><surname>Lucantonio</surname><given-names>F</given-names></name><name><surname>Burke</surname><given-names>KA</given-names></name><name><surname>Niv</surname><given-names>Y</given-names></name><name><surname>Schoenbaum</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Ventral striatum and orbitofrontal cortex are both required for model-based, but not model-free, reinforcement learning</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>2700</fpage><lpage>2705</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5499-10.2011</pub-id><pub-id pub-id-type="pmid">21325538</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>KJ</given-names></name><name><surname>Botvinick</surname><given-names>MM</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dorsal hippocampus contributes to model-based planning</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>1269</fpage><lpage>1276</lpage><pub-id pub-id-type="doi">10.1038/nn.4613</pub-id><pub-id pub-id-type="pmid">28758995</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>KJ</given-names></name><name><surname>Botvinick</surname><given-names>MM</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Value Representations in Orbitofrontal Cortex Drive Learning, but Not Choice</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/245720</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mochol</surname><given-names>G</given-names></name><name><surname>Kiani</surname><given-names>R</given-names></name><name><surname>Moreno-Bote</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Prefrontal cortex represents heuristics that shape choice bias and its integration into future behavior</article-title><source>Current Biology</source><volume>31</volume><fpage>1234</fpage><lpage>1244</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2021.01.068</pub-id><pub-id pub-id-type="pmid">33639107</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Namboodiri</surname><given-names>VMK</given-names></name><name><surname>Otis</surname><given-names>JM</given-names></name><name><surname>van Heeswijk</surname><given-names>K</given-names></name><name><surname>Voets</surname><given-names>ES</given-names></name><name><surname>Alghorazi</surname><given-names>RA</given-names></name><name><surname>Rodriguez-Romaguera</surname><given-names>J</given-names></name><name><surname>Mihalas</surname><given-names>S</given-names></name><name><surname>Stuber</surname><given-names>GD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Single-cell activity tracking reveals that orbitofrontal neurons acquire and maintain a long-term memory to guide behavioral adaptation</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>1110</fpage><lpage>1121</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0408-1</pub-id><pub-id pub-id-type="pmid">31160741</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neiman</surname><given-names>T</given-names></name><name><surname>Loewenstein</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Reinforcement learning in professional basketball players</article-title><source>Nature Communications</source><volume>2</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1038/ncomms1580</pub-id><pub-id pub-id-type="pmid">22146388</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nickerson</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The production and perception of randomness</article-title><source>Psychological Review</source><volume>109</volume><fpage>330</fpage><lpage>357</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.109.2.330</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nogueira</surname><given-names>R</given-names></name><name><surname>Abolafia</surname><given-names>JM</given-names></name><name><surname>Drugowitsch</surname><given-names>J</given-names></name><name><surname>Balaguer-Ballester</surname><given-names>E</given-names></name><name><surname>Sanchez-Vives</surname><given-names>MV</given-names></name><name><surname>Moreno-Bote</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Lateral orbitofrontal cortex anticipates choices and integrates prior with current information</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>14823</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms14823</pub-id><pub-id pub-id-type="pmid">28337990</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noonan</surname><given-names>MP</given-names></name><name><surname>Walton</surname><given-names>ME</given-names></name><name><surname>Behrens</surname><given-names>TEJ</given-names></name><name><surname>Sallet</surname><given-names>J</given-names></name><name><surname>Buckley</surname><given-names>MJ</given-names></name><name><surname>Rushworth</surname><given-names>MFS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Separate value comparison and learning mechanisms in macaque medial and lateral orbitofrontal cortex</article-title><source>PNAS</source><volume>107</volume><fpage>20547</fpage><lpage>20552</lpage><pub-id pub-id-type="doi">10.1073/pnas.1012246107</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padoa-Schioppa</surname><given-names>C</given-names></name><name><surname>Assad</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Neurons in the orbitofrontal cortex encode economic value</article-title><source>Nature</source><volume>441</volume><fpage>223</fpage><lpage>226</lpage><pub-id pub-id-type="doi">10.1038/nature04676</pub-id><pub-id pub-id-type="pmid">16633341</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padoa-Schioppa</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Range-adapting representation of economic value in the orbitofrontal cortex</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>14004</fpage><lpage>14014</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3751-09.2009</pub-id><pub-id pub-id-type="pmid">19890010</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padoa-Schioppa</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Neurobiology of economic choice: a good-based model</article-title><source>Annual Review of Neuroscience</source><volume>34</volume><fpage>333</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-061010-113648</pub-id><pub-id pub-id-type="pmid">21456961</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padoa-Schioppa</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Neuronal origins of choice variability in economic decisions</article-title><source>Neuron</source><volume>80</volume><fpage>1322</fpage><lpage>1336</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.09.013</pub-id><pub-id pub-id-type="pmid">24314733</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>IM</given-names></name><name><surname>Meister</surname><given-names>MLR</given-names></name><name><surname>Huk</surname><given-names>AC</given-names></name><name><surname>Pillow</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Encoding and decoding in parietal cortex during sensorimotor decision-making</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1395</fpage><lpage>1403</lpage><pub-id pub-id-type="doi">10.1038/nn.3800</pub-id><pub-id pub-id-type="pmid">25174005</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pickens</surname><given-names>CL</given-names></name><name><surname>Saddoris</surname><given-names>MP</given-names></name><name><surname>Gallagher</surname><given-names>M</given-names></name><name><surname>Holland</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Orbitofrontal lesions impair use of cue-outcome associations in a devaluation task</article-title><source>Behavioral Neuroscience</source><volume>119</volume><fpage>317</fpage><lpage>322</lpage><pub-id pub-id-type="doi">10.1037/0735-7044.119.1.317</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Uzzell</surname><given-names>VJ</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Prediction and decoding of retinal ganglion cell responses with a probabilistic spiking model</article-title><source>The Journal of Neuroscience</source><volume>25</volume><fpage>11003</fpage><lpage>11013</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3305-05.2005</pub-id><pub-id pub-id-type="pmid">16306413</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Shlens</surname><given-names>J</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title><source>Nature</source><volume>454</volume><fpage>995</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1038/nature07140</pub-id><pub-id pub-id-type="pmid">18650810</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raposo</surname><given-names>D</given-names></name><name><surname>Kaufman</surname><given-names>MT</given-names></name><name><surname>Churchland</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A category-free neural population supports evolving demands during decision-making</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1784</fpage><lpage>1792</lpage><pub-id pub-id-type="doi">10.1038/nn.3865</pub-id><pub-id pub-id-type="pmid">25383902</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rich</surname><given-names>EL</given-names></name><name><surname>Wallis</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Decoding subjective decisions from orbitofrontal cortex</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>973</fpage><lpage>980</lpage><pub-id pub-id-type="doi">10.1038/nn.4320</pub-id><pub-id pub-id-type="pmid">27273768</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rigotti</surname><given-names>M</given-names></name><name><surname>Barak</surname><given-names>O</given-names></name><name><surname>Warden</surname><given-names>MR</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name><name><surname>Daw</surname><given-names>ND</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name><name><surname>Fusi</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The importance of mixed selectivity in complex cognitive tasks</article-title><source>Nature</source><volume>497</volume><fpage>585</fpage><lpage>590</lpage><pub-id pub-id-type="doi">10.1038/nature12160</pub-id><pub-id pub-id-type="pmid">23685452</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudebeck</surname><given-names>PH</given-names></name><name><surname>Murray</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The orbitofrontal oracle: cortical mechanisms for the prediction and evaluation of specific behavioral outcomes</article-title><source>Neuron</source><volume>84</volume><fpage>1143</fpage><lpage>1156</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.10.049</pub-id><pub-id pub-id-type="pmid">25521376</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rushworth</surname><given-names>MFS</given-names></name><name><surname>Noonan</surname><given-names>MP</given-names></name><name><surname>Boorman</surname><given-names>ED</given-names></name><name><surname>Walton</surname><given-names>ME</given-names></name><name><surname>Behrens</surname><given-names>TE</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Frontal cortex and reward-guided learning and decision-making</article-title><source>Neuron</source><volume>70</volume><fpage>1054</fpage><lpage>1069</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.05.014</pub-id><pub-id pub-id-type="pmid">21689594</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rustichini</surname><given-names>A</given-names></name><name><surname>Conen</surname><given-names>KE</given-names></name><name><surname>Cai</surname><given-names>X</given-names></name><name><surname>Padoa-Schioppa</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Optimal coding and neuronal adaptation in economic decisions</article-title><source>Nature Communications</source><volume>8</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1038/s41467-017-01373-y</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sadacca</surname><given-names>BF</given-names></name><name><surname>Wied</surname><given-names>HM</given-names></name><name><surname>Lopatina</surname><given-names>N</given-names></name><name><surname>Saini</surname><given-names>GK</given-names></name><name><surname>Nemirovsky</surname><given-names>D</given-names></name><name><surname>Schoenbaum</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Orbitofrontal neurons signal sensory associations underlying model-based inference in a sensory preconditioning task</article-title><source>eLife</source><volume>7</volume><elocation-id>e30373</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.30373</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schoenbaum</surname><given-names>G</given-names></name><name><surname>Chiba</surname><given-names>AA</given-names></name><name><surname>Gallagher</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Orbitofrontal cortex and basolateral amygdala encode expected outcomes during learning</article-title><source>Nature Neuroscience</source><volume>1</volume><fpage>155</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.1038/407</pub-id><pub-id pub-id-type="pmid">10195132</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simoncelli</surname><given-names>EP</given-names></name><name><surname>Olshausen</surname><given-names>BA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Natural image statistics and neural representation</article-title><source>Annual Review of Neuroscience</source><volume>24</volume><fpage>1193</fpage><lpage>1216</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.24.1.1193</pub-id><pub-id pub-id-type="pmid">11520932</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stalnaker</surname><given-names>TA</given-names></name><name><surname>Cooch</surname><given-names>NK</given-names></name><name><surname>McDannald</surname><given-names>MA</given-names></name><name><surname>Liu</surname><given-names>TL</given-names></name><name><surname>Wied</surname><given-names>H</given-names></name><name><surname>Schoenbaum</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Orbitofrontal neurons infer the value and identity of predicted outcomes</article-title><source>Nature Communications</source><volume>5</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1038/ncomms4926</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steiner</surname><given-names>AP</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The road not taken: neural correlates of decision making in orbitofrontal cortex</article-title><source>Frontiers in Neuroscience</source><volume>6</volume><elocation-id>131</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2012.00131</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steiner</surname><given-names>AP</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Behavioral and neurophysiological correlates of regret in rat decision-making on a neuroeconomic task</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>995</fpage><lpage>1002</lpage><pub-id pub-id-type="doi">10.1038/nn.3740</pub-id><pub-id pub-id-type="pmid">24908102</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sul</surname><given-names>JH</given-names></name><name><surname>Kim</surname><given-names>H</given-names></name><name><surname>Huh</surname><given-names>N</given-names></name><name><surname>Lee</surname><given-names>D</given-names></name><name><surname>Jung</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Distinct roles of rodent orbitofrontal and medial prefrontal cortex in decision making</article-title><source>Neuron</source><volume>66</volume><fpage>449</fpage><lpage>460</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.03.033</pub-id><pub-id pub-id-type="pmid">20471357</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takahashi</surname><given-names>YK</given-names></name><name><surname>Roesch</surname><given-names>MR</given-names></name><name><surname>Stalnaker</surname><given-names>TA</given-names></name><name><surname>Haney</surname><given-names>RZ</given-names></name><name><surname>Calu</surname><given-names>DJ</given-names></name><name><surname>Taylor</surname><given-names>AR</given-names></name><name><surname>Burke</surname><given-names>KA</given-names></name><name><surname>Schoenbaum</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The orbitofrontal cortex and ventral tegmental area are necessary for learning from unexpected outcomes</article-title><source>Neuron</source><volume>62</volume><fpage>269</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.03.005</pub-id><pub-id pub-id-type="pmid">19409271</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takahashi</surname><given-names>YK</given-names></name><name><surname>Chang</surname><given-names>CY</given-names></name><name><surname>Lucantonio</surname><given-names>F</given-names></name><name><surname>Haney</surname><given-names>RZ</given-names></name><name><surname>Berg</surname><given-names>BA</given-names></name><name><surname>Yau</surname><given-names>HJ</given-names></name><name><surname>Bonci</surname><given-names>A</given-names></name><name><surname>Schoenbaum</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Neural estimates of imagined outcomes in the orbitofrontal cortex drive behavior and learning</article-title><source>Neuron</source><volume>80</volume><fpage>507</fpage><lpage>518</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.08.008</pub-id><pub-id pub-id-type="pmid">24139047</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thorpe</surname><given-names>SJ</given-names></name><name><surname>Rolls</surname><given-names>ET</given-names></name><name><surname>Maddison</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>The orbitofrontal cortex: neuronal activity in the behaving monkey</article-title><source>Experimental Brain Research</source><volume>49</volume><fpage>93</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1007/BF00235545</pub-id><pub-id pub-id-type="pmid">6861938</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Walther</surname><given-names>G</given-names></name><name><surname>Hastie</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Estimating the number of clusters in a data set via the gap statistic</article-title><source>Journal of the Royal Statistical Society</source><volume>63</volume><fpage>411</fpage><lpage>423</lpage><pub-id pub-id-type="doi">10.1111/1467-9868.00293</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tremblay</surname><given-names>L</given-names></name><name><surname>Schultz</surname><given-names>W</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Relative reward preference in primate orbitofrontal cortex</article-title><source>Nature</source><volume>398</volume><fpage>704</fpage><lpage>708</lpage><pub-id pub-id-type="doi">10.1038/19525</pub-id><pub-id pub-id-type="pmid">10227292</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tymula</surname><given-names>A</given-names></name><name><surname>Glimcher</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Expected subjective value theory (esvt): A representation of decision under risk and certainty</article-title><source>SSRN Electronic Journal</source><volume>1</volume><elocation-id>2783638</elocation-id><pub-id pub-id-type="doi">10.2139/ssrn.2783638</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wallis</surname><given-names>JD</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Neuronal activity in primate dorsolateral and orbital prefrontal cortex during performance of a reward preference task</article-title><source>The European Journal of Neuroscience</source><volume>18</volume><fpage>2069</fpage><lpage>2081</lpage><pub-id pub-id-type="doi">10.1046/j.1460-9568.2003.02922.x</pub-id><pub-id pub-id-type="pmid">14622240</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wallis</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Orbitofrontal cortex and its contribution to decision-making</article-title><source>Annual Review of Neuroscience</source><volume>30</volume><fpage>31</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.30.051606.094334</pub-id><pub-id pub-id-type="pmid">17417936</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Webb</surname><given-names>R</given-names></name><name><surname>Glimcher</surname><given-names>PW</given-names></name><name><surname>Louie</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Rationalizing context-dependent preferences: divisive normalization and neurobiological constraints on choice</article-title><source>SSRN Electronic Journal</source><volume>10</volume><elocation-id>2462895</elocation-id><pub-id pub-id-type="doi">10.2139/ssrn.2462895</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>West</surname><given-names>EA</given-names></name><name><surname>DesJardin</surname><given-names>JT</given-names></name><name><surname>Gale</surname><given-names>K</given-names></name><name><surname>Malkova</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Transient inactivation of orbitofrontal cortex blocks reinforcer devaluation in macaques</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>15128</fpage><lpage>15135</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3295-11.2011</pub-id><pub-id pub-id-type="pmid">22016546</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>RC</given-names></name><name><surname>Takahashi</surname><given-names>YK</given-names></name><name><surname>Schoenbaum</surname><given-names>G</given-names></name><name><surname>Niv</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Orbitofrontal cortex as a cognitive map of task space</article-title><source>Neuron</source><volume>81</volume><fpage>267</fpage><lpage>279</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.11.005</pub-id><pub-id pub-id-type="pmid">24462094</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yagishita</surname><given-names>S</given-names></name><name><surname>Hayashi-Takagi</surname><given-names>A</given-names></name><name><surname>Ellis-Davies</surname><given-names>GCR</given-names></name><name><surname>Urakubo</surname><given-names>H</given-names></name><name><surname>Ishii</surname><given-names>S</given-names></name><name><surname>Kasai</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A critical time window for dopamine actions on the structural plasticity of dendritic spines</article-title><source>Science</source><volume>345</volume><fpage>1616</fpage><lpage>1620</lpage><pub-id pub-id-type="doi">10.1126/science.1255514</pub-id><pub-id pub-id-type="pmid">25258080</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamada</surname><given-names>H</given-names></name><name><surname>Louie</surname><given-names>K</given-names></name><name><surname>Tymula</surname><given-names>A</given-names></name><name><surname>Glimcher</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Free choice shapes normalized value signals in medial orbitofrontal cortex</article-title><source>Nature Communications</source><volume>9</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1038/s41467-017-02614-w</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.70129.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group></front-stub><body><p>This study used advanced statistical methods to classify the responses of neurons in the lateral orbito-frontal cortex (lOFC) of rats performing economic choices. The authors report that lOFC neurons can be classified into a small number of distinct types based on their characteristic temporal dynamics and preferences for task variables (e.g., choice, success, reward history). The results will be of interest to neuroscientists studying prefrontal cortex, as they demonstrate order amidst what would appear as disorganized diversity, and suggest that some neuronal types play specific functional roles; for instance, in integrating previous trial outcomes into a current choice.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.70129.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Salinas</surname><given-names>Emilio</given-names></name><role>Reviewing Editor</role><aff><institution>Wake Forest School of Medicine</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Salinas</surname><given-names>Emilio</given-names></name><role>Reviewer</role><aff><institution>Wake Forest School of Medicine</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Masset</surname><given-names>Paul</given-names></name><role>Reviewer</role></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Subpopulations of neurons in lOFC encode previous and current rewards at time of choice&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Emilio Salinas as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Floris de Lange as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Paul Masset (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>The reviewers agreed that this is a valuable and interesting study (see reviews below). They suggested additional analyses that would strengthen the main conclusion of the study, because the clustering methods are not conclusive about the presence of distinct subpopulations. The thought is that any additional evidence in support of the central claims would be helpful.</p><p>1) The authors should consider separation metrics that have been used in previous studies (the silhouette score and the adjusted rand index) and compare the optimal number of clusters found with these metrics with their analysis using the gap statistics. This would give better insight into the parameters controlling the complexity of the responses at the level of populations. See comment from Rev 2.</p><p>2) It would also be interesting if the authors compared the properties of neurons in cluster 3 to those of striatum-projecting neurons (and their associated cluster) found in a previous study (Hirokawa et al., 2019). Potentially, this could show that the clustering methods presented here can robustly identify similar populations of neurons across behavioral tasks, and would also provide a potential mechanistic basis for the learning effects mediated by OFC. See comment from Rev 2.</p><p>3) If data are available/appropriate, determine whether neurons have narrow or broad spikes, thus providing another potential criterion for characterizing the clusters. See comment from Rev 3.</p><p>4) In Figure 2C it seems that clusters largely differ by their late responses at the end of the trials. Does a cluster analysis based on the late parts of the PSTHs lead to similar results to those found? See comment from Rev 3.</p><p>5) The endorsement of adaptive value coding as something that OFC is dedicated to is perhaps a bit too optimistic, considering that only 15% of neurons demonstrated it (see comment from Rev 1). The authors should consider a more balanced discussion of this point.</p><p>6) The authors mention that the neurons in cluster 3 might support the integration of reward signals, but it is largely unclear why, especially from a computational point of view. Why do history and current trial reward signals ought to be integrated in this task? Spelling this out would be useful.</p><p><italic>Reviewer #1:</italic></p><p>This is a clear and concise manuscript that aims to understand the diversity of responses observed in the lOFC, a structure implicated in the assignment of value to different available choices, and in monitoring the outcomes of those choices. The work has many technical strengths:</p><p>– Multiple statistical methods and measures are used to determine whether there are identifiable neuronal types in lOFC, and what their distinct properties are.</p><p>– The methods are comprehensive, well described, and attempt a relatively unbiased, agnostic characterization of the recorded neural activity.</p><p>– The behavioral task is rich, and the results are a natural complement to a previous paper describing other aspects of this same dataset.</p><p>– The analysis is thorough. The conclusions are judicious, and are justified by the data.</p><p>Few weaknesses were noted. Perhaps the case in favor of adaptive coding is a bit exaggerated, but this is a minor issue of interpretation.</p><p>The most notable result is that one particular group of neurons encodes past reward history just before an impending choice, and may play a unique role in guiding or biasing the choice accordingly. Although this is not hugely surprising, and further experiments would be needed to prove this idea, it does demonstrate a high degree of order and functional specialization that would not be apparent without careful classification of neuronal properties. More generally, the methods and results should resonate with a wide audience, because classifying a large population of neurons into functionally significant subgroups is a problem that systems neuroscientists face in virtually every task and neural circuit.</p><p><italic>Reviewer #2:</italic></p><p>The firing patterns of single neurons in prefrontal cortex exhibit a large functional diversity. However, recent work has shown that behind this diversity there is significant structure and that this structure could be supported by the cell types and projection targets of prefrontal neurons. In this paper, the authors refine our understanding of this structure by developing new analysis methods. This paper re-analyzes single neuron data recorded in the lateral orbitofrontal cortex (OFC) in a complex behavioral task in which rats must choose between two options of varying reward probability and reward size. The authors' goal is to use dimensionality reduction methods and clustering to identify distinct neural subpopulations that underlie computations thought to be performed in OFC.</p><p>The authors use either the peri-stimulus time histograms (PSTHs) or tuning to specific task features to show that the populations of OFC neurons cluster in distinct subpopulations. Across the two methods, two clusters share a large number of cells, and one of these appears to carry a reward history signal. Just before the choice (and therefore the outcome of the current trial), one of the clusters exhibits an increased selectivity for the outcome of the previous trial. This is the kind of signal the authors were looking for and is consistent with the role of OFC in learning. The specificity here is that this signal is confined to a subpopulation of OFC neurons identified through the clustering procedure.</p><p>A key strength of the paper is that they use several methods to show that the structure they identify is robust to the features used for clustering and that the clusters exhibit a diversity of functional tuning to behaviorally relevant task parameters (reward, choice, etc). Specifically, they show that two major clusters of cells are conserved whether the clustering is performed on the temporal dynamics of the PSTHs or the tuning to task parameters. They then performed a Generalized Linear Model (GLM) analysis to identify the time course of tuning to several behaviorally relevant task variables. Again, they used two metrics of selectivity (coefficient of partial determination and mutual information) and these two metrics give similar results, strengthening their conclusions. Across the clusters the neurons exhibit broadly similar time courses of tuning. The two most striking departures from the population average occur for neurons in the two clusters that are most conserved across clustering techniques. This suggests that the neurons in these two clusters convey specific task related information. One of these clusters shows an increase in selectivity about the outcome in the previous trial right before the outcome in the current trial is revealed. This selectivity is highlighted as a possible contribution of this specific subpopulation to the known role of OFC in learning in uncertain environments.</p><p>This is an interesting paper that goes further than previous work in the prefrontal cortex in characterizing the structure of neuronal populations by using a novel combination of analysis techniques. However, the authors could perform a few additional analyses that would strengthen the paper, allow a more direct comparison with other results in the literature and bring more biological insights. The type of combined analysis presented here (clustering using different types of features, GLM reconstruction of the firing rates, etc) is likely to become a standard prerequisite when analyzing recordings from single neurons in behaving animals.</p><p>Comments for the authors:</p><p>The authors present a nice set of analyses that are well executed but a few more characterizations of the results could strengthen the biological findings.</p><p>1. As the authors point out, their analysis identifies fewer clusters than previous work attempting to cluster the functional properties of OFC neurons. The dimensionality of representations in neural circuits is thought to be partially constrained by task complexity and it would strengthen the authors' argument if they showed that this result holds across different cluster separation metrics. The authors should use both metrics that have been used in previous studies (the silhouette score and the adjusted rand index) and compare the optimal number of clusters found with these metrics with their analysis using the gap statistics. This would give a better insight into the parameters controlling the complexity of the responses at the level of populations. This comparison would provide some evidence as to whether the dimensionality is constrained by task complexity or by the structure of the neural circuits in prefrontal cortex and strengthen the biological findings in the paper.</p><p>2. On that note, it would be interesting if the authors compared the properties of neurons in cluster 3 to those of striatum-projecting neurons (and their associated cluster) found in a previous study (Hirokawa et al., 2019). Here, the authors show that neurons in cluster 3 have a strong response to the outcome (Figure 3) and to the reward history (Figure 4). Furthermore, they have an elevated firing rate prior to the trial start (Figure 1). It would be interesting to see the PSTHs for these neurons into the next trial separated by whether the trial was rewarded or not. If these neurons follow the same pattern as the striatum-projecting neurons in the previous study, it could indicate that the clustering method presented here can robustly identify similar populations of neurons across behavioral tasks. This would also provide a potential mechanistic basis for the learning effects mediated by OFC.</p><p><italic>Reviewer #3:</italic></p><p>I think this is a well-done analysis, but I see some potential limitations in the methods and in the conclusions. First, it is unclear whether the observed clusters actually correspond to distinct neuronal types, or whether they are just functionally different. One potential analysis (if data is available) is to study whether neurons have narrow or broad spikes, thus giving additional insights as to the nature of the clusters.</p><p>In Figure 2C it looks that clusters largely differ by their late responses at the end of the trials. Does a cluster analysis based on the late parts of the PSTHs lead to similar results to those found?</p><p>The authors show that cluster 3 exhibit the most prominent response to reward, but based on the PSTH clustering, the difference is very small. In addition, the increase in CPD for encoding reward history (Figure 5) is very small, although real. In principle I don't have any problems with the small effect sizes but, given that the authors make somehow strong claims about that, I am worried about the implications of the observation. The authors claim that this might support integration of reward signals, but it is largely unclear why, especially from a computational point of view: why do history and current trial reward signals ought to be integrated in this task?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.70129.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>The reviewers agreed that this is a valuable and interesting study (see reviews below). They suggested additional analyses that would strengthen the main conclusion of the study, because the clustering methods are not conclusive about the presence of distinct subpopulations. The thought is that any additional evidence in support of the central claims would be helpful.</p><p>1) The authors should consider separation metrics that have been used in previous studies (the silhouette score and the adjusted rand index) and compare the optimal number of clusters found with these metrics with their analysis using the gap statistics. This would give better insight into the parameters controlling the complexity of the responses at the level of populations. See comment from Rev 2.</p></disp-quote><p>We investigated the silhouette score and adjusted rand index for our features space representation of lOFC responses. Both methods suggested that 2 clusters were present in our dataset. Using additional analyses we demonstrated that neither method is well-suited to make a principled choice of cluster size for our lOFC response. The adjusted rand index, a measure of reproducibility of a clustering result, demonstrated that a large range of cluster sizes (2-8) could be robustly identified in our data, including our primary result of 5 clusters. Therefore, the results from this metric were not definitive about the number of clusters. The silhouette score did not have a clear peak for a specific number of clusters, and instead exhibited a monotonic decay for larger cluster numbers. The silhouette score is known to be inaccurate in certain data regimes (see Garcia-Dias et al., 2018 and 2020), and should be utilized only when the silhouette score results are definitive. The silhouette score is designed to locate clustered data that is both tightly packed together within a cluster, but also well separated and distanced from neighboring clusters. We hypothesized that this penalty for “crowded” clusters may be responsible for our inconclusive silhouette score result, and performed a study on ground-truth data with varying cluster spacing. We found that the silhouette score consistently underestimated the number of clusters in this study in the regime of lOFC responses, and reproduced the same decaying silhouette score values as in our data. We also found that the gap statistic underestimated the number of clusters in ground truth data, but did so to a much lesser degree. This conservative estimation of cluster numbers may be responsible for the discrepancy between our result of 5 clusters, and larger cluster numbers from other groups (<italic>e.g</italic>., Hirokawa et al. 2019).</p><p>The changes to the manuscript were the following:</p><p>– Reporting of the silhouette score and adjusted rand index is given in a Figure 2-figure supplement 5.</p><p>– Results of a ground-truth synthetic data study of the silhouette score is provided in Figure 2-figure supplement 6.</p><p>– A comparison of these methods, as well as a justification for utilizing the gap statistic over the other methods, is provided in the Results section.</p><p>– A description of how we calculated the silhouette score and ARI is provided in the Methods section.</p><p>– A description of the ground-truth study formulation is provided in the Methods section.</p><disp-quote content-type="editor-comment"><p>2) It would also be interesting if the authors compared the properties of neurons in cluster 3 to those of striatum-projecting neurons (and their associated cluster) found in a previous study (Hirokawa et al., 2019). Potentially, this could show that the clustering methods presented here can robustly identify similar populations of neurons across behavioral tasks, and would also provide a potential mechanistic basis for the learning effects mediated by OFC. See comment from Rev 2.</p></disp-quote><p>We investigated if particular clusters in our data had similar encoding properties to the striatum-projecting neurons that were identified in (Hirokawa et al., 2019). In that work, those neurons encoded the reward outcome following reward delivery, with larger responses for unrewarded trials, and also persistently encoded negative integrated value during the inter-trial interval until the start of the next trial. We evaluated the cluster-averaged responses for different reward volumes at reward delivery and trial start, and found that while several clusters encoded reward outcome after reward delivery, only cluster 3 also encoded the magnitude of reward volume during the inter-trial interval. Moreover, cluster 3 neurons exhibited qualitatively similar encoding to the corticostriatal cells from Hirokawa et al., in which they exhibited smaller responses for larger rewards, and the largest responses following unrewarded trials. We believe that this cluster may correspond to striatum-projecting neurons. We discuss these implications, including the possibility of a neural substrate of sequential learning effects, further in the Discussion section.</p><p>The changes to the manuscript were the following:</p><p>– We included a new section in the Results section that describes the corticostriatal projection neurons and their encoding properties from Hirokawa et al.<italic>, 2019,</italic> and added Figure 7 to the Results section, which compares our cluster-averaged responses for different reward volumes.</p><p>– We discuss the implications of cluster 3 being a potential set of striatum-projecting neurons in the Discussion section.</p><p>– We added this primary result to the abstract of the manuscript.</p><disp-quote content-type="editor-comment"><p>3) If data are available/appropriate, determine whether neurons have narrow or broad spikes, thus providing another potential criterion for characterizing the clusters. See comment from Rev 3.</p></disp-quote><p>We have included additional analysis on the waveform. We adopted an analysis from Bruno and Simons (J. Neuroscience, 2002) in which we compared the widths of the action potential (AP) and the after-hyperpolarization (AHP) activity. Similar to that work, we found two clusters of neurons when looking at AP and AHP: One cluster of neurons contained shorter AP and AHP activity, while a second cluster contained slower AP and AHP activity. When using AP and AHP widths as potential criterion for further characterizing our 5 clusters from the main text of the manuscript, we found no relationship between slow or fast single units and our 5 clusters. Specifically, we found that the distribution of the two cell types was similar across clusters.</p><p>The changes to the manuscript were the following:</p><p>– We added Figure 4-figure supplement 1, which shows the distribution of putative regular and fast-spiking cells across clusters, as well as details of the waveform analysis.</p><p>– We added a description of how we performed the analysis in the Methods Section.</p><p>– We added a brief section to the Results section.</p><disp-quote content-type="editor-comment"><p>4) In Figure 2C it seems that clusters largely differ by their late responses at the end of the trials. Does a cluster analysis based on the late parts of the PSTHs lead to similar results to those found? See comment from Rev 3.</p></disp-quote><p>We performed clustering based on PSTHs aligned to when the animal leaves the center port to make a choice. Assessment of cluster size using the Gap statistic yielded a similar number of clusters, K=6. The partitioning of units based on choice-aligned PSTHs was very similar to that based on PSTHs aligned to the start of the trial. Furthermore, it revealed a noteworthy, finer-scale structure to the reward history encoding seen late in the trial: The additional cluster from this analysis partitioned reward history encoding to just before choice (cluster 3), and precisely at choice (cluster 5). Given that this was the only major distinction between encoding of task attributes between the two clustering approaches, we have kept our original analyses, using responses aligned to trial start, in the main text, and have added the results of this late-in-trial clustering to the Supplemental Information.</p><p>The changes to the manuscript were the following:</p><p>– We added the results of this new clustering approach in Figure 5-figure supplement 2, and mentioned them in the Results section.</p><disp-quote content-type="editor-comment"><p>5) The endorsement of adaptive value coding as something that OFC is dedicated to is perhaps a bit too optimistic, considering that only 15% of neurons demonstrated it (see comment from Rev 1). The authors should consider a more balanced discussion of this point.</p></disp-quote><p>The changes to the manuscript were the following:</p><p>– We have relaxed our interpretation of adaptive value coding being dedicated to OFC in the Discussion section. We acknowledge that 15% is a modest fraction of neurons, and emphasize that adaptive value coding is probably not specific to OFC, but occurs broadly in brain areas representing subjective value.</p><disp-quote content-type="editor-comment"><p>6) The authors mention that the neurons in cluster 3 might support the integration of reward signals, but it is largely unclear why, especially from a computational point of view. Why do history and current trial reward signals ought to be integrated in this task? Spelling this out would be useful.</p></disp-quote><p>Given the new result that cluster 3 neurons exhibit qualitatively similar responses to striatum-projection neurons (Hirokawa et al., 2019), we have included a discussion of how these representations of reward history and current reward outcome may affect trial-by-trial learning. Specifically, we discuss the implications of these coincident signals in the context of reinforcement learning accounts of the basal ganglia, in which corticostriatal projection neurons may be representing information about the animal’s state, and corticostriatal synapses represent that value of performing particular actions in that state (Q-values). Coincident activation of cortical inputs and striatal spiking would allow synapses to be tagged for plasticity in the presence of dopamine, thereby modulating state-action values with experience. We speculate that if reward history and current trial reward signals are coincidently represented, then contextual inputs to the striatum that reflect the animal's “state,” and that could be plastically modified in the presence of dopamine, would include the conjunction of previous and current rewards (i.e., I was rewarded on the previous trial, and then rewarded again. I am on a winning streak).</p><p>While there is no need for trial-by-trial learning in this task, as reward contingencies are independent and explicitly cued on each trial, the evolutionary importance of learning about changes in dynamic environments may introduce these sub-optimal, sequential biases.</p><p>An alternative possibility, which we also discuss, is that the representations of reward history at the time of choice influence ongoing neural dynamics -in lOFC or downstream- that support the current choice, as in Mochol et al., 2021.</p><p>The changes to the manuscript were the following:</p><p>– We added additional text to the Discussion section where we describe representations of reward history.</p></body></sub-article></article>