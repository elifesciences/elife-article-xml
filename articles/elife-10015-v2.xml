<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">10015</article-id><article-id pub-id-type="doi">10.7554/eLife.10015</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Internal models for interpreting neural population activity during sensorimotor control</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-38261"><name><surname>Golub</surname><given-names>Matthew D</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4508-0537</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-38262"><name><surname>Yu</surname><given-names>Byron M</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-36482"><name><surname>Chase</surname><given-names>Steven M</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Electrical and Computer Engineering</institution>, <institution>Carnegie Mellon University</institution>, <addr-line><named-content content-type="city">Pittsburgh</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Center for the Neural Basis of Cognition</institution>, <institution>Carnegie Mellon University</institution>, <addr-line><named-content content-type="city">Pittsburgh</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Biomedical Engineering</institution>, <institution>Carnegie Mellon University</institution>, <addr-line><named-content content-type="city">Pittsburgh</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Behrens</surname><given-names>Timothy</given-names></name><role>Reviewing editor</role><aff id="aff4"><institution>Oxford University</institution>, <country>United Kingdom</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>byronyu@cmu.edu</email> (BMY);</corresp><corresp id="cor2"><email>schase@cmu.edu</email> (SMC)</corresp><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>08</day><month>12</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e10015</elocation-id><history><date date-type="received"><day>10</day><month>07</month><year>2015</year></date><date date-type="accepted"><day>25</day><month>11</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Golub et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Golub et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-10015-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.10015.001</object-id><p>To successfully guide limb movements, the brain takes in sensory information about the limb, internally tracks the state of the limb, and produces appropriate motor commands. It is widely believed that this process uses an internal model, which describes our prior beliefs about how the limb responds to motor commands. Here, we leveraged a brain-machine interface (BMI) paradigm in rhesus monkeys and novel statistical analyses of neural population activity to gain insight into moment-by-moment internal model computations. We discovered that a mismatch between subjects’ internal models and the actual BMI explains roughly 65% of movement errors, as well as long-standing deficiencies in BMI speed control. We then used the internal models to characterize how the neural population activity changes during BMI learning. More broadly, this work provides an approach for interpreting neural population activity in the context of how prior beliefs guide the transformation of sensory input to motor output.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.001">http://dx.doi.org/10.7554/eLife.10015.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.10015.002</object-id><title>eLife digest</title><p>The human brain is widely hypothesized to construct “inner beliefs” about how the world works. It is thought that we need this conception to coordinate our movements and anticipate rapid events that go on around us. A driver, for example, needs to predict how the car should behave in response to every turn of the steering wheel and every tap on the brake. But on icy roads, these predictions will often not reflect how the car would behave. Applying the brakes sharply in these conditions could send the car skidding uncontrollably rather than stopping. In general, a mismatch between one’s inner beliefs and reality is thought to cause errors and accidents. Yet this compelling hypothesis has not yet been fully investigated.</p><p>Golub et al. investigated this hypothesis by conducting a “brain-machine interface” experiment. In this experiment, neural signals from the brains of two rhesus macaques were recorded using arrays of electrodes and translated into movements of a cursor on a computer screen. The monkeys were then trained to mentally move the cursor to hit targets on the screen.</p><p>The monkeys’ cursor movements were remarkably precise. In fact, the experiment showed that the monkeys could internally predict their cursor movements just as a driver predicts how a car will move when turning the steering wheel. These findings indicate that the monkeys have likely developed inner beliefs to predict how their neural signals drive the cursor, and that these beliefs helped coordinate their performance.</p><p>In addition, when the monkeys did make mistakes, their neural signals were not entirely wrong—in fact they were typically consistent with the monkeys’ inner beliefs about how the cursor moves. A mismatch between these inner beliefs and reality explained most of the monkeys’ mistakes.</p><p>The brain constructs such inner beliefs over time through experience and learning. To study this learning process, Golub et al. next conducted an experiment in which the cursor moved in a way that was substantially different from the monkey’s inner beliefs. This experiment uncovered that, during the course of learning, the monkey’s inner beliefs realigned to better match the movements of the new cursor. Taken together, this work provides a framework for understanding how the brain transforms sensory information into instructions for movement. The findings could also help improve the performance of brain-machine interfaces and suggest how we can learn new skills more rapidly and proficiently in everyday life.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.002">http://dx.doi.org/10.7554/eLife.10015.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>motor control</kwd><kwd>internal models</kwd><kwd>brain-machine interfaces</kwd><kwd>rhesus macaque</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>IGERT</award-id><principal-award-recipient><name><surname>Golub</surname><given-names>Matthew D</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>NIH-NICHD-CRCNS-R01-HD-071686</award-id><principal-award-recipient><name><surname>Yu</surname><given-names>Byron M</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004897</institution-id><institution>Pennsylvania Department of Health</institution></institution-wrap></funding-source><award-id>C.U.R.E. SAP#4100057653</award-id><principal-award-recipient><name><surname>Chase</surname><given-names>Steven M</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A novel analysis of neural activity recorded in monkeys performing a “brain-machine interface” task reveals that a mismatch between motor effectors and the brains’ internal models of those effectors can explain a substantial portion of movement errors.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Even simple movements, like reaching to grasp a glass of water, require dozens of muscles to be activated with precise coordination. This precision is especially impressive in light of sensory feedback delays inherent to neural transmission and processing: when we make a swift arm movement, the brain only knows where the arm was a split second ago, not where it currently is. To generate the desired movement, it is widely believed that we form internal models that enable selection of appropriate motor commands and prediction of the outcomes of motor commands before sensory feedback becomes available (<xref ref-type="bibr" rid="bib7">Crapse and Sommer, 2008</xref>; <xref ref-type="bibr" rid="bib56">Shadmehr et al., 2010</xref>).</p><p>Mechanistic studies have made important progress toward identifying the neural circuits that implement internal models in sensory (<xref ref-type="bibr" rid="bib36">Komatsu, 2006</xref>; <xref ref-type="bibr" rid="bib33">Kennedy et al., 2014</xref>; <xref ref-type="bibr" rid="bib49">Schneider et al., 2014</xref>), vestibular (<xref ref-type="bibr" rid="bib38">Laurens et al., 2013</xref>), and motor (<xref ref-type="bibr" rid="bib58">Sommer, 2002</xref>; <xref ref-type="bibr" rid="bib16">Ghasia et al., 2008</xref>; <xref ref-type="bibr" rid="bib32">Keller and Hahnloser, 2009</xref>; <xref ref-type="bibr" rid="bib2">Azim et al., 2014</xref>) systems. In parallel, psychophysical studies have demonstrated the behavioral correlates of these internal models (<xref ref-type="bibr" rid="bib55">Shadmehr and Mussa-Ivaldi, 1994</xref>; <xref ref-type="bibr" rid="bib68">Wolpert et al., 1995</xref>; <xref ref-type="bibr" rid="bib63">Thoroughman and Shadmehr, 2000</xref>; <xref ref-type="bibr" rid="bib35">Kluzik et al., 2008</xref>; <xref ref-type="bibr" rid="bib43">Mischiati et al., 2015</xref>) and the behavioral deficits that result from lesions to corresponding brain areas (<xref ref-type="bibr" rid="bib54">Shadmehr and Krakauer, 2008</xref>; <xref ref-type="bibr" rid="bib4">Bhanpuri et al., 2013</xref>). Together with studies showing neural correlates of internal models (<xref ref-type="bibr" rid="bib58">Sommer, 2002</xref>; <xref ref-type="bibr" rid="bib24">Gribble and Scott, 2002</xref>; <xref ref-type="bibr" rid="bib16">Ghasia et al., 2008</xref>; <xref ref-type="bibr" rid="bib44">Mulliken et al., 2008</xref>; <xref ref-type="bibr" rid="bib32">Keller and Hahnloser, 2009</xref>; <xref ref-type="bibr" rid="bib22">Green and Angelaki, 2010</xref>; <xref ref-type="bibr" rid="bib3">Berkes et al., 2011</xref>; <xref ref-type="bibr" rid="bib38">Laurens et al., 2013</xref>), these previous studies have provided strong evidence for the brain’s use of internal models.</p><p>These internal models are presumably rich entities that reflect the multi-dimensional neural processes observed in many brain areas (<xref ref-type="bibr" rid="bib8">Cunningham and Yu, 2014</xref>) and can drive moment-by-moment decisions and motor output. However, to date, most studies have viewed internal models through the lens of individual neurons or low-dimensional behavioral measurements, which provides a limited view of these multi-dimensional neural processes (although see <xref ref-type="bibr" rid="bib3">Berkes et al., 2011</xref>). Here, we address these limitations by extracting a rich internal model from the activity of tens of neurons recorded simultaneously. The key question that we ask is whether such an internal model can explain behavioral errors that cannot be explained by analyzing low-dimensional behavioral measurements in isolation.</p><p>We define an internal model to be one’s inner conception of a motor effector, which includes one’s prior beliefs about the physics of the effector as well as how neural commands drive movements of the effector. When we extract a subject’s internal model, we seek a statistical model of the effector dynamics that is most consistent with the subject’s neural commands. Interpreting high-dimensional neural activity through the lens of such an internal model offers insight into how one’s prior beliefs about the effector affect the transformation of sensory inputs into population-level motor commands on a timescale of tens of milliseconds.</p><p>To date, it has been difficult to identify such an internal model due the complexities of non-linear effector dynamics and multiple sensory feedback modalities, the need to monitor many neurons simultaneously, and the lack of an appropriate statistical algorithm. To overcome these difficulties, we leveraged a closed-loop brain-machine interface (BMI) paradigm (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) in rhesus monkeys, which translates neural activity from the primary motor cortex (M1) into movements of a computer cursor (<xref ref-type="bibr" rid="bib23">Green and Kalaska, 2011</xref>). A BMI represents a simplified and well-defined feedback control system, which facilitates the study of internal models (<xref ref-type="bibr" rid="bib18">Golub et al., 2016</xref>). In particular, the BMI mapping from neural activity to movements is completely specified by the experimenter and can be chosen to define linear cursor dynamics, the relevant sensory feedback can be limited to one modality (in this case, vision), and all neural activity that directly drives the cursor is recorded.<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.10015.003</object-id><label>Figure 1.</label><caption><title>Closed-loop control of a brain-machine interface (BMI) cursor.</title><p>(<bold>A</bold>) Schematic view of the brain-machine interface. Subjects produce neural commands to drive a cursor to hit visual targets under visual feedback. (<bold>B</bold>) Cursor trajectories from the first 10 successful trials to each of 16 instructed targets (filled circles) in representative data sets. Target acquisition was initiated when the cursor visibly overlapped the target, or equivalently when the cursor center entered the cursor-target acceptance zone (dashed circles). Trajectories shown begin at the workspace center and proceed until target acquisition. Data are not shown during target holds.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.003">http://dx.doi.org/10.7554/eLife.10015.003</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Proficient control of the brain-machine interface (BMI). </title><p>(<bold>A</bold>) Histograms of within-session averaged success rates and (<bold>B</bold>) movement times across all sessions and both monkeys. Red lines denote averages across sessions, and triangles indicate the within-session averages for the example sessions from <xref ref-type="fig" rid="fig1">Figure 1B</xref>. Movement times were calculated as the time elapsed between target onset and target acquisition (i.e., excluding all hold times, but including reaction times).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.004">http://dx.doi.org/10.7554/eLife.10015.004</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig1-figsupp1-v2.tif"/></fig></fig-group></p><p>During proficient BMI control, as with other behavioral tasks, subjects make movement errors from time to time. One possible explanation for these errors is that they arise due to sensory or motor “noise” that varies randomly from one trial to the next (<xref ref-type="bibr" rid="bib25">Harris and Wolpert, 1998</xref>; <xref ref-type="bibr" rid="bib45">Osborne et al., 2005</xref>; <xref ref-type="bibr" rid="bib10">Faisal et al., 2008</xref>). Another possibility, which is the central hypothesis in this study, is that a substantial component of movement errors is structured and can be explained by a mismatch between the subject’s internal model of the BMI and the actual BMI mapping.</p><p>Testing this hypothesis required the development of a novel statistical method for estimating the subject’s internal model from the recorded M1 activity, BMI cursor movements, and behavioral task goals. The internal model represents the subject’s prior beliefs about the physics of the BMI cursor, as well as how the subject’s neural activity drives the cursor. To justify the study of internal models in a BMI context, we first asked whether subjects show evidence of internal prediction during BMI control. Next, we asked whether interpreting M1 activity through extracted internal models could explain movement errors that are present throughout proficient BMI control and long-standing deficiencies in control of BMI movement speed. Finally, because a key feature of internal models is their ability to adapt (<xref ref-type="bibr" rid="bib56">Shadmehr et al., 2010</xref>), we altered the BMI mapping and asked whether the internal model adapted in a manner consistent with the new BMI mapping.</p><p>An important distinction that we make relative to previous work is that we are not asking circuit-level questions about how and where in the brain these internal models operate. Rather, we seek a statistical representation of the subject’s prior beliefs about the BMI mapping (i.e., an internal model) that can be used to explain behavioral errors. Although internal models might not reside in M1 (<xref ref-type="bibr" rid="bib53">Shadmehr, 1997</xref>; <xref ref-type="bibr" rid="bib46">Pasalar et al., 2006</xref>; <xref ref-type="bibr" rid="bib42">Miall et al., 2007</xref>; <xref ref-type="bibr" rid="bib44">Mulliken et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Lisberger, 2009</xref>), their computations influence activity in M1. Thus, by examining the moment-by-moment relationship between M1 population activity and task objectives, it may be possible to extract a detailed representation of the subject’s internal model.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We trained two rhesus monkeys to modulate neural activity to drive movements of a computer cursor to hit targets in a two-dimensional workspace (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The family of BMI mappings that we used is represented by:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">Ax</mml:mi><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">Bu</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold">b</mml:mi></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> is the cursor state (position and velocity), <inline-formula><mml:math id="inf2"><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext mathvariant="italic">t</mml:mtext></mml:msub></mml:math></inline-formula> comprises the recorded M1 activity, and <inline-formula><mml:math id="inf3"><mml:mi mathvariant="bold">A</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf4"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf5"><mml:mi mathvariant="bold">b</mml:mi></mml:math></inline-formula> are the parameters of the BMI mapping. All experiments began with a closed-loop calibration of an <italic>intuitive BMI mapping</italic>, which was designed to provide proficient control on par with the majority of studies in the field (<xref ref-type="bibr" rid="bib52">Serruya et al., 2002</xref>; <xref ref-type="bibr" rid="bib65">Velliste et al., 2008</xref>; <xref ref-type="bibr" rid="bib14">Ganguly and Carmena, 2009</xref>; <xref ref-type="bibr" rid="bib60">Suminski et al., 2010</xref>; <xref ref-type="bibr" rid="bib26">Hauschild et al., 2012</xref>; <xref ref-type="bibr" rid="bib28">Ifft et al., 2013</xref>; <xref ref-type="bibr" rid="bib48">Sadtler et al., 2014</xref>). Subjects indeed demonstrated proficient and stable control of the BMI, with success rates of nearly 100%, and movement times on average faster than one second (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><p>The BMI provides an ideal paradigm for studying internal models because it simplifies several key complexities of native limb control. First, native limb control involves effectors with non-linear dynamics, and the causal relationship between the recorded neural activity and limb movements is not completely understood. In contrast, the causal relationship between recorded neural activity and BMI cursor movements is completely specified by the experimenter (through <inline-formula><mml:math id="inf6"><mml:mi mathvariant="bold">A</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf7"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf8"><mml:mi mathvariant="bold">b</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>), and can be chosen to be linear (as in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). Second, native limb control involves multiple modalities of sensory feedback (e.g., proprioception and vision), which makes it difficult for the experimenter to know how the subject combines sources of sensory information. In the BMI, task-relevant sensory feedback is limited to a single modality (vision), which is completely specified by the experimenter (<inline-formula><mml:math id="inf9"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). Finally, the neural activity that directly drives the BMI is completely specified by the recorded population activity (<inline-formula><mml:math id="inf10"><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>), whereas typically only a subset of neurons driving limb movements is recorded. We can thereby reinterpret the full set of BMI control signals using an internal model in a more concrete manner than is currently possible with limb movements.</p><sec id="s2-1"><title>Subjects compensate for sensory feedback delays while controlling a BMI</title><p>Because internal models have not previously been studied in a BMI context, we sought evidence of internal prediction. A hallmark of internal prediction is compensation for sensory feedback delays (<xref ref-type="bibr" rid="bib42">Miall et al., 2007</xref>; <xref ref-type="bibr" rid="bib56">Shadmehr et al., 2010</xref>; <xref ref-type="bibr" rid="bib11">Farshchiansadegh et al., 2015</xref>). To assess the visuomotor latency experienced by a subject in our BMI system, we measured the elapsed time between target onset and the appearance of target-related activity in the recorded neural population (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). The delays we measured (<inline-formula><mml:math id="inf11"><mml:mn>100</mml:mn></mml:math></inline-formula> ms, monkey A; <inline-formula><mml:math id="inf12"><mml:mn>133</mml:mn></mml:math></inline-formula> ms, monkey C) are consistent with visuomotor latencies reported in arm reaching studies of single-neurons in primary motor cortex (<xref ref-type="bibr" rid="bib50">Schwartz et al., 1988</xref>). Next, we asked whether subjects produced motor commands consistent with the current cursor position, which was not known to the subject due to visual feedback delay, or whether motor commands were more consistent with a previous, perceived position (<xref ref-type="fig" rid="fig2">Figure 2B,C</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). If subjects did not compensate for visual feedback delays and aimed from the most recently available visual feedback of cursor position, we would expect errors to be smallest at lags of 100 ms and 133 ms relative to the current cursor position for monkeys A and C, respectively (dashed red lines in <xref ref-type="fig" rid="fig2">Figure 2C</xref>). Rather, we found that these error curves had minima at lags close to 0 ms (dashed black lines in <xref ref-type="fig" rid="fig2">Figure 2C</xref>), indicating that motor commands through the BMI mapping pointed closer to the targets when originating from the current cursor position than from any previous position. This finding suggests that subjects use an internal model to internally predict the current cursor position.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.10015.005</object-id><label>Figure 2.</label><caption><title>Subjects compensate for sensory feedback delays while controlling a BMI. </title><p>(<bold>A</bold>) The visuomotor latency experienced by a subject in our BMI system was assessed by measuring the elapsed time between target onset and the first significant (<inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>) decrease in angular error. If that first decrease was detected <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> timesteps following target onset, we concluded that the visuomotor latency was at least <inline-formula><mml:math id="inf15"><mml:mi>τ</mml:mi></mml:math></inline-formula> timesteps (red dashed lines). For both subjects, the first significant difference was highly significant (**<inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, two-sided Wilcoxon test with Holm-Bonferroni correction for multiple comparisons; <inline-formula><mml:math id="inf17"><mml:mi>n</mml:mi></mml:math></inline-formula> = 5908 trials; monkey C: <inline-formula><mml:math id="inf18"><mml:mi>n</mml:mi></mml:math></inline-formula> = 4578 trials). (<bold>B</bold>) Conceptual illustration of a single motor command (black arrows) shifted to originate from positions lagged relative to the current cursor position (open circle). In this example, the command points farther from the target as it is shifted to originate from earlier cursor positions. (<bold>C</bold>) Motor commands pointed closer to the target when originating from the current cursor position (zero lag) than from outdated (positive lag) cursor positions that could be known from visual feedback alone (**<inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, two-sided Wilcoxon test; monkey A: <inline-formula><mml:math id="inf20"><mml:mi>n</mml:mi></mml:math></inline-formula> = 33,660 timesteps across 4489 trials; monkey C: <inline-formula><mml:math id="inf21"><mml:mi>n</mml:mi></mml:math></inline-formula> = 31,214 timesteps across 3639 trials). Red lines indicate subjects’ inherent visual feedback delays from panel A. Shaded regions in panels A and C (barely visible) indicate <inline-formula><mml:math id="inf22"> <mml:mo>± </mml:mo></mml:math></inline-formula> SEM.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.005">http://dx.doi.org/10.7554/eLife.10015.005</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.006</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Error metrics for assessing estimates of movement intent. </title><p>The primary error metric we used was the absolute angle by which a velocity command would have missed the target, taking into account the cursor and target radii. Because task success requires hitting the target (i.e., cursor-target overlap), we define all commands that would result in cursor-target overlap as having zero angular error. Mathematically, this corresponds to any velocity command that points within <inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>Z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM153"><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM152"><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> degrees from the target center, where <inline-formula><mml:math id="inf24"><mml:mi>D</mml:mi></mml:math></inline-formula> is the distance between target center and the position from which the velocity command originates, and <inline-formula><mml:math id="inf25"><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula> are the cursor and target radii, respectively. A velocity command that would not hit the target is given an error, <inline-formula><mml:math id="inf27"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula>, equal to the angle by which the cursor would have missed the target. Equivalently, we can consider the cursor-target overlap zone defined by a target-concentric circle with radius <inline-formula><mml:math id="inf28"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and define angular error, <inline-formula><mml:math id="inf29"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula>, to be the smallest angle between the velocity command and the perimeter of the cursor-target overlap zone. (<bold>A</bold>) Consider an example in which we assess the error of velocity commands (blue and green arrows) originating from a position <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>85</mml:mn></mml:mrow></mml:math></inline-formula> mm from the target center (the distance between workspace center and target center in a typical experiment). Here, the cursor radius, <inline-formula><mml:math id="inf31"><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math></inline-formula>, and the target radius, <inline-formula><mml:math id="inf32"><mml:msub><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula>, are both 7 mm (typical values from experiments). Any velocity command that points within <inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>Z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM158"><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM157"><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mn>9.48</mml:mn><mml:mi>o</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> of the target center would result in cursor-target overlap and thus would be evaluated as having zero angular error. The green arrow points in the direction farthest from the target center such that movement of the cursor (dashed blue circle) in this direction would result in cursor-target overlap. A velocity command (blue arrow) pointing <inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>30</mml:mn><mml:mi>o</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> from the target center would miss the cursor-target overlap zone by <inline-formula><mml:math id="inf35"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mn>20.52</mml:mn><mml:mi>o</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. (B) Consider a similar example, but with the velocity command originating from a position <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:math></inline-formula> mm from the target center. Because the cursor-target distance has decreased, the zero error window increases to <inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>Z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>13.49</mml:mn><mml:mi>o</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. As a result, a velocity command that points <inline-formula><mml:math id="inf38"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>30</mml:mn><mml:mi>o</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> from the target center (blue arrow; same <inline-formula><mml:math id="inf39"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math></inline-formula> as in panel A), is now evaluated as having a smaller error, <inline-formula><mml:math id="inf40"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>16.51</mml:mn><mml:mi>o</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. The difference between the error angles, <inline-formula><mml:math id="inf41"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula>, in panel A and panel B, reflects the task goals, because a wider range of velocity commands would result in task success in panel B compared to panel A, and thus the same velocity command is more task-appropriate in panel B than in panel A. The <inline-formula><mml:math id="inf42"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> metric was used extensively throughout this work (<xref ref-type="fig" rid="fig2">Figure 2A,C</xref>, <xref ref-type="fig" rid="fig3">Figure 3B,C</xref>, <xref ref-type="fig" rid="fig4">Figure 4C</xref>, <xref ref-type="fig" rid="fig6">Figure 6A</xref>, <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>, <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>, <xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>, <xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref>, and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). We repeated those analyses using <inline-formula><mml:math id="inf43"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math></inline-formula> as the error metric (i.e., ignoring the distance to the target, cursor radius, and target radius) and found qualitatively similar results. In <xref ref-type="fig" rid="fig2">Figure 2C</xref> and <xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref>, velocity commands were evaluated as originating from a range of lagged cursor positions. Since cursor positions later in a trial tend to be closer to the target than earlier positions, velocity commands will tend to have smaller <inline-formula><mml:math id="inf44"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> when originating from these later cursor positions. We controlled for this distance-to-target effect to ensure that it did not influence our results (see Materials and methods).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.006">http://dx.doi.org/10.7554/eLife.10015.006</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig2-figsupp1-v2.tif"/></fig></fig-group></p><p>Because we have not yet explicitly identified the subject’s <italic>internal</italic> model, motor commands were defined in this analysis using the BMI mapping, which is <italic>external</italic> to the subject. If the internal model bears similarities to the BMI mapping, it is reasonable to use the BMI mapping as a proxy for the internal model to assess feedback delay compensation. With evidence that subjects engage an internal model during BMI control, we next asked whether we could explicitly identify an internal model from the recorded neural activity.</p></sec><sec id="s2-2"><title>Internal model mismatch explains the majority of subjects’ control errors</title><p>The BMI mapping, which determines the cursor movements displayed to the subject, provides one relevant, low-dimensional projection of the high-dimensional neural activity. With evidence that subjects use an internal model during closed-loop BMI control, we asked whether mismatch between an internal model and the actual BMI mapping could explain the subject’s moment-by-moment aiming errors. This requires identifying the subject’s internal model, which could reveal a different projection of the high-dimensional neural activity, representing the subject’s internal beliefs about the cursor state. Because of the closed-loop nature of the BMI paradigm, the subject continually updates motor control decisions as new visual feedback of the cursor becomes available. To resolve these effects, the internal model needs to operate on a timescale of tens of milliseconds (in this case, a single timestep of the BMI system) on individual experimental trials. The extraction of such a rich internal model has been difficult prior to this study due to the lack of an appropriate statistical framework.</p><p>To overcome this limitation, we developed an internal model estimation (IME) framework, which extracts, from recorded population activity, a fully parameterized internal model along with a moment-by-moment account of the internal prediction process (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). In the IME framework, the subject internally predicts the cursor state according to:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:msub><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo mathvariant="bold">~</mml:mo></mml:mover><mml:mtext mathvariant="bold">t</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mover><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:msub><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:math></disp-formula><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.10015.007</object-id><label>Figure 3.</label><caption><title>Mismatch between the internal model and the BMI mapping explains the majority of the subjects’ cursor movement errors. </title><p>(<bold>A</bold>) At each timestep, the subject’s internal state predictions (<inline-formula><mml:math id="inf45"><mml:msub><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t-2</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t-1</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula>) are formed by integrating the visual feedback (<inline-formula><mml:math id="inf46"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mtext>t-3</mml:mtext></mml:msub></mml:math></inline-formula>) with the recently issued neural commands (<inline-formula><mml:math id="inf47"><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t-2</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t-1</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula>) using the internal model (<inline-formula><mml:math id="inf48"><mml:mrow><mml:mover accent="true" id="XM138"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true" id="XM139"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true" id="XM140"><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>). We defined cursor states and internal state predictions to include components for position and velocity (i.e., <inline-formula><mml:math id="inf49"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula>). (<bold>B</bold>) Cursor trajectory (black line) from a BMI trial that was not used in model fitting. Red <italic>whisker</italic> shows the subject’s internal predictions of cursor state as extracted by IME. The critical comparison is between the actual cursor velocity (<inline-formula><mml:math id="inf50"><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula>; black arrow) and the subject’s internal prediction of cursor velocity (<inline-formula><mml:math id="inf51"><mml:msub><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula>; red arrow). (<bold>C</bold>) Cross-validated angular aiming errors based on IME-extracted internal models are significantly smaller than cursor errors from the BMI mapping (**<inline-formula><mml:math id="inf52"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, two-sided Wilcoxon test; monkey A: <inline-formula><mml:math id="inf53"><mml:mi>n</mml:mi></mml:math></inline-formula> = 5908 trials; monkey C: <inline-formula><mml:math id="inf54"><mml:mi>n</mml:mi></mml:math></inline-formula> = 4577 trials). Errors in panel B are from a single timestep within a single trial. Errors in panel C are averaged across timesteps and trials. Errors in panels B and C incorporate temporal smoothing through the definition of the BMI mapping and the internal model, and are thus not directly comparable to the errors shown in <xref ref-type="fig" rid="fig2">Figure 2C</xref>, which are based on single-timestep velocity commands needed for additional temporal resolution. Error bars (barely visible) indicate <inline-formula><mml:math id="inf55"> <mml:mo>± </mml:mo></mml:math></inline-formula> SEM.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.007">http://dx.doi.org/10.7554/eLife.10015.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.008</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Full probabilistic graphical model for the internal model estimation (IME) framework.</title><p>At timestep <inline-formula><mml:math id="inf56"><mml:mi>t</mml:mi></mml:math></inline-formula>, the subject generates a set of internal state predictions (row of <inline-formula><mml:math id="inf57"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi></mml:msup></mml:math></inline-formula> variables in the solid box) based on the most recently available visual feedback (<inline-formula><mml:math id="inf58"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mtext>t-3</mml:mtext></mml:msub></mml:math></inline-formula>) and recently issued neural commands (<inline-formula><mml:math id="inf59"><mml:mrow><mml:msubsup id="XM159"><mml:mi mathvariant="bold">u</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>raw</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi id="XM160" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup id="XM161"><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>). Because the subject aims straight to the target from the subject’s up-to-date prediction of cursor position, the target position (<inline-formula><mml:math id="inf60"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:math></inline-formula>) should lie along the line defined by subject’s up-to-date position and velocity predictions (<inline-formula><mml:math id="inf61"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf62"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup></mml:math></inline-formula>, included in <inline-formula><mml:math id="inf63"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup></mml:math></inline-formula>). At the next timestep (<inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), the subject generates a revised set of internal predictions (row of <inline-formula><mml:math id="inf65"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> variables) based on newly received visual feedback (<inline-formula><mml:math id="inf66"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>), the most recently issued neural command (<inline-formula><mml:math id="inf67"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula>), and previously issued neural commands (<inline-formula><mml:math id="inf68"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf69"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula>). A column of internal state predictions represents the subject’s internal predictions given more and more recent visual feedback (e.g., the <inline-formula><mml:math id="inf70"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msubsup></mml:math></inline-formula> variables in the dashed box represent the subject’s internal predictions of the timestep <inline-formula><mml:math id="inf71"><mml:mi>t</mml:mi></mml:math></inline-formula> cursor state <inline-formula><mml:math id="inf72"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:math></inline-formula> given visual feedback available through timestep <inline-formula><mml:math id="inf73"><mml:mi>k</mml:mi></mml:math></inline-formula>). Once a neural command is issued, it cannot be revised, and as such, the same neural command continues to influence internal predictions until visual feedback becomes available from the corresponding timestep (<inline-formula><mml:math id="inf74"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula> affects the <inline-formula><mml:math id="inf75"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf76"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf77"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> variables, but not the <inline-formula><mml:math id="inf78"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> variables as <inline-formula><mml:math id="inf79"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:math></inline-formula> has become available, rendering <inline-formula><mml:math id="inf80"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula> irrelevant). The target position <inline-formula><mml:math id="inf81"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:math></inline-formula> took on the same value for all timesteps within the same trial. Shaded nodes indicate observed data, and red unshaded nodes are latent variables representing the subject’s internal state predictions.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.008">http://dx.doi.org/10.7554/eLife.10015.008</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.009</object-id><label>Figure 3—figure supplement 2.</label><caption><title>A unit-by-unit comparison of the subject’s internal model and the BMI mapping.</title><p>Both the internal model and the BMI mapping can be visualized as a collection of pushing vectors. (<bold>A</bold>) The BMI mapping parameter <inline-formula><mml:math id="inf82"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> from <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> describes how each neuronal unit actually drove the BMI cursor. Each 2D column in the velocity portion (lower two rows) of <inline-formula><mml:math id="inf83"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> corresponds to a particular unit and can be visualized as a pushing vector describing the direction and magnitude by which a single spike from that unit would push the cursor according to the BMI mapping. Each unit’s pushing vector is given a unique color. (<bold>B</bold>) The internal model parameter <inline-formula><mml:math id="inf84"><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> from <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> describes how the subject believes each neuronal unit drives the cursor. As in panel A, each 2D column of the velocity portion of <inline-formula><mml:math id="inf85"><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> corresponds to a particular unit. Pushing vectors corresponding to the same unit in panel A and panel B are given the same color. See Visualizing an extracted internal model for additional details on the pushing vectors in panels A and B. (<bold>C</bold>) Unit-by-unit comparison of pushing vectors from the BMI mapping (circles) and internal model (squares) from panel A. When looking across all units, there was no consistent structure in the differences between pushing vectors through the internal model versus through the BMI mapping. Some units’ pushing vectors were similar through the BMI mapping and the subject’s internal model, whereas other units’ pushing vectors showed substantial differences. Despite these differences, some patterns of neural activity resulted in similar velocities through the internal model and the BMI mapping (<xref ref-type="fig" rid="fig4">Figure 4A</xref>), whereas other patterns resulted in different velocities (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Analyzing the high-dimensional population activity enabled the identification of these effects, which could not have been revealed by analyzing the low-dimensional behavior or individual units in isolation. Parameters visualized in panels A–C were taken from representative session A010609.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.009">http://dx.doi.org/10.7554/eLife.10015.009</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.010</object-id><label>Figure 3—figure supplement 3.</label><caption><title>The explanatory power of IME comes primarily from structure in the high-dimensional neural activity.</title><p>IME explains cursor errors by identifying two main types of statistical structure in the data. The two types of structure are (i) temporal structure in the dynamics of low-dimensional velocities (<inline-formula><mml:math id="inf86"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:math></inline-formula>), and (ii) hidden, task-appropriate structure in the high-dimensional neural activity (<inline-formula><mml:math id="inf87"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula>). Here we asked to what extent each type of structure contributes toward IME’s overall explanatory power. In the internal model of <xref ref-type="disp-formula" rid="equ11">Equation 10</xref>, <inline-formula><mml:math id="inf88"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> summarizes temporal dynamics in the low-dimensional velocity predictions, including how velocity feedback informs internal predictions of cursor state and the degree of temporal smoothness across internal velocity predictions within a single whisker. Intended velocity tends to be similar from one timestep to the next, and whiskers with the appropriate temporal structure (as determined by fitting <inline-formula><mml:math id="inf89"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> to the data) can explain a portion of cursor movement errors. The internal model parameters <inline-formula><mml:math id="inf90"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf91"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> reveal features in the high-dimensional neural activity that are consistent with straight-to-target movement intent and that are often not reflected in the BMI cursor movements. To determine the relative contribution of structure in the high-dimensional neural data toward the explanatory power of IME, we devised a constrained variant of IME that relies entirely on the high-dimensional neural activity to generate whiskers. Specifically, we constrained <inline-formula><mml:math id="inf92"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>, removing IME’s ability to leverage velocity dynamics within its whiskers while preserving its ability to identify structure in the high-dimensional neural activity (since no constraints are placed on <inline-formula><mml:math id="inf93"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula>). In this constrained IME variant, termed “neural-only” IME, the subject’s internal prediction of the velocity resulting from neural command <inline-formula><mml:math id="inf94"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula> is simply <inline-formula><mml:math id="inf95"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Because neural-only IME does not incorporate temporal smoothing of velocity predictions, it cannot be directly compared to the BMI mapping via the cursor error presented in <xref ref-type="fig" rid="fig3">Figure 3C</xref>, which was computed using smoothed cursor velocities. To enable fair comparison with the BMI mapping, we computed cursor errors using single-timestep (unsmoothed) velocity commands, <inline-formula><mml:math id="inf96"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (replicated from <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>). Here we compared the angular errors of these <inline-formula><mml:math id="inf97"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup></mml:math></inline-formula> (“neural only”) and <inline-formula><mml:math id="inf98"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula> (“unsmoothed cursor”). Internal models extracted using neural-only IME explain 54% and 46% of unsmoothed cursor errors in monkeys A and C, respectively, demonstrating that there is considerable structure in the high-dimensional neural activity. For reference, we also include the error from unconstrained IME (i.e., by fitting <inline-formula><mml:math id="inf99"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> to the data; “neural + dynamics”; replicated from <xref ref-type="fig" rid="fig3">Figure 3C</xref>). In this view, the large difference between unsmoothed cursor errors and neural-only internal model errors (solid arrow) represents the explanatory power of the structured high-dimensional neural activity without applying any temporal smoothing and without leveraging visual feedback of cursor velocity. The smaller difference between errors through the neural-only internal model and the unconstrained internal model (dashed arrow) demonstrates the additional explanatory power gained by incorporating velocity feedback and temporal smoothing. As in <xref ref-type="fig" rid="fig3">Figure 3C</xref>, angular error was defined as the angle by which the cursor would have missed the cursor-target overlap zone had it continued in the direction of <inline-formula><mml:math id="inf100"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula> (BMI mapping) or <inline-formula><mml:math id="inf101"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup></mml:math></inline-formula> (internal model) from position <inline-formula><mml:math id="inf102"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup></mml:math></inline-formula> or <inline-formula><mml:math id="inf103"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, respectively (i.e., <inline-formula><mml:math id="inf104"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Absolute angular errors were first averaged within each trial, then averaged across all trials. Error bars indicate <inline-formula><mml:math id="inf105"> <mml:mo>± </mml:mo></mml:math></inline-formula> SEM (**: <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, two-sided Wilcoxon test; monkey A: <inline-formula><mml:math id="inf107"><mml:mi>n</mml:mi></mml:math></inline-formula> = 5908 trials; monkey C: <inline-formula><mml:math id="inf108"><mml:mi>n</mml:mi></mml:math></inline-formula> = 4577 trials).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.010">http://dx.doi.org/10.7554/eLife.10015.010</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.011</object-id><label>Figure 3—figure supplement 4.</label><caption><title>IME does not explain cursor errors when fit to low-dimensional behavior. </title><p>We fit neural-only IME using low-dimensional behavior (i.e., cursor velocity) in place of the high-dimensional neural activity. Extracted internal models result in errors similar to or even larger than those of the BMI cursor (i.e., internal model errors are not substantially smaller than cursor errors, as in <xref ref-type="fig" rid="fig3">Figure 3C</xref>). This suggests that the explanatory power of the IME framework is largely due to reliable structure in the high-dimensional neural activity, as opposed to structured errors in the low-dimensional behavior. Further, these results suggest that our ability to identify internal model mismatch might not have been possible given only behavioral measurements. Error bars indicate <inline-formula><mml:math id="inf109"> <mml:mo>± </mml:mo></mml:math></inline-formula> SEM (*: <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>; **: <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, two-sided Wilcoxon test; monkey A: <inline-formula><mml:math id="inf112"><mml:mi>n</mml:mi></mml:math></inline-formula> = 5908 trials; monkey C: <inline-formula><mml:math id="inf113"><mml:mi>n</mml:mi></mml:math></inline-formula> = 4577 trials).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.011">http://dx.doi.org/10.7554/eLife.10015.011</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig3-figsupp4-v2.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.012</object-id><label>Figure 3—figure supplement 5.</label><caption><title>Subjects could readily produce the entire range of movement directions through the BMI mapping. </title><p>(<bold>A</bold>) Observed movement velocities from representative session A072208. Velocities were computed using single-timestep spike counts (i.e., <inline-formula><mml:math id="inf114"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula> from <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>). (<bold>B</bold>) The distribution of gaps between adjacent observed movement directions from panel A. (<bold>C</bold>) The distribution of the mean within-session direction gap across all intuitive sessions. Red triangle indicates the mean gap from the data in panel B. Since movement direction can be noisy at low speeds, we also analyzed these distributions after withholding observed velocities with low speed (i.e., points near the origin in panel A). Results (as in panels B and C) were nearly identical (data not shown).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.012">http://dx.doi.org/10.7554/eLife.10015.012</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig3-figsupp5-v2.tif"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.013</object-id><label>Figure 3—figure supplement 6.</label><caption><title>Internal model mismatch is not an artifact of correlated spiking variability.</title><p>To determine whether our finding of internal model mismatch could be an artifact of correlated spiking variability, we simulated noisy neural commands according to the alternate hypothesis that the internal model was well-matched to the BMI mapping. We could then ask whether our main finding of internal model mismatch (<xref ref-type="fig" rid="fig3">Figure 3C</xref>) could be explained by the properties of the noise in the real data. Under this alternative hypothesis, the subject generates idealized neural commands that, prior to corruption by noise, would produce the desired movement direction through the BMI mapping. We simulated these idealized neural commands and their noisy counterparts by sampling from the recorded neural activity (see Assessing whether internal model mismatch could appear as a spurious result due to correlated spiking variability). (<bold>A</bold>) By construction, the idealized neural commands had near-zero errors through the BMI mapping. When interpreted through the extracted internal model, those patterns produced substantially larger errors. (<bold>B</bold>) After corruption by noise, which was matched to the statistics of the recorded neural activity, simulated neural commands had substantially larger errors through the extracted internal model than through the BMI mapping. Thus when assuming the alternative hypothesis, simulation results contrast with the results from the real data (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Furthermore, errors increased by roughly the same amount through both the BMI mapping and the internal model. Taken together, these simulation results suggest that our main finding of internal model mismatch cannot simply be explained by extracted internal models that were better fit to the noise properties of the real data, relative to the BMI mapping. Error bars (barely visible) indicate <inline-formula><mml:math id="inf115"> <mml:mo>± </mml:mo></mml:math></inline-formula> SEM (**<inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, two-sided Wilcoxon test; panel A: <inline-formula><mml:math id="inf117"><mml:mi>n</mml:mi></mml:math></inline-formula> = 1152 (monkey A) and <inline-formula><mml:math id="inf118"><mml:mi>n</mml:mi></mml:math></inline-formula> = 576 (monkey C) idealized neural commands; panel B: <inline-formula><mml:math id="inf119"><mml:mi>n</mml:mi></mml:math></inline-formula> = 125,459 (monkey A) and <inline-formula><mml:math id="inf120"><mml:mi>n</mml:mi></mml:math></inline-formula> = 102,689 (monkey C) simulated neural commands).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.013">http://dx.doi.org/10.7554/eLife.10015.013</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig3-figsupp6-v2.tif"/></fig><fig id="fig3s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.014</object-id><label>Figure 3—figure supplement 7.</label><caption><title>IME does not explain cursor errors when fit to neural commands that do not contain high-dimensional structure.</title><p>We applied neural-only IME to datasets in which we shuffled the neural activity in the null-space of <inline-formula><mml:math id="inf121"><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula>, while preserving the neural activity in the row-space of <inline-formula><mml:math id="inf122"><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula>. By design, these shuffled datasets result in exactly the same velocities through the BMI mapping (“unsmoothed cursor” bars here exactly match those in <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). However, any remaining structure in the high-dimensional neural activity is scrambled and as such cannot be leveraged by IME to explain errors. As shown, internal models extracted by neural-only IME from the shuffled data result in errors similar to or even larger than those from the BMI cursor. These results further demonstrate that the explanatory power of the IME framework is largely due to reliable structure in the high-dimensional neural activity and not due to overfitting noise in the data. Error bars indicate <inline-formula><mml:math id="inf123"> <mml:mo>± </mml:mo></mml:math></inline-formula> SEM (n.s.: not significant, <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>; **<inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, two-sided Wilcoxon test; monkey A: <inline-formula><mml:math id="inf126"><mml:mi>n</mml:mi></mml:math></inline-formula> = 5908 trials; monkey C: <inline-formula><mml:math id="inf127"><mml:mi>n</mml:mi></mml:math></inline-formula> = 4577 trials).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.014">http://dx.doi.org/10.7554/eLife.10015.014</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig3-figsupp7-v2.tif"/></fig><fig id="fig3s8" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.015</object-id><label>Figure 3—figure supplement 8.</label><caption><title>A simplified alternative internal model is not consistent with the data.</title><p>The central principles of the IME framework are that the subject internally predicts the current cursor position based on an internal model, and the subject aims straight to the target from that predicted position through the internal model. We asked whether we could account for the data using a simpler form of the internal model, which incorporates straight-to-target aiming without internal prediction. In this alternative model, the subject aims straight to the target from the most recent cursor position available from visual feedback, rather than from an internal forward prediction of cursor position. As in IME, this “aim-from-feedback” approach involves an internal model that need not match the BMI mapping. We fit this model via linear regression using the same feedback delays determined from the BMI behavior (<inline-formula><mml:math id="inf128"><mml:mi>τ</mml:mi></mml:math></inline-formula> from <xref ref-type="fig" rid="fig2">Figure 2A</xref>). At timestep <inline-formula><mml:math id="inf129"><mml:mi>t</mml:mi></mml:math></inline-formula>, the intended aiming direction was assumed to be straight to the target center from the feedback cursor position, <inline-formula><mml:math id="inf130"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and intended speed was taken to match that of the single-timestep velocity command through the BMI mapping, <inline-formula><mml:math id="inf131"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. These aiming directions were regressed against single-timestep spike counts, i.e., the corresponding <inline-formula><mml:math id="inf132"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula>, to yield an internal model. Internal models were fit and errors were evaluated using the same cross-validation practices used to evaluate the IME framework. Shaded regions (barely visible) indicate <inline-formula><mml:math id="inf133"> <mml:mo>± </mml:mo></mml:math></inline-formula> SEM (monkey A: <inline-formula><mml:math id="inf134"><mml:mi>n</mml:mi></mml:math></inline-formula> = 33,660 timesteps across 4489 trials; monkey C: <inline-formula><mml:math id="inf135"><mml:mi>n</mml:mi></mml:math></inline-formula> = 31,214 timesteps across 3639 trials). If subjects intend to drive the cursor from the position given by the most recent visual feedback, internal models fit according to this aim-from-feedback principle should predict intended velocities that point closest to targets when originating from feedback cursor positions (i.e., cursor positions that lag the recorded neural activity by <inline-formula><mml:math id="inf136"><mml:mi>τ</mml:mi></mml:math></inline-formula> timesteps). This was not the case. We found that internal models fit according to the aim-from-feedback principle result in cross-validated velocity commands that point closest to targets when originating from cursor positions more recent than those from the most recently available visual feedback (i.e., curves do not have clear minima at the red lines). This finding is consistent with subjects aiming straight to the target from an up-to-date internal prediction of the current cursor position (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Because of mismatch between the subject’s internal model and the BMI mapping, the subject’s up-to-date estimate of cursor position need not match the actual current cursor position, and as such, we should not necessarily expect minima in these curves at lag = 0. Given this evidence that subjects perform some sort of internal tracking, we implemented a number of different internal models to dissect the exact form of that tracking process. Specifically, we implemented internal models that perform no tracking (aim-from-feedback, presented here), tracking without previously issued motor commands (data not shown), and tracking with previously issued motor commands (main results, which use <xref ref-type="disp-formula" rid="equ10 equ11 equ12 equ13 equ14">Equations 9–13</xref>), among others. Empirically, these internal models all yield similar cross-validated errors. The explanation for this similarity is that the different formulations identify similar high-to-low dimensional mappings that capture the subject’s intent to move straight to the target, and the direction of these intended commands tends to dominate any effect of the position from which those commands originate. This reasoning is consistent with our finding that cursor errors are better explained by structure in the high-dimensional neural activity than by temporal structure in the cursor kinematics (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>), structure in low-dimensional behavior (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>), or low-dimensional structure in the recorded neural activity (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>). We ultimately chose to present results from the internal model of <xref ref-type="disp-formula" rid="equ10 equ11 equ12 equ13 equ14">Equations 9–13</xref> because it performs as well as any internal model we tested, and its formulation is consistent with a number of prominent studies evidencing the use of internal copies of motor commands (<xref ref-type="bibr" rid="bib58">Sommer, 2002</xref>; <xref ref-type="bibr" rid="bib51">Scott, 2004</xref>; <xref ref-type="bibr" rid="bib42">Miall et al., 2007</xref>; <xref ref-type="bibr" rid="bib7">Crapse and Sommer, 2008</xref>; <xref ref-type="bibr" rid="bib54">Shadmehr and Krakauer, 2008</xref>; <xref ref-type="bibr" rid="bib59">Sommer and Wurtz, 2008</xref>; <xref ref-type="bibr" rid="bib27">Huang et al., 2013</xref>; <xref ref-type="bibr" rid="bib2">Azim et al., 2014</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.015">http://dx.doi.org/10.7554/eLife.10015.015</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig3-figsupp8-v2.tif"/></fig></fig-group></p><p>where <inline-formula><mml:math id="inf137"><mml:msub><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> is the subject’s internal prediction about the cursor state (position and velocity), <inline-formula><mml:math id="inf138"><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> is a vector of recorded neural activity, and <inline-formula><mml:math id="inf139"><mml:mover><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="inf140"><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>, and <inline-formula><mml:math id="inf141"><mml:mover><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> are the parameters of the subject’s internal model. This form of the internal model was chosen to be analogous to the BMI mapping from <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> so that the actual BMI mapping lies within the family of internal models that we consider. Additionally, this formulation aligns with recent studies of skeletomotor (<xref ref-type="bibr" rid="bib54">Shadmehr and Krakauer, 2008</xref>) and oculomotor (<xref ref-type="bibr" rid="bib13">Frens, 2009</xref>) control, and a vast literature of control theory (<xref ref-type="bibr" rid="bib1">Anderson and Moore, 1990</xref>).</p><p>The primary concept of the IME framework is that, at each timestep, the subject internally predicts the current cursor state by recursively applying <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> (starting from the most recently available sensory feedback) and generates neural activity consistent with aiming straight to the target relative to this internal prediction (see the 'Framework for internal model estimation (IME)' subsection in 'Materials and methods' and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). At each timestep, IME extracts the entire time-evolution of the subject’s internal state prediction using <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> as an internal forward model. This evolution can be visualized in the form of a whisker (<xref ref-type="fig" rid="fig3">Figure 3B</xref>) that begins at the cursor position of the most recently available feedback and unfolds according to the extracted internal model. At each new timestep, the subject forms a new internal prediction that incorporates newly received visual feedback. If the internal model exactly matches the BMI mapping, the subject’s internal predictions would exactly match the cursor trajectory. A visualization of an example internal model and BMI mapping is given in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>.</p><p>The central hypothesis in this study is that movement errors arise from a mismatch between the subject’s internal model of the BMI and the actual BMI mapping. The alternative to this hypothesis is that the subject’s internal model is well-matched to the BMI mapping, and movement errors result from other factors, such as “noise” in the sensorimotor system, subjects’ inability to produce certain patterns of neural activity, or subjects disengaging from the task. Our key finding is that recorded neural commands were markedly more consistent with the task goals when interpreted through subjects’ internal models than when viewed through the BMI mapping (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Subjects’ internal models deviated from the actual BMI mappings such that control errors evaluated through extracted internal models were substantially smaller than actual cursor errors: extracted internal models explained roughly 65% of cursor movement errors (70%, monkey A; 59%, monkey C). Although this finding does not preclude other factors (e.g., spiking noise or subject disengagement) from contributing toward movement errors, it does suggest their contribution is substantially smaller than previously thought, due to the large effect of internal model mismatch.</p><p>We found that the majority of the explanatory power of extracted internal models was in their ability to identify structure in the high-dimensional neural activity (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). This structure was captured in the internal model by the mapping from high-dimensional neural activity to low-dimensional kinematics (<inline-formula><mml:math id="inf142"><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>), which need not match the BMI mapping (<inline-formula><mml:math id="inf143"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). Consistent with this finding, internal models fit to low-dimensional behavior rather than high-dimensional neural activity were not able to explain cursor errors (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>).</p><p>That a majority of cursor errors can be explained by mismatch of the internal model is not to say that control through the BMI mapping was poor–in fact control was proficient and stable (<xref ref-type="fig" rid="fig1">Figure 1B</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Rather, extracted internal models predicted movements that consistently pointed straight to the target, regardless of whether the actual cursor movements did (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) or did not (<xref ref-type="fig" rid="fig4">Figure 4B</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) point straight to the target. On most trials, BMI cursor trajectories proceeded roughly straight to the target (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). On these trials, internal model predictions aligned with actual cursor movements, resulting in small errors through both the BMI mapping and the extracted internal model. In a smaller subset of trials, actual cursor movements were more circuitous and thus had relatively large errors. Previously, the reason behind these seemingly incorrect movements was unknown, and one possibility was that the subject simply disengaged from the task. When interpreted through the extracted internal model, however, neural activity during these circuitous trials appears correct, suggesting that the subject was engaged but was acting under an internal model that was mismatched to the BMI mapping (<xref ref-type="fig" rid="fig4">Figure 4B</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). In other words, when armed with knowledge of the subject’s internal model, outwardly irrational behavior (i.e., circuitous cursor movements) appears remarkably rational. Across all trials, the majority of neural activity patterns had low or zero error as evaluated through extracted internal models, regardless of whether errors of the actual cursor movements (i.e., through the BMI mapping) were large or small (<xref ref-type="fig" rid="fig4">Figure 4C</xref> and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>).<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.10015.016</object-id><label>Figure 4.</label><caption><title>Neural activity appears correct through the internal model, regardless of how the actual cursor moved.</title><p>(<bold>A</bold>) Typical trial in which the cursor followed a direct path (black) to the target. Internal model predictions (red whiskers) also point straight to the target. (<bold>B</bold>) Trial with a circuitous cursor trajectory. Internal model predictions point straight to the target throughout the trial, regardless of the cursor movement direction (same color conventions as in panel A). (<bold>C</bold>) Timestep-by-timestep distribution of BMI cursor and internal model errors. Neural activity at most timesteps produced near-zero error through the internal model, despite having a range of errors through the BMI mapping. (<bold>D</bold>) Hypothetical internal model (red) and BMI mapping (black) relating 2D neural activity to a 1D velocity output. This is a simplified visualization of <xref ref-type="disp-formula" rid="equ1">Equations 1</xref> and <xref ref-type="disp-formula" rid="equ2">2</xref>, involving only the <inline-formula><mml:math id="inf144"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf145"><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> parameters, respectively. Each contour represents activity patterns producing the same velocity through the internal model (<inline-formula><mml:math id="inf146"><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>, red) or BMI mapping (<inline-formula><mml:math id="inf147"><mml:mi mathvariant="bold">v</mml:mi></mml:math></inline-formula>, black). Because of internal model mismatch, many patterns result in different outputs through the internal model and the BMI. However, some patterns result in the same output through both the internal model and the BMI (gray line). Here we illustrate using a 2D neural space and 1D velocity space. In experiments with <inline-formula><mml:math id="inf148"><mml:mi>q</mml:mi></mml:math></inline-formula>-dimensional neural activity and 2D velocity, activity patterns producing identical velocities through both the internal model and the cursor span a <inline-formula><mml:math id="inf149"><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM148"><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>-dimensional space.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.016">http://dx.doi.org/10.7554/eLife.10015.016</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.017</object-id><label>Figure 4—figure supplement 1.</label><caption><title>IME whiskers consistently point to the target regardless of cursor movement direction. </title><p>Additional example cursor trajectories (black) are overlaid with cross-validated predictions from extracted internal models (red whiskers), as in <xref ref-type="fig" rid="fig4">Figure 4A,B</xref>. Each trial was held-out when fitting the internal model used to generate its whiskers. Each whisker shows the subject’s internal belief of how the cursor trajectory evolved, beginning from the most recently available visual feedback of cursor position (black dots) to the subject’s up-to-date prediction of the current cursor position (red dots). The final whisker segments (red line beyond each red dot) represent the subject’s intended velocity command. Trials were selected to highlight differences between extracted internal models and the BMI mappings. In these trials, black cursor trajectories at times appear irrational with respect to targets, yet internal models reveal whiskers that consistently point toward the targets. Averaged cursor and internal model errors within each of these trials are shown in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.017">http://dx.doi.org/10.7554/eLife.10015.017</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.018</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Errors from trials in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> highlighted on the distribution of errors across trials. </title><p>Letters correspond to trials from <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>. Format is similar to that of <xref ref-type="fig" rid="fig4">Figure 4C</xref>, but there histograms were constructed from single-timestep errors. Here, errors were averaged across all timesteps within each trial, allowing for direct correspondence to the trials shown in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>. Data are from monkey A only. Monkey C data are qualitatively similar (data not shown).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.018">http://dx.doi.org/10.7554/eLife.10015.018</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig4-figsupp2-v2.tif"/></fig></fig-group></p><p>When cursor trajectories were circuitous, it was not uncommon for some internal model predictions (whiskers) to match the actual cursor movement while others did not, even within the same trial (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Given a single internal model, how can some patterns of neural activity result in whiskers aligned to the cursor trajectory, while others patterns produce whiskers that deviate from the cursor trajectory? This is possible due to mathematical operation of mapping from high-dimensional neural activity patterns to low-dimensional cursor states. <xref ref-type="fig" rid="fig4">Figure 4D</xref> provides a conceptual illustration of a simplified BMI mapping:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">Bu</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></disp-formula></p><p>and a simplified internal model:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mover><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></disp-formula></p><p>each of which relies only on a mapping (<inline-formula><mml:math id="inf150"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf151"><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>) from neural activity (<inline-formula><mml:math id="inf152"><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula>) to cursor velocity (<inline-formula><mml:math id="inf153"><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf154"><mml:msub><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula>). We focus on <inline-formula><mml:math id="inf155"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf156"><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> here (without considering <inline-formula><mml:math id="inf157"><mml:mtext mathvariant="bold">A</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext mathvariant="bold">b</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mover><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="inf158"><mml:mover accent="true"><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> from <xref ref-type="disp-formula" rid="equ1">Equations 1</xref> and <xref ref-type="disp-formula" rid="equ2">2</xref>) because of the aforementioned finding that the majority of the internal model mismatch effect is captured by differences between <inline-formula><mml:math id="inf159"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf160"><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). Given a mismatched BMI mapping (black lines) and internal model (red lines), many neural activity patterns will produce different velocities through the BMI mapping versus the internal model. However, a subset of activity patterns (gray line) will produce identical velocities through both the BMI mapping and the internal model. These patterns lie in the nullspace of <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> (i.e., solutions to the equation <inline-formula><mml:math id="inf162"><mml:msub><mml:mi mathvariant="bold">Bu</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula>). In the example trials shown in <xref ref-type="fig" rid="fig4">Figure 4A,B</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, internal model predictions (red) that match the actual cursor movement (black) correspond to neural activity patterns along the gray line in <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Predictions not matching the cursor movement correspond to neural activity patterns anywhere off the gray line in <xref ref-type="fig" rid="fig4">Figure 4D</xref>.</p></sec><sec id="s2-3"><title>Two alternative hypotheses do not explain the effect of internal model mismatch</title><p>The data presented thus far support our central hypothesis that internal model mismatch is a primary source of movement errors. Next we asked whether it might be possible to have arrived at this result under the alternate hypothesis that the internal model is well-matched to the BMI mapping. We address two specific cases of this alternative hypothesis and show that they do not explain the observed effect of internal model mismatch.</p><p>First, we explored the possibility that the subject might have a well-matched internal model, but has systematic difficulties producing the neural activity patterns required to drive the cursor in all directions in the 2D workspace using the BMI mapping. This could result in an estimated internal model that appears to be mismatched to the BMI mapping. Although M1 cannot readily produce all possible patterns of high-dimensional neural activity (<xref ref-type="bibr" rid="bib48">Sadtler et al., 2014</xref>), we observed that subjects could readily produce the full range of movement directions through the BMI mapping (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>). Gaps between producible movement directions were typically less than 1/4 of a degree, which is substantially smaller than the cursor errors shown in <xref ref-type="fig" rid="fig3">Figure 3C</xref>. This suggests that our main finding of internal model mismatch cannot be explained by subjects’ inability to produce particular neural activity patterns.</p><p>Second, we explored the possibility that the subject intended to produce neural commands that were correct according to the BMI mapping, but that those intended commands were corrupted by “noise” that is oriented such that errors appear smaller through the extracted internal model than through the BMI mapping. Here we define noise as spiking variability not explained by the desired movement direction under the BMI mapping. If spiking variability is correlated across neurons, it is possible to identify a mapping that best attenuates that variability. To determine whether correlated spiking variability could explain the effect of internal model mismatch, we simulated neural activity according to this alternative hypothesis in a manner that preserved the statistics of the real data (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>). If this simulation produced results that match our findings from the real data, it would indicate that our main finding can be explained by the alternate hypothesis. However, this was not the case. Simulated neural activity was more consistent with the BMI mapping than the extracted internal model, which contrasts with our finding from the recorded neural activity.</p></sec><sec id="s2-4"><title>Statistical controls for validating observed effects</title><p>To further validate the main results presented above, we implemented four statistical controls. First, we ensured that our findings were not simply artifacts of overfitting the data. Second, we removed the high-dimensional structure from the neural activity while preserving the cursor movements, and show that resulting extracted internal models no longer provided explanatory power. Third, we ensured that internal model predictions do not trivially point toward the targets. Finally, we explored a variety of forms for the internal model and found that a simplified form does not account for the data. Here we describe each of these four statistical controls in additional detail.</p><p>One possible concern when interpreting the findings presented above is that internal models might be simply overfitting the data. To rule out this possibility, all findings presented throughout this paper are cross-validated (see the 'Computing cross-validated internal model predictions' subsection in 'Materials and methods'). Internal models were fit using a subset of trials as training data. Then, trials that were held out during fitting were used to evaluate each extracted internal model. If the extracted internal models had overfit the training data, we would expect those internal models to generalize poorly to the held-out data. However, this was not the case. Internal models explained the majority of cursor errors in the held-out data (<xref ref-type="fig" rid="fig3">Figure 3C</xref>), demonstrating that extracted internal models captured real, task-relevant structure in the recorded neural activity.</p><p>In addition to properly cross-validating our results, we performed a control analysis to show that extracted internal models identified reliable, task-appropriate structure in the high-dimensional neural activity. Here we extracted internal models using neural activity that had been shuffled across timesteps in a manner that preserved the cursor movements through the BMI mapping (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>). If our results could be explained by internal models that simply overfit noise in the data, we would expect internal models fit to these shuffled data data sets to again explain a majority of cursor errors. However, internal models extracted from these shuffled data sets could no longer explain cursor errors, indicating that IME does not identify effects when they do not exist in the data. This result is consistent with our findings that the majority of the explanatory power of extracted internal models relies on structure in the high-dimensional neural activity (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>), and that cursor errors cannot be explained by internal models when high-dimensional neural activity is replaced by low-dimensional behavioral measurements during model fitting (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>).</p><p>If an internal model prediction points toward the target, it is not trivially due to our inclusion of straight-to-target aiming during model fitting (see the 'Computing cross-validated internal model predictions' subsection in 'Materials and methods'). Although target positions were used during model fitting, they were never used when computing internal model predictions from the data (e.g., when constructing the whiskers in <xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig4">Figure 4A,B</xref>, and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Each whisker was constructed in a held-out trial using only visual feedback (consisting of a single timestep of cursor position and velocity), the recorded neural activity up through the current timestep, and the internal model extracted from the training data. Because of our aforementioned cross-validation procedures, when the neural command <inline-formula><mml:math id="inf163"><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> is used to compute the movement error at timestep <inline-formula><mml:math id="inf164"><mml:mi>t</mml:mi></mml:math></inline-formula>, that neural command had not been seen previously (i.e., it was not used when fitting the internal model, when estimating the subject’s internal cursor state prediction, when calibrating the BMI mapping, nor when determining the current position of the actual BMI cursor). A whisker that points straight to the target in the held-out data thus reveals that, when interpreted through the subject’s internal model, the recorded neural activity would have driven the cursor straight to the target.</p><p>Finally, we explored a variety of approaches to modeling the subject’s internal tracking process and found that models demonstrated similarly high degrees of explanatory power as long as they could capture high-dimensional structure in the neural activity. However, a simplified internal model that does not account for any form of internal forward prediction was not consistent with our data (<xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref>).</p></sec><sec id="s2-5"><title>Internal model mismatch explains limitations in speed dynamic range</title><p>A major limitation in BMI performance is the ability to control cursor speed (<xref ref-type="bibr" rid="bib17">Gilja et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Golub et al., 2014</xref>). <xref ref-type="bibr" rid="bib17">Gilja et al. (2012)</xref> and <xref ref-type="bibr" rid="bib21">Golub et al. (2014)</xref> have proposed solutions to improve control of BMI speed (in particular, with respect to stopping the BMI cursor at targets). However, it is still an open question as to why BMI speed control is deficient in the first place. In addition to explaining the subjects’ aiming errors, we asked whether mismatch between the internal model and BMI mapping could also explain subjects’ difficulty in controlling cursor speed. Using the extracted internal model, we could compare the subject’s intended speed (from the internal model) to the speed of the actual BMI cursor at each timestep. We found that low intended speeds were systematically overestimated, and high intended speeds were systematically underestimated by the BMI mapping (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Furthermore, we discovered that the subjects intended to hold the cursor steadier during the initial hold period and move the cursor faster during the movement than what occurred during experiments (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). Note that we make no assumptions about movement speed when extracting the internal model (see the 'Framework for internal model estimation (IME)' subsection in 'Materials and methods').<fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.10015.019</object-id><label>Figure 5.</label><caption><title>Internal model mismatch limits the dynamic range of BMI cursor speeds.</title><p>(<bold>A</bold>) BMI cursor speeds across the range of intended (i.e., internal model) speeds. At low intended speeds, BMI speeds were higher than intended, whereas for mid-to-high intended speeds, BMI speeds were lower than intended. Shaded regions indicate <inline-formula><mml:math id="inf165"> <mml:mo>± </mml:mo></mml:math></inline-formula> SEM. (<bold>B</bold>) During the hold period prior to target onset, intended speeds were significantly lower than those produced through the BMI mapping. During movement, intended speeds were significantly higher than those produced through the BMI. Error bars indicate <inline-formula><mml:math id="inf166"> <mml:mo>± </mml:mo></mml:math></inline-formula> SEM (**<inline-formula><mml:math id="inf167"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, two-sided Wilcoxon test; monkey A: <inline-formula><mml:math id="inf168"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo></mml:mrow></mml:math></inline-formula>5006, 5908<inline-formula><mml:math id="inf169"><mml:mo>}</mml:mo></mml:math></inline-formula> trials; monkey C: <inline-formula><mml:math id="inf170"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo></mml:mrow></mml:math></inline-formula>3008, 4578<inline-formula><mml:math id="inf171"><mml:mo>}</mml:mo></mml:math></inline-formula> trials). In panels A and B internal models were used to predict intended speed on trials not used during model fitting.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.019">http://dx.doi.org/10.7554/eLife.10015.019</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.10015.020</object-id><label>Figure 5—figure supplement 1.</label><caption><title>A unit-by-unit example of internal model mismatch limiting cursor speed dynamic range.</title><p>(<bold>A</bold>) Spike counts during a single example timestep across 22 units. Circles indicate a zero spike count. This example timestep was recorded mid-movement, when intended speed should be at its maximum. (<bold>B</bold>) Pushing vectors from <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> scaled by the spike counts shown in panel A. Dashed arrows indicate the direction and magnitude of the velocity components of offset vectors <inline-formula><mml:math id="inf172"><mml:mi mathvariant="bold">b</mml:mi></mml:math></inline-formula> (left) and <inline-formula><mml:math id="inf173"><mml:mover accent="true"><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> (right), which are meant to effectively zero-out the velocity expected when neurons fire at their baseline rates. Straight-to-target directions (green stars) are shown relative to the current cursor position (left) or the internal-model predicted current cursor position (right). (<bold>C</bold>) Actual (left) and intended (right) cursor velocities corresponding to the spikes counts shown in panel A. Each resultant pushing vector (arrows) is the sum of the offset term and all weighted pushing vectors from panel B. These vectors represents the contribution of the single-timestep spike count from panel A toward the cursor (left) or internal model-predicted (right) velocity (i.e., without considering smoothing across previous time steps). Here, intended speed (magnitude of red arrow) is greater than the actual speed through the BMI mapping (magnitude of black arrow). This difference between intended and actual speed arises because the pattern of activated units in the example spike count vector had similar pushing directions through the internal model, resulting in a coordinated push. Through the BMI mapping, however, the same spike count activated a more diffuse set of pushing directions, resulting in a “co-contraction” of units that push against each other more than they did through the internal model. These spike counts were recorded mid-movement, when intended speed ought to peak. Thus, this example demonstrates the systematic underestimation of movement speed through the BMI mapping that results from internal model mismatch, consistent with aggregate findings in <xref ref-type="fig" rid="fig5">Figure 5B</xref> (movement bars). Also, consistent with aggregate findings in <xref ref-type="fig" rid="fig3">Figure 3C</xref>, the internal-model predicted velocity (red arrow) points closer in direction to the target (green star) than does the actual cursor velocity (black arrow).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.020">http://dx.doi.org/10.7554/eLife.10015.020</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig5-figsupp1-v2.tif"/></fig></fig-group></p><p>To gain insight into this speed mismatch, we can use extracted internal models to examine the discrepancies between intended and actual speeds at the level of individual units and on the timescale of a single 33-ms timestep (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). These systematic differences between intended and actual cursor speeds indicate that internal model mismatch limits realizable dynamic range of BMI movement speeds. These findings suggest that the longstanding deficiencies in BMI speed control may be a consequence of internal model mismatch.</p></sec><sec id="s2-6"><title>Perturbations drive internal model adaptation</title><p>A key feature of an internal model is its ability to adapt. Arm reaching studies have demonstrated behavioral evidence of internal model adaptation (<xref ref-type="bibr" rid="bib55">Shadmehr and Mussa-Ivaldi, 1994</xref>; <xref ref-type="bibr" rid="bib63">Thoroughman and Shadmehr, 2000</xref>; <xref ref-type="bibr" rid="bib30">Joiner and Smith, 2008</xref>; <xref ref-type="bibr" rid="bib62">Taylor et al., 2014</xref>). Behavioral learning has also been demonstrated in the context of BMIs (<xref ref-type="bibr" rid="bib61">Taylor, 2002</xref>; <xref ref-type="bibr" rid="bib5">Carmena et al., 2003</xref>; <xref ref-type="bibr" rid="bib29">Jarosiewicz et al., 2008</xref>; <xref ref-type="bibr" rid="bib14">Ganguly and Carmena, 2009</xref>; <xref ref-type="bibr" rid="bib6">Chase et al., 2012</xref>; <xref ref-type="bibr" rid="bib48">Sadtler et al., 2014</xref>). While these BMI studies suggest that subjects adapt their internal models to better match the BMI mapping, a direct assessment has been difficult without access to those internal models. With the ability to extract a subject’s internal model, here we asked whether extracted internal models adapt in accordance with perturbations to the BMI mapping (<xref ref-type="fig" rid="fig6">Figure 6</xref>). In one monkey, an initial block of trials under an intuitive BMI mapping was followed by a block of trials under a perturbed BMI mapping. All data analyzed prior to this section were recorded during intuitive trials. The intuitive and perturbed mappings were of the form of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, but each used different values in the matrix <inline-formula><mml:math id="inf174"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula>. The perturbed BMI mapping effectively rotated the pushing directions of a subset of the recorded units, such that the global effect resembled a visuomotor rotation (see the 'Behavioral task' subsection in 'Materials and methods'). Previous studies have shown that perturbations of this type can be learned by monkeys (<xref ref-type="bibr" rid="bib67">Wise et al., 1998</xref>; <xref ref-type="bibr" rid="bib47">Paz et al., 2005</xref>; <xref ref-type="bibr" rid="bib6">Chase et al., 2012</xref>).<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.10015.021</object-id><label>Figure 6.</label><caption><title>Extracted internal models capture adaptation to perturbations.</title><p>(<bold>A</bold>) Cross-validated angular errors computed by interpreting monkey A neural activity through BMI mappings and internal models. The intuitive BMI mapping (blue) defined cursor behavior during the intuitive and washout trials. The perturbed BMI mapping (red) defined cursor behavior during the perturbation trials. The late intuitive internal model (yellow) was extracted from the last 48 intuitive trials (yellow bar). A time-varying internal model (green) was extracted from a moving window of the 48 preceding trials. Values were smoothed using a causal 24-trial boxcar filter and averaged across 36 experiments. (<bold>B</bold>) Differences between monkey A’s time-varying internal model and the BMI mappings, assessed through the high-dimensional neural activity. For each round of 16 trials, neural activity from those trials was mapped to velocity through the time-varying internal model, the intuitive BMI mapping, and the perturbed BMI mapping. Signed angles were taken between velocities computed through the time-varying internal model and the intuitive BMI mapping (blue) and between velocities computed through the time varying internal model and the perturbed BMI mapping (red). Values were averaged across 36 experiments.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.10015.021">http://dx.doi.org/10.7554/eLife.10015.021</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-10015-fig6-v2.tif"/></fig></p><p>For each experiment, we interpreted recorded population activity through the intuitive and perturbed BMI mappings, as well as through two views of the subject’s internal model: a time-varying internal model extracted from a moving window of 48 trials, and a late intuitive internal model extracted from the last 48 intuitive trials. We could then quantify changes in the subject’s internal model and assess which BMI mapping or internal model was most consistent with the neural activity, relative to task goals (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). To avoid circularity, trials used to evaluate the BMI mappings and internal models were not used when fitting the internal models nor when calibrating the BMI mappings.</p><p>Errors through the intuitive BMI mapping describe the actual cursor performance during the intuitive and washout trials (thick blue traces; analogous to cursor errors in <xref ref-type="fig" rid="fig3">Figure 3C</xref>), and how that mapping would have performed had it been in effect during the perturbation trials (thin blue trace). Similarly, errors through the perturbed BMI mapping describe the actual cursor performance during the perturbation trials (thick red trace), and how that mapping would have performed had it been in effect during the intuitive and washout trials (thin red traces). Behavioral learning was evident in that errors through the perturbed BMI mapping were large in early perturbation trials and decreased continuously throughout the perturbation trials. A detailed characterization of this behavioral learning can be found in (<xref ref-type="bibr" rid="bib6">Chase et al., 2012</xref>).</p><p>Our key finding in this analysis is that extracted internal models adapted in a manner consistent with the BMI perturbations (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). During the perturbation trials, the time-varying internal model adapted to better match the perturbed BMI mapping (red trace trends toward zero). Similarly, during the washout trials, the time-varying internal model adapted to better match the intuitive BMI mapping (blue trace trends toward zero). Had the subject’s internal model not adapted, or if the adaptation was not reflected in the extracted internal model, we would expect the traces in <xref ref-type="fig" rid="fig6">Figure 6B</xref> to be flat. Rather than being static entities, the extracted internal models were dynamic with timescales independent of experimenter-induced changes to the BMI mapping.</p><p>Consistent with our central hypothesis, internal model mismatch was present throughout the intuitive, perturbation, and washout trials. During intuitive trials, errors through the time-varying internal model were substantially lower than errors through the intuitive BMI mapping (green trace lower than blue trace in <xref ref-type="fig" rid="fig6">Figure 6A</xref>), which is consistent with our main findings in <xref ref-type="fig" rid="fig3">Figure 3C</xref>. Because the subject’s internal model adapts, errors through the time-varying internal model remained substantially smaller than errors through the BMI mappings across the perturbation and washout trials as well (green trace remains low across <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Although behavioral errors decreased over the course of the perturbation and washout trials, internal model mismatch was still present following adaptation (red and blue traces are nonzero during late perturbation and washout trials, respectively, in <xref ref-type="fig" rid="fig6">Figure 6B</xref>).</p><p>It could have been that this internal model mismatch was only substantial during early intuitive trials before the subject had accrued enough experience to form a stable internal model. This was not the case. The subject’s internal model was stable throughout the intuitive session, as evidenced by the nearly constant angular differences between velocities mapped through the time-varying internal model and the BMI mapping (red and blue traces are roughly flat in <xref ref-type="fig" rid="fig6">Figure 6B</xref>) and the nearly identical errors through the time-varying internal model and the (static) late intuitive internal model (green and yellow traces overlap in <xref ref-type="fig" rid="fig6">Figure 6A</xref> wherever cross-validated errors can be computed). Consistent with a stable internal model, behavioral performance was stable throughout the intuitive trials (blue trace is flat in <xref ref-type="fig" rid="fig6">Figure 6A</xref>), and internal model mismatch explained a steady fraction of behavioral errors (green trace is also flat, and substantially lower than blue trace). During the perturbation session, the subject’s internal model diverges from this stabilized state (yellow trace diverges from green trace in <xref ref-type="fig" rid="fig6">Figure 6A</xref> and both traces are non-constant in <xref ref-type="fig" rid="fig6">Figure 6B</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this work, we asked what gives rise to behavioral errors during feedback motor control. In a BMI paradigm, we hypothesized that a mismatch between the subject’s internal model and the actual BMI mapping could explain errors in BMI cursor movement. To assess this, we first found evidence that subjects compensate for sensory feedback delays. Then, we reinterpreted the neural population activity recorded during closed-loop BMI control in terms of a rich internal model that operates on a timescale of tens of milliseconds. We found (i) that subjects’ neural activity was often correct according to the internal model even when cursor movements were circuitous (thereby explaining 65% of cursor errors), and (ii) that subjects intended to hold the cursor steadier during initial hold periods and to drive the cursor faster during movements, relative to observed behavior. Furthermore, when the BMI mapping was perturbed, the subject’s internal model changed in a manner consistent with the new BMI mapping.</p><sec id="s3-1"><title>Internal models influence activity in M1</title><p>In this study, we considered neural population activity recorded in M1. It is reasonable to ask how it is possible to deduce anything about internal models from M1 activity if we are not recording i) signals from the neural circuits that implement internal models (e.g., cerebellum), nor ii) the internal copy signals that enable internal model computations. The rationale is the following. First, the neural activity recorded in M1 is likely to be downstream of the internal model computations, whether they be in cerebellum (<xref ref-type="bibr" rid="bib53">Shadmehr, 1997</xref>; <xref ref-type="bibr" rid="bib46">Pasalar et al., 2006</xref>; <xref ref-type="bibr" rid="bib42">Miall et al., 2007</xref>; <xref ref-type="bibr" rid="bib39">Lisberger, 2009</xref>; <xref ref-type="bibr" rid="bib27">Huang et al., 2013</xref>), posterior parietal cortex (<xref ref-type="bibr" rid="bib53">Shadmehr, 1997</xref>; <xref ref-type="bibr" rid="bib44">Mulliken et al., 2008</xref>), dorsal premotor cortex (<xref ref-type="bibr" rid="bib53">Shadmehr, 1997</xref>), or elsewhere. Thus, the internal model is likely to influence the neural activity produced in M1. By relating the neural activity recorded in M1 to the behavioral task on a moment-by-moment basis, we should be able to infer properties of the upstream internal model. Second, previous studies indicate that internal copy signals (e.g., efference copy, corollary discharge) carry information about movement intent, in particular a copy of the movement intent that M1 sends to the motor effector (<xref ref-type="bibr" rid="bib7">Crapse and Sommer, 2008</xref>; <xref ref-type="bibr" rid="bib27">Huang et al., 2013</xref>; <xref ref-type="bibr" rid="bib49">Schneider et al., 2014</xref>; <xref ref-type="bibr" rid="bib2">Azim et al., 2014</xref>). Although we are not directly recording the internal copy signal, the information in the internal copy relevant to movement intent is likely also present in the recorded M1 activity, and this is what we leveraged. In short, we make no claims about the neural circuitry implementing internal models, but rather we infer statistical properties of the internal models from their downstream consequences in M1. Using this rationale, we extracted internal models from M1 population activity.</p><p>We chose to capture the subject’s internal model using a forward model framework (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref> and <xref ref-type="fig" rid="fig3">Figure 3A</xref>) because it is both highly interpretable and consistent with a large body of behavioral and computational studies (<xref ref-type="bibr" rid="bib54">Shadmehr and Krakauer, 2008</xref>; <xref ref-type="bibr" rid="bib13">Frens, 2009</xref>). Our results do not preclude the use of other types of internal models, such as an inverse model (<xref ref-type="bibr" rid="bib55">Shadmehr and Mussa-Ivaldi, 1994</xref>; <xref ref-type="bibr" rid="bib31">Kawato, 1999</xref>), whose acquisition and function is believed to be tightly coupled to that of the forward model (<xref ref-type="bibr" rid="bib69">Wolpert and Kawato, 1998</xref>).</p></sec><sec id="s3-2"><title>Avoiding circularity when extracting an internal model</title><p>We presented four important lines of evidence that indicate that the extracted internal models are meaningful, and not a result of logical circularity during model fitting or overfitting to noise in the data. First, extracted internal models explain a majority of behavioral errors on trials not seen during model fitting (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Here, extracted internal models identified structure in the high-dimensional neural activity that indicated straight-to-target movement intent, even when the cursor behavior was circuitous. Internal model predictions on held-out trials could not trivially point toward the targets because that held-out neural activity had not been used during model fitting, and because target positions were never used when constructing internal model predictions from held-out trials. Second, the finding that intended speed is better predicted by internal models than the BMI mapping (<xref ref-type="fig" rid="fig5">Figure 5B</xref>) lends an additional independent validation of those internal models, since no assumptions were made about intended movement speed when fitting internal models. Third, when we perturbed the BMI mapping, extracted internal models revealed adaptation consistent with the particular perturbations (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><p>Finally, we performed a series of scientific and statistical control analyses. We showed that our data are not consistent with two versions of the alternative hypothesis, in which the subject’s internal model is well-matched to the BMI mapping (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref> and <xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>). Further, we asked whether extracted internal models could explain the observed behavioral errors without access to structure in the high-dimensional neural activity beyond that which defined cursor movements. We considered two different alterations to the data from which internal models were extracted: one in which we replaced the high-dimensional neural activity with low-dimensional cursor velocities (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>) and another in which we shuffled the neural activity in a manner that preserved cursor velocities through the BMI mapping (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>). In both cases, we found that the extracted internal models no longer offered a consistent explanation for the observed behavioral errors, thereby demonstrating that the explanatory power of the extracted internal models does not arise from logical circularity or overfitting.</p></sec><sec id="s3-3"><title>Relationship between internal models and BMI mappings</title><p>An extracted internal model and a BMI mapping are closely related. They take a similar mathematical form (<xref ref-type="disp-formula" rid="equ1">Equations 1</xref> and <xref ref-type="disp-formula" rid="equ2">2</xref>) and both project high-dimensional population activity to a low-dimensional kinematic space. A key difference between internal models and BMI mappings is that internal models are dynamic entities whose properties can change during motor adaptation. In contrast, the BMI mappings are chosen by the experimenter or by a computer algorithm. Critically, in experiments in which we abruptly applied a perturbed BMI mapping, we found that extracted internal models dynamically adjusted in a manner appropriate for the task and at a timescale independent of changes to the BMI mapping (<xref ref-type="fig" rid="fig6">Figure 6</xref>). The ability to interpret neural activity through the subject’s internal model, while the subject controls the cursor through some BMI mapping (e.g., <xref ref-type="fig" rid="fig4">Figure 4A,B</xref>, <xref ref-type="fig" rid="fig6">Figure 6A</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>), offers a unique glimpse into the subject’s movement intentions, sensory prediction errors, and motor adaptation.</p><p>Given the substantial fraction of behavioral errors that are explained by internal model mismatch during control under the intuitive BMI mapping, it is perhaps surprising that we did not find evidence of behavioral or internal model adaptation during those trials (<xref ref-type="fig" rid="fig6">Figure 6</xref>). A way to reconcile these findings is that, in contrast to the frequent movement errors experienced after the BMI mapping was perturbed, there was a relative paucity of errors during the intuitive trials. As a result, there may not have been sufficient pressure to improve upon a “good enough” internal model (<xref ref-type="bibr" rid="bib40">Loeb, 2012</xref>). Had the subject been given more experience with the same BMI mapping (<xref ref-type="bibr" rid="bib14">Ganguly and Carmena, 2009</xref>), the internal model may have converged to the BMI mapping. Nevertheless, our findings indicate that the subject’s learning process may be a key limitation in BMI performance (<xref ref-type="bibr" rid="bib48">Sadtler et al., 2014</xref>). It may be possible to overcome these limitations in the subject’s neural adaptation process through complementary innovations in designing the BMI mapping (<xref ref-type="bibr" rid="bib57">Shenoy and Carmena, 2014</xref>). For example, applying an extracted internal model as the BMI mapping might improve performance during closed-loop BMI control. Indeed, a recent study incorporating the concept of internal tracking has demonstrated substantial gains in closed-loop BMI performance (<xref ref-type="bibr" rid="bib17">Gilja et al., 2012</xref>). Future studies will be required to determine whether further improvements in performance might be possible by using the IME framework toward designing the BMI mapping.</p></sec><sec id="s3-4"><title>Leveraging multi-dimensional structure in population activity</title><p>The insights gained in this study were made possible because we monitored the subject’s high-dimensional neural activity. Because the BMI mapping and the subject’s internal model are high-to-low dimensional mappings, neural activity that was consistently correct under the internal model sometimes resulted in aberrant behavior through the BMI mapping. We would not have been able to observe or explain this phenomenon by analyzing the BMI cursor movements in isolation (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). In particular, by replacing all instances of neural activity (i.e., the <inline-formula><mml:math id="inf175"><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>) with actual cursor velocities (or analogously, with actual hand velocities from an arm reaching task), IME becomes limited to predicting the subject’s velocity intent to be a scaled and rotated (in two-dimensions) version of the actual velocity. In contrast, access to the high-dimensional neural activity enabled the identification of the subject’s intended movements without constraining them to have a consistent relationship with actual movements.</p><p>Prior beliefs, and their role in sensation and behavior, have been the focus of many studies, including those on visual perception (<xref ref-type="bibr" rid="bib34">Kersten et al., 2004</xref>; <xref ref-type="bibr" rid="bib36">Komatsu, 2006</xref>; <xref ref-type="bibr" rid="bib3">Berkes et al., 2011</xref>), perceptual decision-making (<xref ref-type="bibr" rid="bib41">Ma and Jazayeri, 2014</xref>), and sensorimotor learning (<xref ref-type="bibr" rid="bib37">Körding and Wolpert, 2004</xref>; <xref ref-type="bibr" rid="bib64">Turnham et al., 2011</xref>). Our work provides a means for extracting a rich representation of prior beliefs (i.e., the internal model) that can combine past sensory input with multi-dimensional neural processes to drive moment-by-moment motor control decisions. We found that outwardly aberrant behavior and behavioral limitations could be explained by taking into account the subject’s prior beliefs. By recording simultaneously from multiple neurons and developing the appropriate statistical algorithms, it may be possible to extract similarly rich prior beliefs in other systems.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Neural recordings</title><p>Two male rhesus macaques (Maccaca mulatta) were each implanted with a 96-channel microelectrode array (Blackrock Microsystems, Salt Lake City, UT) targeting proximal arm area of primary motor cortex. Signals were amplified, bandpass filtered (250 Hz - 8 kHz) and manually sorted (Plexon Sort Client, box sort) with a 96-channel Plexon MAP system (Plexon, Dallas, TX). Recorded neuronal units were either well-isolated single cells or multiple cells that could not be well separated but as a group were tuned to intended movement direction. In each session, we recorded 26.0 <inline-formula><mml:math id="inf176"> <mml:mo>± </mml:mo></mml:math></inline-formula> 3.4 (monkey A) and 39.2 <inline-formula><mml:math id="inf177"> <mml:mo>± </mml:mo></mml:math></inline-formula> 3.9 (monkey C) neuronal units (mean <inline-formula><mml:math id="inf178"> <mml:mo>± </mml:mo></mml:math></inline-formula> one standard deviation). Spike counts were taken in nonoverlapping 33-ms bins throughout the behavioral task (see 'Behavioral task'). All animal procedures were approved by the Institutional Animal Care and Use Committee of the University of Pittsburgh.</p></sec><sec id="s4-2"><title>Behavioral task</title><p>Subjects modulated neural activity to drive movements of a virtual cursor in a 2D brain-machine interface (BMI) task. The cursor (radius: 7–8 mm, monkey A; 6 mm monkey C) and targets (same radii as cursor) were displayed to the subject on a frontoparallel stereoscopic display (Dimension Technologies, Rochester, NY) with a refresh rate of 60 Hz. Display updates were subject to a latency of up to 2 refresh cycles (0–33.3 ms). Target positions were chosen pseudorandomly from a set of 16 evenly-spaced radial targets (center-to-target distance: 85 mm, monkey A; 72–73 mm, monkey C). Each trial began with the cursor at the workspace center, where the subject was required to hold the cursor to visibly overlap a central target (center hold requirement randomly selected for each trial: 50–350 ms, monkey A; 50–150 ms, monkey C). Following completion of the initial hold, a peripheral target appeared, instructing the subject to initiate a cursor movement. Target acquisition was recorded as the first timestep during which the cursor visibly overlapped the peripheral target. Following target acquisition, the subject was required to hold the cursor steady without losing visible overlap between the cursor and target (target hold requirement randomly selected for each trial: 50–100 ms, monkey A; 50 ms, monkey C). A limit was placed on the time between target onset and target acquisition (1.5–2 s, monkey A; 1.2–2 s, monkey C). A trial was deemed failed and terminated if visible overlap between cursor and target was lost before satisfying either hold requirement. If all requirements were met, a trial was deemed successful, and the subject was provided with a water reward (120 <inline-formula><mml:math id="inf179"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mtext>l</mml:mtext></mml:mrow></mml:math></inline-formula>, monkey A; 120–130 <inline-formula><mml:math id="inf180"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mtext>l</mml:mtext></mml:mrow></mml:math></inline-formula>, monkey C). Arms were restrained, and little to no hand movements were observed (although hand positions were not recorded).</p><p>The analyzed data were subsets of data from larger experiments. The experimental details for monkey A have been described previously (all no invisible zone conditions from <xref ref-type="bibr" rid="bib6">Chase et al., 2012</xref>). Briefly, each experiment began with roughly 40 trials that were used to calibrate the intuitive BMI mapping (see 'Calibration of the BMI mapping'). Following calibration was a block of 169 <inline-formula><mml:math id="inf181"> <mml:mo>± </mml:mo></mml:math></inline-formula> 8.1 successful trials under this intuitive BMI mapping. Next, the BMI mapping was systematically perturbed and held constant for 365 <inline-formula><mml:math id="inf182"> <mml:mo>± </mml:mo></mml:math></inline-formula> 126 successful trials. Each perturbation effectively rotated a random subset of recorded units’ decoded pushing directions (DPDs), as in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2B</xref>, by a particular angle (5 experiments with 25% of units’ DPDs rotated <inline-formula><mml:math id="inf183"><mml:msup><mml:mn>90</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math></inline-formula>; 20 experiments with 50% of units’ DPDs rotated 60°; 11 experiments with 100% of units’ DPDs rotated 30°). In 33 of 36 experiments, perturbation trials were followed by 360 ± 237 successful washout trials, during which the perturbation was removed, and the BMI mapping was restored to the intuitive mapping. Unless noted otherwise, analyses of monkey A data refer to intuitive trials. Data from the perturbation and washout trials appear only in <xref ref-type="fig" rid="fig6">Figure 6</xref>. Each of the 36 experiments comprising these data took place on a unique day.</p><p>For monkey C, BMI cursor control alternated between the 2D task (described above) and a 3D task (described below). All monkey C trials analyzed in this work came from the 2D task. Each day began with roughly 40–50 trials to calibrate an intuitive BMI mapping. Following calibration, subsequent blocks alternated between the 2D task and the 3D task, with the first of these tasks chosen randomly each day. The 3D task was similar to the 2D task, except that the cursor was allowed to move in 3D, and targets were distributed about the surface of a workspace-centered sphere. Blocks with the 2D task consisted of 277 ± 70.4 trials, and blocks with the 3D task consisted of 527 ± 252 trials. Each day consisted of either 3 or 4 blocks. Monkey C experiments did not include trials under a perturbed BMI mapping. The 18 2D blocks analyzed in this work took place on 12 unique days.</p></sec><sec id="s4-3"><title>The BMI mapping</title><p>BMI cursor position and velocity were determined from recorded spike counts according to a BMI mapping:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:msub><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub><mml:mo mathvariant="bold">⁢</mml:mo><mml:mi mathvariant="bold">Δ</mml:mi></mml:math></disp-formula><disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi></mml:msub><mml:mo mathvariant="bold">⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext mathvariant="bold">t</mml:mtext></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi></mml:msub></mml:math></disp-formula></p><p>where at timestep <inline-formula><mml:math id="inf184"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf185"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is the cursor position, <inline-formula><mml:math id="inf186"><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is the cursor velocity, <inline-formula><mml:math id="inf187"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mn>33</mml:mn></mml:mrow></mml:math></inline-formula> ms is the timestep duration, <inline-formula><mml:math id="inf188"><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mi>q</mml:mi></mml:msup></mml:math></inline-formula> is the mean spike count vector recorded simultaneously across <inline-formula><mml:math id="inf189"><mml:mi>q</mml:mi></mml:math></inline-formula> neuronal units over the past 5 timesteps (167 ms), and <inline-formula><mml:math id="inf190"><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf191"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> are the parameters that map neural activity to cursor velocity. Note that the BMI mapping (<xref ref-type="disp-formula" rid="equ5">Equations 5</xref> and <xref ref-type="disp-formula" rid="equ6">6</xref>) can be written equivalently in the form of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:msub><mml:mi mathvariant="bold">Ax</mml:mi><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:msub><mml:mi mathvariant="bold">Bu</mml:mi><mml:mtext mathvariant="bold">t</mml:mtext></mml:msub><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:mi mathvariant="bold">b</mml:mi><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:mspace linebreak="newline"/><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo> </mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold">I</mml:mi></mml:mtd><mml:mtd><mml:mi mathvariant="bold">I</mml:mi><mml:mo mathvariant="bold">·</mml:mo><mml:mo mathvariant="bold">∆</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn mathvariant="bold">0</mml:mn></mml:mtd><mml:mtd><mml:mn mathvariant="bold">0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo mathvariant="bold"> </mml:mo><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn mathvariant="bold">0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo mathvariant="bold"> </mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn mathvariant="bold">0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math></disp-formula></p><p>where the cursor state, <inline-formula><mml:math id="inf192"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, concatenates cursor position and velocity.</p><p>In some of the following analyses, we required more precise time resolution than could be achieved by analyzing the 5-timestep smoothed velocity commands that drove the BMI cursor (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>). For fine-timescale analyses, we defined single-timestep (i.e., unsmoothed) velocity commands as:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mtext mathvariant="bold">t</mml:mtext><mml:mtext mathvariant="bold">raw</mml:mtext></mml:msubsup><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi></mml:msub><mml:mo mathvariant="bold">⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext mathvariant="bold">t</mml:mtext><mml:mtext mathvariant="bold">raw</mml:mtext></mml:msubsup><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:mo mathvariant="bold"> </mml:mo><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">v</mml:mi></mml:msub></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf193"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup></mml:math></inline-formula> is the vector of recorded spike counts during the single timestep <inline-formula><mml:math id="inf194"><mml:mi>t</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf195"><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf196"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> are the decoding parameters that were applied online, as in <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>. Note that <inline-formula><mml:math id="inf197"><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> is the average of single-timestep velocity commands, <inline-formula><mml:math id="inf198"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>.</p></sec><sec id="s4-4"><title>Calibration of the BMI mapping</title><p>Calibration of parameters <inline-formula><mml:math id="inf199"><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf200"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> of the intuitive BMI mapping was done in closed-loop and followed the population vector algorithm (<xref ref-type="bibr" rid="bib15">Georgopoulos et al., 1983</xref>). Details on this closed-loop calibration have been published previously in <xref ref-type="bibr" rid="bib6">Chase et al. (2012)</xref>. For monkey A, an initial sequence of 8 evenly-spaced radial targets was presented to the subject while the cursor remained stationary at the workspace center. Then, an initial set of BMI parameters was determined by regressing the average spike rates for each trial in this sequence against the corresponding target directions. A second sequence of 8 trials followed, with cursor movements determined by the initial parameter set, but with assistance provided by attenuating velocities perpendicular to target directions. Following this second sequence of trials, new decoding parameters were determined by regressing spike rates from all previous trials against the corresponding target directions. This process was repeated for typically 5 sequences (40 trials), with less assistance in each subsequent sequence until no assistance was provided. The schedule of assistance was determined on an ad-hoc basis. The intuitive BMI mapping calibrated from these trials was then used for the subsequent block of analyzed trials (see 'Behavioral task').</p><p>For monkey C, the first task of each day was randomly selected between the 2D and 3D tasks. If the first task was 2D, calibration followed the same procedure as with monkey A. If the first task was 3D, each calibration sequence consisted of 10 targets equidistant from the workspace center. Eight of these targets were on the corners of a workspace-centered cube. The remaining 2 targets were nearly straight out and straight in along the z-direction, but slightly offset so that the cursor was not visually obscured at the central start position. Because these target directions were specified in 3D, calibration regressions resulted in parameters <inline-formula><mml:math id="inf201"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf202"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">b</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> that could map neural activity to 3D velocity. When the task switched to 2D, the parameters <inline-formula><mml:math id="inf203"><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf204"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> were set to the first two rows of <inline-formula><mml:math id="inf205"><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf206"><mml:msubsup><mml:mi mathvariant="bold">b</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, respectively, corresponding to mapped velocities in the frontoparallel plane only. These 3D calibrations typically spanned five 10-trial sequences (50 trials).</p></sec><sec id="s4-5"><title>Characterizing inherent visuomotor latencies</title><p>BMI subjects experience an inherent visual feedback delay. To assess the visuomotor latency experienced by a subject in our BMI system, we measured the elapsed time between target onset and the appearance of target-related activity in the recorded neural population (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). To determine the first timestep at which neural activity contained target information, we found the first significant decrease in angular error relative to baseline error. For each trial, baseline error was defined to be the average of absolute angular errors prior to target onset. Here, the angular error at timestep <inline-formula><mml:math id="inf207"><mml:mi>t</mml:mi></mml:math></inline-formula> was defined to be the angle by which the cursor would have missed the target had it continued from its current position, <inline-formula><mml:math id="inf208"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, in the direction of the single-timestep velocity command, <inline-formula><mml:math id="inf209"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup></mml:math></inline-formula>, from <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>. Single-timestep commands (<inline-formula><mml:math id="inf210"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup></mml:math></inline-formula>) were analyzed here (as opposed to smoothed cursor velocities, <inline-formula><mml:math id="inf211"><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula>) for improved temporal resolution. Because absolute angular errors range from <inline-formula><mml:math id="inf212"><mml:mrow><mml:mn>0</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, one might reasonably expect baseline error to be roughly <inline-formula><mml:math id="inf213"><mml:msup><mml:mn>90</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math></inline-formula>. Baseline errors shown are less than <inline-formula><mml:math id="inf214"><mml:msup><mml:mn>90</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math></inline-formula> because angular errors were computed relative to the cursor-target overlap zone (i.e., taking into account cursor and target radii; see <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). When errors were instead computed relative to the target center, baseline errors were roughly <inline-formula><mml:math id="inf215"><mml:msup><mml:mn>90</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math></inline-formula>, and identified latencies were unaffected (data not shown). Had we introduced an arbitrary additional delay to the display updates (<xref ref-type="bibr" rid="bib66">Willett et al., 2013</xref>), we would expect a commensurate increase in the identified feedback delay.</p></sec><sec id="s4-6"><title>Assessing feedback delay compensation</title><p>Because of the visual feedback delay (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), at timestep <inline-formula><mml:math id="inf216"><mml:mi>t</mml:mi></mml:math></inline-formula> the subject cannot yet directly access the timestep <inline-formula><mml:math id="inf217"><mml:mi>t</mml:mi></mml:math></inline-formula> cursor position. To determine whether subjects compensated for the visual feedback delay, we asked whether neural activity recorded at timestep <inline-formula><mml:math id="inf218"><mml:mi>t</mml:mi></mml:math></inline-formula> was more appropriate for the timestep <inline-formula><mml:math id="inf219"><mml:mi>t</mml:mi></mml:math></inline-formula> cursor position or for a previous cursor position. Across a range of lags, <inline-formula><mml:math id="inf220"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo>-</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> ms<inline-formula><mml:math id="inf221"><mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula> ms<inline-formula><mml:math id="inf222"><mml:mo>]</mml:mo></mml:math></inline-formula>, we computed the angular errors of single-timestep velocity commands, <inline-formula><mml:math id="inf223"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>t</mml:mtext><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula> (as in <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>), as if they had originated at lagged positions <inline-formula><mml:math id="inf224"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>).</p><p>Here, angular errors were defined to be the absolute angle by which the cursor would have missed the target had it originated at position <inline-formula><mml:math id="inf225"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and continued in the direction of the single-timestep velocity command <inline-formula><mml:math id="inf226"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>t</mml:mtext><mml:mi>raw</mml:mi></mml:msubsup></mml:math></inline-formula>, taking into account the radii of the cursor and the target (i.e., <inline-formula><mml:math id="inf227"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). This error metric was chosen because it reflects the task goal, that to succeed in a trial, the subject had to to acquire visible overlap between the cursor and the target (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><p>By taking into account cursor and target radii, this error metric is influenced by cursor-to-target distance. Specifically, velocity commands originating from positions close to the target will have smaller errors under this definition than the same velocity commands originating far from the target (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Without accounting for this distance-to-target bias, absolute angular errors might appear smaller for lags that are less positive because these lagged cursor positions will tend to be closer to the targets than cursor positions with more positive lags (e.g., <inline-formula><mml:math id="inf228"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> tends to be closer to the target when <inline-formula><mml:math id="inf229"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> ms than when <inline-formula><mml:math id="inf230"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula> ms). To ensure that this distance-to-target bias did not influence our conclusions about feedback delay compensation, errors were computed for the same exact subset of cursor positions across lags. This selection process preserves cursor-to-target distances across lags and thus ensures that the same exact error bias is applied at each lag. To this end, we included in this analysis only cursor positions for which all required lags of neural activity were recorded within the corresponding trial. Further, we only considered cursor positions that were presented at least 100 ms following target onset to ensure that recorded neural activity could plausibly reflect target position given a feedback delay of 100 ms. To determine the error value for a particular lag along the curves in <xref ref-type="fig" rid="fig2">Figure 2C</xref>, we first averaged all absolute angular errors for that lag within each trial, and then averaged across trials. A preliminary version of this analysis using different experiments has appeared in conference form (<xref ref-type="bibr" rid="bib20">Golub et al., 2012</xref>).</p></sec><sec id="s4-7"><title>Framework for internal model estimation (IME)</title><p>The IME framework is a statistical tool we developed to extract from neural population activity i) a subject’s internal model of the BMI mapping, and ii) the subject’s timestep-by-timestep internal predictions about the cursor state. The central concept underlying the IME framework is that at each timestep, the subject internally predicts the current cursor position using outdated visual feedback and a recollection of previously-issued neural commands (representative of efference copy or corollary discharge [<xref ref-type="bibr" rid="bib7">Crapse and Sommer, 2008</xref>]), and issues the next neural command with the intention of driving the cursor straight toward the target from the up-to-date prediction of the current cursor position (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p><p>Formally, the IME framework is a probabilistic model defined by <xref ref-type="disp-formula" rid="equ10 equ11 equ12 equ13 equ14 equ15">Equations 9–14</xref> . The subject’s internal model, as introduced in <xref ref-type="fig" rid="fig3">Figure 3A</xref>, is is represented as follows:<disp-formula id="equ9"><mml:math id="m9"><mml:mtext>for</mml:mtext><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mo>{</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>}</mml:mo><mml:mo>:</mml:mo></mml:math></disp-formula><disp-formula id="equ10"><label>(9)</label><mml:math id="m10"><mml:mspace width="2.5pc"/><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></disp-formula><disp-formula id="equ11"><label>(10)</label><mml:math id="m11"><mml:mspace width="8pc"/><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo mathvariant="bold"> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">w</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf231"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf232"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> are the subject’s internal predictions of the timestep <inline-formula><mml:math id="inf233"><mml:mi>k</mml:mi></mml:math></inline-formula> cursor position and velocity when the subject is sitting at timestep <inline-formula><mml:math id="inf234"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf235"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> is the timestep of the BMI system (33 ms), <inline-formula><mml:math id="inf236"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>k</mml:mtext><mml:mi>raw</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>q</mml:mi></mml:msup></mml:math></inline-formula> is a vector of the spike counts recorded simultaneously across the <inline-formula><mml:math id="inf237"><mml:mi>q</mml:mi></mml:math></inline-formula> neuronal units at timestep <inline-formula><mml:math id="inf238"><mml:mi>k</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf239"><mml:mrow><mml:mrow id="XM35"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM36"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf240"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> are parameters capturing the subject’s internal model, and <inline-formula><mml:math id="inf241"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">w</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> is a Gaussian random variable (with isotropic noise variance, <inline-formula><mml:math id="inf242"><mml:mi>w</mml:mi></mml:math></inline-formula>) representing internal predictions not captured by the internal model. More specifically, <inline-formula><mml:math id="inf243"><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> represents the subject’s internal conception of the physical properties of the cursor, and <inline-formula><mml:math id="inf244"><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> represents the subject’s internal conception of how neural activity drives movement of the cursor. Note that the subject’s internal model in <xref ref-type="disp-formula" rid="equ10 equ11">Equations 9 and 10</xref> can be written in the form of <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>:<disp-formula id="equ12"><label>(11)</label><mml:math id="m12"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>k</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mover><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msubsup><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mtext>k</mml:mtext><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>t</mml:mtext></mml:msubsup><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>k</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup><mml:mo mathvariant="bold"> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mover><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mtext>noise </mml:mtext><mml:mo>=</mml:mo><mml:mspace linebreak="newline"/><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>k</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>k</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold">I</mml:mi></mml:mtd><mml:mtd><mml:mi mathvariant="bold">I</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mover><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo>⁢</mml:mo><mml:mo> </mml:mo><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>k-1</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>k-1</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>k</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup><mml:mo mathvariant="bold"> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mover><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="bold">w</mml:mi><mml:mtext>k</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math></disp-formula></p><p>where the subject’s internal state prediction, <inline-formula><mml:math id="inf245"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>k</mml:mtext></mml:msubsup></mml:math></inline-formula>, includes the internal prediction of cursor position, <inline-formula><mml:math id="inf246"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>k</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula>, and velocity, <inline-formula><mml:math id="inf247"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>k</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula>. For simplicity in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>, we omitted the noise term, the superscript notation, and the distinction between spike count vectors recorded at a single timestep, <inline-formula><mml:math id="inf248"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup></mml:math></inline-formula>, and average spike count vectors across 5 timesteps, <inline-formula><mml:math id="inf249"><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> (more details on smoothing are given below).</p><p>Visual feedback grounds the subject’s internal predictions with reality. At timestep <inline-formula><mml:math id="inf250"><mml:mi>t</mml:mi></mml:math></inline-formula>, the subject’s internal prediction of the cursor position and velocity at the feedback delay (<inline-formula><mml:math id="inf251"><mml:mi>τ</mml:mi></mml:math></inline-formula>, as discussed in Parameter fitting for the IME framework) match the most recently available cursor position and velocity from visual feedback:<disp-formula id="equ13"><label>(12)</label><mml:math id="m13"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mtext>t</mml:mtext></mml:msubsup><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula><disp-formula id="equ14"><label>(13)</label><mml:math id="m14"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mtext>t</mml:mtext></mml:msubsup><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>The internal model in <xref ref-type="disp-formula" rid="equ10 equ11">Equations 9 and 10</xref> is then applied recursively (i.e., across <inline-formula><mml:math id="inf252"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow id="XM52"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi id="XM50" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM51">t</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) to arrive at up-to-date predictions, <inline-formula><mml:math id="inf253"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf254"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula>, about the current cursor state. The resulting set of internal predictions corresponds to the whiskers shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>, <xref ref-type="fig" rid="fig4">Figure 4</xref>, and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>.</p><p>Finally, we incorporate the notion of straight-to-target aiming intention with:<disp-formula id="equ15"><label>(14)</label><mml:math id="m15"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo mathvariant="bold"> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf255"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is the target position, <inline-formula><mml:math id="inf256"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> is a non-negative distance scale parameter, and <inline-formula><mml:math id="inf257"><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is a Gaussian random variable (with isotropic noise variance, <inline-formula><mml:math id="inf258"><mml:mi>r</mml:mi></mml:math></inline-formula>) representing internal velocity predictions that do not point straight to the target. Since the target was held constant within each BMI trial, <inline-formula><mml:math id="inf259"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> took on the same value for all timesteps corresponding to a particular trial. Intuitively, <xref ref-type="disp-formula" rid="equ15">Equation 14</xref> says that when the subject internally believed the cursor to be at position <inline-formula><mml:math id="inf260"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula>, the intended velocity command, <inline-formula><mml:math id="inf261"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula>, ought to point in the direction of the target, <inline-formula><mml:math id="inf262"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula>. The distance scale parameters, <inline-formula><mml:math id="inf263"><mml:msub><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, allow the data to determine the intended speed (i.e., velocity magnitude) at each timestep. This parameterization allows us to avoid imposing a-priori assumptions about the subject’s intended speed. During model fitting, larger values of <inline-formula><mml:math id="inf264"><mml:msub><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> tend to be learned for timesteps when the distance to target is large (from <inline-formula><mml:math id="inf265"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula>), and smaller values tend to be learned when this distance is small. In this manner, there are no assumptions imposed upon intended speed during model fitting. Rather, the learned internal model determines intended speed from the data. Additionally, the linear form of <xref ref-type="disp-formula" rid="equ15">Equation 14</xref> was chosen so all latent variables, <inline-formula><mml:math id="inf266"><mml:mrow><mml:mo>{</mml:mo><mml:mover accent="true" id="XM53"><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true" id="XM54"><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, and observed variables, <inline-formula><mml:math id="inf267"><mml:mo>{</mml:mo><mml:mi mathvariant="bold">G</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">u</mml:mi><mml:mi>raw</mml:mi></mml:msup><mml:mo>}</mml:mo></mml:math></inline-formula>, are jointly Gaussian.</p><p>Throughout control, new visual feedback continues to arrive, and new neural commands are issued at each timestep. IME captures this progression by including a new set of internal predictions (i.e., a new whisker) at each timestep. For example, at timestep <inline-formula><mml:math id="inf268"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the subject receives new feedback about the cursor state, <inline-formula><mml:math id="inf269"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf270"><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and accordingly forms a new set of internal predictions <inline-formula><mml:math id="inf271"><mml:mo>{</mml:mo><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>k</mml:mtext><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>k</mml:mtext><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:math></inline-formula> for <inline-formula><mml:math id="inf272"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow id="XM65"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi id="XM63" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow id="XM66"><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The full IME probabilistic graphical model is drawn in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> to visually depict this instantiation of <xref ref-type="disp-formula" rid="equ10 equ11 equ12 equ13 equ14 equ15">Equations 9–14</xref> at each timestep during control.</p><p>Through <xref ref-type="disp-formula" rid="equ15">Equation 14</xref> we assume that the subject attempts to move the cursor straight to the target from an internal estimate of the current position. We believe that straight-to-target aiming is a reasonable first-order assumption because the BMI cursor, on average, moves straight to the target during proficient control (see <xref ref-type="fig" rid="fig1">Figure 1B</xref>). It may be possible to incorporate other movement objectives, such as minimizing endpoint error (<xref ref-type="bibr" rid="bib25">Harris and Wolpert, 1998</xref>) or movement jerk (<xref ref-type="bibr" rid="bib12">Flash and Hogan, 1985</xref>), in the IME framework, which may yield even greater explanatory power. However, at present, there is not clear evidence that these other movement objectives underlie BMI cursor control, so we apply only the basic straight-to-target movement objective in this work.</p><p>Both the BMI mapping (<xref ref-type="disp-formula" rid="equ5 equ6 equ7">Equations 5–7</xref>) and the internal model representation (<xref ref-type="disp-formula" rid="equ10 equ11 equ12">Equations 9–11</xref>) implement smoothness across BMI cursor velocities and internal velocity predictions, respectively. The details of this smoothing are subtly different between the BMI and the IME framework. To mitigate the effects of neural spiking noise, the BMI mapping smooths cursor velocities by incorporating neural activity at each timestep through the 5-timestep boxcar filter, as described following <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>. Temporal smoothing in internal velocity predictions is achieved through the subject’s internal prior belief about how the internal velocity prediction at one timestep influences the prediction at the next timestep, as encoded by <inline-formula><mml:math id="inf273"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>In a preliminary IME formulation we presented recently in conference form (<xref ref-type="bibr" rid="bib19">Golub et al., 2013</xref>), the subject’s internal state prediction was modeled using position only, rather than using both position and velocity, as we have here. The inclusion of velocity has several important advantages. First, it allows the model to capture the subject using feedback about cursor velocity to internally predict cursor position and velocities. Second, including velocity in the state enables IME to automatically determine the degree of smoothness in internal velocity predictions, based on the data, by fitting an appropriate <inline-formula><mml:math id="inf274"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula>.</p></sec><sec id="s4-8"><title>Parameter fitting for the IME framework</title><p>We fit IME models using expectation maximization (EM) (<xref ref-type="bibr" rid="bib9">Dempster et al., 1977</xref>), a maximum likelihood estimation technique for latent variable models. Training data for each trial consisted of recorded spike counts and actual cursor positions for timesteps beginning at movement onset and ending at target acquisition, as well as the target position for that trial. Movement onset for a given trial was defined as the first timestep at which the cursor speed, projected in the center-to-target direction, exceeded 15% of its maximum from that trial. During the E-step, posterior distributions, P(<inline-formula><mml:math id="inf275"><mml:mrow><mml:mo>{</mml:mo><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>}</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">u</mml:mi><mml:mi>raw</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mtext mathvariant="bold">G</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>), are computed over the internal states given a set of model parameters. Intuitively, these posteriors are distributions over whiskers that compromise between satisfying the internal model (<xref ref-type="disp-formula" rid="equ10 equ11">Equations 9 and 10</xref>) and straight-to-target aiming (<xref ref-type="disp-formula" rid="equ15">Equation 14</xref>). During the M-step, these posterior distributions are used to update the model parameters, <inline-formula><mml:math id="inf276"><mml:mrow><mml:mover accent="true" id="XM75"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true" id="XM76"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true" id="XM77"><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi id="XM78">w</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub id="XM74"><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf277"><mml:mi>r</mml:mi></mml:math></inline-formula>. We typically ran EM for 5000 iterations, but allowed fewer iterations if model parameters converged sooner. Although the feedback delay parameter, <inline-formula><mml:math id="inf278"><mml:mi>τ</mml:mi></mml:math></inline-formula>, can be determined using standard model selection techniques (<xref ref-type="bibr" rid="bib19">Golub et al., 2013</xref>), we fixed this parameter (<inline-formula><mml:math id="inf279"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>corresponding</mml:mi><mml:mo> </mml:mo><mml:mi>to</mml:mi><mml:mo> </mml:mo><mml:mn>100</mml:mn></mml:math></inline-formula> ms, monkey A; <inline-formula><mml:math id="inf280"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>corresponding</mml:mi><mml:mo> </mml:mo><mml:mi>to</mml:mi><mml:mo> </mml:mo><mml:mn>133</mml:mn></mml:math></inline-formula> ms, monkey C) for simplicity and to remain consistent with our experimental characterization of the visuomotor latency from <xref ref-type="fig" rid="fig2">Figure 2A</xref>.</p></sec><sec id="s4-9"><title>Computing cross-validated internal model predictions</title><p>Throughout our results, if an internal state prediction (whisker) points toward the target, it is not trivially due to our inclusion of straight-to-target aiming into IME (<xref ref-type="disp-formula" rid="equ15">Equation 14</xref>). Rather, whiskers that point toward targets are evidence of real structure in the data. We ensure that whiskers do not trivially point toward targets by using cross-validation techniques whenever evaluating or visualizing extracted internal models and their corresponding internal state predictions (whiskers). For a given experimental session, trials were randomly assigned to folds such that each fold consisted of one trial to each unique target. We employed <inline-formula><mml:math id="inf281"><mml:mi>K</mml:mi></mml:math></inline-formula>-fold cross-validation, where <inline-formula><mml:math id="inf282"><mml:mi>K</mml:mi></mml:math></inline-formula> was the number of folds in a given experimental session. Internal models were fit to the data in <inline-formula><mml:math id="inf283"><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> folds (training data), and the data from the held-out fold (test data) were used when evaluating the extracted internal model.</p><p>Although target positions were used to incorporate the notion of straight-to-target aiming during model fitting (through <xref ref-type="disp-formula" rid="equ15">Equation 14</xref>), neither targets nor <xref ref-type="disp-formula" rid="equ15">Equation 14</xref> were used when evaluating extracted internal models on held-out data (relevant for <xref ref-type="fig" rid="fig3">Figures 3</xref>–<xref ref-type="fig" rid="fig6">6</xref>, <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>, <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>, <xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Rather, whiskers were defined as the expected value of the internal state predictions given only available visual feedback and previously issued neural activity according to the probabilistic model, using only <xref ref-type="disp-formula" rid="equ10 equ11 equ12 equ13 equ14">Equations 9–13</xref> and <italic>not</italic> <xref ref-type="disp-formula" rid="equ15">Equation 14</xref>):<disp-formula id="equ16"><label>(15)</label><mml:math id="m16"><mml:mi mathvariant="normal">E</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mfenced><mml:mrow><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mtext>t</mml:mtext></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>t</mml:mtext></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo>∣</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>raw</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>raw</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mover><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msubsup><mml:mover><mml:mi mathvariant="bold">x</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mtext>t</mml:mtext><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>t</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mover><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math></disp-formula></p><p>We found that cross-validated whiskers consistently pointed straight to targets. This result did not trivially need to be the case, as those targets were not used to construct the whiskers. Rather, given internal models extracted from the training data, the statistical structure underlying the recorded neural activity in the test data was consistent with aiming straight to targets from internal predictions of cursor position.</p></sec><sec id="s4-10"><title>Visualizing an extracted internal model</title><p>In <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> we visualize the parameters of an extracted internal model as “pushing vectors”, and interpret them relative to the corresponding parameters of the BMI mapping. Because of differences in how temporal smoothing is implemented through the BMI mapping and the internal model, magnitudes of pushing vectors are not directly comparable between the BMI mapping and the internal model. In the BMI mapping, temporal smoothing comes from averaging the neural activity across 5 timesteps, as in <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>. In the internal model, temporal smoothing comes from the specification that each velocity prediction includes a contribution from the previous velocity prediction through <inline-formula><mml:math id="inf284"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula>, as in <xref ref-type="disp-formula" rid="equ11">Equation 10</xref>. To provide visually comparable pushing vectors, we factored out the influence of temporal smoothing by visualizing the pushing vectors from <inline-formula><mml:math id="inf285"><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf286"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> as follows. Pushing vectors in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2A</xref> show how the cursor would have moved given a single smoothed spike count from each unit. Analogously in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2B</xref>, we rescaled the pushing vectors in <inline-formula><mml:math id="inf287"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> by <inline-formula><mml:math id="inf288"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM86"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mtext>trace</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub id="XM85"><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, approximately normalizing by the fraction of the internal velocity prediction that comes from the previous velocity prediction rather than from the current neural activity. The <inline-formula><mml:math id="inf289"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mtext>trace</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub id="XM87"><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in the scaling factor gives the average value along the diagonal of the <inline-formula><mml:math id="inf290"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> matrix, <inline-formula><mml:math id="inf291"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula>. This normalization was only required because of the particular manner by which cursor velocities were smoothed during BMI experiments. If we had instead used a Kalman filter as the BMI mapping during experiments, pushing vectors would be directly comparable without normalization.</p><p>In <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>, we visually interpret an example spike count vector through the internal model shown in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>. This example spike count vector contributed to the monkey A “movement” bar in <xref ref-type="fig" rid="fig5">Figure 5B</xref>, as it was the timestep at which cursor-to-target distance first decreased below 50% of the center-to-target distance. The example spike count vector is from the same session as the BMI mapping and internal model parameters shown in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, and the spike count vector is from a held-out trial not used to fit that internal model. <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B,C</xref> reflect rescaled <inline-formula><mml:math id="inf292"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf293"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub></mml:math></inline-formula>, as described above.</p></sec><sec id="s4-11"><title>Comparison of motor commands predicted by the internal model to those produced by the BMI mapping</title><p>Comparisons of the appropriateness of the recorded neural activity through the BMI mapping versus through extracted internal models are shown as angular errors in <xref ref-type="fig" rid="fig3">Figure 3B,C</xref>, <xref ref-type="fig" rid="fig4">Figure 4C</xref>, <xref ref-type="fig" rid="fig6">Figure 6A</xref>, <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>, <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>, <xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>, and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>. For a particular timestep, <inline-formula><mml:math id="inf294"><mml:mi>t</mml:mi></mml:math></inline-formula>, we computed the angular error of the neural activity through the BMI mapping as the absolute angle by which the cursor would have missed the target had it continued from cursor position <inline-formula><mml:math id="inf295"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> in the direction of the cursor velocity, <inline-formula><mml:math id="inf296"><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> (i.e., <inline-formula><mml:math id="inf297"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Similarly, we computed the angular error of the neural activity through the subject’s internal model as the absolute angle by which the cursor would have missed the target had it continued from the subject’s internal position prediction, <inline-formula><mml:math id="inf298"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula>, in the direction of the subject’s internal velocity prediction, <inline-formula><mml:math id="inf299"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula>. Internal model errors were computed from whiskers that could be constructed given cursor feedback and recorded spike counts beginning at movement onset and through target acquisition. Whiskers were extracted using the cross-validation techniques described in Computing cross-validated internal model predictions.</p></sec><sec id="s4-12"><title>Assessing whether internal model mismatch could appear as a spurious result due to correlated spiking variability</title><p>An alternative explanation of our data could be that the subject’s internal model is well-matched to the BMI mapping, but that correlated noise in neural firing leads us to estimate an internal model that rejects noise better than the BMI mapping. To determine whether our finding of internal model mismatch might have been a spurious result of noise in the recorded neural activity, we performed the following simulation, which assumes the alternative hypothesis that there is no internal model mismatch. First, we simulated neural activity under the assumption that the BMI mapping and the internal model are equal (i.e., the alternative hypothesis). Then, we evaluated that simulated neural activity through the BMI mapping and the extracted internal model (which were not equal). The key insight provided is due to the ability to explicitly define signal versus noise in simulation. Although there are many possible ways to define signal versus noise in the recorded neural activity, here we assume the internal model and the BMI mapping are equal (the alternative hypothesis), and we define signal to be the component of a neural activity pattern that maps to the subject’s desired movement direction through that mapping. We define noise to be the residual neural activity pattern after subtracting out the signal.</p><p>We began with a set of 32 desired movement directions, <inline-formula><mml:math id="inf300"><mml:msubsup><mml:mi mathvariant="normal">d</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mn>11.25</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mn>22.5</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. This set was chosen to align with the 16 target directions with an additional direction halfway between each pair of adjacent targets. We labeled each recorded neural activity pattern, <inline-formula><mml:math id="inf301"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup></mml:math></inline-formula>, according to the direction, <inline-formula><mml:math id="inf302"><mml:msubsup><mml:mi mathvariant="normal">d</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup></mml:math></inline-formula>, that it most closely matched after being passed through the BMI mapping (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>) from that experiment. This labeling procedure produces, for each direction, <inline-formula><mml:math id="inf303"><mml:msubsup><mml:mi mathvariant="normal">d</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup></mml:math></inline-formula>, a set of real recorded neural activity patterns, <inline-formula><mml:math id="inf304"><mml:msub><mml:mi mathvariant="script">𝒰</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, that reflect the intention to move in direction <inline-formula><mml:math id="inf305"><mml:msubsup><mml:mi mathvariant="normal">d</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup></mml:math></inline-formula>. For each direction, we then defined an idealized neural activity pattern to be the mean of all real neural activity patterns labeled as matching that direction through the BMI mapping:<disp-formula id="equ17"><label>(16)</label><mml:math id="m17"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup><mml:mo mathvariant="bold"> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:mo/><mml:msub><mml:mi mathvariant="script">𝒰</mml:mi><mml:mtext>i</mml:mtext></mml:msub><mml:mo>|</mml:mo><mml:mo/></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">𝒰</mml:mi><mml:mtext>i</mml:mtext></mml:msub></mml:mrow></mml:munder><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf306"><mml:mo>|</mml:mo><mml:mo/><mml:msub><mml:mi mathvariant="script">𝒰</mml:mi><mml:mtext>i</mml:mtext></mml:msub><mml:mo>|</mml:mo><mml:mo/></mml:math></inline-formula> is the number of real activity patterns labeled as matching direction <inline-formula><mml:math id="inf307"><mml:msubsup><mml:mi mathvariant="normal">d</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup></mml:math></inline-formula>. We performed this procedure separately for each intuitive session. Idealized neural activity patterns were calculated from sets of 109 <inline-formula><mml:math id="inf308"> <mml:mo>± </mml:mo></mml:math></inline-formula> 24 (monkey A) and 178 <inline-formula><mml:math id="inf309"> <mml:mo>± </mml:mo></mml:math></inline-formula> 56 (monkey C) real neural activity patterns (mean <inline-formula><mml:math id="inf310"> <mml:mo>± </mml:mo></mml:math></inline-formula> standard deviation across all experiments and directions). We evaluated the error of these idealized neural activity patterns through the BMI mapping and through the extracted internal model, relative to the corresponding desired direction (i.e., the average absolute angular error between <inline-formula><mml:math id="inf311"><mml:msubsup><mml:mtext>d</mml:mtext><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf312"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup><mml:mo mathvariant="bold"> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">Bu</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="bold">b</mml:mi></mml:math></inline-formula>, and between <inline-formula><mml:math id="inf313"><mml:msubsup><mml:mtext>d</mml:mtext><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf314"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mover><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>, respectively) (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6A</xref>). By construction, we expect errors through the BMI mapping to be nearly zero (nonzero errors are due to the discretization of direction).</p><p>To determine the effect of noise in the recorded neural activity, we corrupted these idealized neural activity patterns by combining them with simulated noise patterns drawn from residuals in the recorded neural activity. Residuals, <inline-formula><mml:math id="inf315"><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula>, were computed by subtracting the idealized neural activity pattern, <inline-formula><mml:math id="inf316"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup></mml:math></inline-formula>, from the recorded neural activity patterns, <inline-formula><mml:math id="inf317"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup></mml:math></inline-formula>, corresponding to that idealized pattern:<disp-formula id="equ18"><label>(17)</label><mml:math id="m18"><mml:mtext>for each</mml:mtext><mml:mo>⁢</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">𝒰</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo rspace="7.5pt">,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo mathvariant="bold"> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup></mml:math></disp-formula></p><p>Simulated noise patterns were then drawn from the across-direction set of residuals:<disp-formula id="equ19"><label>(18)</label><mml:math id="m19"><mml:msub><mml:mi mathvariant="bold">s</mml:mi><mml:mtext>k</mml:mtext></mml:msub><mml:mo>~</mml:mo><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mtext>t</mml:mtext></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo>∀</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>Finally, simulated noisy neural activity patterns, <inline-formula><mml:math id="inf318"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>i,k</mml:mtext><mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></inline-formula>, were formed by combining the idealized neural activity patterns with the simulated noise patterns:<disp-formula id="equ20"><label>(19)</label><mml:math id="m20"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>i,k</mml:mtext><mml:mtext>sim</mml:mtext></mml:msubsup><mml:mo mathvariant="bold"> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup><mml:mo mathvariant="bold"> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold">s</mml:mi><mml:mtext>k</mml:mtext></mml:msub></mml:math></disp-formula></p><p>We evaluated the error of the simulated noisy neural activity patterns, <inline-formula><mml:math id="inf319"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>i,k</mml:mtext><mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></inline-formula>, through the BMI mappings and through the extracted internal models, relative to the corresponding desired direction (that is, the average absolute angular error between <inline-formula><mml:math id="inf320"><mml:msubsup><mml:mi mathvariant="normal">d</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf321"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>i,k</mml:mtext><mml:mtext>sim</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">Bu</mml:mi><mml:mtext>i,k</mml:mtext><mml:mtext>sim</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="bold">b</mml:mi></mml:math></inline-formula>, and between <inline-formula><mml:math id="inf322"><mml:msubsup><mml:mi mathvariant="normal">d</mml:mi><mml:mtext>i</mml:mtext><mml:mtext>*</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf323"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>i,k</mml:mtext><mml:mtext>sim</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>i,k</mml:mtext><mml:mtext>sim</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mover><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>, respectively) (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6B</xref>). This analysis was fully cross-validated, meaning that we only evaluated a simulated neural activity pattern through an internal model if its simulated noise pattern was not computed from a recorded neural activity pattern used during fitting of that internal model. To further match the statistics of the real data, we ensured that we evaluated the same number of simulated neural activity patterns corresponding to a particular desired direction as the number of recorded neural activity patterns that matched that desired direction through the BMI mapping.</p></sec><sec id="s4-13"><title>Evaluating the speed bias resulting from internal model mismatch</title><p>In <xref ref-type="fig" rid="fig5">Figure 5</xref> we compared the timestep-by-timestep speeds of the actual cursor to the subject’s intended cursor speed, as determined by extracted internal models. At timestep <inline-formula><mml:math id="inf324"><mml:mi>t</mml:mi></mml:math></inline-formula>, actual cursor speed was taken to be the magnitude of cursor velocity <inline-formula><mml:math id="inf325"><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>t</mml:mtext></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>), and intended cursor speed was taken to be the magnitude of the subject’s velocity belief, <inline-formula><mml:math id="inf326"><mml:msubsup><mml:mover><mml:mi mathvariant="bold">v</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mtext>t</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula>. To form the curves in <xref ref-type="fig" rid="fig5">Figure 5A</xref>, we selected all timesteps when intended cursor speed was <inline-formula><mml:math id="inf327"><mml:mi>s</mml:mi></mml:math></inline-formula> and computed the distribution of actual cursor speeds at those same timesteps. Curves show the mean actual cursor speed (and S.E.M.) as a function of intended cursor speed. In <xref ref-type="fig" rid="fig5">Figure 5B</xref>, we included all timesteps preceding target onset to form the speed difference bars labeled “center hold.” To form the “movement” bars, we included for each trial the single timestep at which cursor-to-target distance first decreased below 50% of the center-to-target distance.</p></sec><sec id="s4-14"><title>Visualizing temporal dynamics of neural activity and internal models during adaptation to perturbations</title><p>In <xref ref-type="fig" rid="fig6">Figure 6A</xref> we interpreted monkey A neural activity through several relevant mappings: the intuitive BMI mapping, the perturbed BMI mapping, the time-varying internal model, and the late intuitive internal model. The time-varying internal model was extracted from a moving window of 48 trials and was updated every 16 trials (1 trial to each of the 16 targets). The late intuitive internal model was extracted from the last 48 trials during the intuitive session. For each mapping, whiskers were constructed at each timestep and angular errors were evaluated relative to the target perimeter. In general, these errors describe how task-appropriate the subject’s neural activity was for a particular mapping at a particular moment during the experiments. In the case of the BMI mappings, each whisker equates to how the cursor position and velocity would have evolved from a particular position on the actual cursor trajectory (i.e., the visual feedback) had that BMI mapping been in effect. In the case of the intuitive BMI mapping during the intuitive and washout trials and in the case of the perturbed BMI mapping during the perturbation trials, these whiskers by definition exactly match the cursor trajectories displayed during the experiments. When a particular BMI mapping was not in effect (e.g., the intuitive BMI mapping during the perturbation trials), these whiskers describe how the cursor would have moved under that BMI mapping and thus would not match the cursor behavior from the experiments.</p><p>In <xref ref-type="fig" rid="fig6">Figure 6B</xref> we evaluated the differences between the time-varying internal model and the BMI mappings. We interpreted monkey A neural activity through the BMI mappings and the time-varying internal model, and at each timestep, computed the angle between the velocity predicted by the internal model (i.e., by constructing a whisker) and the velocity computed through each BMI mapping. For experiments with a counter-clockwise rotational component to the perturbation, signs of angles were flipped so that nonzero biases would not cancel out when averaging across experiments. Angles were computed after centering the origins of the two velocity vectors. In contrast to the absolute angles computed relative to the target, which are presented through this work, these angles were signed and computed without using the target position. Analyzing signed angles permits quantification of the bias in these angles, whereas absolute angles are better suited for quantifying the variance of errors. During the intuitive trials, angular errors through the subject’s internal model and through the intuitive BMI mapping tend to be unbiased (i.e., the average signed angular error is roughly zero for both; data not shown) but with different variances (hence the substantial differences in absolute angular errors in <xref ref-type="fig" rid="fig3">Figure 3C</xref> and <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Angular errors relative to the target become biased during the perturbation and washout trials due to the rotational nature of the perturbations. We also analyzed the signed angular errors (data not shown) to ensure that these biases were not affecting our interpretation of the errors in <xref ref-type="fig" rid="fig6">Figure 6A</xref>.</p><p>The neural activity used in this time-varying difference metric was taken from 16-trial non-overlapping blocks of trials aligned to the horizontal axis labels (as in <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Results were nearly identical when instead using a fixed set of neural activity taken from the first 48 trials of the intuitive session (data not shown). We also evaluated a number of additional difference metrics, including angles between unsmoothed velocities (i.e., between <inline-formula><mml:math id="inf328"><mml:mo>(</mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mover><mml:mi mathvariant="bold">b</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="inf329"><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">Bu</mml:mi><mml:mtext>t</mml:mtext><mml:mtext>raw</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="bold">b</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>; see <xref ref-type="disp-formula" rid="equ11">Equation 10</xref>), cartesian distances between whisker endpoints (i.e., <inline-formula><mml:math id="inf330"><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo/><mml:msubsup><mml:mover><mml:mi mathvariant="bold">p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mo/><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>), and angles between the corresponding columns of the <inline-formula><mml:math id="inf331"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf332"><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> matrices from the BMI mappings and internal models, respectively (data not shown). These metrics were consistent with the metric of <xref ref-type="fig" rid="fig6">Figure 6B</xref> in showing that the time-varying internal model becomes more similar to the particular perturbed BMI mapping during the perturbation trials and to the particular intuitive BMI mapping during the washout trials.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank AB Schwartz and AS Whitford (Motorlab, University of Pittsburgh) for access to BCI data. We thank AP Batista, O Donchin, LL Holt, CR Olson, and MA Smith for critical discussions and reading of this manuscript. This work was supported by NSF IGERT Fellowship (MDG), NIH-NICHD-CRCNS-R01-HD-071686 (BMY), and PA Department of Health Research Formula Grant SAP#4100057653 under the Commonwealth Universal Research Enhancement program (SMC).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>MDG, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>BMY, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>SMC, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article, Contributed unpublished essential data or reagents</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: All animal procedures were approved by the Institutional Animal Care and Use Committee (IACUC) of the University of Pittsburgh (protocol 0808279).</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>BDO</given-names></name><name><surname>Moore</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="1990">1990</year><source>Optimal Control: Linear Quadratic Methods</source><publisher-loc>Upper saddle river, NJ, USA</publisher-loc><publisher-name>Prentice-hall, Inc</publisher-name></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Azim</surname><given-names>E</given-names></name><name><surname>Jiang</surname><given-names>J</given-names></name><name><surname>Alstermark</surname><given-names>B</given-names></name><name><surname>Jessell</surname><given-names>TM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Skilled reaching relies on a V2a propriospinal internal copy circuit</article-title><source>Nature</source><volume>508</volume><fpage>357</fpage><lpage>363</lpage><pub-id pub-id-type="doi">10.1038/nature13021</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berkes</surname><given-names>P</given-names></name><name><surname>Orban</surname><given-names>G</given-names></name><name><surname>Lengyel</surname><given-names>M</given-names></name><name><surname>Fiser</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Spontaneous cortical activity reveals hallmarks of an optimal internal model of the environment</article-title><source>Science</source><volume>331</volume><fpage>83</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1126/science.1195870</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhanpuri</surname><given-names>NH</given-names></name><name><surname>Okamura</surname><given-names>AM</given-names></name><name><surname>Bastian</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Predictive modeling by the cerebellum improves proprioception</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>14301</fpage><lpage>14306</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0784-13.2013</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carmena</surname><given-names>JM</given-names></name><name><surname>Lebedev</surname><given-names>MA</given-names></name><name><surname>Crist</surname><given-names>RE</given-names></name><name><surname>O'Doherty</surname><given-names>JE</given-names></name><name><surname>Santucci</surname><given-names>DM</given-names></name><name><surname>Dimitrov</surname><given-names>DF</given-names></name><name><surname>Patil</surname><given-names>PG</given-names></name><name><surname>Henriquez</surname><given-names>CS</given-names></name><name><surname>Nicolelis</surname><given-names>MAL</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Learning to control a brain–machine interface for reaching and grasping by primates</article-title><source>PLoS Biology</source><volume>1</volume><elocation-id>e42</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0000042</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chase</surname><given-names>SM</given-names></name><name><surname>Kass</surname><given-names>RE</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Behavioral and neural correlates of visuomotor adaptation observed through a brain-computer interface in primary motor cortex</article-title><source>Journal of Neurophysiology</source><volume>108</volume><fpage>624</fpage><lpage>644</lpage><pub-id pub-id-type="doi">10.1152/jn.00371.2011</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crapse</surname><given-names>TB</given-names></name><name><surname>Sommer</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Corollary discharge across the animal kingdom</article-title><source>Nature Reviews Neuroscience</source><volume>9</volume><fpage>587</fpage><lpage>600</lpage><pub-id pub-id-type="doi">10.1038/nrn2457</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dimensionality reduction for large-scale neural recordings</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1500</fpage><lpage>1509</lpage><pub-id pub-id-type="doi">10.1038/nn.3776</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dempster</surname><given-names>AP</given-names></name><name><surname>Laird</surname><given-names>NM</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Maximum likelihood from incomplete data via the em algorithm</article-title><source>Journal of the Royal Statistical Society</source><volume>39</volume><fpage>1</fpage><lpage>38</lpage></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faisal</surname><given-names>AA</given-names></name><name><surname>Selen</surname><given-names>LPJ</given-names></name><name><surname>Wolpert</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Noise in the nervous system</article-title><source>Nature Reviews Neuroscience</source><volume>9</volume><fpage>292</fpage><lpage>303</lpage><pub-id pub-id-type="doi">10.1038/nrn2258</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farshchiansadegh</surname><given-names>A</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name><name><surname>Casadio</surname><given-names>M</given-names></name><name><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Adaptation to visual feedback delay in a redundant motor task</article-title><source>Journal of Neurophysiology</source><volume>113</volume><fpage>426</fpage><lpage>433</lpage><pub-id pub-id-type="doi">10.1152/jn.00249.2014</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flash</surname><given-names>T</given-names></name><name><surname>Hogan</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>The coordination of arm movements: an experimentally confirmed mathematical model</article-title><source>The Journal of Neuroscience</source><volume>5</volume><fpage>1688</fpage><lpage>1703</lpage></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frens</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Forward models and state estimation in compensatory eye movements</article-title><source>Frontiers in Cellular Neuroscience</source><volume>3</volume><fpage>pp. 1</fpage><lpage>pp. 10</lpage><pub-id pub-id-type="doi">10.3389/neuro.03.013.2009</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ganguly</surname><given-names>K</given-names></name><name><surname>Carmena</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Emergence of a stable cortical map for neuroprosthetic control</article-title><source>PLoS Biology</source><volume>7</volume><elocation-id>e1000153</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1000153</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Georgopoulos</surname><given-names>AP</given-names></name><name><surname>Caminiti</surname><given-names>R</given-names></name><name><surname>Kalaska</surname><given-names>JF</given-names></name><name><surname>Massey</surname><given-names>JT</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Spatial coding of movement: a hypothesis concerning the coding of movement direction by motor cortical populations</article-title><source>Exp Brain Res Suppl</source><volume>7</volume><fpage>327</fpage><lpage>336</lpage><pub-id pub-id-type="doi">10.1007/978-3-642-68915-4_34</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghasia</surname><given-names>FF</given-names></name><name><surname>Meng</surname><given-names>H</given-names></name><name><surname>Angelaki</surname><given-names>DE</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neural correlates of forward and inverse models for eye movements: evidence from three-dimensional kinematics</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>5082</fpage><lpage>5087</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0513-08.2008</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilja</surname><given-names>V</given-names></name><name><surname>Nuyujukian</surname><given-names>P</given-names></name><name><surname>Chestek</surname><given-names>CA</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name><name><surname>Fan</surname><given-names>JM</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name><name><surname>Kaufman</surname><given-names>MT</given-names></name><name><surname>Kao</surname><given-names>JC</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A high-performance neural prosthesis enabled by control algorithm design</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1752</fpage><lpage>1757</lpage><pub-id pub-id-type="doi">10.1038/nn.3265</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golub</surname><given-names>MD</given-names></name><name><surname>Chase</surname><given-names>SM</given-names></name><name><surname>Batista</surname><given-names>AP</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Brain–computer interfaces for dissecting cognitive processes underlying sensorimotor control</article-title><source>Current Opinion in Neurobiology</source><volume>37</volume><fpage>53</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2015.12.005</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golub</surname><given-names>MD</given-names></name><name><surname>Chase</surname><given-names>SM</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Learning an internal dynamics model from control demonstration</article-title><source>Proceedings of The 30th International Conference on Machine Learning</source><fpage>606</fpage><lpage>614</lpage></element-citation></ref><ref id="bib20"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Golub</surname><given-names>MD</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name><name><surname>Chase</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Internal models engaged by brain-computer interface control. engineering in medicine and biology society</article-title><conf-name><italic>2012 Annual International Conference of the IEEE</italic></conf-name><fpage>1327</fpage><lpage>1330</lpage></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golub</surname><given-names>MD</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name><name><surname>Chase</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Motor cortical control of movement speed with implications for brain-machine interface control</article-title><source>Journal of Neurophysiology</source><volume>112</volume><fpage>411</fpage><lpage>429</lpage><pub-id pub-id-type="doi">10.1152/jn.00391.2013</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>AM</given-names></name><name><surname>Angelaki</surname><given-names>DE</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Internal models and neural computation in the vestibular system</article-title><source>Experimental Brain Research</source><volume>200</volume><fpage>197</fpage><lpage>222</lpage><pub-id pub-id-type="doi">10.1007/s00221-009-2054-4</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>AM</given-names></name><name><surname>Kalaska</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Learning to move machines with the mind</article-title><source>Trends in Neurosciences</source><volume>34</volume><fpage>61</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2010.11.003</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gribble</surname><given-names>PL</given-names></name><name><surname>Scott</surname><given-names>SH</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Overlap of internal models in motor cortex for mechanical loads during reaching</article-title><source>Nature</source><volume>417</volume><fpage>938</fpage><lpage>941</lpage><pub-id pub-id-type="doi">10.1038/nature00834</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>CM</given-names></name><name><surname>Wolpert</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Signal-dependent noise determines motor planning</article-title><source>Nature</source><volume>394</volume><fpage>780</fpage><lpage>784</lpage><pub-id pub-id-type="doi">10.1038/29528</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hauschild</surname><given-names>M</given-names></name><name><surname>Mulliken</surname><given-names>GH</given-names></name><name><surname>Fineman</surname><given-names>I</given-names></name><name><surname>Loeb</surname><given-names>GE</given-names></name><name><surname>Andersen</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Cognitive signals for brain-machine interfaces in posterior parietal cortex include continuous 3D trajectory commands</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>109</volume><fpage>17075</fpage><lpage>17080</lpage><pub-id pub-id-type="doi">10.1073/pnas.1215092109</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>C-C</given-names></name><name><surname>Sugino</surname><given-names>K</given-names></name><name><surname>Shima</surname><given-names>Y</given-names></name><name><surname>Guo</surname><given-names>C</given-names></name><name><surname>Bai</surname><given-names>S</given-names></name><name><surname>Mensh</surname><given-names>BD</given-names></name><name><surname>Nelson</surname><given-names>SB</given-names></name><name><surname>Hantman</surname><given-names>AW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Convergence of pontine and proprioceptive streams onto multimodal cerebellar granule cells</article-title><source>eLife</source><volume>2</volume><fpage>pp. e00400</fpage><pub-id pub-id-type="doi">10.7554/eLife.00400</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ifft</surname><given-names>PJ</given-names></name><name><surname>Shokur</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Lebedev</surname><given-names>MA</given-names></name><name><surname>Nicolelis</surname><given-names>MAL</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A brain-machine interface enables bimanual arm movements in monkeys</article-title><source>Science Translational Medicine</source><volume>5</volume><fpage>210ra154</fpage><pub-id pub-id-type="doi">10.1126/scitranslmed.3006159</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jarosiewicz</surname><given-names>B</given-names></name><name><surname>Chase</surname><given-names>SM</given-names></name><name><surname>Fraser</surname><given-names>GW</given-names></name><name><surname>Velliste</surname><given-names>M</given-names></name><name><surname>Kass</surname><given-names>RE</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Functional network reorganization during learning in a brain-computer interface paradigm</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>105</volume><fpage>19486</fpage><lpage>19491</lpage><pub-id pub-id-type="doi">10.1073/pnas.0808113105</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joiner</surname><given-names>WM</given-names></name><name><surname>Smith</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Long-term retention explained by a model of short-term learning in the adaptive control of reaching</article-title><source>Journal of Neurophysiology</source><volume>100</volume><fpage>2948</fpage><lpage>2955</lpage><pub-id pub-id-type="doi">10.1152/jn.90706.2008</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawato</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Internal models for motor control and trajectory planning</article-title><source>Current Opinion in Neurobiology</source><volume>9</volume><fpage>718</fpage><lpage>727</lpage><pub-id pub-id-type="doi">10.1016/S0959-4388(99)00028-8</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname><given-names>GB</given-names></name><name><surname>Hahnloser</surname><given-names>RHR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Neural processing of auditory feedback during vocal practice in a songbird</article-title><source>Nature</source><volume>457</volume><fpage>187</fpage><lpage>190</lpage><pub-id pub-id-type="doi">10.1038/nature07467</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennedy</surname><given-names>A</given-names></name><name><surname>Wayne</surname><given-names>G</given-names></name><name><surname>Kaifosh</surname><given-names>P</given-names></name><name><surname>Alviña</surname><given-names>K</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Sawtell</surname><given-names>NB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A temporal basis for predicting the sensory consequences of motor commands in an electric fish</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>416</fpage><lpage>422</lpage><pub-id pub-id-type="doi">10.1038/nn.3650</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kersten</surname><given-names>D</given-names></name><name><surname>Mamassian</surname><given-names>P</given-names></name><name><surname>Yuille</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Object perception as bayesian inference</article-title><source>Annual Review of Psychology</source><volume>55</volume><fpage>271</fpage><lpage>304</lpage><pub-id pub-id-type="doi">10.1146/annurev.psych.55.090902.142005</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kluzik</surname><given-names>J</given-names></name><name><surname>Diedrichsen</surname><given-names>J</given-names></name><name><surname>Shadmehr</surname><given-names>R</given-names></name><name><surname>Bastian</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Reach adaptation: what determines whether we learn an internal model of the tool or adapt the model of our arm?</article-title><source>Journal of Neurophysiology</source><volume>100</volume><fpage>1455</fpage><lpage>1464</lpage><pub-id pub-id-type="doi">10.1152/jn.90334.2008</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Komatsu</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The neural mechanisms of perceptual filling-in</article-title><source>Nature Reviews Neuroscience</source><volume>7</volume><fpage>220</fpage><lpage>231</lpage><pub-id pub-id-type="doi">10.1038/nrn1869</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körding</surname><given-names>KP</given-names></name><name><surname>Wolpert</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Bayesian integration in sensorimotor learning</article-title><source>Nature</source><volume>427</volume><fpage>244</fpage><lpage>247</lpage><pub-id pub-id-type="doi">10.1038/nature02169</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laurens</surname><given-names>J</given-names></name><name><surname>Meng</surname><given-names>H</given-names></name><name><surname>Angelaki</surname><given-names>DE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Computation of linear acceleration through an internal model in the macaque cerebellum</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1701</fpage><lpage>1708</lpage><pub-id pub-id-type="doi">10.1038/nn.3530</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisberger</surname><given-names>SG</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Internal models of eye movement in the floccular complex of the monkey cerebellum</article-title><source>Neuroscience</source><volume>162</volume><fpage>763</fpage><lpage>776</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2009.03.059</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loeb</surname><given-names>GE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Optimal isn’t good enough</article-title><source>Biological Cybernetics</source><volume>106</volume><fpage>757</fpage><lpage>765</lpage><pub-id pub-id-type="doi">10.1007/s00422-012-0514-6</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>WJ</given-names></name><name><surname>Jazayeri</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Neural coding of uncertainty and probability</article-title><source>Annual Review of Neuroscience</source><volume>37</volume><fpage>205</fpage><lpage>220</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-071013-014017</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miall</surname><given-names>RC</given-names></name><name><surname>Christensen</surname><given-names>LOD</given-names></name><name><surname>Cain</surname><given-names>O</given-names></name><name><surname>Stanley</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Disruption of state estimation in the human lateral cerebellum</article-title><source>PLoS Biology</source><volume>5</volume><elocation-id>e316</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0050316</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mischiati</surname><given-names>M</given-names></name><name><surname>Lin</surname><given-names>H-T</given-names></name><name><surname>Herold</surname><given-names>P</given-names></name><name><surname>Imler</surname><given-names>E</given-names></name><name><surname>Olberg</surname><given-names>R</given-names></name><name><surname>Leonardo</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Internal models direct dragonfly interception steering</article-title><source>Nature</source><volume>517</volume><fpage>333</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1038/nature14045</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mulliken</surname><given-names>GH</given-names></name><name><surname>Musallam</surname><given-names>S</given-names></name><name><surname>Andersen</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Forward estimation of movement state in posterior parietal cortex</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>105</volume><fpage>8170</fpage><lpage>8177</lpage><pub-id pub-id-type="doi">10.1073/pnas.0802602105</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Osborne</surname><given-names>LC</given-names></name><name><surname>Lisberger</surname><given-names>SG</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A sensory source for motor variation</article-title><source>Nature</source><volume>437</volume><fpage>412</fpage><lpage>416</lpage><pub-id pub-id-type="doi">10.1038/nature03961</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pasalar</surname><given-names>S</given-names></name><name><surname>Roitman</surname><given-names>AV</given-names></name><name><surname>Durfee</surname><given-names>WK</given-names></name><name><surname>Ebner</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Force field effects on cerebellar purkinje cell discharge with implications for internal models</article-title><source>Nature Neuroscience</source><volume>9</volume><fpage>1404</fpage><lpage>1411</lpage><pub-id pub-id-type="doi">10.1038/nn1783</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paz</surname><given-names>R</given-names></name><name><surname>Nathan</surname><given-names>C</given-names></name><name><surname>Boraud</surname><given-names>T</given-names></name><name><surname>Bergman</surname><given-names>H</given-names></name><name><surname>Vaadia</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Acquisition and generalization of visuomotor transformations by nonhuman primates</article-title><source>Experimental Brain Research</source><volume>161</volume><fpage>209</fpage><lpage>219</lpage><pub-id pub-id-type="doi">10.1007/s00221-004-2061-4</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sadtler</surname><given-names>PT</given-names></name><name><surname>Quick</surname><given-names>KM</given-names></name><name><surname>Golub</surname><given-names>MD</given-names></name><name><surname>Chase</surname><given-names>SM</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Tyler-Kabara</surname><given-names>EC</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name><name><surname>Batista</surname><given-names>AP</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Neural constraints on learning</article-title><source>Nature</source><volume>512</volume><fpage>423</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1038/nature13665</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneider</surname><given-names>DM</given-names></name><name><surname>Nelson</surname><given-names>A</given-names></name><name><surname>Mooney</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A synaptic and circuit basis for corollary discharge in the auditory cortex</article-title><source>Nature</source><volume>513</volume><fpage>189</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1038/nature13724</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname><given-names>AB</given-names></name><name><surname>Kettner</surname><given-names>RE</given-names></name><name><surname>Georgopoulos</surname><given-names>AP</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Primate motor cortex and free arm movements to visual targets in three-dimensional space. i. relations between single cell discharge and direction of movement</article-title><source>The Journal of Neuroscience</source><volume>8</volume><fpage>2913</fpage><lpage>2927</lpage></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scott</surname><given-names>SH</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Optimal feedback control and the neural basis of volitional motor control</article-title><source>Nature Reviews Neuroscience</source><volume>5</volume><fpage>532</fpage><lpage>546</lpage><pub-id pub-id-type="doi">10.1038/nrn1427</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Serruya</surname><given-names>MD</given-names></name><name><surname>Hatsopoulos</surname><given-names>NG</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Fellows</surname><given-names>MR</given-names></name><name><surname>Donoghue</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Brain-machine interface: instant neural control of a movement signal</article-title><source>Nature</source><volume>416</volume><fpage>141</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.1038/416141a</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shadmehr</surname><given-names>R</given-names></name><name><surname>Holcomb</surname><given-names>HH</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Neural correlates of motor memory consolidation</article-title><source>Science</source><volume>277</volume><fpage>821</fpage><lpage>825</lpage><pub-id pub-id-type="doi">10.1126/science.277.5327.821</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shadmehr</surname><given-names>R</given-names></name><name><surname>Krakauer</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A computational neuroanatomy for motor control</article-title><source>Experimental Brain Research</source><volume>185</volume><fpage>359</fpage><lpage>381</lpage><pub-id pub-id-type="doi">10.1007/s00221-008-1280-5</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shadmehr</surname><given-names>R</given-names></name><name><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Adaptive representation of dynamics during learning of a motor task</article-title><source>The Journal of Neuroscience</source><volume>14</volume><fpage>3208</fpage><lpage>3224</lpage></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shadmehr</surname><given-names>R</given-names></name><name><surname>Smith</surname><given-names>MA</given-names></name><name><surname>Krakauer</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Error correction, sensory prediction, and adaptation in motor control</article-title><source>Annual Review of Neuroscience</source><volume>33</volume><fpage>89</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-060909-153135</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Carmena</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Combining decoder design and neural adaptation in brain-machine interfaces</article-title><source>Neuron</source><volume>84</volume><fpage>665</fpage><lpage>680</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.08.038</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sommer</surname><given-names>MA</given-names></name><name><surname>Wurtz</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>A pathway in primate brain for internal monitoring of movements</article-title><source>Science</source><volume>296</volume><fpage>1480</fpage><lpage>1482</lpage><pub-id pub-id-type="doi">10.1126/science.1069590</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sommer</surname><given-names>MA</given-names></name><name><surname>Wurtz</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Brain circuits for the internal monitoring of movements*</article-title><source>Annual Review of Neuroscience</source><volume>31</volume><fpage>317</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.31.060407.125627</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suminski</surname><given-names>AJ</given-names></name><name><surname>Tkach</surname><given-names>DC</given-names></name><name><surname>Fagg</surname><given-names>AH</given-names></name><name><surname>Hatsopoulos</surname><given-names>NG</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Incorporating feedback from multiple sensory modalities enhances brain-machine interface control</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>16777</fpage><lpage>16787</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3967-10.2010</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>DM</given-names></name><name><surname>Tillery</surname><given-names>SI</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Direct cortical control of 3D neuroprosthetic devices</article-title><source>Science</source><volume>296</volume><fpage>1829</fpage><lpage>1832</lpage><pub-id pub-id-type="doi">10.1126/science.1070291</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>JA</given-names></name><name><surname>Krakauer</surname><given-names>JW</given-names></name><name><surname>Ivry</surname><given-names>RB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Explicit and implicit contributions to learning in a sensorimotor adaptation task</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>3023</fpage><lpage>3032</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3619-13.2014</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thoroughman</surname><given-names>KA</given-names></name><name><surname>Shadmehr</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Learning of action through adaptive combination of motor primitives</article-title><source>Nature</source><volume>407</volume><fpage>742</fpage><lpage>6805</lpage><pub-id pub-id-type="doi">10.1038/35037588</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turnham</surname><given-names>EJA</given-names></name><name><surname>Braun</surname><given-names>DA</given-names></name><name><surname>Wolpert</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inferring visuomotor priors for sensorimotor learning</article-title><source>PLoS Computational Biology</source><volume>7</volume><elocation-id>e1001112</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001112</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Velliste</surname><given-names>M</given-names></name><name><surname>Perel</surname><given-names>S</given-names></name><name><surname>Spalding</surname><given-names>MC</given-names></name><name><surname>Whitford</surname><given-names>AS</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Cortical control of a prosthetic arm for self-feeding</article-title><source>Nature</source><volume>453</volume><fpage>1098</fpage><lpage>1101</lpage><pub-id pub-id-type="doi">10.1038/nature06996</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Willett</surname><given-names>FR</given-names></name><name><surname>Suminski</surname><given-names>AJ</given-names></name><name><surname>Fagg</surname><given-names>AH</given-names></name><name><surname>Hatsopoulos</surname><given-names>NG</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Improving brain–machine interface performance by decoding intended future movements</article-title><source>Journal of Neural Engineering</source><volume>10</volume><fpage>026011</fpage><pub-id pub-id-type="doi">10.1088/1741-2560/10/2/026011</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wise</surname><given-names>SP</given-names></name><name><surname>Moody</surname><given-names>SL</given-names></name><name><surname>Blomstrom</surname><given-names>KJ</given-names></name><name><surname>Mitz</surname><given-names>AR</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Changes in motor cortical activity during visuomotor adaptation</article-title><source>Experimental Brain Research</source><volume>121</volume><fpage>285</fpage><lpage>299</lpage><pub-id pub-id-type="doi">10.1007/s002210050462</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolpert</surname><given-names>D</given-names></name><name><surname>Ghahramani</surname><given-names>Z</given-names></name><name><surname>Jordan</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>An internal model for sensorimotor integration</article-title><source>Science</source><volume>269</volume><fpage>1880</fpage><lpage>1882</lpage><pub-id pub-id-type="doi">10.1126/science.7569931</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolpert</surname><given-names>DM</given-names></name><name><surname>Kawato</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Multiple paired forward and inverse models for motor control</article-title><source>Neural Networks</source><volume>11</volume><fpage>1317</fpage><lpage>1329</lpage><pub-id pub-id-type="doi">10.1016/S0893-6080(98)00066-5</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.10015.022</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Behrens</surname><given-names>Timothy</given-names></name><role>Reviewing editor</role><aff id="aff5"><institution>Oxford University</institution>, <country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your work entitled &quot;Internal models for interpreting neural population activity during sensorimotor control&quot; for peer review at <italic>eLife</italic>. Your submission has been favorably evaluated by Timothy Behrens (Senior editor), and two reviewers.</p><p>The reviewers have discussed the reviews with one another and the Reviewing editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This paper describes a novel statistical analysis of population neural activity in M1 during brain-machine interface (BMI) control. It reports that errors in BMI control can be understood in terms of a mismatch between a true control model and an &quot;internal&quot; control model assumed by the animal. It shows that population activity accurately takes account of the time-lag in visual feedback, and compensates for a perturbation of the true model by a corresponding perturbation of the internal model.</p><p>The paper is well written, interesting and highly original, and is likely to be of broad interest to the BMI community as well as to the broader community of neuroscientists interested in issues of population coding, dimensionality reduction, and motor control.</p><p>Essential revisions:</p><p>1) First, I admit I am struggling a little bit to understand why I shouldn't adopt the conclusion offered in the Discussion that &quot;it might be tempting to view an extracted internal model as simply the BMI mapping that should have been identified during calibration.&quot; The authors give several arguments here but sometimes I don't entirely follow them. The true model here is linear difference equation. The (fitted) internal model also takes the form of a linear difference equation, and accounts for a substantial fraction of the errors. This indicates (if I understand the claims correctly) that if the experimenters had used the learned internal model instead of the &quot;true&quot; model to drive cursor position, the BMI performance would have been much better. So I'm puzzled about why the authors don't feel that this is the straightforward conclusion of the paper. (Couldn't this be considered a positive result, i.e., a finding that suggests a much better way to improve BMI training? I suppose a drawback to this framing is that if the paper were pitched as a better way to train BMIs, we would presumably expect to see that it actually works, i.e., show some data where the estimated internal model is used to drive behavior and achieves much lower error).</p><p>2) A related concern: the paper asserts that the good performance of the estimated internal model shows that the limits to performance are the observer's inaccurate estimates of the model, as opposed to noise in the neural activity. I'd like to suggest a third possibility: could it possible that it's not <italic>noise</italic>, but rather systematic problems in producing neural activity patterns needed to optimally drive the BMI? For example, suppose the animal could only produce activity patterns corresponding to motion in the 4 cardinal directions. Then it would to alternate between producing these patterns in order to drive a diagonal cursor movement. Or (more realistically), suppose there were only certain fixed points in neural activity space that M1 can easily visit. These fixed points might be systematically misaligned with the directions needed to optimally drive the controller. Re-estimating the internal model allows the best linear mapping from these allowed neural activity patterns to those that can drive the cursor as needed during the experiment.</p><p>I raise this possibility in part because it seems like this was the conclusion of the Yu &amp; Batista groups' nature paper last year, showing that control within an intrinsic manifold (as defined by the state space explored by the network prior to BMI activity) is much easier than outside this manifold. I realize it is likely that the &quot;intuitive&quot; training procedure would latch on to &quot;out of manifold&quot; patterns, since it tries to use activity during training to define the controller. But it would still be nice to rule out this kind of effect – could it be that rather than insufficient knowledge of the controller, the difference results from differences in the ease with which certain network states can be visited?</p><p>3) Result one is that compensation for feedback delay indicates the existence of an internal model. My confusion is that, because equation 1 includes cursor velocity as an input, couldn't it be doing this extrapolation all by itself? How does extrapolation provide evidence of an internal model if the external model could be doing it? Don't you need to show that the internal model is doing a better job of extrapolation that equation 1 possibly could?</p><p>4) The second issue is whether it is justified to call equation 2 an approximation of an internal model. The authors discuss reasons why equation 1 and 2 are not identical, that is, why the internal and external models don't match. Let me provide a simplified analogy. Suppose a single scalar were being extracted from u by x = Bu (in other words, ignore A and b for the moment). In the initial &quot;intuitive BMI mapping&quot; B is defined by a procedure that is not well explained. Suppose that, on each trial u = u<sub>0</sub> + s, where u<sub>0</sub> would give perfect performance and s is noise. Clearly Bu<sub>0</sub> = x (the correct x), but has B been chosen to minimize the effects of noise? That is, has Bs been minimized? If the noise is correlated, this can be done. What if <inline-formula><mml:math id="inf333"><mml:mover><mml:mtext>B</mml:mtext><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> is simply more orthogonal to the major PCs of s than B? Wouldn't this explain the effect? Even if the parameters of equation 1 are optimal with respect to noise, how do we know that the correlation structure of s has not changed by the time the model of equation 2 was constructed?</p><p>In summary, the paper would be strengthened by a more convincing case that evidence for an internal model has been obtained and that equation 2 can be interpreted as an approximation for this internal model.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.10015.023</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions:</italic> </p><p><italic>1) First, I admit I am struggling a little bit to understand why I shouldn't adopt the conclusion offered in the Discussion that &quot;it might be tempting to view an extracted internal model as simply the BMI mapping that should have been identified during calibration.&quot; The authors give several arguments here but sometimes I don't entirely follow them. The true model here is linear difference equation. The (fitted) internal model also takes the form of a linear difference equation, and accounts for a substantial fraction of the errors. This indicates (if I understand the claims correctly) that if the experimenters had used the learned internal model instead of the &quot;true&quot; model to drive cursor position, the BMI performance would have been much better. So I'm puzzled about why the authors don't feel that this is the straightforward conclusion of the paper. (Couldn't this be considered a positive result, i.e., a finding that suggests a much better way to improve BMI training? I suppose a drawback to this framing is that if the paper were pitched as a better way to train BMIs, we would presumably expect to see that it actually works, i.e., show some data where the estimated internal model is used to drive behavior and achieves much lower error).</italic> </p><p>We agree with the reviewers. Our results do suggest that BMI performance might be improved by applying the learned internal model as the BMI mapping. We believe this to be an exciting direction for future experiments and future publications. We have decided to cut the paragraph in question, (“it might be tempting to view an extracted internal model as simply the BMI mapping that should have been identified during calibration”), which was originally intended to steer readers away from misinterpreting our study as an (incremental) engineering advance, rather than a novel approach to the basic scientific study of sensorimotor control. The preceding paragraph covers this sufficiently, and the following paragraph highlights the potential future direction of applying an extracted internal model during closedloop control.</p><p>The section now reads as follows:</p><p>“An extracted internal model and a BMI mapping are closely related. They take a similar mathematical form (Equations 12) and both project highdimensional population activity to a lowdimensional kinematic space. […] Future studies will be required to determine whether further improvements in performance might be possible by using the IME framework toward designing the BMI mapping.”</p><p><italic>2) A related concern: the paper asserts that the good performance of the estimated internal model shows that the limits to performance are the observer's inaccurate estimates of the model, as opposed to noise in the neural activity. I'd like to suggest a third possibility: could it possible that it's not noise, but rather systematic problems in producing neural activity patterns needed to optimally drive the BMI? For example, suppose the animal could only produce activity patterns corresponding to motion in the 4 cardinal directions. Then it would to alternate between producing these patterns in order to drive a diagonal cursor movement. Or (more realistically), suppose there were only certain fixed points in neural activity space that M1 can easily visit. These fixed points might be systematically misaligned with the directions needed to optimally drive the controller. Re-estimating the internal model allows the best linear mapping from these allowed neural activity patterns to those that can drive the cursor as needed during the experiment.</italic> </p><p><italic>I raise this possibility in part because it seems like this was the conclusion of the Yu &amp; Batista groups' nature paper last year, showing that control within an intrinsic manifold (as defined by the state space explored by the network prior to BMI activity) is much easier than outside this manifold. I realize it is likely that the &quot;intuitive&quot; training procedure would latch on to &quot;out of manifold&quot; patterns, since it tries to use activity during training to define the controller. But it would still be nice to rule out this kind of effect – could it be that rather than insufficient knowledge of the controller, the difference results from differences in the ease with which certain network states can be visited?</italic> </p><p>This is an important concern, and we thank the reviewers for bringing this up. To address this, we included new analyses (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>), which show that the distribution of observed lowdimensional mapped cursor velocities covers the full range of directions. This suggests that our main finding cannot be explained by subjects’ inability to produce particular velocities through the BMI mapping. We also made the following textual changes. We now mention this possibility when introducing our central hypothesis early in the Results section:</p><p>“The central hypothesis in this study is that movement errors arise from a mismatch between the subject’s internal model of the BMI and the actual BMI mapping. […] subjects’ inability to produce certain patterns of neural activity, or subjects disengaging from the task.”</p><p>Then, we fully address the possibility in a new subsection of the Results section, entitled “Two alternative hypotheses do not explain the internal model mismatch effect.”</p><p>“The data presented thus far support our central hypothesis that internal model mismatch is a primary source of movement errors. […] This suggests that our main finding of internal model mismatch cannot be explained by subjects’ inability to produce particular neural activity patterns.”</p><p><italic>3) Result one is that compensation for feedback delay indicates the existence of an internal model. My confusion is that, because equation 1 includes cursor velocity as an input, couldn't it be doing this extrapolation all by itself? How does extrapolation provide evidence of an internal model if the external model could be doing it?</italic> </p><p>We realized that our description of this analysis in the manuscript may have lead to some confusion. The reviewers are correct that equation 1 (the BMI mapping) can be used to perfectly extrapolate the cursor trajectory (given all recorded neural activity as inputs). The question, however, is whether the subject does something like this to internallypredict the path of the cursor over the ~100ms visual feedback latency. The idea behind our feedback compensation result (<xref ref-type="fig" rid="fig2">Figure 2C</xref>) is that the subjects’ neural activity reflected the direction from the current cursor position to the target more so than from any previously displayed cursor position. This suggests an internal model being used by the subject to internally predict cursor motion. To address this potential source of confusion, we have added the following paragraph to the end of the Results section, “Subjects compensate for sensory feedback delays while controlling a BMI”:</p><p>“Because we have not yet explicitly identified the subject's <italic>internal</italic> model, motor commands were defined in this analysis using the BMI mapping, which is <italic>external</italic> to the subject. […] we next asked whether we could explicitly identify an internal model from the recorded neural activity.”</p><p><italic>Don't you need to show that the internal model is doing a better job of extrapolation that equation 1 possibly could?</italic> </p><p>While equation 1 can perfectly reconstruct the cursor trajectory (since this is what defined the cursor trajectory during the experiment), the subject cannot directly know the form or parameters of the equation. Rather, the subject builds up an internal model, which we represent with equation 2. In <xref ref-type="fig" rid="fig3">Figure 3C</xref>, we do just as the reviewer suggests – show that the internal model (equation 2) does a better job of explaining the recorded neural activity than does the BMI mapping (equation 1).</p><p><italic>4) The second issue is whether it is justified to call equation 2 an approximation of an internal model. The authors discuss reasons why equation 1 and 2 are not identical, that is, why the internal and external models don't match. Let me provide a simplified analogy. Suppose a single scalar were being extracted from u by x = Bu (in other words, ignore A and b for the moment). In the initial &quot;intuitive BMI mapping&quot; B is defined by a procedure that is not well explained. Suppose that, on each trial u = u<sub>0</sub> + s, where u<sub>0</sub> would give perfect performance and s is noise. Clearly Bu<sub>0</sub> = x (the correct x), but has B been chosen to minimize the effects of noise? That is, has Bs been minimized? If the noise is correlated, this can be done. What if</italic> <inline-formula><mml:math id="inf334"><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></inline-formula> <italic>is simply more orthogonal to the major PCs of s than B? Wouldn't this explain the effect? Even if the parameters of equation 1 are optimal with respect to noise, how do we know that the correlation structure of s has not changed by the time the model of equation 2 was constructed?</italic> </p><p><italic>In summary, the paper would be strengthened by a more convincing case that evidence for an internal model has been obtained and that equation 2 can be interpreted as an approximation for this internal model.</italic> </p><p>This is another important concern, and we thank the reviewer for bringing it to our attention. To address this, we conducted a simulation along the lines of the scenario that the reviewer describes. Our simulation, which was carefully designed to match the statistics of the real recorded neural activity, shows that our internal model mismatch result cannot be explained by a scenario with correlated noise and no internal model mismatch. These simulated data are presented in a new <xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>. We added the following text into the Results subsection, entitled “Two alternative hypotheses do not explain the internal model mismatch effect”:</p><p>“Second, we explored the possibility that the subject intended to produce neural commands that were correct according to the BMI mapping, but that those intended commands were corrupted by “noise'' that is oriented such that errors appear smaller through the extracted internal model than through the BMI mapping. […] Simulated neural activity was more consistent with the BMI mapping than the extracted internal model, which contrasts with our finding from the recorded neural activity.”</p><p>We have included additional details about this new analysis in a new Materials and methods subsection, “Assessing whether internal model mismatch could appear as a spurious result due to correlated spiking variability”:</p></body></sub-article></article>