<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">73520</article-id><article-id pub-id-type="doi">10.7554/eLife.73520</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Chromosomes and Gene Expression</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Robust and annotation-free analysis of alternative splicing across diverse cell types in mice</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-253488"><name><surname>Benegas</surname><given-names>Gonzalo</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6639-4394</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-253489"><name><surname>Fischer</surname><given-names>Jonathan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1165-9930</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-37137"><name><surname>Song</surname><given-names>Yun S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0734-9868</contrib-id><email>yss@berkeley.edu</email><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an7q238</institution-id><institution>Graduate Group in Computational Biology, University of California, Berkeley</institution></institution-wrap><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02y3ad647</institution-id><institution>Department of Biostatistics, University of Florida</institution></institution-wrap><addr-line><named-content content-type="city">Gainesville</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an7q238</institution-id><institution>Computer Science Division, University of California, Berkeley</institution></institution-wrap><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an7q238</institution-id><institution>Department of Statistics, University of California, Berkeley</institution></institution-wrap><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution>Chan Zuckerberg Biohub</institution><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Eyras</surname><given-names>Eduardo</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/019wvm592</institution-id><institution>Australian National University</institution></institution-wrap><country>Australia</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Manley</surname><given-names>James L</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj8s172</institution-id><institution>Columbia University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>01</day><month>03</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e73520</elocation-id><history><date date-type="received" iso-8601-date="2021-09-01"><day>01</day><month>09</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-02-27"><day>27</day><month>02</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2021-04-27"><day>27</day><month>04</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.04.27.441683"/></event></pub-history><permissions><copyright-statement>© 2022, Benegas et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Benegas et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-73520-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-73520-figures-v2.pdf"/><abstract><p>Although alternative splicing is a fundamental and pervasive aspect of gene expression in higher eukaryotes, it is often omitted from single-cell studies due to quantification challenges inherent to commonly used short-read sequencing technologies. Here, we undertake the analysis of alternative splicing across numerous diverse murine cell types from two large-scale single-cell datasets—the <italic>Tabula Muris</italic> and BRAIN Initiative Cell Census Network—while accounting for understudied technical artifacts and unannotated events. We find strong and general cell-type-specific alternative splicing, complementary to total gene expression but of similar discriminatory value, and identify a large volume of novel splicing events. We specifically highlight splicing variation across different cell types in primary motor cortex neurons, bone marrow B cells, and various epithelial cells, and we show that the implicated transcripts include many genes which do not display total expression differences. To elucidate the regulation of alternative splicing, we build a custom predictive model based on splicing factor activity, recovering several known interactions while generating new hypotheses, including potential regulatory roles for novel alternative splicing events in critical genes like <italic>Khdrbs3</italic> and <italic>Rbfox1</italic>. We make our results available using public interactive browsers to spur further exploration by the community.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>Cells are the basic building blocks of all living things. There are numerous types of cells, and each cell has its own machinery to fulfill a specialised role. Despite their different purposes, most cells contain the same instructions, stored as DNA, on how to assemble the proteins needed to perform their intended functions. Cell types often vary in the frequency that each gene is read, leading to different quantities of proteins produced.</p><p>Moreover, a process known as alternative splicing enables cells to build multiple proteins from the same gene. It works by joining fragments of a gene’s code in various combinations. The resulting RNA sequences are molecular templates that cells use to assemble proteins.</p><p>Analysing these RNA sequences reveals which genes are switched on in different tissues of the body, and what proteins are being made. However, despite recent advancements, alternative splicing is rarely studied in single cells because of some sizeable technical challenges.</p><p>Benegas, Fischer and Song developed a computational toolkit designed to handle the unique challenges of analysing alternative splicing events in single cells. The analysis pipeline, called scQuint, was tested on two large datasets that capture cell-to-cell differences in the brain and other tissues of mice.</p><p>Nearly all the cell types studied exhibited clear differences in alternative splicing, such that cell types could be distinguished based on their splicing profiles. Intriguing patterns of splicing were highlighted in some immune cells and certain types of neurons. Across cell types, the genes with unique splicing patterns were often not the same as those with unique activity patterns, indicating that gene expression and alternative splicing are two complementary processes. New types of alternative splicing events were also identified. Benegas et al. also developed a statistical model to probe the roles of splicing regulators in different cell types.</p><p>In summary, the scQuint toolkit overcomes critical technical challenges typically encountered when analysing alternative splicing in single cells. It also reveals new insights about mechanisms of alternative splicing. The results are open access, made available using public interactive browsers, which should spur on other researchers to interrogate how alternative splicing differs in single cells.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>alternative splicing</kwd><kwd>single-cell RNA-seq</kwd><kwd>primary motor cortex neurons</kwd><kwd>Tabula Muris</kwd><kwd>splicing factors</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R35-GM134922</award-id><principal-award-recipient><name><surname>Benegas</surname><given-names>Gonzalo</given-names></name><name><surname>Song</surname><given-names>Yun S</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014989</institution-id><institution>Chan Zuckerberg Initiative</institution></institution-wrap></funding-source><award-id>CZF2019-002449</award-id><principal-award-recipient><name><surname>Benegas</surname><given-names>Gonzalo</given-names></name><name><surname>Song</surname><given-names>Yun S</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A robust computational pipeline for alternative splicing analysis is developed and applied to large-scale cell atlases, overcoming technical challenges and making results available for the scientific community to explore via public interactive browsers.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The past decade’s advances in single-cell genomics have enabled the data-driven characterization of a wide variety of distinct cell populations. Despite affecting more than 90% of human pre-mRNAs (<xref ref-type="bibr" rid="bib76">Wang et al., 2008</xref>), isoform-level variation in gene expression has often been ignored because of quantification difficulties when using data from popular short-read sequencing technologies such as 10x Genomics Chromium and Smart-seq2 (<xref ref-type="bibr" rid="bib59">Picelli et al., 2014</xref>). Long-read single-cell technologies, which greatly simplify isoform quantification, are improving (<xref ref-type="bibr" rid="bib15">Byrne et al., 2017</xref>; <xref ref-type="bibr" rid="bib26">Gupta et al., 2018</xref>; <xref ref-type="bibr" rid="bib72">Volden and Vollmers, 2020</xref>; <xref ref-type="bibr" rid="bib40">Lebrigand et al., 2020</xref>; <xref ref-type="bibr" rid="bib33">Joglekar et al., 2021</xref>), but remain more costly and lower-throughput than their short-read counterparts. For these reasons and others, short-read datasets predominate and we must work with short reads to make use of the rich compendium of available data. In response, researchers have developed several computational methods to investigate splicing variation despite the sizable technical challenges inherent to this regime. A selection of these challenges and methods are summarized in the Appendix.</p><p>To complement single-cell gene expression atlases, we analyze alternative splicing in large single-cell RNA-seq (scRNA-seq) datasets from the <italic>Tabula Muris</italic> consortium (<xref ref-type="bibr" rid="bib61">Schaum et al., 2018</xref>) and BRAIN Initiative Cell Census Network (BICCN) (<xref ref-type="bibr" rid="bib84">Yao et al., 2021</xref>). These data span a broad range of mouse tissues and cell types, and remain largely unexplored at the level of transcript variation. During our initial analyses, we encountered pervasive coverage biases, a heretofore largely unappreciated mode of technical variation which greatly confounds biological variation across cell types. Unsatisfied with the performance of current methods when confronted by these biases, we implemented our own quantification, visualization, and testing pipeline, named scQuint (single-cell quantification of introns), which allowed us to continue our analyses in a robust, annotation-free, and computationally tractable manner. Parts of the scQuint pipeline are based on adaptations of the bulk RNA-seq alternative splicing analysis method LeafCutter (<xref ref-type="bibr" rid="bib43">Li et al., 2018</xref>) to handle the unique challenges of scRNA-seq data. As we demonstrate in subsequent sections, our modifications in the quantification, statistical modeling, and optimization procedures lead to improved robustness, scalability, and calibration when working with data from single cells (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, also see Materials and methods).</p><p>Applying scQuint to these datasets, we find a strong signal of cell-type-specific alternative splicing and demonstrate that cell type can be accurately predicted given only splicing proportions. Moreover, our annotation-free approach enables us to detect a large quantity of cell-type-specific novel splicing events. In certain cell types, particularly the neuron subclasses, as many as 30% of differential splicing events that we detect are novel. In general, across the many considered cell types and tissues in both datasets, we find only a narrow overlap between the top differentially expressed and the top differentially spliced genes within a given cell type, illustrating the complementarity of splicing to expression. Our examination of neurons in the primary motor cortex suggests that splicing distinguishes neuron classes and subclasses as readily as does expression. We showcase alternative splicing patterns specific to the GABAergic (inhibitory) and Glutamatergic (excitatory) neuron classes as well as the subclasses therein. The implicated transcripts include key synaptic molecules and genes which do not display expression differences across subclasses. In developing marrow B cells, we find alternative splicing and novel transcription start sites (TSS) in critical transcription factors such as <italic>Smarca4</italic> and <italic>Foxp1</italic>, while further investigation reveals dissimilar trajectories for expression and alternative splicing in numerous genes across B cell developmental stages. These findings buttress our belief in the complementary nature of these processes and provide clues to the regulatory architecture controlling the early B cell life cycle. To facilitate easy exploration of these datasets and our results, we make available several interactive browsers as a resource for the genomics community.</p><p>Finally, to advance our understanding of alternative splicing regulation, we build a statistical machine learning model to predict splicing events by leveraging both the expression levels and splicing patterns of splicing factors across cell types. This model recovers several known regulatory interactions such as the repression of splice site four exons in neurexins by <italic>Khdrbs3</italic>, while generating new hypotheses for experimental follow-up. For example, in addition to the regulatory effect of the whole-gene <italic>Khdrbs3</italic> expression, the model predicts a regulatory role for a novel alternative TSS in this gene. In aggregate, our results imply that alternative splicing serves as a complementary rather than redundant component of transcriptional regulation and supports the mining of large-scale single-cell transcriptomic data via careful modeling to generate hypothetical regulatory roles for splicing events.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Methods overview</title><sec id="s2-1-1"><title>Robust, annotation-free quantification based on alternative introns</title><p>Most methods rely on the assumption that coverage depth across a transcript is essentially uniform (e.g., <italic>Akr1r1</italic>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1a</xref>). We instead found that Smart-seq2 data (<xref ref-type="bibr" rid="bib59">Picelli et al., 2014</xref>) frequently contain sizable fractions of genes with coverage that decays with increasing distance from the 3’ ends of transcripts. For example, in mammary gland basal cells from the <italic>Tabula Muris</italic> dataset (<xref ref-type="bibr" rid="bib61">Schaum et al., 2018</xref>), <italic>Ctnbb1</italic> shows a gradual drop in coverage (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1b</xref>) while <italic>Pdpn</italic> displays an abrupt reduction halfway through the 3’ UTR (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1c</xref>). That the magnitude of these effects varies across technical replicates (plates) suggests they could be artifacts, possibly related to degradation or interrupted reverse transcription. Similar coverage bias artifacts are also apparent in the BICCN primary motor cortex data (<xref ref-type="bibr" rid="bib84">Yao et al., 2021</xref>; <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>).</p><p>Such coverage biases affect gene expression quantification, and in some cases these batch effects are sufficient to comprise a significant proportion of the observed variation in expression levels. For the <italic>Tabula Muris</italic> mammary gland dataset, a low-dimensional embedding of cells based on gene expression reveals that some cell type clusters exhibit internal stratification by plate (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). A subsequent test of differential gene expression between plate B002438 and all other plates returns 2870 significant hits after correction for multiple hypothesis testing, and all manually inspected differentially expressed genes exhibit these types of coverage biases. Perhaps unsurprisingly, quantification at the transcript level is apt to be even more sensitive to these artifacts than gene-level quantification, especially if it is based on coverage differences across the whole length of the transcript. The UMAP embeddings of isoform proportions (kallisto by <xref ref-type="bibr" rid="bib13">Bray et al., 2016</xref>), exon proportions (DEXSeq by <xref ref-type="bibr" rid="bib2">Anders et al., 2012</xref>), 100 bp bin coverage proportions (ODEGR-NMF by <xref ref-type="bibr" rid="bib50">Matsumoto et al., 2020</xref>) or junction usage proportions across the whole gene (DESJ by <xref ref-type="bibr" rid="bib47">Liu et al., 2021</xref>) depict a plate clustering pattern which scrambles the anticipated cell type clusters (<xref ref-type="fig" rid="fig1">Figure 1b–e</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Clustering patterns by cell type and plate in the mammary gland from a three month-old female mouse in Tabula Muris.</title><p>Cell embeddings based on different features were obtained by running PCA (gene expression) or VAE (the rest) followed by UMAP and subsequently colored by cell type (left column) and the plate in which they were processed (right column). (<bold>a</bold>) Gene expression, quantified using featureCounts (log-transformed normalized counts). (<bold>b</bold>) Isoform proportions. Isoform expression was estimated with kallisto and divided by the total expression of the corresponding gene to obtain isoform proportions. (<bold>c</bold>) Coverage proportions of 100 base-pair bins along the gene, as proposed by ODEGR-NMF. (<bold>d</bold>) Exon proportions, as proposed by DEXSeq. (<bold>e</bold>) Intron proportions across the whole gene, as proposed by DESJ. (<bold>f</bold>) Alternative intron proportions quantified by LeafCutter. (<bold>g</bold>) Alternative intron proportions (for introns sharing a 3’ acceptor site) as quantified by scQuint.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Coverage artifacts in mammary gland basal cells from <italic>Tabula Muris</italic>.</title><p>Aggregate read coverage of basal cells is shown for three genes in two female mice: <italic>3_38_F</italic>, processed in three different plates, and <italic>3_56_F</italic>, processed in two different plates. Visualization on the UCSC Genome Browser. (<bold>a</bold>) <italic>Akr1r1</italic>, with relatively uniform coverage, what we expect. (<bold>b</bold>) <italic>Ctnbb1</italic>, with a gradual drop in coverage away from the 3’ end. The rate of coverage decay varies across plates. (<bold>c</bold>) <italic>Pdpn</italic>, with a sudden drop in coverage halfway through the 3’ UTR. The magnitude of the drop varies across plates.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Technical artifacts in <italic>BICCN Cortex</italic>.</title><p>Aggregate read coverage in <italic>Pdpk1</italic> in two cell types, Vip and Sst, further separated according to the ‘batch’ metadata label into two groups. The first group contains cells from batches <italic>R8S4-180530</italic> and,<inline-formula><mml:math id="inf1"><mml:mrow><mml:mi mathvariant="italic">R8S4</mml:mi><mml:mo>-</mml:mo><mml:mn mathvariant="italic">180524</mml:mn></mml:mrow></mml:math></inline-formula> while the second group contains the remaining batches. Cells from different batches belong to different mice and were processed on different dates. In all groups, coverage decreases rapidly in the 3’ UTR of the isoform with the longest 3’ UTR, eventually reaching zero. Additionally, the relative coverage in this region compared to the rest of the gene (seeming to originate from a different isoform with a short 3’ UTR) varies drastically across batches, and consistently in different cell types. In principle, this could be due to biological differences between mice from different batches, but an explanation based on technical factors such as amplification bias may be more plausible.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig1-figsupp2-v2.tif"/></fig></fig-group><p>With these considerations in mind, we sought to quantify transcript variation in a fashion that would be more robust to coverage differences along the transcript. Although some bulk RNA-seq methods such as RSEM (<xref ref-type="bibr" rid="bib42">Li and Dewey, 2011</xref>) can model positional bias, they do so globally rather than in the gene-specific manner we encounter. One potential approach is alternative intron quantification as performed by bulk RNA-seq methods MAJIQ (<xref ref-type="bibr" rid="bib71">Vaquero-Garcia et al., 2016</xref>), JUM (<xref ref-type="bibr" rid="bib77">Wang and Rio, 2018</xref>), and LeafCutter (<xref ref-type="bibr" rid="bib43">Li et al., 2018</xref>). Promisingly, quantification via LeafCutter (<xref ref-type="fig" rid="fig1">Figure 1f</xref>) yields an embedding that displays less clustering by plate than the other approaches we tried. We therefore based scQuint’s quantification approach on LeafCutter’s, with the key difference of restricting to alternative introns which share a common 3’ acceptor site (<xref ref-type="fig" rid="fig2">Figure 2</xref>). This results in alternative splicing events that are equidistant from the 3’ end of transcripts and which are less affected by the coverage biases we observed in scRNA-seq data. The embedding of cells based on our quantification approach (<xref ref-type="fig" rid="fig1">Figure 1g</xref>) shows less clustering by plate than LeafCutter and other methods.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Overview of scQuint.</title><p>(<bold>a</bold>) Intron usage is quantified from split reads in each cell, with introns sharing 3’ splice sites forming alternative intron groups. (<bold>b</bold>) Genome-wide intron usage is mapped into a low dimensional latent space using a Dirichlet-Multinomial VAE. Visualization of the latent space is done via UMAP. (<bold>c</bold>) A Dirichlet-Multinomial GLM tests for differential splicing across conditions such as predefined cell types or clusters identified from the splicing latent space.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Splicing latent space when alternative intron counts are shuffled.</title><p>To verify that absolute gene expression does not affect the splicing latent space, we perturbed the <italic>BICCN Cortex</italic> dataset by resampling alternative intron counts with a fixed proportion in all cells (the proportions in different alternative intron groups varied and were sampled from a uniform Dirichlet distribution). In this scenario, different cell types still vary in their gene expression levels but not in their splicing patterns. As hoped, the splicing latent space does not distinguish between cell types, indicating it is only capturing differences in splicing proportions rather than changes in absolute gene expression.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Comparison with LeafCutter.</title><p>(<bold>a</bold>) Quantification runtime. Time to perform intron quantification on <italic>BICCN Cortex</italic> dataset, including cell subsampling to understand effect of number of cells. (<bold>b</bold>) Differential splicing runtime and memory usage. We randomly split all 6220 <italic>BICCN Cortex</italic> cells into two equally sized groups and performed differential splicing between them. Runtime (left) and memory usage (right) are displayed. (<bold>c</bold>) Differential splicing p-value calibration. In the same random split of (<bold>b</bold>), the null hypothesis of no difference in splicing proportions holds, and we expect the distribution of p-values to be uniform. The quantile-quantile plot of p-values obtained with scQuint shows their distribution is indeed uniform, suggesting that the model is well-calibrated under the null; this is not true for p-values obtained by LeafCutter. All experiments were performed on a Skylake processor (2 × 16 cores @ 2.1 GHz) with 96 GB of RAM.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig2-figsupp2-v2.tif"/></fig></fig-group><p>Another advantage of alternative intron quantification is the ability to easily discover novel alternative splicing events. Whereas short reads generally cannot be associated with specific transcript isoforms, nor even exons if they partially overlap, split reads uniquely associate with a particular intron. Consequently, intron-based quantification does not depend on annotated transcriptome references and permits the discovery of novel alternative splicing events. This is important since, as detailed later, we estimate up to 30% of cell-type-specific differential splicing events are novel. Other annotation-free methods have been applied to single-cell short-read full-length data, but they do not provide a statistical test for differential splicing between two groups of cells (<xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>).</p><p>We do not recommend using scQuint to analyze alternative splicing in 10x Genomics Chromium data given its strong 3’ transcript bias and evidence suggesting that these data can detect about half the number of junctions detected by Smart-seq2 (<xref ref-type="bibr" rid="bib78">Wang et al., 2021</xref>). This imposes a fundamental limit on the number of transcripts that can be distinguished, and we expect alternative intron quantification to be sub-optimal in this setting. Nonetheless, several approaches for differential transcript usage in 10x data have been developed: Sierra (<xref ref-type="bibr" rid="bib57">Patrick et al., 2020</xref>), SpliZ (<xref ref-type="bibr" rid="bib55">Olivieri et al., 2020</xref>), and a kallisto-based approach which could be adapted for this task (<xref ref-type="bibr" rid="bib54">Ntranos et al., 2019</xref>).</p></sec><sec id="s2-1-2"><title>Dimensionality reduction with Variational Autoencoder</title><p>To perform dimensionality reduction using splicing profiles, we developed a novel Variational Autoencoder (VAE) (<xref ref-type="bibr" rid="bib35">Kingma and Welling, 2014</xref>) with a Dirichlet-Multinomial noise model, a natural distribution for sparse, overdispersed count data (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, Materials and methods). For example, the often encountered ‘binary’ splicing (<xref ref-type="bibr" rid="bib14">Buen Abad Najar et al., 2020</xref>) can be modeled by fitting a concentration parameter close to zero. VAEs are flexible and scalable generative models which have been successfully applied to analyze gene expression (<xref ref-type="bibr" rid="bib48">Lopez et al., 2020</xref>) but have not yet been employed to investigate alternative splicing. To verify that we prevent leakage of gene expression information into our splicing profiles, we applied our VAE to embed a shuffled dataset obtained by resampling alternative intron counts with a fixed proportion in all cells. This shuffled dataset contained expression variability between cells but no splicing differences, and, as hoped, the resulting splicing latent space did not distinguish among cell types, indicating that it captures differences in splicing proportions rather than changes in absolute gene expression (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). We compared the latent space obtained with the VAE to the one obtained using Principal Component Analysis (PCA), a standard dimensionality reduction technique used in the LeafCutter and BRIE2 software packages. The VAE better distinguishes cell types than PCA (<xref ref-type="fig" rid="fig3">Figure 3</xref>), especially in the mammary gland and diaphragm.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Comparison of splicing latent spaces obtained with PCA and VAE.</title><p>Cells from (<bold>a</bold>) the cortex, (<bold>b</bold>) mammary gland and (<bold>c</bold>) diaphragm are projected into a latent space using PCA or VAE and visualized using UMAP. Cell type labels are obtained from the original data sources and are based on clustering in the expression latent space. The VAE is able to better distinguish cell types in the splicing latent space than PCA.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig3-v2.tif"/></fig></sec><sec id="s2-1-3"><title>Differential splicing hypothesis testing with Generalized Linear Model</title><p>To test for differential splicing across cell types or conditions, we adopt a Dirichlet-Multinomial Generalized Linear Model (GLM) coupled with a likelihood-ratio test (<xref ref-type="fig" rid="fig2">Figure 2c</xref>, Materials and methods). We do so by adapting one of LeafCutter’s proposed models for bulk RNA-seq to the scRNA-seq setting and apply it to our Smart-seq2 intron quantification. Namely, due to the sparse nature of scRNA-seq splicing data, we implement a more parsimonious statistical model featuring gene-level rather than intron-level parameters. Furthermore, we adjust the model-fitting algorithm at the initialization and optimization stages (see Materials and methods). After our modifications, we obtain well-calibrated p-values whereas those from LeafCutter’s original differential splicing model are anti-conservative (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>) and perhaps prone to extra false positives if applied directly to scRNA-seq data. We also find improvements in computational cost, both in runtime and memory usage (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><p>As described in Materials and methods, we generated synthetic data in order to benchmark scQuint against three other methods that also offer two-sample tests for differential transcript usage proportions: BRIE2 and DTUrtle, both designed for scRNA-seq, and LeafCutter, designed for bulk RNA-seq (<xref ref-type="fig" rid="fig4">Figure 4</xref>). While the choice of an appropriate simulation model for scRNA-seq data is very much an open area of debate, particularly at the transcript level, we attempted to recreate a challenging setting for inference by assuming low coverage (1–2X) and high overdispersion (variance-to-mean ratio of 8). We performed three in silico experiments to assess performance under the differing conditions of even transcript coverage, unannotated events, and coverage decay across the transcript. In the case of even coverage, scQuint, LeafCutter, and BRIE2 perform similarly and do a good job of correctly identifying events, while DTUrtle is slightly behind. scQuint does only slightly worse with low cell counts and low coverage, which is probably a trade-off for the robustness that comes from only using reads from junctions sharing 3’ acceptor sites. Next, we recreated the unannotated setting by masking the reference given to methods. Only scQuint and LeafCutter are able to perform differential transcript usage testing in this setting, and, as expected, they performed nearly identically to the annotated setting with even coverage. Lastly, we created a setting where transcript coverage decays with distance from the 3’ in one of the two groups, mirroring a pattern we often saw in the real data analyzed for this paper. Here, scQuint outperforms the other tested methods by a wide margin with performance improving at higher coverages, unlike other methods. These results validate that scQuint is robust to both incomplete annotations and coverage decay while only paying a modest penalty relative to other methods under ideal conditions (even coverage and annotated events).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Evaluation of differential splicing test on simulated data.</title><p>ROC AUC for detecting differential transcript usage between two groups, based on the p-value produced by different methods. <italic>Unannotated</italic>: the transcript reference given to methods is masked. <italic>Coverage decay</italic>: coverage decay with distance to the 3’ end of the transcript is induced in one of the two groups.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig4-v2.tif"/></fig></sec></sec><sec id="s2-2"><title>Augmenting cell atlases with splicing information</title><p>We applied scQuint to two of the largest available Smart-seq2 datasets. The first comprehensively surveys the mouse primary motor cortex (<italic>BICCN Cortex</italic>) (<xref ref-type="bibr" rid="bib84">Yao et al., 2021</xref>) while the second contains over 100 cell types distributed across 20 mouse organs (<italic>Tabula Muris</italic>) (<xref ref-type="bibr" rid="bib61">Schaum et al., 2018</xref>; <xref ref-type="table" rid="table1">Table 1</xref>). We detect more alternative introns in <italic>BICCN Cortex</italic> neurons than in the entire broad range of cell types present in <italic>Tabula Muris</italic> (which includes neurons but in much smaller number). This observation comports with previous findings that the mammalian brain has exceptionally high levels of alternative splicing (<xref ref-type="bibr" rid="bib85">Yeo et al., 2004</xref>). <xref ref-type="bibr" rid="bib11">Booeshaghi et al., 2021</xref> analyzed <italic>BICCN Cortex</italic> at the transcript level, but focused on changes in absolute transcript expression rather than proportions. While the authors indirectly find some differences in transcript proportions by inspecting genes with no differential expression, this is not a systematic analysis of differential transcript usage. Meanwhile, only microglial cells in <italic>Tabula Muris</italic> (<xref ref-type="bibr" rid="bib53">Nip et al., 2020</xref>) have been analyzed at the transcript level. (<italic>Tabula Muris</italic> also contains 10x Chromium data analyzed at the transcript level [<xref ref-type="bibr" rid="bib57">Patrick et al., 2020</xref>]).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Overview of analyzed datasets.</title><p><supplementary-material id="table1sdata1"><label>Table 1—source data 1.</label><caption><title>Number of cells per cell type and donor in BICCN Cortex.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-73520-table1-data1-v2.zip"/></supplementary-material><supplementary-material id="table1sdata2"><label>Table 1—source data 2.</label><caption><title>Number of cells per tissue and donor in Tabula Muris.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-73520-table1-data2-v2.zip"/></supplementary-material></p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom">Dataset</th><th valign="bottom">Cells</th><th valign="bottom">Tissues</th><th valign="bottom">Cell types</th><th valign="bottom">Individuals</th><th valign="bottom">Genes</th><th valign="bottom">Alt. introns</th><th valign="bottom">Unannotated</th></tr></thead><tbody><tr><td align="left" valign="bottom">BICCN Cortex</td><td align="char" char="." valign="bottom">6220</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">11</td><td align="char" char="." valign="bottom">45</td><td align="char" char="." valign="bottom">26,488</td><td align="char" char="." valign="bottom">39,357</td><td align="char" char="." valign="bottom">29%</td></tr><tr><td align="left" valign="bottom">Tabula Muris</td><td align="char" char="." valign="bottom">44,518</td><td align="char" char="." valign="bottom">23</td><td align="char" char="." valign="bottom">117</td><td align="char" char="." valign="bottom">8</td><td align="char" char="." valign="bottom">27,348</td><td align="char" char="." valign="bottom">29,965</td><td align="char" char="." valign="bottom">25%</td></tr></tbody></table></table-wrap><p>As a community resource, we provide complementary ways to interactively explore splicing patterns present in these datasets (<xref ref-type="fig" rid="fig5">Figure 5</xref>), available at (<ext-link ext-link-type="uri" xlink:href="https://github.com/songlab-cal/scquint-analysis">https://github.com/songlab-cal/scquint-analysis</ext-link>, <xref ref-type="bibr" rid="bib6">Benegas, 2021a</xref>) with an accompanying tutorial video. The UCSC Genome Browser (<xref ref-type="bibr" rid="bib34">Kent et al., 2002</xref>) permits exploration of alternative splicing events within genomic contexts such as amino acid sequence, conservation score, or protein binding sites, while allowing users to select different length scales for examination. We additionally leverage the cell×gene browser (<xref ref-type="bibr" rid="bib52">Megill et al., 2021</xref>) (designed for gene expression analysis) to visualize alternative intron PSI (percent spliced-in, defined as the proportion of reads supporting an intron relative to the total in the intron group) via cell embeddings. Further, one can generate histograms to compare across different groups defined by cell type, gender, or even manually selected groups of cells. These tools remain under active development by the community, and we hope that both the genome- and cell-centric views will soon be integrated into one browser.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Interactive visualizations of splicing patterns.</title><p>As an example, a skipped exon in <italic>Myl6</italic>. (<bold>a</bold>) The UCSC Genome browser visualization of this locus. Bottom: annotated isoforms of <italic>Myl6</italic>, including a skipped exon. Center: aggregate read coverage in three cell types with varying inclusion levels of the skipped exon. Top: three alternative introns that share a 3’ acceptor site. The identified intron’s proportion corresponds to the skipped exon’s inclusion level. (<bold>b</bold>) cell×gene browser visualization of the marked intron’s proportions (Myl6_chr10:128491034–128491720). Center: intron proportion for each cell in the UMAP expression embedding. Sides: intron proportion histogram for (left) different cell types and (right) all cells.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig5-v2.tif"/></fig></sec><sec id="s2-3"><title>Cell-type-specific splicing signal is strong and complementary to gene expression</title><sec id="s2-3-1"><title>Primary motor cortex</title><p>We first explored the splicing latent space of <italic>BICCN Cortex</italic> cells by comparing it to the usual expression latent space (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). Cells in the splicing latent space strongly cluster by cell type (annotated by <xref ref-type="bibr" rid="bib84">Yao et al., 2021</xref> based on gene expression). A similar analysis was recently performed (<xref ref-type="bibr" rid="bib18">Feng et al., 2021</xref>) on a different cortex subregion in which most, but not all, neuron subclasses could be distinguished based on splicing profiles (e.g., L6 CT and L6b could not be separated). However, the authors only considered annotated skipped exons, a subset of the events we quantify, and used a different dimensionality reduction technique.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Splicing patterns in <italic>BICCN Cortex</italic>.</title><p>(<bold>a</bold>) Expression and splicing latent spaces, visualized using UMAP. The expression (splicing) latent space is defined by running PCA (VAE) on the gene expression (alternative intron proportion, PSI) matrix. Cell types separate well in both latent spaces. (<bold>b</bold>) PSI of selected introns (left) and expression (log-transformed normalized counts) of their respective genes (right) averaged across cell types. Top: introns distinguishing Glutamatergic and GABAergic neuron classes. Bottom: introns distinguishing neuron subclasses. (<bold>c–e</bold>) Sashimi plots (<xref ref-type="bibr" rid="bib23">Garrido-Martín et al., 2018</xref>) of specific alternative splicing events, displaying overall read coverage with arcs indicating usage of different introns (certain introns are shrunk for better visualization). (<bold>c</bold>) Novel skipped exon in <italic>Pgm2</italic>. (<bold>d</bold>) Novel alternative transcription start site (TSS) in <italic>Rbfox1</italic>. (<bold>e</bold>) Annotated skipped exon (SE) in <italic>Nrxn1</italic>.</p><p><supplementary-material id="fig6sdata1"><label>Figure 6—source data 1.</label><caption><title>Intron coordinates for panel (b).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-73520-fig6-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Marker genes for cell types in <italic>BICCN Cortex</italic>.</title><p>Mean (log-transformed) expression for some of the top differentially expressed genes in each cell type.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>PSI distribution of Pgm2_32951.</title><p>Only six individuals with highest number of cells are displayed. Marked N/A are cell types where the individuals have PSI defined in fewer than three cells. Per the experimental design of this dataset, the top 3 individuals have only Glutamatergic cell types sequenced, while the bottom 3 have only GABAergic.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>PSI distribution of Rbfox1_26172.</title><p>Only six individuals with highest number of cells are displayed. Marked N/A are cell types where the individuals have PSI defined in fewer than three cells. Per the experimental design of this dataset, the top 3 individuals have only Glutamatergic cell types sequenced, while the bottom 3 have only GABAergic.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig6-figsupp3-v2.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 4.</label><caption><title>PSI distribution of Nrxn1_8067.</title><p>Only six individuals with highest number of cells are displayed. Marked N/A are cell types where the individuals have PSI defined in fewer than three cells. Per the experimental design of this dataset, the top 3 individuals have only Glutamatergic cell types sequenced, while the bottom 3 have only GABAergic.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig6-figsupp4-v2.tif"/></fig></fig-group><p><xref ref-type="fig" rid="fig6">Figure 6b</xref> (top left) highlights some differentially spliced genes between Glutamatergic and GABAergic neurons, including the glutamate metabotropic receptor <italic>Grm5</italic> as well as <italic>Shisa9/Ckamp44</italic>, which associates with AMPA ionotropic glutamate receptors (<xref ref-type="bibr" rid="bib73">von Engelhardt et al., 2010</xref>). The expression pattern of these genes, meanwhile, does not readily distinguish the neuron classes (<xref ref-type="fig" rid="fig6">Figure 6b</xref>, top right). In <italic>Pgm2</italic>, a gene of the glycolysis pathway thought to be regulated in the developing cortex by mTOR (<xref ref-type="bibr" rid="bib62">Schüle et al., 2021</xref>), we discover a novel exon preferentially included in Glutamatergic neurons (<xref ref-type="fig" rid="fig6">Figure 6c</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>).</p><p>Our differential splicing test reveals thousands of cell-type-specific splicing events (further discussed below in subsection Comparison of selected tissues), highlighting marker introns that distinguish neuron subclasses, while the expression of their respective genes does not; for example, compare the bottom left and bottom right panels of <xref ref-type="fig" rid="fig6">Figure 6b</xref>. Genes that better distinguish cell types at the expression level can be seen in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>. As another example of the many novel events we discover, we showcase a novel alternative transcription start site in <italic>Rbfox1</italic>, a splicing factor known to regulate cell-type-specific alternative splicing in the brain (<xref ref-type="bibr" rid="bib75">Wamsley et al., 2018</xref>; <xref ref-type="fig" rid="fig6">Figure 6d</xref>, <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>). This novel TSS (exon chr16:5763871–5763913, intron Rbfox1_26172), which lies in a highly-conserved region, is (partially) used by only L6b neurons. We are also able to detect well-known cell-type-specific alternatively spliced genes such as <italic>Nrxn1</italic>, which encodes a key pre-synaptic molecule (<xref ref-type="fig" rid="fig6">Figure 6e</xref>, <xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4</xref>; <xref ref-type="bibr" rid="bib21">Fuccillo et al., 2015</xref>). In this case, we observe an exon (known as splice site 2) exclusively skipped in Vip and Lamp5 neurons.</p></sec><sec id="s2-3-2"><title>General patterns in <italic>Tabula Muris</italic></title><p>We next turned our attention to <italic>Tabula Muris</italic>, which comprises a wide variety of organs and cell types from across the entire body. As before, we initially compared the expression and splicing latent spaces using UMAP (<xref ref-type="fig" rid="fig7">Figure 7a</xref>). This revealed broadly consistent clusters between projections, but a visible shift in the global layout of these clusters. In particular, whereas cell types were better separated in the expression projection, cell classes (e.g., endothelial, epithelial, immune) formed more coherent clusters in the splicing projection.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Global analysis of <italic>Tabula Muris</italic>.</title><p>(<bold>a</bold>) UMAP visualization of the expression (left) and splicing (right) latent spaces. Each dot is a cell, colored by organ, and overlays indicate the primary cell type comprising that cluster. (<bold>b</bold>) Tanglegram comparing dendrograms of major cell types based on distances in the expression (left) and splicing (right) latent spaces, highlighting functional classes with specific colors.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig7-v2.tif"/></fig><p>To supplement our qualitative comparison of UMAP projections with a more rigorous approach, we built dendrograms and a tanglegram using the respective distances between cells in each of the expression and splicing latent spaces (<xref ref-type="fig" rid="fig7">Figure 7b</xref>). Despite minor shifts, the dendrograms resemble one another, and most subtree structure is preserved. The low value of their entanglement, a quantitative measure of the discrepancy between hierarchical clusterings, at only 6% indicates a high degree of similarity. (For comparison, the entanglement value between the dendrogram for all expressed genes and that for transcript factors is 11% [<xref ref-type="bibr" rid="bib61">Schaum et al., 2018</xref>]). As in the UMAP visualization, immune cells group together more closely in the splicing dendrogram. However, unlike the UMAP projection, we observe that several types of pancreatic cells cluster together with neurons, a cell type long believed to share an evolutionary origin (<xref ref-type="bibr" rid="bib39">Le Roith et al., 1982</xref>). Notably, the left dendrogram in <xref ref-type="fig" rid="fig7">Figure 7b</xref> shows that hepatocytes are clear outliers in the expression latent space. We suspect this may be due to technical differences from using 96-well plates rather than the 384-well plates used for other cell types.</p></sec><sec id="s2-3-3"><title>B cell development in the marrow</title><p>We then focused on developing B cells from the bone marrow in <italic>Tabula Muris</italic>. In the splicing latent space, we found that immature B cells are harder to distinguish from the other B cell subpopulations (<xref ref-type="fig" rid="fig8">Figure 8a</xref>), reflecting less refined splicing programs or limitations in transcript capture efficiency. Immature B cells have also fewer differential splicing events when compared to the other stages of B cell development (<xref ref-type="fig" rid="fig8">Figure 8b</xref>). The top differential splicing events we identified throughout development displayed splicing trajectories mostly independent from the trajectories of gene expression (<xref ref-type="fig" rid="fig8">Figure 8c</xref>). We highlight alternative TSSs (one of them novel) in two transcription factors essential for B cell development: <italic>Smarca4</italic>, encoding BRG1 (<xref ref-type="bibr" rid="bib12">Bossen et al., 2015</xref>; <xref ref-type="fig" rid="fig8">Figure 8d</xref>, <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>); and <italic>Foxp1</italic> (<xref ref-type="bibr" rid="bib29">Hu et al., 2006</xref>; <xref ref-type="fig" rid="fig8">Figure 8e</xref>, <xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref>). While <italic>Foxp1</italic> expression peaks in pre-B cells and does not follow a monotonic trend over developmental stages, the alternative TSS is progressively included throughout B cell development. Combining gene-level expression with TSS usage, which can influence translation rate, provides a more nuanced characterization of the expression patterns of these important transcription factors. Some other differentially spliced genes with well-known roles in B cell development are <italic>Syk</italic> (<xref ref-type="bibr" rid="bib16">Cornall et al., 2000</xref>), <italic>Dock10</italic> (<xref ref-type="bibr" rid="bib22">García-Serna et al., 2016</xref>), <italic>Selplg/Psgl-1</italic> (<xref ref-type="bibr" rid="bib25">González-Tajuelo et al., 2020</xref>), and <italic>Rps6ka1</italic> (<xref ref-type="bibr" rid="bib65">Stein et al., 2017</xref>).</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Splicing in developing marrow B cells from <italic>Tabula Muris</italic>.</title><p>B cell developmental stages include pro-B, pre-B, immature B, and naive B. (<bold>a</bold>) Expression versus splicing latent space, as defined previously. In the splicing latent space, some cells types (pro-B) are better distinguished than others (immature B). (<bold>b</bold>) Number of differential splicing events when comparing a B cell stage vs. the rest. (<bold>c</bold>) PSI of some introns that are differentially spliced throughout development, together with expression of the respective genes (log-transformed normalized counts). Expression and splicing can have very different trajectories. (<bold>d</bold>) Sashimi plot of novel alternative transcription start site (TSS) in <italic>Smarca4</italic>. The novel TSS has maximum usage in pre-B cells, and then decays, while the expression peaks at pro-B cells. (<bold>e</bold>) Sashimi plot of an annotated alternative TSS in <italic>Foxp1</italic>. The proximal TSS in increasingly used as development progresses, while the expression peaks at pre-B cells.</p><p><supplementary-material id="fig8sdata1"><label>Figure 8—source data 1.</label><caption><title>Intron coordinates for panel (<bold>c</bold>).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-73520-fig8-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig8-v2.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>PSI distribution of Smarca4_28720.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig8-figsupp1-v2.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>PSI distribution of Foxp1_11076.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig8-figsupp2-v2.tif"/></fig></fig-group></sec><sec id="s2-3-4"><title>Epithelial and endothelial cell types across organs</title><p>Having compared different cell types within organs, we analyzed putatively similar cell types which are present in multiple organs to investigate splicing variation associated with tissue environment and function. We find many alternative introns with strong PSI differences across epithelial cell types, including several which are novel (<xref ref-type="fig" rid="fig9">Figure 9a</xref>). Conversely, apart from those in the brain, endothelial cell types fail to display such striking differences (<xref ref-type="fig" rid="fig9">Figure 9b</xref>). These patterns are consistent with the UMAP projection and dendrogram, both of which suggested less heterogeneity among endothelial than epithelial cells (<xref ref-type="fig" rid="fig7">Figure 7</xref>).</p><fig-group><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Alternative splicing patterns across epithelial and endothelial cell types.</title><p>(<bold>a–b</bold>) PSI of selected introns (left) and expression (log-transformed normalized counts) of the corresponding genes (right) averaged across cell types. Novel intron groups are marked with (*). (<bold>a</bold>) Introns distinguishing epithelial cell types. (<bold>b</bold>) Introns distinguishing endothelial cell types. (<bold>c</bold>) Sashimi plot of an alternative TSS in <italic>Itpr1</italic>. (<bold>d</bold>) Sashimi plot of a complex alternative splicing event in <italic>Khk</italic>.</p><p><supplementary-material id="fig9sdata1"><label>Figure 9—source data 1.</label><caption><title>Intron coordinates for panel (a).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-73520-fig9-data1-v2.zip"/></supplementary-material></p><p><supplementary-material id="fig9sdata2"><label>Figure 9—source data 2.</label><caption><title>Intron coordinates for panel (b).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-73520-fig9-data2-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig9-v2.tif"/></fig><fig id="fig9s1" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 1.</label><caption><title>Full-gene view of novel alternative TSS in <italic>Itpr1</italic>.</title><p>Large intestine secretory cells aggregate read coverage visualized in the UCSC Genome Browser.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig9-figsupp1-v2.tif"/></fig><fig id="fig9s2" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 2.</label><caption><title>PSI distribution of Itpr1_26257.</title><p>Only six individuals with highest number of cells are displayed. Marked N/A are cell types where the individuals have PSI defined in fewer than three cells.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig9-figsupp2-v2.tif"/></fig><fig id="fig9s3" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 3.</label><caption><title>PSI distribution of Khk_24896.</title><p>Only six individuals with highest number of cells are displayed. Marked N/A are cell types where the individuals have PSI defined in fewer than three cells.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig9-figsupp3-v2.tif"/></fig></fig-group><p>Our analysis revealed a novel alternative TSS in <italic>Itpr1</italic> (<xref ref-type="fig" rid="fig9">Figure 9c</xref>, <xref ref-type="fig" rid="fig9s2">Figure 9—figure supplement 2</xref>), an intracellular calcium channel in the endoplasmic reticulum, which regulates secretory activity in epithelial cells of the gastrointestinal tract (<xref ref-type="bibr" rid="bib41">Lemos et al., 2020</xref>). This novel TSS yields a shorter protein isoform (full view in <xref ref-type="fig" rid="fig9s1">Figure 9—figure supplement 1</xref>) which preserves the transmembrane domain, though it is unclear whether this isoform is functional. Notably, it is the predominant isoform in large intestine secretory cells, and these cells express <italic>Itpr1</italic> at the highest level among all epithelial cell types in the dataset. All nine novel alternative splicing events in <xref ref-type="fig" rid="fig9">Figure 9a</xref> are alternative TSSs, with four affecting the 5’ UTR and five affecting the coding sequence.</p><p><xref ref-type="fig" rid="fig9">Figure 9d</xref> (PSI distribution in <xref ref-type="fig" rid="fig9s3">Figure 9—figure supplement 3</xref>) illustrates a complex alternative splicing event in <italic>Khk</italic> involving the well-studied exons 3a and 3c (<xref ref-type="bibr" rid="bib28">Hayward and Bonthron, 1998</xref>). Khk catalyzes the conversion of fructose into fructose-1-phosphate, and the two protein isoforms corresponding to either exon 3a or 3c inclusion differ in their thermostability and substrate affinity (<xref ref-type="bibr" rid="bib4">Asipu et al., 2003</xref>). While the literature describes these exons as mutually exclusive, the transcriptome reference includes transcripts where neither or both may be included. Although we did not find cell types with high inclusion rates for both exons, we did see multiple cell types where both exons are predominantly excluded, for example, epithelial cells from the large intestine. Other differentially spliced genes are involved in cellular junctions, which are particularly important in epithelial tissue. These include <italic>Gsn</italic>, <italic>Eps8</italic>, <italic>Tln2</italic>, <italic>Fermt3</italic>, and <italic>Mapre2</italic>.</p></sec><sec id="s2-3-5"><title>Comparison of selected tissues</title><p>Because of the breadth of the <italic>Tabula Muris</italic> dataset, we can look for general trends across a diverse array of tissues and cell types. <xref ref-type="table" rid="table2">Table 2</xref> summarizes differential expression and splicing for some of the cell types and tissues with the largest sample sizes. First, we note the intersection between the top 100 most differentially expressed and top 100 most differentially spliced genes (ranked by p-value) is consistently low. This means that most differentially spliced genes, which might be of critical importance in a biological system, will go unnoticed if a study only considers differential expression. Second, L5 IT neurons have a larger fraction of genes with differential splicing relative to the number of differentially expressed genes.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Summary of differential expression and splicing for select cell types with the largest sample sizes.</title><p>The overlap between the top 100 differentially expressed genes and the top 100 differentially spliced genes is low, indicating that splicing provides complementary information. In addition, L5 IT neurons have a higher ratio of differentially spliced genes to differentially expressed genes than the other cell types. <italic>Diff. spl. genes</italic>: number of differentially spliced genes between the cell type and other cell types in the same tissue. <italic>Diff. exp. genes</italic>: number of differentially expressed genes between the cell type and other cell types in the same tissue. See Materials and methods for details on the tests for differential splicing and expression.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom">Tissue</th><th valign="bottom">Total # cells</th><th valign="bottom"># cell types</th><th align="left" valign="bottom">Cell type</th><th valign="bottom"># cells</th><th valign="bottom">Diff. spl. genes</th><th valign="bottom">Diff. exp. genes</th><th valign="bottom">Ratio</th><th align="left" valign="bottom">Top-100 overlap</th></tr></thead><tbody><tr><td align="left" valign="bottom">Brain Non-Myeloid</td><td align="char" char="." valign="bottom">3049</td><td align="center" valign="bottom">6</td><td align="left" valign="bottom">Oligodendrocyte</td><td align="center" valign="bottom">1390</td><td align="center" valign="bottom">880</td><td align="center" valign="bottom">8835</td><td align="center" valign="bottom">0.10</td><td align="center" valign="bottom">4</td></tr><tr><td align="left" valign="bottom">Cortex</td><td align="char" char="." valign="bottom">6220</td><td align="center" valign="bottom">10</td><td align="left" valign="bottom">L5 IT</td><td align="center" valign="bottom">1571</td><td align="center" valign="bottom">1447</td><td align="center" valign="bottom">6402</td><td align="center" valign="bottom">0.23</td><td align="center" valign="bottom">2</td></tr><tr><td align="left" valign="bottom">Heart</td><td align="char" char="." valign="bottom">4144</td><td align="center" valign="bottom">6</td><td align="left" valign="bottom">Endothelial cell of coronary artery</td><td align="center" valign="bottom">1126</td><td align="center" valign="bottom">465</td><td align="center" valign="bottom">7108</td><td align="center" valign="bottom">0.07</td><td align="center" valign="bottom">5</td></tr><tr><td align="left" valign="bottom">Large Intestine</td><td align="char" char="." valign="bottom">3729</td><td align="center" valign="bottom">5</td><td align="left" valign="bottom">Enterocyte of epithelium</td><td align="center" valign="bottom">1112</td><td align="center" valign="bottom">586</td><td align="center" valign="bottom">10,786</td><td align="center" valign="bottom">0.05</td><td align="center" valign="bottom">2</td></tr><tr><td align="left" valign="bottom">Marrow</td><td align="char" char="." valign="bottom">4783</td><td align="center" valign="bottom">10</td><td align="left" valign="bottom">Hematopoietic stem cell</td><td align="center" valign="bottom">1363</td><td align="center" valign="bottom">692</td><td align="center" valign="bottom">9909</td><td align="center" valign="bottom">0.07</td><td align="center" valign="bottom">2</td></tr></tbody></table></table-wrap><p>We found many more cell-type-specific differential splicing events in the cortex than in the marrow, as expected (<xref ref-type="bibr" rid="bib85">Yeo et al., 2004</xref>), as well as a higher proportion of events involving novel junctions, which can reach 30% (<xref ref-type="fig" rid="fig10">Figure 10a</xref>). Differences in proportion of novel junctions should be interpreted with care, however, since they can be affected by sequencing depth and number of cells, both of which vary between the two tissues. Very similar patterns are seen when grouping differential splicing events that occur in the same gene (<xref ref-type="fig" rid="fig10">Figure 10b</xref>). Most differential splicing events that we detected with alternative introns fall in the coding portion of the gene, with high proportions in the 5’ UTR (<xref ref-type="fig" rid="fig10">Figure 10c</xref>). This is a property of our quantification approach and does not reflect the total number of alternative splicing events in different gene regions; still, the relative proportion can be compared across tissues. We find an increased proportion of differentially spliced non-coding RNA in the cortex, the majority of which are previously unannotated events. To systematically evaluate how well cell types can be distinguished in the expression and splicing latent spaces, we calculated the ROC AUC score for the one-versus-all classification task for each cell type in each tissue using a binary logistic regression model (<xref ref-type="fig" rid="fig10">Figure 10d</xref>). Since cell type labels were defined using gene expression values, near-perfect classification is to be expected using the expression latent space. Classification based only on the splicing latent space is very good in general, suggesting that cell-type-specific differential splicing is rather pervasive. A few cell types were more challenging to classify correctly using splicing patterns alone. One such example is immature B cells, a reflection of the lower degree of separation observed in the embedding of <xref ref-type="fig" rid="fig8">Figure 8a</xref>.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Patterns across tissues.</title><p>(<bold>a</bold>) Number of differential splicing events detected in each cell type. Cortex cell types have more differential splicing events and larger proportions of novel events (those involving an intron absent from the reference). (<bold>b</bold>) Number of genes with a detected differential splicing event, for different cell types. (<bold>c</bold>) Number of differential splicing events in different gene regions aggregated over cell types (duplicate events removed). Cortex cell types have higher proportions of events in coding regions and non-coding RNAs. Note: y-axes are not on the same scale. (<bold>d</bold>) ROC AUC score for classification of each cell type versus the rest based on either the expression or splicing latent space, using logistic regression, training and testing in non-overlapping sets of individuals. The score for splicing-based classification is near-perfect in most cell types with some exceptions such as immature B cells in the marrow.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig10-v2.tif"/></fig></sec></sec><sec id="s2-4"><title>Finding splicing factors associated with specific alternative splicing events</title><p>Several splicing factors have been identified as regulators of specific alternative splicing events, but most regulatory interactions remain unknown (see <xref ref-type="bibr" rid="bib74">Vuong et al., 2016</xref> for a review focused on the brain). To complement expensive and laborious knockout experiments, we sought to generate regulatory hypotheses by analyzing the correlation between splicing outcomes and splicing factor variation across cell types. Focusing on a subset of highly expressed genes in BICCN primary motor cortex neurons, we fit a sparse linear model regressing PSI of skipped exons on both expression and splicing patterns of splicing factors (<xref ref-type="fig" rid="fig11">Figure 11a</xref> and <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1</xref>). Our model recovers several known regulatory interactions such as Khdrbs3/Slm2/T-Star’s repression of splice site 4 (SS4) in neurexins, modulating their binding with post-synaptic partners (<xref ref-type="bibr" rid="bib70">Traunmüller et al., 2016</xref>). Additionally, the proportion of a novel alternative TSS (though annotated in the human reference) in <italic>Khdrbs3</italic> (<xref ref-type="fig" rid="fig11">Figure 11b</xref>, <xref ref-type="fig" rid="fig11s2">Figure 11—figure supplement 2</xref>) is negatively associated with SS4 in <italic>Nrxn1</italic> and <italic>Nrxn3</italic>. This novel isoform lacks the first 30 amino acids of the Qua1 homodimerization domain and could affect dimerization, which modulates RNA affinity (<xref ref-type="bibr" rid="bib19">Feracci et al., 2016</xref>). The model also recovers the known regulation of a skipped exon in <italic>Camta1</italic>, a transcription factor required for long-term memory (<xref ref-type="bibr" rid="bib5">Bas-Orth et al., 2016</xref>), by Rbfox1 (<xref ref-type="bibr" rid="bib58">Pedrotti et al., 2015</xref>). The skipping of exon 5 (E5) of <italic>Grin1</italic>, which controls long-term synaptic potentiation and learning (<xref ref-type="bibr" rid="bib63">Sengar et al., 2019</xref>), is known to be regulated by Mbnl2 and Rbfox1 (<xref ref-type="bibr" rid="bib74">Vuong et al., 2016</xref>). The model associates <italic>Grin1</italic> E5 PSI with the expression of <italic>Rbfox1</italic> but not <italic>Mbnl2</italic>; however, it does suggest an association with the PSI of two skipped exons in <italic>Mbnl2</italic> (<xref ref-type="fig" rid="fig11">Figure 11c</xref>, <xref ref-type="fig" rid="fig11s3">Figure 11—figure supplements 3</xref> and <xref ref-type="fig" rid="fig11s4">4</xref>) and further implicates the inclusion level of the novel alternative TSS in <italic>Rbfox1</italic> reported above (Rbfox1_26172, chr16:5763912–6173605, <xref ref-type="fig" rid="fig6">Figure 6d</xref>). These results help clarify the disparate impacts of expression and alternative splicing in splicing factors, and encourage the use of regression models to suggest candidate regulators of cell-type-specific alternative splicing. Such computationally generated hypotheses are particularly valuable for splicing events in splicing factors because of the heightened difficulty to experimentally perturb specific exons rather than whole genes.</p><fig-group><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Associations between splicing factors and alternative splicing.</title><p>(<bold>a</bold>) Regression analysis of exon skipping based on expression and splicing of splicing factors, using the BICCN mouse primary motor cortex dataset. Left panel: mean PSI of skipped exons across cell types. Bottom panel: mean z-scores of selected splicing factor features across cell types, including whole-gene expression (gene name) and PSI of alternative introns (gene name and numerical identifier). Center panel: regression coefficients (log-odds) of each splicing factor feature used to predict skipped exon PSI in our sparse Dirichlet-Multinomial linear model. (<bold>b</bold>) Novel alternative TSS in <italic>Khdrbs3</italic>. (<bold>c</bold>) Annotated skipped exons in <italic>Mbnl2</italic>.</p><p><supplementary-material id="fig11sdata1"><label>Figure 11—source data 1.</label><caption><title>Intron coordinates are available for panel (a).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-73520-fig11-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig11-v2.tif"/></fig><fig id="fig11s1" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 1.</label><caption><title>Full plot of associations between splicing factors and alternative splicing.</title><p>Regression analysis of exon skipping based on expression and splicing of splicing factors, using the BICCN mouse primary motor cortex dataset. Left panel: mean PSI of skipped exons across cell types. Bottom panel: mean z-scores of selected splicing factor features across cell types, including whole-gene expression (gene name) and PSI of alternative introns (gene name and numerical identifier). Center panel: regression coefficients (log-odds) of each splicing factor feature used to predict skipped exon PSI in our sparse Dirichlet-Multinomial linear model.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig11-figsupp1-v2.tif"/></fig><fig id="fig11s2" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 2.</label><caption><title>PSI distribution of Khdrbs3_25689.</title><p>Only six individuals with highest number of cells are displayed. Marked N/A are cell types where the individuals have PSI defined in fewer than three cells. Per the experimental design of this dataset, the top three individuals have only Glutamatergic cell types sequenced, while the bottom three have only GABAergic.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig11-figsupp2-v2.tif"/></fig><fig id="fig11s3" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 3.</label><caption><title>PSI distribution of Mbnl2_25376.</title><p>Only six individuals with highest number of cells are displayed. Marked N/A are cell types where the individuals have PSI defined in fewer than three cells. Per the experimental design of this dataset, the top three individuals have only Glutamatergic cell types sequenced, while the bottom three have only GABAergic.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig11-figsupp3-v2.tif"/></fig><fig id="fig11s4" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 4.</label><caption><title>PSI distribution of Mbnl2_25378.</title><p>Only six individuals with highest number of cells are displayed. Marked N/A are cell types where the individuals have PSI defined in fewer than three cells. Per the experimental design of this dataset, the top three individuals have only Glutamatergic cell types sequenced, while the bottom three have only GABAergic.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73520-fig11-figsupp4-v2.tif"/></fig></fig-group></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we introduce scQuint, a toolkit for the quantification, visualization, and statistical inference of alternative splicing in full-length scRNA-seq data without the need for annotations. This allows us to successfully extend the analysis of two single-cell atlases to the level of alternative splicing, overcoming the usual technical challenges as well as coverage artifacts and incomplete annotations. Our results, which we make available for public exploration via interactive browsers, indicate the presence of strong cell-type-specific alternative splicing and previously unannotated splicing events across a broad array of cell types. In most cases, splicing variation is able to differentiate cell types just as well as expression levels. We also note a striking lack of overlap between the most strongly differentially expressed and spliced genes (<xref ref-type="table" rid="table2">Table 2</xref>), suggesting that expression and splicing are complementary rather than integrated processes. Moreover, this complementarity may also manifest temporally, as we show in developing B cells in the marrow. Another outstanding question is the functional significance of isoforms, and we find that most differential splice sites appear in the coding sequence with a sizeable minority also mapping to 5’ UTRs. The apparent predilection for events to occur in these regions rather than 3’ UTRs poses questions about the role of splicing in protein synthesis from translational regulation to the formation of polypeptide chains. Answering these questions requires a more precise understanding of how variation in UTRs and coding sequences affects final protein output as well as the biophysical characteristics of protein isoforms and their roles in different biological systems. These factors, combined with the large fraction of unannotated events in several cell types, should encourage tissue specialists to more deeply consider the contribution of transcript variation to cell identity and cell and tissue homeostasis.</p><p>Despite the clear association between splicing and cell identity, our analyses are yet to produce instances in which clustering in the splicing latent space reveals new cell subpopulations not visible in the expression latent space. This, of course, does not preclude the possibility in other settings where alternative splicing is known to be important, such as in specific developmental transitions or disease conditions. Nevertheless, our current experience leads us to believe that gene expression and splicing proportions provide two different projections of the same underlying cell state. Incidentally, RNA Velocity (<xref ref-type="bibr" rid="bib38">La Manno et al., 2018</xref>) estimates can be distorted by alternative splicing, and (<xref ref-type="bibr" rid="bib10">Bergen et al., 2020</xref>) discuss incorporating isoform proportions into the model as a future direction.</p><p>To support our understanding of cell-type-specific splicing, we implemented a regularized generalized linear regression model which exploits the natural variation of splicing factors in different cell types. We recovered a number of previously identified (via knockout experiments) regulatory interactions and propose novel regulatory interactions involving genes known to play important regulatory roles. A key component of our analysis is the decision to include both the expression and alternative splicing patterns of splicing factors as features in the model. Consequently, we infer that several alternative splicing events in splicing factors themselves (some previously unannotated) contribute to their regulatory activity. Our model thus provides several opportunities for follow-up and does so with an increased granularity that distinguishes between effects due to expression and splicing differences. To facilitate further exploration of these data, we have uploaded our results to cell and genome browsers (linked at <ext-link ext-link-type="uri" xlink:href="https://github.com/songlab-cal/scquint-analysis">https://github.com/songlab-cal/scquint-analysis</ext-link>, (<xref ref-type="bibr" rid="bib6">Benegas, 2021a</xref> copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:76b0f21fb892d9f0aee2da2dc71d887513443966;origin=https://github.com/songlab-cal/scquint-analysis;visit=swh:1:snp:c040f4511378d09901aa51c8e0d2bd3a2e5a72f7;anchor=swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87">swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87</ext-link>)).</p><p>Our experience analyzing these large datasets, initially with prior methods and then scQuint, has led to a series of general observations regarding the analysis of splicing in scRNA-seq data. As most analyses use full-length short-read protocols because of the cost of long-read data and the necessary focus on the 3’ end of transcripts in most UMI-based techniques, we restrict our attention to the full-length short-read setting and its incumbent challenges. For example, low transcript capture efficiency introduces additional technical noise into isoform quantification (<xref ref-type="bibr" rid="bib3">Arzalluz-Luque and Conesa, 2018</xref>; <xref ref-type="bibr" rid="bib81">Westoby et al., 2020</xref>; <xref ref-type="bibr" rid="bib14">Buen Abad Najar et al., 2020</xref>), and incomplete transcriptome annotations result in discarded reads and reduced sensitivity to cross-cell differences (<xref ref-type="bibr" rid="bib81">Westoby et al., 2020</xref>). Nonetheless, we considered several methods (summarized in <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>) to analyze transcript variation in short-read, full-length scRNA-seq. We found each of the classes of current methods to be problematic in the context of our datasets for varying reasons. Methods which depend on transcript annotations (<xref ref-type="bibr" rid="bib13">Bray et al., 2016</xref>; <xref ref-type="bibr" rid="bib60">Qiu et al., 2017</xref>; <xref ref-type="bibr" rid="bib31">Huang and Sanguinetti, 2017</xref>; <xref ref-type="bibr" rid="bib30">Hu et al., 2020</xref>; <xref ref-type="bibr" rid="bib83">Yan et al., 2015</xref>; <xref ref-type="bibr" rid="bib80">Wen et al., 2020</xref>; <xref ref-type="bibr" rid="bib47">Liu et al., 2021</xref>; <xref ref-type="bibr" rid="bib32">Huang and Sanguinetti, 2021</xref>; <xref ref-type="bibr" rid="bib69">Tekath and Dugas, 2021</xref>) cannot easily identify unannotated alternative splicing events. In large collections of previously unsurveyed cell types, these may comprise a sizable fraction of events. Indeed, we found up to 30% of differential splicing events were unannotated in certain cell types. Annotation-free approaches are also available, but they either do not provide a formal statistical test for differential transcript usage across conditions (<xref ref-type="bibr" rid="bib64">Song et al., 2017</xref>; <xref ref-type="bibr" rid="bib45">Ling et al., 2020</xref>; <xref ref-type="bibr" rid="bib53">Nip et al., 2020</xref>; <xref ref-type="bibr" rid="bib79">Welch et al., 2016</xref>), or only do so in a specialized manner (<xref ref-type="bibr" rid="bib50">Matsumoto et al., 2020</xref>), reducing their potential impacts. Finally, methods’ different approaches to quantification are affected by coverage biases to varying degrees. Some methods may thus lead to erroneous inference of cell clusters due to technical rather than biological variation. Until the prevalence and severity of coverage biases are better understood, we advocate quantifying transcript variation in a robust manner.</p><p>Recent and future experimental advances will catalyze the study of isoform variation in single cells. For instance, Smart-seq3 (<xref ref-type="bibr" rid="bib27">Hagemann-Jensen et al., 2020</xref>) allows sequencing of short reads from the entire length of a gene together with unique molecular identifiers, improving mRNA capture and allowing for the filtering of PCR duplicates; however, experiments show that less than 40% of reads can be unambiguously assigned to a single (annotated) isoform. Ultimately, long-read scRNA-seq will provide the definitive picture of isoform variation between cells. Until then, there is much biology to be studied using short-read protocols, and variation at the transcript level should not be disregarded.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Datasets</title><p><italic>Tabula Muris</italic> data (<xref ref-type="bibr" rid="bib61">Schaum et al., 2018</xref>) have accession code GSE109774. Cells were filtered to those from 3-month-old mice present in this collection: <ext-link ext-link-type="uri" xlink:href="https://czb-tabula-muris-senis.s3-us-west-2.amazonaws.com/Data-objects/tabula-muris-senis-facs-processed-official-annotations.h5ad">https://czb-tabula-muris-senis.s3-us-west-2.amazonaws.com/Data-objects/tabula-muris-senis-facs-processed-official-annotations.h5ad</ext-link> (filtering details in <xref ref-type="bibr" rid="bib68">Tabula Muris Consortium, 2020</xref>). <italic>BICCN Cortex</italic> data (<xref ref-type="bibr" rid="bib84">Yao et al., 2021</xref>) were downloaded from <ext-link ext-link-type="uri" xlink:href="https://assets.nemoarchive.org/dat-ch1nqb7">https://assets.nemoarchive.org/dat-ch1nqb7</ext-link> and filtered as in <xref ref-type="bibr" rid="bib11">Booeshaghi et al., 2021</xref>.</p></sec><sec id="s4-2"><title>Simulation</title><p>A preliminary set of exon skipping events was obtained by running briekit-event from the BRIE2 software package. For each event, one pair of transcripts was selected if they only differed on the skipped exon, resulting in 561 pairs, each from a different gene. Reads were simulated using Polyester (<xref ref-type="bibr" rid="bib20">Frazee et al., 2015</xref>), which allows us to control overdispersion and induce different kinds of biases. For roughly half of the genes, differential transcript usage (DTU) was induced by overexpressing one transcript 1.5-fold in one of the two conditions. The number of reads was generated using a highly overdispersed negative binomial distribution with variance equal to eight times the mean. To simulate coverage decay in one of the conditions, the option bias=&quot;cdnaf&quot; was added. To ensure coverage decays as a function of absolute distance to the 3’ end of the transcript, reads were generated no farther away from the 3’ than the minimum of the lengths of the two alternative transcripts. The Area Under the Receiver Operating Characteristic Curve (ROC AUC) for classifying genes into DTU vs. non-DTU was computed using the p-values from each method, excluding genes that were not tested by a given method (e.g., because of a minimum reads threshold).</p></sec><sec id="s4-3"><title>Quantification</title><p>The bioinformatic pipeline was implemented using Snakemake (<xref ref-type="bibr" rid="bib37">Köster and Rahmann, 2012</xref>). Raw reads were trimmed from Smart-seq2 adapters using Cutadapt (<xref ref-type="bibr" rid="bib49">Martin, 2011</xref>) before mapping to the GRCm38/mm10 genome reference (<ext-link ext-link-type="uri" xlink:href="https://hgdownload.soe.ucsc.edu/goldenPath/mm10/chromosomes/">https://hgdownload.soe.ucsc.edu/goldenPath/mm10/chromosomes/</ext-link>) and the transcriptome reference from Ensembl release 101 (<ext-link ext-link-type="uri" xlink:href="ftp://ftp.ensembl.org/pub/release-101/gtf/mus_musculus/Mus_musculus.GRCm38.101.gtf.gz">ftp://ftp.ensembl.org/pub/release-101/gtf/mus_musculus/Mus_musculus.GRCm38.101.gtf.gz</ext-link>). Alignment was done using STAR (<xref ref-type="bibr" rid="bib17">Dobin et al., 2013</xref>) in two-pass mode allowing novel junctions as long as they were supported by reads with at least 20 base pair overhang (30 if they are non-canonical) in at least 30 cells. Also, multimapping and duplicate reads were discarded using the flag <named-content content-type="sequence"><monospace>--bamRemoveDuplicatesType UniqueIdentical</monospace></named-content> (while this can remove duplicates from the second PCR step of Smart-seq, it will not remove duplicates from the first PCR step). Soft-clipped reads were removed as well. Additionally, reads were discarded if they belonged to the ENCODE region blacklist (<xref ref-type="bibr" rid="bib1">Amemiya et al., 2019</xref>) (downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/Boyle-Lab/Blacklist/raw/master/lists/mm10-blacklist.v2.bed.gz">https://github.com/Boyle-Lab/Blacklist/raw/master/lists/mm10-blacklist.v2.bed.gz</ext-link>).</p><p>Gene expression was quantified using featureCounts (<xref ref-type="bibr" rid="bib44">Liao et al., 2014</xref>), and total-count normalized such that each cell had 10,000 reads (as in the Scanpy (<xref ref-type="bibr" rid="bib82">Wolf et al., 2018</xref>) tutorial). Intron usage was quantified using split reads with an overhang of at least six base pairs. Introns were discarded if observed in fewer than 30 cells in <italic>BICCN Cortex</italic> or 100 cells in <italic>Tabula Muris</italic>. Introns were grouped into alternative intron groups based on shared 3’ splice acceptor sites. Introns not belonging to any alternative intron group were discarded. Additionally, we decided to subset our analysis to introns with at least one of their donor or acceptor sites annotated, so we could assign a gene to each intron and facilitate interpretation for our specific analyses.</p></sec><sec id="s4-4"><title>Dimensionality reduction</title><p>To run PCA, we worked with alternative intron proportions (PSI, Percent Spliced In) rather than their absolute counts, as the latter would be confounded by gene expression differences. We first introduce some notation:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf2"><mml:mi>c</mml:mi></mml:math></inline-formula>: cell identifier</p></list-item><list-item><p><inline-formula><mml:math id="inf3"><mml:mi>g</mml:mi></mml:math></inline-formula>: intron group identifier</p></list-item><list-item><p><inline-formula><mml:math id="inf4"><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>: vector of counts of introns in intron group <inline-formula><mml:math id="inf5"><mml:mi>g</mml:mi></mml:math></inline-formula> and cell <inline-formula><mml:math id="inf6"><mml:mi>c</mml:mi></mml:math></inline-formula></p></list-item><list-item><p><inline-formula><mml:math id="inf7"><mml:mrow><mml:mrow><mml:mi>normalize</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>: function to divide each entry of a vector by the total sum.</p></list-item></list><p>Then, PSI can be defined as:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mover><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>normalize</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>However, given the sparsity of single-cell data, a very high proportion of alternative intron groups will have no reads in a given cell, leaving PSI undefined. More generally, an intron group may contain few reads, resulting in defined but noisy PSI estimates. To navigate this issue, we introduce a form of empirical shrinkage towards a central value. We first define the ‘global PSI’ by aggregating reads from all cells and normalizing. Then, we add this global PSI as a pseudocount vector to each cell before re-normalizing to obtain each cell’s shrunken PSI profile (these are non-uniform pseudocounts adding up to one).<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mover><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi>normalize</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mover><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">_</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi>normalize</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mover><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We then run standard PCA on the cell-by-intron-smoothed PSI matrix.</p><p>The VAE was implemented using PyTorch (<xref ref-type="bibr" rid="bib56">Paszke et al., 2019</xref>) and scvi-tools (<xref ref-type="bibr" rid="bib24">Gayoso et al., 2021</xref>). The following is the generative model, repeated for each cell (we drop the superscript indexing the cell in <inline-formula><mml:math id="inf8"><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="inf9"><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="inf10"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf11"><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>):</p><list list-type="order"><list-item><p>Sample the latent cell state <inline-formula><mml:math id="inf12"><mml:mrow><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:mi>Normal</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>For each intron group <inline-formula><mml:math id="inf13"><mml:mi>g</mml:mi></mml:math></inline-formula>:</p><list list-type="alpha-lower"><list-item><p>Obtain the underlying intron proportions: <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>softmax</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>Sample the intron counts conditioning on the total observed <italic>n</italic><sub><italic>g</italic></sub>: <inline-formula><mml:math id="inf15"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi>DirichletMultinomial</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></p></list-item></list></list-item></list><p>Here <italic>f</italic><sub><italic>g</italic></sub>, known as the decoder, can be any differentiable function, including linear mappings and neural networks. <inline-formula><mml:math id="inf16"><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> is a scalar controlling the amount of dispersion. We optimize a variational posterior on cell latent variables <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (Gaussian with diagonal covariance, given by an encoder neural network) as well as point estimates of global parameters <italic>f</italic><sub><italic>g</italic></sub>, <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula>. The encoder takes as input the smoothed PSI values, as in PCA, but the likelihood is based on the raw intron counts. The objective to maximize is the evidence lower bound (ELBO), consisting of a reconstruction term and a regularization term:<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>∼</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:mtext>KL</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where KL <inline-formula><mml:math id="inf19"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo>∥</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the Kullback–Leibler divergence. Optimization is performed using Adam (<xref ref-type="bibr" rid="bib36">Kingma and Ba, 2015</xref>), a stochastic gradient descent method. To avoid overfitting in cases of relatively few cells with respect to the number of features, we considered a linear decoder (<xref ref-type="bibr" rid="bib67">Svensson et al., 2020</xref>), as well as a <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>Normal</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> prior on the entries of the decoder matrix. Hyperparameters were tuned using reconstruction error on held-out data and are described in <xref ref-type="table" rid="table3">Table 3</xref>.</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>VAE hyperparameters.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom">Dataset</th><th valign="bottom">Decoder</th><th valign="bottom">Layers</th><th valign="bottom"><inline-formula><mml:math id="inf21"><mml:mi>σ</mml:mi></mml:math></inline-formula></th><th valign="bottom">Latent dimension</th></tr></thead><tbody><tr><td align="left" valign="bottom">BICCN Cortex</td><td align="left" valign="bottom">Linear</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">26.8</td><td align="char" char="." valign="bottom">18</td></tr><tr><td align="left" valign="bottom">Tabula Muris</td><td align="left" valign="bottom">Non-linear</td><td align="char" char="." valign="bottom">2</td><td align="left" valign="bottom">-</td><td align="char" char="." valign="bottom">34</td></tr></tbody></table></table-wrap></sec><sec id="s4-5"><title>Differential splicing test</title><p>Our differential splicing test across conditions (such as cell types) is based on a modified version of the Dirichlet-Multinomial Generalized Linear Model proposed in LeafCutter (<xref ref-type="bibr" rid="bib43">Li et al., 2018</xref>) for bulk RNA-seq. For each intron group <inline-formula><mml:math id="inf22"><mml:mi>g</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf23"><mml:mi>L</mml:mi></mml:math></inline-formula> alternative introns:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf24"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> is a vector of counts for each of the <inline-formula><mml:math id="inf25"><mml:mi>L</mml:mi></mml:math></inline-formula> introns;</p></list-item><list-item><p>The independent variable, <inline-formula><mml:math id="inf26"><mml:mi>x</mml:mi></mml:math></inline-formula>, equals 0 in one condition and 1 in the other;</p></list-item><list-item><p><inline-formula><mml:math id="inf27"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are the intercept and coefficients of the linear model;</p></list-item><list-item><p><inline-formula><mml:math id="inf28"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>ℝ</mml:mi></mml:mrow></mml:math></inline-formula> is a dispersion parameter shared across conditions; and</p></list-item><list-item><p>the function <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>softmax</mml:mi><mml:mo>:</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>↦</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> maps from <inline-formula><mml:math id="inf30"><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> to the <inline-formula><mml:math id="inf31"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>-dimensional probability simplex.</p></list-item></list><p>The Dirichlet-Multinomial Generalized Linear Model then proceeds as follows:</p><list list-type="order"><list-item><p>Obtain the underlying intron proportions: <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>softmax</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>Sample the intron counts conditioned on the total observed, <italic>n</italic><sub><italic>g</italic></sub>: <inline-formula><mml:math id="inf33"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi>DirichletMultinomial</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></p></list-item></list><p>We implemented this model in PyTorch and optimized it using L-BFGS (<xref ref-type="bibr" rid="bib46">Liu and Nocedal, 1989</xref>).</p><p>To test for differential splicing across the two conditions, we compare the following two hypotheses:</p><list list-type="simple"><list-item><p>Null hypothesis <italic>H</italic><sub>0</sub>:<inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mn>0</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item><list-item><p>Alternative hypothesis <italic>H</italic><sub>1</sub>:<inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mrow><mml:mover><mml:mn>0</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item></list><p>We use the likelihood-ratio test, the test statistic for which is asymptotically distributed as a <inline-formula><mml:math id="inf36"><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> random variable with <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> degrees of freedom under <italic>H</italic><sub>0</sub>. Finally, we correct p-values for multiple testing using the Benjamini-Hochberg FDR procedure (<xref ref-type="bibr" rid="bib9">Benjamini and Hochberg, 1995</xref>).</p><p>The differences with LeafCutter are the following:</p><list list-type="bullet"><list-item><p>LeafCutter groups introns that share a 5’ donor or 3’ acceptor site while scQuint groups introns that share a 3’ acceptor site.</p></list-item><list-item><p>LeafCutter has a vector of concentration parameters, one for each intron, while scQuint uses a single concentration parameter per intron group.</p></list-item><list-item><p>The LeafCutter and scQuint optimization procedures were implemented separately and differ in initialization strategies as well as L-BFGS hyperparameters.</p></list-item></list></sec><sec id="s4-6"><title>Latent space analysis</title><p>The expression latent space was obtained by running PCA with 40 components on log-transformed and normalized gene expression values. The splicing latent space was obtained by running the VAE on the alternative intron count matrix (or equivalent features, e.g., Kallisto transcript counts, DEXSeq exon counts). Both latent spaces were visualized using UMAP (<xref ref-type="bibr" rid="bib51">McInnes et al., 2018</xref>). In the comparison of <xref ref-type="fig" rid="fig1">Figure 1</xref>, we used our own implementation of the quantifications proposed by ODEGR-NMF, DEXSeq, and DESJ for ease of application to large single-cell datasets.</p><p>Dendrograms were constructed using hierarchical clustering (R function hclust) based on euclidean distance between the median latent space embedding of cells of each type. Tanglegram and entanglement were calculated using the dendextend R package, with the step2side method, as also described in <xref ref-type="bibr" rid="bib61">Schaum et al., 2018</xref>.</p><p>Reported scores for cell type classification within a tissue were obtained by running a binary logistic regression classifier over different splits of cells into train and test sets. To assess generalization across individuals, we ensured the same individual was not present in both train and test sets.</p></sec><sec id="s4-7"><title>Cell-type-specific differential splicing</title><p>For differential splicing testing between a given cell type and the rest of the tissue, we only considered introns expressed in at least 50 cells and intron groups with at least 50 cells from both of the conditions. We called an intron group ‘differentially spliced’ if it was both statistically significant using a 5% FDR and if it contained an intron with a PSI change greater than 0.05. We considered a differentially spliced intron group as unannotated if it contained an unannotated intron with a PSI change greater than 0.05. Differential expression was performed using the Mann-Whitney test. A gene was considered differentially expressed if it was statistically significant using a 5% FDR and if the fold change was at least 1.5.</p><p>For selection of marker genes or introns, we proceeded in a semi-automated fashion. For each cell type, we first filtered to keep only significant genes or introns and then ranked them by effect size. We picked a certain number of genes or introns from the top of this list for each cell type, while ensuring there were no repetitions.</p></sec><sec id="s4-8"><title>Splicing factor regression analysis</title><p>We obtained 75 mouse splicing factors using the Gene Ontology term ‘alternative mRNA splicing, via spliceosome’ (<ext-link ext-link-type="uri" xlink:href="http://amigo.geneontology.org/amigo/term/GO">http://amigo.geneontology.org/amigo/term/GO</ext-link>:0000380). A skipped exon annotation, processed by BRIE (<xref ref-type="bibr" rid="bib31">Huang and Sanguinetti, 2017</xref>), was downloaded from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/brie-rna/files/annotation/mouse/gencode.vM12/SE.most.gff3/download">https://sourceforge.net/projects/brie-rna/files/annotation/mouse/gencode.vM12/SE.most.gff3/download</ext-link>. Instead of using single cells as replicates, we partitioned the BICCN primary motor cortex dataset into roughly 200 clusters of 30 cells each that were pooled to create pseudobulks, aiming to reduce variance in the expression and splicing of splicing factors used as covariates in the model. We filtered target exon skipping events to those defined in at least 95% of the replicates, and those having a PSI standard deviation of at least 0.2. We used log-transformed normalized expression and PSI of alternative splicing events as input features. We chose to keep the PSI of only one intron per intron group to avoid the presence of highly correlated features and improve clarity, even if some information from non-binary events is lost. Input features were filtered to those having standard deviation of at least 0.05, and then standardized. A lasso Dirichlet-Multinomial GLM was fit to the data (in this instance, the model reduces to a Beta-Binomial because skipped exons are binary events), with the sparsity penalty selected via cross-validation. As a first approach, we fit a regular lasso linear regression model on PSI instead of raw counts, resulting in roughly similar patterns in the coefficients. <xref ref-type="fig" rid="fig11">Figure 11c</xref> shows the coefficients of the lasso Dirichlet-Multinomial model for the top 30 targets with the highest variance explained by the regular lasso model, all above 68%.</p></sec><sec id="s4-9"><title>Code and data availability</title><p>scQuint is implemented in Python and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/songlab-cal/scquint">https://github.com/songlab-cal/scquint</ext-link>, (<xref ref-type="bibr" rid="bib7">Benegas, 2021b</xref> copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:e94c3f55c512acb3216e2e83dbc35cae75aa8ddb;origin=https://github.com/songlab-cal/scquint;visit=swh:1:snp:4680be565cc000bc06e30fb468919a9f1de9180a;anchor=swh:1:rev:a9db6454e13d42af25f47deee19e201e74d2bdd0">swh:1:rev:a9db6454e13d42af25f47deee19e201e74d2bdd0</ext-link>). Differential splicing results and access to cell and genome browsers, together with the code to reproduce our results, are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/songlab-cal/scquint-analysis">https://github.com/songlab-cal/scquint-analysis</ext-link>, (<xref ref-type="bibr" rid="bib8">Benegas, 2021c</xref> copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:76b0f21fb892d9f0aee2da2dc71d887513443966;origin=https://github.com/songlab-cal/scquint-analysis;visit=swh:1:snp:c040f4511378d09901aa51c8e0d2bd3a2e5a72f7;anchor=swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87">swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87</ext-link>). Processed alternative intron count matrices are provided in the AnnData format (<ext-link ext-link-type="uri" xlink:href="https://anndata.readthedocs.io/en/latest/">anndata.readthedocs.io</ext-link><ext-link ext-link-type="uri" xlink:href="https://anndata.readthedocs.io/en/latest/">anndata.readthedocs.io</ext-link>) for easy manipulation with Scanpy (<xref ref-type="bibr" rid="bib82">Wolf et al., 2018</xref>), Seurat (<xref ref-type="bibr" rid="bib66">Stuart et al., 2019</xref>), and other tools.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Investigation, Methodology, Software, Visualization, Writing - original draft</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Investigation, Supervision, Writing - original draft</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Funding acquisition, Investigation, Supervision, Writing – review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-73520-transrepform1-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data analyzed in this study are publicly available and URL links are provided in the Materials and methods section of our manuscript. Our source code as well as all results represented in figures and tables are publicly available on our lab's GitHub repositories: <ext-link ext-link-type="uri" xlink:href="https://github.com/songlab-cal/scquint">https://github.com/songlab-cal/scquint</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:e94c3f55c512acb3216e2e83dbc35cae75aa8ddb;origin=https://github.com/songlab-cal/scquint;visit=swh:1:snp:4680be565cc000bc06e30fb468919a9f1de9180a;anchor=swh:1:rev:a9db6454e13d42af25f47deee19e201e74d2bdd0">swh:1:rev:a9db6454e13d42af25f47deee19e201e74d2bdd0</ext-link>) and <ext-link ext-link-type="uri" xlink:href="https://github.com/songlab-cal/scquint-analysis">https://github.com/songlab-cal/scquint-analysis</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:76b0f21fb892d9f0aee2da2dc71d887513443966;origin=https://github.com/songlab-cal/scquint-analysis;visit=swh:1:snp:c040f4511378d09901aa51c8e0d2bd3a2e5a72f7;anchor=swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87">swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87</ext-link>).</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><collab>Schaum et al</collab></person-group><year iso-8601-date="2018">2018</year><data-title>Tabula Muris</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE109774">GSE109774</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><collab>Yao et al</collab></person-group><year iso-8601-date="2021">2021</year><data-title>BRAIN Initiative Cell Census Network Cortex</data-title><source>nemoarchive</source><pub-id pub-id-type="accession" xlink:href="https://assets.nemoarchive.org/dat-ch1nqb7">dat-ch1nqb7</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We would like to thank Angela Oliveira Pisco, Spyros Darmanis, and Kif Liakath-Ali for helpful discussions. We also thank the Chan Zuckerberg Biohub for hosting our cell×gene sessions and Aaron McGeever for assistance. This research is supported in part by grant number R35-GM134922 from NIH and grant number CZF2019-002449 from the Chan Zuckerberg Initiative Foundation. YSS is a Chan Zuckerberg Biohub Investigator.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amemiya</surname><given-names>HM</given-names></name><name><surname>Kundaje</surname><given-names>A</given-names></name><name><surname>Boyle</surname><given-names>AP</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The ENCODE Blacklist: identification of problematic regions of the genome</article-title><source>Scientific Reports</source><volume>9</volume><fpage>1</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1038/s41598-019-45839-z</pub-id><pub-id pub-id-type="pmid">31249361</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Reyes</surname><given-names>A</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Detecting differential usage of exons from RNA-seq data</article-title><source>Genome Research</source><volume>22</volume><fpage>2008</fpage><lpage>2017</lpage><pub-id pub-id-type="doi">10.1101/gr.133744.111</pub-id><pub-id pub-id-type="pmid">22722343</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arzalluz-Luque</surname><given-names>Á</given-names></name><name><surname>Conesa</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Single-cell RNAseq for the study of isoforms-how is that possible?</article-title><source>Genome Biology</source><volume>19</volume><elocation-id>1496</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-018-1496-z</pub-id><pub-id pub-id-type="pmid">30097058</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asipu</surname><given-names>A</given-names></name><name><surname>Hayward</surname><given-names>BE</given-names></name><name><surname>O’Reilly</surname><given-names>J</given-names></name><name><surname>Bonthron</surname><given-names>DT</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Properties of normal and mutant recombinant human ketohexokinases and implications for the pathogenesis of essential fructosuria</article-title><source>Diabetes</source><volume>52</volume><fpage>2426</fpage><lpage>2432</lpage><pub-id pub-id-type="doi">10.2337/diabetes.52.9.2426</pub-id><pub-id pub-id-type="pmid">12941785</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bas-Orth</surname><given-names>C</given-names></name><name><surname>Tan</surname><given-names>YW</given-names></name><name><surname>Oliveira</surname><given-names>AMM</given-names></name><name><surname>Bengtson</surname><given-names>CP</given-names></name><name><surname>Bading</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The calmodulin-binding transcription activator CAMTA1 is required for long-term memory formation in mice</article-title><source>Learning &amp; Memory (Cold Spring Harbor, N.Y.)</source><volume>23</volume><fpage>313</fpage><lpage>321</lpage><pub-id pub-id-type="doi">10.1101/lm.041111.115</pub-id><pub-id pub-id-type="pmid">27194798</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Benegas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021a</year><data-title>Alternative splicing analysis of scRNA-seq datasets with scQuint</data-title><version designator="swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87">swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87</version><publisher-name>Software Heritage</publisher-name><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:76b0f21fb892d9f0aee2da2dc71d887513443966;origin=https://github.com/songlab-cal/scquint-analysis;visit=swh:1:snp:c040f4511378d09901aa51c8e0d2bd3a2e5a72f7;anchor=swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87">https://archive.softwareheritage.org/swh:1:dir:76b0f21fb892d9f0aee2da2dc71d887513443966;origin=https://github.com/songlab-cal/scquint-analysis;visit=swh:1:snp:c040f4511378d09901aa51c8e0d2bd3a2e5a72f7;anchor=swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87</ext-link></element-citation></ref><ref id="bib7"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Benegas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021b</year><data-title>scQuint (single-cell quantification of introns) Installation</data-title><version designator="swh:1:rev:a9db6454e13d42af25f47deee19e201e74d2bdd0">swh:1:rev:a9db6454e13d42af25f47deee19e201e74d2bdd0</version><publisher-name>Software Heritage</publisher-name><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:e94c3f55c512acb3216e2e83dbc35cae75aa8ddb;origin=https://github.com/songlab-cal/scquint;visit=swh:1:snp:4680be565cc000bc06e30fb468919a9f1de9180a;anchor=swh:1:rev:a9db6454e13d42af25f47deee19e201e74d2bdd0">https://archive.softwareheritage.org/swh:1:dir:e94c3f55c512acb3216e2e83dbc35cae75aa8ddb;origin=https://github.com/songlab-cal/scquint;visit=swh:1:snp:4680be565cc000bc06e30fb468919a9f1de9180a;anchor=swh:1:rev:a9db6454e13d42af25f47deee19e201e74d2bdd0</ext-link></element-citation></ref><ref id="bib8"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Benegas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021c</year><data-title>Alternative splicing analysis of scRNA-seq datasets with scQuint</data-title><version designator="swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87">swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87</version><publisher-name>Software Heritage</publisher-name><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:76b0f21fb892d9f0aee2da2dc71d887513443966;origin=https://github.com/songlab-cal/scquint-analysis;visit=swh:1:snp:c040f4511378d09901aa51c8e0d2bd3a2e5a72f7;anchor=swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87">https://archive.softwareheritage.org/swh:1:dir:76b0f21fb892d9f0aee2da2dc71d887513443966;origin=https://github.com/songlab-cal/scquint-analysis;visit=swh:1:snp:c040f4511378d09901aa51c8e0d2bd3a2e5a72f7;anchor=swh:1:rev:97dc31babf2a585666af4a38b1e4aa59a92bbf87</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title><source>Journal of the Royal Statistical Society</source><volume>57</volume><fpage>289</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1111/j.2517-6161.1995.tb02031.x</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergen</surname><given-names>V</given-names></name><name><surname>Lange</surname><given-names>M</given-names></name><name><surname>Peidli</surname><given-names>S</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Generalizing RNA velocity to transient cell states through dynamical modeling</article-title><source>Nature Biotechnology</source><volume>38</volume><fpage>1408</fpage><lpage>1414</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-0591-3</pub-id><pub-id pub-id-type="pmid">32747759</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Booeshaghi</surname><given-names>AS</given-names></name><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>van Velthoven</surname><given-names>C</given-names></name><name><surname>Smith</surname><given-names>K</given-names></name><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Isoform cell-type specificity in the mouse primary motor cortex</article-title><source>Nature</source><volume>598</volume><fpage>195</fpage><lpage>199</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03969-3</pub-id><pub-id pub-id-type="pmid">34616073</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bossen</surname><given-names>C</given-names></name><name><surname>Murre</surname><given-names>CS</given-names></name><name><surname>Chang</surname><given-names>AN</given-names></name><name><surname>Mansson</surname><given-names>R</given-names></name><name><surname>Rodewald</surname><given-names>HR</given-names></name><name><surname>Murre</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The chromatin remodeler Brg1 activates enhancer repertoires to establish B cell identity and modulate cell growth</article-title><source>Nature Immunology</source><volume>16</volume><fpage>775</fpage><lpage>784</lpage><pub-id pub-id-type="doi">10.1038/ni.3170</pub-id><pub-id pub-id-type="pmid">25985234</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bray</surname><given-names>NL</given-names></name><name><surname>Pimentel</surname><given-names>H</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Near-optimal probabilistic RNA-seq quantification</article-title><source>Nature Biotechnology</source><volume>34</volume><fpage>525</fpage><lpage>527</lpage><pub-id pub-id-type="doi">10.1038/nbt.3519</pub-id><pub-id pub-id-type="pmid">27043002</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buen Abad Najar</surname><given-names>CF</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name><name><surname>Lareau</surname><given-names>LF</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Coverage-dependent bias creates the appearance of binary splicing in single cells</article-title><source>eLife</source><volume>9</volume><elocation-id>e54603</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.54603</pub-id><pub-id pub-id-type="pmid">32597758</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Byrne</surname><given-names>A</given-names></name><name><surname>Beaudin</surname><given-names>AE</given-names></name><name><surname>Olsen</surname><given-names>HE</given-names></name><name><surname>Jain</surname><given-names>M</given-names></name><name><surname>Cole</surname><given-names>C</given-names></name><name><surname>Palmer</surname><given-names>T</given-names></name><name><surname>DuBois</surname><given-names>RM</given-names></name><name><surname>Forsberg</surname><given-names>EC</given-names></name><name><surname>Akeson</surname><given-names>M</given-names></name><name><surname>Vollmers</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Nanopore long-read RNAseq reveals widespread transcriptional variation among the surface receptors of individual B cells</article-title><source>Nature Communications</source><volume>8</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1038/ncomms16027</pub-id><pub-id pub-id-type="pmid">28722025</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cornall</surname><given-names>RJ</given-names></name><name><surname>Cheng</surname><given-names>AM</given-names></name><name><surname>Pawson</surname><given-names>T</given-names></name><name><surname>Goodnow</surname><given-names>CC</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Role of Syk in B-cell development and antigen-receptor signaling</article-title><source>PNAS</source><volume>97</volume><fpage>1713</fpage><lpage>1718</lpage><pub-id pub-id-type="doi">10.1073/pnas.97.4.1713</pub-id><pub-id pub-id-type="pmid">10677523</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dobin</surname><given-names>A</given-names></name><name><surname>Davis</surname><given-names>CA</given-names></name><name><surname>Schlesinger</surname><given-names>F</given-names></name><name><surname>Drenkow</surname><given-names>J</given-names></name><name><surname>Zaleski</surname><given-names>C</given-names></name><name><surname>Jha</surname><given-names>S</given-names></name><name><surname>Batut</surname><given-names>P</given-names></name><name><surname>Chaisson</surname><given-names>M</given-names></name><name><surname>Gingeras</surname><given-names>TR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>STAR: ultrafast universal RNA-seq aligner</article-title><source>Bioinformatics (Oxford, England)</source><volume>29</volume><fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id><pub-id pub-id-type="pmid">23104886</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>H</given-names></name><name><surname>Moakley</surname><given-names>DF</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>McKenzie</surname><given-names>MG</given-names></name><name><surname>Menon</surname><given-names>V</given-names></name><name><surname>Zhang</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Complexity and graded regulation of neuronal cell-type-specific alternative splicing revealed by single-cell RNA sequencing</article-title><source>PNAS</source><volume>118</volume><elocation-id>e2013056118</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2013056118</pub-id><pub-id pub-id-type="pmid">33674385</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feracci</surname><given-names>M</given-names></name><name><surname>Foot</surname><given-names>JN</given-names></name><name><surname>Grellscheid</surname><given-names>SN</given-names></name><name><surname>Danilenko</surname><given-names>M</given-names></name><name><surname>Stehle</surname><given-names>R</given-names></name><name><surname>Gonchar</surname><given-names>O</given-names></name><name><surname>Kang</surname><given-names>H-S</given-names></name><name><surname>Dalgliesh</surname><given-names>C</given-names></name><name><surname>Meyer</surname><given-names>NH</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Lahat</surname><given-names>A</given-names></name><name><surname>Sattler</surname><given-names>M</given-names></name><name><surname>Eperon</surname><given-names>IC</given-names></name><name><surname>Elliott</surname><given-names>DJ</given-names></name><name><surname>Dominguez</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Structural basis of RNA recognition and dimerization by the STAR proteins T-STAR and Sam68</article-title><source>Nature Communications</source><volume>7</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1038/ncomms10355</pub-id><pub-id pub-id-type="pmid">26758068</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frazee</surname><given-names>AC</given-names></name><name><surname>Jaffe</surname><given-names>AE</given-names></name><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Leek</surname><given-names>JT</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Polyester: simulating RNA-seq datasets with differential transcript expression</article-title><source>Bioinformatics (Oxford, England)</source><volume>31</volume><fpage>2778</fpage><lpage>2784</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv272</pub-id><pub-id pub-id-type="pmid">25926345</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuccillo</surname><given-names>MV</given-names></name><name><surname>Földy</surname><given-names>C</given-names></name><name><surname>Gökce</surname><given-names>Ö</given-names></name><name><surname>Rothwell</surname><given-names>PE</given-names></name><name><surname>Sun</surname><given-names>GL</given-names></name><name><surname>Malenka</surname><given-names>RC</given-names></name><name><surname>Südhof</surname><given-names>TC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Single-Cell mRNA profiling reveals cell-type-specific expression of neurexin isoforms</article-title><source>Neuron</source><volume>87</volume><fpage>326</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.06.028</pub-id><pub-id pub-id-type="pmid">26182417</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>García-Serna</surname><given-names>AM</given-names></name><name><surname>Alcaraz-García</surname><given-names>MJ</given-names></name><name><surname>Ruiz-Lafuente</surname><given-names>N</given-names></name><name><surname>Sebastián-Ruiz</surname><given-names>S</given-names></name><name><surname>Martínez</surname><given-names>CM</given-names></name><name><surname>Moya-Quiles</surname><given-names>MR</given-names></name><name><surname>Minguela</surname><given-names>A</given-names></name><name><surname>García-Alonso</surname><given-names>AM</given-names></name><name><surname>Martín-Orozco</surname><given-names>E</given-names></name><name><surname>Parrado</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Dock10 regulates CD23 expression and sustains B-cell lymphopoiesis in secondary lymphoid tissue</article-title><source>Immunobiology</source><volume>221</volume><fpage>1343</fpage><lpage>1350</lpage><pub-id pub-id-type="doi">10.1016/j.imbio.2016.07.015</pub-id><pub-id pub-id-type="pmid">27502165</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garrido-Martín</surname><given-names>D</given-names></name><name><surname>Palumbo</surname><given-names>E</given-names></name><name><surname>Guigó</surname><given-names>R</given-names></name><name><surname>Breschi</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>ggsashimi: Sashimi plot revised for browser- and annotation-independent splicing visualization</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006360</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006360</pub-id><pub-id pub-id-type="pmid">30118475</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Gayoso</surname><given-names>A</given-names></name><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Xing</surname><given-names>G</given-names></name><name><surname>Boyeau</surname><given-names>P</given-names></name><name><surname>Wu</surname><given-names>K</given-names></name><name><surname>Jayasuriya</surname><given-names>M</given-names></name><name><surname>Melhman</surname><given-names>E</given-names></name><name><surname>Langevin</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Samaran</surname><given-names>J</given-names></name><name><surname>Misrachi</surname><given-names>G</given-names></name><name><surname>Nazaret</surname><given-names>A</given-names></name><name><surname>Clivio</surname><given-names>O</given-names></name><name><surname>Xu</surname><given-names>C</given-names></name><name><surname>Ashuach</surname><given-names>T</given-names></name><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Svensson</surname><given-names>V</given-names></name><name><surname>Beltrame</surname><given-names>E</given-names></name><name><surname>Talavera-López</surname><given-names>C</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><name><surname>Streets</surname><given-names>A</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name><name><surname>Regier</surname><given-names>J</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Scvi-Tools: A Library for Deep Probabilistic Analysis of Single-Cell Omics Data</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.04.28.441833</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>González-Tajuelo</surname><given-names>R</given-names></name><name><surname>González-Sánchez</surname><given-names>E</given-names></name><name><surname>Silván</surname><given-names>J</given-names></name><name><surname>Muñoz-Callejas</surname><given-names>A</given-names></name><name><surname>Vicente-Rabaneda</surname><given-names>E</given-names></name><name><surname>García-Pérez</surname><given-names>J</given-names></name><name><surname>Castañeda</surname><given-names>S</given-names></name><name><surname>Urzainqui</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Relevance of PSGL-1 expression in B cell development and activation</article-title><source>Frontiers in Immunology</source><volume>11</volume><elocation-id>588212</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2020.588212</pub-id><pub-id pub-id-type="pmid">33281818</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>I</given-names></name><name><surname>Collier</surname><given-names>PG</given-names></name><name><surname>Haase</surname><given-names>B</given-names></name><name><surname>Mahfouz</surname><given-names>A</given-names></name><name><surname>Joglekar</surname><given-names>A</given-names></name><name><surname>Floyd</surname><given-names>T</given-names></name><name><surname>Koopmans</surname><given-names>F</given-names></name><name><surname>Barres</surname><given-names>B</given-names></name><name><surname>Smit</surname><given-names>AB</given-names></name><name><surname>Sloan</surname><given-names>SA</given-names></name><name><surname>Luo</surname><given-names>W</given-names></name><name><surname>Fedrigo</surname><given-names>O</given-names></name><name><surname>Ross</surname><given-names>ME</given-names></name><name><surname>Tilgner</surname><given-names>HU</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Single-cell isoform RNA sequencing characterizes isoforms in thousands of cerebellar cells</article-title><source>Nature Biotechnology</source><volume>36</volume><fpage>1197</fpage><lpage>1202</lpage><pub-id pub-id-type="doi">10.1038/nbt.4259</pub-id><pub-id pub-id-type="pmid">30320766</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hagemann-Jensen</surname><given-names>M</given-names></name><name><surname>Ziegenhain</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>P</given-names></name><name><surname>Ramsköld</surname><given-names>D</given-names></name><name><surname>Hendriks</surname><given-names>G-J</given-names></name><name><surname>Larsson</surname><given-names>AJM</given-names></name><name><surname>Faridani</surname><given-names>OR</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Single-cell RNA counting at allele and isoform resolution using Smart-seq3</article-title><source>Nature Biotechnology</source><volume>38</volume><fpage>708</fpage><lpage>714</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-0497-0</pub-id><pub-id pub-id-type="pmid">32518404</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hayward</surname><given-names>BE</given-names></name><name><surname>Bonthron</surname><given-names>DT</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Structure and alternative splicing of the ketohexokinase gene</article-title><source>European Journal of Biochemistry</source><volume>257</volume><fpage>85</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1046/j.1432-1327.1998.2570085.x</pub-id><pub-id pub-id-type="pmid">9799106</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Borde</surname><given-names>M</given-names></name><name><surname>Nardone</surname><given-names>J</given-names></name><name><surname>Maika</surname><given-names>S</given-names></name><name><surname>Allred</surname><given-names>L</given-names></name><name><surname>Tucker</surname><given-names>PW</given-names></name><name><surname>Rao</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Foxp1 is an essential transcriptional regulator of B cell development</article-title><source>Nature Immunology</source><volume>7</volume><fpage>819</fpage><lpage>826</lpage><pub-id pub-id-type="doi">10.1038/ni1358</pub-id><pub-id pub-id-type="pmid">16819554</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Detecting differential alternative splicing events in scRNA-seq with or without Unique Molecular Identifiers</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1007925</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007925</pub-id><pub-id pub-id-type="pmid">32502143</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Sanguinetti</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>BRIE: transcriptome-wide splicing quantification in single cells</article-title><source>Genome Biology</source><volume>18</volume><elocation-id>123</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-017-1248-5</pub-id><pub-id pub-id-type="pmid">28655331</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Sanguinetti</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>BRIE2: computational identification of splicing phenotypes from single-cell transcriptomic experiments</article-title><source>Genome Biology</source><volume>22</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1186/s13059-021-02461-5</pub-id><pub-id pub-id-type="pmid">34452629</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joglekar</surname><given-names>A</given-names></name><name><surname>Prjibelski</surname><given-names>A</given-names></name><name><surname>Mahfouz</surname><given-names>A</given-names></name><name><surname>Collier</surname><given-names>P</given-names></name><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Schlusche</surname><given-names>AK</given-names></name><name><surname>Marrocco</surname><given-names>J</given-names></name><name><surname>Williams</surname><given-names>SR</given-names></name><name><surname>Haase</surname><given-names>B</given-names></name><name><surname>Hayes</surname><given-names>A</given-names></name><name><surname>Chew</surname><given-names>JG</given-names></name><name><surname>Weisenfeld</surname><given-names>NI</given-names></name><name><surname>Wong</surname><given-names>MY</given-names></name><name><surname>Stein</surname><given-names>AN</given-names></name><name><surname>Hardwick</surname><given-names>SA</given-names></name><name><surname>Hunt</surname><given-names>T</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Dieterich</surname><given-names>C</given-names></name><name><surname>Bent</surname><given-names>Z</given-names></name><name><surname>Fedrigo</surname><given-names>O</given-names></name><name><surname>Sloan</surname><given-names>SA</given-names></name><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Jarvis</surname><given-names>ED</given-names></name><name><surname>Flicek</surname><given-names>P</given-names></name><name><surname>Luo</surname><given-names>W</given-names></name><name><surname>Pitt</surname><given-names>GS</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><name><surname>Smit</surname><given-names>AB</given-names></name><name><surname>Ross</surname><given-names>ME</given-names></name><name><surname>Tilgner</surname><given-names>HU</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A spatially resolved brain region- and cell type-specific isoform atlas of the postnatal mouse brain</article-title><source>Nature Communications</source><volume>12</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1038/s41467-020-20343-5</pub-id><pub-id pub-id-type="pmid">33469025</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kent</surname><given-names>WJ</given-names></name><name><surname>Sugnet</surname><given-names>CW</given-names></name><name><surname>Furey</surname><given-names>TS</given-names></name><name><surname>Roskin</surname><given-names>KM</given-names></name><name><surname>Pringle</surname><given-names>TH</given-names></name><name><surname>Zahler</surname><given-names>AM</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The human genome browser at UCSC</article-title><source>Genome Research</source><volume>12</volume><fpage>996</fpage><lpage>1006</lpage><pub-id pub-id-type="doi">10.1101/gr.229102</pub-id><pub-id pub-id-type="pmid">12045153</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>DP</given-names></name><name><surname>Welling</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Adam: A method for stochastic optimization</article-title><conf-name>In: Proceedings of the 2nd International Conference on Learning Representations (ICLR)</conf-name></element-citation></ref><ref id="bib36"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>DP</given-names></name><name><surname>Ba</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Auto-encoding variational Bayes</article-title><conf-name>In: Proceedings of the 2nd International Conference onLearning Representations (ICLR)</conf-name></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Köster</surname><given-names>J</given-names></name><name><surname>Rahmann</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Snakemake--a scalable bioinformatics workflow engine</article-title><source>Bioinformatics (Oxford, England)</source><volume>28</volume><fpage>2520</fpage><lpage>2522</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id><pub-id pub-id-type="pmid">22908215</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>La Manno</surname><given-names>G</given-names></name><name><surname>Soldatov</surname><given-names>R</given-names></name><name><surname>Zeisel</surname><given-names>A</given-names></name><name><surname>Braun</surname><given-names>E</given-names></name><name><surname>Hochgerner</surname><given-names>H</given-names></name><name><surname>Petukhov</surname><given-names>V</given-names></name><name><surname>Lidschreiber</surname><given-names>K</given-names></name><name><surname>Kastriti</surname><given-names>ME</given-names></name><name><surname>Lönnerberg</surname><given-names>P</given-names></name><name><surname>Furlan</surname><given-names>A</given-names></name><name><surname>Fan</surname><given-names>J</given-names></name><name><surname>Borm</surname><given-names>LE</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>van Bruggen</surname><given-names>D</given-names></name><name><surname>Guo</surname><given-names>J</given-names></name><name><surname>He</surname><given-names>X</given-names></name><name><surname>Barker</surname><given-names>R</given-names></name><name><surname>Sundström</surname><given-names>E</given-names></name><name><surname>Castelo-Branco</surname><given-names>G</given-names></name><name><surname>Cramer</surname><given-names>P</given-names></name><name><surname>Adameyko</surname><given-names>I</given-names></name><name><surname>Linnarsson</surname><given-names>S</given-names></name><name><surname>Kharchenko</surname><given-names>PV</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>RNA velocity of single cells</article-title><source>Nature</source><volume>560</volume><fpage>494</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0414-6</pub-id><pub-id pub-id-type="pmid">30089906</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Roith</surname><given-names>D</given-names></name><name><surname>Shiloach</surname><given-names>J</given-names></name><name><surname>Roth</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Is there an earlier phylogenetic precursor that is common to both the nervous and endocrine systems?</article-title><source>Peptides</source><volume>3</volume><fpage>211</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1016/0196-9781(82)90080-8</pub-id><pub-id pub-id-type="pmid">6126861</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lebrigand</surname><given-names>K</given-names></name><name><surname>Magnone</surname><given-names>V</given-names></name><name><surname>Barbry</surname><given-names>P</given-names></name><name><surname>Waldmann</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>High throughput error corrected Nanopore single cell transcriptome sequencing</article-title><source>Nature Communications</source><volume>11</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1038/s41467-020-17800-6</pub-id><pub-id pub-id-type="pmid">32788667</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lemos</surname><given-names>FO</given-names></name><name><surname>Guerra</surname><given-names>MT</given-names></name><name><surname>Leite</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Inositol 1,4,5 trisphosphate receptors in secretory epithelial cells of the gastrointestinal tract</article-title><source>Current Opinion in Physiology</source><volume>17</volume><fpage>169</fpage><lpage>174</lpage><pub-id pub-id-type="doi">10.1016/j.cophys.2020.08.003</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Dewey</surname><given-names>CN</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title><source>BMC Bioinformatics</source><volume>12</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id><pub-id pub-id-type="pmid">21816040</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>YI</given-names></name><name><surname>Knowles</surname><given-names>DA</given-names></name><name><surname>Humphrey</surname><given-names>J</given-names></name><name><surname>Barbeira</surname><given-names>AN</given-names></name><name><surname>Dickinson</surname><given-names>SP</given-names></name><name><surname>Im</surname><given-names>HK</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Annotation-free quantification of RNA splicing using LeafCutter</article-title><source>Nature Genetics</source><volume>50</volume><fpage>151</fpage><lpage>158</lpage><pub-id pub-id-type="doi">10.1038/s41588-017-0004-9</pub-id><pub-id pub-id-type="pmid">29229983</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>Y</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title><source>Bioinformatics (Oxford, England)</source><volume>30</volume><fpage>923</fpage><lpage>930</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id><pub-id pub-id-type="pmid">24227677</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ling</surname><given-names>JP</given-names></name><name><surname>Wilks</surname><given-names>C</given-names></name><name><surname>Charles</surname><given-names>R</given-names></name><name><surname>Leavey</surname><given-names>PJ</given-names></name><name><surname>Ghosh</surname><given-names>D</given-names></name><name><surname>Jiang</surname><given-names>L</given-names></name><name><surname>Santiago</surname><given-names>CP</given-names></name><name><surname>Pang</surname><given-names>B</given-names></name><name><surname>Venkataraman</surname><given-names>A</given-names></name><name><surname>Clark</surname><given-names>BS</given-names></name><name><surname>Nellore</surname><given-names>A</given-names></name><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Blackshaw</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>ASCOT identifies key regulators of neuronal subtype-specific splicing</article-title><source>Nature Communications</source><volume>11</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1038/s41467-019-14020-5</pub-id><pub-id pub-id-type="pmid">31919425</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>DC</given-names></name><name><surname>Nocedal</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>On the limited memory BFGS method for large scale optimization</article-title><source>Mathematical Programming</source><volume>45</volume><fpage>503</fpage><lpage>528</lpage><pub-id pub-id-type="doi">10.1007/BF01589116</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Zhou</surname><given-names>B</given-names></name><name><surname>Wu</surname><given-names>L</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Single-cell differential splicing analysis reveals high heterogeneity of liver tumor-infiltrating T cells</article-title><source>Scientific Reports</source><volume>11</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1038/s41598-021-84693-w</pub-id><pub-id pub-id-type="pmid">33674641</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Gayoso</surname><given-names>A</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Enhancing scientific discoveries in molecular biology with deep generative models</article-title><source>Molecular Systems Biology</source><volume>16</volume><elocation-id>20199198</elocation-id><pub-id pub-id-type="doi">10.15252/msb.20199198</pub-id><pub-id pub-id-type="pmid">32975352</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title><source>EMBnet.Journal</source><volume>17</volume><elocation-id>10</elocation-id><pub-id pub-id-type="doi">10.14806/ej.17.1.200</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsumoto</surname><given-names>H</given-names></name><name><surname>Hayashi</surname><given-names>T</given-names></name><name><surname>Ozaki</surname><given-names>H</given-names></name><name><surname>Tsuyuzaki</surname><given-names>K</given-names></name><name><surname>Umeda</surname><given-names>M</given-names></name><name><surname>Iida</surname><given-names>T</given-names></name><name><surname>Nakamura</surname><given-names>M</given-names></name><name><surname>Okano</surname><given-names>H</given-names></name><name><surname>Nikaido</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>An NMF-based approach to discover overlooked differentially expressed gene regions from single-cell RNA-seq data</article-title><source>NAR Genomics and Bioinformatics</source><volume>2</volume><elocation-id>lqz020</elocation-id><pub-id pub-id-type="doi">10.1093/nargab/lqz020</pub-id><pub-id pub-id-type="pmid">34632380</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Saul</surname><given-names>N</given-names></name><name><surname>Großberger</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>UMAP: Uniform Manifold Approximation and Projection</article-title><source>Journal of Open Source Software</source><volume>3</volume><elocation-id>861</elocation-id><pub-id pub-id-type="doi">10.21105/joss.00861</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Megill</surname><given-names>C</given-names></name><name><surname>Martin</surname><given-names>B</given-names></name><name><surname>Weaver</surname><given-names>C</given-names></name><name><surname>Bell</surname><given-names>S</given-names></name><name><surname>Prins</surname><given-names>L</given-names></name><name><surname>Badajoz</surname><given-names>S</given-names></name><name><surname>McCandless</surname><given-names>B</given-names></name><name><surname>Pisco</surname><given-names>AO</given-names></name><name><surname>Kinsella</surname><given-names>M</given-names></name><name><surname>Griffin</surname><given-names>F</given-names></name><name><surname>Kiggins</surname><given-names>J</given-names></name><name><surname>Haliburton</surname><given-names>G</given-names></name><name><surname>Mani</surname><given-names>A</given-names></name><name><surname>Weiden</surname><given-names>M</given-names></name><name><surname>Dunitz</surname><given-names>M</given-names></name><name><surname>Lombardo</surname><given-names>M</given-names></name><name><surname>Huang</surname><given-names>T</given-names></name><name><surname>Smith</surname><given-names>T</given-names></name><name><surname>Chambers</surname><given-names>S</given-names></name><name><surname>Freeman</surname><given-names>J</given-names></name><name><surname>Cool</surname><given-names>J</given-names></name><name><surname>Carr</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Cellxgene: A Performant, Scalable Exploration Platform for High Dimensional Sparse Matrices</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.04.05.438318</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nip</surname><given-names>KM</given-names></name><name><surname>Chiu</surname><given-names>R</given-names></name><name><surname>Yang</surname><given-names>C</given-names></name><name><surname>Chu</surname><given-names>J</given-names></name><name><surname>Mohamadi</surname><given-names>H</given-names></name><name><surname>Warren</surname><given-names>RL</given-names></name><name><surname>Birol</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>RNA-Bloom enables reference-free and reference-guided sequence assembly for single-cell transcriptomes</article-title><source>Genome Research</source><volume>30</volume><fpage>1191</fpage><lpage>1200</lpage><pub-id pub-id-type="doi">10.1101/gr.260174.119</pub-id><pub-id pub-id-type="pmid">32817073</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ntranos</surname><given-names>V</given-names></name><name><surname>Yi</surname><given-names>L</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A discriminative learning approach to differential expression analysis for single-cell RNA-seq</article-title><source>Nature Methods</source><volume>16</volume><fpage>163</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0303-9</pub-id><pub-id pub-id-type="pmid">30664774</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Olivieri</surname><given-names>JE</given-names></name><name><surname>Dehghannasiri</surname><given-names>R</given-names></name><name><surname>Salzman</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The SpliZ Generalizes “Percent Spliced In” to Reveal Regulated Splicing at Single-Cell Resolution</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.11.10.377572</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Paszke</surname><given-names>A</given-names></name><name><surname>Gross</surname><given-names>S</given-names></name><name><surname>Massa</surname><given-names>F</given-names></name><name><surname>Lerer</surname><given-names>A</given-names></name><name><surname>Bradbury</surname><given-names>J</given-names></name><name><surname>Chanan</surname><given-names>G</given-names></name><name><surname>Killeen</surname><given-names>T</given-names></name><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Gimelshein</surname><given-names>N</given-names></name><name><surname>Antiga</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>PyTorch: An imperative style, high-performance deep learning library</article-title><conf-name>In: Advances in Neural Information Processing Systems</conf-name><fpage>8026</fpage><lpage>8037</lpage></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patrick</surname><given-names>R</given-names></name><name><surname>Humphreys</surname><given-names>DT</given-names></name><name><surname>Janbandhu</surname><given-names>V</given-names></name><name><surname>Oshlack</surname><given-names>A</given-names></name><name><surname>Ho</surname><given-names>JWK</given-names></name><name><surname>Harvey</surname><given-names>RP</given-names></name><name><surname>Lo</surname><given-names>KK</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Sierra: discovery of differential transcript usage from polyA-captured single-cell RNA-seq data</article-title><source>Genome Biology</source><volume>21</volume><fpage>1</fpage><lpage>27</lpage><pub-id pub-id-type="doi">10.1186/s13059-020-02071-7</pub-id><pub-id pub-id-type="pmid">32641141</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedrotti</surname><given-names>S</given-names></name><name><surname>Giudice</surname><given-names>J</given-names></name><name><surname>Dagnino-Acosta</surname><given-names>A</given-names></name><name><surname>Knoblauch</surname><given-names>M</given-names></name><name><surname>Singh</surname><given-names>RK</given-names></name><name><surname>Hanna</surname><given-names>A</given-names></name><name><surname>Mo</surname><given-names>Q</given-names></name><name><surname>Hicks</surname><given-names>J</given-names></name><name><surname>Hamilton</surname><given-names>S</given-names></name><name><surname>Cooper</surname><given-names>TA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The RNA-binding protein Rbfox1 regulates splicing required for skeletal muscle structure and function</article-title><source>Human Molecular Genetics</source><volume>24</volume><fpage>2360</fpage><lpage>2374</lpage><pub-id pub-id-type="doi">10.1093/hmg/ddv003</pub-id><pub-id pub-id-type="pmid">25575511</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Picelli</surname><given-names>S</given-names></name><name><surname>Faridani</surname><given-names>OR</given-names></name><name><surname>Björklund</surname><given-names>AK</given-names></name><name><surname>Winberg</surname><given-names>G</given-names></name><name><surname>Sagasser</surname><given-names>S</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Full-length RNA-seq from single cells using Smart-seq2</article-title><source>Nature Protocols</source><volume>9</volume><fpage>171</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1038/nprot.2014.006</pub-id><pub-id pub-id-type="pmid">24385147</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Hill</surname><given-names>A</given-names></name><name><surname>Packer</surname><given-names>J</given-names></name><name><surname>Lin</surname><given-names>D</given-names></name><name><surname>Ma</surname><given-names>YA</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Single-cell mRNA quantification and differential analysis with Census</article-title><source>Nature Methods</source><volume>14</volume><fpage>309</fpage><lpage>315</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4150</pub-id><pub-id pub-id-type="pmid">28114287</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaum</surname><given-names>NM</given-names></name><name><surname>Karkanias</surname><given-names>J</given-names></name><name><surname>Neff</surname><given-names>NF</given-names></name><name><surname>May</surname><given-names>AP</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name><name><surname>Wyss-Coray</surname><given-names>T</given-names></name><name><surname>Darmanis</surname><given-names>S</given-names></name><name><surname>Batson</surname><given-names>J</given-names></name><name><surname>Botvinnik</surname><given-names>O</given-names></name><name><surname>Chen</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title><source>Nature</source><volume>562</volume><fpage>367</fpage><lpage>372</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0590-4</pub-id><pub-id pub-id-type="pmid">30283141</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schüle</surname><given-names>M</given-names></name><name><surname>Butto</surname><given-names>T</given-names></name><name><surname>Dewi</surname><given-names>S</given-names></name><name><surname>Schlichtholz</surname><given-names>L</given-names></name><name><surname>Strand</surname><given-names>S</given-names></name><name><surname>Gerber</surname><given-names>S</given-names></name><name><surname>Endres</surname><given-names>K</given-names></name><name><surname>Schweiger</surname><given-names>S</given-names></name><name><surname>Winter</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>mTOR Driven Gene Transcription Is Required for Cholesterol Production in Neurons of the Developing Cerebral Cortex</article-title><source>International Journal of Molecular Sciences</source><volume>22</volume><elocation-id>6034</elocation-id><pub-id pub-id-type="doi">10.3390/ijms22116034</pub-id><pub-id pub-id-type="pmid">34204880</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sengar</surname><given-names>AS</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Leung</surname><given-names>C</given-names></name><name><surname>Ramani</surname><given-names>AK</given-names></name><name><surname>Saw</surname><given-names>NM</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Tu</surname><given-names>Y</given-names></name><name><surname>Ross</surname><given-names>PJ</given-names></name><name><surname>Scherer</surname><given-names>SW</given-names></name><name><surname>Ellis</surname><given-names>J</given-names></name><name><surname>Brudno</surname><given-names>M</given-names></name><name><surname>Jia</surname><given-names>Z</given-names></name><name><surname>Salter</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Control of Long-Term Synaptic Potentiation and Learning by Alternative Splicing of the NMDA Receptor Subunit GluN1</article-title><source>Cell Reports</source><volume>29</volume><fpage>4285</fpage><lpage>4294</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2019.11.087</pub-id><pub-id pub-id-type="pmid">31875540</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>Y</given-names></name><name><surname>Botvinnik</surname><given-names>OB</given-names></name><name><surname>Lovci</surname><given-names>MT</given-names></name><name><surname>Kakaradov</surname><given-names>B</given-names></name><name><surname>Liu</surname><given-names>P</given-names></name><name><surname>Xu</surname><given-names>JL</given-names></name><name><surname>Yeo</surname><given-names>GW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Single-Cell Alternative Splicing Analysis with Expedition Reveals Splicing Dynamics during Neuron Differentiation</article-title><source>Molecular Cell</source><volume>67</volume><fpage>148</fpage><lpage>161</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2017.06.003</pub-id><pub-id pub-id-type="pmid">28673540</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein</surname><given-names>M</given-names></name><name><surname>Dütting</surname><given-names>S</given-names></name><name><surname>Mougiakakos</surname><given-names>D</given-names></name><name><surname>Bösl</surname><given-names>M</given-names></name><name><surname>Fritsch</surname><given-names>K</given-names></name><name><surname>Reimer</surname><given-names>D</given-names></name><name><surname>Urbanczyk</surname><given-names>S</given-names></name><name><surname>Steinmetz</surname><given-names>T</given-names></name><name><surname>Schuh</surname><given-names>W</given-names></name><name><surname>Bozec</surname><given-names>A</given-names></name><name><surname>Winkler</surname><given-names>TH</given-names></name><name><surname>Jäck</surname><given-names>HM</given-names></name><name><surname>Mielenz</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A defined metabolic state in pre B cells governs B-cell development and is counterbalanced by Swiprosin-2/EFhd1</article-title><source>Cell Death and Differentiation</source><volume>24</volume><fpage>1239</fpage><lpage>1252</lpage><pub-id pub-id-type="doi">10.1038/cdd.2017.52</pub-id><pub-id pub-id-type="pmid">28524857</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>T</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Hafemeister</surname><given-names>C</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Mauck</surname><given-names>WM</given-names></name><name><surname>Hao</surname><given-names>Y</given-names></name><name><surname>Stoeckius</surname><given-names>M</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Comprehensive Integration of Single-Cell Data</article-title><source>Cell</source><volume>177</volume><fpage>1888</fpage><lpage>1902</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id><pub-id pub-id-type="pmid">31178118</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svensson</surname><given-names>V</given-names></name><name><surname>Gayoso</surname><given-names>A</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Interpretable factor models of single-cell RNA-seq via variational autoencoders</article-title><source>Bioinformatics (Oxford, England)</source><volume>36</volume><fpage>3418</fpage><lpage>3421</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa169</pub-id><pub-id pub-id-type="pmid">32176273</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>Tabula Muris Consortium</collab></person-group><year iso-8601-date="2020">2020</year><article-title>A single-cell transcriptomic atlas characterizes ageing tissues in the mouse</article-title><source>Nature</source><volume>583</volume><fpage>590</fpage><lpage>595</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2496-1</pub-id><pub-id pub-id-type="pmid">32669714</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tekath</surname><given-names>T</given-names></name><name><surname>Dugas</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Differential transcript usage analysis of bulk and single-cell RNA-seq data with DTUrtle</article-title><source>Bioinformatics (Oxford, England)</source><volume>37</volume><fpage>3781</fpage><lpage>3787</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btab629</pub-id><pub-id pub-id-type="pmid">34469510</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traunmüller</surname><given-names>L</given-names></name><name><surname>Gomez</surname><given-names>AM</given-names></name><name><surname>Nguyen</surname><given-names>TM</given-names></name><name><surname>Scheiffele</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Control of neuronal synapse specification by a highly dedicated alternative splicing program</article-title><source>Science (New York, N.Y.)</source><volume>352</volume><fpage>982</fpage><lpage>986</lpage><pub-id pub-id-type="doi">10.1126/science.aaf2397</pub-id><pub-id pub-id-type="pmid">27174676</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vaquero-Garcia</surname><given-names>J</given-names></name><name><surname>Barrera</surname><given-names>A</given-names></name><name><surname>Gazzara</surname><given-names>MR</given-names></name><name><surname>González-Vallinas</surname><given-names>J</given-names></name><name><surname>Lahens</surname><given-names>NF</given-names></name><name><surname>Hogenesch</surname><given-names>JB</given-names></name><name><surname>Lynch</surname><given-names>KW</given-names></name><name><surname>Barash</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A new view of transcriptome complexity and regulation through the lens of local splicing variations</article-title><source>eLife</source><volume>5</volume><elocation-id>e11752</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.11752</pub-id><pub-id pub-id-type="pmid">26829591</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Volden</surname><given-names>R</given-names></name><name><surname>Vollmers</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Highly Multiplexed Single-Cell Full-Length CDNA Sequencing of Human Immune Cells with 10X Genomics and R2C2</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.01.10.902361</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>von Engelhardt</surname><given-names>J</given-names></name><name><surname>Mack</surname><given-names>V</given-names></name><name><surname>Sprengel</surname><given-names>R</given-names></name><name><surname>Kavenstock</surname><given-names>N</given-names></name><name><surname>Li</surname><given-names>KW</given-names></name><name><surname>Stern-Bach</surname><given-names>Y</given-names></name><name><surname>Smit</surname><given-names>AB</given-names></name><name><surname>Seeburg</surname><given-names>PH</given-names></name><name><surname>Monyer</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>CKAMP44: a brain-specific protein attenuating short-term synaptic plasticity in the dentate gyrus</article-title><source>Science (New York, N.Y.)</source><volume>327</volume><fpage>1518</fpage><lpage>1522</lpage><pub-id pub-id-type="doi">10.1126/science.1184178</pub-id><pub-id pub-id-type="pmid">20185686</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vuong</surname><given-names>CK</given-names></name><name><surname>Black</surname><given-names>DL</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The neurogenetics of alternative splicing</article-title><source>Nature Reviews. Neuroscience</source><volume>17</volume><fpage>265</fpage><lpage>281</lpage><pub-id pub-id-type="doi">10.1038/nrn.2016.27</pub-id><pub-id pub-id-type="pmid">27094079</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wamsley</surname><given-names>B</given-names></name><name><surname>Jaglin</surname><given-names>XH</given-names></name><name><surname>Favuzzi</surname><given-names>E</given-names></name><name><surname>Quattrocolo</surname><given-names>G</given-names></name><name><surname>Nigro</surname><given-names>MJ</given-names></name><name><surname>Yusuf</surname><given-names>N</given-names></name><name><surname>Khodadadi-Jamayran</surname><given-names>A</given-names></name><name><surname>Rudy</surname><given-names>B</given-names></name><name><surname>Fishell</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Rbfox1 Mediates Cell-type-Specific Splicing in Cortical Interneurons</article-title><source>Neuron</source><volume>100</volume><fpage>846</fpage><lpage>859</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.09.026</pub-id><pub-id pub-id-type="pmid">30318414</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>ET</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name><name><surname>Luo</surname><given-names>S</given-names></name><name><surname>Khrebtukova</surname><given-names>I</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Mayr</surname><given-names>C</given-names></name><name><surname>Kingsmore</surname><given-names>SF</given-names></name><name><surname>Schroth</surname><given-names>GP</given-names></name><name><surname>Burge</surname><given-names>CB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Alternative isoform regulation in human tissue transcriptomes</article-title><source>Nature</source><volume>456</volume><fpage>470</fpage><lpage>476</lpage><pub-id pub-id-type="doi">10.1038/nature07509</pub-id><pub-id pub-id-type="pmid">18978772</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Rio</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>JUM is a computational method for comprehensive annotation-free analysis of alternative pre-mRNA splicing patterns</article-title><source>PNAS</source><volume>115</volume><fpage>E8181</fpage><lpage>E8190</lpage><pub-id pub-id-type="doi">10.1073/pnas.1806018115</pub-id><pub-id pub-id-type="pmid">30104386</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>He</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Ren</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Direct Comparative Analyses of 10X Genomics Chromium and Smart-seq2</article-title><source>Genomics, Proteomics &amp; Bioinformatics</source><volume>19</volume><fpage>253</fpage><lpage>266</lpage><pub-id pub-id-type="doi">10.1016/j.gpb.2020.02.005</pub-id><pub-id pub-id-type="pmid">33662621</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Welch</surname><given-names>JD</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Prins</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Robust detection of alternative splicing in a population of single cells</article-title><source>Nucleic Acids Research</source><volume>44</volume><elocation-id>e73</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gkv1525</pub-id><pub-id pub-id-type="pmid">26740580</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname><given-names>WX</given-names></name><name><surname>Mead</surname><given-names>AJ</given-names></name><name><surname>Thongjuea</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>VALERIE: Visual-based inspection of alternative splicing events at single-cell resolution</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1008195</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008195</pub-id><pub-id pub-id-type="pmid">32898151</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Westoby</surname><given-names>J</given-names></name><name><surname>Artemov</surname><given-names>P</given-names></name><name><surname>Hemberg</surname><given-names>M</given-names></name><name><surname>Ferguson-Smith</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Obstacles to detecting isoforms using full-length scRNA-seq data</article-title><source>Genome Biology</source><volume>21</volume><fpage>1</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1186/s13059-020-01981-w</pub-id><pub-id pub-id-type="pmid">32293520</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title><source>Genome Biology</source><volume>19</volume><fpage>1</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id><pub-id pub-id-type="pmid">29409532</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>Q</given-names></name><name><surname>Weyn-Vanhentenryck</surname><given-names>SM</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Sloan</surname><given-names>SA</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Wu</surname><given-names>JQ</given-names></name><name><surname>Barres</surname><given-names>BA</given-names></name><name><surname>Zhang</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Systematic discovery of regulated and conserved alternative exons in the mammalian brain reveals NMD modulating chromatin regulators</article-title><source>PNAS</source><volume>112</volume><fpage>3445</fpage><lpage>3450</lpage><pub-id pub-id-type="doi">10.1073/pnas.1502849112</pub-id><pub-id pub-id-type="pmid">25737549</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>H</given-names></name><name><surname>Xie</surname><given-names>F</given-names></name><name><surname>Fischer</surname><given-names>S</given-names></name><name><surname>Adkins</surname><given-names>RS</given-names></name><name><surname>Aldridge</surname><given-names>AI</given-names></name><name><surname>Ament</surname><given-names>SA</given-names></name><name><surname>Bartlett</surname><given-names>A</given-names></name><name><surname>Behrens</surname><given-names>MM</given-names></name><name><surname>Van den Berge</surname><given-names>K</given-names></name><name><surname>Bertagnolli</surname><given-names>D</given-names></name><name><surname>de Bézieux</surname><given-names>HR</given-names></name><name><surname>Biancalani</surname><given-names>T</given-names></name><name><surname>Booeshaghi</surname><given-names>AS</given-names></name><name><surname>Bravo</surname><given-names>HC</given-names></name><name><surname>Casper</surname><given-names>T</given-names></name><name><surname>Colantuoni</surname><given-names>C</given-names></name><name><surname>Crabtree</surname><given-names>J</given-names></name><name><surname>Creasy</surname><given-names>H</given-names></name><name><surname>Crichton</surname><given-names>K</given-names></name><name><surname>Crow</surname><given-names>M</given-names></name><name><surname>Dee</surname><given-names>N</given-names></name><name><surname>Dougherty</surname><given-names>EL</given-names></name><name><surname>Doyle</surname><given-names>WI</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Fang</surname><given-names>R</given-names></name><name><surname>Felix</surname><given-names>V</given-names></name><name><surname>Fong</surname><given-names>O</given-names></name><name><surname>Giglio</surname><given-names>M</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Hawrylycz</surname><given-names>M</given-names></name><name><surname>Herb</surname><given-names>BR</given-names></name><name><surname>Hertzano</surname><given-names>R</given-names></name><name><surname>Hou</surname><given-names>X</given-names></name><name><surname>Hu</surname><given-names>Q</given-names></name><name><surname>Kancherla</surname><given-names>J</given-names></name><name><surname>Kroll</surname><given-names>M</given-names></name><name><surname>Lathia</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>YE</given-names></name><name><surname>Lucero</surname><given-names>JD</given-names></name><name><surname>Luo</surname><given-names>C</given-names></name><name><surname>Mahurkar</surname><given-names>A</given-names></name><name><surname>McMillen</surname><given-names>D</given-names></name><name><surname>Nadaf</surname><given-names>NM</given-names></name><name><surname>Nery</surname><given-names>JR</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Niu</surname><given-names>SY</given-names></name><name><surname>Ntranos</surname><given-names>V</given-names></name><name><surname>Orvis</surname><given-names>J</given-names></name><name><surname>Osteen</surname><given-names>JK</given-names></name><name><surname>Pham</surname><given-names>T</given-names></name><name><surname>Pinto-Duarte</surname><given-names>A</given-names></name><name><surname>Poirion</surname><given-names>O</given-names></name><name><surname>Preissl</surname><given-names>S</given-names></name><name><surname>Purdom</surname><given-names>E</given-names></name><name><surname>Rimorin</surname><given-names>C</given-names></name><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Rivkin</surname><given-names>AC</given-names></name><name><surname>Smith</surname><given-names>K</given-names></name><name><surname>Street</surname><given-names>K</given-names></name><name><surname>Sulc</surname><given-names>J</given-names></name><name><surname>Svensson</surname><given-names>V</given-names></name><name><surname>Tieu</surname><given-names>M</given-names></name><name><surname>Torkelson</surname><given-names>A</given-names></name><name><surname>Tung</surname><given-names>H</given-names></name><name><surname>Vaishnav</surname><given-names>ED</given-names></name><name><surname>Vanderburg</surname><given-names>CR</given-names></name><name><surname>van Velthoven</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>White</surname><given-names>OR</given-names></name><name><surname>Huang</surname><given-names>ZJ</given-names></name><name><surname>Kharchenko</surname><given-names>PV</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><name><surname>Ngai</surname><given-names>J</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Welch</surname><given-names>JD</given-names></name><name><surname>Gillis</surname><given-names>J</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Ren</surname><given-names>B</given-names></name><name><surname>Ecker</surname><given-names>JR</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Mukamel</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A transcriptomic and epigenomic cell atlas of the mouse primary motor cortex</article-title><source>Nature</source><volume>598</volume><fpage>103</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03500-8</pub-id><pub-id pub-id-type="pmid">34616066</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeo</surname><given-names>G</given-names></name><name><surname>Holste</surname><given-names>D</given-names></name><name><surname>Kreiman</surname><given-names>G</given-names></name><name><surname>Burge</surname><given-names>CB</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Variation in alternative splicing across human tissues</article-title><source>Genome Biology</source><volume>5</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r74</pub-id><pub-id pub-id-type="pmid">15461793</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s8" sec-type="appendix"><title>Overview of available methods for alternative splicing analysis in full-length scRNA seq data</title><p>Due to experimental considerations, the analysis of transcript variation in 10x Chromium data is mostly restricted to the 3’ end of genes; in contrast, Smart-seq2 and other full-length, short-read protocols theoretically enable characterization of transcript variation along the whole gene. Nevertheless, numerous challenges impede such analyses in practice. For example, low transcript capture efficiency introduces additional technical noise into transcript quantification (<xref ref-type="bibr" rid="bib3">Arzalluz-Luque and Conesa, 2018</xref>; <xref ref-type="bibr" rid="bib81">Westoby et al., 2020</xref>; <xref ref-type="bibr" rid="bib14">Buen Abad Najar et al., 2020</xref>), and incomplete transcriptome annotations result in discarded reads and reduced sensitivity to cross-cell differences (<xref ref-type="bibr" rid="bib81">Westoby et al., 2020</xref>). Some authors have even recommended avoiding the analysis of alternative splicing in single-cell RNA sequencing (scRNA-seq) data until such obstacles can be suitably overcome (<xref ref-type="bibr" rid="bib81">Westoby et al., 2020</xref>). Despite these difficulties, several methods (summarized in <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>) have sought to analyze transcript variation in short-read, full-length scRNA-seq. Many methods, including kallisto (<xref ref-type="bibr" rid="bib13">Bray et al., 2016</xref>), Census (<xref ref-type="bibr" rid="bib60">Qiu et al., 2017</xref>), BRIE (<xref ref-type="bibr" rid="bib31">Huang and Sanguinetti, 2017</xref>), SCATS (<xref ref-type="bibr" rid="bib30">Hu et al., 2020</xref>), Quantas (<xref ref-type="bibr" rid="bib83">Yan et al., 2015</xref>), VALERIE (meant only for visualization) (<xref ref-type="bibr" rid="bib80">Wen et al., 2020</xref>), DESJ (<xref ref-type="bibr" rid="bib47">Liu et al., 2021</xref>), BRIE2 (<xref ref-type="bibr" rid="bib32">Huang and Sanguinetti, 2021</xref>) and DTUrtle (<xref ref-type="bibr" rid="bib69">Tekath and Dugas, 2021</xref>), depend on transcript annotations and consequently cannot easily identify unannotated alternative splicing events, which may comprise a sizable fraction of events. Currently available annotation-free methods, such as ODEGR-NMF (<xref ref-type="bibr" rid="bib50">Matsumoto et al., 2020</xref>), Expedition (<xref ref-type="bibr" rid="bib64">Song et al., 2017</xref>), ASCOT (<xref ref-type="bibr" rid="bib45">Ling et al., 2020</xref>), SingleSplice (<xref ref-type="bibr" rid="bib79">Welch et al., 2016</xref>) and RNA-Bloom (<xref ref-type="bibr" rid="bib53">Nip et al., 2020</xref>), do not provide a statistical test for differential transcript usage across conditions. <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref> summarizes this information and makes the comparison of different methods easier.</p><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title>Summary of methods available to analyze transcript variation in short-read full-length scRNA-seq.</title><p><italic>Annotation-free</italic>: Does quantification require an accurate transcriptome reference? <italic>Differential transcript usage</italic>: Does the method provide a two-sample test for differences in transcript proportions? Some methods, denoted by (*), provide other statistical tests. Quantas requires cells to be aggregated into known subgroups of each group and therefore does not perform a test at the single-cell level. SingleSplice tests for alternative splicing within a single population. kallisto and ODEGR-NMF test for differential transcript expression, i.e., changes in absolute transcript expression rather than their proportions. Census tests for differential transcript usage along a pseudotime trajectory.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom">Method</th><th valign="bottom">Annotation-free</th><th valign="bottom">Differential transcript usage</th></tr></thead><tbody><tr><td align="left" valign="bottom">Quantas [80]</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">*</td></tr><tr><td align="left" valign="bottom">SingleSplice [76]</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf38"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td><td align="char" char="." valign="bottom">*</td></tr><tr><td align="left" valign="bottom">kallisto [10]</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">*</td></tr><tr><td align="left" valign="bottom">Census [56]</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">*</td></tr><tr><td align="left" valign="bottom">BRIE [27]</td><td align="left" valign="bottom"/><td align="left" valign="bottom"><inline-formula><mml:math id="inf39"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom">Expedition [60]</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf40"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">ODEGR-NMF [46]</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf41"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td><td align="char" char="." valign="bottom">*</td></tr><tr><td align="left" valign="bottom">SCATS [26]</td><td align="left" valign="bottom"/><td align="left" valign="bottom"><inline-formula><mml:math id="inf42"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom">RNA-Bloom [49]</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf43"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">ASCOT [41]</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf44"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">DESJ [43]</td><td align="left" valign="bottom"/><td align="left" valign="bottom"><inline-formula><mml:math id="inf45"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom">BRIE2 [28]</td><td align="left" valign="bottom"/><td align="left" valign="bottom"><inline-formula><mml:math id="inf46"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom">DTUrtle [65]</td><td align="left" valign="bottom"/><td align="left" valign="bottom"><inline-formula><mml:math id="inf47"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom">scQuint</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf48"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf49"><mml:mi mathvariant="normal">✓</mml:mi></mml:math></inline-formula></td></tr></tbody></table></table-wrap></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73520.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Eyras</surname><given-names>Eduardo</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/019wvm592</institution-id><institution>Australian National University</institution></institution-wrap><country>Australia</country></aff></contrib></contrib-group><related-object id="sa0ro1" link-type="continued-by" object-id="10.1101/2021.04.27.441683" object-id-type="id" xlink:href="https://sciety.org/articles/activity/10.1101/2021.04.27.441683"/></front-stub><body><p>This paper presents a new method to study known and novel alternative splicing events at the single-cell level and perform differential analysis across cell types. The method addresses current challenges in the analysis of splicing in single cells related to technical variation and experimental biases. Performing one of the most comprehensive studies to date with data from different mice, this work expands the body of splicing events that potentially define individual cell types.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73520.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Eyras</surname><given-names>Eduardo</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/019wvm592</institution-id><institution>Australian National University</institution></institution-wrap><country>Australia</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.04.27.441683">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.04.27.441683v3">the preprint</ext-link> for the benefit of readers; ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Robust and annotation-free analysis of alternative splicing across diverse cell types in mice&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed their reviews with one another, and it was agreed that a resubmission that fully addresses all of the concerns raised would be suitable for further consideration for publication in <italic>eLife</italic>. The Reviewing Editor has drafted the following to help you prepare a revised submission.</p><p>Essential revisions:</p><p>The reviewers have indicated that although the work might be of interest to researchers working in alternative splicing, the method requires significant additional testing and benchmarking, and the novelty of the findings must be made more clear. The reviewers have provided multiple suggestions to improve this and other aspects of the manuscript.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>Authors have applied their method to two big scRNA-Seq datasets and have reported multiple biological discoveries from their computational analysis. However, the presentation and validation of the results should be improved. I elaborate on my comments below:</p><p>One of my major concerns is about the evaluation and benchmarking analysis of scQuint. Authors have particularly reviewed some of the existing methods in the appendix, but they provided no comparison between the performance of scQuint and those methods. Particularly authors have mentioned on page 18 that they have previously analyzed these datasets with prior methods, but they did not provide any comparison between their findings and those by other methods. In its current form, it is extremely difficult to judge the sensitivity and specificity of scQuint or whether it is a new contribution to the field. Thus, the paper's contribution is to run a standard, published analysis on a single cell dataset. There is no functional or experimental validation to support or refute the findings. Further, there is no computational validation, in terms of testing whether the predictions in this dataset hold in other data.</p><p>One limitation of the current method is more statistical tests which could lower the statistical power due to multiple hypothesis testing issue, as it needs to perform a separate test for each pair of gene/cell type compared to a test for each gene that some other methods need for finding &quot;genes&quot; with cell-type-specific splicing.</p><p>Authors have used the same model as in leafcutter for their analysis. However, they claim that they are getting better p-value and clustering results compared to leafcutter. It is not clear why their method should perform better than leafcutter.</p><p>One of the major advantages of the tabula muris dataset is that it contains data from multiple mouse individuals (i.e., biological replicates), which can be leveraged to show the reproducibility of the biological findings across biological replicates. However, authors did not take advantage of this in presenting their results. I highly recommend that authors show that their results can be replicated across mouse individuals, by visualizing their results as stratified by donor ID. Reproducibility is important for distinguishing between a real reproducible biological signal and a biological/technical noise particularly for the unannotated splicing events as they might be a product of splicing noise.</p><p>Authors have applied their method to only SS2 and not to any 10x data. I believe that the tabula muris dataset contains 10x data as well. While I agree that 10x is more challenging than SS2 for splicing analysis, it is still a valuable resource for splicing analysis as it has higher throughput compared to SS2 and can better capture rare cell types. I recommend that authors comment on the applicability of their method to 10x in the paper and, if their method is applicable, show how their current results compare to the results based on 10x data.</p><p>Since the paper is about analyzing splicing in single cells, I think it is extremely valuable to show the variation at the &quot;single-cell level&quot; (rather than pseudobulked cell-type level) via box or violin plots. This is extremely important as it is not clear from the current plots (e.g., figure 5 c,d,e or figure 8c,d) that the splicing event was observed in how many cells in each cell type and what is the range of read counts per single cell in each cell type. As I mentioned earlier it is extremely difficult to judge the reproducibility and single-cell variation of the visualized splicing events in figures as the data is aggregated across all cells within the cell type from separate donors.</p><p>Authors mention that there is little overlap between differentially expressed and differentially spliced genes but on the other hand they say that the clusters based on splicing and expression latent space are highly consistent with each other. I think they should comment on why this is possible, is it because the same cluster has different markers in each space. If so, is it possible to highlight a few clusters and show their marker genes based on splicing and expression changes?</p><p>On page 9, authors say that they detected thousands of cell-type-specific events; however, they do not provide more specifics about these events? How many events exactly? Across how many distinct genes (also what fraction of genes, and is this fraction with previous studies?)? And distinct cell types? Also, it is not clear how the examples in figure 5 were chosen? Are they among the top genes? What are the top genes? Are they genes known to have cell-type-specific splicing?</p><p>The paper lacks any experimental validation on the discovered splicing events. It is extremely important to show through experimental/FISH validations that these events are not computational artifacts and can be detected in the cell types.</p><p>It is not clear how (and how many?) splicing events in B cell trajectory were identified. Do you report any event that is differential in any of the B cell states as a cell with alternative splicing in B cell trajectory? And again, how these examples were chosen are they among the top genes in B cell trajectory?</p><p>Authors say that they detected many more events in cortex and also higher fraction of unannotated events in cortex, is this because cortex has been more deeply sampled compared to other tissues (Table 2)? Authors should account for sampling depth differences between cell types to see which one is really more enriched in alternative splicing events.</p><p>For Figure 9C, what is the AUC if the model is trained on one individual and used for prediction on another mouse?</p><p>Is not the higher fraction of events in 5' UTRs vs 3' UTR a result of the bias in your method? As you only consider events with shared 3' SS and not events with shared 5' sites in your analysis?</p><p>How did authors account for the coverage-dependent bias (as reported in https://elifesciences.org/articles/54603) which could cause spurious splicing bimodality in scRNA-Seq?</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>To demonstrate the significance of the approach a more completed performance evaluation, for example, using synthetic data, is recommended, as well as a comparison to alternative methods regarding biological significance.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73520.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>Authors have applied their method to two big scRNA-Seq datasets and have reported multiple biological discoveries from their computational analysis. However, the presentation and validation of the results should be improved. I elaborate on my comments below:</p><p>One of my major concerns is about the evaluation and benchmarking analysis of scQuint. Authors have particularly reviewed some of the existing methods in the appendix, but they provided no comparison between the performance of scQuint and those methods. Particularly authors have mentioned on page 18 that they have previously analyzed these datasets with prior methods, but they did not provide any comparison between their findings and those by other methods. In its current form, it is extremely difficult to judge the sensitivity and specificity of scQuint or whether it is a new contribution to the field. Thus, the paper's contribution is to run a standard, published analysis on a single cell dataset. There is no functional or experimental validation to support or refute the findings. Further, there is no computational validation, in terms of testing whether the predictions in this dataset hold in other data.</p></disp-quote><p>Thank you for raising these concerns. We agree that a more rigorous evaluation of scQuint will improve the manuscript. Unfortunately, it is difficult to formally compare all of the methods we discuss because of differences in their requirements and output. For instance, nearly all methods either require annotations or don’t have two-sample tests for differential transcript usage proportions (DTU); neither of these conditions apply to scQuint. We hence reported our qualitative finding that embeddings based on the quantifications of various methods were hampered by technical biases on these datasets (Figure 1 and its two associated supplementary figures), which led us to have doubts about their performance.</p><p>We now introduce an <italic>in silico</italic> benchmarking procedure to demonstrate scQuint’s performance compared with other methods where such a comparison is feasible (Figure 4 in the section Differential splicing hypothesis testing with Generalized Linear Model on page 6). We had intended to include SCATS and DESJ, but were forced to exclude them due to difficulties getting their software to run (the same issues have been noted by other users on Github). To summarize, we found scQuint was comparable to the top methods in DTU testing when coverage artifacts were absent and vastly outperformed them when artifacts were present.</p><p>Per your later suggestion, we now look across different mice to help support the reliability of our findings (discussed in response to comments 4 and 6). Experimental validation, while ideal, has generally not been undertaken by relevant methods (with a couple of exceptions) and would require a time horizon and scope far beyond our intent for this work. We have begun one such collaboration, however. (See also the response to comment 9)</p><disp-quote content-type="editor-comment"><p>One limitation of the current method is more statistical tests which could lower the statistical power due to multiple hypothesis testing issue, as it needs to perform a separate test for each pair of gene/cell type compared to a test for each gene that some other methods need for finding &quot;genes&quot; with cell-type-specific splicing.</p></disp-quote><p>We understand such a test can be advantageous in certain situations. Nevertheless, we decided to test each cell type against the rest, as is the usual approach in the field (like, for example, in the tutorials for the popular single-cell analysis frameworks Seurat and Scanpy).</p><disp-quote content-type="editor-comment"><p>Authors have used the same model as in leafcutter for their analysis. However, they claim that they are getting better p-value and clustering results compared to leafcutter. It is not clear why their method should perform better than leafcutter.</p></disp-quote><p>Thank you for pointing out this ambiguity. We adapted several aspects of LeafCutter’s approach to make it more suitable for the scRNA-seq context, and this is the source of differences in accuracy and scalability. We now include a short description of these modifications in the Methods section and refer to these changes in the appropriate locations of the Introduction and Results. Specifically, we use a modified intron quantification (LeafCutter groups introns that share 5’ donor or 3’ acceptor sites while scQuint groups those sharing 3’ acceptor sites). Moreover, LeafCutter employs a vector of concentration parameters where entries correspond to introns whereas scQuint utilizes a single concentration parameter for each intron group. Finally, the optimization procedure of scQuint was implemented separately and makes a number of different choices, notably adopting a different initialization strategy and using different hyperparameters. The aggregate effect of these changes improves the robustness, estimability, memory requirement, and speed of the quantification and testing procedure when applied to scRNA-seq reads. See Figure 2—figure supplement 2.</p><disp-quote content-type="editor-comment"><p>One of the major advantages of the tabula muris dataset is that it contains data from multiple mouse individuals (i.e., biological replicates), which can be leveraged to show the reproducibility of the biological findings across biological replicates. However, authors did not take advantage of this in presenting their results. I highly recommend that authors show that their results can be replicated across mouse individuals, by visualizing their results as stratified by donor ID. Reproducibility is important for distinguishing between a real reproducible biological signal and a biological/technical noise particularly for the unannotated splicing events as they might be a product of splicing noise.</p></disp-quote><p>Absolutely, thank you for this great suggestion. We went through many genes, visualizing the results across donors and found that the splicing patterns were well-conserved. We now include supplementary figures demonstrating this for several of the events we highlighted in the manuscript (Figure 6—figure supplements 2,3,4; Figure 8—figure supplements 1,2; Figure 9—figure supplements 2,3; Figure 11—figure supplements 2,3,4). We further built a cell type classifier with no overlap in donors between the training and test sets to see if cell-type-specific patterns were preserved across mice, finding that the classifier performed just as well as when all mice were used in both the training and test sets. The updated panels Figure 10d/e now show these results.</p><disp-quote content-type="editor-comment"><p>Authors have applied their method to only SS2 and not to any 10x data. I believe that the tabula muris dataset contains 10x data as well. While I agree that 10x is more challenging than SS2 for splicing analysis, it is still a valuable resource for splicing analysis as it has higher throughput compared to SS2 and can better capture rare cell types. I recommend that authors comment on the applicability of their method to 10x in the paper and, if their method is applicable, show how their current results compare to the results based on 10x data.</p></disp-quote><p>This is indeed an important topic to discuss. We have added the text below to the manuscript to address your comment. Moreover, while it is time consuming to process and analyze all the 10x data from Tabula Muris, we did try a pilot analysis on a smaller, related 10x dataset, finding rather few alternative introns. For now, we think this is the safest advice.</p><p>“We do not recommend using scQuint to analyze alternative splicing in 10x Genomics Chromium data given its strong 3' transcript bias and evidence suggesting these data can detect about half the number of junctions as Smart-seq2 (Wang et al. 2021). While this imposes a fundamental limit on the number of isoforms that can be distinguished, several approaches for differential transcript usage in 10x data have been developed: Sierra (Patrick et al. 2020), SpliZ (Olivieri et al. 2021), and a kallisto-based approach which could be adapted for this task (Ntranos et al. 2019). While a systematic benchmark is missing, we expect alternative intron quantification to be sub-optimal in this setting.”</p><disp-quote content-type="editor-comment"><p>Since the paper is about analyzing splicing in single cells, I think it is extremely valuable to show the variation at the &quot;single-cell level&quot; (rather than pseudobulked cell-type level) via box or violin plots. This is extremely important as it is not clear from the current plots (e.g., figure 5 c,d,e or figure 8c,d) that the splicing event was observed in how many cells in each cell type and what is the range of read counts per single cell in each cell type. As I mentioned earlier it is extremely difficult to judge the reproducibility and single-cell variation of the visualized splicing events in figures as the data is aggregated across all cells within the cell type from separate donors.</p></disp-quote><p>We want to emphasize that all analyses (with the exception of the splice factor regression model in Figure 11) use the single cell data directly and are not pseudobulked. We now make this more explicit in the manuscript. The new supplementary figures (Figure 6—figure supplements 2,3,4; Figure 8—figure supplements 1,2; Figure 9—figure supplements 2,3; Figure 11—figure supplements 2,3,4) to which we alluded in comment 4 response show the distribution of introns across donors for these particular events and are broadly representative of the general trend of consistency we see across genes. These display the strong cell-type specificity and consistency across individuals. We did try box and violin plots, but given the relatively binary nature of the data within cell types, they didn’t yield particularly informative visualizations.</p><disp-quote content-type="editor-comment"><p>Authors mention that there is little overlap between differentially expressed and differentially spliced genes but on the other hand they say that the clusters based on splicing and expression latent space are highly consistent with each other. I think they should comment on why this is possible, is it because the same cluster has different markers in each space. If so, is it possible to highlight a few clusters and show their marker genes based on splicing and expression changes?</p></disp-quote><p>Thank you for raising this question, as it is an interesting and important one which gets at the biological phenomena at play. Indeed, we found that the markers are generally distinct in the expression and splicing spaces despite both data modalities yielding highly consistent clusterings. Figures 6b and 9a-b show that the pattern of alternative splicing across cell types generally do not correlate with the expression of corresponding genes across the same cell types. Table 2 also shows the extremely narrow overlap of the most prominent markers in these two spaces for 5 different tissues. We have also added Figure 6—figure supplement 1 to display the expression marker genes for the cortex cell types. Inspection reveals very little overlap with the splicing markers.</p><disp-quote content-type="editor-comment"><p>On page 9, authors say that they detected thousands of cell-type-specific events; however, they do not provide more specifics about these events? How many events exactly? Across how many distinct genes (also what fraction of genes, and is this fraction with previous studies?)? And distinct cell types? Also, it is not clear how the examples in figure 5 were chosen? Are they among the top genes? What are the top genes? Are they genes known to have cell-type-specific splicing?</p></disp-quote><p>Figure 10 contains information about the number of differential splicing events and differentially spliced genes across different cell types in both the Cortex and Tabula Muris datasets. We have inserted a parenthetical remark in the sentence you mentioned to direct readers to the latter section that contains this figure and a discussion of the information it contains.</p><p>The splicing events in Figure 6 (the former figure 5) panel b were chosen after ranking by inferred effect size with some manual curation to ensure cell-type specificity. Genes for panels c-e (and for subsequent Sashimi plots) were selected from our pool of cell-type-specific novel events based on the clarity of alternative splicing/transcription, and genes were prioritized if there was prior knowledge of roles in relevant biological processes.</p><disp-quote content-type="editor-comment"><p>The paper lacks any experimental validation on the discovered splicing events. It is extremely important to show through experimental/FISH validations that these events are not computational artifacts and can be detected in the cell types.</p></disp-quote><p>We agree that experimental validation is a vital avenue to pursue, and we have begun a collaboration to investigate some of the computationally inferred splicing differences we found in neuronal cells. However, for reasons of the necessary time and our intended scope, we do not feel that it is appropriate to include that as part of this manuscript. We also note that the large majority of computational methods papers for splicing analysis do not perform any experimental validation (we found only 2 out of 13 did so). Our hope with this work is to help generate reasonable hypotheses for follow-up experimentation given the expense of such an endeavor.</p><disp-quote content-type="editor-comment"><p>It is not clear how (and how many?) splicing events in B cell trajectory were identified. Do you report any event that is differential in any of the B cell states as a cell with alternative splicing in B cell trajectory? And again, how these examples were chosen are they among the top genes in B cell trajectory?</p></disp-quote><p>We have inserted panel b of Figure 8 (formerly Figure 7) to explicitly give the number of identified splicing events for each B cell stage. Examples were chosen by selecting genes we identified as containing differential splicing/transcription start events across B cell stages which also have previously identified roles (based on expression) in B cell development. This allowed a comparison of the progression of splicing and expression in genes where both processes seem to play a role in development.</p><disp-quote content-type="editor-comment"><p>Authors say that they detected many more events in cortex and also higher fraction of unannotated events in cortex, is this because cortex has been more deeply sampled compared to other tissues (Table 2)? Authors should account for sampling depth differences between cell types to see which one is really more enriched in alternative splicing events.</p></disp-quote><p>We have updated the relevant section so that it provides readers better context for our results. In particular, we note that the higher rate of unannotated events in the cortex is consistent with previous observations. Due to the one-vs-all testing procedure, the results are affected by the sequencing depths and number of cell types across many tissues and cell types. This makes a comprehensive evaluation difficult, but we now mention that these may complicate a direct interpretation of the number of identified events. The newly added items are underlined.</p><p>“We found many more cell-type-specific differential splicing events in the cortex than in the marrow, as expected (Yeo et al. 2004.), as well as a higher proportion of events involving novel junctions, which can reach 30% (Figure 10a). Differences in proportion of novel junctions should be interpreted with care, however, since they can be affected by sequencing depth and number of cells, both of which vary between the two tissues. Very similar patterns are seen when grouping differential splicing events that occur in the same gene (Figure 10b).”</p><disp-quote content-type="editor-comment"><p>For Figure 9C, what is the AUC if the model is trained on one individual and used for prediction on another mouse?</p></disp-quote><p>Figure 10d now shows the AUC when the classifier is trained and tested on different sets of mice. The values are extremely similar to when there was no partition of individuals between the training and testing data.</p><disp-quote content-type="editor-comment"><p>Is not the higher fraction of events in 5' UTRs vs 3' UTR a result of the bias in your method? As you only consider events with shared 3' SS and not events with shared 5' sites in your analysis?</p></disp-quote><p>We now include a note that our method of intron quantification influences the 5’ vs 3’ ratio we observe:</p><p>&quot;Most differential splicing events that we detected with alternative introns fall in the coding portion of the gene, with high proportions in the 5' UTR (Figure 10c). This is a property of our quantification approach and does not reflect the total number of alternative splicing events in different gene regions; still, the relative proportion can be compared across tissues.”</p><disp-quote content-type="editor-comment"><p>How did authors account for the coverage-dependent bias (as reported in https://elifesciences.org/articles/54603) which could cause spurious splicing bimodality in scRNA-Seq?</p></disp-quote><p>We also encountered this issue while working with these datasets, and it was an important consideration to select a model robust to such technical noise. The Dirichlet-Multinomial model we chose is able to handle this bimodality by fitting a concentration parameter close to zero. To clarify this for readers, we have inserted the following sentence:</p><p>“For example, the often encountered “binary'' splicing (Najar et al. 2020) can be modeled by fitting a concentration parameter close to zero.”</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>To demonstrate the significance of the approach a more completed performance evaluation, for example, using synthetic data, is recommended, as well as a comparison to alternative methods regarding biological significance.</p></disp-quote><p>We thank the reviewer for their careful reading of our manuscript and for noting its strengths and weaknesses. We have revised the paper with a new computational benchmarking section and a better discussion of the biological novelty and insights yielded by our method in this analysis.</p></body></sub-article></article>