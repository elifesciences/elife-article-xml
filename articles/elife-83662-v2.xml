<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">83662</article-id><article-id pub-id-type="doi">10.7554/eLife.83662</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Medicine</subject></subj-group></article-categories><title-group><article-title>Development and evaluation of a live birth prediction model for evaluating human blastocysts from a retrospective study</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-293513"><name><surname>Liu</surname><given-names>Hang</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7948-4236</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-295514"><name><surname>Zhang</surname><given-names>Zhuoran</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-295515"><name><surname>Gu</surname><given-names>Yifan</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-295516"><name><surname>Dai</surname><given-names>Changsheng</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-295517"><name><surname>Shan</surname><given-names>Guanqiao</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2570-769X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-295518"><name><surname>Song</surname><given-names>Haocong</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-295519"><name><surname>Li</surname><given-names>Daniel</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-295520"><name><surname>Chen</surname><given-names>Wenyuan</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-260555"><name><surname>Lin</surname><given-names>Ge</given-names></name><email>linggf@hotmail.com</email><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-144229"><name><surname>Sun</surname><given-names>Yu</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7895-0741</contrib-id><email>sun@mie.utoronto.ca</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="aff" rid="aff9">9</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>Department of Mechanical Engineering, University of Toronto</institution></institution-wrap><addr-line><named-content content-type="city">Toronto</named-content></addr-line><country>Canada</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00t33hh48</institution-id><institution>School of Science and Engineering, The Chinese University of Hong Kong-Shenzhen</institution></institution-wrap><addr-line><named-content content-type="city">Shenzhen</named-content></addr-line><country>China</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00f1zfq44</institution-id><institution>Institute of Reproductive and Stem Cell Engineering, School of Basic Medical Science, Central South University</institution></institution-wrap><addr-line><named-content content-type="city">Changsha</named-content></addr-line><country>China</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ar3e651</institution-id><institution>Reproductive and Genetic Hospital of CITIC-Xiangya</institution></institution-wrap><addr-line><named-content content-type="city">Changsha</named-content></addr-line><country>China</country></aff><aff id="aff5"><label>5</label><institution>Department of Electrical and Computer Engineering</institution><addr-line><named-content content-type="city">Toronto</named-content></addr-line><country>Canada</country></aff><aff id="aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052eegr76</institution-id><institution>Key Laboratory of Reproductive and Stem Cell Engineering, National Health and Family Planning Commission</institution></institution-wrap><addr-line><named-content content-type="city">Changsha</named-content></addr-line><country>China</country></aff><aff id="aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02khfyc93</institution-id><institution>National Engineering Research Center of Human Stem Cells</institution></institution-wrap><addr-line><named-content content-type="city">Changsha</named-content></addr-line><country>China</country></aff><aff id="aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>Institute of Biomedical Engineering, University of Toronto</institution></institution-wrap><addr-line><named-content content-type="city">Toronto</named-content></addr-line><country>Canada</country></aff><aff id="aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>Department of Computer Science, University of Toronto</institution></institution-wrap><addr-line><named-content content-type="city">Toronto</named-content></addr-line><country>Canada</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Suturina</surname><given-names>Larisa V</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/027n02r78</institution-id><institution>Scientific Center for Family Health and Human Reproduction</institution></institution-wrap><country>Russian Federation</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Azziz</surname><given-names>Ricardo</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/012zs8222</institution-id><institution>University at Albany, SUNY</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>22</day><month>02</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e83662</elocation-id><history><date date-type="received" iso-8601-date="2022-09-23"><day>23</day><month>09</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-02-20"><day>20</day><month>02</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-10-21"><day>21</day><month>10</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.10.20.22281296"/></event></pub-history><permissions><copyright-statement>© 2023, Liu, Zhang, Gu et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Liu, Zhang, Gu et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-83662-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-83662-figures-v2.pdf"/><abstract><sec id="abs1"><title>Background:</title><p>In infertility treatment, blastocyst morphological grading is commonly used in clinical practice for blastocyst evaluation and selection, but has shown limited predictive power on live birth outcomes of blastocysts. To improve live birth prediction, a number of artificial intelligence (AI) models have been established. Most existing AI models for blastocyst evaluation only used images for live birth prediction, and the area under the receiver operating characteristic (ROC) curve (AUC) achieved by these models has plateaued at ~0.65.</p></sec><sec id="abs2"><title>Methods:</title><p>This study proposed a multimodal blastocyst evaluation method using both blastocyst images and patient couple’s clinical features (e.g., maternal age, hormone profiles, endometrium thickness, and semen quality) to predict live birth outcomes of human blastocysts. To utilize the multimodal data, we developed a new AI model consisting of a convolutional neural network (CNN) to process blastocyst images and a multilayer perceptron to process patient couple’s clinical features. The data set used in this study consists of 17,580 blastocysts with known live birth outcomes, blastocyst images, and patient couple’s clinical features.</p></sec><sec id="abs3"><title>Results:</title><p>This study achieved an AUC of 0.77 for live birth prediction, which significantly outperforms related works in the literature. Sixteen out of 103 clinical features were identified to be predictors of live birth outcomes and helped improve live birth prediction. Among these features, maternal age, the day of blastocyst transfer, antral follicle count, retrieved oocyte number, and endometrium thickness measured before transfer are the top five features contributing to live birth prediction. Heatmaps showed that the CNN in the AI model mainly focuses on image regions of inner cell mass and trophectoderm (TE) for live birth prediction, and the contribution of TE-related features was greater in the CNN trained with the inclusion of patient couple's clinical features compared with the CNN trained with blastocyst images alone.</p></sec><sec id="abs4"><title>Conclusions:</title><p>The results suggest that the inclusion of patient couple’s clinical features along with blastocyst images increases live birth prediction accuracy.</p></sec><sec id="abs5"><title>Funding:</title><p>Natural Sciences and Engineering Research Council of Canada and the Canada Research Chairs Program.</p></sec></abstract><abstract abstract-type="plain-language-summary"><title>eLife digest</title><p>More than 50 million couples worldwide experience infertility. The most common treatment is in vitro fertilization (IVF). Fertility specialists collect eggs and sperm from the prospective parents. They combine the egg and sperm in a laboratory and allow the fertilized eggs to develop for five days into a multi-celled blastocyst. Then, the specialists select the healthiest blastocysts and return them to the patient's uterus.</p><p>Since 1978, more than 8 million children have been conceived through IVF. Yet, only about 30% of IVF attempts result in a successful birth. As a result, fertility patients often undergo multiple rounds of IVF, which can be expensive and emotionally draining. Several factors determine IVF success, one of which is the health of the blastocysts selected for transfer to the uterus. Specialists select the blastocysts using several criteria. But these human assessments are subjective and inconsistent in predicting which ones are most likely to result in a successful birth. Recent studies suggest artificial intelligence technology may help select blastocysts.</p><p>Liu et al. show that using artificial intelligence to assess blastocysts and fertility patient characteristics leads to more accurate predictions about which blastocysts are likely to result in a successful birth. In the experiments, the researchers trained an artificial intelligence computer program using pictures of 17,580 blastocysts with known birth outcomes and the parents' clinical characteristics. The model identified 16 parental factors associated with birth outcomes. The top 5 most predictive parental factors were maternal age, the day of blastocyst transfer to the uterus, how many eggs were present in the ovaries, the number of eggs retrieved and the thickness of the uterus lining. The program achieved the highest prediction of healthy births so far, compared to success rates listed in other studies.</p><p>Artificial intelligence-aided blastocyte selection using patient and blastocyst characteristics may improve IVF success rates and reduce the number of treatment cycles patient couples undergo. Before specialists can use artificial intelligence in their clinics, they must conduct confirmatory clinical studies that enroll patient couples to compare conventional methods and artificial intelligence.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>live birth</kwd><kwd>blastocyst quality</kwd><kwd>embryo evaluation</kwd><kwd>in vitro fertilization</kwd><kwd>multi-modal</kwd><kwd>artificial intelligence</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id><institution>Natural Sciences and Engineering Research Council of Canada</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Sun</surname><given-names>Yu</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001804</institution-id><institution>Canada Research Chairs</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Sun</surname><given-names>Yu</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The inclusion of the patient couple's clinical features along with blastocyst images increases live birth prediction accuracy.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Infertility is a global health issue, affecting more than 50 million couples worldwide (<xref ref-type="bibr" rid="bib22">Mascarenhas et al., 2012</xref>). Since the birth of the first in vitro fertilization (IVF) child in 1978, over 8 million children were born with IVF treatment (<xref ref-type="bibr" rid="bib1">Adamson et al., 2018</xref>). Among the various factors contributing to IVF outcomes, the quality of the blastocyst (day 5 embryo) selected for transfer is critical for the success of IVF treatment. Manual grading of blastocyst development stage, inner cell mass (ICM), and trophectoderm (TE) remains the most common method for blastocyst evaluation. While the blastocyst morphological grading is widely used in clinical practice, morphological grades of the development stage, ICM, and TE have shown limited predictive power on clinical outcomes (<xref ref-type="bibr" rid="bib33">Seli et al., 2011</xref>; <xref ref-type="bibr" rid="bib32">Reignier et al., 2019</xref>; <xref ref-type="bibr" rid="bib5">Bartolacci et al., 2021</xref>; <xref ref-type="bibr" rid="bib37">Ueno et al., 2021</xref>; <xref ref-type="bibr" rid="bib40">Xiong et al., 2022</xref>). It is desired to identify features for accurate prediction of clinical outcomes of blastocysts.</p><p>To achieve this goal, the convolutional neural network (CNN) is expected to play a critical role. CNN is able to automatically detect discriminative features from images and has been the state-of-the-art method in various fields in medical imaging, such as lung cancer prediction (<xref ref-type="bibr" rid="bib3">Ardila et al., 2019</xref>), breast cancer prediction (<xref ref-type="bibr" rid="bib23">McKinney et al., 2020</xref>), and diabetic retinopathy screening (<xref ref-type="bibr" rid="bib7">Bora et al., 2021</xref>). To apply CNN to predict the clinical outcome of a blastocyst, images of blastocysts with a known clinical outcome (e.g., pregnancy and live birth) are collected for the CNN model development. The area under the receiver operating characteristic (ROC) curve (AUC) is the most commonly used metric to evaluate and compare machine learning models on predicting clinical outcomes of blastocysts (<xref ref-type="bibr" rid="bib16">Kragh and Karstoft, 2021a</xref>). The AUCs reported in the literature using CNN to predict clinical outcomes from blastocyst images range from 0.64 to 0.71 for pregnancy prediction (<xref ref-type="bibr" rid="bib38">VerMilyea et al., 2020</xref>; <xref ref-type="bibr" rid="bib17">Kragh et al., 2021b</xref>; <xref ref-type="bibr" rid="bib6">Berntsen et al., 2022</xref>; <xref ref-type="bibr" rid="bib10">Enatsu et al., 2022</xref>; <xref ref-type="bibr" rid="bib20">Loewke et al., 2022</xref>), and are around 0.65 for live birth prediction (<xref ref-type="bibr" rid="bib25">Miyagi et al., 2019</xref>; <xref ref-type="bibr" rid="bib27">Nagaya and Ukita, 2021</xref>).</p><p>Besides using blastocyst images, attempts have also been made to use time-lapse videos for live birth prediction. These videos contain the entire development process from days 0 to 5–7. However, results in the literature show that CNN using static images achieved similar or slightly better accuracies in predicting clinical outcomes than using time-lapse videos, for instance, AUC=0.68–0.71 (<xref ref-type="bibr" rid="bib38">VerMilyea et al., 2020</xref>; <xref ref-type="bibr" rid="bib10">Enatsu et al., 2022</xref>; <xref ref-type="bibr" rid="bib20">Loewke et al., 2022</xref>) versus 0.64–0.67 (<xref ref-type="bibr" rid="bib17">Kragh et al., 2021b</xref>; <xref ref-type="bibr" rid="bib6">Berntsen et al., 2022</xref>) for pregnancy prediction, and 0.66 (<xref ref-type="bibr" rid="bib25">Miyagi et al., 2019</xref>) versus 0.65 (<xref ref-type="bibr" rid="bib27">Nagaya and Ukita, 2021</xref>) for live birth prediction. A potential reason is that the redundant frames of images in time-lapse videos may work as noise causing the model to overfit and thus leading to a lower prediction accuracy (<xref ref-type="bibr" rid="bib41">Zhu et al., 2018</xref>; <xref ref-type="bibr" rid="bib39">Wu et al., 2021</xref>; <xref ref-type="bibr" rid="bib36">Tao et al., 2022</xref>). Therefore, we opted to use static blastocyst images in this study.</p><p>Different from using blastocyst images alone to predict clinical outcomes, <xref ref-type="bibr" rid="bib26">Miyagi et al., 2020</xref> proposed to use blastocyst images together with maternal clinical features including maternal age, AMH, and BMI and reported an AUC of 0.74, the highest accuracy in literature (<xref ref-type="bibr" rid="bib26">Miyagi et al., 2020</xref>). However, two questions remain elusive. First, the contribution of blastocyst images and the additional contribution of maternal clinical features to live birth prediction are unknown. Second, endometrium status-related features, such as endometrium thickness and pattern, are also critical factors impacting live birth outcomes (<xref ref-type="bibr" rid="bib29">Ng et al., 2007</xref>; <xref ref-type="bibr" rid="bib8">Bu et al., 2016</xref>; <xref ref-type="bibr" rid="bib21">Mahutte et al., 2022</xref>), but were not considered.</p><p>In this study, we quantified the effect of blastocyst images and the combined effect of both blastocyst images and patient couple’s clinical features on live birth prediction. The live birth prediction model using only blastocyst images achieved an AUC of 0.67, which was significantly outperformed by the AUC of 0.77 achieved by the model using both blastocyst images and patient couple’s clinical features (p value&lt;0.0001). Additionally, when endometrium status-related features (e.g., endometrium thickness and pattern) were excluded, the AUC of the model using both blastocyst images and patient couple’s clinical features significantly decreased to 0.74 (p value&lt;0.0001), indicating that the inclusion of endometrium status-related clinical features helps improve live birth prediction accuracy. Sixteen patient couple’s clinical features were identified to be most related to live birth outcomes of blastocysts, among which maternal age, the day of blastocyst transfer, antral follicle count (AFC), retrieved oocyte number, and endometrium thickness measured before transfer are the top five features contributing to live birth prediction. Additionally, the CNN heatmaps showed that the CNN mainly focused on ICM and TE for live birth prediction, and the contribution of TE-related features was greater in the CNN trained with the inclusion of patient couple’s clinical features compared with the CNN trained with blastocyst images alone.</p></sec><sec id="s2" sec-type="methods"><title>Methods</title><sec id="s2-1"><title>Data set collection</title><p>We used retrospectively collected data to develop the live birth prediction model. Transferred blastocysts with known live birth outcomes for patients who underwent frozen embryo transfer cycles from 2016 to 2020, at the Reproductive and Genetic Hospital of CITIC-Xiangya, were reviewed for inclusion in the data set. Informed consent was not necessary because this study used retrospective and fully de-identified data, no medical intervention was performed on the subject, and no biological samples from the patient were collected. This study was approved by the Ethics Committee of the Reproductive and Genetic Hospital of CITIC-Xiangya (approval number: LL-SC-2021-008).</p><p>Blastocyst images were captured before transfer using a standard optical light microscope mounted with a camera. Two grayscale images were captured for each blastocyst, one focusing on ICM and the other focusing on TE. Blastocysts were cropped from the original images which have a resolution of 1024×768 and were consistently padded to 500×500 to facilitate model training. Patient couple’s clinical features consist of 103 features including maternal age and BMI, the day of blastocyst transfer, infertility diagnosis and treatment history of patient couples, ovarian stimulation protocols, maternal hormone profiles, and ultrasound results measured during the ovarian stimulation process and before transfer, and paternal semen diagnosis results (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> for a complete list). Based on p value analysis and logistic regression (LR)-based sequential forward feature selection (<xref ref-type="bibr" rid="bib34">Solorio-Fernández et al., 2020</xref>; <xref ref-type="bibr" rid="bib31">Raschka, 2018</xref>), 16 clinical features that are most relevant to live birth prediction were identified and used for training the machine learning model (see Figure 3). Feature selection reduces the input feature dimensions by removing redundant features and features with limited predictive power, thus improving the model generalization capability (see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). The LR-based feature selection was used due to its computing efficiency, we also presented the result of multilayer perceptron (MLP)-based feature selection in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>.</p><p>A total of 28,118 blastocysts with known live birth outcomes were reviewed, among which 17,580 blastocysts with two blastocyst images and all the 16 clinical features available were included in the data set.</p></sec><sec id="s2-2"><title>Model architecture</title><p><xref ref-type="fig" rid="fig1">Figure 1</xref> shows the architecture of the live birth prediction model based on multimodal blastocyst evaluation. It consists of a CNN to process blastocyst images and an MLP to process patient couple’s clinical features. Features from the CNN and the MLP are fused; thus, the model can be trained to simultaneously take into account both blastocyst images and patient couple’s clinical features for live birth prediction. The last fully connected layer in the CNN and the last fully connected layer in the MLP each output a decision-level feature, which has two variables used to classify the blastocyst into the positive or negative live birth outcome category. The adding operation fuses decision-level features from the CNN and the MLP, and the result of addition is taken as the final output of the overall live birth prediction model.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Architecture of the live birth prediction model based on multimodal blastocyst evaluation.</title><p>CNN, convolutional neural network; FC, fully connected layer; MLP, multilayer perceptron.</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>Source code to reproduce the model.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-83662-fig1-data1-v2.zip"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83662-fig1-v2.tif"/></fig></sec><sec id="s2-3"><title>Model implementation and training</title><p>The proposed live birth prediction model used EfficientNetV2-S as the backbone CNN. EfficientNetV2-S is the baseline model in the EfficientNetV2 family, which is a new family of CNN models that provide higher accuracy and training speed than conventional models (<xref ref-type="bibr" rid="bib35">Tan and Le, 2021</xref>). In our work, the output dimension of the final fully connected layer in EfficientNetV2-S was set to be two, representing the positive and negative live birth outcome of a blastocyst, respectively. The model was implemented using PyTorch 1.10.1 (<xref ref-type="bibr" rid="bib30">Paszke et al., 2019</xref>).</p><p>Each of the 17,580 blastocysts had two images taken at different focal planes, one focused more on TE cells and the other on ICM. Furthermore, for each blastocyst, live birth outcomes and all the 16 patient couple’s clinical features were available. The blastocysts were randomly split into 80%:10%:10% to construct the training, validation, and testing data sets. The stratified random sampling approach was used to ensure that all split data sets have the same distribution of minority and majority classes. Since the ratio of blastocysts with a positive live birth outcome in the data set is 0.368, to mitigate the model’s prediction bias toward the majority category (i.e., the negative live birth outcome), the weighted sampling approach, which can help rebalance the class distributions when sampling from an imbalanced data set (<xref ref-type="bibr" rid="bib11">Feng et al., 2021</xref>), was employed for training the model. In the weighted sampling approach, the probability of each item to be selected is determined by its weight, and the weight of each item is assigned by inverse class frequencies. In this way, the weighted sampling approach rebalances the class distributions by oversampling the minority class and under-sampling the majority class. We also verified the approach of using weighted cross-entropy loss, which assigns greater weights to the loss caused by the prediction error of minority classes. Both approaches helped mitigate the prediction bias toward the majority class, and the results showed that the weighted sampling approach outperformed the weighted cross-entropy loss method.</p><p>Model performance is subject to training hyperparameters (e.g., optimizer, learning rate, batch size, and number of layers). Hence, an automatic hyperparameter-tuning tool is used, Facebook Ax (version 0.2.2, <ext-link ext-link-type="uri" xlink:href="https://github.com/facebook/Ax">https://github.com/facebook/Ax</ext-link>), to search for the optimal hyperparameters for model training. The selected hyperparameters for training the model include a batch size of 16, an SGD optimizer with a learning rate of 0.008, and a momentum of 0.39, and three hidden layers in the MLP. A dropout layer follows each hidden layer in the MLP to prevent overfitting. The number of nodes in each hidden layer is 6836, 5657, and 468, respectively. The dropout rate in each dropout layer is 0.01, 0.07, and 0.67, respectively. The model was trained with four RTX A6000 GPUs. It took about 30 hr to search for the optimal hyperparameters and about an hour to train the model using the optimal hyperparameters.</p></sec><sec id="s2-4"><title>Statistical analysis</title><p>Statistical tests were calculated to compare clinical features between blastocysts with the positive live birth outcome and blastocysts with the negative live birth outcome. Chi-squared test was used for categorical features, t test was used for numerical features. Chi-squared test and t test were performed using Python (version 3.6). ROC curves were compared by the DeLong test implemented in MedCalc software (version 20). All statistical tests were two-tailed and considered significant if p value≤0.05.</p></sec></sec><sec id="s3" sec-type="results"><title>Results</title><sec id="s3-1"><title>The inclusion of patient couple’s clinical features increased AUC for live birth prediction</title><p>To quantify the individual effect of blastocyst images and the combined effect of patient couple’s clinical features, we built and compared models that (1) used only blastocyst images for live birth prediction, and (2) used both blastocyst images and patient couple’s clinical features for prediction. In addition, to quantify the specific effect of endometrium status-related features (i.e., endometrium thickness before transfer, endometrium thickness on HCG day, and endometrium pattern B (yes/no) on HCG day) on live birth prediction, a third model trained using blastocyst images and patient couple’s clinical features where endometrium status-related features were excluded, was also built and compared.</p><p><xref ref-type="fig" rid="fig2">Figure 2</xref> shows the ROC curves and AUCs of the three models for predicting live birth outcomes of 1758 blastocysts (i.e., 10% of 17,580) in the test data set. Using only blastocyst images for live birth prediction gave an AUC of 0.67, with a 95% confidence interval (CI) of 0.65–0.70. Using blastocyst images and patient couple’s clinical features (endometrium status-related features excluded) significantly increased the AUC to 0.74 (95% CI: 0.72–0.76, p value&lt;0.0001). Using both blastocyst images and patient couple’s clinical features (endometrium status-related features included) achieved a prediction AUC of 0.77 (95% CI: 0.75–0.79), which is significantly higher than using only blastocyst images for prediction (p value&lt;0.0001) and than using blastocyst images and patient couple’s clinical features where endometrium status-related features were excluded (p value=0.007).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Receiver operating characteristic (ROC) analysis.</title><p>ROC curves of the model using only blastocyst images, the model using blastocyst images and patient couple’s clinical features where EM-status related features were excluded, and the model using blastocyst images and patient couple’s clinical features where EM-status related features were included to predict live birth outcomes of 1758 blastocysts in the test data set. AUC, area under the ROC curve; EM, endometrium; EM status-related features, endometrium thickness before transfer, endometrium thickness on HCG day, endometrium pattern B (yes/no) on HCG day.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Code and data used to generate the ROC curves.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-83662-fig2-data1-v2.zip"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83662-fig2-v2.tif"/></fig></sec><sec id="s3-2"><title>Ranking the predictive power of patient couple’s clinical features</title><p>We then investigated the predictive power of each patient couple’s clinical feature in predicting live birth outcome. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows the 16 features that were identified to be most related to the live birth outcomes of the blastocysts. These features were ranked according to their AUCs for individually predicting the live birth outcomes of blastocysts using univariable LR. The AUC for each feature was reported as the mean AUC over a tenfold cross-validation process.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Ranking the predictive power of patient couple’s clinical features.</title><p>The 16 patient couple’s clinical features that were identified to be most related to the live birth outcomes of the blastocysts ranked by the AUC for individually predicting live birth outcome. AUC, area under the curve.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Code and data used to generate the AUC ranking chart.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-83662-fig3-data1-v2.zip"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83662-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>ROC curves of the model using LR-selected clinical features and blastocyst images, the model using MLP-selected clinical features and blastocyst images, and the model using all clinical features showing statistical significance and blastocyst images.</title><p>The AUC of the model using all clinical features showing statistical significance and blastocyst images is 0.75, lower than the AUC (0.77) achieved by the model using LR-selected clinical features and blastocyst images, and the AUC (0.76) achieved by the model using MLP-selected clinical features and blastocyst images. The AUC (0.77) achieved by the model using LR-selected clinical features and blastocyst images and the AUC (0.76) achieved by the model using MLP-selected clinical features and blastocyst images show no significant difference (p value=0.95&gt;0.05). AUC, area under the curve; LR, logistic regression; MLP, multilayer perceptron; ROC, receiver operating characteristic.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83662-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Ranking the predictive power of multilayer perceptron (MLP)-selected patient couple’s clinical features.</title><p>The MLP-based feature selection method selected 14 clinical features. Compared with the 16 clinical features selected by LR, 12 of the 16 clinical features were selected by both MLP and LR, and the top nine features are the same. The two clinical features selected by MLP but not by LR include fresh semen (yes/no) and follicle-stimulating hormone (FSH) on day 3 after period. The four clinical features selected by LR but not MLP include number of ovarian stimulation cycles, progesterone (P) on HCG day, maternal body mass index, and free thyroxine (FT4) on day 3 after period. LR: logistic regression.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83662-fig3-figsupp2-v2.tif"/></fig></fig-group></sec><sec id="s3-3"><title>CNN heatmaps</title><p>In blastocyst images, what does CNN focus on to predict the live birth outcome of a blastocyst? Is there a difference in what the CNN focuses on between the model trained without and with the inclusion of patient couple’s clinical features? To answer these questions, we used the class activation mapping method to generate heatmaps. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows blastocyst images, corresponding heatmaps of the CNN trained without including patient couple’s clinical features, and corresponding heatmaps of the CNN trained with including patient couple’s clinical features.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>CNN heatmaps analysis.</title><p>Heatmaps of the CNN trained without and with patient couple’s clinical features. Column (<bold>A</bold>): original blastocyst images. Column (<bold>B</bold>): corresponding heatmaps of the CNN trained without including patient couple’s clinical features. Column (<bold>C</bold>): corresponding heatmaps of the CNN trained with the inclusion of patient couple’s clinical features. CNN, convolutional neural network.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Code and data used to generate the heatmaps shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-83662-fig4-data1-v2.zip"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83662-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Two-channel blastocyst images, one channel focusing on the ICM, the other channel focusing on the TE of a same blastocyst.</title><p>ICM, inner cell mass; TE, trophectoderm.</p><p><supplementary-material id="fig4s1scode1"><label>Figure 4—figure supplement 1—source code 1.</label><caption><title>Code for <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-83662-fig4-figsupp1-code1-v2.zip"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83662-fig4-figsupp1-v2.tif"/></fig></fig-group><p>The blastocyst images were cropped and padded to a consistent size to facilitate model training. The padding value was calculated as the mean pixel value of blastocyst images in the data set. Heatmaps were generated by XGradCAM (<xref ref-type="bibr" rid="bib12">Fu et al., 2020</xref>). Note that the CNN takes two-channel blastocyst images as the input, one focusing on ICM and the other focusing on TE. The blastocyst images shown in <xref ref-type="fig" rid="fig4">Figure 4</xref> are those focused on ICM, and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> shows the two-channel blastocyst images. As can be seen in <xref ref-type="fig" rid="fig4">Figure 4</xref>, when trained using only blastocyst images, the CNN mainly focuses on ICM and TE for predicting live birth outcomes. When training with both blastocyst images and patient couple’s clinical features, TE-related features contributed more to live birth prediction compared with training with blastocyst images only.</p></sec></sec><sec id="s4" sec-type="discussion"><title>Discussion</title><p>In this study, the individual effect of blastocyst images and the combined effect of patient couple’s clinical features for live birth prediction were quantified by comparing the AUC values of the model using only blastocyst images and the model using both blastocyst images and patient couple’s clinical features. An AUC of 0.67 was achieved with blastocyst images only while using both blastocyst images and patient couple’s clinical features led to a significantly higher AUC of 0.77 in live birth prediction. When endometrium status-related features were excluded from patient couple’s clinical features, the AUC of the live birth prediction model significantly decreased (p value=0.007) from 0.77 to 0.74, indicating the strong relevance of endometrium status-related features in live birth prediction. Sixteen patient couple’s clinical features were identified to be most related to live birth outcomes of blastocysts, among which maternal age, the day of blastocyst transfer, AFC, retrieved oocyte number, and endometrium thickness before transfer are the top five features contributing to live birth prediction.</p><p>This study was based on a comprehensive multimodal data set collected for blastocyst evaluation. The data set includes 17,580 blastocysts with known live birth outcomes, blastocyst images, and 16 patient couple’s clinical features. As shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>, 16 patient couple’s clinical features comprehensively include maternal basal characteristics (age and BMI); hormone profiles measured after period (LH and FT4), on HCG day (PE2, P, and LH), and before transfer (E2); endometrium status-related features (endometrium thickness on HCG day and before transfer, endometrium pattern on HCG day); features related to oocytes (AFC, retrieved oocyte number); the day of blastocyst transfer; number of ovarian stimulation cycles; and paternal features (the ratio of grade A sperm after semen processing). For comparison, the data set studied by <xref ref-type="bibr" rid="bib26">Miyagi et al., 2020</xref> did not contain endometrium status-related features and key hormone profiles (e.g., P, E2, and LH). There are numerous IVF data sets containing over 100,000 records of clinical features and live birth outcomes (<xref ref-type="bibr" rid="bib28">Nelson and Lawlor, 2011</xref>; <xref ref-type="bibr" rid="bib24">McLernon et al., 2016</xref>; <xref ref-type="bibr" rid="bib18">La Marca et al., 2021</xref>); however, there are no blastocyst images in these data sets, and thus, these data sets cannot be used for building models to evaluate blastocysts from their images.</p><p>To handle the multimodal data set, our proposed model was designed to integrate two modules including a CNN and an MLP to enable the model to simultaneously consider images and numerical clinical features for blastocyst evaluation. The large and comprehensive multimodal data set and the proposed CNN+MLP model resulted in the highest AUC value of 0.77 ever reported thus far for predicting live birth outcomes of blastocysts. They also enabled us to quantify the predictive power of each feature in predicting the live birth outcomes of blastocysts.</p><p>The blastocyst grading system introduced in 1999 (<xref ref-type="bibr" rid="bib14">Gardner and Schoolcraft, 1999</xref>; <xref ref-type="bibr" rid="bib13">Gardner, 1999</xref>) remains the most common method used by embryologists to evaluate blastocyst quality although the morphological grades of blastocyst development stage, ICM and TE have limited predictive power on live birth outcomes (e.g., AUC=0.58–0.61 for live birth prediction reported by <xref ref-type="bibr" rid="bib32">Reignier et al., 2019</xref>; <xref ref-type="bibr" rid="bib5">Bartolacci et al., 2021</xref>; <xref ref-type="bibr" rid="bib40">Xiong et al., 2022</xref>). Since CNN became a state-of-the-art method for image-based classification, many attempts have been made to apply the CNN to blastocyst evaluation for predicting clinical outcomes (e.g., <xref ref-type="bibr" rid="bib38">VerMilyea et al., 2020</xref>; <xref ref-type="bibr" rid="bib17">Kragh et al., 2021b</xref>; <xref ref-type="bibr" rid="bib6">Berntsen et al., 2022</xref>; <xref ref-type="bibr" rid="bib10">Enatsu et al., 2022</xref>; <xref ref-type="bibr" rid="bib20">Loewke et al., 2022</xref>; <xref ref-type="bibr" rid="bib25">Miyagi et al., 2019</xref>; <xref ref-type="bibr" rid="bib27">Nagaya and Ukita, 2021</xref>). Among these, the AUC values reported in the literature using blastocyst images only were around 0.65 for live birth prediction (<xref ref-type="bibr" rid="bib25">Miyagi et al., 2019</xref>; <xref ref-type="bibr" rid="bib27">Nagaya and Ukita, 2021</xref>). Similarly, we achieved an AUC of 0.67 (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). Compared with the AUC of 0.58–0.61 reported in the literature using Gardner grades for live birth prediction, these results confirmed that CNN can achieve a higher prediction accuracy. As shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>, the CNN mainly focuses on ICM and TE. Different from the Gardner-defined TE grade on the number of TE cells and the cohesiveness of TE cells as a whole, the CNN tends to focus on specific TE clusters. Understanding the heatmaps further requires more investigations.</p><p><xref ref-type="bibr" rid="bib26">Miyagi et al., 2020</xref> used both blastocyst images and maternal clinical features (age, AMH, and BMI) to predict live birth outcomes and achieved an AUC of 0.74 (<xref ref-type="bibr" rid="bib26">Miyagi et al., 2020</xref>). The additional contribution from the three maternal clinical features was not clear since no AUC was reported by using blastocyst images alone. Furthermore, despite their importance in pregnancy and live birth, endometrium status-related features were not considered in their work. Therefore, our study used a comprehensive data set and quantitatively compared the AUC values of live birth prediction using only blastocyst images versus using both blastocyst images and patient couple’s clinical features. We also quantified the usefulness of endometrium status-related features in working with blastocyst images to improve live birth prediction. Furthermore, we revealed that hormone profiles such as E2, LH, P, and FT4, features related to oocyte retrieval such as AFC and number of oocytes retrieved, and the ratio of grade A sperm after processing representing semen quality are able to work with blastocyst images to further improve the live birth prediction accuracy. Note that in this study, only the total testosterone (T) was analyzed, and free T or bioavailable T was not available for clinical feature analysis (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). This may cause potential bias in determining the significance of testosterone as a predictor of live birth.</p><p>Another finding of this study, by comparing the heatmaps of the CNN trained without and with the inclusion of patient couple’s clinical features, is that the weights of TE-related features increased (see <xref ref-type="fig" rid="fig4">Figure 4</xref>). A potential reason may be that TE and the endometrium status-related features (e.g., endometrium thickness and pattern) play critical roles when a blastocyst initiates implantation, and a positive live birth outcome is not possible without the success of this implantation process (<xref ref-type="bibr" rid="bib2">Ahlström et al., 2011</xref>; <xref ref-type="bibr" rid="bib15">Hill et al., 2013</xref>; <xref ref-type="bibr" rid="bib9">Chen et al., 2014</xref>; <xref ref-type="bibr" rid="bib4">Bakkensen et al., 2019</xref>).</p><p>In conclusion, in this retrospective study involving 17,580 blastocysts with known live birth outcomes, blastocyst images and 16 patient couple’s clinical features, we built a live birth prediction model based on multimodal blastocyst evaluation using both blastocyst images and patient couple’s clinical features. We quantified the individual effect of blastocyst images and the combined effect of patient couple’s clinical features on live birth prediction. Results demonstrated that using both blastocyst images and patient couple’s clinical features can significantly improve live birth prediction than using blastocyst images alone.</p><p>The proposed live birth prediction model improves the evaluation of a blastocyst in terms of its live birth potential for best blastocyst selection from multiple blastocysts of a patient. The next step is to validate the model’s prediction accuracy using prospectively collected data and verify its effectiveness in blastocyst selection via a randomized controlled trial (RCT). Patients enrolled in the RCT will be split into the study group and the control group (1:1 ratio). In the study group, the model selects a top blastocyst having the highest probability of live birth for transfer, and in the control group, embryologists select a top blastocyst based on their routine morphological grading for transfer. Live birth outcomes of both groups will be tracked and compared.</p></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Data curation, Software, Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Data curation, Software, Validation, Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Resources, Data curation, Supervision, Validation, Investigation, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Resources, Supervision, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Resources, Data curation, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Human subjects: Informed consent was not necessary because this study used retrospective and fully de-identified data, no medical intervention was performed on the subject, and no biological samples from the patient were collected. This study was approved by the Ethics Committee of the Reproductive and Genetic Hospital of CITIC-Xiangya (approval number: LL-SC-2021-008).</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-83662-mdarchecklist1-v2.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>P value analysis result of 103 patient couple's clinical features.</title></caption><media xlink:href="elife-83662-supp1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All processed data and code needed to reproduce the findings of the study are made openly available in deidentified form. This can be found in <ext-link ext-link-type="uri" xlink:href="https://github.com/robotVisionHang/LiveBirthPrediction_Data_Code">https://github.com/robotVisionHang/LiveBirthPrediction_Data_Code</ext-link> (copy archived at <xref ref-type="bibr" rid="bib19">Liu et al., 2023</xref>), and attached to this manuscript. All codes and software used to analyze the data can also be accessed through the link. Due to data privacy regulations of patient data, raw data cannot be publicly shared. Interested researchers are welcome to contact the corresponding author with a concise project proposal indicating aims of using the data and how they will use the data. The project proposal will be firstly assessed by Prof. Yu Sun, Prof. Ge Lin, and then by the Ethics Committee of the Reproductive and Genetic Hospital of CITIC-Xiangya. There are no restrictions on who can access the data.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adamson</surname><given-names>GD</given-names></name><name><surname>de Mouzon</surname><given-names>J</given-names></name><name><surname>Chambers</surname><given-names>GM</given-names></name><name><surname>Zegers-Hochschild</surname><given-names>F</given-names></name><name><surname>Mansour</surname><given-names>R</given-names></name><name><surname>Ishihara</surname><given-names>O</given-names></name><name><surname>Banker</surname><given-names>M</given-names></name><name><surname>Dyer</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>International committee for monitoring assisted reproductive technology: world report on assisted reproductive technology, 2011</article-title><source>Fertility and Sterility</source><volume>110</volume><fpage>1067</fpage><lpage>1080</lpage><pub-id pub-id-type="doi">10.1016/j.fertnstert.2018.06.039</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahlström</surname><given-names>A</given-names></name><name><surname>Westin</surname><given-names>C</given-names></name><name><surname>Reismer</surname><given-names>E</given-names></name><name><surname>Wikland</surname><given-names>M</given-names></name><name><surname>Hardarson</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Trophectoderm morphology: an important parameter for predicting live birth after single blastocyst transfer</article-title><source>Human Reproduction</source><volume>26</volume><fpage>3289</fpage><lpage>3296</lpage><pub-id pub-id-type="doi">10.1093/humrep/der325</pub-id><pub-id pub-id-type="pmid">21972253</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ardila</surname><given-names>D</given-names></name><name><surname>Kiraly</surname><given-names>AP</given-names></name><name><surname>Bharadwaj</surname><given-names>S</given-names></name><name><surname>Choi</surname><given-names>B</given-names></name><name><surname>Reicher</surname><given-names>JJ</given-names></name><name><surname>Peng</surname><given-names>L</given-names></name><name><surname>Tse</surname><given-names>D</given-names></name><name><surname>Etemadi</surname><given-names>M</given-names></name><name><surname>Ye</surname><given-names>W</given-names></name><name><surname>Corrado</surname><given-names>G</given-names></name><name><surname>Naidich</surname><given-names>DP</given-names></name><name><surname>Shetty</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>End-To-End lung cancer screening with three-dimensional deep learning on low-dose chest computed tomography</article-title><source>Nature Medicine</source><volume>25</volume><fpage>954</fpage><lpage>961</lpage><pub-id pub-id-type="doi">10.1038/s41591-019-0447-x</pub-id><pub-id pub-id-type="pmid">31110349</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bakkensen</surname><given-names>JB</given-names></name><name><surname>Brady</surname><given-names>P</given-names></name><name><surname>Carusi</surname><given-names>D</given-names></name><name><surname>Romanski</surname><given-names>P</given-names></name><name><surname>Thomas</surname><given-names>AM</given-names></name><name><surname>Racowsky</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Association between blastocyst morphology and pregnancy and perinatal outcomes following fresh and cryopreserved embryo transfer</article-title><source>Journal of Assisted Reproduction and Genetics</source><volume>36</volume><fpage>2315</fpage><lpage>2324</lpage><pub-id pub-id-type="doi">10.1007/s10815-019-01580-0</pub-id><pub-id pub-id-type="pmid">31512049</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartolacci</surname><given-names>A</given-names></name><name><surname>Dal Canto</surname><given-names>M</given-names></name><name><surname>Guglielmo</surname><given-names>MC</given-names></name><name><surname>Mura</surname><given-names>L</given-names></name><name><surname>Brigante</surname><given-names>C</given-names></name><name><surname>Mignini Renzini</surname><given-names>M</given-names></name><name><surname>Buratini</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Early embryo morphokinetics is a better predictor of post-ICSI live birth than embryo morphology: speed is more important than beauty at the cleavage stage</article-title><source>Zygote</source><volume>29</volume><fpage>495</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1017/S0967199421000253</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berntsen</surname><given-names>J</given-names></name><name><surname>Rimestad</surname><given-names>J</given-names></name><name><surname>Lassen</surname><given-names>JT</given-names></name><name><surname>Tran</surname><given-names>D</given-names></name><name><surname>Kragh</surname><given-names>MF</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Robust and generalizable embryo selection based on artificial intelligence and time-lapse image sequences</article-title><source>PLOS ONE</source><volume>17</volume><elocation-id>e0262661</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0262661</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bora</surname><given-names>A</given-names></name><name><surname>Balasubramanian</surname><given-names>S</given-names></name><name><surname>Babenko</surname><given-names>B</given-names></name><name><surname>Virmani</surname><given-names>S</given-names></name><name><surname>Venugopalan</surname><given-names>S</given-names></name><name><surname>Mitani</surname><given-names>A</given-names></name><name><surname>de Oliveira Marinho</surname><given-names>G</given-names></name><name><surname>Cuadros</surname><given-names>J</given-names></name><name><surname>Ruamviboonsuk</surname><given-names>P</given-names></name><name><surname>Corrado</surname><given-names>GS</given-names></name><name><surname>Peng</surname><given-names>L</given-names></name><name><surname>Webster</surname><given-names>DR</given-names></name><name><surname>Varadarajan</surname><given-names>AV</given-names></name><name><surname>Hammel</surname><given-names>N</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Bavishi</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Predicting the risk of developing diabetic retinopathy using deep learning</article-title><source>The Lancet. Digital Health</source><volume>3</volume><fpage>e10</fpage><lpage>e19</lpage><pub-id pub-id-type="doi">10.1016/S2589-7500(20)30250-8</pub-id><pub-id pub-id-type="pmid">33735063</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bu</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Dai</surname><given-names>W</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Endometrial thickness significantly affects clinical pregnancy and live birth rates in frozen-thawed embryo transfer cycles</article-title><source>Gynecological Endocrinology</source><volume>32</volume><fpage>524</fpage><lpage>528</lpage><pub-id pub-id-type="doi">10.3109/09513590.2015.1136616</pub-id><pub-id pub-id-type="pmid">26942778</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Cao</surname><given-names>S</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Zhao</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Ling</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Trophectoderm morphology predicts outcomes of pregnancy in vitrified-warmed single-blastocyst transfer cycle in a Chinese population</article-title><source>Journal of Assisted Reproduction and Genetics</source><volume>31</volume><fpage>1475</fpage><lpage>1481</lpage><pub-id pub-id-type="doi">10.1007/s10815-014-0317-x</pub-id><pub-id pub-id-type="pmid">25123128</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enatsu</surname><given-names>N</given-names></name><name><surname>Miyatsuka</surname><given-names>I</given-names></name><name><surname>An</surname><given-names>LM</given-names></name><name><surname>Inubushi</surname><given-names>M</given-names></name><name><surname>Enatsu</surname><given-names>K</given-names></name><name><surname>Otsuki</surname><given-names>J</given-names></name><name><surname>Iwasaki</surname><given-names>T</given-names></name><name><surname>Kokeguchi</surname><given-names>S</given-names></name><name><surname>Shiotani</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A novel system based on artificial intelligence for predicting blastocyst viability and visualizing the explanation</article-title><source>Reproductive Medicine and Biology</source><volume>21</volume><elocation-id>12443</elocation-id><pub-id pub-id-type="doi">10.1002/rmb2.12443</pub-id><pub-id pub-id-type="pmid">35386375</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>C</given-names></name><name><surname>Zhong</surname><given-names>Y</given-names></name><name><surname>Huang</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Exploring Classification Equilibrium in Long-Tailed Object Detection</article-title><conf-name>IEEE/CVF International Conference on Computer Vision</conf-name><conf-loc>Montreal, QC, Canada</conf-loc><fpage>3417</fpage><lpage>3426</lpage><pub-id pub-id-type="doi">10.1109/ICCV48922.2021.00340</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>R</given-names></name><name><surname>Hu</surname><given-names>Q</given-names></name><name><surname>Dong</surname><given-names>X</given-names></name><name><surname>Guo</surname><given-names>Y</given-names></name><name><surname>Gao</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Axiom-Based Grad-Cam: Towards Accurate Visualization and Explanation of Cnns</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.2008.02312</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gardner</surname><given-names>DK</given-names></name></person-group><year iso-8601-date="1999">1999</year><chapter-title>In-vitro culture of human blastocyst</chapter-title><person-group person-group-type="editor"><name><surname>Gardner</surname><given-names>DK</given-names></name></person-group><source>Towards Reproductive Certainty: Infertility and Genetics Beyond 1999</source><publisher-name>CRC Press</publisher-name><fpage>378</fpage><lpage>388</lpage></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname><given-names>DK</given-names></name><name><surname>Schoolcraft</surname><given-names>WB</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Culture and transfer of human blastocysts</article-title><source>Current Opinion in Obstetrics &amp; Gynecology</source><volume>11</volume><fpage>307</fpage><lpage>311</lpage><pub-id pub-id-type="doi">10.1097/00001703-199906000-00013</pub-id><pub-id pub-id-type="pmid">10369209</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hill</surname><given-names>MJ</given-names></name><name><surname>Richter</surname><given-names>KS</given-names></name><name><surname>Heitmann</surname><given-names>RJ</given-names></name><name><surname>Graham</surname><given-names>JR</given-names></name><name><surname>Tucker</surname><given-names>MJ</given-names></name><name><surname>DeCherney</surname><given-names>AH</given-names></name><name><surname>Browne</surname><given-names>PE</given-names></name><name><surname>Levens</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Trophectoderm grade predicts outcomes of single-blastocyst transfers</article-title><source>Fertility and Sterility</source><volume>99</volume><fpage>1283</fpage><lpage>1289</lpage><pub-id pub-id-type="doi">10.1016/j.fertnstert.2012.12.003</pub-id><pub-id pub-id-type="pmid">23312233</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kragh</surname><given-names>MF</given-names></name><name><surname>Karstoft</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021a</year><article-title>Embryo selection with artificial intelligence: how to evaluate and compare methods?</article-title><source>Journal of Assisted Reproduction and Genetics</source><volume>38</volume><fpage>1675</fpage><lpage>1689</lpage><pub-id pub-id-type="doi">10.1007/s10815-021-02254-6</pub-id><pub-id pub-id-type="pmid">34173914</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kragh</surname><given-names>MF</given-names></name><name><surname>Rimestad</surname><given-names>J</given-names></name><name><surname>Lassen</surname><given-names>JT</given-names></name><name><surname>Berntsen</surname><given-names>J</given-names></name><name><surname>Karstoft</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021b</year><article-title>Predicting embryo viability based on self-supervised alignment of time-lapse videos</article-title><source>IEEE Transactions on Medical Imaging</source><volume>41</volume><fpage>465</fpage><lpage>475</lpage><pub-id pub-id-type="doi">10.1109/TMI.2021.3116986</pub-id><pub-id pub-id-type="pmid">34596537</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>La Marca</surname><given-names>A</given-names></name><name><surname>Capuzzo</surname><given-names>M</given-names></name><name><surname>Donno</surname><given-names>V</given-names></name><name><surname>Mignini Renzini</surname><given-names>M</given-names></name><name><surname>Giovane</surname><given-names>CD</given-names></name><name><surname>D’Amico</surname><given-names>R</given-names></name><name><surname>Sunkara</surname><given-names>SK</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The predicted probability of live birth in in vitro fertilization varies during important stages throughout the treatment: analysis of 114,882 first cycles</article-title><source>Journal of Gynecology Obstetrics and Human Reproduction</source><volume>50</volume><elocation-id>101878</elocation-id><pub-id pub-id-type="doi">10.1016/j.jogoh.2020.101878</pub-id><pub-id pub-id-type="pmid">32747217</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Gu</surname><given-names>Y</given-names></name><name><surname>Dai</surname><given-names>C</given-names></name><name><surname>Shan</surname><given-names>G</given-names></name><name><surname>Song</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>D</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Lin</surname><given-names>G</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>LiveBirthPrediction_Data_Code</data-title><version designator="swh:1:rev:55eda9aece25451f1b68e3941124d92e9d97cf82">swh:1:rev:55eda9aece25451f1b68e3941124d92e9d97cf82</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:04bbbb284ca95b4e8c2385bbac8f4460ceb5ae68;origin=https://github.com/robotVisionHang/LiveBirthPrediction_Data_Code;visit=swh:1:snp:9f5da846f1bf5d1b38540d13cb03e221bd9df153;anchor=swh:1:rev:55eda9aece25451f1b68e3941124d92e9d97cf82">https://archive.softwareheritage.org/swh:1:dir:04bbbb284ca95b4e8c2385bbac8f4460ceb5ae68;origin=https://github.com/robotVisionHang/LiveBirthPrediction_Data_Code;visit=swh:1:snp:9f5da846f1bf5d1b38540d13cb03e221bd9df153;anchor=swh:1:rev:55eda9aece25451f1b68e3941124d92e9d97cf82</ext-link></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loewke</surname><given-names>K</given-names></name><name><surname>Cho</surname><given-names>JH</given-names></name><name><surname>Brumar</surname><given-names>CD</given-names></name><name><surname>Maeder-York</surname><given-names>P</given-names></name><name><surname>Barash</surname><given-names>O</given-names></name><name><surname>Malmsten</surname><given-names>JE</given-names></name><name><surname>Zaninovic</surname><given-names>N</given-names></name><name><surname>Sakkas</surname><given-names>D</given-names></name><name><surname>Miller</surname><given-names>KA</given-names></name><name><surname>Levy</surname><given-names>M</given-names></name><name><surname>VerMilyea</surname><given-names>MD</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Characterization of an artificial intelligence model for ranking static images of blastocyst stage embryos</article-title><source>Fertility and Sterility</source><volume>117</volume><fpage>528</fpage><lpage>535</lpage><pub-id pub-id-type="doi">10.1016/j.fertnstert.2021.11.022</pub-id><pub-id pub-id-type="pmid">34998577</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahutte</surname><given-names>N</given-names></name><name><surname>Hartman</surname><given-names>M</given-names></name><name><surname>Meng</surname><given-names>L</given-names></name><name><surname>Lanes</surname><given-names>A</given-names></name><name><surname>Luo</surname><given-names>ZC</given-names></name><name><surname>Liu</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Optimal endometrial thickness in fresh and frozen-thaw in vitro fertilization cycles: an analysis of live birth rates from 96,000 autologous embryo transfers</article-title><source>Fertility and Sterility</source><volume>117</volume><fpage>792</fpage><lpage>800</lpage><pub-id pub-id-type="doi">10.1016/j.fertnstert.2021.12.025</pub-id><pub-id pub-id-type="pmid">35109980</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mascarenhas</surname><given-names>MN</given-names></name><name><surname>Flaxman</surname><given-names>SR</given-names></name><name><surname>Boerma</surname><given-names>T</given-names></name><name><surname>Vanderpoel</surname><given-names>S</given-names></name><name><surname>Stevens</surname><given-names>GA</given-names></name><name><surname>Low</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>National, regional, and global trends in infertility prevalence since 1990: a systematic analysis of 277 health surveys</article-title><source>PLOS Medicine</source><volume>9</volume><elocation-id>e1001356</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pmed.1001356</pub-id><pub-id pub-id-type="pmid">23271957</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKinney</surname><given-names>SM</given-names></name><name><surname>Sieniek</surname><given-names>M</given-names></name><name><surname>Godbole</surname><given-names>V</given-names></name><name><surname>Godwin</surname><given-names>J</given-names></name><name><surname>Antropova</surname><given-names>N</given-names></name><name><surname>Ashrafian</surname><given-names>H</given-names></name><name><surname>Back</surname><given-names>T</given-names></name><name><surname>Chesus</surname><given-names>M</given-names></name><name><surname>Corrado</surname><given-names>GS</given-names></name><name><surname>Darzi</surname><given-names>A</given-names></name><name><surname>Etemadi</surname><given-names>M</given-names></name><name><surname>Garcia-Vicente</surname><given-names>F</given-names></name><name><surname>Gilbert</surname><given-names>FJ</given-names></name><name><surname>Halling-Brown</surname><given-names>M</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name><name><surname>Jansen</surname><given-names>S</given-names></name><name><surname>Karthikesalingam</surname><given-names>A</given-names></name><name><surname>Kelly</surname><given-names>CJ</given-names></name><name><surname>King</surname><given-names>D</given-names></name><name><surname>Ledsam</surname><given-names>JR</given-names></name><name><surname>Melnick</surname><given-names>D</given-names></name><name><surname>Mostofi</surname><given-names>H</given-names></name><name><surname>Peng</surname><given-names>L</given-names></name><name><surname>Reicher</surname><given-names>JJ</given-names></name><name><surname>Romera-Paredes</surname><given-names>B</given-names></name><name><surname>Sidebottom</surname><given-names>R</given-names></name><name><surname>Suleyman</surname><given-names>M</given-names></name><name><surname>Tse</surname><given-names>D</given-names></name><name><surname>Young</surname><given-names>KC</given-names></name><name><surname>De Fauw</surname><given-names>J</given-names></name><name><surname>Shetty</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>International evaluation of an AI system for breast cancer screening</article-title><source>Nature</source><volume>577</volume><fpage>89</fpage><lpage>94</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1799-6</pub-id><pub-id pub-id-type="pmid">31894144</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLernon</surname><given-names>DJ</given-names></name><name><surname>Steyerberg</surname><given-names>EW</given-names></name><name><surname>Te Velde</surname><given-names>ER</given-names></name><name><surname>Lee</surname><given-names>AJ</given-names></name><name><surname>Bhattacharya</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Predicting the chances of a live birth after one or more complete cycles of in vitro fertilisation: population based study of linked cycle data from 113 873 women</article-title><source>BMJ</source><volume>355</volume><elocation-id>i5735</elocation-id><pub-id pub-id-type="doi">10.1136/bmj.i5735</pub-id><pub-id pub-id-type="pmid">27852632</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyagi</surname><given-names>Y</given-names></name><name><surname>Habara</surname><given-names>T</given-names></name><name><surname>Hirata</surname><given-names>R</given-names></name><name><surname>Hayashi</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Feasibility of artificial intelligence for predicting live birth without aneuploidy from a blastocyst image</article-title><source>Reproductive Medicine and Biology</source><volume>18</volume><fpage>204</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1002/rmb2.12267</pub-id><pub-id pub-id-type="pmid">30996684</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyagi</surname><given-names>Y</given-names></name><name><surname>Habara</surname><given-names>T</given-names></name><name><surname>Hirata</surname><given-names>R</given-names></name><name><surname>Hayashi</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Predicting a live birth by artificial intelligence incorporating both the blastocyst image and conventional embryo evaluation parameters</article-title><source>Artificial Intelligence in Medical Imaging</source><volume>1</volume><fpage>94</fpage><lpage>107</lpage><pub-id pub-id-type="doi">10.35711/aimi.v1.i3.94</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagaya</surname><given-names>M</given-names></name><name><surname>Ukita</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Embryo grading with unreliable labels due to chromosome abnormalities by regularized Pu learning with ranking</article-title><source>IEEE Transactions on Medical Imaging</source><volume>41</volume><fpage>320</fpage><lpage>331</lpage><pub-id pub-id-type="doi">10.1109/TMI.2021.3126169</pub-id><pub-id pub-id-type="pmid">34748484</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>SM</given-names></name><name><surname>Lawlor</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Predicting live birth, preterm delivery, and low birth weight in infants born from in vitro fertilisation: a prospective study of 144,018 treatment cycles</article-title><source>PLOS Medicine</source><volume>8</volume><elocation-id>e1000386</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pmed.1000386</pub-id><pub-id pub-id-type="pmid">21245905</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ng</surname><given-names>EHY</given-names></name><name><surname>Chan</surname><given-names>CCW</given-names></name><name><surname>Tang</surname><given-names>OS</given-names></name><name><surname>Yeung</surname><given-names>WSB</given-names></name><name><surname>Ho</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Endometrial and subendometrial vascularity is higher in pregnant patients with livebirth following art than in those who suffer a miscarriage</article-title><source>Human Reproduction</source><volume>22</volume><fpage>1134</fpage><lpage>1141</lpage><pub-id pub-id-type="doi">10.1093/humrep/del458</pub-id><pub-id pub-id-type="pmid">17148577</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Paszke</surname><given-names>A</given-names></name><name><surname>Gross</surname><given-names>S</given-names></name><name><surname>Massa</surname><given-names>F</given-names></name><name><surname>Lerer</surname><given-names>A</given-names></name><name><surname>Bradbury</surname><given-names>J</given-names></name><name><surname>Chanan</surname><given-names>G</given-names></name><name><surname>Killeen</surname><given-names>T</given-names></name><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Gimelshein</surname><given-names>N</given-names></name><name><surname>Antiga</surname><given-names>L</given-names></name><name><surname>Desmaison</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Pytorch: An Imperative Style, High-Performance Deep Learning Library</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.1912.01703</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raschka</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>MLxtend: providing machine learning and data science utilities and extensions to python’s scientific computing stack</article-title><source>Journal of Open Source Software</source><volume>3</volume><elocation-id>638</elocation-id><pub-id pub-id-type="doi">10.21105/joss.00638</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reignier</surname><given-names>A</given-names></name><name><surname>Girard</surname><given-names>JM</given-names></name><name><surname>Lammers</surname><given-names>J</given-names></name><name><surname>Chtourou</surname><given-names>S</given-names></name><name><surname>Lefebvre</surname><given-names>T</given-names></name><name><surname>Barriere</surname><given-names>P</given-names></name><name><surname>Freour</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Performance of day 5 kidscore</article-title><source>Journal of Assisted Reproduction and Genetics</source><volume>36</volume><fpage>2279</fpage><lpage>2285</lpage><pub-id pub-id-type="doi">10.1007/s10815-019-01567-x</pub-id><pub-id pub-id-type="pmid">31444634</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seli</surname><given-names>E</given-names></name><name><surname>Bruce</surname><given-names>C</given-names></name><name><surname>Botros</surname><given-names>L</given-names></name><name><surname>Henson</surname><given-names>M</given-names></name><name><surname>Roos</surname><given-names>P</given-names></name><name><surname>Judge</surname><given-names>K</given-names></name><name><surname>Hardarson</surname><given-names>T</given-names></name><name><surname>Ahlström</surname><given-names>A</given-names></name><name><surname>Harrison</surname><given-names>P</given-names></name><name><surname>Henman</surname><given-names>M</given-names></name><name><surname>Go</surname><given-names>K</given-names></name><name><surname>Acevedo</surname><given-names>N</given-names></name><name><surname>Siques</surname><given-names>J</given-names></name><name><surname>Tucker</surname><given-names>M</given-names></name><name><surname>Sakkas</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Receiver operating characteristic (ROC) analysis of day 5 morphology grading and metabolomic viability score on predicting implantation outcome</article-title><source>Journal of Assisted Reproduction and Genetics</source><volume>28</volume><fpage>137</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1007/s10815-010-9501-9</pub-id><pub-id pub-id-type="pmid">21063765</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solorio-Fernández</surname><given-names>S</given-names></name><name><surname>Carrasco-Ochoa</surname><given-names>JA</given-names></name><name><surname>Martínez-Trinidad</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A review of unsupervised feature selection methods</article-title><source>Artificial Intelligence Review</source><volume>53</volume><fpage>907</fpage><lpage>948</lpage><pub-id pub-id-type="doi">10.1007/s10462-019-09682-y</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Tan</surname><given-names>M</given-names></name><name><surname>Le</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Efficientnetv2: Smaller models and faster training</article-title><conf-name>In International Conference on Machine Learning 2021</conf-name><fpage>10096</fpage><lpage>10106</lpage></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tao</surname><given-names>H</given-names></name><name><surname>Lu</surname><given-names>M</given-names></name><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Xin</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Attention-aggregated attribute-aware network with redundancy reduction convolution for video-based industrial smoke emission recognition</article-title><source>IEEE Transactions on Industrial Informatics</source><volume>18</volume><fpage>7653</fpage><lpage>7664</lpage><pub-id pub-id-type="doi">10.1109/TII.2022.3146142</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ueno</surname><given-names>S</given-names></name><name><surname>Berntsen</surname><given-names>J</given-names></name><name><surname>Ito</surname><given-names>M</given-names></name><name><surname>Uchiyama</surname><given-names>K</given-names></name><name><surname>Okimura</surname><given-names>T</given-names></name><name><surname>Yabuuchi</surname><given-names>A</given-names></name><name><surname>Kato</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Pregnancy prediction performance of an annotation-free embryo scoring system on the basis of deep learning after single vitrified-warmed blastocyst transfer: a single-center large cohort retrospective study</article-title><source>Fertility and Sterility</source><volume>116</volume><fpage>1172</fpage><lpage>1180</lpage><pub-id pub-id-type="doi">10.1016/j.fertnstert.2021.06.001</pub-id><pub-id pub-id-type="pmid">34246469</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>VerMilyea</surname><given-names>M</given-names></name><name><surname>Hall</surname><given-names>JMM</given-names></name><name><surname>Diakiw</surname><given-names>SM</given-names></name><name><surname>Johnston</surname><given-names>A</given-names></name><name><surname>Nguyen</surname><given-names>T</given-names></name><name><surname>Perugini</surname><given-names>D</given-names></name><name><surname>Miller</surname><given-names>A</given-names></name><name><surname>Picou</surname><given-names>A</given-names></name><name><surname>Murphy</surname><given-names>AP</given-names></name><name><surname>Perugini</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Development of an artificial intelligence-based assessment model for prediction of embryo viability using static images captured by optical light microscopy during IVF</article-title><source>Human Reproduction</source><volume>35</volume><fpage>770</fpage><lpage>784</lpage><pub-id pub-id-type="doi">10.1093/humrep/deaa013</pub-id><pub-id pub-id-type="pmid">32240301</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Yang</surname><given-names>F</given-names></name><name><surname>Zhou</surname><given-names>T</given-names></name><name><surname>Lin</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Rethinking the Impacts of Overfitting and Feature Quality on Small-scale Video Classification</article-title><conf-name>MM ’21</conf-name><conf-loc>Virtual Event China</conf-loc><fpage>4760</fpage><lpage>4764</lpage><pub-id pub-id-type="doi">10.1145/3474085.3479226</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiong</surname><given-names>F</given-names></name><name><surname>Sun</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>P</given-names></name><name><surname>Wan</surname><given-names>C</given-names></name><name><surname>Zhong</surname><given-names>H</given-names></name><name><surname>Zeng</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A nomogram to assist blastocyst selection in vitrified‐warmed embryo transfer cycles</article-title><source>Journal of Obstetrics and Gynaecology Research</source><volume>48</volume><fpage>1816</fpage><lpage>1828</lpage><pub-id pub-id-type="doi">10.1111/jog.15138</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>C</given-names></name><name><surname>Tan</surname><given-names>X</given-names></name><name><surname>Zhou</surname><given-names>F</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Yue</surname><given-names>K</given-names></name><name><surname>Ding</surname><given-names>E</given-names></name><name><surname>Ma</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Fine-grained video categorization with redundancy reduction attention</article-title><conf-name>In Proceedings of the European Conference on Computer Vision</conf-name><fpage>136</fpage><lpage>152</lpage><pub-id pub-id-type="doi">10.1007/978-3-030-01228-1</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.83662.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Suturina</surname><given-names>Larisa V</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/027n02r78</institution-id><institution>Scientific Center for Family Health and Human Reproduction</institution></institution-wrap><country>Russian Federation</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.10.20.22281296" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.10.20.22281296"/></front-stub><body><p>This article provides important findings that have practical implications for reproductive medicine and would be of interest to IVF specialists. Based on the compelling strength of evidence, the study demonstrates significant results in improving the predictive value of the live birth model based on blastocyst evaluation and clinical features.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.83662.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Suturina</surname><given-names>Larisa V</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/027n02r78</institution-id><institution>Scientific Center for Family Health and Human Reproduction</institution></institution-wrap><country>Russian Federation</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.10.20.22281296">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.medrxiv.org/content/10.1101/2022.10.20.22281296v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Development and evaluation of a live birth prediction model for evaluating human blastocysts: a retrospective study&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Ricardo Azziz as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Please, expand the section &quot;Model architecture&quot; and clarify the details regarding &quot;decision-level features&quot;.</p><p>2) Provide the details of how parameter optimization was accomplished as well as the architectural details, i.e., the number of layers and nodes. What was the computational overhead for training these models?</p><p>3) Consider presenting the data for all significant predictors to justify the choice for inclusion in the model and verify if the important or top features MLP (using explanation methods) uses for prediction are the same as those inferred by the logistic regression.</p><p>4) Please, consider presenting in detail a weighted sampling approach used to tackle the imbalance issue.</p><p>5) The code is available only for generating figures 2, 4 reported in the paper. For figure 3, only data is available. Consider presenting this code for reproducibility purposes.</p><p>6) Please, improve the discussion of the potential applications of the proposed model in clinical settings and mention the method of testosterone assessment as a study limitation.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>The authors could mention the method of testosterone assessment as a study limitation that may cause a potential bias regarding the estimation of significance of testosterone as a predictor of live birth.</p><p>The authors could consider presenting the data for all significant predictors (of example, in the supplemental Figure 3 data) and justify the choice for inclusion in the model. It will better demonstrate the correctness of the selection of predictors</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>I quite enjoyed reading the article. Overall, the motivation and concepts are well defined; however, the manuscript lacks the necessary methodological details, which hindered my ability to fully understand and appreciate the work.</p><p>The link between CNN and MLP architecture in the final integrated model is unclear. The section &quot;Model architecture&quot; needs to be expanded. It is not clear what &quot;decision-level features&quot; are from CNN or MLP. Are these features from the CNN's fully connected layer? In MLP, are they before the final layer? And how do authors concatenate these features? These details are important to understand final architecture.</p><p>How was parameter optimization accomplished? Architectural details, i.e., the number of layers and nodes, are missing. What was the computational overhead for training these models?</p><p>It is difficult to understand the discrepancy of features between CNN with clinical features and CNN without clinical features. Maybe it is because model architecture is not well defined. For the moment, it seems like CNN was trained independently, even in the concatenated version of the model. How can you explain the discrepancy between the activation maps of these two models?</p><p>Important features were identified using logistic regression. I do not observe the link presenting these features as important features when the model was built using MLP instead. Could you verify that the important or top features MLP (using explanation methods) uses for prediction are the same as those inferred by the logistic regression?</p><p>The imbalance issue was tackled using a weighted sampling approach. This approach needs to be detailed in the main text. And how were train, val, and test partitions built in view of the distribution of minority and majority classes? Did the author verify other approaches that can help resolve this issue?</p><p>The code to reproduce the model is missing.</p><p>Discussion regarding implementation in a clinical setting would be informative. How feasible is the model's deployment in a clinic? Maybe you can further elaborate on prospective clinical trial which was mentioned in line # 363.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The study is well designed as the Materials and methods were convincing. Results are supporting the Aims. Further studies will be important for establishing the Criteria.</p><p>The challenging issue is to keep reporting the effectiveness of this predictive procedure and publish it with LBR.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.83662.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Please, expand the section &quot;Model architecture&quot; and clarify the details regarding &quot;decision-level features&quot;.</p></disp-quote><p>The decision-level features are generated from the last fully connected layer in the CNN and the last fully connected layer in the MLP. Each decision-level feature has two variables used to classify the blastocyst into the positive or negative live birth outcome category. The two decision-level features are fused by the adding operation.</p><p>To clarify this issue, we have revised the “Model architecture” section, added text in Figure 1 to indicate the last fully connected layer, and provided the code to reproduce the model. The source code has been submitted with the revised manuscript and can also be accessed at https://github.com/robotVisionHang/LiveBirthPrediction_Data_Code.</p><p>The revised “Model architecture” section now reads:</p><p>“Figure 1 shows the architecture of the live birth prediction model based on multi-modal blastocyst evaluation. It consists of a CNN to process blastocyst images and an MLP to process patient couple's clinical features. Features from the CNN and the MLP are fused; thus, the model can be trained to simultaneously take into account both blastocyst images and patient couple's clinical features for live birth prediction. The last fully connected layer in the CNN and the last fully connected layer in the MLP each output a decision-level feature, which has two variables used to classify the blastocyst into the positive or negative live birth outcome category. The adding operation fuses decision-level features from the CNN and the MLP, and the result of addition is taken as the final output of the overall live birth prediction model.”</p><disp-quote content-type="editor-comment"><p>2) Provide the details of how parameter optimization was accomplished as well as the architectural details, i.e., the number of layers and nodes. What was the computational overhead for training these models?</p></disp-quote><p>To clarify this issue, we have added paragraph 3 in the “Model implementation and training” section:</p><p>“Model performance is subject to training hyperparameters (e.g., optimizer, learning rate, batch size, number of layers). Hence, an automatic hyperparameter-tuning tool is used, Facebook Ax (https://github.com/facebook/Ax), to search for the optimal hyperparameters for model training. The selected hyperparameters for training the model include a batch size of 16, an SGD optimizer with a learning rate of 0.008 and a momentum of 0.39, and three hidden layers in the MLP. A dropout layer follows each hidden layer in the MLP to prevent overfitting. The number of nodes in each hidden layer is 6836, 5657, and 468, respectively. The dropout rate in each dropout layer is 0.01, 0.07, and 0.67, respectively. The model was trained with four RTX A6000 GPUs. It took about 30 hours to search for the optimal hyperparameters and about an hour to train the model using the optimal hyperparameters.”</p><disp-quote content-type="editor-comment"><p>3) Consider presenting the data for all significant predictors to justify the choice for inclusion in the model and verify if the important or top features MLP (using explanation methods) uses for prediction are the same as those inferred by the logistic regression.</p></disp-quote><p>The AUC of the model using all significant predictors and blastocyst images is 0.75, lower than the AUC (0.77) achieved by the model using logistic regression-selected clinical features and blastocyst images, and the AUC (0.76) achieved by the model using MLP-selected clinical features and blastocyst images. Feature selection reduces the input feature dimensions by removing redundant features and features with limited predictive power, thus improving the model generalization capability.</p><p>To follow the reviewer’s suggestion, we used the sequential forward feature selection method to perform MLP-based feature selection. It is explainable in that features are sequentially added to an empty candidate set until the addition of further features does not increase the prediction accuracy. Note that we searched for the optimal MLP parameters (e.g., number of layers, nodes, dropout rate) and training parameters (e.g., optimizer, learning rate) to accurately evaluate the predictive power of each feature candidate.</p><p>The MLP-based feature selection method selected 14 clinical features. Compared with the 16 clinical features selected by logistic regression (LR), 12 of the 16 clinical features were selected by both MLP and logistic regression, and the top 9 features are the same. The two clinical features selected by MLP but not by LR include fresh semen (yes/no) and follicle stimulating hormone (FSH) on day 3 after period. The four clinical features selected by LR but not MLP include number of ovarian stimulation cycles, progesterone (P) on HCG day, maternal body mass index (BMI), and free thyroxine (FT4) on day 3 after period. The AUC (0.77) achieved by the model using LR-selected clinical features and blastocyst images and the AUC (0.76) achieved by the model using MLP-selected clinical features and blastocyst images show no significant difference (p-value = 0.95 &gt; 0.05).</p><p>Furthermore, the MLP-based feature selection took a few days due to the processes of iterative feature searching/testing and tuning hyperparameters. The LR-based feature selection is much more efficient and only takes a few minutes.</p><p>To clarify this issue, we have now added the data regarding the AUC of the model using all significant predictors in and blastocyst images and the MLP-based feature selection results in Figure 3-supplement 1, 2.</p><disp-quote content-type="editor-comment"><p>4) Please, consider presenting in detail a weighted sampling approach used to tackle the imbalance issue.</p></disp-quote><p>To clarify this issue, we have added details regarding the weighted sampling approach in paragraph 2 in the “Model implementation and training” section:</p><p>“In the weighted sampling approach, the probability of each item to be selected is determined by its weight, and the weight of each item is assigned by inverse class frequencies. In this way, the weighted sampling approach rebalances the class distributions by oversampling the minority class and under-sampling the majority class.”</p><disp-quote content-type="editor-comment"><p>5) The code is available only for generating figures 2, 4 reported in the paper. For figure 3, only data is available. Consider presenting this code for reproducibility purposes.</p></disp-quote><p>We have provided the source code for generating figure 3. The source code has been submitted with the revised manuscript and can also be accessed at https://github.com/robotVisionHang/LiveBirthPrediction_Data_Code</p><disp-quote content-type="editor-comment"><p>6) Please, improve the discussion of the potential applications of the proposed model in clinical settings and mention the method of testosterone assessment as a study limitation.</p></disp-quote><p>1) The potential application of the proposed model in clinical settings is to improve blastocyst selection. Among the various factors contributing to IVF outcomes, the quality (i.e., developmental potential) of the selected blastocyst for transfer is a major factor determining IVF success. Existing approaches for evaluating and selecting blastocysts are based on manually observing blastocyst morphology grade, which have shown limited predictive power on live birth outcomes of blastocysts (e.g., AUC = 0.58-0.61).</p><p>The proposed model achieved a significantly higher accuracy in evaluating the live birth potential of blastocysts (AUC = 0.77) for best blastocyst selection to improve the live birth rate. When the proposed model is applied in clinical practice for blastocyst selection, it takes images of multiple blastocysts of a same patient and patient couple’s clinical features as input, outputs the live birth probability of each blastocyst, and identifies the best blastocyst having the highest live birth probability.</p><p>To clarify this issue, we have added following contents on page 13:</p><p>“The proposed live birth prediction model improves the evaluation of a blastocyst in terms of its live birth potential for best blastocyst selection from multiple blastocysts of a patient. The next step is to validate the model’s prediction accuracy using prospectively collected data and verify its effectiveness in blastocyst selection via a randomized controlled trial (RCT). Patients enrolled in the RCT will be split into the study group and the control group (1:1 ratio). In the study group, the model selects a top blastocyst having the highest probability of live birth for transfer, and in the control group, embryologists select a top blastocyst based on their routine morphological grading for transfer. Live birth outcomes of both groups will be tracked and compared.”</p><p>2) The testosterone (T) included in the clinical feature analysis is total T measuring both free T and bioavailable T.</p><p>To clarify this issue, we revised the name of testosterone in Supplementary file 1, which now reads: “Total testosterone on day 3 after period”.</p><p>We also mentioned this as a study limitation on page 12:</p><p>“Note that in this study, only the total testosterone (T) was analyzed, and free T or bioavailable T was not available for clinical feature analysis (see Supplementary file 1). This may cause potential bias in determining the significance of testosterone as a predictor of live birth.”</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>The authors could mention the method of testosterone assessment as a study limitation that may cause a potential bias regarding the estimation of significance of testosterone as a predictor of live birth.</p></disp-quote><p>To clarify this issue, we revised the name of testosterone in Supplementary Table Ⅰ, which now reads: “Total testosterone on day 3 after period”.</p><p>We also mentioned this as a study limitation on page 12:</p><p>“Note that in this study, only the total testosterone (T) was analyzed, and free T or bioavailable T was not available for clinical feature analysis (see Supplementary file 1). This may cause potential bias in determining the significance of testosterone as a predictor of live birth.”</p><disp-quote content-type="editor-comment"><p>The authors could consider presenting the data for all significant predictors (of example, in the supplemental Figure 3 data) and justify the choice for inclusion in the model. It will better demonstrate the correctness of the selection of predictors</p></disp-quote><p>The AUC of the model using all significant predictors and blastocyst images is 0.75, lower than the AUC (0.77) achieved by the model using logistic regression-selected clinical features and blastocyst images, and the AUC (0.76) achieved by the model using MLP-selected clinical features and blastocyst images. Feature selection reduces the input feature dimensions by removing redundant features and features with limited predictive power, thus improving the model generalization capability.</p><p>To clarify this issue, we have added the ROC curve comparisons Figure 3-supplement 1:</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>I quite enjoyed reading the article. Overall, the motivation and concepts are well defined; however, the manuscript lacks the necessary methodological details, which hindered my ability to fully understand and appreciate the work.</p><p>The link between CNN and MLP architecture in the final integrated model is unclear. The section &quot;Model architecture&quot; needs to be expanded. It is not clear what &quot;decision-level features&quot; are from CNN or MLP. Are these features from the CNN's fully connected layer? In MLP, are they before the final layer? And how do authors concatenate these features? These details are important to understand final architecture.</p></disp-quote><p>The decision-level features are generated from the last fully connected layer in the CNN and the last fully connected layer in the MLP. Each decision-level feature has two variables used to classify the blastocyst into the positive or negative live birth outcome category. The two decision-level features are fused by the adding operation.</p><p>To clarify this issue, we have revised the “Model architecture” section, added text in Figure 1 to indicate the last fully connected layer, and provided the code to reproduce the model. The source code has been submitted with the revised manuscript and can also be accessed at https://github.com/robotVisionHang/LiveBirthPrediction_Data_Code.</p><p>The revised “Model architecture” section now reads:</p><p>“Figure 1 shows the architecture of the live birth prediction model based on multi-modal blastocyst evaluation. It consists of a CNN to process blastocyst images and an MLP to process patient couple's clinical features. Features from the CNN and the MLP are fused; thus, the model can be trained to simultaneously take into account both blastocyst images and patient couple's clinical features for live birth prediction. The last fully connected layer in the CNN and the last fully connected layer in the MLP each output a decision-level feature, which has two variables used to classify the blastocyst into the positive or negative live birth outcome category. The adding operation fuses decision-level features from the CNN and the MLP, and the result of addition is taken as the final output of the overall live birth prediction model.”</p><disp-quote content-type="editor-comment"><p>How was parameter optimization accomplished? Architectural details, i.e., the number of layers and nodes, are missing. What was the computational overhead for training these models?</p></disp-quote><p>To clarify this issue, we have added paragraph 3 in the “Model implementation and training” section:</p><p>“Model performance is subject to training hyperparameters (e.g., optimizer, learning rate, batch size, number of layers). Hence, an automatic hyperparameter-tuning tool is used, Facebook Ax (https://github.com/facebook/Ax), to search for the optimal hyperparameters for model training. The selected hyperparameters for training the model include a batch size of 16, an SGD optimizer with a learning rate of 0.008 and a momentum of 0.39, and three hidden layers in the MLP. A dropout layer follows each hidden layer in the MLP to prevent overfitting. The number of nodes in each hidden layer is 6836, 5657, and 468, respectively. The dropout rate in each dropout layer is 0.01, 0.07, and 0.67, respectively. The model was trained with four RTX A6000 GPUs. It took about 30 hours to search for the optimal hyperparameters and about an hour to train the model using the optimal hyperparameters.”</p><disp-quote content-type="editor-comment"><p>It is difficult to understand the discrepancy of features between CNN with clinical features and CNN without clinical features. Maybe it is because model architecture is not well defined. For the moment, it seems like CNN was trained independently, even in the concatenated version of the model. How can you explain the discrepancy between the activation maps of these two models?</p></disp-quote><p>The CNN and the MLP are connected by the two decision-level features. The adding operation fuses decision-level features from the CNN and the MLP, and the addition result is taken as the final output of the overall live birth prediction model. Thus, the model weights of the CNN and the MLP were trained simultaneously.</p><p>Another finding of this study, by comparing the heatmaps of the CNN trained without and with the inclusion of patient couple's clinical features, is that the weights of TE-related features increased (see Figure 4). A potential reason may be that TE and the endometrium status-related features (e.g., endometrium thickness and pattern) play critical roles when a blastocyst initiates implantation, and a positive live birth outcome is not possible without the success of this implantation process (Ahlström et al., 2011; Hill et al., 2013; Chen et al., 2014; Bakkensen et al., 2019).</p><p>To clarify this issue, we have revised the “Model architecture” section. The explanation of the discrepancy between the heatmaps of the CNN trained without and with clinical features is added on page 12:</p><p>“Another finding of this study, by comparing the heatmaps of the CNN trained without and with the inclusion of patient couple's clinical features, is that the weights of TE-related features increased (see Figure 4). A potential reason may be that TE and the endometrium status-related features (e.g., endometrium thickness and pattern) play critical roles when a blastocyst initiates implantation, and a positive live birth outcome is not possible without the success of this implantation process (Ahlström et al., 2011; Hill et al., 2013; Chen et al., 2014; Bakkensen et al., 2019).”</p><disp-quote content-type="editor-comment"><p>Important features were identified using logistic regression. I do not observe the link presenting these features as important features when the model was built using MLP instead. Could you verify that the important or top features MLP (using explanation methods) uses for prediction are the same as those inferred by the logistic regression?</p></disp-quote><p>To follow the reviewer’s suggestion, we used the sequential forward feature selection method to perform MLP-based feature selection. It is explainable in that features are sequentially added to an empty candidate set until the addition of further features does not increase the prediction accuracy. Note that we searched for the optimal MLP parameters (e.g., number of layers, nodes, dropout rate) and training parameters (e.g., optimizer, learning rate) to accurately evaluate the predictive power of each feature candidate.</p><p>The MLP-based feature selection method selected 14 clinical features. Compared with the 16 clinical features selected by logistic regression (LR), 12 of the 16 clinical features were selected by both MLP and logistic regression, and the top 9 features are the same. The two clinical features selected by MLP but not by LR include fresh semen (yes/no) and follicle stimulating hormone (FSH) on day 3 after period. The four clinical features selected by LR but not MLP include number of ovarian stimulation cycles, progesterone (P) on HCG day, maternal body mass index (BMI), and free thyroxine (FT4) on day 3 after period. The AUC (0.77) achieved by the model using LR-selected clinical features and blastocyst images and the AUC (0.76) achieved by the model using MLP-selected clinical features and blastocyst images show no significant difference (p-value = 0.95 &gt; 0.05).</p><p>Furthermore, the MLP-based feature selection took a few days due to the processes of iterative feature searching/testing and tuning hyperparameters. The LR-based feature selection is much more efficient and only takes a few minutes.</p><p>To clarify this issue, we have now added the data regarding the AUC of the model using all significant predictors and blastocyst images and the MLP-based feature selection results in Figure 3-supplement 1, 2:</p><disp-quote content-type="editor-comment"><p>The imbalance issue was tackled using a weighted sampling approach. This approach needs to be detailed in the main text. And how were train, val, and test partitions built in view of the distribution of minority and majority classes? Did the author verify other approaches that can help resolve this issue?</p></disp-quote><p>We have added details regarding the weighted sampling approach in paragraph 2, the “Model implementation and training” section. We also verified the approach of using weighted cross-entropy loss. We found that both approaches can be used to mitigate the prediction bias towards the majority class. The weighted sampling approach performed better and was selected for the final model training.</p><p>The stratified random sampling approach was used to ensure that all split datasets (training, validation, and testing datasets) have the same distribution of minority and majority classes.</p><p>To clarify this issue, we have revised the following contents in paragraph 2, the “Model implementation and training” section:</p><p>“The blastocysts were randomly split into 80%:10%:10% to construct the training, validation, and testing datasets. The stratified random sampling approach was used to ensure that all split datasets have the same distribution of minority and majority classes. Since the ratio of blastocysts with a positive live birth outcome in the dataset is 0.368, to mitigate the model's prediction bias towards the majority category (i.e., the negative live birth outcome), the weighted sampling approach, which can help rebalance the class distributions when sampling from an imbalanced dataset (Feng et al., 2021), was employed for training the model. In the weighted sampling approach, the probability of each item to be selected is determined by its weight, and the weight of each item is assigned by inverse class frequencies. In this way, the weighted sampling approach rebalances the class distributions by oversampling the minority class and under-sampling the majority class. We also verified the approach of using weighted cross-entropy loss, which assigns greater weights to the loss caused by the prediction error of minority classes. Both approaches helped mitigate the prediction bias towards the majority class, and the results showed that the weighted sampling approach outperformed the weighted cross-entropy loss method.”</p><disp-quote content-type="editor-comment"><p>The code to reproduce the model is missing.</p></disp-quote><p>We have provided the source code to reproduce the model. The source code has been submitted with the revised manuscript and can also be accessed at https://github.com/robotVisionHang/LiveBirthPrediction_Data_Code</p><disp-quote content-type="editor-comment"><p>Discussion regarding implementation in a clinical setting would be informative. How feasible is the model's deployment in a clinic? Maybe you can further elaborate on prospective clinical trial which was mentioned in line # 363.</p></disp-quote><p>The potential application of the proposed model in clinical settings is to improve blastocyst selection. Among the various factors contributing to IVF outcomes, the quality (i.e., developmental potential) of the selected blastocyst for transfer is a major factor determining IVF success. Existing approaches for evaluating and selecting blastocysts are based on manually observing blastocyst morphology grade, which have shown limited predictive power on live birth outcomes of blastocysts (e.g., AUC = 0.58-0.61).</p><p>The proposed model achieved a significantly higher accuracy in evaluating the live birth potential of blastocysts (AUC = 0.77) for best blastocyst selection to improve the live birth rate. When the proposed model is applied in clinical practice for blastocyst selection, it takes images of multiple blastocysts of a same patient and patient couple’s clinical features as input, outputs the live birth probability of each blastocyst, and identifies the best blastocyst having the highest live birth probability.</p><p>To clarify this issue, we have added following contents on page 13:</p><p>“The proposed live birth prediction model improves the evaluation of a blastocyst in terms of its live birth potential for best blastocyst selection from multiple blastocysts of a patient. The next step is to validate the model’s prediction accuracy using prospectively collected data and verify its effectiveness in blastocyst selection via a randomized controlled trial (RCT). Patients enrolled in the RCT will be split into the study group and the control group (1:1 ratio). In the study group, the model selects a top blastocyst having the highest probability of live birth for transfer, and in the control group, embryologists select a top blastocyst based on their routine morphological grading for transfer. Live birth outcomes of both groups will be tracked and compared.”</p></body></sub-article></article>