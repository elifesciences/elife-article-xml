<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">04811</article-id><article-id pub-id-type="doi">10.7554/eLife.04811</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Homeostatic reinforcement learning for integrating reward collection and physiological stability</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-10538"><name><surname>Keramati</surname><given-names>Mehdi</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-4"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-6744"><name><surname>Gutkin</surname><given-names>Boris</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="other" rid="par-5"/><xref ref-type="other" rid="par-6"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Group for Neural Theory, INSERM U960, Departément des Etudes Cognitives</institution>, <institution>Ecole Normale Supérieure, PSL Research University</institution>, <addr-line><named-content content-type="city">Paris</named-content></addr-line>, <country>France</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Gatsby Computational Neuroscience Unit</institution>, <institution>University College London</institution>, <addr-line><named-content content-type="city">London</named-content></addr-line>, <country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Center for Cognition and Decision Making</institution>, <institution>National Research University Higher School of Economics</institution>, <addr-line><named-content content-type="city">Moscow</named-content></addr-line>, <country>Russia</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Marder</surname><given-names>Eve</given-names></name><role>Reviewing editor</role><aff><institution>Brandeis University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>mehdi@gatsby.ucl.ac.uk</email> (MK);</corresp><corresp id="cor2"><email>boris.gutkin@ens.fr</email> (BG)</corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>02</day><month>12</month><year>2014</year></pub-date><pub-date pub-type="collection"><year>2014</year></pub-date><volume>3</volume><elocation-id>e04811</elocation-id><history><date date-type="received"><day>18</day><month>09</month><year>2014</year></date><date date-type="accepted"><day>03</day><month>11</month><year>2014</year></date></history><permissions><copyright-statement>Copyright © 2014, Keramati and Gutkin</copyright-statement><copyright-year>2014</copyright-year><copyright-holder>Keramati and Gutkin</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-04811-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.04811.001</object-id><p>Efficient regulation of internal homeostasis and defending it against perturbations requires adaptive behavioral strategies. However, the computational principles mediating the interaction between homeostatic and associative learning processes remain undefined. Here we use a definition of primary rewards, as outcomes fulfilling physiological needs, to build a normative theory showing how learning motivated behaviors may be modulated by internal states. Within this framework, we mathematically prove that seeking rewards is equivalent to the fundamental objective of physiological stability, defining the notion of physiological rationality of behavior. We further suggest a formal basis for temporal discounting of rewards by showing that discounting motivates animals to follow the shortest path in the space of physiological variables toward the desired setpoint. We also explain how animals learn to act predictively to preclude prospective homeostatic challenges, and several other behavioral patterns. Finally, we suggest a computational role for interaction between hypothalamus and the brain reward system.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.001">http://dx.doi.org/10.7554/eLife.04811.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.04811.002</object-id><title>eLife digest</title><p>Our survival depends on our ability to maintain internal states, such as body temperature and blood sugar levels, within narrowly defined ranges, despite being subject to constantly changing external forces. This process, which is known as homeostasis, requires humans and other animals to carry out specific behaviors—such as seeking out warmth or food—to compensate for changes in their environment. Animals must also learn to prevent the potential impact of changes that can be anticipated.</p><p>A network that includes different regions of the brain allows animals to perform the behaviors that are needed to maintain homeostasis. However, this network is distinct from the network that supports the learning of new behaviors in general. These two systems must, therefore, interact so that animals can learn novel strategies to support their physiological stability, but it is not clear how animals do this.</p><p>Keramati and Gutkin have now devised a mathematical model that explains the nature of this interaction, and that can account for many behaviors seen among animals, even those that might otherwise appear irrational. There are two assumptions at the heart of the model. First, it is assumed that animals are capable of guessing the impact of the outcome of their behaviors on their internal state. Second, it is assumed that animals find a behavior rewarding if they believe that the predicted impact of its outcome will reduce the difference between a particular internal state and its ideal value. For example, a form of behavior for a human might be going to the kitchen, and an outcome might be eating chocolate.</p><p>Based on these two assumptions, the model shows that animals stabilize their internal state around its ideal value by simply learning to perform behaviors that lead to rewarding outcomes (such as going into the kitchen and eating chocolate). Their theory also explains the physiological importance of a type of behavior known as ‘delay discounting’. Animals displaying this form of behavior regard a positive outcome as less rewarding the longer they have to wait for it. The model proves mathematically that delay discounting is a logical way to optimize homeostasis.</p><p>In addition to making a number of predictions that could be tested in experiments, Keramati and Gutkin argue that their model can account for the failure of homeostasis to limit food consumption whenever foods loaded with salt, sugar or fat are freely available.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.002">http://dx.doi.org/10.7554/eLife.04811.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>reinforcement learning</kwd><kwd>homeostatic regulation</kwd><kwd>cortico-basal ganglia</kwd><kwd>hypothalamus</kwd><kwd>temporal discounting</kwd><kwd>anticipatory responding</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000324</institution-id><institution>Gatsby Charitable Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Keramati</surname><given-names>Mehdi</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution content-type="dept">National Research University Higher School of Economics</institution></institution-wrap></funding-source><award-id>Basic Research Program</award-id><principal-award-recipient><name><surname>Gutkin</surname><given-names>Boris</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001677</institution-id><institution>Institut national de la santé et de la recherche médicale</institution></institution-wrap></funding-source><award-id>INSERM U960, France</award-id><principal-award-recipient><name><surname>Gutkin</surname><given-names>Boris</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution>Center for Research and Interdisciplinary</institution></institution-wrap></funding-source><award-id>Frontiers du Vivant</award-id><principal-award-recipient><name><surname>Keramati</surname><given-names>Mehdi</given-names></name></principal-award-recipient></award-group><award-group id="par-5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>ANR-10-LABX-0087 IEC, France</award-id><principal-award-recipient><name><surname>Gutkin</surname><given-names>Boris</given-names></name></principal-award-recipient></award-group><award-group id="par-6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>ANR-10-IDEX-0001-02 PSL, France</award-id><principal-award-recipient><name><surname>Gutkin</surname><given-names>Boris</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.0</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A mathematical model built around the assumption that the desire to maintain internal homeostasis drives the behavior of animals, by affecting their learning processes, can explain many real-world behaviors, including some that might otherwise appear irrational.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Survival requires living organisms to maintain their physiological integrity within the environment. In other words, they must preserve homeostasis (e.g. body temperature, glucose level, etc.). Yet, how might an animal learn to structure its behavioral strategies to obtain the outcomes necessary to fulfill and even preclude homeostatic challenges? Such, efficient behavioral decisions surely should depend on two brain circuits working in concert: the hypothalamic homeostatic regulation (HR) system, and the cortico-basal ganglia reinforcement learning (RL) mechanism. However, the computational mechanisms underlying this obvious coupling remain poorly understood.</p><p>The previously developed classical negative feedback models of HR have tried to explain the hypothalamic function in behavioral sensitivity to the ‘internal’ state, by axiomatizing that animals minimize the deviation of some key physiological variables from their hypothetical setpoints (<xref ref-type="bibr" rid="bib29">Marieb &amp; Hoehn, 2012</xref>). To this end, a direct corrective response is triggered when a deviation from setpoint is sensed or anticipated (<xref ref-type="bibr" rid="bib52">Sibly &amp; McFarland, 1974</xref>; <xref ref-type="bibr" rid="bib58">Sterling, 2012</xref>). A key lacuna in these models is how a simple corrective action (e.g. ‘go eat’) in response to a homeostatic deficit might be translated into a complex behavioral strategy for interacting with the dynamic and uncertain external world.</p><p>On the other hand, the computational theory of RL has proposed a viable computational account for the role of the cortico-basal ganglia system in behavioral adaptation to the ‘external’ environment, by exploiting experienced environmental contingencies and reward history (<xref ref-type="bibr" rid="bib59">Sutton &amp; Barto, 1998</xref>; <xref ref-type="bibr" rid="bib42">Rangel et al., 2008</xref>). Critically, this theory is built upon one major axiom, namely, that the objective of behavior is to maximize reward acquisition. Yet, this suite of theoretical models does not resolve how the brain constructs the reward itself, and how the variability of the internal state impacts overt behavior.</p><p>Accumulating neurobiological evidence indicates intricate intercommunication between the hypothalamus and the reward-learning circuitry (<xref ref-type="bibr" rid="bib40">Palmiter, 2007</xref>; <xref ref-type="bibr" rid="bib68">Yeo &amp; Heisler, 2012</xref>; <xref ref-type="bibr" rid="bib41">Rangel, 2013</xref>). The integration of the two systems is also behaviorally manifest in the classical behavioral pattern of anticipatory responding in which, animals learn to act predictively to preclude prospective homeostatic challenges. Moreover, the ‘good regulator’ theoretical principle implies that ‘every good regulator of a system must be a model of that system’ (<xref ref-type="bibr" rid="bib13">Conant &amp; Ashby, 1970</xref>), accentuating the necessity of learning a model (either explicit or implicit) of the environment in order to regulate internal variables, and thus, the necessity of associative learning processes being involved in homeostatic regulation.</p><p>Given the apparent coupling of homeostatic and learning processes, here, we propose a formal hypothesis for the computations, at an algorithmic level, that may be performed in this biological integration of the two systems. More precisely, inspired by previous descriptive hypotheses on the interaction between motivation and learning (<xref ref-type="bibr" rid="bib24">Hull, 1943</xref>; <xref ref-type="bibr" rid="bib57">Spence, 1956</xref>; <xref ref-type="bibr" rid="bib35">Mowrer, 1960</xref>), we suggest a principled model for how the rewarding value of outcomes is computed as a function of the animal's internal state, and of the approximated need-reduction ability of the outcome. The computed reward is then made available to RL systems that learn over a state-space including both internal and external states, resulting in approximate reinforcement of instrumental associations that reduce or prevent homeostatic imbalance.</p><p>The paper is structured as follows: After giving a heuristic sketch of the theory, we show several analytical, behavioral, and neurobiological results. On the basis of the proposed computational integration of the two systems, we prove analytically that reward-seeking and physiological stability are two sides of the same coin, and also provide a normative explanation for temporal discounting of reward. Behaviorally, the theory gives a plausible unified account for anticipatory responding and the rise-fall pattern of the response rate. We show that the interaction between the two systems is critical in these behavioral phenomena and thus, neither classical RL nor classical HR theories can account for them. Neurobiologically, we show that our model can shed light on recent findings on the interaction between the hypothalamus and the reward-learning circuitry, namely, the modulation of dopaminergic activity by hypothalamic signals. Furthermore, we show how orosensory information can be integrated with internal signals in a principled way, resulting in accounting for experimental results on consummatory behaviors, as well as the pathological condition of over-eating induced by hyperpalatability. Finally, we discuss limitations of the theory, compare it with other theoretical accounts of motivation and internal state regulation, and outline testable predictions and future directions.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Theory sketch</title><p>A self-organizing system (i.e. an organism) can be defined as a system that opposes the second law of thermodynamics (<xref ref-type="bibr" rid="bib20">Friston, 2010</xref>). In other words, biological systems actively resist the natural tendency to disorder by regulating their physiological state to fall within narrow bounds. This general process, known as homeostasis (<xref ref-type="bibr" rid="bib10">Cannon, 1929</xref>; <xref ref-type="bibr" rid="bib3">Bernard, 1957</xref>), includes adaptive behavioral strategies for counteracting and preventing self-entropy in the face of constantly changing environments. In this sense, one would expect organisms to reinforce responses that mitigate deviation of the internal state from desired ‘setpoints’. This is reminiscent of the drive-reduction theory (<xref ref-type="bibr" rid="bib24">Hull, 1943</xref>; <xref ref-type="bibr" rid="bib57">Spence, 1956</xref>; <xref ref-type="bibr" rid="bib35">Mowrer, 1960</xref>) according to which, one of the major mechanisms underlying reward is the usefulness of the corresponding outcome in fulfilling the homeostatic needs of the organism (<xref ref-type="bibr" rid="bib9">Cabanac, 1971</xref>). Inspired by these considerations (i.e. preservation of self-order and reduction of deviations), we propose a formal definition of primary reward (equivalently: reinforcer, economic utility) as the approximated ability of an outcome to restore the internal equilibrium of the physiological state. We then demonstrate that our formal homeostatic reinforcement learning framework accounts for some phenomena that classical drive-reduction was unable to explain.</p><p>We first define ‘homeostatic space’ as a multidimensional metric space in which each dimension represents one physiologically-regulated variable (the horizontal plane in <xref ref-type="fig" rid="fig1">Figure 1</xref>). The physiological state of the animal at each time <italic>t</italic> can be represented as a point in this space, denoted by <inline-formula><mml:math id="inf1"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf2"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> indicates the state of the <italic>i</italic>-th physiological variable. For example, <inline-formula><mml:math id="inf4"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can refer to the animal's glucose level, body temperature, plasma osmolality, etc. The homeostatic setpoint, as the ideal internal state, can be denoted by <inline-formula><mml:math id="inf5"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>N</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. As a mapping from the physiological to the motivational state, we define the ‘drive’ as the distance of the internal state from the setpoint (the three-dimensional surface in <xref ref-type="fig" rid="fig1">Figure 1</xref>):<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mroot><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">*</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mi>m</mml:mi></mml:mroot></mml:mrow></mml:math></disp-formula><italic>m</italic> and <italic>n</italic> are free parameters that induce important nonlinear effects on the mapping between homeostatic deviations and their motivational consequences. Note that for the simple case of <italic>m</italic> = <italic>n</italic> = 1, the drive function reduces to Euclidian distance. We will later consider more general nonlinear mappings in terms of classical utility theory. We will also discuss that the drive function can be viewed as equivalent to the information-theoretic notion of <italic>surprise</italic>, defined as the negative log-probability of finding an organism in a certain state (<inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.003</object-id><label>Figure 1.</label><caption><title>Schematics of the model in an exemplary two-dimensional homeostatic space.</title><p>Upon performing an action, the animal receives an outcome <inline-formula><mml:math id="inf7"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> from the environment. The rewarding value of this outcome depends on its ability to make the internal state, <inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, closer to the homeostatic setpoint, <inline-formula><mml:math id="inf9"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, and thus reduce the drive level (the vertical axis). This experienced reward, denoted by <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is then learned by an RL algorithm. Here a model-free RL algorithm is shown in which a reward prediction error signal is computed by comparing the realized reward and the expected rewarding value of the performed response. This signal is then used to update the subjective value attributed to the corresponding response. Subjective values of alternative choices bias the action selection process.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.003">http://dx.doi.org/10.7554/eLife.04811.003</ext-link></p></caption><graphic xlink:href="elife-04811-fig1-v1"/></fig></p><p>Having defined drive, we can now provide a formal definition for primary reward. Let's assume that as the result of an action, the animal receives an outcome <inline-formula><mml:math id="inf11"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> at time <italic>t</italic>. The impact of this outcome on different dimensions of the animal's internal state can be denoted by <inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. For example, <inline-formula><mml:math id="inf13"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can be the quantity of glucose received as a result of outcome <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Hence, the outcome results in a transition of the physiological state from <inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (See <xref ref-type="fig" rid="fig1">Figure 1</xref>) and thus, a transition of the drive state from <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. Accordingly, the rewarding value of this outcome can be defined as the consequent reduction of drive:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Intuitively, the rewarding value of an outcome depends on the ability of its constituting elements to reduce the homeostatic distance from the setpoint or equivalently, to counteract self-entropy. As discussed later, the additive effect (<inline-formula><mml:math id="inf22"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) of these constituting elements on the internal state can be approximated by the orosensory properties of outcomes. We will also discuss how erroneous estimation of drive reduction can potentially be a cause for maladaptive consumptive behaviors.</p><p>We hypothesize in this paper that the primary reward constructed as proposed in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> is used by the brain's reward learning machinery to structure behavior. Incorporating this physiological reward definition in a normative RL theory allows us to derive one major result of our theory, which is that the rationality of behavioral patterns is geared toward maintaining physiological stability.</p></sec><sec id="s2-2"><title>Rationality of the theory</title><p>Here we show that our definition of reward reconciles the RL and HR theories in terms of their normative assumptions: reward acquisition and physiological stability are mathematically equivalent behavioral objectives. More precisely, given the proposed definition of reward and given that animals discount future rewards (<xref ref-type="bibr" rid="bib11">Chung &amp; Herrnstein, 1967</xref>), any behavioral policy, <italic>π</italic>, that maximizes the sum of discounted rewards (<inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>) also minimizes the sum of discounted deviations from the setpoint, and vice versa. In fact, starting from an initial internal state <inline-formula><mml:math id="inf24"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, the sum of discounted deviations (<italic>SDD</italic>) for a certain behavioral policy <italic>π</italic> that causes the internal state to move in the homeostatic space along the trajectory <italic>p(π)</italic>, can be defined as:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>π</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>.</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></disp-formula></p><p>Similarly, the sum of discounted rewards (SDR) for a policy <italic>π</italic> can be defined as:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>π</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>.</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></disp-formula></p><p>It is then rather straightforward to show that for any initial state <inline-formula><mml:math id="inf25"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, we will have (See ‘Materials and methods’ for the proof):<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext>  </mml:mtext><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mo>:</mml:mo><mml:mo>       </mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mi>π</mml:mi></mml:munder><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>π</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mi>π</mml:mi></mml:munder><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>π</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>γ</italic> is the discount factor. In other words, the same behavioral policy satisfies optimal reward-seeking as well as optimal homeostatic maintenance. In this respect, reward acquisition sought by the RL system is an efficient means to guide an animal's behavior toward fulfilling the basic objective of defending homeostasis. Thus, our theory suggests a physiological basis for the rationality of reward seeking.</p></sec><sec id="s2-3"><title>Normative role of temporal discounting</title><p>In the domain of animal behavior, one fundamental question is why animals should discount rewards the further they are in the future. Our theory indicates that reward seeking without discounting (i.e., if <italic>γ</italic> = 1) would not lead, and may even be detrimental, to physiological stability (See ‘Materials and methods’). Intuitively, this is because a future-discounting agent would always tend to expedite bigger rewards and postpone punishments. Such an agent, therefore, tries to reduce homeostatic deviations (which is rewarding) as soon as possible, and thus, tries to find the shortest path toward the setpoint. A non-discounting agent, in contrast, can always compensate for a deviation-induced punishment by reducing that deviation any time in the future.</p><p>While the formal proof of the necessity of discounting is given in the ‘Materials and methods’, let us give an intuitive explanation. Imagine you had to plan a 1-hr hill walk from a drop-point toward a pickup point, during which you wanted to minimize the height (equivalent to drive) summed over the path you take. In this summation, if you give higher weights to your height in the near future as compared to later times, the optimum path would be to descend the hill and spend as long as possible at the bottom (i.e. homeostatic setpoint) before returning to the pickup point. <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> shows that this optimization is equivalent to optimizing the total discounted rewards along the path, given that descending and ascending steps are defined as being rewarding and punishing, respectively (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>).</p><p>In contrast, if at all points in time you give equal weights to your height, then the summed height over path only depends on the drop and pickup points, since every ascend can be compensated with a descend at any time. In other words, in the absence of discounting, the rewarding value of a behavioral policy that changes the internal state only depends on the initial and final internal states, regardless of its trajectory in the homeostatic space. Thus, when <italic>γ</italic> = 1, the values of any two behavioral policies with equal net shifts of the internal state are equal, even if one policy moves the internal state along the shortest path, whereas the other policy results in large deviations of the internal state from the setpoint and threatens survival. These results hold for any form of temporal discounting (e.g., exponential, hyperbolic). In this respect, our theory provides a normative explanation for the necessity of temporal discounting of reward: to maintain internal stability, it is necessary to discount future rewards.</p></sec><sec id="s2-4"><title>A normative account of anticipatory responding</title><p>A paradigmatic example of behaviors governed by the internal state is the anticipatory responses geared to preclude perturbations in regulated variables even before any physiological depletion (negative feedback) is detectable. Anticipatory eating and drinking that occur before any discernible homeostatic deviation (<xref ref-type="bibr" rid="bib66">Woods &amp; Seeley, 2002</xref>), anticipatory shivering in response to a cue that predicts the cold (<xref ref-type="bibr" rid="bib27">Mansfield et al., 1983</xref>; <xref ref-type="bibr" rid="bib22">Hjeresen et al., 1986</xref>), and insulin secretion prior to meal initiation (<xref ref-type="bibr" rid="bib65">Woods, 1991</xref>), are only a few examples of anticipatory responding.</p><p>One clear example of a conditioned homeostatic response is animals' progressive tolerance to ethanol-induced hypothermia. Experiments show that when ethanol injections are preceded (i.e., are predictable) by a distinctive cue, the ethanol-induced drop of the body core temperature of animals diminishes along the trials (<xref ref-type="bibr" rid="bib28">Mansfield &amp; Cunningham, 1980</xref>). <xref ref-type="fig" rid="fig2">Figure 2</xref> shows that when the temperature was measured 30, 60, 90, and 120 min after daily injections, the drop of temperature below the baseline was significant on the first day, but gradually disappeared over 8 days. Interestingly, in the first extinction trial on the ninth day where the ethanol was omitted, the animal's temperature exhibited a significant increase above normal after cue presentation. This indicates that the enhanced tolerance response to ethanol is triggered by the cue, and results in an increase of temperature in order to compensate for the forthcoming ethanol-induced hypothermia. Thus, this tolerance response is mediated by associative learning processes, and is aimed at regulating temperature. Here we demonstrate that the integration of HR and RL processes accounts for this phenomenon.<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.004</object-id><label>Figure 2.</label><caption><title>Experimental results (adapted from <xref ref-type="bibr" rid="bib28">Mansfield &amp; Cunningham, 1980</xref>) on the acquisition and extinction of conditioned tolerance response to ethanol.</title><p>(<bold>A</bold>) In each block (day) of the experiment, the animal received ethanol injection after the presentation of the stimulus. (<bold>B</bold>) The change in the body temperature was measured 30, 60, 90, and 120 min after ethanol administration. Initially, the hypothermic effect of ethanol decreased the body temperature of animals. After several training days, however, animals learned to activate a tolerance response upon observing the stimulus, resulting in smaller deviations from the temperature setpoint. If the stimulus was not followed by ethanol injection, as in the first day of extinction (E1), the activation of the conditioned tolerance response resulted in an increase in body temperature. The tolerance response was weakened after several (four) extinction sessions, resulting in increased deviation from the setpoint in the first day of re-acquisition (R1), where presentation of the cue was again followed by ethanol injection.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.004">http://dx.doi.org/10.7554/eLife.04811.004</ext-link></p></caption><graphic xlink:href="elife-04811-fig2-v1"/></fig></p><p>We simulate the model in an artificial environment where on every trial, the agent can choose between initiating a tolerance response and doing nothing, upon observing a cue (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). The cue is then followed by a forced drop of temperature, simulating the effect of ethanol (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). We also assume that in the absence of injection, the temperature does not change. However, if the agent chooses to initiate the tolerance response in this condition, the temperature increases gradually (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Thus, if ethanol injection is preceded by cue-triggered tolerance response, the combined effect (<xref ref-type="fig" rid="fig3">Figure 3F</xref>, as superposition of <xref ref-type="fig" rid="fig3">Figure 3B,D</xref>) will have less deviation from the setpoint as compared to when no response is taken (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). As punishment (as the opposite of reward) in our model is defined by the extent to which the deviation from the setpoint increases, the ‘null’ response will have a bigger punishing value than the ‘tolerance’ response and thus, the agent gradually reinforces the ‘tolerance’ action (<xref ref-type="fig" rid="fig3">Figure 3C</xref>) (More precisely, the rewarding value of each action is defined by the sum of discounted drive-reductions during the 24 hr upon taking that action). This results in gradual fade of the ethanol-induced deviation of temperature from setpoint (<xref ref-type="fig" rid="fig3">Figure 3E</xref>; See <xref ref-type="supplementary-material" rid="SD1-data">Figure 3—source data 1</xref> for simulation details).<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.005</object-id><label>Figure 3.</label><caption><title>Simulation result on anticipatory responding.</title><p>(<bold>A</bold>) In every trial, the simulated agent can choose between initiating a tolerance response and doing nothing, upon observing the stimulus. Regardless of the agent's choice, ethanol is administered after 1 hr, followed by four temperature measurements every 30 min. (<bold>B</bold>) Dynamics of temperature upon ethanol injection. (<bold>C</bold>) Learning curve for choosing the ‘tolerance’ response. (<bold>D</bold>) Dynamics of temperature upon initiating the tolerance response. (<bold>E</bold>) Temperature profile during several simulated trails. (<bold>F</bold>) Dynamics of temperature upon initiating the tolerance response, followed by ethanol administration. Plots c and e are averaged over 500 simulated agents.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.005">http://dx.doi.org/10.7554/eLife.04811.005</ext-link></p><p><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.04811.006</object-id><label>Figure 3—source data 1.</label><caption><title>Free parameters for the anticipatory responding simulation.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.006">http://dx.doi.org/10.7554/eLife.04811.006</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-04811-fig3-data1-v1.docx"/></supplementary-material></p></caption><graphic xlink:href="elife-04811-fig3-v1"/></fig></p><p>Clearly, if after this learning process cue-presentation is no longer followed by ethanol injection (as in the first extinction trial, E1), the cue-triggered tolerance response increases the temperate beyond the setpoint (<xref ref-type="fig" rid="fig3">Figure 3E</xref>).</p><p>In general, these results show that the tolerance response caused by predicted hypothermia is an optimal behavior in terms of minimizing homeostatic deviation and thus, maximizing reward. Thus, this optimal homeostatic maintenance policy is acquired by associative learning mechanisms.</p><p>Our theory implies that animals are capable of learning not only Pavlovian (e.g. shivering, or tolerance to ethanol), but also instrumental anticipatory responding (e.g., pressing a lever to receive warmth, in response to a cold-predicting cue). This prediction is in contrast to the theory of predictive homeostasis (also known as allostasis) where anticipatory behaviors are only <italic>reflexive</italic> responses to the predicted homeostatic deprivation upon observing cues (<xref ref-type="bibr" rid="bib67">Woods &amp; Ramsay, 2007</xref>; <xref ref-type="bibr" rid="bib58">Sterling, 2012</xref>).</p></sec><sec id="s2-5"><title>Behavioral plausibility of drive: accounting for key phenomena</title><p>The definition of the drive function (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) in our model has two degrees of freedom: <italic>m</italic> and <italic>n</italic> are free parameters whose values determine the properties of the homeostatic space metric. Appropriate choice of <italic>m</italic> and <italic>n</italic> (<italic>n</italic> &gt; <italic>m</italic> &gt; 1) permits our theory to account for the following four key behavioral phenomena in a unified framework. First, it accounts for the fact that the reinforcing value of an appetitive outcome increases as a function of its dose (<inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) (<xref ref-type="fig" rid="fig4">Figure 4A</xref>):<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.007</object-id><label>Figure 4.</label><caption><title>Schematic illustration of the behavioral properties of the drive function.</title><p>(<bold>A</bold>) excitatory effect of the dose of outcome on its rewarding value. (<bold>B</bold>, <bold>C</bold>) excitatory effect of deprivation level on the rewarding value of outcomes: Increased deprivation increases the rewarding value of reducing drive (<bold>B</bold>), and increases the punishing value of increasing drive (<bold>C</bold>). (<bold>D</bold>) inhibitory effect of irrelevant drives on the rewarding value of outcomes.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.007">http://dx.doi.org/10.7554/eLife.04811.007</ext-link></p></caption><graphic xlink:href="elife-04811-fig4-v1"/></fig></p><p>This is supported by the fact that in progressive ratio schedules of reinforcement rats maintain higher breakpoints when reinforced with bigger appetitive outcomes, reflecting higher motivation toward them (<xref ref-type="bibr" rid="bib23">Hodos, 1961</xref>; <xref ref-type="bibr" rid="bib54">Skjoldager et al., 1993</xref>). Secondly, the model accounts for the potentiating effect of the deprivation level on the reinforcing value (i.e., food will be more rewarding when the animal is hungrier) (<xref ref-type="fig" rid="fig4">Figure 4B,C</xref>):<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mtext>*</mml:mtext></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>This is consistent with experimental evidence showing that the level of food deprivation in rats increases the breakpoint in a progressive ratio schedule (<xref ref-type="bibr" rid="bib23">Hodos, 1961</xref>). Note that this point effectively establishes a formal extension for the ‘incentive’ concept as defined by incentive salience theory (<xref ref-type="bibr" rid="bib5">Berridge, 2012</xref>) (Discussed later).</p><p>Thirdly, the theory accounts for the inhibitory effect of irrelevant drives, which is consistent with a large body of behavioral experiments showing competition between different motivational systems (See <xref ref-type="bibr" rid="bib17">Dickinson &amp; Balleine, 2002</xref> for a review). In other words, as the deprivation level for one need increases, it inhibits the rewarding value of other outcomes that satisfy irrelevant motivational systems (<xref ref-type="fig" rid="fig4">Figure 4D</xref>):<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mtext>*</mml:mtext></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo> </mml:mo><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>w</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>Intuitively, one does not play chess, or even search for sex, on an empty stomach. As some examples, calcium deprivation reduces the appetite for phosphorus, and hunger inhibits sexual behavior (<xref ref-type="bibr" rid="bib17">Dickinson &amp; Balleine, 2002</xref>).</p><p>Finally, the theory naturally captures the risk-aversive nature of behavior. The rewarding value in our model is a concave function of the corresponding outcome magnitude:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>It is well known that the concavity of the economic utility function is equivalent to risk aversion (<xref ref-type="bibr" rid="bib31">Mas-Colell et al., 1995</xref>). Indeed, simulating the model shows that when faced with two options with equal expected payoffs, the model learns to choose the more certain option as opposed to the risky one (<xref ref-type="fig" rid="fig5">Figure 5</xref>; See <xref ref-type="supplementary-material" rid="SD2-data">Figure 5—source data 1</xref> for simulation details). This is because frequent small deviations from the setpoint are preferable to rare drastic deviations. In fact, our theory suggests the intuition that when the expected physiological instability caused by two behavioral options are equal, organisms do not choose the risky option, because the severe, though unlikely, physiological instabilities that it can cause might be life-threatening.<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.008</object-id><label>Figure 5.</label><caption><title>Risk aversion simulation.</title><p>In a conditioned place preference paradigm, the agent's presence in the left and the right compartments has equal expected payoffs, but different levels of risk (<bold>A</bold>) Panel (<bold>B</bold>) shows the Markov decision process of the same task. In fact, in every trial, the agent chooses whether to stay it the current compartment, or transit to the other one. The average input of energy per trial, regardless of the animal's choice, is set such that it is equal to the animal's normal energy expenditure. Thus, the internal state stays close to its initial level, which is equal to the setpoint here (<bold>D</bold>). The model learns to prefer the non-risky over the risky compartments (<bold>C</bold>) in order to avoid severe deviations from the setpoint.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.008">http://dx.doi.org/10.7554/eLife.04811.008</ext-link></p><p><supplementary-material id="SD2-data"><object-id pub-id-type="doi">10.7554/eLife.04811.009</object-id><label>Figure 5—source data 1.</label><caption><title>Free parameters for the risk-aversion simulations.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.009">http://dx.doi.org/10.7554/eLife.04811.009</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-04811-fig5-data1-v1.docx"/></supplementary-material></p></caption><graphic xlink:href="elife-04811-fig5-v1"/></fig></p><p>Our unified explanation for the above four behavioral patterns suggests that they may all arise from the functional form of the mapping from the physiological to the motivational state. In this sense, we propose that these behavioral phenomena are signatures of the coupling between the homeostatic and the associative learning systems. We will discuss later that <italic>m</italic>, <italic>n</italic>, and <italic>H</italic><sup>*</sup> can be regarded as free parameters of an evolutionary process, which eventually determine the equilibrium density of the species.</p><p>Note that the equations in this section hold only when the internal state remains below the setpoint. However, the drive function is symmetric with respect to the setpoint and thus, analogous conclusions can be derived for other three quarters of the homeostatic space.</p></sec><sec id="s2-6"><title>Stepping back from the brink</title><p>Since learning requires experience, learning whether an action in a certain internal state decreases or increases the drive (i.e. is rewarding or punishing, respectively) would require our model to have experienced that internal state. Living organisms, however, cannot just experience internal states with extreme and life threatening homeostatic deviations in order to learn that the actions that cause them are bad. For example, once the body temperature goes beyond 45°C, the organism can never return.</p><p>We now show how our model manages this problem; that is, it avoids voluntarily experiencing extreme homeostatic deviations and hence ensures that the animal does not voluntarily endanger its physiological integrity (simulations in <xref ref-type="fig" rid="fig6">Figure 6</xref>). In the simplest case, let us assume that the model is tabula rasa: it starts from absolute ignorance about the value of state–action pairs, and can freely change its internal state in the homeostatic space. In a one-dimensional space, it means that the agent can freely increase or decrease the internal state (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). As the value of ‘increase’ and ‘decrease’ actions at all internal states are initialized to zero, the agent starts by performing a random walk in the homeostatic space. However, the probability of choosing the same action for <inline-formula><mml:math id="inf27"><mml:mi>z</mml:mi></mml:math></inline-formula> times in a row decreases exponentially as <italic>z</italic> increases (<inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>): for example, the probability of choosing ‘increase’ is 2<sup>−1</sup> = 0.5, the probability of choosing two successive ‘increases’ is 2<sup>−1</sup> = 0.25, the probability of choosing three successive ‘increases’ is 2<sup>−3</sup> = 0.125, and so on. Thus, it is highly likely for the agent to return at least one step back, before getting too far from its starting point. When the agent returns to a state it had previously experienced, going in the same deviation-increasing direction will be less likely than the first time (i.e., than 50–50), since the agent has already experienced the punishment caused by that state–action pair once. Repetition of this process results in the agent gradually getting more and more attracted to the setpoint, without ever having experienced internal states that are beyond a certain limit (i.e. the brink of death).<fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.010</object-id><label>Figure 6.</label><caption><title>Simulations showing that the model avoids extreme deviations.</title><p>Starting from 30, the agent can either decrease or increase its internal state by one unit in each trial. (<bold>A</bold>) The number of visits at each internal state after 10<sup>6</sup> trials. (<bold>B</bold>) The drive function in the one-dimensional homeostatic space. (setpoint = 0). The mean (<bold>C</bold>) and standard deviation (<bold>D</bold>) of the internal state of 10<sup>5</sup> agents, along 1500 trials.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.010">http://dx.doi.org/10.7554/eLife.04811.010</ext-link></p><p><supplementary-material id="SD3-data"><object-id pub-id-type="doi">10.7554/eLife.04811.011</object-id><label>Figure 6—source data 1.</label><caption><title>Free parameters for the simulations showing that the model avoids extreme homeostatic deviations.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.011">http://dx.doi.org/10.7554/eLife.04811.011</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-04811-fig6-data1-v1.docx"/></supplementary-material></p></caption><graphic xlink:href="elife-04811-fig6-v1"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.04811.012</object-id><label>Figure 6—figure supplement 1.</label><caption><title>The Markov Decision Process used for simulation results presented in <xref ref-type="fig" rid="fig6">Figure 6</xref> and <xref ref-type="fig" rid="fig6s2 fig6s3 fig6s4 fig6s5 fig6s6 fig6s7">Figure 6—figure supplements 2–7</xref>.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.012">http://dx.doi.org/10.7554/eLife.04811.012</ext-link></p></caption><graphic xlink:href="elife-04811-fig6-figsupp1-v1"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.04811.013</object-id><label>Figure 6—figure supplement 2.</label><caption><title>Value function (<bold>A</bold>) and choice preferences (<bold>B</bold>) for state–action pairs after simulating one agent for 10<sup>6</sup> trials (As in <xref ref-type="fig" rid="fig6">Figure 6</xref>).</title><p>The parameters of the model where as follows: <italic>α</italic> = 0.4, <italic>β</italic> = 0.05, <italic>γ</italic> = 0.9, <italic>n</italic> = 4.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.013">http://dx.doi.org/10.7554/eLife.04811.013</ext-link></p></caption><graphic xlink:href="elife-04811-fig6-figsupp2-v1"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.04811.014</object-id><label>Figure 6—figure supplement 3.</label><caption><title>Simulation results replicating <xref ref-type="fig" rid="fig6">Figure 6</xref>, with the difference that the initial internal state was zero.</title><p>(<bold>A</bold>) The number of visits at each internal state after 106 trials. (<bold>B</bold>) The drive function in the one-dimensional homeostatic space (setpoint=0). Value function (<bold>C</bold>) and choice preferences (<bold>D</bold>) for state-action pairs after simulating one agent for 10<sup>6</sup> trials. The mean (<bold>E</bold>) and standard deviation (<bold>F</bold>) of the internal state of 10<sup>5</sup> agents, along 1500 trials.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.014">http://dx.doi.org/10.7554/eLife.04811.014</ext-link></p></caption><graphic xlink:href="elife-04811-fig6-figsupp3-v1"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.04811.015</object-id><label>Figure 6—figure supplement 4.</label><caption><title>Simulation results replicating <xref ref-type="fig" rid="fig6">Figure 6</xref>, with the difference that the initial internal state was zero, and the rate of exploration, <italic>β</italic>, was 0.03.</title><p>(<bold>A</bold>) The number of visits at each internal state after 10<sup>6</sup> trials. (<bold>B</bold>) The drive function in the one-dimensional homeostatic space (setpoint=0). Value function (<bold>C</bold>) and choice preferences (<bold>D</bold>) for state-action pairs after simulating one agent for 10<sup>6</sup> trials. The mean (<bold>E</bold>) and standard deviation (<bold>F</bold>) of the internal state of 10<sup>5</sup> agents, along 1500 trials.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.015">http://dx.doi.org/10.7554/eLife.04811.015</ext-link></p></caption><graphic xlink:href="elife-04811-fig6-figsupp4-v1"/></fig><fig id="fig6s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.04811.016</object-id><label>Figure 6—figure supplement 5.</label><caption><title>Simulation results replicating <xref ref-type="fig" rid="fig6">Figure 6</xref>, with the difference that the initial internal state was zero, and also <italic>m</italic> = <italic>n</italic> = 1.</title><p>(<bold>A</bold>) The number of visits at each internal state after 10<sup>6</sup> trials. (<bold>B</bold>) The drive function in the one-dimensional homeostatic space (setpoint=0). Value function (<bold>C</bold>) and choice preferences (<bold>D</bold>) for state-action pairs after simulating one agent for 10<sup>6</sup> trials. The mean (<bold>E</bold>) and standard deviation (<bold>F</bold>) of the internal state of 10<sup>5</sup> agents, along 1500 trials.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.016">http://dx.doi.org/10.7554/eLife.04811.016</ext-link></p></caption><graphic xlink:href="elife-04811-fig6-figsupp5-v1"/></fig><fig id="fig6s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.04811.017</object-id><label>Figure 6—figure supplement 6.</label><caption><title>Simulation results replicating <xref ref-type="fig" rid="fig6">Figure 6</xref>, with the difference that the initial internal state was zero, and the discount factor, <italic>γ</italic>, was zero.</title><p>(<bold>A</bold>) The number of visits at each internal state after 10<sup>6</sup> trials. (<bold>B</bold>) The drive function in the one-dimensional homeostatic space (setpoint=0). Value function (<bold>C</bold>) and choice preferences (<bold>D</bold>) for state-action pairs after simulating one agent for 10<sup>6</sup> trials. The mean (<bold>E</bold>) and standard deviation (<bold>F</bold>) of the internal state of 10<sup>5</sup> agents, along 1500 trials.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.017">http://dx.doi.org/10.7554/eLife.04811.017</ext-link></p></caption><graphic xlink:href="elife-04811-fig6-figsupp6-v1"/></fig><fig id="fig6s7" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.04811.018</object-id><label>Figure 6—figure supplement 7.</label><caption><title>Simulation results replicating <xref ref-type="fig" rid="fig6">Figure 6</xref>, with the difference that the initial internal state was zero, and the discount factor, <italic>γ</italic>, was one (no discounting).</title><p>(<bold>A</bold>) The number of visits at each internal state after 10<sup>6</sup> trials. (<bold>B</bold>) The drive function in the one-dimensional homeostatic space (setpoint=0). Value function (<bold>C</bold>) and choice preferences (<bold>D</bold>) for state-action pairs after simulating one agent for 10<sup>6</sup> trials. The mean (<bold>E</bold>) and standard deviation (<bold>F</bold>) of the internal state of 10<sup>5</sup> agents, along 1500 trials.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.018">http://dx.doi.org/10.7554/eLife.04811.018</ext-link></p></caption><graphic xlink:href="elife-04811-fig6-figsupp7-v1"/></fig></fig-group></p><p>Simulating the model in a one-dimensional space shows that even after starting from a rather deviated internal state (initial state = 30, setpoint = 0), the agent never visits states with a deviation of more than 40 units after <inline-formula><mml:math id="inf30"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> trials (every action is assumed to change the state by one unit) (<xref ref-type="fig" rid="fig6">Figure 6A</xref>; See <xref ref-type="fig" rid="fig6s1 fig6s2">Figure 6—figure supplements 1,2</xref>, and <xref ref-type="supplementary-material" rid="SD3-data">Figure 6—source data 1</xref> for simulation details). Also, simulating 10<sup>5</sup> agents over 1500 trials (starting from state 30) shows that the mean value of the internal state across all agents converges to the setpoint (<xref ref-type="fig" rid="fig5">Figure 5C</xref>), and its variance converges to a steady-state level (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). This shows that all agents stay within certain bounds around the setpoint (The maximum deviation from the setpoint among all the 10<sup>5</sup> agents over the 1500 trials was 61). Also, this property of the model is shown to be insensitive to the parameters of the model, like the initial internal state (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>), the rate of exploration (<xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4</xref>), <italic>m</italic> and <italic>n</italic> (<xref ref-type="fig" rid="fig6s5">Figure 6—figure supplement 5</xref>), or the discount factor (<xref ref-type="fig" rid="fig6s6 fig6s7">Figure 6—figure supplements 6,7</xref>). These parameters only affect the rate of convergence or the distribution over visited states, but not the general property of never-visiting-drastic-deviations (existence of a boundary). Moreover, this property can be generalized to multi-dimensional homeostatic spaces. Therefore, our theory suggests a potential normative explanation for how animals (who might be a priori naïve about potential dangers of certain internal states) would learn to avoid extreme physiological instability, without ever exploring how good or bad they are.</p></sec><sec id="s2-7"><title>Orosensory-based approximation of post-ingestive effects</title><p>As mentioned, we hypothesize that orosensory properties of food and water provide the animal with an estimate, <inline-formula><mml:math id="inf31"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, of their true post-ingestive effect, <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, on the internal state. Such association between sensory and post-ingestive properties could have been developed through prior learning (<xref ref-type="bibr" rid="bib60">Swithers et al., 2009</xref>; <xref ref-type="bibr" rid="bib61">Swithers et al., 2010</xref>; <xref ref-type="bibr" rid="bib2">Beeler et al., 2012</xref>) or evolutionary mechanisms (<xref ref-type="bibr" rid="bib6">Breslin, 2013</xref>). Based on this sensory approximation, the only information required to compute the reward (and thus the reward prediction error) is the current physiological state (<inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) and the sensory-based approximation of the nutritional content of the outcome (<inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>):<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Clearly, the evolution of the internal state itself depends only on the actual (<inline-formula><mml:math id="inf35"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) post-ingestive effects of the outcome. That is <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>According to <xref ref-type="disp-formula" rid="equ10">Equation 10</xref>, the reinforcing value of food and water outcomes can be approximated as soon as they are sensed/consumed, without having to wait for the outcome to be digested and the drive to be reduced. This proposition is compatible with the fact that dopamine neurons exhibit instantaneous, rather than delayed, burst activity in response to unexpected food reward (<xref ref-type="bibr" rid="bib49">Schneider, 1989</xref>; <xref ref-type="bibr" rid="bib50">Schultz et al., 1997</xref>). Moreover, it might provide a formal explanations for the experimental fact that intravenous injection (and even intragastric intubation, in some cases) of food is not rewarding even though its drive reduction effect is equal to when it is ingested orally (<xref ref-type="bibr" rid="bib34">Miller &amp; Kessen, 1952</xref>) (See also <xref ref-type="bibr" rid="bib43">Ren et al., 2010</xref>). In fact, if the post-ingestive effect of food is estimated by its sensory properties, the reinforcing value of intravenously injected food that lacks sensory aspects will be effectively zero. In the same line of reasoning, the theory suggests that animals' motivation toward palatable foods, such as saccharine, that have no caloric content (and thus no need-reduction effect) is due to erroneous over-estimation of their drive-reduction capacity, misguided by their taste or smell. Note that the rationality of our theory, as shown in <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>, holds only as long as <inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is an unbiased estimation of <inline-formula><mml:math id="inf38"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Otherwise, pathological conditions could emerge.</p><p>Last but not least, the orosensory-based approximation provides a computational hypothesis for the separation of reinforcement and satiation effects. A seminal series of experiments (<xref ref-type="bibr" rid="bib33">McFarland, 1969</xref>) demonstrated that the reinforcing and satiating (i.e., need reduction) effects of drinking behavior, dissociable from one another, are governed by the orosensory and alimentary components of the water, respectively. Two groups of water-deprived animals learned to press a green key to self-administer water orally. After this pre-training session, pressing the green key had no consequence anymore, whereas pressing a novel yellow key resulted in the oral delivery of water in one group, and intragastric (through a fistula) delivery of water in the second group. Results showed that the green key gradually extinguished in both groups (<xref ref-type="fig" rid="fig7">Figure 7A,B</xref>). During this time, responding on the yellow key in the oral group initially increased but then gradually extinguished (rise-fall pattern; <xref ref-type="fig" rid="fig7">Figure 7A</xref>). The second group, however, showed no motivation for the yellow key (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). This shows that only oral, but not intragastric, self-administration of water is reinforcing for thirsty animals. Our model accounts for these behavioral dynamics.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.019</object-id><label>Figure 7.</label><caption><title>Experimental results (adapted from <xref ref-type="bibr" rid="bib33">McFarland, 1969</xref>) on learning the reinforcing effect of oral vs. intragastric delivery of water.</title><p>Thirsty animals were initially trained to peck at a green key to receive water orally. In the next phase, pecking at the green key had no consequence, while pecking at a novel yellow key resulted in oral delivery of water in one group (<bold>A</bold>), and intragastric injection of the same amount of water through a fistula in a second group (<bold>B</bold>). In the first group, responding was rapidly transferred from the green to the yellow key, and then suppressed. In the fistula group, the yellow key was not reinforced.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.019">http://dx.doi.org/10.7554/eLife.04811.019</ext-link></p></caption><graphic xlink:href="elife-04811-fig7-v1"/></fig></p><p>Simulating the model shows that the agent's subjective probability of receiving water upon pressing the green key gradually decreases to zero in both groups (<xref ref-type="fig" rid="fig8">Figure 8C,D</xref>). As this predicted outcome (alimentary content) decreases, its approximated thirst-reduction effect (equal to reward in our framework) decreases as well, resulting in the extinction of pressing the green key (<xref ref-type="fig" rid="fig8">Figure 8A,B</xref>). As for the yellow key, the oral agent initially increases the rate of responding (<xref ref-type="fig" rid="fig8">Figure 8A</xref>) as the subjective probability of receiving water upon pressing the yellow key increases (<xref ref-type="fig" rid="fig8">Figure 8C</xref>). Gradually, however, the internal state of the animal reaches the homeostatic setpoint (<xref ref-type="fig" rid="fig8">Figure 8E</xref>), resulting in diminishing motivation (thirst-reduction effect) of seeking water (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). Thus, our model shows that whereas the ascending limb of the response curve represents a learning effect, the descending limb is due to mitigated homeostatic imbalance (i.e., unlearning vs. satiation). Notably, classical RL models only explain the ascending, and classical HR models only explain the descending pattern.<fig-group><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.020</object-id><label>Figure 8.</label><caption><title>Simulation results replicating the data from <xref ref-type="bibr" rid="bib33">McFarland (1969)</xref> on learning the reinforcing effect of oral vs. intragastric delivery of water.</title><p>As in the experiment, two groups of simulated agents were pre-trained to respond on the green key to receive oral delivery of water. During the test phase, the green key had no consequence, whereas a novel yellow key resulted in oral delivery in one group (<bold>A</bold>) and intragastric injection in the second group (<bold>B</bold>). All agents started this phase in a thirsty state (initial internal state = 0; setpoint = 0). In the oral group, responding transferred rapidly from the green to the yellow key and was then suppressed (<bold>A</bold>) as the internal state approached the setpoint (<bold>E</bold>). This transfer is due to gradually updating the subjective probability of receiving water outcome upon responding on either key (<bold>C</bold>). In the fistula group, as the water was not sensed, the outcome expectation converged to zero for both keys (<bold>D</bold>) and thus, responding was extinguished (<bold>B</bold>). As a result, the internal state changed only slightly (<bold>F</bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.020">http://dx.doi.org/10.7554/eLife.04811.020</ext-link></p><p><supplementary-material id="SD4-data"><object-id pub-id-type="doi">10.7554/eLife.04811.021</object-id><label>Figure 8—source data 1.</label><caption><title>Free parameters for the reinforcing vs. satiation simulations.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.021">http://dx.doi.org/10.7554/eLife.04811.021</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-04811-fig8-data1-v1.docx"/></supplementary-material></p></caption><graphic xlink:href="elife-04811-fig8-v1"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.04811.022</object-id><label>Figure 8—figure supplement 1.</label><caption><title>A model-based homeostatic RL system. Upon performing an action in a certain state, the agent receives an outcome, <inline-formula><mml:math id="inf107"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which results in the internal state to shift from <inline-formula><mml:math id="inf108"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf109"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</title><p>At the same time, sensory properties of the outcome are sensed by the agent. Based on this information, the agent updates the state-action-outcome associations. In fact, the agent learns to predict the sensory properties, <inline-formula><mml:math id="inf110"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, of the outcome that is expected to be received upon performing a certain action. Having learned these associations, the agent can estimate the rewarding value of different options. That is, when the agent is in a certain state, it predicts the outcome <inline-formula><mml:math id="inf111"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, expected to result from each behavioral policy. Based on <inline-formula><mml:math id="inf112"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the internal state <inline-formula><mml:math id="inf113"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the agent can approximate the drive-reduction reward.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.022">http://dx.doi.org/10.7554/eLife.04811.022</ext-link></p></caption><graphic xlink:href="elife-04811-fig8-figsupp1-v1"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.04811.023</object-id><label>Figure 8—figure supplement 2.</label><caption><title>The Markov Decision Process used for simulating the reinforcing vs. satiation effects of water.</title><p>At each time point, the agent can choose between doing nothing (nul) or pecking at either the green or the yellow key.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.023">http://dx.doi.org/10.7554/eLife.04811.023</ext-link></p></caption><graphic xlink:href="elife-04811-fig8-figsupp2-v1"/></fig></fig-group></p><p>In contrast to the oral agent, the fistula agent never learns to press the yellow key (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). This is because the approximated alimentary content attributed to this response remains zero (<xref ref-type="fig" rid="fig8">Figure 8D</xref>) and so does its drive-reduction effect. Note that as above, the sensory-based approximation (<inline-formula><mml:math id="inf39"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) of the alimentary effect of water in the oral and fistula cases is assumed to be equal to its actual effect (<inline-formula><mml:math id="inf40"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) and zero, respectively (See <xref ref-type="fig" rid="fig8s1 fig8s2">Figure 8—figure supplements 1,2</xref>, and <xref ref-type="supplementary-material" rid="SD4-data">Figure 8—source data 1</xref> for simulation details).</p><p>Our theory also suggests that in contrast to reinforcement (above), satiation is independent of the sensory aspects of water and only depends on its post-ingestive effects. In fact, experiments show that when different proportions of water were delivered via the two routes in different groups, satiation (i.e., suppression of responding) only depended on the total amount of water ingested, regardless of the delivery route (<xref ref-type="bibr" rid="bib33">McFarland, 1969</xref>).</p><p>Our model accounts for these data (<xref ref-type="fig" rid="fig9">Figure 9</xref>), since the evolution of the internal state only depends on the actual water ingested. For example, whether water is administered completely orally (<xref ref-type="fig" rid="fig9">Figure 9</xref>, left column) or half-orally-half-intragastrically (<xref ref-type="fig" rid="fig9">Figure 9</xref>, right column), the agent stops seeking water when the setpoint is reached. As only oral delivery is sensed, the subjective outcome magnitude converges to 1 (<xref ref-type="fig" rid="fig9">Figure 9C</xref>) and 0.5 (<xref ref-type="fig" rid="fig9">Figure 9D</xref>) units for the two cases, respectively. When the setpoint is reached, consuming more water results in overshooting the setpoint (increasing homeostatic deviation) and thus, is punishing. Therefore, both agents self-administer the same total amount of water, equal to what is required for reaching the setpoint.<fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.024</object-id><label>Figure 9.</label><caption><title>Simulation results of the satiation test.</title><p>Left column shows results for the case where water was received only orally. Rate of responding drops rapidly (<bold>A</bold>) as the internal state approaches the setpoint (<bold>E</bold>). Also, the agent learns rapidly that upon every key pecking, it receives 1.0 unit of water (<bold>C</bold>). On the right column, upon every key-peck, 0.5 unit of water is received orally, and 0.5 unit is received via the fistula. As only oral delivery is sensed by the agent, the subjective outcome-magnitude converges to 0.5 (<bold>D</bold>). As a result, the reinforcing value of key-pecking is less than that of the oral case and thus, the rate of responding is lower (<bold>B</bold>). This in turn results in slower convergence of the internal state to the setpoint (<bold>F</bold>). The MDP and the free parameters used for simulation are the same as in <xref ref-type="fig" rid="fig8">Figure 8</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.024">http://dx.doi.org/10.7554/eLife.04811.024</ext-link></p></caption><graphic xlink:href="elife-04811-fig9-v1"/></fig></p><p>However, as the sensed amount of water is bigger in the completely-oral case, water-seeking behavior is approximated to have a higher thirst-reduction effect. As a result, the reinforcing value of water-seeking is higher in the oral case (as compared to the half-oral-half- intragastric case) and thus, the rate of responding is higher. This, in turn, results in faster convergence of the internal state to the setpoint (compare <xref ref-type="fig" rid="fig9">Figure 9E,F</xref>). In this respect, we predict that the oral/fistula proportion affects the speed of satiation: the higher the proportion is, the faster the satiety state is reached and thus, the faster the descending limb of responding emerges.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Theories of conditioning are founded on the argument that animals seek reward, while reward may be defined, at least in the behaviorist approach, as what animals seek. This apparently circular argument relies on the hypothetical and out-of-reach axiom of reward-maximization as the behavioral objective of animals. Physiological stability, however, is an observable fact. Here, we develop a coherent mathematical theory where physiological stability is put as the basic axiom, and reward is defined in physiological terms. We demonstrated that reinforcement learning algorithms under such a definition of physiological reward lead to optimal policies that both maximize reward collection and minimize homeostatic needs. This argues for behavioral rationality of physiological integrity maintenance and further shows that temporal discounting of rewards is paramount for homeostatic maintenance. Furthermore, we demonstrated that such integration of the two systems can account for several behavioral phenomena, including anticipatory responding, the rise-fall pattern of food-seeking response, risk-aversion, and competition between motivational systems. Here we argue that our framework may also shed light on the computational role of the interaction between the brain reward circuitry and the homeostatic regulation system; namely, the modulation of midbrain dopaminergic activity by hypothalamic signals.</p><sec id="s3-1"><title>Neural substrates</title><p>Homeostatic regulation critically depends on sensing the internal state. In the case of energy regulation, for example, the arcuate nucleus of the hypothalamus integrates peripheral hormones including leptin, insulin, and ghrelin, whose circulating levels reflect the internal abundance of fat, abundance of carbohydrate, and hunger, respectively (<xref ref-type="bibr" rid="bib63">Williams &amp; Elmquist, 2012</xref>). In our model, the deprivation level has an excitatory effect on the rewarding value of outcomes (<xref ref-type="disp-formula" rid="equ7">Equation 7</xref>) and thus on the reward prediction error (RPE). Consistently, recent evidence indicates neuronal pathways through which energy state-monitoring peptides modulate the activity of midbrain dopamine neurons, which supposedly carry the RPE signal (<xref ref-type="bibr" rid="bib40">Palmiter, 2007</xref>).</p><p>Namely, orexin neurons, which project from the lateral hypothalamus area to several brain regions including the ventral tegmental area (VTA) (<xref ref-type="bibr" rid="bib46">Sakurai et al., 1998</xref>), have been shown to have an excitatory effect on dopaminergic activity (<xref ref-type="bibr" rid="bib26">Korotkova et al., 2003</xref>; <xref ref-type="bibr" rid="bib37">Narita et al., 2006</xref>), as well as feeding behavior (<xref ref-type="bibr" rid="bib44">Rodgers et al., 2001</xref>). Orexin neurons are responsive to peripheral metabolic signals as well as to the animal's deprivation level (<xref ref-type="bibr" rid="bib7">Burdakov et al., 2005</xref>), as they are innervated by orexigenic and anorexigenic neural populations in the arcuate nucleus where circulating peptides are sensed. Accordingly, orexin neurons are suggested to act as an interface between internal states and the reward learning circuit (<xref ref-type="bibr" rid="bib40">Palmiter, 2007</xref>). In parallel with the orexinergic pathway, ghrelin, leptin and insulin receptors are also expressed on the VTA dopamine neurons, providing a further direct interface between the HR and RL systems. Consistently, whereas leptin and insulin inhibit dopamine activity and feeding behavior, ghrelin has an excitatory effect on them (See <xref ref-type="bibr" rid="bib40">Palmiter, 2007</xref> for a review).</p><p>The reinforcing value of food outcome (and thus RPE signal) in our theory is not only modulated by the internal state, but also by the orosensory information that approximates the need-reduction effects. In this respect, endogenous opioids and <italic>μ</italic>-opioid receptors have long been implicated in the hedonic aspects of food, signaled by its orosensory properties. Systemic administration of opioid antagonists decreases subjective pleasantness rating and affective responses for palatable foods in humans (<xref ref-type="bibr" rid="bib69">Yeomans &amp; Wright, 1991</xref>) and rats (<xref ref-type="bibr" rid="bib18">Doyle et al., 1993</xref>), respectively. Supposedly through modulating palatability, opioids also control food intake (<xref ref-type="bibr" rid="bib47">Sanger &amp; McCarthy, 1980</xref>) as well as instrumental food-seeking behavior (<xref ref-type="bibr" rid="bib12">Cleary et al., 1996</xref>). For example, opioid antagonists decrease the breakpoint in progressive ratio schedules of reinforcement with food (<xref ref-type="bibr" rid="bib1">Barbano et al., 2009</xref>), whereas opioid agonists produce the opposite effect (<xref ref-type="bibr" rid="bib55">Solinas &amp; Goldberg, 2005</xref>). This reflects the influence of orosensory information on the reinforcing effect of food. Consistent with our model, these influences have mainly been attributed to the effect of opiates on increasing extracellular dopamine levels in the Nucleus Accumbens (NAc) (<xref ref-type="bibr" rid="bib16">Devine et al., 1993</xref>) through its action on <italic>μ</italic>-opioid receptors in the VTA and NAc (<xref ref-type="bibr" rid="bib39">Noel &amp; Wise, 1993</xref>; <xref ref-type="bibr" rid="bib71">Zhang &amp; Kelley, 1997</xref>).</p><p>Such orosensory-based approximation of nutritional content, as discussed before, could have been obtained through evolutionary processes (<xref ref-type="bibr" rid="bib6">Breslin, 2013</xref>), as well as through prior learning (<xref ref-type="bibr" rid="bib2">Beeler et al., 2012</xref>; <xref ref-type="bibr" rid="bib60">Swithers et al., 2009</xref>, <xref ref-type="bibr" rid="bib61">2010</xref>). In the latter case, approximations based on orosensory or contextual cues can be updated so as to match the true nutritional value, resulting in a rational neural/behavioral response to food stimuli (<xref ref-type="bibr" rid="bib15">de Araujo et al., 2008</xref>).</p></sec><sec id="s3-2"><title>Irrational behavior: the case of over-eating</title><p>Above, we developed a normative theory for reward-seeking behaviors that lead to homeostatic stability. However, animals do not always follow rational behavioral patterns, notably as exemplified in eating disorders, drug addiction, and many other psychiatric diseases. Here we discuss one prominent example of such irrational behavior within the context of our theory.</p><p>Binge eating is a disorder characterized by compulsive eating even when the person is not hungry. Among the many risk factors of developing binge eating, a prominent one is having easy access to hyperpalatable foods, commonly defined as those loaded with fat, sugar, or salt (<xref ref-type="bibr" rid="bib45">Rolls, 2007</xref>). As an attempt to explain this risk factor, we discuss one of the points of vulnerability of our theory that can induce irrational choices and thus, pathological conditions.</p><p>Over-seeking of hyperpalatable foods is suggested to be caused by motivational systems escaping homeostatic constraints, supposedly as a result of the inability of internal satiety signals in blocking the opioid-based stimulation of DA neurons (<xref ref-type="bibr" rid="bib72">M. Zhang &amp; Kelley, 2000</xref>). Stimulation of <italic>μ</italic>-opioid receptors in the NAc, for example, is demonstrated to preferentially increase the intake of high-fat food (<xref ref-type="bibr" rid="bib21">Glass et al., 1996</xref>; <xref ref-type="bibr" rid="bib72">Zhang &amp; Kelley, 2000</xref>), and hyperpalatable foods are shown to trigger potent release of DA into the NAc (<xref ref-type="bibr" rid="bib38">Nestler, 2001</xref>). Moreover, stimulation of the brain reward circuitry (<xref ref-type="bibr" rid="bib62">Will et al., 2006</xref>), as well as DA receptor agonists (<xref ref-type="bibr" rid="bib14">Cornelius et al., 2010</xref>) are shown to induce hedonic overeating long after energy requirements are met, suggesting the hyper-palatability factor to be drive-independent.</p><p>Motivated by these neurobiological findings, one way to formulate the overriding of the homeostatic satiety signals by hyperpalatable foods is to assume that the drive-reduction reward for these outcomes is augmented by a drive-independent term, <italic>T</italic> (<italic>T</italic> &gt; 0 for palatable foods, and <italic>T</italic> = 0 for ‘normal’ foods):<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></disp-formula></p><p>In other words, even when the setpoint is reached and thus, the drive-reduction effect of food is zero or even negative, the term <italic>T</italic> overrides this signal and results in further motivation for eating (See ‘Materials and methods’ for alternative formulations of <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>). Simulating this hypothesis shows that when a deprived agent (initial internal state = −50) is given access to normal food, the internal state converges to the setpoint (<xref ref-type="fig" rid="fig10">Figure 10C</xref>). When hyperpalatable food with equal caloric content (<italic>K</italic> is the same for both types of food) is made available instead, the steady level of the internal state goes beyond the setpoint (<xref ref-type="fig" rid="fig10">Figure 10C</xref>). Moreover, the total consumption of food is higher in the latter case (<xref ref-type="fig" rid="fig8">Figure 8D</xref>), reflecting overeating. In fact, the inflated hedonic aspect of the hyperpalatable food causes it to be sought and consumed to a certain extent, even after metabolic demands are fulfilled. One might speculate that such persistent overshoot would result in excess energy storage, potentially leading to obesity.<fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.025</object-id><label>Figure 10.</label><caption><title>Simulating over-eating of hyperpalatable vs. normal food.</title><p>(<bold>A</bold>) The simulated agent can consume normal (<italic>T</italic> = 0) or hyperpalatable (<italic>T</italic> &gt; 0) food. The nutritional content, <italic>K</italic>, of both foods are equal. In the single-option task (<bold>C</bold>, <bold>D</bold>), one group of animals can only choose between normal food and nothing (nul), whereas the other group can choose between hyperpalatable food and nothing. Starting the task in a deprived state (initial internal state=−50), the internal state of the second, but not the first, group converges to a level above the setpoint (<bold>C</bold>) and the total consumption of food is higher in this group (<bold>D</bold>). In the multiple-choice task, the agents can choose between normal food, hyperpalatable food, and nothing (<bold>B</bold>). Results show that the hyperpalatable food is preferred over the normal food (<bold>E</bold>) and the internal state is defended at a level beyond the setpoint (<bold>F</bold>). See <xref ref-type="supplementary-material" rid="SD5-data">Figure 10—source data 1</xref> for simulation details.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.025">http://dx.doi.org/10.7554/eLife.04811.025</ext-link></p><p><supplementary-material id="SD5-data"><object-id pub-id-type="doi">10.7554/eLife.04811.026</object-id><label>Figure 10—source data 1.</label><caption><title>Free parameters for the over-eating simulations.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.026">http://dx.doi.org/10.7554/eLife.04811.026</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-04811-fig10-data1-v1.docx"/></supplementary-material></p></caption><graphic xlink:href="elife-04811-fig10-v1"/></fig></p><p>Simulating the model in another condition where the agent has ‘concurrent’ access to both types of foods shows significant preference of the hyperpalatable food over the normal food (<xref ref-type="fig" rid="fig10">Figure 10E</xref>), and the internal state again converges to a higher-than-setpoint level (<xref ref-type="fig" rid="fig10">Figure 10F</xref>). This is in agreement with the evidence showing that animals strongly prefer highly palatable to less palatable foods (<xref ref-type="bibr" rid="bib32">McCrory et al., 2002</xref>). (See <xref ref-type="supplementary-material" rid="SD5-data">Figure 10—source data 1</xref> for simulation details)</p></sec><sec id="s3-3"><title>Relationship to classical drive-reduction theory</title><p>Our model is inspired by the drive reduction theory of motivation, initially proposed by Clark Hull (<xref ref-type="bibr" rid="bib24">Hull, 1943</xref>), which became the dominant theory of motivation in psychology during the 1940s and 1950s. However, major criticisms have been leveled against this theory over the years (<xref ref-type="bibr" rid="bib33">McFarland, 1969</xref>; <xref ref-type="bibr" rid="bib48">Savage, 2000</xref>; <xref ref-type="bibr" rid="bib4">Berridge, 2004</xref>; <xref ref-type="bibr" rid="bib56">Speakman et al., 2011</xref>). Here we propose that our formal theory alleviates some of major faults of the classical drive-reduction. Firstly, the classical drive-reduction does not explain anticipatory responding in which animals paradoxically voluntarily increase (rather than decrease) their drive deviation, even in the absence of any physiological deficit. As we demonstrated, such apparently maladaptive responses are optimal in terms of both reward-seeking and ensuring physiological stability, and are thus acquired by animals.</p><p>Secondly, the drive reduction could not explain how secondary reinforcers (e.g., money, or a light that predicts food) gain motivational value, since they do not reduce the drive per se. Because our framework integrates an RL module with the HR reward computation, the drive reduction-induced reward of primary reinforcers can be readily transferred through the learning process to secondary reinforcers that predict them (i.e., Pavlovian conditioning) as well as to behavioral policies that lead to them (i.e., instrumental conditioning).</p><p>Finally, the original Hull's theory is in contradiction with the fact that intravenous injection of food is not rewarding, despite its drive-reduction effect. As we showed, this could be due to the orosensory-based approximation mechanism required for computing the reward.</p><p>Despite its limitations (discussed later), we would suggest that our modern re-formulation of the drive-reduction theory subject to specific assumptions (i.e., orosensory approximation, connection to RL, drive form) can serve as a framework to understand the interaction between internal states and motivated behaviors.</p></sec><sec id="s3-4"><title>Relationship to other theoretical models</title><p>Several previous RL-based models have also tried to incorporate the internal state into the computation of reward by proposing that reward increases as a linear function of deprivation level. That is, <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf42"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is a constant and <inline-formula><mml:math id="inf43"><mml:mi>w</mml:mi></mml:math></inline-formula> is proportional to the deprivation level.</p><p>Interestingly, a linear approximation of our proposed drive-reduction reward is equivalent to assuming that the rewarding value of outcomes is equal to the multiplication of the deprivation level and the magnitude of the outcome. In fact, by rewriting <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> for the continuous case we will have:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Using Taylor expansion, this reward can be approximated by:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≅</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>.</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>D</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula>Where ∇ is the gradient operator, and <inline-formula><mml:math id="inf44"><mml:mrow><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> is the Laplace operator. Thus, a linear approximation of our proposed drive-reduction reward is equivalent to assuming that the rewarding value of outcomes is linearly proportional to their need-reduction capacity (<inline-formula><mml:math id="inf45"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), as well as a function (the gradient of drive) of the deprivation level. In this respect, our framework generalizes and provides a normative basis to multiplicative forms of deprivation-modulated reward (e.g., decision field theory (<xref ref-type="bibr" rid="bib8">Busemeyer et al., 2002</xref>), intrinsically motivated RL theory (<xref ref-type="bibr" rid="bib53">Singh et al., 2010</xref>), and MOTIVATOR theory (<xref ref-type="bibr" rid="bib19">Dranias et al., 2008</xref>)), where reward increases as a linear function of deprivation level. Moreover, those previous models cannot account for the non-linearities arising from our model; that is the inhibitory effect of irrelevant drives and risk aversion.</p><p>Whether the brain implements a nonlinear drive-reduction reward (as in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>) or a linear approximation of it (as in <xref ref-type="disp-formula" rid="equ13">Equation 13</xref>) can be examined experimentally. Assuming that an animal is in a slightly deprived state (<xref ref-type="fig" rid="fig11">Figure 11A</xref>), a linear model predicts that as the magnitude of the outcome increases, its rewarding value will increase linearly (<xref ref-type="fig" rid="fig11">Figure 11B</xref>). A non-linear reward, however, predicts an inverted U-shaped economic utility function (<xref ref-type="fig" rid="fig11">Figure 11B</xref>). That is, the rewarding value of a large outcome can be negative, if it results in overshooting the setpoint.<fig id="fig11" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.027</object-id><label>Figure 11.</label><caption><title>Behavioral predictions of the model.</title><p>(<bold>A</bold>) Differential predictions of the multiplicative (linear) and drive-reduction (non-linear) forms of reward. In our model, assuming that the internal state is at <inline-formula><mml:math id="inf46"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<bold>A</bold>), outcomes larger than <inline-formula><mml:math id="inf47"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> result in overshooting the setpoint and thus a declining trend of the rewarding value (<bold>B</bold>). Previous models, however, predict the rewarding value to increase linearly as the outcome increases in magnitude. (<bold>C</bold>) Our model predicts that when given a choice between two options with equal net effects on the internal state, animals choose the option that first results in reducing the homeostatic deviation and then is followed by an increase in deviation (green), as compared to a reversed-order option (red).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.027">http://dx.doi.org/10.7554/eLife.04811.027</ext-link></p></caption><graphic xlink:href="elife-04811-fig11-v1"/></fig></p><p>A more recent framework that also uses a multiplicative form of deprivation-modulated reward is the incentive salience theory (<xref ref-type="bibr" rid="bib5">Berridge, 2012</xref>; <xref ref-type="bibr" rid="bib70">Zhang et al., 2009</xref>). However, in contrast to the previous models and our framework, this model assumes that the rewarding value of outcomes and conditioned stimuli is learned as if the animal is in a reference internal state <italic>(</italic><inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><italic>)</italic>. Let's denote this reward by <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> for state <italic>s</italic>. At the time of encountering state <italic>s</italic> in the future, the animal uses a factor, <inline-formula><mml:math id="inf50"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, related to its current internal state, to modulate the real-time motivation of the animal: <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>.</mml:mo><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. In the case of conditioned tolerance to hypothermic agents, however, heat-producing response is motivated at the time of cue presentation, when the hypothermic agent is not administered yet. At this time, the animal's internal state is not deviated and thus, the motivational element, <inline-formula><mml:math id="inf52"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, in the incentive salience theory does not provoke the tolerance response. Therefore, in our reading and unlike our framework, the incentive salience theory cannot give a computational account of anticipatory responding.</p><p>Another approach to integrate responsiveness to both internal and external states appeals to approximate inference techniques from statistical physics. The free energy theory of brain (<xref ref-type="bibr" rid="bib20">Friston, 2010</xref>) proposes that organisms optimize their actions in order to minimize ‘surprise’. Surprise is an information-theoretic notion measuring how inconceivable it is to the organism to find itself in a certain state. Assume that evolutionary pressure has compelled a species to occupy a restricted set of internal states, and <inline-formula><mml:math id="inf53"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> indicates the probability of occupying state <inline-formula><mml:math id="inf54"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, after the evolution of admissible states has converged to an equilibrium density. Surprise is defined as the negative log-probability of <inline-formula><mml:math id="inf55"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> occurring; <inline-formula><mml:math id="inf56"><mml:mrow><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>.</p><p>We propose that our notion of drive is equivalent to surprise as utilized in the free energy (<xref ref-type="bibr" rid="bib20">Friston, 2010</xref>) and interoceptive inference (<xref ref-type="bibr" rid="bib51">Seth, 2013</xref>) frameworks. In fact, we propose that an organism has an equilibrium density, <inline-formula><mml:math id="inf57"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>.</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with the following functional form:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mo>−</mml:mo></mml:msup><mml:mroot><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">*</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mi>m</mml:mi></mml:mroot></mml:mrow></mml:math></disp-formula></p><p>In order to stay faithful to this probability density (and ensure the survival of genes by remaining within physiological bounds), the organism minimizes surprise, which is equal to <inline-formula><mml:math id="inf58"><mml:mrow><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mroot><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">*</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mi>m</mml:mi></mml:mroot></mml:mrow></mml:math></inline-formula>. This specific form of surprise is equivalent to our definition of drive (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). The equivalency of reward maximization and physiological stability objectives in our model (<xref ref-type="disp-formula" rid="equ5">Equation 5</xref>) shows that optimizing either homeostasis or sum of discounted rewards corresponds to prescribing a principle of least action applied to the surprise function.</p><p>Although our homeostatic RL and the free-energy theory are similar in spirit, several major differences can be mentioned. Most importantly, the two frameworks should be understood at different levels of analysis (<xref ref-type="bibr" rid="bib30">Marr, 1982</xref>): the free-energy theory is a computational framework, whereas our theory fits in the algorithmic/representational level. In the same line, the two theories use different mathematical tools as their optimization techniques. The free energy approach uses variational Bayes inference. Thus, rationality in that model is bounded by the simplifying assumptions for doing ‘approximate’ inference (namely, factorization of the variational distribution over some partition of the latent variables, Laplace approximation, etc.). Our approach, however, depends on tools from optimal control theory and thus, rationality is constrained by the capabilities and weaknesses of the variants of the RL algorithm being used (e.g. model-based vs. model-free RL). In this sense, while the notion of reward is redundant in the free energy formulation, and physiological stability is achieved through gradient descent function, homeostasis in our model can only be achieved through computing reward. In fact, the associative learning component in our model critically depends on receiving the approximated reward from the upstream regulatory component. As a result, our model remains faithful to and exploits the well-developed conditioning literature in behavioral psychology, with its strengths and weaknesses.</p><p>A further approach toward adaptive homeostatic regulation is the predictive homeostasis (otherwise known as allostasis) model (<xref ref-type="bibr" rid="bib58">Sterling, 2012</xref>) where the classical negative-feedback homeostatic model is coupled with an inference system capable of anticipating forthcoming demands. In this framework, anticipated demands increase current homeostatic deviation (by adjusting the setpoint level) and thus, prepare the organism to meet the predicted need. Again, the concept of reward is redundant in this model and motivated behaviors are directly controlled by homeostatic deviation, rather than by <italic>a priori</italic> computed and reinforced rewarding values.</p><p>As alternative to the homeostatic regulation theories phrased around maintenance of setpoints, another theoretical approach toward modeling regulatory systems is the ‘settling point’ theory (<xref ref-type="bibr" rid="bib64">Wirtshafter &amp; Davis, 1977</xref>; <xref ref-type="bibr" rid="bib4">Berridge, 2004</xref>; <xref ref-type="bibr" rid="bib36">Müller et al., 2010</xref>; <xref ref-type="bibr" rid="bib56">Speakman et al., 2011</xref>). According to this theory, by viewing organisms as dynamical systems, what looks like a homeostatic setpoint is just the stable state of the system caused by a balance of different opposing effectors on the internal variables. However, one should notice that mathematically, such dynamical systems can be re-formulated as a homeostatically regulated system, by writing down a potential functional for the system (or an energy function). Such an energy function is equivalent to our drive function whose setpoint corresponds to the settling point of the dynamical system formulation. Thus, there is equivalence between the two methods, and the setpoint approach summarizes the outcome of the underlying dynamical system on the regulated variables. Note that nothing precludes our framework to treat the setpoint conceptually as maintained internally by an underlying system of effectors and regulators. However, the setpoint/drive-function formulation conveniently allows us to derive our normative theory.</p></sec><sec id="s3-5"><title>Predictions</title><p>Here we list the testable predictions of our theory, some of which put our model to test against alternative proposals. Firstly, as mentioned before (<xref ref-type="fig" rid="fig9">Figure 9</xref>), our theory predicts that the oral vs. fistula proportion in the water self-administration task (<xref ref-type="bibr" rid="bib33">McFarland, 1969</xref>) affects the speed of satiation: the higher the oral portion is, the faster the setpoint will be reached.</p><p>Secondly, as discussed before, our model predicts an inverted U-shaped utility function (<xref ref-type="fig" rid="fig11">Figure 11A,B</xref>). This is in contrast to the multiplicative formulations of deprivation-modulated reward.</p><p>Thirdly, our model predicts that if animals are offered with two outcomes where one outcome reduces the homeostatic deviation and the other increases the deviation, the animal chooses to first take the deviation-reducing and then the deviation-increasing outcome (<xref ref-type="fig" rid="fig11">Figure 11C</xref>, green sequence), but not the other way around (<xref ref-type="fig" rid="fig11">Figure 11C</xref>, red sequence). This is due to the fact that future deviations (and rewards) are discounted. Thus, the animal tries to postpone further deviations and expedite drive-reducing outcomes.</p><p>Fourthly, as explained earlier, we predict that animals are capable of learning not only Pavlovian, but also instrumental anticipatory responding. This is in contrast to the prediction of the predictive homeostasis theory (<xref ref-type="bibr" rid="bib67">Woods &amp; Ramsay, 2007</xref>; <xref ref-type="bibr" rid="bib58">Sterling, 2012</xref>; Stephen C ).</p><p>Finally, our theory predicts that upon reducing the magnitude of the outcome, a transitory burst of responding should be observed. We simulate both our model (<xref ref-type="fig" rid="fig12">Figure 12</xref>, left) and classical homeostatic regulation models (<xref ref-type="fig" rid="fig12">Figure 12</xref>, right) in an artificial environment where pressing a lever results in the agent receiving a big outcome (1 g) during the first hour, and a significantly smaller outcome (0.125 g) during the second hour of the experiment. According to the classical models, the corrective response (lever-press) is performed when the internal state drops below the setpoint. Thus, during the first hour, the agent responds with a stable rate (<xref ref-type="fig" rid="fig12">Figure 12E,F</xref>) in order maintain the internal state above the setpoint (<xref ref-type="fig" rid="fig12">Figure 12D</xref>). Upon decreasing the dose, the agent waits until the internal state again drops below the setpoint. Thereafter, the agent presses the lever with a new rate, corresponding to the new dose. Therefore, according to this class of models, response rate switches from a stable low level to a stable high level, with no burst phase in between (<xref ref-type="fig" rid="fig12">Figure 12F</xref>).<fig-group><fig id="fig12" position="float"><object-id pub-id-type="doi">10.7554/eLife.04811.028</object-id><label>Figure 12.</label><caption><title>Simulation results, predicting a transitory burst of responding upon reducing the dose of outcome.</title><p>Our model (left column) and negative-feedback models (right column) are simulated is a process where responding yields big and small outcomes, during the first and second hours of the experiment, respectively. In our model, the objective is stay as close as possible to the setpoint (<bold>A</bold>), whereas in previous homeostatic regulation models, the objective is to stay above the setpoint (<bold>D</bold>). Thus, our model predicts a short-term burst of responding after the dose reduction, followed by regular and escalated response rate (<bold>B</bold>, <bold>C</bold>). Classical HR models, however, predict an immediate transition from a steady low to a steady high response rate (<bold>E</bold>, <bold>F</bold>). See <xref ref-type="fig" rid="fig12s1">Figure 12—figure supplements 1</xref> and <xref ref-type="supplementary-material" rid="SD6-data">Figure 12—source data 1</xref> for simulation details.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.028">http://dx.doi.org/10.7554/eLife.04811.028</ext-link></p><p><supplementary-material id="SD6-data"><object-id pub-id-type="doi">10.7554/eLife.04811.029</object-id><label>Figure 12—source data 1.</label><caption><title>Free parameters for the within-session dose-change simulation.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.029">http://dx.doi.org/10.7554/eLife.04811.029</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-04811-fig12-data1-v1.docx"/></supplementary-material></p></caption><graphic xlink:href="elife-04811-fig12-v1"/></fig><fig id="fig12s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.04811.030</object-id><label>Figure 12—figure supplement 1.</label><caption><title>The Markov Decision Process used for the within-session dose-change simulation.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.04811.030">http://dx.doi.org/10.7554/eLife.04811.030</ext-link></p></caption><graphic xlink:href="elife-04811-fig12-figsupp1-v1"/></fig></fig-group></p><p>According to our model, however, when the unit dose decreases from 1 g to 0.125 g, the agent requires at least some new experiences with the outcome in order to realize that this change has happened (i.e., in order to update the expected outcome associated with every action). Thus, right after the dose is decreased, the agent still expects to receive a big outcome upon pressing the lever. Therefore, as the objective is to minimize deviation from the setpoint (rather that staying above the setpoint), the agent waits for a period equal to the normal inter-infusion interval of the 1 g unit-dose. During this period, the internal state reaches the same lower bound as in previous trials (<xref ref-type="fig" rid="fig12">Figure 12A</xref>). Afterward, when the agent presses the lever for the first time, it receives an unexpectedly small outcome, which is not sufficient for reaching the setpoint. Thus, several further responses will be needed to reach the setpoint, resulting in a burst of responding after decreasing the unit dose (<xref ref-type="fig" rid="fig12">Figure 12B,C</xref>). After the setpoint is achieved, the agent presses the lever with a lower (-than-burst) rate, in order to keep the internal state close to the setpoint. In sum, in contrast to the classical HR models, our theory predicts a temporary burst of self-administration after dose reduction (See <xref ref-type="supplementary-material" rid="SD6-data">Figure 12—source data 1</xref> for simulation details).</p></sec><sec id="s3-6"><title>Limitations and future directions</title><p>From an evolutionary perspective, physiological stability and thus survival may themselves be seen as means of guaranteeing reproduction. These intermediate objectives can be even violated in specific conditions and be replaced with parental sacrifice. Still, we believe that homeostatic maintenance can explain a significant proportion of motivated behaviors in animals. It is also noteworthy that our theory only applies to rewards that have a corresponding regulatory system. How to extend our theory to rewards without a corresponding homeostatic regulation system (e.g., social rewards, novelty-induced reward, etc.) remains a key challenge for the future.</p><p>In order to put forth our formal theory we had to put forward several key constraints and assumptions. As further future directions, one could relax several constraining assumptions of our formal setup of the theory. For example, redesigning the model in a <italic>partially observable</italic> condition (as opposed to the fully-observable setup we used) where the internal state observation is susceptible to noise could have important implications for understanding some psychiatric diseases and self-perception distortion disorders, such as anorexia nervosa. Also, relaxing the assumption that the setpoint is fixed and making it adaptive to the animal's experiences could explain tolerance (as elevated perception of desired setpoint) and thus, drug addiction and obesity. Furthermore, relaxing the restrictive functional form of the drive function and introducing more general forms could explain behavioral patterns that our model does not yet account for, like asymmetric risk-aversion toward gains vs. losses (<xref ref-type="bibr" rid="bib25">Kahneman &amp; Tversky, 1979</xref>).</p></sec><sec id="s3-7"><title>Conclusion</title><p>In a nutshell, our theory incorporates a formal physiological definition of primary rewards into a novel homeostatically regulated reinforcement learning theory, allowing us to prove that economically rational behaviors ensure physiological integrity. Being inspired by the classic drive-reduction theory of motivation, our mathematical treatment allows for quantitative results to be obtained, predictions that make the theory testable, and logical coherence. The theory, with its set of formal assumptions and proofs, does not purport to explain the full gamut of animal behavior, yet we believe it to be a credible step toward developing a coherent mathematical framework to understand behaviors that depend on motivations stemming from internal states and needs of the individual. Furthermore, this work puts forth a meta-hypothesis that a number of apparently irrational behaviors regain their rationality if the internal state of the individual is taken into account. Among others, the relationship between our learning-based theory and evolutionary processes that shape animal a priori preferences and influence behavioral patterns remains a key challenge.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Rationality of the theory</title><p>Here we show analytically that maximizing rewards and minimizing deviations from the setpoint are equivalent objective functions.</p><sec id="s4-1-1"><title>Definition:</title><p>A ‘homeostatic trajectory’, denoted by <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, is an ordered sequence of transitions in the <inline-formula><mml:math id="inf60"><mml:mi>v</mml:mi></mml:math></inline-formula>-dimensional homeostatic space. Each <inline-formula><mml:math id="inf61"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a <inline-formula><mml:math id="inf62"><mml:mi>v</mml:mi></mml:math></inline-formula>-dimensional vector, determining the length and direction of one transition. We also define <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> as the set of all trajectories that if start from <inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, will end up at <inline-formula><mml:math id="inf65"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-1-2"><title>Definition:</title><p>For each homeostatic trajectory <italic>p</italic> that starts from the initial motivational state <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and consists of <inline-formula><mml:math id="inf67"><mml:mi>w</mml:mi></mml:math></inline-formula> elements, we define <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> as the ‘sum of discounted drives’ through that trajectory:<disp-formula id="equ15"><label>(S1)</label><mml:math id="m15"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>.</mml:mo><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula>Where <inline-formula><mml:math id="inf69"><mml:mi>γ</mml:mi></mml:math></inline-formula> is the discount factor, and <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mo>.</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is the drive function. Also, starting from <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, the internal state evolves by <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-1-3"><title>Definition:</title><p>Similarly, for each homeostatic trajectory <italic>p</italic> that starts from the initial motivational state <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and consists of <inline-formula><mml:math id="inf74"><mml:mi>m</mml:mi></mml:math></inline-formula> elements, we define <inline-formula><mml:math id="inf75"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> as the ‘sum of discounted rewards’ through that trajectory:<disp-formula id="equ16"><label>(S2)</label><mml:math id="m16"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>.</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-1-4"><title>Proposition:</title><p>For any initial state <inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, if <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we will have:<disp-formula id="equ17"><label>(S3)</label><mml:math id="m17"><mml:mrow><mml:munder><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Roughly, this means that a policy that minimizes deviation from the setpoint, also maximizes acquisition of reward, and vice versa.</p></sec><sec id="s4-1-5"><title>Proof:</title><p>Assume that <inline-formula><mml:math id="inf78"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is a sample trajectory consisting of <inline-formula><mml:math id="inf79"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> transitions. As a result of these transitions, the internal state will take a sequence like: <inline-formula><mml:math id="inf80"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Denoting <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> by <inline-formula><mml:math id="inf82"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for the sake of simplicity in notation, the drive value will take the following sequence: <inline-formula><mml:math id="inf83"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. We have:<disp-formula id="equ18"><label>(S4)</label><mml:math id="m18"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mtext>*</mml:mtext></mml:msup></mml:mrow></mml:math></disp-formula></p><p>We also have:<disp-formula id="equ19"><label>(S5)</label><mml:math id="m19"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mtext>*</mml:mtext></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Since <inline-formula><mml:math id="inf89"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> has a fixed value and <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, it can be concluded that if a certain trajectory from <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> maximizes <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, it will also minimize <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and vice versa. Thus, the trajectories that satisfy these two objectives are identical.</p></sec></sec><sec id="s4-2"><title>Hyper-palatability effect</title><p>For the especial case that m/n = 1, <xref ref-type="disp-formula" rid="equ11">Equation 11</xref> can be rewritten as follows:<disp-formula id="equ20"><label>(S6)</label><mml:math id="m20"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>T</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>T</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>This means that the effect of <italic>T</italic> is equivalent to having a simple HRL system (without term <italic>T</italic>) whose drive function is shifted such that the new setpoint is equal to <inline-formula><mml:math id="inf98"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>T</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf99"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> is the setpoint of the original system. This predicts that the bigger the hyper-palatability factor <italic>T</italic> is, the higher the new steady state is, and the higher the real nutritional content <inline-formula><mml:math id="inf100"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of the food outcome is, the less divergence of the new setpoint from the original setpoint is.</p><p><xref ref-type="disp-formula" rid="equ5">Equation 5</xref> can also be re-written as:<disp-formula id="equ21"><label>(S7)</label><mml:math id="m21"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mi>T</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mi>T</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>This can be interpreted as the effect of <italic>T</italic> being equivalent to a simple HRL system (without term <italic>T</italic>) whose internal state <inline-formula><mml:math id="inf105"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is underestimated by <inline-formula><mml:math id="inf106"><mml:mrow><mml:mfrac><mml:mi>T</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> units. That is, hyper-palatability makes the behavior look like as if the subject is hungrier than what they really are.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgments</title><p>We thank Peter Dayan, Amir Dezfouli, Serge Ahmed, and Mathias Pessiglione for critical discussions, and Peter Dayan and Oliver Hulme for commenting on the manuscript. The authors acknowledge partial funding from ANR-10-LABX-0087 IEC (BSG), ANR-10-IDEX-0001-02 PSL* (BSG), CNRS (BSG), INSERM (BSG), and FRM (MK). Support from the Basic Research Program of the National Research University Higher School of Economics is gratefully acknowledged by BSG.</p></ack><sec sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>MK, Doing simulations, Deriving analytical proofs, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>BG, Discussing the results, Drafting or revising the article</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barbano</surname><given-names>MF</given-names></name><name><surname>Le Saux</surname><given-names>M</given-names></name><name><surname>Cador</surname><given-names>M</given-names></name></person-group><year>2009</year><article-title>Involvement of dopamine and opioids in the motivation to eat: influence of palatability, homeostatic state, and behavioral paradigms</article-title><source>Psychopharmacology</source><volume>203</volume><fpage>475</fpage><lpage>487</lpage><pub-id pub-id-type="doi">10.1007/s00213-008-1390-6</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beeler</surname><given-names>JA</given-names></name><name><surname>McCutcheon</surname><given-names>JE</given-names></name><name><surname>Cao</surname><given-names>ZF</given-names></name><name><surname>Murakami</surname><given-names>M</given-names></name><name><surname>Alexander</surname><given-names>E</given-names></name><name><surname>Roitman</surname><given-names>MF</given-names></name><name><surname>Zhuang</surname><given-names>X</given-names></name></person-group><year>2012</year><article-title>Taste uncoupled from nutrition fails to sustain the reinforcing properties of food</article-title><source>The European Journal of Neuroscience</source><volume>36</volume><fpage>2533</fpage><lpage>2546</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2012.08167.x</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bernard</surname><given-names>C</given-names></name></person-group><year>1957</year><article-title>Lectures on the physiological properties and the pathological alternations of the liquids of the organism: Third lecture</article-title><person-group person-group-type="editor"><name><surname>Langley</surname><given-names>LL</given-names></name></person-group><source>Homeostasis: Origins of the concept, 1973</source><publisher-loc>Stroudsberg, PA</publisher-loc><publisher-name>Dowden, Hutchinson &amp; Ross, Inc</publisher-name><fpage>89</fpage><lpage>100</lpage></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berridge</surname><given-names>KC</given-names></name></person-group><year>2004</year><article-title>Motivation concepts in behavioral neuroscience</article-title><source>Physiology &amp; Behavior</source><volume>81</volume><fpage>179</fpage><lpage>209</lpage><pub-id pub-id-type="doi">10.1016/j.physbeh.2004.02.004</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berridge</surname><given-names>KC</given-names></name></person-group><year>2012</year><article-title>From prediction error to incentive salience: mesolimbic computation of reward motivation</article-title><source>The European Journal of Neuroscience</source><volume>35</volume><fpage>1124</fpage><lpage>1143</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2012.07990.x</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breslin</surname><given-names>PA</given-names></name></person-group><year>2013</year><article-title>An evolutionary perspective on food and human taste</article-title><source>Current Biology</source><volume>23</volume><fpage>R409</fpage><lpage>R418</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.04.010</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burdakov</surname><given-names>D</given-names></name><name><surname>Gerasimenko</surname><given-names>O</given-names></name><name><surname>Verkhratsky</surname><given-names>A</given-names></name></person-group><year>2005</year><article-title>Physiological changes in glucose differentially modulate the excitability of hypothalamic melanin-concentrating hormone and orexin neurons in situ</article-title><source>The Journal of Neuroscience</source><volume>25</volume><fpage>2429</fpage><lpage>2433</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4925-04.2005</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Busemeyer</surname><given-names>JR</given-names></name><name><surname>Townsend</surname><given-names>JT</given-names></name><name><surname>Stout</surname><given-names>JC</given-names></name></person-group><year>2002</year><article-title>Motivational underpinnings of utility in decision making: decision field theory analysis of deprivation and satiation</article-title><person-group person-group-type="editor"><name><surname>Moore</surname><given-names>S</given-names></name><name><surname>Oaksford</surname><given-names>M</given-names></name></person-group><source>Emotional cognition: from brain to behaviour</source><publisher-loc>Amsterdam</publisher-loc><publisher-name>John Benjamins</publisher-name><fpage>197</fpage><lpage>218</lpage></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cabanac</surname><given-names>M</given-names></name></person-group><year>1971</year><article-title>Physiological role of Pleasure</article-title><source>Science</source><volume>173</volume><fpage>1103</fpage><lpage>1107</lpage><pub-id pub-id-type="doi">10.1126/science.173.4002.1103</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cannon</surname><given-names>WB</given-names></name></person-group><year>1929</year><article-title>Organization for physiological homeostasis</article-title><source>Physiological Reviews</source><volume>9</volume><fpage>399</fpage><lpage>431</lpage></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>SH</given-names></name><name><surname>Herrnstein</surname><given-names>RJ</given-names></name></person-group><year>1967</year><article-title>Choice and delay of reinforcement</article-title><source>Journal of the Experimental Analysis of Behavior</source><volume>10</volume><fpage>67</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1901/jeab.1967.10-67</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cleary</surname><given-names>J</given-names></name><name><surname>Weldon</surname><given-names>DT</given-names></name><name><surname>O'Hare</surname><given-names>E</given-names></name><name><surname>Billington</surname><given-names>C</given-names></name><name><surname>Levine</surname><given-names>AS</given-names></name></person-group><year>1996</year><article-title>Naloxone effects on sucrose-motivated behavior</article-title><source>Psychopharmacology</source><volume>126</volume><fpage>110</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1007/BF02246345</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conant</surname><given-names>RC</given-names></name><name><surname>Ashby</surname><given-names>WR</given-names></name></person-group><year>1970</year><article-title>Every good regulator of a system must be a model of that system</article-title><source>International Journal of Systems Science</source><volume>1</volume><fpage>89</fpage><lpage>97</lpage></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cornelius</surname><given-names>JR</given-names></name><name><surname>Tippmann-Peikert</surname><given-names>M</given-names></name><name><surname>Slocumb</surname><given-names>NL</given-names></name><name><surname>Frerichs</surname><given-names>CF</given-names></name><name><surname>Silber</surname><given-names>MH</given-names></name></person-group><year>2010</year><article-title>Impulse control disorders with the use of dopaminergic agents in restless legs syndrome: a case-control study</article-title><source>Sleep</source><volume>33</volume><fpage>81</fpage><lpage>87</lpage></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Araujo</surname><given-names>IE</given-names></name><name><surname>Oliveira-Maia</surname><given-names>AJ</given-names></name><name><surname>Sotnikova</surname><given-names>TD</given-names></name><name><surname>Gainetdinov</surname><given-names>RR</given-names></name><name><surname>Caron</surname><given-names>MG</given-names></name><name><surname>Nicolelis</surname><given-names>MAL</given-names></name><name><surname>Simon</surname><given-names>SA</given-names></name></person-group><year>2008</year><article-title>Food reward in the absence of taste receptor signaling</article-title><source>Neuron</source><volume>57</volume><fpage>930</fpage><lpage>941</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.01.032</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Devine</surname><given-names>DP</given-names></name><name><surname>Leone</surname><given-names>P</given-names></name><name><surname>Wise</surname><given-names>RA</given-names></name></person-group><year>1993</year><article-title>Mesolimbic dopamine neurotransmission is increased by administration of mu-opioid receptor antagonists</article-title><source>European Journal of Pharmacology</source><volume>243</volume><fpage>55</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.1016/0014-2999(93)90167-G</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dickinson</surname><given-names>A</given-names></name><name><surname>Balleine</surname><given-names>BW</given-names></name></person-group><year>2002</year><article-title>The role of learning in motivation</article-title><person-group person-group-type="editor"><name><surname>Gallistel</surname><given-names>CR</given-names></name></person-group><source>Volume 3 of Steven's Handbook of experimental psychology: learning, motivation, and Emotion</source><edition>3rd edition</edition><publisher-loc>New York</publisher-loc><publisher-name>Wiley</publisher-name><fpage>497</fpage><lpage>533</lpage></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doyle</surname><given-names>TG</given-names></name><name><surname>Berridge</surname><given-names>KC</given-names></name><name><surname>Gosnell</surname><given-names>BA</given-names></name></person-group><year>1993</year><article-title>Morphine enhances hedonic taste palatability in rats</article-title><source>Pharmacology, Biochemistry, and Behavior</source><volume>46</volume><fpage>745</fpage><lpage>749</lpage><pub-id pub-id-type="doi">10.1016/0091-3057(93)90572-B</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dranias</surname><given-names>MR</given-names></name><name><surname>Grossberg</surname><given-names>S</given-names></name><name><surname>Bullock</surname><given-names>D</given-names></name></person-group><year>2008</year><article-title>Dopaminergic and non-dopaminergic value systems in conditioning and outcome-specific revaluation</article-title><source>Brain Research</source><volume>1238</volume><fpage>239</fpage><lpage>287</lpage><pub-id pub-id-type="doi">10.1016/j.brainres.2008.07.013</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname><given-names>K</given-names></name></person-group><year>2010</year><article-title>The free-energy principle: a unified brain theory?</article-title> <source>Nature Reviews Neuroscience</source><volume>11</volume><fpage>127</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1038/nrn2787</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glass</surname><given-names>MJ</given-names></name><name><surname>Grace</surname><given-names>M</given-names></name><name><surname>Cleary</surname><given-names>JP</given-names></name><name><surname>Billington</surname><given-names>CJ</given-names></name><name><surname>Levine</surname><given-names>AS</given-names></name></person-group><year>1996</year><article-title>Potency of naloxone's anorectic effect in rats is dependent on diet preference</article-title><source>The American Journal of Physiology</source><volume>271</volume><fpage>R217</fpage><lpage>R221</lpage></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hjeresen</surname><given-names>DL</given-names></name><name><surname>Reed</surname><given-names>DR</given-names></name><name><surname>Woods</surname><given-names>SC</given-names></name></person-group><year>1986</year><article-title>Tolerance to hypothermia induced by ethanol depends on specific drug effects</article-title><source>Psychopharmacology</source><volume>89</volume><fpage>45</fpage><lpage>51</lpage><pub-id pub-id-type="doi">10.1007/BF00175187</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hodos</surname><given-names>W</given-names></name></person-group><year>1961</year><article-title>Progressive ratio as a measure of reward strength</article-title><source>Science</source><volume>134</volume><fpage>943</fpage><lpage>944</lpage><pub-id pub-id-type="doi">10.1126/science.134.3483.943</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hull</surname><given-names>CL</given-names></name></person-group><year>1943</year><source>Principles of behavior: an introduction to behavior theory</source><publisher-loc>New York</publisher-loc><publisher-name>Appleton-Century-Crofts</publisher-name></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kahneman</surname><given-names>D</given-names></name><name><surname>Tversky</surname><given-names>A</given-names></name></person-group><year>1979</year><article-title>Prospect theory: an Analysis of Decision under risk</article-title><source>Econometrica</source><volume>47</volume><fpage>263</fpage><lpage>291</lpage><pub-id pub-id-type="doi">10.2307/1914185</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korotkova</surname><given-names>TM</given-names></name><name><surname>Sergeeva</surname><given-names>OA</given-names></name><name><surname>Eriksson</surname><given-names>KS</given-names></name><name><surname>Haas</surname><given-names>HL</given-names></name><name><surname>Brown</surname><given-names>RE</given-names></name></person-group><year>2003</year><article-title>Excitation of ventral tegmental area dopaminergic and nondopaminergic neurons by orexins/hypocretins</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>7</fpage><lpage>11</lpage></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mansfield</surname><given-names>JG</given-names></name><name><surname>Benedict</surname><given-names>RS</given-names></name><name><surname>Woods</surname><given-names>SC</given-names></name></person-group><year>1983</year><article-title>Response specificity of behaviorally augmented tolerance to ethanol supports a learning interpretation</article-title><source>Psychopharmacology</source><volume>79</volume><fpage>94</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1007/BF00427791</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mansfield</surname><given-names>JG</given-names></name><name><surname>Cunningham</surname><given-names>CL</given-names></name></person-group><year>1980</year><article-title>Conditioning and extinction of tolerance to the hypothermic effect of ethanol in rats</article-title><source>Journal of Comparative and Physiological Psychology</source><volume>94</volume><fpage>962</fpage><lpage>969</lpage><pub-id pub-id-type="doi">10.1037/h0077824</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Marieb</surname><given-names>EN</given-names></name><name><surname>Hoehn</surname><given-names>K</given-names></name></person-group><year>2012</year><article-title>Human Anatomy &amp; Physiology</article-title><edition>9th edition</edition><publisher-name>Benjamin Cummings</publisher-name><fpage>1264</fpage></element-citation></ref><ref id="bib30"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Marr</surname><given-names>D</given-names></name></person-group><year>1982</year><source>Vision</source><publisher-loc>Cambridge, Massachusetts</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib31"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mas-Colell</surname><given-names>A</given-names></name><name><surname>Whinston</surname><given-names>MD</given-names></name><name><surname>Green</surname><given-names>JR</given-names></name></person-group><year>1995</year><source>Microeconomic Theory</source><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge Univ. Press</publisher-name></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCrory</surname><given-names>MA</given-names></name><name><surname>Suen</surname><given-names>VMM</given-names></name><name><surname>Roberts</surname><given-names>SB</given-names></name></person-group><year>2002</year><article-title>Biobehavioral influences on energy intake and adult weight gain</article-title><source>The Journal of Nutrition</source><volume>132</volume><fpage>3830S</fpage><lpage>3834S</lpage></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McFarland</surname><given-names>D</given-names></name></person-group><year>1969</year><article-title>Separation of satiating and rewarding consequences of drinking</article-title><source>Physiology &amp; Behavior</source><volume>4</volume><fpage>987</fpage><lpage>989</lpage><pub-id pub-id-type="doi">10.1016/0031-9384(69)90054-7</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>NE</given-names></name><name><surname>Kessen</surname><given-names>ML</given-names></name></person-group><year>1952</year><article-title>Reward effects of food via stomach fistula compared with those of food via mouth</article-title><source>Journal of Comparative and Physiological Psychology</source><volume>45</volume><fpage>555</fpage><lpage>564</lpage><pub-id pub-id-type="doi">10.1037/h0060113</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mowrer</surname><given-names>OH</given-names></name></person-group><year>1960</year><source>Learning theory and behavior</source><publisher-loc>New York</publisher-loc><publisher-name>Wiley</publisher-name></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Müller</surname><given-names>MJ</given-names></name><name><surname>Bosy-Westphal</surname><given-names>A</given-names></name><name><surname>Heymsfield</surname><given-names>SB</given-names></name></person-group><year>2010</year><article-title>Is there evidence for a set point that regulates human body weight?</article-title><source>F1000 Medicine Reports</source><volume>2</volume><fpage>59</fpage><pub-id pub-id-type="doi">10.3410/M2-59</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Narita</surname><given-names>M</given-names></name><name><surname>Nagumo</surname><given-names>Y</given-names></name><name><surname>Hashimoto</surname><given-names>S</given-names></name><name><surname>Narita</surname><given-names>M</given-names></name><name><surname>Khotib</surname><given-names>J</given-names></name><name><surname>Miyatake</surname><given-names>M</given-names></name><name><surname>Sakurai</surname><given-names>T</given-names></name><name><surname>Yanagisawa</surname><given-names>M</given-names></name><name><surname>Nakamachi</surname><given-names>T</given-names></name><name><surname>Shioda</surname><given-names>S</given-names></name><name><surname>Suzuki</surname><given-names>T</given-names></name></person-group><year>2006</year><article-title>Direct involvement of orexinergic systems in the activation of the mesolimbic dopamine pathway and related behaviors induced by morphine</article-title><source>The Journal of neuroscience</source><volume>26</volume><fpage>398</fpage><lpage>405</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2761-05.2006</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nestler</surname><given-names>EJ</given-names></name></person-group><year>2001</year><article-title>Molecular basis of long-term plasticity underlying addiction</article-title><source>Nature Reviews Neuroscience</source><volume>2</volume><fpage>119</fpage><lpage>128</lpage><pub-id pub-id-type="doi">10.1038/35053570</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noel</surname><given-names>MB</given-names></name><name><surname>Wise</surname><given-names>RA</given-names></name></person-group><year>1993</year><article-title>Ventral tegmental injections of morphine but not U-50,488H enhance feeding in food-deprived rats</article-title><source>Brain Research</source><volume>632</volume><fpage>68</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(93)91139-J</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palmiter</surname><given-names>RD</given-names></name></person-group><year>2007</year><article-title>Is dopamine a physiologically relevant mediator of feeding behavior?</article-title> <source>Trends in Neurosciences</source><volume>30</volume><fpage>375</fpage><lpage>381</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2007.06.004</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rangel</surname><given-names>A</given-names></name></person-group><year>2013</year><article-title>Regulation of dietary choice by the decision-making circuitry</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1717</fpage><lpage>1724</lpage><pub-id pub-id-type="doi">10.1038/nn.3561</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rangel</surname><given-names>A</given-names></name><name><surname>Camerer</surname><given-names>C</given-names></name><name><surname>Montague</surname><given-names>PR</given-names></name></person-group><year>2008</year><article-title>A framework for studying the neurobiology of value-based decision making</article-title><source>Nature Reviews Neuroscience</source><volume>9</volume><fpage>545</fpage><lpage>556</lpage><pub-id pub-id-type="doi">10.1038/nrn2357</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ren</surname><given-names>X</given-names></name><name><surname>Ferreira</surname><given-names>JG</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Shammah-Lagnado</surname><given-names>SJ</given-names></name><name><surname>Yeckel</surname><given-names>CW</given-names></name><name><surname>de Araujo</surname><given-names>IE</given-names></name></person-group><year>2010</year><article-title>Nutrient selection in the absence of taste receptor signaling</article-title><source>The Journal of Neuroscience</source><volume>30</volume><fpage>8012</fpage><lpage>8023</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5749-09.2010</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodgers</surname><given-names>RJ</given-names></name><name><surname>Halford</surname><given-names>JC</given-names></name><name><surname>Nunes de Souza</surname><given-names>RL</given-names></name><name><surname>Canto de Souza</surname><given-names>AL</given-names></name><name><surname>Piper</surname><given-names>DC</given-names></name><name><surname>Arch</surname><given-names>JR</given-names></name><name><surname>Upton</surname><given-names>N</given-names></name><name><surname>Porter</surname><given-names>RA</given-names></name><name><surname>Johns</surname><given-names>A</given-names></name><name><surname>Blundell</surname><given-names>JE</given-names></name></person-group><year>2001</year><article-title>SB-334867, a selective orexin-1 receptor antagonist, enhances behavioural satiety and blocks the hyperphagic effect of orexin-A in rats</article-title><source>The European Journal of Neuroscience</source><volume>13</volume><fpage>1444</fpage><lpage>1452</lpage><pub-id pub-id-type="doi">10.1046/j.0953-816x.2001.01518.x</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rolls</surname><given-names>ET</given-names></name></person-group><year>2007</year><article-title>Understanding the mechanisms of food intake and obesity</article-title><source>Obesity Reviews</source><volume>8</volume><fpage>67</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1111/j.1467-789X.2007.00321.x</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sakurai</surname><given-names>T</given-names></name><name><surname>Amemiya</surname><given-names>A</given-names></name><name><surname>Ishii</surname><given-names>M</given-names></name><name><surname>Matsuzaki</surname><given-names>I</given-names></name><name><surname>Chemelli</surname><given-names>RM</given-names></name><name><surname>Tanaka</surname><given-names>H</given-names></name><name><surname>Williams</surname><given-names>SC</given-names></name><name><surname>Richardson</surname><given-names>JA</given-names></name><name><surname>Kozlowski</surname><given-names>GP</given-names></name><name><surname>Wilson</surname><given-names>S</given-names></name><name><surname>Arch</surname><given-names>JR</given-names></name><name><surname>Buckingham</surname><given-names>RE</given-names></name><name><surname>Haynes</surname><given-names>AC</given-names></name><name><surname>Carr</surname><given-names>SA</given-names></name><name><surname>Annan</surname><given-names>RS</given-names></name><name><surname>McNulty</surname><given-names>DE</given-names></name><name><surname>Liu</surname><given-names>WS</given-names></name><name><surname>Terrett</surname><given-names>JA</given-names></name><name><surname>Elshourbagy</surname><given-names>NA</given-names></name><name><surname>Bergsma</surname><given-names>DJ</given-names></name><name><surname>Yanagisawa</surname><given-names>M</given-names></name></person-group><year>1998</year><article-title>Orexins and orexin receptors: a family of hypothalamic neuropeptides and G protein-coupled receptors that regulate feeding behavior</article-title><source>Cell</source><volume>92</volume><fpage>573</fpage><lpage>585</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(00)80949-6</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanger</surname><given-names>DJ</given-names></name><name><surname>McCarthy</surname><given-names>PS</given-names></name></person-group><year>1980</year><article-title>Differential effects of morphine on food and water intake in food deprived and freely-feeding rats</article-title><source>Psychopharmacology</source><volume>72</volume><fpage>103</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1007/BF00433813</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savage</surname><given-names>T</given-names></name></person-group><year>2000</year><article-title>Artificial motives: A review of motivation in artificial creatures</article-title><source>Connection Science</source><volume>12</volume><fpage>211</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1080/095400900750060131</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneider</surname><given-names>LH</given-names></name></person-group><year>1989</year><article-title>Orosensory self-stimulation by sucrose involves brain dopaminergic mechanisms</article-title><source>Annals of the New York Academy of Sciences</source><volume>575</volume><fpage>307</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.1111/j.1749-6632.1989.tb53252.x</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schultz</surname><given-names>W</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Montague</surname><given-names>PR</given-names></name></person-group><year>1997</year><article-title>A neural substrate of prediction and reward</article-title><source>Science</source><volume>275</volume><fpage>1593</fpage><lpage>1599</lpage><pub-id pub-id-type="doi">10.1126/science.275.5306.1593</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seth</surname><given-names>AK</given-names></name></person-group><year>2013</year><article-title>Interoceptive inference, emotion, and the embodied self</article-title><source>Trends in Cognitive Sciences</source><volume>17</volume><fpage>565</fpage><lpage>573</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2013.09.007</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sibly</surname><given-names>RM</given-names></name><name><surname>McFarland</surname><given-names>DJ</given-names></name></person-group><year>1974</year><source>State Space Approach to Motivation, Motivational Control System Analysis</source><publisher-name>Academic Press</publisher-name></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>S</given-names></name><name><surname>Lewis</surname><given-names>RL</given-names></name><name><surname>Barto</surname><given-names>AG</given-names></name><name><surname>Sorg</surname><given-names>J</given-names></name></person-group><year>2010</year><article-title>Intrinsically motivated reinforcement learning: an evolutionary perspective</article-title><source>IEEE Transactions on Autonomous Mental Development</source><volume>2</volume><fpage>70</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1109/TAMD.2010.2051031</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skjoldager</surname><given-names>P</given-names></name><name><surname>Pierre</surname><given-names>PJ</given-names></name><name><surname>Mittleman</surname><given-names>G</given-names></name></person-group><year>1993</year><article-title>Reinforcer Magnitude and progressive ratio Responding in the rat: Effects of increased Effort, Prefeeding, and extinction</article-title><source>Learning and Motivation</source><volume>24</volume><fpage>303</fpage><lpage>343</lpage><pub-id pub-id-type="doi">10.1006/lmot.1993.1019</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solinas</surname><given-names>M</given-names></name><name><surname>Goldberg</surname><given-names>SR</given-names></name></person-group><year>2005</year><article-title>Motivational effects of cannabinoids and opioids on food reinforcement depend on simultaneous activation of cannabinoid and opioid systems</article-title><source>Neuropsychopharmacology</source><volume>30</volume><fpage>2035</fpage><lpage>2045</lpage><pub-id pub-id-type="doi">10.1038/sj.npp.1300720</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Speakman</surname><given-names>JR</given-names></name><name><surname>Levitsky</surname><given-names>DA</given-names></name><name><surname>Allison</surname><given-names>DB</given-names></name><name><surname>Bray</surname><given-names>MS</given-names></name><name><surname>de Castro</surname><given-names>JM</given-names></name><name><surname>Clegg</surname><given-names>DJ</given-names></name><name><surname>Clapham</surname><given-names>JC</given-names></name><name><surname>Dulloo</surname><given-names>AG</given-names></name><name><surname>Gruer</surname><given-names>L</given-names></name><name><surname>Haw</surname><given-names>S</given-names></name><name><surname>Hebebrand</surname><given-names>J</given-names></name><name><surname>Hetherington</surname><given-names>MM</given-names></name><name><surname>Higgs</surname><given-names>S</given-names></name><name><surname>Jebb</surname><given-names>SA</given-names></name><name><surname>Loos</surname><given-names>RJ</given-names></name><name><surname>Luckman</surname><given-names>S</given-names></name><name><surname>Luke</surname><given-names>A</given-names></name><name><surname>Mohammed-Ali</surname><given-names>V</given-names></name><name><surname>O'Rahilly</surname><given-names>S</given-names></name><name><surname>Pereira</surname><given-names>M</given-names></name><name><surname>Perusse</surname><given-names>L</given-names></name><name><surname>Robinson</surname><given-names>TN</given-names></name><name><surname>Rolls</surname><given-names>B</given-names></name><name><surname>Symonds</surname><given-names>ME</given-names></name><name><surname>Westerterp-Plantenga</surname><given-names>MS</given-names></name></person-group><year>2011</year><article-title>Set points, settling points and some alternative models: theoretical options to understand how genes and environments combine to regulate body adiposity</article-title><source>Disease Models &amp; Mechanisms</source><volume>4</volume><fpage>733</fpage><lpage>745</lpage><pub-id pub-id-type="doi">10.1242/dmm.008698</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Spence</surname><given-names>KW</given-names></name></person-group><year>1956</year><source>Behavior theory and conditioning</source><publisher-loc>Westport</publisher-loc><publisher-name>Greenwood Press</publisher-name></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sterling</surname><given-names>P</given-names></name></person-group><year>2012</year><article-title>Allostasis: a model of predictive regulation</article-title><source>Physiology &amp; Behavior</source><volume>106</volume><fpage>5</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1016/j.physbeh.2011.06.004</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sutton</surname><given-names>RS</given-names></name><name><surname>Barto</surname><given-names>AG</given-names></name></person-group><year>1998</year><source>Reinforcement Learning: An Introduction</source><publisher-loc>Cambridge</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swithers</surname><given-names>SE</given-names></name><name><surname>Baker</surname><given-names>CR</given-names></name><name><surname>Davidson</surname><given-names>TL</given-names></name></person-group><year>2009</year><article-title>General and persistent effects of high-intensity sweeteners on body weight gain and caloric compensation in rats</article-title><source>Behavioral Neuroscience</source><volume>123</volume><fpage>772</fpage><lpage>780</lpage><pub-id pub-id-type="doi">10.1037/a0016139</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swithers</surname><given-names>SE</given-names></name><name><surname>Martin</surname><given-names>AA</given-names></name><name><surname>Davidson</surname><given-names>TL</given-names></name></person-group><year>2010</year><article-title>High-intensity sweeteners and energy balance</article-title><source>Physiology &amp; Behavior</source><volume>100</volume><fpage>55</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/j.physbeh.2009.12.021</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Will</surname><given-names>MJ</given-names></name><name><surname>Pratt</surname><given-names>WE</given-names></name><name><surname>Kelley</surname><given-names>AE</given-names></name></person-group><year>2006</year><article-title>Pharmacological characterization of high-fat feeding induced by opioid stimulation of the ventral striatum</article-title><source>Physiology &amp; Behavior</source><volume>89</volume><fpage>226</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.1016/j.physbeh.2006.06.008</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>KW</given-names></name><name><surname>Elmquist</surname><given-names>JK</given-names></name></person-group><year>2012</year><article-title>From neuroanatomy to behavior: central integration of peripheral signals regulating feeding behavior</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1350</fpage><lpage>1355</lpage><pub-id pub-id-type="doi">10.1038/nn.3217</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wirtshafter</surname><given-names>D</given-names></name><name><surname>Davis</surname><given-names>JD</given-names></name></person-group><year>1977</year><article-title>Set points, settling points, and the control of body weight</article-title><source>Physiology &amp; Behavior</source><volume>19</volume><fpage>75</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1016/0031-9384(77)90162-7</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woods</surname><given-names>SC</given-names></name></person-group><year>1991</year><article-title>The eating paradox: how we tolerate food</article-title><source>Psychological Review</source><volume>98</volume><fpage>488</fpage><lpage>505</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.98.4.488</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Woods</surname><given-names>SC</given-names></name><name><surname>Seeley</surname><given-names>RJ</given-names></name></person-group><year>2002</year><article-title>Hunger and energy homeostasis</article-title><person-group person-group-type="editor"><name><surname>Gallistel</surname><given-names>CR</given-names></name></person-group><source>Volume 3 of Steven's Handbook of experimental psychology: learning, motivation, and Emotion</source><edition>3rd edition</edition><publisher-loc>New York</publisher-loc><publisher-name>Wiley</publisher-name><fpage>633</fpage><lpage>668</lpage></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woods</surname><given-names>SC</given-names></name><name><surname>Ramsay</surname><given-names>DS</given-names></name></person-group><year>2007</year><article-title>Homeostasis: beyond Curt Richter</article-title><source>Appetite</source><volume>49</volume><fpage>388</fpage><lpage>398</lpage><pub-id pub-id-type="doi">10.1016/j.appet.2006.09.015</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeo</surname><given-names>GS</given-names></name><name><surname>Heisler</surname><given-names>LK</given-names></name></person-group><year>2012</year><article-title>Unraveling the brain regulation of appetite: lessons from genetics</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1343</fpage><lpage>1349</lpage><pub-id pub-id-type="doi">10.1038/nn.3211</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeomans</surname><given-names>MR</given-names></name><name><surname>Wright</surname><given-names>P</given-names></name></person-group><year>1991</year><article-title>Lower pleasantness of palatable foods in nalmefene-treated human volunteers</article-title><source>Appetite</source><volume>16</volume><fpage>249</fpage><lpage>259</lpage><pub-id pub-id-type="doi">10.1016/0195-6663(91)90062-W</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Berridge</surname><given-names>KC</given-names></name><name><surname>Tindell</surname><given-names>AJ</given-names></name><name><surname>Smith</surname><given-names>KS</given-names></name><name><surname>Aldridge</surname><given-names>JW</given-names></name></person-group><year>2009</year><article-title>A neural computational Model of incentive salience</article-title><source>PLOS Computational Biology</source><volume>5</volume><fpage>e1000437</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000437</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>M</given-names></name><name><surname>Kelley</surname><given-names>AE</given-names></name></person-group><year>1997</year><article-title>Opiate agonists microinjected into the nucleus accumbens enhance sucrose drinking in rats</article-title><source>Psychopharmacology</source><volume>132</volume><fpage>350</fpage><lpage>360</lpage><pub-id pub-id-type="doi">10.1007/s002130050355</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>M</given-names></name><name><surname>Kelley</surname><given-names>AE</given-names></name></person-group><year>2000</year><article-title>Enhanced intake of high-fat food following striatal mu-opioid stimulation: microinjection mapping and fos expression</article-title><source>Neuroscience</source><volume>99</volume><fpage>267</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1016/S0306-4522(00)00198-6</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.04811.031</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Marder</surname><given-names>Eve</given-names></name><role>Reviewing editor</role><aff><institution>Brandeis University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>[Editors’ note: this article was originally rejected after discussions between the reviewers, but the authors were invited to resubmit after an appeal against the decision.]</p><p>Thank you for choosing to send your work entitled “Collecting reward to defend homeostasis: A homeostatic reinforcement learning theory” for consideration at eLife. Your full submission has been evaluated by a Senior editor and 3 peer reviewers, and the decision was reached after discussions between the reviewers. We regret to inform you that your work will not be considered further for publication at this stage.</p><p>While the topic of your manuscript is potentially very interesting, the reviewers and BREs consulted and had a number of substantive issues that enter into this decision.</p><p>During our initial BRE discussion, one pointed out that humans (and many animals) indulge in many behaviors that are not in the animal's best interest, and violate the premises of physiological homeostasis. For example, obesity and drug-taking behavior, and many of our other activities are clearly not physiologically homeostatic. This appears to be an issue that calls into question some of the fundamental assumptions of this work? If not, how does this come into play?</p><p><italic>eLife</italic> does not allow supplemental material as is common by many journals. Instead, all material of substance should be incorporated into the main text, and less important material omitted. eLife has no specific length limitations, and this policy is to support papers that present an integrated story.</p><p>We are including the reviews in entirety below for your information. eLife welcomes theoretical work when it can add new insight into interesting biological problems, which is why we chose to review it. We only recommend revision when there is a straightforward path that we foresee could lead to a successful outcome, which is not obvious in the case of this manuscript. Consequently, we are returning it to you so that you can submit it elsewhere, either as is, or benefiting from this review. Because the reviewers find this work potentially interesting, if you feel you can successfully craft a new manuscript that addresses the issues raised in this review, we would be willing to consider it as an entirely new submission, which would be reviewed either by the same or different reviewers, and which would not be guaranteed to be successful.</p><p><italic>Reviewer #1</italic>:</p><p>I enjoyed reading this interesting discussion reinforcement learning in the setting of homeostasis. I thought your treatment was both formal and scholarly. It usefully highlights the fact that reinforcement learning or optimal control can be applied to homeostatic regulation. Having said this, as the author of the free energy principle, I find the notion that optimal control (e.g. Dynamic programming or reinforcement learning) can be applied to physiological homeostasis a little self-evident. I think the deeper challenge is to provide a principled explanation for why optimal control emerges from, or is mandated by, homeostasis.</p><p>If I understand your idea correctly, you are saying that applying optimal control to the deviation of homeostatic variables from their set point accounts for some key empirical findings in behavioural psychology. I think this is a perfectly fine thing to say and a useful contribution. However, your focus on reinforcement learning is a bit colloquial. One could equally suggest that applying predictive coding to homeostatic deviations (prediction errors about their set point) is a plausible explanation for the empirical findings. This is because one can formulate optimal control as a Kalman filter (exactly for linear quadratic control) and predictive coding is a biologically plausible implementation of Bayesian filtering.</p><p>This is important because unlike reinforcement learning, predictive coding provides a process theory or mechanistic explanation for how the brain works. In other words, it is not just a normative model but makes mechanistic predictions. I stress predictive coding because there is a lot of work on homeostasis and interoceptive inference based upon predictive coding (within the larger setting of minimising variational free energy). For example, Anil Seth has a several articles that you might want to refer to. I think you also need to discuss the intellectual background to your work in cybernetics (and more recently synergetics). A key example here would be the good regulator theorem stemming from the work of Ross Ashby on self organisation and his notion of a homeostat. A more recent (and possibly heuristic) formulation of these ideas can be found in the literature on allostasis. I notice that you refer to allostasis in the last sentence of your paper (and also cite Peter Sterling). However, you never define the distinction between allostasis and homeostasis and how this relates to the anticipatory aspects of your formulation (e.g., temporal discounting within control theory).</p><p>The other issue I think you need to discuss and qualify is the status of your normative model. Temporal discounting coefficients and other arbitrary parameters (for example the n and m in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) are characteristic of reinforcement learning models, which undermines their normative status. I am assuming here that normative means that one can describe a process in terms of optimising an objective function. However, adding ad hoc parameters to the function destroys any uniqueness or optimality properties of the normative explanation. An example of this is the temporal discounting factor that your treatment emphasises. In normative Bayesian accounts, this reflects the precision of random fluctuations in hierarchical or volatility models of contingencies. Crucially, for any given outcomes, there is a Bayes-optimal temporal discounting that renders the Bayesian description truly normative.</p><p>My main point here is that I think you need to discuss the broader church of theoretical approaches to homeostasis and self organisation and highlight why reinforcement learning might provide a useful focus. I would not be shy about emphasising its shortcomings and pointing to outstanding conceptual challenges. In one sense, making reinforcement learning accountable to homeostatic imperatives is one step in this direction, as illustrated by the importance of temporal discounting and converting a homeostasis into allostasis (and highlighting the fact that reinforcement learning is not context sensitive). As a minimum, I think you should discuss the good regulator theorem and early cybernetic formulations. I think you should also mention the notion of interoceptive inference or prediction as a relevant example of more generic Bayesian approaches. You may find useful references in the following:</p><p>Seth AK. Interoceptive inference, emotion, and the embodied self. Trends Cogn Sci. 2013 Nov;17(11):565-73.</p><p><ext-link ext-link-type="uri" xlink:href="http://en.wikipedia.org/wiki/The_free_energy_principle">http://en.wikipedia.org/wiki/The_free_energy_principle</ext-link></p><p><ext-link ext-link-type="uri" xlink:href="http://en.wikipedia.org/wiki/Allostasis">http://en.wikipedia.org/wiki/Allostasis</ext-link></p><p><ext-link ext-link-type="uri" xlink:href="http://en.wikipedia.org/wiki/Homeostat">http://en.wikipedia.org/wiki/Homeostat</ext-link></p><p>1) You introduce reinforcement learning. It might be useful to comment upon its biological plausibility. Are there any detailed models of how neuronal circuits would implement reinforcement learning in the context of homoeostasis?</p><p>2) In <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, you should highlight the fact that n and m are free parameters It would be useful to say something like:</p><p>Note that m and n (both greater than 2) are free parameters that have an important nonlinear effect on the mapping between homeostatic deviations and their motivational consequences. Later, we will consider this mapping in terms of risk and classical utility theory (risk aversion).</p><p>3) I thought that your argument was confused (or written in a confusing way). You seem to imply that in the absence of discounting, the value of a policy depends only on the initial and final states regardless of its trajectory. This is not the case in standard applications of optimal control or reinforcement learning. The quantity that is optimised is the expected reward at each point (in free energy formulations this would be the path integral). This means that the path becomes important in determining the expected reward or value. Furthermore, there is no final state unless you are considering finite horizon problems. Perhaps you meant there is no temporal integration into the future at all?</p><p><italic>Reviewer #2</italic>:</p><p>The authors describe a model in which reward is operationally defined and computed according to the degree to which an outcome reduces the distance between the animal's current state and an idealized homeostatic state (setpoint). The authors characterize this as a drive-reduction model and revisit several points of controversy from the 1940s/50s surrounding Hull's drive-reduction theory. The authors seem to suggest that (a) their model addresses all the criticism of drive-reduction and (b) that more contemporary views of motivation, which have largely rejected Hull's model, have been hasty and that we should reconsider the drive-reduction model-rescue Hull, as the authors put it.</p><p>Kudos to the authors for tackling an interesting and really important problem: how is a stimulus evaluated to determine whether it is rewarding (or aversive) in the first place, an issue almost entirely ignored in contemporary reinforcement learning models. To address the question of how are stimuli evaluated and to place that into a homeostatic framework in which reward is contingent upon the state of the animal is an important endeavor and I was excited about the authors' model.</p><p>However, several issues severely temper my enthusiasm, as follows:</p><p>1) Framing the entire model, not just the Introduction and Discussion but the Results, around revisiting and apparently rekindling a half-century old debate between drive and incentive theories of motivation seems unfortunate. The result is that the manuscript reads more like a review, mostly comprised of arguments that border on polemical. This leads to several problems:</p><p>(a) The Results section does not read like a Results section but like a Discussion section. For each of the subsections in the Results I would expect the question/problem to be defined clearly, then the details of how this was addressed in a simulation and then the results of the simulation (for example, one expects results to be substantively organized around/referencing figures). The 'results', as the manuscript stands, are essentially presented in brief in the figure legends. Less argument and 'defending' the model and more illustrating its function.</p><p>(b) Instead of framing this in a half century old debate, why not anchor it in contemporary scientific issues and questions? How are TD models being developed and applied, what are their short-comings in particular applications, how does this model improve upon that state of the art?</p><p>(c) The manuscript ends up with a cavalier quality of 'our model has just solved all these problems' but the solution is superficial (see below).</p><p>(d) The manuscript is too ambitious, attempting to implement a simple computational model of drive-reduction and then, in effect, wanting to 'put to rest' what comprised decades of (much still unresolved) controversy. Again, the result reads more like a polemical review, both cavalier and superficial. A more focused, more empirical, less argumentative approach might be more successful.</p><p>2) Several arguments are not convincing. Example; extinction burst. The intuitive explanation for extinction bursts is that the animal expects a reward and when it does not arrive, continues to work/press because prior learning does not unravel (or update) that quickly, especially if reward was stochastic in the first place (and, well, the animal is still hungry). The suggestion that a mouse that does not get a reward after pressing the lever 10 times would, as a result, be in a physiological state significantly further from setpoint that this increases their responding seems unlikely. If the mouse presses the lever 10x in 2 minutes (slow for a well-trained mouse), then the mouse's hunger state would only be increased by 2 min metabolism, but mouse behavior is not that regimented nor does receiving a pellet significantly reduce pressing when not in extinction (would you expect to see increased responding if you put the mouse in 2 min later today than yesterday?)</p><p>3) Confusion on drive-reduction vs. incentive. In the anticipatory responding section, the authors argue that their model explains why an animal would respond in the absence of a deficit state: the animal has previously learned that a cue or action is rewarding, i.e., that it is associated with relieving a deficit state. Thus, the authors argue, that learning induces the animal to respond even when not in a deficit state. But this is, in fact, precisely what incentive salience is: that animals learn the value of stimuli and that this learned value induces responding in the absence of an actual deficit state. And, in fact when animals respond for such learned value, they are not motivated but a current deficit state (as drive-reduction would have) but by learned incentive, which is causing the behavior in the absence of such need. The authors have merely reinvented the incentive-salience wheel and don't appear to realize it.</p><p>4) Anatomical substrates. There is much data suggesting that metabolic state and nutritional information is signaled in the brain (how could it not be?) and, moreover, that this impacts the dopamine system. However, the authors make a jump here and assume, without evidence, that this is a homeostatic system. Because metabolic information is signaled does not necessitate homeostasis. Equally important, as the authors are discussing the effect of metabolic state on dopamine signaling, a distinction between tonic and phasic needs to be made. So for example, tonic dopamine goes up and remains up for a period of time during a meal, how does this fit in with what should be decreased signaling as the state of the system moves toward the setpoint (i.e., with each bite)? In extinction bursts, the authors seem to suggest that this sort of micro, moment to moment variation in state is signaled. Is there evidence to support that hunger will change the magnitude of the reward?</p><p>Requested brevity of review limits detailed critique, but each and every section essentially presents the same sorts of problems (do not make a compelling case, don't actually solve the problem). More generally, what have the authors really done? They have added into a TD model a computational mechanism for determining what is and is not rewarding. That, I think, could represent a substantial contribution if the authors could focus specifically on that and develop it in the context of contemporary models/problems. When they attempt to resolve one of the largest, most complex controversies in all of the history of psychology in one short manuscript, they fall into trouble. From the point of view of computational modeling, is this not simply a form of utility? How is it different from other models that have incorporated utility? This seems the more relevant context for developing and presenting the model. As for drive-reduction and rescuing Hull, surely Hull and his followers meant 'ideal_state MINUS current_state = motivation'? Do the authors really believe that if only Hull had had RL learning theory in which to embed his drive-reduction, the history of psychology would have been different? And now it can be corrected?</p><p>I think the effort and intent is to be commended: how reward is evaluated and how learning and motivation is state-dependent is a critical question not well developed in RL models. And starting with a simple drive-reduction model is a reasonable starting point, but I would suggest that rather than implementing a drive reduction model and saying 'viola, a half century of controversy resolved', the authors might make a far better contribution by asking what problems are solved and what problems remain or are created; that is, to see this model as a starting point of something really important, not an end point.</p><p><italic>Reviewer #3</italic>:</p><p>The authors implement, in a simple mathematical manner, an elaboration of Hull's “drive reduction theory” (1943), a theory that reinforces a behavior if it reduces any deviation of an organism from homeostasis. As far as I can tell, the specific elaboration is to incorporate more modern theories of reinforcement learning as the mechanism to reduce the “drive” and in so doing manage to alleviate a couple of criticisms of Hull's work (e.g., how secondary reinforcers such as money can operate) as well as account for a number of behavioral phenomena. The impressive aspect of this paper is that it provides a unifying theory of motivation that explains several behavioral phenomena; some of them the authors claim have no other explanation to date.</p><p>Unfortunately I find the paper rather abstract, with the concrete details that are presented being a “convenient fiction” (such as “distance of the internal state from the set point” in a fictional “homeostatic space”) that do not directly correspond to any biological property. I focus on one particular result by way of example:</p><p>The authors claim that “temporal discounting” (the reduced value of a behavior as its benefit is less immediate) is explained within their theory (for the first time) as “in order to maintain internal stability, it is necessary to discount future rewards.” However, the derivation underlying this argument seems to rely on the assumption that all paths in homeostatic space are possible – e.g., one could raise one's body temperature to 45C then return it back to 37C, so in order to avoid such a path the positive value of returning from 45C to 37C should be discounted compared to the preceding negative value of rising from 37C to 45C. In my mind such an argument seems bizarre, since once reaching 45C the organism can never return to its “sweet spot”; mathematically the “homeostasis space” defined by the authors is not really “curl-free” or without bifurcations, because routes matter, homeostatic fixed points change etc. So the solution seems to explain a problem that only arises in the proposed formalism. Alternative factors – such as the environment being less and less predictable as one moves to the future and that uncertainties in the consequences of behaviors increase as one projects into the future – seem a much more plausible explanation of temporal discounting.</p><p>In general, I question whether the theory is falsifiable as I do not see specific testable predictions and the quantitative results presented appear to be produced purely by fine tuning of unconstrained parameters. Also, the authors make claims such as “the major result of our theory, which is that the rationality of behavioral patterns is geared toward maintaining physiological stability”, but that was Hull's theory and is hardly novel or a surprising idea. Since the authors add a mathematical framework to prior theories and their combination, the paper would greatly benefit (and in my view could be acceptable) if it could make some concrete quantitative predictions of the results of behavioral experiments that could be tested, or at a minimum, when numbers in their model are fit to one data set, they show they can reproduce other data without extra fitting.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for sending your work entitled “Collecting reward to defend homeostasis: A homeostatic reinforcement learning theory” for consideration at eLife. Your article has been favorably evaluated by Eve Marder (Senior editor) and 3 reviewers.</p><p>As you will see below, all of the reviewers find this version vastly improved over your previous submission, and all of the reviewers are quite positive about this work at this point. Nonetheless, each of them has some specific suggestions for editorial revision, mostly to do with emphasis and presentation. Because these are well-articulated in the actual reviews, I am taking the unusual tactic of enclosing these reviews in their entirety, as they were meant constructively. I hope that you will find them helpful in making a considerably improved piece of work more transparent and accessible.</p><p><italic>Reviewer #1</italic>:</p><p>The authors have embarked on the valuable task of producing a computational framework that combines theories of reinforcement learning with those of homeostasis and drive reduction. This is a worthwhile goal and the authors have several examples of behaviors that arise within their framework as well as predictions. I do think the manuscript reads a bit as though come of the ideas of combining reinforcement learning and homeostasis are novel to the authors, whereas in reality their contribution is to add a mathematical/computational framework which allows for quantitative predictions to be made and suggests what could/should be observed in any neural mechanism.</p><p>While overall the writing is very clear, I think the manuscript would be served by the authors being more careful to tone down statements that suggest the idea of combining homeostasis and reinforcement learning is their own. After all, everyone knows that when one is out on a cold winter's day a hot drink is rewarding, whereas in the middle of a hot summer's day a cold drink has greater rewarding value. The authors deserve credit for developing a mathematical scheme (the first I think?) where such results fall out, and I think they now have enough quantitative results and predictions that make the scheme testable.</p><p>In a similar vein, some statements to motivate the work are exaggerated, for example in the first line of Discussion the authors’ state:</p><p>“Theories of conditioning are founded on the argument that animals seek reward, while reward is defined as what animals seek.”</p><p>I think that while these definitions can be found, to state simply “reward is defined” without adding “by some” or “can be defined” or “has been defined by some” is too bold and general. One can find plenty of definitions of reward, in which “primary reward” is “that which aids survival” or “helps propagate the species” or simply in general English, reward is something that is good for you!</p><p>In a couple of places (including the Abstract) the authors state that they:</p><p>“prove analytically that reward-seeking and physiological stability are two sides of the same coin” and “Our theory mathematically proves that seeking rewards is equivalent to the fundamental objective of physiological stability“ whereas in fact through their definition of drive;”we define the “drive” as the distance of the internal state from the setpoint“ the authors assume this to be the case and develop a mathematical theory where this result is true. One must be careful in mathematical proofs as to what are the premises. Since the rewards associated with sexual desire are outside the model (as the authors comment) it is clear that it is only within their theory that the mathematical “proof” holds.</p><p><italic>Reviewer #2</italic>:</p><p>The authors have dramatically transformed this paper from the last submission. I like it a lot and think it has some important things to say. It feels much more anchored in the modern RL literature and the discussion of Hull is much more nuanced and realistic. However, there are still some comments:</p><p>1) The authors make a comment early on that equates reward/reinforcer/utility. Given the obvious sophistication of the authors, this is unfortunate. In particular, to make clear the relationship between prior treatments of utility and the authors’ proposal would be helpful. Notably, the authors do describe other approaches to this, but even a sentence or two early on that clarifies rather than lumps together the difference between reinforcer/utility. Specifically because the authors are essentially arguing that homeostatic utility determines reinforcement properties.</p><p>2) The authors make a comment about 'erroneous estimation of error' and later in the manuscript talk at length about, essentially, taste serving as cues. Three lines of investigation that the authors might find useful in this discussion: (1) Beeler et al Eur J Neuroscience 2012 'taste uncoupled from nutrition fails to sustain the rewarding properties of . . . ' (2) the work of Swithers with artificial sweeteners:</p><p>Swithers, S.E. &amp; Davidson, T.L. (2008) A role for sweet taste: calorie predictive relations in energy regulation by rats. Behav. Neurosci., 122, 161- 173.</p><p>Swithers, S.E., Baker, C.R. &amp; Davidson, T.L. (2009) General and persistent effects of high-intensity sweeteners on body weight gain and caloric compensation in rats. Behav. Neurosci., 123, 772-780.</p><p>Swithers, S.E., Martin, A.A. &amp; Davidson, T.L. (2010) High-intensity sweeteners and energy balance. Physiol. Behav., 100, 55-62.</p><p>Finally, the authors cite one paper by de Araujo, but he has significantly developed the notion that the DA cells specifically serve as a metabolic sensor.</p><p>Other than that, I think there are many things that one could nitpick about, especially with regards to the endless details and nuances of the model (eg., I am not sure the authors have fully addressed the question the other reviewer had regarding the 'shortest distance between two points' idea). However, I think the paper is interesting, brings up some very good points, is well done and, as the authors point out, targets the mutual weakness of HR and RL models and brings them together nicely.</p><p><italic>Reviewer 3</italic>:</p><p>This is an improved version of a previous submission. I see merit in the ideas behind this work. However, I think the authors still could communicate their thoughts in a more structured way, and have made some suggestions below.</p><p>This is a much improved version of a previous submission to eLife. It basically connects homeostatic imperatives with classical (utilitarian and control theoretic) formulations of adaptive behaviour. There is a central technical result that links homeostasis to discounted future reward, which the authors exploit to explain a number of phenomena in the reinforcement learning literature. The authors have contextualised their contribution in relation to other (theoretical) frameworks. There are some outstanding issues with the way that the authors structure their paper.</p><p>Major points:</p><p>1) Scientifically, I think you need to highlight and unpack the major result in the appendix. At an appropriate point in the main text, I would include a paragraph of the following sort:</p><p>“In summary, we have established a formal link between the homeostatic imperatives to keep physiological states near some set point and the maximisation of temporally discounted reward (or minimisation of some loss function). This is an important and non-trivial result. The appendix provides a formal proof; however, the underlying idea is fairly simple. Imagine you had to plan a hill walk, during which you wanted to maximise the height (altitude or reward) averaged over the path you take. If someone dropped you at the bottom of the hill, the optimum path would be to ascend the hill and spend as long as possible at the top before returning to your pick up point. Notice that this entails ascending the hill (reward function) before descending. Implicit in this strategy is a maximisation of temporally discounted reward. In other words, going up the hill first and then coming down is better than going down and then coming back up. It is this fundamental (variational) phenomenon that connects homeostasis with classical temporal discounting.</p><p>Furthermore, as indicated above, if the homeostatic cost (negative reward) is cast as a log probability then it can be treated as (free) energy. Crucially, the time average or path integral of energy is called action. This means that both the homeostasis and temporally discounted reward are ways of prescribing a principle of least action. From this perspective, one can regard the adaptive behaviours that we are trying to link as necessary and emergent properties of all dynamical systems that comply with (Hamilton's) principle of least action. We will return to this perspective in the Discussion.”</p><p>2) The second major point is about the format of your paper. It is still unclear where the reader can find the details of your simulations. I also note that you have included supplementary figures. Can I suggest that you remove all supplementary material and place it in the main text (or discard it and refer to it as results not shown). I think you should prepare the reader for the slightly unusual scientific presentation with a paragraph at the beginning of the paper along the following lines:</p><p>”We will develop our theoretical results by appealing to simulations. These simulations are described in figures (and accompanying tables) and are called upon when necessary. All the simulations in this paper followed the same procedure: first we define a model that captures the problem of interest in terms of a Markov decision process. The ensuing behaviour is then optimised using classical reinforcement learning procedures (Q-learning) to define a value function. Actions are then selected using a softmax function of the value of allowable actions or choices. For each simulation we present the graphical model or Markov decision process in the figures, along with the ensuing behaviour. Each figure is accompanied by a table specifying the parameters of the Markovian process, the Q-learning and softmax functions used to simulate behaviour.”</p><p>Note that I am suggesting, for every simulation you present, a figure and table. Whenever you refer to results that are not presented in this format I would say so explicitly so the reader does not have to wonder whether they have missed something.</p><p>3) You might want to refer to the notion of beliefs or probability distributions over excursions. In other words, the risk sensitive behaviour can also be interpreted in terms of the probability of extreme events that render the beliefs sub Gaussian; assuming the homeostatic deviation is interpreted as a log probability.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.04811.032</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Animals indulge in many behaviors that violate the premises of physiological homeostasis, like obesity and drug-taking behavior. This appears to be an issue that calls into question some of the fundamental assumptions of this work</italic>.</p><p>We thank the BREs for prompting us to address this issue. In fact we already performed the simulations showing how irrational behaviors might arise within our theory, yet did not include it in the previous version of the manuscript as we previously felt that a full-blown treatment of irrational behaviors is beyond the scope of this paper and would merit a further publication. To address the BREs’ concern, in the present manuscript we added a subsection titled “Irrational behavior: the case of over-eating.” to illustrate (with simulations) one of the points of vulnerability of our theory that can induce irrational choices. Moreover, in the subsection “Limitations and future works” we discuss on how to approach other pathologies including drug-addiction and anorexia, as results of other mechanisms of our framework going awry. Also, as communicated to the editor previously, modeling drug addiction within our “Homeostatic Reinforcement Learning” framework has been the topic of another entire line of research in our group and we are preparing a further publication on that.</p><p>Reviewer 1:</p><p><italic>The relation of the theory to the free-energy framework, as well as the allostasis and the good regulator theorem to be explained. Also, the advantage of using optimal control as the optimization techniques to be discussed</italic>.</p><p>We agree with the reviewer that our theory has significant connections with the free-energy framework. We added a subsection titled “Previous theoretical models” in order to discuss all these and other issues in detail.</p><p><italic>Limitations of the theory to be discussed</italic>.</p><p>We added a subsection titled “Limitations and future works”, and detailed several limitations of the model, as well as constraining assumptions that could be eventually relaxed.</p><p>Reviewer 2:</p><p><italic>Framing the entire model around rekindling the Hull’s theory is unfortunate. Instead of framing this in a half-century-old debate, why not anchor it in contemporary scientific issues and questions? The results section does not read like a results section but like a discussion section</italic>.</p><p>We thank the reviewer for this suggestion. While we stand behind our theory’s explanatory power, we do agree that the present manuscript is only a first step in addressing the modern literature on the links between motivation and the internal physiological states. Following the reviewer’s advice, we re-structured the manuscript to make it less polemic and more result-oriented, and tried to clearly de-limit its scope. Rather than framing the whole manuscript around the Hull’s theory, we now only discuss that theory and its relevancy to our model in a subsection of the Discussion titled “Relationship to classical drive-reduction theory”. Also, in that section, we withdrew the claim of “rescuing Hall”, and instead discuss the differences between our formal elaboration and the original theory (Namely, orosensory-based approximation of drive-reduction, and integration with an RL module). Also, for the sake of caution, we only claim that our model addresses “a number of significant criticisms”, rather than “all”, criticisms against the Hull’s theory.</p><p><italic>The Results section does not read like a Results section but like a Discussion section. For each of the subsections in the Results I would expect the question/problem to be defined clearly, then the details of how this was addressed in a simulation and then the results of the simulation (for example, one expects results to be substantively organized around/referencing figures). The 'results', as the manuscript stands, are essentially presented in brief in the figure legends. Less argument and 'defending' the model and more illustrating its function</italic>.</p><p>In response to this concern, we transferred all the other discussion-like issues to the Discussion section (i.e., Neural substrate, predictions, previous models) and greatly expanded the Results section. In the rest of the manuscript, we only focus on the behavioral/neurobiological pattern being addressed, and mechanisms by which our model explains them. We tried to explain the replicated experiments, our simulation results, and the mechanisms of the model with much more details and clarity. Furthermore, we included the full proof of the rationality and the normativity of temporal discounting in the Methods section. In fact we considered including the full proof in the main body of the paper but felt that the paper might become too cumbersome. This is a point we are ready to discuss and if eLife might allow for a “mathbox” to be embedded within the paper, which could be a good solution.</p><p><italic>The manuscript ends up with a cavalier quality of 'our model has just solved all these problems' but the solution is superficial. The manuscript is too ambitious, attempting to implement a simple computational model of drive-reduction and then, in effect, wanting to 'put to rest' what comprised decades of (much still unresolved) controversy</italic>.</p><p><italic>Again, the result reads more like a polemical review, both cavalier and superficial. A more focused, more empirical, less argumentative approach might be more successful</italic>.</p><p>In general, following the points raised by the reviewer we rewrote the paper in a more empirical and less argumentative way. We further pointed out in the manuscript, which issues are resolved by our model and what are the limitations (new sections added). Furthermore, we tried to clarify in the manuscript that our modeling framework is not only a simple model of drive-reduction, but gives a normative computational theory for the interplay between the former and reinforcement learning theories of motivation. Indeed the present manuscript is only a starting point for a further development of the theory, and we tried to point this out in the manuscript. We sincerely hope that the cavalier quality of our paper has been rectified.</p><p><italic>The explanation for extinction bursts is not convincing</italic>.</p><p>We see the point raised by the reviewer and understand that our suggestion is way too speculative. We decided to remove the “Extinction burst” section from the manuscript and re-consider this issue in the future.</p><p><italic>With respect to anticipatory responding, the proposed model is equivalent to the “incentive salience” theory</italic>.</p><p>We thank the reviewer for pointing out this apparent lack of clarity in our paper. In the new manuscript, we discuss the differences between the two models in detail, in the subsection “Relationship to other theoretical models”.</p><p>We would also like to briefly address the specific comment of the reviewer. In our theory the value of a response depends on the internal state at the time of learning and is built from a reward definition that is based on the ability of the response to produces a drive-reducing outcome. We give a precise mathematical formulation of how this should be done (normative reinforcement learning framework). And indeed the response after learning is driven by the value as opposed to by the direct drive reduction. Previously it was controversially argued that “value” in the RL algorithms is equivalent to motivational “incentive salience” (1). However, as we could best understand, the recent computation model of incentive salience separates value learning from influences of the internal state. The value is learned as in the standard RL algorithms (with respect to a reference state and based on externally defined rewards). The internal state at the time of the response then modifies the learned value. As we now argue in the manuscript such a formulation differs from our framework and is unable to account for anticipatory responses.</p><p><italic>Just because metabolic information is signaled into the hypothalamus does not necessitate that it is a homeostatic system</italic>.</p><p>We thank the reviewer for pointing out this issue. Although discussing the neural evidence for the hypothalamus being a homeostatic system is a topic of merit, we feel that in this manuscript, we would better limit the discussion to the neural evidence that is relevant to the novel contributions of our model (i.e. the “integration” of homeostatic and learning systems). We felt that a full discussion of the substrates of the two individual systems is beyond the scope of our manuscript. However, in the new manuscript, we cited further recent review articles that point to the role of hypothalamus in homeostatic regulation.</p><p>Furthermore, in the new manuscript, we have explained that from a mathematical point of view, any regulatory system can be formulated either as a dynamical system (interaction of many effectors) or as a homeostatic regulation system. We explain that these formulations can be readily transformed into one another; particularly, the stable equilibrium (settling point) of the dynamical system is equivalent to the setpoint of the homeostatic formulation. Thus, we have tried to make it clear that setpoint vs. settling-point formulation is only a matter of the point of view.</p><p>Last but not least, one example where we could have discussed the evidence supporting the homeostatic role of the hypothalamus is in thermoregulation (see the text below). However, we did not see how to include it in the manuscript, without straying too far from issues relevant to the novel contributions of the paper.</p><p>A particularly prominent example for the role of the hypothalamus in homeostatic regulation has come over the years in the human and animal thermoregulation literature. Interestingly, the concept of an internally regulated set point appears prominently in that body of literature. The classical review by Benzinger (2) establishes experimental evidence for a thermal set point as a physiological property and points out the role of the “preoptic-spraoptic region of the hypothalamus” in central regulation of the body temperature. The suggestion that hypothalamic circuits play a role in maintenance of thermal homeostasis by translating sensed temperature into neural activity was formalized by Hammel (3) in a model proposing hypothalamic circuitry where integration of thermo-sensitive and thermo-insensitive neuronal activities could lead to dynamic encoding of the thermal setpoint. Populations of heat-sensitive neurons have been identified in the hypothalamus (4, 5): they increase firing rate with increasing body temperature. The heat-sensitive (HS) and heat-insensitive (HI) neurons synaptically innervate two sets of effector neurons. Heat-loss effectors are excited by the heat-sensitive cells and inhibited by the heat-insensitive cells in a manner that balances these inputs at 37C body temperature. Heat-production effector neurons are in turn inhibited by the HS neurons and excited by the HI neurons. Over the years, heat-loss/production effector neurons have been electrophysiologically identified (6–8) and anatomically mapped. The regulatory loop is closed by the thermosensory afferents from the periphery to the HS (but not the HI) neurons (e.g. see (9)). Manipulations of the POA induce body temperature changes (e.g. see (10)) and the effector neurons have been implicated in control of organismal thermoregulatory responses (e.g. as reviewed in Morrison and Nakamura (11) and Boulant (12)) including shivering (13). Furthermore, there is experimental evidence that the regulated thermal temperature point is influenced (or dynamically set) by signals that not in themselves directly related to temperature (e.g. hormonal levels, inputs from joint mechano-receptors receptors) and varies from individual to individual (see (12) for review).</p><p><italic>A distinction between tonic and phasic dopamine activity needs to be made</italic>.</p><p>To make a distinction between tonic and phasic dopamine, we clearly stated in the new manuscript that our model, as in the classical RL model, only addresses the burst (i.e. phasic) activity pattern of dopamine neurons. How changes in the tonic DA levels might be incorporated into our theory is an active topic of current research in our group.</p><p>Reviewer 3:</p><p><italic>The theory is based on abstracted concepts like homeostatic set point and distances in the homeostatic space that do not directly correspond to any biological properties</italic>.</p><p>Indeed, our mathematical theory, as any mathematical theory, requires several constructs to be defined. Above, in the response to reviewer 2, we discussed how the concepts used in our framework relate to ideas of dynamically-maintained internal equilibrium and potentials of dynamical systems. The functional equivalency of the two approaches establishes a correspondence between their neurobiological implementation. Thus, we respectfully beg to differ with the opinion of the reviewer, we believe that concepts we use do have connections to biological properties. For example the homeostatic space is simply a coordinate system where the various physiologically regulated quantities are represented: temperature, glucose levels, etc. Also, the setpoint is just equivalent to the stable equilibrium of the underlying dynamical system.</p><p>Let us take the example of temperature. Without going into details, as discussed in the text in response to the second reviewer, there are multiple classes of temperature receptors peripherally, and temperature sensitive neurons in the hypothalamus. There have been data-driven suggestions in the literature that activity of such neurons, informed by peripheral afferents, together with temperature insensitive neurons in the hypothalamus, encode the thermal setpoint (approx. 37 degrees) (3–5). There is further evidence that inputs from such neurons, create cold-producing and heat-producing effector neurons (6–8). Modern work on human thermoregulation experimentally suggests an existence of temperature space and “energy functional”, or in our terms, drive function (14).</p><p><italic>The model assumes that organisms experience all paths in the homeostatic space, and only then can choose the shortest path. However, once the animal reaches an extreme homeostatic deviation, it can never return (due to death)</italic>.</p><p>Indeed we thank the reviewer for pointing out that we needed to clarify this point. We added a new subsection titled “Stepping back from the brink”, and addressed this issue in detail. In fact our model predicts that animals should learn to act preventively to avoid states with drastic deviations (even without experiencing them directly).</p><p><italic>The authors claim to provide a normative explanation for temporal discounting for the first time. However, alternative factors such as the environment being less and less predictable as one moves to the future seem to be a plausible explanation of temporal discounting</italic>.</p><p>Indeed we agree with the reviewer that temporal discounting intuitive sense for a number of reasons including uncertainty of outcomes in the future, changing environments, etc. However the point we attempted to make was more formal and mathematical: if we were not to include discounting, behavioral policies that maximized rewards did not necessarily minimize the total deviation from the homeostasis and hence could endanger the animal. Hence lack of discounting did not result in equivalence of reward maximization of homeostatic defense. Temporal discounting ensured that such did not happen and ensured the rationality of defending homeostasis. In view of the reviewers comments, we realized that our claim was overreaching and withdrew the claim that our normative explanation for temporal discounting is the only possible explanation. Though, we have not been able to find any alternative formal mathematical explanation.</p><p><italic>Quoting form the review: I question whether the theory is falsifiable, as I do not see specific testable predictions</italic>.</p><p>We thank the reviewer for pointing us toward this point. We added a subsection titled “predictions”, and listed five testable predictions of the model.</p><p><italic>Throughout the results I would have preferred either more incorporation of the equations or stronger references to the methods</italic>.</p><p>We tried to incorporate more formal details in the text, particularly in the development of the theory. At the same time, we felt that including the full mathematical proofs in the main text of the paper would make it too cumbersome. These are now in the Materials and Methods section.</p><p><italic>When free parameters in the model are fit to one data set, they should show they can reproduce other data without extra fitting</italic>.</p><p>We thank the reviewer for this comment. It should be mentioned that the different experimental data we have replicated in the paper come from different species (rat in the anticipatory responding task, and pigeon in the oral/fistula water-seeking task). Thus, it is not surprising that the free parameters have different values for different experimental data sets. For every individual dataset, however, the value of free parameters are chosen to replicate the first part of data, and then the same values have successfully predicted the second part. That is, for the case of anticipatory responding simulations, the free parameters are derived according to the training days (the first 8 days of the experiment), and then are used for predicting the extinction days, as well as the re-acquisition day. Similarly, for the case of oral/fistula water-seeking experiment, the free parameters are chosen to best explain the reinforcement experiment (<xref ref-type="fig" rid="fig7">Figure 7</xref>), and are then used for predicting the satiation experiment (<xref ref-type="fig" rid="fig8">Figure 8</xref>).</p><p>It is also noteworthy that although free parameters are different across different experiments (different species), the essential patterns of simulation results hold for a wide range of free parameters, and the specific values used in every experiment are only to replicate that specific data.</p><p>References:</p><p>1) McClure SM, Daw ND, Montague PR (2003) A computational substrate for incentive salience. Trends in Neurosciences 26:423–428.</p><p>2) Benzinger TH (1961) The diminution of thermoregulatory sweating during cold-reception at the skin. Proceedings of the National Academy of Sciences of the United States of America 47:1683–8.</p><p>3) Hammel H (1965) in Physiological Controls and Regulations, eds Yamamoto W, Brobeck J (Saunders, Philadelphia, PA), pp 71–97.</p><p>4) Makayama T, Elisenman JS, Hardy JD (1961) Single unit activity of anterior hypothalamus during local heating. Science 134:560–1.</p><p>5) Griffin JD, Kaple ML, Chow AR, Boulant JA (1996) Cellular mechanisms for neuronal thermosensitivity in the rat hypothalamus. The Journal of physiology 492 ( Pt 1:231–42.</p><p>6) Edinger HM, Eisenman JS (1970) Thermosensitive neurons in tuberal and posterior hypothalamus of cats. The American journal of physiology 219:1098–103.</p><p>7) Curras MC, Kelso SR, Boulant JA (1991) Intracellular analysis of inherent and synaptic activity in hypothalamic thermosensitive neurones in the rat. The Journal of physiology 440:257–71.</p><p>8) Dean JB, Boulant JA (1989) Effects of synaptic blockade on thermosensitive neurons in rat diencephalon in vitro. The American journal of physiology 257:R65–73.</p><p>9) Cliffer KD, Burstein R, Giesler GJ (1991) Distributions of spinothalamic, spinohypothalamic, and spinotelencephalic fibers revealed by anterograde transport of PHA-L in rats. The Journal of neuroscience :theofficial journ al of the Society for Neuroscience 11:852–68.</p><p>10) Chen XM, Hosono T, Yoda T, Fukuda Y, Kanosue K (1998) Efferent projection from the preoptic area for the control of non-shivering thermogenesis in rats. The Journal of physiology 512 ( Pt 3:883–92.</p><p>11) Morrison SF, Nakamura K (2011) Central neural pathways for thermoregulation. Frontiers in bioscience (Landmark edition) 16:74–104.</p><p>12) Boulant JA (2006) Neuronal basis of Hammel’s model for set-point thermoregulation. Journal of applied physiology (Bethesda, Md: 1985).100:1347–54.</p><p>13) Zhang YH, Yanase-Fujiwara M, Hosono T, Kanosue K (1995) Warm and cold signals from the preoptic area: which contribute more to the control of shivering in rats? The Journal of physiology 485 ( Pt 1:195–202.</p><p>14) Kingma BR, Frijns AJ, Schellen L, Van Marken Lichtenbelt WD (2014) Beyond the classic thermoneutral zone: Including thermal comfort. Temperature 1:142–149.</p><p><italic>[Editors' note: further revisions were requested prior to acceptance, as described below</italic>.<italic>]</italic></p><p><italic>Reviewer #1</italic>:</p><p><italic>The authors have embarked on the valuable task of producing a computational framework that combines theories of reinforcement learning with those of homeostasis and drive reduction. This is a worthwhile goal and the authors have several examples of behaviors that arise within their framework as well as predictions. I do think the manuscript reads a bit as though come of the ideas of combining reinforcement learning and homeostasis are novel to the authors, whereas in reality their contribution is to add a mathematical/computational framework which allows for quantitative predictions to be made and suggests what could/should be observed in any neural mechanism</italic>.</p><p><italic>While overall the writing is very clear, I think the manuscript would be served by the authors being more careful to tone down statements that suggest the idea of combining homeostasis and reinforcement learning is their own. After all, everyone knows that when one is out on a cold winter's day a hot drink is rewarding, whereas in the middle of a hot summer's day a cold drink has greater rewarding value. The authors deserve credit for developing a mathematical scheme (the first I think?) where such results fall out, and I think they now have enough quantitative results and predictions that make the scheme testable</italic>.</p><p>In response to the reviewer’s suggestion, we added to the paragraph where we first talk about the contributions of the paper (in Introduction):</p><p>Given this evident coupling of homeostatic and learning processes, here, we propose a formal hypothesis for what computations, at an algorithmic level, may be performed in this biological integration of the two systems. More precisely, inspired by previous descriptive hypotheses on the interaction between motivation and learning (Hull, 1943; <xref ref-type="bibr" rid="bib35">Mowrer, 1960</xref>; <xref ref-type="bibr" rid="bib57">Spence, 1956</xref>), we suggest a principled model for how the rewarding value of outcomes is computed as a function of the animal’s internal state, and of the approximated need-reduction ability of the outcome…</p><p>Also, we added the below sentence to the conclusion section:</p><p>Being inspired by the classic drive-reduction theory of motivation, our mathematical treatment allows for quantitative results to be obtained, predictions that make the theory testable, and logical coherence.</p><p><italic>In a similar vein, some statements to motivate the work are exaggerated, for example in the first line of Discussion the authors’ state</italic>:</p><p><italic>“Theories of conditioning are founded on the argument that animals seek reward, while reward is defined as what animals seek</italic>.<italic>”</italic></p><p><italic>I think that while these definitions can be found, to state simply “reward is defined” without adding “by some” or “can be defined” or “has been defined by some” is too bold and general</italic>. <italic>One can find plenty of definitions of reward, in which “primary reward” is “that which aids survival” or “helps propagate the species” or simply in general English, reward is something that is good for you!</italic></p><p>In response to the reviewer’s concern, we added the phrase “at least in the behaviorist approach” to the mentioned sentence:</p><p>Theories of conditioning are founded on the argument that animals seek reward, while reward is defined, at least in the behaviorist approach, as what animals seek.</p><p><italic>In a couple of places (including the Abstract) the authors state that they</italic>:</p><p><italic>“prove analytically that reward-seeking and physiological stability are two sides of the same coin” and “Our theory mathematically proves that seeking rewards is equivalent to the fundamental objective of physiological stability” whereas in fact through their definition of drive;“we define the “drive” as the distance of the internal state from the setpoint” the authors assume this to be the case and develop a mathematical theory where this result is true. One must be careful in mathematical proofs as to what are the premises. Since the rewards associated with sexual desire are outside the model (as the authors comment) it is clear that it is only within their theory that the mathematical “proof” holds</italic>.</p><p>In response to the reviewer’s concern, we added the phrase “Within this framework,” in the Abstract:</p><p>Within this framework, we mathematically prove that seeking rewards is equivalent to the fundamental objective of physiological stability, defining the notion of physiological rationality of behavior.</p><p>Furthermore we added the phrase “On the basis of the proposed computational integration of the two systems” into the sentence below, in the Introduction section:</p><p>On the basis of the proposed computational integration of the two systems, we prove analytically that reward-seeking and physiological stability are two sides of the same coin, and also provide a normative explanation for temporal discounting of reward.</p><p><italic>Reviewer #2</italic>:</p><p><italic>1) The authors make a comment early on that equates reward/reinforcer/utility. Given the obvious sophistication of the authors, this is unfortunate. In particular, to make clear the relationship between prior treatments of utility and the authors’ proposal would be helpful. Notably, the authors do describe other approaches to this, but even a sentence or two early on that clarifies rather than lumps together the difference between reinforcer/utility. Specifically because the authors are essentially arguing that homeostatic utility determines reinforcement properties</italic>.</p><p>We thank the author for pointing out this issue. By “utility”, we mean “economic utility” (as it is defined in Economics) rather than “homeostatic utility”. In economics, the utility of a commodity is a fixed value, without taking the internal state of individuals into account. This is the same problem as with reinforcer/reward value in psychology. In order to resolve this misunderstanding, we now use the term “economic utility” rather than “utility”, in the manuscript.</p><p><italic>2) The authors make a comment about 'erroneous estimation of error' and later in the manuscript talk at length about, essentially, taste serving as cues. Three lines of investigation that the authors might find useful in this discussion: (1) Beeler et al Eur J Neuroscience 2012 'taste uncoupled from nutrition fails to sustain the rewarding properties of . . . ' (2) the work of Swithers with artificial sweeteners</italic>:</p><p><italic>Swithers, S.E. &amp; Davidson, T.L. (2008) A role for sweet taste: calorie predictive relations in energy regulation by rats. Behav. Neurosci., 122, 161- 173</italic>.</p><p><italic>Swithers, S.E., Baker, C.R. &amp; Davidson, T.L. (2009) General and persistent effects of high-intensity sweeteners on body weight gain and caloric compensation in rats. Behav. Neurosci., 123, 772-780</italic>.</p><p><italic>Swithers, S.E., Martin, A.A. &amp; Davidson, T.L. (2010) High-intensity sweeteners and energy balance. Physiol. Behav., 100, 55-62</italic>.</p><p><italic>Finally, the authors cite one paper by de Araujo, but he has significantly developed the notion that the DA cells specifically serve as a metabolic sensor</italic>.</p><p>We found these references very helpful in supporting some aspects of our theory. In this respect, we added the below paragraph to the end of the subsection “Neural substrates”:</p><p>Such orosensory-based approximation of nutritional content, could have been obtained through evolutionary processes (<xref ref-type="bibr" rid="bib6">Breslin, 2013</xref>), as well as through prior learning (<xref ref-type="bibr" rid="bib2">Beeler et al., 2012</xref>; <xref ref-type="bibr" rid="bib60">Swithers et al., 2009</xref>, <xref ref-type="bibr" rid="bib61">2010</xref>). In the latter case, approximations based on orosensory or contextual cues can be updated so as to match the true nutritional value, resulting in a rational neural/behavioral response to food stimuli (De Araujo et al., 2008).</p><p>The last sentence suggests a probable mechanism for the taste-independent adaptation of dopamine response to the true caloric value of food.</p><p><italic>Other than that, I think there are many things that one could nitpick about, especially with regards to the endless details and nuances of the model (eg., I am not sure the authors have fully addressed the question the other reviewer had regarding the 'shortest distance between two points' idea). However, I think the paper is interesting, brings up some very good points, is well done and, as the authors point out, targets the mutual weakness of HR and RL models and brings them together nicely</italic>.</p><p><italic>Reviewer 3</italic>:</p><p><italic>1) Scientifically, I think you need to highlight and unpack the major result in the appendix. At an appropriate point in the main text, I would include a paragraph of the following sort</italic>:</p><p><italic>“In summary, we have established a formal link between the homeostatic imperatives to keep physiological states near some set point and the maximisation of temporally discounted reward (or minimisation of some loss function). This is an important and non-trivial result. The appendix provides a formal proof; however, the underlying idea is fairly simple. Imagine you had to plan a hill walk, during which you wanted to maximise the height (altitude or reward) averaged over the path you take. If someone dropped you at the bottom of the hill, the optimum path would be to ascend the hill and spend as long as possible at the top before returning to your pick up point. Notice that this entails ascending the hill (reward function) before descending. Implicit in this strategy is a maximisation of temporally discounted reward. In other words, going up the hill first and then coming down is better than going down and then coming back up. It is this fundamental (variational) phenomenon that connects homeostasis with classical temporal discounting</italic>.</p><p><italic>Furthermore, as indicated above, if the homeostatic cost (negative reward) is cast as a log probability then it can be treated as (free) energy</italic>.</p><p>Thanks to the reviewer’s suggestion, we now explain the importance of temporal discounting more clearly by adding the paragraph below (modified version of the paragraph suggested by the reviewer) in the middle of the section “Normative role of temporal discounting”:</p><p>Imagine you had to plan a 1-hr hill walk from a drop-point toward a pickup point, during which you wanted to minimize the height (equivalent to drive) summed over the path you take. In this summation, if you give higher weights to your height in the near future as compared to later times, the optimum path would be to descend the hill and spend as long as possible at the bottom (i.e. homeostatic setpoint) before returning to the pickup point. <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> shows that this optimization is equivalent to optimizing the total discounted rewards along the path, given that descending and ascending steps are defined as being rewarding and punishing, respectively (<xref ref-type="disp-formula" rid="equ2">equation 2</xref>).</p><p>In contrast, if at all points in time you give equal weights to your height, then the summed height over path only depends on the drop and pickup points, since every ascend can be compensated with a descend at any time.</p><p>We chose not to include the second part of the suggested paragraph: with all due gratitude for the reviewers support of our work and appreciation for the efforts of the reviewer to help us improve the clarity of the paper, we felt that launching into a short discussion of the free-energy principle early in our manuscript, before we sowed out the major results of the paper, would be distracting to the reader. We give ample discussion of the relationship between our theory and the free-energy principle in the Discussion where we point out exactly what the reviewer urges us to highlight.</p><p><italic>Crucially, the time average or path integral of energy is called action. This means that both the homeostasis and temporally discounted reward are ways of prescribing a principle of least action. From this perspective, one can regard the adaptive behaviours that we are trying to link as necessary and emergent properties of all dynamical systems that comply with (Hamilton's) principle of least action. We will return to this perspective in the Discussion</italic>.<italic>”</italic></p><p>We thank the reviewer for the suggested texts to be added to the manuscript. We used some of the notions mentioned by the reviewer (particularly the principle of least action), and discussed them in the manuscript. For example we added the below text after <xref ref-type="disp-formula" rid="equ14">equation 14</xref>:</p><p>The equivalency of reward maximization and physiological stability objectives in our model (<xref ref-type="disp-formula" rid="equ5">equation 5</xref>) shows that optimizing either homeostasis or sum of discounted rewards corresponds to prescribing a principle of least action applied to the surprise function.</p><p><italic>2) The second major point is about the format of your paper. It is still unclear where the reader can find the details of your simulations. I also note that you have included supplementary figures. Can I suggest that you remove all supplementary material and place it in the main text (or discard it and refer to it as results not shown). I think you should prepare the reader for the slightly unusual scientific presentation with a paragraph at the beginning of the paper along the following lines</italic>:</p><p><italic>“We will develop our theoretical results by appealing to simulations. These simulations are described in figures (and accompanying tables) and are called upon when necessary. All the simulations in this paper followed the same procedure: first we define a model that captures the problem of interest in terms of a Markov decision process. The ensuing behaviour is then optimised using classical reinforcement learning procedures (Q-learning) to define a value function. Actions are then selected using a softmax function of the value of allowable actions or choices. For each simulation we present the graphical model or Markov decision process in the figures, along with the ensuing behaviour. Each figure is accompanied by a table specifying the parameters of the Markovian process, the Q-learning and softmax functions used to simulate behaviour</italic>.<italic>”</italic></p><p><italic>Note that I am suggesting, for every simulation you present, a figure and table. Whenever you refer to results that are not presented in this format I would say so explicitly so the reader does not have to wonder whether they have missed something</italic>.</p><p>In order to give a better outline of the structure of the paper, we changed the last paragraph of the Introduction section to this:</p><p>The paper is structured as follows: After giving a heuristic sketch of the theory, we show several analytical, behavioral, and neurobiological results. On the basis of the proposed computational integration of the two systems, we prove analytically that reward-seeking and physiological stability are two sides of the same coin, and also provide a normative explanation for temporal discounting of reward. Behaviorally, the theory gives a plausible unified account for anticipatory responding and the rise-fall pattern of the response rate. We show that the interaction between the two systems is critical in these behavioral phenomena and thus, neither classical RL nor classical HR theories can account for them. Neurobiologically, we show that our model can shed light on recent findings on the interaction between the hypothalamus and the reward-learning circuitry, namely, the modulation of dopaminergic activity by hypothalamic signals.</p><p>Furthermore, we show how orosensory information can be integrated with internal signals in a principled way, resulting in accounting for experimental results on consummatory behaviors, as well as the pathological condition of over-eating induced by hyperpalatability.</p><p>Finally, we discuss limitations of the theory, compare it with other theoretical accounts of motivation and internal state regulation, and outline testable predictions and future directions.</p><p>Furthermore, we moved “Figure 4–figure supplements 2, 3 and 4” in the previous manuscript into the main text in the current version of the manuscript (merged together in <xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><p>Also, in order to provide more details of the simulations and to have the same format for all presented results (i.e., problem definition, simulation results, simulated environment (MDP), free parameters of the model), we added four tables (Figure 5–figure supplement 1; <xref ref-type="fig" rid="fig6s2">Figure 6–figure supplement 2</xref>; Figure 10–figure supplement 1; <xref ref-type="fig" rid="fig12s1">Figure 12–figure supplement 1</xref>) and one Markov Decision Process (Figure 12–figure supplement 2) in the figure supplements.</p></body></sub-article></article>