<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">46409</article-id><article-id pub-id-type="doi">10.7554/eLife.46409</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>The manifold structure of limb coordination in walking <italic>Drosophila</italic></article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-133884"><name><surname>DeAngelis</surname><given-names>Brian D</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9418-7619</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataset1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-125809"><name><surname>Zavatone-Veth</surname><given-names>Jacob A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4060-1738</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataset1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-27474"><name><surname>Clark</surname><given-names>Damon A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8487-700X</contrib-id><email>damon.clark@yale.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataset1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Interdepartmental Neuroscience Program</institution><institution>Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Physics</institution><institution>Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Molecular, Cellular, and Developmental Biology</institution><institution>Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Department of Neuroscience</institution><institution>Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>28</day><month>06</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e46409</elocation-id><history><date date-type="received" iso-8601-date="2019-03-02"><day>02</day><month>03</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-06-15"><day>15</day><month>06</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, DeAngelis et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>DeAngelis et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-46409-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.46409.001</object-id><p>Terrestrial locomotion requires animals to coordinate their limb movements to efficiently traverse their environment. While previous studies in hexapods have reported that limb coordination patterns can vary substantially, the structure of this variability is not yet well understood. Here, we characterized the symmetric and asymmetric components of variation in walking kinematics in the genetic model organism <italic>Drosophila</italic>. We found that <italic>Drosophila</italic> use a single continuum of coordination patterns without evidence for preferred configurations. Spontaneous symmetric variability was associated with modulation of a single control parameter—stance duration—while asymmetric variability consisted of small, limb-specific modulations along multiple dimensions of the underlying symmetric pattern. Commands that modulated walking speed, originating from artificial neural activation or from the visual system, evoked modulations consistent with spontaneous behavior. Our findings suggest that <italic>Drosophila</italic> employ a low-dimensional control architecture, which provides a framework for understanding the neural circuits that regulate hexapod legged locomotion.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>walking</kwd><kwd>gaits</kwd><kwd>limb coordination</kwd><kwd>descending commands</kwd><kwd>turning</kwd><kwd>Drosophila</kwd><kwd>hexapod</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01 EY026555</award-id><principal-award-recipient><name><surname>DeAngelis</surname><given-names>Brian</given-names></name><name><surname>Clark</surname><given-names>Damon A</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>GRFP</award-id><principal-award-recipient><name><surname>DeAngelis</surname><given-names>Brian</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100001341</institution-id><institution>Richard and Susan Smith Family Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>DeAngelis</surname><given-names>Brian</given-names></name><name><surname>Clark</surname><given-names>Damon A</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000879</institution-id><institution>Alfred P. Sloan Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Clark</surname><given-names>Damon A</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005665</institution-id><institution>Kinship Foundation</institution></institution-wrap></funding-source><award-id>Searle Scholar Award</award-id><principal-award-recipient><name><surname>DeAngelis</surname><given-names>Brian</given-names></name><name><surname>Clark</surname><given-names>Damon A</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>During walking and turning, the fruit fly <italic>Drosophila</italic> uses variable limb coordination patterns, which exist on a low-dimensional, continuous manifold.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Legged locomotion requires flexible coordination of limbs in varied, changing environments. This coordination has been studied in a variety of model organisms, from camels and rhinoceros to ferrets, rats, beetles, and ants (<xref ref-type="bibr" rid="bib4">Alexander and Jayes, 1983</xref>; <xref ref-type="bibr" rid="bib21">Büschges et al., 2008</xref>). In hexapods, many studies have noted considerable variability in limb movements (<xref ref-type="bibr" rid="bib8">Ayali et al., 2015</xref>; <xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib87">Pereira et al., 2019</xref>; <xref ref-type="bibr" rid="bib101">Strauß and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib111">Wosnitza et al., 2013</xref>; <xref ref-type="bibr" rid="bib112">Zollikofer, 1994</xref>), but the structure and origin of this variability remain unclear. A comprehensive characterization of this variability is required to understand locomotor control in insects (<xref ref-type="bibr" rid="bib67">Krakauer et al., 2017</xref>). To understand how insects coordinate their limbs during terrestrial locomotion, we investigated the variability in walking patterns in the fruit fly <italic>Drosophila</italic>, where we could record behavior in many flies and manipulate neural signals with genetic tools.</p><p>In many animals, variability in walking patterns takes the form of distinct locomotor gaits (<xref ref-type="bibr" rid="bib2">Alexander, 1989</xref>; <xref ref-type="bibr" rid="bib3">Alexander and Jayes, 1980</xref>; <xref ref-type="bibr" rid="bib4">Alexander and Jayes, 1983</xref>; <xref ref-type="bibr" rid="bib100">Srinivasan and Ruina, 2006</xref>; <xref ref-type="bibr" rid="bib103">Thorstensson and Roberthson, 1987</xref>). In the study of hexapod locomotion, it is unclear how the observed variability in walking coordination relates to potential preferred gaits or to forms of continuous variability. Although some studies report distinct gaits in insects (<xref ref-type="bibr" rid="bib8">Ayali et al., 2015</xref>; <xref ref-type="bibr" rid="bib11">Bender et al., 2011</xref>; <xref ref-type="bibr" rid="bib20">Burrows, 1996</xref>; <xref ref-type="bibr" rid="bib53">Graham, 1972</xref>; <xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib87">Pereira et al., 2019</xref>), many note a high degree of variability in limb coordination, with intermediate patterns intermixed with movements that resemble canonical gaits (<xref ref-type="bibr" rid="bib8">Ayali et al., 2015</xref>; <xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib87">Pereira et al., 2019</xref>; <xref ref-type="bibr" rid="bib101">Strauß and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib102">Szczecinski et al., 2018</xref>; <xref ref-type="bibr" rid="bib111">Wosnitza et al., 2013</xref>; <xref ref-type="bibr" rid="bib112">Zollikofer, 1994</xref>). <italic>Drosophila</italic> have been reported to use different coordination patterns at low and high walking speeds, with significant variability around these canonical patterns (<xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib87">Pereira et al., 2019</xref>; <xref ref-type="bibr" rid="bib101">Strauß and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib102">Szczecinski et al., 2018</xref>; <xref ref-type="bibr" rid="bib111">Wosnitza et al., 2013</xref>). The nature of this variability has not been fully investigated, as these studies focused primarily on small numbers of individual bouts of walking.</p><p>When walking speed is varied, it represents a form of <italic>symmetric</italic> variability in walking patterns. These walking patterns are themselves often antisymmetric, with legs moving out of phase, but we refer to modulations of these patterns as symmetric if they are equal on the two sides of the body. This symmetry maintains heading. Locomotion also contains <italic>asymmetric</italic> variability, in which modulations are unequal on the two sides of the body. Such asymmetry is required to change heading. In hexapods, measurements of limb kinematics (<xref ref-type="bibr" rid="bib35">Cruse et al., 2009</xref>; <xref ref-type="bibr" rid="bib40">Domenici et al., 1998</xref>; <xref ref-type="bibr" rid="bib42">Dürr and Ebeling, 2005</xref>; <xref ref-type="bibr" rid="bib46">Franklin et al., 1981</xref>; <xref ref-type="bibr" rid="bib47">Frantsevich and Mokrushov, 1980</xref>; <xref ref-type="bibr" rid="bib53">Graham, 1972</xref>; <xref ref-type="bibr" rid="bib55">Gruhn et al., 2009</xref>; <xref ref-type="bibr" rid="bib81">Mu and Ritzmann, 2005</xref>; <xref ref-type="bibr" rid="bib101">Strauß and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib112">Zollikofer, 1994</xref>; <xref ref-type="bibr" rid="bib113">Zolotov et al., 1975</xref>) and dynamics (<xref ref-type="bibr" rid="bib61">Jindrich and Full, 1999</xref>) have described small, limb-specific modulations of movement associated with turning. As in the study of symmetric variability, these studies focused primarily on individual bouts of locomotion, and most employed tethered preparations. To understand how limb movements are modulated during turns, and how symmetric and asymmetric forms of variability are related to one another, it is necessary to observe full distributions of behavior in intact and unrestrained animals.</p><p>In this study, we generated large datasets of locomotor behavior using a simple method for robustly tracking the body and limb movements of freely-walking <italic>Drosophila</italic>. By analyzing hundreds of thousands of steps, we found that the locomotor variability in flies exists on a single continuous manifold, without evidence for discrete preferred patterns. Symmetric variability could be described by changes to a single global parameter governing walking speed. In contrast, turning involves small, asymmetric, and limb-specific modulations that are precisely timed relative to the underlying symmetric pattern. When slowing was evoked by optogenetic activation of command neurons or by visual stimuli, the resulting symmetric modulations of limb movement were consistent with the manifold present in spontaneous walking. The structure of the variability in spontaneous and evoked coordination patterns suggests a simple model for limb coupling during locomotion.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A simple automated method robustly identifies limb positions</title><p>We constructed a planar arena in which freely-walking flies were illuminated from above and could be filmed from below in silhouette by a high-speed camera at 150 frames per second (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Within each frame, flies were first located and then rotated into a common orientation (see Materials and methods). From the centroid positions and heading angles, we computed the fly’s forward velocity (parallel to its heading), its lateral velocity (perpendicular to its heading), and its yaw velocity, which we denote as <inline-formula><mml:math id="inf1"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf2"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf3"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, respectively (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Exploiting the stereotyped anatomy of flies, we then used a simple linear model to identify the position of each limb in each frame (see Materials and methods, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, <xref ref-type="table" rid="table1">Table 1</xref>, and <xref ref-type="video" rid="video1">Videos 1</xref>–<xref ref-type="video" rid="video3">3</xref>). To ensure that correlations between limb poses in our training set did not systematically bias predicted limb positions, we required the model to predict limb positions from image regions limited to each limb’s approximate range of motion (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). We trained our model on a set of 5000 hand-annotated images, and used 10-fold cross-validation to test for overfitting. This cross-validation showed that the mean error between predicted and hand-annotated limb positions was 0.15 mm (3.5 pixels) (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Importantly, the accuracy of this simple linear model in our experimental context was comparable to that achieved by published deep neural network methods (<xref ref-type="bibr" rid="bib78">Mathis et al., 2018</xref>; <xref ref-type="bibr" rid="bib87">Pereira et al., 2019</xref>) (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.002</object-id><label>Figure 1.</label><caption><title>Measurements of body and limb kinematics in freely-walking <italic>Drosophila</italic>.</title><p>(<bold>A</bold>) Schematic of experimental setup. Fruit flies walk in a circular arena while illuminated from above and tracked from below using a high-speed camera (150 fps). (<bold>B</bold>) Data transformations from unstructured video to time series variables. Flies are identified in raw camera frames. Individual fly-frames are then grouped and aligned across sequential camera images. Limb positions relative to the fly’s center of mass are converted into time series variables describing limb movements in the egocentric fly frame. The fly’s limbs are binarized into individual periods of swing (<italic>black</italic>) and stance (<italic>white</italic>). (<bold>C</bold>) Probability density functions (PDFs) of three components of body movement: forward walking velocity (<inline-formula><mml:math id="inf4"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>), lateral walking velocity (<inline-formula><mml:math id="inf5"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>), and rotational velocity (<inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). (<bold>D</bold>) Joint distributions of body velocity components: forward velocity vs. lateral velocity, forward velocity vs. rotational velocity, and lateral velocity vs. rotational velocity. (<bold>E</bold>) Mean stepping statistics as a function of forward velocity. Step length in the camera frame increases linearly with forward velocity. Swing duration is roughly constant as forward velocity increases when compared to changes in stance duration. Stance duration decreases inversely with increasing forward velocity. <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub> <mml:mi/><mml:mo>~</mml:mo><mml:msup><mml:mrow> <mml:mi/><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1.025</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.59</mml:mn></mml:math></inline-formula> (see Materials and methods). For swing events, n = 58,000 to 59,000 for each limb. For stance events, n = 54,000 to 56,000 for each limb.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Linear regression accurately identifies footfall positions.</title><p>(<bold>A</bold>) Euclidean error distance (mm) between predicted and actual footfall positions as a function of number of principal components (PCs) included in model, estimated using 10-fold cross-validation. Model used for feature extraction included 1000 PCs. (<bold>B</bold>) Probability density function (PDF) and cumulative distribution function (CDF) of cross-validated errors (mm) for 1000 PC model used for feature extraction. (<bold>C</bold>) Learned linear filters that weight oriented fly images (as in <xref ref-type="fig" rid="fig1">Figure 1B</xref>) to predict each of the twelve limb positional variables. The spatial extent of each filter is restricted such that correlations between limbs do not bias the resulting predictions (see Materials and methods); this figure shows only the nonzero region of each filter.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.004</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Statistics of centroid kinematic behavior in freely-walking flies.</title><p>Error patches show 95% confidence intervals obtained from bootstrap distributions over experiments (N = 8 videos; see Materials and methods). (<bold>A</bold>) Sample centroid trajectories before and after smoothing. The raw path of the centroid is indicated by a thick <italic>black</italic> line, and the smoothed path by a thick <italic>red</italic> line. The heading vector is plotted at 20 ms increments as a thin <italic>black</italic> line before smoothing, and a thin <italic>red</italic> line after smoothing. (<bold>B</bold>) Autocorrelation functions of the yaw velocity (<italic>blue</italic>), forward velocity (<italic>red</italic>), and lateral velocity (<italic>green</italic>) of the fly centroid, before (<italic>dashed line</italic>) and after (<italic>solid line</italic>) smoothing with a Gaussian kernel with a standard deviation of 20 ms. (<bold>C</bold>) Mean absolute deviation of unsmoothed yaw velocity from smoothed yaw velocity as a function of forward velocity. (<bold>D</bold>) Distribution of full widths at half maxima of yaw rate segments centered around extrema.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig1-figsupp2-v1.tif"/></fig></fig-group><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.028</object-id><label>Table 1.</label><caption><title>Fly strains.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top"/><th valign="top">Genotype</th><th valign="top">Source</th><th valign="top">Experiment</th><th valign="top">Figure</th></tr></thead><tbody><tr><td valign="top">Wild type</td><td valign="top">+; +; +</td><td valign="top">(<xref ref-type="bibr" rid="bib52">Gohl et al., 2011</xref>)</td><td valign="top">Free-walking; Visual stimulus induced slowing</td><td valign="top">1–8</td></tr><tr><td valign="top">Moonwalker &gt; Chrimson</td><td valign="top">+; +; VT-050660-Gal4/UAS-Chrimson</td><td valign="top">(<xref ref-type="bibr" rid="bib14">Bidaye et al., 2014</xref>)</td><td valign="top">Optogenetic induced slowing</td><td valign="top">8</td></tr></tbody></table></table-wrap><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-46409-video1.mp4"><object-id pub-id-type="doi">10.7554/eLife.46409.005</object-id><label>Video 1.</label><caption><title>This movie shows a fly walking in our arena with annotated body and limb features.</title><p>Video shows annotations in both the camera and egocentric frame of the fly. Body orientation is indicated with a <italic>yellow</italic> triangle. Limb positions are <italic>red</italic> (L1), <italic>blue</italic> (L2), <italic>green</italic> (L3), <italic>orange</italic> (R1), <italic>yellow</italic> (R2), and <italic>brown</italic> (R3).</p></caption></media><media id="video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-46409-video2.mp4"><object-id pub-id-type="doi">10.7554/eLife.46409.006</object-id><label>Video 2.</label><caption><title>This movie shows a fly in its egocentric frame with annotations for each of the individual limbs.</title><p>Limb position variables are shown as time series in the direction parallel and perpendicular to the fly’s major axis. Limb positions are <italic>red</italic> (L1), <italic>blue</italic> (L2), <italic>green</italic> (L3), <italic>orange</italic> (R1), <italic>yellow</italic> (R2), and <italic>brown</italic> (R3). Swing (<italic>black</italic>) and stance (<italic>white</italic>) events for each of the limbs are shown as a function of time.</p></caption></media><media id="video3" mime-subtype="mp4" mimetype="video" xlink:href="elife-46409-video3.mp4"><object-id pub-id-type="doi">10.7554/eLife.46409.007</object-id><label>Video 3.</label><caption><title>This movie shows a grid of 25 fly trajectories seen in the egocentric frame.</title><p>Limb positions are annotated with <italic>red</italic> (L1), <italic>blue</italic> (L2), <italic>green</italic> (L3), <italic>orange</italic> (R1), <italic>yellow</italic> (R2), and <italic>brown</italic> (R3).</p></caption></media></sec><sec id="s2-2"><title>Measurements of spontaneous wild-type walking are consistent with previous studies</title><p>Many previous studies have investigated the statistics of walking in <italic>Drosophila</italic> (<xref ref-type="bibr" rid="bib13">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib14">Bidaye et al., 2014</xref>; <xref ref-type="bibr" rid="bib18">Branson et al., 2009</xref>; <xref ref-type="bibr" rid="bib51">Geurten et al., 2014</xref>; <xref ref-type="bibr" rid="bib62">Kain et al., 2013</xref>; <xref ref-type="bibr" rid="bib64">Katsov and Clandinin, 2008</xref>; <xref ref-type="bibr" rid="bib63">Katsov et al., 2017</xref>; <xref ref-type="bibr" rid="bib77">Martin, 2004</xref>; <xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib101">Strauß and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib111">Wosnitza et al., 2013</xref>). As the flies walked in the arena, their heading, lateral, and forward velocities oscillated continuously due to the periodicity of limb forces (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). Since we were interested in longer-timescale modulations of the path, we smoothed the centroid kinematics to eliminate this oscillation (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>, see Materials and methods) (<xref ref-type="bibr" rid="bib64">Katsov and Clandinin, 2008</xref>; <xref ref-type="bibr" rid="bib63">Katsov et al., 2017</xref>). Consistent with prior studies, we observe forward velocities between −1.3 and 30.4 mm/s (2.5th and 97.5th percentiles), with peaks in the distribution of forward walking speeds at 0 mm/s and ~17.5 mm/s (<xref ref-type="fig" rid="fig1">Figure 1Ci</xref>). Variation across studies in the measured distributions of walking speeds may be due to variation in experimental conditions that affect the motivational state of the fly, such as temperature and hunger (<xref ref-type="bibr" rid="bib23">Chadha and Cook, 2014</xref>; <xref ref-type="bibr" rid="bib30">Crill et al., 1996</xref>; <xref ref-type="bibr" rid="bib98">Soto-Padilla et al., 2018</xref>).</p><p>Our large dataset enabled us to characterize the full distributions of centroid kinematics, rather than measuring only a small number of individual examples. The distributions of lateral and angular velocities were roughly symmetric, illustrating that we do not observe population-level handedness in <italic>Drosophila</italic> walking (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). The joint distribution of the forward velocity <inline-formula><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> and the yaw velocity <inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> showed that flies turn at a broad range of yaw rates across many forward speeds (<xref ref-type="fig" rid="fig1">Figure 1Di–ii</xref>). Crab-walking, in which the fly’s heading vector is no longer tangent to its path, predominately occurs during high-yaw-rate turns at slow to moderate forward velocities (<xref ref-type="fig" rid="fig1">Figure 1Di–iii</xref>). These characteristics of aggregate kinematic behavior are consistent with those reported in previous studies (<xref ref-type="bibr" rid="bib101">Strauß and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib51">Geurten et al., 2014</xref>; <xref ref-type="bibr" rid="bib64">Katsov and Clandinin, 2008</xref>; <xref ref-type="bibr" rid="bib63">Katsov et al., 2017</xref>).</p><p>Our measurements of limb kinematic parameters were also broadly consistent with previous studies. Importantly, we restricted this and subsequent analyses of limb coordination to locomotion by excluding flies moving below 0.5 mm/s. This criterion excluded flies that were stopped or grooming, behaviors that involve interesting patterns of limb coordination (<xref ref-type="bibr" rid="bib95">Seeds et al., 2014</xref>), but lie outside of the focus of this study. In our data, step length in the stationary frame of the camera increased roughly linearly with forward walking speed (<xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>) (<xref ref-type="fig" rid="fig1">Figure 1Ei</xref>). Across walking speeds, swing duration increased, but this modulation is small in comparison to the change in stance duration (<xref ref-type="fig" rid="fig1">Figure 1Eii–iii</xref>). Stance duration was approximately inversely proportional to forward walking speed (<inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub> <mml:mi/><mml:mo>~</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1.025</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo> <mml:mi/> <mml:mi/><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.59</mml:mn></mml:math></inline-formula>) (see Materials and methods) (<xref ref-type="fig" rid="fig1">Figure 1Eiii</xref>). Therefore, our data were broadly consistent with previous observations that walking speed differences are dominated by changes in stance duration, while swing duration remains relatively constant (<xref ref-type="bibr" rid="bib110">Wilson, 1966</xref>; <xref ref-type="bibr" rid="bib111">Wosnitza et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Dürr et al., 2018</xref>; <xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>).</p></sec><sec id="s2-3"><title>Swing-stance patterns change in a speed-dependent manner</title><p>In hexapod locomotion, studies have described three canonical gaits (<xref ref-type="fig" rid="fig2">Figure 2A–B</xref>) (<xref ref-type="bibr" rid="bib11">Bender et al., 2011</xref>; <xref ref-type="bibr" rid="bib20">Burrows, 1996</xref>; <xref ref-type="bibr" rid="bib26">Collins and Stewart, 1993</xref>; <xref ref-type="bibr" rid="bib53">Graham, 1972</xref>; <xref ref-type="bibr" rid="bib99">Spirito and Mushrush, 1979</xref>; <xref ref-type="bibr" rid="bib110">Wilson, 1966</xref>). In tripod gait, two groups of three limbs swing simultaneously, creating two alternating configurations of swing and stance. In tetrapod gait, three groups of two limbs swing in sequence, while in wave gait, each limb swings individually. In general, distinct gaits can be distinguished by discontinuous changes in one or more parameters of the coordination pattern (<xref ref-type="bibr" rid="bib2">Alexander, 1989</xref>; <xref ref-type="bibr" rid="bib100">Srinivasan and Ruina, 2006</xref>). However, defining gaits in terms of discontinuous transitions can be problematic in the presence of measurement noise or behavioral variability, which can blur sharp transitions. Instead, one may characterize the distribution of walking coordination patterns, where distinct gaits correspond to multiple modes in the distribution (<xref ref-type="bibr" rid="bib58">Hoyt and Taylor, 1981</xref>).</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.008</object-id><label>Figure 2.</label><caption><title><italic>Drosophila</italic> use a two-cycle limb coordination pattern across all walking speeds.</title><p>(<bold>A</bold>) Canonical hexapod gaits. In all gaits, limb swings (<italic>black</italic>) propagate ipsilaterally posterior to anterior on each side of the fly. Tripod gait is defined by three limbs simultaneously swinging at each point in time. Tetrapod gait is defined by two limbs simultaneously swinging at each point in time. Wave gait is defined by each limb swinging individually. (<bold>B</bold>) Each canonical gait contains a different number of distinct stance configurations, and correspondingly a different number of transitions between these configurations. Tripod gait contains two distinct configurations, tetrapod gait contains three distinct configurations, and wave gait contains six distinct configurations. The ordering of configurations within a cycle is defined by the posterior-to-anterior propagation of ipsilateral swing events (<italic>black</italic>). (<bold>C</bold>) Probability of number of feet in stance at each forward walking velocity. Segments within each color represent different configurations within each category. Number of feet in stance decreases as forward walking velocity increases. (<bold>D</bold>) Probability of canonical stance configurations (from (<bold>B</bold>)) as a function of forward velocity: tripod (<italic>green</italic>), tetrapod (<italic>yellow</italic>), wave gait (<italic>orange</italic>). Dashed lines indicate the forward speed with maximum probability of each stance category: 24 mm/s, 13 mm/s, and 7 mm/s 3-foot-down, 4-foot-down, and 5-foot-down categories, respectively. (<bold>E</bold>) Cumulative distribution function (CDF) of stance durations for all canonical gait configurations: tripod (<italic>green</italic>), tetrapod (<italic>yellow</italic>), and wave gait (<italic>orange</italic>). Configuration durations are visualized for bottom, middle, and top thirds of forward velocity distribution: slow walking (0–10.2 mm/s), medium walking (10.2–19 mm/s), and fast walking (&gt;19 mm/s). Tetrapod and wave gait configurations are predominantly transient in all but the slowest walking condition. (<bold>F</bold>) Relative probability of number of feet in stance as a function of midlimb phase grouped by walking velocity: slow (0–10.2 mm/s), medium (10.2–19 mm/s) and fast walking (&gt;19 mm/s). These probability density functions are normalized such that the integral over phase of the sum of the distributions conditioned on the number of feet down is equal to unity. The number of feet in stance varies as a function of limb phase with a periodicity of two per limb cycle.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.009</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Estimating limb phases.</title><p>Analytic signal decomposition of an example limb position time series. Limb movements in the direction parallel to the fly’s body axis were decomposed into instantaneous measures of phase and amplitude using the discrete-time analytic signal method (see Materials and methods). Phase zero is defined as the maximally posterior point in the limb’s cycle. Phase measurements used throughout the paper were computed in this manner.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.010</object-id><label>Figure 2—figure supplement 2.</label><caption><title>A two-cycle coordination pattern is used across all walking speeds.</title><p>(<bold>A</bold>) Joint distribution of midlimb phase and forward walking speed conditioned on the number of feet in stance phase reveals two peaks per limb cycle for 5, 4, and 3-foot down conditions across all walking speeds. (<bold>B</bold>) Relative probability of number of feet in stance as a function of forelimb phase grouped by walking velocity: slow (0–10.2 mm/s), medium (10.2–19 mm/s) and fast walking (&gt;19 mm/s). The number of feet in stance varies as a function of limb phase with a periodicity of two per limb cycle. (<bold>C</bold>) Relative probability of number of feet in stance as a function of hindlimb phase grouped by walking velocity: slow (0–10.2 mm/s), medium (10.2–19 mm/s) and fast walking (&gt;19 mm/s). The number of feet in stance varies as a function of limb phase with a periodicity of two per limb cycle.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig2-figsupp2-v1.tif"/></fig></fig-group><p>To examine the structure of limb coordination in flies, we first investigated the structure of the swing-stance patterns used at different forward walking speeds (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). We determined whether a limb was in swing or stance phase by measuring its frame-to-frame displacement in the camera frame. If a limb position moved more than roughly our error in positional measurement (~0.13 mm in the camera frame) then we considered the limb to be in swing phase (see Materials and methods). Movements below this threshold were classified as stance phase. Thus, for each fly-frame, we generated a six-digit binary vector describing the swing-stance configuration of the fly’s six limbs.</p><p>These individual configurations can be categorized by how many limbs are in stance phase. Previous studies have reported an enrichment of the three-foot stance category at faster forward walking speeds and a corresponding enrichment of the four-foot stance category at slower forward walking speeds (<xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib87">Pereira et al., 2019</xref>; <xref ref-type="bibr" rid="bib101">Strauß and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib111">Wosnitza et al., 2013</xref>). These studies suggested that the proportion of feet in stance at different speeds were consistent with flies using tetrapod gaits at lower speeds and a tripod gait at higher speeds. Our data also showed speed-dependent enrichments of five- and four-foot stance categories at slow speeds, and enrichments of the three-foot stance category for flies walking at faster speeds (<xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p><p>To understand the structure of these different stance categories, we investigated the specific configurations of limbs in each of the three-, four-, and five-foot stance categories. For each of the canonical gaits, one would expect the constituent discrete limb configurations to occur in roughly equal proportions (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). In the case of the three-foot stance category, the two configurations that comprise the canonical tripod gait occur in roughly equal proportions at all forward walking speeds (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). In contrast, different configurations of the five-foot and four-foot stance categories do not occur with equal abundance across walking speeds (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). Interestingly, the four-foot stance configurations that occur with greatest frequency are those that are a single swing-stance transition away from a canonical tripod gait.</p></sec><sec id="s2-4"><title>A large fraction of four- and five-foot stance configurations are transient</title><p>To investigate the dynamics of stance configurations in our data, we examined the dwell times in all individual stance configurations within each canonical gait (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). We defined the dwell time as the number of contiguous frames in the configuration. If each canonical gait existed in the data, one would expect that the dwell time in each stance configuration associated with the gait would approximately match the average swing duration of the limbs. Because previous studies reported that <italic>Drosophila</italic> preferentially use tetrapod and tripod gaits at slow and fast speeds respectively, we partitioned the data into thirds based on forward walking speed (<xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib87">Pereira et al., 2019</xref>; <xref ref-type="bibr" rid="bib111">Wosnitza et al., 2013</xref>). At slow speeds (<italic>v</italic><sub>|| </sub>≤ 10.2 mm/s), while many instances of canonical configurations were transient (one frame or ~6.7 ms), there existed longer durations for all tripod, tetrapod, and wave gait configurations (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). At higher speeds, virtually all tetrapod and wave gait configurations were transient, lasting only one frame.</p><p>Next, we found the most frequent forward velocities within each stance category, which were 7 mm/s, 13 mm/s, and 24 mm/s for 5-foot, 4-foot, and 3-foot stance categories, respectively (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). If each canonical configuration represented a distinct, preferred gait, then we might expect these walking speeds to occur with greater frequency than nearby walking speeds, as is observed in horses (<xref ref-type="bibr" rid="bib58">Hoyt and Taylor, 1981</xref>). Yet, no peaks in the distribution of forward velocities exist in these locations, suggesting that this phenomenon is not present in flies (<xref ref-type="fig" rid="fig1">Figure 1Ci</xref>).</p></sec><sec id="s2-5"><title>The abundance of each stance category peaks twice per single-limb stride</title><p>Each canonical gait contains a different number of discrete limb configurations and thus a different number of transitions between these configurations (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). In canonical gaits, swinging limbs move simultaneously, but deviations in step timing can transiently change the number of feet down. For tripod gait, changes in the number of feet down would occur twice per cycle, corresponding to the two transitions between canonical stance configurations. For a tetrapod gait, we would expect a three-cycle associated with the three transitions between the three tetrapod stance configurations. Correspondingly, a wave gait would produce a six-cycle corresponding to the transitions between each of the independently swinging limbs. Previous studies have noted that deviations in step timing can produce intermediate non-canonical stance configurations (<xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>). Yet, even if these intermediate configurations are present, the periodicity of the relative abundance of three-, four- and five-foot stance categories as a function of limb phase still provides information about potential underlying gait patterns.</p><p>To calculate the phase of each limb at each point in time, we decomposed the time series of the limb position in the direction parallel to the fly’s body axis into amplitude and phase components using the discrete-time analytic signal method (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>) (see Materials and methods) (<xref ref-type="bibr" rid="bib15">Boashash and Reilly, 1992</xref>; <xref ref-type="bibr" rid="bib49">Gabor, 1946</xref>; <xref ref-type="bibr" rid="bib72">Lamb and Stöckl, 2014</xref>); Marple L., 1999; <xref ref-type="bibr" rid="bib106">Vakman and Vaĭnshteĭn, 1977</xref>). This transformation gives an estimate of the phase of each limb at each timepoint and has previously been applied to analyze cockroach limb oscillations (<xref ref-type="bibr" rid="bib28">Couzin-Fuchs et al., 2015</xref>). We then visualized the number of feet down as a function of each limb’s phase to count the number of transitions per step cycle (<xref ref-type="fig" rid="fig2">Figure 2F</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). If canonical wave and tetrapod gaits occurred with significant frequency in our data, we would expect to see walking speeds where the number of feet down oscillates as a 6- or 3-cycle. Yet, the frequency of all limb categories peaked twice per cycle at all forward walking speeds. This two-cycle persists even when the threshold that distinguishes between swing and stance is halved, a manipulation that accentuates any effects of measurement noise. The persistent two-cycle in the data is inconsistent with the existence of tetrapod or wave gaits in a large fraction of measured trajectories. However, if tetrapod or wave gaits accounted for only a small fraction of the walking data, their characteristic periodicity might not be visible in this analysis.</p></sec><sec id="s2-6"><title>Contralateral limbs are antiphase across all walking speeds</title><p>To investigate variability in the coordination among limbs, we examined the full distributions of pairwise relative limb phases (<xref ref-type="fig" rid="fig3">Figure 3A–B</xref>). Within the set of canonical gaits, each has a characteristic set of phase offsets among the six limbs (<xref ref-type="bibr" rid="bib26">Collins and Stewart, 1993</xref>). The most probable relative phase configuration in our data was not consistent with any single canonically defined gait (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Like the canonical tripod gait, all contralateral pairwise relative phases maintain a mean relative phase of a half-cycle (<inline-formula><mml:math id="inf11"><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfenced><mml:mo>≈</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib111">Wosnitza et al., 2013</xref>). However, unlike a perfect tripod gait, ipsilateral mid-fore and hind-mid pairings are not on average in antiphase (<inline-formula><mml:math id="inf12"><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfenced><mml:mo>≈</mml:mo><mml:mn>0.4</mml:mn></mml:math></inline-formula>), while hind-fore pairings are also not in phase (<inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.85</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), consistent with previous observations (<xref ref-type="bibr" rid="bib111">Wosnitza et al., 2013</xref>). The observed pairwise relative phases are also inconsistent with expected phasing for canonical tetrapod and wave gaits (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.011</object-id><label>Figure 3.</label><caption><title>Relative phase measurements reveal a continuum of coordination patterns across all walking speeds with contralateral limbs in antiphase.</title><p>(<bold>A</bold>) Diagram of pairwise limb relative phases, with ipsilateral pairs in <italic>blue</italic> and contralateral pairs in <italic>red</italic>. (L1-R1 = Left forelimb – Right forelimb, L2-R2 = Left midlimb – Right midlimb, L3-R3 = Left hindlimb – Right hindlimb, M-F = Midlimbs – Forelimbs, H-M = Hindlimbs – Midlimbs, H-F = Hindlimbs – Forelimbs). (<bold>B</bold>) Distributions of limb relative phases (<inline-formula><mml:math id="inf14"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:math></inline-formula>) for ipsilateral and contralateral pairs across all velocities. (<bold>C</bold>) Circular means of relative phases as a function of forward velocity. Contralateral relative phases are constant at 0.5 cycles across all walking speeds. Adjacent ipsilateral pairings (mid-fore and hind-mid) approach 0.5 cycles out of phase as forward velocity increases. Hind-fore ipsilateral limb pairings approach being in-phase as forward velocity increases. (<bold>D</bold>) Angular deviation of pairwise relative limb phases. Variance monotonically decreases in all limb pairings as forward velocity increases. (<bold>E</bold>) Joint probability distribution of L2-R2 and L3-L1 relative phases reveals a single peak in the distribution. (<bold>F</bold>) Example trajectories from freely walking fruit flies showing limb coordination patterns similar to canonical tripod (<italic>green</italic>) and tetrapod (<italic>orange</italic>), and to a non-canonical gait (<italic>purple</italic>) in which hind-fore limbs swing together while midlimbs swing individually. (<bold>G</bold>) Stance duration probability conditioned on forward velocity. All stances from example trajectories overlaid: tripod (<italic>green</italic>), tetrapod (<italic>orange</italic>), and non-canonical (<italic>purple</italic>). (<bold>H</bold>) Coherence distributions (see Materials and methods) for canonical tripod (<italic>red</italic>), left tetrapod (<italic>blue</italic>), right tetrapod (<italic>green</italic>), and wave gaits (<italic>orange</italic>). (<bold>I</bold>) Mean coherence at each forward walking speed for canonical tripod (<italic>red</italic>), left tetrapod (<italic>blue</italic>), right tetrapod (<italic>green</italic>) and wave gaits (<italic>orange</italic>). (<bold>J</bold>) Fraction of data best described by each canonical gait as a function of forward walking speed.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.012</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Synthetic canonical gaits differ in relative phasing from the coordination patterns used by free-walking <italic>Drosophila</italic>.</title><p>(<bold>A</bold>) Distributions of limb relative phases for synthetic tripod, left tetrapod, right tetrapod, and wave gaits. (<bold>B</bold>) Joint probability distribution of L2-R2 and L3-L1 relative phases for synthetic tripod, left tetrapod, right tetrapod, and wave gaits.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.013</object-id><label>Figure 3—figure supplement 2.</label><caption><title>The conditional distributions of pairwise limb relative phases are unimodal at all forward walking speeds.</title><p>Probability density functions of each of the nine pairings of limb relative phase shown in <xref ref-type="fig" rid="fig3">Figure 3A–D</xref>, conditioned on forward walking speed.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig3-figsupp2-v1.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.014</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Additional measurements of limb phases.</title><p>(<bold>A</bold>) Joint probability distribution of L2-R2 and L3-L1 relative phases for bottom, middle, and top thirds of forward velocity distribution: slow walking (0–10.2 mm/s), medium walking (10.2–19 mm/s), and fast walking (&gt;19 mm/s). (<bold>B</bold>) L2-R2 relative phase as a function of L2 limb phase for free-walking wild type flies partitioned by forward walking velocity. Greater range in relative phases occurs at slower forward walking velocities. Error bars are standard error of the mean (SEM). (<bold>C</bold>) Coherence distributions for timepoints best described by canonical tripod (<italic>red</italic>), left tetrapod (<italic>blue</italic>), right tetrapod (<italic>green</italic>), and wave gaits (<italic>orange</italic>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig3-figsupp3-v1.tif"/></fig></fig-group><p>To understand how phase relationships depend on forward walking speeds, we estimated the distributions of all pairwise limb relative phases conditioned on forward walking speed (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). Across all forward velocities, these distributions were unimodal, allowing us to characterize them by their first and second circular moments. Strikingly, at all forward walking speeds, all three contralateral limb pairings maintain a constant mean phase offset of a half-cycle (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Mean ipsilateral limb relative phases, in contrast, are not constant across walking speeds, and approach a tripod-like coupling at the fastest forward walking speeds (<xref ref-type="fig" rid="fig3">Figure 3C</xref>).</p><p>Notably, all pairwise relative phases exhibit a monotonic decrease in angular deviation as forward walking speed increases (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). One interpretation for this decrease in variance is that inter-limb coupling is weaker at low speeds than at fast speeds (<xref ref-type="bibr" rid="bib6">Aminzare and Holmes, 2018</xref>; <xref ref-type="bibr" rid="bib5">Aminzare et al., 2018</xref>). This possibility is consistent with the observation that low-speed walking is more sensitive to sensory information and correspondingly more variable (<xref ref-type="bibr" rid="bib12">Berendes et al., 2016</xref>; <xref ref-type="bibr" rid="bib60">Isakov et al., 2016</xref>). A second interpretation is that some of the variability results from the characteristics of phases for waveforms with duty cycles that deviate from one-half (<xref ref-type="bibr" rid="bib28">Couzin-Fuchs et al., 2015</xref>; <xref ref-type="bibr" rid="bib72">Lamb and Stöckl, 2014</xref>; <xref ref-type="bibr" rid="bib106">Vakman and Vaĭnshteĭn, 1977</xref>) (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). When measuring the relative phases between limbs, each limb sweeps out one half-cycle while in stance and another half-cycle while in swing. When the limbs have asymmetric duty cycles, they sweep out different fractions of a cycle per unit time when in swing versus stance. Thus, slow walking, which is empirically characterized by longer stances and approximately the same swing durations as fast walking, will necessarily have greater variance in relative phasing. Both explanations likely contribute to the observation of greater variance in limb relative phases at low speed.</p></sec><sec id="s2-7"><title>The joint distribution of limb relative phases is unimodal</title><p>To determine the preferred phase offsets used by the control circuits that govern walking, we examined the joint distributions of inter-limb relative phases (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). If <italic>Drosophila</italic> used multiple distinct gaits, we would expect to see multiple peaks in this probability distribution (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). For instance, in this view, tripod gaits exist in one region, tetrapod gaits exist in two, and wave gaits exist in a fourth. Yet, the observed distribution has only a single peak, suggesting that the spontaneously walking fruit fly uses a single continuum of limb relative phases (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). This observation holds across all forward walking speeds; in particular, there was only a single mode even at the slowest walking speeds (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplements 2</xref> and <xref ref-type="fig" rid="fig3s3">3</xref>). The most abundant relative phasing is distinct from the peaks predicted for any canonical gait; however, it is closest to that of a canonical tripod gait. There were no peaks in the distribution at locations corresponding to canonical tetrapod or wave gait configurations. However, the tails of this distribution extend to the location of both canonical tetrapod peaks, which allowed us to identify individual trajectories with tetrapod-like characteristics.</p><p>Consistent with previous studies, we could extract individual trajectories that are similar to canonical tripod and tetrapod gaits by selecting trajectories with the expected duty cycles (<xref ref-type="fig" rid="fig3">Figure 3F–G</xref>) (<xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib87">Pereira et al., 2019</xref>). Interestingly, the tetrapod-like examples appear to have a characteristic cross-body offset in step timing, so that the limbs that should swing together in the canonical tetrapod gait are actually slightly offset in time. This offset maintains approximate antiphase between contralateral pairs of limbs, rather than the expected phase offset of the canonical tetrapod gait (<xref ref-type="fig" rid="fig3">Figure 3F</xref>). In addition, we observed a previously unidentified non-canonical coordination pattern in which fore- and hind-limbs swing together while each mid-limb swings alone (<xref ref-type="fig" rid="fig3">Figure 3F</xref>). This pattern is distinct from all previously described canonical gaits, but might be expected when considering a single continuum of coordination patterns. In particular, this non-canonical configuration was predicted from an early continuum view of limb coordination (<xref ref-type="bibr" rid="bib107">Wendler, 1964</xref>; <xref ref-type="bibr" rid="bib110">Wilson, 1966</xref>).</p></sec><sec id="s2-8"><title>Template-matching suggests an absence of canonical tetrapod and wave gaits</title><p>We next sought to systematically investigate how closely our data matched the configurations of relative limb phasing specified by each of the canonical gaits. To do so, we defined a template-matching coherence metric based on a simple model for networks of coupled oscillators (see Materials and methods). The coherence falls between zero and one, with unity corresponding to an exact match to the template phase configuration. The tripod coherence distribution is sharply peaked around ~0.9, indicating a close template match, while the distributions for the other canonical gaits were broader and peaked at lower coherences (<xref ref-type="fig" rid="fig3">Figure 3H</xref>). If the fly preferentially used different gaits at different forward walking speeds, then we would expect to see a peak in the conditional coherence distribution for a given canonical gait at some characteristic forward velocity. Yet, we did not observe any such distinct peaks in our data (<xref ref-type="fig" rid="fig3">Figure 3I</xref>). At all but the lowest speeds, the most coherent phase template is tripod (<xref ref-type="fig" rid="fig3">Figure 3J</xref>). Furthermore, the coherences in non-tripod modes are quite low, even among those instances better described by canonical gaits other than tripod (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). Therefore, under an analysis designed to sensitively compare our data to canonical gait configurations, we do not observe significant evidence for the use of canonical tetrapod and wave gaits.</p></sec><sec id="s2-9"><title>A single low-dimensional manifold describes limb coordination during walking</title><p>To directly visualize the structure of the continuum of coordination patterns indicated by our phase analysis, we first applied principal component analysis to our limb kinematic data (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). The principal components of these data occur in degenerate, phase-shifted pairs. The projection into the first two principal components provides some information about the phasic structure of our data. However, variations in walking frequency are not well-represented by this projection. In particular, the first two principal components emphasize a single frequency, so that frequencies that are both higher and lower are mapped to the same radius in the plane. Furthermore, the projection into the first three principal components does not provide greater insight. Therefore, principal component analysis provides some information about the structure of the data, but does not permit easy visualization of its full structure in two or three dimensions.</p><p>We therefore applied Uniform Manifold Approximation and Projection (UMAP) to generate a low-dimensional embedding of our data (<xref ref-type="bibr" rid="bib79">McInnes et al., 2018</xref>). UMAP minimizes the cross-entropy between topological representations of the local distance metric on some high-dimensional data manifold and on a low-dimensional embedding manifold. Among nonlinear dimensionality reduction techniques, UMAP is ideal for this application because it attempts to preserve the local and global topology of the high-dimensional data, in contrast to algorithms like t-SNE, which is designed to emphasize local structure at the expense of global structure (<xref ref-type="bibr" rid="bib10">Becht et al., 2019</xref>; <xref ref-type="bibr" rid="bib79">McInnes et al., 2018</xref>).</p><p>Using UMAP, we generated low-dimensional representations of 10<sup>5</sup> randomly-sampled segments of limb positional data, each with a half-window length of 100 ms (15 frames). This sampling thus had a dimensionality of 31 frames by 6 limbs by two spatial coordinates, or 372 total dimensions. Our data was represented by a bell-shaped manifold embedded in three-dimensional space (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The linear dimension along the axis of the bell is parameterized by the mean stepping frequency (<xref ref-type="fig" rid="fig4">Figure 4A</xref>, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>), while the cyclic coordinate is defined by a single global phase (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Antiphase between contralateral limbs is preserved at all phases of the global oscillator (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). Embedding individual trajectories illustrates a clockwise rotation during forward walking when viewed from the mouth of the bell (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). The number of feet in stance at the central timepoint of the sampled segments oscillates as a two-cycle as a function of the cyclic coordinate (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Consistent with the absence of multiple preferred configuration patterns, the density of points within this manifold along its axial dimension is unimodal (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). If one halves or doubles the segment length, the axial extent of the manifold is compressed or extended, intuitively corresponding to one’s ability to extract frequency information from the time series, following the frequency-time uncertainty principle (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>). Thus, this manifold learning analysis of our data reveals a structure that exactly corresponds to the intuitive representation of a system of coupled oscillators with a shared frequency that varies between segments.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.015</object-id><label>Figure 4.</label><caption><title>Dimensionality reduction reveals the manifold structure of limb coordination patterns.</title><p>(<bold>A</bold>) UMAP embedding of limb coordinate time series colored by the mean frequency of forward walking. Frequency (correlated with forward walking velocity) maps to the height along the vase-shaped manifold. (<bold>B</bold>) Embedding colored by the mean-subtracted positions of the left and right midlimbs. The global phase of the walking behavior defines the location along a cross-section of the manifold. (<bold>C</bold>) Tripod (<italic>green</italic>), tetrapod-like (<italic>orange</italic>), and non-canonical (<italic>purple</italic>) trajectories from <xref ref-type="fig" rid="fig3">Figure 3F–G</xref> embedded in the UMAP space. Start of each trajectory is indicated by a <italic>black</italic> circle. Arrows indicate the trajectory direction. (<bold>D</bold>) Embedding colored by number of feet in stance. The number of feet in stance changes with a periodicity of two per cycle at all forward walking speeds.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.016</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Principal component analysis of limb kinematic data.</title><p>(<bold>A</bold>) The covariance matrix of the segments of standardized limb kinematic data used to generate the UMAP embedding in <xref ref-type="fig" rid="fig4">Figure 4</xref>. This matrix is approximately a block-symmetric-Toeplitz matrix. (<bold>B</bold>) The principal component spectrum of these data is composed of degenerate pairs. (<bold>C</bold>) The first four principal components of the limb kinematic data used to generate the PCA embedding. PC1 and 2 have approximately equal eigenvalues and are approximately phase-shifted versions of one another. PC3 and 4 are also degenerate and approximately phase-shifted. (<bold>D</bold>) Scatter plot of the projections of limb kinematic data into the first two principal components, colored by the mean frequency of stepping. (<bold>E</bold>) As in (<bold>D</bold>), but colored by the mean-subtracted positions of the left and right midlimbs. (<bold>F</bold>) Joint distribution of radius in the PC1-PC2 plane as shown in (<bold>D</bold>) and the mean frequency of stepping. The relationship between frequency and radius is multivalued. (<bold>G</bold>) As in (<bold>D</bold>), but for the projection into the first three principal components.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig4-figsupp1-v1.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.017</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Representation of UMAP embedding in cylindrical coordinates.</title><p>(<bold>A</bold>) The UMAP embedding of limb kinematic data shown in <xref ref-type="fig" rid="fig4">Figure 4</xref> was converted into cylindrical coordinates as <inline-formula><mml:math id="inf15"><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf16"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:math></inline-formula>, <inline-formula><mml:math id="inf17"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">arctan</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, the distribution of the resulting UMAP phase angle is shown. (<bold>B</bold>) Joint distribution of axial and radial coordinates of UMAP embedding. (<bold>C</bold>) Joint distribution of UMAP phase and L2 instantaneous phase at the central timepoint of the embedded segment. (<bold>D</bold>) Joint distribution of mean instantaneous frequency and UMAP axial dimension.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig4-figsupp2-v1.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.018</object-id><label>Figure 4—figure supplement 3.</label><caption><title>Contralateral antiphase is preserved at all phases of the global oscillator.</title><p>The UMAP embedding of limb kinematic data shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>, colored by the instantaneous phases of the left and right midlimbs at the center point of each segment.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig4-figsupp3-v1.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.019</object-id><label>Figure 4—figure supplement 4.</label><caption><title>Changing the segment duration dilates the axial extent of the UMAP manifold while maintaining the same structure.</title><p>(<bold>A</bold>) UMAP embedding of 100 ms segments of limb positional data, colored by mean stepping frequency (see <xref ref-type="fig" rid="fig4">Figure 4A</xref>). (<bold>B</bold>) As in (<bold>A</bold>), but for 400 ms segments. (<bold>C</bold>) As in (<bold>A</bold>), but colored by the position of the right midlimb in the direction parallel to the body axis (see <xref ref-type="fig" rid="fig4">Figure 4B</xref>). (<bold>D</bold>) As in (<bold>C</bold>), but for 400 ms segments.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig4-figsupp4-v1.tif"/></fig><fig id="fig4s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.020</object-id><label>Figure 4—figure supplement 5.</label><caption><title>The manifold structure of synthetic canonical gaits differs qualitatively from that of free-walking <italic>Drosophila</italic>.</title><p>(<bold>A</bold>) UMAP embedding (see Materials and methods) of synthetic tripod (<italic>red</italic>), left tetrapod (<italic>blue</italic>), right tetrapod (<italic>green</italic>), and wave gaits (<italic>orange</italic>) reveals separate manifolds for each canonical gait type. Tripod, tetrapod, and wave gaits occur with equal abundance in this embedding. (<bold>B</bold>) Separation of UMAP manifolds remains even with low abundance of non-tripod gaits. Gaits represented different fractions of the input data: tripod (<italic>red</italic>) 98%, left tetrapod (<italic>blue</italic>) 0.5%, right tetrapod (<italic>green</italic>) 0.5%, wave gait (<italic>orange</italic>) 1%.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig4-figsupp5-v1.tif"/></fig></fig-group><p>To test how this UMAP visualization would act on a dataset known to contain distinct gaits, we generated a synthetic dataset in which all three canonical gaits were present, each at a continuum of stepping frequencies (see Materials and methods). To generate an embedding comparison that provided evidence for the absence of distinct gaits, one would need to have a model for the structure of gait transitions. However, there is not a clear null model for such transitions. In the absence of a null model, this analysis considers only pure canonical gaits. Even when canonical tetrapod and wave gaits each accounted for only 1% of the segments, this embedding clearly showed distinct manifolds for the canonical gaits (<xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>). Therefore, although this simulation does not provide direct evidence for the absence of multiple distinct gaits, it provides additional evidence that the manifold structure of our data is consistent with a single continuum, since data containing discrete gaits could have yielded distinct manifolds for each.</p></sec><sec id="s2-10"><title>Varying one parameter in a simple model generates key attributes of observed walking patterns</title><p>Our experimental data suggest that walking speed modulation in <italic>Drosophila</italic> may be consistent with a simple control circuit with speed-independent coupling. We tested this possibility by constructing a minimal, rule-based generative model for phase dynamics (<xref ref-type="fig" rid="fig5">Figure 5A–B</xref>) (see Materials and methods). Conceptually, this model is related to rule-based control algorithms for walking robots, but it differs from most such models in that it generates phase dynamics rather than target limb placement positions (<xref ref-type="bibr" rid="bib71">Kwak and McGhee, 1989</xref>; <xref ref-type="bibr" rid="bib97">Song and Waldron, 1987</xref>; <xref ref-type="bibr" rid="bib108">Wettergreen and Thorpe, 1992</xref>). In this model, we varied the stance duration while keeping the inter-limb coupling and swing duration fixed, thus generating posterior-to-anterior metachronal waves along each side of the body (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). The interval between metachronal waves was governed by the stance duration, which is the single modulated parameter in the model. The two sides of the body were coupled such that they were in antiphase, independent of stance duration.</p><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.021</object-id><label>Figure 5.</label><caption><title>A single-parameter model with speed-independent coupling predicts a continuum of inter-limb coordination patterns.</title><p>(<bold>A</bold>) A single-parameter phase oscillator model to generate metachronal waves (see Materials and methods). The frequency of metachronal waves is determined by a single parameter, <inline-formula><mml:math id="inf18"><mml:mi>τ</mml:mi></mml:math></inline-formula><sub>stance</sub>. Limb oscillators are coupled by constant unidirectional inhibition from posterior limbs to anterior limbs. (<bold>B</bold>) A minimal model of spontaneous walking in the fruit fly may be obtained by linking two of the units diagrammed in (<bold>A</bold>) with bidirectional contralateral coupling. Forward walking speed is determined solely by stance duration. Example swing-stance plots illustrate the ability to generate walking patterns similar to canonical tripod (<italic>v<sub>||</sub></italic>=25 mm/s) and tetrapod-like gaits (<italic>v<sub>||</sub></italic>=15 mm/s). Additionally, this model generates the non-canonical limb coordination pattern identified in our data (<italic>v<sub>||</sub></italic>=10 mm/s), in which midlimbs swing independently while contralateral fore and hind limbs swing together. As observed in our experimental data, the tetrapod-like pattern generated by this model deviates from canonical tetrapod as relative phases between contralateral limbs are antiphase. Example trajectories from <xref ref-type="fig" rid="fig3">Figure 3F</xref> are presented for comparison to model trajectories. This model was used to generate the data analyzed in panels (<bold>C–G</bold>). (<bold>C</bold>) Relative probability of the number of feet in stance as a function of forward walking speed. As walking speed increases, the number of feet in stance decreases. (<bold>D</bold>) Relative probability of number of feet in stance as a function of midlimb phase for bottom, middle, and top thirds of forward velocity distribution. The number of feet down oscillates with a frequency of two per single-limb-stride. (<bold>E</bold>) Circular means of limb relative phases for each pairwise relationship as a function of forward velocity. Consistent with experimental data, contralateral relative phases are constant at ½ cycles across all walking speeds. Adjacent ipsilateral pairings (mid-fore and hind-mid) approach antiphase as walking frequency (forward velocity) increases. Hind-fore ipsilateral limb pairings approach being in-phase as forward velocity increases. (<bold>F</bold>) Angular deviation of pairwise relative limb phases. Variance of relative phases decreases in all limb pairings as forward velocity increases. (<bold>G</bold>) UMAP embedding of model-generated trajectories. All trajectories lie on a single manifold.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.022</object-id><label>Figure 5—figure supplement 1.</label><caption><title>A single-parameter model generates a two-cycle coordination pattern across all walking speeds.</title><p>Model-generated joint distribution of midlimb phase and forward walking speed shows two peaks per limb cycle for 5, 4, and 3-foot down conditions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig5-figsupp1-v1.tif"/></fig></fig-group><p>This simple construction recapitulated several key observations in our data. First, it can generate canonical tripod and wave gaits, as well as a continuum of intermediate coordination patterns (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). Importantly, because the phase difference across the body is always one half-cycle, this model cannot produce the canonical tetrapod gait, but it can produce the tetrapod-like pattern with a characteristic offset in swings observed in our experimental data. With an appropriate choice of stance duration, it also generated the observed non-canonical limb pattern in which fore- and hind-limbs swing simultaneously while mid-limbs swing individually. With this model, the number of feet in stance phase varied as a function of the forward walking speed, as observed in experimental data (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). The model also reproduced the measured two-cycle in the number of feet down as a function of limb phase (<xref ref-type="fig" rid="fig5">Figure 5D</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). This two-cycle occurs in the model because each ipsilateral posterior-to-anterior wave is effectively a single event, and they are always exactly out of phase. The mean contralateral relative phases are constant across forward walking speeds, while the mean ipsilateral relative phases vary in a speed-dependent manner, consistent with our experiments (<xref ref-type="fig" rid="fig5">Figure 5E</xref>). Finally, this model recapitulates the decrease in variance in the relative phases with increasing forward speed observed in our data (<xref ref-type="fig" rid="fig5">Figure 5F</xref>). Consistent with experimental observations, embedding the model-generated data using UMAP produces a single manifold (<xref ref-type="fig" rid="fig5">Figure 5G</xref>). Overall, this simple model with speed-independent limb coupling and a single control parameter qualitatively captures major characteristics of the symmetric variability in <italic>Drosophila</italic> spontaneous walking coordination.</p></sec><sec id="s2-11"><title>Turns are achieved through asymmetric, segment-specific modulations of limb movements</title><p>Our simple model shows that symmetric variability in limb movements can be described using a single parameter to control speed. Turning is inherently a form of asymmetric variation, as it requires that the outside legs of the fly traverse a greater distance than the inside legs. This path length differential could be achieved by modulating any combination of three parameters of limb kinematics: the frequency of stepping, the length of steps, and the direction of steps. We therefore sought to determine which of these parameters are modulated during turning. To exclude the effect of forward speed modulation on these parameters, we restricted our analysis to forward speeds between 15 and 20 mm/s, the range with the greatest quantity of turning data.</p><p>On average, the swing durations of the inside mid- and hind-limbs decrease as a function of turning rate, while their stance durations increase (<xref ref-type="fig" rid="fig6">Figure 6A–B</xref>). The swing and stance durations of the remaining limbs are oppositely modulated (<xref ref-type="fig" rid="fig6">Figure 6A–B</xref>). At the highest yaw rates, the net modulation of stepping frequency is about 25%. The step length of the inside forelimb is not significantly modulated during turning (<xref ref-type="fig" rid="fig6">Figure 6C</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). The step lengths of the outside limbs increase with yaw rate while step lengths of the inside midlimb and hindlimb decrease with increasing turning rate. Overall, the observed limb-specific modulations of step frequency and step length are consistent with reports in other hexapods (<xref ref-type="bibr" rid="bib46">Franklin et al., 1981</xref>; <xref ref-type="bibr" rid="bib47">Frantsevich and Mokrushov, 1980</xref>; <xref ref-type="bibr" rid="bib53">Graham, 1972</xref>; <xref ref-type="bibr" rid="bib56">Gruhn et al., 2016</xref>; <xref ref-type="bibr" rid="bib61">Jindrich and Full, 1999</xref>; <xref ref-type="bibr" rid="bib101">Strauß and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib112">Zollikofer, 1994</xref>; <xref ref-type="bibr" rid="bib113">Zolotov et al., 1975</xref>).</p><fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.023</object-id><label>Figure 6.</label><caption><title>Asymmetric, segment-specific modulations of limb movement underlie turning.</title><p>Error patches show 95% confidence intervals of the mean obtained from bootstrap distributions over experiments (N = 8 videos; see Materials and methods). (<bold>A</bold>) Modulation of swing duration in individual limbs relative to straight walking as a function of symmetrized yaw velocity. <italic>Red</italic>, <italic>blue</italic> and <italic>green</italic> indicate the outside fore-, mid-, and hindlimbs respectively. <italic>Orange</italic>, <italic>yellow</italic> and <italic>brown</italic> indicate the inside fore-, mid-, and hindlimbs respectively. To exclude the effect of forward speed modulation on limb movement parameters, the analysis is restricted to forward velocities between 15 and 20 mm/s. The swing durations of the inside mid- and hindlimbs decrease with increasing yaw rate while those of the remaining limbs increase slightly with yaw rate. (<bold>B</bold>) As in (<bold>A</bold>), but for stance duration. The stance durations of the inside mid- and hindlimbs increase with increasing yaw rate while those of the remaining limbs decrease with yaw rate. (<bold>C</bold>) As in (<bold>A</bold>), but for step length. The step lengths of the outside limbs increase with yaw rate, while those of the inside mid- and hindlimbs decrease with yaw rate and that of the inside forelimb is barely modulated. (<bold>D</bold>) As in (<bold>A</bold>), but for step direction. The direction of steps in the inside and outside forelimbs is shifted such that their movements are directed outwards relative to the curvature of its path.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.46409.024</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Average modulations of limb movement parameters.</title><p>Error patches show 95% confidence intervals of the mean obtained from bootstrap distributions over experiments (N = 8 videos; see Materials and methods). (<bold>A</bold>) Average swing duration in individual limbs conditioned on symmetrized yaw velocity. <italic>Red</italic>, <italic>blue</italic> and <italic>green</italic> indicate the outside fore-, mid-, and hindlimbs respectively. <italic>Orange</italic>, <italic>yellow</italic> and <italic>brown</italic> indicate the inside fore-, mid-, and hindlimbs respectively. (<bold>B</bold>) As in (<bold>A</bold>), but conditioned on forward velocity. (<bold>C</bold>) As in (<bold>A</bold>), but for stance duration. (<bold>D</bold>) As in (<bold>C</bold>), but conditioned on forward velocity. (<bold>E</bold>) As in (<bold>A</bold>), but for step length. (<bold>F</bold>) As in (<bold>E</bold>), but conditioned on forward velocity. (<bold>G</bold>) As in (<bold>A</bold>), but for step direction. (<bold>H</bold>) As in (<bold>G</bold>), but conditioned on forward velocity.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig6-figsupp1-v1.tif"/></fig></fig-group><p>The remaining kinematic parameter is the direction of limb movement during stance, which can also change the total path traversed by each limb (<xref ref-type="fig" rid="fig6">Figure 6D</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>).</p><p>Our measurements of the two forelimbs show nearly identical modulations of stepping frequency and modest differences in step length modulations. The remaining path length differential between forelimbs is achieved through modulation of the stance direction of the inside forelimb, which is modulated more dramatically than that of other limbs, by up to about 45°. This suggests that the fly achieves the required difference in forelimb path length by directing forelimb motions away from, rather than along, its path. This is consistent with measurements in cockroaches (<xref ref-type="bibr" rid="bib61">Jindrich and Full, 1999</xref>; <xref ref-type="bibr" rid="bib81">Mu and Ritzmann, 2005</xref>) and in tethered stick insects (<xref ref-type="bibr" rid="bib55">Gruhn et al., 2009</xref>). Thus, unlike forward walking speed changes, which are dominated by global modulations of a single parameter, turns are achieved through asymmetric and limb-specific modulations of multiple parameters of limb movement.</p></sec><sec id="s2-12"><title>Turns are aligned to preferred phases of the limb oscillator</title><p>Next, we sought to understand whether symmetric and asymmetric patterns of limb movement are coupled. In particular, we examined whether flies execute turns at all phases of their walking pattern or if turns occur at particular limb configurations. To visualize the gross placement of limbs during turning, we estimated the spatial distributions of limb positions over all walking behaviors (<xref ref-type="fig" rid="fig7">Figure 7A</xref>) and at yaw rate extrema (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). These distributions demonstrate that turns occur at a preferred spatial configuration of the walking oscillator. To understand how turns are timed relative to the underlying straight-walking coordination pattern, we examined the distributions of the instantaneous phases of each of the limbs at yaw rate extrema (see Materials and methods). Turns were preferentially aligned to a particular phase for each leg, which corresponds to a preferred phase of the walking oscillator (<xref ref-type="fig" rid="fig7">Figure 7C–D</xref>). In particular, there exists a statistically significant difference between the distributions of phases for all timepoints and for yaw extrema (p&lt;10<sup>−5</sup> for all limbs, see Materials and methods, <xref ref-type="table" rid="table4">Table 4</xref>). Thus, turns consist of precisely-timed modulations of the underlying walking coordination pattern, which couple the asymmetric variability to the symmetric coordination patterns.</p><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.025</object-id><label>Figure 7.</label><caption><title>Spontaneous turns are aligned to preferred phases of the limb oscillator.</title><p>Error patches show 95% confidence intervals obtained from bootstrap distributions over experiments (N = 8 videos; see Materials and methods). (<bold>A</bold>) Probability density function of limb positions in the egocentric frame of the fly over all walking behaviors. (<bold>B</bold>) As in (<bold>A</bold>), but at yaw rate extrema. The tripod containing the inside forelimb is in nearly its most posterior position, while the tripod containing the outside forelimb is in nearly its most anterior position. (<bold>C</bold>) Circular probability density functions of the instantaneous phases of each limb over all walking behaviors. Phases between ½ and 1, corresponding to stance phase, are more probable than phases between 0 and ½, corresponding to swing phase, due to the fact that the duration of stance phase is on average greater than that during swing phase. (<bold>D</bold>) As in (<bold>C</bold>), but at yaw rate extrema. There exists a preferred phase of each limb at which yaw rate extrema occur, which differs significantly from the corresponding time-invariant distribution (see Materials and methods).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig7-v1.tif"/></fig></sec><sec id="s2-13"><title>Perturbations of forward walking speed modulate stance duration</title><p>In the analyses presented so far, we have characterized the structure of variability in spontaneous walking behavior. We next sought to test whether the structure of evoked behavior was similar to spontaneous behavior. Our experiments and model both suggest that stance duration controls forward walking speed during spontaneous behavior in <italic>Drosophila</italic>. Since flies also transiently modulate their walking speed in response to stimuli, we wondered whether this transient modulation was along the same dimension as the spontaneous behavior. For instance, while spontaneous walking speed is regulated primarily by stance duration, transient modulations of walking speed could instead be modulated by changing the step length, swing duration, or both. To investigate these possibilities, we generated transient slowing in walking flies both by directly activating a set of command neurons and by presenting visual stimuli that induced slowing.</p><p>Previous work identified a set of command neurons in a pathway named moonwalker, which regulates the speed and direction of walking (<xref ref-type="bibr" rid="bib14">Bidaye et al., 2014</xref>). When these neurons are tonically activated, the fly walks backwards. We expressed Chrimson in these neurons and then stimulated freely-walking flies with 8 ms pulses of red light (see Materials and methods, <xref ref-type="table" rid="table1">Table 1</xref>) (<xref ref-type="bibr" rid="bib65">Klapoetke et al., 2014</xref>). Short-timescale activation of moonwalker neurons caused a transient reduction in forward walking speed that lasted ~100 ms (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). This slowing is consistent with the suppression of forward walking elicited by activating a subset of the moonwalker neurons (<xref ref-type="bibr" rid="bib14">Bidaye et al., 2014</xref>). This reduction in forward walking speed was accompanied by a transient increase in stance duration, the control parameter for speed regulation in our coordination model (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). In individual trials, all limbs increased their stance duration over hundreds of milliseconds in response to the brief neural activation (<xref ref-type="fig" rid="fig8">Figure 8C</xref>). When visualized using UMAP, moonwalker activation corresponded to a deflection along the stepping frequency dimension of the manifold, consistent with a modulation of stance duration (<xref ref-type="fig" rid="fig8">Figure 8D</xref>). Thus, symmetrically activating a small subset of command neurons shifts the fly’s limb coordination along the same manifold as spontaneous symmetric variation.</p><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.027</object-id><label>Figure 8.</label><caption><title>Experimental perturbations of walking speed modulate stance duration.</title><p>(<bold>A</bold>) <italic>Drosophila</italic> normalized forward speed over time in response to 8 ms optogenetic activation of moonwalker neurons (<italic>red</italic>, n = 82) versus random trigger control (<italic>blue</italic>, n = 91). (<bold>B</bold>) Cumulative distribution function of first stance duration post perturbation for all limbs for moonwalker manipulation (<italic>red</italic>, n = 492) versus random trigger control (<italic>blue</italic>, n = 546). Includes stance durations from all six limbs. Distributions are significantly different as measured by a two-sample Kolmogorov-Smirnov test (N = 91, 82; p&lt;0.05; D = 0.1965). (<bold>C</bold>) Single trial of walking over time in response to moonwalker activation. Forward walking speed (<italic>blue</italic>) over time. Limb positions in the direction parallel to the fly’s body axis over time. Step plot for the fly over time with swing (<italic>black</italic>) and stance (<italic>white</italic>) in each of the limbs. Post manipulation, stance duration increases in all limbs. (<bold>D</bold>) The trajectory of a single trial in the UMAP embedding space shows that moonwalker activation induces shifts along the length of the manifold. The time relative to activation onset at the center of each embedded trajectory is indicated by color, with <italic>dark blue</italic> corresponding to times before onset (<inline-formula><mml:math id="inf19"><mml:mo>-</mml:mo><mml:mn>200</mml:mn><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> ms), <italic>green</italic> corresponding to the onset of activation (<inline-formula><mml:math id="inf20"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> ms), and <italic>dark red</italic> corresponding to times after activation (<inline-formula><mml:math id="inf21"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>200</mml:mn></mml:math></inline-formula> ms). (<bold>E</bold>) <italic>Drosophila</italic> normalized forward speed over time in response to 50 ms translation of random dot stimuli moving at 720, 960, or 1440 <sup>o</sup>/s (<italic>red</italic>, n = 59) versus random trigger control (<italic>blue</italic>, n = 97). (<bold>F</bold>) Cumulative distribution function of first stance duration post perturbation for all limbs for visual stimulus manipulation (<italic>red</italic>, n = 354) versus random trigger control (<italic>blue</italic>, n = 582). Includes stance durations from all six limbs. Distributions are significantly different as measured by a two-sample Kolmogorov-Smirnov test (N = 97, 59; p&lt;0.05; D = 0.2834). (<bold>G</bold>) As in (<bold>C</bold>), but for visual stimulation. (<bold>H</bold>) As in (<bold>D</bold>), but for visual stimulation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-fig8-v1.tif"/></fig><p>Last, we sought to test whether more naturalistic slowing commands also modulate stance duration. Previous studies in tethered and freely-walking flies have shown that a variety of visual stimuli evoke slowing (<xref ref-type="bibr" rid="bib29">Creamer et al., 2018</xref>; <xref ref-type="bibr" rid="bib64">Katsov and Clandinin, 2008</xref>; <xref ref-type="bibr" rid="bib96">Silies et al., 2013</xref>). We presented rigidly translating random dot patterns above freely-walking flies. In response to this visual stimulus, flies slowed transiently, consistent with previous studies (<xref ref-type="fig" rid="fig8">Figure 8E</xref>). As with the moonwalker manipulation, visual stimulation produced a transient increase in stance durations (<xref ref-type="fig" rid="fig8">Figure 8F–G</xref>). The visual stimulus-based perturbations also induced shifts along the frequency dimension of the UMAP manifold, corresponding to the change in stance duration (<xref ref-type="fig" rid="fig8">Figure 8H</xref>). Therefore, slowing evoked by visual stimuli generated transient changes along the same manifold as the spontaneous symmetric modulations that control walking speed.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we comprehensively characterized the variability in <italic>Drosophila</italic> limb coordination during spontaneous walking behaviors. To fully sample the space of limb coordination patterns, we developed an automated method for video annotation (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We investigated the distribution of limb coordination patterns across forward walking speeds in freely-moving flies (<xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig3">3</xref>). Our experimental data lie on a single manifold, consistent with a continuum of coordination patterns (<xref ref-type="fig" rid="fig4">Figure 4</xref>). A simple model with fixed coupling could reproduce the observed symmetric patterns of walking at a wide range of speeds by varying only stance duration (<xref ref-type="fig" rid="fig5">Figure 5</xref>). In contrast, asymmetric variability associated with turning is characterized by small, precisely-timed, and limb-specific modulations of this underlying straight-walking coordination pattern (<xref ref-type="fig" rid="fig6">Figures 6</xref> and <xref ref-type="fig" rid="fig7">7</xref>). Evoked changes in walking speed generated changes in limb coordination similar to the structure of spontaneous modulations in walking speed (<xref ref-type="fig" rid="fig8">Figure 8</xref>).</p><sec id="s3-1"><title>A single continuum of leg coordination patterns suggests a simple neural control circuit</title><p>A variety of computational models have been developed to describe patterns of hexapod locomotion (<xref ref-type="bibr" rid="bib6">Aminzare and Holmes, 2018</xref>; <xref ref-type="bibr" rid="bib5">Aminzare et al., 2018</xref>; <xref ref-type="bibr" rid="bib26">Collins and Stewart, 1993</xref>; <xref ref-type="bibr" rid="bib27">Collins and Stewart, 1994</xref>; <xref ref-type="bibr" rid="bib31">Cruse, 1979</xref>; <xref ref-type="bibr" rid="bib32">Cruse, 1980</xref>; <xref ref-type="bibr" rid="bib33">Cruse, 1990</xref>; <xref ref-type="bibr" rid="bib34">Cruse et al., 1995</xref>; <xref ref-type="bibr" rid="bib38">Delcomyn, 1999</xref>; <xref ref-type="bibr" rid="bib54">Graham, 1977</xref>; <xref ref-type="bibr" rid="bib59">Ijspeert, 2008</xref>). A central component of these models is the nature of inter-limb coupling, which in turn determines the predicted limb coordination patterns. Our simple model suggests that one might expect to find mutual inhibitory coupling between contralateral neuropil of the ventral nerve cord (VNC) and posterior to anterior inhibitory coupling between ipsilateral neuropil. Importantly, neither contralateral nor ipsilateral couplings need vary with walking speed. If a single continuum can describe fly walking, then models of the circuit controlling walking may be made substantially simpler, since they need not account for multiple distinct coordination patterns. Instead, a simpler control circuit need only be able to vary stance duration while maintaining ipsilateral and contralateral coupling. This suggests the intriguing possibility that walking <italic>Drosophila</italic> may use a qualitatively different locomotor control circuit than previously studied animals in which distinct gaits have been observed (<xref ref-type="bibr" rid="bib2">Alexander, 1989</xref>; <xref ref-type="bibr" rid="bib3">Alexander and Jayes, 1980</xref>; <xref ref-type="bibr" rid="bib4">Alexander and Jayes, 1983</xref>; <xref ref-type="bibr" rid="bib19">Brett and Sutherland, 1965</xref>; <xref ref-type="bibr" rid="bib91">Rayner et al., 1986</xref>; <xref ref-type="bibr" rid="bib100">Srinivasan and Ruina, 2006</xref>).</p><p>With a simple, one-parameter model, we recapitulated several major elements of the symmetric variability in spontaneous walking (<xref ref-type="fig" rid="fig5">Figure 5</xref>). However, there were aspects of our experimental data that were not captured by our simple model. Though the ipsilateral relative phases exhibited qualitatively similar speed-dependent shifts, the magnitude of these shifts is larger in our model than in our data, with greater deviations at slow forward walking speeds. There are several potential explanations for this larger range. First, our experimental data included turning, which our model does not consider. Second, the relative timing of ipsilateral swings was less variable in our model than in our experimental data. Third, each swing event in the model was of constant duration while our experimentally-measured swings were more variable in duration overall and shorter on average at slow forward walking speeds. Taken together, these differences may account for the deviations in ipsilateral phasing. These differences do not diminish the utility of this simple model, since its purpose is to illustrate the sufficiency of a single set of couplings to describe the symmetric variability in spontaneous limb coordination.</p></sec><sec id="s3-2"><title>Optimality and expected gait transitions</title><p>Prior studies have suggested that the inter-limb coordination patterns used by insects reflect an optimization against physical constraints (<xref ref-type="bibr" rid="bib84">Nishii, 2000</xref>; <xref ref-type="bibr" rid="bib102">Szczecinski et al., 2018</xref>). Theoretical work has suggested that continua of coordination patterns, like those identified here in <italic>Drosophila</italic>, minimize the energetic cost of transport when ground reaction forces are balanced across limbs (<xref ref-type="bibr" rid="bib84">Nishii, 2000</xref>). In contrast, distinct gaits are optimal when non-uniform ground reaction forces are necessary to balance the body (<xref ref-type="bibr" rid="bib84">Nishii, 2000</xref>). The magnitude and robustness of mechanical stability during walking may also influence the presence or absence of distinct gaits (<xref ref-type="bibr" rid="bib102">Szczecinski et al., 2018</xref>). In addition to these mechanical considerations, we suggest that the simple control of the observed continuum of coordination patterns might make it preferable in animals with small circuits for controlling limbs.</p></sec><sec id="s3-3"><title>Turning limb kinematics represent small modifications of straight walking</title><p>The asymmetric variability in limb kinematics associated with turning represents a minor modification of the coordination patterns used during forward walking, with ~25% modulations of limb movement parameters at the highest yaw rates. Detailed neuromechanical and phase-reduced models in cockroaches (<xref ref-type="bibr" rid="bib70">Kukillaya and Holmes, 2009</xref>; <xref ref-type="bibr" rid="bib69">Kukillaya et al., 2009</xref>; <xref ref-type="bibr" rid="bib90">Proctor and Holmes, 2018</xref>; <xref ref-type="bibr" rid="bib88">Proctor et al., 2010</xref>) and simplified bipedal models (<xref ref-type="bibr" rid="bib89">Proctor and Holmes, 2008</xref>) have shown that ~20% modulations in forelimb placement parameters can generate 90° degree turns within three strides. These theoretical findings are consistent with experimental results in cockroaches, which show that limb kinematics and dynamics during turning represent a minor modification of the symmetric coordination pattern (<xref ref-type="bibr" rid="bib61">Jindrich and Full, 1999</xref>). The small magnitude of these modulations suggests a conceptual parallel between turning during walking and during flight. In flying <italic>Drosophila</italic>, detailed kinematic and dynamical measurements and modeling have shown that yaw is regulated through small modulations of wing rotation angle while gross wingbeat movements remain mostly unaffected (<xref ref-type="bibr" rid="bib39">Dickinson and Muijres, 2016</xref>; <xref ref-type="bibr" rid="bib48">Fry et al., 2003</xref>; <xref ref-type="bibr" rid="bib73">Lindsay et al., 2017</xref>; <xref ref-type="bibr" rid="bib82">Muijres et al., 2015</xref>).</p></sec><sec id="s3-4"><title>Distinct control mechanisms imply distinct circuit bases for yaw and speed regulation</title><p>Mechanically, turning could be achieved through asymmetric modulations of limb movement that do not affect the coordination between ipsilateral limbs (<xref ref-type="bibr" rid="bib89">Proctor and Holmes, 2008</xref>). In this case, the command signals regulating turning could be unilateral but not segment-specific. However, swing duration, stance duration, step length, and step direction are all modulated on an individual-limb basis during turning. This suggests that the motor output of individual limbs in freely-walking flies is regulated during turning at the hemi-segmental level by control signals, a conclusion which is consistent with electrophysiological measurements and pharmacological manipulations in dissected stick insects (<xref ref-type="bibr" rid="bib56">Gruhn et al., 2016</xref>). In contrast to the limb-specific modulation of many kinematic degrees of freedom during turning, forward speed changes are associated primarily with modulations in stance duration that are comparable across all limbs (<xref ref-type="fig" rid="fig6">Figure 6</xref>). The fact that limb movements are modulated along different dimensions for yaw and speed control suggests differentiation between the circuit bases of symmetric and asymmetric variability beyond the simple requirement of asymmetric limb movement in turning. However, as turns are precisely timed relative to the walking coordination pattern (<xref ref-type="fig" rid="fig7">Figure 7</xref>), the control of these symmetric and asymmetric modulations must be neurally or mechanically coupled.</p></sec><sec id="s3-5"><title>Differentiated roles for the posterior and anterior neuropils of the VNC</title><p>Our detailed characterization of walking suggests that, surprisingly, the observed complexity in symmetric interlimb coordination can be reproduced with fixed, unidirectional posterior-to-anterior coupling between limbs. This model implies that the most posterior of the limb neuropils could have a differentiated role in walking speed regulation, as swing events originate in these posterior segments. Anatomical evidence supports this differentiated role. In particular, the moonwalker ascending neurons receive dendritic input almost exclusively from the metathoracic neuromere, with axons projecting to more anterior neuropils in the thorax and to the subesophageal ganglion (<xref ref-type="bibr" rid="bib14">Bidaye et al., 2014</xref>). Their activation causes the fly to slow its walking (<xref ref-type="bibr" rid="bib14">Bidaye et al., 2014</xref>), and they appear most active when all six limbs are in stance phase (<xref ref-type="bibr" rid="bib24">Chen et al., 2018</xref>). In contrast, our kinematic measurements suggest that the forelimbs, and thus the anterior neuropil, play a distinct role in spontaneous turning, a result consistent with dynamical measurements in cockroaches (<xref ref-type="bibr" rid="bib61">Jindrich and Full, 1999</xref>). Symmetry arguments suggest that walking speed and turning must be regulated through different coordinated patterns of neural activity. The difference in the roles of anterior and posterior neuropils in the two locomotor behaviors supports a hypothesis that these behaviors employ distinct circuitry.</p></sec><sec id="s3-6"><title>Separation of action selection and motor implementation in insects</title><p>Despite the phasic relationships between limbs during locomotion and grooming, a variety of studies have demonstrated that tonic activation of descending neurons (DNs) suffices to generate complex, structured motor patterns in the fruit fly (<xref ref-type="bibr" rid="bib14">Bidaye et al., 2014</xref>; <xref ref-type="bibr" rid="bib22">Cande et al., 2018</xref>; <xref ref-type="bibr" rid="bib95">Seeds et al., 2014</xref>). Interestingly, previous electrophysiological recordings in orthopteran insects showed that neurons projecting from the insect brain to the thoracic ganglia are tonically active in all regions except for those emanating from the subesophageal ganglion (<xref ref-type="bibr" rid="bib57">Heinrich, 2002</xref>). This organization suggests that the control of motor behaviors in insects physically segregates action selection and the low-level implementation of motor behaviors into the brain and VNC respectively. The manifold structure of limb coordination is compatible with tonic descending inputs that modulate limb movements, while local circuits in the VNC coordinate limbs.</p><p>These experiments have shown that variability in walking coordination patterns exists on a continuous manifold. In <italic>Drosophila</italic>, explorations of VNC circuits are increasingly made possible by automated behavioral tracking (<xref ref-type="bibr" rid="bib18">Branson et al., 2009</xref>; <xref ref-type="bibr" rid="bib78">Mathis et al., 2018</xref>; <xref ref-type="bibr" rid="bib87">Pereira et al., 2019</xref>; <xref ref-type="bibr" rid="bib109">Williamson et al., 2018</xref>), by preparations to visualize neural activity in the VNC (<xref ref-type="bibr" rid="bib24">Chen et al., 2018</xref>; <xref ref-type="bibr" rid="bib105">Tuthill and Wilson, 2016</xref>), and by genetic tools to target neurons in the VNC (<xref ref-type="bibr" rid="bib22">Cande et al., 2018</xref>; <xref ref-type="bibr" rid="bib75">Mamiya et al., 2018</xref>; <xref ref-type="bibr" rid="bib83">Namiki et al., 2018</xref>) and to manipulate neural activity (<xref ref-type="bibr" rid="bib74">Luo et al., 2018</xref>). The manifold structure of limb coordination in <italic>Drosophila</italic> provides a framework for dissecting the circuits that regulate walking.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Fly strains and husbandry</title><p>Female <italic>Drosophila melanogaster</italic> used in experiments were grown at 25°C on a 12 hr/12 hr light/dark cycle. Wild-type flies were staged on CO<sub>2 </sub>12–24 hr after eclosion, and run after 24 hr of staging. Flies used in optogenetic experiments were grown at 25°C and staged 12–24 hr after eclosion on CO<sub>2</sub>. When staged, flies used in optogenetic experiments were transferred to food supplemented with all-trans-retinal (ATR) following previous protocols (<xref ref-type="bibr" rid="bib36">de Vries and Clandinin, 2013</xref>). Flies remained on ATR-supplemented food for 4 days prior to behavioral experiments. In all cases, flies were grown at near 50% relative humidity, and experiments were performed at 50% relative humidity.</p></sec><sec id="s4-2"><title>Experimental setup</title><p>Behavioral experiments were performed in an illuminated 5 cm diameter circular planar arena consisting of two plates of glass separated by 2.5 mm. The top glass plate was coated with Rain-X (wax) to prevent flies from walking on this surface during experiments. Above the arena, we mounted a diffusing screen and a 530 nm green Luxeon SP-01-G4 LED (Quadica Developments Inc, Lethbridge, AB, Canada) that provided background illumination for the arena (~1 µW/mm<sup>2</sup>). Flies were recorded from below at 150 fps using a Point Grey Flea3 FL3-U3-13Y3M-C camera (FLIR Systems, Wilsonville, OR). The camera was positioned such that its field of view (2.2 × 2.75 cm) was approximately centered within the fly arena. All experiments were performed at 34°C to increase the frequency of fly walking (<xref ref-type="bibr" rid="bib98">Soto-Padilla et al., 2018</xref>).</p><p>During walking experiments, groups of 12–15 female flies were loaded into the arena. We allowed the flies to acclimate to the arena for 20 min prior to image acquisition. We then recorded the spontaneous activity of flies in the arena for 1.1 hr. Data from eight separate recordings, with a total of 114 flies, were merged to generate the aggregate wild type, free-walking dataset analyzed in this manuscript.</p></sec><sec id="s4-3"><title>Feature extraction</title><p>To track freely-walking flies in an open arena, we decomposed the tracking process into distinct steps of centroid and footfall tracking. Our body tracking method relies on the roughly stereotyped size of fruit flies. To track the body, we binarized camera frames to separate out the darker fly pixels from the lighter background pixels. In this binarized camera frame, we identified body ellipsoids restricting our analysis to regions with roughly the correct area and eccentricity (<xref ref-type="bibr" rid="bib16">Bradski, 2000</xref>). After aligning these ellipsoids, we then extracted stereotyped images of individual flies oriented such that the fly was aligned across all frames. We smoothed estimates of velocities by zero-phase filtering with a Gaussian kernel with a standard deviation of 20 ms (three frames), which eliminated this oscillation (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>) (<xref ref-type="bibr" rid="bib64">Katsov and Clandinin, 2008</xref>; <xref ref-type="bibr" rid="bib63">Katsov et al., 2017</xref>). Due to the height of the arena and the temporal resolution of our camera, we were, in most circumstances, able to distinguish individual flies, even when they were in close proximity. To end trajectories when fly bodies touched and became difficult to distinguish with our algorithm, we included a threshold on the maximum ellipsoid size.</p><p>Footfall tracking was performed using linear regression. To train our footfall prediction model, we manually labeled 5,000 randomly sampled oriented fly frames output by our body tracking algorithm. Exploiting the bilateral symmetry of the fly, we augmented our training data by appending the mirror symmetric images and corresponding manual labels. We used principal component analysis to reduce the dimensionality of the image space from the full number of pixels (19,881) to 1000 (<xref ref-type="bibr" rid="bib104">Turk and Pentland, 1991</xref>). This reduction in the number of model parameters was important because we wished to train our model with a limited set of hand-annotated frames. We then trained 12 separate linear regression models to independently predict each footfall location variable (<xref ref-type="bibr" rid="bib85">Pedregosa et al., 2011</xref>). To ensure that correlations between the positions of limbs did not influence the predictions made for an individual limb, we masked input variables to exclude portions of the image outside of the target limb’s range of motion prior to training (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). We fit our model with 5000 frames of annotated data, and used 10-fold cross-validation to test for overfitting. This showed that the mean Euclidean distance between predicted and hand annotated limb positions was 0.15 mm (3.5 pixels), or about 10% of stride length (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). This error distance is comparable to that reported for distal limb positions by published deep neural network methods for pose estimation (<xref ref-type="bibr" rid="bib78">Mathis et al., 2018</xref>; <xref ref-type="bibr" rid="bib87">Pereira et al., 2019</xref>).</p></sec><sec id="s4-4"><title>Fit of functional relationship between forward velocity and stance duration (<xref ref-type="fig" rid="fig1">Figure 1</xref>)</title><p>To compare our measurements of the relationship between forward velocity and stance duration with previous studies (<xref ref-type="bibr" rid="bib80">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib102">Szczecinski et al., 2018</xref>; <xref ref-type="bibr" rid="bib111">Wosnitza et al., 2013</xref>), we fit a power law of the form:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf22"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>mm/s is a fixed scaling factor used to nondimensionalize the velocity (hence <inline-formula><mml:math id="inf23"><mml:mi>a</mml:mi></mml:math></inline-formula> has units of milliseconds). We fit this power law using the nonlinear least-squares solver built into MATLAB in the fit function, giving <inline-formula><mml:math id="inf24"><mml:mi>a</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mn>932.8</mml:mn></mml:math></inline-formula> ms and <inline-formula><mml:math id="inf25"><mml:mi>b</mml:mi></mml:math></inline-formula>= –1.025 with a coefficient of determination of <inline-formula><mml:math id="inf26"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.59</mml:mn></mml:math></inline-formula>.</p></sec><sec id="s4-5"><title>Swing and stance determination (<xref ref-type="fig" rid="fig1">Figures 1</xref>–<xref ref-type="fig" rid="fig4">4</xref>, <xref ref-type="fig" rid="fig6">6</xref> and <xref ref-type="fig" rid="fig8">8</xref>)</title><p>Movement in the camera frame was used to determine swing and stance in each of the six limbs. Frames were categorized as stance if the smoothed instantaneous velocity of the limb was less than 20 mm/s (3.1 pixels per frame), approximately matching our error in positional measurement. Frames above this threshold were categorized as swing. Smoothing of limb velocities was performed using a five-frame moving average filter. Both thresholds were chosen manually in order to give a reasonable representation in the presence of limb position noise.</p></sec><sec id="s4-6"><title>Estimation of limb oscillator phase (<xref ref-type="fig" rid="fig2">Figures 2</xref>, <xref ref-type="fig" rid="fig3">3</xref>, <xref ref-type="fig" rid="fig5">5</xref> and <xref ref-type="fig" rid="fig7">7</xref>)</title><p>To estimate the phases of the limbs, we used the discrete-time analytic signal method. Briefly, this method uses the Hilbert transform to construct the harmonic conjugate of a real-valued signal, and then estimates the phase as the argument of the resulting complex-analytic function. In continuous time, the Hilbert transform of a real signal <inline-formula><mml:math id="inf27"><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is related to the Fourier transform as<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>H</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="fraktur">F</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="fraktur"> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="fraktur">F</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>which allows it to be defined in discrete-time by replacing the continuous-time Fourier transform by its discrete-time analog. Using the Hilbert transform, one may define the analytic signal as:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mi>H</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>From the analytic signal, the instantaneous phase is defined as<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mi>arg</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where the argument function is defined such that the instantaneous phase is a continuous function of time (<xref ref-type="bibr" rid="bib106">Vakman and Vaĭnshteĭn, 1977</xref>; <xref ref-type="bibr" rid="bib15">Boashash and Reilly, 1992</xref>; <xref ref-type="bibr" rid="bib49">Gabor, 1946</xref>). We computed the analytic representations of the positions of each limb in the direction parallel to the fly’s body axis using the <italic>hilbert</italic> function in Matlab (Mathworks, Natick, MA, USA). This function implements the fast-Fourier-transform-based algorithm introduced in <xref ref-type="bibr" rid="bib76">Marple (1999)</xref>. The zero-point of the resulting phase estimate corresponds to the maximally posterior point of the limb cycle. The discrete-time analytic signal method was previously used to estimate the phases of cockroach limb oscillations (<xref ref-type="bibr" rid="bib28">Couzin-Fuchs et al., 2015</xref>), where it was shown that this method produced comparable results to the phase estimation algorithm introduced in <xref ref-type="bibr" rid="bib92">Revzen and Guckenheimer (2008)</xref>. We smoothed the resulting phase estimates using a third-order Savitzky-Golay smoothing filter with a window length of 15 frames, and estimated instantaneous frequencies using a corresponding differentiating filter (<xref ref-type="bibr" rid="bib94">Savitzky and Golay, 1964</xref>). To calculate the relative phase differences between limbs, instantaneous phase measurements were subtracted from each other at each frame and expressed in fractions of a limb cycle.</p></sec><sec id="s4-7"><title>Coherence analyses (<xref ref-type="fig" rid="fig3">Figure 3</xref>)</title><p>To measure how well our data matched the configurations of relative limb phasing specified by each of the canonical gaits, we defined a metric of coherence based upon the Kuramoto model for networks of coupled oscillators (<xref ref-type="bibr" rid="bib1">Acebrón et al., 2005</xref>). For each canonical gait, we defined a template of relative phases <inline-formula><mml:math id="inf28"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>. The template phases for each canonical gait are listed in <xref ref-type="table" rid="table2">Table 2</xref>. Then, given the set of instantaneous phases of the six limbs <inline-formula><mml:math id="inf29"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> we defined for each template pattern the global phase <inline-formula><mml:math id="inf30"><mml:mi mathvariant="normal">Φ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and coherence <inline-formula><mml:math id="inf31"><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> by the relation<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:munderover><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><table-wrap id="table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.029</object-id><label>Table 2.</label><caption><title>Phase templates for canonical gait coherence analysis (<xref ref-type="bibr" rid="bib26">Collins and Stewart, 1993</xref>).</title><p>Limb ordering is (L1, L2, L3, R1, R2, R3).</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Canonical gait</th><th valign="top">Phase template (cycles)</th></tr></thead><tbody><tr><td valign="top">Tripod</td><td valign="top">[0, 1/2, 0, 1/2, 0, 1/2]</td></tr><tr><td valign="top">Left tetrapod</td><td valign="top">[1/3, 2/3, 0, 0, 1/3, 2/3]</td></tr><tr><td valign="top">Right tetrapod</td><td valign="top">[2/3, 0, 1/3, 0, 1/3, 2/3]</td></tr><tr><td valign="top">Wave</td><td valign="top">[1/6, 1/3, 1/2, 2/3, 5/6, 0]</td></tr></tbody></table></table-wrap><p>which corresponds exactly to the definition of the order parameters of the Kuramoto model with the addition of the phase template. The resulting coherence <inline-formula><mml:math id="inf32"><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> ranges from a value of zero for asynchrony to a value of one for perfect alignment with the phase template.</p></sec><sec id="s4-8"><title>Dimensionality reduction with UMAP (<xref ref-type="fig" rid="fig4">Figures 4</xref>, <xref ref-type="fig" rid="fig5">5</xref> and <xref ref-type="fig" rid="fig8">8</xref>)</title><p>To generate low-dimensional representations of our data, we applied the nonlinear dimensionality reduction algorithm UMAP (<xref ref-type="bibr" rid="bib79">McInnes et al., 2018</xref>). Using UMAP, we generated low-dimensional representations of 10<sup>5</sup> randomly sampled segments of limb positional data, each with a half-window length of 100 ms. Given our sampling rate of 150 frames per second, each segment was thus an element of a 372-dimensional vector space. Before embedding, each time series was mean-subtracted on a per-segment basis, and each timepoint of each variable was standardized across trajectories to have zero mean and unit variance. This standardization does not substantially affect the resulting embedding, since all flies are roughly the same size, with the same mean limb positions. We note also that comparable results may be obtained with segments of length 100 ms or 400 ms rather than 200 ms (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>). In <xref ref-type="fig" rid="fig4">Figure 4B</xref>, we colored the UMAP embedding by mean-subtracted limb position, a raw form of the input data.</p></sec><sec id="s4-9"><title>Synthetic canonical gait data (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>; <xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>)</title><p>To generate synthetic data matching canonical gait patterns, we adapted a model originally designed to generate quadruped gaits (<xref ref-type="bibr" rid="bib93">Righetti and Ijspeert, 2008</xref>). Briefly, this model is composed of six coupled nonlinear oscillators, each with two degrees of freedom. We denote the state of the <italic>i</italic><sup>th</sup> oscillator as <inline-formula><mml:math id="inf33"><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, where <inline-formula><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the position of the limb in the direction parallel to the body axis, and <inline-formula><mml:math id="inf35"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a variable which allows for the incorporation of feedback and defines whether the limb is in swing (<inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) or in stance phase (<inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). In this model, uneven duty ratios are implemented by introducing the state-dependent frequency<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where the stance frequency is given in terms of the swing frequency <inline-formula><mml:math id="inf38"><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the duty factor <inline-formula><mml:math id="inf39"><mml:mi>β</mml:mi></mml:math></inline-formula> as<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mi>β</mml:mi></mml:mfrac><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Then, defining <inline-formula><mml:math id="inf40"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>, the dynamical equations of the model are given as<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf41"><mml:mi>α</mml:mi></mml:math></inline-formula> is a positive parameter governing the strength of self-interactions, <inline-formula><mml:math id="inf42"><mml:mi>μ</mml:mi></mml:math></inline-formula> is a positive parameter governing the radius of the limit cycle, and <inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a coupling matrix. This system of nonlinear ordinary differential equations admits stable limit cycles for a broad range of coupling matrices (<xref ref-type="bibr" rid="bib93">Righetti and Ijspeert, 2008</xref>). By adjusting the coupling matrix and the duty cycle appropriately, this model can produce synthetic limb traces with the duty cycle and phasing of the four canonical gaits. We integrated these equations using Matlab’s <italic>ode45</italic> medium-order adaptive timestep Runge-Kutta integrator. For each canonical gait we generated trajectories with swing durations iid from a uniform distribution corresponding to stepping frequencies between 5 and 12.5 Hz for a tripod gait. To correct for the fact that this model (with the coupling matrices chosen) is time-reversal symmetric, we adjust limb ordering post-hoc to enforce posterior-to-anterior propagation of metachronal waves. Finally, we add white Gaussian noise with a signal-to-noise ratio of 12.5 to the synthetic limb data to model the noise in our experimental data.</p></sec><sec id="s4-10"><title>Numerical modeling (<xref ref-type="fig" rid="fig5">Figure 5</xref>)</title><p>To build a generative model for phase dynamics during straight-walking, we make use of the fact that the cross-body phasing is constant, and first construct a simple rule-based discrete-time algorithm to generate metachronal waves along one side of the body. Following the empirical observation that the swing duration is approximately constant across all forward walking speeds, we fix the swing duration <inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and have as a free parameter the stance duration <inline-formula><mml:math id="inf45"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. As the swing and stance durations are dimensionful quantities, we define a timestep <inline-formula><mml:math id="inf46"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> such that the ratios <inline-formula><mml:math id="inf47"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi> <mml:mi/><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf48"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi> <mml:mi/><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> are dimensionless. We denote the phases of the fore-, mid-, and hind-limbs at timestep <inline-formula><mml:math id="inf49"><mml:mi>t</mml:mi></mml:math></inline-formula> as <inline-formula><mml:math id="inf50"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, <inline-formula><mml:math id="inf51"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, and <inline-formula><mml:math id="inf52"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, respectively. Defining phases modulo <inline-formula><mml:math id="inf53"><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula>, we represent swings by values less than <inline-formula><mml:math id="inf54"><mml:mi>π</mml:mi></mml:math></inline-formula>, and stances by values greater than <inline-formula><mml:math id="inf55"><mml:mi>π</mml:mi></mml:math></inline-formula>. We fix a desired total number of timesteps <inline-formula><mml:math id="inf56"><mml:mi>N</mml:mi></mml:math></inline-formula>, and an initial condition <inline-formula><mml:math id="inf57"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>.</p><p>Since the metachronal waves propagate from the posterior limb to the anterior limb, we model the phase dynamics of the posterior limb as being independent from those of other limbs; at each timestep its phase is simply incremented by <inline-formula><mml:math id="inf58"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi> <mml:mi/><mml:mi>π</mml:mi> <mml:mi/><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> during swing and by <inline-formula><mml:math id="inf59"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi> <mml:mi/><mml:mi>π</mml:mi> <mml:mi/><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> during stance. We now must choose a mechanism to ensure that the forelimb and hindlimb swing after their respective posterior neighbors. A simple means to do this is to reduce the rate of a given limb’s phase advance during swing phase if its anterior neighbor is also in swing phase. We make the arbitrary but simple choice that the rate of phase advance is halved. These choices lead to the feedforward rule-based algorithm to generate the phase dynamics described in pseudocode in <bold>Algorithm 1</bold>. Conceptually, this is similar to classical rule-based algorithms for generating robot limb placement targets (<xref ref-type="bibr" rid="bib108">Wettergreen and Thorpe, 1992</xref>; <xref ref-type="bibr" rid="bib71">Kwak and McGhee, 1989</xref>; <xref ref-type="bibr" rid="bib97">Song and Waldron, 1987</xref>).</p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><tbody><tr valign="top"><td><p><bold>Algorithm 1</bold> Rule-based generation of metachronal waves.</p></td></tr><tr valign="top"><td><bold>Parameters </bold><inline-formula><mml:math id="inf60"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf61"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf62"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf63"><mml:mi>N</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf64"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula></td></tr><tr valign="top"><td><bold>for</bold> <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><bold>do</bold> </td></tr><tr valign="top"><td>            <bold>if</bold> <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>π</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>then</bold></td></tr><tr valign="top"><td>                    <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>π</mml:mi><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td>            <bold>else</bold></td></tr><tr valign="top"><td>                    <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>π</mml:mi><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td>            <bold>end if</bold> </td></tr><tr valign="top"><td>            <bold>if </bold> <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>π</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>and</bold> <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>π</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>then</bold></td></tr><tr valign="top"><td>                    <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>π</mml:mi><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td>            <bold>else if</bold> <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>π</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>then</bold></td></tr><tr valign="top"><td>                    <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>π</mml:mi><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td>            <bold>else</bold></td></tr><tr valign="top"><td>                    <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>π</mml:mi><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td>            <bold>end if</bold> </td></tr><tr valign="top"><td>            <bold>if</bold> <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>π</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>and</bold> <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>π</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>then</bold></td></tr><tr valign="top"><td>                    <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>π</mml:mi><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td>            <bold>else if</bold> <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>π</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>then</bold></td></tr><tr valign="top"><td>                    <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>π</mml:mi><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td>            <bold>else</bold></td></tr><tr valign="top"><td>                    <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>π</mml:mi><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td>            <bold>end if</bold> </td></tr><tr valign="top"><td><bold>end for</bold></td></tr></tbody></table></table-wrap><p>We now note that <bold>Algorithm 1</bold> simply implements a forward Euler method for integrating the following system of ordinary differential equations:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ11"><mml:math id="m11"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></disp-formula><disp-formula id="equ12"><mml:math id="m12"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></disp-formula>where we have implemented the discrete-time rules using indicator functions for swing and stance phase, defined as<disp-formula id="equ13"><label>(11)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>if</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mi>θ</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>π</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>and<disp-formula id="equ14"><label>(12)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>if</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mi>θ</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>π</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>mod</mml:mtext></mml:mrow><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>respectively. As shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>, this simple model suffices to generate metachronal waves that appear qualitatively similar to those observed empirically. We note that this system of piecewise-linear ODEs could be replaced with a system that uses continuous, differentiable approximations for the indicator functions. However, this would introduce additional parameters governing the sharpness of the approximation. As the piecewise-continuous system is well-behaved but for the discontinuities, it may be numerically integrated with satisfactory accuracy using a fixed-step low-order Runge-Kutta method. Therefore, we chose to integrate the discontinuous rule-based model.</p><p>To generate six-legged phase dynamics, we coupled together two such generative models for metachronal waves. Since cross-body antiphase is conserved across forward walking speeds, our model is chiefly concerned with the generation of metachronal waves. The nature of the cross-body coupling is not central to our model; rather, it is a convenience used to generate phase dynamics for all the limbs in a feedforward manner. With this in mind, we chose to enforce cross-body antiphase by adding additional divisive terms depending on the sine of the contralateral phase differences. In doing so, we introduce an additional parameter <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> governing the strength of the cross-body coupling. In <xref ref-type="fig" rid="fig5">Figure 5</xref>, a value of <inline-formula><mml:math id="inf82"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula> was used, though we find empirically that varying the value of <inline-formula><mml:math id="inf83"><mml:mi>α</mml:mi></mml:math></inline-formula> between <inline-formula><mml:math id="inf84"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="inf85"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula> does not produce qualitative changes in the behavior of the model. Then, denoting phases of the left forelimb, left midlimb, left hindlimb, right forelimb, right midlimb, and right hindlimb as <inline-formula><mml:math id="inf86"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> through <inline-formula><mml:math id="inf87"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, respectively, the dynamical equations of the six-limb model are<disp-formula id="equ15"><label>(13)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We integrated this system of ODEs with the parameters given in <xref ref-type="table" rid="table3">Table 3</xref> using Heun’s method, a second-order explicit Runge-Kutta integrator (<xref ref-type="bibr" rid="bib7">Ascher and Petzold, 1998</xref>) with a timestep of 0.025 ms, as it provides a reasonable balance of computational efficiency and numerical stability.</p><table-wrap id="table3" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.031</object-id><label>Table 3.</label><caption><title>Parameters used for model in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Parameter</th><th valign="top">Value</th></tr></thead><tbody><tr><td valign="top"><p><inline-formula><mml:math id="inf88"><mml:mi>α</mml:mi></mml:math></inline-formula></p></td><td valign="top">1/8</td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf89"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></p></td><td valign="top">40 ms</td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf90"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></p></td><td valign="top">40–210 ms</td></tr></tbody></table></table-wrap></sec><sec id="s4-11"><title>Optogenetic manipulations (<xref ref-type="fig" rid="fig8">Figure 8</xref>)</title><p>For optogenetic experiments, we augmented the arena used in free-walking experiments by mounting a DLP Lightcrafter 4500 projector (Texas Instruments, Dallas, TX) below the walking surface. During experiments, flies were loaded into the arena and allowed to acclimate for 20 min prior to recording. For each experiment, 12–15 females were allowed to walk freely within the arena and were recorded from below for 1.1 hr. Throughout the recording, at 4 s intervals, 8 ms full-field flashes of ~ 0.05 mW/mm<sup>2</sup> red light (peak 624 nm) were projected into the arena in order to optogenetically activate moonwalker neurons of the flies. In both experimental and random trigger control conditions, we selected trajectories where the fly was walking &gt; 5 mm/s on average in the 100 ms prior to stimulation. Additionally, in order to exclude stopping flies, we removed trajectories in which the flies’ forward velocity was less than 0.1 mm/s at any point post stimulus. Data from seven separate recordings, with a total of 96 flies, were merged to generate the aggregate dataset analyzed in this manuscript.</p></sec><sec id="s4-12"><title>Visual stimuli (<xref ref-type="fig" rid="fig8">Figure 8</xref>)</title><p>Visual stimuli were designed using Matlab and its associated Psychophysics Toolbox (<xref ref-type="bibr" rid="bib17">Brainard, 1997</xref>; <xref ref-type="bibr" rid="bib66">Kleiner et al., 2007</xref>; <xref ref-type="bibr" rid="bib86">Pelli, 1997</xref>). They were projected onto a virtual flat torus masked with a disk placed on a flat screen 29.5 mm above the free-walking arena using a DLP Lightcrafter projector (Texas Instruments, Dallas, TX). The spatial resolution of the screens was ~ 0.3° and the screen update rate was 180 Hz. All visual stimuli used green light (peak 520 nm) with mean luminance of 100 cd/m<sup>2</sup>. The video data were aligned to the stimulus by presenting periodic flashes measured with a photodiode. All stimuli were presented in 50 ms bouts separated by 950 ms interleaves. The stimulus presented consisted of an array of 15°-diameter white and black circular dots, placed on a mean-grey background at locations iid from a uniform distribution with a density of 10%. Overlap between dots was handled such that the contrast of the stimulus did not increase (two white dots add to white, two black dots sum to black, and a white and black dot sum to gray). The resulting image was translated rigidly in a randomly selected cardinal direction during stimulation, and was static during the interleave. Three velocities of translation, 720, 960, and 1440 <sup>o</sup>/s, were grouped and used as the visual stimulus condition in <xref ref-type="fig" rid="fig8">Figure 8</xref>. Trajectories were selected in a manner identical to the optogenetic experiments described above. For these experiments, the flies were backlit with infrared light (peak 850 nm) at an intensity of ~ 2 µW/mm<sup>2</sup>. Data from three separate recordings, with a total of 44 flies, were merged to generate the aggregate dataset analyzed in this manuscript.</p></sec><sec id="s4-13"><title>Statistics</title><p>All statistical analysis was conducted using Matlab 9.4 (The MathWorks, Natick, MA). Throughout this manuscript, presented error bars are bootstrapped 95% confidence intervals obtained using the bias-corrected and accelerated percentile method (<xref ref-type="bibr" rid="bib44">Efron, 1987</xref>) unless otherwise indicated. In <xref ref-type="fig" rid="fig1">Figure 1</xref>, error bars for both body and limb variables were generated from bootstraps over videos (eight videos total from eight experiments, each with approximately 1/8 of the total data). In <xref ref-type="fig" rid="fig3">Figures 3</xref>, <xref ref-type="fig" rid="fig6">6</xref> and <xref ref-type="fig" rid="fig7">7</xref>, error bars for analyses of relative limb phases and coherences were also generated by bootstrapping over videos. In <xref ref-type="fig" rid="fig8">Figure 8</xref>, unlike other analyses, the confidence intervals were generated by bootstrapping over individual selected fly walking trajectories. In <xref ref-type="fig" rid="fig8">Figure 8</xref>, distributions of stance durations were compared using a two-sample Kolmogorov-Smirnov test. Throughout this manuscript, circular probability density functions of limb relative phases were estimated using kernel methods (<xref ref-type="bibr" rid="bib9">Batschelet, 1981</xref>; <xref ref-type="bibr" rid="bib45">Fisher, 1989</xref>). In <xref ref-type="fig" rid="fig7">Figure 7</xref>, to test against the null hypothesis that the distribution of phases at yaw extrema is indistinguishable from that over all instants, we performed two-sample Monte Carlo resampling tests (<xref ref-type="bibr" rid="bib43">Dwass, 1957</xref>; <xref ref-type="bibr" rid="bib50">Gandy, 2009</xref>) using the Kuiper V-statistic (<xref ref-type="bibr" rid="bib9">Batschelet, 1981</xref>; <xref ref-type="bibr" rid="bib68">Kuiper, 1960</xref>). We used 10<sup>5</sup> permutations, and computed Clopper-Pearson confidence intervals for the resulting p-values (<xref ref-type="bibr" rid="bib25">Clopper and Pearson, 1934</xref>; <xref ref-type="bibr" rid="bib43">Dwass, 1957</xref>; <xref ref-type="bibr" rid="bib50">Gandy, 2009</xref>) (<xref ref-type="table" rid="table4">Table 4</xref>). As the value of the test statistic for the null distribution did not exceed the observed test statistic in 10<sup>5</sup> permutations, this test only allows us to bound the true p-value from above.</p><table-wrap id="table4" position="float"><object-id pub-id-type="doi">10.7554/eLife.46409.026</object-id><label>Table 4.</label><caption><title>Two-sample Monte Carlo resampling tests using the Kuiper V-statistic against the null hypothesis that the distribution of phases at yaw extrema is indistinguishable from that over all instants (10<sup>5</sup> permutations, N = 8 videos).</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Limb</th><th valign="top">V-statistic</th><th valign="top">p-Value</th><th valign="top">95% CI for p-value</th></tr></thead><tbody><tr><td valign="top">O1</td><td valign="top">1.08 × 10<sup>−1</sup></td><td valign="top">&lt;10<sup>−5</sup></td><td valign="top">[0, 3.68 × 10<sup>−5</sup>]</td></tr><tr><td valign="top">O2</td><td valign="top">1.67 × 10<sup>−1</sup></td><td valign="top">&lt;10<sup>−5</sup></td><td valign="top">[0, 3.68 × 10<sup>−5</sup>]</td></tr><tr><td valign="top">O3</td><td valign="top">1.77 × 10<sup>−1</sup></td><td valign="top">&lt;10<sup>−5</sup></td><td valign="top">[0, 3.68 × 10<sup>−5</sup>]</td></tr><tr><td valign="top">I1</td><td valign="top">1.07 × 10<sup>−1</sup></td><td valign="top">&lt;10<sup>−5</sup></td><td valign="top">[0, 3.68 × 10<sup>−5</sup>]</td></tr><tr><td valign="top">I2</td><td valign="top">2.33 × 10<sup>−1</sup></td><td valign="top">&lt;10<sup>−5</sup></td><td valign="top">[0, 3.68 × 10<sup>−5</sup>]</td></tr><tr><td valign="top">I3</td><td valign="top">1.16 × 10<sup>−1</sup></td><td valign="top">&lt;10<sup>−5</sup></td><td valign="top">[0, 3.68 × 10<sup>−5</sup>]</td></tr></tbody></table></table-wrap></sec><sec id="s4-14"><title>Data and code availability</title><p>The datasets analyzed in this work are available from the Dryad Digital Repository: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.3p9h20r">https://doi.org/10.5061/dryad.3p9h20r</ext-link>. Matlab code to integrate all models, reproduce all statistical analyses, and generate all figure panels is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ClarkLabCode/GaitPaperCode">https://github.com/ClarkLabCode/GaitPaperCode</ext-link> (<xref ref-type="bibr" rid="bib37">DeAngelis et al., 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/GaitPaperCode">https://github.com/elifesciences-publications/GaitPaperCode</ext-link>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This work benefitted from many helpful conversations with M Venkadesan, as well as analysis by U Piterbarg. BDD was supported by an NSF GRF and a Gruber Science Fellowship. DAC and this project were supported by the Smith Family Foundation, NIH R01EY026555, a Searle Scholar Award, and a Sloan Fellowship in Neuroscience.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.46409.032</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-46409-transrepform-v1.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>The datasets analyzed in this work are available from the Dryad Digital Repository: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.3p9h20r">https://doi.org/10.5061/dryad.3p9h20r</ext-link>. Matlab code to reproduce all statistical analyses and figure panels is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ClarkLabCode/GaitPaperCode">https://github.com/ClarkLabCode/GaitPaperCode</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/GaitPaperCode">https://github.com/elifesciences-publications/GaitPaperCode</ext-link>).</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Brian</surname><given-names>DeAngelis</given-names></name><name><surname>Jacob</surname><given-names>A Zavatone-Veth</given-names></name><name><surname>Damon</surname><given-names>A Clark</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Data from: The manifold structure of limb coordination in walking Drosophila</data-title><source>Dryad Digital Repository</source><pub-id assigning-authority="Dryad" pub-id-type="doi">10.5061/dryad.3p9h20r</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Acebrón</surname> <given-names>JA</given-names></name><name><surname>Bonilla</surname> <given-names>LL</given-names></name><name><surname>Pérez Vicente</surname> <given-names>CJ</given-names></name><name><surname>Ritort</surname> <given-names>F</given-names></name><name><surname>Spigler</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The Kuramoto model: a simple paradigm for synchronization phenomena</article-title><source>Reviews of Modern Physics</source><volume>77</volume><fpage>137</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.77.137</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexander</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Optimization and gaits in the locomotion of vertebrates</article-title><source>Physiological Reviews</source><volume>69</volume><fpage>1199</fpage><lpage>1227</lpage><pub-id pub-id-type="doi">10.1152/physrev.1989.69.4.1199</pub-id><pub-id pub-id-type="pmid">2678167</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexander</surname> <given-names>RM</given-names></name><name><surname>Jayes</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Fourier analysis of forces exerted in walking and running</article-title><source>Journal of Biomechanics</source><volume>13</volume><fpage>383</fpage><lpage>390</lpage><pub-id pub-id-type="doi">10.1016/0021-9290(80)90019-6</pub-id><pub-id pub-id-type="pmid">7400167</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexander</surname> <given-names>RM</given-names></name><name><surname>Jayes</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>A dynamic similarity hypothesis for the gaits of quadrupedal mammals</article-title><source>Journal of Zoology</source><volume>201</volume><fpage>135</fpage><lpage>152</lpage><pub-id pub-id-type="doi">10.1111/j.1469-7998.1983.tb04266.x</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aminzare</surname> <given-names>Z</given-names></name><name><surname>Srivastava</surname> <given-names>V</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Gait transitions in a phase oscillator model of an insect central pattern generator</article-title><source>SIAM Journal on Applied Dynamical Systems</source><volume>17</volume><fpage>626</fpage><lpage>671</lpage><pub-id pub-id-type="doi">10.1137/17M1125571</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Aminzare</surname> <given-names>Z</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Heterogeneous inputs to central pattern generators can shape insect gaits</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1807.05142">https://arxiv.org/abs/1807.05142</ext-link></element-citation></ref><ref id="bib7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ascher</surname> <given-names>UM</given-names></name><name><surname>Petzold</surname> <given-names>LR</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Computer Methods for Ordinary Differential Equations and Differential-Algebraic Equations</source><publisher-name>SIAM: Society for Industrial and Applied Mathematics</publisher-name></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ayali</surname> <given-names>A</given-names></name><name><surname>Borgmann</surname> <given-names>A</given-names></name><name><surname>Büschges</surname> <given-names>A</given-names></name><name><surname>Couzin-Fuchs</surname> <given-names>E</given-names></name><name><surname>Daun-Gruhn</surname> <given-names>S</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The comparative investigation of the stick insect and cockroach models in the study of insect locomotion</article-title><source>Current Opinion in Insect Science</source><volume>12</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1016/j.cois.2015.07.004</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Batschelet</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="1981">1981</year><source>Circular Statistics in Biology</source><publisher-loc>London</publisher-loc><publisher-name>Academic Press</publisher-name></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becht</surname> <given-names>E</given-names></name><name><surname>McInnes</surname> <given-names>L</given-names></name><name><surname>Healy</surname> <given-names>J</given-names></name><name><surname>Dutertre</surname> <given-names>C-A</given-names></name><name><surname>Kwok</surname> <given-names>IWH</given-names></name><name><surname>Ng</surname> <given-names>LG</given-names></name><name><surname>Ginhoux</surname> <given-names>F</given-names></name><name><surname>Newell</surname> <given-names>EW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title><source>Nature Biotechnology</source><volume>37</volume><fpage>38</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bender</surname> <given-names>JA</given-names></name><name><surname>Simpson</surname> <given-names>EM</given-names></name><name><surname>Tietz</surname> <given-names>BR</given-names></name><name><surname>Daltorio</surname> <given-names>KA</given-names></name><name><surname>Quinn</surname> <given-names>RD</given-names></name><name><surname>Ritzmann</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Kinematic and behavioral evidence for a distinction between trotting and ambling gaits in the cockroach blaberus discoidalis</article-title><source>Journal of Experimental Biology</source><volume>214</volume><fpage>2057</fpage><lpage>2064</lpage><pub-id pub-id-type="doi">10.1242/jeb.056481</pub-id><pub-id pub-id-type="pmid">21613522</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berendes</surname> <given-names>V</given-names></name><name><surname>Zill</surname> <given-names>SN</given-names></name><name><surname>Büschges</surname> <given-names>A</given-names></name><name><surname>Bockemühl</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Speed-dependent interplay between local pattern-generating activity and sensory signals during walking in <italic>Drosophila</italic></article-title><source>The Journal of Experimental Biology</source><volume>219</volume><fpage>3781</fpage><lpage>3793</lpage><pub-id pub-id-type="doi">10.1242/jeb.146720</pub-id><pub-id pub-id-type="pmid">27688052</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname> <given-names>GJ</given-names></name><name><surname>Choi</surname> <given-names>DM</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mapping the stereotyped behaviour of freely moving fruit flies</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><elocation-id>20140672</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2014.0672</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bidaye</surname> <given-names>SS</given-names></name><name><surname>Machacek</surname> <given-names>C</given-names></name><name><surname>Wu</surname> <given-names>Y</given-names></name><name><surname>Dickson</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Neuronal control of Drosophila walking direction</article-title><source>Science</source><volume>344</volume><fpage>97</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1126/science.1249964</pub-id><pub-id pub-id-type="pmid">24700860</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Boashash</surname> <given-names>B</given-names></name><name><surname>Reilly</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1992">1992</year><chapter-title>Algorithms for Time-Frequency Signal Analysis</chapter-title><source>Time Frequency Signal Analysis: Methods and Applications</source><publisher-loc>Longman Cheshire</publisher-loc><publisher-name>Melbourne</publisher-name><fpage>163</fpage><lpage>168</lpage></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradski</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The OpenCV Library</article-title><source>Dr. Dobb’s Journal of Software Tools</source></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brainard</surname> <given-names>DH</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The psychophysics toolbox</article-title><source>Spatial Vision</source><volume>10</volume><fpage>433</fpage><lpage>436</lpage><pub-id pub-id-type="doi">10.1163/156856897X00357</pub-id><pub-id pub-id-type="pmid">9176952</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Branson</surname> <given-names>K</given-names></name><name><surname>Robie</surname> <given-names>AA</given-names></name><name><surname>Bender</surname> <given-names>J</given-names></name><name><surname>Perona</surname> <given-names>P</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>High-throughput ethomics in large groups of Drosophila</article-title><source>Nature Methods</source><volume>6</volume><fpage>451</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1328</pub-id><pub-id pub-id-type="pmid">19412169</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brett</surname> <given-names>JR</given-names></name><name><surname>Sutherland</surname> <given-names>DB</given-names></name></person-group><year iso-8601-date="1965">1965</year><article-title>Respiratory Metabolism of Pumpkinseed ( <italic>Lepomis gibbosus</italic> ) in Relation to Swimming Speed</article-title><source>Journal of the Fisheries Research Board of Canada</source><volume>22</volume><fpage>405</fpage><lpage>409</lpage><pub-id pub-id-type="doi">10.1139/f65-039</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Burrows</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1996">1996</year><source>The Neurobiology of an Insect Brain</source><publisher-loc>New York</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Büschges</surname> <given-names>A</given-names></name><name><surname>Akay</surname> <given-names>T</given-names></name><name><surname>Gabriel</surname> <given-names>JP</given-names></name><name><surname>Schmidt</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Organizing network action for locomotion: insights from studying insect walking</article-title><source>Brain Research Reviews</source><volume>57</volume><fpage>162</fpage><lpage>171</lpage><pub-id pub-id-type="doi">10.1016/j.brainresrev.2007.06.028</pub-id><pub-id pub-id-type="pmid">17888515</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cande</surname> <given-names>J</given-names></name><name><surname>Namiki</surname> <given-names>S</given-names></name><name><surname>Qiu</surname> <given-names>J</given-names></name><name><surname>Korff</surname> <given-names>W</given-names></name><name><surname>Card</surname> <given-names>GM</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name><name><surname>Stern</surname> <given-names>DL</given-names></name><name><surname>Berman</surname> <given-names>GJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Optogenetic dissection of descending behavioral control in <italic>Drosophila</italic></article-title><source>eLife</source><volume>7</volume><elocation-id>e34275</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34275</pub-id><pub-id pub-id-type="pmid">29943729</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chadha</surname> <given-names>A</given-names></name><name><surname>Cook</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The effect of stress on motor function in Drosophila</article-title><source>PLOS ONE</source><volume>9</volume><fpage>e112076</fpage><lpage>e112079</lpage><pub-id pub-id-type="doi">10.1371/journal.pone.0112076</pub-id><pub-id pub-id-type="pmid">25375106</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>CL</given-names></name><name><surname>Hermans</surname> <given-names>L</given-names></name><name><surname>Viswanathan</surname> <given-names>MC</given-names></name><name><surname>Fortun</surname> <given-names>D</given-names></name><name><surname>Aymanns</surname> <given-names>F</given-names></name><name><surname>Unser</surname> <given-names>M</given-names></name><name><surname>Cammarato</surname> <given-names>A</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name><name><surname>Ramdya</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Imaging neural activity in the ventral nerve cord of behaving adult Drosophila</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>4390</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-06857-z</pub-id><pub-id pub-id-type="pmid">30348941</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clopper</surname> <given-names>CJ</given-names></name><name><surname>Pearson</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="1934">1934</year><article-title>The use of confidence or fiducial limits illustrated in the case of the binomial</article-title><source>Biometrika</source><volume>26</volume><fpage>404</fpage><lpage>413</lpage><pub-id pub-id-type="doi">10.1093/biomet/26.4.404</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname> <given-names>JJ</given-names></name><name><surname>Stewart</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Hexapodal gaits and coupled nonlinear oscillator models</article-title><source>Biological Cybernetics</source><volume>68</volume><fpage>287</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1007/BF00201854</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname> <given-names>JJ</given-names></name><name><surname>Stewart</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>A group-theoretic approach to rings of coupled biological oscillators</article-title><source>Biological Cybernetics</source><volume>71</volume><fpage>95</fpage><lpage>103</lpage><pub-id pub-id-type="doi">10.1007/BF00197312</pub-id><pub-id pub-id-type="pmid">8068779</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couzin-Fuchs</surname> <given-names>E</given-names></name><name><surname>Kiemel</surname> <given-names>T</given-names></name><name><surname>Gal</surname> <given-names>O</given-names></name><name><surname>Ayali</surname> <given-names>A</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Intersegmental coupling and recovery from perturbations in freely running cockroaches</article-title><source>Journal of Experimental Biology</source><volume>218</volume><fpage>285</fpage><lpage>297</lpage><pub-id pub-id-type="doi">10.1242/jeb.112805</pub-id><pub-id pub-id-type="pmid">25609786</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Creamer</surname> <given-names>MS</given-names></name><name><surname>Mano</surname> <given-names>O</given-names></name><name><surname>Clark</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Visual control of walking speed in Drosophila</article-title><source>Neuron</source><volume>100</volume><fpage>1460</fpage><lpage>1473</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.10.028</pub-id><pub-id pub-id-type="pmid">30415994</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crill</surname> <given-names>WD</given-names></name><name><surname>Huey</surname> <given-names>RB</given-names></name><name><surname>Gilchrist</surname> <given-names>GW</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Within- and Between-Generation effects of temperature on the morphology and physiology of Drosophila melanogaster</article-title><source>Evolution</source><volume>50</volume><fpage>1205</fpage><lpage>1218</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.1996.tb02361.x</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruse</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>A new model describing the coordination pattern of the legs of a walking stick insect</article-title><source>Biological Cybernetics</source><volume>32</volume><fpage>107</fpage><lpage>113</lpage><pub-id pub-id-type="doi">10.1007/BF00337442</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruse</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>A quantitative model of walking incorporating central and peripheral influences II. the connections between the different legs</article-title><source>Biological Cybernetics</source><volume>37</volume><fpage>137</fpage><lpage>144</lpage></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruse</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>What mechanisms coordinate leg movement in walking arthropods?</article-title><source>Trends in Neurosciences</source><volume>13</volume><fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1016/0166-2236(90)90057-H</pub-id><pub-id pub-id-type="pmid">1688670</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruse</surname> <given-names>H</given-names></name><name><surname>Bartling</surname> <given-names>C</given-names></name><name><surname>Cymbalyuk</surname> <given-names>G</given-names></name><name><surname>Dean</surname> <given-names>J</given-names></name><name><surname>Dreifert</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>A modular artificial neural net for controlling a six-legged walking system</article-title><source>Biological Cybernetics</source><volume>72</volume><fpage>421</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1007/BF00201417</pub-id><pub-id pub-id-type="pmid">7734551</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruse</surname> <given-names>H</given-names></name><name><surname>Ehmanns</surname> <given-names>I</given-names></name><name><surname>Stübner</surname> <given-names>S</given-names></name><name><surname>Schmitz</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Tight turns in stick insects</article-title><source>Journal of Comparative Physiology A</source><volume>195</volume><fpage>299</fpage><lpage>309</lpage><pub-id pub-id-type="doi">10.1007/s00359-008-0406-3</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Vries</surname> <given-names>SE</given-names></name><name><surname>Clandinin</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Optogenetic stimulation of escape behavior in Drosophila melanogaster</article-title><source>Journal of Visualized Experiments</source><pub-id pub-id-type="doi">10.3791/50192</pub-id><pub-id pub-id-type="pmid">23380919</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>DeAngelis</surname> <given-names>B</given-names></name><name><surname>Zavatone-Veth</surname> <given-names>JA</given-names></name><name><surname>Clark</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>GaitPaperCode</data-title><source>GitHub</source><version designator="63c43fb">63c43fb</version><ext-link ext-link-type="uri" xlink:href="https://github.com/ClarkLabCode/GaitPaperCode">https://github.com/ClarkLabCode/GaitPaperCode</ext-link></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delcomyn</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Walking robots and the central peripheral of locomotion in insects</article-title><source>Autonomous Robots</source><volume>7</volume><fpage>259</fpage><lpage>270</lpage></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dickinson</surname> <given-names>MH</given-names></name><name><surname>Muijres</surname> <given-names>FT</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The aerodynamics and control of free flight manoeuvres in <italic>Drosophila</italic></article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>371</volume><fpage>20150388</fpage><pub-id pub-id-type="doi">10.1098/rstb.2015.0388</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Domenici</surname> <given-names>P</given-names></name><name><surname>Jamon</surname> <given-names>M</given-names></name><name><surname>Clarac</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Curve walking in freely moving crayfish (Procambarus clarkii)</article-title><source>The Journal of Experimental Biology</source><volume>201</volume><fpage>1315</fpage><lpage>1329</lpage><pub-id pub-id-type="pmid">9547313</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dürr</surname> <given-names>V</given-names></name><name><surname>Theunissen</surname> <given-names>LM</given-names></name><name><surname>Dallmann</surname> <given-names>CJ</given-names></name><name><surname>Hoinville</surname> <given-names>T</given-names></name><name><surname>Schmitz</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Motor flexibility in insects: adaptive coordination of limbs in locomotion and near-range exploration</article-title><source>Behavioral Ecology and Sociobiology</source><volume>72</volume><elocation-id>15</elocation-id><pub-id pub-id-type="doi">10.1007/s00265-017-2412-3</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dürr</surname> <given-names>V</given-names></name><name><surname>Ebeling</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The behavioural transition from straight to curve walking: kinetics of leg movement parameters and the initiation of turning</article-title><source>Journal of Experimental Biology</source><volume>208</volume><fpage>2237</fpage><lpage>2252</lpage><pub-id pub-id-type="doi">10.1242/jeb.01637</pub-id><pub-id pub-id-type="pmid">15939767</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dwass</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1957">1957</year><article-title>Modified randomization tests for nonparametric hypotheses</article-title><source>The Annals of Mathematical Statistics</source><volume>28</volume><fpage>181</fpage><lpage>187</lpage><pub-id pub-id-type="doi">10.1214/aoms/1177707045</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Efron</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Better bootstrap confidence intervals</article-title><source>Journal of the American Statistical Association</source><volume>82</volume><fpage>171</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1080/01621459.1987.10478410</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname> <given-names>NI</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Smoothing a sample of circular data</article-title><source>Journal of Structural Geology</source><volume>11</volume><fpage>775</fpage><lpage>778</lpage><pub-id pub-id-type="doi">10.1016/0191-8141(89)90012-6</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franklin</surname> <given-names>R</given-names></name><name><surname>Bell</surname> <given-names>WJ</given-names></name><name><surname>Jander</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Rotational locomotion by the cockroach blattella germanica</article-title><source>Journal of Insect Physiology</source><volume>27</volume><fpage>249</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1016/0022-1910(81)90058-5</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frantsevich</surname> <given-names>LI</given-names></name><name><surname>Mokrushov</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Turning and righting inGeotrupes (Coleoptera, scarabaeidae)</article-title><source>Journal of Comparative Physiology ? A</source><volume>136</volume><fpage>279</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1007/BF00657348</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fry</surname> <given-names>SN</given-names></name><name><surname>Sayaman</surname> <given-names>R</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The aerodynamics of free-flight maneuvers in Drosophila</article-title><source>Science</source><volume>300</volume><fpage>495</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1126/science.1081944</pub-id><pub-id pub-id-type="pmid">12702878</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gabor</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1946">1946</year><article-title>Theory of communication</article-title><source>J. Inst. Electr. Eng</source><volume>93</volume><fpage>429</fpage><lpage>460</lpage></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gandy</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Sequential implementation of monte carlo tests with uniformly bounded resampling risk</article-title><source>Journal of the American Statistical Association</source><volume>104</volume><fpage>1504</fpage><lpage>1511</lpage><pub-id pub-id-type="doi">10.1198/jasa.2009.tm08368</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geurten</surname> <given-names>BR</given-names></name><name><surname>Jähde</surname> <given-names>P</given-names></name><name><surname>Corthals</surname> <given-names>K</given-names></name><name><surname>Göpfert</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Saccadic body turns in walking Drosophila</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>8</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.3389/fnbeh.2014.00365</pub-id><pub-id pub-id-type="pmid">25386124</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gohl</surname> <given-names>DM</given-names></name><name><surname>Silies</surname> <given-names>MA</given-names></name><name><surname>Gao</surname> <given-names>XJ</given-names></name><name><surname>Bhalerao</surname> <given-names>S</given-names></name><name><surname>Luongo</surname> <given-names>FJ</given-names></name><name><surname>Lin</surname> <given-names>CC</given-names></name><name><surname>Potter</surname> <given-names>CJ</given-names></name><name><surname>Clandinin</surname> <given-names>TR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A versatile in vivo system for directed dissection of gene expression patterns</article-title><source>Nature Methods</source><volume>8</volume><fpage>231</fpage><lpage>237</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1561</pub-id><pub-id pub-id-type="pmid">21473015</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graham</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>A behavioural analysis of the temporal organisation of walking movements in the 1st instar and adult stick insect (Carausius morosus)</article-title><source>Journal of Comparative Physiology</source><volume>81</volume><fpage>23</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1007/BF00693548</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graham</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>The effect of amputation and leg restraint on the free walking coordination of the stick insectCarausius morosus</article-title><source>Journal of Comparative Physiology ? A</source><volume>116</volume><fpage>91</fpage><lpage>116</lpage><pub-id pub-id-type="doi">10.1007/BF00605519</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gruhn</surname> <given-names>M</given-names></name><name><surname>Zehl</surname> <given-names>L</given-names></name><name><surname>Büschges</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Straight walking and turning on a slippery surface</article-title><source>Journal of Experimental Biology</source><volume>212</volume><fpage>194</fpage><lpage>209</lpage><pub-id pub-id-type="doi">10.1242/jeb.018317</pub-id><pub-id pub-id-type="pmid">19112138</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gruhn</surname> <given-names>M</given-names></name><name><surname>Rosenbaum</surname> <given-names>P</given-names></name><name><surname>Bockemühl</surname> <given-names>T</given-names></name><name><surname>Büschges</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Body side-specific control of motor activity during turning in a walking animal</article-title><source>eLife</source><volume>5</volume><elocation-id>e13799</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.13799</pub-id><pub-id pub-id-type="pmid">27130731</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinrich</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Impact of descending brain neurons on the control of stridulation, walking<italic>, and flight in orthoptera</italic></article-title><source>Microscopy Research and Technique</source><volume>56</volume><fpage>292</fpage><lpage>301</lpage><pub-id pub-id-type="doi">10.1002/jemt.10033</pub-id><pub-id pub-id-type="pmid">11877804</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoyt</surname> <given-names>DF</given-names></name><name><surname>Taylor</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Gait and the energetics of locomotion in horses</article-title><source>Nature</source><volume>292</volume><fpage>239</fpage><lpage>240</lpage><pub-id pub-id-type="doi">10.1038/292239a0</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ijspeert</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Central pattern generators for locomotion control in animals and robots: a review</article-title><source>Neural Networks</source><volume>21</volume><fpage>642</fpage><lpage>653</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2008.03.014</pub-id><pub-id pub-id-type="pmid">18555958</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Isakov</surname> <given-names>A</given-names></name><name><surname>Buchanan</surname> <given-names>SM</given-names></name><name><surname>Sullivan</surname> <given-names>B</given-names></name><name><surname>Ramachandran</surname> <given-names>A</given-names></name><name><surname>Chapman</surname> <given-names>JKS</given-names></name><name><surname>Lu</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Recovery of locomotion after injury in Drosophila depends on proprioception <italic>and de bivort, B</italic></article-title><source>The Journal of Experimental Biology</source><volume>219</volume><fpage>1760</fpage><lpage>1771</lpage><pub-id pub-id-type="doi">10.1242/jeb.133652</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jindrich</surname> <given-names>DL</given-names></name><name><surname>Full</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Many-legged maneuverability: dynamics of turning in hexapods</article-title><source>The Journal of Experimental Biology</source><volume>202</volume><fpage>1603</fpage><lpage>1623</lpage><pub-id pub-id-type="pmid">10333507</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kain</surname> <given-names>J</given-names></name><name><surname>Stokes</surname> <given-names>C</given-names></name><name><surname>Gaudry</surname> <given-names>Q</given-names></name><name><surname>Song</surname> <given-names>X</given-names></name><name><surname>Foley</surname> <given-names>J</given-names></name><name><surname>Wilson</surname> <given-names>R</given-names></name><name><surname>de Bivort</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Leg-tracking and automated behavioural classification in Drosophila</article-title><source>Nature Communications</source><volume>4</volume><fpage>1910</fpage><lpage>1918</lpage><pub-id pub-id-type="doi">10.1038/ncomms2908</pub-id><pub-id pub-id-type="pmid">23715269</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katsov</surname> <given-names>AY</given-names></name><name><surname>Freifeld</surname> <given-names>L</given-names></name><name><surname>Horowitz</surname> <given-names>M</given-names></name><name><surname>Kuehn</surname> <given-names>S</given-names></name><name><surname>Clandinin</surname> <given-names>TR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dynamic structure of locomotor behavior in walking fruit flies</article-title><source>eLife</source><volume>6</volume><elocation-id>e26410</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.26410</pub-id><pub-id pub-id-type="pmid">28742018</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katsov</surname> <given-names>AY</given-names></name><name><surname>Clandinin</surname> <given-names>TR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Motion processing streams in Drosophila are behaviorally specialized</article-title><source>Neuron</source><volume>59</volume><fpage>322</fpage><lpage>335</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.05.022</pub-id><pub-id pub-id-type="pmid">18667159</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klapoetke</surname> <given-names>NC</given-names></name><name><surname>Murata</surname> <given-names>Y</given-names></name><name><surname>Kim</surname> <given-names>SS</given-names></name><name><surname>Pulver</surname> <given-names>SR</given-names></name><name><surname>Birdsey-Benson</surname> <given-names>A</given-names></name><name><surname>Cho</surname> <given-names>YK</given-names></name><name><surname>Morimoto</surname> <given-names>TK</given-names></name><name><surname>Chuong</surname> <given-names>AS</given-names></name><name><surname>Carpenter</surname> <given-names>EJ</given-names></name><name><surname>Tian</surname> <given-names>Z</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Xie</surname> <given-names>Y</given-names></name><name><surname>Yan</surname> <given-names>Z</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Chow</surname> <given-names>BY</given-names></name><name><surname>Surek</surname> <given-names>B</given-names></name><name><surname>Melkonian</surname> <given-names>M</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name><name><surname>Constantine-Paton</surname> <given-names>M</given-names></name><name><surname>Wong</surname> <given-names>GK</given-names></name><name><surname>Boyden</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Independent optical excitation of distinct neural populations</article-title><source>Nature Methods</source><volume>11</volume><fpage>338</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2836</pub-id><pub-id pub-id-type="pmid">24509633</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kleiner</surname> <given-names>M</given-names></name><name><surname>Brainard</surname> <given-names>D</given-names></name><name><surname>Pelli</surname> <given-names>DG</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>What’s new in Psychtoolbox-3?</article-title><source>Perception</source><volume>36</volume><elocation-id>1</elocation-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krakauer</surname> <given-names>JW</given-names></name><name><surname>Ghazanfar</surname> <given-names>AA</given-names></name><name><surname>Gomez-Marin</surname> <given-names>A</given-names></name><name><surname>MacIver</surname> <given-names>MA</given-names></name><name><surname>Poeppel</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Neuroscience needs behavior: correcting a reductionist bias</article-title><source>Neuron</source><volume>93</volume><fpage>480</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.12.041</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuiper</surname> <given-names>NH</given-names></name></person-group><year iso-8601-date="1960">1960</year><article-title>Tests concerning random points on a circle</article-title><source>Indagationes Mathematicae</source><volume>63</volume><fpage>38</fpage><lpage>47</lpage><pub-id pub-id-type="doi">10.1016/S1385-7258(60)50006-0</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kukillaya</surname> <given-names>R</given-names></name><name><surname>Proctor</surname> <given-names>J</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Neuromechanical models for insect locomotion: stability, maneuverability, and proprioceptive feedback</article-title><source>Chaos: An Interdisciplinary Journal of Nonlinear Science</source><volume>19</volume><fpage>026107</fpage><pub-id pub-id-type="doi">10.1063/1.3141306</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kukillaya</surname> <given-names>RP</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A model for insect locomotion in the horizontal plane: feedforward activation of fast muscles, stability, and robustness</article-title><source>Journal of Theoretical Biology</source><volume>261</volume><fpage>210</fpage><lpage>226</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2009.07.036</pub-id><pub-id pub-id-type="pmid">19660474</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kwak</surname> <given-names>SH</given-names></name><name><surname>McGhee</surname> <given-names>RB</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Rule-based motion coordination for a hexapod walking machine</article-title><source>Advanced Robotics</source><volume>4</volume><fpage>263</fpage><lpage>282</lpage><pub-id pub-id-type="doi">10.1163/156855390X00297</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lamb</surname> <given-names>PF</given-names></name><name><surname>Stöckl</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>On the use of continuous relative phase: review of current approaches and outline for a new standard</article-title><source>Clinical Biomechanics</source><volume>29</volume><fpage>484</fpage><lpage>493</lpage><pub-id pub-id-type="doi">10.1016/j.clinbiomech.2014.03.008</pub-id><pub-id pub-id-type="pmid">24726779</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindsay</surname> <given-names>T</given-names></name><name><surname>Sustar</surname> <given-names>A</given-names></name><name><surname>Dickinson</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The function and organization of the motor system controlling flight maneuvers in flies</article-title><source>Current Biology</source><volume>27</volume><fpage>345</fpage><lpage>358</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2016.12.018</pub-id><pub-id pub-id-type="pmid">28132816</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname> <given-names>L</given-names></name><name><surname>Callaway</surname> <given-names>EM</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Genetic dissection of neural circuits: a decade of progress</article-title><source>Neuron</source><volume>98</volume><fpage>256</fpage><lpage>281</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.03.040</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mamiya</surname> <given-names>A</given-names></name><name><surname>Gurung</surname> <given-names>P</given-names></name><name><surname>Tuthill</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Neural coding of leg proprioception in Drosophila</article-title><source>Neuron</source><volume>100</volume><fpage>636</fpage><lpage>650</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.09.009</pub-id><pub-id pub-id-type="pmid">30293823</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marple</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Computing the discrete-time &quot;analytic&quot; signal via FFT</article-title><source>IEEE Transactions on Signal Processing</source><volume>47</volume><fpage>2600</fpage><lpage>2603</lpage><pub-id pub-id-type="doi">10.1109/78.782222</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>A portrait of locomotor behaviour in Drosophila determined by a video-tracking paradigm</article-title><source>Behavioural Processes</source><volume>67</volume><fpage>207</fpage><lpage>219</lpage><pub-id pub-id-type="doi">10.1016/j.beproc.2004.04.003</pub-id><pub-id pub-id-type="pmid">15240058</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathis</surname> <given-names>A</given-names></name><name><surname>Mamidanna</surname> <given-names>P</given-names></name><name><surname>Cury</surname> <given-names>KM</given-names></name><name><surname>Abe</surname> <given-names>T</given-names></name><name><surname>Murthy</surname> <given-names>VN</given-names></name><name><surname>Mathis</surname> <given-names>MW</given-names></name><name><surname>Bethge</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>DeepLabCut: markerless pose estimation of user-defined body parts with deep learning</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>1281</fpage><lpage>1289</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0209-y</pub-id><pub-id pub-id-type="pmid">30127430</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>McInnes</surname> <given-names>L</given-names></name><name><surname>Healy</surname> <given-names>J</given-names></name><name><surname>Melville</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>UMAP: uniform manifold approximation and projection for dimension reduction</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.03426">https://arxiv.org/abs/1802.03426</ext-link></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendes</surname> <given-names>CS</given-names></name><name><surname>Bartos</surname> <given-names>I</given-names></name><name><surname>Akay</surname> <given-names>T</given-names></name><name><surname>Márka</surname> <given-names>S</given-names></name><name><surname>Mann</surname> <given-names>RS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantification of gait parameters in freely walking wild type and sensory deprived Drosophila melanogaster</article-title><source>eLife</source><volume>2</volume><elocation-id>e00231</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00231</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mu</surname> <given-names>L</given-names></name><name><surname>Ritzmann</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Kinematics and motor activity during tethered walking and turning in the cockroach, blaberus discoidalis</article-title><source>Journal of Comparative Physiology A</source><volume>191</volume><fpage>1037</fpage><lpage>1054</lpage><pub-id pub-id-type="doi">10.1007/s00359-005-0029-x</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muijres</surname> <given-names>FT</given-names></name><name><surname>Elzinga</surname> <given-names>MJ</given-names></name><name><surname>Iwasaki</surname> <given-names>NA</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Body saccades of Drosophila consist of stereotyped banked turns</article-title><source>Journal of Experimental Biology</source><volume>218</volume><fpage>864</fpage><lpage>875</lpage><pub-id pub-id-type="doi">10.1242/jeb.114280</pub-id><pub-id pub-id-type="pmid">25657212</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Namiki</surname> <given-names>S</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name><name><surname>Wong</surname> <given-names>AM</given-names></name><name><surname>Korff</surname> <given-names>W</given-names></name><name><surname>Card</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The functional organization of descending sensory-motor pathways in <italic>Drosophila</italic></article-title><source>eLife</source><volume>7</volume><elocation-id>e34272</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34272</pub-id><pub-id pub-id-type="pmid">29943730</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nishii</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Legged insects select the optimal locomotor pattern based on the energetic cost</article-title><source>Biological Cybernetics</source><volume>83</volume><fpage>435</fpage><lpage>442</lpage><pub-id pub-id-type="doi">10.1007/s004220000175</pub-id><pub-id pub-id-type="pmid">11073207</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Pedregosa</surname> <given-names>F</given-names></name><name><surname>Varoquaux</surname> <given-names>G</given-names></name><name><surname>Gramfort</surname> <given-names>A</given-names></name><name><surname>Thirion</surname> <given-names>B</given-names></name><name><surname>Grisel</surname> <given-names>O</given-names></name><name><surname>Blondel</surname> <given-names>M</given-names></name><name><surname>Prettenhofer</surname> <given-names>P</given-names></name><name><surname>Weiss</surname> <given-names>R</given-names></name><name><surname>Dubourg</surname> <given-names>V</given-names></name><name><surname>Vanderplas</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><data-title>Scikit-learn</data-title><source>Machine Learning in Python</source></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pelli</surname> <given-names>DG</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The VideoToolbox software for visual psychophysics: transforming numbers into movies</article-title><source>Spatial Vision</source><volume>10</volume><fpage>437</fpage><lpage>442</lpage><pub-id pub-id-type="doi">10.1163/156856897X00366</pub-id><pub-id pub-id-type="pmid">9176953</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pereira</surname> <given-names>TD</given-names></name><name><surname>Aldarondo</surname> <given-names>DE</given-names></name><name><surname>Willmore</surname> <given-names>L</given-names></name><name><surname>Kislin</surname> <given-names>M</given-names></name><name><surname>Wang</surname> <given-names>SS</given-names></name><name><surname>Murthy</surname> <given-names>M</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Fast animal pose estimation using deep neural networks</article-title><source>Nature Methods</source><volume>16</volume><fpage>117</fpage><lpage>125</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0234-5</pub-id><pub-id pub-id-type="pmid">30573820</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Proctor</surname> <given-names>J</given-names></name><name><surname>Kukillaya</surname> <given-names>RP</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A phase-reduced neuro-mechanical model for insect locomotion: feed-forward stability and proprioceptive feedback</article-title><source>Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences</source><volume>368</volume><fpage>5087</fpage><lpage>5104</lpage><pub-id pub-id-type="doi">10.1098/rsta.2010.0134</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Proctor</surname> <given-names>J</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Steering by transient destabilization in piecewise-holonomic models of legged locomotion</article-title><source>Regular and Chaotic Dynamics</source><volume>13</volume><fpage>267</fpage><lpage>282</lpage><pub-id pub-id-type="doi">10.1134/S1560354708040047</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Proctor</surname> <given-names>JL</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The effects of feedback on stability and maneuverability of a phase-reduced model for cockroach locomotion</article-title><source>Biological Cybernetics</source><volume>112</volume><fpage>387</fpage><lpage>401</lpage><pub-id pub-id-type="doi">10.1007/s00422-018-0762-1</pub-id><pub-id pub-id-type="pmid">29948143</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rayner</surname> <given-names>JMV</given-names></name><name><surname>Jones</surname> <given-names>G</given-names></name><name><surname>Thomas</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Vortex flow visualizations reveal change in upstroke function with flight speed in bats</article-title><source>Nature</source><volume>321</volume><fpage>162</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1038/321162a0</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Revzen</surname> <given-names>S</given-names></name><name><surname>Guckenheimer</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Estimating the phase of synchronized oscillators</article-title><source>Physical Review E</source><volume>78</volume><elocation-id>51907</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.78.051907</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Righetti</surname> <given-names>L</given-names></name><name><surname>Ijspeert</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Pattern generators with sensory feedback for the control of quadruped locomotion</article-title><conf-name>IEEE International Conference on Robotics and Automation</conf-name></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savitzky</surname> <given-names>A</given-names></name><name><surname>Golay</surname> <given-names>MJE</given-names></name></person-group><year iso-8601-date="1964">1964</year><article-title>Smoothing and differentiation of data by simplified least squares procedures</article-title><source>Analytical Chemistry</source><volume>36</volume><fpage>1627</fpage><lpage>1639</lpage><pub-id pub-id-type="doi">10.1021/ac60214a047</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seeds</surname> <given-names>AM</given-names></name><name><surname>Ravbar</surname> <given-names>P</given-names></name><name><surname>Chung</surname> <given-names>P</given-names></name><name><surname>Hampel</surname> <given-names>S</given-names></name><name><surname>Midgley</surname> <given-names>FM</given-names></name><name><surname>Mensh</surname> <given-names>BD</given-names></name><name><surname>Simpson</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A suppression hierarchy among competing motor programs drives sequential grooming in Drosophila</article-title><source>eLife</source><volume>3</volume><elocation-id>e02951</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.02951</pub-id><pub-id pub-id-type="pmid">25139955</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silies</surname> <given-names>M</given-names></name><name><surname>Gohl</surname> <given-names>DM</given-names></name><name><surname>Fisher</surname> <given-names>YE</given-names></name><name><surname>Freifeld</surname> <given-names>L</given-names></name><name><surname>Clark</surname> <given-names>DA</given-names></name><name><surname>Clandinin</surname> <given-names>TR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Modular use of peripheral input channels tunes motion-detecting circuitry</article-title><source>Neuron</source><volume>79</volume><fpage>111</fpage><lpage>127</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.04.029</pub-id><pub-id pub-id-type="pmid">23849199</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname> <given-names>S-M</given-names></name><name><surname>Waldron</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>An analytical approach for gait study and its applications on wave gaits</article-title><source>The International Journal of Robotics Research</source><volume>6</volume><fpage>60</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1177/027836498700600205</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soto-Padilla</surname> <given-names>A</given-names></name><name><surname>Ruijsink</surname> <given-names>R</given-names></name><name><surname>Sibon</surname> <given-names>OCM</given-names></name><name><surname>van Rijn</surname> <given-names>H</given-names></name><name><surname>Billeter</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Thermosensory perception regulates speed of movement in response to temperature changes in <italic>Drosophila melanogaster</italic></article-title><source>The Journal of Experimental Biology</source><volume>221</volume><fpage>jeb174151</fpage><pub-id pub-id-type="doi">10.1242/jeb.174151</pub-id><pub-id pub-id-type="pmid">29650755</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spirito</surname> <given-names>CP</given-names></name><name><surname>Mushrush</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Interlimb coordination during slow walking in the cockroach: I. effects of substrate alterations</article-title><source>The Journal of Experimental Biology</source><volume>78</volume><fpage>233</fpage><lpage>243</lpage></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srinivasan</surname> <given-names>M</given-names></name><name><surname>Ruina</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Computer optimization of a minimal biped model discovers walking and running</article-title><source>Nature</source><volume>439</volume><fpage>72</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1038/nature04113</pub-id><pub-id pub-id-type="pmid">16155564</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strauß</surname> <given-names>R</given-names></name><name><surname>Heisenberg</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Coordination of legs during straight walking and turning in Drosophila melanogaster</article-title><source>Journal of Comparative Physiology A</source><volume>167</volume><fpage>403</fpage><lpage>412</lpage><pub-id pub-id-type="doi">10.1007/BF00192575</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szczecinski</surname> <given-names>NS</given-names></name><name><surname>Bockemühl</surname> <given-names>T</given-names></name><name><surname>Chockley</surname> <given-names>AS</given-names></name><name><surname>Büschges</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Static stability predicts the continuum of interleg coordination patterns in <italic>Drosophila</italic></article-title><source>The Journal of Experimental Biology</source><volume>221</volume><elocation-id>jeb189142</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.189142</pub-id><pub-id pub-id-type="pmid">30274987</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thorstensson</surname> <given-names>A</given-names></name><name><surname>Roberthson</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Adaptations to changing speed in human locomotion: speed of transition between walking and running</article-title><source>Acta Physiologica Scandinavica</source><volume>131</volume><fpage>211</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1111/j.1748-1716.1987.tb08228.x</pub-id><pub-id pub-id-type="pmid">3673618</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turk</surname> <given-names>M</given-names></name><name><surname>Pentland</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Eigenfaces for recognition</article-title><source>Journal of Cognitive Neuroscience</source><volume>3</volume><fpage>71</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1162/jocn.1991.3.1.71</pub-id><pub-id pub-id-type="pmid">23964806</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tuthill</surname> <given-names>JC</given-names></name><name><surname>Wilson</surname> <given-names>RI</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Parallel transformation of tactile signals in central circuits of Drosophila</article-title><source>Cell</source><volume>164</volume><fpage>1046</fpage><lpage>1059</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.01.014</pub-id><pub-id pub-id-type="pmid">26919434</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vakman</surname> <given-names>DE</given-names></name><name><surname>Vaĭnshteĭn</surname> <given-names>LA</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Amplitude, phase, frequency—fundamental concepts of oscillation theory</article-title><source>Soviet Physics Uspekhi</source><volume>20</volume><fpage>1002</fpage><lpage>1016</lpage><pub-id pub-id-type="doi">10.1070/PU1977v020n12ABEH005479</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wendler</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1964">1964</year><article-title>Laufen und stehen der stabheuschrecke carausius morosus: sinnesborstenfelder in den beingelenken als glieder von regelkreisen</article-title><source>Zeitschrift Für Vergleichende Physiologie</source><volume>48</volume><fpage>198</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1007/BF00297860</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Wettergreen</surname> <given-names>D</given-names></name><name><surname>Thorpe</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Gait generation for legged robots</article-title><conf-name>In IEEE International Conference on Intelligent Robots and Systems</conf-name><conf-loc>Raleigh, NC, USA</conf-loc><pub-id pub-id-type="doi">10.1109/IROS.1992.594568</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williamson</surname> <given-names>WR</given-names></name><name><surname>Peek</surname> <given-names>MY</given-names></name><name><surname>Breads</surname> <given-names>P</given-names></name><name><surname>Coop</surname> <given-names>B</given-names></name><name><surname>Card</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Tools for rapid High-Resolution behavioral phenotyping of automatically isolated Drosophila</article-title><source>Cell Reports</source><volume>25</volume><fpage>1636</fpage><lpage>1649</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2018.10.048</pub-id><pub-id pub-id-type="pmid">30404015</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="1966">1966</year><article-title>Insect walking</article-title><source>Annual Review of Entomology</source><volume>11</volume><fpage>103</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1146/annurev.en.11.010166.000535</pub-id><pub-id pub-id-type="pmid">5321575</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wosnitza</surname> <given-names>A</given-names></name><name><surname>Bockemühl</surname> <given-names>T</given-names></name><name><surname>Dübbert</surname> <given-names>M</given-names></name><name><surname>Scholz</surname> <given-names>H</given-names></name><name><surname>Büschges</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inter-leg coordination in the control of walking speed in Drosophila</article-title><source>Journal of Experimental Biology</source><volume>216</volume><fpage>480</fpage><lpage>491</lpage><pub-id pub-id-type="doi">10.1242/jeb.078139</pub-id><pub-id pub-id-type="pmid">23038731</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zollikofer</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Stepping patterns in ants - INFLUENCE of speed and curvature</article-title><source>The Journal of Experimental Biology</source><volume>192</volume><fpage>95</fpage><lpage>106</lpage><pub-id pub-id-type="pmid">9317406</pub-id></element-citation></ref><ref id="bib113"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zolotov</surname> <given-names>V</given-names></name><name><surname>Frantsevich</surname> <given-names>L</given-names></name><name><surname>Falk</surname> <given-names>E-M</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Kinematik Der Phototaktischen Drehung bei der HonigbieneApis mellifera L</article-title><source>Journal of Comparative Physiology</source><volume>97</volume><fpage>339</fpage><lpage>353</lpage><pub-id pub-id-type="doi">10.1007/BF00631970</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.46409.035</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;The manifold structure of limb coordination in walking <italic>Drosophila</italic>&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by Ronald Calabrese as the Senior and Reviewing Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This work investigates the repertoire of forward locomotion dynamics in the fruit fly (<italic>D. melanogaster</italic>) using a combination of limb tip and centroid tracking, dimensionality reduction and mathematical modeling, and neuronal perturbations. The key claims are that the speed of forward locomotion are controlled using a single control parameter, and that the traditional division of walking patterns into alternating tripod, tetrapod, and wave gaits is not apparent in spontaneous walking and is, accordingly, better understood through the manifold framework proposed here. Lastly, the authors perform both optogenetic and sensory perturbations during spontaneous locomotion, finding that the flies altered their movements along the trajectory of the manifold described.</p><p>Essential revisions:</p><p>There is much to interest the fly community and the greater neuroscience community in the thorough analysis presented and the interesting manifold structure described.</p><p>Several concerns detailed in the expert reviews should be addressed.</p><p>1) The UMAP embedding (dimensionality reduction) is well-suited for preserving topological features of a data set requiring warping of global metrics in order to preserve local topological structure. PCA may do a better job of describing the full dynamic range of the variables than the UMAP does. The authors should directly compare PCA to the UMAP manifold and should be very clear about what features of the data UMAP is preserving.</p><p>2) The effect of error on gait definitions (e.g. those in Figure 3) is not explored/discussed. The authors make stance/swing definitions based on the smoothed instantaneous velocity of the limb (with the tracking error threshold chosen as the separation threshold). While this is a sensible approach given the type data obtained here there is no analysis or discussion about how error in this value might affect the results found.</p><p>3) Previous studies have shown that limb coordination patterns in <italic>Drosophila</italic> are highly variable and that while there are changes with speed that the overall shifts are more continuous than observed in many other animals. The authors would be better served by not emphasizing how this work shows that flies do not exhibit discrete gaits and emphasizing more the structure of the manifold discovered and how it is relevant to locomotion.</p><p>4) The paper would be substantially improved if the coupled phase oscillator model were motivated and presented more clearly.</p><p>5) A common feature in the gait transition literature is hysteresis – the transition occurs at a different speed going from slow-to fast than fast-to-slow. Either adapting the analysis to include this potential effect (or explaining why it is not relevant here) is a necessary addition to the manuscript.</p><p>6) The spontaneous turning data from your other <italic>eLife</italic> submission and its relationship to the manifold described would enhance this paper and further take the emphasis off the current discrete gaits controversy. This is not a requirement but a suggestion.</p><p><italic>Reviewer #1:</italic> </p><p>Note: I am also a reviewer of your other <italic>eLife</italic> submission, so several of my comments will mirror those for that paper, due to the similarity of the methods used.</p><p>The manuscript by DeAngelis and colleagues investigates the repertoire of forward locomotion dynamics in the fruit fly (<italic>D. melanogaster</italic>) using a combination of limb tip and centroid tracking, dimensionality reduction, mathematical modeling, and neuronal perturbations. The key claims are that the speed of forward locomotion are controlled using a single control parameter, and that the traditional division of walking patterns into alternating tripod, tetrapod, and wave gaits is not apparent in spontaneous walking (and is, accordingly, better understood through the manifold framework proposed here). Lastly, the authors perform both optogenetic and sensory perturbations during spontaneous locomotion, finding that the flies altered their movements along the trajectory of the found manifold.</p><p>Overall, I thought that this manuscript was creatively performed and would be of general interest to the community. I do have some serious reservations about the findings, however, and would like to see some further analysis of the data before recommending publication. Specifically, I have questions about the authors' choice of embedding to find the manifold, the effects of footfall error on their results and interpretation of their results in light of gait hysteresis. If these concerns are resolved satisfactorily, however, I envision that this paper will be well-suited to publication in <italic>eLife</italic>.</p><p>1) After reading and digesting the paper (as well as the co-submitted paper), I remain a bit perplexed why the authors decided to use UMAP for the dimensionality reduction technique upon which many of their results lie. UMAP is well-suited for preserving topological features of a data set requiring warping of global metrics in order to preserve local topological structure. Despite this, the authors only use UMAP as a global coordinate, treating it like one often observed PCA (which does the opposite, preserving global metrics while warping local ones), pointing at directions where yaw or lateral or forward velocities alter. In fact, the results from Figure 2—figure supplement 1 in Zavatone-Veth et al. show that PCA actually does a better job of describing the full dynamic range of the variables than the UMAP does. As a result, it also would be interesting to see what PCA provides for the kinematic variables.</p><p>I don't make these points as merely a technicality, however. As many of the results in the paper come from this embedding, it is important to actually note what the structure of this manifold is. Moreover, the density within the manifold is not shown in any of the plots as well. Are there islands of high density with valleys in between? Or is It smoothly distributed? I think that more care is needed to more fully-characterize the manifold that is the one of the key mathematical descriptions in this manuscript (and is in fact in the title!).</p><p>2) Perhaps my largest concern with the paper, however, is the effect of error on gait definitions (e.g. those in Figure 3). The authors make stance/swing definitions based on the smoothed instantaneous velocity of the limb (with the tracking error threshold chosen as the separation threshold). While this is a sensible approach given the type data that they obtain here, as far as I saw in this manuscript at any rate, I did not see any discussion about how error in this value might affect the found results. This is rather important, as many of the disagreements with the previous literature about the discreteness of individual gaits rely on these measurements. I think that it would be important to see how the results change if the threshold for swing/stance was changed within some reasonable limits, or if swing/stance was assigned using a confidence (using, say, a logistic function of the limb speed). Specifically, I would be curious to see if the 2-wave vs. 3-wave and 6-wave results could be altered by changing this threshold.</p><p>That being said, the values for seem <italic>that</italic> far off. The results from Mendes et al., 2013, for example, are built upon a much more accurate measurement of swing/stance determination, since the footfalls are directly measured using frustrated total internal reflection (although the authors should please correct me if they feel this assessment is incorrect). The results in Figure 1 here are similar to those found in Figure 2 of that paper, so no major tweaking is likely needed, but some assessment of the effect of potential error is important. Relatedly, it might be useful to see what happens to the &quot;tripod index&quot; as defined in the Medes paper with the data collected here. Are the results replicated?</p><p>3) Related to both the previous comments, I think that in some senses, this paper is offering a potentially-false dichotomy between discrete and continuous gaits. For example, although the fly may have some preferred forward velocities or gaits that are peaks in the distribution, there may be non-zero valleys between them that, although rare, are important parts of the overall manifold that describes locomotion. For example, in Figure 4—figure supplement 1, the separate regions are potentially the result of the fact that there is <italic>no</italic> intermediate data. Because UMAP explicitly exaggerates topological differences, my guess is that the inclusion of a relatively small number of intermediate gaits will link the discrete rings together into something that looks more like the real data. I also worry that the phase error potentially-introduced from the uncertainty of the stance/swing transition time might affect the phase difference peaks in Figure 3 and Figure 3—figure supplements 1 and 2.</p><p>4) A common feature in the gait transition literature is hysteresis – the transition occurs at a different speed going from slow-to fast than fast-to-slow. All of the analyses here fundamentally assume that gait is a single-valued function of speed, however, which may cause for some misinterpretations of the data, since all spread of the distribution would just be assigned to a single mean value. Either adapting the analysis to include this potential effect (or explaining why it is not relevant here) is a necessary addition to the manuscript.</p><p><italic>Reviewer #2:</italic></p><p>In this paper, DeAngelis and colleagues investigate the temporal organization of the fly walking gait. They use a simple tracking algorithm to measure the body orientation and distal leg position of flies walking in a flat, featureless environment. They confirm previous observations that stance duration changes as a function of walking speed. They then extracted swing and stance phases from each leg and used these patterns to classify different walking gaits. They find that flies typically have three feet in stance (tripod gait), but they observe that flies occasionally (and transiently) have 4 or 5 feet in stance, particularly at low walking speeds. Contralateral limbs reliably swing in antiphase, while ipsilateral limb coordination vary a bit more. A low-dimensional embedding visualization of limb coordinates resulted in cyclic (global oscillator phase) and one linear coordinate (stepping frequency). Overall, this suite of analyses suggest that there is no clear differentiation of walking behavior into distinct gaits (e.g., tripod vs. tetrapod). The authors then construct a model that can predict the continuum of walking behavior by tuning of a single parameter. Finally, they find that perturbing walking behavior through activation of the Moonwalker Descending Neuron or visual stimulation alters stance duration, and thus induces a shift along the length of the walking manifold.</p><p>Overall, the paper is clearly organized and well-written. Although the subject of the fly walking gait is already well-trodden, this is certainly the most exhaustive and definitive treatment to date. I think it is a very strong paper and have only a handful of suggestions to improve it prior to publication.</p><p>1) My biggest point of confusion was the coupled phase oscillator model. The paper would be improved if this model were motivated and presented more clearly. The equations are not intuitive at first glance (e.g., the 1/sin terms, the discontinuous indicator functions); is there an easy interpretation of them? And does the specific form of the model matter? How is it related to the other coupled oscillator models in the literature? I would have liked to see a sensitivity analysis that provides some intuition for how the model works and which parameters matter. For example, τ<sub>stance</sub> is the relevant parameter that the authors tune to get different inter-limb coordination patterns, but this is not clearly explained (especially in the main text). Finally, how does this model contribute to our understanding or intuition of the control strategy used by the fly to coordinate walking? The authors should include a deeper discussion of the motivation for and interpretation of this model.</p><p><italic>Reviewer #3:</italic></p><p>This paper is notable for collecting a very comprehensive dataset of kinematic gait patterns in <italic>Drosophila</italic> over a wide range of spontaneous and evoked speed changes. While the optogenetic and visually induced changes are nice as supporting evidence, the core of the paper comes from a detailed and thorough gait analysis. As such the paper has some very good insights when connected to modern dimensionality reduction and some simple models of oscillations, but needs to distinguish itself carefully from the long history of papers that also do gait analysis especially in <italic>Drosophila</italic>.</p><p>1) The structure of the argument is that animals in general are thought to have distinct gaits. The authors cite a number of studies on larger legged animals for this, but in those cases walking is an out of phase oscillation of gravitational potential energy and kinetic energy (the inverted pendulum model) and running is in-phase oscillations (the spring-loaded inverted pendulum). The transition in gaits in many animals from insects to horses corresponds to the transition between these underlying dynamics If this transition is unlikely (although possible?) for <italic>Drosophila</italic> given their size, it is not clear why we would expect distinct gaits even if larger animals have them.</p><p>More critical to the conclusions drawn about <italic>Drosophila</italic>, previous studies (Wosnitza et al., 2012, and Mendes et al., 2013) My reading of these previous studies is that they show that limb coordination patterns in <italic>Drosophila</italic> are highly variable and that while there were changes with speed that the overall shifts are more continuous than observed in many other animals. These are cited in the paper but the relationship of their conclusions to this paper are only discussed superficially. For example Wosnitza et al., 2012 conclude that their findings &quot;imply that <italic>Drosophila</italic>'s walking behavior is more flexible than previously thought (Strauss and Heisenberg, 1990): there are no clearly separable gaits and, more specifically, the neural controller producing inter-leg coordination is not restricted to a fixed tripod pattern.&quot; This is very close to the initial conclusions of this paper.</p><p>So while some data from those studies do fit tetrapod and tripod gaits (as do some in this study), the conclusion that <italic>Drosophila</italic> use a variety kinematic patterns that encompass the canonical gaits is already somewhat established. Therefore the hypothesis of distinct gaits in this paper seems like a bit of a strawman. The authors do make some nice analyses of these data and show the point perhaps more convincingly than in previous work. However, prior to the manifold section, the initial presentation of the data did not leave me thinking that I had learned something new. I recognize that the authors may not agree with interpretations in previous works, but the onus is on the authors to clearly articulate what cannot be concluded from the previous work that their work in turn justifies.</p><p>More importantly this whole argument of distinct gaits takes away from what for me was the real impact of the paper. The central advance of the paper is the finding that kinematics patterns across a large range of speeds can collapse down onto a manifold with a single parameter governing speed variation. The authors are still making an advance here, but the motivation of the introduction and the conclusion of the first sentence of the Discussion highlight the continuum vs. discrete nature of <italic>Drosophila</italic> gaits. The emphasis should be about the manifold.</p><p>2) My concern about the manifold discussion is how this approach is different from the many other dimensionality reductions that have been done on gait. What really sets it apart from the t-SNE analyses of behavior that show all walking lying in a low dimensional cluster (Berman et al., 2014) and the reduced phase and oscillator models of stick insects and cockroaches (e.g. Couzin-Fuchs et al., 2015). I think there is novelty here but it must be articulated more in context.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.46409.036</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>There is much to interest the fly community and the greater neuroscience community in the thorough analysis presented and the interesting manifold structure described.</p><p>Several concerns detailed in the expert reviews should be addressed.</p><p>1) The UMAP embedding (dimensionality reduction) is well-suited for preserving topological features of a data set requiring warping of global metrics in order to preserve local topological structure. PCA may do a better job of describing the full dynamic range of the variables than the UMAP does. The authors should directly compare PCA to the UMAP manifold and should be very clear about what features of the data UMAP is preserving.</p></disp-quote><p>Thank you for this suggestion. We initially considered using PCA to visualize our locomotion dataset. Unfortunately, PCA does not provide a particularly clarifying description of the overall structure of variability in limb movement patterns. We have added a supplementary figure (Figure 4—figure supplement 1) to illustrate this point. The principal components of our limb kinematic data occur in degenerate, approximately phase-shifted pairs. Therefore, though the projection of these data into the first two principal components provides some information about their phasic structure, PCA does not allow for easy visualization of the full structure of variability in two or three dimensions. Specifically, the relationship between the projection and the frequency of stepping is multivalued.</p><p>We would like to highlight that the principal component analysis presented in the companion manuscript was performed on the body kinematic variables. Due to long-timescale correlations among those coordinates, the body kinematic data are approximately three-dimensional, even when segments of trajectories are embedded. Therefore, projection into two dimensions using PCA yields more informative results than the application of PCA to the higher-dimensional limb data. We have adjusted the prose to address the difficulties encountered with PCA and t-SNE, another commonly used dimensionality-reduction technique.</p><p>We acknowledge that UMAP is a relatively new dimensionality reduction technique. To further clarify the features of the data that are preserved by UMAP, we have added a supplementary figure (Figure 4—figure supplement 2) including the additional visualizations requested by Reviewer #1. We have also expanded the prose to more clearly describe the optimization performed by the UMAP algorithm. We have added citations to several other publications, notably (Becht et al., 2019), in which it was applied to reveal the global topology of high-dimensional gene expression data, consistent with its usage in this manuscript.</p><disp-quote content-type="editor-comment"><p>2) The effect of error on gait definitions (e.g. those in Figure 3) is not explored/discussed. The authors make stance/swing definitions based on the smoothed instantaneous velocity of the limb (with the tracking error threshold chosen as the separation threshold). While this is a sensible approach given the type data obtained here there is no analysis or discussion about how error in this value might affect the results found.</p></disp-quote><p>Thank you for this suggestion. We have taken two steps to address the sensitivity of the swing/stance analyses. First, the analyses presented in Figure 3 are independent of our determination of swing and stance, as the instantaneous phase measurements used throughout the figure are estimated directly from raw limb position time series. We have modified the prose to state this more clearly. Second, in Figure 2, the analyses presented do depend on swing/stance determinations. If one believed that measurement noise strongly affected these analyses, one would expect that lowering the separation threshold would accentuate the effect. To address this concern, we replicated Figure 2 using a separation threshold of 10 pixels per frame rather than 20 pixels per frame as in the main figure. As shown in <xref ref-type="fig" rid="respfig1">Author response image 1</xref>, the two-cycle in the instantaneous number of feet in stance is preserved even under halving of the separation threshold. Thus, we believe this analysis is relatively insensitive to measurement noise in our swing-stance definition. We have updated the prose in the manuscript to describe this sensitivity analysis.</p><fig id="respfig1"><label>Author response image 1.</label><caption><title>Replication of Figure 2 with halved swing/stance separation threshold.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-resp-fig1-v1.tif"/></fig><p>Following this comment, we also wanted to test whether our phase-based analyses were sensitive to noise in the limb measurements. To test the noise sensitivity of the discrete-time analytic signal method we used for phase estimation, we simulated a set of trajectories using our canonical gait model. As this phase estimation method is known to perform best with waveforms with duty cycle equal to 1/2 (Boashash and Reilly, 1992; Lamb and Stöckl, 2014), we chose to simulate canonical right tetrapod gaits, which have a duty cycle equal to 2/3, so that we tested the algorithm where it might not work as well. We then corrupted the resulting simulated limb position data with additive white Gaussian noise to yield signal-to-noise ratios (std of signal/std of noise) of 12.5 (matching Figure 3—figure supplement 1 and Figure 4—figure supplement 4; also roughly matching our estimate of the experimental signal to noise) and 1.25. Following the protocol applied to our experimental data, we then estimated the phase from these noisy traces and smoothed the resulting estimate using a third-order Savitzky-Golay filter. As shown in <xref ref-type="fig" rid="respfig2">Author response image 2</xref>, the spread of the relative phase distribution increased with decreasing SNR, but the location and number of modes were not qualitatively altered. Therefore, our phase estimation method appears to be relatively robust to noise.</p><fig id="respfig2"><label>Author response image 2.</label><caption><title>Analysis of phase extraction with high SNR (A and B) and low SNR (C and D).</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-resp-fig2-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>3) Previous studies have shown that limb coordination patterns in Drosophila are highly variable and that while there are changes with speed that the overall shifts are more continuous than observed in many other animals. The authors would be better served by not emphasizing how this work shows that flies do not exhibit discrete gaits and emphasizing more the structure of the manifold discovered and how it is relevant to locomotion.</p></disp-quote><p>We agree that previous studies have presented evidence that limb coordination patterns in <italic>Drosophila</italic> are highly variable, and believe that the primary contribution of our study is to characterize the structure of that variability. We have adjusted the prose throughout the manuscript to better reflect this understanding. In the literature, the structure of variability in walking patterns in many animals has most often been studied using the framework of distinct gaits, so we believe it is important to address the question of gaits. Indeed, this framework has persisted in the descriptions (Aminzare and Holmes, 2018; Aminzare et al., 2018; Mendes et al., 2013; Pereira et al., 2018; Strauss and Heisenberg, 1990) and analyses (Berman et al., 2014; Mendes et al., 2013; Pereira et al., 2018) used in the <italic>Drosophila</italic> locomotion literature, despite the observations of variable coordination patterns. We have therefore retained some analysis of and discussion of gaits, while simultaneously shifting the primary focus of the manuscript to describing the variability in coordination patterns. Adding results about spontaneous turning (Essential Revision 6) has also decreased the focus on gaits.</p><disp-quote content-type="editor-comment"><p>4) The paper would be substantially improved if the coupled phase oscillator model were motivated and presented more clearly.</p></disp-quote><p>Thank you for this suggestion. We have updated the main text and Materials and methods to clarify and motivate the description of the coupled phase oscillator model.</p><p>We have updated the prose to clarify the rule-based nature of the model, and its relation to conceptually similar rule-based algorithms for robot limb placement, such as (Kwak and McGhee, 1989; Song and Waldron, 1987; Wettergreen and Thorpe, 1992). To that end, we now present an algorithmic description in pseudocode. Additionally, we regret the lack of clarity surrounding the various model parameters. Parameters other than the stance duration are not critical to the model; we have updated the prose to clarify this. We therefore did not include analyses of the sensitivity to parameters other than the stance duration.</p><p>We have also updated the prose to better highlight the intuition generated by the model regarding the fly’s walking control strategy. Briefly, in this framework a single descending command conveying the desired stance duration would suffice to control the forward speed of the fly. This single control parameter permits a simpler control architecture than models in which inter-limb coupling is actively varied with walking speed. On each side of the fly, a posterior-to-anterior set of limb swings can be thought of as a single event. The two sides of the body are then coupled to each other in a manner that maintains a half-cycle difference in phase between contralateral limbs.</p><disp-quote content-type="editor-comment"><p>5) A common feature in the gait transition literature is hysteresis – the transition occurs at a different speed going from slow-to fast than fast-to-slow. Either adapting the analysis to include this potential effect (or explaining why it is not relevant here) is a necessary addition to the manuscript.</p></disp-quote><p>We agree that, based upon the literature, it is important to address the possibility of hysteresis in our experimental data. As we do not observe any evidence of multiple fixed points in our limb coordination data, it is difficult to directly address the question of hysteresis. To address the possibility that multiple preferred limb coordination patterns exist at certain speeds, we have added a supplementary figure (Figure 3—figure supplement 2) showing the distributions of pairwise relative phases conditioned with high resolution on forward velocity. At all forward walking speeds, these distributions are unimodal, which leads us to believe that our dataset does not include substantial hysteretic effects.</p><disp-quote content-type="editor-comment"><p>6) The spontaneous turning data from your other eLife submission and its relationship to the manifold described would enhance this paper and further take the emphasis off the current discrete gaits controversy. This is not a requirement but a suggestion.</p></disp-quote><p>Thank you for this suggestion. We agree that incorporating the spontaneous turning data originally presented in our rejected submission would enhance this paper, and have done so.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>Note: I am also a reviewer of your other eLife submission, so several of my comments will mirror those for that paper, due to the similarity of the methods used.</p><p>The manuscript by DeAngelis and colleagues investigates the repertoire of forward locomotion dynamics in the fruit fly (D. melanogaster) using a combination of limb tip and centroid tracking, dimensionality reduction, mathematical modeling, and neuronal perturbations. The key claims are that the speed of forward locomotion are controlled using a single control parameter, and that the traditional division of walking patterns into alternating tripod, tetrapod, and wave gaits is not apparent in spontaneous walking (and is, accordingly, better understood through the manifold framework proposed here). Lastly, the authors perform both optogenetic and sensory perturbations during spontaneous locomotion, finding that the flies altered their movements along the trajectory of the found manifold.</p><p>Overall, I thought that this manuscript was creatively performed and would be of general interest to the community. I do have some serious reservations about the findings, however, and would like to see some further analysis of the data before recommending publication. Specifically, I have questions about the authors' choice of embedding to find the manifold, the effects of footfall error on their results and interpretation of their results in light of gait hysteresis. If these concerns are resolved satisfactorily, however, I envision that this paper will be well-suited to publication in eLife.</p><p>1) After reading and digesting the paper (as well as the co-submitted paper), I remain a bit perplexed why the authors decided to use UMAP for the dimensionality reduction technique upon which many of their results lie. UMAP is well-suited for preserving topological features of a data set requiring warping of global metrics in order to preserve local topological structure. Despite this, the authors only use UMAP as a global coordinate, treating it like one often observed PCA (which does the opposite, preserving global metrics while warping local ones), pointing at directions where yaw or lateral or forward velocities alter. In fact, the results from Figure 2—figure supplement 1 in Zavatone-Veth et al. show that PCA actually does a better job of describing the full dynamic range of the variables than the UMAP does. As a result, it also would be interesting to see what PCA provides for the kinematic variables.</p><p>I don't make these points as merely a technicality, however. As many of the results in the paper come from this embedding, it is important to actually note what the structure of this manifold is. Moreover, the density within the manifold is not shown in any of the plots as well. Are there islands of high density with valleys in between? Or is It smoothly distributed? I think that more care is needed to more fully-characterize the manifold that is the one of the key mathematical descriptions in this manuscript (and is in fact in the title!).</p></disp-quote><p>Our primary response to this comment is under Essential Revision 1. To address the concerns regarding the specific structure of the manifold, we have added a supplementary figure (Figure 4—figure supplement 2) showing the parameterization of the manifold with cylindrical coordinates. Using this projection, we visualized the density of points within the manifold. The distribution along the phase dimension is roughly uniform. As one would expect given the nonuniform distribution of forward speeds, the density along the frequency dimension of the manifold is not uniform, though it changes smoothly. The projection into cylindrical coordinates also allows us to generate more easily interpretable visualizations relating the UMAP dimensions to limb phases and frequencies, as well as a clear visualization of how the radius of the manifold is related to the axial dimension.</p><disp-quote content-type="editor-comment"><p>2) Perhaps my largest concern with the paper, however, is the effect of error on gait definitions (e.g. those in Figure 3). The authors make stance/swing definitions based on the smoothed instantaneous velocity of the limb (with the tracking error threshold chosen as the separation threshold). While this is a sensible approach given the type data that they obtain here, as far as I saw in this manuscript at any rate, I did not see any discussion about how error in this value might affect the found results. This is rather important, as many of the disagreements with the previous literature about the discreteness of individual gaits rely on these measurements. I think that it would be important to see how the results change if the threshold for swing/stance was changed within some reasonable limits, or if swing/stance was assigned using a confidence (using, say, a logistic function of the limb speed). Specifically, I would be curious to see if the 2-wave vs. 3-wave and 6-wave results could be altered by changing this threshold.</p><p>That being said, the values for seem that far off. The results from Mendes et al., 2013, for example, are built upon a much more accurate measurement of swing/stance determination, since the footfalls are directly measured using frustrated total internal reflection (although the authors should please correct me if they feel this assessment is incorrect). The results in Figure 1 here are similar to those found in Figure 2 of that paper, so no major tweaking is likely needed, but some assessment of the effect of potential error is important. Relatedly, it might be useful to see what happens to the &quot;tripod index&quot; as defined in the Medes paper with the data collected here. Are the results replicated?</p></disp-quote><p>Our primary response is in the comments to Essential Revision 2. Specifically, the results regarding the 2-, 3-, and 6- wave results were preserved under halving of the separation threshold, suggesting that choice of threshold does not strongly influence this finding. Additionally, we have reproduced in <xref ref-type="fig" rid="respfig3">Author response image 3</xref> the gait index analysis from (Mendes et al., 2013) on the individual example trajectories presented in Figure 3F-G; that analysis is shown in <xref ref-type="fig" rid="respfig3">Author response image 3</xref>. Consistent with Mendes et al., 2013, we are capable of extracting individual trajectories with tripod-like and tetrapod-like characteristics under this measure. This, in combination with other presented analyses (Figures 1-2, specifically Figure 2C-D), suggests that our experimental data is largely consistent with data collected in previous studies of <italic>Drosophila</italic> walking. Importantly, the tetrapod-like patterns identified by this index are consistent with our smoothly varying generative model.</p><fig id="respfig3"><label>Author response image 3.</label><caption><title>Example trajectories with gait index analysis from Mendes et al., 2013.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-resp-fig3-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>3) Related to both the previous comments, I think that in some senses, this paper is offering a potentially-false dichotomy between discrete and continuous gaits. For example, although the fly may have some preferred forward velocities or gaits that are peaks in the distribution, there may be non-zero valleys between them that, although rare, are important parts of the overall manifold that describes locomotion. For example, in Figure 4—figure supplement 1, the separate regions are potentially the result of the fact that there is no intermediate data. Because UMAP explicitly exaggerates topological differences, my guess is that the inclusion of a relatively small number of intermediate gaits will link the discrete rings together into something that looks more like the real data. I also worry that the phase error potentially-introduced from the uncertainty of the stance/swing transition time might affect the phase difference peaks in Figure 3 and Figure 3—figure supplements 1 and 2.</p></disp-quote><p>Our primary response is in the comments to Essential Revision 3. Regarding the specific analysis presented in Figure 4—figure supplement 1, we would like to note that we do not view the UMAP embedding as a direct line of evidence for the absence of distinct gaits. Rather, it is an ancillary line of evidence that is consistent with the existence of the continuum suggested by the analyses presented in Figures 2 and 3. To generate an embedding comparison that provides direct evidence for the absence of distinct gaits, it would be necessary to have a model for the structure of gait transitions. However, there does not exist <italic>a priori</italic> a clear null model for intermediate coordination patterns, nor does our experimental data suggest such a model. In the absence of such a null model, Figure 4—figure supplement 1 presents the case in which transitions do not occur within the embedded segments of coordination patterns. We regret that we did not make this feature of the analysis clear in the original manuscript; in particular, the order in which the synthetic and empirical data embeddings were presented framed this analysis as a stronger hypothesis test than we believe it is. We have therefore revised the ordering of this section of the manuscript, and have added prose to clarify the intent of this analysis.</p><p>Additionally, we would like to clarify that we do not use the binary swing/stance variables to estimate limb phases; rather, we estimate limb phases directly from the raw limb positional time series using the discrete-time analytic signal method. As described in our response to Essential Revision 3, our investigation of the noise sensitivity of this method using synthetic data shows that measurement error leads to broader peaks in phase distributions but does not change the presence or locations of those peaks.</p><disp-quote content-type="editor-comment"><p>4) A common feature in the gait transition literature is hysteresis – the transition occurs at a different speed going from slow-to fast than fast-to-slow. All of the analyses here fundamentally assume that gait is a single-valued function of speed, however, which may cause for some misinterpretations of the data, since all spread of the distribution would just be assigned to a single mean value. Either adapting the analysis to include this potential effect (or explaining why it is not relevant here) is a necessary addition to the manuscript.</p></disp-quote><p>Our primary response is in the comments to Essential Revision 5. Based on our additional analysis, we have not found evidence for hysteresis in our dataset.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>In this paper, DeAngelis and colleagues investigate the temporal organization of the fly walking gait. They use a simple tracking algorithm to measure the body orientation and distal leg position of flies walking in a flat, featureless environment. They confirm previous observations that stance duration changes as a function of walking speed. They then extracted swing and stance phases from each leg and used these patterns to classify different walking gaits. They find that flies typically have three feet in stance (tripod gait), but they observe that flies occasionally (and transiently) have 4 or 5 feet in stance, particularly at low walking speeds. Contralateral limbs reliably swing in antiphase, while ipsilateral limb coordination vary a bit more. A low-dimensional embedding visualization of limb coordinates resulted in cyclic (global oscillator phase) and one linear coordinate (stepping frequency). Overall, this suite of analyses suggest that there is no clear differentiation of walking behavior into distinct gaits (e.g., tripod vs. tetrapod). The authors then construct a model that can predict the continuum of walking behavior by tuning of a single parameter. Finally, they find that perturbing walking behavior through activation of the Moonwalker Descending Neuron or visual stimulation alters stance duration, and thus induces a shift along the length of the walking manifold.</p><p>Overall, the paper is clearly organized and well-written. Although the subject of the fly walking gait is already well-trodden, this is certainly the most exhaustive and definitive treatment to date. I think it is a very strong paper and have only a handful of suggestions to improve it prior to publication.</p><p>1) My biggest point of confusion was the coupled phase oscillator model. The paper would be improved if this model were motivated and presented more clearly. The equations are not intuitive at first glance (e.g., the 1/sin terms, the discontinuous indicator functions); is there an easy interpretation of them? And does the specific form of the model matter? How is it related to the other coupled oscillator models in the literature? I would have liked to see a sensitivity analysis that provides some intuition for how the model works and which parameters matter. For example, τ<sub>stance</sub> is the relevant parameter that the authors tune to get different inter-limb coordination patterns, but this is not clearly explained (especially in the main text). Finally, how does this model contribute to our understanding or intuition of the control strategy used by the fly to coordinate walking? The authors should include a deeper discussion of the motivation for and interpretation of this model.</p></disp-quote><p>Thank you for this comment. We have addressed this comment in detail in the reply to Essential Revision 4 above.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>This paper is notable for collecting a very comprehensive dataset of kinematic gait patterns in Drosophila over a wide range of spontaneous and evoked speed changes. While the optogenetic and visually induced changes are nice as supporting evidence, the core of the paper comes from a detailed and thorough gait analysis. As such the paper has some very good insights when connected to modern dimensionality reduction and some simple models of oscillations, but needs to distinguish itself carefully from the long history of papers that also do gait analysis especially in Drosophila.</p><p>1) The structure of the argument is that animals in general are thought to have distinct gaits. The authors cite a number of studies on larger legged animals for this, but in those cases walking is an out of phase oscillation of gravitational potential energy and kinetic energy (the inverted pendulum model) and running is in-phase oscillations (the spring-loaded inverted pendulum). The transition in gaits in many animals from insects to horses corresponds to the transition between these underlying dynamics If this transition is unlikely (although possible?) for Drosophila given their size, it is not clear why we would expect distinct gaits even if larger animals have them.</p><p>More critical to the conclusions drawn about Drosophila, previous studies (Wosnitza, et al., 2012, and Mendes, et al., 2013) My reading of these previous studies is that they show that limb coordination patterns in Drosophila are highly variable and that while there were changes with speed that the overall shifts are more continuous than observed in many other animals. These are cited in the paper but the relationship of their conclusions to this paper are only discussed superficially. For example Wosnitza, et al., 2012 conclude that their findings &quot;imply that Drosophila's walking behavior is more flexible than previously thought (Strauss and Heisenberg, 1990): there are no clearly separable gaits and, more specifically, the neural controller producing inter-leg coordination is not restricted to a fixed tripod pattern.&quot; This is very close to the initial conclusions of this paper.</p><p>So while some data from those studies do fit tetrapod and tripod gaits (as do some in this study), the conclusion that Drosophila use a variety kinematic patterns that encompass the canonical gaits is already somewhat established. Therefore the hypothesis of distinct gaits in this paper seems like a bit of a strawman. The authors do make some nice analyses of these data and show the point perhaps more convincingly than in previous work. However, prior to the manifold section, the initial presentation of the data did not leave me thinking that I had learned something new. I recognize that the authors may not agree with interpretations in previous works, but the onus is on the authors to clearly articulate what cannot be concluded from the previous work that their work in turn justifies.</p><p>More importantly this whole argument of distinct gaits takes away from what for me was the real impact of the paper. The central advance of the paper is the finding that kinematics patterns across a large range of speeds can collapse down onto a manifold with a single parameter governing speed variation. The authors are still making an advance here, but the motivation of the introduction and the conclusion of the first sentence of the Discussion highlight the continuum vs. discrete nature of Drosophila gaits. The emphasis should be about the manifold.</p></disp-quote><p>Our primary response to this comment is with Essential Revision 3. We have followed the suggestions of the reviewer and made the manifold structure the primary emphasis of the paper.</p><disp-quote content-type="editor-comment"><p>2) My concern about the manifold discussion is how this approach is different from the many other dimensionality reductions that have been done on gait. What really sets it apart from the t-SNE analyses of behavior that show all walking lying in a low dimensional cluster (Berman, et al., 2014) and the reduced phase and oscillator models of stick insects and cockroaches (e.g. Couzin-Fuchs, et al., 2015). I think there is novelty here but it must be articulated more in context.</p></disp-quote><p>Our main response to this is included with Essential Revision 1. We have updated the prose to expand our discussion of the relative benefits of UMAP over previous dimensionality reduction techniques. In particular, because t-SNE is designed to emphasize local rather than global structure, it does not immediately capture the periodic dynamics of legged locomotion, which UMAP highlights (Becht et al., 2019; McInnes et al., 2018). Furthermore, UMAP has been shown to produce embeddings that are more reproduceable across data samples and subsample sizes than those obtained using t-SNE (Becht et al., 2019).</p><p>To compare the results of applying t-SNE with those obtained using UMAP, we used the fast interpolation-based algorithm for t-SNE introduced in (Linderman et al., 2017) to generate embeddings of our limb kinematic data. Following standard practices, we used the standard target dimensionality for t-SNE (two) and a perplexity of 100, and reduced the dimensionality of the input data to 50 using PCA prior to applying t-SNE (Becht et al., 2019; Berman et al., 2014; Linderman et al., 2017; Van Der Maaten, 2014). As shown in <xref ref-type="fig" rid="respfig4">Author response image 4, t</xref>-SNE does capture some of the frequency structure of the manifold produced by UMAP, but, unlike UMAP, it produces an embedding that appears segmented.</p><p>We wanted to better understand whether this segmentation arose from features of the data or features of the algorithm. We therefore applied the identical analysis to data generated by our model. By construction, the high-dimensional data manifold produced by the model is continuous. However, the t-SNE embedding of the model data is also segmented, suggesting that the structure observed in the embedding of experimental data could result from the analysis itself rather than the underlying structure of the data (<xref ref-type="fig" rid="respfig4">Author response image 4</xref>). This result makes sense given that t-SNE is explicitly designed to emphasize local similarities in the high-dimensional data at the expense of large-scale structure (Van Der Maaten, 2014). This is in some ways opposite to the purpose of UMAP, which is designed to preserve both local and large scale structure in the data. Therefore, unlike UMAP, the application of t-SNE to our limb kinematic data does not produce results that are immediately interpretable. Since the goal of our dimensionality reduction analysis is to visualize the global structure of our data, the interpretability of the embedding is key.</p><fig id="respfig4"><label>Author response image 4.</label><caption><title>t-SNE embedding of limb position data, colored by forward walking speed.</title><p>(<bold>A</bold>) shows experimental limb positional data, while (<bold>B</bold>) shows data generated using the continuum model presented in Figure 5 of the manuscript.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-46409-resp-fig4-v1.tif"/></fig></body></sub-article></article>