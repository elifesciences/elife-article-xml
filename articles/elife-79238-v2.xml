<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">79238</article-id><article-id pub-id-type="doi">10.7554/eLife.79238</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Genetics and Genomics</subject></subj-group></article-categories><title-group><article-title>Limitations of principal components in quantitative genetic association models for human studies</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-276035"><name><surname>Yao</surname><given-names>Yiqi</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-275581"><name><surname>Ochoa</surname><given-names>Alejandro</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4928-3403</contrib-id><email>alejandro.ochoa@duke.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00py81415</institution-id><institution>Department of Biostatistics and Bioinformatics, Duke University</institution></institution-wrap><addr-line><named-content content-type="city">Durham</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00py81415</institution-id><institution>Duke Center for Statistical Genetics and Genomics, Duke University</institution></institution-wrap><addr-line><named-content content-type="city">Durham</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Nordborg</surname><given-names>Magnus</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05twjp994</institution-id><institution>Gregor Mendel Institute</institution></institution-wrap><country>Austria</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0243gzr89</institution-id><institution>Max Planck Institute for Biology Tübingen</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>BenHealth Consulting, Shanghai, Shanghai, China</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>04</day><month>05</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e79238</elocation-id><history><date date-type="received" iso-8601-date="2022-04-04"><day>04</day><month>04</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-05-04"><day>04</day><month>05</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-03-27"><day>27</day><month>03</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.03.25.485885"/></event></pub-history><permissions><copyright-statement>© 2023, Yao and Ochoa</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Yao and Ochoa</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-79238-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-79238-figures-v2.pdf"/><abstract><p>Principal Component Analysis (PCA) and the Linear Mixed-effects Model (LMM), sometimes in combination, are the most common genetic association models. Previous PCA-LMM comparisons give mixed results, unclear guidance, and have several limitations, including not varying the number of principal components (PCs), simulating simple population structures, and inconsistent use of real data and power evaluations. We evaluate PCA and LMM both varying number of PCs in realistic genotype and complex trait simulations including admixed families, subpopulation trees, and real multiethnic human datasets with simulated traits. We find that LMM without PCs usually performs best, with the largest effects in family simulations and real human datasets and traits without environment effects. Poor PCA performance on human datasets is driven by large numbers of distant relatives more than the smaller number of closer relatives. While PCA was known to fail on family data, we report strong effects of family relatedness in genetically diverse human datasets, not avoided by pruning close relatives. Environment effects driven by geography and ethnicity are better modeled with LMM including those labels instead of PCs. This work better characterizes the severe limitations of PCA compared to LMM in modeling the complex relatedness structures of multiethnic human data for association studies.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>genetic association</kwd><kwd>statistical genetics</kwd><kwd>population structure</kwd><kwd>cryptic relatedness</kwd><kwd>complex quantitative traits</kwd><kwd>multiethnic human data and simulations</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100020186</institution-id><institution>Whitehead Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Ochoa</surname><given-names>Alejandro</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>It is always better to use mixed effects models over principal components association regression for genetic association studies of continuous traits, since the former models family structure and close relatives are always found in real human studies.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The goal of a genetic association study is to identify loci whose genotype variation is significantly correlated to given trait. Naive association tests assume that genotypes are drawn independently from a common allele frequency. This assumption does not hold for structured populations, which includes multiethnic cohorts and admixed individuals (ancient relatedness), and for family data (recent relatedness; <xref ref-type="bibr" rid="bib8">Astle and Balding, 2009</xref>). Association studies of admixed and multiethnic cohorts, the focus of this work, are becoming more common, are believed to be more powerful, and are necessary to bring more equity to genetic medicine (<xref ref-type="bibr" rid="bib86">Rosenberg et al., 2010</xref>; <xref ref-type="bibr" rid="bib33">Hoffman and Dubé, 2013</xref>; <xref ref-type="bibr" rid="bib19">Coram et al., 2013</xref>; <xref ref-type="bibr" rid="bib63">Medina-Gomez et al., 2015</xref>; <xref ref-type="bibr" rid="bib17">Conomos et al., 2016a</xref>; <xref ref-type="bibr" rid="bib32">Hodonsky et al., 2017</xref>; <xref ref-type="bibr" rid="bib58">Martin et al., 2017a</xref>; <xref ref-type="bibr" rid="bib59">Martin et al., 2017b</xref>; <xref ref-type="bibr" rid="bib31">Hindorff et al., 2018</xref>; <xref ref-type="bibr" rid="bib34">Hoffmann et al., 2018</xref>; <xref ref-type="bibr" rid="bib64">Mogil et al., 2018</xref>; <xref ref-type="bibr" rid="bib84">Roselli et al., 2018</xref>; <xref ref-type="bibr" rid="bib106">Wojcik et al., 2019</xref>; <xref ref-type="bibr" rid="bib76">Peterson et al., 2019</xref>; <xref ref-type="bibr" rid="bib120">Zhong et al., 2019</xref>; <xref ref-type="bibr" rid="bib37">Hu et al., 2020</xref>; <xref ref-type="bibr" rid="bib89">Simonin-Wilmer et al., 2021</xref>; <xref ref-type="bibr" rid="bib41">Kamariza et al., 2021</xref>; <xref ref-type="bibr" rid="bib48">Lin et al., 2021</xref>; <xref ref-type="bibr" rid="bib55">Mahajan et al., 2022</xref>; <xref ref-type="bibr" rid="bib35">Hou et al., 2023a</xref>). When insufficient approaches are applied to data with relatedness, their association statistics are miscalibrated, resulting in excess false positives and loss of power (<xref ref-type="bibr" rid="bib20">Devlin and Roeder, 1999</xref>; <xref ref-type="bibr" rid="bib104">Voight and Pritchard, 2005</xref>; <xref ref-type="bibr" rid="bib8">Astle and Balding, 2009</xref>). Therefore, many specialized approaches have been developed for genetic association under relatedness, of which PCA and LMM are the most popular.</p><p>Genetic association with PCA consists of including the top eigenvectors of the population kinship matrix as covariates in a generalized linear model (<xref ref-type="bibr" rid="bib115">Zhang et al., 2003</xref>; <xref ref-type="bibr" rid="bib77">Price et al., 2006</xref>; <xref ref-type="bibr" rid="bib12">Bouaziz et al., 2011</xref>). These top eigenvectors are a new set of coordinates for individuals that are commonly referred to as PCs in genetics (<xref ref-type="bibr" rid="bib74">Patterson et al., 2006</xref>), the convention adopted here, but in other fields PCs instead denote what in genetics would be the projections of loci onto eigenvectors, which are new independent coordinates for loci (<xref ref-type="bibr" rid="bib40">Jolliffe, 2002</xref>). The direct ancestor of PCA association is structured association, in which inferred ancestry (genetic cluster membership, often corresponding with labels such as “European”, “African”, “Asian”, etc.) or admixture proportions of these ancestries are used as regression covariates (<xref ref-type="bibr" rid="bib80">Pritchard et al., 2000</xref>). These models are deeply connected because PCs map to ancestry empirically (<xref ref-type="bibr" rid="bib6">Alexander et al., 2009</xref>; <xref ref-type="bibr" rid="bib122">Zhou et al., 2016</xref>) and theoretically (<xref ref-type="bibr" rid="bib62">McVean, 2009</xref>; <xref ref-type="bibr" rid="bib119">Zheng and Weir, 2016</xref>; <xref ref-type="bibr" rid="bib13">Cabreros and Storey, 2019</xref>; <xref ref-type="bibr" rid="bib16">Chiu et al., 2022</xref>), and they work as well as global ancestry in association studies but are estimated more easily (<xref ref-type="bibr" rid="bib74">Patterson et al., 2006</xref>; <xref ref-type="bibr" rid="bib118">Zhao et al., 2007</xref>; <xref ref-type="bibr" rid="bib6">Alexander et al., 2009</xref>; <xref ref-type="bibr" rid="bib12">Bouaziz et al., 2011</xref>). Another approach closely related to PCA is nonmetric multidimensional scaling (<xref ref-type="bibr" rid="bib124">Zhu and Yu, 2009</xref>). PCs are also proposed for modeling environment effects that are correlated to ancestry, for example, through geography (<xref ref-type="bibr" rid="bib66">Novembre et al., 2008</xref>; <xref ref-type="bibr" rid="bib117">Zhang and Pan, 2015</xref>; <xref ref-type="bibr" rid="bib48">Lin et al., 2021</xref>). The strength of PCA is its simplicity, which as covariates can be readily included in more complex models, such as haplotype association (<xref ref-type="bibr" rid="bib109">Xu and Guan, 2014</xref>) and polygenic models (<xref ref-type="bibr" rid="bib82">Qian et al., 2020</xref>). However, PCA assumes that the underlying relatedness space is low dimensional (or low rank), so it can be well modeled with a small number of PCs, which may limit its applicability. PCA is known to be inadequate for family data (<xref ref-type="bibr" rid="bib74">Patterson et al., 2006</xref>; <xref ref-type="bibr" rid="bib124">Zhu and Yu, 2009</xref>; <xref ref-type="bibr" rid="bib101">Thornton and McPeek, 2010</xref>; <xref ref-type="bibr" rid="bib78">Price et al., 2010</xref>), which is called ‘cryptic relatedness’ when it is unknown to the researchers, but no other troublesome cases have been confidently identified. Recent work has focused on developing more scalable versions of the PCA algorithm (<xref ref-type="bibr" rid="bib47">Lee et al., 2012</xref>; <xref ref-type="bibr" rid="bib3">Abraham and Inouye, 2014</xref>; <xref ref-type="bibr" rid="bib23">Galinsky et al., 2016</xref>; <xref ref-type="bibr" rid="bib4">Abraham et al., 2017</xref>; <xref ref-type="bibr" rid="bib5">Agrawal et al., 2020</xref>). PCA remains a popular and powerful approach for association studies.</p><p>The other dominant association model under relatedness is the LMM, which includes a random effect parameterized by the kinship matrix. Unlike PCA, LMM does not assume that relatedness is low-dimensional, and explicitly models families via the kinship matrix. Early LMMs used kinship matrices estimated from known pedigrees or using methods that captured recent relatedness only, and modeled population structure (ancestry) as fixed effects (<xref ref-type="bibr" rid="bib112">Yu et al., 2006</xref>; <xref ref-type="bibr" rid="bib118">Zhao et al., 2007</xref>; <xref ref-type="bibr" rid="bib124">Zhu and Yu, 2009</xref>). Modern LMMs estimate kinship from genotypes using a non-parametric estimator, often referred to as a genetic relationship matrix, that captures the combined covariance due to family relatedness and ancestry (<xref ref-type="bibr" rid="bib42">Kang et al., 2008</xref>; <xref ref-type="bibr" rid="bib8">Astle and Balding, 2009</xref>; <xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>). Like PCA, LMM has also been proposed for modeling environment correlated to genetics (<xref ref-type="bibr" rid="bib103">Vilhjálmsson and Nordborg, 2013</xref>; <xref ref-type="bibr" rid="bib105">Wang et al., 2022</xref>). The classic LMM assumes a quantitative (continuous) complex trait, the focus of our work. Although case-control (binary) traits and their underlying ascertainment are theoretically a challenge (<xref ref-type="bibr" rid="bib111">Yang et al., 2014</xref>), LMMs have been applied successfully to balanced case-control studies (<xref ref-type="bibr" rid="bib8">Astle and Balding, 2009</xref>; <xref ref-type="bibr" rid="bib43">Kang et al., 2010</xref>) and simulations (<xref ref-type="bibr" rid="bib78">Price et al., 2010</xref>; <xref ref-type="bibr" rid="bib108">Wu et al., 2011</xref>; <xref ref-type="bibr" rid="bib97">Sul and Eskin, 2013</xref>), and have been adapted for unbalanced case-control studies (<xref ref-type="bibr" rid="bib123">Zhou et al., 2018</xref>). However, LMMs tend to be considerably slower than PCA and other models, so much effort has focused on improving their runtime and scalability (<xref ref-type="bibr" rid="bib9">Aulchenko et al., 2007</xref>; <xref ref-type="bibr" rid="bib42">Kang et al., 2008</xref>; <xref ref-type="bibr" rid="bib43">Kang et al., 2010</xref>; <xref ref-type="bibr" rid="bib116">Zhang et al., 2010</xref>; <xref ref-type="bibr" rid="bib49">Lippert et al., 2011</xref>; <xref ref-type="bibr" rid="bib110">Yang et al., 2011</xref>; <xref ref-type="bibr" rid="bib50">Listgarten et al., 2012</xref>; <xref ref-type="bibr" rid="bib121">Zhou and Stephens, 2012</xref>; <xref ref-type="bibr" rid="bib100">Svishcheva et al., 2012</xref>; <xref ref-type="bibr" rid="bib53">Loh et al., 2015</xref>; <xref ref-type="bibr" rid="bib123">Zhou et al., 2018</xref>).</p><p>An LMM variant that incorporates PCs as fixed covariates is tested thoroughly in our work. Since PCs are the top eigenvectors of the same kinship matrix estimate used in modern LMMs (<xref ref-type="bibr" rid="bib8">Astle and Balding, 2009</xref>; <xref ref-type="bibr" rid="bib39">Janss et al., 2012</xref>; <xref ref-type="bibr" rid="bib33">Hoffman and Dubé, 2013</xref>; <xref ref-type="bibr" rid="bib117">Zhang and Pan, 2015</xref>), then population structure is modeled twice in an LMM with PCs. However, some previous work has found the apparent redundancy of an LMM with PCs beneficial (<xref ref-type="bibr" rid="bib78">Price et al., 2010</xref>; <xref ref-type="bibr" rid="bib102">Tucker et al., 2014</xref>; <xref ref-type="bibr" rid="bib117">Zhang and Pan, 2015</xref>), while others did not (<xref ref-type="bibr" rid="bib51">Liu et al., 2011</xref>; <xref ref-type="bibr" rid="bib39">Janss et al., 2012</xref>), and the approach continues to be used (<xref ref-type="bibr" rid="bib114">Zeng et al., 2018</xref>; <xref ref-type="bibr" rid="bib61">Mbatchou et al., 2021</xref>), although not always (<xref ref-type="bibr" rid="bib60">Matoba et al., 2020</xref>). Recall that early LMMs used kinship to model family relatedness only, so population structure had to be modeled separately in those models, in practice as admixture fractions instead of PCs (<xref ref-type="bibr" rid="bib112">Yu et al., 2006</xref>; <xref ref-type="bibr" rid="bib118">Zhao et al., 2007</xref>; <xref ref-type="bibr" rid="bib124">Zhu and Yu, 2009</xref>). The LMM with PCs (vs no PCs) is also believed to help better model loci that have experienced selection (<xref ref-type="bibr" rid="bib78">Price et al., 2010</xref>; <xref ref-type="bibr" rid="bib103">Vilhjálmsson and Nordborg, 2013</xref>) and environment effects correlated with genetics (<xref ref-type="bibr" rid="bib117">Zhang and Pan, 2015</xref>).</p><p>LMM and PCA are closely related models (<xref ref-type="bibr" rid="bib8">Astle and Balding, 2009</xref>; <xref ref-type="bibr" rid="bib39">Janss et al., 2012</xref>; <xref ref-type="bibr" rid="bib33">Hoffman and Dubé, 2013</xref>; <xref ref-type="bibr" rid="bib117">Zhang and Pan, 2015</xref>), so similar performance is expected particularly under low-dimensional relatedness. Direct comparisons have yielded mixed results, with several studies finding superior performance for LMM, notably from papers promoting advances in LMMs, while many others report comparable performance (<xref ref-type="table" rid="table1">Table 1</xref>). No papers find that PCA outperforms LMM decisively, although PCA occasionally performs better in isolated and artificial cases or individual measures, often with unknown significance. Previous studies generally used either only simulated or only real genotypes, with only two studies using both. The simulated genotype studies, which tended to have low model dimensions and <inline-formula><mml:math id="inf1"><mml:msub><mml:mi>F</mml:mi><mml:mtext>ST</mml:mtext></mml:msub></mml:math></inline-formula>, were more likely to report ties or mixed results (6/8), whereas real genotypes tended to clearly favor LMMs (9/11). Similarly, 10/12 papers with quantitative traits favor LMMs, whereas 6/9 papers with case-control traits gave ties or mixed results—the only factor we do not explore in this work. Additionally, although all previous evaluations measured type I error (or proxies such as genomic inflation factors <xref ref-type="bibr" rid="bib20">Devlin and Roeder, 1999</xref> or QQ plots), a large fraction (6/17) did not measure power (or proxies such as ROC curves), and only four used more than one number of PCs for PCA. Lastly, no consensus has emerged as to why LMM might outperform PCA or vice versa (<xref ref-type="bibr" rid="bib78">Price et al., 2010</xref>; <xref ref-type="bibr" rid="bib97">Sul and Eskin, 2013</xref>; <xref ref-type="bibr" rid="bib79">Price et al., 2013</xref>; <xref ref-type="bibr" rid="bib33">Hoffman and Dubé, 2013</xref>), or which features of the real datasets are critical for the LMM advantage other than family relatedness, resulting in unclear guidance for using PCA. Hence, our work includes real and simulated genotypes with higher model dimensions and <inline-formula><mml:math id="inf2"><mml:msub><mml:mi>F</mml:mi><mml:mtext>ST</mml:mtext></mml:msub></mml:math></inline-formula> matching that of multiethnic human cohorts (<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>; <xref ref-type="bibr" rid="bib67">Ochoa and Storey, 2019</xref>), we vary the number of PCs, and measure robust proxies for type I error control and calibrated power.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Previous PCA-LMM evaluations in the literature.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom" colspan="3">Sim. Genotypes</th><th align="left" valign="bottom">General</th><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom"/></tr><tr><th align="left" valign="bottom">Publication</th><th align="left" valign="bottom">Type<xref ref-type="table-fn" rid="table1fn1">*</xref></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf3"><mml:mi>K</mml:mi></mml:math></inline-formula><xref ref-type="table-fn" rid="table1fn2"><sup>†</sup></xref></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf4"><mml:msub><mml:mi>F</mml:mi><mml:mtext>ST</mml:mtext></mml:msub></mml:math></inline-formula><xref ref-type="table-fn" rid="table1fn3"><sup>‡</sup></xref></th><th align="left" valign="bottom">Real <xref ref-type="table-fn" rid="table1fn4"><sup>§</sup></xref></th><th align="left" valign="bottom">Trait <xref ref-type="table-fn" rid="table1fn5"><sup>¶</sup></xref></th><th align="left" valign="bottom">Power</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom">Best</th></tr></thead><tbody><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib118">Zhao et al., 2007</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Q</td><td align="left" valign="bottom">✓</td><td align="char" char="." valign="bottom">8</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib124">Zhu and Yu, 2009</xref></td><td align="left" valign="bottom">I, A, F</td><td align="char" char="." valign="bottom">3, 8</td><td align="char" char="." valign="bottom">≤0.15</td><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Q</td><td align="left" valign="bottom">✓</td><td align="char" char="ndash" valign="bottom">1–22</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib8">Astle and Balding, 2009</xref></td><td align="left" valign="bottom">I</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">0.10</td><td align="left" valign="bottom"/><td align="left" valign="bottom">CC</td><td align="left" valign="bottom">✓</td><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib43">Kang et al., 2010</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Both</td><td align="left" valign="bottom"/><td align="char" char="ndash" valign="bottom">2–100</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib78">Price et al., 2010</xref></td><td align="left" valign="bottom">I, F</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">0.01</td><td align="left" valign="bottom"/><td align="left" valign="bottom">CC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">Mixed</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib108">Wu et al., 2011</xref></td><td align="left" valign="bottom">I, A</td><td align="char" char="ndash" valign="bottom">2–4</td><td align="char" char="." valign="bottom">0.01</td><td align="left" valign="bottom"/><td align="left" valign="bottom">CC</td><td align="left" valign="bottom">✓</td><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom">Mixed</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib51">Liu et al., 2011</xref></td><td align="left" valign="bottom">S, A</td><td align="char" char="ndash" valign="bottom">2–3</td><td align="left" valign="bottom">R</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Q</td><td align="left" valign="bottom">✓</td><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib97">Sul and Eskin, 2013</xref></td><td align="left" valign="bottom">I</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">0.01</td><td align="left" valign="bottom"/><td align="left" valign="bottom">CC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib102">Tucker et al., 2014</xref></td><td align="left" valign="bottom">I</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">0.05</td><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Both</td><td align="left" valign="bottom">✓</td><td align="char" char="." valign="bottom">5</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib111">Yang et al., 2014</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">CC</td><td align="left" valign="bottom">✓</td><td align="char" char="." valign="bottom">5</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib93">Song et al., 2015</xref></td><td align="left" valign="bottom">S, A</td><td align="char" char="ndash" valign="bottom">2–3</td><td align="left" valign="bottom">R</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Q</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib53">Loh et al., 2015</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Q</td><td align="left" valign="bottom">✓</td><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib117">Zhang and Pan, 2015</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Q</td><td align="left" valign="bottom">✓</td><td align="char" char="ndash" valign="bottom">20–100</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib52">Liu et al., 2016</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Q</td><td align="left" valign="bottom">✓</td><td align="char" char="ndash" valign="bottom">3–6</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib98">Sul et al., 2018</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Q</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib54">Loh et al., 2018</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Both</td><td align="left" valign="bottom">✓</td><td align="char" char="." valign="bottom">20</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib61">Mbatchou et al., 2021</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Both</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">This work</td><td align="left" valign="bottom">A, T, F</td><td align="char" char="ndash" valign="bottom">10–243</td><td align="char" char="." valign="bottom">≤0.25</td><td align="left" valign="bottom">✓</td><td align="left" valign="bottom">Q</td><td align="left" valign="bottom">✓</td><td align="char" char="ndash" valign="bottom">0–90</td><td align="left" valign="bottom">LMM</td></tr></tbody></table><table-wrap-foot><fn id="table1fn1"><label>*</label><p>Genotype simulation types. I: Independent subpopulations; S: subpopulations (with parameters drawn from real data); A: Admixture; T: Subpopulation Tree; F: Family.</p></fn><fn id="table1fn2"><label>†</label><p>Model dimension (number of subpopulations or ancestries).</p></fn><fn id="table1fn3"><label>‡</label><p>R: simulated parameters based on real data, <inline-formula><mml:math id="inf6"><mml:msub><mml:mi>F</mml:mi><mml:mtext>ST</mml:mtext></mml:msub></mml:math></inline-formula> not reported.</p></fn><fn id="table1fn4"><label>§</label><p>Evaluations using unmodified real genotypes.</p></fn><fn id="table1fn5"><label>¶</label><p>Q: quantitative; CC: case-control.</p></fn></table-wrap-foot></table-wrap><p>In this work, we evaluate the PCA and LMM association models under various numbers of PCs, which are included in LMMs too. We use genotype simulations (admixture, family, and subpopulation tree models) and three real datasets: the 1000 Genomes Project (<xref ref-type="bibr" rid="bib1">Abecasis et al., 2010</xref>; <xref ref-type="bibr" rid="bib2">Abecasis et al., 2012</xref>), the Human Genome Diversity Panel (HGDP) (<xref ref-type="bibr" rid="bib14">Cann et al., 2002</xref>; <xref ref-type="bibr" rid="bib85">Rosenberg et al., 2002</xref>; <xref ref-type="bibr" rid="bib11">Bergström et al., 2020</xref>), and Human Origins (<xref ref-type="bibr" rid="bib75">Patterson et al., 2012</xref>; <xref ref-type="bibr" rid="bib45">Lazaridis et al., 2014</xref>; <xref ref-type="bibr" rid="bib46">Lazaridis et al., 2016</xref>; <xref ref-type="bibr" rid="bib91">Skoglund et al., 2016</xref>). We simulate quantitative traits from two models: fixed effect sizes (FES) construct coefficients inverse to allele frequency, which matches real data (<xref ref-type="bibr" rid="bib73">Park et al., 2011</xref>; <xref ref-type="bibr" rid="bib114">Zeng et al., 2018</xref>; <xref ref-type="bibr" rid="bib70">O’Connor et al., 2019</xref>) and corresponds to high pleiotropy and strong balancing selection (<xref ref-type="bibr" rid="bib90">Simons et al., 2018</xref>) and strong negative selection (<xref ref-type="bibr" rid="bib114">Zeng et al., 2018</xref>; <xref ref-type="bibr" rid="bib70">O’Connor et al., 2019</xref>), which are appropriate assumptions for diseases; and random coefficients (RC), which are drawn independent of allele frequency, and corresponds to neutral traits (<xref ref-type="bibr" rid="bib114">Zeng et al., 2018</xref>; <xref ref-type="bibr" rid="bib90">Simons et al., 2018</xref>). LMM without PCs consistently performs best in simulations without environment, and greatly outperforms PCA in the family simulation and in all real datasets. The tree simulations, which model subpopulations with the tree but exclude family structure, do not recapitulate the real data results, suggesting that family relatedness in real data is the reason for poor PCA performance. Lastly, removing up to 4th degree relatives in the real datasets recapitulates poor PCA performance, showing that the more numerous distant relatives explain the result, and suggesting that PCA is generally not an appropriate model for real data. We find that both LMM and PCA are able to model environment effects correlated with genetics, and LMM with PCs gains a small advantage in this setting only, but direct modeling of environment performs much better. All together, we find that LMMs without PCs are generally a preferable association model, and present novel simulation and evaluation approaches to measure the performance of these and other genetic association approaches.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Overview of evaluations</title><p>We use three real genotype datasets and simulated genotypes from six population structure scenarios to cover various features of interest (<xref ref-type="table" rid="table2">Table 2</xref>). We introduce them in sets of three, as they appear in the rest of our results. Population kinship matrices, which combine population and family relatedness, are estimated without bias using popkin (<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>; <xref ref-type="fig" rid="fig1">Figure 1</xref>). The first set of three simulated genotypes are based on an admixture model with 10 ancestries (<xref ref-type="fig" rid="fig1">Figure 1A</xref>; <xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>; <xref ref-type="bibr" rid="bib25">Gopalan et al., 2016</xref>; <xref ref-type="bibr" rid="bib13">Cabreros and Storey, 2019</xref>). The ‘large’ version (1000 individuals) illustrates asymptotic performance, while the ‘small’ simulation (100 individuals) illustrates model overfitting. The ‘family’ simulation has admixed founders and draws a 20-generation random pedigree with assortative mating, resulting in a complex joint family and ancestry structure in the last generation (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The second set of three are the real human datasets representing global human diversity: Human Origins (<xref ref-type="fig" rid="fig1">Figure 1D</xref>), HGDP (<xref ref-type="fig" rid="fig1">Figure 1G</xref>), and 1000 Genomes (<xref ref-type="fig" rid="fig1">Figure 1J</xref>), which are enriched for small minor allele frequencies even after MAF &lt;1% filter (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Last are subpopulation tree simulations (<xref ref-type="fig" rid="fig1">Figure 1F, I, L</xref>) fit to the kinship (<xref ref-type="fig" rid="fig1">Figure 1E, H and K</xref>) and MAF (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) of each real human dataset, which by design do not have family structure.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Features of simulated and real human genotype datasets.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Dataset</th><th align="left" valign="bottom">Type</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom">Ind. (<inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>)</th><th align="left" valign="bottom">Subpops.<xref ref-type="table-fn" rid="table2fn1">*</xref> (<inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>)</th><th align="left" valign="bottom">Causal loci<xref ref-type="table-fn" rid="table2fn2"><sup>†</sup></xref> (<inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>)</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>ST</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula><xref ref-type="table-fn" rid="table2fn3"><sup>‡</sup></xref></th></tr></thead><tbody><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom">Admix.</td><td align="char" char="." valign="bottom">100 000</td><td align="char" char="." valign="bottom">1000</td><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">100</td><td align="char" char="." valign="bottom">0.1</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom">Admix.</td><td align="char" char="." valign="bottom">100 000</td><td align="char" char="." valign="bottom">100</td><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">0.1</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom">Admix.+Pedig.</td><td align="char" char="." valign="bottom">100 000</td><td align="char" char="." valign="bottom">1000</td><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">100</td><td align="char" char="." valign="bottom">0.1</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom">Real</td><td align="char" char="." valign="bottom">190 394</td><td align="char" char="." valign="bottom">2922</td><td align="char" char="." valign="bottom">11–243</td><td align="char" char="." valign="bottom">292</td><td align="char" char="." valign="bottom">0.28</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom">Real</td><td align="char" char="." valign="bottom">771 322</td><td align="char" char="." valign="bottom">929</td><td align="char" char="." valign="bottom">7–54</td><td align="char" char="." valign="bottom">93</td><td align="char" char="." valign="bottom">0.28</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom">Real</td><td align="char" char="." valign="bottom">1 111 266</td><td align="char" char="." valign="bottom">2504</td><td align="char" char="." valign="bottom">5–26</td><td align="char" char="." valign="bottom">250</td><td align="char" char="." valign="bottom">0.22</td></tr><tr><td align="left" valign="bottom">Human Origins sim.</td><td align="left" valign="bottom">Tree</td><td align="char" char="." valign="bottom">190 394</td><td align="char" char="." valign="bottom">2922</td><td align="char" char="." valign="bottom">243</td><td align="char" char="." valign="bottom">292</td><td align="char" char="." valign="bottom">0.23</td></tr><tr><td align="left" valign="bottom">HGDP sim.</td><td align="left" valign="bottom">Tree</td><td align="char" char="." valign="bottom">771 322</td><td align="char" char="." valign="bottom">929</td><td align="char" char="." valign="bottom">54</td><td align="char" char="." valign="bottom">93</td><td align="char" char="." valign="bottom">0.25</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes sim.</td><td align="left" valign="bottom">Tree</td><td align="char" char="." valign="bottom">1 111 266</td><td align="char" char="." valign="bottom">2504</td><td align="char" char="." valign="bottom">26</td><td align="char" char="." valign="bottom">250</td><td align="char" char="." valign="bottom">0.21</td></tr></tbody></table><table-wrap-foot><fn id="table2fn1"><label>*</label><p>For admixed family, ignores additional model dimension of 20 generation pedigree structure. For real datasets, lower range is continental subpopulations, upper range is number of fine-grained subpopulations.</p></fn><fn id="table2fn2"><label>†</label><p><inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>round</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mn>8</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to balance power across datasets, shown for <inline-formula><mml:math id="inf13"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> only.</p></fn><fn id="table2fn3"><label>‡</label><p>Model parameter for simulations, estimated value on real datasets.</p></fn></table-wrap-foot></table-wrap><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Population structures of simulated and real human genotype datasets.</title><p>First two columns are population kinship matrices as heatmaps: individuals along x- and y-axis, kinship as color. Diagonal shows inbreeding values. (<bold>A</bold>) Admixture scenario for both Large and Small simulations. (<bold>B</bold>) Last generation of 20-generation admixed family, shows larger kinship values near diagonal corresponding to siblings, first cousins, etc. (<bold>C</bold>) Minor allele frequency (MAF) distributions. Real datasets and subpopulation tree simulations had <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>MAF</mml:mtext><mml:mo>≥</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> filter. (<bold>D</bold>) Human Origins is an array dataset of a large diversity of global populations. (<bold>G</bold>) Human Genome Diversity Panel (HGDP) is a WGS dataset from global native populations. (<bold>J</bold>) 1000 Genomes Project is a WGS dataset of global cosmopolitan populations. (<bold>F, I, L</bold>) Trees between subpopulations fit to real data. (<bold>E, H, K</bold>). Simulations from trees fit to the real data recapitulate subpopulation structure.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig1-v2.tif"/></fig><p>All traits in this work are simulated. We repeated all evaluations on two additive quantitative trait models, <italic>fixed effect sizes</italic> (FES) and <italic>random coefficients</italic> (RC), which differ in how causal coefficients are constructed. The FES model captures the rough inverse relationship between coefficient and minor allele frequency that arises under strong negative and balancing selection and has been observed in numerous diseases and other traits (<xref ref-type="bibr" rid="bib73">Park et al., 2011</xref>; <xref ref-type="bibr" rid="bib114">Zeng et al., 2018</xref>; <xref ref-type="bibr" rid="bib90">Simons et al., 2018</xref>; <xref ref-type="bibr" rid="bib70">O’Connor et al., 2019</xref>), so it is the focus of our results. The RC model draws coefficients independent of allele frequency, corresponding to neutral traits (<xref ref-type="bibr" rid="bib114">Zeng et al., 2018</xref>; <xref ref-type="bibr" rid="bib90">Simons et al., 2018</xref>), which results in a wider effect size distribution that reduces association power and effective polygenicity compared to FES.</p><p>We evaluate using two complementary measures: (1) <inline-formula><mml:math id="inf15"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> (p-value signed root mean square deviation) measures p-value calibration (closer to zero is better), and (2) <inline-formula><mml:math id="inf16"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> (precision-recall area under the curve) measures causal locus classification performance (higher is better; <xref ref-type="fig" rid="fig2">Figure 2</xref>). <inline-formula><mml:math id="inf17"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> is a more robust alternative to the common inflation factor <inline-formula><mml:math id="inf18"><mml:mi>λ</mml:mi></mml:math></inline-formula> and type I error control measures; there is a correspondence between <inline-formula><mml:math id="inf19"><mml:mi>λ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf20"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, with <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> giving <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1.06</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>) and thus evidence of miscalibration close to the rule of thumb of <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib78">Price et al., 2010</xref>). There is also a monotonic correspondence between <inline-formula><mml:math id="inf24"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> and type I error rate (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). <inline-formula><mml:math id="inf25"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> has been used to evaluate association models (<xref ref-type="bibr" rid="bib83">Rakitsch et al., 2013</xref>), and reflects calibrated statistical power (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>) while being robust to miscalibrated models (Appendix 2).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Illustration of evaluation measures.</title><p>Three archetypal models illustrate our complementary measures: M1 is ideal, M2 overfits slightly, M3 is naive. (<bold>A</bold>) QQ plot of p-values of “null” (non-causal) loci. M1 has desired uniform p-values, M2/M3 are miscalibrated. (<bold>B</bold>)<inline-formula><mml:math id="inf26"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> (p-value Signed Root Mean Square Deviation) measures signed distance between observed and expected null p-values (closer to zero is better). (<bold>C</bold>) Precision and Recall (PR) measure causal locus classification performance (higher is better). (<bold>D</bold>) <inline-formula><mml:math id="inf27"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> (Area Under the PR Curve) reflects power (higher is better).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Comparison between <inline-formula><mml:math id="inf28"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> and inflation factor.</title><p>Each point is a pair of statistics for one replicate, one association model (PCA or LMM with some number of PCs <inline-formula><mml:math id="inf29"><mml:mi>r</mml:mi></mml:math></inline-formula>), one trait model (FES vs RC, all heritability/environments tested), and one dataset (color coded by dataset). Note log y-axis. The sigmoidal curve in <xref ref-type="disp-formula" rid="equ27">Equation 10</xref> is fit to the data.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Comparison between <inline-formula><mml:math id="inf30"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> and type I error rate.</title><p>Type I error rate calculated at a p-value threshold of 1e-2 (horizontal dashed gray line). Thus, a calibrated model has a type I error rate of 1e-2 and <inline-formula><mml:math id="inf31"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (where the dashed lines meet). As expected, increased type I error rates correspond to <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, while reduced type I error rates correspond to <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Each point is a pair of statistics for one replicate, one association model (PCA or LMM with some number of PCs <inline-formula><mml:math id="inf34"><mml:mi>r</mml:mi></mml:math></inline-formula>), one trait model (FES vs RC, all heritability/environments tested), and one dataset (color coded by dataset). Note log y-axis.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Comparison between <inline-formula><mml:math id="inf35"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> and calibrated power.</title><p>Calibrated power is power calculated at an empirical type I error threshold of 1e-4. Each point is a pair of statistics for one replicate, one association model (PCA or LMM with some number of PCs <inline-formula><mml:math id="inf36"><mml:mi>r</mml:mi></mml:math></inline-formula>), one trait model (FES vs RC, all heritability/environments tested), and one dataset (color coded by dataset). Gray dashed line is <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> line.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig2-figsupp3-v2.tif"/></fig></fig-group><p>Both PCA and LMM are evaluated in each replicate dataset including a number of PCs <inline-formula><mml:math id="inf38"><mml:mi>r</mml:mi></mml:math></inline-formula> between 0 and 90 as fixed covariates. In terms of p-value calibration, for PCA the best number of PCs <inline-formula><mml:math id="inf39"><mml:mi>r</mml:mi></mml:math></inline-formula> (minimizing mean <inline-formula><mml:math id="inf40"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> over replicates) is typically large across all datasets (<xref ref-type="table" rid="table3">Table 3</xref>), although much smaller <inline-formula><mml:math id="inf41"><mml:mi>r</mml:mi></mml:math></inline-formula> values often performed as well (shown in following sections). Most cases have a mean <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, whose p-values are effectively calibrated. However, PCA is often miscalibrated on the family simulation and real datasets (<xref ref-type="table" rid="table3">Table 3</xref>). In contrast, for LMM, <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (no PCs) is always best, and is always calibrated. Comparing LMM with <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> to PCA with its best <inline-formula><mml:math id="inf45"><mml:mi>r</mml:mi></mml:math></inline-formula>, LMM always has significantly smaller <inline-formula><mml:math id="inf46"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> than PCA or is statistically tied. For <inline-formula><mml:math id="inf47"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> and PCA, the best <inline-formula><mml:math id="inf48"><mml:mi>r</mml:mi></mml:math></inline-formula> is always smaller than the best <inline-formula><mml:math id="inf49"><mml:mi>r</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="inf50"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula>, so there is often a tradeoff between calibrated p-values versus classification performance. For LMM, there is no tradeoff, as <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> often has the best mean <inline-formula><mml:math id="inf52"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>, and otherwise is not significantly different from the best <inline-formula><mml:math id="inf53"><mml:mi>r</mml:mi></mml:math></inline-formula>. Lastly, LMM with <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> always has significantly greater or statistically tied <inline-formula><mml:math id="inf55"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> than PCA with its best <inline-formula><mml:math id="inf56"><mml:mi>r</mml:mi></mml:math></inline-formula>.</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Overview of PCA and LMM evaluations for high heritability simulations.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom" colspan="3">LMM <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> vs best <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom" colspan="4">PCA vs LMM <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></th></tr><tr><th align="left" valign="bottom">Dataset</th><th align="left" valign="bottom">Metric</th><th align="left" valign="bottom">Trait<xref ref-type="table-fn" rid="table3fn1">*</xref></th><th align="left" valign="bottom">Cal.<xref ref-type="table-fn" rid="table3fn2"><sup>†</sup></xref></th><th align="left" valign="bottom">Best <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><xref ref-type="table-fn" rid="table3fn3"><sup>‡</sup></xref></th><th align="left" valign="bottom">P-value <xref ref-type="table-fn" rid="table3fn4"><sup>§</sup></xref></th><th align="left" valign="bottom">Best <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><xref ref-type="table-fn" rid="table3fn3"><sup>‡</sup></xref></th><th align="left" valign="bottom">Cal.<xref ref-type="table-fn" rid="table3fn2"><sup>†</sup></xref></th><th align="left" valign="bottom">P-value <xref ref-type="table-fn" rid="table3fn4"><sup>§</sup></xref></th><th align="left" valign="bottom">Best model <xref ref-type="table-fn" rid="table3fn5"><sup>¶</sup></xref></th></tr></thead><tbody><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf62"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">12</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.036</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf63"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">4</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.055</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf64"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf65"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">89</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf66"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">87</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">4.4e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf67"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf68"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">88</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.017</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">HGDP sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf69"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">47</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.046</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf70"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">78</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">9.6e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf71"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">26</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.11</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf72"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">4</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.00097</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf73"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf74"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.00065</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf75"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">37</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">1.5e-05*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf76"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">76</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf77"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">85</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.14</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">HGDP sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf78"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">44</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">8.8e-07*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf79"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf80"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">5.9e-06*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf81"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">2</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.025</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf82"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0.35</td><td align="char" char="." valign="bottom">22</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf83"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">34</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf84"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0.33</td><td align="char" char="." valign="bottom">16</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">4.4e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf85"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0.11</td><td align="char" char="." valign="bottom">8</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf86"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">36</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">HGDP sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf87"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">17</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">1.7e-05*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf88"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">5e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf89"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">1.4e-05*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf90"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.095</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf91"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">34</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf92"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">0.4</td><td align="char" char="." valign="bottom">36</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">9.6e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf93"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">0.21</td><td align="char" char="." valign="bottom">16</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.013</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf94"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">5</td><td align="char" char="." valign="bottom">0.004</td><td align="char" char="." valign="bottom">9</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.00043</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Human Origins sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf95"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">37</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">4.1e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">HGDP sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf96"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">0.087</td><td align="char" char="." valign="bottom">17</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.0014</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf97"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">0.37</td><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">8.5e-10*</td><td align="left" valign="bottom">LMM</td></tr></tbody></table><table-wrap-foot><fn id="table3fn1"><label>*</label><p>FES: Fixed Effect Sizes, RC: Random Coefficients.</p></fn><fn id="table3fn2"><label>†</label><p>Calibrated: whether mean <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> over 50 replicates.</p></fn><fn id="table3fn3"><label>‡</label><p>Value of <inline-formula><mml:math id="inf99"><mml:mi>r</mml:mi></mml:math></inline-formula> (number of PCs) with minimum mean <inline-formula><mml:math id="inf100"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> or maximum mean <inline-formula><mml:math id="inf101"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>.</p></fn><fn id="table3fn4"><label>§</label><p>Wilcoxon paired 1-tailed test of distributions (<inline-formula><mml:math id="inf102"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf103"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>) between models in header. Asterisk marks significant value using Bonferroni threshold (<inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>tests</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> with <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>tests</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>72</mml:mn></mml:mrow></mml:math></inline-formula> is the number of tests in this table).</p></fn><fn id="table3fn5"><label>¶</label><p>Tie if no significant difference using Bonferroni threshold.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2-2"><title>Evaluations in admixture simulations</title><p>Now we look more closely at results per dataset. The complete <inline-formula><mml:math id="inf107"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf108"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> distributions for the admixture simulations and FES traits are in <xref ref-type="fig" rid="fig3">Figure 3</xref>. RC traits gave qualitatively similar results (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Evaluations in admixture simulations with FES traits, high heritability.</title><p>PCA and LMM models have varying number of PCs (<inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>90</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on x-axis), with the distributions (y-axis) of <inline-formula><mml:math id="inf110"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> (top subpanel) and <inline-formula><mml:math id="inf111"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> (bottom subpanel) for 50 replicates. Best performance is zero <inline-formula><mml:math id="inf112"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> and large <inline-formula><mml:math id="inf113"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>. Zero and maximum median <inline-formula><mml:math id="inf114"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> values are marked with horizontal gray dashed lines, and <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is marked with a light gray area. LMM performs best with <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, PCA with various <inline-formula><mml:math id="inf117"><mml:mi>r</mml:mi></mml:math></inline-formula>. (<bold>A</bold>) Large simulation (<inline-formula><mml:math id="inf118"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> individuals). (<bold>B</bold>) Small simulation (<inline-formula><mml:math id="inf119"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>) shows overfitting for large <inline-formula><mml:math id="inf120"><mml:mi>r</mml:mi></mml:math></inline-formula>. (<bold>C</bold>) Family simulation (<inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>) has admixed founders and large numbers of close relatives from a realistic random 20-generation pedigree. PCA performs poorly compared to LMM: <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for all <inline-formula><mml:math id="inf123"><mml:mi>r</mml:mi></mml:math></inline-formula> and large <inline-formula><mml:math id="inf124"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> gap.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Evaluations in admixture simulations with RC traits, high heritability.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Evaluations in admixture simulations with FES traits, low heritability.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Evaluations in admixture simulations with RC traits, low heritability.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 4.</label><caption><title>Evaluations in admixture simulations with FES traits, environment.</title><p>‘LMM lab.’ was only tested with <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig3-figsupp4-v2.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 5.</label><caption><title>Evaluations in admixture simulations with RC traits, environment.</title><p>‘LMM lab.’ was only tested with <inline-formula><mml:math id="inf126"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig3-figsupp5-v2.tif"/></fig></fig-group><p>In the large admixture simulation, the <inline-formula><mml:math id="inf127"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> of PCA is largest when <inline-formula><mml:math id="inf128"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (no PCs) and decreases rapidly to near zero at <inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, where it stays for up to <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>90</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Thus, PCA has calibrated p-values for <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≥</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, smaller than the theoretical optimum for this simulation of <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula>. In contrast, the <inline-formula><mml:math id="inf133"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> for LMM starts near zero for <inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, but becomes negative as <inline-formula><mml:math id="inf135"><mml:mi>r</mml:mi></mml:math></inline-formula> increases (p-values are conservative). The <inline-formula><mml:math id="inf136"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> distribution of PCA is similarly worst at <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, increases rapidly and peaks at <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, then decreases slowly for <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, while the <inline-formula><mml:math id="inf140"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> distribution for LMM starts near its maximum at <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and decreases with <inline-formula><mml:math id="inf142"><mml:mi>r</mml:mi></mml:math></inline-formula>. Although the <inline-formula><mml:math id="inf143"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> distributions for LMM and PCA overlap considerably at each <inline-formula><mml:math id="inf144"><mml:mi>r</mml:mi></mml:math></inline-formula>, LMM with <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> has significantly greater <inline-formula><mml:math id="inf146"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> values than PCA with <inline-formula><mml:math id="inf147"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="table" rid="table3">Table 3</xref>). However, qualitatively PCA performs nearly as well as LMM in this simulation.</p><p>The observed robustness to large <inline-formula><mml:math id="inf148"><mml:mi>r</mml:mi></mml:math></inline-formula> led us to consider smaller sample sizes. A model with large numbers of parameters <inline-formula><mml:math id="inf149"><mml:mi>r</mml:mi></mml:math></inline-formula> should overfit more as <inline-formula><mml:math id="inf150"><mml:mi>r</mml:mi></mml:math></inline-formula> approaches the sample size <inline-formula><mml:math id="inf151"><mml:mi>n</mml:mi></mml:math></inline-formula>. Rather than increase <inline-formula><mml:math id="inf152"><mml:mi>r</mml:mi></mml:math></inline-formula> beyond 90, we reduce individuals to <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>, which is small for typical association studies but may occur in studies of rare diseases, pilot studies, or other constraints. To compensate for the loss of power due to reducing <inline-formula><mml:math id="inf154"><mml:mi>n</mml:mi></mml:math></inline-formula>, we also reduce the number of causal loci (see Trait Simulation), which increases per-locus effect sizes. We found a large decrease in performance for both models as <inline-formula><mml:math id="inf155"><mml:mi>r</mml:mi></mml:math></inline-formula> increases, and best performance for <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for PCA and <inline-formula><mml:math id="inf157"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for LMM (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Remarkably, LMM attains much larger negative <inline-formula><mml:math id="inf158"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> values than in our other evaluations. LMM with <inline-formula><mml:math id="inf159"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is significantly better than PCA (<inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to 4) in both measures (<xref ref-type="table" rid="table3">Table 3</xref>), but qualitatively the difference is negligible.</p><p>The family simulation adds a 20-generation random family to our large admixture simulation. Only the last generation is studied for association, which contains numerous siblings, first cousins, etc., with the initial admixture structure preserved by geographically biased mating. Our evaluation reveals a sizable gap in both measures between LMM and PCA across all <inline-formula><mml:math id="inf161"><mml:mi>r</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). LMM again performs best with <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and achieves mean <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. However, PCA does not achieve mean <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> at any <inline-formula><mml:math id="inf165"><mml:mi>r</mml:mi></mml:math></inline-formula>, and its best mean <inline-formula><mml:math id="inf166"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> is considerably worse than that of LMM. Thus, LMM is conclusively superior to PCA, and the only calibrated model, when there is family structure.</p></sec><sec id="s2-3"><title>Evaluations in real human genotype datasets</title><p>Next, we repeat our evaluations with real human genotype data, which differs from our simulations in allele frequency distributions and more complex population structures with greater <inline-formula><mml:math id="inf167"><mml:msub><mml:mi>F</mml:mi><mml:mtext>ST</mml:mtext></mml:msub></mml:math></inline-formula>, numerous correlated subpopulations, and potential cryptic family relatedness.</p><p>Human Origins has the greatest number and diversity of subpopulations. The <inline-formula><mml:math id="inf168"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf169"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> distributions in this dataset and FES traits (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) most resemble those from the family simulation (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). In particular, while LMM with <inline-formula><mml:math id="inf170"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> performed optimally (both measures) and satisfies mean <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, PCA maintained <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for all <inline-formula><mml:math id="inf173"><mml:mi>r</mml:mi></mml:math></inline-formula> and its <inline-formula><mml:math id="inf174"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> were all considerably smaller than the best <inline-formula><mml:math id="inf175"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> of LMM.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Evaluations in real human genotype datasets with FES traits, high heritability.</title><p>Same setup as <xref ref-type="fig" rid="fig3">Figure 3</xref>, see that for details. These datasets strongly favor LMM with no PCs over PCA, with distributions that most resemble the family simulation. (<bold>A</bold>) Human Origins. (<bold>B</bold>) Human Genome Diversity Panel (HGDP). (<bold>C</bold>) 1000 Genomes Project.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Evaluations in real human genotype datasets with RC traits, high heritability.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Evaluations in real human genotype datasets with FES traits, low heritability.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Evaluations in real human genotype datasets with RC traits, low heritability.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig4-figsupp3-v2.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 4.</label><caption><title>Evaluations in real human genotype datasets with FES traits, environment.</title><p>‘LMM lab.’ was only tested with <inline-formula><mml:math id="inf176"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig4-figsupp4-v2.tif"/></fig><fig id="fig4s5" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 5.</label><caption><title>Evaluations in real human genotype datasets with RC traits, environment.</title><p>‘LMM lab.’ was only tested with <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig4-figsupp5-v2.tif"/></fig></fig-group><p>HGDP has the fewest individuals among real datasets, but compared to Human Origins contains more loci and low-frequency variants. Performance (<xref ref-type="fig" rid="fig4">Figure 4B</xref>) again most resembled the family simulations. In particular, LMM with <inline-formula><mml:math id="inf178"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> achieves mean <inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (p-values are calibrated), while PCA does not, and there is a sizable <inline-formula><mml:math id="inf180"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> gap between LMM and PCA. Maximum <inline-formula><mml:math id="inf181"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> values were lowest in HGDP compared to the two other real datasets.</p><p>1000 Genomes has the fewest subpopulations but largest number of individuals per subpopulation. Thus, although this dataset has the simplest subpopulation structure among the real datasets, we find <inline-formula><mml:math id="inf182"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf183"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> distributions (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) that again most resemble our earlier family simulation, with mean <inline-formula><mml:math id="inf184"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for LMM only and large <inline-formula><mml:math id="inf185"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> gaps between LMM and PCA.</p><p>Our results are qualitatively different for RC traits, which had smaller <inline-formula><mml:math id="inf186"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> gaps between LMM and PCA (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Maximum <inline-formula><mml:math id="inf187"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> were smaller in RC compared to FES in Human Origins and 1000 Genomes, suggesting lower power for RC traits across association models. Nevertheless, LMM with <inline-formula><mml:math id="inf188"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> was significantly better than PCA for all measures in the real datasets and RC traits (<xref ref-type="table" rid="table3">Table 3</xref>).</p></sec><sec id="s2-4"><title>Evaluations in subpopulation tree simulations fit to human data</title><p>To better understand which features of the real datasets lead to the large differences in performance between LMM and PCA, we carried out subpopulation tree simulations. Human subpopulations are related roughly by trees, which induce the strongest correlations, so we fit trees to each real dataset and tested if data simulated from these complex tree structures could recapitulate our previous results (<xref ref-type="fig" rid="fig1">Figure 1</xref>). These tree simulations also feature non-uniform ancestral allele frequency distributions, which recapitulated some of the skew for smaller minor allele frequencies of the real datasets (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). The <inline-formula><mml:math id="inf189"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf190"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> distributions for these tree simulations (<xref ref-type="fig" rid="fig5">Figure 5</xref>) resembled our admixture simulation more than either the family simulation (<xref ref-type="fig" rid="fig3">Figure 3</xref>) or real data results (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Both LMM with <inline-formula><mml:math id="inf191"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and PCA (various <inline-formula><mml:math id="inf192"><mml:mi>r</mml:mi></mml:math></inline-formula>) achieve mean <inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="table" rid="table3">Table 3</xref>). The <inline-formula><mml:math id="inf194"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> distributions of both LMM and PCA track closely as <inline-formula><mml:math id="inf195"><mml:mi>r</mml:mi></mml:math></inline-formula> is varied, although there is a small gap resulting in LMM (<inline-formula><mml:math id="inf196"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) besting PCA in all three simulations. The results are qualitatively similar for RC traits (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>, <xref ref-type="table" rid="table3">Table 3</xref>). Overall, these subpopulation tree simulations do not recapitulate the large LMM advantage over PCA observed on the real data.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Evaluations in subpopulation tree simulations fit to human data with FES traits, high heritability.</title><p>Same setup as <xref ref-type="fig" rid="fig3">Figure 3</xref>, see that for details. These tree simulations, which exclude family structure by design, do not explain the large gaps in LMM-PCA performance observed in the real data. (<bold>A</bold>) Human Origins tree simulation. (<bold>B</bold>) Human Genome Diversity Panel (HGDP) tree simulation. (<bold>C</bold>) 1000 Genomes Project tree simulation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Evaluations in subpopulation tree simulations fit to human data with RC traits, high heritability.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig5-figsupp1-v2.tif"/></fig></fig-group></sec><sec id="s2-5"><title>Numerous distant relatives explain poor PCA performance in real data</title><p>In principle, PCA performance should be determined by the dimension of relatedness, or kinship matrix rank, since PCA is a low-dimensional model whereas LMM can model high-dimensional relatedness without overfitting. We used the Tracy-Widom test (<xref ref-type="bibr" rid="bib74">Patterson et al., 2006</xref>) with <inline-formula><mml:math id="inf197"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> to estimate kinship matrix rank as the number of significant PCs (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>). The true rank of our simulations is slightly underestimated (<xref ref-type="table" rid="table2">Table 2</xref>), but we confirm that the family simulation has the greatest rank, and real datasets have greater estimates than their respective subpopulation tree simulations, which confirms our hypothesis to some extent. However, estimated ranks do not separate real datasets from tree simulations, as required to predict the observed PCA performance. Moreover, the HGDP and 1000 Genomes rank estimates are 45 and 61, respectively, yet PCA performed poorly for all <inline-formula><mml:math id="inf198"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mn>90</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> numbers of PCs (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The top eigenvalue explained a proportion of variance proportional to <inline-formula><mml:math id="inf199"><mml:msub><mml:mi>F</mml:mi><mml:mtext>ST</mml:mtext></mml:msub></mml:math></inline-formula> (<xref ref-type="table" rid="table2">Table 2</xref>), but the rest of the top 10 eigenvalues show no clear differences between datasets, except the small simulation had larger variances explained per eigenvalue (expected since it has fewer eigenvalues; <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). Comparing cumulative variance explained versus rank fraction across all eigenvalues, all datasets increase from their starting point almost linearly until they reach 1, except the family simulation has much greater variance explained by mid-rank eigenvalues (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). We also calculated the number of PCs that are significantly associated with the trait, and observed similar results, namely that while the family simulation has more significant PCs than the non-family admixture simulations, the real datasets and their tree simulated counterparts have similar numbers of significant PCs (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). Overall, there is no separation between real datasets (where PCA performed poorly) and subpopulation tree simulations (where PCA performed relatively well) in terms of their eigenvalues or kinship matrix rank estimates.</p><p>Local kinship, which is recent relatedness due to family structure excluding population structure, is the presumed cause of the LMM to PCA performance gap observed in real datasets but not their subpopulation tree simulation counterparts. Instead of inferring local kinship through increased kinship matrix rank, as attempted in the last paragraph, now we measure it directly using the KING-robust estimator (<xref ref-type="bibr" rid="bib57">Manichaikul et al., 2010</xref>). We observe more large local kinship in the real datasets and the family simulation compared to the other simulations (<xref ref-type="fig" rid="fig6">Figure 6</xref>). However, for real data this distribution depends on the subpopulation structure, since locally related pairs are most likely in the same subpopulation. Therefore, the only comparable curve to each real dataset is their corresponding subpopulation tree simulation, which matches subpopulation structure. In all real datasets, we identified highly related individual pairs with kinship above the 4th degree relative threshold of 0.022 (<xref ref-type="bibr" rid="bib57">Manichaikul et al., 2010</xref>; <xref ref-type="bibr" rid="bib18">Conomos et al., 2016b</xref>). However, these highly related pairs are vastly outnumbered by more distant pairs with evident non-zero local kinship as compared to the extreme tree simulation values.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Local kinship distributions.</title><p>Curves are complementary cumulative distribution of lower triangular kinship matrix (self kinship excluded) from KING-robust estimator. Note log x-axis; negative estimates are counted but not shown. Most values are below 4th degree relative threshold. Each real dataset has a greater cumulative than its subpopulation tree simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Estimated relatedness dimensions of datasets.</title><p>(<bold>A</bold>) Kinship matrix rank estimated with the Tracy-Widom test with <inline-formula><mml:math id="inf200"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>B</bold>) Cumulative variance explained versus eigenvalue rank fraction. (<bold>C</bold>) Variance explained by first 10 eigenvalues.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Number of PCs significantly associated with traits.</title><p>PCs are tested using an ordinary linear regression sequentially, with the th PC tested conditionally on the previous <inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> PCs and the intercept. Q-values are estimated from the 90 p-values (one for each PC in a given dataset and replicate) using the R package qvalue assuming <inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (necessary since the default <inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> estimates were unreliable for such small numbers of p-values and occasionally produced errors), and an FDR threshold of 0.05 is used to determine the number of significant PCs. Distribution per dataset is over its 50 replicates. Shown are results for FES traits with <inline-formula><mml:math id="inf204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (the results for RC were very similar, not shown).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig6-figsupp2-v2.tif"/></fig></fig-group><p>To try to improve PCA performance, we followed the standard practice of removing 4th degree relatives, which reduced sample sizes between 5% and 10% (<xref ref-type="table" rid="table4">Table 4</xref>). Only <inline-formula><mml:math id="inf205"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for LMM and <inline-formula><mml:math id="inf206"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> for PCA were tested, as these performed well in our earlier evaluation, and only FES traits were tested because they previously displayed the large PCA-LMM performance gap. LMM significantly outperforms PCA in all these cases (Wilcoxon paired 1-tailed <inline-formula><mml:math id="inf207"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; <xref ref-type="fig" rid="fig7">Figure 7</xref>). Notably, PCA still had miscalibrated p-values two of the three real datasets (<inline-formula><mml:math id="inf208"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), the only marginally calibrated case being HGDP which is also the smallest of these datasets. Otherwise, <inline-formula><mml:math id="inf209"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf210"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> ranges were similar here as in our earlier evaluation. Therefore, the removal of the small number of highly related individual pairs had a negligible effect in PCA performance, so the larger number of more distantly related pairs explain the poor PCA performance in the real datasets.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Evaluation in real datasets excluding 4th degree relatives, FES traits, high heritability.</title><p>Each dataset is a column, rows are measures. Boxplot whiskers are extrema over 50 replicates. First row has <inline-formula><mml:math id="inf211"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> band marked as gray area.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Evaluation in real datasets excluding 4th degree relatives, FES traits, low heritability.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig7-figsupp1-v2.tif"/></fig></fig-group><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title>Dataset sizes after 4th degree relative filter.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Dataset</th><th align="left" valign="bottom">Loci (<inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>)</th><th align="left" valign="bottom">Ind. (<inline-formula><mml:math id="inf213"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>)</th><th align="left" valign="bottom">Ind. removed (%)</th></tr></thead><tbody><tr><td align="left" valign="bottom">Human Origins</td><td align="char" char="." valign="bottom">189 722</td><td align="char" char="." valign="bottom">2636</td><td align="char" char="." valign="bottom">9.8</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="char" char="." valign="bottom">758 009</td><td align="char" char="." valign="bottom">847</td><td align="char" char="." valign="bottom">8.8</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="char" char="." valign="bottom">1 097 415</td><td align="char" char="." valign="bottom">2390</td><td align="char" char="." valign="bottom">4.6</td></tr></tbody></table></table-wrap></sec><sec id="s2-6"><title>Low heritability and environment simulations</title><p>Our main evaluations were repeated with traits simulated under a lower heritability value of <inline-formula><mml:math id="inf214"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>. We reduced the number of causal loci in response to this change in heritability, to result in equal average effect size per locus compared to the previous high heritability evaluations (see Trait Simulation). Despite that, these low heritability evaluations measured lower <inline-formula><mml:math id="inf215"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> values than their high heritability counterparts (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>, <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>, <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). The gap between LMM and PCA was reduced in these evaluations, but the main conclusion of the high heritability evaluation holds for low heritability as well, namely that LMM with <inline-formula><mml:math id="inf216"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> significantly outperforms or ties LMM with <inline-formula><mml:math id="inf217"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and PCA in all cases (<xref ref-type="table" rid="table5">Table 5</xref>).</p><table-wrap id="table5" position="float"><label>Table 5.</label><caption><title>Overview of PCA and LMM evaluations for low heritability simulations.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom" colspan="3">LMM <inline-formula><mml:math id="inf218"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> vs best <inline-formula><mml:math id="inf219"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom" colspan="4">PCA vs LMM <inline-formula><mml:math id="inf220"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></th></tr><tr><th align="left" valign="bottom">Dataset</th><th align="left" valign="bottom">Metric</th><th align="left" valign="bottom">Trait<xref ref-type="table-fn" rid="table5fn1">*</xref></th><th align="left" valign="bottom">Cal.<xref ref-type="table-fn" rid="table5fn2"><sup>†</sup></xref></th><th align="left" valign="bottom">Best <inline-formula><mml:math id="inf221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><xref ref-type="table-fn" rid="table5fn3"><sup>‡</sup></xref></th><th align="left" valign="bottom">p-value <xref ref-type="table-fn" rid="table5fn4"><sup>§</sup></xref></th><th align="left" valign="bottom">Best <inline-formula><mml:math id="inf222"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><xref ref-type="table-fn" rid="table5fn3"><sup>‡</sup></xref></th><th align="left" valign="bottom">Cal.<xref ref-type="table-fn" rid="table5fn2"><sup>†</sup></xref></th><th align="left" valign="bottom">p-value <xref ref-type="table-fn" rid="table5fn4"><sup>§</sup></xref></th><th align="left" valign="bottom">Best model <xref ref-type="table-fn" rid="table5fn5"><sup>¶</sup></xref></th></tr></thead><tbody><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf223"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">62</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.00012*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf224"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.27</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf225"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf226"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">81</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf227"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">37</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">6.2e-09*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf228"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">84</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf229"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">35</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.00094</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf230"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.087</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf231"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">4.1e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf232"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">75</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.00016*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf233"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">23</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">1.7e-05*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf234"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">41</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">6.7e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf235"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.11</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf236"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.58</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf237"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">7</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">2.2e-06*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf238"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">16</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">8e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf239"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">11</td><td align="char" char="." valign="bottom">0.68</td><td align="char" char="." valign="bottom">6</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.0043</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf240"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">0.34</td><td align="char" char="." valign="bottom">4</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">2.3e-07*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf241"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.14</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf242"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.1</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf243"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">5</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">1.9e-06*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf244"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">0.16</td><td align="char" char="." valign="bottom">12</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.003</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf245"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">0.14</td><td align="char" char="." valign="bottom">5</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.14</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf246"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">4</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.078</td><td align="left" valign="bottom">Tie</td></tr></tbody></table><table-wrap-foot><fn id="table5fn1"><label>*</label><p>FES: Fixed Effect Sizes, RC: Random Coefficients.</p></fn><fn id="table5fn2"><label>†</label><p>Calibrated: whether mean <inline-formula><mml:math id="inf247"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> over 50 replicates.</p></fn><fn id="table5fn3"><label>‡</label><p>Value of <inline-formula><mml:math id="inf248"><mml:mi>r</mml:mi></mml:math></inline-formula> (number of PCs) with minimum mean <inline-formula><mml:math id="inf249"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> or maximum mean <inline-formula><mml:math id="inf250"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>.</p></fn><fn id="table5fn4"><label>§</label><p>Wilcoxon paired 1-tailed test of distributions (<inline-formula><mml:math id="inf251"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf252"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>) between models in header. Asterisk marks significant value using Bonferroni threshold (<inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>tests</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> with <inline-formula><mml:math id="inf254"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf255"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>tests</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>48</mml:mn></mml:mrow></mml:math></inline-formula> is the number of tests in this table).</p></fn><fn id="table5fn5"><label>¶</label><p>Tie if no significant difference using Bonferroni threshold.</p></fn></table-wrap-foot></table-wrap><p>Lastly, we simulated traits with both low heritability and large environment effects determined by geography and subpopulation labels, so they are strongly correlated to the low-dimensional population structure. For that reason, PCs may be expected to perform better in this setting (in either PCA or LMM). However, we find that both PCA and LMM (even without PCs) increase their <inline-formula><mml:math id="inf256"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> values compared to the low-heritability evaluations (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>; <xref ref-type="fig" rid="fig8">Figure 8</xref> also shows representative numbers of PCs, which performed optimally or nearly so in individual simulations shown in <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>, <xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>, <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>, <xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>). p-Value calibration is comparable with or without environment effects, for LMM for all <inline-formula><mml:math id="inf257"><mml:mi>r</mml:mi></mml:math></inline-formula> and for PCA once <inline-formula><mml:math id="inf258"><mml:mi>r</mml:mi></mml:math></inline-formula> is large enough (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>). These simulations are the only where we occasionally observed for both metrics a significant, though small, advantage of LMM with PCs versus LMM without PCs (<xref ref-type="table" rid="table6">Table 6</xref>). Additionally, on RC traits only, PCA significantly outperforms LMM in the three real human datasets (<xref ref-type="table" rid="table6">Table 6</xref>), the only cases in all of our evaluations where this is observed. For comparison, we also evaluate an ‘oracle’ LMM without PCs but with the finest group labels, the same used to simulate environment, as fixed categorical covariates (‘LMM lab.’), and see much larger <inline-formula><mml:math id="inf259"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> values than either LMM with PCs or PCA (<xref ref-type="fig" rid="fig8">Figure 8</xref>, <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>, <xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>, <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>, <xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>, <xref ref-type="table" rid="table6">Table 6</xref>). However, LMM with labels is often more poorly calibrated than LMM or PCA without labels, which may be since these numerous labels are inappropriately modeled as fixed rather than random effects. Overall, we find that association studies with correlated environment and genetic effects remain a challenge for PCA and LMM, that addition of PCs to an LMM improves performance only marginally, and that if the environment effect is driven by geography or ethnicity then use of those labels greatly improves performance compared to using PCs.</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Evaluation in real datasets excluding 4th degree relatives, FES traits, environment.</title><p>Traits simulated with environment effects, otherwise the same as <xref ref-type="fig" rid="fig7">Figure 7</xref>. ‘LMM lab.’ includes as fixed effects true groups from which environment was simulated.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig8-v2.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Comparison of performance in low heritability vs environment simulations.</title><p>Each curve traces as the number of PCs <inline-formula><mml:math id="inf260"><mml:mi>r</mml:mi></mml:math></inline-formula> is increased from <inline-formula><mml:math id="inf261"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (marked with an “x”) until <inline-formula><mml:math id="inf262"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>90</mml:mn></mml:mrow></mml:math></inline-formula> (unmarked end), on one axis is the mean value over replicates of either <inline-formula><mml:math id="inf263"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf264"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>, for low heritability simulations on the x-axis and environment simulations on the y-axis. Each curve corresponds to one dataset (color) and association model (solid or dashed line type). Columns: (<bold>A</bold>) FES and (<bold>B</bold>) RC traits show similar results. First row shows that for PCA curves (dashed), <inline-formula><mml:math id="inf265"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> is higher (worse) in environment simulations for low <inline-formula><mml:math id="inf266"><mml:mi>r</mml:mi></mml:math></inline-formula>, but becomes equal in both simulations once <inline-formula><mml:math id="inf267"><mml:mi>r</mml:mi></mml:math></inline-formula> is sufficiently large; for LMM curves (solid), <inline-formula><mml:math id="inf268"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> is equal in both simulations for all <inline-formula><mml:math id="inf269"><mml:mi>r</mml:mi></mml:math></inline-formula>, all datasets. Second row shows that for PCA, <inline-formula><mml:math id="inf270"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> is higher (better) in low heritability simulations for low <inline-formula><mml:math id="inf271"><mml:mi>r</mml:mi></mml:math></inline-formula>, but becomes higher in environment simulations once <inline-formula><mml:math id="inf272"><mml:mi>r</mml:mi></mml:math></inline-formula> is sufficiently large; for LMM, performance is better in environment simulations for all <inline-formula><mml:math id="inf273"><mml:mi>r</mml:mi></mml:math></inline-formula>, all datasets.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79238-fig8-figsupp1-v2.tif"/></fig></fig-group><table-wrap id="table6" position="float"><label>Table 6.</label><caption><title>Overview of PCA and LMM evaluations for environment simulations.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="center" valign="bottom" colspan="3">LMM <inline-formula><mml:math id="inf274"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> vs best <inline-formula><mml:math id="inf275"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center" valign="bottom" colspan="4">PCA vs LMM <inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center" valign="bottom" colspan="3">LMM lab. <inline-formula><mml:math id="inf277"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> vs PCA/LMM</th></tr><tr><th align="left" valign="bottom">Dataset</th><th align="left" valign="bottom">Metric</th><th align="left" valign="bottom">Trait<xref ref-type="table-fn" rid="table6fn1">*</xref></th><th align="left" valign="bottom">Cal.<xref ref-type="table-fn" rid="table6fn2"><sup>†</sup></xref></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf278"><mml:mi mathsize="90%">r</mml:mi></mml:math></inline-formula><xref ref-type="table-fn" rid="table6fn3"><sup>‡</sup></xref></th><th align="left" valign="bottom">p-value <xref ref-type="table-fn" rid="table6fn4"><sup>§</sup></xref></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf279"><mml:mi mathsize="90%">r</mml:mi></mml:math></inline-formula><xref ref-type="table-fn" rid="table6fn3"><sup>‡</sup></xref></th><th align="left" valign="bottom">Cal.<xref ref-type="table-fn" rid="table6fn2"><sup>†</sup></xref></th><th align="left" valign="bottom">p-value <xref ref-type="table-fn" rid="table6fn4"><sup>§</sup></xref></th><th align="left" valign="bottom">Best <xref ref-type="table-fn" rid="table6fn5"><sup>¶</sup></xref></th><th align="left" valign="bottom">Cal.<xref ref-type="table-fn" rid="table6fn2"><sup>†</sup></xref></th><th align="left" valign="bottom">p-value <xref ref-type="table-fn" rid="table6fn4"><sup>§</sup></xref></th><th align="left" valign="bottom">Best <xref ref-type="table-fn" rid="table6fn5"><sup>¶</sup></xref></th></tr></thead><tbody><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf280"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">83</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.38</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">1.8e-14*</td><td align="left" valign="bottom">PCA/LMM</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf281"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.001</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">1.4e-14*</td><td align="left" valign="bottom">PCA/LMM</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf282"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">0.18</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">False</td><td align="char" char="." valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.066</td><td align="left" valign="bottom">LMM/LMM lab.</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf283"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">3.9e-05*</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">False</td><td align="char" char="." valign="bottom">1.4e-08*</td><td align="left" valign="bottom">LMM</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf284"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.0037</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">2.1e-09*</td><td align="left" valign="bottom">PCA/LMM</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf285"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom">False</td><td align="char" char="." valign="bottom">8</td><td align="char" char="." valign="bottom">8.8e-08*</td><td align="char" char="." valign="bottom">85</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.053</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM lab.</td></tr><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf286"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">60</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.033</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom">True</td><td align="char" char="hyphen" valign="bottom">6.3e-10*</td><td align="left" valign="bottom">PCA/LMM</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf287"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">9</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.85</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">1.4e-14*</td><td align="left" valign="bottom">PCA/LMM</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf288"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">5</td><td align="char" char="." valign="bottom">0.14</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">False</td><td align="char" char="." valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.011</td><td align="left" valign="bottom">LMM/LMM lab.</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf289"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">False</td><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">1.1e-08*</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">2.3e-07*</td><td align="left" valign="bottom">PCA</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">PCA</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf290"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">89</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">6.5e-09*</td><td align="left" valign="bottom">PCA</td><td align="left" valign="bottom">False</td><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">PCA</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf291"><mml:mrow><mml:mo maxsize="90%" minsize="90%">|</mml:mo><mml:msub><mml:mtext mathsize="90%">SRMSD</mml:mtext><mml:mi mathsize="90%">p</mml:mi></mml:msub><mml:mo maxsize="90%" minsize="90%">|</mml:mo></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom">False</td><td align="char" char="." valign="bottom">8</td><td align="char" char="." valign="bottom">1.6e-08*</td><td align="char" char="." valign="bottom">88</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">4.9e-09*</td><td align="left" valign="bottom">PCA</td><td align="left" valign="bottom">True</td><td align="char" char="." valign="bottom">0.09</td><td align="left" valign="bottom">PCA/LMM lab.</td></tr><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf292"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">2.4e-06*</td><td align="char" char="." valign="bottom">6</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.0021</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">1.8e-15*</td><td align="left" valign="bottom">LMM lab.</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf293"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">0.055</td><td align="char" char="." valign="bottom">4</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.033</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.28</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf294"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">12</td><td align="char" char="." valign="bottom">7e-04</td><td align="char" char="." valign="bottom">63</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM lab.</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf295"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">3.7e-06*</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">1.4e-05*</td><td align="left" valign="bottom">LMM</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM lab.</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf296"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">12</td><td align="char" char="." valign="bottom">4.3e-06*</td><td align="char" char="." valign="bottom">45</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.0044</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM lab.</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf297"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">FES</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">1.9e-08*</td><td align="char" char="." valign="bottom">55</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.028</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM lab.</td></tr><tr><td align="left" valign="bottom">Admix. Large sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf298"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">0.00085</td><td align="char" char="." valign="bottom">5</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.0018</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">5e-10*</td><td align="left" valign="bottom">LMM lab.</td></tr><tr><td align="left" valign="bottom">Admix. Small sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf299"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">0.13</td><td align="char" char="." valign="bottom">5</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.093</td><td align="left" valign="bottom">Tie</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">0.0028</td><td align="left" valign="bottom">Tie</td></tr><tr><td align="left" valign="bottom">Admix. Family sim.</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf300"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">0.01</td><td align="char" char="." valign="bottom">86</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">1.7e-09*</td><td align="left" valign="bottom">LMM</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM lab.</td></tr><tr><td align="left" valign="bottom">Human Origins</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf301"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">22</td><td align="char" char="." valign="bottom">0.0039</td><td align="char" char="." valign="bottom">90</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">1e-06*</td><td align="left" valign="bottom">PCA</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3.9e-10*</td><td align="left" valign="bottom">LMM lab.</td></tr><tr><td align="left" valign="bottom">HGDP</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf302"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">19</td><td align="char" char="." valign="bottom">0.0057</td><td align="char" char="." valign="bottom">64</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">2.8e-05*</td><td align="left" valign="bottom">PCA</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">3e-07*</td><td align="left" valign="bottom">LMM lab.</td></tr><tr><td align="char" char="." valign="bottom">1000 Genomes</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf303"><mml:msub><mml:mtext mathsize="90%">AUC</mml:mtext><mml:mtext mathsize="90%">PR</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">RC</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">8.7e-05*</td><td align="char" char="." valign="bottom">87</td><td align="left" valign="bottom"/><td align="char" char="." valign="bottom">1.2e-09*</td><td align="left" valign="bottom">PCA</td><td align="left" valign="bottom"/><td align="char" char="hyphen" valign="bottom">4.4e-10*</td><td align="left" valign="bottom">LMM lab.</td></tr></tbody></table><table-wrap-foot><fn id="table6fn1"><label>*</label><p>FES: Fixed Effect Sizes, RC: Random Coefficients.</p></fn><fn id="table6fn2"><label>†</label><p>Calibrated: whether mean <inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> over 50 replicates.</p></fn><fn id="table6fn3"><label>‡</label><p>Value of <inline-formula><mml:math id="inf305"><mml:mi>r</mml:mi></mml:math></inline-formula> (number of PCs) with minimum mean <inline-formula><mml:math id="inf306"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> or maximum mean <inline-formula><mml:math id="inf307"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>.</p></fn><fn id="table6fn4"><label>§</label><p>Wilcoxon paired 1-tailed test of distributions (<inline-formula><mml:math id="inf308"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf309"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>) between models in header. Asterisk marks significant value using Bonferroni threshold (<inline-formula><mml:math id="inf310"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>tests</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> with <inline-formula><mml:math id="inf311"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf312"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>tests</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>72</mml:mn></mml:mrow></mml:math></inline-formula> is the number of tests in this table).</p></fn><fn id="table6fn5"><label>¶</label><p>Tie if no significant difference using Bonferroni threshold; in last column, pairwise ties are specified and “Tie” is three-way tie.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Our evaluations conclusively determined that LMM without PCs performs better than PCA (for any number of PCs) across all scenarios without environment effects, including all real and simulated genotypes and two trait simulation models. Although the addition of a few PCs to LMM does not greatly hurt its performance (except for small sample sizes), they generally did not improve it either (<xref ref-type="table" rid="table3">Table 3</xref>, <xref ref-type="table" rid="table5">Table 5</xref>), which agrees with previous observations (<xref ref-type="bibr" rid="bib51">Liu et al., 2011</xref>; <xref ref-type="bibr" rid="bib39">Janss et al., 2012</xref>) but contradicts others (<xref ref-type="bibr" rid="bib118">Zhao et al., 2007</xref>; <xref ref-type="bibr" rid="bib78">Price et al., 2010</xref>). Our findings make sense since PCs are the eigenvectors of the same kinship matrix that parameterized random effects, so including both is redundant.</p><p>The presence of environment effects that are correlated to relatedness presents the only scenario where occasionally PCA and LMM with PCs outperform LMM without PCs (<xref ref-type="table" rid="table6">Table 6</xref>). It is commonly believed that PCs model such environment effects well (<xref ref-type="bibr" rid="bib66">Novembre et al., 2008</xref>; <xref ref-type="bibr" rid="bib117">Zhang and Pan, 2015</xref>; <xref ref-type="bibr" rid="bib48">Lin et al., 2021</xref>). However, we observe that LMM without PCs models environment effects nearly as well as with PCs (<xref ref-type="fig" rid="fig8">Figure 8</xref>), consistent with previous findings (<xref ref-type="bibr" rid="bib103">Vilhjálmsson and Nordborg, 2013</xref>; <xref ref-type="bibr" rid="bib105">Wang et al., 2022</xref>) and with environment inflating heritability estimates using LMM (<xref ref-type="bibr" rid="bib29">Heckerman et al., 2016</xref>). Moreover, modeling the true environment groups as fixed categorical effects always substantially improved <inline-formula><mml:math id="inf313"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> compared to modeling them with PCs (<xref ref-type="fig" rid="fig8">Figure 8</xref>, <xref ref-type="table" rid="table6">Table 6</xref>). Modeling numerous environment groups as fixed effects does result in deflated p-values (<xref ref-type="fig" rid="fig8">Figure 8</xref>, <xref ref-type="table" rid="table6">Table 6</xref>), which we expect would be avoided by modeling them as random effects, a strategy we chose not to pursue here as it is both a circular evaluation (the true effects were drawn from that model) and out of scope. Overall, including PCs to model environment effects yields limited power gains if at all, even in an LMM, and is no replacement for more adequate modeling of environment whenever possible.</p><p>Previous studies found that PCA was better calibrated than LMM for unusually differentiated markers (<xref ref-type="bibr" rid="bib78">Price et al., 2010</xref>; <xref ref-type="bibr" rid="bib108">Wu et al., 2011</xref>; <xref ref-type="bibr" rid="bib111">Yang et al., 2014</xref>), which as simulated were an artificial scenario not based on a population genetics model, and are otherwise believed to be unusual (<xref ref-type="bibr" rid="bib97">Sul and Eskin, 2013</xref>; <xref ref-type="bibr" rid="bib79">Price et al., 2013</xref>). Our evaluations on real human data, which contain such loci in relevant proportions if they exist, do not replicate that result. Family relatedness strongly favors LMM, an advantage that probably outweighs this potential PCA benefit in real data.</p><p>Relative to LMM, the behavior of PCA fell between two extremes. When PCA performed well, there was a small number of PCs with both calibrated p-values and <inline-formula><mml:math id="inf314"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> near that of LMM without PCs. Conversely, PCA performed poorly when no number of PCs had either calibrated p-values or acceptably large <inline-formula><mml:math id="inf315"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>. There were no cases where high numbers of PCs optimized an acceptable <inline-formula><mml:math id="inf316"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>, or cases with miscalibrated p-values but high <inline-formula><mml:math id="inf317"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>. PCA performed well in the admixture simulations (without families, both trait models), real human genotypes with RC traits, and the subpopulation tree simulations (both trait models). Conversely, PCA performed poorly in the admixed family simulation (both trait models) and the real human genotypes with FES traits.</p><p>PCA assumes that genetic relatedness is restricted to a low-dimensional subspace, whereas LMM can handle high-dimensional relatedness. Thus, PCA performs well in the admixture simulation, which is explicitly low-dimensional (see Genotype simulation from the admixture model), and our subpopulation tree simulations, which are likely well approximated by a few dimensions despite the large number of subpopulations because there are few long branches. Conversely, PCA performs poorly under family structure because its kinship matrix is high-dimensional (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). However, estimating the latent space dimensions of real datasets is challenging because estimated eigenvalues have biased distributions (<xref ref-type="bibr" rid="bib28">Hayashi et al., 2018</xref>). Kinship matrix rank estimated using the Tracy-Widom test (<xref ref-type="bibr" rid="bib74">Patterson et al., 2006</xref>) did not fully predict the datasets that PCA performs well on. In contrast, estimated local kinship finds considerable cryptic family relatedness in all real human datasets and better explains why PCA performs poorly there. The trait model also influences the relative performance of PCA, so genotype-only parameters (eigenvalues or local kinship) alone cannot tell the full story. There are related tests for numbers of dimensions that consider the trait which we did not consider, including the Bayesian information criterion for the regression with PCs against the trait (<xref ref-type="bibr" rid="bib124">Zhu and Yu, 2009</xref>). Additionally, PCA and LMM goodness of fit could be compared using the coefficient of determination generalized for LMMs (<xref ref-type="bibr" rid="bib99">Sun et al., 2010</xref>).</p><p>PCA is at best underpowered relative to LMMs, and at worst miscalibrated regardless of the numbers of PCs included, in real human genotype tests. Among our simulations, such poor performance occurred only in the admixed family. Local kinship estimates reveal considerable family relatedness in the real datasets absent in the corresponding subpopulation tree simulations. Admixture is also absent in our tree simulations, but our simulations and theory show that admixture is well handled by PCA. Hundreds of close relative pairs have been identified in 1000 Genomes (<xref ref-type="bibr" rid="bib24">Gazal et al., 2015</xref>; <xref ref-type="bibr" rid="bib7">Al Khudhair et al., 2015</xref>; <xref ref-type="bibr" rid="bib22">Fedorova et al., 2016</xref>; <xref ref-type="bibr" rid="bib87">Schlauch et al., 2017</xref>), but their removal does not improve PCA performance sufficiently in our tests, so the larger number of more distantly related pairs are PCA’s most serious obstacle in practice. Distant relatives are expected to be numerous in any large human dataset (<xref ref-type="bibr" rid="bib30">Henn et al., 2012</xref>; <xref ref-type="bibr" rid="bib88">Shchur and Nielsen, 2018</xref>; <xref ref-type="bibr" rid="bib54">Loh et al., 2018</xref>). Our FES trait tests show that family relatedness is more challenging when rarer variants have larger coefficients. Overall, the high relatedness dimensions induced by family relatedness is the key challenge for PCA association in modern datasets that is readily overcome by LMM.</p><p>Our tests also found PCA robust to large numbers of PCs, far beyond the optimal choice, agreeing with previous anecdotal observations (<xref ref-type="bibr" rid="bib77">Price et al., 2006</xref>; <xref ref-type="bibr" rid="bib43">Kang et al., 2010</xref>), in contrast to using too few PCs for which there is a large performance penalty. The exception was the small sample size simulation, where only small numbers of PCs performed well. In contrast, LMM is simpler since there is no need to choose the number of PCs. However, an LMM with a large number of covariates may have conservative p-values, as observed for LMM with large numbers of PCs, which is a weakness of the score test used by the LMM we evaluated that may be overcome with other statistical tests. Simulations or post hoc evaluations remain crucial for ensuring that statistics are calibrated.</p><p>There are several variants of the PCA and LMM analyses, most designed for better modeling linkage disequilibrium (LD), that we did not evaluate directly, in which PCs are no longer exactly the top eigenvectors of the kinship matrix (if estimated with different approaches), although this is not a crucial aspect of our arguments. We do not consider the case where samples are projected onto PCs estimated from an external sample (<xref ref-type="bibr" rid="bib81">Privé et al., 2020</xref>), which is uncommon in association studies, and whose primary effect is shrinkage, so if all samples are projected then they are all equally affected and larger regression coefficients compensate for the shrinkage, although this will no longer be the case if only a portion of the sample is projected onto the PCs of the rest of the sample. Another approach tests PCs for association against every locus in the genome in order to identify and exclude PCs that capture LD structure (which is localized) instead of ancestry (which should be present across the genome; <xref ref-type="bibr" rid="bib81">Privé et al., 2020</xref>); a previous proposal removes LD using an autocorrelation model prior to estimating PCs (<xref ref-type="bibr" rid="bib74">Patterson et al., 2006</xref>). These improved PCs remain inadequate models of family relatedness, so an LMM will continue to outperform them in that setting. Similarly, the leave-one-chromosome-out (LOCO) approach for estimating kinship matrices for LMMs prevents the test locus and loci in LD with it from being modeled by the random effect as well, which is called ‘proximal contamination’ (<xref ref-type="bibr" rid="bib49">Lippert et al., 2011</xref>; <xref ref-type="bibr" rid="bib111">Yang et al., 2014</xref>). While LOCO kinship estimates vary for each chromosome, they continue to model family relatedness, thus maintaining their key advantage over PCA. The LDAK model estimates kinship instead by weighing loci taking LD into account (<xref ref-type="bibr" rid="bib94">Speed et al., 2012</xref>). LD effects must be adjusted for, if present, so in unfiltered data we advise the previous methods be applied. However, in this work, simulated genotypes do not have LD, and the real datasets were filtered to remove LD, so here there is no proximal contamination and LD confounding is minimized if present at all, so these evaluations may be considered the ideal situation where LD effects have been adjusted successfully, and in this setting LMM outperforms PCA. Overall, these alternative PCs or kinship matrices differ from their basic counterparts by either the extent to which LD influences the estimates (which may be a confounder in a small portion of the genome, by definition) or by sampling noise, neither of which are expected to change our key conclusion.</p><p>One of the limitations of this work include relatively small sample sizes compared to modern association studies. However, our conclusions are not expected to change with larger sample sizes, as cryptic family relatedness will continue to be abundant in such data, if not increase in abundance, and thus give LMMs an advantage over PCA (<xref ref-type="bibr" rid="bib30">Henn et al., 2012</xref>; <xref ref-type="bibr" rid="bib88">Shchur and Nielsen, 2018</xref>; <xref ref-type="bibr" rid="bib54">Loh et al., 2018</xref>). One reason PCA has been favored over classic LMMs is because PCA’s runtime scales much better with increasing sample size. However, recent approaches not tested in this work have made LMMs more scalable and applicable to biobank-scale data (<xref ref-type="bibr" rid="bib53">Loh et al., 2015</xref>; <xref ref-type="bibr" rid="bib123">Zhou et al., 2018</xref>; <xref ref-type="bibr" rid="bib61">Mbatchou et al., 2021</xref>), so one clear next step is carefully evaluating these approaches in simulations with larger sample sizes. A different benefit for including PCs were recently reported for BOLT-LMM, which does not result in greater power but rather in reduced runtime, a property that may be specific to its use of scalable algorithms such as conjugate gradient and variational Bayes (<xref ref-type="bibr" rid="bib54">Loh et al., 2018</xref>). Many of these newer LMMs also no longer follow the infinitesimal model of the basic LMM (<xref ref-type="bibr" rid="bib53">Loh et al., 2015</xref>; <xref ref-type="bibr" rid="bib61">Mbatchou et al., 2021</xref>), and employ novel approximations, which are features not evaluated in this work and worthy of future study.</p><p>Another limitation of this work is ignoring rare variants, a necessity given our smaller sample sizes, where rare variant association is miscalibrated and underpowered. Using simulations mimicking the UK Biobank, recent work has found that rare variants can have a more pronounced structure than common variants, and that modeling this rare variant structure (with either PCA and LMM) may better model environment confounding, reduce inflation in association studies, and ameliorate stratification in polygenic risk scores (<xref ref-type="bibr" rid="bib113">Zaidi and Mathieson, 2020</xref>). Better modeling rare variants and their structure is a key next step in association studies.</p><p>The largest limitation of our work is that we only considered quantitative traits. Previous evaluations involving case-control traits tended to report PCA-LMM ties or mixed results, an observation potentially confounded by the use of low-dimensional simulations without family relatedness (<xref ref-type="table" rid="table1">Table 1</xref>). An additional concern is case-control ascertainment bias and imbalance, which appears to affect LMMs more severely, although recent work appears to solve this problem (<xref ref-type="bibr" rid="bib111">Yang et al., 2014</xref>; <xref ref-type="bibr" rid="bib123">Zhou et al., 2018</xref>). Future evaluations should aim to include our simulations and real datasets, to ensure that previous results were not biased in favor of PCA by not simulating family structure or larger coefficients for rare variants that are expected for diseases by various selection models.</p><p>Overall, our results lead us to recommend LMM over PCA for association studies in general. Although PCA offer flexibility and speed compared to LMM, additional work is required to ensure that PCA is adequate, including removal of close relatives (lowering sample size and wasting resources) followed by simulations or other evaluations of statistics, and even then PCA may perform poorly in terms of both type I error control and power. The large numbers of distant relatives expected of any real dataset all but ensures that PCA will perform poorly compared to LMM (<xref ref-type="bibr" rid="bib30">Henn et al., 2012</xref>; <xref ref-type="bibr" rid="bib88">Shchur and Nielsen, 2018</xref>; <xref ref-type="bibr" rid="bib54">Loh et al., 2018</xref>). Our findings also suggest that related applications such as polygenic models may enjoy gains in power and accuracy by employing an LMM instead of PCA to model relatedness (<xref ref-type="bibr" rid="bib83">Rakitsch et al., 2013</xref>; <xref ref-type="bibr" rid="bib82">Qian et al., 2020</xref>). PCA remains indispensable across population genetics, from visualizing population structure and performing quality control to its deep connection to admixture models, but the time has come to limit its use in association testing in favor of LMM or other, richer models capable of modeling all forms of relatedness.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>The complex trait model and PCA and LMM approximations</title><p>Let <inline-formula><mml:math id="inf318"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be the genotype at the biallelic locus <inline-formula><mml:math id="inf319"><mml:mi>i</mml:mi></mml:math></inline-formula> for individual <inline-formula><mml:math id="inf320"><mml:mi>j</mml:mi></mml:math></inline-formula>, which counts the number of reference alleles. Suppose there are <inline-formula><mml:math id="inf321"><mml:mi>n</mml:mi></mml:math></inline-formula> individuals and <inline-formula><mml:math id="inf322"><mml:mi>m</mml:mi></mml:math></inline-formula> loci, <inline-formula><mml:math id="inf323"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is their <inline-formula><mml:math id="inf324"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> genotype matrix, and <inline-formula><mml:math id="inf325"><mml:mi mathvariant="bold">y</mml:mi></mml:math></inline-formula> is the length-<inline-formula><mml:math id="inf326"><mml:mi>n</mml:mi></mml:math></inline-formula> column vector of individual trait values. The additive linear model for a quantitative (continuous) trait is:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold">Z</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where 1 is a length-<inline-formula><mml:math id="inf327"><mml:mi>n</mml:mi></mml:math></inline-formula> vector of ones, <inline-formula><mml:math id="inf328"><mml:mi>α</mml:mi></mml:math></inline-formula> is the scalar intercept coefficient, <inline-formula><mml:math id="inf329"><mml:mi mathvariant="bold-italic">β</mml:mi></mml:math></inline-formula> is the length-<inline-formula><mml:math id="inf330"><mml:mi>m</mml:mi></mml:math></inline-formula> vector of locus coefficients, <inline-formula><mml:math id="inf331"><mml:mi mathvariant="bold">Z</mml:mi></mml:math></inline-formula> is a design matrix of environment effects and other covariates, <inline-formula><mml:math id="inf332"><mml:mi mathvariant="bold-italic">η</mml:mi></mml:math></inline-formula> is the vector of environment coefficients, <inline-formula><mml:math id="inf333"><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:math></inline-formula> is a length-<inline-formula><mml:math id="inf334"><mml:mi>n</mml:mi></mml:math></inline-formula> vector of residuals, and the superscript prime symbol (<inline-formula><mml:math id="inf335"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) denotes matrix transposition. The residuals follow <inline-formula><mml:math id="inf336"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>Normal</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> independently per individual <inline-formula><mml:math id="inf337"><mml:mi>j</mml:mi></mml:math></inline-formula>, for some <inline-formula><mml:math id="inf338"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>.</p><p>The full model of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, which has a coefficient for each of the <inline-formula><mml:math id="inf339"><mml:mi>m</mml:mi></mml:math></inline-formula> loci, is underdetermined in current datasets where <inline-formula><mml:math id="inf340"><mml:mrow><mml:mi>m</mml:mi><mml:mo>≫</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>. The PCA and LMM models, respectively, approximate the full model fit at a single locus <inline-formula><mml:math id="inf341"><mml:mi>i</mml:mi></mml:math></inline-formula>:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mtext>PCA:</mml:mtext><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mo>:</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn mathvariant="bold">0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf342"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the length-<inline-formula><mml:math id="inf343"><mml:mi>n</mml:mi></mml:math></inline-formula> vector of genotypes at locus <inline-formula><mml:math id="inf344"><mml:mi>i</mml:mi></mml:math></inline-formula> only, <inline-formula><mml:math id="inf345"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the locus coefficient, <inline-formula><mml:math id="inf346"><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> is an <inline-formula><mml:math id="inf347"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> matrix of PCs, <inline-formula><mml:math id="inf348"><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> is the length-<inline-formula><mml:math id="inf349"><mml:mi>r</mml:mi></mml:math></inline-formula> vector of PC coefficients, <inline-formula><mml:math id="inf350"><mml:mi mathvariant="bold">s</mml:mi></mml:math></inline-formula> is a length-<inline-formula><mml:math id="inf351"><mml:mi>n</mml:mi></mml:math></inline-formula> vector of random effects, <inline-formula><mml:math id="inf352"><mml:mrow><mml:msup><mml:mi mathvariant="bold">Φ</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>φ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the <inline-formula><mml:math id="inf353"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> kinship matrix conditioned on the ancestral population <inline-formula><mml:math id="inf354"><mml:mi>T</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf355"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is a variance factor. Both models condition the regression of the focal locus <inline-formula><mml:math id="inf356"><mml:mi>i</mml:mi></mml:math></inline-formula> on an approximation of the total polygenic effect <inline-formula><mml:math id="inf357"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math></inline-formula> with the same covariance structure, which is parameterized by the kinship matrix. Under the kinship model, genotypes are random variables obeying<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi>Cov</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>Φ</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf358"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> is the ancestral allele frequency of locus <inline-formula><mml:math id="inf359"><mml:mi>i</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib56">Malécot, 1948</xref>; <xref ref-type="bibr" rid="bib107">Wright, 1949</xref>; <xref ref-type="bibr" rid="bib38">Jacquard, 1970</xref>; <xref ref-type="bibr" rid="bib8">Astle and Balding, 2009</xref>). Assuming independent loci, the covariance of the polygenic effect is<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:mi>Cov</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mn>2</mml:mn><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which is readily modeled by the LMM random effect <inline-formula><mml:math id="inf360"><mml:mi mathvariant="bold">s</mml:mi></mml:math></inline-formula>, where the difference in mean is absorbed by the intercept. Alternatively, consider the eigendecomposition of the kinship matrix <inline-formula><mml:math id="inf361"><mml:mrow><mml:msup><mml:mi mathvariant="bold">Φ</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">Λ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf362"><mml:mi mathvariant="bold">U</mml:mi></mml:math></inline-formula> is the <inline-formula><mml:math id="inf363"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> eigenvector matrix and <inline-formula><mml:math id="inf364"><mml:mi mathvariant="bold">Λ</mml:mi></mml:math></inline-formula> is the <inline-formula><mml:math id="inf365"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> diagonal matrix of eigenvalues. The random effect can be written as<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold">Λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which follows from the affine transformation property of multivariate normal distributions. Therefore, the PCA term <inline-formula><mml:math id="inf366"><mml:mrow><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can be derived from the above equation under the additional assumption that the kinship matrix has approximate rank <inline-formula><mml:math id="inf367"><mml:mi>r</mml:mi></mml:math></inline-formula> and the coefficients <inline-formula><mml:math id="inf368"><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> are fit without constraints. In contrast, the LMM uses all eigenvectors, while effectively shrinking their coefficients <inline-formula><mml:math id="inf369"><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mtext>LMM</mml:mtext></mml:msub></mml:math></inline-formula> as all random effects models do, although these parameters are marginalized (<xref ref-type="bibr" rid="bib8">Astle and Balding, 2009</xref>; <xref ref-type="bibr" rid="bib39">Janss et al., 2012</xref>; <xref ref-type="bibr" rid="bib33">Hoffman and Dubé, 2013</xref>; <xref ref-type="bibr" rid="bib117">Zhang and Pan, 2015</xref>). PCA has more parameters than LMM, so it may overfit more: ignoring the shared terms in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> and <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>, PCA fits <inline-formula><mml:math id="inf370"><mml:mi>r</mml:mi></mml:math></inline-formula> parameters (length of <inline-formula><mml:math id="inf371"><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:math></inline-formula>), whereas LMMs fit only one (<inline-formula><mml:math id="inf372"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>).</p><p>In practice, the kinship matrix used for PCA and LMM is estimated with variations of a method-of-moments formula applied to standardized genotypes <inline-formula><mml:math id="inf373"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula>, which is derived from <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>:<disp-formula id="equ7"><label>(5)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msqrt><mml:mn>4</mml:mn><mml:msubsup><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the unknown <inline-formula><mml:math id="inf374"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> is estimated by <inline-formula><mml:math id="inf375"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib77">Price et al., 2006</xref>; <xref ref-type="bibr" rid="bib42">Kang et al., 2008</xref>; <xref ref-type="bibr" rid="bib43">Kang et al., 2010</xref>; <xref ref-type="bibr" rid="bib110">Yang et al., 2011</xref>; <xref ref-type="bibr" rid="bib121">Zhou and Stephens, 2012</xref>; <xref ref-type="bibr" rid="bib111">Yang et al., 2014</xref>; <xref ref-type="bibr" rid="bib53">Loh et al., 2015</xref>; <xref ref-type="bibr" rid="bib98">Sul et al., 2018</xref>; <xref ref-type="bibr" rid="bib123">Zhou et al., 2018</xref>). However, this kinship estimator has a complex bias that differs for every individual pair, which arises due to the use of this estimated <inline-formula><mml:math id="inf376"><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>; <xref ref-type="bibr" rid="bib67">Ochoa and Storey, 2019</xref>). Nevertheless, in PCA and LMM these biased estimates perform as well as unbiased ones (<xref ref-type="bibr" rid="bib36">Hou et al., 2023b</xref>).</p><p>We selected fast and robust software implementing the basic PCA and LMM models. PCA association was performed with plink2 (<xref ref-type="bibr" rid="bib15">Chang et al., 2015</xref>). The quantitative trait association model is a linear regression with covariates, evaluated using the t-test. PCs were calculated with plink2, which equal the top eigenvectors of <xref ref-type="disp-formula" rid="equ7">Equation 5</xref> after removing loci with minor allele frequency <inline-formula><mml:math id="inf377"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>MAF</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>LMM association was performed using GCTA (<xref ref-type="bibr" rid="bib110">Yang et al., 2011</xref>; <xref ref-type="bibr" rid="bib111">Yang et al., 2014</xref>). Its kinship estimator equals <xref ref-type="disp-formula" rid="equ7">Equation 5</xref>. PCs were calculated using GCTA from its kinship estimate. Association significance is evaluated with a score test. In the small simulation only, GCTA with large numbers of PCs had convergence and singularity errors in some replicates, which were treated as missing data.</p></sec><sec id="s4-2"><title>Simulations</title><p>Every simulation was replicated 50 times, drawing anew all genotypes (except for real datasets) and traits. Below we use the notation <inline-formula><mml:math id="inf378"><mml:msubsup><mml:mi>f</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:math></inline-formula> for the inbreeding coefficient of a subpopulation <inline-formula><mml:math id="inf379"><mml:mi>A</mml:mi></mml:math></inline-formula> from another subpopulation <inline-formula><mml:math id="inf380"><mml:mi>B</mml:mi></mml:math></inline-formula> ancestral to <inline-formula><mml:math id="inf381"><mml:mi>A</mml:mi></mml:math></inline-formula>. In the special case of the <italic>total</italic> inbreeding of <inline-formula><mml:math id="inf382"><mml:mi>A</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf383"><mml:msubsup><mml:mi>f</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf384"><mml:mi>T</mml:mi></mml:math></inline-formula> is an overall ancestral population, which is ancestral to every individual under consideration, such as the most recent common ancestor (MRCA) population.</p><sec id="s4-2-1"><title>Genotype simulation from the admixture model</title><p>The basic admixture model is as described previously (<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>) and is implemented in the R package bnpsd. Both Large and Family simulations have <inline-formula><mml:math id="inf385"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> individuals, while Small has <inline-formula><mml:math id="inf386"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>. The number of loci is <inline-formula><mml:math id="inf387"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. Individuals are admixed from <inline-formula><mml:math id="inf388"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> intermediate subpopulations, or ancestries. Each subpopulation <inline-formula><mml:math id="inf389"><mml:msub><mml:mi>S</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf390"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) is at coordinate <inline-formula><mml:math id="inf391"><mml:mi>u</mml:mi></mml:math></inline-formula> and has an inbreeding coefficient <inline-formula><mml:math id="inf392"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for some <inline-formula><mml:math id="inf393"><mml:mi>τ</mml:mi></mml:math></inline-formula>. Ancestry proportions <inline-formula><mml:math id="inf394"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for individual <inline-formula><mml:math id="inf395"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf396"><mml:msub><mml:mi>S</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math></inline-formula> arise from a random walk with spread <inline-formula><mml:math id="inf397"><mml:mi>σ</mml:mi></mml:math></inline-formula> on the 1D geography, and <inline-formula><mml:math id="inf398"><mml:mi>τ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf399"><mml:mi>σ</mml:mi></mml:math></inline-formula> are fit to give <inline-formula><mml:math id="inf400"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>ST</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> and mean kinship <inline-formula><mml:math id="inf401"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mtext>ST</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for the admixed individuals (<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>). Random ancestral allele frequencies <inline-formula><mml:math id="inf402"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>, subpopulation allele frequencies <inline-formula><mml:math id="inf403"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:msubsup></mml:math></inline-formula>, individual-specific allele frequencies <inline-formula><mml:math id="inf404"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and genotypes <inline-formula><mml:math id="inf405"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are drawn from this hierarchical model:<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mi/><mml:mo>∼</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where this Beta is the Balding-Nichols distribution (<xref ref-type="bibr" rid="bib10">Balding and Nichols, 1995</xref>) with mean <inline-formula><mml:math id="inf406"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> and variance <inline-formula><mml:math id="inf407"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. Fixed loci (<inline-formula><mml:math id="inf408"><mml:mi>i</mml:mi></mml:math></inline-formula> where <inline-formula><mml:math id="inf409"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf410"><mml:mi>j</mml:mi></mml:math></inline-formula>, or <inline-formula><mml:math id="inf411"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf412"><mml:mi>j</mml:mi></mml:math></inline-formula>) are drawn again from the model, starting from <inline-formula><mml:math id="inf413"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>, iterating until no loci are fixed. Each replicate draws a genotypes starting from <inline-formula><mml:math id="inf414"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>.</p><p>As a brief aside, we prove that global ancestry proportions as covariates is equivalent in expectation to using PCs under the admixture model. Note that the latent space of <inline-formula><mml:math id="inf415"><mml:mi mathvariant="bold">X</mml:mi></mml:math></inline-formula>, which is the subspace to which the data is constrained by the admixture model, is given by <inline-formula><mml:math id="inf416"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which has <inline-formula><mml:math id="inf417"><mml:mi>K</mml:mi></mml:math></inline-formula> dimensions (number of columns of <inline-formula><mml:math id="inf418"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), so the top <inline-formula><mml:math id="inf419"><mml:mi>K</mml:mi></mml:math></inline-formula> PCs span this space. Since associations include an intercept term (<inline-formula><mml:math id="inf420"><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>), estimated PCs are orthogonal to 1  (note <inline-formula><mml:math id="inf421"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> because <inline-formula><mml:math id="inf422"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:math></inline-formula>), and the sum of rows of <inline-formula><mml:math id="inf423"><mml:mi mathvariant="bold">Q</mml:mi></mml:math></inline-formula> sums to one, then only <inline-formula><mml:math id="inf424"><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> PCs plus the intercept are needed to span the latent space of this admixture model.</p></sec><sec id="s4-2-2"><title>Genotype simulation from random admixed families</title><p>We simulated a pedigree with admixed founders, no close relative pairings, assortative mating based on a 1D geography (to preserve admixture structure), random family sizes, and arbitrary numbers of generations (20 here). This simulation is implemented in the R package simfam. Generations are drawn iteratively. Generation 1 has <inline-formula><mml:math id="inf425"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> individuals from the above admixture simulation ordered by their 1D geography. Local kinship measures pedigree relatedness; in the first generation, everybody is locally unrelated and outbred. Individuals are randomly assigned sex. In the next generation, individuals are paired iteratively, removing random males from the pool of available males and pairing them with the nearest available female with local kinship <inline-formula><mml:math id="inf426"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (stay unpaired if there are no matches), until there are no more available males or females. Let <inline-formula><mml:math id="inf427"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> be the desired population size, <inline-formula><mml:math id="inf428"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> the minimum number of children per family and <italic>n</italic><sub><italic>f</italic></sub> the number of families (paired parents) in the current generation, then the number of additional children (beyond the minimum) is drawn from <inline-formula><mml:math id="inf429"><mml:mrow><mml:mtext>Poisson</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Let <inline-formula><mml:math id="inf430"><mml:mi>δ</mml:mi></mml:math></inline-formula> be the difference between desired and current population sizes. If <inline-formula><mml:math id="inf431"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, then <inline-formula><mml:math id="inf432"><mml:mi>δ</mml:mi></mml:math></inline-formula> random families are incremented by 1. If <inline-formula><mml:math id="inf433"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, then <inline-formula><mml:math id="inf434"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> random families with at least <inline-formula><mml:math id="inf435"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> children are decremented by 1. If <inline-formula><mml:math id="inf436"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> exceeds the number of families, all families are incremented or decremented as needed and the process is iterated. Children are assigned sex randomly, and are reordered by the average coordinate of their parents. Children draw alleles from their parents independently per locus. A new random pedigree is drawn for each replicate, as well as new founder genotypes from the admixture model.</p></sec><sec id="s4-2-3"><title>Genotype simulation from a subpopulation tree model</title><p>This model draws subpopulations allele frequencies from a hierarchical model parameterized by a tree, which is also implemented in bnpsd and relies on the R package ape for general tree data structures and methods (<xref ref-type="bibr" rid="bib71">Paradis and Schliep, 2019</xref>). The ancestral population <inline-formula><mml:math id="inf437"><mml:mi>T</mml:mi></mml:math></inline-formula> is the root, and each node is a subpopulation <inline-formula><mml:math id="inf438"><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> indexed arbitrarily. Each edge between <inline-formula><mml:math id="inf439"><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> and its parent population <inline-formula><mml:math id="inf440"><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> has an inbreeding coefficient <inline-formula><mml:math id="inf441"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf442"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> are drawn from a given distribution, which is constructed to mimic each real dataset in Appendix 1. Given the allele frequencies <inline-formula><mml:math id="inf443"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:msubsup></mml:math></inline-formula> of the parent population, <inline-formula><mml:math id="inf444"><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula>’s allele frequencies are drawn from:<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Individuals <inline-formula><mml:math id="inf445"><mml:mi>j</mml:mi></mml:math></inline-formula> in <inline-formula><mml:math id="inf446"><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> draw genotypes from its allele frequency: <inline-formula><mml:math id="inf447"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> Loci with <inline-formula><mml:math id="inf448"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>MAF</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> are drawn again starting from the <inline-formula><mml:math id="inf449"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> distribution, iterating until no such loci remain.</p></sec><sec id="s4-2-4"><title>Fitting subpopulation tree to real data</title><p>We developed new methods to fit trees to real data based on unbiased kinship estimates from popkin, implemented in bnpsd. A tree with given inbreeding coefficients <inline-formula><mml:math id="inf450"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:msubsup></mml:math></inline-formula> for its edges (between subpopulation <inline-formula><mml:math id="inf451"><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> and its parent <inline-formula><mml:math id="inf452"><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula>) gives rise to a coancestry matrix <inline-formula><mml:math id="inf453"><mml:msubsup><mml:mi>ϑ</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> for a subpopulation pair (<inline-formula><mml:math id="inf454"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), and the goal is to recover these edge inbreeding coefficients from coancestry estimates. Coancestry values are total inbreeding coefficients of the MRCA population of each subpopulation pair. Therefore, we calculate <inline-formula><mml:math id="inf455"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> for every <inline-formula><mml:math id="inf456"><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> recursively from the root as follows. Nodes with parent <inline-formula><mml:math id="inf457"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> are already as desired. Given <inline-formula><mml:math id="inf458"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>, the desired <inline-formula><mml:math id="inf459"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> is calculated via the ‘additive edge’ <inline-formula><mml:math id="inf460"><mml:msub><mml:mi>δ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>):<disp-formula id="equ10"><label>(6)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>These <inline-formula><mml:math id="inf461"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> because <inline-formula><mml:math id="inf462"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for every <inline-formula><mml:math id="inf463"><mml:mi>w</mml:mi></mml:math></inline-formula>. Edge inbreeding coefficients can be recovered from additive edges: <inline-formula><mml:math id="inf464"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Overall, coancestry values are sums of <inline-formula><mml:math id="inf465"><mml:msub><mml:mi>δ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> over common ancestor nodes,<disp-formula id="equ11"><label>(7)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>ϑ</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the sum includes all <inline-formula><mml:math id="inf466"><mml:mi>w</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf467"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> equals 1 if <inline-formula><mml:math id="inf468"><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> is a common ancestor of <inline-formula><mml:math id="inf469"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, 0 otherwise. Note that <inline-formula><mml:math id="inf470"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> reflects tree topology and <inline-formula><mml:math id="inf471"><mml:msub><mml:mi>δ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> edge values.</p><p>To estimate population-level coancestry, first kinship (<inline-formula><mml:math id="inf472"><mml:msubsup><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>) is estimated using popkin (<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>). Individual coancestry (<inline-formula><mml:math id="inf473"><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>) is estimated from kinship using<disp-formula id="equ12"><label>(8)</label><mml:math id="m12"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mover><mml:mi>φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mover><mml:mi>φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Lastly, coancestry <inline-formula><mml:math id="inf474"><mml:msubsup><mml:mover accent="true"><mml:mi>ϑ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> between subpopulations are averages of individual coancestry values:<disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mrow><mml:mover><mml:mi>ϑ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Topology is estimated with hierarchical clustering using the weighted pair group method with arithmetic mean (<xref ref-type="bibr" rid="bib92">Sokal and Michener, 1958</xref>), with distance function <inline-formula><mml:math id="inf475"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>ϑ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>ϑ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> which succeeds due to the monotonic relationship between node depth and coancestry (<xref ref-type="disp-formula" rid="equ11">Equation 7</xref>). This algorithm recovers the true topology from the true coancestry values, and performs well for estimates from genotypes.</p><p>To estimate tree edge lengths, first <inline-formula><mml:math id="inf476"><mml:msub><mml:mi>δ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> are estimated from <inline-formula><mml:math id="inf477"><mml:msubsup><mml:mover accent="true"><mml:mi>ϑ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> and the topology using <xref ref-type="disp-formula" rid="equ11">Equation 7</xref> and non-negative least squares linear regression (<xref ref-type="bibr" rid="bib44">Lawson and Hanson, 1974</xref>) (implemented in nnls; <xref ref-type="bibr" rid="bib65">Mullen, 2012</xref>) to yield non-negative <inline-formula><mml:math id="inf478"><mml:msub><mml:mi>δ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf479"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:msubsup></mml:math></inline-formula> are calculated from <inline-formula><mml:math id="inf480"><mml:msub><mml:mi>δ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> by reversing <xref ref-type="disp-formula" rid="equ7">Equation 5</xref>. To account for small biases in coancestry estimation, an intercept term <inline-formula><mml:math id="inf481"><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is included (<inline-formula><mml:math id="inf482"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf483"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math></inline-formula>), and when converting <inline-formula><mml:math id="inf484"><mml:msub><mml:mi>δ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf485"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf486"><mml:msub><mml:mi>δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is treated as an additional edge to the root, but is ignored when drawing allele frequencies from the tree.</p></sec><sec id="s4-2-5"><title>Trait simulation</title><p>Traits are simulated from the quantitative trait model of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, with novel bias corrections for simulating the desired heritability from real data relying on the unbiased kinship estimator popkin (<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>). This simulation is implemented in the R package simtrait. All simulations have a fixed narrow-sense heritability of <inline-formula><mml:math id="inf487"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>, a variance proportion due to environment effects <inline-formula><mml:math id="inf488"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, and residuals are drawn from <inline-formula><mml:math id="inf489"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>Normal</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf490"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. The number of causal loci <italic>m</italic><sub>1</sub>, which determines the average coefficient size, is chosen with the heuristic formula <inline-formula><mml:math id="inf491"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>round</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mn>8</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which empirically balances power well with varying <inline-formula><mml:math id="inf492"><mml:mi>n</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf493"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. The set of causal loci <inline-formula><mml:math id="inf494"><mml:mi>C</mml:mi></mml:math></inline-formula> is drawn anew for each replicate, from loci with <inline-formula><mml:math id="inf495"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>MAF</mml:mtext><mml:mo>≥</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> to avoid rare causal variants, which are not discoverable by PCA or LMM at the sample sizes we considered. Letting <inline-formula><mml:math id="inf496"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, the effect size of locus <inline-formula><mml:math id="inf497"><mml:mi>i</mml:mi></mml:math></inline-formula> equals <inline-formula><mml:math id="inf498"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, its contribution of the trait variance (<xref ref-type="bibr" rid="bib72">Park et al., 2010</xref>). Under the <italic>fixed effect sizes</italic> (FES) model, initial causal coefficients are<disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:msqrt></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>for known <inline-formula><mml:math id="inf499"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>; otherwise <inline-formula><mml:math id="inf500"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> is replaced by the unbiased estimator (<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>) <inline-formula><mml:math id="inf501"><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf502"><mml:msup><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> is the mean kinship estimated with popkin. Each causal locus is multiplied by –1 with probability 0.5. Alternatively, under the <italic>random coefficients</italic> (RC) model, initial causal coefficients are drawn independently from <inline-formula><mml:math id="inf503"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>Normal</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. For both models, the initial genetic variance is <inline-formula><mml:math id="inf504"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> replacing <inline-formula><mml:math id="inf505"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> with <inline-formula><mml:math id="inf506"><mml:msubsup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> for unknown <inline-formula><mml:math id="inf507"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> (so <inline-formula><mml:math id="inf508"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is an unbiased estimate), so we multiply every initial <inline-formula><mml:math id="inf509"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> by <inline-formula><mml:math id="inf510"><mml:mfrac><mml:mi>h</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:math></inline-formula> to have the desired heritability. Lastly, for known <inline-formula><mml:math id="inf511"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>, the intercept coefficient is <inline-formula><mml:math id="inf512"><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> When <inline-formula><mml:math id="inf513"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> are unknown, <inline-formula><mml:math id="inf514"><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> should not replace <inline-formula><mml:math id="inf515"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> since that distorts the trait covariance (for the same reason the standard kinship estimator in <xref ref-type="disp-formula" rid="equ7">Equation 5</xref> is biased), which is avoided with<disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Simulations optionally included multiple environment group effects, similarly to previous models (<xref ref-type="bibr" rid="bib117">Zhang and Pan, 2015</xref>; <xref ref-type="bibr" rid="bib105">Wang et al., 2022</xref>), as follows. Each independent environment <inline-formula><mml:math id="inf516"><mml:mi>i</mml:mi></mml:math></inline-formula> has predefined groups, and each group <inline-formula><mml:math id="inf517"><mml:mi>g</mml:mi></mml:math></inline-formula> has random coefficients drawn independent from <inline-formula><mml:math id="inf518"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>Normal</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf519"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is a specified variance proportion for environment <inline-formula><mml:math id="inf520"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf521"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> has individuals along columns and environment-groups along rows, and it contains indicator variables: 1 if the individual belongs to the environment-group, 0 otherwise.</p><p>We performed trait simulations with the following variance parameters (<xref ref-type="table" rid="table7">Table 7</xref>): <italic>high heritability</italic> used <inline-formula><mml:math id="inf522"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> and no environment effects; <italic>low heritability</italic> used <inline-formula><mml:math id="inf523"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> and no environment effects; lastly, <italic>environment</italic> used <inline-formula><mml:math id="inf524"><mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (total <inline-formula><mml:math id="inf525"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>). For real genotype datasets, the groups are the continental (environment 1) and fine-grained (environment 2) subpopulation labels given (see next subsection). For simulated genotypes, we created these labels by grouping by the index <inline-formula><mml:math id="inf526"><mml:mi>j</mml:mi></mml:math></inline-formula> (geographical coordinate) of each simulated individual, assigning group <inline-formula><mml:math id="inf527"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mtext>ceiling</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where <italic>k</italic><sub><italic>i</italic></sub> is the number of groups in environment <inline-formula><mml:math id="inf528"><mml:mi>i</mml:mi></mml:math></inline-formula>, and we selected <inline-formula><mml:math id="inf529"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf530"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula> to mimic the number of groups in each level of 1000 Genomes (<xref ref-type="table" rid="table2">Table 2</xref>).</p><table-wrap id="table7" position="float"><label>Table 7.</label><caption><title>Variance parameters of trait simulations.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Trait variance type</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf531"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf532"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf533"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom">High heritability</td><td align="char" char="." valign="bottom">0.8</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">0.2</td></tr><tr><td align="left" valign="bottom">Low heritability</td><td align="char" char="." valign="bottom">0.3</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">0.7</td></tr><tr><td align="left" valign="bottom">Environment</td><td align="char" char="." valign="bottom">0.3</td><td align="char" char="." valign="bottom">0.5</td><td align="char" char="." valign="bottom">0.2</td></tr></tbody></table></table-wrap></sec></sec><sec id="s4-3"><title>Real human genotype datasets</title><p>The three datasets were processed as before (<xref ref-type="bibr" rid="bib67">Ochoa and Storey, 2019</xref>; summarized below), except with an additional filter so loci are in approximate linkage equilibrium and rare variants are removed. All processing was performed with plink2 (<xref ref-type="bibr" rid="bib15">Chang et al., 2015</xref>), and analysis was uniquely enabled by the R packages BEDMatrix (<xref ref-type="bibr" rid="bib27">Grueneberg and de Los Campos, 2019</xref>) and genio. Each dataset groups individuals in a two-level hierarchy: continental and fine-grained subpopulations. Final dataset sizes are in <xref ref-type="table" rid="table2">Table 2</xref>.</p><p>We obtained the full (including non-public) Human Origins by contacting the authors and agreeing to their usage restrictions. The Pacific data (<xref ref-type="bibr" rid="bib91">Skoglund et al., 2016</xref>) was obtained separately from the rest (<xref ref-type="bibr" rid="bib45">Lazaridis et al., 2014</xref>; <xref ref-type="bibr" rid="bib46">Lazaridis et al., 2016</xref>), and datasets were merged using the intersection of loci. We removed ancient individuals, and individuals from singleton and non-native subpopulations. Non-autosomal loci were removed. Our analysis of both the whole-genome sequencing (WGS) version of HGDP (<xref ref-type="bibr" rid="bib11">Bergström et al., 2020</xref>) and the high-coverage NYGC version of 1000 Genomes (<xref ref-type="bibr" rid="bib21">Fairley et al., 2020</xref>) was restricted to autosomal biallelic SNP loci with filter “PASS”.</p><p>Since our evaluations assume uncorrelated loci, we filtered each real dataset with plink2 using parameters “--indep-pairwise 1000kb 0.3”, which iteratively removes loci that have a greater than 0.3 squared correlation coefficient with another locus that is within 1000 kb, stopping until no such loci remain. Since all real datasets have numerous rare variants, while PCA and LMM are not able to detect associations involving rare variants, we removed all loci with <inline-formula><mml:math id="inf534"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>MAF</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Lastly, only HGDP had loci with over 10% missingness removed, as they were otherwise 17% of remaining loci (for Human Origins and 1000 Genomes they were under 1% of loci so they were not removed). Kinship matrix rank and eigenvalues were calculated from popkin kinship estimates. Eigenvalues were assigned p-values with twstats of the Eigensoft package (<xref ref-type="bibr" rid="bib74">Patterson et al., 2006</xref>), and kinship matrix rank was estimated as the largest number of consecutive eigenvalue from the start that all satisfy <inline-formula><mml:math id="inf535"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (p-values did not increase monotonically). For the evaluation with close relatives removed, each dataset was filtered with plink2 with option “--king-cutoff” with cutoff 0.02209709 (<inline-formula><mml:math id="inf536"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>11</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) for removing up to 4th degree relatives using KING-robust (<xref ref-type="bibr" rid="bib57">Manichaikul et al., 2010</xref>), and <inline-formula><mml:math id="inf537"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>MAF</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> filter is reapplied (<xref ref-type="table" rid="table4">Table 4</xref>).</p></sec><sec id="s4-4"><title>Evaluation of performance</title><p>All approaches are evaluated using two complementary metrics: <inline-formula><mml:math id="inf538"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> quantifies p-value uniformity, and <inline-formula><mml:math id="inf539"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> measures causal locus classification performance and reflects power while ranking miscalibrated models fairly. These measures are more robust alternatives to previous measures from the literature (Appendix 2), and are implemented in simtrait.</p><p>P-values for continuous test statistics have a uniform distribution when the null hypothesis holds, a crucial assumption for type I error and FDR control (<xref ref-type="bibr" rid="bib95">Storey, 2003</xref>; <xref ref-type="bibr" rid="bib96">Storey and Tibshirani, 2003</xref>). We use the Signed Root Mean Square Deviation (<inline-formula><mml:math id="inf540"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>) to measure the difference between the observed null p-value quantiles and the expected uniform quantiles:<disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf541"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of null (non-causal) loci, here <inline-formula><mml:math id="inf542"><mml:mi>i</mml:mi></mml:math></inline-formula> indexes null loci only, <inline-formula><mml:math id="inf543"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is the <inline-formula><mml:math id="inf544"><mml:mi>i</mml:mi></mml:math></inline-formula> th ordered null p-value, <inline-formula><mml:math id="inf545"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is its expectation, <inline-formula><mml:math id="inf546"><mml:msub><mml:mi>p</mml:mi><mml:mtext>median</mml:mtext></mml:msub></mml:math></inline-formula> is the median observed null p-value, <inline-formula><mml:math id="inf547"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mtext>median</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> is its expectation, and sgn is the sign function (1 if <inline-formula><mml:math id="inf548"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext>median</mml:mtext></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>median</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, –1 otherwise). Thus, <inline-formula><mml:math id="inf549"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> corresponds to calibrated p-values, <inline-formula><mml:math id="inf550"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> indicate anti-conservative p-values, and <inline-formula><mml:math id="inf551"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> are conservative p-values. The maximum <inline-formula><mml:math id="inf552"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> is achieved when all p-values are zero (the limit of anti-conservative p-values), which for infinite loci approaches<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msqrt><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:msqrt><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mo>≈</mml:mo><mml:mn>0.577.</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The same value with a negative sign occurs for all p-values of 1.</p><p>Precision and recall are standard performance measures for binary classifiers that do not require calibrated p-values (<xref ref-type="bibr" rid="bib26">Grau et al., 2015</xref>). Given the total numbers of true positives (TP), false positives (FP) and false negatives (FN) at some threshold or parameter <inline-formula><mml:math id="inf553"><mml:mi>t</mml:mi></mml:math></inline-formula>, precision and recall are<disp-formula id="equ18"><mml:math id="m18"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Precision and Recall trace a curve as <inline-formula><mml:math id="inf554"><mml:mi>t</mml:mi></mml:math></inline-formula> is varied, and the area under this curve is <inline-formula><mml:math id="inf555"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>. We use the R package PRROC to integrate the correct non-linear piecewise function when interpolating between points. A model obtains the maximum <inline-formula><mml:math id="inf556"><mml:mrow><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if there is a <inline-formula><mml:math id="inf557"><mml:mi>t</mml:mi></mml:math></inline-formula> that classifies all loci perfectly. In contrast, the worst models, which classify at random, have an expected precision (<inline-formula><mml:math id="inf558"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>) equal to the overall proportion of causal loci: <inline-formula><mml:math id="inf559"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-5"><title>Data and code availability</title><p>The data and code generated during this study are available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/OchoaLab/pca-assoc-paper">https://github.com/OchoaLab/pca-assoc-paper</ext-link> (copy archived at <xref ref-type="bibr" rid="bib69">Ochoa, 2023</xref>). The public subset of Human Origins is available on the Reich Lab website at <ext-link ext-link-type="uri" xlink:href="https://reich.hms.harvard.edu/datasets">https://reich.hms.harvard.edu/datasets</ext-link>; non-public samples have to be requested from David Reich. The WGS version of HGDP was downloaded from the Wellcome Sanger Institute FTP site at <ext-link ext-link-type="uri" xlink:href="ftp://ngs.sanger.ac.uk/production/hgdp/hgdp_wgs.20190516/">ftp://ngs.sanger.ac.uk/production/hgdp/hgdp_wgs.20190516/</ext-link>. The high-coverage version of the 1000 Genomes Project was downloaded from <ext-link ext-link-type="uri" xlink:href="ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20190425_NYGC_GATK/">ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20190425_NYGC_GATK/</ext-link>.</p></sec><sec id="s4-6"><title>Web resources</title><p>plink2, <ext-link ext-link-type="uri" xlink:href="https://www.cog-genomics.org/plink/2.0/">https://www.cog-genomics.org/plink/2.0/</ext-link> ; GCTA, <ext-link ext-link-type="uri" xlink:href="https://yanglab.westlake.edu.cn/software/gcta/">https://yanglab.westlake.edu.cn/software/gcta/</ext-link> ; Eigensoft, <ext-link ext-link-type="uri" xlink:href="https://github.com/DReichLab/EIG">https://github.com/DReichLab/EIG</ext-link> ; bnpsd, <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=bnpsd">https://cran.r-project.org/package=bnpsd</ext-link> ; simfam, <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=simfam">https://cran.r-project.org/package=simfam</ext-link> ; simtrait, <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=simtrait">https://cran.r-project.org/package=simtrait</ext-link> ; genio, <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=genio">https://cran.r-project.org/package=genio</ext-link> ; popkin, <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=popkin">https://cran.r-project.org/package=popkin</ext-link> ; ape, <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=ape">https://cran.r-project.org/package=ape</ext-link> ; nnls, <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=nnls">https://cran.r-project.org/package=nnls</ext-link> ; PRROC, <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=PRROC">https://cran.r-project.org/package=PRROC</ext-link> ; BEDMatrix, <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=BEDMatrix">https://cran.r-project.org/package=BEDMatrix</ext-link>.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>is affiliated with BenHealth Consulting. The author has no financial interests to declare</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Software, Formal analysis, Investigation, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-79238-mdarchecklist1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. Code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/OchoaLab/pca-assoc-paper">https://github.com/OchoaLab/pca-assoc-paper</ext-link> (copy archived at <xref ref-type="bibr" rid="bib69">Ochoa, 2023</xref>).</p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><name><surname>Fairley</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>1000 Genomes Project, high-coverage version</data-title><source>International Genome Sample Resource</source><pub-id pub-id-type="accession" xlink:href="ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20190425_NYGC_GATK/">NYGC_GATK/</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><name><surname>Bergstrom</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Human Genome Diversity Panel, whole-genome sequencing version</data-title><source>Wellcome Sanger Institute</source><pub-id pub-id-type="accession" xlink:href="ftp://ngs.sanger.ac.uk/production/hgdp/hgdp_wgs.20190516/">wgs.20190516/</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><name><surname>Lazaridis</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Human Origins</data-title><source>David Reich Lab</source><pub-id pub-id-type="accession" xlink:href="https://reich.hms.harvard.edu/datasets">datasets</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>Thanks to Tiffany Tu, Ratchanon Pornmongkolsuk, and Zhuoran Hou for feedback on this article. This work was funded in part by the Duke University School of Medicine Whitehead Scholars Program, a gift from the Whitehead Charitable Foundation. The 1000 Genomes data were generated at the New York Genome Center with funds provided by NHGRI Grant 3UM1HG008901-03S1.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abecasis</surname><given-names>GR</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Auton</surname><given-names>A</given-names></name><name><surname>Brooks</surname><given-names>LD</given-names></name><name><surname>Durbin</surname><given-names>RM</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Hurles</surname><given-names>ME</given-names></name><name><surname>McVean</surname><given-names>GA</given-names></name><collab>1000 Genomes Project Consortium</collab></person-group><year iso-8601-date="2010">2010</year><article-title>A map of human genome variation from population-scale sequencing</article-title><source>Nature</source><volume>467</volume><fpage>1061</fpage><lpage>1073</lpage><pub-id pub-id-type="doi">10.1038/nature09534</pub-id><pub-id pub-id-type="pmid">20981092</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abecasis</surname><given-names>GR</given-names></name><name><surname>Auton</surname><given-names>A</given-names></name><name><surname>Brooks</surname><given-names>LD</given-names></name><name><surname>DePristo</surname><given-names>MA</given-names></name><name><surname>Durbin</surname><given-names>RM</given-names></name><name><surname>Handsaker</surname><given-names>RE</given-names></name><name><surname>Kang</surname><given-names>HM</given-names></name><name><surname>Marth</surname><given-names>GT</given-names></name><name><surname>McVean</surname><given-names>GA</given-names></name><collab>1000 Genomes Project Consortium</collab></person-group><year iso-8601-date="2012">2012</year><article-title>An integrated map of genetic variation from 1,092 human Genomes</article-title><source>Nature</source><volume>491</volume><fpage>56</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1038/nature11632</pub-id><pub-id pub-id-type="pmid">23128226</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abraham</surname><given-names>G</given-names></name><name><surname>Inouye</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Fast principal component analysis of large-scale genome-wide data</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e93766</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0093766</pub-id><pub-id pub-id-type="pmid">24718290</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abraham</surname><given-names>G</given-names></name><name><surname>Qiu</surname><given-names>Y</given-names></name><name><surname>Inouye</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Flashpca2: Principal component analysis of Biobank-scale genotype Datasets</article-title><source>Bioinformatics</source><volume>33</volume><fpage>2776</fpage><lpage>2778</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btx299</pub-id><pub-id pub-id-type="pmid">28475694</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agrawal</surname><given-names>A</given-names></name><name><surname>Chiu</surname><given-names>AM</given-names></name><name><surname>Le</surname><given-names>M</given-names></name><name><surname>Halperin</surname><given-names>E</given-names></name><name><surname>Sankararaman</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Scalable probabilistic PCA for large-scale genetic variation data</article-title><source>PLOS Genetics</source><volume>16</volume><elocation-id>e1008773</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1008773</pub-id><pub-id pub-id-type="pmid">32469896</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexander</surname><given-names>DH</given-names></name><name><surname>Novembre</surname><given-names>J</given-names></name><name><surname>Lange</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Fast model-based estimation of ancestry in unrelated individuals</article-title><source>Genome Research</source><volume>19</volume><fpage>1655</fpage><lpage>1664</lpage><pub-id pub-id-type="doi">10.1101/gr.094052.109</pub-id><pub-id pub-id-type="pmid">19648217</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Al Khudhair</surname><given-names>A</given-names></name><name><surname>Qiu</surname><given-names>S</given-names></name><name><surname>Wyse</surname><given-names>M</given-names></name><name><surname>Chowdhury</surname><given-names>S</given-names></name><name><surname>Cheng</surname><given-names>X</given-names></name><name><surname>Bekbolsynov</surname><given-names>D</given-names></name><name><surname>Saha-Mandal</surname><given-names>A</given-names></name><name><surname>Dutta</surname><given-names>R</given-names></name><name><surname>Fedorova</surname><given-names>L</given-names></name><name><surname>Fedorov</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Inference of distant genetic relations in humans using &quot;1000 Genomes&quot;</article-title><source>Genome Biology and Evolution</source><volume>7</volume><fpage>481</fpage><lpage>492</lpage><pub-id pub-id-type="doi">10.1093/gbe/evv003</pub-id><pub-id pub-id-type="pmid">25573959</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Astle</surname><given-names>W</given-names></name><name><surname>Balding</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Population structure and cryptic relatedness in genetic Association studies</article-title><source>Statistical Science</source><volume>24</volume><fpage>451</fpage><lpage>471</lpage><pub-id pub-id-type="doi">10.1214/09-STS307</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aulchenko</surname><given-names>YS</given-names></name><name><surname>de Koning</surname><given-names>D-J</given-names></name><name><surname>Haley</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Genomewide rapid Association using mixed model and regression: A fast and simple method for Genomewide pedigree-based quantitative trait Loci Association analysis</article-title><source>Genetics</source><volume>177</volume><fpage>577</fpage><lpage>585</lpage><pub-id pub-id-type="doi">10.1534/genetics.107.075614</pub-id><pub-id pub-id-type="pmid">17660554</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balding</surname><given-names>DJ</given-names></name><name><surname>Nichols</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>A method for Quantifying differentiation between populations at multi-Allelic Loci and its implications for investigating identity and Paternity</article-title><source>Genetica</source><volume>96</volume><fpage>3</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1007/BF01441146</pub-id><pub-id pub-id-type="pmid">7607457</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergström</surname><given-names>A</given-names></name><name><surname>McCarthy</surname><given-names>SA</given-names></name><name><surname>Hui</surname><given-names>R</given-names></name><name><surname>Almarri</surname><given-names>MA</given-names></name><name><surname>Ayub</surname><given-names>Q</given-names></name><name><surname>Danecek</surname><given-names>P</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Felkel</surname><given-names>S</given-names></name><name><surname>Hallast</surname><given-names>P</given-names></name><name><surname>Kamm</surname><given-names>J</given-names></name><name><surname>Blanché</surname><given-names>H</given-names></name><name><surname>Deleuze</surname><given-names>JF</given-names></name><name><surname>Cann</surname><given-names>H</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Sandhu</surname><given-names>MS</given-names></name><name><surname>Skoglund</surname><given-names>P</given-names></name><name><surname>Scally</surname><given-names>A</given-names></name><name><surname>Xue</surname><given-names>Y</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name><name><surname>Tyler-Smith</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Insights into human genetic variation and population history from 929 diverse Genomes</article-title><source>Science</source><volume>367</volume><elocation-id>eaay5012</elocation-id><pub-id pub-id-type="doi">10.1126/science.aay5012</pub-id><pub-id pub-id-type="pmid">32193295</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouaziz</surname><given-names>M</given-names></name><name><surname>Ambroise</surname><given-names>C</given-names></name><name><surname>Guedj</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Accounting for population stratification in practice: A comparison of the main strategies dedicated to genome-wide Association studies</article-title><source>PLOS ONE</source><volume>6</volume><elocation-id>e28845</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0028845</pub-id><pub-id pub-id-type="pmid">22216125</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cabreros</surname><given-names>I</given-names></name><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A likelihood-free estimator of population structure bridging admixture models and principal components analysis</article-title><source>Genetics</source><volume>212</volume><fpage>1009</fpage><lpage>1029</lpage><pub-id pub-id-type="doi">10.1534/genetics.119.302159</pub-id><pub-id pub-id-type="pmid">31028112</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cann</surname><given-names>HM</given-names></name><name><surname>de Toma</surname><given-names>C</given-names></name><name><surname>Cazes</surname><given-names>L</given-names></name><name><surname>Legrand</surname><given-names>MF</given-names></name><name><surname>Morel</surname><given-names>V</given-names></name><name><surname>Piouffre</surname><given-names>L</given-names></name><name><surname>Bodmer</surname><given-names>J</given-names></name><name><surname>Bodmer</surname><given-names>WF</given-names></name><name><surname>Bonne-Tamir</surname><given-names>B</given-names></name><name><surname>Cambon-Thomsen</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Chu</surname><given-names>J</given-names></name><name><surname>Carcassi</surname><given-names>C</given-names></name><name><surname>Contu</surname><given-names>L</given-names></name><name><surname>Du</surname><given-names>R</given-names></name><name><surname>Excoffier</surname><given-names>L</given-names></name><name><surname>Ferrara</surname><given-names>GB</given-names></name><name><surname>Friedlaender</surname><given-names>JS</given-names></name><name><surname>Groot</surname><given-names>H</given-names></name><name><surname>Gurwitz</surname><given-names>D</given-names></name><name><surname>Jenkins</surname><given-names>T</given-names></name><name><surname>Herrera</surname><given-names>RJ</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name><name><surname>Kidd</surname><given-names>J</given-names></name><name><surname>Kidd</surname><given-names>KK</given-names></name><name><surname>Langaney</surname><given-names>A</given-names></name><name><surname>Lin</surname><given-names>AA</given-names></name><name><surname>Mehdi</surname><given-names>SQ</given-names></name><name><surname>Parham</surname><given-names>P</given-names></name><name><surname>Piazza</surname><given-names>A</given-names></name><name><surname>Pistillo</surname><given-names>MP</given-names></name><name><surname>Qian</surname><given-names>Y</given-names></name><name><surname>Shu</surname><given-names>Q</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Zhu</surname><given-names>S</given-names></name><name><surname>Weber</surname><given-names>JL</given-names></name><name><surname>Greely</surname><given-names>HT</given-names></name><name><surname>Feldman</surname><given-names>MW</given-names></name><name><surname>Thomas</surname><given-names>G</given-names></name><name><surname>Dausset</surname><given-names>J</given-names></name><name><surname>Cavalli-Sforza</surname><given-names>LL</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>A human genome diversity cell line panel</article-title><source>Science</source><volume>296</volume><fpage>261</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1126/science.296.5566.261b</pub-id><pub-id pub-id-type="pmid">11954565</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>CC</given-names></name><name><surname>Chow</surname><given-names>CC</given-names></name><name><surname>Tellier</surname><given-names>LC</given-names></name><name><surname>Vattikuti</surname><given-names>S</given-names></name><name><surname>Purcell</surname><given-names>SM</given-names></name><name><surname>Lee</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Second-generation PLINK: Rising to the challenge of larger and richer Datasets</article-title><source>GigaScience</source><volume>4</volume><elocation-id>7</elocation-id><pub-id pub-id-type="doi">10.1186/s13742-015-0047-8</pub-id><pub-id pub-id-type="pmid">25722852</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiu</surname><given-names>AM</given-names></name><name><surname>Molloy</surname><given-names>EK</given-names></name><name><surname>Tan</surname><given-names>Z</given-names></name><name><surname>Talwalkar</surname><given-names>A</given-names></name><name><surname>Sankararaman</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Inferring population structure in biobank-scale genomic data</article-title><source>American Journal of Human Genetics</source><volume>109</volume><fpage>727</fpage><lpage>737</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2022.02.015</pub-id><pub-id pub-id-type="pmid">35298920</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conomos</surname><given-names>MP</given-names></name><name><surname>Laurie</surname><given-names>CA</given-names></name><name><surname>Stilp</surname><given-names>AM</given-names></name><name><surname>Gogarten</surname><given-names>SM</given-names></name><name><surname>McHugh</surname><given-names>CP</given-names></name><name><surname>Nelson</surname><given-names>SC</given-names></name><name><surname>Sofer</surname><given-names>T</given-names></name><name><surname>Fernández-Rhodes</surname><given-names>L</given-names></name><name><surname>Justice</surname><given-names>AE</given-names></name><name><surname>Graff</surname><given-names>M</given-names></name><name><surname>Young</surname><given-names>KL</given-names></name><name><surname>Seyerle</surname><given-names>AA</given-names></name><name><surname>Avery</surname><given-names>CL</given-names></name><name><surname>Taylor</surname><given-names>KD</given-names></name><name><surname>Rotter</surname><given-names>JI</given-names></name><name><surname>Talavera</surname><given-names>GA</given-names></name><name><surname>Daviglus</surname><given-names>ML</given-names></name><name><surname>Wassertheil-Smoller</surname><given-names>S</given-names></name><name><surname>Schneiderman</surname><given-names>N</given-names></name><name><surname>Heiss</surname><given-names>G</given-names></name><name><surname>Kaplan</surname><given-names>RC</given-names></name><name><surname>Franceschini</surname><given-names>N</given-names></name><name><surname>Reiner</surname><given-names>AP</given-names></name><name><surname>Shaffer</surname><given-names>JR</given-names></name><name><surname>Barr</surname><given-names>RG</given-names></name><name><surname>Kerr</surname><given-names>KF</given-names></name><name><surname>Browning</surname><given-names>SR</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name><name><surname>Weir</surname><given-names>BS</given-names></name><name><surname>Avilés-Santa</surname><given-names>ML</given-names></name><name><surname>Papanicolaou</surname><given-names>GJ</given-names></name><name><surname>Lumley</surname><given-names>T</given-names></name><name><surname>Szpiro</surname><given-names>AA</given-names></name><name><surname>North</surname><given-names>KE</given-names></name><name><surname>Rice</surname><given-names>K</given-names></name><name><surname>Thornton</surname><given-names>TA</given-names></name><name><surname>Laurie</surname><given-names>CC</given-names></name></person-group><year iso-8601-date="2016">2016a</year><article-title>Genetic diversity and Association studies in US Hispanic/Latino populations: Applications in the Hispanic community health study/study of Latinos</article-title><source>The American Journal of Human Genetics</source><volume>98</volume><fpage>165</fpage><lpage>184</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2015.12.001</pub-id><pub-id pub-id-type="pmid">26748518</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conomos</surname><given-names>MP</given-names></name><name><surname>Reiner</surname><given-names>AP</given-names></name><name><surname>Weir</surname><given-names>BS</given-names></name><name><surname>Thornton</surname><given-names>TA</given-names></name></person-group><year iso-8601-date="2016">2016b</year><article-title>Model-free estimation of recent genetic relatedness</article-title><source>The American Journal of Human Genetics</source><volume>98</volume><fpage>127</fpage><lpage>148</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2015.11.022</pub-id><pub-id pub-id-type="pmid">26748516</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coram</surname><given-names>MA</given-names></name><name><surname>Duan</surname><given-names>Q</given-names></name><name><surname>Hoffmann</surname><given-names>TJ</given-names></name><name><surname>Thornton</surname><given-names>T</given-names></name><name><surname>Knowles</surname><given-names>JW</given-names></name><name><surname>Johnson</surname><given-names>NA</given-names></name><name><surname>Ochs-Balcom</surname><given-names>HM</given-names></name><name><surname>Donlon</surname><given-names>TA</given-names></name><name><surname>Martin</surname><given-names>LW</given-names></name><name><surname>Eaton</surname><given-names>CB</given-names></name><name><surname>Robinson</surname><given-names>JG</given-names></name><name><surname>Risch</surname><given-names>NJ</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name><name><surname>Kooperberg</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Reiner</surname><given-names>AP</given-names></name><name><surname>Tang</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genome-wide characterization of shared and distinct genetic components that influence blood lipid levels in ethnically diverse human populations</article-title><source>American Journal of Human Genetics</source><volume>92</volume><fpage>904</fpage><lpage>916</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2013.04.025</pub-id><pub-id pub-id-type="pmid">23726366</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Devlin</surname><given-names>B</given-names></name><name><surname>Roeder</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Genomic control for Association studies</article-title><source>Biometrics</source><volume>55</volume><fpage>997</fpage><lpage>1004</lpage><pub-id pub-id-type="doi">10.1111/j.0006-341x.1999.00997.x</pub-id><pub-id pub-id-type="pmid">11315092</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fairley</surname><given-names>S</given-names></name><name><surname>Lowy-Gallego</surname><given-names>E</given-names></name><name><surname>Perry</surname><given-names>E</given-names></name><name><surname>Flicek</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The International genome sample resource (IGSR) collection of open human Genomic variation resources</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>D941</fpage><lpage>D947</lpage><pub-id pub-id-type="doi">10.1093/nar/gkz836</pub-id><pub-id pub-id-type="pmid">31584097</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fedorova</surname><given-names>L</given-names></name><name><surname>Qiu</surname><given-names>S</given-names></name><name><surname>Dutta</surname><given-names>R</given-names></name><name><surname>Fedorov</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Atlas of cryptic genetic relatedness among 1000 human Genomes</article-title><source>Genome Biology and Evolution</source><volume>8</volume><fpage>777</fpage><lpage>790</lpage><pub-id pub-id-type="doi">10.1093/gbe/evw034</pub-id><pub-id pub-id-type="pmid">26907499</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galinsky</surname><given-names>KJ</given-names></name><name><surname>Bhatia</surname><given-names>G</given-names></name><name><surname>Loh</surname><given-names>PR</given-names></name><name><surname>Georgiev</surname><given-names>S</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Patterson</surname><given-names>NJ</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fast principal-component analysis reveals CONVERGENT evolution of Adh1B in Europe and East Asia</article-title><source>American Journal of Human Genetics</source><volume>98</volume><fpage>456</fpage><lpage>472</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2015.12.022</pub-id><pub-id pub-id-type="pmid">26924531</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gazal</surname><given-names>S</given-names></name><name><surname>Sahbatou</surname><given-names>M</given-names></name><name><surname>Babron</surname><given-names>MC</given-names></name><name><surname>Génin</surname><given-names>E</given-names></name><name><surname>Leutenegger</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>High level of inbreeding in final phase of 1000 Genomes project</article-title><source>Scientific Reports</source><volume>5</volume><elocation-id>17453</elocation-id><pub-id pub-id-type="doi">10.1038/srep17453</pub-id><pub-id pub-id-type="pmid">26625947</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gopalan</surname><given-names>P</given-names></name><name><surname>Hao</surname><given-names>W</given-names></name><name><surname>Blei</surname><given-names>DM</given-names></name><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Scaling probabilistic models of genetic variation to millions of humans</article-title><source>Nature Genetics</source><volume>48</volume><fpage>1587</fpage><lpage>1590</lpage><pub-id pub-id-type="doi">10.1038/ng.3710</pub-id><pub-id pub-id-type="pmid">27819665</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grau</surname><given-names>J</given-names></name><name><surname>Grosse</surname><given-names>I</given-names></name><name><surname>Keilwagen</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>PRROC: Computing and Visualizing precision-recall and receiver operating characteristic curves in R</article-title><source>Bioinformatics</source><volume>31</volume><fpage>2595</fpage><lpage>2597</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv153</pub-id><pub-id pub-id-type="pmid">25810428</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grueneberg</surname><given-names>A</given-names></name><name><surname>de Los Campos</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Bgdata - A suite of R packages for Genomic analysis with big data</article-title><source>G3: Genes, Genomes, Genetics</source><volume>9</volume><fpage>1377</fpage><lpage>1383</lpage><pub-id pub-id-type="doi">10.1534/g3.119.400018</pub-id><pub-id pub-id-type="pmid">30894453</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hayashi</surname><given-names>K</given-names></name><name><surname>Yuan</surname><given-names>KH</given-names></name><name><surname>Liang</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><chapter-title>On the bias in Eigenvalues of sample covariance matrix</chapter-title><person-group person-group-type="editor"><name><surname>Wiberg</surname><given-names>M</given-names></name><name><surname>Culpepper</surname><given-names>S</given-names></name><name><surname>Janssen</surname><given-names>R</given-names></name><name><surname>González</surname><given-names>J</given-names></name><name><surname>Molenaar</surname><given-names>D</given-names></name></person-group><source>Quantitative Psychology Springer Proceedings in Mathematics &amp; Statistics</source><publisher-loc>Cham</publisher-loc><publisher-name>Springer International Publishing</publisher-name><fpage>221</fpage><lpage>233</lpage><pub-id pub-id-type="doi">10.1007/978-3-319-77249-3_19</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heckerman</surname><given-names>D</given-names></name><name><surname>Gurdasani</surname><given-names>D</given-names></name><name><surname>Kadie</surname><given-names>C</given-names></name><name><surname>Pomilla</surname><given-names>C</given-names></name><name><surname>Carstensen</surname><given-names>T</given-names></name><name><surname>Martin</surname><given-names>H</given-names></name><name><surname>Ekoru</surname><given-names>K</given-names></name><name><surname>Nsubuga</surname><given-names>RN</given-names></name><name><surname>Ssenyomo</surname><given-names>G</given-names></name><name><surname>Kamali</surname><given-names>A</given-names></name><name><surname>Kaleebu</surname><given-names>P</given-names></name><name><surname>Widmer</surname><given-names>C</given-names></name><name><surname>Sandhu</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Linear mixed model for Heritability estimation that explicitly addresses environmental variation</article-title><source>PNAS</source><volume>113</volume><fpage>7377</fpage><lpage>7382</lpage><pub-id pub-id-type="doi">10.1073/pnas.1510497113</pub-id><pub-id pub-id-type="pmid">27382152</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henn</surname><given-names>BM</given-names></name><name><surname>Hon</surname><given-names>L</given-names></name><name><surname>Macpherson</surname><given-names>JM</given-names></name><name><surname>Eriksson</surname><given-names>N</given-names></name><name><surname>Saxonov</surname><given-names>S</given-names></name><name><surname>Pe’er</surname><given-names>I</given-names></name><name><surname>Mountain</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Cryptic distant relatives are common in both isolated and cosmopolitan genetic samples</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e34267</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0034267</pub-id><pub-id pub-id-type="pmid">22509285</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hindorff</surname><given-names>LA</given-names></name><name><surname>Bonham</surname><given-names>VL</given-names></name><name><surname>Brody</surname><given-names>LC</given-names></name><name><surname>Ginoza</surname><given-names>MEC</given-names></name><name><surname>Hutter</surname><given-names>CM</given-names></name><name><surname>Manolio</surname><given-names>TA</given-names></name><name><surname>Green</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Prioritizing diversity in human Genomics research</article-title><source>Nature Reviews Genetics</source><volume>19</volume><fpage>175</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1038/nrg.2017.89</pub-id><pub-id pub-id-type="pmid">29151588</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hodonsky</surname><given-names>CJ</given-names></name><name><surname>Jain</surname><given-names>D</given-names></name><name><surname>Schick</surname><given-names>UM</given-names></name><name><surname>Morrison</surname><given-names>JV</given-names></name><name><surname>Brown</surname><given-names>L</given-names></name><name><surname>McHugh</surname><given-names>CP</given-names></name><name><surname>Schurmann</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>DD</given-names></name><name><surname>Liu</surname><given-names>YM</given-names></name><name><surname>Auer</surname><given-names>PL</given-names></name><name><surname>Laurie</surname><given-names>CA</given-names></name><name><surname>Taylor</surname><given-names>KD</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Papanicolaou</surname><given-names>G</given-names></name><name><surname>Rotter</surname><given-names>JI</given-names></name><name><surname>Kurita</surname><given-names>R</given-names></name><name><surname>Nakamura</surname><given-names>Y</given-names></name><name><surname>Browning</surname><given-names>SR</given-names></name><name><surname>Loos</surname><given-names>RJF</given-names></name><name><surname>North</surname><given-names>KE</given-names></name><name><surname>Laurie</surname><given-names>CC</given-names></name><name><surname>Thornton</surname><given-names>TA</given-names></name><name><surname>Pankratz</surname><given-names>N</given-names></name><name><surname>Bauer</surname><given-names>DE</given-names></name><name><surname>Sofer</surname><given-names>T</given-names></name><name><surname>Reiner</surname><given-names>AP</given-names></name><name><surname>Williams</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Genome-wide Association study of red blood cell traits in Hispanics/Latinos: The Hispanic community health study/study of Latinos</article-title><source>PLOS Genetics</source><volume>13</volume><elocation-id>e1006760</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1006760</pub-id><pub-id pub-id-type="pmid">28453575</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoffman</surname><given-names>GE</given-names></name><name><surname>Dubé</surname><given-names>M-P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Correcting for population structure and kinship using the linear mixed model: theory and extensions</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e75707</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0075707</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoffmann</surname><given-names>TJ</given-names></name><name><surname>Choquet</surname><given-names>H</given-names></name><name><surname>Yin</surname><given-names>J</given-names></name><name><surname>Banda</surname><given-names>Y</given-names></name><name><surname>Kvale</surname><given-names>MN</given-names></name><name><surname>Glymour</surname><given-names>M</given-names></name><name><surname>Schaefer</surname><given-names>C</given-names></name><name><surname>Risch</surname><given-names>N</given-names></name><name><surname>Jorgenson</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A large Multiethnic genome-wide Association study of adult body mass index identifies novel Loci</article-title><source>Genetics</source><volume>210</volume><fpage>499</fpage><lpage>515</lpage><pub-id pub-id-type="doi">10.1534/genetics.118.301479</pub-id><pub-id pub-id-type="pmid">30108127</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hou</surname><given-names>K</given-names></name><name><surname>Ding</surname><given-names>Y</given-names></name><name><surname>Xu</surname><given-names>Z</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Bhattacharya</surname><given-names>A</given-names></name><name><surname>Mester</surname><given-names>R</given-names></name><name><surname>Belbin</surname><given-names>GM</given-names></name><name><surname>Buyske</surname><given-names>S</given-names></name><name><surname>Conti</surname><given-names>DV</given-names></name><name><surname>Darst</surname><given-names>BF</given-names></name><name><surname>Fornage</surname><given-names>M</given-names></name><name><surname>Gignoux</surname><given-names>C</given-names></name><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Haiman</surname><given-names>C</given-names></name><name><surname>Kenny</surname><given-names>EE</given-names></name><name><surname>Kim</surname><given-names>M</given-names></name><name><surname>Kooperberg</surname><given-names>C</given-names></name><name><surname>Lange</surname><given-names>L</given-names></name><name><surname>Manichaikul</surname><given-names>A</given-names></name><name><surname>North</surname><given-names>KE</given-names></name><name><surname>Peters</surname><given-names>U</given-names></name><name><surname>Rasmussen-Torvik</surname><given-names>LJ</given-names></name><name><surname>Rich</surname><given-names>SS</given-names></name><name><surname>Rotter</surname><given-names>JI</given-names></name><name><surname>Wheeler</surname><given-names>HE</given-names></name><name><surname>Wojcik</surname><given-names>GL</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Sankararaman</surname><given-names>S</given-names></name><name><surname>Pasaniuc</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2023">2023a</year><article-title>Causal effects on complex traits are similar for common variants across segments of different Continental Ancestries within admixed individuals</article-title><source>Nature Genetics</source><volume>55</volume><fpage>549</fpage><lpage>558</lpage><pub-id pub-id-type="doi">10.1038/s41588-023-01338-6</pub-id><pub-id pub-id-type="pmid">36941441</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hou</surname><given-names>Z</given-names></name><name><surname>Ochoa</surname><given-names>A</given-names></name><name><surname>Browning</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2023">2023b</year><article-title>Genetic Association models are robust to common population kinship estimation biases</article-title><source>GENETICS</source><volume>224</volume><elocation-id>iyad030</elocation-id><pub-id pub-id-type="doi">10.1093/genetics/iyad030</pub-id><pub-id pub-id-type="pmid">36843304</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Graff</surname><given-names>M</given-names></name><name><surname>Haessler</surname><given-names>J</given-names></name><name><surname>Buyske</surname><given-names>S</given-names></name><name><surname>Bien</surname><given-names>SA</given-names></name><name><surname>Tao</surname><given-names>R</given-names></name><name><surname>Highland</surname><given-names>HM</given-names></name><name><surname>Nishimura</surname><given-names>KK</given-names></name><name><surname>Zubair</surname><given-names>N</given-names></name><name><surname>Lu</surname><given-names>Y</given-names></name><name><surname>Verbanck</surname><given-names>M</given-names></name><name><surname>Hilliard</surname><given-names>AT</given-names></name><name><surname>Klarin</surname><given-names>D</given-names></name><name><surname>Damrauer</surname><given-names>SM</given-names></name><name><surname>Ho</surname><given-names>Y-L</given-names></name><name><surname>Wilson</surname><given-names>PWF</given-names></name><name><surname>Chang</surname><given-names>K-M</given-names></name><name><surname>Tsao</surname><given-names>PS</given-names></name><name><surname>Cho</surname><given-names>K</given-names></name><name><surname>O’Donnell</surname><given-names>CJ</given-names></name><name><surname>Assimes</surname><given-names>TL</given-names></name><name><surname>Petty</surname><given-names>LE</given-names></name><name><surname>Below</surname><given-names>JE</given-names></name><name><surname>Dikilitas</surname><given-names>O</given-names></name><name><surname>Schaid</surname><given-names>DJ</given-names></name><name><surname>Kosel</surname><given-names>ML</given-names></name><name><surname>Kullo</surname><given-names>IJ</given-names></name><name><surname>Rasmussen-Torvik</surname><given-names>LJ</given-names></name><name><surname>Jarvik</surname><given-names>GP</given-names></name><name><surname>Feng</surname><given-names>Q</given-names></name><name><surname>Wei</surname><given-names>W-Q</given-names></name><name><surname>Larson</surname><given-names>EB</given-names></name><name><surname>Mentch</surname><given-names>FD</given-names></name><name><surname>Almoguera</surname><given-names>B</given-names></name><name><surname>Sleiman</surname><given-names>PM</given-names></name><name><surname>Raffield</surname><given-names>LM</given-names></name><name><surname>Correa</surname><given-names>A</given-names></name><name><surname>Martin</surname><given-names>LW</given-names></name><name><surname>Daviglus</surname><given-names>M</given-names></name><name><surname>Matise</surname><given-names>TC</given-names></name><name><surname>Ambite</surname><given-names>JL</given-names></name><name><surname>Carlson</surname><given-names>CS</given-names></name><name><surname>Do</surname><given-names>R</given-names></name><name><surname>Loos</surname><given-names>RJF</given-names></name><name><surname>Wilkens</surname><given-names>LR</given-names></name><name><surname>Le Marchand</surname><given-names>L</given-names></name><name><surname>Haiman</surname><given-names>C</given-names></name><name><surname>Stram</surname><given-names>DO</given-names></name><name><surname>Hindorff</surname><given-names>LA</given-names></name><name><surname>North</surname><given-names>KE</given-names></name><name><surname>Kooperberg</surname><given-names>C</given-names></name><name><surname>Cheng</surname><given-names>I</given-names></name><name><surname>Peters</surname><given-names>U</given-names></name><collab>VA Million Veteran Program</collab></person-group><year iso-8601-date="2020">2020</year><article-title>Minority-centric meta-analyses of blood lipid levels identify novel Loci in the population architecture using Genomics and epidemiology (page) study</article-title><source>PLOS Genetics</source><volume>16</volume><elocation-id>e1008684</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1008684</pub-id><pub-id pub-id-type="pmid">32226016</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jacquard</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1970">1970</year><source>Structures Génétiques Des Populations</source><publisher-loc>Paris</publisher-loc><publisher-name>Masson et Cie</publisher-name></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Janss</surname><given-names>L</given-names></name><name><surname>de Los Campos</surname><given-names>G</given-names></name><name><surname>Sheehan</surname><given-names>N</given-names></name><name><surname>Sorensen</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Inferences from Genomic models in stratified populations</article-title><source>Genetics</source><volume>192</volume><fpage>693</fpage><lpage>704</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.141143</pub-id><pub-id pub-id-type="pmid">22813891</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jolliffe</surname><given-names>IT</given-names></name></person-group><year iso-8601-date="2002">2002</year><source>Principal Component Analysis</source><publisher-loc>New York</publisher-loc><publisher-name>Springer-Verlag</publisher-name></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamariza</surname><given-names>M</given-names></name><name><surname>Crawford</surname><given-names>L</given-names></name><name><surname>Jones</surname><given-names>D</given-names></name><name><surname>Finucane</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Misuse of the term ‘Trans-ethnic’ in Genomics research</article-title><source>Nature Genetics</source><volume>53</volume><fpage>1520</fpage><lpage>1521</lpage><pub-id pub-id-type="doi">10.1038/s41588-021-00952-6</pub-id><pub-id pub-id-type="pmid">34741159</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>H.M</given-names></name><name><surname>Zaitlen</surname><given-names>NA</given-names></name><name><surname>Wade</surname><given-names>CM</given-names></name><name><surname>Kirby</surname><given-names>A</given-names></name><name><surname>Heckerman</surname><given-names>D</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Eskin</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Efficient control of population structure in model organism association mapping</article-title><source>Genetics</source><volume>178</volume><fpage>1709</fpage><lpage>1723</lpage><pub-id pub-id-type="doi">10.1534/genetics.107.080101</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>HM</given-names></name><name><surname>Sul</surname><given-names>JH</given-names></name><name><surname>Service</surname><given-names>SK</given-names></name><name><surname>Zaitlen</surname><given-names>NA</given-names></name><name><surname>Kong</surname><given-names>S-Y</given-names></name><name><surname>Freimer</surname><given-names>NB</given-names></name><name><surname>Sabatti</surname><given-names>C</given-names></name><name><surname>Eskin</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Variance component model to account for sample structure in genome-wide Association studies</article-title><source>Nature Genetics</source><volume>42</volume><fpage>348</fpage><lpage>354</lpage><pub-id pub-id-type="doi">10.1038/ng.548</pub-id><pub-id pub-id-type="pmid">20208533</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>CL</given-names></name><name><surname>Hanson</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="1974">1974</year><source>Solving Least Squares Problems</source><publisher-loc>Englewood Cliffs</publisher-loc><publisher-name>Prentice Hall</publisher-name></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lazaridis</surname><given-names>I</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Mittnik</surname><given-names>A</given-names></name><name><surname>Renaud</surname><given-names>G</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Kirsanow</surname><given-names>K</given-names></name><name><surname>Sudmant</surname><given-names>PH</given-names></name><name><surname>Schraiber</surname><given-names>JG</given-names></name><name><surname>Castellano</surname><given-names>S</given-names></name><name><surname>Lipson</surname><given-names>M</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name><name><surname>Economou</surname><given-names>C</given-names></name><name><surname>Bollongino</surname><given-names>R</given-names></name><name><surname>Fu</surname><given-names>Q</given-names></name><name><surname>Bos</surname><given-names>KI</given-names></name><name><surname>Nordenfelt</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>de Filippo</surname><given-names>C</given-names></name><name><surname>Prüfer</surname><given-names>K</given-names></name><name><surname>Sawyer</surname><given-names>S</given-names></name><name><surname>Posth</surname><given-names>C</given-names></name><name><surname>Haak</surname><given-names>W</given-names></name><name><surname>Hallgren</surname><given-names>F</given-names></name><name><surname>Fornander</surname><given-names>E</given-names></name><name><surname>Rohland</surname><given-names>N</given-names></name><name><surname>Delsate</surname><given-names>D</given-names></name><name><surname>Francken</surname><given-names>M</given-names></name><name><surname>Guinet</surname><given-names>J-M</given-names></name><name><surname>Wahl</surname><given-names>J</given-names></name><name><surname>Ayodo</surname><given-names>G</given-names></name><name><surname>Babiker</surname><given-names>HA</given-names></name><name><surname>Bailliet</surname><given-names>G</given-names></name><name><surname>Balanovska</surname><given-names>E</given-names></name><name><surname>Balanovsky</surname><given-names>O</given-names></name><name><surname>Barrantes</surname><given-names>R</given-names></name><name><surname>Bedoya</surname><given-names>G</given-names></name><name><surname>Ben-Ami</surname><given-names>H</given-names></name><name><surname>Bene</surname><given-names>J</given-names></name><name><surname>Berrada</surname><given-names>F</given-names></name><name><surname>Bravi</surname><given-names>CM</given-names></name><name><surname>Brisighelli</surname><given-names>F</given-names></name><name><surname>Busby</surname><given-names>GBJ</given-names></name><name><surname>Cali</surname><given-names>F</given-names></name><name><surname>Churnosov</surname><given-names>M</given-names></name><name><surname>Cole</surname><given-names>DEC</given-names></name><name><surname>Corach</surname><given-names>D</given-names></name><name><surname>Damba</surname><given-names>L</given-names></name><name><surname>van Driem</surname><given-names>G</given-names></name><name><surname>Dryomov</surname><given-names>S</given-names></name><name><surname>Dugoujon</surname><given-names>J-M</given-names></name><name><surname>Fedorova</surname><given-names>SA</given-names></name><name><surname>Gallego Romero</surname><given-names>I</given-names></name><name><surname>Gubina</surname><given-names>M</given-names></name><name><surname>Hammer</surname><given-names>M</given-names></name><name><surname>Henn</surname><given-names>BM</given-names></name><name><surname>Hervig</surname><given-names>T</given-names></name><name><surname>Hodoglugil</surname><given-names>U</given-names></name><name><surname>Jha</surname><given-names>AR</given-names></name><name><surname>Karachanak-Yankova</surname><given-names>S</given-names></name><name><surname>Khusainova</surname><given-names>R</given-names></name><name><surname>Khusnutdinova</surname><given-names>E</given-names></name><name><surname>Kittles</surname><given-names>R</given-names></name><name><surname>Kivisild</surname><given-names>T</given-names></name><name><surname>Klitz</surname><given-names>W</given-names></name><name><surname>Kučinskas</surname><given-names>V</given-names></name><name><surname>Kushniarevich</surname><given-names>A</given-names></name><name><surname>Laredj</surname><given-names>L</given-names></name><name><surname>Litvinov</surname><given-names>S</given-names></name><name><surname>Loukidis</surname><given-names>T</given-names></name><name><surname>Mahley</surname><given-names>RW</given-names></name><name><surname>Melegh</surname><given-names>B</given-names></name><name><surname>Metspalu</surname><given-names>E</given-names></name><name><surname>Molina</surname><given-names>J</given-names></name><name><surname>Mountain</surname><given-names>J</given-names></name><name><surname>Näkkäläjärvi</surname><given-names>K</given-names></name><name><surname>Nesheva</surname><given-names>D</given-names></name><name><surname>Nyambo</surname><given-names>T</given-names></name><name><surname>Osipova</surname><given-names>L</given-names></name><name><surname>Parik</surname><given-names>J</given-names></name><name><surname>Platonov</surname><given-names>F</given-names></name><name><surname>Posukh</surname><given-names>O</given-names></name><name><surname>Romano</surname><given-names>V</given-names></name><name><surname>Rothhammer</surname><given-names>F</given-names></name><name><surname>Rudan</surname><given-names>I</given-names></name><name><surname>Ruizbakiev</surname><given-names>R</given-names></name><name><surname>Sahakyan</surname><given-names>H</given-names></name><name><surname>Sajantila</surname><given-names>A</given-names></name><name><surname>Salas</surname><given-names>A</given-names></name><name><surname>Starikovskaya</surname><given-names>EB</given-names></name><name><surname>Tarekegn</surname><given-names>A</given-names></name><name><surname>Toncheva</surname><given-names>D</given-names></name><name><surname>Turdikulova</surname><given-names>S</given-names></name><name><surname>Uktveryte</surname><given-names>I</given-names></name><name><surname>Utevska</surname><given-names>O</given-names></name><name><surname>Vasquez</surname><given-names>R</given-names></name><name><surname>Villena</surname><given-names>M</given-names></name><name><surname>Voevoda</surname><given-names>M</given-names></name><name><surname>Winkler</surname><given-names>CA</given-names></name><name><surname>Yepiskoposyan</surname><given-names>L</given-names></name><name><surname>Zalloua</surname><given-names>P</given-names></name><name><surname>Zemunik</surname><given-names>T</given-names></name><name><surname>Cooper</surname><given-names>A</given-names></name><name><surname>Capelli</surname><given-names>C</given-names></name><name><surname>Thomas</surname><given-names>MG</given-names></name><name><surname>Ruiz-Linares</surname><given-names>A</given-names></name><name><surname>Tishkoff</surname><given-names>SA</given-names></name><name><surname>Singh</surname><given-names>L</given-names></name><name><surname>Thangaraj</surname><given-names>K</given-names></name><name><surname>Villems</surname><given-names>R</given-names></name><name><surname>Comas</surname><given-names>D</given-names></name><name><surname>Sukernik</surname><given-names>R</given-names></name><name><surname>Metspalu</surname><given-names>M</given-names></name><name><surname>Meyer</surname><given-names>M</given-names></name><name><surname>Eichler</surname><given-names>EE</given-names></name><name><surname>Burger</surname><given-names>J</given-names></name><name><surname>Slatkin</surname><given-names>M</given-names></name><name><surname>Pääbo</surname><given-names>S</given-names></name><name><surname>Kelso</surname><given-names>J</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Ancient human genomes suggest three ancestral populations for present-day Europeans</article-title><source>Nature</source><volume>513</volume><fpage>409</fpage><lpage>413</lpage><pub-id pub-id-type="doi">10.1038/nature13673</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lazaridis</surname><given-names>I</given-names></name><name><surname>Nadel</surname><given-names>D</given-names></name><name><surname>Rollefson</surname><given-names>G</given-names></name><name><surname>Merrett</surname><given-names>DC</given-names></name><name><surname>Rohland</surname><given-names>N</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Fernandes</surname><given-names>D</given-names></name><name><surname>Novak</surname><given-names>M</given-names></name><name><surname>Gamarra</surname><given-names>B</given-names></name><name><surname>Sirak</surname><given-names>K</given-names></name><name><surname>Connell</surname><given-names>S</given-names></name><name><surname>Stewardson</surname><given-names>K</given-names></name><name><surname>Harney</surname><given-names>E</given-names></name><name><surname>Fu</surname><given-names>Q</given-names></name><name><surname>Gonzalez-Fortes</surname><given-names>G</given-names></name><name><surname>Jones</surname><given-names>ER</given-names></name><name><surname>Roodenberg</surname><given-names>SA</given-names></name><name><surname>Lengyel</surname><given-names>G</given-names></name><name><surname>Bocquentin</surname><given-names>F</given-names></name><name><surname>Gasparian</surname><given-names>B</given-names></name><name><surname>Monge</surname><given-names>JM</given-names></name><name><surname>Gregg</surname><given-names>M</given-names></name><name><surname>Eshed</surname><given-names>V</given-names></name><name><surname>Mizrahi</surname><given-names>A-S</given-names></name><name><surname>Meiklejohn</surname><given-names>C</given-names></name><name><surname>Gerritsen</surname><given-names>F</given-names></name><name><surname>Bejenaru</surname><given-names>L</given-names></name><name><surname>Blüher</surname><given-names>M</given-names></name><name><surname>Campbell</surname><given-names>A</given-names></name><name><surname>Cavalleri</surname><given-names>G</given-names></name><name><surname>Comas</surname><given-names>D</given-names></name><name><surname>Froguel</surname><given-names>P</given-names></name><name><surname>Gilbert</surname><given-names>E</given-names></name><name><surname>Kerr</surname><given-names>SM</given-names></name><name><surname>Kovacs</surname><given-names>P</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name><name><surname>McGettigan</surname><given-names>D</given-names></name><name><surname>Merrigan</surname><given-names>M</given-names></name><name><surname>Merriwether</surname><given-names>DA</given-names></name><name><surname>O’Reilly</surname><given-names>S</given-names></name><name><surname>Richards</surname><given-names>MB</given-names></name><name><surname>Semino</surname><given-names>O</given-names></name><name><surname>Shamoon-Pour</surname><given-names>M</given-names></name><name><surname>Stefanescu</surname><given-names>G</given-names></name><name><surname>Stumvoll</surname><given-names>M</given-names></name><name><surname>Tönjes</surname><given-names>A</given-names></name><name><surname>Torroni</surname><given-names>A</given-names></name><name><surname>Wilson</surname><given-names>JF</given-names></name><name><surname>Yengo</surname><given-names>L</given-names></name><name><surname>Hovhannisyan</surname><given-names>NA</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Pinhasi</surname><given-names>R</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Genomic insights into the origin of farming in the ancient near East</article-title><source>Nature</source><volume>536</volume><fpage>419</fpage><lpage>424</lpage><pub-id pub-id-type="doi">10.1038/nature19310</pub-id><pub-id pub-id-type="pmid">27459054</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>S</given-names></name><name><surname>Epstein</surname><given-names>MP</given-names></name><name><surname>Duncan</surname><given-names>R</given-names></name><name><surname>Lin</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Sparse principal component analysis for identifying ancestry-informative markers in genome-wide Association studies</article-title><source>Genetic Epidemiology</source><volume>36</volume><fpage>293</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1002/gepi.21621</pub-id><pub-id pub-id-type="pmid">22508067</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>M</given-names></name><name><surname>Park</surname><given-names>DS</given-names></name><name><surname>Zaitlen</surname><given-names>NA</given-names></name><name><surname>Henn</surname><given-names>BM</given-names></name><name><surname>Gignoux</surname><given-names>CR</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Admixed populations improve power for variant discovery and Portability in genome-wide Association studies</article-title><source>Frontiers in Genetics</source><volume>12</volume><elocation-id>673167</elocation-id><pub-id pub-id-type="doi">10.3389/fgene.2021.673167</pub-id><pub-id pub-id-type="pmid">34108994</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lippert</surname><given-names>C</given-names></name><name><surname>Listgarten</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Kadie</surname><given-names>CM</given-names></name><name><surname>Davidson</surname><given-names>RI</given-names></name><name><surname>Heckerman</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Fast linear mixed models for genome-wide Association studies</article-title><source>Nature Methods</source><volume>8</volume><fpage>833</fpage><lpage>835</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1681</pub-id><pub-id pub-id-type="pmid">21892150</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Listgarten</surname><given-names>J</given-names></name><name><surname>Lippert</surname><given-names>C</given-names></name><name><surname>Kadie</surname><given-names>CM</given-names></name><name><surname>Davidson</surname><given-names>RI</given-names></name><name><surname>Eskin</surname><given-names>E</given-names></name><name><surname>Heckerman</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Improved linear mixed models for genome-wide Association studies</article-title><source>Nature Methods</source><volume>9</volume><fpage>525</fpage><lpage>526</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2037</pub-id><pub-id pub-id-type="pmid">22669648</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>N</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name><name><surname>Patki</surname><given-names>A</given-names></name><name><surname>Limdi</surname><given-names>NA</given-names></name><name><surname>Allison</surname><given-names>DB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Controlling population structure in human genetic association studies with samples of unrelated individuals</article-title><source>Statistics and Its Interface</source><volume>4</volume><fpage>317</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.4310/sii.2011.v4.n3.a6</pub-id><pub-id pub-id-type="pmid">22308192</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Huang</surname><given-names>M</given-names></name><name><surname>Fan</surname><given-names>B</given-names></name><name><surname>Buckler</surname><given-names>ES</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Listgarten</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Iterative usage of fixed and random effect models for powerful and efficient genome-wide Association studies</article-title><source>PLOS Genetics</source><volume>12</volume><elocation-id>e1005767</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1005767</pub-id><pub-id pub-id-type="pmid">26828793</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loh</surname><given-names>PR</given-names></name><name><surname>Tucker</surname><given-names>G</given-names></name><name><surname>Bulik-Sullivan</surname><given-names>BK</given-names></name><name><surname>Vilhjálmsson</surname><given-names>BJ</given-names></name><name><surname>Finucane</surname><given-names>HK</given-names></name><name><surname>Salem</surname><given-names>RM</given-names></name><name><surname>Chasman</surname><given-names>DI</given-names></name><name><surname>Ridker</surname><given-names>PM</given-names></name><name><surname>Neale</surname><given-names>BM</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Efficient Bayesian mixed-model analysis increases association power in large cohorts</article-title><source>Nature Genetics</source><volume>47</volume><fpage>284</fpage><lpage>290</lpage><pub-id pub-id-type="doi">10.1038/ng.3190</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loh</surname><given-names>PR</given-names></name><name><surname>Kichaev</surname><given-names>G</given-names></name><name><surname>Gazal</surname><given-names>S</given-names></name><name><surname>Schoech</surname><given-names>AP</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Mixed-model association for biobank-scale datasets</article-title><source>Nature Genetics</source><volume>50</volume><fpage>906</fpage><lpage>908</lpage><pub-id pub-id-type="doi">10.1038/s41588-018-0144-6</pub-id><pub-id pub-id-type="pmid">29892013</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahajan</surname><given-names>A</given-names></name><name><surname>Spracklen</surname><given-names>CN</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Ng</surname><given-names>MCY</given-names></name><name><surname>Petty</surname><given-names>LE</given-names></name><name><surname>Kitajima</surname><given-names>H</given-names></name><name><surname>Yu</surname><given-names>GZ</given-names></name><name><surname>Rüeger</surname><given-names>S</given-names></name><name><surname>Speidel</surname><given-names>L</given-names></name><name><surname>Kim</surname><given-names>YJ</given-names></name><name><surname>Horikoshi</surname><given-names>M</given-names></name><name><surname>Mercader</surname><given-names>JM</given-names></name><name><surname>Taliun</surname><given-names>D</given-names></name><name><surname>Moon</surname><given-names>S</given-names></name><name><surname>Kwak</surname><given-names>S-H</given-names></name><name><surname>Robertson</surname><given-names>NR</given-names></name><name><surname>Rayner</surname><given-names>NW</given-names></name><name><surname>Loh</surname><given-names>M</given-names></name><name><surname>Kim</surname><given-names>B-J</given-names></name><name><surname>Chiou</surname><given-names>J</given-names></name><name><surname>Miguel-Escalada</surname><given-names>I</given-names></name><name><surname>Della Briotta Parolo</surname><given-names>P</given-names></name><name><surname>Lin</surname><given-names>K</given-names></name><name><surname>Bragg</surname><given-names>F</given-names></name><name><surname>Preuss</surname><given-names>MH</given-names></name><name><surname>Takeuchi</surname><given-names>F</given-names></name><name><surname>Nano</surname><given-names>J</given-names></name><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Lamri</surname><given-names>A</given-names></name><name><surname>Nakatochi</surname><given-names>M</given-names></name><name><surname>Scott</surname><given-names>RA</given-names></name><name><surname>Lee</surname><given-names>J-J</given-names></name><name><surname>Huerta-Chagoya</surname><given-names>A</given-names></name><name><surname>Graff</surname><given-names>M</given-names></name><name><surname>Chai</surname><given-names>J-F</given-names></name><name><surname>Parra</surname><given-names>EJ</given-names></name><name><surname>Yao</surname><given-names>J</given-names></name><name><surname>Bielak</surname><given-names>LF</given-names></name><name><surname>Tabara</surname><given-names>Y</given-names></name><name><surname>Hai</surname><given-names>Y</given-names></name><name><surname>Steinthorsdottir</surname><given-names>V</given-names></name><name><surname>Cook</surname><given-names>JP</given-names></name><name><surname>Kals</surname><given-names>M</given-names></name><name><surname>Grarup</surname><given-names>N</given-names></name><name><surname>Schmidt</surname><given-names>EM</given-names></name><name><surname>Pan</surname><given-names>I</given-names></name><name><surname>Sofer</surname><given-names>T</given-names></name><name><surname>Wuttke</surname><given-names>M</given-names></name><name><surname>Sarnowski</surname><given-names>C</given-names></name><name><surname>Gieger</surname><given-names>C</given-names></name><name><surname>Nousome</surname><given-names>D</given-names></name><name><surname>Trompet</surname><given-names>S</given-names></name><name><surname>Long</surname><given-names>J</given-names></name><name><surname>Sun</surname><given-names>M</given-names></name><name><surname>Tong</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>W-M</given-names></name><name><surname>Ahmad</surname><given-names>M</given-names></name><name><surname>Noordam</surname><given-names>R</given-names></name><name><surname>Lim</surname><given-names>VJY</given-names></name><name><surname>Tam</surname><given-names>CHT</given-names></name><name><surname>Joo</surname><given-names>YY</given-names></name><name><surname>Chen</surname><given-names>C-H</given-names></name><name><surname>Raffield</surname><given-names>LM</given-names></name><name><surname>Lecoeur</surname><given-names>C</given-names></name><name><surname>Prins</surname><given-names>BP</given-names></name><name><surname>Nicolas</surname><given-names>A</given-names></name><name><surname>Yanek</surname><given-names>LR</given-names></name><name><surname>Chen</surname><given-names>G</given-names></name><name><surname>Jensen</surname><given-names>RA</given-names></name><name><surname>Tajuddin</surname><given-names>S</given-names></name><name><surname>Kabagambe</surname><given-names>EK</given-names></name><name><surname>An</surname><given-names>P</given-names></name><name><surname>Xiang</surname><given-names>AH</given-names></name><name><surname>Choi</surname><given-names>HS</given-names></name><name><surname>Cade</surname><given-names>BE</given-names></name><name><surname>Tan</surname><given-names>J</given-names></name><name><surname>Flanagan</surname><given-names>J</given-names></name><name><surname>Abaitua</surname><given-names>F</given-names></name><name><surname>Adair</surname><given-names>LS</given-names></name><name><surname>Adeyemo</surname><given-names>A</given-names></name><name><surname>Aguilar-Salinas</surname><given-names>CA</given-names></name><name><surname>Akiyama</surname><given-names>M</given-names></name><name><surname>Anand</surname><given-names>SS</given-names></name><name><surname>Bertoni</surname><given-names>A</given-names></name><name><surname>Bian</surname><given-names>Z</given-names></name><name><surname>Bork-Jensen</surname><given-names>J</given-names></name><name><surname>Brandslund</surname><given-names>I</given-names></name><name><surname>Brody</surname><given-names>JA</given-names></name><name><surname>Brummett</surname><given-names>CM</given-names></name><name><surname>Buchanan</surname><given-names>TA</given-names></name><name><surname>Canouil</surname><given-names>M</given-names></name><name><surname>Chan</surname><given-names>JCN</given-names></name><name><surname>Chang</surname><given-names>L-C</given-names></name><name><surname>Chee</surname><given-names>M-L</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>S-H</given-names></name><name><surname>Chen</surname><given-names>Y-T</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Chuang</surname><given-names>L-M</given-names></name><name><surname>Cushman</surname><given-names>M</given-names></name><name><surname>Das</surname><given-names>SK</given-names></name><name><surname>de Silva</surname><given-names>HJ</given-names></name><name><surname>Dedoussis</surname><given-names>G</given-names></name><name><surname>Dimitrov</surname><given-names>L</given-names></name><name><surname>Doumatey</surname><given-names>AP</given-names></name><name><surname>Du</surname><given-names>S</given-names></name><name><surname>Duan</surname><given-names>Q</given-names></name><name><surname>Eckardt</surname><given-names>K-U</given-names></name><name><surname>Emery</surname><given-names>LS</given-names></name><name><surname>Evans</surname><given-names>DS</given-names></name><name><surname>Evans</surname><given-names>MK</given-names></name><name><surname>Fischer</surname><given-names>K</given-names></name><name><surname>Floyd</surname><given-names>JS</given-names></name><name><surname>Ford</surname><given-names>I</given-names></name><name><surname>Fornage</surname><given-names>M</given-names></name><name><surname>Franco</surname><given-names>OH</given-names></name><name><surname>Frayling</surname><given-names>TM</given-names></name><name><surname>Freedman</surname><given-names>BI</given-names></name><name><surname>Fuchsberger</surname><given-names>C</given-names></name><name><surname>Genter</surname><given-names>P</given-names></name><name><surname>Gerstein</surname><given-names>HC</given-names></name><name><surname>Giedraitis</surname><given-names>V</given-names></name><name><surname>González-Villalpando</surname><given-names>C</given-names></name><name><surname>González-Villalpando</surname><given-names>ME</given-names></name><name><surname>Goodarzi</surname><given-names>MO</given-names></name><name><surname>Gordon-Larsen</surname><given-names>P</given-names></name><name><surname>Gorkin</surname><given-names>D</given-names></name><name><surname>Gross</surname><given-names>M</given-names></name><name><surname>Guo</surname><given-names>Y</given-names></name><name><surname>Hackinger</surname><given-names>S</given-names></name><name><surname>Han</surname><given-names>S</given-names></name><name><surname>Hattersley</surname><given-names>AT</given-names></name><name><surname>Herder</surname><given-names>C</given-names></name><name><surname>Howard</surname><given-names>A-G</given-names></name><name><surname>Hsueh</surname><given-names>W</given-names></name><name><surname>Huang</surname><given-names>M</given-names></name><name><surname>Huang</surname><given-names>W</given-names></name><name><surname>Hung</surname><given-names>Y-J</given-names></name><name><surname>Hwang</surname><given-names>MY</given-names></name><name><surname>Hwu</surname><given-names>C-M</given-names></name><name><surname>Ichihara</surname><given-names>S</given-names></name><name><surname>Ikram</surname><given-names>MA</given-names></name><name><surname>Ingelsson</surname><given-names>M</given-names></name><name><surname>Islam</surname><given-names>MT</given-names></name><name><surname>Isono</surname><given-names>M</given-names></name><name><surname>Jang</surname><given-names>H-M</given-names></name><name><surname>Jasmine</surname><given-names>F</given-names></name><name><surname>Jiang</surname><given-names>G</given-names></name><name><surname>Jonas</surname><given-names>JB</given-names></name><name><surname>Jørgensen</surname><given-names>ME</given-names></name><name><surname>Jørgensen</surname><given-names>T</given-names></name><name><surname>Kamatani</surname><given-names>Y</given-names></name><name><surname>Kandeel</surname><given-names>FR</given-names></name><name><surname>Kasturiratne</surname><given-names>A</given-names></name><name><surname>Katsuya</surname><given-names>T</given-names></name><name><surname>Kaur</surname><given-names>V</given-names></name><name><surname>Kawaguchi</surname><given-names>T</given-names></name><name><surname>Keaton</surname><given-names>JM</given-names></name><name><surname>Kho</surname><given-names>AN</given-names></name><name><surname>Khor</surname><given-names>C-C</given-names></name><name><surname>Kibriya</surname><given-names>MG</given-names></name><name><surname>Kim</surname><given-names>D-H</given-names></name><name><surname>Kohara</surname><given-names>K</given-names></name><name><surname>Kriebel</surname><given-names>J</given-names></name><name><surname>Kronenberg</surname><given-names>F</given-names></name><name><surname>Kuusisto</surname><given-names>J</given-names></name><name><surname>Läll</surname><given-names>K</given-names></name><name><surname>Lange</surname><given-names>LA</given-names></name><name><surname>Lee</surname><given-names>M-S</given-names></name><name><surname>Lee</surname><given-names>NR</given-names></name><name><surname>Leong</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Li-Gao</surname><given-names>R</given-names></name><name><surname>Ligthart</surname><given-names>S</given-names></name><name><surname>Lindgren</surname><given-names>CM</given-names></name><name><surname>Linneberg</surname><given-names>A</given-names></name><name><surname>Liu</surname><given-names>C-T</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Locke</surname><given-names>AE</given-names></name><name><surname>Louie</surname><given-names>T</given-names></name><name><surname>Luan</surname><given-names>J</given-names></name><name><surname>Luk</surname><given-names>AO</given-names></name><name><surname>Luo</surname><given-names>X</given-names></name><name><surname>Lv</surname><given-names>J</given-names></name><name><surname>Lyssenko</surname><given-names>V</given-names></name><name><surname>Mamakou</surname><given-names>V</given-names></name><name><surname>Mani</surname><given-names>KR</given-names></name><name><surname>Meitinger</surname><given-names>T</given-names></name><name><surname>Metspalu</surname><given-names>A</given-names></name><name><surname>Morris</surname><given-names>AD</given-names></name><name><surname>Nadkarni</surname><given-names>GN</given-names></name><name><surname>Nadler</surname><given-names>JL</given-names></name><name><surname>Nalls</surname><given-names>MA</given-names></name><name><surname>Nayak</surname><given-names>U</given-names></name><name><surname>Nongmaithem</surname><given-names>SS</given-names></name><name><surname>Ntalla</surname><given-names>I</given-names></name><name><surname>Okada</surname><given-names>Y</given-names></name><name><surname>Orozco</surname><given-names>L</given-names></name><name><surname>Patel</surname><given-names>SR</given-names></name><name><surname>Pereira</surname><given-names>MA</given-names></name><name><surname>Peters</surname><given-names>A</given-names></name><name><surname>Pirie</surname><given-names>FJ</given-names></name><name><surname>Porneala</surname><given-names>B</given-names></name><name><surname>Prasad</surname><given-names>G</given-names></name><name><surname>Preissl</surname><given-names>S</given-names></name><name><surname>Rasmussen-Torvik</surname><given-names>LJ</given-names></name><name><surname>Reiner</surname><given-names>AP</given-names></name><name><surname>Roden</surname><given-names>M</given-names></name><name><surname>Rohde</surname><given-names>R</given-names></name><name><surname>Roll</surname><given-names>K</given-names></name><name><surname>Sabanayagam</surname><given-names>C</given-names></name><name><surname>Sander</surname><given-names>M</given-names></name><name><surname>Sandow</surname><given-names>K</given-names></name><name><surname>Sattar</surname><given-names>N</given-names></name><name><surname>Schönherr</surname><given-names>S</given-names></name><name><surname>Schurmann</surname><given-names>C</given-names></name><name><surname>Shahriar</surname><given-names>M</given-names></name><name><surname>Shi</surname><given-names>J</given-names></name><name><surname>Shin</surname><given-names>DM</given-names></name><name><surname>Shriner</surname><given-names>D</given-names></name><name><surname>Smith</surname><given-names>JA</given-names></name><name><surname>So</surname><given-names>WY</given-names></name><name><surname>Stančáková</surname><given-names>A</given-names></name><name><surname>Stilp</surname><given-names>AM</given-names></name><name><surname>Strauch</surname><given-names>K</given-names></name><name><surname>Suzuki</surname><given-names>K</given-names></name><name><surname>Takahashi</surname><given-names>A</given-names></name><name><surname>Taylor</surname><given-names>KD</given-names></name><name><surname>Thorand</surname><given-names>B</given-names></name><name><surname>Thorleifsson</surname><given-names>G</given-names></name><name><surname>Thorsteinsdottir</surname><given-names>U</given-names></name><name><surname>Tomlinson</surname><given-names>B</given-names></name><name><surname>Torres</surname><given-names>JM</given-names></name><name><surname>Tsai</surname><given-names>F-J</given-names></name><name><surname>Tuomilehto</surname><given-names>J</given-names></name><name><surname>Tusie-Luna</surname><given-names>T</given-names></name><name><surname>Udler</surname><given-names>MS</given-names></name><name><surname>Valladares-Salgado</surname><given-names>A</given-names></name><name><surname>van Dam</surname><given-names>RM</given-names></name><name><surname>van Klinken</surname><given-names>JB</given-names></name><name><surname>Varma</surname><given-names>R</given-names></name><name><surname>Vujkovic</surname><given-names>M</given-names></name><name><surname>Wacher-Rodarte</surname><given-names>N</given-names></name><name><surname>Wheeler</surname><given-names>E</given-names></name><name><surname>Whitsel</surname><given-names>EA</given-names></name><name><surname>Wickremasinghe</surname><given-names>AR</given-names></name><name><surname>van Dijk</surname><given-names>KW</given-names></name><name><surname>Witte</surname><given-names>DR</given-names></name><name><surname>Yajnik</surname><given-names>CS</given-names></name><name><surname>Yamamoto</surname><given-names>K</given-names></name><name><surname>Yamauchi</surname><given-names>T</given-names></name><name><surname>Yengo</surname><given-names>L</given-names></name><name><surname>Yoon</surname><given-names>K</given-names></name><name><surname>Yu</surname><given-names>C</given-names></name><name><surname>Yuan</surname><given-names>J-M</given-names></name><name><surname>Yusuf</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Zheng</surname><given-names>W</given-names></name><collab>FinnGen</collab><collab>eMERGE Consortium</collab><name><surname>Raffel</surname><given-names>LJ</given-names></name><name><surname>Igase</surname><given-names>M</given-names></name><name><surname>Ipp</surname><given-names>E</given-names></name><name><surname>Redline</surname><given-names>S</given-names></name><name><surname>Cho</surname><given-names>YS</given-names></name><name><surname>Lind</surname><given-names>L</given-names></name><name><surname>Province</surname><given-names>MA</given-names></name><name><surname>Hanis</surname><given-names>CL</given-names></name><name><surname>Peyser</surname><given-names>PA</given-names></name><name><surname>Ingelsson</surname><given-names>E</given-names></name><name><surname>Zonderman</surname><given-names>AB</given-names></name><name><surname>Psaty</surname><given-names>BM</given-names></name><name><surname>Wang</surname><given-names>Y-X</given-names></name><name><surname>Rotimi</surname><given-names>CN</given-names></name><name><surname>Becker</surname><given-names>DM</given-names></name><name><surname>Matsuda</surname><given-names>F</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Zeggini</surname><given-names>E</given-names></name><name><surname>Yokota</surname><given-names>M</given-names></name><name><surname>Rich</surname><given-names>SS</given-names></name><name><surname>Kooperberg</surname><given-names>C</given-names></name><name><surname>Pankow</surname><given-names>JS</given-names></name><name><surname>Engert</surname><given-names>JC</given-names></name><name><surname>Chen</surname><given-names>Y-DI</given-names></name><name><surname>Froguel</surname><given-names>P</given-names></name><name><surname>Wilson</surname><given-names>JG</given-names></name><name><surname>Sheu</surname><given-names>WHH</given-names></name><name><surname>Kardia</surname><given-names>SLR</given-names></name><name><surname>Wu</surname><given-names>J-Y</given-names></name><name><surname>Hayes</surname><given-names>MG</given-names></name><name><surname>Ma</surname><given-names>RCW</given-names></name><name><surname>Wong</surname><given-names>T-Y</given-names></name><name><surname>Groop</surname><given-names>L</given-names></name><name><surname>Mook-Kanamori</surname><given-names>DO</given-names></name><name><surname>Chandak</surname><given-names>GR</given-names></name><name><surname>Collins</surname><given-names>FS</given-names></name><name><surname>Bharadwaj</surname><given-names>D</given-names></name><name><surname>Paré</surname><given-names>G</given-names></name><name><surname>Sale</surname><given-names>MM</given-names></name><name><surname>Ahsan</surname><given-names>H</given-names></name><name><surname>Motala</surname><given-names>AA</given-names></name><name><surname>Shu</surname><given-names>X-O</given-names></name><name><surname>Park</surname><given-names>K-S</given-names></name><name><surname>Jukema</surname><given-names>JW</given-names></name><name><surname>Cruz</surname><given-names>M</given-names></name><name><surname>McKean-Cowdin</surname><given-names>R</given-names></name><name><surname>Grallert</surname><given-names>H</given-names></name><name><surname>Cheng</surname><given-names>C-Y</given-names></name><name><surname>Bottinger</surname><given-names>EP</given-names></name><name><surname>Dehghan</surname><given-names>A</given-names></name><name><surname>Tai</surname><given-names>E-S</given-names></name><name><surname>Dupuis</surname><given-names>J</given-names></name><name><surname>Kato</surname><given-names>N</given-names></name><name><surname>Laakso</surname><given-names>M</given-names></name><name><surname>Köttgen</surname><given-names>A</given-names></name><name><surname>Koh</surname><given-names>W-P</given-names></name><name><surname>Palmer</surname><given-names>CNA</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Abecasis</surname><given-names>G</given-names></name><name><surname>Kooner</surname><given-names>JS</given-names></name><name><surname>Loos</surname><given-names>RJF</given-names></name><name><surname>North</surname><given-names>KE</given-names></name><name><surname>Haiman</surname><given-names>CA</given-names></name><name><surname>Florez</surname><given-names>JC</given-names></name><name><surname>Saleheen</surname><given-names>D</given-names></name><name><surname>Hansen</surname><given-names>T</given-names></name><name><surname>Pedersen</surname><given-names>O</given-names></name><name><surname>Mägi</surname><given-names>R</given-names></name><name><surname>Langenberg</surname><given-names>C</given-names></name><name><surname>Wareham</surname><given-names>NJ</given-names></name><name><surname>Maeda</surname><given-names>S</given-names></name><name><surname>Kadowaki</surname><given-names>T</given-names></name><name><surname>Lee</surname><given-names>J</given-names></name><name><surname>Millwood</surname><given-names>IY</given-names></name><name><surname>Walters</surname><given-names>RG</given-names></name><name><surname>Stefansson</surname><given-names>K</given-names></name><name><surname>Myers</surname><given-names>SR</given-names></name><name><surname>Ferrer</surname><given-names>J</given-names></name><name><surname>Gaulton</surname><given-names>KJ</given-names></name><name><surname>Meigs</surname><given-names>JB</given-names></name><name><surname>Mohlke</surname><given-names>KL</given-names></name><name><surname>Gloyn</surname><given-names>AL</given-names></name><name><surname>Bowden</surname><given-names>DW</given-names></name><name><surname>Below</surname><given-names>JE</given-names></name><name><surname>Chambers</surname><given-names>JC</given-names></name><name><surname>Sim</surname><given-names>X</given-names></name><name><surname>Boehnke</surname><given-names>M</given-names></name><name><surname>Rotter</surname><given-names>JI</given-names></name><name><surname>McCarthy</surname><given-names>MI</given-names></name><name><surname>Morris</surname><given-names>AP</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Multi-ancestry genetic study of type 2 diabetes highlights the power of diverse populations for discovery and translation</article-title><source>Nature Genetics</source><volume>54</volume><fpage>560</fpage><lpage>572</lpage><pub-id pub-id-type="doi">10.1038/s41588-022-01058-3</pub-id><pub-id pub-id-type="pmid">35551307</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Malécot</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1948">1948</year><source>Mathématiques de l’hérédité</source><publisher-loc>Paris</publisher-loc><publisher-name>Masson et Cie</publisher-name></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manichaikul</surname><given-names>A</given-names></name><name><surname>Mychaleckyj</surname><given-names>JC</given-names></name><name><surname>Rich</surname><given-names>SS</given-names></name><name><surname>Daly</surname><given-names>K</given-names></name><name><surname>Sale</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>WM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Robust relationship inference in genome-wide Association studies</article-title><source>Bioinformatics</source><volume>26</volume><fpage>2867</fpage><lpage>2873</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq559</pub-id><pub-id pub-id-type="pmid">20926424</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>AR</given-names></name><name><surname>Gignoux</surname><given-names>CR</given-names></name><name><surname>Walters</surname><given-names>RK</given-names></name><name><surname>Wojcik</surname><given-names>GL</given-names></name><name><surname>Neale</surname><given-names>BM</given-names></name><name><surname>Gravel</surname><given-names>S</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Bustamante</surname><given-names>CD</given-names></name><name><surname>Kenny</surname><given-names>EE</given-names></name></person-group><year iso-8601-date="2017">2017a</year><article-title>Human demographic history impacts genetic risk prediction across diverse populations</article-title><source>American Journal of Human Genetics</source><volume>100</volume><fpage>635</fpage><lpage>649</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2017.03.004</pub-id><pub-id pub-id-type="pmid">28366442</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>AR</given-names></name><name><surname>Lin</surname><given-names>M</given-names></name><name><surname>Granka</surname><given-names>JM</given-names></name><name><surname>Myrick</surname><given-names>JW</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Sockell</surname><given-names>A</given-names></name><name><surname>Atkinson</surname><given-names>EG</given-names></name><name><surname>Werely</surname><given-names>CJ</given-names></name><name><surname>Möller</surname><given-names>M</given-names></name><name><surname>Sandhu</surname><given-names>MS</given-names></name><name><surname>Kingsley</surname><given-names>DM</given-names></name><name><surname>Hoal</surname><given-names>EG</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Feldman</surname><given-names>MW</given-names></name><name><surname>Gignoux</surname><given-names>CR</given-names></name><name><surname>Bustamante</surname><given-names>CD</given-names></name><name><surname>Henn</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2017">2017b</year><article-title>An unexpectedly complex architecture for skin Pigmentation in Africans</article-title><source>Cell</source><volume>171</volume><fpage>1340</fpage><lpage>1353</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.11.015</pub-id><pub-id pub-id-type="pmid">29195075</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matoba</surname><given-names>N</given-names></name><name><surname>Akiyama</surname><given-names>M</given-names></name><name><surname>Ishigaki</surname><given-names>K</given-names></name><name><surname>Kanai</surname><given-names>M</given-names></name><name><surname>Takahashi</surname><given-names>A</given-names></name><name><surname>Momozawa</surname><given-names>Y</given-names></name><name><surname>Ikegawa</surname><given-names>S</given-names></name><name><surname>Ikeda</surname><given-names>M</given-names></name><name><surname>Iwata</surname><given-names>N</given-names></name><name><surname>Hirata</surname><given-names>M</given-names></name><name><surname>Matsuda</surname><given-names>K</given-names></name><name><surname>Murakami</surname><given-names>Y</given-names></name><name><surname>Kubo</surname><given-names>M</given-names></name><name><surname>Kamatani</surname><given-names>Y</given-names></name><name><surname>Okada</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>GWAS of 165,084 Japanese individuals identified nine Loci associated with dietary habits</article-title><source>Nature Human Behaviour</source><volume>4</volume><fpage>308</fpage><lpage>316</lpage><pub-id pub-id-type="doi">10.1038/s41562-019-0805-1</pub-id><pub-id pub-id-type="pmid">31959922</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mbatchou</surname><given-names>J</given-names></name><name><surname>Barnard</surname><given-names>L</given-names></name><name><surname>Backman</surname><given-names>J</given-names></name><name><surname>Marcketta</surname><given-names>A</given-names></name><name><surname>Kosmicki</surname><given-names>JA</given-names></name><name><surname>Ziyatdinov</surname><given-names>A</given-names></name><name><surname>Benner</surname><given-names>C</given-names></name><name><surname>O’Dushlaine</surname><given-names>C</given-names></name><name><surname>Barber</surname><given-names>M</given-names></name><name><surname>Boutkov</surname><given-names>B</given-names></name><name><surname>Habegger</surname><given-names>L</given-names></name><name><surname>Ferreira</surname><given-names>M</given-names></name><name><surname>Baras</surname><given-names>A</given-names></name><name><surname>Reid</surname><given-names>J</given-names></name><name><surname>Abecasis</surname><given-names>G</given-names></name><name><surname>Maxwell</surname><given-names>E</given-names></name><name><surname>Marchini</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Computationally efficient whole-genome regression for quantitative and binary traits</article-title><source>Nature Genetics</source><volume>53</volume><fpage>1097</fpage><lpage>1103</lpage><pub-id pub-id-type="doi">10.1038/s41588-021-00870-7</pub-id><pub-id pub-id-type="pmid">34017140</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McVean</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A Genealogical interpretation of principal components analysis</article-title><source>PLOS Genetics</source><volume>5</volume><elocation-id>e1000686</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000686</pub-id><pub-id pub-id-type="pmid">19834557</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Medina-Gomez</surname><given-names>C</given-names></name><name><surname>Felix</surname><given-names>JF</given-names></name><name><surname>Estrada</surname><given-names>K</given-names></name><name><surname>Peters</surname><given-names>MJ</given-names></name><name><surname>Herrera</surname><given-names>L</given-names></name><name><surname>Kruithof</surname><given-names>CJ</given-names></name><name><surname>Duijts</surname><given-names>L</given-names></name><name><surname>Hofman</surname><given-names>A</given-names></name><name><surname>van Duijn</surname><given-names>CM</given-names></name><name><surname>Uitterlinden</surname><given-names>AG</given-names></name><name><surname>Jaddoe</surname><given-names>VWV</given-names></name><name><surname>Rivadeneira</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Challenges in conducting genome-wide Association studies in highly admixed multi-ethnic populations: The generation R study</article-title><source>European Journal of Epidemiology</source><volume>30</volume><fpage>317</fpage><lpage>330</lpage><pub-id pub-id-type="doi">10.1007/s10654-015-9998-4</pub-id><pub-id pub-id-type="pmid">25762173</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mogil</surname><given-names>LS</given-names></name><name><surname>Andaleon</surname><given-names>A</given-names></name><name><surname>Badalamenti</surname><given-names>A</given-names></name><name><surname>Dickinson</surname><given-names>SP</given-names></name><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Rotter</surname><given-names>JI</given-names></name><name><surname>Johnson</surname><given-names>WC</given-names></name><name><surname>Im</surname><given-names>HK</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Wheeler</surname><given-names>HE</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Genetic architecture of gene expression traits across diverse populations</article-title><source>PLOS Genetics</source><volume>14</volume><elocation-id>e1007586</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007586</pub-id><pub-id pub-id-type="pmid">30096133</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Mullen</surname><given-names>KM</given-names></name></person-group><year iso-8601-date="2012">2012</year><data-title>Stokkum Ihmv, Nnls: The Lawson-Hanson algorithm for non-negative least squares (NNLS)</data-title><source>The Comprehensive R Archive Network</source><ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=nnls">https://CRAN.R-project.org/package=nnls</ext-link></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Novembre</surname><given-names>J</given-names></name><name><surname>Johnson</surname><given-names>T</given-names></name><name><surname>Bryc</surname><given-names>K</given-names></name><name><surname>Kutalik</surname><given-names>Z</given-names></name><name><surname>Boyko</surname><given-names>AR</given-names></name><name><surname>Auton</surname><given-names>A</given-names></name><name><surname>Indap</surname><given-names>A</given-names></name><name><surname>King</surname><given-names>KS</given-names></name><name><surname>Bergmann</surname><given-names>S</given-names></name><name><surname>Nelson</surname><given-names>MR</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Bustamante</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Genes mirror geography within Europe</article-title><source>Nature</source><volume>456</volume><fpage>98</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1038/nature07331</pub-id><pub-id pub-id-type="pmid">18758442</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ochoa</surname><given-names>A</given-names></name><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>New Kinship and FST Estimates Reveal Higher Levels of Differentiation in the Global Human Population</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/653279</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ochoa</surname><given-names>A</given-names></name><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Estimating FST and kinship for arbitrary population structures</article-title><source>PLOS Genetics</source><volume>17</volume><elocation-id>e1009241</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1009241</pub-id><pub-id pub-id-type="pmid">33465078</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Ochoa</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Pca-Assoc-paper</data-title><version designator="swh:1:rev:8549eafe6c27583894640e6cd8639232ed15cade">swh:1:rev:8549eafe6c27583894640e6cd8639232ed15cade</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:54f4600c823ac0f1c3b17eb03185aa49a8232d56;origin=https://github.com/OchoaLab/pca-assoc-paper;visit=swh:1:snp:fcc0d7bc50b88ce0b091fd4a89d811fb26f3ddd7;anchor=swh:1:rev:8549eafe6c27583894640e6cd8639232ed15cade">https://archive.softwareheritage.org/swh:1:dir:54f4600c823ac0f1c3b17eb03185aa49a8232d56;origin=https://github.com/OchoaLab/pca-assoc-paper;visit=swh:1:snp:fcc0d7bc50b88ce0b091fd4a89d811fb26f3ddd7;anchor=swh:1:rev:8549eafe6c27583894640e6cd8639232ed15cade</ext-link></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Connor</surname><given-names>LJ</given-names></name><name><surname>Schoech</surname><given-names>AP</given-names></name><name><surname>Hormozdiari</surname><given-names>F</given-names></name><name><surname>Gazal</surname><given-names>S</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Extreme Polygenicity of complex traits is explained by negative selection</article-title><source>American Journal of Human Genetics</source><volume>105</volume><fpage>456</fpage><lpage>476</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2019.07.003</pub-id><pub-id pub-id-type="pmid">31402091</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paradis</surname><given-names>E</given-names></name><name><surname>Schliep</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Ape 5.0: An environment for modern Phylogenetics and evolutionary analyses in R</article-title><source>Bioinformatics</source><volume>35</volume><fpage>526</fpage><lpage>528</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty633</pub-id><pub-id pub-id-type="pmid">30016406</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>JH</given-names></name><name><surname>Wacholder</surname><given-names>S</given-names></name><name><surname>Gail</surname><given-names>MH</given-names></name><name><surname>Peters</surname><given-names>U</given-names></name><name><surname>Jacobs</surname><given-names>KB</given-names></name><name><surname>Chanock</surname><given-names>SJ</given-names></name><name><surname>Chatterjee</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Estimation of effect size distribution from genome-wide Association studies and implications for future discoveries</article-title><source>Nature Genetics</source><volume>42</volume><fpage>570</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1038/ng.610</pub-id><pub-id pub-id-type="pmid">20562874</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>JH</given-names></name><name><surname>Gail</surname><given-names>MH</given-names></name><name><surname>Weinberg</surname><given-names>CR</given-names></name><name><surname>Carroll</surname><given-names>RJ</given-names></name><name><surname>Chung</surname><given-names>CC</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Chanock</surname><given-names>SJ</given-names></name><name><surname>Fraumeni</surname><given-names>JF</given-names></name><name><surname>Chatterjee</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Distribution of allele frequencies and effect sizes and their interrelationships for common genetic susceptibility variants</article-title><source>PNAS</source><volume>108</volume><fpage>18026</fpage><lpage>18031</lpage><pub-id pub-id-type="doi">10.1073/pnas.1114759108</pub-id><pub-id pub-id-type="pmid">22003128</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Population structure and Eigenanalysis</article-title><source>PLOS Genetics</source><volume>2</volume><elocation-id>e190</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.0020190</pub-id><pub-id pub-id-type="pmid">17194218</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Moorjani</surname><given-names>P</given-names></name><name><surname>Luo</surname><given-names>Y</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Rohland</surname><given-names>N</given-names></name><name><surname>Zhan</surname><given-names>Y</given-names></name><name><surname>Genschoreck</surname><given-names>T</given-names></name><name><surname>Webster</surname><given-names>T</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Ancient admixture in human history</article-title><source>Genetics</source><volume>192</volume><fpage>1065</fpage><lpage>1093</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.145037</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peterson</surname><given-names>RE</given-names></name><name><surname>Kuchenbaecker</surname><given-names>K</given-names></name><name><surname>Walters</surname><given-names>RK</given-names></name><name><surname>Chen</surname><given-names>C-Y</given-names></name><name><surname>Popejoy</surname><given-names>AB</given-names></name><name><surname>Periyasamy</surname><given-names>S</given-names></name><name><surname>Lam</surname><given-names>M</given-names></name><name><surname>Iyegbe</surname><given-names>C</given-names></name><name><surname>Strawbridge</surname><given-names>RJ</given-names></name><name><surname>Brick</surname><given-names>L</given-names></name><name><surname>Carey</surname><given-names>CE</given-names></name><name><surname>Martin</surname><given-names>AR</given-names></name><name><surname>Meyers</surname><given-names>JL</given-names></name><name><surname>Su</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Edwards</surname><given-names>AC</given-names></name><name><surname>Kalungi</surname><given-names>A</given-names></name><name><surname>Koen</surname><given-names>N</given-names></name><name><surname>Majara</surname><given-names>L</given-names></name><name><surname>Schwarz</surname><given-names>E</given-names></name><name><surname>Smoller</surname><given-names>JW</given-names></name><name><surname>Stahl</surname><given-names>EA</given-names></name><name><surname>Sullivan</surname><given-names>PF</given-names></name><name><surname>Vassos</surname><given-names>E</given-names></name><name><surname>Mowry</surname><given-names>B</given-names></name><name><surname>Prieto</surname><given-names>ML</given-names></name><name><surname>Cuellar-Barboza</surname><given-names>A</given-names></name><name><surname>Bigdeli</surname><given-names>TB</given-names></name><name><surname>Edenberg</surname><given-names>HJ</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Duncan</surname><given-names>LE</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Genome-wide Association studies in Ancestrally diverse populations: Opportunities, methods, pitfalls, and recommendations</article-title><source>Cell</source><volume>179</volume><fpage>589</fpage><lpage>603</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.08.051</pub-id><pub-id pub-id-type="pmid">31607513</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Patterson</surname><given-names>NJ</given-names></name><name><surname>Plenge</surname><given-names>RM</given-names></name><name><surname>Weinblatt</surname><given-names>ME</given-names></name><name><surname>Shadick</surname><given-names>NA</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Principal components analysis corrects for stratification in genome-wide Association studies</article-title><source>Nature Genetics</source><volume>38</volume><fpage>904</fpage><lpage>909</lpage><pub-id pub-id-type="doi">10.1038/ng1847</pub-id><pub-id pub-id-type="pmid">16862161</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Zaitlen</surname><given-names>NA</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>New approaches to population stratification in genome-wide association studies</article-title><source>Nature Reviews Genetics</source><volume>11</volume><fpage>459</fpage><lpage>463</lpage><pub-id pub-id-type="doi">10.1038/nrg2813</pub-id><pub-id pub-id-type="pmid">20548291</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Zaitlen</surname><given-names>NA</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Response to Sul and Eskin</article-title><source>Nature Reviews Genetics</source><volume>14</volume><elocation-id>300</elocation-id><pub-id pub-id-type="doi">10.1038/nrg2813-c2</pub-id><pub-id pub-id-type="pmid">23438870</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pritchard</surname><given-names>JK</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Rosenberg</surname><given-names>NA</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Association mapping in structured populations</article-title><source>American Journal of Human Genetics</source><volume>67</volume><fpage>170</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1086/302959</pub-id><pub-id pub-id-type="pmid">10827107</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Privé</surname><given-names>F</given-names></name><name><surname>Luu</surname><given-names>K</given-names></name><name><surname>Blum</surname><given-names>MGB</given-names></name><name><surname>McGrath</surname><given-names>JJ</given-names></name><name><surname>Vilhjálmsson</surname><given-names>BJ</given-names></name><name><surname>Schwartz</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Efficient Toolkit implementing best practices for principal component analysis of population genetic data</article-title><source>Bioinformatics</source><volume>36</volume><fpage>4449</fpage><lpage>4457</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa520</pub-id><pub-id pub-id-type="pmid">32415959</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qian</surname><given-names>J</given-names></name><name><surname>Tanigawa</surname><given-names>Y</given-names></name><name><surname>Du</surname><given-names>W</given-names></name><name><surname>Aguirre</surname><given-names>M</given-names></name><name><surname>Chang</surname><given-names>C</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Rivas</surname><given-names>MA</given-names></name><name><surname>Hastie</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A fast and Scalable framework for large-scale and Ultrahigh-dimensional sparse regression with application to the UK Biobank</article-title><source>PLOS Genetics</source><volume>16</volume><elocation-id>e1009141</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1009141</pub-id><pub-id pub-id-type="pmid">33095761</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rakitsch</surname><given-names>B</given-names></name><name><surname>Lippert</surname><given-names>C</given-names></name><name><surname>Stegle</surname><given-names>O</given-names></name><name><surname>Borgwardt</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A lasso multi-marker mixed model for Association mapping with population structure correction</article-title><source>Bioinformatics</source><volume>29</volume><fpage>206</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts669</pub-id><pub-id pub-id-type="pmid">23175758</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roselli</surname><given-names>C</given-names></name><name><surname>Chaffin</surname><given-names>MD</given-names></name><name><surname>Weng</surname><given-names>LC</given-names></name><name><surname>Aeschbacher</surname><given-names>S</given-names></name><name><surname>Ahlberg</surname><given-names>G</given-names></name><name><surname>Albert</surname><given-names>CM</given-names></name><name><surname>Almgren</surname><given-names>P</given-names></name><name><surname>Alonso</surname><given-names>A</given-names></name><name><surname>Anderson</surname><given-names>CD</given-names></name><name><surname>Aragam</surname><given-names>KG</given-names></name><name><surname>Arking</surname><given-names>DE</given-names></name><name><surname>Barnard</surname><given-names>J</given-names></name><name><surname>Bartz</surname><given-names>TM</given-names></name><name><surname>Benjamin</surname><given-names>EJ</given-names></name><name><surname>Bihlmeyer</surname><given-names>NA</given-names></name><name><surname>Bis</surname><given-names>JC</given-names></name><name><surname>Bloom</surname><given-names>HL</given-names></name><name><surname>Boerwinkle</surname><given-names>E</given-names></name><name><surname>Bottinger</surname><given-names>EB</given-names></name><name><surname>Brody</surname><given-names>JA</given-names></name><name><surname>Calkins</surname><given-names>H</given-names></name><name><surname>Campbell</surname><given-names>A</given-names></name><name><surname>Cappola</surname><given-names>TP</given-names></name><name><surname>Carlquist</surname><given-names>J</given-names></name><name><surname>Chasman</surname><given-names>DI</given-names></name><name><surname>Chen</surname><given-names>LY</given-names></name><name><surname>Chen</surname><given-names>YDI</given-names></name><name><surname>Choi</surname><given-names>EK</given-names></name><name><surname>Choi</surname><given-names>SH</given-names></name><name><surname>Christophersen</surname><given-names>IE</given-names></name><name><surname>Chung</surname><given-names>MK</given-names></name><name><surname>Cole</surname><given-names>JW</given-names></name><name><surname>Conen</surname><given-names>D</given-names></name><name><surname>Cook</surname><given-names>J</given-names></name><name><surname>Crijns</surname><given-names>HJ</given-names></name><name><surname>Cutler</surname><given-names>MJ</given-names></name><name><surname>Damrauer</surname><given-names>SM</given-names></name><name><surname>Daniels</surname><given-names>BR</given-names></name><name><surname>Darbar</surname><given-names>D</given-names></name><name><surname>Delgado</surname><given-names>G</given-names></name><name><surname>Denny</surname><given-names>JC</given-names></name><name><surname>Dichgans</surname><given-names>M</given-names></name><name><surname>Dörr</surname><given-names>M</given-names></name><name><surname>Dudink</surname><given-names>EA</given-names></name><name><surname>Dudley</surname><given-names>SC</given-names></name><name><surname>Esa</surname><given-names>N</given-names></name><name><surname>Esko</surname><given-names>T</given-names></name><name><surname>Eskola</surname><given-names>M</given-names></name><name><surname>Fatkin</surname><given-names>D</given-names></name><name><surname>Felix</surname><given-names>SB</given-names></name><name><surname>Ford</surname><given-names>I</given-names></name><name><surname>Franco</surname><given-names>OH</given-names></name><name><surname>Geelhoed</surname><given-names>B</given-names></name><name><surname>Grewal</surname><given-names>RP</given-names></name><name><surname>Gudnason</surname><given-names>V</given-names></name><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Gupta</surname><given-names>N</given-names></name><name><surname>Gustafsson</surname><given-names>S</given-names></name><name><surname>Gutmann</surname><given-names>R</given-names></name><name><surname>Hamsten</surname><given-names>A</given-names></name><name><surname>Harris</surname><given-names>TB</given-names></name><name><surname>Hayward</surname><given-names>C</given-names></name><name><surname>Heckbert</surname><given-names>SR</given-names></name><name><surname>Hernesniemi</surname><given-names>J</given-names></name><name><surname>Hocking</surname><given-names>LJ</given-names></name><name><surname>Hofman</surname><given-names>A</given-names></name><name><surname>Horimoto</surname><given-names>A</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Huang</surname><given-names>PL</given-names></name><name><surname>Huffman</surname><given-names>J</given-names></name><name><surname>Ingelsson</surname><given-names>E</given-names></name><name><surname>Ipek</surname><given-names>EG</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name><name><surname>Jimenez-Conde</surname><given-names>J</given-names></name><name><surname>Johnson</surname><given-names>R</given-names></name><name><surname>Jukema</surname><given-names>JW</given-names></name><name><surname>Kääb</surname><given-names>S</given-names></name><name><surname>Kähönen</surname><given-names>M</given-names></name><name><surname>Kamatani</surname><given-names>Y</given-names></name><name><surname>Kane</surname><given-names>JP</given-names></name><name><surname>Kastrati</surname><given-names>A</given-names></name><name><surname>Kathiresan</surname><given-names>S</given-names></name><name><surname>Katschnig-Winter</surname><given-names>P</given-names></name><name><surname>Kavousi</surname><given-names>M</given-names></name><name><surname>Kessler</surname><given-names>T</given-names></name><name><surname>Kietselaer</surname><given-names>BL</given-names></name><name><surname>Kirchhof</surname><given-names>P</given-names></name><name><surname>Kleber</surname><given-names>ME</given-names></name><name><surname>Knight</surname><given-names>S</given-names></name><name><surname>Krieger</surname><given-names>JE</given-names></name><name><surname>Kubo</surname><given-names>M</given-names></name><name><surname>Launer</surname><given-names>LJ</given-names></name><name><surname>Laurikka</surname><given-names>J</given-names></name><name><surname>Lehtimäki</surname><given-names>T</given-names></name><name><surname>Leineweber</surname><given-names>K</given-names></name><name><surname>Lemaitre</surname><given-names>RN</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Lim</surname><given-names>HE</given-names></name><name><surname>Lin</surname><given-names>HJ</given-names></name><name><surname>Lin</surname><given-names>H</given-names></name><name><surname>Lind</surname><given-names>L</given-names></name><name><surname>Lindgren</surname><given-names>CM</given-names></name><name><surname>Lokki</surname><given-names>ML</given-names></name><name><surname>London</surname><given-names>B</given-names></name><name><surname>Loos</surname><given-names>RJF</given-names></name><name><surname>Low</surname><given-names>SK</given-names></name><name><surname>Lu</surname><given-names>Y</given-names></name><name><surname>Lyytikäinen</surname><given-names>LP</given-names></name><name><surname>Macfarlane</surname><given-names>PW</given-names></name><name><surname>Magnusson</surname><given-names>PK</given-names></name><name><surname>Mahajan</surname><given-names>A</given-names></name><name><surname>Malik</surname><given-names>R</given-names></name><name><surname>Mansur</surname><given-names>AJ</given-names></name><name><surname>Marcus</surname><given-names>GM</given-names></name><name><surname>Margolin</surname><given-names>L</given-names></name><name><surname>Margulies</surname><given-names>KB</given-names></name><name><surname>März</surname><given-names>W</given-names></name><name><surname>McManus</surname><given-names>DD</given-names></name><name><surname>Melander</surname><given-names>O</given-names></name><name><surname>Mohanty</surname><given-names>S</given-names></name><name><surname>Montgomery</surname><given-names>JA</given-names></name><name><surname>Morley</surname><given-names>MP</given-names></name><name><surname>Morris</surname><given-names>AP</given-names></name><name><surname>Müller-Nurasyid</surname><given-names>M</given-names></name><name><surname>Natale</surname><given-names>A</given-names></name><name><surname>Nazarian</surname><given-names>S</given-names></name><name><surname>Neumann</surname><given-names>B</given-names></name><name><surname>Newton-Cheh</surname><given-names>C</given-names></name><name><surname>Niemeijer</surname><given-names>MN</given-names></name><name><surname>Nikus</surname><given-names>K</given-names></name><name><surname>Nilsson</surname><given-names>P</given-names></name><name><surname>Noordam</surname><given-names>R</given-names></name><name><surname>Oellers</surname><given-names>H</given-names></name><name><surname>Olesen</surname><given-names>MS</given-names></name><name><surname>Orho-Melander</surname><given-names>M</given-names></name><name><surname>Padmanabhan</surname><given-names>S</given-names></name><name><surname>Pak</surname><given-names>HN</given-names></name><name><surname>Paré</surname><given-names>G</given-names></name><name><surname>Pedersen</surname><given-names>NL</given-names></name><name><surname>Pera</surname><given-names>J</given-names></name><name><surname>Pereira</surname><given-names>A</given-names></name><name><surname>Porteous</surname><given-names>D</given-names></name><name><surname>Psaty</surname><given-names>BM</given-names></name><name><surname>Pulit</surname><given-names>SL</given-names></name><name><surname>Pullinger</surname><given-names>CR</given-names></name><name><surname>Rader</surname><given-names>DJ</given-names></name><name><surname>Refsgaard</surname><given-names>L</given-names></name><name><surname>Ribasés</surname><given-names>M</given-names></name><name><surname>Ridker</surname><given-names>PM</given-names></name><name><surname>Rienstra</surname><given-names>M</given-names></name><name><surname>Risch</surname><given-names>L</given-names></name><name><surname>Roden</surname><given-names>DM</given-names></name><name><surname>Rosand</surname><given-names>J</given-names></name><name><surname>Rosenberg</surname><given-names>MA</given-names></name><name><surname>Rost</surname><given-names>N</given-names></name><name><surname>Rotter</surname><given-names>JI</given-names></name><name><surname>Saba</surname><given-names>S</given-names></name><name><surname>Sandhu</surname><given-names>RK</given-names></name><name><surname>Schnabel</surname><given-names>RB</given-names></name><name><surname>Schramm</surname><given-names>K</given-names></name><name><surname>Schunkert</surname><given-names>H</given-names></name><name><surname>Schurman</surname><given-names>C</given-names></name><name><surname>Scott</surname><given-names>SA</given-names></name><name><surname>Seppälä</surname><given-names>I</given-names></name><name><surname>Shaffer</surname><given-names>C</given-names></name><name><surname>Shah</surname><given-names>S</given-names></name><name><surname>Shalaby</surname><given-names>AA</given-names></name><name><surname>Shim</surname><given-names>J</given-names></name><name><surname>Shoemaker</surname><given-names>MB</given-names></name><name><surname>Siland</surname><given-names>JE</given-names></name><name><surname>Sinisalo</surname><given-names>J</given-names></name><name><surname>Sinner</surname><given-names>MF</given-names></name><name><surname>Slowik</surname><given-names>A</given-names></name><name><surname>Smith</surname><given-names>AV</given-names></name><name><surname>Smith</surname><given-names>BH</given-names></name><name><surname>Smith</surname><given-names>JG</given-names></name><name><surname>Smith</surname><given-names>JD</given-names></name><name><surname>Smith</surname><given-names>NL</given-names></name><name><surname>Soliman</surname><given-names>EZ</given-names></name><name><surname>Sotoodehnia</surname><given-names>N</given-names></name><name><surname>Stricker</surname><given-names>BH</given-names></name><name><surname>Sun</surname><given-names>A</given-names></name><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Svendsen</surname><given-names>JH</given-names></name><name><surname>Tanaka</surname><given-names>T</given-names></name><name><surname>Tanriverdi</surname><given-names>K</given-names></name><name><surname>Taylor</surname><given-names>KD</given-names></name><name><surname>Teder-Laving</surname><given-names>M</given-names></name><name><surname>Teumer</surname><given-names>A</given-names></name><name><surname>Thériault</surname><given-names>S</given-names></name><name><surname>Trompet</surname><given-names>S</given-names></name><name><surname>Tucker</surname><given-names>NR</given-names></name><name><surname>Tveit</surname><given-names>A</given-names></name><name><surname>Uitterlinden</surname><given-names>AG</given-names></name><name><surname>Van Der Harst</surname><given-names>P</given-names></name><name><surname>Van Gelder</surname><given-names>IC</given-names></name><name><surname>Van Wagoner</surname><given-names>DR</given-names></name><name><surname>Verweij</surname><given-names>N</given-names></name><name><surname>Vlachopoulou</surname><given-names>E</given-names></name><name><surname>Völker</surname><given-names>U</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Weeke</surname><given-names>PE</given-names></name><name><surname>Weijs</surname><given-names>B</given-names></name><name><surname>Weiss</surname><given-names>R</given-names></name><name><surname>Weiss</surname><given-names>S</given-names></name><name><surname>Wells</surname><given-names>QS</given-names></name><name><surname>Wiggins</surname><given-names>KL</given-names></name><name><surname>Wong</surname><given-names>JA</given-names></name><name><surname>Woo</surname><given-names>D</given-names></name><name><surname>Worrall</surname><given-names>BB</given-names></name><name><surname>Yang</surname><given-names>PS</given-names></name><name><surname>Yao</surname><given-names>J</given-names></name><name><surname>Yoneda</surname><given-names>ZT</given-names></name><name><surname>Zeller</surname><given-names>T</given-names></name><name><surname>Zeng</surname><given-names>L</given-names></name><name><surname>Lubitz</surname><given-names>SA</given-names></name><name><surname>Lunetta</surname><given-names>KL</given-names></name><name><surname>Ellinor</surname><given-names>PT</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Multi-ethnic genome-wide Association study for atrial fibrillation</article-title><source>Nature Genetics</source><volume>50</volume><fpage>1225</fpage><lpage>1233</lpage><pub-id pub-id-type="doi">10.1038/s41588-018-0133-9</pub-id><pub-id pub-id-type="pmid">29892015</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenberg</surname><given-names>NA</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name><name><surname>Weber</surname><given-names>JL</given-names></name><name><surname>Cann</surname><given-names>HM</given-names></name><name><surname>Kidd</surname><given-names>KK</given-names></name><name><surname>Zhivotovsky</surname><given-names>LA</given-names></name><name><surname>Feldman</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Genetic structure of human populations</article-title><source>Science</source><volume>298</volume><fpage>2381</fpage><lpage>2385</lpage><pub-id pub-id-type="doi">10.1126/science.1078311</pub-id><pub-id pub-id-type="pmid">12493913</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenberg</surname><given-names>NA</given-names></name><name><surname>Huang</surname><given-names>L</given-names></name><name><surname>Jewett</surname><given-names>EM</given-names></name><name><surname>Szpiech</surname><given-names>ZA</given-names></name><name><surname>Jankovic</surname><given-names>I</given-names></name><name><surname>Boehnke</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Genome-wide Association studies in diverse populations</article-title><source>Nature Reviews Genetics</source><volume>11</volume><fpage>356</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1038/nrg2760</pub-id><pub-id pub-id-type="pmid">20395969</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlauch</surname><given-names>D</given-names></name><name><surname>Fier</surname><given-names>H</given-names></name><name><surname>Lange</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Identification of genetic Outliers due to sub-structure and cryptic relationships</article-title><source>Bioinformatics</source><volume>33</volume><fpage>1972</fpage><lpage>1979</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btx109</pub-id><pub-id pub-id-type="pmid">28334167</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shchur</surname><given-names>V</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>On the number of siblings and p-th cousins in a large population sample</article-title><source>Journal of Mathematical Biology</source><volume>77</volume><fpage>1279</fpage><lpage>1298</lpage><pub-id pub-id-type="doi">10.1007/s00285-018-1252-8</pub-id><pub-id pub-id-type="pmid">29876645</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simonin-Wilmer</surname><given-names>I</given-names></name><name><surname>Orozco-Del-Pino</surname><given-names>P</given-names></name><name><surname>Bishop</surname><given-names>DT</given-names></name><name><surname>Iles</surname><given-names>MM</given-names></name><name><surname>Robles-Espinoza</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>An overview of strategies for detecting genotype-phenotype associations across Ancestrally diverse populations</article-title><source>Frontiers in Genetics</source><volume>12</volume><elocation-id>703901</elocation-id><pub-id pub-id-type="doi">10.3389/fgene.2021.703901</pub-id><pub-id pub-id-type="pmid">34804113</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simons</surname><given-names>YB</given-names></name><name><surname>Bullaughey</surname><given-names>K</given-names></name><name><surname>Hudson</surname><given-names>RR</given-names></name><name><surname>Sella</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A population genetic interpretation of GWAS findings for human quantitative traits</article-title><source>PLOS Biology</source><volume>16</volume><elocation-id>e2002985</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2002985</pub-id><pub-id pub-id-type="pmid">29547617</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skoglund</surname><given-names>P</given-names></name><name><surname>Posth</surname><given-names>C</given-names></name><name><surname>Sirak</surname><given-names>K</given-names></name><name><surname>Spriggs</surname><given-names>M</given-names></name><name><surname>Valentin</surname><given-names>F</given-names></name><name><surname>Bedford</surname><given-names>S</given-names></name><name><surname>Clark</surname><given-names>GR</given-names></name><name><surname>Reepmeyer</surname><given-names>C</given-names></name><name><surname>Petchey</surname><given-names>F</given-names></name><name><surname>Fernandes</surname><given-names>D</given-names></name><name><surname>Fu</surname><given-names>Q</given-names></name><name><surname>Harney</surname><given-names>E</given-names></name><name><surname>Lipson</surname><given-names>M</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Novak</surname><given-names>M</given-names></name><name><surname>Rohland</surname><given-names>N</given-names></name><name><surname>Stewardson</surname><given-names>K</given-names></name><name><surname>Abdullah</surname><given-names>S</given-names></name><name><surname>Cox</surname><given-names>MP</given-names></name><name><surname>Friedlaender</surname><given-names>FR</given-names></name><name><surname>Friedlaender</surname><given-names>JS</given-names></name><name><surname>Kivisild</surname><given-names>T</given-names></name><name><surname>Koki</surname><given-names>G</given-names></name><name><surname>Kusuma</surname><given-names>P</given-names></name><name><surname>Merriwether</surname><given-names>DA</given-names></name><name><surname>Ricaut</surname><given-names>F-X</given-names></name><name><surname>Wee</surname><given-names>JTS</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name><name><surname>Pinhasi</surname><given-names>R</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Genomic insights into the peopling of the southwest Pacific</article-title><source>Nature</source><volume>538</volume><fpage>510</fpage><lpage>513</lpage><pub-id pub-id-type="doi">10.1038/nature19844</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sokal</surname><given-names>RR</given-names></name><name><surname>Michener</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="1958">1958</year><article-title>A statistical method for evaluating systematic relationships</article-title><source>Univ Kansas, Sci Bull</source><volume>38</volume><fpage>1409</fpage><lpage>1438</lpage></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>M</given-names></name><name><surname>Hao</surname><given-names>W</given-names></name><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Testing for genetic associations in arbitrarily structured populations</article-title><source>Nature Genetics</source><volume>47</volume><fpage>550</fpage><lpage>554</lpage><pub-id pub-id-type="doi">10.1038/ng.3244</pub-id><pub-id pub-id-type="pmid">25822090</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Speed</surname><given-names>D</given-names></name><name><surname>Hemani</surname><given-names>G</given-names></name><name><surname>Johnson</surname><given-names>MR</given-names></name><name><surname>Balding</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Improved Heritability estimation from genome-wide SNPs</article-title><source>American Journal of Human Genetics</source><volume>91</volume><fpage>1011</fpage><lpage>1021</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2012.10.010</pub-id><pub-id pub-id-type="pmid">23217325</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The positive false discovery rate: A Bayesian interpretation and the Q-value</article-title><source>The Annals of Statistics</source><volume>31</volume><fpage>2013</fpage><lpage>2035</lpage><pub-id pub-id-type="doi">10.1214/aos/1074290335</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storey</surname><given-names>JD</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Statistical significance for Genomewide studies</article-title><source>PNAS</source><volume>100</volume><fpage>9440</fpage><lpage>9445</lpage><pub-id pub-id-type="doi">10.1073/pnas.1530509100</pub-id><pub-id pub-id-type="pmid">12883005</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sul</surname><given-names>JH</given-names></name><name><surname>Eskin</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Mixed models can correct for population structure for Genomic regions under selection</article-title><source>Nature Reviews Genetics</source><volume>14</volume><elocation-id>300</elocation-id><pub-id pub-id-type="doi">10.1038/nrg2813-c1</pub-id><pub-id pub-id-type="pmid">23438871</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sul</surname><given-names>JH</given-names></name><name><surname>Martin</surname><given-names>LS</given-names></name><name><surname>Eskin</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Population structure in genetic studies: Confounding factors and mixed models</article-title><source>PLOS Genetics</source><volume>14</volume><elocation-id>e1007309</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007309</pub-id><pub-id pub-id-type="pmid">30589851</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>G</given-names></name><name><surname>Zhu</surname><given-names>C</given-names></name><name><surname>Kramer</surname><given-names>MH</given-names></name><name><surname>Yang</surname><given-names>SS</given-names></name><name><surname>Song</surname><given-names>W</given-names></name><name><surname>Piepho</surname><given-names>HP</given-names></name><name><surname>Yu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Variation explained in mixed-model Association mapping</article-title><source>Heredity</source><volume>105</volume><fpage>333</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1038/hdy.2010.11</pub-id><pub-id pub-id-type="pmid">20145669</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svishcheva</surname><given-names>GR</given-names></name><name><surname>Axenovich</surname><given-names>TI</given-names></name><name><surname>Belonogova</surname><given-names>NM</given-names></name><name><surname>van Duijn</surname><given-names>CM</given-names></name><name><surname>Aulchenko</surname><given-names>YS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Rapid variance components–based method for whole-genome Association analysis</article-title><source>Nature Genetics</source><volume>44</volume><fpage>1166</fpage><lpage>1170</lpage><pub-id pub-id-type="doi">10.1038/ng.2410</pub-id><pub-id pub-id-type="pmid">22983301</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thornton</surname><given-names>T</given-names></name><name><surname>McPeek</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>ROADTRIPS: Case-control Association testing with partially or completely unknown population and pedigree structure</article-title><source>American Journal of Human Genetics</source><volume>86</volume><fpage>172</fpage><lpage>184</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2010.01.001</pub-id><pub-id pub-id-type="pmid">20137780</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tucker</surname><given-names>G</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Improving the power of GWAS and avoiding confounding from population stratification with PC-select</article-title><source>Genetics</source><volume>197</volume><fpage>1045</fpage><lpage>1049</lpage><pub-id pub-id-type="doi">10.1534/genetics.114.164285</pub-id><pub-id pub-id-type="pmid">24788602</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vilhjálmsson</surname><given-names>BJ</given-names></name><name><surname>Nordborg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The nature of confounding in genome-wide Association studies</article-title><source>Nature Reviews Genetics</source><volume>14</volume><fpage>1</fpage><lpage>2</lpage><pub-id pub-id-type="doi">10.1038/nrg3382</pub-id><pub-id pub-id-type="pmid">23165185</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voight</surname><given-names>BF</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Confounding from cryptic relatedness in case-control Association studies</article-title><source>PLOS Genetics</source><volume>1</volume><elocation-id>e32</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.0010032</pub-id><pub-id pub-id-type="pmid">16151517</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Aragam</surname><given-names>B</given-names></name><name><surname>Xing</surname><given-names>EP</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Trade-offs of linear mixed models in genome-wide Association studies</article-title><source>Journal of Computational Biology</source><volume>29</volume><fpage>233</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1089/cmb.2021.0157</pub-id><pub-id pub-id-type="pmid">35230156</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wojcik</surname><given-names>GL</given-names></name><name><surname>Graff</surname><given-names>M</given-names></name><name><surname>Nishimura</surname><given-names>KK</given-names></name><name><surname>Tao</surname><given-names>R</given-names></name><name><surname>Haessler</surname><given-names>J</given-names></name><name><surname>Gignoux</surname><given-names>CR</given-names></name><name><surname>Highland</surname><given-names>HM</given-names></name><name><surname>Patel</surname><given-names>YM</given-names></name><name><surname>Sorokin</surname><given-names>EP</given-names></name><name><surname>Avery</surname><given-names>CL</given-names></name><name><surname>Belbin</surname><given-names>GM</given-names></name><name><surname>Bien</surname><given-names>SA</given-names></name><name><surname>Cheng</surname><given-names>I</given-names></name><name><surname>Cullina</surname><given-names>S</given-names></name><name><surname>Hodonsky</surname><given-names>CJ</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Huckins</surname><given-names>LM</given-names></name><name><surname>Jeff</surname><given-names>J</given-names></name><name><surname>Justice</surname><given-names>AE</given-names></name><name><surname>Kocarnik</surname><given-names>JM</given-names></name><name><surname>Lim</surname><given-names>U</given-names></name><name><surname>Lin</surname><given-names>BM</given-names></name><name><surname>Lu</surname><given-names>Y</given-names></name><name><surname>Nelson</surname><given-names>SC</given-names></name><name><surname>Park</surname><given-names>S-SL</given-names></name><name><surname>Poisner</surname><given-names>H</given-names></name><name><surname>Preuss</surname><given-names>MH</given-names></name><name><surname>Richard</surname><given-names>MA</given-names></name><name><surname>Schurmann</surname><given-names>C</given-names></name><name><surname>Setiawan</surname><given-names>VW</given-names></name><name><surname>Sockell</surname><given-names>A</given-names></name><name><surname>Vahi</surname><given-names>K</given-names></name><name><surname>Verbanck</surname><given-names>M</given-names></name><name><surname>Vishnu</surname><given-names>A</given-names></name><name><surname>Walker</surname><given-names>RW</given-names></name><name><surname>Young</surname><given-names>KL</given-names></name><name><surname>Zubair</surname><given-names>N</given-names></name><name><surname>Acuña-Alonso</surname><given-names>V</given-names></name><name><surname>Ambite</surname><given-names>JL</given-names></name><name><surname>Barnes</surname><given-names>KC</given-names></name><name><surname>Boerwinkle</surname><given-names>E</given-names></name><name><surname>Bottinger</surname><given-names>EP</given-names></name><name><surname>Bustamante</surname><given-names>CD</given-names></name><name><surname>Caberto</surname><given-names>C</given-names></name><name><surname>Canizales-Quinteros</surname><given-names>S</given-names></name><name><surname>Conomos</surname><given-names>MP</given-names></name><name><surname>Deelman</surname><given-names>E</given-names></name><name><surname>Do</surname><given-names>R</given-names></name><name><surname>Doheny</surname><given-names>K</given-names></name><name><surname>Fernández-Rhodes</surname><given-names>L</given-names></name><name><surname>Fornage</surname><given-names>M</given-names></name><name><surname>Hailu</surname><given-names>B</given-names></name><name><surname>Heiss</surname><given-names>G</given-names></name><name><surname>Henn</surname><given-names>BM</given-names></name><name><surname>Hindorff</surname><given-names>LA</given-names></name><name><surname>Jackson</surname><given-names>RD</given-names></name><name><surname>Laurie</surname><given-names>CA</given-names></name><name><surname>Laurie</surname><given-names>CC</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Lin</surname><given-names>D-Y</given-names></name><name><surname>Moreno-Estrada</surname><given-names>A</given-names></name><name><surname>Nadkarni</surname><given-names>G</given-names></name><name><surname>Norman</surname><given-names>PJ</given-names></name><name><surname>Pooler</surname><given-names>LC</given-names></name><name><surname>Reiner</surname><given-names>AP</given-names></name><name><surname>Romm</surname><given-names>J</given-names></name><name><surname>Sabatti</surname><given-names>C</given-names></name><name><surname>Sandoval</surname><given-names>K</given-names></name><name><surname>Sheng</surname><given-names>X</given-names></name><name><surname>Stahl</surname><given-names>EA</given-names></name><name><surname>Stram</surname><given-names>DO</given-names></name><name><surname>Thornton</surname><given-names>TA</given-names></name><name><surname>Wassel</surname><given-names>CL</given-names></name><name><surname>Wilkens</surname><given-names>LR</given-names></name><name><surname>Winkler</surname><given-names>CA</given-names></name><name><surname>Yoneyama</surname><given-names>S</given-names></name><name><surname>Buyske</surname><given-names>S</given-names></name><name><surname>Haiman</surname><given-names>CA</given-names></name><name><surname>Kooperberg</surname><given-names>C</given-names></name><name><surname>Le Marchand</surname><given-names>L</given-names></name><name><surname>Loos</surname><given-names>RJF</given-names></name><name><surname>Matise</surname><given-names>TC</given-names></name><name><surname>North</surname><given-names>KE</given-names></name><name><surname>Peters</surname><given-names>U</given-names></name><name><surname>Kenny</surname><given-names>EE</given-names></name><name><surname>Carlson</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Genetic analyses of diverse populations improves discovery for complex traits</article-title><source>Nature</source><volume>570</volume><fpage>514</fpage><lpage>518</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1310-4</pub-id><pub-id pub-id-type="pmid">31217584</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1949">1949</year><article-title>The Genetical structure of populations</article-title><source>Annals of Eugenics</source><volume>15</volume><fpage>323</fpage><lpage>354</lpage><pub-id pub-id-type="doi">10.1111/j.1469-1809.1949.tb02451.x</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>C</given-names></name><name><surname>DeWan</surname><given-names>A</given-names></name><name><surname>Hoh</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A comparison of Association methods correcting for population stratification in case-control studies</article-title><source>Annals of Human Genetics</source><volume>75</volume><fpage>418</fpage><lpage>427</lpage><pub-id pub-id-type="doi">10.1111/j.1469-1809.2010.00639.x</pub-id><pub-id pub-id-type="pmid">21281271</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>H</given-names></name><name><surname>Guan</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Detecting local haplotype sharing and haplotype Association</article-title><source>Genetics</source><volume>197</volume><fpage>823</fpage><lpage>838</lpage><pub-id pub-id-type="doi">10.1534/genetics.114.164814</pub-id><pub-id pub-id-type="pmid">24812308</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>SH</given-names></name><name><surname>Goddard</surname><given-names>ME</given-names></name><name><surname>Visscher</surname><given-names>PM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>GCTA: a tool for genome-wide complex trait analysis</article-title><source>The American Journal of Human Genetics</source><volume>88</volume><fpage>76</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2010.11.011</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Zaitlen</surname><given-names>NA</given-names></name><name><surname>Goddard</surname><given-names>ME</given-names></name><name><surname>Visscher</surname><given-names>PM</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Advantages and pitfalls in the application of mixed-model association methods</article-title><source>Nature Genetics</source><volume>46</volume><fpage>100</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1038/ng.2876</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>J</given-names></name><name><surname>Pressoir</surname><given-names>G</given-names></name><name><surname>Briggs</surname><given-names>WH</given-names></name><name><surname>Vroh Bi</surname><given-names>I</given-names></name><name><surname>Yamasaki</surname><given-names>M</given-names></name><name><surname>Doebley</surname><given-names>JF</given-names></name><name><surname>McMullen</surname><given-names>MD</given-names></name><name><surname>Gaut</surname><given-names>BS</given-names></name><name><surname>Nielsen</surname><given-names>DM</given-names></name><name><surname>Holland</surname><given-names>JB</given-names></name><name><surname>Kresovich</surname><given-names>S</given-names></name><name><surname>Buckler</surname><given-names>ES</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A unified mixed-model method for Association mapping that accounts for multiple levels of relatedness</article-title><source>Nature Genetics</source><volume>38</volume><fpage>203</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1038/ng1702</pub-id><pub-id pub-id-type="pmid">16380716</pub-id></element-citation></ref><ref id="bib113"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaidi</surname><given-names>AA</given-names></name><name><surname>Mathieson</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Demographic history mediates the effect of stratification on Polygenic scores</article-title><source>eLife</source><volume>9</volume><elocation-id>e61548</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.61548</pub-id><pub-id pub-id-type="pmid">33200985</pub-id></element-citation></ref><ref id="bib114"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>J</given-names></name><name><surname>de Vlaming</surname><given-names>R</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Robinson</surname><given-names>MR</given-names></name><name><surname>Lloyd-Jones</surname><given-names>LR</given-names></name><name><surname>Yengo</surname><given-names>L</given-names></name><name><surname>Yap</surname><given-names>CX</given-names></name><name><surname>Xue</surname><given-names>A</given-names></name><name><surname>Sidorenko</surname><given-names>J</given-names></name><name><surname>McRae</surname><given-names>AF</given-names></name><name><surname>Powell</surname><given-names>JE</given-names></name><name><surname>Montgomery</surname><given-names>GW</given-names></name><name><surname>Metspalu</surname><given-names>A</given-names></name><name><surname>Esko</surname><given-names>T</given-names></name><name><surname>Gibson</surname><given-names>G</given-names></name><name><surname>Wray</surname><given-names>NR</given-names></name><name><surname>Visscher</surname><given-names>PM</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Signatures of negative selection in the genetic architecture of human complex traits</article-title><source>Nature Genetics</source><volume>50</volume><fpage>746</fpage><lpage>753</lpage><pub-id pub-id-type="doi">10.1038/s41588-018-0101-4</pub-id><pub-id pub-id-type="pmid">29662166</pub-id></element-citation></ref><ref id="bib115"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>On a Semiparametric test to detect associations between quantitative traits and candidate genes using unrelated individuals</article-title><source>Genetic Epidemiology</source><volume>24</volume><fpage>44</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1002/gepi.10196</pub-id><pub-id pub-id-type="pmid">12508255</pub-id></element-citation></ref><ref id="bib116"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Ersoz</surname><given-names>E</given-names></name><name><surname>Lai</surname><given-names>CQ</given-names></name><name><surname>Todhunter</surname><given-names>RJ</given-names></name><name><surname>Tiwari</surname><given-names>HK</given-names></name><name><surname>Gore</surname><given-names>MA</given-names></name><name><surname>Bradbury</surname><given-names>PJ</given-names></name><name><surname>Yu</surname><given-names>J</given-names></name><name><surname>Arnett</surname><given-names>DK</given-names></name><name><surname>Ordovas</surname><given-names>JM</given-names></name><name><surname>Buckler</surname><given-names>ES</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Mixed linear model approach adapted for genome-wide Association studies</article-title><source>Nature Genetics</source><volume>42</volume><fpage>355</fpage><lpage>360</lpage><pub-id pub-id-type="doi">10.1038/ng.546</pub-id><pub-id pub-id-type="pmid">20208535</pub-id></element-citation></ref><ref id="bib117"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Pan</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Principal component regression and linear mixed model in association analysis of structured samples: Competitors or complements</article-title><source>Genetic Epidemiology</source><volume>39</volume><fpage>149</fpage><lpage>155</lpage><pub-id pub-id-type="doi">10.1002/gepi.21879</pub-id><pub-id pub-id-type="pmid">25536929</pub-id></element-citation></ref><ref id="bib118"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>K</given-names></name><name><surname>Aranzana</surname><given-names>MJ</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Lister</surname><given-names>C</given-names></name><name><surname>Shindo</surname><given-names>C</given-names></name><name><surname>Tang</surname><given-names>C</given-names></name><name><surname>Toomajian</surname><given-names>C</given-names></name><name><surname>Zheng</surname><given-names>H</given-names></name><name><surname>Dean</surname><given-names>C</given-names></name><name><surname>Marjoram</surname><given-names>P</given-names></name><name><surname>Nordborg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>An Arabidopsis example of Association mapping in structured samples</article-title><source>PLOS Genetics</source><volume>3</volume><elocation-id>e4</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.0030004</pub-id><pub-id pub-id-type="pmid">17238287</pub-id></element-citation></ref><ref id="bib119"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>X</given-names></name><name><surname>Weir</surname><given-names>BS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Eigenanalysis of SNP data with an identity by descent interpretation</article-title><source>Theoretical Population Biology</source><volume>107</volume><fpage>65</fpage><lpage>76</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2015.09.004</pub-id><pub-id pub-id-type="pmid">26482676</pub-id></element-citation></ref><ref id="bib120"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhong</surname><given-names>Y</given-names></name><name><surname>Perera</surname><given-names>MA</given-names></name><name><surname>Gamazon</surname><given-names>ER</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>On using local ancestry to characterize the genetic architecture of human traits: Genetic regulation of gene expression in Multiethnic or admixed populations</article-title><source>American Journal of Human Genetics</source><volume>104</volume><fpage>1097</fpage><lpage>1115</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2019.04.009</pub-id><pub-id pub-id-type="pmid">31104770</pub-id></element-citation></ref><ref id="bib121"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Genome-Wide efficient mixed-model analysis for association studies</article-title><source>Nature Genetics</source><volume>44</volume><fpage>821</fpage><lpage>824</lpage><pub-id pub-id-type="doi">10.1038/ng.2310</pub-id><pub-id pub-id-type="pmid">22706312</pub-id></element-citation></ref><ref id="bib122"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Q</given-names></name><name><surname>Zhao</surname><given-names>L</given-names></name><name><surname>Guan</surname><given-names>Y</given-names></name><name><surname>Akey</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Strong selection at MHC in Mexicans since admixture</article-title><source>PLOS Genetics</source><volume>12</volume><elocation-id>e1005847</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1005847</pub-id></element-citation></ref><ref id="bib123"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>W</given-names></name><name><surname>Nielsen</surname><given-names>JB</given-names></name><name><surname>Fritsche</surname><given-names>LG</given-names></name><name><surname>Dey</surname><given-names>R</given-names></name><name><surname>Gabrielsen</surname><given-names>ME</given-names></name><name><surname>Wolford</surname><given-names>BN</given-names></name><name><surname>LeFaive</surname><given-names>J</given-names></name><name><surname>VandeHaar</surname><given-names>P</given-names></name><name><surname>Gagliano</surname><given-names>SA</given-names></name><name><surname>Gifford</surname><given-names>A</given-names></name><name><surname>Bastarache</surname><given-names>LA</given-names></name><name><surname>Wei</surname><given-names>WQ</given-names></name><name><surname>Denny</surname><given-names>JC</given-names></name><name><surname>Lin</surname><given-names>M</given-names></name><name><surname>Hveem</surname><given-names>K</given-names></name><name><surname>Kang</surname><given-names>HM</given-names></name><name><surname>Abecasis</surname><given-names>GR</given-names></name><name><surname>Willer</surname><given-names>CJ</given-names></name><name><surname>Lee</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Efficiently controlling for case-control imbalance and sample relatedness in large-scale genetic association studies</article-title><source>Nature Genetics</source><volume>50</volume><fpage>1335</fpage><lpage>1341</lpage><pub-id pub-id-type="doi">10.1038/s41588-018-0184-y</pub-id><pub-id pub-id-type="pmid">30104761</pub-id></element-citation></ref><ref id="bib124"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>C</given-names></name><name><surname>Yu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Nonmetric multidimensional Scaling corrects for population structure in association mapping with different sample types</article-title><source>Genetics</source><volume>182</volume><fpage>875</fpage><lpage>888</lpage><pub-id pub-id-type="doi">10.1534/genetics.108.098863</pub-id><pub-id pub-id-type="pmid">19414565</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Fitting ancestral allele frequency distribution to real data</title><p>We calculated <inline-formula><mml:math id="inf560"><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> distributions of each real dataset. However, population structure increases the variance of these sample <inline-formula><mml:math id="inf561"><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> relative to the true <inline-formula><mml:math id="inf562"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>). We present a new algorithm for constructing a new distribution based on the input data but with the lower variance of the true ancestral distribution. Suppose the <inline-formula><mml:math id="inf563"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> distribution over loci <inline-formula><mml:math id="inf564"><mml:mi>i</mml:mi></mml:math></inline-formula> satisfies <inline-formula><mml:math id="inf565"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf566"><mml:mrow><mml:mrow><mml:mi>Var</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. The sample allele frequency <inline-formula><mml:math id="inf567"><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>, conditioned on <inline-formula><mml:math id="inf568"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>, satisfies<disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi>Var</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf569"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mi>φ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the mean kinship over all individual (<xref ref-type="bibr" rid="bib68">Ochoa and Storey, 2021</xref>). The unconditional moments of <inline-formula><mml:math id="inf570"><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> follow from the laws of total expectation and variance: <inline-formula><mml:math id="inf571"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> and<disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>Var</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Since <inline-formula><mml:math id="inf572"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>≤</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf573"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, then <inline-formula><mml:math id="inf574"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Thus, the goal is to construct a new distribution with the original, lower variance of<disp-formula id="equ21"><label>(9)</label><mml:math id="m21"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mover><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We use the unbiased estimator <inline-formula><mml:math id="inf575"><mml:mrow><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> while <inline-formula><mml:math id="inf576"><mml:msup><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> is calculated from the tree parameters: the subpopulation coancestry matrix (<xref ref-type="disp-formula" rid="equ11">Equation 7</xref>), expanded from subpopulations to individuals, the diagonal converted to kinship (reversing <xref ref-type="disp-formula" rid="equ7">Equation 5</xref>), and the matrix averaged. However, since our model ignores the MAF filters imposed in our simulations, <inline-formula><mml:math id="inf577"><mml:msup><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> was adjusted. For Human Origins the true model <inline-formula><mml:math id="inf578"><mml:msup><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> of 0.143 was used. For 1000 Genomes and HGDP the true <inline-formula><mml:math id="inf579"><mml:msup><mml:mover accent="true"><mml:mi>φ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> are 0.126 and 0.124, respectively, but 0.4 for both produced a better fit.</p><p>Lastly, we construct new allele frequencies,<disp-formula id="equ22"><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:msubsup><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>by a weighted average of <inline-formula><mml:math id="inf580"><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf581"><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> drawn independently from a different distribution. <inline-formula><mml:math id="inf582"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> is required to have <inline-formula><mml:math id="inf583"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>. The resulting variance is<disp-formula id="equ23"><mml:math id="m23"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Var</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>Var</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which we equate to the desired <inline-formula><mml:math id="inf584"><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ21">Equation 9</xref>) and solve for <inline-formula><mml:math id="inf585"><mml:mi>w</mml:mi></mml:math></inline-formula>. For simplicity, we also set <inline-formula><mml:math id="inf586"><mml:mrow><mml:mrow><mml:mi>Var</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, which is achieved with:<disp-formula id="equ24"><mml:math id="m24"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>q</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Although <inline-formula><mml:math id="inf587"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> yields <inline-formula><mml:math id="inf588"><mml:mrow><mml:mrow><mml:mi>Var</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, we use the second root of the quadratic equation to use <inline-formula><mml:math id="inf589"><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula>:<disp-formula id="equ25"><mml:math id="m25"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s9"><title>Comparisons between <inline-formula><mml:math id="inf590"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf591"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>, and evaluation measures from the literature</title><sec sec-type="appendix" id="s9-1"><title>2.1 The inflation factor <inline-formula><mml:math id="inf592"><mml:mi>λ</mml:mi></mml:math></inline-formula></title><p>Test statistic inflation has been used to measure model calibration (<xref ref-type="bibr" rid="bib8">Astle and Balding, 2009</xref>; <xref ref-type="bibr" rid="bib78">Price et al., 2010</xref>). The inflation factor <inline-formula><mml:math id="inf593"><mml:mi>λ</mml:mi></mml:math></inline-formula> is defined as the median <inline-formula><mml:math id="inf594"><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> association statistic divided by theoretical median under the null hypothesis (<xref ref-type="bibr" rid="bib20">Devlin and Roeder, 1999</xref>). To compare p-values from non-<inline-formula><mml:math id="inf595"><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> tests (such as t-statistics), <inline-formula><mml:math id="inf596"><mml:mi>λ</mml:mi></mml:math></inline-formula> can be calculated from p-values using<disp-formula id="equ26"><mml:math id="m26"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf597"><mml:msub><mml:mi>p</mml:mi><mml:mtext>median</mml:mtext></mml:msub></mml:math></inline-formula> is the median observed p-value (including causal loci), <inline-formula><mml:math id="inf598"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mtext>median</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> is its null expectation, and <inline-formula><mml:math id="inf599"><mml:mi>F</mml:mi></mml:math></inline-formula> is the <inline-formula><mml:math id="inf600"><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> cumulative density function (<inline-formula><mml:math id="inf601"><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> is the quantile function).</p><p>To compare <inline-formula><mml:math id="inf602"><mml:mi>λ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf603"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> directly, for simplicity assume that all p-values are null. In this case, calibrated p-values give <inline-formula><mml:math id="inf604"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf605"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. However, non-uniform p-values with the expected median, such as from genomic control (<xref ref-type="bibr" rid="bib20">Devlin and Roeder, 1999</xref>), result in <inline-formula><mml:math id="inf606"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, but <inline-formula><mml:math id="inf607"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> except for uniform p-values, a key flaw of <inline-formula><mml:math id="inf608"><mml:mi>λ</mml:mi></mml:math></inline-formula> that <inline-formula><mml:math id="inf609"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> overcomes. Inflated statistics (anti-conservative p-values) give <inline-formula><mml:math id="inf610"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf611"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Deflated statistics (conservative p-values) give <inline-formula><mml:math id="inf612"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf613"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Thus, <inline-formula><mml:math id="inf614"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> always implies <inline-formula><mml:math id="inf615"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (where <inline-formula><mml:math id="inf616"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf617"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> have the same sign), but not the other way around. Overall, <inline-formula><mml:math id="inf618"><mml:mi>λ</mml:mi></mml:math></inline-formula> depends only on the median p-value, while <inline-formula><mml:math id="inf619"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> uses the complete distribution. However, <inline-formula><mml:math id="inf620"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> requires knowing which loci are null, so unlike <inline-formula><mml:math id="inf621"><mml:mi>λ</mml:mi></mml:math></inline-formula> it is only applicable to simulated traits.</p></sec><sec sec-type="appendix" id="s9-2"><title>2.2 Empirical comparison of <inline-formula><mml:math id="inf622"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf623"><mml:mi>λ</mml:mi></mml:math></inline-formula></title><p>There is a near one-to-one correspondence between <inline-formula><mml:math id="inf624"><mml:mi>λ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf625"><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> in our data (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). PCA tended to be inflated (<inline-formula><mml:math id="inf626"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf627"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) whereas LMM tended to be deflated (<inline-formula><mml:math id="inf628"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf629"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), otherwise the data for both models fall on the same contiguous curve. We fit a sigmoidal function to this data,<disp-formula id="equ27"><label>(10)</label><mml:math id="m27"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which for <inline-formula><mml:math id="inf630"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> satisfies <inline-formula><mml:math id="inf631"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and reflects <inline-formula><mml:math id="inf632"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> about zero (<inline-formula><mml:math id="inf633"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>):<disp-formula id="equ28"><mml:math id="m28"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We fit this model to <inline-formula><mml:math id="inf634"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> only since it was less noisy and of greater interest, and obtained the curve shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> with <inline-formula><mml:math id="inf635"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0.564</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf636"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.619</mml:mn></mml:mrow></mml:math></inline-formula>. The value <inline-formula><mml:math id="inf637"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.05</mml:mn></mml:mrow></mml:math></inline-formula>, a common threshold for benign inflation (<xref ref-type="bibr" rid="bib78">Price et al., 2010</xref>), corresponds to <inline-formula><mml:math id="inf638"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0085</mml:mn></mml:mrow></mml:math></inline-formula> according to <xref ref-type="disp-formula" rid="equ27">Equation 10</xref>. Conversely, <inline-formula><mml:math id="inf639"><mml:mrow><mml:msub><mml:mtext>SRMSD</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, serving as a simpler rule of thumb, corresponds to <inline-formula><mml:math id="inf640"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.06</mml:mn></mml:mrow></mml:math></inline-formula>.</p></sec><sec sec-type="appendix" id="s9-3"><title>2.3 Type I error rate</title><p>The type I error rate is the proportion of null p-values with <inline-formula><mml:math id="inf641"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Calibrated p-values have type I error rate near <inline-formula><mml:math id="inf642"><mml:mi>t</mml:mi></mml:math></inline-formula>, which may be evaluated with a binomial test. This measure may give different results for different <inline-formula><mml:math id="inf643"><mml:mi>t</mml:mi></mml:math></inline-formula>, for example be significantly miscalibrated only for large <inline-formula><mml:math id="inf644"><mml:mi>t</mml:mi></mml:math></inline-formula> (due to lack of power for smaller <inline-formula><mml:math id="inf645"><mml:mi>t</mml:mi></mml:math></inline-formula>), and it requires large simulations to estimate well as it depends on the tail of the distribution. In contrast, <inline-formula><mml:math id="inf646"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> uses the entire distribution so it is easier to estimate, <inline-formula><mml:math id="inf647"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> guarantees calibrated type I error rates at all <inline-formula><mml:math id="inf648"><mml:mi>t</mml:mi></mml:math></inline-formula>, while large <inline-formula><mml:math id="inf649"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> indicates incorrect type I errors for a range of <inline-formula><mml:math id="inf650"><mml:mi>t</mml:mi></mml:math></inline-formula>. Empirically, we find the expected agreement and monotonic relationship between <inline-formula><mml:math id="inf651"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and type I error rate (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p></sec><sec sec-type="appendix" id="s9-4"><title>2.4 Statistical power and comparison to <inline-formula><mml:math id="inf652"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula></title><p>Power is the probability that a test is declared significant when the alternative hypothesis <italic>H</italic><sub>1</sub> holds. At a p-value threshold <inline-formula><mml:math id="inf653"><mml:mi>t</mml:mi></mml:math></inline-formula>, power equals<disp-formula id="equ29"><mml:math id="m29"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo movablelimits="true" form="prefix">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf654"><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a cumulative function, so it is monotonically increasing and has an inverse. Like type I error control, power may rank models differently depending on <inline-formula><mml:math id="inf655"><mml:mi>t</mml:mi></mml:math></inline-formula>, and it is also harder to estimate than <inline-formula><mml:math id="inf656"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> because power depends on the tail of the distribution.</p><p>Power is not meaningful when p-values are not calibrated. To establish a clear connection to <inline-formula><mml:math id="inf657"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula>, assume calibrated (uniform) null p-values: <inline-formula><mml:math id="inf658"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo movablelimits="true" form="prefix">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. TPs, FPs, and FNs at <inline-formula><mml:math id="inf659"><mml:mi>t</mml:mi></mml:math></inline-formula> are<disp-formula id="equ30"><mml:math id="m30"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf660"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the proportion of null cases and <inline-formula><mml:math id="inf661"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> of alternative cases. Therefore,<disp-formula id="equ31"><mml:math id="m31"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Noting that <inline-formula><mml:math id="inf662"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, precision can be written as a function of recall, the power function, and constants:<disp-formula id="equ32"><mml:math id="m32"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This last form leads most clearly to <inline-formula><mml:math id="inf663"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> .</p><p>Lastly, consider a simple yet common case in which model <inline-formula><mml:math id="inf664"><mml:mi>A</mml:mi></mml:math></inline-formula> is uniformly more powerful than model <inline-formula><mml:math id="inf665"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for every <inline-formula><mml:math id="inf666"><mml:mi>t</mml:mi></mml:math></inline-formula>. Therefore <inline-formula><mml:math id="inf667"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for every recall value. This ensures that the precision of <inline-formula><mml:math id="inf668"><mml:mi>A</mml:mi></mml:math></inline-formula> is greater than that of <inline-formula><mml:math id="inf669"><mml:mi>B</mml:mi></mml:math></inline-formula> at every recall value, so <inline-formula><mml:math id="inf670"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> is greater for <inline-formula><mml:math id="inf671"><mml:mi>A</mml:mi></mml:math></inline-formula> than <inline-formula><mml:math id="inf672"><mml:mi>B</mml:mi></mml:math></inline-formula>. Thus, <inline-formula><mml:math id="inf673"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> ranks calibrated models according to power.</p><p>Empirically, we find the predicted positive correlation between <inline-formula><mml:math id="inf674"><mml:msub><mml:mtext>AUC</mml:mtext><mml:mtext>PR</mml:mtext></mml:msub></mml:math></inline-formula> and calibrated power (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). The correlation is clear when considered separately per dataset, but the slope varies per dataset, which is expected because the proportion of alternative cases <inline-formula><mml:math id="inf675"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> varies per dataset.</p></sec></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.79238.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Nordborg</surname><given-names>Magnus</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05twjp994</institution-id><institution>Gregor Mendel Institute</institution></institution-wrap><country>Austria</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.03.25.485885" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.03.25.485885"/></front-stub><body><p>This is an important paper that presents compelling arguments (based on simulation and comprehensively reviewed background theory) that Linear Mixed Models generally should perform better at correcting for genetic and environmental confounding in GWAS than more commonly used Principal Components methods.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.79238.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Nordborg</surname><given-names>Magnus</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05twjp994</institution-id><institution>Gregor Mendel Institute</institution></institution-wrap><country>Austria</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Nordborg</surname><given-names>Magnus</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05twjp994</institution-id><institution>Gregor Mendel Institute</institution></institution-wrap><country>Austria</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.03.25.485885">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.03.25.485885v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Limitations of principal components in quantitative genetic association models for human studies&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 4 peer reviewers, including Magnus Nordborg as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Detlef Weigel as the Senior Editor.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission. Individual reviews are also included as they are generally helpful. As you will see, there is strong support for your work, but it is clear that improvements are in order to justify your general claims.</p><p>Essential revisions:</p><p>1) You must at least discuss that the scenarios you test are in a sense as unrealistic as the (much more limited) simulations previously run, both in terms of sample size and population structure. Actual human GWAS are run &quot;within populations&quot; to minimize environmental confounding (more on this below) as much long-range LD and involve much larger sample sizes. Does this affect your conclusions? Related to this, the historical context for several methods you cite is not given.</p><p>2) Practical considerations for why PCs were/are used are not discussed either. Unbalanced designs, meta-studies, sample sizes.</p><p>3) You are not discussing environmental confounding, which is not only likely more of a problem in human GWAS than any of the other things discussed here, but could potentially justify a combination of LMM and PCs. Selection could have a similar effect, as discussed in the original LMM paper by Yu et al. (2006). Ideally, this should be simulated, but it certainly must be discussed, and the conclusions must take this into account.</p><p>4) You are similarly not addressing the issue of rare alleles and heterogeneity, which is a major preoccupation in human genetics. How does genetic architecture affect your conclusions? If you could address this, it would be a very nice (and timely) contribution (whereas the manuscript as currently written feels like it's fighting a 10-year old battle).</p><p>5) Finally, the description of the theory is often hard to follow, relies heavily on a particular model (ancient allele frequencies), and appears to be wrong in a few specific cases (see comments below). The results table is likewise inscrutable, and it is difficult to relate your simulations to real-life scenarios.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>At the very least you need to comment on the practicability and relevance issues noted above.</p><p>I would also recommend adjusting the writing to make your (otherwise lucid) review of the theory more accessible to a broader audience. Not only do you assume considerable knowledge of mathematical statistics, but you are also deeply rooted in a classical quantitative genetics framework. Terms like &quot;inbreeding edges&quot; are likely to befuddle all but a tiny fraction of humanity!</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>1. Environmental effects are known to correlate with population structure. A silly example of this is chop-stick skills, which obviously correlate with broad levels of East-Asian ancestry, e.g. in a global population sample it would likely correlate with the first two top PCs, and additional PCs would not explain more. Hence, for such a trait the generative model could really just be the top PCs, in which case including top PCs as covariates would be optimal. An LMM would in this example probably try to account for a much more complicated structure in addition to the top PCs. Hence, in summary, I would appreciate some simulations where you have environmental contributions that are perhaps strongly correlated with individual PCs, as I believe such scenarios may exist in real data analyses.</p><p>2. I really appreciate the detailed simulations in this study, but perhaps it would make sense to simulate traits given UKB genotypes? Also, and perhaps more importantly, how about also evaluating the two approaches on UKB data, to see if you really find more hits using LMMs? (similar to Loh et al., NG 2018)</p><p>3. You note that PCs are the top eigenvectors of the kinship matrix. This is usually true, but not always as when deriving PCs one should ideally apply some LD adjustment to avoid PCs capturing long-range LD regions, which can otherwise reduce power to detect variants in long-range regions. See e.g. Patterson et al. (PLoS Genet 2006) or Privé et al. (Bioinformatics 2020).</p><p>4. Following up on the previous comment, I wonder if the conclusions in this paper change if PCs are derived the way they often are, i.e. excluding long-range LD regions and/or using some LD adjustments.</p><p>5. Some of the LMMs cited are not classical LMMs, in the sense that they do not assume an infinitesimal genetic architecture. E.g. BOLT-LMM (Loh et al., Nat Genet 2015) assumes a mixture of two Gaussians as a prior for the effects, which they show can improve power further. Mbatchou et al. (Nat Genet 2021) also use blockwise ridge regression (infinitesimal model), which is effectively a more flexible prior. Using these, the relationship between the PCs and the model becomes yet more complicated. Similarly, the GCTA mixed model GWAS uses a LOCO approach to improve power, which I believe means that a slightly different kinship is used for each chromosome.</p><p>6. Your derivation assumes that there are some ancestral allele frequencies underlying the true model, but that seems perhaps unnecessary to me because these allele frequencies only represent the &quot;correct&quot; weights for the variants, and we know that they are probably wrong anyway. Indeed alternative and likely better weightings can be used, see Speed and Balding (AJHG 2012, NGR 2015, NG 2019). If you instead assume the sample frequencies are the right frequencies, then all the math becomes simple by standardizing the variants.</p><p>7. Another publication that also provides some similar theory on the relationship between PCA and mixed models is Janss et al., (Genetics 2012). (Interestingly, although their work is very nice their PCs did however have major long-range LD issues.)</p><p>8. The authors mention that LMMs are not well suited for unbalanced samples, e.g. where the case-control ratio in the sample is &lt;5%, and cite Zhou et al., Nat Genet 2018 as a solution. However, before Zhou et al. there were no computationally efficient generalized mixed models capable of being able to be applied to UKB sample sizes, which could help explain why LMMs haven't been adopted as quickly as one might have expected.</p><p>9. I believe there is some concern regarding meta-analyzing LMM GWAS summary statistics, e.g. whether one should use the actual effective sample sizes or the effective sample sizes (which I believe is the best approach). I believe this is probably the main reason why LMMs are not as widely used as we would like. I would appreciate some discussion or reflection on this.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The presentation of the results in Table 3 is nearly incomprehensible.</p><p>The authors are incorrect about no other troublesome cases on line 48. The differential variance between populations can induce bias (see papers from Xihong Lin).</p><p>The author's discussion of the benefits of including sample PCs in LMM (eg 468-472 on p28) is misinformed. In particular, it is a critical step for methods like BOLT.</p><p>The authors say &quot;low-dimensional&quot; when they mean &quot;low-rank&quot;.</p><p>The Sul and Eskin paper does not result in a tie. It states that creating a second kinship matrix from the PCs can address the issue presented in Price et al. entirely with LMMs.</p><p>It would also be interesting to know to what extent the singular value distribution matters versus the rank? The authors have some discussion of this in 5b but it is not well developed.</p><p><italic>Reviewer #4 (Recommendations for the authors):</italic></p><p>I have the following comments for consideration:</p><p>Historical context: The overall reasoning for controlling population stratification and relative kinship for different types of populations was given in [26]. It would be helpful to revise the introduction part to focus more on the original research papers and their reasonings: [5] (PCA), [9] (Q), [26] (LMM, Q in MM), and [16] (PC in LMM and actual association study). The later studies with LMM from the groups behind GCTA should be mentioned as the (emerging/emerged) trend, in addition to those comparison studies.</p><p>A couple of relevant research may be examined and discussed, in terms of different types of populations, determining the number of PCs to be included in the LMM, model comparison, and modeling fitting (redundancy). https://doi.org/10.1534/genetics.108.098863 https://doi.org/10.1038/hdy.2010.11</p><p>One question is the justification for examining a single heritability of 0.8. This level is generally regarded very high. It would be more convincing to see the results when h2 = 0.3-0.6, particularly if this is set for a large population with different subgroups.</p><p>The choice of m1=n/10 is not adequately justified. Even though we typically assume that there are many loci and the detection power increases with larger sample sizes, the actual detected numbers of loci in empirical studies are lower than that. With the current set m1 (Table 2), what were the power values, and are they close to the empirical studies?</p><p>&quot;The largest limitation of our work is that we only considered quantitative traits&quot;. This may be expanded to include that with the overall simulation scheme, you assume the causal variants are functioning across different groups of a large population (2.2.5 Trait Simulation)? Real data with measured traits may be different. This can also be different for different types of complex diseases. Some clear context information should be given at the beginning too.</p><p>Among these simulated population and real data, have you examined whether a small number of PCs are indeed significant to explain some trait variation? I think this was the original thinking of applying PCs to correct the population stratification.</p><p>L46 and L487. Assume the low-dimension part of the relatedness matters in terms of trait differences among groups, which need to be adjusted.</p><p>L53-57. This is not an accurate summary of the relevant papers. Earlier papers set up the general LMM framework with different components that may be included or included and individual components that can have varied forms or reported the first actual association study with the LMM framework. These two are earlier papers that (re-)introduce LMM to the association studies, and markers were used for kinship, structure, and PCA.</p><p>L64-70. Redundancy is not an issue since the objective is to control false positives using two types of covariates.</p><p>L166. Large &quot;and&quot;(?) Family.</p><p>L282. Theoretical and empirical evidence of these two needs to be provided.</p><p>Table 3. Not clear about the asterisk.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.79238.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) You must at least discuss that the scenarios you test are in a sense as unrealistic as the (much more limited) simulations previously run, both in terms of sample size and population structure. Actual human GWAS are run &quot;within populations&quot; to minimize environmental confounding (more on this below) as much long-range LD and involve much larger sample sizes. Does this affect your conclusions? Related to this, the historical context for several methods you cite is not given.</p></disp-quote><p>We added to our discussion comments on sample size, which is smaller than many of the largest modern studies. However, we do not expect our key conclusion to change for larger sample sizes, since cryptic family relatedness is not only present there but it is expected to be even more abundant compared to smaller sample sizes.</p><p>Many modern GWAS are multiethnic or include admixed individuals, so this is not an artificial setting that has no bearing on real analyses. We now cite 21 recent papers on this topic to back up this assertion. We focused on these more extreme cases as this is where challenges to PCA and LMM performance are most expected. We agree that environmental confounding is an important issue for multiethnic studies, and have now included numerous simulations with considerable environment effects.</p><p>Our simulated genotypes do not have LD, and our real data was pruned to exclude short range LD in order to simplify evaluations. The reviewers point out several variants to PC and kinship estimation that can improve handling of LD, and we now incorporate those in our discussion. We agree LD should be handled with appropriate estimators when present, but overall we do not think the presence of LD changes our key conclusion, namely that LMM outperforms PCA and that this is mostly due to the presence of cryptic family relatedness.</p><p>For clarity, we opted to focus on describing the most common modern versions of PCA and LMM which are tested, as opposed to numerous older variants we did not test here, which modeled population and family structure in somewhat different ways. We provide historical context strictly as needed to avoid confusion and keep our already lengthy work as brief as possible.</p><disp-quote content-type="editor-comment"><p>2) Practical considerations for why PCs were/are used are not discussed either. Unbalanced designs, meta-studies, sample sizes.</p></disp-quote><p>We added a discussion paragraph to sample sizes and related questions. Indeed, PCA scales better than classic LMMs with sample size, although many recent LMMs are now scaling better, although some do so by changing the inference model somewhat (by taking new shortcuts, for example), so those new models deserve further study. However, cryptic family relatedness is expected to become more abundant at larger sample sizes, so PCA should perform worse there.</p><p>We also briefly discuss unbalanced case-control designs. However, quantitative trait studies do not typically exhibit unbalanced designs, which is the sole focus of this work, so this interesting question is out of scope.</p><p>Meta-analysis does not give either PCA or LMM an advantage, as it can be applied to summary statistics from either or even a combination of models.</p><disp-quote content-type="editor-comment"><p>3) You are not discussing environmental confounding, which is not only likely more of a problem in human GWAS than any of the other things discussed here, but could potentially justify a combination of LMM and PCs. Selection could have a similar effect, as discussed in the original LMM paper by Yu et al. (2006). Ideally, this should be simulated, but it certainly must be discussed, and the conclusions must take this into account.</p></disp-quote><p>We added numerous simulations with large environment effects. Although an LMM with PCs can occasionally significantly outperform an LMM without PCs, in these cases the difference in performance tended to be small, and including environment variables as fixed effects in our regression improves performance much more than using PCs. Therefore, we are hesitant to recommend always including PCs in an LMM since this tends to be a poor solution to the problem of environmental confounding, and more explicit modeling of environment effects is instead recommended.</p><disp-quote content-type="editor-comment"><p>4) You are similarly not addressing the issue of rare alleles and heterogeneity, which is a major preoccupation in human genetics. How does genetic architecture affect your conclusions? If you could address this, it would be a very nice (and timely) contribution (whereas the manuscript as currently written feels like it's fighting a 10-year old battle).</p></disp-quote><p>We now include rare variants in our discussion. In our evaluations we had to ignore rare variants because at our small sample sizes we have no power to detect association at these variants with low counts (and p-values were often miscalibrated in those cases, a well known issue). However, we agree that modeling rare variants is important in biobank-scale analyses, and their covariance structure is different than for common variants (Zaidi and Mathieson, 2020), which raises very interesting challenges we hope to tackle in future work.</p><p>By heterogeneity, one reviewer clarifies below to mean effect size heterogeneity across populations, which is the focus of much recent work. However, this questions is not relevant to our LMM vs PCA comparisons, as neither of these basic models is equipped to model effect size heterogeneity, neither is expected a priori to perform better than the other, and both models can be extended to model ancestry-specific effects in the way it is done in TRACTOR, for example.</p><disp-quote content-type="editor-comment"><p>5) Finally, the description of the theory is often hard to follow, relies heavily on a particular model (ancient allele frequencies), and appears to be wrong in a few specific cases (see comments below). The results table is likewise inscrutable, and it is difficult to relate your simulations to real-life scenarios.</p></disp-quote><p>We updated the descriptions of our theory as suggested in the more specific comments below, and there we also address the particulars of our model. We improved Table 3 with the main statistical evaluations.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>At the very least you need to comment on the practicability and relevance issues noted above.</p><p>I would also recommend adjusting the writing to make your (otherwise lucid) review of the theory more accessible to a broader audience. Not only do you assume considerable knowledge of mathematical statistics, but you are also deeply rooted in a classical quantitative genetics framework. Terms like &quot;inbreeding edges&quot; are likely to befuddle all but a tiny fraction of humanity!</p></disp-quote><p>We clarified the concepts highlighted and additionally edited based on feedback from additional members of our lab who reviewed the revised manuscript.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>1. Environmental effects are known to correlate with population structure. A silly example of this is chop-stick skills, which obviously correlate with broad levels of East-Asian ancestry, e.g. in a global population sample it would likely correlate with the first two top PCs, and additional PCs would not explain more. Hence, for such a trait the generative model could really just be the top PCs, in which case including top PCs as covariates would be optimal. An LMM would in this example probably try to account for a much more complicated structure in addition to the top PCs. Hence, in summary, I would appreciate some simulations where you have environmental contributions that are perhaps strongly correlated with individual PCs, as I believe such scenarios may exist in real data analyses.</p></disp-quote><p>We added numerous simulations with random environment effects generated from the population labels given by the three real datasets (and with labels that group individuals by geographic coordinates for the simulated datasets). These environment effects are strongly correlated with ancestry and are also low-dimensional, which could give PCA an advantage based on those properties as you and many others expect. By necessity, the environment simulations have a lower heritability, to accommodate for large environment effects. Thus, for comparison, we also simulated numerous low heritability traits without environment, whose results are comparable to the original high heritability simulations. Surprisingly, we find that LMMs fit environment effects nearly as well as PCA, since both increase their AUCs substantially compared to the low heritability simulations (Figure 8 Figure supp 1). We do find that with environment, occasionally, an LMM with PCs slightly but significantly outperforms an LMM without PCs, and in other cases PCA similarly outperforms LMM. But we do want to emphasize that the effect is often not there, and that in general LMM without PCs performs nearly as well as the best competing method, and significant differences are invariably small. Lastly, we included an LMM with the true group labels as fixed covariates, and in most cases that was the best method and its AUCs were greater by considerable amounts. Overall, we do see this potential advantage to including PCs, but it is in no way a reliable solution, and it is no replacement for more direct modeling of environment effects.</p><disp-quote content-type="editor-comment"><p>2. I really appreciate the detailed simulations in this study, but perhaps it would make sense to simulate traits given UKB genotypes? Also, and perhaps more importantly, how about also evaluating the two approaches on UKB data, to see if you really find more hits using LMMs? (similar to Loh et al., NG 2018)</p></disp-quote><p>We are interested in this question of larger datasets, but it is out of scope of the current work. One immediate concern is that the LMM used in our paper (GCTA) cannot be used in these larger datasets. GCTA is in a sense a classic LMM that in our evaluations performs as well as older methods (EMMAX, GEMMA) but is faster than those, so we have no concerns that either of those would have similar power if we were able to run them on UKB (but this is not possible). In contrast, the scalable LMM approaches applicable to the UKB (BOLT-LMM, SAIGE, REGENIE, and others) do so by making additional approximations that older LMMs do not use, which worry us as they may potentially reduce power and could confound the results. BOLT-LMM in particularly has performed poorly in our hands in simulations with <italic>n</italic> = 1000 individuals (unpublished results), so this is not a merely hypothetical concern. A fair and complete evaluation that considers all of these variables is an entire line of work separate from the current evaluation, but it is definitely the next step.</p><p>That said, we believe the main conclusion will not change on UKB or other large datasets. In particular, we expect cryptic family relatedness to remain a serious problem, and perhaps have a larger impact as the abundance of distant relatives only increases with sample size.</p><disp-quote content-type="editor-comment"><p>3. You note that PCs are the top eigenvectors of the kinship matrix. This is usually true, but not always as when deriving PCs one should ideally apply some LD adjustment to avoid PCs capturing long-range LD regions, which can otherwise reduce power to detect variants in long-range regions. See e.g. Patterson et al. (PLoS Genet 2006) or Privé et al. (Bioinformatics 2020).</p><p>4. Following up on the previous comment, I wonder if the conclusions in this paper change if PCs are derived the way they often are, i.e. excluding long-range LD regions and/or using some LD adjustments.</p></disp-quote><p>We incorporated these variants of the PCA approach into our discussion, and in particular added the following conclusion: “These improved PCs remain inadequate models of family relatedness, so an LMM will continue to outperform them in that setting.”</p><disp-quote content-type="editor-comment"><p>5. Some of the LMMs cited are not classical LMMs, in the sense that they do not assume an infinitesimal genetic architecture. E.g. BOLT-LMM (Loh et al., Nat Genet 2015) assumes a mixture of two Gaussians as a prior for the effects, which they show can improve power further. Mbatchou et al. (Nat Genet 2021) also use blockwise ridge regression (infinitesimal model), which is effectively a more flexible prior. Using these, the relationship between the PCs and the model becomes yet more complicated. Similarly, the GCTA mixed model GWAS uses a LOCO approach to improve power, which I believe means that a slightly different kinship is used for each chromosome.</p></disp-quote><p>We incorporated the LOCO approach into our discussion, and added the following conclusion: “While LOCO kinship estimates vary for each chromosome, they continue to model family relatedness, thus maintaining their key advantage over PCA.”</p><p>We also incorporated BOLT-LMM and REGENIE into a different part of our discussion, and agreed with your conclusion: “Many of these newer LMMs also no longer follow the infinitesimal model of the basic LMM (Loh et al., 2015; Mbatchou et al., 2021), and employ novel approximations, which are features not evaluated in this work and worthy of future study.”</p><disp-quote content-type="editor-comment"><p>6. Your derivation assumes that there are some ancestral allele frequencies underlying the true model, but that seems perhaps unnecessary to me because these allele frequencies only represent the &quot;correct&quot; weights for the variants, and we know that they are probably wrong anyway. Indeed alternative and likely better weightings can be used, see Speed and Balding (AJHG 2012, NGR 2015, NG 2019). If you instead assume the sample frequencies are the right frequencies, then all the math becomes simple by standardizing the variants.</p></disp-quote><p>Our methods contained early on the following explanation: “However, this kinship estimator has a complex bias that differs for every individual pair, which arises due to the use of this estimated <italic>p</italic>ˆ<italic><sup>T</sup><sub>i</sub></italic> (Ochoa and Storey, 2021, 2019). Nevertheless, in PCA and LMM these biased estimates perform as well as unbiased ones (Hou and Ochoa, 2023).”</p><p>To further explain, our recent work (Ochoa and Storey, 2021) has shown that sample allele frequencies are not the right frequencies, although that is a pervasive assumption, and in particular kinship estimates are biased when making this precise assumption. In that work we developed a new estimator, popkin, that is unbiased and overcomes the problem that the true ancestral allele frequencies are unknown, and estimates kinship without bias without having to estimate such allele frequencies at all. We use popkin to visualize population structure in Figure 1. and to calculate eigenvalues later. However, our followup work found that PCA and LMM work just fine with standard biased kinship estimates, because the intercept compensates (in a complicated way) for the bias in PCs or random effects (Hou and Ochoa, 2023). Nevertheless, it is very important to distinguish between true and estimated allele frequencies, as biases creep in when such distinctions are ignored, and regardless of whether this is ultimately the correct model or not (no model is completely correct, of course).</p><p>Since Speed and Balding (2012) is relevant to a new related discussion about PCA and LMM variants, all of which attempt to improve LD modeling, we added this paper to that discussion as well.</p><disp-quote content-type="editor-comment"><p>7. Another publication that also provides some similar theory on the relationship between PCA and mixed models is Janss et al., (Genetics 2012). (Interestingly, although their work is very nice their PCs did however have major long-range LD issues.)</p></disp-quote><p>We incorporated Janss et al., (2012) in our paper, cited in introduction, methods, and discussion.</p><disp-quote content-type="editor-comment"><p>8. The authors mention that LMMs are not well suited for unbalanced samples, e.g. where the case-control ratio in the sample is &lt;5%, and cite Zhou et al., Nat Genet 2018 as a solution. However, before Zhou et al. there were no computationally efficient generalized mixed models capable of being able to be applied to UKB sample sizes, which could help explain why LMMs haven't been adopted as quickly as one might have expected.</p></disp-quote><p>We agree, and added a discussion paragraph concerning the sample size limitations of the present work that echo these points.</p><disp-quote content-type="editor-comment"><p>9. I believe there is some concern regarding meta-analyzing LMM GWAS summary statistics, e.g. whether one should use the actual effective sample sizes or the effective sample sizes (which I believe is the best approach). I believe this is probably the main reason why LMMs are not as widely used as we would like. I would appreciate some discussion or reflection on this.</p></disp-quote><p>We agree these are important questions to be analyzed in future work, but meta-analysis is a very different kind of model that falls outside the scope of this present work.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>The presentation of the results in Table 3 is nearly incomprehensible.</p></disp-quote><p>We modified Table 3 considerably for greater clarity. We simplified the statistical tests to center on the hypothesis that LMM with no PCs is better than all other cases (before we instead sought to identify smaller numbers of PCs that performed the same, statistically, as the best number of PCs, but that was both confusing and did not directly address our central hypothesis). For additional clarity we now include all p-values. Now we use a Bonferroni threshold to declare significance (the original used a fixed p-value threshold).</p><disp-quote content-type="editor-comment"><p>The authors are incorrect about no other troublesome cases on line 48. The differential variance between populations can induce bias (see papers from Xihong Lin).</p></disp-quote><p>We apologize, we were unable to identify the precise papers from Xihong Lin you are referring to, using your keywords of PCA and differential variance between populations. However, we stand by our comment, in that numerous papers have proposed various explanations for poor PCA performance that have not stood the test of time, and family relatedness is the only explanation that recurs and that numerous papers/authors agree upon.</p><disp-quote content-type="editor-comment"><p>The author's discussion of the benefits of including sample PCs in LMM (eg 468-472 on p28) is misinformed. In particular, it is a critical step for methods like BOLT.</p></disp-quote><p>We added the following to the discussion (appears a few paragraphs after the lines cited above): “A different benefit for including PCs were recently reported for BOLT-LMM, which does not result in greater power but rather in reduced runtime, a property that may be specific to its use of scalable algorithms such as conjugate gradient and variational Bayes (Loh et al., 2018).”</p><p>To further clarify, the BOLT-LMM authors make no claim that there are gains in performance (which in our paper refers exclusively to calibration and power) due to inclusion of PCs, it is solely a runtime advantage. Further, this appears to be a property of the specific algorithm used by BOLT-LMM, and not a general property of LMMs. Thus, our original statement stands.</p><disp-quote content-type="editor-comment"><p>The authors say &quot;low-dimensional&quot; when they mean &quot;low-rank&quot;.</p></disp-quote><p>Low-rank is more correct mathematically, so we included a clarification in the first mention of “low-dimensional” relatedness. We also replaced some mentions of dimension with “matrix rank” when that is more precise, and in other cases added the adjective “model dimension” when that was appropriate. We also entirely replaced the vague term “dimensionality” with more precise terms, which varied depending on context. However, we thought “low-rank” may be too technical to use exclusively, so we did not fully excise the more intuitive “low-dimensional” expression from our work.</p><disp-quote content-type="editor-comment"><p>The Sul and Eskin paper does not result in a tie. It states that creating a second kinship matrix from the PCs can address the issue presented in Price et al. entirely with LMMs.</p></disp-quote><p>You are correct. However, we sought to indicate whether a standard LMM (with a single, standard kinship matrix) outperformed PCA, and in that regard it was a tie. LMMs with multiple kinship matrices are not commonly used and are not the subject of our investigation.</p><disp-quote content-type="editor-comment"><p>It would also be interesting to know to what extent the singular value distribution matters versus the rank? The authors have some discussion of this in 5b but it is not well developed.</p></disp-quote><p>We indeed consider this in what is now Figure 6 Figure supp 1, which shows the cumulative distribution of eigenvalues. However, that figure shows that none of the datasets stand out in having exceptional distributions except for the admixed family simulation. Since these distributions do not clearly separate the cases where PCA performed poorly from the rest, we decided that a brief mention of this analysis in the main text was enough to state that it was done but it was inconclusive. We think that spending additional time on this tangent is distracting from the stronger results we obtained from looking at the local kinship distributions.</p><disp-quote content-type="editor-comment"><p>Reviewer #4 (Recommendations for the authors):</p><p>I have the following comments for consideration:</p><p>Historical context: The overall reasoning for controlling population stratification and relative kinship for different types of populations was given in [26]. It would be helpful to revise the introduction part to focus more on the original research papers and their reasonings: [5] (PCA), [9] (Q), [26] (LMM, Q in MM), and [16] (PC in LMM and actual association study). The later studies with LMM from the groups behind GCTA should be mentioned as the (emerging/emerged) trend, in addition to those comparison studies.</p></disp-quote><p>For reference, these are the citations (as numbers may have changed in revision):</p><list list-type="bullet"><list-item><p>[5]: Price et al., (2006): PCA</p></list-item><list-item><p>[9]: Pritchard et al., (2000): Q</p></list-item><list-item><p>[16]: Zhao et al., (2007): PC in LMM and actual association</p></list-item><list-item><p>[26]: Yu et al., (2006): LMM, Q in MM</p></list-item></list><p>Earlier draft versions of our introduction presented the historical context in more detail, similarly to what you are suggesting, but after much consideration we converged onto the current version, which we believe is appropriately more focused on the current approaches that were tested. In particular, our paper does not test the Q association model directly, and only tests one newer LMM that uses the standard kinship estimator (unlike the above early LMMs), so we thought spending more time explaining previous approaches that we are not testing can be distracting and confusing to readers. We thought the text flowed better the way it is written, not only primarily describing current approaches, but also describing PCA and LMM papers separately rather than chronologically (the timelines overlap considerably). We chose to focus on explaining the methods and their properties clearly instead. We do cover the conclusions of those early papers and highlight the differences between those and current approaches, but we do so strictly as needed (not chronologically) and as concisely as possible for clarity.</p><disp-quote content-type="editor-comment"><p>A couple of relevant research may be examined and discussed, in terms of different types of populations, determining the number of PCs to be included in the LMM, model comparison, and modeling fitting (redundancy). https://doi.org/10.1534/genetics.108.098863 https://doi.org/10.1038/hdy.2010.11</p></disp-quote><p>Zhu and Yu, 2009: Thank you for making us aware of this excellent evaluation, we included it in Table 1, and cited it in numerous locations in the introduction and discussion.</p><p>Sun et al., 2010: We now cite this paper in the discussion: “Additionally, PCA and LMM goodness of fit could be compared using the coefficient of determination generalized for LMMs (Sun et al., 2010).” Although we would have liked to try calculating these <italic>R<sub>LR</sub></italic><sup>2</sup> in all of our simulations, for the baseline PCA and LMM models without loci, it comes at a considerable computational expense for LMMs, especially for the largest datasets, so we decided not to pursue it for this work. Furthermore, as variance components are estimated in GCTA using REML, we are also unsure if those estimates are appropriate for use in <italic>R<sub>LR</sub></italic><sup>2</sup> (technically estimates must be ML, not REML).</p><disp-quote content-type="editor-comment"><p>One question is the justification for examining a single heritability of 0.8. This level is generally regarded very high. It would be more convincing to see the results when h2 = 0.3-0.6, particularly if this is set for a large population with different subgroups.</p></disp-quote><p>We repeated most of our simulations with a heritability of 0.3, and all of our conclusions hold.</p><disp-quote content-type="editor-comment"><p>The choice of m1=n/10 is not adequately justified. Even though we typically assume that there are many loci and the detection power increases with larger sample sizes, the actual detected numbers of loci in empirical studies are lower than that. With the current set m1 (Table 2), what were the power values, and are they close to the empirical studies?</p></disp-quote><p>Since we now consider varying heritability, we extended our heuristic formula to “<italic>m</italic><sub>1</sub> = round(<italic>nh</italic><sup>2</sup><italic>/</italic>8), which empirically balances power well with varying <italic>n</italic> and <italic>h</italic><sup>2</sup>.” Note that for the original heritability of <italic>h</italic><sup>2</sup> = 0<italic>.</italic>8 the above formula reduces to the original one. This heuristic formula aims to maintain similar power (or AUCs) across studies with different parameters, and it works well enough empirically, though it is not exact and we did observe that AUCs vary somewhat between studies. More parameters surely matter for determining AUC.</p><p>We do not recover most of the causal loci we are simulating, reflected in the fact that AUCs are near 0.1 or 0.2 (this is, roughly speaking, close to the proportion of causal loci we are recovering confidently, which are clearly separated from the noise). We added a new figure that compares AUC to power, and find rough agreement between AUC and calibrated power calculated at an empirical type I error rate of 1e-4 (Figure 2 Figure supp 3). Therefore, our power at that level is roughly 0.1 to 0.2. In contrast, other empirical studies try to select parameters so that power is near 50%, although the p-value thresholds at which power is measured varies considerably in those previous studies. We think our simulation is more realistic in the sense that most causal loci are not recovered by GWAS, but their presence is important as they add to the background polygenic effect, so it makes sense to model a large number of causal loci even if we can only hope to recover a small proportion of them.</p><disp-quote content-type="editor-comment"><p>&quot;The largest limitation of our work is that we only considered quantitative traits&quot;. This may be expanded to include that with the overall simulation scheme, you assume the causal variants are functioning across different groups of a large population (2.2.5 Trait Simulation)? Real data with measured traits may be different. This can also be different for different types of complex diseases. Some clear context information should be given at the beginning too.</p></disp-quote><p>By this we assume you mean that we did not simulate ancestry-specific effect size heterogeneity (in other words, our coefficients are the same for all individuals, of all ancestries). Although some work has suggested that effect sizes can vary across ancestries, other recent work shows that this is not common (K. Hou et al., 2023). However, this is not a limitation in the context of our paper, as neither the basic PCA or LMM are equipped to handle effect size heterogeneity, so adding such details to our simulation is not expected to benefit either approach. There are more recent approaches that extend that model effect size heterogeneity, such as TRACTOR, but they are not the focus of this evaluation. Additionally, both PCA and LMM can, in principle, be extended to model effect heterogeneity in exactly the same way as TRACTOR (which is a fixed effects model most like PCA).</p><disp-quote content-type="editor-comment"><p>Among these simulated population and real data, have you examined whether a small number of PCs are indeed significant to explain some trait variation? I think this was the original thinking of applying PCs to correct the population stratification.</p></disp-quote><p>We now performed these tests (Figure 6 Figure supp 2) and they always yielded small numbers of PCs that were significant: minimum 1 observed for the small sample size admixture simulation, most other cases had several significant PCs, maximum below 20 observed for the Admixed Family simulation and for Human Origins (both real and the tree simulated version). Overall they were roughly consistent with the numbers of PCs needed for the PCA method to maximize its performance in each of these datasets.</p><p>We introduced the following text in the section where we discuss the latent dimension of datasets and whether they could be used to predict when PCA would perform poorly (they don’t): “We also calculated the number of PCs that are significantly associated with the trait, and observed similar results, namely that while the family simulation has more significant PCs than the non-family admixture simulations, the real datasets and their tree simulated counterparts have similar numbers of significant PCs (Figure 6 Figure supp 2).”</p><disp-quote content-type="editor-comment"><p>L46 and L487. Assume the low-dimension part of the relatedness matters in terms of trait differences among groups, which need to be adjusted.</p></disp-quote><p>It is unnecessary to state that PCA assumes that the effect on the trait is also low-dimensional. Under non-zero heritability, high-dimensional relatedness (family structure) always affects the trait. It is impossible for the effect to be restricted to a low-dimensional component, because close relatives will share an outsize proportion of variants (whether they are common or rare in different groups) and thus have much more similar traits than random people (in the same group or otherwise).</p><disp-quote content-type="editor-comment"><p>L53-57. This is not an accurate summary of the relevant papers. Earlier papers set up the general LMM framework with different components that may be included or included and individual components that can have varied forms or reported the first actual association study with the LMM framework. These two are earlier papers that (re-)introduce LMM to the association studies, and markers were used for kinship, structure, and PCA.</p></disp-quote><p>We reworded the first sentence to: “Early LMMs used kinship matrices estimated from known pedigrees or using methods that captured recent relatedness only, and modeled population structure (ancestry) as fixed effects (Yu et al., 2006; Zhao et al., 2007; Zhu et al., 2009).” The intent of that sentence was not to describe early LMMs entirely, or as abstract frameworks, but to point out that the specific kinship estimates used then in practice were different than the ones commonly used now, though we agree the original version was misleading.</p><disp-quote content-type="editor-comment"><p>L64-70. Redundancy is not an issue since the objective is to control false positives using two types of covariates.</p></disp-quote><p>We agree, redundancy does not often cause problems in practice, but without a clear benefit it’s not worth the clear risk of loss of power (which we demonstrate for large numbers of PCs) and increased computational burden.</p><disp-quote content-type="editor-comment"><p>L166. Large &quot;and&quot;(?) Family.</p></disp-quote><p>We reworded to say “Both Large and Family simulations …”.</p><disp-quote content-type="editor-comment"><p>L282. Theoretical and empirical evidence of these two needs to be provided.</p></disp-quote><p>We previously provided theoretical justification for our SRMSDp and AUC metrics in Appendix B, showing that SRMSDp reflects null p-value calibration and agrees with the inflation factor and type I error rate, while AUC corresponds to calibrated power. We also provided Figure 2 Figure supp 1, which showed an excellent monotonic correspondence between SRMSDp and the inflation factor. We added two supplementary figures that provide additional empirical justification. Figure 2 Figure supp 2 shows that SRMSDp and type I error are monotonically related, and that they agree as expected for calibrated models. Figure 2 Figure supp 3 shows a positive correlation between AUC and calibrated power, which holds well separately per dataset, although the slope of this relationship varies between datasets because they have different proportions of loci where the alternative hypothesis holds.</p><disp-quote content-type="editor-comment"><p>Table 3. Not clear about the asterisk.</p></disp-quote><p>This table has been reorganized at the request of another reviewer. The asterisk denoted that model with that number of PCs was calibrated (determined by whether the mean absolute SRMSDp was below 0.01). In the new table there is instead a column that denotes if each model is calibrated as a boolean (True or False).</p></body></sub-article></article>