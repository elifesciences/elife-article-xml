<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">51214</article-id><article-id pub-id-type="doi">10.7554/eLife.51214</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Human Biology and Medicine</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Human Neocortical Neurosolver (HNN), a new software tool for interpreting the cellular and network origin of human MEG/EEG data</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-127661"><name><surname>Neymotin</surname><given-names>Samuel A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3646-5195</contrib-id><email>samuel.neymotin@nki.rfmh.org</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-155985"><name><surname>Daniels</surname><given-names>Dylan S</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-155986"><name><surname>Caldwell</surname><given-names>Blake</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6882-6998</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-127662"><name><surname>McDougal</surname><given-names>Robert A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6394-3127</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-155987"><name><surname>Carnevale</surname><given-names>Nicholas T</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-155988"><name><surname>Jas</surname><given-names>Mainak</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-7293"><name><surname>Moore</surname><given-names>Christopher I</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4534-1602</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-47274"><name><surname>Hines</surname><given-names>Michael L</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-33313"><name><surname>Hämäläinen</surname><given-names>Matti</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-79078"><name><surname>Jones</surname><given-names>Stephanie R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6760-5301</contrib-id><email>Stephanie_Jones@brown.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department Neuroscience, Carney Institute for Brain Sciences</institution><institution>Brown University</institution><addr-line><named-content content-type="city">Providence</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Center for Biomedical Imaging and Neuromodulation</institution><institution>Nathan S. Kline Institute for Psychiatric Research</institution><addr-line><named-content content-type="city">Orangeburg</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department Neuroscience</institution><institution>Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Department of Biostatistics</institution><institution>Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Athinoula A. Martinos Center for Biomedical Imaging</institution><institution>Massachusetts General Hospital</institution><addr-line><named-content content-type="city">Charlestown</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution>Harvard Medical School</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff7"><label>7</label><institution content-type="dept">Center for Neurorestoration and Neurotechnology</institution><institution>Providence VAMC</institution><addr-line><named-content content-type="city">Providence</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="senior_editor"><name><surname>Ivry</surname><given-names>Richard B</given-names></name><role>Senior Editor</role><aff><institution>University of California, Berkeley</institution><country>United States</country></aff></contrib><contrib contrib-type="editor"><name><surname>Stolk</surname><given-names>Arjen</given-names></name><role>Reviewing Editor</role><aff><institution>Donders Centre for Cognitive Neuroimaging</institution><country>Netherlands</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>22</day><month>01</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e51214</elocation-id><history><date date-type="received" iso-8601-date="2019-08-20"><day>20</day><month>08</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-01-22"><day>22</day><month>01</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Neymotin et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Neymotin et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-51214-v2.pdf"/><abstract><p>Magneto- and electro-encephalography (MEG/EEG) non-invasively record human brain activity with millisecond resolution providing reliable markers of healthy and disease states. Relating these macroscopic signals to underlying cellular- and circuit-level generators is a limitation that constrains using MEG/EEG to reveal novel principles of information processing or to translate findings into new therapies for neuropathology. To address this problem, we built Human Neocortical Neurosolver (HNN, <ext-link ext-link-type="uri" xlink:href="https://hnn.brown.edu">https://hnn.brown.edu</ext-link>) software. HNN has a graphical user interface designed to help researchers and clinicians interpret the neural origins of MEG/EEG. HNN’s core is a neocortical circuit model that accounts for biophysical origins of electrical currents generating MEG/EEG. Data can be directly compared to simulated signals and parameters easily manipulated to develop/test hypotheses on a signal’s origin. Tutorials teach users to simulate commonly measured signals, including event related potentials and brain rhythms. HNN’s ability to associate signals across scales makes it a unique tool for translational neuroscience research.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>Neurons carry information in the form of electrical signals. Each of these signals is too weak to detect on its own. But the combined signals from large groups of neurons can be detected using techniques called EEG and MEG. Sensors on or near the scalp detect changes in the electrical activity of groups of neurons from one millisecond to the next. These recordings can also reveal changes in brain activity due to disease.</p><p>But how do EEG/MEG signals relate to the activity of neural circuits? While neuroscientists can rarely record electrical activity from inside the human brain, it is much easier to do so in other animals. Computer models can then compare these recordings from animals to the signals in human EEG/MEG to infer how the activity of neural circuits is changing. But building and interpreting these models requires advanced skills in mathematics and programming, which not all researchers possess.</p><p>Neymotin et al. have therefore developed a user-friendly software platform that can help translate human EEG/MEG recordings into circuit-level activity. Known as the Human Neocortical Neurosolver, or HNN for short, the open-source tool enables users to develop and test hypotheses on the neural origin of EEG/MEG signals. The model simulates the electrical activity of cells in the outer layers of the human brain, the neocortex. By feeding human EEG/MEG data into the model, researchers can predict patterns of circuit-level activity that might have given rise to the EEG/MEG data. The HNN software includes tutorials and example datasets for commonly measured signals, including brain rhythms. It is free to use and can be installed on all major computer platforms or run online.</p><p>HNN will help researchers and clinicians who wish to identify the neural origins of EEG/MEG signals in the healthy or diseased brain. Likewise, it will be useful to researchers studying brain activity in animals, who want to know how their findings might relate to human EEG/MEG signals. As HNN is suitable for users without training in computational neuroscience, it offers an accessible tool for discoveries in translational neuroscience.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>computational modeling</kwd><kwd>MEG/EEG</kwd><kwd>event related potentials</kwd><kwd>brain rhythms</kwd><kwd>translational neuroscience</kwd><kwd>thalamocortical system</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000070</institution-id><institution>National Institute of Biomedical Imaging and Bioengineering</institution></institution-wrap></funding-source><award-id>BRAIN Award 5-R01-EB022889-02</award-id><principal-award-recipient><name><surname>Neymotin</surname><given-names>Samuel A</given-names></name><name><surname>Daniels</surname><given-names>Dylan S</given-names></name><name><surname>Caldwell</surname><given-names>Blake</given-names></name><name><surname>McDougal</surname><given-names>Robert A</given-names></name><name><surname>Carnevale</surname><given-names>Nicholas T</given-names></name><name><surname>Jas</surname><given-names>Mainak</given-names></name><name><surname>Moore</surname><given-names>Christopher I</given-names></name><name><surname>Hines</surname><given-names>Michael L</given-names></name><name><surname>Hämäläinen</surname><given-names>Matti</given-names></name><name><surname>Jones</surname><given-names>Stephanie R</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000070</institution-id><institution>National Institute of Biomedical Imaging and Bioengineering</institution></institution-wrap></funding-source><award-id>BRAIN Award Supplement R01EB022889-02S1</award-id><principal-award-recipient><name><surname>Neymotin</surname><given-names>Samuel A</given-names></name><name><surname>Daniels</surname><given-names>Dylan S</given-names></name><name><surname>Caldwell</surname><given-names>Blake</given-names></name><name><surname>McDougal</surname><given-names>Robert A</given-names></name><name><surname>Carnevale</surname><given-names>Nicholas T</given-names></name><name><surname>Jas</surname><given-names>Mainak</given-names></name><name><surname>Moore</surname><given-names>Christopher I</given-names></name><name><surname>Hines</surname><given-names>Michael L</given-names></name><name><surname>Hämäläinen</surname><given-names>Matti</given-names></name><name><surname>Jones</surname><given-names>Stephanie R</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000055</institution-id><institution>National Institute on Deafness and Other Communication Disorders</institution></institution-wrap></funding-source><award-id>5-R01DC012947-07</award-id><principal-award-recipient><name><surname>Neymotin</surname><given-names>Samuel A</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000183</institution-id><institution>Army Research Office</institution></institution-wrap></funding-source><award-id>W911NF-19-1-0402</award-id><principal-award-recipient><name><surname>Neymotin</surname><given-names>Samuel A</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication. The views and conclusions contained in this document are those of the authors and should not be interpreted as representing the official policies, either expressed or implied, of the Army Research Office or the U.S. Government. The U.S. Government is authorized to reproduce and distribute reprints for Government purposes notwithstanding any copyright notation herein.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Human Neocortical Neurosolver is a new user-friendly software tool for researchers to develop and test hypotheses on cellular/circuit origins of human MEG/EEG signals using a biophysical model.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Modern neuroscience is in the midst of a revolution in understanding the cellular and genetic substrates of healthy brain dynamics and disease due to advances in cellular- and circuit-level approaches in animal models, for example two-photon imaging and optogenetics. However, the translation of new discoveries to human neuroscience is significantly lacking (<xref ref-type="bibr" rid="bib2">Badre et al., 2015</xref>; <xref ref-type="bibr" rid="bib67">Sahin et al., 2018</xref>). To understand human disease, and more generally the human condition, we must study humans. To date, EEG and MEG are the only noninvasive methods to study electrical neural activity in humans with fine temporal resolution. Despite the fact that EEG/MEG provide biomarkers of almost all healthy and abnormal brain dynamics, these so called ‘macro-scale’ techniques suffer from difficulty in interpretability in terms of the underlying cellular- and circuit-level events. As such, there is a need for a translator that can bridge the ‘micro-scale’ animal data with the ‘macro-scale’ human recordings in a principled way. This is the ideal problem for computational neural modeling, where the model can have specificity at different scales.</p><p>To address this need, we developed the Human Neocortical Neurosolver (HNN), a modeling tool designed to provide researchers and clinicians an easy-to-use software platform to develop and test hypotheses regarding the neural origin of their data. The foundation of the HNN software is a neocortical model that accounts for the biophysical origin of macroscale extracranial EEG/MEG recordings with enough detail to translate to the underlying cellular- and network-level activity. HNN’s graphical user interface (GUI) provides users with an interactive tool to interpret the neural underpinnings of EEG/MEG data and changes in these signals with behavior or neuropathology.</p><p>HNN’s underlying model represents a canonical neocortical circuit based on generalizable features of cortical circuitry, with individual pyramidal neurons and interneurons arranged across the cortical layers, and layer-specific input pathways that relay spiking information from other parts of the brain, which are not explicitly modeled. Based on known electromagnetic biophysics underlying macroscale EEG/MEG signals (<xref ref-type="bibr" rid="bib42">Jones, 2015</xref>), the elementary current generators of EEG/MEG (current dipoles) are simulated from the intracellular current flow in the long and spatially-aligned pyramidal neuron dendrites (<xref ref-type="bibr" rid="bib29">Hämäläinen et al., 1993</xref>; <xref ref-type="bibr" rid="bib35">Ikeda et al., 2005</xref>; <xref ref-type="bibr" rid="bib42">Jones, 2015</xref>; <xref ref-type="bibr" rid="bib55">Murakami et al., 2003</xref>; <xref ref-type="bibr" rid="bib56">Murakami and Okada, 2006</xref>; <xref ref-type="bibr" rid="bib59">Okada et al., 1997</xref>). This unique construction produces equal units between the model output and source-localized data (ampere-meters, Am) allowing one-to-one comparison between model and data to guide interpretation.</p><p>The extracranial macroscale nature of EEG/MEG limits the space of signals that are typically observed and studied. The majority of studies focus on quantification of event related potentials (ERPs) and low-frequency brain rhythms (&lt;100 Hz), and there are commonalities in these signals across tasks and species (<xref ref-type="bibr" rid="bib13">Buzsáki et al., 2013</xref>; <xref ref-type="bibr" rid="bib73">Shin et al., 2017</xref>). HNN’s underlying mathematical model has been successfully applied to interpret the mechanisms and meaning of these common signals, including sensory evoked responses and oscillations in the alpha (7–14 Hz), beta (15–29 Hz) and gamma bands (30–80 Hz) (<xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>; <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>; <xref ref-type="bibr" rid="bib50">Lee and Jones, 2013</xref>; <xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>; <xref ref-type="bibr" rid="bib88">Ziegler et al., 2010</xref>), and changes with perception (<xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>) and aging (<xref ref-type="bibr" rid="bib88">Ziegler et al., 2010</xref>). The model has also been used to study the impact of non-invasive brain stimulation on circuit dynamics measured with EEG (<xref ref-type="bibr" rid="bib75">Sliva et al., 2018</xref>), and to constrain more reduced ‘neural mass models’ of laminar activity (<xref ref-type="bibr" rid="bib62">Pinotsis et al., 2017</xref>). In the clinical domain, HNN’s model has also been applied to study MEG-measured circuit deficits in autism (<xref ref-type="bibr" rid="bib45">Khan et al., 2015</xref>).</p><p>Despite these examples of use, the complexity of the original model and code hindered use by the general community. The innovation in the new HNN software is the construction of an intuitive graphical user interface to interact with the model without any coding. We offer several free and publicly-available resources to assist the broad EEG/MEG community in using the software and applying the model to their studies. These resources include an example workflow, several tutorials (based on the prior studies cited above) to study ERPs and oscillations, and community-sharing resources.</p><p>HNN’s GUI is designed so that researchers can simultaneously view the model's net current dipole output and microscale features (including layer-specific responses, individual cell spiking activity, and somatic voltages) in both the time and frequency domains. HNN is constructed to be a hypothesis development and testing tool to produce circuit-level predictions that can then be directly tested and informed by invasive recordings and/or other imaging modalities. This level of scalability provides a unique tool for translational neuroscience research.</p><p>In this paper, we outline biophysiological and physiological background information that is the basis of the development of HNN, give an overview of tutorials and available data and parameter sets to simulate ERPs and low-frequency oscillations in the alpha, beta, and gamma range, and describe current distribution and online resources (<ext-link ext-link-type="uri" xlink:href="https://hnn.brown.edu">https://hnn.brown.edu</ext-link>). We discuss the differences between HNN and other EEG/MEG modeling software packages, as well as limitations and future directions.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Background information on the generation of EEG/MEG signals and uniqueness of HNN</title><sec id="s2-1-1"><title>Primary currents and the relation to forward and inverse modeling</title><p>The concepts of electromagnetic biophysics are succinctly discussed, for example in <xref ref-type="bibr" rid="bib29">Hämäläinen et al. (1993)</xref> and <xref ref-type="bibr" rid="bib32">Hari and Ilmoniemi (1986)</xref>. Here, we briefly review the basic framework of forward and inverse modeling and how they relate to HNN (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of the biophysical origin of MEG/EEG signals and the relationship between HNN and forward/inverse modeling.</title><p>(<bold>A</bold>) HNN bridges the ‘macroscale’ extracranial EEG/MEG recordings to the underlying cellular- and circuit-level activity by simulating the primary electrical currents (J<sup>P</sup>) underlying EEG/MEG, which are generated by the postsynaptic, intracellular current flow in the long and spatially-aligned dendrites of a large population of synchronously-activated pyramidal neurons. (<bold>B</bold>) A zoomed in representation of the relationship between HNN and EEG/MEG forward and inverse modeling. Inverse modeling estimates the location, timecourse and orientation of the primary currents (J<sup>p</sup>), and HNN simulates the neural activity creating J<sup>p</sup>, at the microscopic scale. Adapted from <xref ref-type="bibr" rid="bib42">Jones (2015)</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig1-v2.tif"/></fig><p>MEG/EEG signals are created by electrical currents in the brain. The signals are recorded by sensors at least a centimeter from the actual current sources. Given this configuration, a macroscopic scale is employed for the distribution of electrical conductivity. The division between the actual non-ohmic equivalent current sources of activity and the passive ohmic currents is then referred to as primary (<bold>J</bold><sup>p</sup>) and volume currents (<bold>J</bold><sup>V</sup>), respectively. As depicted in <xref ref-type="fig" rid="fig1">Figure 1</xref>, both MEG and EEG are ultimately generated by the primary currents. The primary currents set up a potential distribution (V) that extends through the brain tissue, the cerebrospinal fluid (CSF), the skull, and the scalp, where it is measured as EEG; the passive <bold>J</bold><sup>V</sup> is proportional to the electric field (negative gradient of V) and electrical conductivity (σ). MEG, in general, is generated by both the <bold>J</bold><sup>p</sup> and <bold>J</bold><sup>v</sup>. The total current is the sum of <bold>J</bold><sup>p</sup> and <bold>J</bold><sup>v</sup>: <bold>J</bold> = <bold>J</bold><sup>p</sup> + <bold>J</bold><sup>v</sup>, whence <bold>J</bold><sup>p</sup> = <bold>J – J</bold><sup>v</sup> = <bold>J</bold> + σ∇V. In this definition, the conductivity is considered on a macroscopic scale, omitting the cellular level details. The primary current is the ‘battery’ of the circuit and is nonzero at the active sites in the brain. Furthermore, the direction of the primary current is determined by the cellular level geometry of the active cells. By locating the primary currents from MEG/EEG we locate the sites of activity.</p><p>The task of computing EEG and MEG given <bold>J</bold><sup>p</sup> is commonly called forward modeling, and it is governed by Maxwell’s equations. However, in the geometry of the head, the integral effect of the volume currents to the magnetic field can be relatively easily taken into account and, therefore, modeling of MEG is in general more straightforward than the precise calculation of the electric potentials measured in EEG. Specifically, a first order approximation, the spherically symmetric conductor model (<xref ref-type="bibr" rid="bib69">Sarvas, 1987</xref>), can often be used (<xref ref-type="bibr" rid="bib79">Tarkiainen et al., 2003</xref>). In this case, all components of the magnetic field can be computed from an analytical formula which is independent of the value of the electrical conductivity as a function of the distance from the center of the sphere (<xref ref-type="bibr" rid="bib69">Sarvas, 1987</xref>). In a more complex case with realistically shaped conductivity compartments, the skull and the scalp can be replaced by a perfect insulator (<xref ref-type="bibr" rid="bib30">Hämäläinen and Sarvas, 1987</xref>; <xref ref-type="bibr" rid="bib31">Hämäläinen and Sarvas, 1989</xref>).</p><p>The availability of these forward models opens up the possibility to estimate the locations (<bold>r</bold>) and time course of the primary current activity, <bold>J</bold><sup>p</sup> = <bold>J</bold><sup>p</sup>(<bold>r</bold>,t) from MEG and EEG sensor data, that is inverse modeling, or source estimation. However, this inverse problem is fundamentally ill-posed, and constraints are needed to render the problem unique. The different source estimation methods, such as current dipole fitting, minimum-norm estimates, sparse source estimation methods, and beamformer approaches, differ in their capability to approximate the extent of the source activity and in their localization accuracy; there are presently several open-source software packages for source estimation, for example <xref ref-type="bibr" rid="bib25">Gramfort et al. (2013)</xref>. All of these methods are capable of inferring both the location and direction of the neural currents and their time courses. Importantly, due to physiological considerations, the appropriate elementary primary current source in all of these methods is estimated as a <italic>current dipole,</italic> with units current x distance, that is Am (Ampere x meter).</p><p>Thanks to the consistent orientation of the apical dendrites of the pyramidal cells in the cortex this primary current is oriented normal to the cortical mantle and its direction corresponds to the intracellular current flow (<xref ref-type="bibr" rid="bib59">Okada et al., 1997</xref>; <xref ref-type="bibr" rid="bib35">Ikeda et al., 2005</xref>; <xref ref-type="bibr" rid="bib56">Murakami and Okada, 2006</xref>). When source estimation is used in combination with geometrical models of the cortex constructed from anatomical MRI, the current direction can be related to the direction of the outer normal of the cortex: one is thus able to tell whether the estimated current is flowing outwards or inwards at a particular cortical site at a particular point in time. As such, the direction of the current flow can be related to orientation of the pyramidal neuron apical dendrites and inferred as currents flow from soma to apical tuft (up the dendrites) or apical tuft to soma (down the dendrites), see <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p></sec><sec id="s2-1-2"><title>Inferring the neural origin of the primary currents with HNN</title><p>The focus of HNN is to study how <bold>J</bold><sup>p</sup> is generated by the assembly of neurons in the brain at the microscopic scale. Currently, the process of estimating the primary current sources with inverse methods, or calculating the forward solution from <bold>J</bold><sup>p</sup> to the measured sensor level signal, is separate from HNN. A future direction is to integrate the top-down source estimation software with our bottom-up HNN model for all-in-one source estimation and circuit interpretation (see Discussion).</p><p>HNN’s underlying neural model contains elements that can simulate the primary current dipoles (<bold>J</bold><sup>p</sup>) creating EEG/MEG signals in a biophysically principled manner (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Specifically, HNN simulates the primary current from a canonical model of a layered neocortical column via the net intracellular electrical current flow in the pyramidal neuron dendrites in a direction parallel to the apical dendrites (see red arrow in <xref ref-type="fig" rid="fig1">Figures 1</xref> and <xref ref-type="fig" rid="fig2">2</xref>, and further discussion in Materials and methods) (<xref ref-type="bibr" rid="bib29">Hämäläinen et al., 1993</xref>; <xref ref-type="bibr" rid="bib35">Ikeda et al., 2005</xref>; <xref ref-type="bibr" rid="bib42">Jones, 2015</xref>; <xref ref-type="bibr" rid="bib55">Murakami et al., 2003</xref>; <xref ref-type="bibr" rid="bib56">Murakami and Okada, 2006</xref>; <xref ref-type="bibr" rid="bib59">Okada et al., 1997</xref>). With this construction, the units of measure produced by the model are the same as those estimated from source localization methods, namely, ampere-meters (Am), enabling one-to-one comparison of results. This construction is unique compared to other EEG/MEG modeling software (see Discussion). A necessary step in comparing model results with source-localized signals is an understanding of the direction of the estimated net current in or out of the cortex, which corresponds to current flow down or up the pyramidal neuron dendrites, respectively, as discussed above. Estimation of current flow orientation at any point in time is an option in most inverse solution software that helps guide the neural interpretation, as does prior knowledge of the relay of sensory information in the cortex, see further discussion in the Tutorials part of the Results section.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>A schematic illustration of a canonical patch of neocortex that is represented by HNN’s underlying neural model.</title><p>(Left) 3D visualization of HNN’s model (pyramidal neurons drawn in blue, interneurons drawn in orange. (Right) Commonly measured EEG/MEG signals (ERPs and low frequency rhythms) from a single brain area that can be studied with HNN.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig2-v2.tif"/></fig><p>By keeping model output in close agreement with the data, HNN’s underlying model has led to new and generative predictions on the origin of sensory evoked responses and low-frequency rhythms, and on the changes in these signals across experimental conditions (<xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>; <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>; <xref ref-type="bibr" rid="bib45">Khan et al., 2015</xref>; <xref ref-type="bibr" rid="bib50">Lee and Jones, 2013</xref>; <xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>; <xref ref-type="bibr" rid="bib75">Sliva et al., 2018</xref>; <xref ref-type="bibr" rid="bib88">Ziegler et al., 2010</xref>) described further below. The macro- to micro-scale nature of the HNN software is designed to develop and test hypotheses that can be directly validated with invasive recordings or other imaging modalities (see further discussion in tutorial on alpha and beta rhythms).</p><p>HNN is currently constructed to dissect the cell and network contributions to signals from one source-localized region of interest. Specifically, the HNN GUI is designed to simulate sensory evoked responses and low-frequency brain rhythms from a single region, based on the local network dynamics and the layer-specific thalamo-cortical and cortico-cortical inputs that contribute to the local activity. As such, HNN’s underlying neocortical network represents a scalable patch of neocortex containing canonical features of neocortical circuitry (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Ongoing expansions will include the ability to import other user-defined cell types and circuit models into HNN, simulate LFP and sensor level signals, as well as the the interactions among multiple neocortical areas (see Discussion). Of note, users can still benefit from our software if they are working with data directly from EEG/MEG sensor rather than source-localized signals. The primary currents are the foundation of the sensor signal and, as such, can have similar activity profiles (e.g., compare source-localized tactile evoked response in Figure 4 and sensor-level response in Figure 5).</p></sec></sec><sec id="s2-2"><title>Overview of HNN’s default canonical neocortical column template network</title><sec id="s2-2-1"><title>Neocortical column structure</title><p>Here, we give an overview of the main features that are important to understand in order to begin exploring the origin of macroscale evoked responses and brain rhythms, and we provide details on how these features are implemented in HNN’s template model. Further details can be found in the Materials and methods section, in our prior publications (e.g., <xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>), and on our website <ext-link ext-link-type="uri" xlink:href="https://hnn.brown.edu">https://hnn.brown.edu</ext-link>.</p><p>Given that the primary electrical current that generates EEG/MEG signals comes from synchronous activity in pyramidal neuron (PN) dendrites across a large population, there are several key features of neocortical circuitry that are essential to consider when simulating these currents. While there are known differences in microscale circuitry across cortical areas and species, many features of neocortical circuits are remarkably similar. We assume these conserved features are minimally sufficient to account for the generation of evoked responses and brain rhythms measured with EEG/MEG, and we have harnessed this generalization into HNN’s foundational model, with success in simulating many of these signals using the same template model (see Introduction). These canonical features include:</p><p>(I) A 3-layered structure with pyramidal neurons in the supragranular and infragranular layers whose dendrites span across the layers and are synaptically coupled to inhibitory interneurons in a 3-to-1 ratio of pyramidal to inhibitory cells (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Of note, cells in the granular layer are not explicitly included in the template circuit. This initial design choice was based on the fact that macroscale current dipoles are dominated by PN activity in supragranular and infragranular layers. Thalamic input to granular layers is presumed to propagate directly to basal and oblique dendrites of PN in the supragranular and infragranular layers. In the model, the thalamic input synapses directly onto these dendrites.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Schematic illustrations of HNN’s underlying neocortical network model.</title><p>(<bold>A</bold>) Local Network Connectivity: GABAergic (GABAA/GABAB; lines) and glutamatergic (AMPA/NMDA; circles) synaptic connectivity between single-compartment inhibitory neurons (orange circles) and multi-compartment layer 2/3 and layer five pyramidal neurons (blue neurons). Excitatory to excitatory connections not shown, see Materials and methods. (<bold>B</bold>) Exogenous proximal drive representing lemniscal thalamic drive to cortex. User defined trains or bursts of action potentials (see tutorials described in text) are simulated and activate post-synaptic excitatory synapses on the basal and oblique dendrites of layer 2/3 and layer five pyramidal neurons as well as the somata of layer 2/3 and layer five interneurons. These excitatory synaptic inputs drive current flow up the dendrites towards supragranular layers (red arrows). (<bold>C</bold>) Exogenous distal drive representing cortical-cortical inputs or non-lemniscal thalamic drive that synapses directly into the supragranular layer. User defined trains of action potentials are simulated and activate post-synaptic excitatory synapses on the distal apical dendrites of layer 5 and layer 2/3 pyramidal neurons as well as the somata of layer 2/3 interneurons. These excitatory synaptic inputs push the current flow down towards the infragranular layers (green arrows). (<bold>D</bold>) The full network contains a scalable number of pyramidal neurons in layer 2/3 and layer 5 in a 3-to-1 ratio with inhibitory interneurons, activated by user defined layer specific proximal and distal drive (see Materials and methods for full details).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig3-v2.tif"/></fig><p>The number of cells in the network is adjustable in the Local Network Parameters window via the Cells tab, while maintaining at 3-to-1 pyramidal to inhibitory interneuron ratio in each layer. The connectivity pattern is fixed, but the synaptic weights between cell types can be adjusted in the Local Network menu and the Synaptic Gains menu. Macroscale EEG/MEG signals are generated by the synchronous activity in large populations of PN neurons. Evoked responses are typically on the order of 10 – 100nAm, and are estimated to be generated by the synchronous spiking activity of the order of tens of thousands of pyramidal neurons. Low-frequency oscillations are larger in magnitude and are on the order of 100–1000 nAm, and are estimated to be generated by the subthreshold activity of on the order of a million pyramidal neurons (<xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>; <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>; <xref ref-type="bibr" rid="bib56">Murakami and Okada, 2006</xref>). While HNN is constructed with the ability to adjust local network size, the magnitude of these signals can also be conveniently matched by applying a scaling factor to the model output, providing an estimate of the number of neurons that contributed to the signal.</p><p>(II) Exogenous driving input through two known layer-specific pathways. One type of input represents excitatory synaptic drive that comes from the lemniscal thalamus and contacts the cortex in the granular layers, which then propagates to the proximal PN dendrites in the supragranular and infragranular layers and somata of the inhibitory neurons; this input is referred to as proximal drive (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). The other input represents excitatory synaptic drive from higher-order cortex or non-specific thalamic nuclei that synapses directly into the supragranular layers and contacts the distal PN dendrites and somata of the inhibitory neuron; this input is referred to as distal drive (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). The networks that provide proximal and distal input to the local circuit (e.g., thalamus and higher order cortex) are not explicitly modelled, but rather these inputs are represented by simulated trains of action potentials that activate excitatory post-synaptic receptors in the local network. The temporal profile of these action potentials is adjustable depending on the simulation experiment and can be represented as single spikes, bursts of input, or rhythmic bursts of input. There are several ways to change the pattern of action potential drive through different buttons built into the HNN GUI: Evoked Inputs, Rhythmic Proximal Inputs, and Rhythmic Distal Inputs. The dialog boxes that open with these buttons allow creation and adjustment of patterns of evoked response drive or rhythmic drive to the network (see tutorials described in Results section for further details).</p><p>(III) Exogenous drive to the network can also be generated as excitatory synaptic drives following a Poisson process to the somata of chosen cell classes or as tonic input simulated as a somatic current clamp with a fixed current injection. The timing and duration of these drives is adjustable.</p><p>Further details of the biophysics and morphology of the cells and of the architecture of the local synaptic connectivity profiles in the template network can be found in the Materials and methods section. As the use of our software grows, we anticipate other cells and network configurations will be made available as template models to work with via open source sharing (see Discussion).</p></sec><sec id="s2-2-2"><title>Parameter tuning in HNN’s template network model</title><p>HNN’s template model is a large-scale model simulated with thousands of differential equations and parameters, making the parameter optimization process challenging. The process for tuning this canonical model and constraining the space of parameters to investigate the origin of ERPs and low-frequency oscillations was as follows. First, the individual cell morphologies and physiologies were constrained so individual cells produced realistic spiking patterns to somatic injected current (detailed in Materials and methods). Second, the local connectivity within and among cortical layers was constructed based on a large body of literature from animal studies (detailed in Materials and methods). All of these equations and parameters were then fixed, and the only parameters that were originally tuned to simulate ERPs and oscillations were the timing and the strength of the exogenous drive to the local network. This drive represented our ‘simulation experiment’ and was based on our hypotheses on the origin of these signals motivated by literature and on matching model output to features of the data (see tutorials described in Results). The HNN GUI was constructed assuming ERPs and low-frequency oscillations depend on layer-specific exogenous drives to the network. The simulation experiment workflow and tutorials described below are in large part based on ‘activating the network’ by defining the characteristics of this layer-specific drive. Default parameter sets are provided as a starting point from which the underlying parameters can be interactively manipulated using the GUI, and additional exogenous driving inputs can be created or removed.</p><p>Automated parameter optimization is also available in HNN and is specifically designed to accurately reproduce features of an ERP waveform based on the temporal spacing and strength of the exogenous driving inputs assumed to generate the ERP. Before taking advantage of HNN’s automated parameter optimization, we strongly encourage users to begin by understanding our ERP tutorial and by hand-tuning parameters using one of our default parameter sets to get an initial representation of the recorded data. The identification of an appropriate number of driving inputs and their approximate timings and strengths serves as a starting point for the optimization procedure (described in the ERP Model Optimization section below). Hand tuning of parameters and visualizing the resultant changes in the GUI will enable users to understand how specific parameter changes impact features of the current dipole waveform.</p><p>Importantly, the biophysical constraints on the origin of the current dipoles signal (discussed above) will dictate the output of the model and necessarily limit the space of parameter adjustments that can accurately account for the recorded data. The same principle underlies the fact that a limited space of signals are typically studied at the macroscale (ERPs and low-frequency oscillations). A parameter sensitivity analysis on perturbations around the default ERP parameter sets confirmed that a subset of the parameters have the strongest influence on features of the ERP waveform (see Supplementary Materials). Insights from GUI-interactive hand tuning and sensitivity analyses can help narrow the number of parameters to include in the subsequent optimization procedure and greatly decrease the number of simulations required for optimization.</p></sec></sec><sec id="s2-3"><title>HNN GUI overview and interactive simulation experiment workflow</title><p>The HNN GUI is designed to allow researchers to link macro-scale EEG/MEG recordings to the underlying cellular- and network-level generators. Currently available visualizations include a direct comparison of simulated electrical sources to recorded data with calculated goodness of fit estimates, layer-specific current dipole activity, individual cell spiking activity, and individual cell somatic voltages (<xref ref-type="fig" rid="fig4">Figure 4B–D</xref>). Results can be visualized in both the time and frequency domain. Based on its biophysically detailed design, the output of HNN’s model and recorded source-localized data have the same units of measure (Am). By closely matching the output of the model to recorded data in an interactive manner, users can test and develop hypotheses on the cell and network origin of their signals.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>An example workflow showing how HNN can be used to link the macroscale current dipole signal to the underlying cell and circuit activity.</title><p>The example shown is for a perceptual threshold level tactile evoked response (50% detected) from SI (<xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>; see ERP Tutorial text for details). (<bold>A</bold>) Steps 1 and 2: load data and define the local network structure. (<bold>B</bold>) Step 3: activate the local network, starting with a predefined parameter set; shown here for the parameter set for perceptual threshold-level evoked response (ERPYes100Trials.param) (<bold>C</bold>) Step 3 and 4: adjust the evoked input parameters according to user defined hypotheses and simulation experiment, and run the simulation. (<bold>D</bold>) Step 5: visualize model output; the net current dipole will be displayed in the main GUI window and microcircuit details, including layer-specific responses, cell membrane voltages, and spiking profiles (<bold>E and F</bold>) are shown by choosing them from the View pull down menu. Parameters can be adjusted to hypothesized circuit changes under different experimental conditions (e.g. see <xref ref-type="fig" rid="fig5">Figure 5</xref>).</p><p> <supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Average S1 ERP from detected threshold-level stimulus.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-51214-fig4-data1-v2.txt"/></supplementary-material> </p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Sensitivity analysis results of the perceptual threshold level evoked response example showing the relative contribution of each input’s parameters on variance.</title><p>Total Sobol indices at each point have been weighted by the std. deviation scaled from 0 to 1.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig4-figsupp1-v2.tif"/></fig></fig-group><p>The process for simulating evoked responses or brain rhythms from a single region of interest is to first define the network structure and then to ‘activate’ the network with exogenous driving input based on your hypotheses and simulation experiment. HNN’s template model provides the initial network structure. The choice of ‘activation’ to the network depends on the simulation experiment. The GUI design is motivated by our prior published studies and was built specifically to simulate sensory evoked responses, spontaneous rhythms, or a combination of the two (<xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>; <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>; <xref ref-type="bibr" rid="bib45">Khan et al., 2015</xref>; <xref ref-type="bibr" rid="bib50">Lee and Jones, 2013</xref>; <xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>; <xref ref-type="bibr" rid="bib75">Sliva et al., 2018</xref>; <xref ref-type="bibr" rid="bib88">Ziegler et al., 2010</xref>). The tutorials described in the Results section below detail examples of how to ‘activate’ the network to simulate sensory evoked responses and spontaneous rhythms. Here, we outline a typical simulation experiment workflow.</p><p>In practice, users apply the following interactive workflow, as in <xref ref-type="fig" rid="fig4">Figure 4</xref> and detailed further in the tutorials with an example tactile evoked response from somatosensory cortex (data from <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>).</p><p>(Step 1) Load EEG/MEG data (<italic>blue</italic>). (Step one is optional.)</p><p>(Step 2) Define the cortical column network structure. The default template network is automatically loaded when HNN starts. Default parameters describing the local network can be adjusted by clicking the Set Parameters button on the GUI and then Local Network Parameters, or directly from the Local Network Parameters button on the GUI (<xref ref-type="fig" rid="fig4">Figure 4A</xref>).</p><p>(Step 3) ‘Activate’ the local network by defining layer-specific, exogenous driving inputs (<xref ref-type="fig" rid="fig3">Figure 3B,C</xref>). The drive represents input to the local circuit from thalamus and/or other cortical areas and can be in the form of (i) spike trains (single spikes or bursts of rhythmic input) that activate post-synaptic targets in the local network, (ii) current clamps (tonic drive), or (iii) noisy (Poisson) synaptic drive. The choice of input parameters depends on your hypotheses and ‘simulation experiment’. In the example simulation, predefined evoked response parameters were loaded in via the Set Parameters From File button and choosing the file ‘ERPYes100Trials.param’; this is also the default evoked response parameter set loaded when starting HNN (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). The Evoked Input parameters are then viewed in the Set Parameters dialog box under Evoked Inputs (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). The Evoked Inputs parameters are described further in the tutorials below.</p><p>(Step 4) Run simulation and directly compare model output (<italic>black</italic>) and data (<italic>purple</italic>) with goodness of fit calculations (root mean squared error, RMSE, between data and averaged simulation) (<xref ref-type="fig" rid="fig4">Figure 4D</xref>).</p><p>(Step 5) Visualize microcircuit details, including layer-specific responses, cell membrane voltages, and spiking profiles by choosing from the View pull down menu (<xref ref-type="fig" rid="fig4">Figure 4D,E,F</xref>).</p><p>(Step 6) Adjust parameters through the Set Parameters dialog box to develop and test predictions on the circuit mechanisms that provide the best fit to the data. With any parameter adjustment, the change in the dipole signal can be viewed and compared with the prior simulation to infer how specific parameters impact the current dipole waveform. Prior simulations can be maintained in the GUI or removed. For ERPs, automatic parameter optimization can be iteratively applied to tune the parameters of the exogenous driving inputs to find those that provide the best initial fit between the simulated dipole waveform and the EEG/MEG data (see further details below).</p><p>(Step 7) To infer circuit differences across experimental conditions, once a fit to one condition is found, adjustments to relevant cell and network parameters can be made (guided by user-defined hypotheses), and the simulation can be re-run to see if predicted changes account for the observed differences in the data A list of the GUI-adjustable parameters in the model can be found in the ‘Tour of the GUI’ section of the tutorials on our website. HNN’s GUI was designed so that users could easily find the adjustable parameters from buttons and pull down menus on the main GUI leading to dialogue boxes with explanatory labels.</p><p>As a specific example on how to use HNN as a hypothesis testing tool, we have used HNN to evaluate hypothesized changes in EEG-measured neural circuit dynamics with non-invasive brain stimulation (<xref ref-type="fig" rid="fig5">Figure 5</xref>). We measured somatosensory evoked responses from brief threshold-level taps to the middle finger tip before and after 10 min of ~10 Hz transcranial alternating current stimulation (tACS) over contralateral somatosensory cortex (see <xref ref-type="bibr" rid="bib75">Sliva et al., 2018</xref> for details). The magnitude of an early peak near ~70 ms in the tactile evoked response increased after the tACS session (<xref ref-type="fig" rid="fig5">Figure 5</xref>, top left). Based on prior literature, we hypothesized that the observed difference was due to changes in synaptic efficacy in the local network induced by the tACS (<xref ref-type="bibr" rid="bib49">Kronberg et al., 2017</xref>; <xref ref-type="bibr" rid="bib65">Rahman et al., 2017</xref>). To test this hypothesis, we first used HNN to simulate the pre-tACS evoked responses, following the evoked response tutorial in our software (see Tutorial below). Once the pre-tACS condition was accounted for, we then adjusted the synaptic gain between the excitatory and inhibitory cells in the network using the HNN GUI and re-simulated the tactile evoked responses. We tested several possible gain changes between the populations. HNN showed that a two-fold increase in synaptic strength of the inhibitory connections, as opposed to an increase in the excitatory connections or in total synaptic efficacy, could best account for the observed differences in the data (compare blue in red curves in <xref ref-type="fig" rid="fig5">Figure 5</xref>). By viewing the cell spiking profiles in each condition (<xref ref-type="fig" rid="fig5">Figure 5</xref>, bottom right), HNN further predicted that the increase in the magnitude of the ~70 ms peak coincided with increased firing in the inhibitory neuron population and decreased firing in the excitatory pyramidal neurons in the post-tACS compared to the pre-tACS window. These detailed predictions can guide further experiments and follow-up testing in animal models or with other human imaging experiments. Follow up testing of model derived predictions is described further in the alpha/beta tutorial below.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Application of HNN to test alternative hypotheses on the circuit level impact of tACS on the somatosensory tactile evoked response (adapted from <xref ref-type="bibr" rid="bib75">Sliva et al., 2018</xref>).</title><p>(<bold>A</bold>) The early tactile evoked response from above somatosensory cortex before and after 10 min of 10 Hz alternating current stimulation over SI shows that the ~70 ms peak is more prominent in the post-tACS condition. Note that the timing of this peak in the sensor level signal is analogous to the 70 ms peak in the source localized signal in <xref ref-type="fig" rid="fig4">Figure 4B</xref>, since the tactile stimulation was the same in both studies and the early signal from SI is similar both at the source and sensor level. (<bold>B</bold>) HNN was applied to investigate the impact of several possible tACS induced changes in local synaptic efficacy and identify which could account for the observed evoked response data. The parameters in HNN were first adjusted to account for the pre-tACS response using the default HNN parameter set (solid blue line). The synaptic gains between the different cell types was then adjusted through the Set Parameters dialog box to predict that 2x gain in the local inhibitory synaptic weights best accounted for the post-tACS evoked response. (<bold>C</bold>) Simultaneous viewing of the cell spiking activity further predicted that there is less pyramidal neuron spiking at 70 ms post-tACS, despite the more prominent 70 ms current dipole peak.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig5-v2.tif"/></fig></sec><sec id="s2-4"><title>Tutorials on ERPs and low-frequency oscillations</title><p>HNN’s tutorials are designed to teach users how to simulate the most commonly studied EEG/MEG signals, including sensory evoked responses and low-frequency oscillations (alpha, beta, and gamma rhythms) by walking users through the workflow we applied in our prior studies of these signals. The data and parameter sets used in these studies are distributed with the software, and the interactive GUI design was motivated by this workflow. In completing each tutorial, users will have a sense of the basic structure of the GUI and the process for manipulating relevant parameters and viewing results. From there, users can begin to develop and test hypotheses on the origin of their own data. Below we give a basic overview of each tutorial. The HNN website (<ext-link ext-link-type="uri" xlink:href="https://hnn.brown.edu">https://hnn.brown.edu</ext-link>) provides additional information and example exercises for further exploration.</p><sec id="s2-4-1"><title>Sensory evoked responses</title><p>We have applied HNN to study the neural origin of tactile evoked responses localized with inverse methods to primary somatosensory cortex from MEG data (<xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>). In this study, the tactile evoked response was elicited from a brief perceptual threshold level tap - stimulus strength maintained at 50% detection - to the contralateral middle finger tip during a tactile detection experiment (experimental details in <xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref> and <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>). The average tactile evoked response during detected trials is shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>. The data from this study is distributed with HNN installation.</p><p>Following the workflow described above, the process for reproducing these results in HNN is as follows.</p></sec><sec id="s2-4-2"><title>Steps 1 and 2</title><p>Load the evoked response data distributed with HNN, ‘yes_trial_SI_ERP_all_avg.txt’. The data shown in <xref ref-type="fig" rid="fig4">Figure 4B</xref> will be displayed. Adjust parameters defining the automatically loaded default local network, if desired.</p></sec><sec id="s2-4-3"><title>Step 3</title><p>‘Activate’ the local network. In prior publications, we showed that this tactile evoked response could be reproduced in HNN by ‘activating’ the network with a sequence of layer-specific proximal and distal spike train drive to the local network, which is distributed with HNN in the file ‘ERPYes100Trials.param’.</p><p>The sequence described below was motivated by intracranial recordings in non-human primates, which guided the initial hypothesis testing in the model. Additionally, we established with inverse methods that at the prominent ~70 ms negative peak (<xref ref-type="fig" rid="fig4">Figure 4D</xref>), the orientation of the current was into the cortex (e.g., down the pyramidal neuron dendrites), consistent with prior intracranial recordings (see <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>). As such, in this example, negative current dipole values correspond to current flow down the dendrites, and positive values up the dendrites. In sensory cortex, the earliest evoked response peak corresponds to excitatory synaptic input from the lemniscal thalamus that leads to current flow out of the cortex (e.g., up the dendrites). This earliest evoked response in somatosensory cortex occurs at ~25 ms. The corresponding current dipole positive peak is small for the threshold tactile response in <xref ref-type="fig" rid="fig4">Figure 4D</xref>, but clearly visible in Figure 11 for a suprathreshold (100% detection) level tactile response.</p><p>The drive sequence that accurately reproduced the tactile evoked response consisted of ‘feedforward’/proximal input at ~25 ms post stimulus, followed by ‘feedback’/distal input at ~60 ms, followed by a subsequent ‘feedforward’/proximal input at ~125 ms (Gaussian distribution of input times on each simulated trial, <xref ref-type="fig" rid="fig4">Figure 4C</xref>). This ‘activation’ of the network generated spiking activity and a pattern of intracellular dendritic current flow in the pyramidal neuron dendrites in the local network to reproduce the current dipole waveform, many features of which fell naturally out of the local network dynamics (details in <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>). This sequence can be interpreted as initial ‘feedforward’ input from the lemniscal thalamus followed by ‘feedback’ input from higher-order cortex or non-lemniscal thalamus, followed by a re-emergent leminsical thalamic drive. A similar sequence of information flow likely applies to most sensory evoked signals. The inputs are distinguished with red and green arrows (corresponding to proximal and distal input, respectively) in the main GUI window. The number, timing, and strength (post-synaptic conductance) of the driving spikes were manually adjusted in the model until a close representation of the data was found (see section on parameter tuning above). To account for some variability across trials, the exact time of the driving spikes for each input was chosen from a Gaussian distribution with a mean and standard deviation (see Evoked Inputs dialog box, <xref ref-type="fig" rid="fig4">Figure 4C</xref>, and green and red histograms on the top of the GUI in <xref ref-type="fig" rid="fig4">Figure 4D</xref>). The gray curves in <xref ref-type="fig" rid="fig4">Figure 4D</xref> show 25 trials of the simulation (decreased from 100 trials in the Set Parameters, Run dialog box) and the black curve is the average across simulations. The top of the GUI windows displays histograms of the temporal profile of the spiking activity providing the sequence of proximal (red) and distal (green) synaptic input to the local network across the 25 trials. Note, a scaling factor was applied to net dipole output to match to the magnitude of the recorded ERP data and used to predict the number of neurons contributing to the recorded ERP. This scaling factor is chosen from Set Parameters, Run dialog box, and is shown as 3000 on the y-axis of the main GUI window in <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Note that the scaling factor is used to predict the number of pyramidal neurons contributing to the observed signal. In this case, since there are 100 pyramidal neurons in each of layers 2/3 and 5, that amounts to 600,000 neurons (200 neurons x 3000 scaling factor) contributing to the evoked response, consistent with the experimental literature (described in <xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref> and <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>).</p><p>Based on the assumption that sensory evoked responses will be generated by a layer-specific sequence of drive to the local network similar to that described above, HNN’s GUI was designed for users to begin simulating evoked responses by starting with the aforementioned default sequence of drive that is defined when starting HNN and by loading in the parameter set from the ‘ERPYes100Trials.param’ file, as described above. The Evoked Inputs dialog box (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) shows the parameters of the proximal and distal drive (number, timing, and strength) used to produce the evoked response in <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Here, there were two proximal drives and one distal drive to the network. These parameters were found by first hand tuning the inputs to get a close representation of the data and then running the parameter optimization procedure described below.</p></sec><sec id="s2-4-4"><title>Step 4</title><p>The evoked response shown in <xref ref-type="fig" rid="fig4">Figure 4</xref> is reproduced by clicking the ‘Run Simulation’ button at the top of the GUI, and the RMSE of the goodness of fit to the data is automatically calculated and displayed. Additional network features can also be visualized through pull down menus (Step 5).</p><p>Evoked response parameters can now be adjusted, and additional inputs can be created or removed to account for the user-defined ‘simulation experiment’ and hypothesis testing goals (Step 6). With each parameter change, a new parameter file will be saved by renaming the simulation under ‘Simulation Name’ in the ‘Set Parameters’ dialog box (see <xref ref-type="fig" rid="fig4">Figure 4C</xref>). From here, other cell or network parameters can be adjusted to compare across conditions (Step 7).</p></sec><sec id="s2-4-5"><title>Alpha and beta rhythms</title><p>We have applied HNN to study the neural origin of spontaneous rhythms localized to the primary somatosensory cortex from MEG data; it is often referred to as the mu-rhythm, and it contains a complex of (7–14 Hz) alpha and (15–29 Hz) beta frequency components (<xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>). A 1 s time frequency spectrogram of the spontaneous unaveraged SI rhythm from this study is shown in <xref ref-type="fig" rid="fig6">Figure 6a</xref>. This data is distributed on the HNN website (‘SI_ongoing.txt’), and contains 1000 1 s epochs of spontaneous data (100 trials each from 10 subjects). The data is plotted in HNN through the ‘View → View Spectrograms’ menu item, followed by ‘Load Data’ and then selecting the ‘SI_ongoing.txt’ file. Note that it may take a few minutes to calculate the wavelet transforms for all 1000 1 s trials included. Next, select an individual trial (e.g. trial 32) from the drop-down menu. The dipole waveform from a single 1 s epoch will then be shown in the top.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Example spontaneous data from a current dipole source in SI showing transient alpha (~7–14 Hz Hz) and beta (~15–29 Hz) components (data as in <xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>).</title><p>The data file (‘SI_ongoing.txt’) used to generate these outputs is provided with HNN and plotted through the ‘View → View Spectrograms’ menu item, followed by ‘Load Data’, and then selecting the file. (<bold>A</bold>) The spectrogram viewer with the default ‘jet’ colormap. (<bold>B</bold>) The configuration option to change the colormap to other perceptually uniform colormaps, where the lightness value increases monotonically. (<bold>C</bold>) The spectrogram viewer updated with the perceptually uniform ‘viridis’ colormap.</p><p> <supplementary-material id="fig6sdata1"><label>Figure 6—source data 1.</label><caption><title>S1 pre-stimulus activity.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-51214-fig6-data1-v2.txt"/></supplementary-material> </p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig6-v2.tif"/></fig><p>The corresponding time-frequency spectrogram is automatically calculated and displayed at the bottom, as seen in <xref ref-type="fig" rid="fig6">Figure 6A</xref>. The default colormap indicating spectral power is the ‘jet’ scheme with blue representing low power and red representing high power. This is the same colormap used in the spectrograms of prior publications using the HNN model for studying low-frequency oscillations. However, HNN allows the user to plot the spectrogram using different standardized colormaps that are perceptually uniform, meaning they have a lightness value that increases monotonically (<xref ref-type="bibr" rid="bib61">Pauli, 1976</xref>). The configuration option for changing the colormap and the colormap options are shown in <xref ref-type="fig" rid="fig6">Figure 6B</xref>. The spectrogram resulting from choosing the perceptually uniform ‘viridis’ colormap is shown in <xref ref-type="fig" rid="fig7">Figure 7C</xref>. Note that updating the spectrogram colormap requires repeating the ‘View → View Spectrograms’ menu selection.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>An example workflow for simulating alpha frequency rhythm (<xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>; <xref ref-type="bibr" rid="bib88">Ziegler et al., 2010</xref>; see Alpha and Beta Rhythms Tutorial text for details).</title><p>(<bold>A</bold>) Here we are using the default HNN network configuration and not directly comparing the waveform to data, so begin with Step 3: activate the local network. Motivated by prior studies (see text), in this example alpha rhythms were simulated by driving the network with ~10 Hz bursts (presumed to be generated by thalamus) to the local network through proximal and distal projection pathways. The parameter set describing these burst is provided in the Alpha.param file and loaded through the Set Parameters From File button. Adjustable burst drive parameter are shown and here were set with a 50 ms delay between the ~10 proximal and distal drive (red boxes). (<bold>B</bold>) Step 4: running the simulation with the ‘Run Simulation’ button, shows that a continuous alpha rhythm emerged in the current dipole signal (middle dipole time trace; bottom time-frequency representation). Green and red histograms at the top display the defined distal and proximal burst drive patterns, respectively. (<bold>C</bold>) Step 5: additional network features, including layer specific power spectral density plots as shown can be visualized through the ‘View’ pull down menu, and compared to data (here compared to the spontaneous SI data shown in <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Features of the burst drive can be adjusted (panel A) and corresponding changes in the current dipole signals studied (Steps 6 and 7, see <xref ref-type="fig" rid="fig8">Figure 8</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig7-v2.tif"/></fig><p>Notice that this rhythm contains brief bouts of alpha or beta activity that will occur at different times in different trials due to the spontaneous, non-stationary nature of the signals. Such non-time-locked oscillations are often referred to as spontaneous and/or ‘induced’ rhythms. When the non-negative spectrograms are averaged across trials, the intermittent bouts of high power alpha and beta activity accumulate without cancellation, and bands of alpha and beta activity appear continuous in the spectrogram (data not shown, see <xref ref-type="bibr" rid="bib43">Jones, 2016</xref>; <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>) and will create peaks at alpha and beta in a power spectral density (<xref ref-type="fig" rid="fig8">Figure 8C</xref>). Since the alpha and beta components of this rhythm are not time locked across trials, it is difficult to directly compare the waveform of the recorded data with model output. Rather, to assess the goodness of fit of the model, we compared features of the simulated rhythm to the data (see <xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>), including peaks in the power spectral density, as described below. Since we can not directly compare the waveform of this rhythm with the model output, rather than first loading the data, we begin this tutorial with Step 3, ‘activating’ the network, using the default local network defined when starting HNN.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>An example workflow for simulating transient alpha and beta frequency rhythm as in the spontaneous SI rhythms shown in <xref ref-type="fig" rid="fig6">Figure 6A</xref> (<xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>; <xref ref-type="bibr" rid="bib88">Ziegler et al., 2010</xref>; see Alpha and Beta Rhythms Tutorial text for details).</title><p>(<bold>A</bold>) Here we are using the default HNN network configuration and not directly comparing the waveform to data, so begin with Step 3: activate the local network. In this example, a beta component emerged when the parameters of two ~ 10 Hz bursts to the local network through proximal and distal project pathways, as described in <xref ref-type="fig" rid="fig7">Figure 7</xref>, were adjusted so that on average they arrived to the network at the same time (see red boxes). This parameter set is provided in the ‘AlphaAndBeta.params’ file. (<bold>B</bold>) Step 4: running the simulation with the ‘Run Simulation’ button, shows that intermittent and transient alpha and beta rhythms emerge in the current dipole signal (middle dipole time trace; bottom time-frequency representation). Green and red histograms at the top display the defined distal and proximal burst drive patterns, respectively. Due to the stochastic nature of the bursts, on some cycles of the drive, the distal burst was simultaneous with the proximal burst and strong enough to push current flow down the dendrites to create a beta event (see red box). This model derived prediction reproduced several features of the data, including alpha and beta peaks in the corresponding PSD that were more closely matched to the recorded data (<bold>C</bold>). Model predictions were subsequently validated with invasive recordings in mice and monkeys (<xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>; see further discussion in text).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig8-v2.tif"/></fig></sec><sec id="s2-4-6"><title>Step 3</title><p>‘Activate’ the local network. In prior publications, we have simulated non-time-locked spontaneous low-frequency alpha and beta rhythms through patterns of rhythmic drive (repeated bursts of spikes) through proximal and distal projection pathways. These patterns of drive were again motivated by literature and by tuning the parameters to match features of the model output to the recorded data (see <xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>; <xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>).</p><p>We begin by describing the process for simulating a pure alpha frequency rhythm only, and we then describe how a novel prediction for the origin of beta events emerged (<xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>). Motivated by a long history of research showing alpha rhythms in neocortex rely on ~10 Hz bursting in the thalamus, we tested the hypothesis that ~10 Hz bursts of drive through proximal and distal projection pathways (representing lemniscal and non-lemniscal thalamic drive) could reproduce an alpha rhythm in the local circuit. The burst statistics (number of spikes and inter-burst interval chosen from a Gaussian distribution), strength of the input (post-synaptic conductance), and delay between the proximal and distal input were manually adjusted until a pure alpha rhythm sharing feature of the data was found. We showed that when ~ 10 Hz bursts of proximal and distal drives are subthreshold and arrive to the local network in anti-phase (~50 ms delay) a pure alpha rhythm emerges (<xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>; <xref ref-type="bibr" rid="bib88">Ziegler et al., 2010</xref>).</p><p>The parameters of this drive are distributed with HNN in the file ‘Alpha.param’, loaded through the Set Parameters From File button and viewed in the Set Parameters dialog box under Rhythmic Proximal and Rhythmic Distal inputs (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). Note that the start time mean of the ~10 Hz Rhythmic Proximal and Rhythmic Distal Inputs are delayed by 50 ms. The HNN GUI in <xref ref-type="fig" rid="fig7">Figure 7B</xref> displays the simulated current dipole output from this drive (middle), the histogram of the proximal and distal driving spike trains (top), and the corresponding time-frequency domain response (bottom). This GUI window is automatically constructed when rhythmic inputs are given to the network, and HNN is designed to easily define rhythmic input to the network via the Set Parameters dialog box. A scaling factor was also applied to this signal (via Set Parameters, Run dialog box) and is shown as 300,000 on the y-axis of the main GUI window example in <xref ref-type="fig" rid="fig7">Figure 7B</xref>. The 300,000 scaling factor predicts that 60,000,000 PNs (300,000 × 200 PNs) contribute to the measured signal.</p></sec><sec id="s2-4-7"><title>Step 4</title><p>The alpha rhythm shown in <xref ref-type="fig" rid="fig7">Figure 7B</xref> is reproduced by clicking the ‘Run Simulation’ button at the top of the GUI, Additional network features, including power-spectral density plots, can also be visualized through the pull down menus (Step 5).</p></sec><sec id="s2-4-8"><title>Steps 6 and 7</title><p>Rhythmic input parameters can be adjusted to account for the user defined ‘simulation experiment’ and hypothesis testing goals.</p><p>The goal in our prior study was to reproduce the alpha/beta complex of the SI mu-rhythm. By hand tuning the parameters we were able to match the output of the model to several features of the recorded data, including symmetric amplitude modulation around zero and PSD plots as shown in <xref ref-type="fig" rid="fig7">Figures 7</xref> and <xref ref-type="fig" rid="fig8">8</xref> (see further feature matching in <xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref> and <xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>), we arrived at the hypothesis that brief bouts of beta activity (‘beta events’) non-time locked to alpha events could be generated by decreasing the mean delay between the proximal and distal drive to 0 ms and increasing the strength of the distal drive relative to the proximal drive. This parameter set is also distributed with HNN (‘AlphaandBeta.param’) and viewed in <xref ref-type="fig" rid="fig8">Figure 8A</xref>. With this mechanism, beta events emerged on cycles when the two stochastic drives hit the network simultaneously and when the distal drive was strong enough to break the upward flowing current and create a prominent ~50 ms downward deflection (see red box in <xref ref-type="fig" rid="fig8">Figure 8B</xref>). The stronger the distal drive the more prominent the beta activity (data not shown, see <xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>). This beta event hypothesis was purely model derived and was based on matching several features of the SI mu rhythm between the model output and data (detailed in <xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref> <xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>).</p><p>Importantly, due to the non-time locked nature of this spontaneous rhythm, the waveform can not be directly compared by overlaying the waveform of the model and recorded oscillations as in the evoked response example (e.g. <xref ref-type="fig" rid="fig4">Figure 4</xref>). However, one can quantify features of the oscillation and compare to recorded data (<xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>; <xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>). One such feature is the amplitude of the oscillation waveform, where a scaling factor can be applied to the model to predict how many cells are needed to produce a waveform amplitude on the same order as the recorded data, as described in Step three above. Additionally, the PSD from the model and data can be directly compared. This can be viewed in the HNN GUI though the ‘View PSD’ pull down menu (see <xref ref-type="fig" rid="fig4">Figure 4</xref>, Step 5), where this data (‘SI_ongoing.txt’ - provided with HNN) can be automatically compared to the model output in the PSD window (<xref ref-type="fig" rid="fig8">Figure 8C</xref>).</p><p>The model derived predictions on mechanisms underlying alpha and beta where motivated by literature and further refined by tuning the parameters to match the output of the model with various features of the recorded data. While the mechanisms of the alpha rhythm described above were motivated by literature showing cortical alpha rhythms arise in part from alpha frequency drive from the thalamus and supported by animal studies (<xref ref-type="bibr" rid="bib34">Hughes and Crunelli, 2005</xref>; for example, see Figure 2 in <xref ref-type="bibr" rid="bib8">Bollimunta et al., 2011</xref>), the beta event hypothesis was novel. The level of circuit detail in the model led to specific predictions on the laminar profile of synaptic activity occurring during beta events that could be directly tested with invasive recordings in animal models. One specific prediction was that the orientation of the current during the prominent ~50 ms deflection defining a beta event (red box, <xref ref-type="fig" rid="fig8">Figure 8B</xref>) was down the pyramidal neuron dendrites (e.g. into the cortex). This prediction, along with several others, were subsequently tested and validated with laminar recordings in both mice and monkeys, where it was also confirmed that features of beta events are conserved across species and recording modalities (<xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>; <xref ref-type="bibr" rid="bib73">Shin et al., 2017</xref>).</p></sec><sec id="s2-4-9"><title>Gamma rhythms</title><p>Gamma rhythms can encompass a wide band of frequencies from 30 to 150 Hz. Here, we will focus on the generation of so-called ‘low gamma’ rhythms in the 30–80 Hz range. It has been well established through experiments and computational modeling that these rhythms can emerge in local spiking networks through excitatory and inhibitory cell interactions where synaptic time constants set the frequency of the oscillation, while broadband or ‘high gamma’ rhythms reflect spiking activity in the network that creates sharp waveform deflections (<xref ref-type="bibr" rid="bib50">Lee and Jones, 2013</xref>). The period of the low gamma oscillation is determined by the time constant of decay of GABAA-mediated inhibitory currents (<xref ref-type="bibr" rid="bib14">Buzsáki and Wang, 2012</xref>; <xref ref-type="bibr" rid="bib15">Cardin et al., 2009</xref>; <xref ref-type="bibr" rid="bib84">Vierling-Claassen et al., 2010</xref>), a mechanism that has been referred to as pyramidal-interneuron gamma (PING). In normal regimes, the decay time constant of GABA<sub>A</sub>-mediated synapses (~25 ms) bounds oscillations to the low gamma frequency band (~40 Hz). In general, PING rhythms are initiated by ‘excitation’ to the excitatory (PN) cells, and this initial excitation causes PN spiking that, in turn, synaptically activates a spiking population of inhibitory (I) cells. These (I) cells then inhibit the PN cells, preventing further PN activity until the PN cells can overcome the effects of the inhibition ~25 ms later. The pattern is repeated, creating a gamma frequency oscillation (~40 Hz).</p><p>We have applied HNN to determine if features in the current dipole signal could distinguish PING-mediated gamma from other possible mechanisms such as exogenous rhythmic drive or spiking activity that creates ‘high gamma’ oscillations (<xref ref-type="bibr" rid="bib50">Lee and Jones, 2013</xref>). Here, we describe the process for generating gamma rhythms via the canonical PING mechanisms in HNN. First, to demonstrate the basic mechanisms of PING, we simulate a robust large amplitude and nearly continuous gamma rhythm (Steps 3–5, <xref ref-type="fig" rid="fig9">Figure 9</xref>). Second, we adjust the simulation parameters in order to directly compare to experimental data, where on single trials induced gamma rhythms are smaller in amplitude and less continuous emerging as transient bursts of activity (<xref ref-type="bibr" rid="bib60">Pantazis et al., 2018</xref>) (Steps 6 and 7, <xref ref-type="fig" rid="fig10">Figure 10</xref>). Both parameter sets for creating the examples below are distributed with the software.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>An example workflow for simulating canonical pyramidal-interneuron gamma (PING) rhythms (<xref ref-type="bibr" rid="bib50">Lee and Jones, 2013</xref>; see Gamma Rhythms Tutorial text for details).</title><p>(<bold>A</bold>) Here we are using the default HNN network configuration (with some parameter adjustments as shown in panel B) and we are not directly comparing the waveform to data, so begin with Step 3: activate the local network. Motivated by prior studies on PING mechanisms (see text), in this example PING rhythms were simulated by driving the pyramidal neuron somas with noisy excitatory synaptic input following a Poisson process. The parameters defining this noisy drive are viewed and adjusted through the Set Parameters button as shown, see text and Materials and methods for parameter details. This parameter set for this example is provided in the ‘<ext-link ext-link-type="uri" xlink:href="http://hnn.brown.edu/wp-content/uploads/2018/04/gamma.zip">gamma_L5weak_L2weak.param</ext-link>’ file. In this example, all synaptic connections within the network are turned off (synaptic weight = 0), except for reciprocal connections between the excitatory (AMPA only) and inhibitory (GABAA only) cells within the same layer. The local network connectivity can be viewed and adjusted through the Set Network Connection button or pull down menu, as shown in (<bold>B</bold>). (<bold>C</bold>) Step 4: running the simulation with the ‘Run Simulation’ button, shows that a ~ 50 Hz gamma rhythm is produced in the current dipole signal (middle dipole time trace; bottom time-frequency representation). The black histogram at the top displays the noisy excitatory drive to the network. (<bold>D–F</bold>) Step 5: additional network features, including cell spiking responses, somatic voltages, and layer specific power spectral density plots as shown can be visualized through the ‘View’ pull down menu.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig9-v2.tif"/></fig><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>An example simulation describing how parameter adjustments to the canonical PING mechanism can account for source localized visually-induced gamma rhythms recorded with MEG.</title><p>(<bold>A</bold>) An example single trial current dipole waveform generated from a stationary square-wave grating, presented from 0 to 700 ms. MEG data was source localized to the pericalcarine region of the visual cortex (top). The corresponding time-frequency representation (bottom) shows transient bursts of induced gamma activity (bottom). Data is as in <xref ref-type="bibr" rid="bib60">Pantazis et al. (2018)</xref> and described further in text. (<bold>B</bold>) Analogous waveforms from 100 trials overlaid (top) and corresponding averaged time-frequency spectrograms (bottom). Averaging in the spectral domain creates the appearance of a more continuous oscillation. (<bold>C</bold>) Parameters used to simulate the canonical PING rhythm in <xref ref-type="fig" rid="fig9">Figure 9</xref> were adjusted (Steps 6 and 7) to test the hypothesis that a reduced rate of Poisson synaptic input to the pyramidal neurons could account for the bursty nature of the observed gamma data. The parameter set for this example is provided in the ‘<ext-link ext-link-type="uri" xlink:href="http://hnn.brown.edu/wp-content/uploads/2018/04/gamma.zip">gamma_L5weak_L2weak_bursty.param</ext-link>’ file. In this example, the Poisson input rates to the Layer 2/3 and Layer 5 cells were reduced to 4 Hz and 5 Hz, respectively, and the NMDA synaptic inputs were set to a small positive weight (dialog box not shown). Running the simulation will display a histogram of the Poisson drive (top), the current dipole waveform (middle), and the corresponding time-frequency spectrogram (bottom). With this parameter adjustment,~50 Hz bursty gamma activity is reproduced. A scaling factor of 5 was applied to the net current dipole to produce a signal amplitude comparable to the data (&lt;0.1 nAm), suggesting that only ~1000 pyramidal neurons contributed the recorded signal. (<bold>D</bold>) Poisson input over 100 simulations (top), current dipole waveforms overlaid (middle), and the corresponding spectrogram average (bottom). Similar to the recorded data, averaging in the spectral domain creates the appearance of a more continuous oscillation. (<bold>E–F</bold>) Microcircuit details including cell spiking responses and layer specific current dipoles shows Layer 5 activity dominates the net current dipole signal, see text for further description.</p><p> <supplementary-material id="fig10sdata1"><label>Figure 10—source data 1.</label><caption><title>Visual cortex gamma activity from 1 trial.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-51214-fig10-data1-v2.txt"/></supplementary-material> </p><p> <supplementary-material id="fig10sdata2"><label>Figure 10—source data 2.</label><caption><title>Visual cortex gamma activity from 100 trials.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-51214-fig10-data2-v2.txt"/></supplementary-material> </p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig10-v2.tif"/></fig><p>To demonstrate the robust PING-mechanisms and its expression at the level of a current dipole, we begin this tutorial with Step 3, ‘activating’ the network using a slightly altered local network configuration as described below.</p></sec><sec id="s2-4-10"><title>Step 3</title><p>‘Activate’ the local network by loading in the parameter set defining the local network and initial input parameters ‘<ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/param/gamma_L5weak_L2weak.param">gamma_L5weak_L2weak.param</ext-link>’. In this example, the input was noisy excitatory synaptic drive to the pyramidal neurons. Additionally, all synaptic connections within the network are turned off (synaptic weight = 0) except for reciprocal connections between the excitatory (AMPA only) and inhibitory (GABA<sub>A</sub> only) cells within the same layer. This is not biologically realistic, but was done for illustration purposes and to prevent pyramidal-to-pyramidal interactions from disrupting the gamma rhythm. To view the local network connections, click the ‘local network’ button in the Set Parameters dialog box. <xref ref-type="fig" rid="fig9">Figure 9B</xref> shows the corresponding dialog box where the values of adjustable parameters are displayed. Notice that the L2/3 and L5 cells are not connected to each other, the inhibitory conductance weights within layers are stronger than the excitatory conductances, and there are also strong inhibitory-to-inhibitory (i.e., basket-to-basket) connections. This strong autonomous inhibition will cause synchrony among the basket cells, and hence strong inhibition onto the PNs.</p><p>To reproduce the ~40 Hz gamma oscillation described by the PING mechanism above, we drove the pyramidal neuron somas in L2/3 and L5 with noisy excitatory AMPA synaptic input, distributed in time as a Poisson process with a rate of 140 Hz. This noisy input can be viewed in the ‘Set Parameters’ menu by clicking on the ‘Poisson Inputs’ button (see <xref ref-type="fig" rid="fig9">Figure 9A</xref>). Setting the stop time of the Poisson drive to −1, under the Timing tab, keeps it active throughout the simulation duration.</p></sec><sec id="s2-4-11"><title>Step 4</title><p>The gamma rhythm shown in <xref ref-type="fig" rid="fig9">Figure 9C</xref> is reproduced by clicking the ‘Run Simulation’ button at the top of the main HNN GUI. The top panel shows a histogram of Poisson distributed times of input to the pyramidal neurons, the middle panel the net current dipole across the entire network, and the bottom the corresponding time-frequency spectrogram showing strong gamma band activity. Additional network features, including spiking activity in each cell in the population (<xref ref-type="fig" rid="fig9">Figure 9D</xref>), somatic voltages (<xref ref-type="fig" rid="fig9">Figure 9E</xref>), and PSD plots for each layer and the entire network (<xref ref-type="fig" rid="fig9">Figure 9F</xref>) can also be visualized through the ‘View’ pull down menu (Step 5). Notice the PING mechanisms described above in the spiking activity of the cells (<xref ref-type="fig" rid="fig9">Figure 9D</xref>), where in each layer the excitatory pyramidal neurons fire before the inhibitory basket cells. The line plots, which show spike counts over time, also demonstrate rhythmicity. The pyramidal neurons are firing periodically but with lower synchrony due to the Poisson drive (orange histogram at the top), which creates randomized spike times across the populations (once the inhibition sufficiently wears off). Notice also that the power in the gamma band is much smaller in Layers 2/3 than in Layer 5 (<xref ref-type="fig" rid="fig9">Figure 9F</xref>). This is reflective, in part, of the fact that the length of the L2/3 PNs is smaller than the L5 PNs, and hence the L2/3 cells produce smaller current dipole moments that can be masked by activity in Layer 5. This example was constructed to describe features in the current dipole signal that could distinguish PING mediated gamma rhythms but has not been directly compared to recorded data (see <xref ref-type="bibr" rid="bib50">Lee and Jones, 2013</xref> for further discussion).</p></sec><sec id="s2-4-12"><title>Steps 6 and 7</title><p>Next, we describe how parameter adjustments to the canonical PING mechanism above can account for induced gamma rhythms recorded with MEG in a prior published study (<xref ref-type="bibr" rid="bib60">Pantazis et al., 2018</xref>). In this study, subjects were presented with the following visual stimuli: stationary square-wave Cartesian gratings with vertical orientation and black/white maximum contrast with a frequency of 3 cycles/degree. These stimuli create non-time locked induced gamma rhythms in the visual cortex; a reliable phenomena observed in many studies. The data represents time-domain activity from sources localized in the pericalcarine region of the visual cortex from 0 to 700 ms after the presentation of the stimulus (<xref ref-type="fig" rid="fig10">Figure 10A,B</xref>), and is located in HNN’s data/gamma_tutorial folder.</p><p>To view the data in HNN, click on HNN’s ‘View’ pull down menu, then click on ‘View Spectrograms’. Then from the Spectrogram Viewer, click on the ‘File’ pull down menu, click ‘Load Data’, and select data/gamma_tutorial/100_trials.txt. <xref ref-type="fig" rid="fig10">Figure 10A</xref> shows a single trial of the source-localized current dipole signal, with corresponding wavelet-transform spectrogram below. Here, visual gratings were provided from time = 0–700 ms. On single non-averaged trials, the visual stimulus creates non-time-locked induced gamma rhythms at ~50 Hz that are not continuous but transient in time and ‘burst-like’, with each burst lasting ~50–100 ms. HNN’s Spectrogram Viewer automatically averages the wavelet spectrograms across trials when the data is loaded (<xref ref-type="fig" rid="fig10">Figure 10B</xref>). To view a single trial as in <xref ref-type="fig" rid="fig10">Figure 10A</xref>, use the drop-down menu at the bottom of the Spectrogram Viewer to select a single trial. The averaged spectrogram from 100 trials makes the oscillation appear nearly continuous in the 40–50 Hz gamma band (<xref ref-type="fig" rid="fig10">Figure 10B</xref>).</p><p>We hypothesized that in order to change the nearly continuous gamma oscillation from HNN’s canonical PING model (<xref ref-type="fig" rid="fig9">Figure 9</xref>) into a bursty lower amplitude gamma rhythm on single trials, the noisy excitatory AMPA synaptic input to the pyramidal neurons that creates the PING-rhythm, as described in Step 3, would need to be reduced. We tested this hypothesis by reducing the rate of the Poisson synaptic inputs to L2/3 and L5 pyramidal neurons, here from 140 Hz to 4 Hz and 5 Hz, respectively. To see the parameter values used, load the ‘<ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/param/gamma_L5weak_L2weak_bursty.param">gamma_L5weak_L2weak_bursty.param</ext-link>’ file, then click on ‘Set Parameters’ and ‘Poisson Inputs’ (parameter values not shown in <xref ref-type="fig" rid="fig10">Figure 10</xref>). Note, that in addition to the change and rate of drive, the NMDA synaptic inputs now have a small positive weight (previously zero), which was required to compensate for the reduced AMPA activation of the pyramidal neurons.</p><p>Click on ‘Run Simulation’ to produce the results shown in <xref ref-type="fig" rid="fig10">Figure 10C</xref>. The top panel of <xref ref-type="fig" rid="fig10">Figure 10C</xref> shows the Poisson inputs, which have a noticeably lower rate than the default PING simulation. The current dipole time-course is shown in the middle panel. The corresponding wavelet spectrogram in the bottom panel shows intermittent gamma bursts recurring with high power, similar to the features seen in the experiment. Note, in this data set, the amplitude of the current dipole signal is small,&lt;0.1 nAm. As such, a small dipole scaling factor of 5 was applied to the output of HNN to compare to the amplitude of the experimental data. This predicts that a highly localized population of ~1000 pyramidal neurons contribute to the recorded gamma signal.</p><p>To see the effects of averaging across trials in HNN, click on ‘Set Parameters’ and ‘Run’, enter 100 trials, and then click on ‘Run Simulation’. Output as shown in <xref ref-type="fig" rid="fig10">Figure 10D</xref> will be produced. The individual current dipole waveforms do not have consistent phase across trials (<xref ref-type="fig" rid="fig10">Figure 10D</xref> middle). However, averaging the spectrograms across trials produces a more continuous band of gamma oscillation throughout the simulation duration, similar to the effects observed in the experiment.</p><p>We can now use HNN to take a closer look at the underlying neuronal spiking activity contributing to the observed dipole signal, as shown in <xref ref-type="fig" rid="fig10">Figure 10E</xref>. The firing rates of L2/3 pyramidal neurons (green) and L5 pyramidal neurons (red) are significantly lower and more sparse than in the continuous PING simulation shown in <xref ref-type="fig" rid="fig9">Figure 9</xref>. This lower pyramidal neuron activation leads to fewer, or no basket interneurons firing on any given gamma cycle (<xref ref-type="fig" rid="fig10">Figure 10E</xref> white, blue points have fewer participating interneurons, and do not always occur). This lower interneuron activity produces lower-amplitude bouts of feedback inhibition, which are sometimes nearly absent, and thus creates transient bursty gamma activity. Note that the firing rates of L2/3 pyramids are lower than that of L5 pyramidals, consistent with experimental data (<xref ref-type="bibr" rid="bib57">Naka et al., 2019</xref>; <xref ref-type="bibr" rid="bib70">Schiemann et al., 2015</xref>) and previous data-driven modeling (<xref ref-type="bibr" rid="bib18">Dura-Bernal et al., 2019</xref>; <xref ref-type="bibr" rid="bib58">Neymotin et al., 2016</xref>). Layer specific current dipole responses in <xref ref-type="fig" rid="fig10">Figure 10F</xref> confirm that due to their dendritic length L5 pyramidals are once again the major contributors to the aggregate dipole signal. This example is presented as a proof of principle of the method to begin to study the cell and circuit origin of source localized gamma band data with HNN. The circuit level hypotheses have not yet been published elsewhere or investigated in further detail.</p></sec></sec><sec id="s2-5"><title>ERP model optimization</title><p>To ease the process of narrowing in on parameter values representing a user’s hypothesized model, we have added a model optimization tool in HNN. Currently, this tool automatically estimates parameter values that minimize the error between model output and features of ERP waveforms from experiments. Parameter estimation is a computationally demanding task for any large-scale model. To reduce this complexity, we have leveraged insight of key parameters essential to ERP generation, along with a parameter sensitivity analysis, to create an optimization procedure that reduces the computational demand to a level that can be satisfied by a common multi-core laptop.</p><p>Two primary insights guided development of the optimization tool. First, exogenous proximal and distal driving inputs are the essential parameters to first tune to get an initial accurate representation of an ERP waveform. Thus, the model optimization is currently designed to estimate the parameters of these driving inputs defined by their synaptic connection strengths, and the Gaussian distribution of their timing (see dialog box in <xref ref-type="fig" rid="fig11">Figure 11B</xref>). In optimizing the parameters of the evoked response simulations to reproduce ERP data distributed with HNN (e.g. see ERP tutorial), we performed sensitivity analyses that estimated the relative contributions of each parameter to model uncertainty, where a low contribution indicated that a parameter could be fixed in the model and excluded from the estimation process to decrease compute time (see Supplementary Materials).</p><fig-group><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Example of the ERP parameter optimization procedure for a suprathreshold tactile evoked response.</title><p>(<bold>A</bold>) Source localized SI data from a suprathreshold tactile evoked response (100% detection; purple) is shown overlaid with the corresponding HNN evoked response (black) using the threshold level evoked response parameter set detailed in <xref ref-type="fig" rid="fig4">Figure 4</xref>, as in initial parameter set. The RMSE between the data and the model is initially high at 30.53. (<bold>B</bold>) To improve the fit to the data, a procedure for sequentially optimizing the strengths of the proximal and distal drive inputs generating the evoked response can be run. The ‘Configure Optimization’ option is available under the ‘Simulation’ pull down menu. A dialog box allows users to choose and set a range over free optimization parameters, see text for details. (<bold>C</bold>) The GUI displays an intermediate fit after the first optimization step, specific to the first proximal drive. (<bold>D</bold>) The final fit is displayed once the optimization is complete. Here, the simulation from the optimized parameter set for the suprathreshold evoked response is shown in gray with an improved RMSE of 15.54 compared to 30.53 for the initial model. See <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplements 1</xref> and <xref ref-type="fig" rid="fig11s2">2</xref> for a further description of the optimization routine and parameter sensitivity analysis.</p><p> <supplementary-material id="fig11sdata1"><label>Figure 11—source data 1.</label><caption><title>Average SI ERP from suprathreshood stimulus.</title></caption><media mime-subtype="plain" mimetype="text" xlink:href="elife-51214-fig11-data1-v2.txt"/></supplementary-material> </p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig11-v2.tif"/></fig><fig id="fig11s1" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 1.</label><caption><title>Weighted scoring of the stepwise optimization procedure for suprathreshold level evoked response example, see text for details.</title><p>(<bold>A</bold>) Probability distribution of input timing for each input. (<bold>B</bold>) Corresponding cumulative distribution as a contribution index. (<bold>C</bold>) Unique Contribution Index that is reduced by subsequent input’s CDFs. (<bold>D</bold>) Extended Contribution Index in which the subtracted CDFs are subject to a decay factor.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig11-figsupp1-v2.tif"/></fig><fig id="fig11s2" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 2.</label><caption><title>Sensitivity analysis results of the suprathreshold level evoked response example showing the relative contribution of each input’s parameters on variance.</title><p>Total Sobol indices at each point have been weighted by the std. deviation scaled from 0 to 1.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51214-fig11-figsupp2-v2.tif"/></fig></fig-group><p>Second, an intuitive insight that was confirmed by parameter sensitivity analysis is that the influence of each exogenous input on the simulated dipole varies over time, with the highest influence during and just after the time of the input (see Supplementary Material). We used this knowledge to create a stepwise optimization process, only estimating parameter values for one input at a time, where the objective of each optimization is to minimize a weighted root mean squared error (RMSE) measure between simulated and experimental data only during the relevant time window (see Materials and methods). This stepwise estimation reduces the complexity of the optimization problem and saves time. Each step in the process searches for parameter estimates using the COBYLA optimization algorithm (<xref ref-type="bibr" rid="bib64">Powell, 1994</xref>) (see Materials and methods for detailed explanation of the stepwise optimization procedure).</p></sec><sec id="s2-6"><title>Example model optimization for the suprathreshold sensory evoked response data set</title><p>In this example, we describe an application of the model optimization tool for estimating parameters to simulate data representing the SI evoked response to a brief suprathreshold level tactile stimulation -- which is 100% detected (<xref ref-type="fig" rid="fig11">Figure 11A</xref>). This evoked response is similar to that shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>, where the signal was elicited from a perceptual threshold level stimulation - at 50% detection. We start from the parameter file fitted to the 50% detection scenario, and use HNN’s model optimization feature to find parameter estimates that provide a better fit the suprathreshold-level experimental data. The data from this study is also included in the HNN distribution (‘SI_SupraT.txt’).</p><sec id="s2-6-1"><title>Steps 1–4</title><p>Similar to steps 1–4 above, first load the supra-threshold experimental data file ‘S1_SupraT.txt’ via the ‘Load data file’ menu option and the example starting parameters to activate the network provided in the parameter file ‘ERPYes100Trials.param’ via the ‘Load parameter file’ menu option. Note that in this example, the network is also ‘activated’ by a sequence of three exogenous inputs defined in the parameter file. The parameters for these inputs serve as a baseline for model optimization. The supplied parameter file (used above) runs 100 trials by default for each simulation. For model optimization, this can be reduced to three trials. Click on the ‘Set Parameters’ button, then the ‘Run’ button, and replace 100 trials with 3. In the previous Set Parameters dialog box change the simulation name to ‘ERPYes3Trials’ to reflect this change (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). By clicking the ‘Run Simulation’ button the evoked response using this initial parameter set as in <xref ref-type="fig" rid="fig11">Figure 11A</xref> will be displayed. As described above, in practice with user defined data, users should apply their own hypotheses related to the number, timing and synaptic input strengths of the exogenous inputs that activate the network to obtain an initial representation of the recorded waveform before beginning the parameter estimation process.</p></sec><sec id="s2-6-2"><title>Step 5</title><p>Before running the optimization, rename the simulation to ‘ERPYes3Trials_opt’ in the Set Parameters dialog box as described above, so that the parameter results of the optimization will be saved in a new file.</p></sec><sec id="s2-6-3"><title>Step 6</title><p>In the Simulation pull down menu, choose the ‘Configure Optimization’ option. This option is only selectable once data and parameter files have been loaded. A new dialog box pre-populated with values from the parameter file will appear, as shown in <xref ref-type="fig" rid="fig11">Figure 11B</xref>. All parameters describing the timing and strength of defined exogenous inputs will be available for optimization. Users can generate their own evoked response parameter files with as many exogenous inputs as desired and they will be automatically populated into the ‘Configure Optimization’ dialog box.</p><p>Select which parameters to treat as free variables for optimization; parameters that will be fixed in the optimization process are grayed out. By default, all parameters are selected, but it may be desirable to limit the number of free parameters to only the most influential set based on a parameter sensitivity analysis. Fixing non-influential parameters will decrease the complexity of an optimization step, and increase the likelihood of the optimization algorithm converging on parameter estimates after a relatively low number of simulations. Results of a sensitivity analysis using Uncertainpy (<xref ref-type="bibr" rid="bib80">Tennøe et al., 2018</xref>) on this example data are provided in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> and may help guide model optimization for similar data. Sensitivity analysis is not yet included in HNN (see Future Directions).</p><p>The number of simulations per optimization step is configurable in the top section of the ‘Configure Optimization’ dialog box (<xref ref-type="fig" rid="fig11">Figure 11B</xref>). The default values shown in <xref ref-type="fig" rid="fig11">Figure 11B</xref> were based on results from our studies where the fit obtained was significantly improved from a single optimization. This value can be decreased as the number of free parameters is reduced.</p><p>The parameter ranges defining the bound constraints given to the optimization algorithm are shown in the ‘Defined range’ column of the dialog box in <xref ref-type="fig" rid="fig11">Figure 11B</xref>. The displayed range is calculated as plus or minus a specified number of standard deviations for input start time or plus or minus a percentage of the initial value for all other parameters. The user may customize the range by inputting their own ‘Range specifier’ or using the interactive slider bar to define new minimum or maximum values. If a parameter has an initial value of 0, its range is defined by a user-specified maximum value rather than percentage. The ‘Reset Ranges’ button will update ranges using the ‘Range specifier’ and discard custom values set by the slider. Parameters can be fixed during the optimization process by unchecking the ‘Optimize’ checkbox.</p></sec><sec id="s2-6-4"><title>Step 7</title><p>Click the ‘Run Optimization’ button to start the stepwise optimization process. After each input has been optimized in sequence followed by a final optimization step that adjusts all input parameters, the final optimized fit will be shown in gray in the main HNN window along with the lowest obtained RMSE (<xref ref-type="fig" rid="fig11">Figure 11C/D</xref>).</p></sec><sec id="s2-6-5"><title>Step 8 (optional)</title><p>To perform a second optimization using the results of the first procedure as a starting point, select the optimized simulation parameter set drop-down menu. This will update the values in the Configure Optimization dialog box and pressing Run Optimization will start a new optimization process. For this example, the RMSE improved from 15.54 (<xref ref-type="fig" rid="fig11">Figure 11D</xref>) after the first optimization to 10.02 after a second round (data not shown).</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The Human Neocortical Neurosolver (HNN, <ext-link ext-link-type="uri" xlink:href="https://hnn.brown.edu">https://hnn.brown.edu</ext-link>) is a neural modeling software tool developed to help researchers and clinicians interpret the neural origin of their human EEG or MEG data. HNN’s interactive GUI is designed for users with no formal computational neural modeling or software development experience to be able to develop and test hypotheses on the cellular- and circuit-level generators of their human data. Based on prior applications of HNN’s underlying template neural model on these signals (<xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>; <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>; <xref ref-type="bibr" rid="bib45">Khan et al., 2015</xref>; <xref ref-type="bibr" rid="bib50">Lee and Jones, 2013</xref>; <xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>; <xref ref-type="bibr" rid="bib75">Sliva et al., 2018</xref>; <xref ref-type="bibr" rid="bib88">Ziegler et al., 2010</xref>), the tutorials and the example workflow focus on studying the neural origin of ERPs and low-frequency oscillations from a single brain region. The template network model contains features of a canonical neocortical circuit, with layer-specific thalamocortical and cortico-cortical drive, where the net primary current dipoles are simulated from the intracellular current across the network of pyramidal neurons. HNN enables visualization and direct comparison of the primary current dipole produced by the network to source-localized data in units of Am, under various parameter manipulations. This comparison, along with simultaneous visualization of microcircuit activity, including cell spiking and somatic voltage responses, guides interpretation of the cellular- and circuit-level origin of EEG/MEG data.</p><p>HNN was created based on the biophysical origin of EEG/MEG primary currents to be a hypothesis development and testing tool, where specific predictions on the microcircuit-level underpinnings of recorded data can be produced. The circuit-level predictions can guide further validation with invasive recordings or with other imaging modalities (e.g., spectroscopy or tractography, see <xref ref-type="bibr" rid="bib45">Khan et al., 2015</xref>). As one specific example, HNN led to a novel prediction on the origin of transient neocortical beta oscillations, and the prediction was later tested and supported by laminar recordings in mice and monkeys (<xref ref-type="bibr" rid="bib72">Sherman et al., 2016</xref>). In turn, established cellular- or circuit-level details known to contribute to healthy brain dynamics and/or disease states can be adapted into HNN to predict corresponding signatures in macroscale signals.</p><p>HNN is particularly timely given the rapidly expanding wealth of genetic insights and phenotype data in animal model systems. As disease-specific genetic mutations and corresponding cellular/circuit outcomes in mouse models are identified, they can be implemented in HNN, and their impact on EEG/MEG measured brain dynamics, ranging from ongoing state properties (e.g., alpha oscillations) to sensory-evoked responses, can be simulated. The outputs from HNN would then provide specific and principled predictions to be compared against real EEG/MEG data obtained in the relevant population, leading to valid bi-directional inference. Overall, the scalability of HNN provides an unprecedented framework for translational neuroscience research.</p><sec id="s3-1"><title>Comparison to other neocortical models and EEG/MEG modeling software</title><p>Many models of neocortical circuitry, with varying levels of complexity, have been developed to simulate LFP, EEG/MEG and/or ECoG (e.g., <xref ref-type="bibr" rid="bib4">Barrès et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Kiebel et al., 2008</xref>; <xref ref-type="bibr" rid="bib66">Reimann et al., 2013</xref>; <xref ref-type="bibr" rid="bib68">Sanz Leon et al., 2013</xref>). Several modeling tools and associated documentation are also available to build user defined neocortical models for general use that are not domain specific, such as NEURON (<ext-link ext-link-type="uri" xlink:href="https://neuron.yale.edu/neuron/">https://neuron.yale.edu/neuron/</ext-link>), NetPyNE (<xref ref-type="bibr" rid="bib18">Dura-Bernal et al., 2019</xref>), the Brain Modeling Toolkit/Bionet (<xref ref-type="bibr" rid="bib27">Gratiy et al., 2018</xref>), and the Brain Simulation Platform from the European Union Human Brain Project. Among the current modeling software designed specifically for study of EEG/MEG signals (e.g., The Virtual Brain [TVB] <ext-link ext-link-type="uri" xlink:href="https://thevirtualbrain.org">https://thevirtualbrain.org</ext-link>, Dynamic Causal Modeling [DCM] of E/MEG within the Statistical Parametric Mapping [SPM] software <ext-link ext-link-type="uri" xlink:href="https://www.fil.ion.ucl.ac.uk/spm/">https://www.fil.ion.ucl.ac.uk/spm/</ext-link>, and LFPy <ext-link ext-link-type="uri" xlink:href="https://lfpy.readthedocs.io/en/latest/">https://lfpy.readthedocs.io/en/latest/</ext-link>; <xref ref-type="bibr" rid="bib28">Hagen et al., 2018</xref>; <xref ref-type="bibr" rid="bib46">Kiebel et al., 2008</xref>; <xref ref-type="bibr" rid="bib68">Sanz Leon et al., 2013</xref>), HNN’s model, goals, and capabilities are unique.</p><p>The goal of HNN is to provide a user-friendly graphical interface to a validated biophysically detailed model of neocortical circuitry, and to teach the community, regardless of neural modeling or coding experience, how to interact with the model to study the neural origin of commonly measured macroscale EEG/MEG signals. This includes studying ERPs, and low frequency alpha, beta and gamma rhythms. HNN’s construction and tutorials are based on knowledge and workflows developed in prior published studies. As with other open-source software, continued application of HNN to new use cases means that software users can add to and improve upon the examples distributed with HNN. The level of biophysical detail included in HNN’s model and the calculation of the primary electrical currents from the intracellular dendritic current flow in multi-compartment pyramidal neurons enables one-to-one comparison between model output and source localized data in units of Am. HNN was specifically designed for interpreting microscale cellular- and circuit-level activity from single regions of interest. The cell and network level details provided can guide targeted testing and make connections to studies in animal models. Below we describe ways in which HNN’s goals and construction are distinct from other current domain specific EEG/MEG modeling software, namely LFPy, TVB, DCM.</p><p>LFPy is a Python package that provides a set of Python libraries and associated documentation on how to apply these scripts to simulate multi-scale signals, including current dipole, LFP, ECoG, M/EEG sensor signals, in user defined multi-compartment neuron models and networks built in NEURON or NeuroML (<xref ref-type="bibr" rid="bib28">Hagen et al., 2018</xref>). LFPy does not contain a GUI and is designed for users who have experience in neural modeling and Python. Users define their own workflows to simulate signals of interest that can be compared to data. The LFPy Python classes are likely to provide a useful framework for expanding the utility of HNN to include multi-area simulations, and simulations of LFP and EEG/MEG sensor level signals, as described in Limitations and future directions below.</p><p>DCM applied to EEG/MEG data is also a non-GUI based scripting tool, using Matlab. Users assume an active set of distributed sites, that is nodes, in the brain that contribute to a recorded signal. The neural activity of a node is simulated using ‘neural mass’ representations in which the activity (e.g. firing rate) of a population of neurons is simulated with a reduced number of variables (<xref ref-type="bibr" rid="bib46">Kiebel et al., 2008</xref>). The recorded data is fit to the assumed nodes and directionality of interactions between nodes statistically inferred.</p><p>TVB is designed to simulate large-scale network interactions also using reduced neural mass representations. Active nodes across the whole brain are assumed to contribute to the recorded signal and connectivity between nodes is informed by individualized tractography data (<xref ref-type="bibr" rid="bib68">Sanz Leon et al., 2013</xref>). Multi-scale EEG/MEG and/or fMRI data can be fit to the model. One advantage of this approach is that propagation of activity across the brain can be studied (e.g. spread of seizure), unlike HNN which is currently restricted to interpreting detailed activity in a single region of interest.</p><p>Indeed, many prior models of EEG/MEG rely on reduced representations of neural activity, including neural mass and/or mean field approximations (<xref ref-type="bibr" rid="bib9">Breakspear et al., 2004</xref>; <xref ref-type="bibr" rid="bib36">Jansen and Rit, 1995</xref>; <xref ref-type="bibr" rid="bib37">Jirsa and Haken, 1996</xref>; <xref ref-type="bibr" rid="bib46">Kiebel et al., 2008</xref>; <xref ref-type="bibr" rid="bib68">Sanz Leon et al., 2013</xref>; <xref ref-type="bibr" rid="bib86">Woolrich and Stephan, 2013</xref>). Such simplifications may be necessary to ensure mathematical or computational tractability of models that address interactions between multiple areas or whole brain activity (<xref ref-type="bibr" rid="bib10">Breakspear, 2017</xref>). However, that tractability comes at the cost of suppressing or eliminating the ability to evaluate cellular-level details of individual spiking units and dendritic currents, or to perform one-to-one comparisons between model and data; explicit goals of HNN.</p></sec><sec id="s3-2"><title>Limitations and future directions</title><p>One of the greatest challenges in computational neural modeling is deciding the appropriate scale of model to use to answer the question at hand. There is always a tradeoff between model complexity and computational efficiency, ease of use, and interpretability. As discussed above, this tradeoff underlies different scales of modeling in various EEG/MEG modeling software. HNN’s model was chosen to be minimally sufficient to accurately account for the biophysical origin of the primary currents that underlie EEG/MEG signals in a single brain area; namely, the net intracellular current flow in the apical dendrites of pyramidal neurons that span across the cortical layers and receive layer-specific synaptic input from other brain areas. HNN’s model was also constructed to maintain known canonical features of neocortical circuitry including, excitatory/inhibitory ratios, layer specific synaptic interactions, and cell spiking behaviors (see Parameter Tuning above, and Materials and methods). While HNN’s model is a reduction of the full complexity of neocortical circuits, it has been successful in interpreting the origin of extracranially measured macro-scale EEG/MEG signals that likely rely on canonical macroscale features of neocortical circuitry and not on finer details of the underlying structure. A future direction discussed below is to expand HNN to simulate extracellular local field potential signals (LFPs), and sensor level signals, whose accuracy may require additional model detail and whose implementation can be aided by other existing tools such as LFPy and NetPyNe (discussed further below). Any conclusions made with HNN are based on the underlying model assumptions that are important for users to understand. These assumptions are outlined in detail in the Materials and methods section, in our prior publications, and on our website.</p><p>Parameter optimization is a computationally challenging problem in any large-scale model. The process for parameter tuning to study ERPs and oscillations in HNN’s underlying model is detailed above. Based on our prior studies and sensitivity analyses (see Supplementary Materials), we have identified that the timing and strength of the layer specific exogenous drive to the local network is critical in defining the timing and peaks of sensory evoked responses. As such, HNN currently includes a tool to optimize these parameters based on reducing the error between simulated evoked response waveforms and recorded data. Due to the non-stationary nature of spontaneous brain rhythms (e.g. <xref ref-type="fig" rid="fig6">Figure 6</xref> and <xref ref-type="fig" rid="fig10">Figure 10</xref>) error reduction based on matching waveform features is not as straightforward, and other signal features may be necessary to consider for optimization (e.g. PSD peak amplitudes, see <xref ref-type="fig" rid="fig8">Figure 8</xref> and <xref ref-type="bibr" rid="bib41">Jones et al., 2009</xref>). Future expansions of HNN will include the ability to optimize over other user defined parameters, and to minimize errors between model output and various features of recorded data, with an estimate of the sensitivity of various parameters to these features. Given enough compute power, large parameter sweeps could be implemented in HNN to generate families of models for template matching to given waveforms via machine learning algorithms. This would serve as an alternative means for circuit interpretation without interactive hypothesis development and testing. At present, HNN can be run on high performance computers through the Neuroscience Gateway Portal (<ext-link ext-link-type="uri" xlink:href="http://www.nsgportal.org/">www.nsgportal.org</ext-link>) and Amazon Web Services (<ext-link ext-link-type="uri" xlink:href="https://aws.amazon.com">https://aws.amazon.com</ext-link>), see also Dissemination in Materials and methods.</p><p>Currently, all conclusions made in HNN are derived from the template neocortical column model provided. Another important step in expanding HNN’s utility will be to enable users to define their own cells and circuits to use within the HNN framework. While the HNN code is open source and adaptable for advanced users, it is difficult for those without expertise in computational neural modeling in Neuron/Python to expand. Therefore, work is in progress to convert HNN’s underlying neural model to the NetPyNe simulation language (<ext-link ext-link-type="uri" xlink:href="http://www.netpyne.org/">www.netpyne.org</ext-link>) (<xref ref-type="bibr" rid="bib18">Dura-Bernal et al., 2019</xref>). NetPyNe is a neural modeling platform enabling flexible cell and network development. This conversion will facilitate the ability to expand HNN to the study of activity from and between multiple cortical areas and the thalamus. NetPyNe is designed with both a GUI and command line (CLI) interface facilitating the construction of code that is readily accessible and human-readable. In expanding HNN to the NetPyNe language, HNN will also embrace the dual GUI and CLI capabilities, enabling the specification of architectures and parameters to be scriptable so that simulations and analyses can scale-up beyond manual operations.</p><p>HNN is designed to simulate source-localized current dipole signals produced by neurons. Source localization is currently viewed as an independent process. The output from any source localization algorithm can be compared to HNN’s simulated output. In future expansions of HNN, we plan to integrate HNN’s ‘bottom up’ simulations, with ‘top down’ source localization estimates using minimum-norm-estimate (MNE) software (<ext-link ext-link-type="uri" xlink:href="http://www.martinos.org/mne">www.martinos.org/mne</ext-link>) (<xref ref-type="bibr" rid="bib25">Gramfort et al., 2013</xref>; <xref ref-type="bibr" rid="bib26">Gramfort et al., 2014</xref>), providing an all-in-one software tool for source localization and circuit-based interpretation. In doing so, parameter estimation in each software package may benefit from direct knowledge and constraints from the other. Additionally, HNN’s utility will be expanded to include estimation of forward fields through the brain to simulate and visualize LFPs, current-source density, and sensor-level EEG/MEG signals, facilitating comparison to these recording modalities.</p><p>We have shown that HNN can be a useful tool to interpret the impact of noninvasive brain stimulation (NIBS) on EEG-measured circuit dynamics (<xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="bibr" rid="bib75">Sliva et al., 2018</xref>). HNN was used to test specific hypotheses on tACS-induced modulation of synaptic dynamics by accounting for EEG signal differences in pre-tACS compared to post-tACS periods. A useful expansion of HNN will be to include simulations of the fields induced in the brain by NIBS (e.g., with finite-element-estimates <xref ref-type="bibr" rid="bib85">Windhoff et al., 2013</xref>) and to directly couple these fields to the modeled neurons. This integration would facilitate studying the effects of NIBS on real-time EEG signals and could lead to improved NIBS paradigms.</p><p>In total, HNN’s present distribution and planned expansions are aimed at providing a one-of-a-kind, user-friendly software tool for translational neuroscience research that is accessible to a wide scientific and clinical community.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th valign="top">Reagent type (species) or resource</th><th valign="top">Designation</th><th valign="top">Source or reference</th><th valign="top">Identifiers</th><th valign="top">Additional information</th></tr></thead><tbody><tr><td valign="top">Software, algorithm</td><td valign="top">HNN</td><td valign="top">HNN</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resources/about/registry/SCR_017437">SCR_017437</ext-link></td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://hnn.brown.edu">https://hnn.brown.edu</ext-link></td></tr><tr><td valign="top">Software, algorithm</td><td valign="top">NEURON</td><td valign="top">NEURON</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resources/about/registry/SCR_005393">SCR_005393</ext-link></td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://neuron.yale.edu">https://neuron.yale.edu</ext-link></td></tr></tbody></table></table-wrap><p><italic>Dissemination</italic> HNN is distributed online at <ext-link ext-link-type="uri" xlink:href="https://hnn.brown.edu">https://hnn.brown.edu</ext-link>. The menu bar at the top of the HNN homepage links to installation instructions, documentation, tutorials, troubleshooting information, and a user forum. HNN can be installed locally on Linux, Windows, and mac OS operating systems, and it can be run as well online through Amazon Web Services (AWS) or the Neuroscience Gateway Portal (NGP). Since HNN is an open-source project, the code for our software, as well as the local installation instructions, are hosted on GitHub (see <ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn">https://github.com/jonescompneurolab/hnn</ext-link>).</p><sec id="s4-1"><title>Template model construction</title><sec id="s4-1-1"><title>Overview</title><p>The template neocortical model provided with HNN is based on prior publications using the model without a graphical user interface, as described in <xref ref-type="bibr" rid="bib41">Jones et al. (2009)</xref>, and available on ModelDB (<ext-link ext-link-type="uri" xlink:href="https://senselab.med.yale.edu/modeldb">https://senselab.med.yale.edu/modeldb</ext-link>). All current parameter files included in the software, and described in the tutorials above, are based on this model, except for the gamma tutorial whose parameter file has local network modifications as described above.</p><p>HNN’s underlying neocortical model is simulated using the NEURON simulation environment with the Python interpreter (see Key Resources Table). HNN’s model is simulated across multiple cores in parallel using the message-passing interface (MPI). HNN’s Run Parameters dialog box can be accessed through the GUI and provides access to commonly used simulation parameters, including integration time-step (dt), simulation duration (milliseconds), number of trials, neuronal firing threshold (mV), and number of cores over which to parallelize the model.</p><p>The model represents a canonical neocortical circuit. It contains multi-compartment pyramidal neurons (PN) in supragranular and infragranular layers (layers 2/3 and 5, respectively), whose apical dendrites are spatially aligned and span the cortical layers. In both layers, the PNs have two basal, one oblique, and one apical dendrite branch, and the layer 2/3 PNs have shorter apical dendrites than layer 5 PNs.</p><p>The PNs are synaptically coupled to each other and to a subset of inhibitory neurons in each layer, and are included in the model in a 3/1 PN-to-interneuron ratio, with a scalable number of PNs. The inhibitory neurons are simulated with single compartments representing fast spiking basket cells, and are shown in yellow in (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Note that the granular layer is not explicitly included in the template circuit. This design choice was based on the fact that macroscale current dipoles are dominated by PN activity in supragranular, and infragranular layers, due to their alignment (see Calculation of Primary Electrical Current). Thalamic input to granular layers is presumed to propagate directly to basal and oblique dendrites of PN in layer 2/3 and 5.</p></sec></sec><sec id="s4-2"><title>Detailed neuronal morphology and physiology</title><sec id="s4-2-1"><title>Morphology</title><p>The morphology of the PN in each layer (see <xref ref-type="fig" rid="fig3">Figure 3</xref>, and <xref ref-type="table" rid="table1">Table 1</xref>) were adapted from the morphology reduction procedure in <xref ref-type="bibr" rid="bib12">Bush and Sejnowski (1993)</xref>. In <xref ref-type="bibr" rid="bib12">Bush and Sejnowski (1993)</xref>, digitized HRP-filled pyramidal neurons from layers 2 and 5 of cat visual cortex consisting of 400 compartments were reduced to 8 and 9 compartments, respectively. This procedure is important for HNN’s purposes because the axial conductance is the basis of the primary current dipole calculation (see below).</p><p>The reduction procedure was based on conserving the axial conductance between compartments in the cells rather than the surface area of the dendritic tree. This reduction retained the general morphology of the neurons and allowed for accurate position of synaptic inputs and ionic conductances on individual cells, and construction of spatially accurate network models. The reduced model contained active conductances in the somatic compartents and retaining faithful electrical responses to injected current. In HNN, a scaling factor of 1.3 was applied to the length and diameters of the dendritic compartments to account for increases in dendritic length and volume in human somatosensory neurons, as predicted by larger cortical thickness (<xref ref-type="bibr" rid="bib21">Fischl and Dale, 2000</xref>; <xref ref-type="bibr" rid="bib24">Geyer et al., 1997</xref>) and an increase in the number of dendritic spines and arborization (<xref ref-type="bibr" rid="bib19">Elston et al., 2001</xref>). Additional active ionic conductances were added to the dendritic compartments, as detailed below, and the neurons were embedded in a cortical column network with single compartment inhibitory neurons. The radial geometry of the inhibitory neuron dendrites does not contribute to the primary current dipole calculation. The morphology of each cell was as follows:</p><list list-type="simple"><list-item><p>Layer 2/3</p><list list-type="bullet"><list-item><p>PN: 8 compartments including four apical dendrites, three basal dendrites, one soma</p></list-item> <list-item><p>Inhibitory basket neurons: single compartment (soma)</p></list-item></list> </list-item> <list-item><p>Layer 5</p></list-item> <list-item><list list-type="bullet"><list-item><p>PN: 9 compartments including five apical dendrites, three basal dendrites, one soma.</p></list-item> <list-item><p>As shown below, L5 PNs have longer dendrites than L2/3 PNs. L5 PN somas are based in L5 with long apical dendrites reaching into L2/3.</p></list-item> <list-item><p>Inhibitory Basket neurons: single compartment (soma).</p></list-item> <list-item><p>L2/3 and L5 basket interneurons are identical but their synaptic parameters and local circuit connectivity differs.</p></list-item></list> </list-item></list><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Length (<inline-formula><mml:math id="inf1"><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:math></inline-formula>), diameter (<inline-formula><mml:math id="inf2"><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:math></inline-formula>) of compartments in each modeled neuron type.</title><p>Adend (Bdend) represent apical (basal) dendrite. Note the following connectivity for compartments of PNs. The non-oblique Adends of PNs are connected vertically along the Z axis (cortical layer axis from supra- to infragranular layers) from soma → Adend trunk → Adend1 → Adend2 → Adend tuft. The smaller L2/3 PNs do not have an Adend2 compartment. PN Adend oblique are connected to the soma and perpendicular to the Z axis. Bdend1 connects to the soma along the Z axis, and Bdend2 and Bdend3 branch from Bdend1 at a 45 degree angle from the Z axis. L2/3 and L5 basket interneurons have a single somatic compartment. N/A indicates non-applicable, since that specific compartment not present in the neuron type. Geometry illustrated in Figure 3 above.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Type</th><th valign="top">Soma</th><th valign="top">Adend trunk</th><th valign="top">Adend1</th><th valign="top">Adend2</th><th valign="top">Adend tuft</th><th valign="top">Adend oblique</th><th valign="top">Bdend1</th><th valign="top">Bdend2</th><th valign="top">Bdend3</th></tr></thead><tbody><tr><td valign="top">L2/3 PN</td><td valign="top">22.1, 23.4</td><td valign="top">59.5, 4.3</td><td valign="top">306.0, 4.1</td><td valign="top">N/A</td><td valign="top">238.0, 3.4</td><td valign="top">340.0, 3.9</td><td valign="top">85.0, 4.3</td><td valign="top">255.0, 2.7</td><td valign="top">255.0, 2.7</td></tr><tr><td valign="top">L2/3 basket</td><td valign="top">39.0, 20.0</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td></tr><tr><td valign="top">L5 PN</td><td valign="top">39.0, 28.9</td><td valign="top">102.0, 10.2</td><td valign="top">680.0, 7.5</td><td valign="top">680.0, 4.9</td><td valign="top">425.0, 3.4</td><td valign="top">255.0, 5.1</td><td valign="top">85.0, 6.8</td><td valign="top">255.0, 8.5</td><td valign="top">255.0, 8.5</td></tr><tr><td valign="top">L5 basket</td><td valign="top">39.0, 20.0</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">N/A</td></tr></tbody></table></table-wrap></sec></sec><sec id="s4-3"><title>Physiology</title><p>Membrane voltages in each simulated compartment were calculated using the standard Hodgkin-Huxley parallel conductance equations, and current flow between compartments follows from cable theory as accounted for in NEURON.</p><p>Extending the prior work of <xref ref-type="bibr" rid="bib12">Bush and Sejnowski (1993)</xref>, active ionic currents were included in both the somatic and dendritic compartment of the cells of the pyramidal neurons, and in the single compartment of the inhibitory neurons. For the pyramidal neurons, the membrane resistance was increased and membrane capacitance was decreased from the Bush and Sejnowski’s values by the same 1.3 scaling factor as the compartment sizes described above (<bold>R</bold><sub>m</sub>23,474 cm<sup>2</sup> for L5 and L2/3; <bold>C</bold><sub>m</sub> 0.85 and <bold>C</bold><sub>m</sub>0.6195 F/cm2 for L5 and L2/3, respectively) to maintain the input resistances in the cells of 45 M for the L5 and 110 M for L2/3 (<xref ref-type="bibr" rid="bib17">Douglas et al., 1991</xref>). The axial resistance for each cell was <bold>R</bold><sub>a</sub>200 cm (<xref ref-type="bibr" rid="bib71">Segev et al., 1992</xref>). The parameters regulating the active currents were tuned to replicate known in vitro firing patterns in response to somatic current injection.</p><p>The kinetic equations and NEURON code used for each of these currents were as used by <xref ref-type="bibr" rid="bib52">Mainen and Sejnowski (1996)</xref> and downloaded from <ext-link ext-link-type="uri" xlink:href="http://senselab.med.yale.edu/senselab/modeldb/">http://senselab.med.yale.edu/senselab/modeldb/</ext-link>. The maximal conductances of each current were constant throughout the soma and dendrite (<xref ref-type="bibr" rid="bib5">Bekkers, 2000</xref>; <xref ref-type="bibr" rid="bib48">Korngreen and Sakmann, 2000</xref>; <xref ref-type="bibr" rid="bib53">Migliore and Shepherd, 2002</xref>; <xref ref-type="bibr" rid="bib78">Stuart and Sakmann, 1994</xref>) and were chosen to produce adapting spikes in the L2/3 PNs and bursting in the L5 PNs to current injected in the soma (1 nA for 100 ms) representative of neurons classified as regular spiking and intrinsically bursting, respectively (<xref ref-type="bibr" rid="bib54">Moore and Nelson, 1998</xref>; <xref ref-type="bibr" rid="bib74">Silva et al., 1991</xref>; <xref ref-type="bibr" rid="bib87">Zhu and Connors, 1999</xref>).</p><p>The inhibitory neurons were tuned to represent basket cells and produced regular fast spiking dynamics to injected current, as in other cortical network models (<xref ref-type="bibr" rid="bib23">Garabedian et al., 2003</xref>; <xref ref-type="bibr" rid="bib39">Jones et al., 2000</xref>; <xref ref-type="bibr" rid="bib63">Pinto et al., 2003</xref>).</p><p>The following table displays the ion channels and mechanisms in each cell type in the model (X) indicates the presence of the channel/mechanism in the cell type, see online code for full equations.</p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th valign="top">Cell type (rows) Channel/mechanism Type (columns)</th><th valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/mod/hh2.mod">Na (fast)</ext-link></th><th valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/mod/hh2.mod">K (fast)</ext-link></th><th valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/mod/km.mod">Km</ext-link></th><th valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/mod/kca.mod">KCa</ext-link></th><th valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/mod/ca.mod">Ca (L</ext-link><ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/mod/ca.mod">-type)</ext-link></th><th valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/mod/cat.mod">Ca (T-type)</ext-link></th><th valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/mod/cad.mod">Ca decay</ext-link></th><th valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/mod/ar.mod">HCN</ext-link></th><th valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/neuronsimulator/nrn/blob/master/src/nrnoc/passive.mod">Leak</ext-link></th><th valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn/blob/master/mod/dipole_pp.mod">Dipole</ext-link></th></tr></thead><tbody><tr><td valign="top">Basket</td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"><bold>X</bold></td><td valign="top"/></tr><tr><td valign="top">L2/3 Pyramidal</td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td></tr><tr><td valign="top">L5 Pyramidal</td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td valign="top"><bold>X</bold></td><td><bold>X</bold></td></tr></tbody></table></table-wrap><p>In the table above, Na (fast)/K (fast) are the fast sodium and potassium channels responsible for generating action potentials. Km is the muscarine sensitive potassium channel, with a relatively slow time-constant and KCa is the calcium-dependent potassium channel, which contributes to hyperpolarization after calcium influx into the cell. The L- and T-type calcium (Ca) channels represent the high-threshold and low-threshold activated calcium channels which together with the hyperpolarization-activated cyclic nucleotide gated channel (HCN) contribute to bursting. Ca decay represents the calcium extrusion pump, which causes intracellular calcium to decay towards a baseline level. Leak represents the passive channel, with constant conductance. Dipole represents the mechanism that takes into account the primary axial current flow within pyramidal neuron dendrites, responsible for the generation of simulated signals comparable to MEG/EEG recordings. For more details see <xref ref-type="bibr" rid="bib41">Jones et al. (2009)</xref>.</p></sec><sec id="s4-4"><title>Local network connections</title><p>HNN’s default template neocortical model includes neurons arranged in three dimensions. The <italic>XY</italic> plane is used to array cells on a regular grid while the Z-axis specifies cortical layer. HNN’s default model contains a regular 10 × 10 grid (arbitrary units) of pyramidal neurons in layer 2/3 and layer five for a total of 200 pyramidal neurons, with interneurons interleaved regularly in a 3–1 ratio (see <xref ref-type="fig" rid="fig3">Figure 3D</xref>). The local synaptic architecture in <xref ref-type="fig" rid="fig3">Figure 3A</xref> was based on an abundance of animal studies and, in particular, studies of the mouse/rat somatosensory cortex (<xref ref-type="bibr" rid="bib6">Bernardo et al., 1990a</xref>; <xref ref-type="bibr" rid="bib7">Bernardo et al., 1990b</xref>; for review, see <xref ref-type="bibr" rid="bib81">Thomson et al., 2002</xref>; <xref ref-type="bibr" rid="bib83">Thomson and Bannister, 2003</xref>, and <xref ref-type="bibr" rid="bib3">Bannister, 2005</xref>). Inhibitory synaptic connections onto PNs were located on the soma (<xref ref-type="bibr" rid="bib22">Freund et al., 1986</xref>; <xref ref-type="bibr" rid="bib47">Kisvárday et al., 1985</xref>; <xref ref-type="bibr" rid="bib77">Somogyi et al., 1983</xref>), and excitatory synapses contacted the basal and apical oblique dendrites (<xref ref-type="bibr" rid="bib16">Deuchars et al., 1994</xref>; <xref ref-type="bibr" rid="bib20">Feldmeyer et al., 2002</xref>; <xref ref-type="bibr" rid="bib51">Lübke et al., 1996</xref>; <xref ref-type="bibr" rid="bib82">Thomson and Bannister, 1998</xref>).</p><p>Synaptic dynamics were modeled with bi-exponential functions. The rise and decay time constants and reversal potentials were based on experiments and the original neocortical model in <xref ref-type="bibr" rid="bib41">Jones et al. (2009)</xref>, and are generally as follows: AMPA (0.5 ms, 1.0 ms, 0 mV); NMDA (1.0 ms, 20.0 ms, 0 mV); GABAA (0.5 ms, 5.0 ms, −80 mV), GABAB (1.0 ms, 20.0 ms, −80 mV). Within a cortical layer there is recurrent connectivity between neurons of a given type (PN to PN, interneuron to interneuron), PN to interneuron connectivity, and synaptic inhibition from interneurons onto PNs. The following synaptic connections are present across cortical layers: layer 2/3 PNs to layer 5 PNs, layer 2/3 interneurons to layer 5 PNs, layer 2/3 PNs to layer five interneurons.</p><p>The conductance of the synaptic connections within the local network grid were defined with a symmetric 2D Gaussian spatial profile, with a delay incorporate into the synaptic connection between two cells defined by and inverse Gaussian (<xref ref-type="bibr" rid="bib38">Jones, 1986</xref>; <xref ref-type="bibr" rid="bib44">Kaas and Garraghty, 1991</xref>). There is all-to-all connectivity between any two populations of synaptically-coupled neurons. Synaptic <italic>weights</italic> between the neurons are scaled inversely by the distance in the XY plane (arbitrary units) between the neurons (<inline-formula><mml:math id="inf3"><mml:mi>d</mml:mi></mml:math></inline-formula>) using exponential fall-off following <inline-formula><mml:math id="inf4"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>, and space constant <inline-formula><mml:math id="inf5"><mml:mi>λ</mml:mi></mml:math></inline-formula>, which depends on pre- and post-synaptic type (<xref ref-type="table" rid="table2">Table 2</xref> below).</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Space constant (arbitrary units) for synaptic connection strengths and delays between different populations of neurons (rows are pre-synaptic type, columns are post-synaptic type).</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">(From ↓, To →)</th><th valign="top">L2/3 PN</th><th valign="top">L2/3 Basket</th><th valign="top">L5 pn</th><th valign="top">L5 basket</th></tr></thead><tbody><tr><td valign="top">L2/3 PN</td><td valign="top">3</td><td valign="top">3</td><td valign="top">3</td><td valign="top">3</td></tr><tr><td valign="top">L2/3 Basket</td><td valign="top">50</td><td valign="top">20</td><td valign="top">50</td><td valign="top">N/A</td></tr><tr><td valign="top">L5 PN</td><td valign="top">3</td><td valign="top">N/A</td><td valign="top">3</td><td valign="top">3</td></tr><tr><td valign="top">L5 Basket</td><td valign="top">N/A</td><td valign="top">N/A</td><td valign="top">70</td><td valign="top">20</td></tr></tbody></table></table-wrap><p>The synaptic <italic>delays</italic> are scaled in proportion to the XY plane distance (<inline-formula><mml:math id="inf6"><mml:mi>d</mml:mi></mml:math></inline-formula>) between the neurons following <inline-formula><mml:math id="inf7"><mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, to account for the larger propagation distance (note that the <inline-formula><mml:math id="inf8"><mml:mi>λ</mml:mi></mml:math></inline-formula> value is determined using values in <xref ref-type="table" rid="table2">Table 2</xref>). With increasing <inline-formula><mml:math id="inf9"><mml:mi>d</mml:mi></mml:math></inline-formula> between neurons, the synaptic weights decay, while the synaptic delays increase. The connectivity details are based on known neocortical anatomy and local circuit wiring patterns, as derived from the literature. Further details on connectivity are available on HNN’s website and prior publications.</p></sec><sec id="s4-5"><title>Exogenous driving inputs</title><p>At rest, the default model does not generate activity. HNN provides several ways to activate the local cortical column with layer specific excitatory synaptic input representing thalamo-cortical, and/or cortical-cortical and noisy/tonic drive. The user defines the choice of driving input to the network, based on their simulation experiment, as described in Results.</p><p>Exogenous driving networks are not explicitly modeled, rather the user defines trains or bursts of action potentials representing these inputs that excite the local network via AMPA or NMDA synaptic connections to distinct layers and cellular compartments. These inputs are referred to as proximal and distal drive based on the PN dendritic contact location. Proximal inputs contact basal and oblique dendrites of PN and somas of the inhibitory neurons in L2/3 and L5, and distal inputs contact distal dendrites of the PN in L2/3 and L5 and somas of the inhibitory neurons in L2/3 only, as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p><p>The trains of action potentials, or tonic/noisy input, that the user defines are created in specific dialog boxes in the GUI and represent either Evoked, Rhythmic, Tonic, or Poisson Inputs, as motivated by our prior studies and tutorials described in Results.</p><sec id="s4-5-1"><title>Evoked input</title><p>Evoked inputs are trains of synaptic inputs to the local network during a sensory stimulus that creates an event related potential (ERP). Parameter choices for defining these inputs are shown in <xref ref-type="fig" rid="fig4">Figure 4A</xref>. The following parameter values are used to define each proximal or distal evoked input:</p><list list-type="bullet"><list-item><p>Start time mean (ms) - average start time</p></list-item> <list-item><p>Start time stdev (ms) - standard deviation of start time</p></list-item> <list-item><p>Number spikes - number of inputs provided to each synapse</p></list-item> <list-item><p>L2/3 Pyr weight AMPA/NMDA (<inline-formula><mml:math id="inf10"><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula>) - weight of AMPA/NMDA synaptic inputs to layer 2/3 pyramidal neurons</p> </list-item> <list-item><p>L2/3 Basket weight AMPA/NMDA (<inline-formula><mml:math id="inf11"><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula>) - weight of AMPA/NMDA synaptic inputs to layer /32 basket cells</p></list-item> <list-item><p>L5 Pyr weight AMPA/NMDA (<inline-formula><mml:math id="inf12"><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula>) - weight of AMPA/NMDA synaptic inputs to layer 5 pyramidal neurons</p> </list-item> <list-item><p>L5 Basket weight AMPA/NMDA (<inline-formula><mml:math id="inf13"><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula>) - weight of AMPA/NMDA synaptic inputs to layer 5 basket cells (only used for <italic>proximal</italic> inputs)</p></list-item></list><p>Each evoked input also has a ‘Synchronous Inputs’ option, indicating whether for a specific evoked proximal/distal input each neuron receives the input at the same time, or if instead each neuron receives the evoked input events independently drawn from the same distribution. Increment input (ms) indicates whether to increment the Start time of all evoked inputs on each trial. In the studies described above, the evoked input strengths are suprathreshold generating action potentials in the local network.</p></sec><sec id="s4-5-2"><title>Rhythmic input</title><p>Rhythmic Inputs are typically bursts of action potentials that drive the local network rhythmically. Parameter choices for defining these inputs are shown in <xref ref-type="fig" rid="fig7">Figure 7A</xref>. Each rhythmic input is defined as a series of ‘population bursts’, consisting of a set number of ‘burst units’ which drive post-synaptic conductances in the local network with a set frequency and mean delay between proximal and distal projections. Rhythmic proximal and distal inputs target different cortical layers, as described above. HNN allows setting proximal and distal rhythmic synaptic input start/stop times and frequencies using the following specification:</p><list list-type="bullet"><list-item><p>Start time mean (ms) - specifies the average start time for rhythmic inputs</p></list-item> <list-item><p>Start time stdev (ms) - specifies the standard deviation of start times for rhythmic inputs</p></list-item> <list-item><p>Stop time (ms) - specifies when the rhythmic inputs should be turned off</p></list-item> <list-item><p>Burst frequency (Hz) - average frequency of bursts</p></list-item> <list-item><p>Burst stdev (ms) - standard deviation of input events</p></list-item> <list-item><p>Spikes/burst - provides <italic>n</italic> synaptic events at each selected time</p></list-item> <list-item><p>Number bursts - number of times the full Burst sequence is repeated (each repeat adds variability and more inputs)</p></list-item></list><p>In addition, HNN’s Rhythmic Input dialog box allows setting the weights of the rhythmic synaptic inputs (units of conductance) to individual neuron types in layers 2/3 and 5, and adding synaptic delays (ms) before the neurons receive the synaptic inputs. In the studies described above, rhythmic inputs are set to sub-threshold synaptic strengths, and therefore do not lead to neuronal action potentials.</p></sec><sec id="s4-5-3"><title>Tonic/Noisy Input</title><p>Tonic inputs are modeled as somatic current clamps with a fixed current amplitude (nA). These clamps can be used to adjust the resting membrane potential of a neuron, and bring it closer (with positive amplitude injection) or further from firing threshold (with a negative amplitude injection). Parameter choices for defining these inputs are shown in <xref ref-type="fig" rid="fig9">Figure 9A</xref> and include setting the current clamp amplitude, and start/stop time for each modeled neuron type separately.</p><p>Noisy Inputs are trains of action potentials that follow a Poisson Process and create excitatory AMPA or NMDA synaptic inputs to the somata of all neurons of a given type. Parameter choices for defining these inputs are shown in <xref ref-type="fig" rid="fig9">Figure 9A</xref> and include, setting the average frequency of the Poisson drive, synaptic strength to somatic AMPA or NMDA synapses, and start/stop times of all Poisson inputs.</p></sec></sec><sec id="s4-6"><title>Calculation of primary electrical current (Net Current Dipole)</title><p>Axial current flow between any two neighboring model compartments i,j is defined as i<sub>axial</sub> = (v<sub>i</sub> - v<sub>j</sub>)/r<sub>axial</sub>, where v<sub>i</sub>, v<sub>j</sub>, and r<sub>axial</sub> are the voltages in compartment i, j, and the resistance between the compartments, respectively. In order to convert this axial current into a dipole signal, we apply a length scaling where the axial current is scaled by the inter-compartment distance along the vertical axis. The length scaling means that for the longer apical dendrites of layer five pyramidal neurons, the contribution will be larger than from the shorter layer 2/3 pyramidal neuron apical dendrites. Note that the orientation of the dendrites relative to the vertical axis also influences the contribution to the dipole signal. For example, the horizontally-oriented oblique dendrites which do not have any vertical length component, do not contribute to the dipole signal, whereas for basal dendrites oriented at 45 degrees from the vertical axis, the scaling is <inline-formula><mml:math id="inf14"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> (note the negative sign is because these dendrites are pointing downward). The contribution from all neighboring compartments within a neuron is integrated and then added to a value across the set of all pyramidal neurons. As a result of the multiplication between axial current and length, the model dipole output signal has the same units of measure as the experimental data (Am) (<xref ref-type="bibr" rid="bib59">Okada et al., 1997</xref>; <xref ref-type="bibr" rid="bib55">Murakami et al., 2003</xref>; <xref ref-type="bibr" rid="bib56">Murakami and Okada, 2006</xref>; <xref ref-type="bibr" rid="bib40">Jones et al., 2007</xref>; <xref ref-type="bibr" rid="bib28">Hagen et al., 2018</xref>).</p></sec><sec id="s4-7"><title>ERP optimization tools</title><p>HNN includes a method to optimize ERP simulations. The optimization procedure was uniquely designed to minimize the RMSE between model output and ERP waveforms in a stepwise manner that decreases parameter exploration and saves compute time. This procedure takes advantage of the assumption that the exogenous proximal and distal driving inputs are essential parameters to tune to get an accurate representation of an ERP waveform. Additionally, it applies the knowledge that, with probabilistic certainty, features of the dipole waveform at a particular point in time cannot be influenced by an exogenous driving input that begins after that point in time.</p><p>Since exogenous inputs are modeled as Gaussian processes, the likelihood of occurrence can be modeled by a probability distribution function (PDF) normally distributed with a given mean and standard deviation. <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1A</xref> shows the PDFs of the inputs for the suprathreshold example described in the results <xref ref-type="fig" rid="fig11">Figure 11</xref>. An input’s contribution to the ERP will begin when there is a non-zero probability of occurrence and persist for a duration commensurate with the input’s cumulative distribution function (CDF), shown in <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1B</xref>. This clearly illustrates that from 20 to 50 ms, the input labeled ‘Proximal 1’ is the unique contributor to the waveform. After 50 ms, effects from Distal one begin, thus adding new parameters that contribute to the waveform fit and reduce the relative contribution of Proximal 1 (from full to partial). It follows that each successive driving input will have a time window where it is most likely to have a unique and dominant effect. As such, our approach to model optimization is to divide the process into smaller steps where only a single input’s parameters are estimated before proceeding to optimize the next input.</p><p>To implement this procedure, we developed a new goodness of fit measure that amplifies the importance of maximizing the fit at points of unique contribution (e.g. 20–50 ms for Proximal 1, <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1C</xref>) and diminished the importance of fitting to later points where other inputs contribute more to the fit. We began with standard root mean squared error (RMSE)<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:msqrt></mml:mrow></mml:mstyle></mml:math></disp-formula>where <italic>t</italic> is the current simulation time, from 0 to simulation completion (<italic>T</italic>), and <italic>x<sub>1,t</sub></italic> is the simulated dipole at <italic>t,</italic> and <italic>x<sub>2,t</sub></italic> is the experimental data point. Then we adapted RMSE to include weight functions specific for input <italic>k</italic> at time <italic>t</italic>,<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:msub><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mstyle></mml:math></disp-formula>where an assignment of <italic>w<sub>k</sub>(t)</italic>=1 for all <italic>t</italic> would be equivalent to RMSE.</p><p>For each input <italic>k</italic>, we first defined a weight distribution function, <italic>w<sub>k</sub>(t)</italic>, as the Unique Contribution Index (UCI), which starts from the CDF of input <italic>k</italic> and simply subtracts the CDF of subsequent inputs, with a lower bound of 0 (<xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1C</xref>). Equivalently,<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <italic>N</italic> is the number of exogenous driving inputs in the simulation. <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1C</xref> shows that Proximal 1’s influence is unique up to 50 ms, Distal one has a dominant, but not unique contribution near 70 ms, and Proximal two is dominant after ~100 ms. When the UCI is applied as a weighting function in the wRMSE equation above, we observed that some optimization steps would negatively impact the fit in regions after the peak in UCI, where the errors had been down-weighted, requiring subsequent optimization steps to attempt to ‘correct’ the fit. Our solution was to instead define the weight function using the Extended Contribution Index (ECI), which includes a term that delays the weight function’s return to 0, extending the window of data points that have an impact on wRMSE further into the simulation. This achieves a balance between optimal parameter estimates for the current step and providing a good starting point for following optimization steps. ECI is defined by<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where μ<sub>i</sub> and μ<sub>k</sub> are the mean start times of the next input and the current input, respectively. Simulation length is represented by <italic>T</italic> and <italic>A</italic> is an empirically derived constant. We arrived at a value of 1.6 for <italic>A</italic> as a factor that appropriately minimized the contribution of inputs proportional to the delay between their onset and the <italic>k</italic><sup>th</sup> input currently being optimized. The effect of the ECI’s decay term can be seen in <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1D</xref> where the ECI for Proximal one extends further than the corresponding UCI, and the ECI of Distal one remains significant through the end of the simulation. Since points where ECI<sub>k,t</sub> approximately equal 0 will have a negligible impact on wRMSE<sub>k</sub>, we define a threshold of 0.01 where wRMSE<sub>k</sub> is calculated for the window starting when ECI<sub>k,t</sub> rises above 0.01 and ending when ECI<sub>k,t</sub> drops below 0.01. For the first exogenous driving input, it is likely that the window will end before the completion of the simulation. In that first step, simulations can be stopped early, reducing the time required for simulating each candidate parameter set in that step.</p><p>The final step in our model optimization process is to vary all free parameters from all inputs using regular RMSE to measure goodness of fit. Like each previous step, the number of simulations run is limited. So this primary purpose of this final step is to make small corrections, not perform all-at-once optimization (which would likely require thousands of simulations). It also provides an opportunity to rebalance the contributions from multiple inputs in regions where there is a high degree of parameter inter-dependence. However, if the user is certain that they want to perform all-at-once optimization (which would likely require many more simulations), they could set the number of simulations for all steps except the last one to 0, and specify a very large number of simulations for the final step.</p><p>For each optimization step, HNN uses the COBYLA optimization algorithm (<xref ref-type="bibr" rid="bib64">Powell, 1994</xref>), which supports bound constraints as defined by the user for each parameter. We have found COBYLA converges at a local minimum faster than the PRAXIS algorithm (<xref ref-type="bibr" rid="bib11">Brent, 1973</xref>) as implemented in NEURON’s multiple run fitter.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>Research supported by NIH NIBIB BRAIN Award 5-R01-EB022889-02, NIH NIBIB BRAIN Award Supplement R01EB022889-02S1, NIH NIDCD 5-R01DC012947-07, ARO W911NF-19-1-0402. We thank Dimitrios Pantazis and colleagues for supplying source localized data for our gamma tutorial.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Summary of weighted total Sobol sensitivity index values averaged across the entire simulation for each exogenous driving input in two sensory evoked response models: suprathreshold (<xref ref-type="fig" rid="fig11">Figure 11</xref>) and 50% detected (<xref ref-type="fig" rid="fig4">Figure 4</xref>)﻿.</title><p>The ranking of each input’s parameters is similar between models.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-51214-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-51214-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All source-code, model parameters, and associated data are provided in a permanent public-accessible repository on github (<ext-link ext-link-type="uri" xlink:href="https://github.com/jonescompneurolab/hnn">https://github.com/jonescompneurolab/hnn</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexanderian</surname> <given-names>A</given-names></name><name><surname>Gremaud</surname> <given-names>PA</given-names></name><name><surname>Smith</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Variance-based sensitivity analysis for time-dependent processes</article-title><source>Reliability Engineering &amp; System Safety</source><volume>196</volume><elocation-id>106722</elocation-id><pub-id pub-id-type="doi">10.1016/j.ress.2019.106722</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Badre</surname> <given-names>D</given-names></name><name><surname>Frank</surname> <given-names>MJ</given-names></name><name><surname>Moore</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Interactionist neuroscience</article-title><source>Neuron</source><volume>88</volume><fpage>855</fpage><lpage>860</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.10.021</pub-id><pub-id pub-id-type="pmid">26637794</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bannister</surname> <given-names>AP</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Inter- and intra-laminar connections of pyramidal cells in the neocortex</article-title><source>Neuroscience Research</source><volume>53</volume><fpage>95</fpage><lpage>103</lpage><pub-id pub-id-type="doi">10.1016/j.neures.2005.06.019</pub-id><pub-id pub-id-type="pmid">16054257</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barrès</surname> <given-names>V</given-names></name><name><surname>Simons</surname> <given-names>A</given-names></name><name><surname>Arbib</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Synthetic event-related potentials: a computational bridge between neurolinguistic models and experiments</article-title><source>Neural Networks</source><volume>37</volume><fpage>66</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2012.09.021</pub-id><pub-id pub-id-type="pmid">23177656</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bekkers</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Properties of voltage-gated potassium currents in nucleated patches from large layer 5 cortical pyramidal neurons of the rat</article-title><source>The Journal of Physiology</source><volume>525</volume><fpage>593</fpage><lpage>609</lpage><pub-id pub-id-type="doi">10.1111/j.1469-7793.2000.t01-1-00593.x</pub-id><pub-id pub-id-type="pmid">10856115</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernardo</surname> <given-names>KL</given-names></name><name><surname>McCasland</surname> <given-names>JS</given-names></name><name><surname>Woolsey</surname> <given-names>TA</given-names></name></person-group><year iso-8601-date="1990">1990a</year><article-title>Local axonal trajectories in mouse barrel cortex</article-title><source>Experimental Brain Research</source><volume>82</volume><fpage>247</fpage><lpage>253</lpage><pub-id pub-id-type="doi">10.1007/BF00231244</pub-id><pub-id pub-id-type="pmid">2286230</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernardo</surname> <given-names>KL</given-names></name><name><surname>McCasland</surname> <given-names>JS</given-names></name><name><surname>Woolsey</surname> <given-names>TA</given-names></name><name><surname>Strominger</surname> <given-names>RN</given-names></name></person-group><year iso-8601-date="1990">1990b</year><article-title>Local intra- and interlaminar connections in mouse barrel cortex</article-title><source>The Journal of Comparative Neurology</source><volume>291</volume><fpage>231</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1002/cne.902910207</pub-id><pub-id pub-id-type="pmid">2298933</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bollimunta</surname> <given-names>A</given-names></name><name><surname>Mo</surname> <given-names>J</given-names></name><name><surname>Schroeder</surname> <given-names>CE</given-names></name><name><surname>Ding</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Neuronal mechanisms and attentional modulation of corticothalamic α oscillations</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>4935</fpage><lpage>4943</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5580-10.2011</pub-id><pub-id pub-id-type="pmid">21451032</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breakspear</surname> <given-names>M</given-names></name><name><surname>Williams</surname> <given-names>LM</given-names></name><name><surname>Stam</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>A novel method for the topographic analysis of neural activity reveals formation and dissolution of 'Dynamic Cell Assemblies'</article-title><source>Journal of Computational Neuroscience</source><volume>16</volume><fpage>49</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1023/B:JCNS.0000004841.66897.7d</pub-id><pub-id pub-id-type="pmid">14707544</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breakspear</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dynamic models of large-scale brain activity</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>340</fpage><lpage>352</lpage><pub-id pub-id-type="doi">10.1038/nn.4497</pub-id><pub-id pub-id-type="pmid">28230845</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Brent</surname> <given-names>RP</given-names></name></person-group><year iso-8601-date="1973">1973</year><source>Algorithms for Minimization Without Derivatives</source><publisher-loc>Englewood Cliffs</publisher-loc><publisher-name>Prentice-Hall</publisher-name></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname> <given-names>PC</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Reduced compartmental models of neocortical pyramidal cells</article-title><source>Journal of Neuroscience Methods</source><volume>46</volume><fpage>159</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1016/0165-0270(93)90151-G</pub-id><pub-id pub-id-type="pmid">8474259</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname> <given-names>G</given-names></name><name><surname>Logothetis</surname> <given-names>N</given-names></name><name><surname>Singer</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Scaling brain size, keeping timing: evolutionary preservation of brain rhythms</article-title><source>Neuron</source><volume>80</volume><fpage>751</fpage><lpage>764</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.10.002</pub-id><pub-id pub-id-type="pmid">24183025</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname> <given-names>G</given-names></name><name><surname>Wang</surname> <given-names>XJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Mechanisms of gamma oscillations</article-title><source>Annual Review of Neuroscience</source><volume>35</volume><fpage>203</fpage><lpage>225</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-062111-150444</pub-id><pub-id pub-id-type="pmid">22443509</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardin</surname> <given-names>JA</given-names></name><name><surname>Carlén</surname> <given-names>M</given-names></name><name><surname>Meletis</surname> <given-names>K</given-names></name><name><surname>Knoblich</surname> <given-names>U</given-names></name><name><surname>Zhang</surname> <given-names>F</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name><name><surname>Tsai</surname> <given-names>LH</given-names></name><name><surname>Moore</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Driving fast-spiking cells induces gamma rhythm and controls sensory responses</article-title><source>Nature</source><volume>459</volume><fpage>663</fpage><lpage>667</lpage><pub-id pub-id-type="doi">10.1038/nature08002</pub-id><pub-id pub-id-type="pmid">19396156</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deuchars</surname> <given-names>J</given-names></name><name><surname>West</surname> <given-names>DC</given-names></name><name><surname>Thomson</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Relationships between morphology and physiology of pyramid-pyramid single axon connections in rat neocortex in vitro</article-title><source>The Journal of Physiology</source><volume>478</volume><fpage>423</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1994.sp020262</pub-id><pub-id pub-id-type="pmid">7965856</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Douglas</surname> <given-names>RJ</given-names></name><name><surname>Martin</surname> <given-names>KA</given-names></name><name><surname>Whitteridge</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>An intracellular analysis of the visual responses of neurones in cat visual cortex</article-title><source>The Journal of Physiology</source><volume>440</volume><fpage>659</fpage><lpage>696</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1991.sp018730</pub-id><pub-id pub-id-type="pmid">1804981</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dura-Bernal</surname> <given-names>S</given-names></name><name><surname>Suter</surname> <given-names>BA</given-names></name><name><surname>Gleeson</surname> <given-names>P</given-names></name><name><surname>Cantarelli</surname> <given-names>M</given-names></name><name><surname>Quintana</surname> <given-names>A</given-names></name><name><surname>Rodriguez</surname> <given-names>F</given-names></name><name><surname>Kedziora</surname> <given-names>DJ</given-names></name><name><surname>Chadderdon</surname> <given-names>GL</given-names></name><name><surname>Kerr</surname> <given-names>CC</given-names></name><name><surname>Neymotin</surname> <given-names>SA</given-names></name><name><surname>McDougal</surname> <given-names>RA</given-names></name><name><surname>Hines</surname> <given-names>M</given-names></name><name><surname>Shepherd</surname> <given-names>GM</given-names></name><name><surname>Lytton</surname> <given-names>WW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>NetPyNE, a tool for data-driven multiscale modeling of brain circuits</article-title><source>eLife</source><volume>8</volume><elocation-id>e44494</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.44494</pub-id><pub-id pub-id-type="pmid">31025934</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elston</surname> <given-names>GN</given-names></name><name><surname>Benavides-Piccione</surname> <given-names>R</given-names></name><name><surname>DeFelipe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>The pyramidal cell in cognition: a comparative study in human and monkey</article-title><source>The Journal of Neuroscience</source><volume>21</volume><elocation-id>RC163</elocation-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.21-17-j0002.2001</pub-id><pub-id pub-id-type="pmid">11511694</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feldmeyer</surname> <given-names>D</given-names></name><name><surname>Lübke</surname> <given-names>J</given-names></name><name><surname>Silver</surname> <given-names>RA</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Synaptic connections between layer 4 spiny neurone-layer 2/3 pyramidal cell pairs in juvenile rat barrel cortex: physiology and anatomy of interlaminar signalling within a cortical column</article-title><source>The Journal of Physiology</source><volume>538</volume><fpage>803</fpage><lpage>822</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2001.012959</pub-id><pub-id pub-id-type="pmid">11826166</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischl</surname> <given-names>B</given-names></name><name><surname>Dale</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Measuring the thickness of the human cerebral cortex from magnetic resonance images</article-title><source>PNAS</source><volume>97</volume><fpage>11050</fpage><lpage>11055</lpage><pub-id pub-id-type="doi">10.1073/pnas.200033797</pub-id><pub-id pub-id-type="pmid">10984517</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freund</surname> <given-names>TF</given-names></name><name><surname>Maglóczky</surname> <given-names>Z</given-names></name><name><surname>Soltész</surname> <given-names>I</given-names></name><name><surname>Somogyi</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Synaptic connections, axonal and dendritic patterns of neurons immunoreactive for cholecystokinin in the visual cortex of the cat</article-title><source>Neuroscience</source><volume>19</volume><fpage>1133</fpage><lpage>1159</lpage><pub-id pub-id-type="doi">10.1016/0306-4522(86)90129-6</pub-id><pub-id pub-id-type="pmid">3029625</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garabedian</surname> <given-names>CE</given-names></name><name><surname>Jones</surname> <given-names>SR</given-names></name><name><surname>Merzenich</surname> <given-names>MM</given-names></name><name><surname>Dale</surname> <given-names>A</given-names></name><name><surname>Moore</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Band-pass response properties of rat SI neurons</article-title><source>Journal of Neurophysiology</source><volume>90</volume><fpage>1379</fpage><lpage>1391</lpage><pub-id pub-id-type="doi">10.1152/jn.01158.2002</pub-id><pub-id pub-id-type="pmid">12750410</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geyer</surname> <given-names>S</given-names></name><name><surname>Schleicher</surname> <given-names>A</given-names></name><name><surname>Zilles</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The somatosensory cortex of human: cytoarchitecture and regional distributions of receptor-binding sites</article-title><source>NeuroImage</source><volume>6</volume><fpage>27</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1006/nimg.1997.0271</pub-id><pub-id pub-id-type="pmid">9245653</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gramfort</surname> <given-names>A</given-names></name><name><surname>Luessi</surname> <given-names>M</given-names></name><name><surname>Larson</surname> <given-names>E</given-names></name><name><surname>Engemann</surname> <given-names>DA</given-names></name><name><surname>Strohmeier</surname> <given-names>D</given-names></name><name><surname>Brodbeck</surname> <given-names>C</given-names></name><name><surname>Goj</surname> <given-names>R</given-names></name><name><surname>Jas</surname> <given-names>M</given-names></name><name><surname>Brooks</surname> <given-names>T</given-names></name><name><surname>Parkkonen</surname> <given-names>L</given-names></name><name><surname>Hämäläinen</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>MEG and EEG data analysis with MNE-Python</article-title><source>Frontiers in Neuroscience</source><volume>7</volume><elocation-id>67</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2013.00267</pub-id><pub-id pub-id-type="pmid">24431986</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gramfort</surname> <given-names>A</given-names></name><name><surname>Luessi</surname> <given-names>M</given-names></name><name><surname>Larson</surname> <given-names>E</given-names></name><name><surname>Engemann</surname> <given-names>DA</given-names></name><name><surname>Strohmeier</surname> <given-names>D</given-names></name><name><surname>Brodbeck</surname> <given-names>C</given-names></name><name><surname>Parkkonen</surname> <given-names>L</given-names></name><name><surname>Hämäläinen</surname> <given-names>MS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>MNE software for processing MEG and EEG data</article-title><source>NeuroImage</source><volume>86</volume><fpage>446</fpage><lpage>460</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.10.027</pub-id><pub-id pub-id-type="pmid">24161808</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gratiy</surname> <given-names>SL</given-names></name><name><surname>Billeh</surname> <given-names>YN</given-names></name><name><surname>Dai</surname> <given-names>K</given-names></name><name><surname>Mitelut</surname> <given-names>C</given-names></name><name><surname>Feng</surname> <given-names>D</given-names></name><name><surname>Gouwens</surname> <given-names>NW</given-names></name><name><surname>Cain</surname> <given-names>N</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>Anastassiou</surname> <given-names>CA</given-names></name><name><surname>Arkhipov</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>BioNet: a Python interface to NEURON for modeling large-scale networks</article-title><source>PLOS ONE</source><volume>13</volume><elocation-id>e0201630</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0201630</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hagen</surname> <given-names>E</given-names></name><name><surname>Næss</surname> <given-names>S</given-names></name><name><surname>Ness</surname> <given-names>TV</given-names></name><name><surname>Einevoll</surname> <given-names>GT</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Multimodal modeling of neural network activity: computing LFP, ECoG, EEG, and MEG signals with LFPy 2.0</article-title><source>Frontiers in Neuroinformatics</source><volume>12</volume><elocation-id>92</elocation-id><pub-id pub-id-type="doi">10.3389/fninf.2018.00092</pub-id><pub-id pub-id-type="pmid">30618697</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hämäläinen</surname> <given-names>M</given-names></name><name><surname>Hari</surname> <given-names>R</given-names></name><name><surname>Ilmoniemi</surname> <given-names>RJ</given-names></name><name><surname>Knuutila</surname> <given-names>J</given-names></name><name><surname>Lounasmaa</surname> <given-names>OV</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Magnetoencephalography—theory, instrumentation, and applications to noninvasive studies of the working human brain</article-title><source>Reviews of Modern Physics</source><volume>65</volume><fpage>413</fpage><lpage>497</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.65.413</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hämäläinen</surname> <given-names>MS</given-names></name><name><surname>Sarvas</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Feasibility of the homogeneous head model in the interpretation of neuromagnetic fields</article-title><source>Physics in Medicine and Biology</source><volume>32</volume><fpage>91</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1088/0031-9155/32/1/014</pub-id><pub-id pub-id-type="pmid">3823145</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hämäläinen</surname> <given-names>MS</given-names></name><name><surname>Sarvas</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Realistic conductivity geometry model of the human head for interpretation of neuromagnetic data</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>36</volume><fpage>165</fpage><lpage>171</lpage><pub-id pub-id-type="doi">10.1109/10.16463</pub-id><pub-id pub-id-type="pmid">2917762</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hari</surname> <given-names>R</given-names></name><name><surname>Ilmoniemi</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Cerebral magnetic fields</article-title><source>Critical Reviews in Biomedical Engineering</source><volume>14</volume><fpage>93</fpage><lpage>126</lpage><pub-id pub-id-type="pmid">3527557</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Homma</surname> <given-names>T</given-names></name><name><surname>Saltelli</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Importance measures in global sensitivity analysis of nonlinear models</article-title><source>Reliability Engineering &amp; System Safety</source><volume>52</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1016/0951-8320(96)00002-6</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hughes</surname> <given-names>SW</given-names></name><name><surname>Crunelli</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Thalamic mechanisms of EEG alpha rhythms and their pathological implications</article-title><source>The Neuroscientist</source><volume>11</volume><fpage>357</fpage><lpage>372</lpage><pub-id pub-id-type="doi">10.1177/1073858405277450</pub-id><pub-id pub-id-type="pmid">16061522</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ikeda</surname> <given-names>H</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Okada</surname> <given-names>YC</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Origins of the somatic N20 and high-frequency oscillations evoked by trigeminal stimulation in the piglets</article-title><source>Clinical Neurophysiology</source><volume>116</volume><fpage>827</fpage><lpage>841</lpage><pub-id pub-id-type="doi">10.1016/j.clinph.2004.10.010</pub-id><pub-id pub-id-type="pmid">15792892</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jansen</surname> <given-names>BH</given-names></name><name><surname>Rit</surname> <given-names>VG</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Electroencephalogram and visual evoked potential generation in a mathematical model of coupled cortical columns</article-title><source>Biological Cybernetics</source><volume>73</volume><fpage>357</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1007/BF00199471</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jirsa</surname> <given-names>VK</given-names></name><name><surname>Haken</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Field theory of electromagnetic brain activity</article-title><source>Physical Review Letters</source><volume>77</volume><fpage>960</fpage><lpage>963</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.77.960</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>EG</given-names></name></person-group><year iso-8601-date="1986">1986</year><chapter-title>Connectivity of the Primate Sensory-Motor Cortex</chapter-title><source>Sensory-Motor Areas and Aspects of Cortical Connectivity</source><publisher-loc>Boston</publisher-loc><publisher-name>Springer</publisher-name><fpage>113</fpage><lpage>183</lpage><pub-id pub-id-type="doi">10.1007/978-1-4613-2149-1_4</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>SR</given-names></name><name><surname>Pinto</surname> <given-names>DJ</given-names></name><name><surname>Kaper</surname> <given-names>TJ</given-names></name><name><surname>Kopell</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Alpha-frequency rhythms desynchronize over long cortical distances: a modeling study</article-title><source>Journal of Computational Neuroscience</source><volume>9</volume><fpage>271</fpage><lpage>291</lpage><pub-id pub-id-type="doi">10.1023/a:1026539805445</pub-id><pub-id pub-id-type="pmid">11139043</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>SR</given-names></name><name><surname>Pritchett</surname> <given-names>DL</given-names></name><name><surname>Stufflebeam</surname> <given-names>SM</given-names></name><name><surname>Hämäläinen</surname> <given-names>M</given-names></name><name><surname>Moore</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Neural correlates of tactile detection: a combined magnetoencephalography and biophysically based computational modeling study</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>10751</fpage><lpage>10764</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0482-07.2007</pub-id><pub-id pub-id-type="pmid">17913909</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>SR</given-names></name><name><surname>Pritchett</surname> <given-names>DL</given-names></name><name><surname>Sikora</surname> <given-names>MA</given-names></name><name><surname>Stufflebeam</surname> <given-names>SM</given-names></name><name><surname>Hämäläinen</surname> <given-names>M</given-names></name><name><surname>Moore</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Quantitative analysis and biophysically realistic neural modeling of the MEG mu rhythm: rhythmogenesis and modulation of sensory-evoked responses</article-title><source>Journal of Neurophysiology</source><volume>102</volume><fpage>3554</fpage><lpage>3572</lpage><pub-id pub-id-type="doi">10.1152/jn.00535.2009</pub-id><pub-id pub-id-type="pmid">19812290</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2015">2015</year><chapter-title>Local Field Potential, Relationship to Electroencephalogram (EEG) and Magnetoencephalogram (MEG)</chapter-title><source>Encyclopedia of Computational Neuroscience</source><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name><fpage>1568</fpage><lpage>1572</lpage><pub-id pub-id-type="doi">10.1007/978-1-4614-7320-6_727-1</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>When brain rhythms aren't 'rhythmic': implication for their mechanisms and meaning</article-title><source>Current Opinion in Neurobiology</source><volume>40</volume><fpage>72</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.06.010</pub-id><pub-id pub-id-type="pmid">27400290</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaas</surname> <given-names>JH</given-names></name><name><surname>Garraghty</surname> <given-names>PE</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Hierarchical, parallel, and serial arrangements of sensory cortical Areas: connection patterns and functional aspects</article-title><source>Current Opinion in Neurobiology</source><volume>1</volume><fpage>248</fpage><lpage>251</lpage><pub-id pub-id-type="doi">10.1016/0959-4388(91)90085-L</pub-id><pub-id pub-id-type="pmid">1821188</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname> <given-names>S</given-names></name><name><surname>Michmizos</surname> <given-names>K</given-names></name><name><surname>Tommerdahl</surname> <given-names>M</given-names></name><name><surname>Ganesan</surname> <given-names>S</given-names></name><name><surname>Kitzbichler</surname> <given-names>MG</given-names></name><name><surname>Zetino</surname> <given-names>M</given-names></name><name><surname>Garel</surname> <given-names>K-LA</given-names></name><name><surname>Herbert</surname> <given-names>MR</given-names></name><name><surname>Hämäläinen</surname> <given-names>MS</given-names></name><name><surname>Kenet</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Somatosensory cortex functional connectivity abnormalities in autism show opposite trends, depending on direction and spatial scale</article-title><source>Brain</source><volume>138</volume><fpage>1394</fpage><lpage>1409</lpage><pub-id pub-id-type="doi">10.1093/brain/awv043</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiebel</surname> <given-names>SJ</given-names></name><name><surname>Garrido</surname> <given-names>MI</given-names></name><name><surname>Moran</surname> <given-names>RJ</given-names></name><name><surname>Friston</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Dynamic causal modelling for EEG and MEG</article-title><source>Cognitive Neurodynamics</source><volume>2</volume><fpage>121</fpage><lpage>136</lpage><pub-id pub-id-type="doi">10.1007/s11571-008-9038-0</pub-id><pub-id pub-id-type="pmid">19003479</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kisvárday</surname> <given-names>ZF</given-names></name><name><surname>Martin</surname> <given-names>KA</given-names></name><name><surname>Whitteridge</surname> <given-names>D</given-names></name><name><surname>Somogyi</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Synaptic connections of intracellularly filled clutch cells: a type of small basket cell in the visual cortex of the cat</article-title><source>The Journal of Comparative Neurology</source><volume>241</volume><fpage>111</fpage><lpage>137</lpage><pub-id pub-id-type="doi">10.1002/cne.902410202</pub-id><pub-id pub-id-type="pmid">4067011</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korngreen</surname> <given-names>A</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Voltage-gated K<sup>+</sup> channels in layer 5 neocortical pyramidal neurones from young rats: subtypes and gradients</article-title><source>The Journal of Physiology</source><volume>525</volume><fpage>621</fpage><lpage>639</lpage><pub-id pub-id-type="doi">10.1111/j.1469-7793.2000.00621.x</pub-id><pub-id pub-id-type="pmid">10856117</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kronberg</surname> <given-names>G</given-names></name><name><surname>Bridi</surname> <given-names>M</given-names></name><name><surname>Abel</surname> <given-names>T</given-names></name><name><surname>Bikson</surname> <given-names>M</given-names></name><name><surname>Parra</surname> <given-names>LC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Direct current stimulation modulates LTP and LTD: activity dependence and dendritic effects</article-title><source>Brain Stimulation</source><volume>10</volume><fpage>51</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1016/j.brs.2016.10.001</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Jones</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Distinguishing mechanisms of gamma frequency oscillations in human current source signals using a computational model of a laminar neocortical network</article-title><source>Frontiers in Human Neuroscience</source><volume>7</volume><elocation-id>869</elocation-id><pub-id pub-id-type="doi">10.3389/fnhum.2013.00869</pub-id><pub-id pub-id-type="pmid">24385958</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lübke</surname> <given-names>J</given-names></name><name><surname>Markram</surname> <given-names>H</given-names></name><name><surname>Frotscher</surname> <given-names>M</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Frequency and dendritic distribution of autapses established by layer 5 pyramidal neurons in the developing rat neocortex: comparison with synaptic innervation of adjacent neurons of the same class</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>3209</fpage><lpage>3218</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-10-03209.1996</pub-id><pub-id pub-id-type="pmid">8627359</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mainen</surname> <given-names>ZF</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Influence of dendritic structure on firing pattern in model neocortical neurons</article-title><source>Nature</source><volume>382</volume><fpage>363</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1038/382363a0</pub-id><pub-id pub-id-type="pmid">8684467</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Migliore</surname> <given-names>M</given-names></name><name><surname>Shepherd</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Emerging rules for the distributions of active dendritic conductances</article-title><source>Nature Reviews Neuroscience</source><volume>3</volume><fpage>362</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1038/nrn810</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moore</surname> <given-names>CI</given-names></name><name><surname>Nelson</surname> <given-names>SB</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Spatio-temporal subthreshold receptive fields in the vibrissa representation of rat primary somatosensory cortex</article-title><source>Journal of Neurophysiology</source><volume>80</volume><fpage>2882</fpage><lpage>2892</lpage><pub-id pub-id-type="doi">10.1152/jn.1998.80.6.2882</pub-id><pub-id pub-id-type="pmid">9862892</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murakami</surname> <given-names>S</given-names></name><name><surname>Hirose</surname> <given-names>A</given-names></name><name><surname>Okada</surname> <given-names>YC</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Contribution of ionic currents to magnetoencephalography (MEG) and electroencephalography (EEG) signals generated by guinea-pig CA3 slices</article-title><source>The Journal of Physiology</source><volume>553</volume><fpage>975</fpage><lpage>985</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2003.051144</pub-id><pub-id pub-id-type="pmid">14528026</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murakami</surname> <given-names>S</given-names></name><name><surname>Okada</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Contributions of principal neocortical neurons to magnetoencephalography and electroencephalography signals</article-title><source>The Journal of Physiology</source><volume>575</volume><fpage>925</fpage><lpage>936</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2006.105379</pub-id><pub-id pub-id-type="pmid">16613883</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naka</surname> <given-names>A</given-names></name><name><surname>Veit</surname> <given-names>J</given-names></name><name><surname>Shababo</surname> <given-names>B</given-names></name><name><surname>Chance</surname> <given-names>RK</given-names></name><name><surname>Risso</surname> <given-names>D</given-names></name><name><surname>Stafford</surname> <given-names>D</given-names></name><name><surname>Snyder</surname> <given-names>B</given-names></name><name><surname>Egladyous</surname> <given-names>A</given-names></name><name><surname>Chu</surname> <given-names>D</given-names></name><name><surname>Sridharan</surname> <given-names>S</given-names></name><name><surname>Mossing</surname> <given-names>DP</given-names></name><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Ngai</surname> <given-names>J</given-names></name><name><surname>Adesnik</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Complementary networks of cortical somatostatin interneurons enforce layer specific control</article-title><source>eLife</source><volume>8</volume><elocation-id>e43696</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.43696</pub-id><pub-id pub-id-type="pmid">30883329</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neymotin</surname> <given-names>SA</given-names></name><name><surname>Dura-Bernal</surname> <given-names>S</given-names></name><name><surname>Lakatos</surname> <given-names>P</given-names></name><name><surname>Sanger</surname> <given-names>TD</given-names></name><name><surname>Lytton</surname> <given-names>WW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Multitarget multiscale simulation for pharmacological treatment of dystonia in motor cortex</article-title><source>Frontiers in Pharmacology</source><volume>7</volume><elocation-id>157</elocation-id><pub-id pub-id-type="doi">10.3389/fphar.2016.00157</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Okada</surname> <given-names>YC</given-names></name><name><surname>Wu</surname> <given-names>J</given-names></name><name><surname>Kyuhou</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Genesis of MEG signals in a mammalian CNS structure</article-title><source>Electroencephalography and Clinical Neurophysiology</source><volume>103</volume><fpage>474</fpage><lpage>485</lpage><pub-id pub-id-type="doi">10.1016/S0013-4694(97)00043-6</pub-id><pub-id pub-id-type="pmid">9368492</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pantazis</surname> <given-names>D</given-names></name><name><surname>Fang</surname> <given-names>M</given-names></name><name><surname>Qin</surname> <given-names>S</given-names></name><name><surname>Mohsenzadeh</surname> <given-names>Y</given-names></name><name><surname>Li</surname> <given-names>Q</given-names></name><name><surname>Cichy</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Decoding the orientation of contrast edges from MEG evoked and induced responses</article-title><source>NeuroImage</source><volume>180</volume><fpage>267</fpage><lpage>279</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.07.022</pub-id><pub-id pub-id-type="pmid">28712993</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pauli</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Proposed extension of the CIE recommendation on “Uniform color spaces, color difference equations, and metric color terms”</article-title><source>Journal of the Optical Society of America</source><volume>66</volume><fpage>866</fpage><lpage>867</lpage><pub-id pub-id-type="doi">10.1364/JOSA.66.000866</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pinotsis</surname> <given-names>DA</given-names></name><name><surname>Geerts</surname> <given-names>JP</given-names></name><name><surname>Pinto</surname> <given-names>L</given-names></name><name><surname>FitzGerald</surname> <given-names>THB</given-names></name><name><surname>Litvak</surname> <given-names>V</given-names></name><name><surname>Auksztulewicz</surname> <given-names>R</given-names></name><name><surname>Friston</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Linking canonical microcircuits and neuronal activity: dynamic causal modelling of laminar recordings</article-title><source>NeuroImage</source><volume>146</volume><fpage>355</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.11.041</pub-id><pub-id pub-id-type="pmid">27871922</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pinto</surname> <given-names>DJ</given-names></name><name><surname>Jones</surname> <given-names>SR</given-names></name><name><surname>Kaper</surname> <given-names>TJ</given-names></name><name><surname>Kopell</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Analysis of state-dependent transitions in frequency and long-distance coordination in a model oscillatory cortical circuit</article-title><source>Journal of Computational Neuroscience</source><volume>15</volume><fpage>283</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1023/a:1025825102620</pub-id><pub-id pub-id-type="pmid">14512752</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Powell</surname> <given-names>MJD</given-names></name></person-group><year iso-8601-date="1994">1994</year><chapter-title>A Direct Search Optimization Method That Models the Objective and Constraint Functions by Linear Interpolation</chapter-title><source>Advances in Optimization and Numerical Analysis</source><publisher-loc>Dordrecht</publisher-loc><publisher-name>Springer</publisher-name><fpage>51</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1007/978-94-015-8330-5_4</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rahman</surname> <given-names>A</given-names></name><name><surname>Lafon</surname> <given-names>B</given-names></name><name><surname>Parra</surname> <given-names>LC</given-names></name><name><surname>Bikson</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Direct current stimulation boosts synaptic gain and cooperativity <italic>in vitro</italic></article-title><source>The Journal of Physiology</source><volume>595</volume><fpage>3535</fpage><lpage>3547</lpage><pub-id pub-id-type="doi">10.1113/JP273005</pub-id><pub-id pub-id-type="pmid">28436038</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reimann</surname> <given-names>MW</given-names></name><name><surname>Anastassiou</surname> <given-names>CA</given-names></name><name><surname>Perin</surname> <given-names>R</given-names></name><name><surname>Hill</surname> <given-names>SL</given-names></name><name><surname>Markram</surname> <given-names>H</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A biophysically detailed model of neocortical local field potentials predicts the critical role of active membrane currents</article-title><source>Neuron</source><volume>79</volume><fpage>375</fpage><lpage>390</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.05.023</pub-id><pub-id pub-id-type="pmid">23889937</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sahin</surname> <given-names>M</given-names></name><name><surname>Jones</surname> <given-names>SR</given-names></name><name><surname>Sweeney</surname> <given-names>JA</given-names></name><name><surname>Berry-Kravis</surname> <given-names>E</given-names></name><name><surname>Connors</surname> <given-names>BW</given-names></name><name><surname>Ewen</surname> <given-names>JB</given-names></name><name><surname>Hartman</surname> <given-names>AL</given-names></name><name><surname>Levin</surname> <given-names>AR</given-names></name><name><surname>Potter</surname> <given-names>WZ</given-names></name><name><surname>Mamounas</surname> <given-names>LA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Discovering translational biomarkers in neurodevelopmental disorders</article-title><source>Nature Reviews Drug Discovery</source><pub-id pub-id-type="doi">10.1038/d41573-018-00010-7</pub-id><pub-id pub-id-type="pmid">30936503</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanz Leon</surname> <given-names>P</given-names></name><name><surname>Knock</surname> <given-names>SA</given-names></name><name><surname>Woodman</surname> <given-names>MM</given-names></name><name><surname>Domide</surname> <given-names>L</given-names></name><name><surname>Mersmann</surname> <given-names>J</given-names></name><name><surname>McIntosh</surname> <given-names>AR</given-names></name><name><surname>Jirsa</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The virtual brain: a simulator of primate brain network dynamics</article-title><source>Frontiers in Neuroinformatics</source><volume>7</volume><elocation-id>10</elocation-id><pub-id pub-id-type="doi">10.3389/fninf.2013.00010</pub-id><pub-id pub-id-type="pmid">23781198</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarvas</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Basic mathematical and electromagnetic concepts of the biomagnetic inverse problem</article-title><source>Physics in Medicine and Biology</source><volume>32</volume><fpage>11</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1088/0031-9155/32/1/004</pub-id><pub-id pub-id-type="pmid">3823129</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiemann</surname> <given-names>J</given-names></name><name><surname>Puggioni</surname> <given-names>P</given-names></name><name><surname>Dacre</surname> <given-names>J</given-names></name><name><surname>Pelko</surname> <given-names>M</given-names></name><name><surname>Domanski</surname> <given-names>A</given-names></name><name><surname>van Rossum</surname> <given-names>MC</given-names></name><name><surname>Duguid</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Cellular mechanisms underlying behavioral state-dependent bidirectional modulation of motor cortex output</article-title><source>Cell Reports</source><volume>11</volume><fpage>1319</fpage><lpage>1330</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2015.04.042</pub-id><pub-id pub-id-type="pmid">25981037</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Segev</surname> <given-names>I</given-names></name><name><surname>Rapp</surname> <given-names>M</given-names></name><name><surname>Manor</surname> <given-names>Y</given-names></name><name><surname>Yarom</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="1992">1992</year><chapter-title>Chapter 7 - Analog and Digital Processing in Single Nerve Cells: Dendritic Integration and Axonal Propagation</chapter-title><person-group person-group-type="editor"><name><surname>Mckenna</surname> <given-names>T</given-names></name><name><surname>Davis</surname> <given-names>J</given-names></name><name><surname>Zornetzer</surname> <given-names>S. F</given-names></name></person-group><source>Single Neuron Computation</source><publisher-loc>San Diego</publisher-loc><publisher-name>Academic Press</publisher-name><fpage>173</fpage><lpage>198</lpage><pub-id pub-id-type="doi">10.1016/b978-0-12-484815-3.50013-x</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sherman</surname> <given-names>MA</given-names></name><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Law</surname> <given-names>R</given-names></name><name><surname>Haegens</surname> <given-names>S</given-names></name><name><surname>Thorn</surname> <given-names>CA</given-names></name><name><surname>Hämäläinen</surname> <given-names>MS</given-names></name><name><surname>Moore</surname> <given-names>CI</given-names></name><name><surname>Jones</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neural mechanisms of transient neocortical beta rhythms: converging evidence from humans, computational modeling, monkeys, and mice</article-title><source>PNAS</source><volume>113</volume><fpage>E4885</fpage><lpage>E4894</lpage><pub-id pub-id-type="doi">10.1073/pnas.1604135113</pub-id><pub-id pub-id-type="pmid">27469163</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shin</surname> <given-names>H</given-names></name><name><surname>Law</surname> <given-names>R</given-names></name><name><surname>Tsutsui</surname> <given-names>S</given-names></name><name><surname>Moore</surname> <given-names>CI</given-names></name><name><surname>Jones</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The rate of transient beta frequency events predicts behavior across tasks and species</article-title><source>eLife</source><volume>6</volume><elocation-id>e29086</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.29086</pub-id><pub-id pub-id-type="pmid">29106374</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silva</surname> <given-names>LR</given-names></name><name><surname>Gutnick</surname> <given-names>MJ</given-names></name><name><surname>Connors</surname> <given-names>BW</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Laminar distribution of neuronal membrane properties in neocortex of normal and Reeler mouse</article-title><source>Journal of Neurophysiology</source><volume>66</volume><fpage>2034</fpage><lpage>2040</lpage><pub-id pub-id-type="doi">10.1152/jn.1991.66.6.2034</pub-id><pub-id pub-id-type="pmid">1812234</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sliva</surname> <given-names>DD</given-names></name><name><surname>Black</surname> <given-names>CJ</given-names></name><name><surname>Bowary</surname> <given-names>P</given-names></name><name><surname>Agrawal</surname> <given-names>U</given-names></name><name><surname>Santoyo</surname> <given-names>JF</given-names></name><name><surname>Philip</surname> <given-names>NS</given-names></name><name><surname>Greenberg</surname> <given-names>BD</given-names></name><name><surname>Moore</surname> <given-names>CI</given-names></name><name><surname>Jones</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A prospective study of the impact of transcranial alternating current stimulation on EEG correlates of somatosensory perception</article-title><source>Frontiers in Psychology</source><volume>9</volume><elocation-id>17</elocation-id><pub-id pub-id-type="doi">10.3389/fpsyg.2018.02117</pub-id><pub-id pub-id-type="pmid">30515114</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sobol′</surname> <given-names>IM</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Global sensitivity indices for nonlinear mathematical models and their monte carlo estimates</article-title><source>Mathematics and Computers in Simulation</source><volume>55</volume><fpage>271</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1016/S0378-4754(00)00270-6</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Somogyi</surname> <given-names>P</given-names></name><name><surname>Kisvárday</surname> <given-names>ZF</given-names></name><name><surname>Martin</surname> <given-names>KA</given-names></name><name><surname>Whitteridge</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Synaptic connections of morphologically identified and physiologically characterized large basket cells in the striate cortex of cat</article-title><source>Neuroscience</source><volume>10</volume><fpage>261</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1016/0306-4522(83)90133-1</pub-id><pub-id pub-id-type="pmid">6633861</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname> <given-names>GJ</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Active propagation of somatic action potentials into neocortical pyramidal cell dendrites</article-title><source>Nature</source><volume>367</volume><fpage>69</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1038/367069a0</pub-id><pub-id pub-id-type="pmid">8107777</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tarkiainen</surname> <given-names>A</given-names></name><name><surname>Liljeström</surname> <given-names>M</given-names></name><name><surname>Seppä</surname> <given-names>M</given-names></name><name><surname>Salmelin</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The 3D topography of MEG source localization accuracy: effects of conductor model and noise</article-title><source>Clinical Neurophysiology</source><volume>114</volume><fpage>1977</fpage><lpage>1992</lpage><pub-id pub-id-type="doi">10.1016/S1388-2457(03)00195-0</pub-id><pub-id pub-id-type="pmid">14499760</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tennøe</surname> <given-names>S</given-names></name><name><surname>Halnes</surname> <given-names>G</given-names></name><name><surname>Einevoll</surname> <given-names>GT</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Uncertainpy: a Python toolbox for uncertainty quantification and sensitivity analysis in computational neuroscience</article-title><source>Frontiers in Neuroinformatics</source><volume>12</volume><elocation-id>49</elocation-id><pub-id pub-id-type="doi">10.3389/fninf.2018.00049</pub-id><pub-id pub-id-type="pmid">30154710</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomson</surname> <given-names>AM</given-names></name><name><surname>West</surname> <given-names>DC</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Bannister</surname> <given-names>AP</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Synaptic connections and small circuits involving excitatory and inhibitory neurons in layers 2-5 of adult rat and cat neocortex: triple intracellular recordings and biocytin labelling in vitro</article-title><source>Cerebral Cortex</source><volume>12</volume><fpage>936</fpage><lpage>953</lpage><pub-id pub-id-type="doi">10.1093/cercor/12.9.936</pub-id><pub-id pub-id-type="pmid">12183393</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomson</surname> <given-names>AM</given-names></name><name><surname>Bannister</surname> <given-names>AP</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Postsynaptic pyramidal target selection by descending layer III pyramidal axons: dual intracellular recordings and biocytin filling in slices of rat neocortex</article-title><source>Neuroscience</source><volume>84</volume><fpage>669</fpage><lpage>683</lpage><pub-id pub-id-type="doi">10.1016/S0306-4522(97)00557-5</pub-id><pub-id pub-id-type="pmid">9579775</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomson</surname> <given-names>AM</given-names></name><name><surname>Bannister</surname> <given-names>AP</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Interlaminar connections in the neocortex</article-title><source>Cerebral Cortex</source><volume>13</volume><fpage>5</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1093/cercor/13.1.5</pub-id><pub-id pub-id-type="pmid">12466210</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vierling-Claassen</surname> <given-names>D</given-names></name><name><surname>Cardin</surname> <given-names>JA</given-names></name><name><surname>Moore</surname> <given-names>CI</given-names></name><name><surname>Jones</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Computational modeling of distinct neocortical oscillations driven by cell-type selective optogenetic drive: separable resonant circuits controlled by low-threshold spiking and fast-spiking interneurons</article-title><source>Frontiers in Human Neuroscience</source><volume>4</volume><elocation-id>198</elocation-id><pub-id pub-id-type="doi">10.3389/fnhum.2010.00198</pub-id><pub-id pub-id-type="pmid">21152338</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Windhoff</surname> <given-names>M</given-names></name><name><surname>Opitz</surname> <given-names>A</given-names></name><name><surname>Thielscher</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Electric field calculations in brain stimulation based on finite elements: an optimized processing pipeline for the generation and usage of accurate individual head models</article-title><source>Human Brain Mapping</source><volume>34</volume><fpage>923</fpage><lpage>935</lpage><pub-id pub-id-type="doi">10.1002/hbm.21479</pub-id><pub-id pub-id-type="pmid">22109746</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woolrich</surname> <given-names>MW</given-names></name><name><surname>Stephan</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Biophysical network models and the human connectome</article-title><source>NeuroImage</source><volume>80</volume><fpage>330</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.03.059</pub-id><pub-id pub-id-type="pmid">23571421</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname> <given-names>JJ</given-names></name><name><surname>Connors</surname> <given-names>BW</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Intrinsic firing patterns and whisker-evoked synaptic responses of neurons in the rat barrel cortex</article-title><source>Journal of Neurophysiology</source><volume>81</volume><fpage>1171</fpage><lpage>1183</lpage><pub-id pub-id-type="doi">10.1152/jn.1999.81.3.1171</pub-id><pub-id pub-id-type="pmid">10085344</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziegler</surname> <given-names>DA</given-names></name><name><surname>Pritchett</surname> <given-names>DL</given-names></name><name><surname>Hosseini-Varnamkhasti</surname> <given-names>P</given-names></name><name><surname>Corkin</surname> <given-names>S</given-names></name><name><surname>Hämäläinen</surname> <given-names>M</given-names></name><name><surname>Moore</surname> <given-names>CI</given-names></name><name><surname>Jones</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Transformations in oscillatory activity and evoked responses in primary somatosensory cortex in middle age: a combined computational neural modeling and MEG study</article-title><source>NeuroImage</source><volume>52</volume><fpage>897</fpage><lpage>912</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2010.02.004</pub-id><pub-id pub-id-type="pmid">20149881</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s8" sec-type="appendix"><title>Supplementary materials</title><boxed-text><sec id="s9"><title>Sensitivity analyses of ERP simulations</title><p>To reduce the computational demands of performing model optimization of HNN ERP simulations, we used variance based sensitivity analysis to identify parameters that were less significant to the simulated dipole waveform. As discussed above, HNN’s model optimization feature focuses on estimating parameters of the exogenous driving inputs. Of those parameters, ones that did not vary model output significantly, as determined by sensitivity analysis, could be excluded from parameter estimation.</p><p>The method of variance based sensitivity analysis through Monte Carlo estimation (<xref ref-type="bibr" rid="bib76">Sobol′, 2001</xref>) provides Sobol sensitivity indices that can be used to explain the relative contribution of individual parameters on model variance. The total Sobol sensitivity index for each parameter serves as a measure that represents that parameter’s contribution to the variance, and also the contributions resulting from interactions with other parameters being varied (<xref ref-type="bibr" rid="bib33">Homma and Saltelli, 1996</xref>). So a parameter with a low total Sobol sensitivity index can be characterized as an insignificant contributor to variance and can be fixed at its default value during model optimization.</p><p>We used the Python package Uncertainpy (<xref ref-type="bibr" rid="bib80">Tennøe et al., 2018</xref>) to perform sensitivity analyses of parameters belonging to the exogenous driving inputs in the perceptual threshold-level ('yes_trial_SI_ERP_all_avg.txt') and suprathreshold-level ('ERPYesSupraT.txt') evoked response examples provided with HNN and described in the Results (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig11">Figure 11</xref>). These analyses were performed using a modified simulation interface to run the simulations in parallel on a high-performance computing cluster, which is not currently included with HNN distribution. The results from our sensitivity analyses are shown in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, <xref ref-type="fig" rid="fig11s2">Figure 11—figure supplement 2</xref>, and <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1</xref>. Each analysis consisted of varying all parameters (except input timing standard deviation) of a driving input over 55,000 simulations using a quasi-Monte Carlo method that sampled from parameter distributions we specified. The input time distribution was defined as a normal distribution with the same mean and standard deviation in the corresponding HNN parameter file. The values for various synaptic weights were chosen from a uniform distribution ranging from the default value plus or minus 500%. For synaptic weight parameters with a default value of 0, the uniform distribution ranged from 0 to 1.0.</p><p>We were interested in comparing the contribution of each parameter to the dipole waveform (in units of nAm) across the entire simulation time. However, since the calculation of the total Sobol sensitivity index is relative to the variance at each point of the time series, when variance changes over time, it is not appropriate to average the total Sobol sensitivity indices across the entire simulation (<xref ref-type="bibr" rid="bib1">Alexanderian et al., 2020</xref>). Instead we computed a weighted total Sobol index at each point in time (weighted by std. deviation scaled to have a range from 0 to 1). The plots in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> and <xref ref-type="fig" rid="fig11s2">Figure 11—figure supplement 2</xref> show weighted total Sobol indices for each parameter over the duration of the simulation. <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> ranks the parameters with the greatest contribution to model output using the arithmetic means of weighted total Sobol indices across the entire simulation, for each driving input.</p><p>The results from our sensitivity analyses of sensory evoked response examples illustrate that there are several candidate parameters for excluding from model optimization. Not surprisingly input timing is an important parameter to optimize. We also found that NMDA weights typically have a greater contribution to variance than AMPA weights, as do connections to Layer 5 neurons compared to Layer 2/3 neurons.</p></sec></boxed-text></sec></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.51214.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Stolk</surname><given-names>Arjen</given-names></name><role>Reviewing Editor</role><aff><institution>Donders Centre for Cognitive Neuroimaging</institution><country>Netherlands</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Stolk</surname><given-names>Arjen</given-names> </name><role>Reviewer</role><aff><institution>Donders Centre for Cognitive Neuroimaging</institution><country>Netherlands</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Dalal</surname><given-names>Sarang S</given-names></name><role>Reviewer</role><aff><institution>Aarhus University</institution><country>Denmark</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>The HNN provides an intuitive way for thinking about and linking cellular- and circuit-level mechanisms in the neocortex to (source-reconstructed) neural data. Combined with the worked examples that demonstrate the application of the tool to current issues, the reviewers unanimously agreed on its relevance and potential for opening up new possibilities for the field to advance our understanding of cellular and network origins of MEG/EEG data.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Human Neocortical Neurosolver (HNN), a new software tool for interpreting the cellular and network origin of human MEG/EEG data&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Arjen Stolk as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Richard Ivry as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Sarang S. Dalal (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>All reviewers and editors agreed on the methodological sophistication and relevance of your software tool. However, several concerns were raised, which are summarized below. We are aware that these may be challenging to address within the usual timeframe but we all agreed that if these issues can be addressed satisfactorily, the paper would substantially improve.</p><p>Essential revisions:</p><p>1) MEG is generally considered to arise from intracellular currents, with EEG arising from extracellular currents (e.g., section 2.1 https://www.sciencedirect.com/science/article/pii/S0896627313009203). In the case of MEG, the volume currents largely cancel out, which is thought to leave intracellular currents as the main contributor to MEG signals. But volume currents are supposed to be a dominating factor in EEG, so this theoretically leads to its bias towards extracellular currents. However, the manuscript and software appear to address only intracellular currents, while MEG and EEG are discussed as if they are equivalent. This may be a necessary compromise, or the authors may disagree with the premise of MEG from intracellular and EEG from extracellular currents. However, they should be clear on their position and how this issue is handled in HNN.</p><p>2) It is a bit unsatisfying that the &quot;Gamma rhythms&quot; example does not use real data, given its importance to the community. Even if the authors' own experiments have not yielded data with strong gamma, there are many examples in the literature that could perhaps be obtained, and even some appropriate datasets are publicly available. For example, FieldTrip's gamma source localization tutorial provides one:</p><p>http://www.fieldtriptoolbox.org/tutorial/beamformingextended/</p><p>3) The HNN framework seems well-suited for evoked responses that are phase-locked across trials. However, gamma oscillations are often &quot;induced&quot;, i.e., not phase-locked across trials. Does HNN provide tools to model/simulate the origins of such phase variance? If so, this should be clarified, and if not, perhaps described as a limitation.</p><p>4) There appears to be a distinction between narrowband and broadband gamma in terms of their neural underpinnings, with broadband gamma suggested to be closely linked to spiking activity (e.g. Whittingstall and Logothetis, 2009 among others). Likewise, this should be described if HNN can model this, and otherwise addressed as a limitation.</p><p>5) The &quot;jet&quot; colormaps for the spectrograms (Figures 6 and 7) have been heavily criticized in recent years for being extremely biased perceptually (see, e.g., https://predictablynoisy.com/makeitpop-intro). In the case of Figure 6, this results in yellow patches that &quot;pop&quot; somewhat misleadingly. New releases of neuroscientific software should be especially cognizant of this and ideally provide a perceptually uniform colormap as the default. See https://matplotlib.org/3.1.1/tutorials/colors/colormaps.html and https://matplotlib.org/cmocean/ for some ideas on divergent colormaps.</p><p>6) The manuscript refers to previous work by the authors for details of the biophysical model. However, it is not clear from the present manuscript how well these models compare to actual experimental data and from which species the data was obtained. For example, because the model appears to use reduced and simplified neuronal morphologies, and only a single type of inhibitory interneuron, it would be very informative to provide some assessment of whether any potential inaccuracies in the generated field potentials could exist due to reduced dendritic morphology, and whether incorporation of additional inhibitory circuitry could expand the scope of questions that could be addressed via HNN.</p><p>7) The manuscript refers several times to source localization, but the presented model appears to be of a single cortical column, and presumably, this means that it is currently not possible to study questions related to the spatial distribution of field potentials. While I have no doubt that the methods of HNN will scale well to networks of multiple cortical columns, some clarity is necessary in manuscript regarding the current capability of HNN with regards to spatially distributed networks and source localization features, and what plans are made for future releases.</p><p>8) While the manuscript addresses related work by other authors, there are now several published large-scale biophysical neural models that incorporate some form of approximated LFP computation that aids the study of neural oscillations. It would be very informative to include at least a brief comparison with e.g. the methods developed by Reimann et al., 2013, and in what ways HNN is an improvement.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.51214.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) MEG is generally considered to arise from intracellular currents, with EEG arising from extracellular currents (e.g., section 2.1 https://www.sciencedirect.com/science/article/pii/S0896627313009203). In the case of MEG, the volume currents largely cancel out, which is thought to leave intracellular currents as the main contributor to MEG signals. But volume currents are supposed to be a dominating factor in EEG, so this theoretically leads to its bias towards extracellular currents. However, the manuscript and software appear to address only intracellular currents, while MEG and EEG are discussed as if they are equivalent. This may be a necessary compromise, or the authors may disagree with the premise of MEG from intracellular and EEG from extracellular currents. However, they should be clear on their position and how this issue is handled in HNN.</p></disp-quote><p>Thank you for bringing up the need to address this basic conceptual point in more detail. As even the reference to a publication by a very influential author in the field demonstrates, the biophysics of the generation and the concepts used in the modeling of MEG/EEG need to be further clarified and the correct physically sound concepts have to be restated. There is much confusion in the field on this topic.</p><p>We, indeed, disagree with the notion that MEG is generated by the intracellular and EEG with the extracellular currents. In fact, in the modeling of the MEG and EEG signals at a long distance of at least centimeters from the actual sources, the concepts of “intracellular” and “extracellular” do not directly apply. Instead, a macroscopic scale is assumed for the distribution of electrical conductivity. The proper division between the actual non-ohmic equivalent sources of activity and the passive ohmic currents is then referred to as primary and volume currents, respectively. Both MEG and EEG are ultimately generated by the primary currents, which sets up a potential distribution (EEG) whose gradients are driving the volume currents. Both primary and volume currents, in general, create the magnetic field (MEG). Surprisingly, the conductivity distribution and geometry of the compartments with different electric conductivities in the head leads to a situation in which the integral effect of the volume currents can be relatively easily taken into account while the precise computation of the EEG for a given primary current requires more detailed information about the electrical conductivity. We want to point out that these concepts are succinctly discussed in [1] and [2].</p><p>Given the primary currents and the macroscopic distribution of electrical conductivity, the computation of MEG/EEG can be accomplished by using either an analytical method (in special cases) or by employing numerical boundary-element, finite-element, or finite-difference methods. Source estimation methods aim at finding the best estimate for the primary currents underlying the MEG/EEG measurements.</p><p>The distinct purpose of HNN is to interpret how the primary current distribution corresponding to the microscopic currents is created by an assembly of neurons. Thanks to the consistent orientation of the apical dendrites of the pyramidal cells in the cortex this primary current is oriented normal to the cortical mantle and its direction corresponds to the intracellular current flow [3, 4, 5]. By definition, the same primary current is the source of both MEG and EEG.</p><p>The clarify this in the manuscript, we have rewritten the Results subsection titled</p><p>“Primary currents and the relation to forward and inverse modeling”. In addition, we have created a new panel in Figure 1B that emphasizes the relationship between the primary currents, MEG/EEG forward and inverse modeling and HNN. We hope that these additions to the manuscript bring further clarity to the confusing topic. However, we also emphasize that the goal of the current HNN methods paper is not to review electromagnetic biophysics, but rather to present a new tool for neural interpretation of the primary currents underlying MEG/EEG signals.</p><disp-quote content-type="editor-comment"><p>2) It is a bit unsatisfying that the &quot;Gamma rhythms&quot; example does not use real data, given its importance to the community. Even if the authors' own experiments have not yielded data with strong gamma, there are many examples in the literature that could perhaps be obtained, and even some appropriate datasets are publicly available. For example, FieldTrip's gamma source localization tutorial provides one:</p><p>http://www.fieldtriptoolbox.org/tutorial/beamformingextended/</p></disp-quote><p>As a result of the reviewer’s insightful suggestion, we have obtained source-localized current dipole signals from human MEG recordings showing visually-induced gamma rhythms. This data set has been published (Pantazis et al., 2018) and was generously provided by the authors. In these data, induced gamma rhythms are not continuous but emerge as transient bursts of activity on individual trials. We were able to model this type of gamma activity using HNN with a slight modification, the weak PING model in our previous gamma tutorial (Figure 9). Specifically, we adjusted the properties of the noisy drive to the network. HNN modeling of this new data and a corresponding new figure (Figure 10) are now described in the “Gamma rhythms” subsection of the manuscript section “Tutorials on ERPs and low-frequency oscillations”. We also uploaded the experimental data to the HNN github repository. As stated at the end of the gamma tutorial section: “This example is presented as a proof of principle on the method to begin to study the cell and circuit origin source localized gamma band data with HNN. The circuit level hypotheses have not yet been published elsewhere or investigated in further detail.”</p><p>Of note to the reviewer, the gamma source localization data distributed with FieldTrip is not source localized and as such requires additional processing before it can be compared to the output in HNN. Therefore, we decided to use the alternative source localized data set provided by Pantazis et al., 2018, as described. This data set was already in units of nAm and could be directly compared to the HNN model output in both the time and frequency domain without further processing (Figure 10).</p><disp-quote content-type="editor-comment"><p>3) The HNN framework seems well-suited for evoked responses that are phase-locked across trials. However, gamma oscillations are often &quot;induced&quot;, i.e., not phase-locked across trials. Does HNN provide tools to model/simulate the origins of such phase variance? If so, this should be clarified, and if not, perhaps described as a limitation.</p></disp-quote><p>We thank the reviewer for pointing out this lack of clarity. Indeed, non time-locked spontaneous and “induced” oscillations are fundamental brain dynamics that HNN can be used to understand. We have addressed this comment in two ways.</p><p>First, we note that in reply to comment #2 above, we have added a new tutorial and section in the methods paper that describes how to simulate induced gamma oscillations (see above, and new Figure 1).</p><p>Second, our prior studies of spontaneous alpha/beta activity described in our alpha and beta tutorial focused on non time-locked rhythms. This dataset is provided and described as “induced” in the “Getting Started” section of the Alpha/Beta tutorial. We also point out in the tutorial “Section 5” that due to the non-timelocked nature of the signal, it is not possible to directly compare the time domain output of the model with single epoch time traces. However, data can be directly compared to model in the Power Spectral Density viewer. Additionally, tutorial “Section 3.3” describes how to create variability in the drive to the network on different trials that effectively jitters the phase of the induced oscillations on each trial. In the averaged response, seemingly continuous high power activity can occur.</p><p>We have now clarified this in the tutorials by updating the title of the tutorial sections to emphasize the induced nature of the data we are simulating.</p><p>“Section 3.3: Simulating multiple trials of non-time locked spontaneous or induced signals with jitter, and averaging across trials, creates the impression of continuous oscillations”</p><p>“Section 5: Comparing model output and recorded data for non-timelocked spontaneous or induced oscillations”</p><p>We have also clarified in several places in the text describing alpha and beta rhythms, and gamma rhythms, that these simulations are constructed to study non-time locked spontaneous or “induced” rhythms.</p><disp-quote content-type="editor-comment"><p>4) There appears to be a distinction between narrowband and broadband gamma in terms of their neural underpinnings, with broadband gamma suggested to be closely linked to spiking activity (e.g. Whittingstall and Logothetis, 2009 among others). Likewise, this should be described if HNN can model this, and otherwise addressed as a limitation.</p></disp-quote><p>Indeed, there is much literature addressing the neural underpinnings of narrowband vs. broadband gamma oscillations, and we have used HNN to contribute to this literature (Lee and Jones, 2013). In the methods paper and in our online tutorials, we have chosen to only describe application of HNN to narrowband low gamma PING mechanism.</p><p>To directly address this concern, we have now explicitly stated in the methods paper that HNN has been applied to study the neural underpinnings of broadband “high gamma” activity with reference to Lee and Jones 2013, where these issues are outlined further. Specifically, the following statements have been added to the paper:</p><p>“It has been well established through experiments and computational modeling that these rhythms can emerge in local spiking networks through excitatory and inhibitory cell interactions where synaptic time constants set the frequency of the oscillation, while broadband or “high gamma” rhythms reflect spiking activity in the network that creates sharp waveform deflections (Lee and Jones, 2013). “</p><p>“We have applied HNN to determine if features in the current dipole signal could distinguish PING-mediated gamma from other possible mechanisms such as exogenous rhythmic drive or spiking activity that creates “high gamma” oscillations (Lee and Jones, 2013). Here, we describe the process for generating gamma rhythms via the canonical PING mechanisms in HNN.”</p><p>In response to critique 2, we have also added an additional example of simulating gamma and comparing to recorded data to the methods paper (Figure 10). The new data and parameter files are now included with the HNN installation so that others can replicate the new simulation.</p><disp-quote content-type="editor-comment"><p>5) The &quot;jet&quot; colormaps for the spectrograms (Figures 6 and 7) have been heavily criticized in recent years for being extremely biased perceptually (see, e.g., https://predictablynoisy.com/makeitpop-intro). In the case of Figure 6, this results in yellow patches that &quot;pop&quot; somewhat misleadingly. New releases of neuroscientific software should be especially cognizant of this and ideally provide a perceptually uniform colormap as the default. See https://matplotlib.org/3.1.1/tutorials/colors/colormaps.html and https://matplotlib.org/cmocean/ for some ideas on divergent colormaps.</p></disp-quote><p>We thank the reviewer for pointing out this criticism in the field. To directly address this concern, we have updated HNN so that the user has a choice of colormap for their spectrogram images. This is described in the paper in the section “Alpha and beta rhythms” section under “Tutorials on ERPs and low-frequency oscillations”, along with panels in Figure 6 (Figure 6B and C).</p><p>Due to the fact that our prior publications that serve as the basis for the existing tutorials have used the “jet” colormap, we have chosen not to change the figures in our tutorials for consistency and to avoid adding confusion.</p><disp-quote content-type="editor-comment"><p>6) The manuscript refers to previous work by the authors for details of the biophysical model. However, it is not clear from the present manuscript how well these models compare to actual experimental data and from which species the data was obtained. For example, because the model appears to use reduced and simplified neuronal morphologies, and only a single type of inhibitory interneuron, it would be very informative to provide some assessment of whether any potential inaccuracies in the generated field potentials could exist due to reduced dendritic morphology, and whether incorporation of additional inhibitory circuitry could expand the scope of questions that could be addressed via HNN.</p></disp-quote><p>The reviewer is correct that the underlying neural model is a reduced representation of neural activity. The initial choices made in the reduction were based on including the minimal components necessary to account for the primary current dipole signal (from pyramidal neuron dendrites) and to maintain canonical features of neocortical circuitry (layers, E/I ratio, synaptic time-constants, etc.). We’ve found that this reduction has been sufficient to account for important features of the most commonly measured macroscale signals (ERPs and low-frequency oscillations) and to generate new, testable hypotheses on the origin of these signals (e.g. beta bursts; Sherman et al., 2016).</p><p>We agree that this reduction may cause for some inaccuracies in simulating extracellular local field potential (LFP) signals that may rely on more detail in the neocortical circuit and/or on different interneuron types. This is yet to be determined and simulating LFP is not currently part of HNN. As discussed, we are interested in expanding HNN to be useful to simulate LFPs, and this is an ongoing effort. As a first step, we are converting the code responsible for building the NEURON model to NetPyNE so that other neuron types, such as different types of pyramidal cells or interneurons, can be implemented into the model. This expansion may also reveal the importance of yet-to-be-implemented features of the neural circuit in simulating the primary current signal. Our vision is for HNN, as open-source software, to be adaptable, so that new information can easily be incorporated into HNN and shared with the community.</p><p>To directly address the reviewers concern, we have added further details in the Template Model Construction in the Materials and methods sections: “Morphology”, “Physiology”, and “Local Network Connections”. These sections now detail the choices made in cell and network construction and the publications that motivated our original model. Of note, we did not include additional equations or parameters, as all equations are part of the open-source code.</p><p>Additionally, we have expanded our Discussion section to further address limitations in the model. The “Limitation and future directions” section of the Discussion reads:</p><p>“One of the greatest challenges in computational neural modeling is deciding the appropriate scale of model to use to answer the question at hand. […] These assumptions are outlined in detail in the Materials and methods section, in our prior publications, and on our website.”</p><disp-quote content-type="editor-comment"><p>7) The manuscript refers several times to source localization, but the presented model appears to be of a single cortical column, and presumably, this means that it is currently not possible to study questions related to the spatial distribution of field potentials. While I have no doubt that the methods of HNN will scale well to networks of multiple cortical columns, some clarity is necessary in manuscript regarding the current capability of HNN with regards to spatially distributed networks and source localization features, and what plans are made for future releases.</p></disp-quote><p>We hope that the response to comment #1 has helped clarify this issue. Additionally, we have described in several places throughout the manuscript that HNN is designed to simulate the activity in a single source region of interest, and that future expansions will include simulation of spatially distributed networks and sensor level signals. Example clarifications are as follows.</p><p>In the subsection, “Inferring the neural origin of the primary currents with HNN<bold>”</bold> </p><p>“Currently, the process of estimating the primary current sources with inverse methods, or calculating the forward solution from <bold>J</bold><sup>p</sup>to the measured sensor level signal, is separate from HNN.”</p><p>“HNN is currently constructed to dissect the cell and network contributions to signals from one source-localized region of interest. […] Ongoing expansions will include the ability to import other user-defined cell types and circuit models into HNN, simulate LFP and sensor level signals, as well as the interactions among multiple neocortical areas (see Discussion).”</p><p>In the subsection, “Comparison to other neocortical models and EEG/MEG modeling software”:</p><p><bold>“</bold>This construction enables one-to-one comparison between model output and source localized data in units of Am, and was specifically designed for interpreting microscale cellular- and circuit-level activity from single regions of interest.”</p><p>“The LFPy Python classes are likely to provide a useful framework for expanding the utility of HNN to include multi-area simulations, and simulations of LFP and EEG/MEG sensor level signals, as described in Limitations and future directions below. “</p><p>In the subsection “Limitations and future directions”</p><p><bold>“</bold>HNN’s model was chosen to be minimally sufficient to accurately account for the biophysical origin of the primary currents that underlie EEG/MEG signals in a single brain area; namely, the net intracellular current flow in the apical dendrites of pyramidal neurons that span across the cortical layers and receive layer-specific synaptic input from other brain areas. […] A future direction discussed below is to expand HNN to simulate extracellular local field potential signals (LFPs), and sensor level signals, whose accuracy may require additional model detail and whose implementation can be aided by other existing tools such as LFPy and NetPyNe (discussed further below)”</p><disp-quote content-type="editor-comment"><p>8) While the manuscript addresses related work by other authors, there are now several published large-scale biophysical neural models that incorporate some form of approximated LFP computation that aids the study of neural oscillations. It would be very informative to include at least a brief comparison with e.g. the methods developed by Reimann et al., 2013, and in what ways HNN is an improvement.</p></disp-quote><p>We thank the reviewer for pointing out that we were not clear in describing how our model was different from existing models with similar capabilities. Indeed there are many large-scale biophysical neural models to simulate various aspects of neocortical activity, including LFP, and source localized and EEG/MEG sensor level signals. Several modeling tools and associated documentation are also available to build user defined neocortical models for general use that is not domain specific. Among the current modeling software designed specifically for study of EEG/MEG signals (LFPy, The Virtual Brain, and Dynamic Causal Modeling of EEG/MEG data), HNN is unique in its model, goals, and capabilities. To highlight these differences, we have re-written and expanded the Discussion section on the topic which is now titled “Comparison to other neocortical models and EEG/MEG modeling software”.</p><p>We have also attempted to clarify confusion on the relationship between source localized EEG/MEG signals (primary current dipoles), LFP, and EEG/MEG sensor level data. Please see response to comment #1 above. We emphasize that as currently constructed, HNN is specific to simulating source localized primary current dipoles in a single brain region of interest from the intracellular current flow in pyramidal neuron dendrites. Future directions are aimed at including simulations of LFP, and sensor level EEG/MEG signals in HNN’s vizualization and distribution.</p><p>References</p><p>1. Hämäläinen M, Hari R, Ilmoniemi R, Knuutila J, and Lounasmaa OV, Magnetoencephalography – theory, instrumentation, and applications to noninvasive studies of the working human brain. Reviews of Modern Physics, 65: 413-497, 1993.</p><p>2. Hari R and Ilmoniemi RJ, Cerebral magnetic fields. Crit Rev Biomed Eng, 14: 93-126, 1986.</p><p>3. Ikeda, H., Wang, Y., and Okada, Y. C. (2005). Origins of the somatic N20 and high-frequency oscillations evoked by trigeminal stimulation in the piglets. <italic>Clinical Neurophysiology, 116</italic>(4), 827–841. https://doi.org/10.1016/j.clinph.2004.10.010</p><p>4. Okada, Y. C., Wu, J., and Kyuhou, S. (1997). Genesis of MEG signals in a mammalian CNS structure. <italic>Electroencephalography and Clinical Neurophysiology, 103</italic>(4), 474–485. https://doi.org/10.1016/S0013-4694(97)00043-6</p><p>5. Murakami, S., and Okada, Y. (2006). Contributions of principal neocortical neurons to magnetoencephalography and electroencephalography signals. <italic>Journal of Physiology, 575</italic>(3), 925–936. https://doi.org/10.1113/jphysiol.2006.105379</p></body></sub-article></article>