<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">91911</article-id><article-id pub-id-type="doi">10.7554/eLife.91911</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.91911.3</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Cell Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Neural network emulation of the human ventricular cardiomyocyte action potential for more efficient computations in pharmacological studies</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-331587"><name><surname>Grandits</surname><given-names>Thomas</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7441-8002</contrib-id><email>thomas.grandits@uni-graz.at</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-228515"><name><surname>Augustin</surname><given-names>Christoph M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6341-4014</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-331593"><name><surname>Haase</surname><given-names>Gundolf</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3439-6117</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-202780"><name><surname>Jost</surname><given-names>Norbert</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-84887"><name><surname>Mirams</surname><given-names>Gary R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4569-4312</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-215793"><name><surname>Niederer</surname><given-names>Steven A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4612-6982</contrib-id><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-228513"><name><surname>Plank</surname><given-names>Gernot</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-201461"><name><surname>Varró</surname><given-names>András</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0745-3603</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-202757"><name><surname>Virág</surname><given-names>László</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-331589"><name><surname>Jung</surname><given-names>Alexander</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0723-4403</contrib-id><email>alexander.jung@medunigraz.at</email><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01faaaf77</institution-id><institution>Department of Mathematics and Scientific Computing, University of Graz</institution></institution-wrap><addr-line><named-content content-type="city">Graz</named-content></addr-line><country>Austria</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01faaaf77</institution-id><institution>NAWI Graz, University of Graz</institution></institution-wrap><addr-line><named-content content-type="city">Graz</named-content></addr-line><country>Austria</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01faaaf77</institution-id><institution>Gottfried Schatz Research Center for Cell Signaling, Metabolism and Aging - Division of Medical Physics and Biophysics, Medical University of Graz</institution></institution-wrap><addr-line><named-content content-type="city">Graz</named-content></addr-line><country>Austria</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jfbm483</institution-id><institution>BioTechMed-Graz</institution></institution-wrap><addr-line><named-content content-type="city">Graz</named-content></addr-line><country>Austria</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01pnej532</institution-id><institution>Department of Pharmacology and Pharmacotherapy, University of Szeged</institution></institution-wrap><addr-line><named-content content-type="city">Szeged</named-content></addr-line><country>Hungary</country></aff><aff id="aff6"><label>6</label><institution>HUN-REN-TKI, Research Group of Pharmacology</institution><addr-line><named-content content-type="city">Budapest</named-content></addr-line><country>Hungary</country></aff><aff id="aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ee9ar58</institution-id><institution>Centre for Mathematical Medicine &amp; Biology, School of Mathematical Sciences, University of Nottingham</institution></institution-wrap><addr-line><named-content content-type="city">Nottingham</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0220mzb33</institution-id><institution>Division of Imaging Sciences &amp; Biomedical Engineering, King’s College London</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Yang</surname><given-names>Yongliang</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/023hj5876</institution-id><institution>Dalian University of Technology</institution></institution-wrap><country>China</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a0dhs15</institution-id><institution>École Normale Supérieure - PSL</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>10</day><month>04</month><year>2024</year></pub-date><volume>12</volume><elocation-id>RP91911</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2023-08-22"><day>22</day><month>08</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-08-17"><day>17</day><month>08</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.08.16.553497"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-12-04"><day>04</day><month>12</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.91911.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-02-13"><day>13</day><month>02</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.91911.2"/></event></pub-history><permissions><copyright-statement>© 2023, Grandits et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Grandits et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-91911-v1.pdf"/><abstract><p>Computer models of the human ventricular cardiomyocyte action potential (AP) have reached a level of detail and maturity that has led to an increasing number of applications in the pharmaceutical sector. However, interfacing the models with experimental data can become a significant computational burden. To mitigate the computational burden, the present study introduces a neural network (NN) that emulates the AP for given maximum conductances of selected ion channels, pumps, and exchangers. Its applicability in pharmacological studies was tested on synthetic and experimental data. The NN emulator potentially enables massive speed-ups compared to regular simulations and the forward problem (find drugged AP for pharmacological parameters defined as scaling factors of control maximum conductances) on synthetic data could be solved with average root-mean-square errors (RMSE) of 0.47 mV in normal APs and of 14.5 mV in abnormal APs exhibiting early afterdepolarizations (72.5% of the emulated APs were alining with the abnormality, and the substantial majority of the remaining APs demonstrated pronounced proximity). This demonstrates not only very fast and mostly very accurate AP emulations but also the capability of accounting for discontinuities, a major advantage over existing emulation strategies. Furthermore, the inverse problem (find pharmacological parameters for control and drugged APs through optimization) on synthetic data could be solved with high accuracy shown by a maximum RMSE of 0.22 in the estimated pharmacological parameters. However, notable mismatches were observed between pharmacological parameters estimated from experimental data and distributions obtained from the Comprehensive in vitro Proarrhythmia Assay initiative. This reveals larger inaccuracies which can be attributed particularly to the fact that small tissue preparations were studied while the emulator was trained on single cardiomyocyte data. Overall, our study highlights the potential of NN emulators as powerful tool for an increased efficiency in future quantitative systems pharmacology studies.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>computer modeling</kwd><kwd>computer simulation</kwd><kwd>cardiac electrophysiology</kwd><kwd>machine learning</kwd><kwd>surrogate modeling</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002428</institution-id><institution>Austrian Science Fund</institution></institution-wrap></funding-source><award-id>ERA-NET I 4652-B</award-id><principal-award-recipient><name><surname>Augustin</surname><given-names>Christoph M</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01-HL158667</award-id><principal-award-recipient><name><surname>Augustin</surname><given-names>Christoph M</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>German Research Foundation</institution></institution-wrap></funding-source><award-id>Walter Benjamin Fellowship No. 468256475</award-id><principal-award-recipient><name><surname>Jung</surname><given-names>Alexander</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution>HUN-REN Hungarian Research Network</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Jost</surname><given-names>Norbert</given-names></name><name><surname>Varró</surname><given-names>András</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id><institution>Wellcome Trust</institution></institution-wrap></funding-source><award-id>Senior Research Fellowship No. 212203/Z/18/Z</award-id><principal-award-recipient><name><surname>Mirams</surname><given-names>Gary R</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100011019</institution-id><institution>National Research Development and Innovation Office</institution></institution-wrap></funding-source><award-id>No. 142738</award-id><principal-award-recipient><name><surname>Jost</surname><given-names>Norbert</given-names></name><name><surname>Varró</surname><given-names>András</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication. For the purpose of Open Access, the authors have applied a CC BY public copyright license to any Author Accepted Manuscript version arising from this submission.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Neural networks can emulate normal and abnormal human ventricular action potentials accurately and potentially much faster than regular simulations paving the way for more efficient quantitative systems pharmacology studies.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Computer models of human physiology are becoming increasingly detailed and mature and the area of ventricular cardiomyocyte electrophysiology (EP) is one of the most advanced. The most updated models include fine representations of ion movements through various important channels, pumps, and exchangers, and take the complex handling of intracellular calcium accurately into account (<xref ref-type="bibr" rid="bib22">Grandi et al., 2010</xref>; <xref ref-type="bibr" rid="bib52">O’Hara et al., 2011</xref>; <xref ref-type="bibr" rid="bib69">Tomek et al., 2019</xref>; <xref ref-type="bibr" rid="bib2">Bartolucci et al., 2020</xref>). While these models have individual strengths and limitations in replicating different aspects of physiology, pathology, and pharmacology (<xref ref-type="bibr" rid="bib14">Corrado et al., 2021</xref>; <xref ref-type="bibr" rid="bib1">Amuzescu et al., 2021</xref>), their degree of credibility has reached a level that has led to an increasing number of applications in academia and beyond. This holds in particular for the pharmaceutical sector, where much effort is spent on using computer modeling to reduce traditional preclinical and clinical methodologies for assessing the efficacy and safety of novel drug candidates (<xref ref-type="bibr" rid="bib45">Mirams et al., 2011</xref>; <xref ref-type="bibr" rid="bib54">Passini et al., 2017</xref>; <xref ref-type="bibr" rid="bib43">Li et al., 2019</xref>; <xref ref-type="bibr" rid="bib55">Passini et al., 2021</xref>). To improve the regulatory assessment of a drug’s proarrhythmic potential, the Comprehensive in Vitro Proarrhythmia Assay (CiPA) was proposed in 2013 following a workshop at the US Food and Drug Administration (<xref ref-type="bibr" rid="bib60">Sager et al., 2014</xref>; <xref ref-type="bibr" rid="bib13">Colatsky et al., 2016</xref>; <xref ref-type="bibr" rid="bib66">Strauss et al., 2021</xref>). A central component is a computer model of human ventricular cardiomyocyte EP that is coupled to a pharmacological model describing the interaction between a given drug and multiple arrhythmia-relevant channels (<xref ref-type="bibr" rid="bib18">Dutta et al., 2017</xref>; <xref ref-type="bibr" rid="bib42">Li et al., 2017</xref>; <xref ref-type="bibr" rid="bib43">Li et al., 2019</xref>). For a given drug, experimental channel block data are collected to inform the pharmacological model and corresponding simulations of the action potentials (AP; time course of the transmembrane potential) are performed to predict the proarrhythmic risk based on a mechanistically motivated biomarker (<xref ref-type="bibr" rid="bib9">Chang et al., 2017</xref>; <xref ref-type="bibr" rid="bib42">Li et al., 2017</xref>; <xref ref-type="bibr" rid="bib43">Li et al., 2019</xref>). The prediction is then compared with findings in experimental (<xref ref-type="bibr" rid="bib3">Blinova et al., 2018</xref>) and clinical (<xref ref-type="bibr" rid="bib73">Vicente et al., 2018</xref>) studies. To compute the drugged AP for given pharmacological parameters is a forward problem, while the corresponding inverse problem is to find pharmacological parameters for given control (before drug administration) and drugged AP. Some relevant examples for the latter have been presented by <xref ref-type="bibr" rid="bib4">Bottino et al., 2006</xref> who estimated pharmacological parameters from APs of canine Purkinje fibers and by Tv<italic>eito</italic> et al. <italic>who estima</italic>ted pharmacological parameters from AP biomarkers measured in human induced pluripotent stem cell-derived cardiomyocytes (<xref ref-type="bibr" rid="bib71">Tveito et al., 2018</xref>) and several animal ventricular cardiomyocytes (<xref ref-type="bibr" rid="bib72">Tveito et al., 2020</xref>). Furthermore, <xref ref-type="bibr" rid="bib31">Jaeger et al., 2021</xref> identified the optimal polypharmacological treatment for recovering APs of mutant ventricular cardiomyocytes based on biomarkers of simulated wild type and mutant APs.</p><p>When the models are interfaced with experimental data, attention should be paid to the inherent uncertainty in the data that results from beat-to-beat variability (intrinsic variability), cell-to-cell variability (extrinsic variability), and measurement errors (observational uncertainty) (<xref ref-type="bibr" rid="bib47">Mirams et al., 2016</xref>). Uncertainty propagates through the given problem from APs to estimated parameters or from parameters to predicted APs and must be properly quantified to draw reliable conclusions from the results. Multiple methodologies exist for this purpose (<xref ref-type="bibr" rid="bib51">Oakley and O’Hagan, 2004</xref>; <xref ref-type="bibr" rid="bib47">Mirams et al., 2016</xref>; <xref ref-type="bibr" rid="bib63">Sher et al., 2022</xref>) but usually require many simulations, which even for ordinary differential equation (ODE)-based models of cardiomyocyte EP can become a significant computational burden when considering that each simulation includes a substantial number of beats to reach the model’s limit cycle, (also often called steady state). To overcome this problem, surrogate models have emerged which approximate (emulate) chosen outputs for given inputs multiple orders of magnitude faster. In line with uncertainty quantification literature, the cardiomyocyte EP model is from now on termed the ‘<italic>simulator</italic>’, whereas the surrogate model is termed the ‘<italic>emulator</italic>’. Earlier work has reported on an emulator based on linear interpolation of a multi-dimensional lookup table <xref ref-type="bibr" rid="bib46">Mirams et al., 2014</xref> and more recently, Gaussian process (GP) emulators have become popular. Their key advantage is that in- and outputs are modeled as random distributions which allows for rapid sampling of the posterior distributions (<xref ref-type="bibr" rid="bib8">Chang et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Johnstone et al., 2016</xref>; <xref ref-type="bibr" rid="bib15">Coveney and Clayton, 2018</xref>; <xref ref-type="bibr" rid="bib21">Ghosh, 2018</xref>; <xref ref-type="bibr" rid="bib58">Rasmussen, 2019</xref>; <xref ref-type="bibr" rid="bib16">Coveney et al., 2021</xref>) and while outputs of recently published GP emulators were relevant biomarkers of the AP (<xref ref-type="bibr" rid="bib8">Chang et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Johnstone et al., 2016</xref>; <xref ref-type="bibr" rid="bib15">Coveney and Clayton, 2018</xref>; <xref ref-type="bibr" rid="bib21">Ghosh, 2018</xref>; <xref ref-type="bibr" rid="bib16">Coveney et al., 2021</xref>), the emulation of the entire AP can also be realized, for example through dimensionality reduction techniques such as the principal component analysis or regressing state-transition models (<xref ref-type="bibr" rid="bib48">Mohammadi et al., 2019</xref>). However, GP emulators are not well suited to capture discontinuities of the response surface as standard GP emulators assume a smooth and continuous response to changes in parameter values. Applying GPs for modeling discontinuous functions therefore remains a largely open problem. Thus, they may fail to capture AP abnormalities, which is a particular drawback for pharmacological studies where bifurcations in behavior such as early afterdepolarizations (EAD) can occur (<xref ref-type="bibr" rid="bib21">Ghosh, 2018</xref>). To address this, <xref ref-type="bibr" rid="bib21">Ghosh, 2018</xref> presented a two-step approach for the emulation of the AP duration at 90% repolarization that first sets up a GP for the location of discontinuities and then fits separate GP emulators for the output of interest either side of these boundaries. In contrast, it has been proven that neural networks (NN) can approximate even discontinuous functions with arbitrary precision in theory (<xref ref-type="bibr" rid="bib29">Hornik et al., 1989</xref>), while recent works using NNs show empirically promising results for modeling partial differential equations containing discontinuities (<xref ref-type="bibr" rid="bib32">Jagtap et al., 2020</xref>). These features render NN emulators suitable emulation candidates and while <xref ref-type="bibr" rid="bib40">Lei and Mirams, 2021</xref> have recently investigated NN emulation of hERG channel kinetics, <xref ref-type="bibr" rid="bib34">Jeong et al., 2023</xref> proposed a neural network using AP shapes as input for the prediction of a drug’s proarrhythmic risk. However, to the best of our knowledge, NN emulators have not yet been used as surrogate for cardiomyocyte EP models.</p><p>The present study introduces NN emulation of the human ventricular cardiomyocyte AP and investigates the applicability in pharmacological studies. To this end, a NN emulator was developed based on data generated using a state-of-the-art simulator (<xref ref-type="bibr" rid="bib69">Tomek et al., 2019</xref>; <xref ref-type="bibr" rid="bib70">Tomek et al., 2020</xref>) and the evaluation was done for forward and inverse problems on synthetic and experimental data.</p></sec><sec id="s2" sec-type="materials|methods"><title>Materials and methods</title><p>The methodology of this study including the development of the emulator and the evaluation is outlined in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Methodology of this study including the emulator development and the evaluation.</title><p>The simulator is visualized by a schematic human ventricular cardiomyocyte that includes all currents considered for the emulator training. Inputs of the emulator (see <xref ref-type="fig" rid="fig3">Figure 3</xref>) are the corresponding maximum conductances (<inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) but for the sake of illustration, only three representatives are shown. Output is the AP (<inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>). Training and validation data (maximum conductances <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and APs <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>) were generated by the simulator. The evaluationwas performed for forward and inverse problems and to this end, the pharmacological parameter <italic>s</italic> was introduced. This describes the interaction between the drug and a given target and was defined as scaling factor of the respective maximum conductance in control conditions (s &lt; 1:block, s=1:no effect, s &gt; 1:enhancement). Synthetic data (control maximum conductances and drugged maximum conductances obtained through scaling, and control and drugged APs) and experimental data (control and drugged APs) were used for the evaluation (<xref ref-type="bibr" rid="bib53">Orvos, 2019</xref>). The forward problem was only solved for whereas the inverse problem was solved for both synthetic and experimental data. When experimental data were used, estimated pharmacological parameters were compared to distributions derived from data published within the CiPA initiative (<xref ref-type="bibr" rid="bib9">Chang et al., 2017</xref>; <xref ref-type="bibr" rid="bib42">Li et al., 2017</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-fig1-v1.tif"/></fig><sec id="s2-1"><title>Simulator</title><p>The simulator of <xref ref-type="bibr" rid="bib70">Tomek et al., 2020</xref> (ToR-ORd-dynCl simulator) was used. This is available in CARPentry (<xref ref-type="bibr" rid="bib74">Vigmond et al., 2008</xref>) and was implemented based on the published CellML file for the endocardial subtype (ToRORd_dynCl_endo.cellml, <ext-link ext-link-type="uri" xlink:href="https://github.com/jtmff/torord/tree/master/cellml">https://github.com/jtmff/torord/tree/master/cellml</ext-link>; <xref ref-type="bibr" rid="bib36">jtmff, 2020</xref>). Simulations were performed in CARPentry with the single cell tool bench. To compute the gating variables, the Rush-Larsen Method (<xref ref-type="bibr" rid="bib59">Rush and Larsen, 1978</xref>) was employed, which uses an analytical solution assuming fixed voltage over a small timestep, and the remaining variables were computed by the Forward Euler method. To ensure low computational cost, we found the maximum solver and sampling time steps that still produce accurate results as follows. Various solver and sampling time steps were applied to generate APs and the biomarkers (AP biomarkers and abnormalities) used in this study were computed and compared with those that correspond to the minimum time steps (solver: <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.005</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>; sampling: <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.01</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). We considered the time steps with only 2% relative difference for all AP biomarkers (solver: <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.01</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>; sampling: <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.05</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) to offer a sufficiently good approximation. APs were stimulated at a pacing cycle length of <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1000</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> using <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> long rectangular transmembrane current density pulses of <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>53</mml:mn><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib69">Tomek et al., 2019</xref>). To approach the simulator’s steady state, a series of 1000 stimuli were applied for each new parameter set starting from the initial states specified in the CellML file (when 1000 additional stimuli were applied, the maximum intracellular [Ca<sup>2+</sup>], [Cl<sup>-</sup>], and [Na<sup>+</sup>] changed by 1.5%, 0.15%, and 1.7%, respectively). Note, that the simulations can also be performed using open-source software such as (<xref ref-type="bibr" rid="bib11">Clerx et al., 2016</xref>), OpenCOR (<xref ref-type="bibr" rid="bib19">Garny and Hunter, 2015</xref>) and openCARP (<xref ref-type="bibr" rid="bib57">Plank et al., 2021</xref>).</p></sec><sec id="s2-2"><title>Emulator</title><p>Here, we present the architecture and capabilities of the implemented and trained emulator. Details on the practical implementation and a link to the public code can be found in Code &amp; data availability.</p><sec id="s2-2-1"><title>Data</title><p>We generated three data sets in the study to train, validate and test the emulator performance.</p><sec id="s2-2-1-1"><title>Training/validation data (#1)</title><p>The first data set is the the supervised training data set, containing pairs of maximum conductance samples <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and the corresponding AP <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> that was obtained from the simulator. Sobol’ sequences were used to generate 40,000 maximum conductance samples, containing 20,000 maximum conductance samples between 0% and 200% of the original values and 20,000 maximum conductance samples between 50% and 150% of the original values. The first covers a range that was considered plausible in terms of physiology and pathology (<xref ref-type="bibr" rid="bib7">Britton et al., 2017</xref>; <xref ref-type="bibr" rid="bib69">Tomek et al., 2019</xref>), and in terms of pharmacology (where full block is plausible). The latter covers a range that was considered particularly relevant in line with experimental calibration results presented in <xref ref-type="bibr" rid="bib69">Tomek et al., 2019</xref> and patch clamp measurements of channels that were exposed to 30 clinical drugs blocks in up to the fourfold of the maximum free therapeutic concentration were analyzed in agreement with the CiPA paradigm (<xref ref-type="bibr" rid="bib43">Li et al., 2019</xref>; <xref ref-type="bibr" rid="bib17">Crumb et al., 2016</xref>). The <monospace>SALib-Sensitivity Analysis Library</monospace> (<xref ref-type="bibr" rid="bib27">Herman and Usher, 2017</xref>) was used in the entire study for the generation of samples based on Sobol’ sequences. For each maximum conductance sample, simulations were performed to obtain the corresponding 40,000 APs. APs with a transmembrane potential difference of more than 10% of the amplitude between <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1000</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (indicative of an AP that is far away from full repolarization) were excluded. This, however, applied to only 116 APs.</p><p>Starting from the original APs in data set #1, the data were first extended by <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>10</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> from <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to enable some extrapolation of <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math></inline-formula> and hence a better alignment of the depolarization; for <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> the initial resting membrane potential <inline-formula><mml:math id="inf21"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was held constant. Then, the data were non-uniformly resampled from the original uniformly simulated APs, to emphasize the depolarization slope with a high accuracy while lowering the number of repolarization samples. For this purpose, we resamled the APs to <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>4</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (resting phase) and <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>10</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>20</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (depolarization phase) to <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>4</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The repolarization phase (<inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) was also resampled to <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>4</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>From the initial training data set, 20% were randomly chosen to be used for validation leaving 31908 pairs of maximum conductances and corresponding APs for training. <xref ref-type="fig" rid="fig2">Figure 2</xref> shows processed APs that were used for training, validation and the APs excluded due to missing full repolarization as described above.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Processed APs used for training and validation (left and center).</title><p>Additionally we show the excluded APs on the right (see text for description of the exclusion criteria).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-fig2-v1.tif"/></fig></sec><sec id="s2-2-1-2"><title>Synthetic test data (#2/#3)</title><p>Two sets of synthetic data were created using the simulator and each of the sets consisted of control and drug data with pairs of maximum conductances and corresponding APs.</p><p>The control data were the same in both sets. They were created using an experimentally calibrated population of 100 synthetic cardiomyocytes (<xref ref-type="bibr" rid="bib6">Britton et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Muszkiewicz et al., 2016</xref>; <xref ref-type="bibr" rid="bib20">Gemmell et al., 2016</xref>). and to this end, Sobol’ sequences were used to generate samples of maximum conductances with values between 50% and 150% of the original values. Maximum conductance samples that produced APs without abnormalities (checked for the last two consecutive APs; see AP biomarkers and abnormalities), and with seven biomarker values (derived from the last AP; see AP biomarkers and abnormalities) in agreement with experimental ranges (<xref ref-type="table" rid="table1">Table 1</xref>) were included in the population. Please note that the experimental ranges were not derived from the data set described in Experimental data (#4).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>AP biomarkers and their experimental ranges used to generate the population of synthetic cardiomyocytes.</title><p>These were adopted from <xref ref-type="bibr" rid="bib54">Passini et al., 2017</xref>. Experimental data were collected at 37°C in small right ventricular trabeculae and papillary tissue preparations obtained from healthy human hearts during pacing with a cycle length of <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1000</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib7">Britton et al., 2017</xref>; <xref ref-type="bibr" rid="bib52">O’Hara et al., 2011</xref>).</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom" rowspan="1">AP biomarker</th><th valign="bottom" rowspan="1">Unit</th><th valign="bottom" rowspan="1">Min</th><th valign="bottom" rowspan="1">Max</th></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">mV</td><td align="left" valign="bottom">-95</td><td align="left" valign="bottom">-80</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mi>V</mml:mi><mml:mi>m</mml:mi><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">mVms<sup>-1</sup></td><td align="left" valign="bottom">100</td><td align="left" valign="bottom">1000</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">mV</td><td align="left" valign="bottom">10</td><td align="left" valign="bottom">55</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>40</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">ms</td><td align="left" valign="bottom">85</td><td align="left" valign="bottom">320</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">ms</td><td align="left" valign="bottom">110</td><td align="left" valign="bottom">350</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>90</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">ms</td><td align="left" valign="bottom">180</td><td align="left" valign="bottom">440</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>90</mml:mn><mml:mo>−</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">ms</td><td align="left" valign="bottom">50</td><td align="left" valign="bottom">150</td></tr></tbody></table></table-wrap><p>Data set #2: The motivation for creating data set #2 was to evaluate the emulator on data of normal APs. Drug data were created using 100 synthetic drugs represented by a set of pharmacological parameters. Each synthetic drug was built to have four different targets, with all channels, pumps, and exchangers related to the emulator inputs considered as potential targets. To this end, 100 samples of four pharmacological parameters, each with values between 0.5 (50% block) and 1.5 (50% enhancement) were randomly generated. The synthetic drugs were applied to the entire synthetic cardiomyocyte population by scaling each of the relevant control maximum conductances with the corresponding pharmacological parameter. The samples that produced APs without abnormalities (checked for the last two consecutive APs; see AP biomarkers and abnormalities) were included in the data set. No sample was excluded and thus, the data set consisted of 100 control data pairs and 10,000 drug data pairs.</p><p>Data set #3: The motivation for creating data set #3 was to test the emulator on data of abnormal APs showing the repolarization abnormality EAD. This is considered a particularly relevant AP abnormality in pharmacological studies because of their role in the genesis of drug-induced ventricular arrhythmia’s (<xref ref-type="bibr" rid="bib75">Weiss et al., 2010</xref>). Drug data were created using 10 synthetic drugs with the hERG channel and the Cav1.2 channel as targets. To this end, 10 samples with pharmacological parameters for <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">G</mml:mi><mml:mrow><mml:mi mathvariant="normal">K</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="table" rid="table2">Table 2</xref>) were generated and the synthetic drugs were applied to the entire synthetic cardiomyocyte population by scaling <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">G</mml:mi><mml:mrow><mml:mi mathvariant="normal">K</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> with the corresponding pharmacological parameter. Of the 1000 APs simulated, we discarded APs with a transmembrane potential difference of more than 10% of the amplitude between <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1000</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (checked for the last AP), indicative of an AP that is far away from fully repolarizing within <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1000</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. This left us with 950 APs, 171 of which exhibit EAD (see EAD classification).</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Pharmacological parameter samples (synthetic drugs) with scaling factors for G<sub>kr</sub> and P<sub>ca</sub> to generate the drug data of data set #3.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom" rowspan="1">ID</th><th valign="bottom" rowspan="1">1</th><th valign="bottom" rowspan="1">2</th><th valign="bottom" rowspan="1">3</th><th valign="bottom" rowspan="1">4</th><th valign="bottom" rowspan="1">5</th><th valign="bottom" rowspan="1">6</th><th valign="bottom" rowspan="1">7</th><th valign="bottom" rowspan="1">8</th><th valign="bottom" rowspan="1">9</th><th valign="bottom" rowspan="1">10</th></tr></thead><tbody><tr><td align="left" valign="bottom">G<sub>kr</sub></td><td align="char" char="." valign="bottom">0.05</td><td align="char" char="." valign="bottom">0.06</td><td align="char" char="." valign="bottom">0.07</td><td align="char" char="." valign="bottom">0.08</td><td align="char" char="." valign="bottom">0.09</td><td align="char" char="." valign="bottom">0.10</td><td align="char" char="." valign="bottom">0.11</td><td align="char" char="." valign="bottom">0.12</td><td align="char" char="." valign="bottom">0.13</td><td align="char" char="." valign="bottom">0.14</td></tr><tr><td align="left" valign="bottom">P<sub>ca</sub></td><td align="char" char="." valign="bottom">1.20</td><td align="char" char="." valign="bottom">1.22</td><td align="char" char="." valign="bottom">1.24</td><td align="char" char="." valign="bottom">1.26</td><td align="char" char="." valign="bottom">1.28</td><td align="char" char="." valign="bottom">1.30</td><td align="char" char="." valign="bottom">1.32</td><td align="char" char="." valign="bottom">1.34</td><td align="char" char="." valign="bottom">1.36</td><td align="char" char="." valign="bottom">1.38</td></tr></tbody></table></table-wrap></sec><sec id="s2-2-1-3"><title>Experimental data (#4)</title><p>In the experimental data set, APs were recorded in small right ventricular trabeculae and papillary tissue preparations that were isolated from healthy human hearts (<xref ref-type="bibr" rid="bib53">Orvos, 2019</xref>). The hearts were obtained from organ donors whose hearts were explanted to obtain pulmonary and aortic valves for transplant surgery. Before cardiac explantation, organ donors did not receive medication apart from dobutamine, furosemide, and plasma expanders. Proper consent was obtained for use of each individual’s tissue for experimentation. The conventional microelectrode technique was used for AP recordings and all measurements were carried out at 37°C. Stimulation of APs was done at a pacing cycle length of <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1000</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> using a pair of platinum electrodes that provided rectangular current pulses of <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> duration. To allow the preparations to equilibrate, stimuli were delivered for at least <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>60</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> before the measurements started. Measurements were performed under control conditions and after administration of five channel-blocking drugs at one concentration in multiple preparations. Drugs were cisapride (<inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>30</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), dofetilide (<inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>10</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), sotalol (<inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>30</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), terfenadine (<inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), and verapamil (<inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>300</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). The last 10 consecutive APs of each measurement were analyzed to quantify the beat-to-beat variability. Overall, the beat-to-beat variability was found to be small (standard deviation in all APs below <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>7</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> before the peak due to time alignment mismatch and below <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> after the peak) and thus, the last 10 consecutive APs of each measurement were averaged. In most of the preparations, the standard deviation between beats did not vary over time and thus, no temporal correlation of noise was assumed. Averaging also reduced the noise level. The experimental data set contained one pair of averaged control and drugged AP per preparation per drug. Pairs were excluded if the biomarker values (see AP biomarkers and abnormalities) of the control or the drugged AP were not in the range found in the training data (see Training). This applied to seven pairs and the final data set contained three pairs for cisapride, dofetilide, sotalol, and terfenadine, and one pair for verapamil. All measurements were performed at the University of Szeged, Hungary, and conformed to the principles of the Declaration of Helsinki. Experimental protocols were approved by the University of Szeged and by the National Scientific and Research Ethical Review Boards (No. 51-57/1997 OEj and 4991-0/2010-1018EKU [339/PI/010]).</p><p>An overview of all utilized data is given in <xref ref-type="table" rid="table3">Table 3</xref>.</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Summary of the data used in this study, along with their usage and the number of valid samples.</title><p>Note that each AP is counted individually, also in cases of control/drug pairs.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="1" valign="bottom">ID</th><th rowspan="1" valign="bottom">Description</th><th rowspan="1" valign="bottom">Usage</th><th rowspan="1" valign="bottom">Origin</th><th rowspan="1" valign="bottom">Samples</th></tr></thead><tbody><tr><td align="left" valign="bottom">#1</td><td align="left" valign="bottom">Training/validation data</td><td align="left" valign="bottom">Training and validating the emulator, choosing the best architecture (Architecture)</td><td align="left" valign="bottom">Simulation</td><td align="left" valign="bottom">39,884</td></tr><tr><td align="left" valign="bottom">#2</td><td align="left" valign="bottom">Synthetic drug data, normal APs</td><td align="left" valign="bottom">Testing forward and inverse performance for normal APs (‘Forward problem’ and ‘Inverse problem based on synthetic data’)</td><td align="left" valign="bottom">Simulation</td><td align="left" valign="bottom">10<sup>4</sup></td></tr><tr><td align="left" valign="bottom">#3</td><td align="left" valign="bottom">Synthetic drug data, including EAD APs</td><td align="left" valign="bottom">Testing forward performance of abnormal (EAD) APs (‘Forward problem’)</td><td align="left" valign="bottom">Simulation</td><td align="left" valign="bottom">950</td></tr><tr><td align="left" valign="bottom">#4</td><td align="left" valign="bottom">Experimental cardiomyocytes</td><td align="left" valign="bottom">Testing and comparing the inverse performance with data published by the CiPA initiative (<xref ref-type="bibr" rid="bib42">Li et al., 2017</xref>; <xref ref-type="bibr" rid="bib9">Chang et al., 2017</xref>; ’Inverse problem based on experimental data’)</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib53">Orvos, 2019</xref></td><td align="left" valign="bottom">26</td></tr></tbody></table></table-wrap></sec></sec></sec><sec id="s2-3"><title>Architecture</title><p>The emulator takes maximum conductances of channels, pumps, and exchangers as inputs and computes the corresponding AP (<inline-formula><mml:math id="inf54"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) after the last stimulus as output. It was trained to represent human ventricular cardiomyocytes under control and drugged conditions and the inputs were selected based on two assumptions: (1) The kinetics of channels are preserved, while the number of channels, pumps, and exchangers vary due to different expression levels (<xref ref-type="bibr" rid="bib67">Syed et al., 2005</xref>; <xref ref-type="bibr" rid="bib23">Groenendaal et al., 2015</xref>; <xref ref-type="bibr" rid="bib39">Krogh-Madsen et al., 2016</xref>). These numbers are captured in the simulator by the maximum conductance parameters (or permeability parameters but maximum conductance is used as general term here for the sake of simplicity) that determine the respective current densities; (2) Channels, pumps, and exchangers are potential (intended and unintended) drug targets and the interaction between drugs and their targets can be described by a scaling of the related maximum conductances (<xref ref-type="bibr" rid="bib5">Brennan et al., 2009</xref>). The corresponding scaling factors are pharmacological parameters. These assumptions allowed us to focus on maximum conductances and we considered those as inputs which either the AP is sensitive to (G<sub>Na</sub>, G<sub>NaL</sub>, P<sub>Ca</sub>, G<sub>to</sub>, G<sub>K</sub>r, G<sub>K1</sub>, G<sub>NCX</sub>, P<sub>NaK</sub>) or which are related to common drug targets (G<sub>Na</sub>, G<sub>NaL</sub>, P<sub>Ca</sub>, G<sub>to</sub>, G<sub>Kr</sub>, G<sub>Ks</sub>, G<sub>K1</sub>; <xref ref-type="bibr" rid="bib17">Crumb et al., 2016</xref>) leading to the following selection: G<sub>Na</sub>, G<sub>NaL</sub>, P<sub>Ca</sub>, G<sub>to</sub>, G<sub>Kr</sub>, G<sub>Ks</sub>, G<sub>K1</sub>, G<sub>NCX</sub>, and P<sub>NaK</sub>. AP sensitivity was quantified using a global sensitivity analysis (GSA; see.Appendix 2) and the inclusion threshold was a total-effect Sobol’ sensitivity index (ST) above 0.1 with respect to any of the considered biomarkers (see.Appendix 1).</p><p>Several emulator architectures were tried on the training and validation data sets and the final choice was hand-picked as a good trade-off between high accuracy on the validation set (#1) and low computational runtime cost. We decided to utilize a two-stage emulator architecture: First, the maximum conductances <inline-formula><mml:math id="inf55"><mml:mi mathvariant="bold">x</mml:mi></mml:math></inline-formula> – normalized to the range <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> – are encoded using a first NN (<inline-formula><mml:math id="inf57"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>) into a latent representation <inline-formula><mml:math id="inf58"><mml:mi>ϑ</mml:mi></mml:math></inline-formula>. Second, this intermediate representation parameterizes a function <inline-formula><mml:math id="inf59"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>ϑ</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mrow><mml:mi>ℝ</mml:mi><mml:mo>→</mml:mo><mml:mi>ℝ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> defined by a second NN (<inline-formula><mml:math id="inf60"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>) that can be continuously evaluated to receive the emulated AP at time <inline-formula><mml:math id="inf61"><mml:mi>t</mml:mi></mml:math></inline-formula>. To help the second NN in computing the fast depolarization, a simple depolarization term <inline-formula><mml:math id="inf62"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>tanh</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is added to <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>f</mml:mi><mml:mi>ϑ</mml:mi></mml:msub></mml:math></inline-formula>. The parameters of this depolarization function are slope (<italic>d</italic><sub>1</sub>), offset (<italic>d</italic><sub>2</sub>), and amplitude (<italic>d</italic><sub>3</sub>), and are created by encoding the parameters through the first network, similar to the latent code. The AP approximated by the emulator is thus defined by<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>A schematic drawing of the emulator architecture is provided in 2. Splitting the network into two parts — one for encoding the parameters into a latent space and a second one for evaluating <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>f</mml:mi><mml:mi>ϑ</mml:mi></mml:msub></mml:math></inline-formula> — allowed us to give the emulator enough complexity without markedly increasing the computational cost: in most cases, it is desirable to compute the whole AP in the entire range, for example <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and not only at a single time step. Creating a single network that computes the mapping from maximum conductances to the transmembrane potential at a single time step (compare <xref ref-type="fig" rid="fig3">Figure 3</xref>) is either orders of magnitudes slower than encoding the parameters into a latent vector (only done once per AP) or would require to reduce the complexity of the network, which led to inaccurate emulations in the validation. The additional depolarization term was introduced to address the difficulty of fitting the depolarization phase during training and decreased the required training time substantially. Note that the mapping from maximum conductances <inline-formula><mml:math id="inf66"><mml:mi mathvariant="bold">x</mml:mi></mml:math></inline-formula> to depolarization parameters <inline-formula><mml:math id="inf67"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> is also learned through <inline-formula><mml:math id="inf68"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Conceptual architecture of the neural network emulator.</title><p>The maximum conductances <inline-formula><mml:math id="inf69"><mml:mi mathvariant="bold">x</mml:mi></mml:math></inline-formula> are encoded into depolarization parameters <italic>d</italic><sub><italic>i</italic></sub> and a latent space representation <inline-formula><mml:math id="inf70"><mml:mi>ϑ</mml:mi></mml:math></inline-formula> that uniquely defines the time series functional <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>ϑ</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mrow><mml:mi>ℝ</mml:mi><mml:mo>→</mml:mo><mml:mi>ℝ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The time is normalized and encoded in polynomials up to degree 8 (<inline-formula><mml:math id="inf72"><mml:msup><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:math></inline-formula> for <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>8</mml:mn></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), before being appended to the latent code <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is then used in conjunction with the depolarization helper <inline-formula><mml:math id="inf75"><mml:mi>tanh</mml:mi></mml:math></inline-formula> to approximate the AP <inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-fig3-v1.tif"/></fig><p>The exact architecture employed – chosen by a cross-validation approach (see Validation) – comprised a first network (<inline-formula><mml:math id="inf77"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>) of four fully connected layers of 256 neurons, each to encode the parameters into the latent vector <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>ϑ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>256</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. This first network additionally generates the parameterization for the depolarization model <inline-formula><mml:math id="inf79"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. The second network, computing the APs from the latent representation (<inline-formula><mml:math id="inf80"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>), consisted of four fully connected layers of 64 neurons each. Exponential linear unit (ELU) activation functions <xref ref-type="bibr" rid="bib12">Clevert et al., 2016</xref> were used for all layers, except for the final non-linear layer, which was modeled using a <inline-formula><mml:math id="inf81"><mml:mi>tanh</mml:mi></mml:math></inline-formula> activation function followed by a <inline-formula><mml:math id="inf82"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>64</mml:mn></mml:msup><mml:mo>→</mml:mo><mml:mi>ℝ</mml:mi></mml:mrow></mml:math></inline-formula> linear layer.</p></sec><sec id="s2-4"><title>Training</title><p>Although different regularization schemes such as variational losses (e.g. <inline-formula><mml:math id="inf83"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>) were tried, the wealth of training data allowed us to define the training loss purely in terms of mean-squared-error (MSE)<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>⊂</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> describes the output of the emulator using the current NN weights <inline-formula><mml:math id="inf85"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf86"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> refers to the current training batch and <inline-formula><mml:math id="inf87"><mml:mi>X</mml:mi></mml:math></inline-formula> is the training data set containing both target APs <inline-formula><mml:math id="inf88"><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math></inline-formula> and corresponding maximum conductances <inline-formula><mml:math id="inf89"><mml:mi mathvariant="bold">x</mml:mi></mml:math></inline-formula>. For the training, increasing batch sizes (<inline-formula><mml:math id="inf90"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>1250</mml:mn></mml:math></inline-formula> 1250 to 1800) were used, both in terms of the entire AP and considering only subsets over time <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⊂</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> from <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>16</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, resulting in a reduction of training time needed. The neural network was trained for a total number of 5000 epochs using the first-order gradient-based algorithm ADAM <xref ref-type="bibr" rid="bib37">Kingma and Ba, 2017</xref>. The training time was approximately <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>4</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> on the GPU specified in Computational performance.</p></sec><sec id="s2-5"><title>Validation</title><p>A cross-validation approach was used to quantify and compare the performance of various emulator architectures. The validation was based on 20% of the initial training data set (7976 pairs of maximum conductances and corresponding APs, see Training). For each pair, the emulated AP <inline-formula><mml:math id="inf95"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math></inline-formula> was compared against the simulated AP <inline-formula><mml:math id="inf96"><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math></inline-formula>, given the same maximum conductances. The mismatch was quantified by the root-mean-squared error (RMSE) defined as<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mtext>RMSE</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">∼</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The mismatch was also quantified in terms of AP biomarkers <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (see AP biomarkers and abnormalities) and normalized maximum conductances <inline-formula><mml:math id="inf98"><mml:mi mathvariant="bold">x</mml:mi></mml:math></inline-formula> (see Time series fitting and estimation of maximum conductances and pharmacological parameters) in which case the RMSE was defined as<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mtext>RMSE</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mo stretchy="false">∼</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mo stretchy="false">∼</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mtext>RMSE</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">∼</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">∼</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>for <inline-formula><mml:math id="inf99"><mml:mi>N</mml:mi></mml:math></inline-formula> samples.</p></sec><sec id="s2-6"><title>Time series fitting and estimation of maximum conductances and pharmacological parameters</title><p>Time series fitting is the basis for solving the inverse problem. To fit a given AP <inline-formula><mml:math id="inf100"><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math></inline-formula>, defined on a subset of the trained domain <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>⊂</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, the first step was to choose a trial set of maximum conductances <inline-formula><mml:math id="inf102"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. Then, for the given trial set, the corresponding AP was emulated and the trial set of maximum conductances was iteratively updated by solving the following minimization problem:<disp-formula id="equ5"><label>(3)</label><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo movablelimits="true" form="prefix">min</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is a shorthand for the emulator approximation function and <italic>t</italic><sub>0</sub> is a temporal offset parameter helping in fitting the exact depolarization timing. Here, <inline-formula><mml:math id="inf104"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the element-wise indicator function on the normalized feasible parameter space <inline-formula><mml:math id="inf105"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. The minimization was done using ADAM (<xref ref-type="bibr" rid="bib37">Kingma and Ba, 2017</xref>) combined with a projection on the feasible space.</p><p>To estimate maximum conductances for a given control AP, the control AP was fitted using the original maximum conductance values as initial guesses and priors: <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. To estimate maximum conductances for a given drugged AP, the drugged AP was fitted using the maximum conductances estimated for the respective control AP as initial guesses and priors: <inline-formula><mml:math id="inf107"><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. The pharmacological parameters (scaling factors of control maximum conductances) were computed as element-wise ratios between the drugged and control maximum conductances <inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>:=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> but here, <inline-formula><mml:math id="inf109"><mml:msup><mml:mi mathvariant="bold">G</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf110"><mml:msup><mml:mi mathvariant="bold">G</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula> are the non-normalized maximum conductances, where <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Since multiple sets of maximum conductances produced similarly good fits of the given AP, the parameter <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub></mml:math></inline-formula> was introduced which minimizes the difference between original and control maximum conductances and between control and drugged maximum conductances, respectively. The value was chosen to be <inline-formula><mml:math id="inf113"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> with respect to the highest accuracy found for the synthetic data set #2 that was generated for the evaluation (see Synthetic test data (#2/#3)).</p></sec><sec id="s2-7"><title>Evaluation</title><p>The evaluation was performed for forward and inverse problems in pharmacological studies on synthetic and experimental data.</p><p>The raw experimental data were obtained without filtering but some filtering was applied before interfacing the data with the emulator. The APs contained a stimulus artifact between 0 and <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1.5</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> that was filtered as follows. For each of the last 10 consecutive APs, the transmembrane potential <inline-formula><mml:math id="inf115"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math></inline-formula> closest to the end of the recorded time series was defined as the resting transmembrane potential <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf117"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> was set for <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>1.75</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Then, the APs were resampled at <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>100</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and a low-pass filtering was performed with a second-order butterworth filter (cutoff at <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2.5</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) to reduce the high-frequency noise of the signal. Finally, the filtered APs were averaged and the averaged AP was again resampled at <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (repolarization) and <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>100</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>15</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (depolarization). An example comparison of a raw and a filtered averaged AP is given in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Comparison of an averaged raw and an averaged filtered experimental AP.</title><p>One dofetilide control AP is shown as example.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-fig4-v1.tif"/></fig><sec id="s2-7-1"><title>Computational performance</title><p>The simulation of a single AP (see Simulator) sampled at a resolution of 20 kH<sub>Z</sub> took 293 s on one core of a AMD Ryzen Threadripper 2990 WX (clock rate: 3.0 GH<sub>Z</sub>) in CARPentry. Adaptive timestep solver of variable order, such as implemented in <monospace>Myokit </monospace>(<xref ref-type="bibr" rid="bib11">Clerx et al., 2016</xref>), can significantly lower the simulation time (30 s for our setup) by using small step sizes close to the depolarization (phase 0) and increasing the time step in all other phases. The emulation of a steady state AP sampled at a resolution of 20 KH<sub>Z</sub> for <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> took 18.7 ms on a AMD Ryzen 7 3800 X (clock rate: 3.9 GH<sub>Z</sub>) and 1.2 ms on a Nvidia A100 (Nvidia Corporation, USA), including synchronization and data copy overhead between CPU and GPU.</p><p>The amount of required beats to reach the steady state of the cell in the simulator has a major impact on the runtime and is not known a-priori. On the other hand, both simulator and emulator runtime linearly depends on the time resolution, but since the output of the emulator is learned, the time resolution can be chosen at arbitrarily without affecting the AP at the sampled times. This makes direct performance comparisons between the two methodologies difficult. To still be able to quantify the speed-up, we ran <monospace>Myokit </monospace>using 100 beats to reach steady state, taking 3.2 s of simulation time. In this scenario, we witnessed a speed-up of 171 and <inline-formula><mml:math id="inf126"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> of our emulator on CPU and GPU, respectively (again including synchronization and data copy overhead between CPU and GPU in the latter case). Note that both methods are similarly expected to have a linear parallelization speedup across multiple cells.</p><p>For the inverse problem, we parallelized the problem for multiple cells and keep the problem on the GPU to minimize the overhead, achieving emulations (including backpropagation) that run in 120 s per AP at an average temporal resolution of 2 KH<sub>Z</sub>. We consider this the peak performance which will be necessary for the inverse problem in Inverse problem based on synthetic data.</p></sec><sec id="s2-7-2"><title>Forward problem</title><p>The emulator evaluation for the forward problem, i.e. to find the drugged AP for given pharmacological parameters, was only performed on synthetic data since maximum conductances were not available experimentally. The maximum conductances of data sets #2 and #3 were used to consider data with normal APs and with abnormal APs exhibiting EADs. Pharmacological parameters are not inputs of the emulator but drugged maximum conductances that were computed as control maximum conductances scaled by the given pharmacological parameters (see Synthetic test data (#2/#3)). These were used to emulate drugged APs. The RMSE was used to quantify the mismatch between the emulated and the ground truth AP.</p></sec><sec id="s2-7-3"><title>Inverse problem</title><p>The emulator evaluation for the inverse problem, that is to find the pharmacological parameters for given control and drugged APs (through optimization), was performed on both synthetic and experimental data. When using synthetic data, the data set #2 was used including data with normal APs. First, control and drugged maximum conductances were estimated based on control and drugged APs and then, pharmacological parameters were computed as ratios of drugged and control conductances (see Time series fitting and estimation of maximum conductances and pharmacological parameters). The mismatch between estimated and ground truth maximum conductances were quantified using the error that is defined through<disp-formula id="equ6"><label>(4)</label><mml:math id="m6"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>:=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf127"><mml:mi mathvariant="bold">x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf128"><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> are the normalized estimated and ground truth maximum conductances (see Architecture). Similarly, we computed the mismatch between estimated and ground truth scaling factor vectors (<inline-formula><mml:math id="inf129"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf130"><mml:mover accent="true"><mml:mi mathvariant="bold">S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> respectively) as<disp-formula id="equ7"><label>(5)</label><mml:math id="m7"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>:=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>When using experimental data, maximum conductances and pharmacological parameters were estimated in the same way but due to a lack of experimental maximum conductances, the mismatch between estimated and ground truth values could not be quantified. Instead, the estimated pharmacological parameters were compared with distributions computed from data published within the CiPA initiative (<xref ref-type="bibr" rid="bib42">Li et al., 2017</xref>; <xref ref-type="bibr" rid="bib9">Chang et al., 2017</xref>) (CiPA distributions). The data set (<ext-link ext-link-type="uri" xlink:href="https://github.com/FDA/CiPA/tree/master/Hill_fitting/results">https://github.com/FDA/CiPA/tree/master/Hill_fitting/results</ext-link>; <xref ref-type="bibr" rid="bib10">Chang and Li, 2017</xref>) includes 2000 IC<sub>50</sub> values and Hill coefficients for each drug and for up to seven targets (<inline-formula><mml:math id="inf131"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf132"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf133"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf135"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf136"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf137"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>). The pore-block model (<xref ref-type="bibr" rid="bib5">Brennan et al., 2009</xref>) was used to obtain the corresponding scaling factors.</p></sec></sec></sec><sec id="s3" sec-type="results"><title>Results</title><sec id="s3-1"><title>Evaluation</title><sec id="s3-1-1"><title>Forward problem</title><p>The emulator evaluation for the forward problem was only done on synthetic data and both data sets #2 and #3 (see Synthetic test data (#2/#3)) were used to analyze the solution accuracy for normal and abnormal APs exhibiting EADs.</p><p>The data set #2 was used first and <xref ref-type="fig" rid="fig5">Figure 5</xref> illustrates the distribution of RMSEs between emulated and ground truth drugged APs. In total 10<sup>4</sup> APs were emulated in 0.6 s. The average RMSE over all APs was 0.47 mV and only for a few APs the RMSE was &gt;1 mV with 1.5 mV being the maximum. Largest mismatches were located in the phases 0 and 3 of the AP. While the mismatches in phase 3 were simply a result of imperfect emulation, the mismatches in phase 0 were a result of the difficulty in matching the depolarization time exactly.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Analysis of solution accuracy of the forward problem on synthetic data including normal APs (drug data of data set #2).</title><p>Left: histogram of RMSEs for the APs, right: APs with the largest RMSEs. The RMSE is given above each subplot.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-fig5-v1.tif"/></fig><p><xref ref-type="fig" rid="fig6">Figure 6</xref> shows the distribution of biomarker mismatches between emulated and ground truth drugged APs. The low RMSEs between the APs translated into low RMSEs between the AP biomarkers. Likewise, the difficulty in exactly matching the depolarization time leads to elevated errors and more outliers in the biomarkers influenced by the depolarization phase (<inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Analysis of solution accuracy of the forward problem on synthetic data including normal APs (drug data of data set #2) with respect to AP biomarkers.</title><p>Histograms of mismatches for each biomarker are shown and the RMSE is given in the upper left corner. The number in the right upper corner denotes the number of outliers of the 10,000 samples which lie outside the shown ranges.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-fig6-v1.tif"/></fig><p>The data set #3 was used second and Appendix 3 shows all emulated APs, both containing the EAD and non-EAD cases. The emulation of all 950 APs took 0.76 s on the GPU specified in Training We show the emulation of all maximum conductances and the classification of the emulation. The comparison with the actual EAD classification (based on the criterion outlined in Appendix 1) results in true-positive (EAD both in the simulation and emulation), false-negative (EAD in the simulation, but not in the emulation), false-positive (EAD in the emulation, but not in the simulation) and true-negative (no EAD both in the emulation and simulation). The emulations achieved 72.5% sensitivity (EAD cases correctly classified) and 94.9% specificity (non-EAD cases correctly classified), with an overall acurracy of 90.8% (total samples correctly classified). A substantial amount of wrongly classified APs showcase a notable proximity to the threshold of manifesting EADs. <xref ref-type="fig" rid="fig7">Figure 7</xref> illustrates the distribution of RMSEs in the EAD APs between emulated and ground truth drugged APs. The average RMSE over all EAD APs was 14.5 mV with 37.1 mV being the maximum. Largest mismatches were located in phase 3 of the AP, in particular in emulated APs that did not fully repolarize.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Analysis of solution accuracy of the forward problem on synthetic data including abnormal APs exhibiting EADs (subset of data set #3).</title><p>Left: histogram of RMSEs for the APs, right: APs with the largest RMSEs. Of the 171 emulated APs, 124 exhibit the expected EADs (based on the criterion outlined in Appendix 1). The RMSE is given above each subplot. All emulated APs are shown in Appendix 3.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-fig7-v1.tif"/></fig></sec><sec id="s3-1-2"><title>Inverse problem based on synthetic data</title><p>The emulator evaluation for the inverse problem was first done using synthetic data (data set #2, see Synthetic test data (#2/#3)). For this, we minimized (3) by using ADAM (<xref ref-type="bibr" rid="bib37">Kingma and Ba, 2017</xref>) with no batching for 10<sup>4</sup> iterations for all 100 cardiomyocytes times 100 drugs (i.e. 10<sup>4</sup> APs), resulting in a total of 10<sup>8</sup> emulations, taking approximately 3.5 h on the GPU specified in Training. Control and drugged APs could be fitted with an average RMSE of 0.8 mV. Largest mismatches were located in phase 0 and 3 of the AP for the reasons given above (see Forward problem). <xref ref-type="fig" rid="fig8">Figure 8</xref> shows the distribution of the errors between the estimated and the ground truth maximum conductances and pharmacological parameters. For both the maximum conductances (RMSE <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi/><mml:mo>≤</mml:mo><mml:mn>0.18</mml:mn></mml:mrow></mml:math></inline-formula>) and the related pharmacological parameters (RMSE <inline-formula><mml:math id="inf141"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≤</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0.22</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), the errors were closely distributed around zero. However, the RMSEs increased from the control maximum conductance over the drugged maximum conductance to the pharmacological parameters and there were distinctive differences among maximum conductances and related pharmacological parameters with the smallest for G<sub>Kr</sub> and the largest for G<sub>Ks</sub>.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Analysis of solution accuracy of the inverse problem on synthetic data (data set #2).</title><p>Left: boxplot of errors between normalized estimated and ground truth control maximum conductances, middle: boxplot of errors between normalized estimated and ground truth drugged maximum conductances, right: boxplot of errors between estimated and ground truth pharmacological parameters. Error definitions are given in (4) and (5). The RMSE over all data is given below each parameter.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-fig8-v1.tif"/></fig></sec><sec id="s3-1-3"><title>Inverse problem based on experimental data</title><p>The emulator evaluation for the inverse problem was then done on experimental data (Experimental data (#4)). Similar to the synthetic inverse problem, we optimized (3), this time for <inline-formula><mml:math id="inf142"><mml:mrow><mml:mn>5</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf143"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> epochs for control and drug APs for each drug sample. The total computational time spent on this task was 2.8 hr on the GPU specified in Training.</p><p><xref ref-type="fig" rid="fig9">Figure 9</xref> shows the fitted and the ground truth APs for all drugs. Control and drugged APs could be fitted with average RMSEs shown in <xref ref-type="table" rid="table4">Table 4</xref>. The largest mismatch was located in phase 0 for most APs, which was the result from an imperfect matching of the exact depolarization timing.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Analysis of fit quality of the inverse problem on experimental data.</title><p>Comparison of the fitted APs (solid lines) and the experimental APs (dashed lines) at control (red) and after drug administration (blue) for all drugs.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-fig9-v1.tif"/></fig><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title>Average RMSE over control and drugged APs measured in all preparations per drug.</title><p>All values in mV.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Drug</th><th align="left" valign="bottom">RMSE control</th><th align="left" valign="bottom">RMSE drug</th></tr></thead><tbody><tr><td align="left" valign="bottom">Cisapride</td><td align="left" valign="bottom">1.53</td><td align="left" valign="bottom">2</td></tr><tr><td align="left" valign="bottom">Dofetilide</td><td align="left" valign="bottom">2.05</td><td align="left" valign="bottom">1.73</td></tr><tr><td align="left" valign="bottom">Sotalol</td><td align="left" valign="bottom">1.4</td><td align="left" valign="bottom">2.51</td></tr><tr><td align="left" valign="bottom">Terfenadine</td><td align="left" valign="bottom">1.22</td><td align="left" valign="bottom">1.08</td></tr><tr><td align="left" valign="bottom">Verapamil</td><td align="left" valign="bottom">1.93</td><td align="left" valign="bottom">2.21</td></tr></tbody></table></table-wrap><p><xref ref-type="fig" rid="fig10">Figure 10</xref> compares the estimated pharmacological parameters and the CiPA distributions. Pharmacological parameters that fell into the range spanned by <inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>±</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0.15</mml:mn><mml:mo>+</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of the CiPA distribution, where <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:math></inline-formula> are the distribution’s mean and standard deviation respectively, were classified as successfully estimated while the others were classified as unsuccessfully estimated. In total, 50% of the pharmacological parameters could be estimated succesfully and while all pharmacological parameters related to G<sub>Ks</sub> could be successfully estimated, unsuccessfully estimated parameters were found across all maximum conductances, in particular related to G<sub>K1</sub> for which all pharmacological parameters could not be successfully estimated (<xref ref-type="table" rid="table5">Table 5</xref>).</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Analysis of solution accuracy of the inverse problem using experimental data.</title><p>The histograms compare the estimated pharmacological parameters (dashed vertical lines) from data of multiple preparations with the CiPA distributions (blue; see Inverse problem). The black dash dotted vertical lines are the borders of the range (grey) that was used to determine if the estimation of the given pharmacological parameter was successful. The range is spanned up by µ ± (0.15 + σ) of the CiPA distribution. Successfully estimated parameters are shown as green lines and unsuccessfully estimated parameters are shown as red lines. The number in the upper left corner indicates for how many preparations the parameters could be successfully estimated in relation to the total number of preparations for the given drug.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-fig10-v1.tif"/></fig><table-wrap id="table5" position="float"><label>Table 5.</label><caption><title>Pharmacological parameters related to maximum conductances that were considered successfullyor unsuccessfully estimated across all preparations and drugs.</title><p>For each channel, the drugs are stated forwhich respective data from the CiPA initiative were available. C, D, S, T, V, A mark cisapride, dofetilide, sotalol,terfenadine, verapamil, all drugs respectively.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom">Gna</th><th align="left" valign="bottom">GNaL</th><th align="left" valign="bottom">Gto</th><th align="left" valign="bottom">GKr</th><th align="left" valign="bottom">GKs</th><th align="left" valign="bottom">GK</th><th align="left" valign="bottom">PCa</th><th align="left" valign="bottom">Total</th></tr></thead><tbody><tr><td align="left" valign="bottom">Successful</td><td align="left" valign="bottom">6</td><td align="left" valign="bottom">6</td><td align="left" valign="bottom">8</td><td align="left" valign="bottom">3</td><td align="left" valign="bottom">9</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">5</td><td align="left" valign="bottom">37</td></tr><tr><td align="left" valign="bottom">Unsuccessful</td><td align="left" valign="bottom">3</td><td align="left" valign="bottom">1</td><td align="left" valign="bottom">5</td><td align="left" valign="bottom">10</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">10</td><td align="left" valign="bottom">8</td><td align="left" valign="bottom">37</td></tr><tr><td align="left" valign="bottom">Ratio</td><td align="left" valign="bottom">0.67</td><td align="left" valign="bottom">0.86</td><td align="left" valign="bottom">0.62</td><td align="left" valign="bottom">0.23</td><td align="left" valign="bottom">1</td><td align="left" valign="bottom">0</td><td align="left" valign="bottom">0.38</td><td align="left" valign="bottom">0.5</td></tr></tbody></table></table-wrap></sec></sec></sec><sec id="s4" sec-type="discussion"><title>Discussion</title><p>NN emulation of the human ventricular cardiomyocyte AP was introduced and the applicability in pharmacological studies was investigated.</p><sec id="s4-1"><title>Evaluation</title><p>The evaluated NN emulator showed highly accurate AP emulations for the forward problem on synthetic data. High accuracy was found in normal APs in data set #2 (average RMSE was 0.47 mV; <xref ref-type="fig" rid="fig5">Figure 5</xref>) and to a lesser extent also in abnormal APs exhibiting EADs: of the emulated EAD APs, 72.5% exhibited alignment with the abnormality, and the substantial majority of the remaining APs demonstrated pronounced proximity, while the average RMSE among the EAD APs was 14.5 mV (<xref ref-type="fig" rid="fig7">Figure 7</xref>). In comparison, the normal APs exhibiting no EAD in data set #3 could be reconstructed with an average RMSE of 4.02 mV and the overall accuracy of classifying EAD on emulated APs was 90.8%. Increasing the amount of training data within the relevant range could lead to further enhancements in accuracy for abnormal APs. Nevertheless, this observation demonstrates that the emulator is also capable of accounting for discontinuities of the response surface. This is particularly useful in pharmacological studies and a key advantage over existing emulation approaches (<xref ref-type="bibr" rid="bib8">Chang et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Johnstone et al., 2016</xref>; <xref ref-type="bibr" rid="bib15">Coveney and Clayton, 2018</xref>; <xref ref-type="bibr" rid="bib21">Ghosh, 2018</xref>; <xref ref-type="bibr" rid="bib58">Rasmussen, 2019</xref>; <xref ref-type="bibr" rid="bib16">Coveney et al., 2021</xref>).</p><p>The emulator was further evaluated for the inverse problem on synthetic and also on experimental data. Maximum conductances and related pharmacological parameters could be widely estimated with high accuracy on synthetic data (RMSE <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi/><mml:mo>≤</mml:mo><mml:mn>0.18</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf147"><mml:mrow><mml:mi/><mml:mo>≤</mml:mo><mml:mn>0.21</mml:mn></mml:mrow></mml:math></inline-formula> for all maximum conductances and pharmacological parameters, respectively; <xref ref-type="fig" rid="fig8">Figure 8</xref>).</p><p>The RMSEs increased from the control maximum conductance over the drugged maximum conductance to the pharmacological parameters which may be because the estimation of drugged maximum conductances depends on the control maximum conductances and the computation of pharmacological parameters depends on both control and drugged maximum conductances (see Time series fitting and estimation of maximum conductances and pharmacological parameters) allowing that errors can propagate and amplify. Distinctive differences were observed among the maximum conductances and related pharmacological parameters and the largest RMSEs were found for G<sub>Ks</sub> throughout. This can be attributed to various degrees of parameter identifiability <xref ref-type="bibr" rid="bib62">Sarkar and Sobie, 2010</xref>; <xref ref-type="bibr" rid="bib77">Zaniboni et al., 2010</xref>; <xref ref-type="bibr" rid="bib23">Groenendaal et al., 2015</xref>; <xref ref-type="bibr" rid="bib30">Jaeger et al., 2019</xref>; <xref ref-type="bibr" rid="bib76">Whittaker et al., 2020</xref> and the results agree with the GSA that indicates almost non-identifiability of G<sub>Ks</sub> (Appendix 2).</p><p>Larger inaccuracies were found in the inverse problem solutions on experimental data (<xref ref-type="fig" rid="fig10">Figure 10</xref>, <xref ref-type="table" rid="table4">Table 4</xref>). The first reason may be low parameter identifiability and we want to highlight inaccuracies in estimating the pharmacological parameters related to G<sub>Kr</sub>, P<sub>Ca</sub>, and G<sub>NaL</sub> when the hERG channel was blocked in parallel to the Cav1.2 channel (verapamil) or in parallel to both the Cav1.2 and the Nav1.5-late channel (terfenadine). The hERG channel block (prolongation of the AP), and the Cav1.2 and Nav1.5-late channel block (shortening of the AP) are known to have opposite effects on the AP <xref ref-type="bibr" rid="bib53">Orvos, 2019</xref>. At the given drug concentrations, these effects were apparently counterbalancing, which resulted in negligible changes of the AP (<xref ref-type="fig" rid="fig9">Figure 9</xref>). This situation made the estimation of pharmacological parameters very challenging and led to particularly large inaccuracies for terfenadine. The accurate estimations of the pharmacological parameters related to GKs are surprising at first in light of the almost non-identifiability. This was due to the combination of two factors: (1) different from synthetic data, the drugs at the given concentrations did not affect the corresponding KCNQ1-MinK channel and (2) the difference between control and drugged maximum conductance was weakly enforced to be minimal (see Time series fitting and estimation of maximum conductances and pharmacological parameters) which leads to almost no difference in non-identifiable parameters and hence, to a pharmacological parameter of one. The accuracy will likely be much lower in drugs that affect the KCNQ1-MinK channel.</p><p>The second and probably main reason for the inaccuracies may be the fact that the data were collected in small tissue preparations, whereas the emulator was trained on data generated by a simulator that represents single cardiomyocytes. APs in small tissue preparations are slightly different from those in single cardiomyocytes. Differences can arise from electrotonic coupling and the mixture of cells including fibroblasts that are able to modify the EP (<xref ref-type="bibr" rid="bib38">Kohl and Gourdie, 2014</xref>; <xref ref-type="bibr" rid="bib44">Mayer et al., 2017</xref>; <xref ref-type="bibr" rid="bib25">Hall et al., 2021</xref>). This can hamper the fitting of the APs and consequently, the estimation of the maximum conductances and pharmacological parameters.</p></sec><sec id="s4-2"><title>Emulator</title><p>The presented NN emulator enables a massive speed-up compared to regular simulations and the evaluation for the forward problem on synthetic data showed also highly accurate AP emulations. Cardiomyocyte EP models are already very quick to evaluate in the scale of seconds (see Computational performance), but the achieved runtime of emulations allows to solve time consuming simulation protocols markedly more efficient. One such scenario is the presented inverse maximum conductance estimation problem (see Inverse problem based on synthetic data and Inverse problem based on experimental data), where for estimating maximum conductances of a single AP, we need to emulate the steady state AP at least several hundred times as part of an optimization procedure. Further applications include the probabilistic use of cardiomyocyte EP models with uncertainty quantification (<xref ref-type="bibr" rid="bib9">Chang et al., 2017</xref>; <xref ref-type="bibr" rid="bib35">Johnstone et al., 2016</xref>) where thousands of samples of parameters are potentially necessary to compute a distribution of the steady-state properties of subsequent APs, and the creation of cell populations (<xref ref-type="bibr" rid="bib50">Muszkiewicz et al., 2016</xref>; <xref ref-type="bibr" rid="bib20">Gemmell et al., 2016</xref>; <xref ref-type="bibr" rid="bib6">Britton et al., 2013</xref>). In addition to the aforementioned strengths of the presented NN emulator, some further valuable features are worth mentioning that arise from the continuous nature of the emulator. First, the AP can be emulated and fitted at any desired resolution. Second, timing offsets, for example between stimuli in the data to be fitted and the training data, can be accounted for using <italic>t</italic><sub>0</sub> in (3) without retraining. Last but not least, the transmembrane potential gradient <inline-formula><mml:math id="inf148"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>, recently highlighted in terms of proarrhythmic potential prediction (<xref ref-type="bibr" rid="bib33">Jeong et al., 2022</xref>), can be continuously derived and is not dependent on the temporal discretization.</p></sec><sec id="s4-3"><title>Limitations and future work</title><p>Some limitations have to be considered. First, the emulator has only maximum conductances as inputs. Although these explain much of the AP variability seen between cardiomyocytes (<xref ref-type="bibr" rid="bib6">Britton et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Muszkiewicz et al., 2016</xref>), the inclusion of parameters related to the channel kinetics might enable a more detailed consideration of drug effects in pharmacological studies. In general, the question of complete parameter identifiability utilizing only APs remains an open challenge (<xref ref-type="bibr" rid="bib77">Zaniboni et al., 2010</xref>). Channel kinetics determine the contribution of the corresponding current to the AP generation in different phases and can thus also modulate drug effects, but were however neglected, as the expansion of the input space might be unsuitable for solving the inverse problem when only AP data are used. Second, the interaction between drugs and their targets is solely captured through scaling of the related maximum conductance at control, which is mostly adequate but in fact an oversimplification (<xref ref-type="bibr" rid="bib5">Brennan et al., 2009</xref>). The interaction can be dependent on time, voltage, and channel state, which requires the use of Markov models with many more parameters (<xref ref-type="bibr" rid="bib5">Brennan et al., 2009</xref>; <xref ref-type="bibr" rid="bib42">Li et al., 2017</xref>; <xref ref-type="bibr" rid="bib41">Lei et al., 2024</xref>). Again, this expands the input space and might be unsuitable for solving the inverse problem when only AP data are used. Moreover, drugs that are applied over a longer period of time can also cause modifications of the maximum conductances through changes in gene expression (<xref ref-type="bibr" rid="bib64">Shim et al., 2023</xref>). This requires attention to avoid misinterpretations of found blocking or enhancement effects, for example by estimating the control maximum conductances again after a washout procedure. Third, the inverse problem was only solved for AP data obtained from one single stimulation protocol. <xref ref-type="bibr" rid="bib35">Johnstone et al., 2016</xref> have shown that the usage of AP data obtained from various stimulation protocols can improve the parameter identifiability and thus, the accuracy of parameter estimates. To be able to use those data in the presented approach, the pacing cycle length must be included as additional input in the emulator and the emulator may be trained on more than the last AP of the pacing series. This would also allow to capture alternans. Last but not least, the number of drugs and concentrations considered in the inverse problem on experimental data poses a limitation. The ultimate goal is to have a tool that provides highly accurate solutions for drugs with different targets and concentrations. To this end, analyses must be extended by data obtained from a series of available and well characterized drugs. The data should be collected in single cardiomyocytes in order to minimize the discussed inaccuracies that stem from the use of tissue preparation data. Further simulation studies of the inverse problem on tissue slabs versus cardiomyocyte EP model could be integrated to assess the impact of differences in setups. This should be addressed in future work. Of note, the presented approach can also be straightforwardly applied to other transients, for example intracellular [Ca<sup>2+</sup>] or sarcomere length.</p></sec><sec id="s4-4"><title>Conclusion</title><p>This paper introduced NN emulation of the human ventricular cardiomyocyte AP and tested its applicability in pharmacological studies. The computational cost of the NN emulator was compared to that of the simulator, revealing a massive speed-up of more than 1e<sup>3</sup>. The accuracy of solving the forward problem on synthetic data was found to be high for normal APs and this hold mostly true for abnormal APs exhibiting EADs. This advantage distinguishes our novel approach from existing emulation methods. While larger inaccuracies were observed when utilizing experimental data – a limitation thoroughly discussed and particularly inherent to the fact that small tissue preparations were studied while the emulator was trained on single cardiomyocyte data – the accuracy of solving the inverse problem on synthetic data remained high. Collectively, these findings underscore the potential of NN emulators in improving the efficiency of future quantitative systems pharmacology studies.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Funding acquisition, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Resources, Funding acquisition, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Resources, Formal analysis, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Funding acquisition, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Funding acquisition, Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Resources, Funding acquisition, Writing – review and editing</p></fn><fn fn-type="con" id="con8"><p>Resources, Funding acquisition, Writing – review and editing</p></fn><fn fn-type="con" id="con9"><p>Resources, Funding acquisition, Writing – review and editing</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Data curation, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Writing - original draft, Project administration, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Data set #4 contains data of small right ventricular trabeculae and papillary tissue preparations that were obtained from healthy human hearts (see Orvos et al., 2019). Hearts were obtained from organ donors whose hearts were explanted to obtain pulmonary and aortic valves for transplant surgery. Before cardiac explantation, organ donors did not receive medication apart from dobutamine, furosemide, and plasma expanders. Proper consent was obtained for use of each individual's tissue for experimentation. The investigations conform to the principles of the Declaration of Helsinki. Experimental protocols were approved by the University of Szeged and National Scientific and Research Ethical Review Boards (No. 51-57/1997 OEj and 4991-0/2010-1018EKU [339/PI/010]).</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-91911-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The trained emulator is available as a python package from <ext-link ext-link-type="uri" xlink:href="https://github.com/thomgrand/cardiomyocyte_emulator">https://github.com/thomgrand/cardiomyocyte_emulator</ext-link> (copy archived at <xref ref-type="bibr" rid="bib68">Thomas, 2024</xref>; the code is licensed under AGPLv3, see <ext-link ext-link-type="uri" xlink:href="https://www.gnu.org/licenses/agpl-3.0.en.html">https://www.gnu.org/licenses/agpl-3.0.en.html</ext-link> for details). The trained emulator is provided as a Python package, heavily utilizing PyTorch (<xref ref-type="bibr" rid="bib56">Paszke, 2019</xref>) for the neural network execution, allowing it to be executed on both CPUs and NVidia GPUs. Additionally, NumPy (<xref ref-type="bibr" rid="bib26">Harris et al., 2020</xref>) interfaces are provided for easy interfacing with other libraries. Note that the provided repository is a re-implementation of the code-base used in this study and thus may deviate in performance or runtime. The training data set (data set #1) is available on Zenodo using the link <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/10640339">https://zenodo.org/records/10640339</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Grandits</surname><given-names>T</given-names></name><name><surname>Augustin</surname><given-names>C</given-names></name><name><surname>Haase</surname><given-names>G</given-names></name><name><surname>Jost</surname><given-names>N</given-names></name><name><surname>Mirams</surname><given-names>G</given-names></name><name><surname>Niederer</surname><given-names>S</given-names></name><name><surname>Plank</surname><given-names>G</given-names></name><name><surname>Varró</surname><given-names>V</given-names></name><name><surname>Virág</surname><given-names>L</given-names></name><name><surname>Jung</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Cardiomyocyte Emulator Training Data</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.10640339</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This research was funded by the Austrian Science Fund (FWF), the German Research Foundation (DFG), the National Institutes of Health, the National Research, Development and Innovation Office (NRDI), the Hungarian Research Network (HUN-REN), and the Wellcome Trust. For the purpose of open access, the authors have applied a CC-BY public copyright licence to any Author Accepted Manuscript version arising from this submission.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amuzescu</surname><given-names>B</given-names></name><name><surname>Airini</surname><given-names>R</given-names></name><name><surname>Epureanu</surname><given-names>FB</given-names></name><name><surname>Mann</surname><given-names>SA</given-names></name><name><surname>Knott</surname><given-names>T</given-names></name><name><surname>Radu</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Evolution of mathematical models of cardiomyocyte electrophysiology</article-title><source>Mathematical Biosciences</source><volume>334</volume><elocation-id>108567</elocation-id><pub-id pub-id-type="doi">10.1016/j.mbs.2021.108567</pub-id><pub-id pub-id-type="pmid">33607174</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartolucci</surname><given-names>C</given-names></name><name><surname>Passini</surname><given-names>E</given-names></name><name><surname>Hyttinen</surname><given-names>J</given-names></name><name><surname>Paci</surname><given-names>M</given-names></name><name><surname>Severi</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Simulation of the effects of extracellular calcium changes leads to a novel computational model of human ventricular action potential with a revised calcium handling</article-title><source>Frontiers in Physiology</source><volume>11</volume><elocation-id>314</elocation-id><pub-id pub-id-type="doi">10.3389/fphys.2020.00314</pub-id><pub-id pub-id-type="pmid">32351400</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blinova</surname><given-names>K</given-names></name><name><surname>Dang</surname><given-names>Q</given-names></name><name><surname>Millard</surname><given-names>D</given-names></name><name><surname>Smith</surname><given-names>G</given-names></name><name><surname>Pierson</surname><given-names>J</given-names></name><name><surname>Guo</surname><given-names>L</given-names></name><name><surname>Brock</surname><given-names>M</given-names></name><name><surname>Lu</surname><given-names>HR</given-names></name><name><surname>Kraushaar</surname><given-names>U</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Shi</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Sawada</surname><given-names>K</given-names></name><name><surname>Osada</surname><given-names>T</given-names></name><name><surname>Kanda</surname><given-names>Y</given-names></name><name><surname>Sekino</surname><given-names>Y</given-names></name><name><surname>Pang</surname><given-names>L</given-names></name><name><surname>Feaster</surname><given-names>TK</given-names></name><name><surname>Kettenhofen</surname><given-names>R</given-names></name><name><surname>Stockbridge</surname><given-names>N</given-names></name><name><surname>Strauss</surname><given-names>DG</given-names></name><name><surname>Gintant</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>International multisite study of human-induced pluripotent stem cell-derived cardiomyocytes for drug proarrhythmic potential assessment</article-title><source>Cell Reports</source><volume>24</volume><fpage>3582</fpage><lpage>3592</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2018.08.079</pub-id><pub-id pub-id-type="pmid">30257217</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bottino</surname><given-names>D</given-names></name><name><surname>Penland</surname><given-names>RC</given-names></name><name><surname>stamps</surname><given-names>A</given-names></name><name><surname>Traebert</surname><given-names>M</given-names></name><name><surname>Dumotier</surname><given-names>B</given-names></name><name><surname>Georgiva</surname><given-names>A</given-names></name><name><surname>Helmlinger</surname><given-names>G</given-names></name><name><surname>Lett</surname><given-names>GS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Preclinical cardiac safety assessment of pharmaceutical compounds using an integrated systems-based computer model of the heart</article-title><source>Progress in Biophysics and Molecular Biology</source><volume>90</volume><fpage>414</fpage><lpage>443</lpage><pub-id pub-id-type="doi">10.1016/j.pbiomolbio.2005.06.006</pub-id><pub-id pub-id-type="pmid">16321428</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brennan</surname><given-names>T</given-names></name><name><surname>Fink</surname><given-names>M</given-names></name><name><surname>Rodriguez</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Multiscale modelling of drug-induced effects on cardiac electrophysiological activity</article-title><source>European Journal of Pharmaceutical Sciences</source><volume>36</volume><fpage>62</fpage><lpage>77</lpage><pub-id pub-id-type="doi">10.1016/j.ejps.2008.09.013</pub-id><pub-id pub-id-type="pmid">19061955</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Britton</surname><given-names>OJ</given-names></name><name><surname>Bueno-Orovio</surname><given-names>A</given-names></name><name><surname>Van Ammel</surname><given-names>K</given-names></name><name><surname>Lu</surname><given-names>HR</given-names></name><name><surname>Towart</surname><given-names>R</given-names></name><name><surname>Gallacher</surname><given-names>DJ</given-names></name><name><surname>Rodriguez</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Experimentally calibrated population of models predicts and explains intersubject variability in cardiac cellular electrophysiology</article-title><source>PNAS</source><volume>110</volume><fpage>E2098</fpage><lpage>E2105</lpage><pub-id pub-id-type="doi">10.1073/pnas.1304382110</pub-id><pub-id pub-id-type="pmid">23690584</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Britton</surname><given-names>OJ</given-names></name><name><surname>Bueno-Orovio</surname><given-names>A</given-names></name><name><surname>Virág</surname><given-names>L</given-names></name><name><surname>Varró</surname><given-names>A</given-names></name><name><surname>Rodriguez</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The electrogenic Na<sup>+</sup>/K<sup>+</sup> pump is a key determinant of repolarization abnormality susceptibility in human ventricular cardiomyocytes: a population-based simulation study</article-title><source>Frontiers in Physiology</source><volume>8</volume><elocation-id>278</elocation-id><pub-id pub-id-type="doi">10.3389/fphys.2017.00278</pub-id><pub-id pub-id-type="pmid">28529489</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>ETY</given-names></name><name><surname>Strong</surname><given-names>M</given-names></name><name><surname>Clayton</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Bayesian sensitivity analysis of a cardiac cell model using a gaussian process emulator</article-title><source>PLOS ONE</source><volume>10</volume><elocation-id>e0130252</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0130252</pub-id><pub-id pub-id-type="pmid">26114610</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>KC</given-names></name><name><surname>Dutta</surname><given-names>S</given-names></name><name><surname>Mirams</surname><given-names>GR</given-names></name><name><surname>Beattie</surname><given-names>KA</given-names></name><name><surname>Sheng</surname><given-names>J</given-names></name><name><surname>Tran</surname><given-names>PN</given-names></name><name><surname>Wu</surname><given-names>M</given-names></name><name><surname>Wu</surname><given-names>WW</given-names></name><name><surname>Colatsky</surname><given-names>T</given-names></name><name><surname>Strauss</surname><given-names>DG</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Uncertainty quantification reveals the importance of data variability and experimental design considerations for <italic>in Silico</italic> proarrhythmia risk assessment</article-title><source>Frontiers in Physiology</source><volume>8</volume><elocation-id>917</elocation-id><pub-id pub-id-type="doi">10.3389/fphys.2017.00917</pub-id><pub-id pub-id-type="pmid">29209226</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Comprehensive in vitro Proarrhythmia assay (CiPA) in silico model</data-title><version designator="e881df6">e881df6</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/FDA/CiPA">https://github.com/FDA/CiPA</ext-link></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clerx</surname><given-names>M</given-names></name><name><surname>Collins</surname><given-names>P</given-names></name><name><surname>de Lange</surname><given-names>E</given-names></name><name><surname>Volders</surname><given-names>PGA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Myokit: a simple interface to cardiac cellular electrophysiology</article-title><source>Progress in Biophysics and Molecular Biology</source><volume>120</volume><fpage>100</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1016/j.pbiomolbio.2015.12.008</pub-id><pub-id pub-id-type="pmid">26721671</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Clevert</surname><given-names>DA</given-names></name><name><surname>Unterthiner</surname><given-names>T</given-names></name><name><surname>Hochreiter</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fast and accurate deep network learning by exponential linear units (ELUs)</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1511.07289">https://arxiv.org/abs/1511.07289</ext-link></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colatsky</surname><given-names>T</given-names></name><name><surname>Fermini</surname><given-names>B</given-names></name><name><surname>Gintant</surname><given-names>G</given-names></name><name><surname>Pierson</surname><given-names>JB</given-names></name><name><surname>Sager</surname><given-names>P</given-names></name><name><surname>Sekino</surname><given-names>Y</given-names></name><name><surname>Strauss</surname><given-names>DG</given-names></name><name><surname>Stockbridge</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The comprehensive in vitro proarrhythmia assay (CiPA) initiative - update on progress</article-title><source>Journal of Pharmacological and Toxicological Methods</source><volume>81</volume><fpage>15</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1016/j.vascn.2016.06.002</pub-id><pub-id pub-id-type="pmid">27282641</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corrado</surname><given-names>C</given-names></name><name><surname>Avezzù</surname><given-names>A</given-names></name><name><surname>Lee</surname><given-names>AWC</given-names></name><name><surname>Mendoca Costa</surname><given-names>C</given-names></name><name><surname>Roney</surname><given-names>CH</given-names></name><name><surname>Strocchi</surname><given-names>M</given-names></name><name><surname>Bishop</surname><given-names>M</given-names></name><name><surname>Niederer</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Using cardiac ionic cell models to interpret clinical data</article-title><source>WIREs Mechanisms of Disease</source><volume>13</volume><elocation-id>e1508</elocation-id><pub-id pub-id-type="doi">10.1002/wsbm.1508</pub-id><pub-id pub-id-type="pmid">33027553</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coveney</surname><given-names>S</given-names></name><name><surname>Clayton</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Fitting two human atrial cell models to experimental data using Bayesian history matching</article-title><source>Progress in Biophysics and Molecular Biology</source><volume>139</volume><fpage>43</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1016/j.pbiomolbio.2018.08.001</pub-id><pub-id pub-id-type="pmid">30145156</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coveney</surname><given-names>S</given-names></name><name><surname>Corrado</surname><given-names>C</given-names></name><name><surname>Oakley</surname><given-names>JE</given-names></name><name><surname>Wilkinson</surname><given-names>RD</given-names></name><name><surname>Niederer</surname><given-names>SA</given-names></name><name><surname>Clayton</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Bayesian calibration of electrophysiology models using restitution curve emulators</article-title><source>Frontiers in Physiology</source><volume>12</volume><elocation-id>693015</elocation-id><pub-id pub-id-type="doi">10.3389/fphys.2021.693015</pub-id><pub-id pub-id-type="pmid">34366883</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crumb</surname><given-names>WJ</given-names></name><name><surname>Vicente</surname><given-names>J</given-names></name><name><surname>Johannesen</surname><given-names>L</given-names></name><name><surname>Strauss</surname><given-names>DG</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>An evaluation of 30 clinical drugs against the comprehensive in vitro proarrhythmia assay (CiPA) proposed ion channel panel</article-title><source>Journal of Pharmacological and Toxicological Methods</source><volume>81</volume><fpage>251</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1016/j.vascn.2016.03.009</pub-id><pub-id pub-id-type="pmid">27060526</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dutta</surname><given-names>S</given-names></name><name><surname>Chang</surname><given-names>KC</given-names></name><name><surname>Beattie</surname><given-names>KA</given-names></name><name><surname>Sheng</surname><given-names>J</given-names></name><name><surname>Tran</surname><given-names>PN</given-names></name><name><surname>Wu</surname><given-names>WW</given-names></name><name><surname>Wu</surname><given-names>M</given-names></name><name><surname>Strauss</surname><given-names>DG</given-names></name><name><surname>Colatsky</surname><given-names>T</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Optimization of an <italic>In silico</italic> cardiac cell model for proarrhythmia risk assessment</article-title><source>Frontiers in Physiology</source><volume>8</volume><elocation-id>616</elocation-id><pub-id pub-id-type="doi">10.3389/fphys.2017.00616</pub-id><pub-id pub-id-type="pmid">28878692</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garny</surname><given-names>A</given-names></name><name><surname>Hunter</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>OpenCOR: a modular and interoperable approach to computational biology</article-title><source>Frontiers in Physiology</source><volume>6</volume><elocation-id>26</elocation-id><pub-id pub-id-type="doi">10.3389/fphys.2015.00026</pub-id><pub-id pub-id-type="pmid">25705192</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gemmell</surname><given-names>P</given-names></name><name><surname>Burrage</surname><given-names>K</given-names></name><name><surname>Rodríguez</surname><given-names>B</given-names></name><name><surname>Quinn</surname><given-names>TA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Rabbit-specific computational modelling of ventricular cell electrophysiology: Using populations of models to explore variability in the response to ischemia</article-title><source>Progress in Biophysics and Molecular Biology</source><volume>121</volume><fpage>169</fpage><lpage>184</lpage><pub-id pub-id-type="doi">10.1016/j.pbiomolbio.2016.06.003</pub-id><pub-id pub-id-type="pmid">27320382</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ghosh</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Gaussian process emulation for discontinuous response surfaces with applications for cardiac electrophysiology models</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1805.10020">https://arxiv.org/abs/1805.10020</ext-link></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grandi</surname><given-names>E</given-names></name><name><surname>Pasqualini</surname><given-names>FS</given-names></name><name><surname>Bers</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A novel computational model of the human ventricular action potential and Ca transient</article-title><source>Journal of Molecular and Cellular Cardiology</source><volume>48</volume><fpage>112</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1016/j.yjmcc.2009.09.019</pub-id><pub-id pub-id-type="pmid">19835882</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Groenendaal</surname><given-names>W</given-names></name><name><surname>Ortega</surname><given-names>FA</given-names></name><name><surname>Kherlopian</surname><given-names>AR</given-names></name><name><surname>Zygmunt</surname><given-names>AC</given-names></name><name><surname>Krogh-Madsen</surname><given-names>T</given-names></name><name><surname>Christini</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Cell-specific cardiac electrophysiology models</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004242</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004242</pub-id><pub-id pub-id-type="pmid">25928268</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guillaume</surname><given-names>JHA</given-names></name><name><surname>Jakeman</surname><given-names>JD</given-names></name><name><surname>Marsili-Libelli</surname><given-names>S</given-names></name><name><surname>Asher</surname><given-names>M</given-names></name><name><surname>Brunner</surname><given-names>P</given-names></name><name><surname>Croke</surname><given-names>B</given-names></name><name><surname>Hill</surname><given-names>MC</given-names></name><name><surname>Jakeman</surname><given-names>AJ</given-names></name><name><surname>Keesman</surname><given-names>KJ</given-names></name><name><surname>Razavi</surname><given-names>S</given-names></name><name><surname>Stigter</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Introductory overview of identifiability analysis: A guide to evaluating whether you have the right type of data for your modeling purpose</article-title><source>Environmental Modelling &amp; Software</source><volume>119</volume><fpage>418</fpage><lpage>432</lpage><pub-id pub-id-type="doi">10.1016/j.envsoft.2019.07.007</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>C</given-names></name><name><surname>Gehmlich</surname><given-names>K</given-names></name><name><surname>Denning</surname><given-names>C</given-names></name><name><surname>Pavlovic</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Complex relationship between cardiac fibroblasts and cardiomyocytes in health and disease</article-title><source>Journal of the American Heart Association</source><volume>10</volume><elocation-id>e019338</elocation-id><pub-id pub-id-type="doi">10.1161/JAHA.120.019338</pub-id><pub-id pub-id-type="pmid">33586463</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>CR</given-names></name><name><surname>Millman</surname><given-names>KJ</given-names></name><name><surname>van der Walt</surname><given-names>SJ</given-names></name><name><surname>Gommers</surname><given-names>R</given-names></name><name><surname>Virtanen</surname><given-names>P</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><name><surname>Wieser</surname><given-names>E</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Berg</surname><given-names>S</given-names></name><name><surname>Smith</surname><given-names>NJ</given-names></name><name><surname>Kern</surname><given-names>R</given-names></name><name><surname>Picus</surname><given-names>M</given-names></name><name><surname>Hoyer</surname><given-names>S</given-names></name><name><surname>van Kerkwijk</surname><given-names>MH</given-names></name><name><surname>Brett</surname><given-names>M</given-names></name><name><surname>Haldane</surname><given-names>A</given-names></name><name><surname>Del Río</surname><given-names>JF</given-names></name><name><surname>Wiebe</surname><given-names>M</given-names></name><name><surname>Peterson</surname><given-names>P</given-names></name><name><surname>Gérard-Marchant</surname><given-names>P</given-names></name><name><surname>Sheppard</surname><given-names>K</given-names></name><name><surname>Reddy</surname><given-names>T</given-names></name><name><surname>Weckesser</surname><given-names>W</given-names></name><name><surname>Abbasi</surname><given-names>H</given-names></name><name><surname>Gohlke</surname><given-names>C</given-names></name><name><surname>Oliphant</surname><given-names>TE</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Array programming with NumPy</article-title><source>Nature</source><volume>585</volume><fpage>357</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id><pub-id pub-id-type="pmid">32939066</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herman</surname><given-names>J</given-names></name><name><surname>Usher</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>SALib: an open-source python library for sensitivity analysis</article-title><source>The Journal of Open Source Software</source><volume>2</volume><elocation-id>97</elocation-id><pub-id pub-id-type="doi">10.21105/joss.00097</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Homma</surname><given-names>T</given-names></name><name><surname>Saltelli</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Importance measures in global sensitivity analysis of nonlinear models</article-title><source>Reliability Engineering &amp; System Safety</source><volume>52</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1016/0951-8320(96)00002-6</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hornik</surname><given-names>K</given-names></name><name><surname>Stinchcombe</surname><given-names>M</given-names></name><name><surname>White</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Multilayer feedforward networks are universal approximators</article-title><source>Neural Networks</source><volume>2</volume><fpage>359</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1016/0893-6080(89)90020-8</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaeger</surname><given-names>KH</given-names></name><name><surname>Wall</surname><given-names>S</given-names></name><name><surname>Tveito</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Detecting undetectables: Can conductances of action potential models be changed without appreciable change in the transmembrane potential?</article-title><source>Chaos</source><volume>29</volume><elocation-id>073102</elocation-id><pub-id pub-id-type="doi">10.1063/1.5087629</pub-id><pub-id pub-id-type="pmid">31370420</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaeger</surname><given-names>KH</given-names></name><name><surname>Edwards</surname><given-names>AG</given-names></name><name><surname>Giles</surname><given-names>WR</given-names></name><name><surname>Tveito</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A computational method for identifying an optimal combination of existing drugs to repair the action potentials of SQT1 ventricular myocytes</article-title><source>PLOS Computational Biology</source><volume>17</volume><elocation-id>e1009233</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009233</pub-id><pub-id pub-id-type="pmid">34383746</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jagtap</surname><given-names>AD</given-names></name><name><surname>Kawaguchi</surname><given-names>K</given-names></name><name><surname>Karniadakis</surname><given-names>GE</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Adaptive activation functions accelerate convergence in deep and physics-informed neural networks</article-title><source>Journal of Computational Physics</source><volume>404</volume><elocation-id>109136</elocation-id><pub-id pub-id-type="doi">10.1016/j.jcp.2019.109136</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeong</surname><given-names>DU</given-names></name><name><surname>Yoo</surname><given-names>Y</given-names></name><name><surname>Marcellinus</surname><given-names>A</given-names></name><name><surname>Kim</surname><given-names>KS</given-names></name><name><surname>Lim</surname><given-names>KM</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Proarrhythmic risk assessment of drugs by dV<sub>m</sub> /dt shapes using the convolutional neural network</article-title><source>CPT</source><volume>11</volume><fpage>653</fpage><lpage>664</lpage><pub-id pub-id-type="doi">10.1002/psp4.12803</pub-id><pub-id pub-id-type="pmid">35579100</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeong</surname><given-names>DU</given-names></name><name><surname>Yoo</surname><given-names>Y</given-names></name><name><surname>Marcellinus</surname><given-names>A</given-names></name><name><surname>Lim</surname><given-names>KM</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Application of convolutional neural networks using action potential shape for in-silico proarrhythmic risk assessment</article-title><source>Biomedicines</source><volume>11</volume><elocation-id>406</elocation-id><pub-id pub-id-type="doi">10.3390/biomedicines11020406</pub-id><pub-id pub-id-type="pmid">36830942</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnstone</surname><given-names>RH</given-names></name><name><surname>Chang</surname><given-names>ETY</given-names></name><name><surname>Bardenet</surname><given-names>R</given-names></name><name><surname>de Boer</surname><given-names>TP</given-names></name><name><surname>Gavaghan</surname><given-names>DJ</given-names></name><name><surname>Pathmanathan</surname><given-names>P</given-names></name><name><surname>Clayton</surname><given-names>RH</given-names></name><name><surname>Mirams</surname><given-names>GR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Uncertainty and variability in models of the cardiac action potential: Can we build trustworthy models?</article-title><source>Journal of Molecular and Cellular Cardiology</source><volume>96</volume><fpage>49</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/j.yjmcc.2015.11.018</pub-id><pub-id pub-id-type="pmid">26611884</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="software"><person-group person-group-type="author"><collab>jtmff</collab></person-group><year iso-8601-date="2020">2020</year><data-title>CellML</data-title><version designator="1f18500">1f18500</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/jtmff/torord/tree/master/cellml">https://github.com/jtmff/torord/tree/master/cellml</ext-link></element-citation></ref><ref id="bib37"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>DP</given-names></name><name><surname>Ba</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Adam: A Method for Stochastic Optimization</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1412.6980">https://arxiv.org/abs/1412.6980</ext-link></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kohl</surname><given-names>P</given-names></name><name><surname>Gourdie</surname><given-names>RG</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Fibroblast-myocyte electrotonic coupling: does it occur in native cardiac tissue?</article-title><source>Journal of Molecular and Cellular Cardiology</source><volume>70</volume><fpage>37</fpage><lpage>46</lpage><pub-id pub-id-type="doi">10.1016/j.yjmcc.2013.12.024</pub-id><pub-id pub-id-type="pmid">24412581</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krogh-Madsen</surname><given-names>T</given-names></name><name><surname>Sobie</surname><given-names>EA</given-names></name><name><surname>Christini</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Improving cardiomyocyte model fidelity and utility via dynamic electrophysiology protocols and optimization algorithms</article-title><source>The Journal of Physiology</source><volume>594</volume><fpage>2525</fpage><lpage>2536</lpage><pub-id pub-id-type="doi">10.1113/JP270618</pub-id><pub-id pub-id-type="pmid">26661516</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lei</surname><given-names>CL</given-names></name><name><surname>Mirams</surname><given-names>GR</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Neural network differential equations for ion channel modelling</article-title><source>Frontiers in Physiology</source><volume>12</volume><elocation-id>708944</elocation-id><pub-id pub-id-type="doi">10.3389/fphys.2021.708944</pub-id><pub-id pub-id-type="pmid">34421652</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lei</surname><given-names>CL</given-names></name><name><surname>Whittaker</surname><given-names>DG</given-names></name><name><surname>Mirams</surname><given-names>GR</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>The impact of uncertainty in hERG binding mechanism on in silico predictions of drug-induced proarrhythmic risk</article-title><source>British Journal of Pharmacology</source><volume>181</volume><fpage>987</fpage><lpage>1004</lpage><pub-id pub-id-type="doi">10.1111/bph.16250</pub-id><pub-id pub-id-type="pmid">37740435</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Dutta</surname><given-names>S</given-names></name><name><surname>Sheng</surname><given-names>J</given-names></name><name><surname>Tran</surname><given-names>PN</given-names></name><name><surname>Wu</surname><given-names>W</given-names></name><name><surname>Chang</surname><given-names>K</given-names></name><name><surname>Mdluli</surname><given-names>T</given-names></name><name><surname>Strauss</surname><given-names>DG</given-names></name><name><surname>Colatsky</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Improving the in silico assessment of proarrhythmia risk by combining hERG (human Ether-à-go-go-Related Gene) channel-drug binding kinetics and multichannel pharmacology</article-title><source>Circulation. Arrhythmia and Electrophysiology</source><volume>10</volume><elocation-id>e004628</elocation-id><pub-id pub-id-type="doi">10.1161/CIRCEP.116.004628</pub-id><pub-id pub-id-type="pmid">28202629</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Ridder</surname><given-names>BJ</given-names></name><name><surname>Han</surname><given-names>X</given-names></name><name><surname>Wu</surname><given-names>WW</given-names></name><name><surname>Sheng</surname><given-names>J</given-names></name><name><surname>Tran</surname><given-names>PN</given-names></name><name><surname>Wu</surname><given-names>M</given-names></name><name><surname>Randolph</surname><given-names>A</given-names></name><name><surname>Johnstone</surname><given-names>RH</given-names></name><name><surname>Mirams</surname><given-names>GR</given-names></name><name><surname>Kuryshev</surname><given-names>Y</given-names></name><name><surname>Kramer</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>C</given-names></name><name><surname>Crumb</surname><given-names>WJ</given-names></name><name><surname>Strauss</surname><given-names>DG</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Assessment of an in silico mechanistic model for proarrhythmia risk prediction under the CiPA Initiative</article-title><source>Clinical Pharmacology and Therapeutics</source><volume>105</volume><fpage>466</fpage><lpage>475</lpage><pub-id pub-id-type="doi">10.1002/cpt.1184</pub-id><pub-id pub-id-type="pmid">30151907</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mayer</surname><given-names>A</given-names></name><name><surname>Bittihn</surname><given-names>P</given-names></name><name><surname>Luther</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Complex restitution behavior and reentry in a cardiac tissue model for neonatal mice</article-title><source>Physiological Reports</source><volume>5</volume><elocation-id>e13449</elocation-id><pub-id pub-id-type="doi">10.14814/phy2.13449</pub-id><pub-id pub-id-type="pmid">28989116</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirams</surname><given-names>GR</given-names></name><name><surname>Cui</surname><given-names>Y</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Fink</surname><given-names>M</given-names></name><name><surname>Cooper</surname><given-names>J</given-names></name><name><surname>Heath</surname><given-names>BM</given-names></name><name><surname>McMahon</surname><given-names>NC</given-names></name><name><surname>Gavaghan</surname><given-names>DJ</given-names></name><name><surname>Noble</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Simulation of multiple ion channel block provides improved early prediction of compounds’ clinical torsadogenic risk</article-title><source>Cardiovascular Research</source><volume>91</volume><fpage>53</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1093/cvr/cvr044</pub-id><pub-id pub-id-type="pmid">21300721</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirams</surname><given-names>GR</given-names></name><name><surname>Davies</surname><given-names>MR</given-names></name><name><surname>Brough</surname><given-names>SJ</given-names></name><name><surname>Bridgland-Taylor</surname><given-names>MH</given-names></name><name><surname>Cui</surname><given-names>Y</given-names></name><name><surname>Gavaghan</surname><given-names>DJ</given-names></name><name><surname>Abi-Gerges</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Prediction of Thorough QT study results using action potential simulations based on ion channel screens</article-title><source>Journal of Pharmacological and Toxicological Methods</source><volume>70</volume><fpage>246</fpage><lpage>254</lpage><pub-id pub-id-type="doi">10.1016/j.vascn.2014.07.002</pub-id><pub-id pub-id-type="pmid">25087753</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirams</surname><given-names>GR</given-names></name><name><surname>Pathmanathan</surname><given-names>P</given-names></name><name><surname>Gray</surname><given-names>RA</given-names></name><name><surname>Challenor</surname><given-names>P</given-names></name><name><surname>Clayton</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Uncertainty and variability in computational and mathematical models of cardiac physiology</article-title><source>The Journal of Physiology</source><volume>594</volume><fpage>6833</fpage><lpage>6847</lpage><pub-id pub-id-type="doi">10.1113/JP271671</pub-id><pub-id pub-id-type="pmid">26990229</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohammadi</surname><given-names>H</given-names></name><name><surname>Challenor</surname><given-names>P</given-names></name><name><surname>Goodfellow</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Emulating dynamic non-linear simulators using Gaussian processes</article-title><source>Computational Statistics &amp; Data Analysis</source><volume>139</volume><fpage>178</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1016/j.csda.2019.05.006</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morotti</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Hegyi</surname><given-names>B</given-names></name><name><surname>Ni</surname><given-names>H</given-names></name><name><surname>Fogli Iseppe</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Pritoni</surname><given-names>M</given-names></name><name><surname>Ripplinger</surname><given-names>CM</given-names></name><name><surname>Bers</surname><given-names>DM</given-names></name><name><surname>Edwards</surname><given-names>AG</given-names></name><name><surname>Grandi</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Quantitative cross-species translators of cardiac myocyte electrophysiology: Model training, experimental validation, and applications</article-title><source>Science Advances</source><volume>7</volume><elocation-id>eabg0927</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abg0927</pub-id><pub-id pub-id-type="pmid">34788089</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muszkiewicz</surname><given-names>A</given-names></name><name><surname>Britton</surname><given-names>OJ</given-names></name><name><surname>Gemmell</surname><given-names>P</given-names></name><name><surname>Passini</surname><given-names>E</given-names></name><name><surname>Sánchez</surname><given-names>C</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>Carusi</surname><given-names>A</given-names></name><name><surname>Quinn</surname><given-names>TA</given-names></name><name><surname>Burrage</surname><given-names>K</given-names></name><name><surname>Bueno-Orovio</surname><given-names>A</given-names></name><name><surname>Rodriguez</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Variability in cardiac electrophysiology: Using experimentally-calibrated populations of models to move beyond the single virtual physiological human paradigm</article-title><source>Progress in Biophysics and Molecular Biology</source><volume>120</volume><fpage>115</fpage><lpage>127</lpage><pub-id pub-id-type="doi">10.1016/j.pbiomolbio.2015.12.002</pub-id><pub-id pub-id-type="pmid">26701222</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oakley</surname><given-names>JE</given-names></name><name><surname>O’Hagan</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Probabilistic sensitivity analysis of complex models: a bayesian approach</article-title><source>Journal of the Royal Statistical Society Series B</source><volume>66</volume><fpage>751</fpage><lpage>769</lpage><pub-id pub-id-type="doi">10.1111/j.1467-9868.2004.05304.x</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Hara</surname><given-names>T</given-names></name><name><surname>Virág</surname><given-names>L</given-names></name><name><surname>Varró</surname><given-names>A</given-names></name><name><surname>Rudy</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Simulation of the undiseased human cardiac ventricular action potential: model formulation and experimental validation</article-title><source>PLOS Computational Biology</source><volume>7</volume><elocation-id>e1002061</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002061</pub-id><pub-id pub-id-type="pmid">21637795</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orvos</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Evaluation of possible proarrhythmic potency: comparison of the effect of dofetilide, cisapride, sotalol</article-title><source>Toxicological Sciences</source><volume>168</volume><fpage>365</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1093/toxsci/kfy299</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Passini</surname><given-names>E</given-names></name><name><surname>Britton</surname><given-names>OJ</given-names></name><name><surname>Lu</surname><given-names>HR</given-names></name><name><surname>Rohrbacher</surname><given-names>J</given-names></name><name><surname>Hermans</surname><given-names>AN</given-names></name><name><surname>Gallacher</surname><given-names>DJ</given-names></name><name><surname>Greig</surname><given-names>RJH</given-names></name><name><surname>Bueno-Orovio</surname><given-names>A</given-names></name><name><surname>Rodriguez</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Human <italic>In Silico</italic> drug trials demonstrate higher accuracy than animal models in predicting clinical pro-arrhythmic cardiotoxicity</article-title><source>Frontiers in Physiology</source><volume>8</volume><elocation-id>668</elocation-id><pub-id pub-id-type="doi">10.3389/fphys.2017.00668</pub-id><pub-id pub-id-type="pmid">28955244</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Passini</surname><given-names>E</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>Trovato</surname><given-names>C</given-names></name><name><surname>Britton</surname><given-names>OJ</given-names></name><name><surname>Bueno-Orovio</surname><given-names>A</given-names></name><name><surname>Rodriguez</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The virtual assay software for human in silico drug trials to augment drug cardiac testing</article-title><source>Journal of Computational Science</source><volume>52</volume><elocation-id>101202</elocation-id><pub-id pub-id-type="doi">10.1016/j.jocs.2020.101202</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Paszke</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>PyTorch: An Imperative Style, High-Performance Deep Learning Library</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plank</surname><given-names>G</given-names></name><name><surname>Loewe</surname><given-names>A</given-names></name><name><surname>Neic</surname><given-names>A</given-names></name><name><surname>Augustin</surname><given-names>C</given-names></name><name><surname>Huang</surname><given-names>YL</given-names></name><name><surname>Gsell</surname><given-names>MAF</given-names></name><name><surname>Karabelas</surname><given-names>E</given-names></name><name><surname>Nothstein</surname><given-names>M</given-names></name><name><surname>Prassl</surname><given-names>AJ</given-names></name><name><surname>Sánchez</surname><given-names>J</given-names></name><name><surname>Seemann</surname><given-names>G</given-names></name><name><surname>Vigmond</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The openCARP simulation environment for cardiac electrophysiology</article-title><source>Computer Methods and Programs in Biomedicine</source><volume>208</volume><elocation-id>106223</elocation-id><pub-id pub-id-type="doi">10.1016/j.cmpb.2021.106223</pub-id><pub-id pub-id-type="pmid">34171774</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rasmussen</surname><given-names>CE</given-names></name></person-group><year iso-8601-date="2019">2019</year><source>Gaussian Processes for Machine Learning</source><publisher-loc>London, England</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rush</surname><given-names>S</given-names></name><name><surname>Larsen</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>A practical algorithm for solving dynamic membrane equations</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>25</volume><fpage>389</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1109/TBME.1978.326270</pub-id><pub-id pub-id-type="pmid">689699</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sager</surname><given-names>PT</given-names></name><name><surname>Gintant</surname><given-names>G</given-names></name><name><surname>Turner</surname><given-names>JR</given-names></name><name><surname>Pettit</surname><given-names>S</given-names></name><name><surname>Stockbridge</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Rechanneling the cardiac proarrhythmia safety paradigm: A meeting report from the cardiac safety research consortium</article-title><source>American Heart Journal</source><volume>167</volume><fpage>292</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1016/j.ahj.2013.11.004</pub-id><pub-id pub-id-type="pmid">24576511</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saltelli</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Making best use of model evaluations to compute sensitivity indices</article-title><source>Computer Physics Communications</source><volume>145</volume><fpage>280</fpage><lpage>297</lpage><pub-id pub-id-type="doi">10.1016/S0010-4655(02)00280-1</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarkar</surname><given-names>AX</given-names></name><name><surname>Sobie</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Regression analysis for constraining free parameters in electrophysiological models of cardiac cells</article-title><source>PLOS Computational Biology</source><volume>6</volume><elocation-id>e1000914</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000914</pub-id><pub-id pub-id-type="pmid">20824123</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Niederer</surname><given-names>SA</given-names></name><name><surname>Mirams</surname><given-names>GR</given-names></name><name><surname>Kirpichnikova</surname><given-names>A</given-names></name><name><surname>Allen</surname><given-names>R</given-names></name><name><surname>Pathmanathan</surname><given-names>P</given-names></name><name><surname>Gavaghan</surname><given-names>DJ</given-names></name><name><surname>van der Graaf</surname><given-names>PH</given-names></name><name><surname>Noble</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A quantitative systems pharmacology perspective on the importance of parameter identifiability</article-title><source>Bulletin of Mathematical Biology</source><volume>84</volume><elocation-id>39</elocation-id><pub-id pub-id-type="doi">10.1007/s11538-021-00982-5</pub-id><pub-id pub-id-type="pmid">35132487</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shim</surname><given-names>JV</given-names></name><name><surname>Xiong</surname><given-names>Y</given-names></name><name><surname>Dhanan</surname><given-names>P</given-names></name><name><surname>Dariolli</surname><given-names>R</given-names></name><name><surname>Azeloglu</surname><given-names>EU</given-names></name><name><surname>Hu</surname><given-names>B</given-names></name><name><surname>Jayaraman</surname><given-names>G</given-names></name><name><surname>Schaniel</surname><given-names>C</given-names></name><name><surname>Birtwistle</surname><given-names>MR</given-names></name><name><surname>Iyengar</surname><given-names>R</given-names></name><name><surname>Dubois</surname><given-names>NC</given-names></name><name><surname>Sobie</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Predicting individual-specific cardiotoxicity responses induced by tyrosine kinase inhibitors</article-title><source>Frontiers in Pharmacology</source><volume>14</volume><elocation-id>1158222</elocation-id><pub-id pub-id-type="doi">10.3389/fphar.2023.1158222</pub-id><pub-id pub-id-type="pmid">37101545</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sobol′</surname><given-names>IM</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Global sensitivity indices for nonlinear mathematical models and their Monte Carlo estimates</article-title><source>Mathematics and Computers in Simulation</source><volume>55</volume><fpage>271</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1016/S0378-4754(00)00270-6</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strauss</surname><given-names>DG</given-names></name><name><surname>Wu</surname><given-names>WW</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Koerner</surname><given-names>J</given-names></name><name><surname>Garnett</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Translational models and tools to reduce clinical trials and improve regulatory decision making for QTc and proarrhythmia risk (ICH E14/S7B updates)</article-title><source>Clinical Pharmacology and Therapeutics</source><volume>109</volume><fpage>319</fpage><lpage>333</lpage><pub-id pub-id-type="doi">10.1002/cpt.2137</pub-id><pub-id pub-id-type="pmid">33332579</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Syed</surname><given-names>Z</given-names></name><name><surname>Vigmond</surname><given-names>E</given-names></name><name><surname>Nattel</surname><given-names>S</given-names></name><name><surname>Leon</surname><given-names>LJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Atrial cell action potential parameter fitting using genetic algorithms</article-title><source>Medical &amp; Biological Engineering &amp; Computing</source><volume>43</volume><fpage>561</fpage><lpage>571</lpage><pub-id pub-id-type="doi">10.1007/BF02351029</pub-id><pub-id pub-id-type="pmid">16411628</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Cardiomyocyte_Emulator</data-title><version designator="swh:1:rev:26ba43c619c0acf2fc853326aa4cd0578b786d6a">swh:1:rev:26ba43c619c0acf2fc853326aa4cd0578b786d6a</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:f464ac2227b8abcce4e7e3582850b0412a406de7;origin=https://github.com/thomgrand/cardiomyocyte_emulator;visit=swh:1:snp:f4c9896effdccb4104dc7c4dfa1ffc96ff71cb8e;anchor=swh:1:rev:26ba43c619c0acf2fc853326aa4cd0578b786d6a">https://archive.softwareheritage.org/swh:1:dir:f464ac2227b8abcce4e7e3582850b0412a406de7;origin=https://github.com/thomgrand/cardiomyocyte_emulator;visit=swh:1:snp:f4c9896effdccb4104dc7c4dfa1ffc96ff71cb8e;anchor=swh:1:rev:26ba43c619c0acf2fc853326aa4cd0578b786d6a</ext-link></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tomek</surname><given-names>J</given-names></name><name><surname>Bueno-Orovio</surname><given-names>A</given-names></name><name><surname>Passini</surname><given-names>E</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>Minchole</surname><given-names>A</given-names></name><name><surname>Britton</surname><given-names>O</given-names></name><name><surname>Bartolucci</surname><given-names>C</given-names></name><name><surname>Severi</surname><given-names>S</given-names></name><name><surname>Shrier</surname><given-names>A</given-names></name><name><surname>Virag</surname><given-names>L</given-names></name><name><surname>Varro</surname><given-names>A</given-names></name><name><surname>Rodriguez</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Development, calibration, and validation of a novel human ventricular myocyte model in health, disease, and drug block</article-title><source>eLife</source><volume>8</volume><elocation-id>e48890</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.48890</pub-id><pub-id pub-id-type="pmid">31868580</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Tomek</surname><given-names>J</given-names></name><name><surname>Bueno-Orovio</surname><given-names>A</given-names></name><name><surname>Rodriguez</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>ToR-ORd-dynCl: An Update of the ToR-ORd Model of Human Ventricular Cardiomyocyte with Dynamic Intracellular Chloride</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.06.01.127043</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tveito</surname><given-names>A</given-names></name><name><surname>Jæger</surname><given-names>KH</given-names></name><name><surname>Huebsch</surname><given-names>N</given-names></name><name><surname>Charrez</surname><given-names>B</given-names></name><name><surname>Edwards</surname><given-names>AG</given-names></name><name><surname>Wall</surname><given-names>S</given-names></name><name><surname>Healy</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inversion and computational maturation of drug response using human stem cell derived cardiomyocytes in microphysiological systems</article-title><source>Scientific Reports</source><volume>8</volume><elocation-id>17626</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-018-35858-7</pub-id><pub-id pub-id-type="pmid">30514966</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tveito</surname><given-names>A</given-names></name><name><surname>Jæger</surname><given-names>KH</given-names></name><name><surname>Maleckar</surname><given-names>MM</given-names></name><name><surname>Giles</surname><given-names>WR</given-names></name><name><surname>Wall</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Computational translation of drug effects from animal experiments to human ventricular myocytes</article-title><source>Scientific Reports</source><volume>10</volume><elocation-id>10537</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-020-66910-0</pub-id><pub-id pub-id-type="pmid">32601303</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vicente</surname><given-names>J</given-names></name><name><surname>Zusterzeel</surname><given-names>R</given-names></name><name><surname>Johannesen</surname><given-names>L</given-names></name><name><surname>Mason</surname><given-names>J</given-names></name><name><surname>Sager</surname><given-names>P</given-names></name><name><surname>Patel</surname><given-names>V</given-names></name><name><surname>Matta</surname><given-names>MK</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Garnett</surname><given-names>C</given-names></name><name><surname>Stockbridge</surname><given-names>N</given-names></name><name><surname>Zineh</surname><given-names>I</given-names></name><name><surname>Strauss</surname><given-names>DG</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Mechanistic model-informed proarrhythmic risk assessment of drugs: review of the “CiPA” initiative and design of a prospective clinical validation study</article-title><source>Clinical Pharmacology and Therapeutics</source><volume>103</volume><fpage>54</fpage><lpage>66</lpage><pub-id pub-id-type="doi">10.1002/cpt.896</pub-id><pub-id pub-id-type="pmid">28986934</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vigmond</surname><given-names>EJ</given-names></name><name><surname>Weber dos Santos</surname><given-names>R</given-names></name><name><surname>Prassl</surname><given-names>AJ</given-names></name><name><surname>Deo</surname><given-names>M</given-names></name><name><surname>Plank</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Solvers for the cardiac bidomain equations</article-title><source>Progress in Biophysics and Molecular Biology</source><volume>96</volume><fpage>3</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.1016/j.pbiomolbio.2007.07.012</pub-id><pub-id pub-id-type="pmid">17900668</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiss</surname><given-names>JN</given-names></name><name><surname>Garfinkel</surname><given-names>A</given-names></name><name><surname>Karagueuzian</surname><given-names>HS</given-names></name><name><surname>Chen</surname><given-names>PS</given-names></name><name><surname>Qu</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Early afterdepolarizations and cardiac arrhythmias</article-title><source>Heart Rhythm</source><volume>7</volume><fpage>1891</fpage><lpage>1899</lpage><pub-id pub-id-type="doi">10.1016/j.hrthm.2010.09.017</pub-id><pub-id pub-id-type="pmid">20868774</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whittaker</surname><given-names>DG</given-names></name><name><surname>Clerx</surname><given-names>M</given-names></name><name><surname>Lei</surname><given-names>CL</given-names></name><name><surname>Christini</surname><given-names>DJ</given-names></name><name><surname>Mirams</surname><given-names>GR</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Calibration of ionic and cellular cardiac electrophysiology models</article-title><source>Wiley Interdisciplinary Reviews. Systems Biology and Medicine</source><volume>12</volume><elocation-id>e1482</elocation-id><pub-id pub-id-type="doi">10.1002/wsbm.1482</pub-id><pub-id pub-id-type="pmid">32084308</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaniboni</surname><given-names>M</given-names></name><name><surname>Riva</surname><given-names>I</given-names></name><name><surname>Cacciani</surname><given-names>F</given-names></name><name><surname>Groppi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>How different two almost identical action potentials can be: A model study on cardiac repolarization</article-title><source>Mathematical Biosciences</source><volume>228</volume><fpage>56</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1016/j.mbs.2010.08.007</pub-id><pub-id pub-id-type="pmid">20801131</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>AP biomarkers and abnormalities</title><p>The AP biomarkers used in this study were selected such that the key characteristics of the depolarization and the repolarization phase can be quantified. They include <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> (resting transmembrane potential measured just before stimulation), <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> (maximum transmembrane potential slope during the upstroke), <inline-formula><mml:math id="inf151"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> (peak transmembrane potential at the end of the upstroke), <inline-formula><mml:math id="inf152"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> (time-to-peak from the stimulus until <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> is reached), <inline-formula><mml:math id="inf154"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (AP duration at <inline-formula><mml:math id="inf155"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>30</mml:mn><mml:mo>,</mml:mo><mml:mn>40</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>60</mml:mn><mml:mo>,</mml:mo><mml:mn>70</mml:mn><mml:mo>,</mml:mo><mml:mn>80</mml:mn><mml:mo>,</mml:mo><mml:mn>90</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>% repolarization relative to the AP amplitude (<inline-formula><mml:math id="inf156"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>) measured from the instant of <inline-formula><mml:math id="inf157"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>), and <inline-formula><mml:math id="inf158"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>90</mml:mn><mml:mo>-</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (triangulation defined as the difference between <inline-formula><mml:math id="inf159"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>90</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>40</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> <xref ref-type="bibr" rid="bib7">Britton et al., 2017</xref>).</p><p>For the GSA (see.3) and the creation of synthetic data (see Synthetic test data (#2/#3)), AP abnormalities were also considered which included depolarization abnormalities, repolarization abnormalities, and alternans. Depolarization abnormalities were defined as an upstroke peak below 0 mV and an AP that does not reach 0 mV before 100 ms after stimulation (<xref ref-type="bibr" rid="bib54">Passini et al., 2017</xref>). Repolarization abnormalities were defined as a transmembrane potential rate of rise of more than <inline-formula><mml:math id="inf161"><mml:mrow><mml:mn>0.01</mml:mn><mml:mtext/><mml:mfrac><mml:mi class="ltx_unit">mV</mml:mi><mml:mi class="ltx_unit">ms</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> from 150 ms after the upstroke peak onwards (representative of early afterdepolarizations) and as a transmembrane potential that does not fall below -40 mV (<xref ref-type="bibr" rid="bib54">Passini et al., 2017</xref>) (representative of repolarization failure). Alternans were defined as <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>90</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> difference of more than 5 ms between two consecutive APs (<xref ref-type="bibr" rid="bib49">Morotti et al., 2021</xref>).</p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s9"><title>Global sensitivity analysis</title><p>A variance-based Sobol’ global sensitivity analysis (GSA) (<xref ref-type="bibr" rid="bib65">Sobol′, 2001</xref>) was performed on the simulator to quantify the sensitivities of the maximum channel conductances (inputs) with respect to the AP biomarkers (outputs; see AP biomarkers and abnormalities). This informed the decision on which inputs to consider in the emulator. Furthermore, it was used for the interpretation of the solutions of the inverse problem since parameters that are insensitive with respect to the outputs indicate non-identifiability (<xref ref-type="bibr" rid="bib24">Guillaume et al., 2019</xref>).</p><p>The maximum conductances used for building the model population in <xref ref-type="bibr" rid="bib69">Tomek et al., 2019</xref> were considered and Saltelli’s sampling scheme (<xref ref-type="bibr" rid="bib61">Saltelli, 2002</xref>) was applied with <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1024</mml:mn></mml:mrow></mml:math></inline-formula> to generate 20,480 input samples with values between 50% and 150% of the original values. Simulations were performed for each input sample and biomarker values (see AP biomarkers and abnormalities) derived from the last AP were used for the analysis. However, data were excluded if not all biomarkers could be determined or abnormalities (see AP biomarkers and abnormalities) were detected in the last two consecutive APs. First-order (S1) and total-effect (ST) Sobol’ sensitivity indices were computed using the Saltelli method (<xref ref-type="bibr" rid="bib28">Homma and Saltelli, 1996</xref>; <xref ref-type="bibr" rid="bib61">Saltelli, 2002</xref>). This requires outputs for each input sample and to take this into account, excluded outputs were assigned the mean values of included outputs. The <monospace>SALib-Sensitivity Analysis Library</monospace> (<xref ref-type="bibr" rid="bib27">Herman and Usher, 2017</xref>) was used for the GSA.</p><p>The GSA could be performed on the data of all input samples as no data were excluded. S1 and ST were mostly very similar which indicates only little interactions among the maximum conductivities relative to the AP biomarkers (9). The only exception was <inline-formula><mml:math id="inf164"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula>. As was to be expected, the analysis underlines the predominant relative sensitivity of G<sub>Na</sub> with respect to biomarkers of the depolarization phase, the predominant relative sensitivity of G<sub>NaL</sub>, G<sub>Kr</sub>, and G<sub>NCX</sub> with respect to biomarkers of the repolarization phase and the predominant relative sensitivity of G<sub>K1</sub>, P<sub>NaK</sub> to the resting transmembrane potential. However, G<sub>Ks</sub> has a negligible relative sensitivity to all biomarkers. This indicates almost non-identifiability.</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Global sensitivity analysis of the ToR-ORd simulator.</title><p>Sobol’ sensitivity indices are shown for each maximum conductance relative to each AP biomarker. Left: first-order (S1), right: total-effect (ST) Sobol’ sensitivity coefficient.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-app2-fig1-v1.tif"/></fig></sec></app><app id="appendix-3"><title>Appendix 3</title><sec sec-type="appendix" id="s10"><title>EAD classification</title><fig id="app3fig1" position="float"><label>Appendix 3—figure 1.</label><caption><title>Emulated APs based on the pharmacological parameters of data set #3.</title><p>See also Forward problem and <xref ref-type="fig" rid="fig7">Figure 7</xref>. From left to right and top to bottom, the plot shows the true positive, false negative, false positive and true negative samples. The number next to the title specifies the number of samples belonging to each category. The classification criterion is outlined in Appendix 1.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-app3-fig1-v1.tif"/></fig><fig id="app3fig2" position="float"><label>Appendix 3—figure 2.</label><caption><title>Same as <xref ref-type="fig" rid="fig1">Figure 1</xref>, but showing the simulated APs.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91911-app3-fig2-v1.tif"/></fig></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91911.3.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Yongliang</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Dalian University of Technology</institution><country>China</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Valuable</kwd></kwd-group></front-stub><body><p>This <bold>valuable</bold> prospective study develops a new tool to accelerate pharmacological studies by using neural networks to emulate the human ventricular cardiomyocyte action potential. The evidence supporting the conclusions is <bold>convincing</bold>, based on using a large and high-quality dataset to train the neural network emulator. There are nevertheless a few areas in which the article may be improved through validating the neural network emulators against extensive experimental data. In addition, the article may be improved through delineating the exact speed-up achieved and the scope for acceleration. The work will be of broad interest to scientists working in cardiac simulation and quantitative system pharmacology.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91911.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The authors present a neural network (NN)-based approach to computationally cheaper emulation of simulations of biophysically relatively detailed cardiac cell models based on systems of ordinary differential equations. Relevant case studies are used to demonstrate the performance in prediction of standard action potentials, as well as action potentials manifesting early depolarizations. Application to the &quot;reverse problem&quot; (inferring the effect of pharmacological compounds on ion channels based on action potential data before and after drug treatment) is also explored, which is a task of generally high interest.</p><p>Strengths:</p><p>This is a well-designed study, which explores an area that many in the cardiac simulation community will be interested in. The article is well written and I particularly commend the authors on transparency of methods description, code sharing, etc. - it feels rather exemplary in this regard and I only wish more authors of cardiac simulation studies took such an approach. The training speed of the network is encouraging and the technique is accessible to anyone with a reasonably strong GPU, not needing specialized equipment.</p><p>Weaknesses:</p><p>Below are several points that I consider to be weaknesses and/or uncertainties of the work:</p><p>1. The scope for acceleration of single cell simulations is not vast, as it is easy to simulate tens of thousands of cells per day on a workstation computer, using simulation conditions similar to those of the authors. While this covers a large part of what is needed in the field, I agree with the authors that there are applications where the presented technology is helpful. In such cases, e.g., in uncertaintly quantification, it will enable studies that would be difficult to carry out previously. In addition, any application involving long-term pre-pacing of a large number of cells will benefit greatly from the reported tool.</p><p>An area which is definitely in need of acceleration is simulations of whole ventricles or hearts, but it is not clear how much potential for speedup would the presented technology bring there. I can imagine interesting applications of rapid emulation in such a setting, some of which could be hybrid in nature (e.g. using simulation for the region around the wavefront of propagating electrical waves, while emulating the rest of the tissue, which is behaving more regularly/predictable, and is likely to be emulated well), but this is definitely beyond of the scope of this article.</p><p>2. The exact speed-up achieved by the NN emulation is somewhat context-dependent. In particular, the reported speedup critically depends on the number of beats in the simulation. The emulator learns to directly estimate the state of the cell after X beats (where X is decided by the operator of training). The speedup appears to be relatively marginal when a single beat is simulated versus emulated - but when 1000 beats are simulated, this takes 1000fold more time for simulation, but unchanged time for emulation.</p><p>While the initial submission did not communicate the practical speedup entirely clearly, this was addressed well by the authors in the revised version.</p><p>3. It appears that the accuracy of emulation drops off relatively sharply with increasing real-world applicability/relevance of the tasks it is applied to. That said, the authors are to be commended on declaring this transparently, rather than withholding such analyses. I particularly enjoyed the discussion of the not always amazing results of the inverse problem on the experimental data. The point on low parameter identifiability is an important one, and serves as a warning against overconfidence in our ability to infer cellular parameters from action potentials alone. On the other hand, I'm not that sure the difference between small tissue preps and single cells which authors propose as another source of the discrepancy will be that vast beyond the AP peak potential (probably much of the tissue prep is affected by the pacing electrode?), but that is a subjective view only. The influence of coupling could be checked if the simulated data were generated from 2D tissue samples/fibres, e.g. using the Myokit software.</p><p>In summary, I believe the range of tasks where the emulator provides a major advance is relatively narrow, particularly given the relatively limited need for further speedup compared to simulations. However, this does not make the study uninteresting in the slightest - on the contrary, it explores something that many of us are thinking about, and it is likely to stimulate further development in the direction of computationally efficient emulation of relatively complex simulations.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91911.3.sa2</article-id><title-group><article-title>Reviewer #3 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>1. Grandits and colleagues were trying to develop a new tool to accelerate pharmacological studies by using neural networks to emulate the human ventricular cardiomyocyte action potential (AP). The AP is a complex electrical signal that governs the heartbeat, and it is important to accurately model the effects of drugs on the AP to assess their safety and efficacy. Traditional biophysical simulations of the AP are computationally expensive and time-consuming. The authors hypothesized that neural network emulators could be trained to predict the AP with high accuracy and that these emulators could also be used to quickly and accurately predict the effects of drugs on the AP.</p><p>Strengths:</p><p>2. One of the study's major strengths is that the authors use a large and high-quality dataset to train their neural network emulator. The dataset includes a wide range of APs, including normal and abnormal APs exhibiting EADs. This ensures that the emulator is robust and can be used to predict the AP for a variety of different conditions.</p><p>Another major strength of the study is that the authors demonstrate that their neural network emulator can be used to accelerate pharmacological studies. For example, they use the emulator to predict the effects of a set of known arrhythmogenic drugs on the AP. The emulator is able to predict the effects of these drugs, even though it had not been trained on these drugs specifically.</p><p>Weaknesses:</p><p>One weakness of the study is that it is important to validate neural network emulators against experimental data to ensure that they are accurate and reliable. The authors do this to some extent, but further validation would be beneficial. In particular for the inverse problem, where the estimation of pharmacological parameters very challenging and led to particularly large inaccuracies.</p><p>Additional context:</p><p>4. The work by Grandits et al. has the potential to revolutionize the way that pharmacological studies are conducted. Neural network emulation has the promise to reduce the time and cost of drug development and to improve the safety and efficacy of new drugs. The methods and data presented in the paper are useful to the community because they provide a starting point for other researchers to develop and improve neural network emulators for the human ventricular cardiomyocyte AP. The authors have made their code and data publicly available, which will facilitate further research in this area.</p><p>5. It is important to note that neural network emulation is still a relatively new approach, and there are some challenges that need to be addressed before it can be widely adopted in the pharmaceutical industry. For example, neural network emulators need to be trained on large and high-quality datasets. Additionally, it is important to validate neural network emulators against experimental data to ensure that they are accurate and reliable. Despite these challenges, the potential benefits of neural network emulation for pharmacological studies are significant. As neural network emulation technology continues to develop, it is likely to become a valuable tool for drug discovery and development.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91911.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Grandits</surname><given-names>Thomas</given-names></name><role specific-use="author">Author</role><aff><institution>University of Graz</institution><addr-line><named-content content-type="city">Graz</named-content></addr-line><country>Austria</country></aff></contrib><contrib contrib-type="author"><name><surname>Augustin</surname><given-names>Christoph M</given-names></name><role specific-use="author">Author</role><aff><institution>Medical University of Graz</institution><addr-line><named-content content-type="city">Graz</named-content></addr-line><country>Austria</country></aff></contrib><contrib contrib-type="author"><name><surname>Haase</surname><given-names>Gundolf</given-names></name><role specific-use="author">Author</role><aff><institution>University of Graz</institution><addr-line><named-content content-type="city">Graz</named-content></addr-line><country>Austria</country></aff></contrib><contrib contrib-type="author"><name><surname>Jost</surname><given-names>Norbert</given-names></name><role specific-use="author">Author</role><aff><institution>University of Szeged</institution><addr-line><named-content content-type="city">Szeged</named-content></addr-line><country>Hungary</country></aff></contrib><contrib contrib-type="author"><name><surname>Mirams</surname><given-names>Gary Richard</given-names></name><role specific-use="author">Author</role><aff><institution>University of Nottingham</institution><addr-line><named-content content-type="city">Nottingham</named-content></addr-line><country>United Kingdom</country></aff></contrib><contrib contrib-type="author"><name><surname>Niederer</surname><given-names>Steven A</given-names></name><role specific-use="author">Author</role><aff><institution>King&amp;apos;s College London</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff></contrib><contrib contrib-type="author"><name><surname>Plank</surname><given-names>Gernot</given-names></name><role specific-use="author">Author</role><aff><institution>Medical University of Graz</institution><addr-line><named-content content-type="city">Graz</named-content></addr-line><country>Austria</country></aff></contrib><contrib contrib-type="author"><name><surname>Varró</surname><given-names>András</given-names></name><role specific-use="author">Author</role><aff><institution>University of Szeged</institution><addr-line><named-content content-type="city">Szeged</named-content></addr-line><country>Hungary</country></aff></contrib><contrib contrib-type="author"><name><surname>Virág</surname><given-names>László</given-names></name><role specific-use="author">Author</role><aff><institution>University of Szeged</institution><addr-line><named-content content-type="city">Szeged</named-content></addr-line><country>Hungary</country></aff></contrib><contrib contrib-type="author"><name><surname>Jung</surname><given-names>Alexander</given-names></name><role specific-use="author">Author</role><aff><institution>Medical University of Graz</institution><addr-line><named-content content-type="city">Graz</named-content></addr-line><country>Austria</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>eLife assessment</bold></p><p>This valuable study reports on the potential of neural networks to emulate simulations of human ventricular cardiomyocyte action potentials for various ion channel parameters with the advantage of saving simulation time in certain conditions. The evidence supporting the claims of the authors is solid, although the inclusion of open analysis of drop-off accuracy and validation of the neural network emulators against experimental data would have strengthened the study. The work will be of interest to scientists working in cardiac simulation and quantitative pharmacology.</p></disp-quote><p>Thank you for the kind assessment. It is important for us to point out that, while limited, experimental validation was performed in this study and is thoroughly described in the work.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 1 - Comments</bold></p><p>This manuscript describes a method to solve the inverse problem of finding the initial cardiac activations to produce a desired ECG. This is an important question. The techniques presented are novel and clearly demonstrate that they work in the given situation. The paper is well-organized and logical.</p><p>Strengths:</p><p>This is a well-designed study, which explores an area that many in the cardiac simulation community will be interested in. The article is well written and I particularly commend the authors on transparency of methods description, code sharing, etc. - it feels rather exemplary in this regard and I only wish more authors of cardiac simulation studies took such an approach. The training speed of the network is encouraging and the technique is accessible to anyone with a reasonably strong GPU, not needing specialized equipment.</p><p>Weaknesses:</p><p>Below are several points that I consider to be weaknesses and/or uncertainties of the work:</p><p>C I-(a) I am not convinced by the authors’ premise that there is a great need for further acceleration of cellular cardiac simulations - it is easy to simulate tens of thousands of cells per day on a workstation computer, using simulation conditions similar to those of the authors. I do not really see an unsolved task in the field that would require further speedup of single-cell simulations.At the same time, simulations offer multiple advantages, such as the possibility to dissect mechanisms of the model behaviour, and the capability to test its behaviour in a wide array of protocols - whereas a NN is trained for a single purpose/protocol, and does not enable a deep investigation of mechanisms. Therefore, I am not sure the cost/benefit ratio is that strong for single-cell emulation currently.</p><p>An area that is definitely in need of acceleration is simulations of whole ventricles or hearts, but it is not clear how much potential for speedup the presented technology would bring there. I can imagine interesting applications of rapid emulation in such a setting, some of which could be hybrid in nature (e.g. using simulation for the region around the wavefront of propagating electrical waves, while emulating the rest of the tissue, which is behaving more regularly/predictable, and is likely to be emulated well), but this is definitely beyond of the scope of this article.</p></disp-quote><p>Thank you for this point of view. Simulating a population of few thousand cells is completely feasible on single desktop machines and for fixed, known parameters, emulation may not fill ones need. Yet we still foresee a great untapped potential for rapid evaluations of ionic models, such as for the gradient-based inverse problem, presented in the paper. Such inverse optimization requires several thousand evaluations per cell and thus finding maximum conductances for the presented experimental data set (13 cell pairs control/drug → 26 APs) purely through simulations would require roughly a day of simulation time even in a very conservative estimation (3.5 seconds per simulation, 1000 simulations per optimization). Additionally, the emulator provides local sensitivity information between the AP and maximum conductances in the form of the gradient, which enables a whole new array of efficient optimization algorithms [Beck, 2017]. To further emphasize these points, we added the number of emulations and runtime of each conducted experiment in the specific section and a paragraph in the discussion that addresses this point:</p><p>&quot;Cardiomyocyte EP models are already very quick to evaluate in the scale of seconds (see Section 2.3.1), but the achieved runtime of emulations allows to solve time consuming simulation protocols markedly more efficient. One such scenario is the presented inverse maximum conductance estimation problem (see Section 3.1.2 and Section 3.1.3), where for estimating maximum conductances of a single AP, we need to emulate the steady state AP at least several hundred times as part of an optimization procedure. Further applications include the probabilistic use of cardiomyocyte EP models with uncertainty quantification [Chang et al., 2017, Johnstone et al., 2016] where thousands of samples of parameters are potentially necessary to compute a distribution of the steady-state properties of subsequent APs, and the creation of cell populations [Muszkiewicz et al., 2016, Gemmell et al., 2016, Britton et al., 2013].&quot; (Section 4.2)</p><p>We believe that rapid emulations are valuable for several use-cases, where thousands of evaluations are necessary. These include the shown inverse problem, but similarly arise in uncertainty quantification, or cardiomyocyte population creation. Similarly, new use-cases may arise as such efficient tools become available. Additionally, we provided the number of evaluations along with the runtimes for each of the conducted experiments, showing how essential these speedups are to realize these experiments in reasonable timeframes. Utilizing these emulations in organ-level electrophysiological models is a possibility, but the potential problems in such scenarios are much more varied and depend on a number of factors, making it hard to pin-point the achievable speed-up using ionic emulations.</p><disp-quote content-type="editor-comment"><p>C I-(b) The authors run a cell simulation for 1000 beats, training the NN emulator to mimic the last beat. It is reported that the simulation of a single cell takes 293 seconds, while emulation takes only milliseconds, implying a massive speedup. However, I consider the claimed speedup achieved by emulation to be highly context-dependent, and somewhat too flattering to the presented method of emulation. Two specific points below:</p><p>First, it appears that a not overly efficient (fixed-step) numerical solver scheme is used for the simulation. On my (comparable, also a Threadripper) CPU, using the same model (”ToR-ORd-dyncl”), but a variable step solver ode15s in Matlab, a simulation of a cell for 1000 beats takes ca. 50 seconds, rather than 293 of the authors. This can be further sped up by parallelization when more cells than available cores are simulated: on 32 cores, this translates into ca. 2 seconds amortized time per cell simulation (I suspect that the NN-based approach cannot be parallelized in a similar way?). By amortization, I mean that if 32 models can be simulated at once, a simulation of X cells will not take X<italic>50 seconds, but (X/32)</italic>50. (with only minor overhead, as this task scales well across cores).</p><p>Second, and this is perhaps more important - the reported speed-up critically depends on the number of beats in the simulation - if I am reading the article correctly, the runtime compares a simulation of 1000 beats versus the emulation of a single beat. If I run a simulation of a single beat across multiple simulated cells (on a 32-core machine), the amortized runtime is around 20 ms per cell, which is only marginally slower than the NN emulation. On the other hand, if the model was simulated for aeons, comparing this to a fixed runtime of the NN, one can get an arbitrarily high speedup.</p><p>Therefore, I’d probably emphasize the concrete speedup less in an abstract and I’d provide some background on the speedup calculation such as above, so that the readers understand the context-dependence. That said, I do think that a simulation for anywhere between 250 and 1000 beats is among the most reasonable points of comparison (long enough for reasonable stability, but not too long to beat an already stable horse; pun with stables was actually completely unintended, but here it is...). I.e., the speedup observed is still valuable and valid, albeit in (I believe) a somewhat limited sense.</p></disp-quote><p>We agree that the speedup comparison only focused on a very specific case and needs to be more thoroughly discussed and benchmarked. One of the main strengths of the emulator is to cut the time of prepacing to steady state, which is known to be a potential bottleneck for the speed of the single-cell simulations. The time it takes to reach the steady state in the simulator is heavily dependant on the actual maximum conductance configuration and the speed-up is thus heavily reliant on a per-case basis. The differences in architecture of the simulator and emulator further makes direct comparisons very difficult. In the revised version we now go into more detail regarding the runtime calculations and also compare it to an adaptive time stepping simulation (Myokit [Clerx et al., 2016]) in a new subsection:</p><p>&quot;The simulation of a single AP (see Section 2.1) sampled at a resolution of 20kHz took 293s on one core of a AMD Ryzen Threadripper 2990WX (clock rate: 3.0GHz) in CARPentry. Adaptive timestep solver of variable order, such as implemented in Myokit [Clerx et al., 2016], can significantly lower the simulation time (30s for our setup) by using small step sizes close to the depolarization (phase 0) and increasing the time step in all other phases. The emulation of a steady state AP sampled at a resolution of 20kHz for t ∈ [−10, 1000]ms took 18.7ms on a AMD Ryzen 7 3800X (clock rate: 3.9GHz) and 1.2ms on a Nvidia A100 (Nvidia Corporation, USA), including synchronization and data copy overhead between CPU and GPU.</p><p>&quot;The amount of required beats to reach the steady state of the cell in the simulator has a major impact on the runtime and is not known a-priori. On the other hand, both simulator and emulator runtime linearly depends on the time resolution, but since the output of the emulator is learned, the time resolution can be chosen at arbitrarily without affecting the AP at the sampled times. This makes direct performance comparisons between the two methodologies difficult. To still be able to quantify the speed-up, we ran Myokit using 100 beats to reach steady state, taking 3.2s of simulation time. In this scenario, we witnessed a speed-up of 171 and 2 · 103 of our emulator on CPU and GPU respectively (again including synchronization and data copy overhead between CPU and GPU in the latter case). Note that both methods are similarly expected to have a linear parallelization speedup across multiple cells.</p><p>For the inverse problem, we parallelized the problem for multiple cells and keep the problem on the GPU to minimize the overhead, achieving emulations (including backpropagation) that run in 120µs per AP at an average temporal resolution of 2kHz. We consider this the peak performance which will be necessary for the inverse problem in Section 3.1.2.&quot; (Section 2.3.1)</p><p>Note that the mentioned parallelization across multiple machines/hardware applies equally to the emulator and simulator (linear speed-up), though the utilization for single cells is most likely different (single vs. multi-cell parallelization).</p><disp-quote content-type="editor-comment"><p>C I-(c) It appears that the accuracy of emulation drops off relatively sharply with increasing real-world applicability/relevance of the tasks it is applied to. That said, the authors are to be commended on declaring this transparently, rather than withholding such analyses. I particularly enjoyed the discussion of the not-always amazing results of the inverse problem on the experimental data. The point on low parameter identifiability is an important one and serves as a warning against overconfidence in our ability to infer cellular parameters from action potentials alone. On the other hand, I’m not that sure the difference between small tissue preps and single cells which authors propose as another source of the discrepancy will be that vast beyond the AP peak potential (probably much of the tissue prep is affected by the pacing electrode?), but that is a subjective view only. The influence of coupling could be checked if the simulated data were generated from 2D tissue samples/fibres, e.g. using the Myokit software.</p><p>Given the points above (particularly the uncertain need for further speedup compared to running single-cell simulations), I am not sure that the technology generated will be that broadly adopted in the near future.</p><p>However, this does not make the study uninteresting in the slightest - on the contrary, it explores something that many of us are thinking about, and it is likely to stimulate further development in the direction of computationally efficient emulation of relatively complex simulations.</p></disp-quote><p>We agree that the parameter identifiability is an important point of discussion. While the provided experimental data gave us great insights already, we still believe that given the differences in the setup, we can not draw conclusions about the source of inaccuracies with absolute certainty. The suggested experiment to test the influence of coupling is of interest for future works and has been integrated into the discussion. Further details are given in the response to the recommendation R III- (t)</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 2 - Comments</bold></p><p>Summary:</p><p>This study provided a neural network emulator of the human ventricular cardiomyocyte action potential. The inputs are the corresponding maximum conductances and the output is the action potential (AP). It used the forward and inverse problems to evaluate the model. The forward problem was solved for synthetic data, while the inverse problem was solved for both synthetic and experimental data. The NN emulator tool enables the acceleration of simulations, maintains high accuracy in modeling APs, effectively handles experimental data, and enhances the overall efficiency of pharmacological studies. This, in turn, has the potential to advance drug development and safety assessment in the field of cardiac electrophysiology.</p><p>Strengths:</p><p>1. Low computational cost: The NN emulator demonstrated a massive speed-up of more than 10,000 times compared to the simulator. This substantial increase in computational speed has the potential to expedite research and drug development processes</p><p>1. High accuracy in the forward problem: The NN emulator exhibited high accuracy in solving the forward problem when tested with synthetic data. It accurately predicted normal APs and, to a large extent, abnormal APs with early afterdepolarizations (EADs). High accuracy is a notable advantage over existing emulation methods, as it ensures reliable modeling and prediction of AP behavior</p><p>C II-(a) Input space constraints: The emulator relies on maximum conductances as inputs, which explain a significant portion of the AP variability between cardiomyocytes. Expanding the input space to include channel kinetics parameters might be challenging when solving the inverse problem with only AP data available.</p></disp-quote><p>Thank you for this comment. We consider this limitation a major drawback, as discussed in Section 4.3. Identifiability is already an issue when only considering the most important maximum conductances. Further extending the problem to include kinetics will most likely only increase the difficulty of the inverse problem. For the forward problem though, it might be of interest to people studying ionic models to further analyze the effects of channel kinetics.</p><disp-quote content-type="editor-comment"><p>C II-(b) Simplified drug-target interaction: In reality, drug interactions can be time-, voltage-, and channel statedependent, requiring more complex models with multiple parameters compared to the oversimplified model that represents the drug-target interactions by scaling the maximum conductance at control. The complex model could also pose challenges when solving the inverse problem using only AP data.</p></disp-quote><p>Thank you pointing out this limitation. We slightly adapted Section 4.3 to further highlight some of these limitations. Note however that the experimental drugs used have been shown to be influenced by this drug interaction in varying degrees [Li et al., 2017] (e.g. dofetilide vs. cisapride). However, the discrepancy in identifiability was mostly channel-based (0%-100%), whereas the variation in identifiability between drugs was much lower (39%-66%).</p><disp-quote content-type="editor-comment"><p>C II-(c) Limited data variety: The inverse problem was solved using AP data obtained from a single stimulation protocol, potentially limiting the accuracy of parameter estimates. Including AP data from various stimulation protocols and incorporating pacing cycle length as an additional input could improve parameter identifiability and the accuracy of predictions.</p></disp-quote><p>The proposed emulator architecture currently only considers the discussed maximum conductances as input and thus can only compensate when using different stimulation protocols. However, the architecture itself does not prohibit including any of these as parameters for future variants of the emulator. We potentially foresee future works extending on the architecture with modified datasets to include other parameters of importance, such as channel kinetics, stimulation protocols and pacing cycle lengths. These will however vary between the actual use-cases one is interested in.</p><disp-quote content-type="editor-comment"><p>C II-(d) Larger inaccuracies in the inverse problem using experimental data: The reasons for this result are not quite clear. Hypotheses suggest that it may be attributed to the low parameter identifiability or the training data set were collected in small tissue preparation.</p></disp-quote><p>The low parameter identifiability on some channels (e.g. GK1) poses a problem, for which we state multiple potential reasons. As of yet, no final conclusion can be drawn, warranting further research in this area.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 3 - Comments</bold></p><p>Summary:</p><p>Grandits and colleagues were trying to develop a new tool to accelerate pharmacological studies by using neural networks to emulate the human ventricular cardiomyocyte action potential (AP). The AP is a complex electrical signal that governs the heartbeat, and it is important to accurately model the effects of drugs on the AP to assess their safety and efficacy. Traditional biophysical simulations of the AP are computationally expensive and time-consuming. The authors hypothesized that neural network emulators could be trained to predict the AP with high accuracy and that these emulators could also be used to quickly and accurately predict the effects of drugs on the AP.</p><p>Strengths:</p><p>One of the study’s major strengths is that the authors use a large and high-quality dataset to train their neural network emulator. The dataset includes a wide range of APs, including normal and abnormal APs exhibiting EADs. This ensures that the emulator is robust and can be used to predict the AP for a variety of different conditions.</p><p>Another major strength of the study is that the authors demonstrate that their neural network emulator can be used to accelerate pharmacological studies. For example, they use the emulator to predict the effects of a set of known arrhythmogenic drugs on the AP. The emulator is able to predict the effects of these drugs, even though it had not been trained on these drugs specifically.</p><p>C III-(a) One weakness of the study is that it is important to validate neural network emulators against experimental data to ensure that they are accurate and reliable. The authors do this to some extent, but further validation would be beneficial. In particular for the inverse problem, where the estimation of pharmacological parameters was very challenging and led to particularly large inaccuracies.</p></disp-quote><p>Thank you for this recommendation. Further experimental validation of the emulator in the context of the inverse problem would be definitely beneficial. Still, an important observation is that the identifiability varies greatly between channels. While the inverse problem is an essential reason for utilizing the emulator, it is also empirically validated for the pure forward problem and synthetic inverse problem, together with the (limited) experimental validation. The sources of problems arising in estimating the maximum conductances of the experimental tissue preparations are important to discuss in future works, as we now further emphasize in the discussion. See also the response to the recommendations R III-(t).</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 1 - Recommendations</bold></p><p>R I-(a) Could further detail on the software used for the emulation be provided? E.g. based on section 2.2.2, it sounds like a CPU, as well as GPU-based emulation, is possible, which is neat.</p></disp-quote><p>Indeed as suspected, the emulator can run on both CPUs and GPUs and features automatic parallelization (per-cell, but also multi-cell), which is enabled by the engineering feats of PyTorch [Paszke et al., 2019]. This is now outlined in a bit more detail in Sec. 2 and 5.</p><p>&quot;The trained emulator is provided as a Python package, heavily utilizing PyTorch [Paszke et al., 2019] for the neural network execution, allowing it to be executed on both CPUs and NVidia GPUs.&quot; (Section 5)</p><disp-quote content-type="editor-comment"><p>R I-(b) I believe that a potential use of NN emulation could be also in helping save time on prepacing models to stability - using the NN for ”rough” prepacing (e.g. 1000 beats), and then running a simulation from that point for a smaller amount of time (e.g. 50 beats). One could monitor the stability of states, so if the prepacing was inaccurate, one could quickly tell that these models develop their state vector substantially, and they should be simulated for longer for full accuracy - but if the model was stable within the 50 simulated beats, it could be kept as it is. In this way, the speedup of the NN and accuracy and insightfulness of the simulation could be combined. However, as I mentioned in the public review, I’m not sure there is a great need for further speedup of single-cell simulations. Such a hybrid scheme as described above might be perhaps used to accelerate genetic algorithms used to develop new models, where it’s true that hundreds of thousands to millions of cells are eventually simulated, and a speedup there could be practical. However one would have to have a separate NN trained for each protocol in the fitness function that is to be accelerated, and this would have to be retrained for each explored model architecture. I’m not sure if the extra effort would be worth it - but maybe yes to some people.</p></disp-quote><p>Thank you for this valuable suggestion. As pointed out in C I-(a), one goal of this study was to reduce the timeconsuming task of prepacing. Still, in its current form the emulator could not be utilized for prepacing simulators, as only the AP is computed by the emulator. For initializing a simulation at the N-th beat, one would additionally need all computed channel state variables. However, a simple adaptation of the emulator architecture would allow to also output the mentioned state variables.</p><disp-quote content-type="editor-comment"><p>R I-(c) Re: ”Several emulator architectures were tried on the training and validation data sets and the final choice was hand-picked as a good trade-off between high accuracy and low computational cost” - is it that the emulator architecture was chosen early in the development, and the analyses presented in the paper were all done with one previously selected architecture? Or is it that the analyses were attempted with all considered architectures, and the well-performing one was chosen? In the latter case, this could flatter the performance artificially and a test set evaluation would be worth carrying out.</p></disp-quote><p>We apologize for the unclear description of the architectural validation. The validation was in fact carried out with 20% of the training data (data set #1), which is however completely disjoint with the test set (#2, #3, #4, formerly data set #1 and #2) on which the evaluation was presented. To further clarify the four different data sets used in the study, we now dedicated an additional section to describing each set and where it was used (see also our response below R I-(d)), and summarize them in Table 1, which we also added at R II-(a). The cited statement was slightly reworked.</p><p>&quot;Several emulator architectures were tried on the training and validation data sets and the final choice was hand-picked as a good trade-off between high accuracy on the validation set (#1) and low computational runtime cost.&quot; (Section 2.2.2)</p><disp-quote content-type="editor-comment"><p>R I-(d) When using synthetic data for the forward and inverse problem, with the various simulated drugs, is it that split of the data into training/validation test set was done by the drug simulated (i.e., putting 80 drugs and the underlying models in the training set, and 20 into test set)? Or were the data all mixed together, and 20% (including drugs in the test set) were used for validation? I’m slightly concerned by the potential of ”soft” data leaks between training/validation sets if the latter holds. Presumably, the real-world use case, especially for the inverse problem, will be to test drugs that were not seen in any form in the training process. I’m also not sure whether it’s okay to reuse cell models (sets of max conductances) between training and validation tests - wouldn’t it be better if these were also entirely distinct? Could you please comment on this?</p></disp-quote><p>We completely agree with the main points of apprehension that training, validation and test sets all serve a distinct purpose and should not be arbitrarily mixed. However, this is only a result of the sub-optimal description of our datasets, which we heavily revised in Section 2.2.1 (Data, formerly 2.3.1). We now present the data using four distinct numbers: The initial training/validation data, now called data set #1 (formerly no number), is split 80%/20% into training and validation sets (for architectural choices) respectively. The presented evaluations in Section 2.3 (Evaluation) are purely performed on data set #2 (normal APs, formerly #1), #3 (EADs, formerly #2) and #4 (experimental).</p><disp-quote content-type="editor-comment"><p>R I-(e) For the forward problem on EADs, I’m not sure if the 72% accuracy is that great (although I do agree that the traces in Fig 12-left also typically show substantial ICaL reactivation, but this definitely should be present, given the IKr and ICaL changes). I would suggest that you also consider the following design for the EAD investigation: include models with less severe upregulation of ICaL and downregulation of IKr, getting a population of models where a part manifests EADs and a part does not. Then you could run the emulator on the input data of this population and be able to quantify true, falsexpositive, negative detections. I think this is closer to a real-world use case where we have drug parameters and a cell population, and we want to quickly assess the arrhythmic risk, with some drugs being likely entirely nonrisky, some entirely risky, and some between (although I still am not convinced it’s that much of an issue to just simulate this in a couple of thousands of cells).</p></disp-quote><p>Thank you for pointing out this alternative to address the EAD identification task. Even though the values chosen in Table 2 seem excessively large, we still only witnessed EADs in 171 of the 950 samples. Especially border cases, which are close to exhibiting EADs are hardest to estimate for the NN emulator. As suggested, we now include the study with the full 950 samples (non-EAD &amp; EAD) and classify the emulator AP into one of the labels for each sample. The mentioned 72.5% now represent the sensitivity, whereas our accuracy in such a scenario becomes90.8% (total ratio of correct classifications):</p><p>&quot;The data set #3 was used second and Appendix C shows all emulated APs, both containing the EAD and non-EAD cases. The emulation of all 950 APs took 0.76s on the GPU specified in Section 2.2.3 We show the emulation of all maximum conductances and the classification of the emulation. The comparison with the actual EAD classification (based on the criterion outlined in Appendix A) results in true-positive (EAD both in the simulation and emulation), false-negative (EAD in the simulation, but not in the emulation), false-positive (EAD in the emulation, but not in the simulation) and true-negative (no EAD both in the emulation and simulation). The emulations achieved 72.5% sensitivity (EAD cases correctly classified) and 94.9% specificity (non-EAD cases correctly classified), with an overall accuracy of 90.8% (total samples correctly classified). A substantial amount of wrongly classified APs showcase a notable proximity to the threshold of manifesting EADs. Figure 7 illustrates the distribution of RMSEs in the EAD APs between emulated and ground truth drugged APs. The average RMSE over all EAD APs was 14.5mV with 37.1mV being the maximum. Largest mismatches were located in phase 3 of the AP, in particular in emulated APs that did not fully repolarize.&quot; (Section 3.1.1)</p><disp-quote content-type="editor-comment"><p>R I-(f) Figure 1 - I think a large number of readers will understand the mathematical notation describing inputs/outputs; that said, there may be a substantial number of readers who may find that hard to read (e.g. lab-based researchers, or simulation-based researchers not familiar with machine learning). At the same time, this is a very important part of the paper to explain what is done where, so I wonder whether using words to describe the inputs/outputs would not be more practical and easier to understand (e.g. ”drug-based conductance scaling factor” instead of ”s” ?). It’s just an idea - it needs to be tried to see if it wouldn’t make the figure too cluttered.</p></disp-quote><p>We agree that the mathematical notation may be confusing to some readers. As a compromise between using verbose wording and mathematical notation, we introduced a legend in the lower right corner of the figure that shortly describes the notation in order to help with interpreting the figure.</p><disp-quote content-type="editor-comment"><p>R I-(g) ”APs with a transmembrane potential difference of more than 10% of the amplitude between t = 0 and 1000 ms were excluded” - I’m not sure I understand what exactly you mean here - could you clarify?</p></disp-quote><p>With this criterion, we try to discard data that is far away from fully repolarizing within the given time frame, which applies to 116 APs in data set #1 and 50 APs in data set #3. We added a small side note into the text:</p><p>&quot;APs with a transmembrane potential difference of more than 10% of the amplitude between t = 0 and 1000ms (indicative of an AP that is far away from full repolarization) were excluded.&quot; (Section 2.2.1)</p><disp-quote content-type="editor-comment"><p>R I-(h) Speculation (for the future) - it looks like a tool like this could be equally well used to predict current traces, as well as action potentials. I wonder, would there be a likely benefit in feeding back the currents-traces predictions on the input of the AP predictor to provide additional information? Then again, this might be already encoded within the network - not sure.</p></disp-quote><p>Although not possible with the chosen architecture (see also R I-(b)), it is worth thinking about an implementation in future works and to study differences to the current emulator.</p><disp-quote content-type="editor-comment"><p>Entirely minor points:</p><p>R I-(i) ”principle component analysis” → principal component analysis</p></disp-quote><p>Fixed</p><disp-quote content-type="editor-comment"><p>R I-(j) The paper will be probably typeset by elife anyway, but the figures are often quite far from their sections, with Results figures even overflowing into Discussion. This can be often fixed by using the !htb parameters (\begin{figure}[!htb]), or potentially by using ”\usepackage[section]{placeins}” and then ”\FloatBarrier” at the start and end of each section (or subsection) - this prevents floating objects from passing such barriers.</p></disp-quote><p>Thank you for these helpful suggestions. We tried reducing the spacing between the figures and their references in the text, hopefully improving the reader’s experience.</p><disp-quote content-type="editor-comment"><p>R I-(k) Alternans seems to be defined in Appendix A (as well as repo-/depolarization abnormalities), but is not really investigated. Or are you defining these just for the purpose of explaining what sorts of data were also included in the data?</p></disp-quote><p>We defined alternans since this was an exclusion criterion for generating simulation data.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer 2 - Recommendations</bold></p><p>R II-(a) Justification for methods selection: Explain the rationale behind important choices, such as the selection of specific parameters and algorithms.</p></disp-quote><p>Thank you for this recommendation, we tried to increase transparency of our choices by introducing a separate data section that summarizes all data sets and their use cases in Section 2.2.1 and also collect many of the explanations there. Additionally we added an overview table (Table 1) of the utilized data.</p><table-wrap id="sa3table1" position="float"><label>Author response table 1.</label><caption><title>Summary of the data used in this study, along with their usage and the number of valid samples.</title><p>Note that each AP is counted individually, also in cases of control/drug pairs.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">ID</th><th align="left" valign="top">Description</th><th align="left" valign="top">Usage</th><th align="left" valign="top">Origin</th><th align="left" valign="top">Samples</th></tr></thead><tbody><tr><td align="left" valign="top">#1</td><td align="left" valign="top">Training/validation data</td><td align="left" valign="top">Training and validating the emulator, choosing the best architecture (Section ‘Architecture’)</td><td align="left" valign="top">Simulation</td><td align="left" valign="top">39,884</td></tr><tr><td align="left" valign="top">#2</td><td align="left" valign="top">Synthetic drug data, normal APs</td><td align="left" valign="top">Testing forward and inverse performance for normal APs (Sections ‘Forward problem’ and ‘Inverse problem based on synthetic data’)</td><td align="left" valign="top">Simulation</td><td align="left" valign="top">10<sup>4</sup></td></tr><tr><td align="left" valign="top">#3</td><td align="left" valign="top">Synthetic drug data, including EAD APs</td><td align="left" valign="top">Testing forward performance of abnormal (EAD) APs (‘Forward problem’)</td><td align="left" valign="top">Simulation</td><td align="left" valign="top">950</td></tr><tr><td align="left" valign="top">#4</td><td align="left" valign="top">Experimental cardiomyocytes</td><td align="left" valign="top">Testing and comparing the inverse performance with data published by the CiPA initiative (Li et al.. 2017, Chang et al., 2017; Section ‘Inverse problem based onexperimental data’)</td><td align="left" valign="top">Orvos et al., 2019</td><td align="left" valign="top">26</td></tr></tbody></table></table-wrap><disp-quote content-type="editor-comment"><p>R II-(b) Interpretation of the evaluation results: After presenting the evaluation results, consider interpretations or insights into what the results mean for the performance of the emulator. Explain whether the emulator achieved the desired accuracy or compare it with other existing methods.In the revised version, we tried to further expand the discussion on possible applications of our emulator (Section 4.2). See also our response to C I-(a). To the best of our knowledge, there are currently no out-of-the-box methods available for directly comparing all experiments we considered in our work.</p><p><bold>Reviewer 3 - Recommendations</bold></p><p>R III-(a) In the introduction (Page 3) and then also in the 2.1 paragraph authors speak about the ”limit cycle”: Do you mean steady state conditions? In that case, it is more common to use steady state.</p></disp-quote><p>When speaking about the limit cycle, we refer to what is also sometimes called the steady state, depending on the field of research and/or personal preference. We now mention both terms at the first occurence, but stick with the limit cycle terminology which can also be found in other works, see e.g. [Endresen and Skarland, 2000].</p><disp-quote content-type="editor-comment"><p>R III-(b) On page 3, while comparing NN with GP emulators, I still don’t understand the key reason why NN can solve the discontinuous functions with more precision than GP.</p></disp-quote><p>The potential problems in modeling sharp continuities using GPs is further explained in the referenced work [Ghosh et al., 2018] and further references therein:</p><p>&quot;Statistical emulators such as Gaussian processes are frequently used to reduce the computational cost of uncertainty quantification, but discontinuities render a standard Gaussian process emulation approach unsuitable as these emulators assume a smooth and continuous response to changes in parameter values [...] Applying GPs to model discontinuous functions is largely an open problem. Although many advances (see the discussion about non-stationarity in [Shahriari et al., 2016] and the references in there) have been made towards solving this problem, a common solution has not yet emerged. In the recent GP literature there are two specific streams of work that have been proposed for modelling non-stationary response surfaces including those with discontinuities. The first approach is based on designing nonstationary processes [Snoek et al., 2014] whereas the other approach attempts to divide the input space into separate regions and build separate GP models for each of the segmented regions. [...]&quot;([Ghosh et al., 2018])</p><p>We integrated a short segment of this explanation into Section 1.</p><disp-quote content-type="editor-comment"><p>R III-(c) Why do authors prefer to use CARPentry and not directly openCARP?The use of CARPentry is purely a practical choice since the simulation pipeline was already set up. As we now point out however in Sec. 2.1 (Simulator), simulations can also be performed using any openly available ionic simulation tool, such as Myokit [Clerx et al., 2016], OpenCOR [Garny and Hunter, 2015] and openCARP [Plank et al., 2021]. We emphasized this in the text.</p></disp-quote><p>&quot;Note, that the simulations can also be performed using open-source software such as Myokit [Clerx et al., 2016], OpenCOR [Garny and Hunter, 2015] and openCARP [Plank et al., 2021].&quot; (Section 2.1)</p><disp-quote content-type="editor-comment"><p>R III-(d) In paragraph 2.1:</p><p>(a) In this sentence: ”Various solver and sampling time steps were applied to generate APs and the biomarkers used in this study (see Appendix A)” this reviewer suggests putting the Appendix reference near “biomarkers”. In addition, a figure that shows the test of various solver vs. sampling time steps could be interesting and can be added to the Appendix as well.</p><p>(b) Why did the authors set the relative difference below 5% for all biomarkers? Please give a reference to that choice. Instead, why choose 2% for the time step?</p></disp-quote><p>1. We adjusted the reference to be closer to “biomarkers”. While we agree that further details on the influence of the sampling step would be of interest to some of the readers, we feel that it is far beyond the scope of this paper.</p><disp-quote content-type="editor-comment"><p>1. There is no specific reference we can provide for the choice. Our goal was to reach 5% relative difference, which we surpassed by the chosen time steps of 0.01 ms (solver) and 0.05 ms (sampling), leading to only 2% difference. We rephrased the sentence in question to make this clear.</p></disp-quote><p>&quot;We considered the time steps with only 2% relative difference for all AP biomarkers (solver: 0.01ms; sampling: 0.05ms) to offer a sufficiently good approximation.&quot; (Section 2.1)</p><disp-quote content-type="editor-comment"><p>R III-(e) In the caption of Figure 1 authors should include the reference for AP experimental data (are they from Orvos et al. 2019 as reported in the Experimental Data section?)</p></disp-quote><p>We added the missing reference as requested. As correctly assumed, they are from [Orvos et al., 2019].</p><disp-quote content-type="editor-comment"><p>R III-(f) Why do authors not use experimental data in the emulator development/training?</p></disp-quote><p>For the supervised training of our NN emulator, we need to provide the maximum conductances of our chosen channels for each AP. While it would be beneficial to also include experimental data in the training to diversify the training data, the exact maximum conductances in our the considered retrospective experiments are not known. In the case such data would be available with low measurement uncertainty, it would be possible to include.</p><disp-quote content-type="editor-comment"><p>R III-(g) What is TP used in the Appendix B? I could not find the acronymous explanation.</p></disp-quote><p>We are sorry for the oversight, TP refers to the time-to-peak and is now described in Appendix A.</p><disp-quote content-type="editor-comment"><p>R III-(h) Are there any reasons for only using ST and no S1? Maybe are the same?</p></disp-quote><p>The global sensitivity analysis is further outlined in Appendix B, also showing S1 (first-order effects) and ST (variance of all interactions) together (Figure 11) [Herman and Usher, 2017] and their differences (e.g. in TP) Since S1 only captures first-order effects, it may fail to capture higher-order interactions between the maximum conductances, thus we favored ST.</p><disp-quote content-type="editor-comment"><p>R III-(i) In Training Section Page 8. It is not clear why it is necessary to resample data. Can you motivate?</p></disp-quote><p>The resampling part is motivated by exactly capturing the swift depolarization dynamics, whereas the output from CARPentry is uniformly sampled. This is now further highlighted in the text.</p><p>&quot;Then, the data were non-uniformly resampled from the original uniformly simulated APs, to emphasize the depolarization slope with a high accuracy while lowering the number of repolarization samples. For this purpose, we resamled the APs [...]&quot; (Section 2.2.1)</p><disp-quote content-type="editor-comment"><p>R III-(j) For the training of the neuronal network, the authors used the ADAM algorithm: have you tested any other algorithm?</p></disp-quote><p>For training neural networks, ADAM has become the current de-facto standard and is certainly a robust choice for training our emulator. While there may exist slightly faster, or better-suited training algorithms, we witnessed (qualitative) convergence in the training (Equation (2)). We thus strongly believe that the training algorithm is not a limiting factor in our study.</p><disp-quote content-type="editor-comment"><p>R III-(k) What is the amount of the drugs tested? Is the same dose reported in the description of the second data set or the values are only referring to experimental data? Moreover, it is not clear if in the description of experimental data, the authors are referring to newly acquired data (since they described in detail the protocol) or if they are obtained from Orvos et al. 2019 work.</p></disp-quote><p>In all scenarios, we tested 5 different drugs (cisapride, dofetilide, sotalol, terfenadine, verapamil). We revised our previous presentation of the data available, and now try to give a concise overview over the utilized data (Section 2.2.1 and table 1) and drug comparison with the CiPA distributions (Table 5, former 4). Note that in the latter case, the available expected channel scaling factors by the CiPA distributions vary, but are now clearly shown in Table 5.</p><disp-quote content-type="editor-comment"><p>R III-(l) In Figure 4, I will avoid the use of “control” in the legend since it is commonly associated with basal conditions and not with the drug administration.</p></disp-quote><p>The terminology “control” in this context is in line with works from the CiPA initiative, e.g. [Li et al., 2017] and refers to the state of cell conditions before the drug wash-in. We added a minor note the first time we use the term control in the introduction to emphasize that we refer to the state of the cell before administering any drugs</p><p>&quot;To compute the drugged AP for given pharmacological parameters is a forward problem, while the corresponding inverse problem is to find pharmacological parameters for given control (before drug administration) and drugged AP.&quot; (Section 1)</p><disp-quote content-type="editor-comment"><p>R III-(m) In Table 1 when you referred to Britton et al. 2017 work, I suggest adding also 10.1371/journal.pcbi.1002061.</p></disp-quote><p>We added the suggested article as a reference.</p><disp-quote content-type="editor-comment"><p>R III-(n) For the minimization problem, only data set #1 has been used. Have you tested data set #2?</p></disp-quote><p>In the current scenario, we only tested the inverse problem for data set #2 (former #1). The main purpose for data set #3 (former #2), was to test the possibility to emulate EAD APs. Given the overall lower performance in comparison to data set #2 (former #1), we also expect deteriorated results in comparison to the existing inverse synthetic problem.</p><disp-quote content-type="editor-comment"><p>R III-(o) In Figure 6 you should have the same x-axis (we could not see any points in the large time scale for many biomarkers). Why dVmMax is not uniformed distributed compared to the others? Can you comment on that?</p></disp-quote><p>As suggested, we re-adjusted the x-range to show the center of distributions. Additionally, we denoted in each subplot the number of outliers which lie outside of the shown range. The error distribution on dVmMax exhibits a slightly off-center, left-tailed normal distribution, which we now describe a bit more in the revised text:</p><p>&quot;While the mismatches in phase 3 were simply a result of imperfect emulation, the mismatches in phase 0 were a result of the difficulty in matching the depolarization time exactly. [...] Likewise, the difficulty in exactly matching the depolarization time leads to elevated errors and more outliers in the biomarkers influenced by the depolarization phase (TP and dVmMax),&quot; (Section 3.1.1)</p><disp-quote content-type="editor-comment"><p>R III-(p) Page 14. Can the authors better clarify ”the average RMSE over all APs 13.6mV”: is it the mean for all histograms in Figure 7? (In Figure 5 is more evident the average RMSE).</p></disp-quote><p>The average RMSE uses the same definition for Figures 5 and 7: It is the average over all the RMSEs for each pair of traces (simulated/emulated), though the amount of samples is much lower for the EAD data set and not normal distributed.</p><disp-quote content-type="editor-comment"><p>R III-(q) In Table 4, the information on which drugs are considered should be added.For each channel, we added the names of the drugs for which respective data from the CiPA initiative were available.</p><p>R III-(r) Pag. 18, second paragraph, there is a repetition of ”and”.</p></disp-quote><p>Fixed</p><disp-quote content-type="editor-comment"><p>R III-(s) The pair’s combination of scaling factors for simulating synthetic drugs reported in Table 2, can be associated with some effects of real drugs? In this case, I suggest including the information or justifying the choice.</p></disp-quote><p>The scaling factors in Table 2 are used to create data set #3 (former #2), and is meant to provide several APs which expose EADs. This is described in more detail in the new data section, Section 2.2.1:</p><p>&quot;Data set #3: The motivation for creating data set #3 was to test the emulator on data of abnormal APs showing the repolarization abnormality EAD. This is considered a particularly relevant AP abnormality in pharmacological studies because of their role in the genesis of drug-induced ventricular arrhythmia’s [Weiss et al., 2010]. Drug data were created using ten synthetic drugs with the hERG channel and the Cav1.2 channel as targets. To this end, ten samples with pharmacological parameters for GKr and PCa (Table 2) were generated and the synthetic drugs were applied to the entire synthetic cardiomyocyte population by scaling GKr and PCa with the corresponding pharmacological parameter. Of the 1000 APs simulated, we discarded APs with a transmembrane potential difference of more than 10% of the amplitude between t = 0 and 1000ms (checked for the last AP), indicative of an AP that does not repolarize within 1000ms. This left us with 950 APs, 171 of which exhibit EAD (see Appendix C).&quot; (Section 2.2.1)</p><disp-quote content-type="editor-comment"><p>R III-(t) A general comment on the work is that the authors claim that their study highlights the potential of NN emulators as a powerful tool for increased efficiency in future quantitative systems pharmacology studies, but they wrote ”Larger inaccuracies were found in the inverse problem solutions on experimental data highlight inaccuracies in estimating the pharmacological parameters”: so, I was wondering how they can claim the robustness of NN use as a tool for more efficient computation in pharmacological studies.</p></disp-quote><p>The discussed robustness directly refers to efficiently emulating steady-state/limit cycle APs from a set of maximum conductances (forward problem, Section 3.1.1). We extensively evaluated the algorithm and feel that given the low emulation RMSE of APs (&lt; 1 mV), the statement is warranted. The inverse estimation, enabled through this rapid evaluation, performs well on synthetic data, but shows difficulties for experimental data. Note however that at this point there are multiple potential sources for these problems as highlighted in the Evaluation section (Section 4.1) and Table 5 (former 4) highlights the difference in accuracy of estimating per-channel maximum conductances, revealing a potentially large discrepancy. The emulator also offers future possibilities to incorporate additional informations in the forms of either priors, or more detailed measurements (e.g. calcium transients) and can be potentially improved to a point where also the inverse problem can be satisfactorily solved in experimental preparations, though further analysis will be required.</p><p>References[Beck, 2017] Beck, A. (2017). First-order methods in optimization. SIAM.</p><p>[Britton et al., 2013] Britton, O. J., Bueno-Orovio, A., Ammel, K. V., Lu, H. R., Towart, R., Gallacher, D. J., and Rodriguez, B. (2013). Experimentally calibrated population of models predicts and explains intersubject variability in cardiac cellular electrophysiology. Proceedings of the National Academy of Sciences, 110(23).</p><p>[Chang et al., 2017] Chang, K. C., Dutta, S., Mirams, G. R., Beattie, K. A., Sheng, J., Tran, P. N., Wu, M., Wu, W. W., Colatsky, T., Strauss, D. G., and Li, Z. (2017). Uncertainty quantification reveals the importance of data variability and experimental design considerations for in silico proarrhythmia risk assessment. Frontiers in Physiology, 8.</p><p>[Clerx et al., 2016] Clerx, M., Collins, P., de Lange, E., and Volders, P. G. A. (2016). Myokit: A simple interface to cardiac cellular electrophysiology. Progress in Biophysics and Molecular Biology, 120(1):100–114.</p><p>[Endresen and Skarland, 2000] Endresen, L. and Skarland, N. (2000). Limit cycle oscillations in pacemaker cells. IEEE Transactions on Biomedical Engineering, 47(8):1134–1137.</p><p>[Garny and Hunter, 2015] Garny, A. and Hunter, P. J. (2015). OpenCOR: a modular and interoperable approach to computational biology. Frontiers in Physiology, 6.</p><p>[Gemmell et al., 2016] Gemmell, P., Burrage, K., Rodr´ıguez, B., and Quinn, T. A. (2016). Rabbit-specific computational modelling of ventricular cell electrophysiology: Using populations of models to explore variability in the response to ischemia. Progress in Biophysics and Molecular Biology, 121(2):169–184.</p><p>[Ghosh et al., 2018] Ghosh, S., Gavaghan, D. J., and Mirams, G. R. (2018). Gaussian process emulation for discontinuous response surfaces with applications for cardiac electrophysiology models.</p><p>[Herman and Usher, 2017] Herman, J. and Usher, W. (2017). SALib: An open-source python library for sensitivity analysis. J. Open Source Softw., 2(9):97.</p><p>[Johnstone et al., 2016] Johnstone, R. H., Chang, E. T., Bardenet, R., de Boer, T. P., Gavaghan, D. J., Pathmanathan, P., Clayton, R. H., and Mirams, G. R. (2016). Uncertainty and variability in models of the cardiac action potential: Can we build trustworthy models? Journal of Molecular and Cellular Cardiology, 96:49–62.</p><p>[Li et al., 2017] Li, Z., Dutta, S., Sheng, J., Tran, P. N., Wu, W., Chang, K., Mdluli, T., Strauss, D. G., and Colatsky, T. (2017). Improving the in silico assessment of proarrhythmia risk by combining hERG (human ether`a-go-go-related gene) channel–drug binding kinetics and multichannel pharmacology. Circulation: Arrhythmia and Electrophysiology, 10(2).</p><p>[Muszkiewicz et al., 2016] Muszkiewicz, A., Britton, O. J., Gemmell, P., Passini, E., S´anchez, C., Zhou, X., Carusi, A., Quinn, T. A., Burrage, K., Bueno-Orovio, A., and Rodriguez, B. (2016). Variability in cardiac electrophysiology: Using experimentally-calibrated populations of models to move beyond the single virtual physiological human paradigm. Progress in Biophysics and Molecular Biology, 120(1):115–127.</p><p>[Orvos et al., 2019] Orvos, P., Kohajda, Z., Szlov´ak, J., Gazdag, P., Arp´adffy-Lovas, T., T´oth, D., Geramipour, A.,´ T´alosi, L., Jost, N., Varr´o, A., and Vir´ag, L. (2019). Evaluation of possible proarrhythmic potency: Comparison of the effect of dofetilide, cisapride, sotalol, terfenadine, and verapamil on hERG and native iKr currents and on cardiac action potential. Toxicological Sciences, 168(2):365–380.</p><p>[Paszke et al., 2019] Paszke, A., Gross, S., Massa, F., Lerer, A., Bradbury, J., Chanan, G., Killeen, T., Lin, Z., Gimelshein, N., Antiga, L., Desmaison, A., Kopf, A., Yang, E., DeVito, Z., Raison, M., Tejani, A., Chilamkurthy, S., Steiner, B., Fang, L., Bai, J., and Chintala, S. (2019). PyTorch: An Imperative Style, High-Performance Deep Learning Library. In Advances in Neural Information Processing Systems, volume 32. Curran Associates, Inc.</p><p>[Plank et al., 2021] Plank, G., Loewe, A., Neic, A., Augustin, C., Huang, Y.-L., Gsell, M. A., Karabelas, E., Nothstein, M., Prassl, A. J., S´anchez, J., Seemann, G., and Vigmond, E. J. (2021). The openCARP simulation environment for cardiac electrophysiology. Computer Methods and Programs in Biomedicine, 208:106223.</p><p>[Shahriari et al., 2016] Shahriari, B., Swersky, K., Wang, Z., Adams, R. P., and de Freitas, N. (2016). Taking the Human Out of the Loop: A Review of Bayesian Optimization. Proceedings of the IEEE, 104(1):148–175. Conference Name: Proceedings of the IEEE.</p><p>[Snoek et al., 2014] Snoek, J., Swersky, K., Zemel, R., and Adams, R. (2014). Input Warping for Bayesian Optimization of Non-Stationary Functions. In Proceedings of the 31st International Conference on Machine Learning, pages 1674–1682. PMLR. ISSN: 1938-7228.</p><p>[Weiss et al., 2010] Weiss, J. N., Garfinkel, A., Karagueuzian, H. S., Chen, P.-S., and Qu, Z. (2010). Early afterdepolarizations and cardiac arrhythmias. Heart Rhythm, 7(12):1891–1899.</p></body></sub-article></article>