<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">75611</article-id><article-id pub-id-type="doi">10.7554/eLife.75611</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>An incentive circuit for memory dynamics in the mushroom body of <italic>Drosophila melanogaster</italic></article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-143872"><name><surname>Gkanias</surname><given-names>Evripidis</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3343-9039</contrib-id><email>ev.gkanias@ed.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-243062"><name><surname>McCurdy</surname><given-names>Li Yan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8862-6715</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-243063"><name><surname>Nitabach</surname><given-names>Michael N</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-198304"><name><surname>Webb</surname><given-names>Barbara</given-names></name><email>B.Webb@ed.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01nrxwf90</institution-id><institution>Institute of Perception Action and Behaviour, School of Informatics, University of Edinburgh</institution></institution-wrap><addr-line><named-content content-type="city">Edinburgh</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v76x132</institution-id><institution>Department of Cellular and Molecular Physiology, Yale University</institution></institution-wrap><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v76x132</institution-id><institution>Department of Genetics, Yale University</institution></institution-wrap><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v76x132</institution-id><institution>Department of Neuroscience, Yale University</institution></institution-wrap><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bhalla</surname><given-names>Upinder Singh</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03ht1xw27</institution-id><institution>Tata Institute of Fundamental Research</institution></institution-wrap><country>India</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>01</day><month>04</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e75611</elocation-id><history><date date-type="received" iso-8601-date="2021-11-16"><day>16</day><month>11</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-03-07"><day>07</day><month>03</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2021-06-11"><day>11</day><month>06</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.06.11.448104"/></event></pub-history><permissions><copyright-statement>© 2022, Gkanias et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Gkanias et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-75611-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-75611-figures-v1.pdf"/><abstract><p>Insects adapt their response to stimuli, such as odours, according to their pairing with positive or negative reinforcements, such as sugar or shock. Recent electrophysiological and imaging findings in <italic>Drosophila melanogaster</italic> allow detailed examination of the neural mechanisms supporting the acquisition, forgetting, and assimilation of memories. We propose that this data can be explained by the combination of a dopaminergic plasticity rule that supports a variety of synaptic strength change phenomena, and a circuit structure (derived from neuroanatomy) between dopaminergic and output neurons that creates different roles for specific neurons. Computational modelling shows that this circuit allows for rapid memory acquisition, transfer from short term to long term, and exploration/exploitation trade-off. The model can reproduce the observed changes in the activity of each of the identified neurons in conditioning paradigms and can be used for flexible behavioural control.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>computational model</kwd><kwd>memory</kwd><kwd>plasticity</kwd><kwd>dopamine</kwd><kwd>olfactory conditioning</kwd><kwd>motivation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000266</institution-id><institution>Engineering and Physical Sciences Research Council</institution></institution-wrap></funding-source><award-id>EP/L016834/1</award-id><principal-award-recipient><name><surname>Gkanias</surname><given-names>Evripidis</given-names></name><name><surname>Webb</surname><given-names>Barbara</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000065</institution-id><institution>National Institute of Neurological Disorders and Stroke</institution></institution-wrap></funding-source><award-id>R01NS091070</award-id><principal-award-recipient><name><surname>Nitabach</surname><given-names>Michael N</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01NS091070</award-id><principal-award-recipient><name><surname>Nitabach</surname><given-names>Michael N</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Modelling differential roles for identified dopaminergic and output neurons of the fruit fly mushroom bodies, combined with a novel dopaminergic plasticity rule, explains neural and behavioural phenomena in olfactory learning tasks.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Animals deal with a complicated and changing world, and they need to adapt their behaviour according to their recent experience. Rapid changes in behaviour to stimuli accompanied by intense reinforcement require memories in the brain that are readily susceptible to alteration. Yet associations experienced consistently should form long-term memories (LTMs) that are hard to change. Memories that are no longer valid should be forgotten. Every neuron cannot have all of these properties, but they must be connected in a circuit, playing different roles such as supporting short-term memory (STM) or LTM, and enabling processes to form, retain, and erase memories. This complex interaction of memory processes is familiar in principle, but its implementation at the single-neuron level is still largely a mystery.</p><p>The fruit fly <italic>Drosophila melanogaster</italic> is able to form, retain, and forget olfactory associations with reinforcements, for example, electric shock. The key neural substrate is known to lie in the neuropils of their brain called the <italic>mushroom bodies</italic> (MBs) (<xref ref-type="bibr" rid="bib26">Davis, 1993</xref>; <xref ref-type="bibr" rid="bib40">Heisenberg, 2003</xref>; <xref ref-type="bibr" rid="bib18">Busto et al., 2010</xref>). There are two MBs in the insect brain, one in each hemisphere, composed of intrinsic and extrinsic neurons. Extrinsic <italic>projection neurons</italic> (PN) deliver sensory input to the only intrinsic neurons of the MBs, the <italic>Kenyon cells</italic> (KCs), whose long parallel axons travel through the pendunculus and then split forming the vertical (α/α′) and medial (β/β′ and γ) MB lobes (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). The extrinsic <italic>mushroom body output neurons</italic> (MBONs) extend their dendrites in different regions of the lobes, receiving input from the KCs and forming 15 distinct compartments (<xref ref-type="bibr" rid="bib91">Turner et al., 2008</xref>; <xref ref-type="bibr" rid="bib90">Tanaka et al., 2008</xref>; <xref ref-type="bibr" rid="bib19">Campbell et al., 2013</xref>; <xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>). Their activity is thought to provide motivational output that modulates the default behaviour of the animal (<xref ref-type="bibr" rid="bib6">Aso et al., 2014b</xref>). Different groups of extrinsic <italic>dopaminergic neurons</italic> (DANs) terminate their axons in specific compartments of the MB and modulate the connections between KCs and MBONs (<xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>). Many of the DANs respond to a variety of reinforcement signals (<xref ref-type="bibr" rid="bib60">Mao and Davis, 2009</xref>; <xref ref-type="bibr" rid="bib83">Schwaerzel et al., 2003</xref>; <xref ref-type="bibr" rid="bib21">Claridge-Chang et al., 2009</xref>; <xref ref-type="bibr" rid="bib56">Liu et al., 2012</xref>; <xref ref-type="bibr" rid="bib54">Lin et al., 2014</xref>), and therefore, they are considered the main source of reinforcement signals in the MB. Finally, many of the MBON axons and DAN dendrites meet in the convergence zones (CZs), where they create interconnections, such that the motivational output can also influence the activity of the reinforcement neurons (<xref ref-type="bibr" rid="bib53">Li et al., 2020</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of the mushroom body circuit.</title><p>Left: the main anatomical pathways. In the illustration, the presented odour activates the Kenyon cells (KCs) through the projection neurons (PNs). The parallel axons of KCs propagate this signal to the lobes of the mushroom body. The mushroom body output neurons (MBONs) extend their dendrites in the mushroom body lobes, receiving input from the KCs. Electric shock creates a punishing signal that excites some dopaminergic neurons (DANs), whose axons terminate in the lobes and modulate the synaptic weights between KCs and MBONs. Right: schematic of potential connections between punishment/reward DANs and approach/avoidance MBONs. Note that although DANs transferring punishing signals modulate the KC activation of MBONs that encode positive motivations (decreasing attraction to the presented odour and increasing attraction to odours not present [the dopaminergic plasticity rule]), MBONs that encode negative motivations will also gain higher responses due to release of inhibition between MBONs, and the feedback connections from MBONs to other DANs. In our model, we further decompose these functions using three DANs and three MBONs for each motivation (positive or negative) and map these units to specific identified neurons and microcircuits in the brain of <italic>Drosophila</italic>. These circuits include some direct (but not mutual) MBON-MBON connections (dashed inhibitory connections).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig1-v1.tif"/></fig><p>Several computational models have tried to capture the structure and function of the MBs, usually abstracting the common features of this network across various insect species. Modellers have treated the MBs as performing odour discrimination (<xref ref-type="bibr" rid="bib42">Huerta et al., 2004</xref>), olfactory conditioning (<xref ref-type="bibr" rid="bib10">Balkenius et al., 2006</xref>; <xref ref-type="bibr" rid="bib85">Smith et al., 2008</xref>; <xref ref-type="bibr" rid="bib35">Finelli et al., 2008</xref>; <xref ref-type="bibr" rid="bib98">Young et al., 2011</xref>; <xref ref-type="bibr" rid="bib93">Wessnitzer et al., 2012</xref>; <xref ref-type="bibr" rid="bib71">Peng and Chittka, 2017</xref>; <xref ref-type="bibr" rid="bib32">Faghihi et al., 2017</xref>; <xref ref-type="bibr" rid="bib101">Zhao et al., 2021</xref>; <xref ref-type="bibr" rid="bib86">Springer and Nawrot, 2021</xref>; <xref ref-type="bibr" rid="bib31">Eschbach et al., 2020</xref>; <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref>), or calculating the scene familiarity (<xref ref-type="bibr" rid="bib94">Wu and Guo, 2011</xref>; <xref ref-type="bibr" rid="bib9">Baddeley et al., 2012</xref>; <xref ref-type="bibr" rid="bib3">Arena et al., 2013</xref>; <xref ref-type="bibr" rid="bib11">Bazhenov et al., 2013</xref>; <xref ref-type="bibr" rid="bib2">Ardin et al., 2016</xref>). However, it seems like they can subserve all these functions, depending on context (or experience), that is, what is driving the activity of the KCs (<xref ref-type="bibr" rid="bib23">Cohn et al., 2015</xref>). This suggests that the output neurons of the MB do not just inform the animal whether an odour is known or attractive, or if a scene is familiar, but they actually motivate the animal to take an action like approach, avoid, escape, or forage. There is emerging evidence supporting this idea of the MBONs driving non-binary but antagonistic motivations (<xref ref-type="bibr" rid="bib83">Schwaerzel et al., 2003</xref>; <xref ref-type="bibr" rid="bib50">Krashes et al., 2009</xref>; <xref ref-type="bibr" rid="bib37">Gerber et al., 2009</xref>; <xref ref-type="bibr" rid="bib92">Waddell, 2010</xref>; <xref ref-type="bibr" rid="bib54">Lin et al., 2014</xref>; <xref ref-type="bibr" rid="bib72">Perisse et al., 2016</xref>; <xref ref-type="bibr" rid="bib84">Senapati et al., 2019</xref>), which has started to be explored in recent models.</p><p>In addition to the structural and functional depiction of the MBs, a variety of plasticity rules have been used in order to explain the effect of dopamine emitted by the DANs on the KC→MBON synapses. Although the best supported biological mechanism is that coincidence of DAN and KC activity depresses the output of KCs to MBONs, most of the models mentioned before use variations of the Hebbian rule (<xref ref-type="bibr" rid="bib39">Hebb, 2005</xref>), where the coincidence of the input (KCs) and output (MBONs) activation strengthens the synaptic weight (or weakens it for the anti-Hebbian case) and this is gated by the reinforcement (DANs). More recent approaches that try to model the activity of DANs and MBONs in the brain have used plasticity rules (<xref ref-type="bibr" rid="bib101">Zhao et al., 2021</xref>) or circuit structures (<xref ref-type="bibr" rid="bib86">Springer and Nawrot, 2021</xref>; <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref>; <xref ref-type="bibr" rid="bib31">Eschbach et al., 2020</xref>) that implement a reward prediction error (RPE) (<xref ref-type="bibr" rid="bib76">Rescorla and Wagner, 1972</xref>), which is the most widely accepted psychological account of associative learning with strong validation evidence in the vertebrate brain (<xref ref-type="bibr" rid="bib67">Niv, 2009</xref>). For the MB, this plasticity rule is interpreted as the output (MBON) being the prediction of the reinforcement (DAN), so their difference (gated by the activity of the input, KC) drives the synaptic plasticity. However, details of neuronal dynamics in fruit flies (<xref ref-type="bibr" rid="bib41">Hige et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Dylla et al., 2017</xref>; <xref ref-type="bibr" rid="bib14">Berry et al., 2018</xref>) suggest that neither Hebbian nor RPE plasticity rules capture the plasticity dynamics in the MBs (also in larva: <xref ref-type="bibr" rid="bib80">Schleyer et al., 2018</xref>; <xref ref-type="bibr" rid="bib81">Schleyer et al., 2020</xref>) as both rules need the conditional stimuli (CS) to occur (KCs to be active) for synaptic weight change. This highlights the importance of investigating new plasticity rules that are a closer approximation to the actual dopaminergic function.</p><p>In this work, we propose such a novel plasticity rule, named the <italic>dopaminergic plasticity rule</italic> (DPR), which reflects a recent understanding of the role of dopamine in depression and potentiation of synapses. Based on the evidence of existing MBON→DAN connections, we build a 12-neuron computational model, which we call the <italic>incentive circuit</italic> (IC), and uses the proposed plasticity rule. In this model, we name three types of DANs (‘discharging’, ‘charging’, and ‘forgetting’) and three types of MBONs (‘susceptible’, ‘restrained’, and ‘LTM’) for each of the two opposing motivational states. We demonstrate that the neural responses generated by this model during an aversive olfactory learning paradigm replicate those observed in the animal; and that simulated flies equipped with the IC generate learned odour preferences comparable to real flies. Finally, we suggest that such a model could work as a motif that extends the set of motivations from binary (e.g., avoidance vs. attraction) to a spectrum of motivations whose capabilities are equivalent to ‘decision-making’ in mammals.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>The dopaminergic plasticity rule</title><p>We implement a novel dopaminergic plasticity rule (DPR) to update the KC→MBON synaptic weights proportionally to the dopamine level, KC activity, and current state of the synaptic weight with respect to its default (rest) value. Our DPR is based on recent findings regarding the role of dopamine (and co-transmitters) in altering synaptic efficacy in the fruit fly MB (see methods section ‘Derivation of the dopaminergic plasticity rule’). Instead of calculating the error between the reinforcement and its prediction, DPR uses the reinforcement to maximise the separation between the synaptic weights of reinforced inputs, which is functionally closer to the information maximisation theory (<xref ref-type="bibr" rid="bib12">Bell and Sejnowski, 1995</xref>; <xref ref-type="bibr" rid="bib52">Lee et al., 1999</xref>; <xref ref-type="bibr" rid="bib58">Lulham et al., 2011</xref>) than the RPE principle. While this rule, in combination with some specific types of circuits, can result in the prediction of reinforcements, it can also support a more flexible range of responses to stimulus-reinforcement contingencies, as we will show in what follows.</p><p>The dopaminergic learning rule is written formally as<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the change in the synaptic weight connecting a KC, <italic>i</italic>, to an MBON, <inline-formula><mml:math id="inf2"><mml:mi>j</mml:mi></mml:math></inline-formula>. The KC→MBON synaptic weight, <inline-formula><mml:math id="inf3"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and the KC response, <inline-formula><mml:math id="inf4"><mml:mrow><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, have a lower bound of 0, while the resting weight, <inline-formula><mml:math id="inf5"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mtext>rest</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, is a fixed parameter. The rule alters the connection weight between each KC and MBON on each time-step depending on the <italic>dopaminergic factor</italic>, <inline-formula><mml:math id="inf6"><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which is determined by the responses of the DANs targeting this MBON. The dopaminergic factor can be positive [<inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>] or negative [<inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>], which we motivate from recent observations of the differential roles in synaptic plasticity of DopR1 and DopR2 receptors (<xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>), as detailed in ‘Materials and methods’. When combined with two possible states of KC activity (active or inactive), this results in four different plasticity effects: <italic>depression</italic>, <italic>potentiation</italic>, <italic>recovery,</italic> and <italic>saturation</italic>.</p><p>These effects can be inferred directly from <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. If the dopaminergic factor is zero (contributing DANs are inactive or mutually cancelling), no learning occurs. If the dopaminergic factor is negative and the KC is active (positive), the KC→MBON synaptic weight is decreased (<italic>depression</italic> effect of the plasticity rule, see <xref ref-type="fig" rid="fig2">Figure 2A</xref>). However, if the synaptic weight is already low, the synaptic weight cannot change further. The <italic>recovery</italic> effect takes place when the dopaminergic factor is negative and the KC is inactive (<inline-formula><mml:math id="inf9"><mml:mrow><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), in which case the synaptic weights tend to reset to the resting weight (see <xref ref-type="fig" rid="fig2">Figure 2C</xref>). When the dopaminergic factor is positive and the KC is active, we have the <italic>potentiation</italic> effect, which causes an increase in the synaptic weights (see <xref ref-type="fig" rid="fig2">Figure 2B</xref>). In contrast to the depression effect, as the synaptic weight becomes stronger, it further enhances this effect. If the KC is inactive and the dopaminergic factor is positive, then we have the <italic>saturation</italic> effect, where if the current synaptic weight is higher than its resting weight, the synaptic weight continues to increase, while if it is lower then it continues to decrease (see <xref ref-type="fig" rid="fig2">Figure 2D</xref>). This effect enhances diversity in the responses of the MBON to the different past and current CS experiences, which is essential for memory consolidation (i.e., continued strengthening of a memory) and the formation of long-term memories (i.e., slower acquisition and resistance to further change).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>The different effects of the dopaminergic plasticity rule, depending on the activity of the Kenyon cell (KC) (orange indicates active) and the sign of the dopaminergic factor (white arrowheads in dots).</title><p>The dopaminergic plasticity rule (DPR) can cause four different effects that work in harmony or discord to maximise the information captured in each experience and allow different types of memories to be formed for each KC→MBON synapse. In each box, time-step <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mtext>pre</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> shows the initial KC→MBON synaptic weights (thickness of the arrows); electric shock activates the DAN in time-step <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mtext>learn</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> causing modulation of the synaptic weights (red: increase; blue: decrease), while time-step <inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mtext>post</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> shows the synaptic weights after the shock delivery. (<bold>A</bold>) Example of the <italic>depression effect</italic> – the synaptic weight decreases when <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and the KC is active. (<bold>B</bold>) Example of the <italic>potentiation effect</italic> – the synaptic weight increases when <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and the KC is active. (<bold>C</bold>) Example of the <italic>recovery effect</italic> – the synaptic weight increases when <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and the KC is inactive. (<bold>D</bold>) Example of the <italic>saturation effect</italic> – the synaptic weight increases further (when <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>rest</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) or decreases further (when <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>rest</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) when <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and the KC is inactive. MBON: mushroom body output neuron.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig2-v1.tif"/></fig><p>The different effects described above can work together in single KC→MBON synapses (i.e., through the influence of multiple DANs), leading to more complicated effects like the formation of short-term memories (e.g., combining the depression/potentiation and recovery effects) or long-term memories (e.g., combining the potentiation and saturation effects). However, we will see that by adding MBON→DAN feedback connections a very wide range of circuit properties can be implemented. We next introduce a set of microcircuits that have been found in the fruit fly MBs and describe how they could interlock and interact in one IC to control the motivation and hence the behaviour of the animal.</p></sec><sec id="s2-2"><title>The incentive circuit</title><p>What we call the IC is a circuit in the MB of the fruit fly <italic>D. melanogaster</italic> that allows complicated memory dynamics through self-motivation. We have identified and modelled this circuit (shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>) which consists of six MBONs that receive KC input and six DANs that modulate the KC-MBON connections. The circuit includes some MBON-MBON connections and some feedback connections from MBONs to DANs. All the neurons and connections in this circuit are mapped to identified connectivity in the MB as summarised in <xref ref-type="table" rid="table1">Table 1</xref>. We will describe each of the microcircuits and the biological justification for their assumed function in detail below, but here we provide an initial overview of the IC function.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>The incentive circuit (IC) integrates the different microcircuits of the mushroom body into a unified model allowing the expression of more complicated behaviours and memory dynamics.</title><p>It combines the susceptible, restrained, reciprocal short- and long-term memories and the memory assimilation mechanism microcircuits in one circuit that is able to form, consolidate, and forget different types of memories that motivate the animal to take actions. <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>d</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>: avoidance- and attraction-driving discharging dopaminergic neurons (DANs); <inline-formula><mml:math id="inf21"><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf22"><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>: avoidance- and attraction-driving charging DANs; <inline-formula><mml:math id="inf23"><mml:msub><mml:mi>f</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>f</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>: avoidance- and attraction-driving forgetting DANs; <inline-formula><mml:math id="inf25"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>: avoidance- and attraction-driving susceptible mushroom body output neurons (MBONs); <inline-formula><mml:math id="inf27"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>: avoidance- and attraction-driving restrained MBONs; <inline-formula><mml:math id="inf29"><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>: avoidance- and attraction-driving long-term memory MBONs.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Experimental data from <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref> modified to include the predicted neuron types.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-75611-fig3-data1-v1.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Behaviour generated by the model correlates with 92 experiments reported in <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref>.</title><p>Testing the performance of the incentive circuit in the experiments of <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref>, Figure 5, <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref> collected behavioural data (<inline-formula><mml:math id="inf31"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula> measure) from 92 experiments, summarised in <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>, and calculated their correlation coefficient to the behaviour produced by their model (VSλmodel: <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.68</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; MV model: <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.65</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). The behavioural data involve intervention (e.g., activation or silencing) in different mushroom body output neurons (MBONs) or dopaminergic neurons (DANs), which are grouped by colour codes. Here we use the same colour codes as in the original paper for convenience. For the details of this analysis, please refer to <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref>. We test the behaviour of the incentive circuit when using two different learning rules: (<bold>A</bold>) the dopaminergic plasticity rule <italic>(</italic>DPR) and (<bold>B</bold>) the reward prediction error (RPE). As we do not know what type the intervened MBON or DAN is, we test for all the types (and groups of them) and report the ones with the highest correlation under the ‘Best fit’ plot. We also try to guess the type by the identity of the neuron (or group of neurons) intervened and report the correlation coefficient under the ‘Selected neuron types’ plot. The types selected for each experiment can also be found in <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>. (<bold>C</bold>) Examples of the genetic intervention as coloured in (<bold>A</bold>) and (<bold>B</bold>). We run 10 trials of odour A + shock or sugar (indicated with a thunder or cubes, respectively) or without reinforcement (absence of thunder and sugar cubes), followed by 10 trials of odour B without reinforcement (acquisition phase). Then we proceed with two trials of testing odour A vs. odour B (extinction phase). In addition, we model genetic intervention by targeting selected neurons of our model and silence them via the shibire blockage or excite them through the dTrpA1 channel (timing of the intervention is shown by the coloured lines). The colours of the lines correspond to the different examples of the coloured samples of (<bold>A</bold>) and (<bold>B</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig3-figsupp1-v1.tif"/></fig></fig-group><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Connections among neurons in the <italic>Drosophila</italic> mushroom body mapped to the connections of the incentive circuit.</title><p>Connection types: ‘⊸’, modulates the synaptic weights of the KC→MBON connections terminating in that MBON; ‘→’, excitatory connection; ‘⊣’, inhibitory connection. Microcircuit – SM: susceptible memory; RM: restrained memory; RSM: reciprocal short-term memories; LTM: long-term memory; RLM: reciprocal long-term memories; MAM: memory assimilation mechanism. Evidence – A: anatomical connection is known (i.e., using light or electron microscopy); F: functional connection is known (i.e., whether activating the presynaptic neuron leads to an excitatory or inhibitory effect on the postsynaptic neuron and/or the neurotransmitter released by the presynaptic neuron); KC: Kenyon cell; MBON: mushroom body output neuron; IC: incentive circuit.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Connection in the MB</th><th align="left" valign="bottom">Connection in the IC</th><th align="left" valign="bottom">Microcircuit</th><th align="left" valign="bottom">Evidence</th><th align="left" valign="bottom">References</th></tr></thead><tbody><tr><td align="left" valign="bottom">PPL1-γ1ped ⊸ MBON-γ1ped</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf36"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>d</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊸</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">SM</td><td align="left" valign="bottom">A, F</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>; <xref ref-type="bibr" rid="bib70">Pavlowsky et al., 2018</xref></td></tr><tr><td align="left" valign="bottom">MBON-γ1ped ⊣ PPL1-γ1ped</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf37"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊣</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">SM</td><td align="left" valign="bottom">A, F</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>; <xref ref-type="bibr" rid="bib70">Pavlowsky et al., 2018</xref></td></tr><tr><td align="left" valign="bottom">PAM-γ4&lt;γ1γ2 ⊸ MBON-γ4&gt;γ1γ2</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf38"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>d</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊸</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">SM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref></td></tr><tr><td align="left" valign="bottom">MBON-γ4&gt;γ1γ2 ⊣ PAM-γ4&lt;γ1γ2</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf39"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊣</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">SM</td><td align="left" valign="bottom">A, F</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>; <xref ref-type="bibr" rid="bib23">Cohn et al., 2015</xref></td></tr><tr><td align="left" valign="bottom">MBON-γ1ped ⊣ MBON-γ5β′2a</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf40"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊣</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RM</td><td align="left" valign="bottom">A, F</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>; <xref ref-type="bibr" rid="bib34">Felsenberg et al., 2018</xref></td></tr><tr><td align="left" valign="bottom">MBON-γ4&gt;γ1γ2 ⊣ MBON-γ2α′1</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf41"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊣</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref></td></tr><tr><td align="left" valign="bottom">PPL1-γ2α’1<sub>2</sub> ⊸ MBON-γ2α′1</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf42"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊸</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RSM</td><td align="left" valign="bottom">A, F</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>; <xref ref-type="bibr" rid="bib63">McCurdy et al., 2021</xref></td></tr><tr><td align="left" valign="bottom">MBON-γ2α′1 → PAM-β′2a</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf43"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">→</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RSM</td><td align="left" valign="bottom">A, F</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>; <xref ref-type="bibr" rid="bib63">McCurdy et al., 2021</xref></td></tr><tr><td align="left" valign="bottom">PAM-β′2a ⊸ MBON-γ5β′2a</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf44"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊸</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RSM</td><td align="left" valign="bottom">A, F</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>; <xref ref-type="bibr" rid="bib63">McCurdy et al., 2021</xref></td></tr><tr><td align="left" valign="bottom">MBON-γ5β′2a → PPL1-γ2α’1<sub>2</sub></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf45"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">→</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RSM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib53">Li et al., 2020</xref></td></tr><tr><td align="left" valign="bottom">PPL1-γ2α’1<sub>2</sub> ⊸ MBON-α’1</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf46"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊸</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">LTM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref></td></tr><tr><td align="left" valign="bottom">MBON-α’1 → PPL1-γ2α’1<sub>2</sub></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf47"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">→</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">LTM</td><td align="left" valign="bottom">A</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>; <xref ref-type="bibr" rid="bib53">Li et al., 2020</xref></td></tr><tr><td align="left" valign="bottom">PAM-β’2a ⊸ MBON-β2β′2a</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf48"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊸</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">LTM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref></td></tr><tr><td align="left" valign="bottom">MBON-β2β′2 a → PAM-β′2a</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf49"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">→</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">LTM</td><td align="left" valign="bottom">A</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>; <xref ref-type="bibr" rid="bib53">Li et al., 2020</xref></td></tr><tr><td align="left" valign="bottom">PPL1-γ2α’1<sub>1</sub> ⊸ MBON-α’1</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf50"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>f</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊸</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RLM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref></td></tr><tr><td align="left" valign="bottom">MBON-α’1 → PAM-β2β′2a</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf51"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">→</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RLM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib53">Li et al., 2020</xref></td></tr><tr><td align="left" valign="bottom">PAM-β2β′2a ⊸ MBON-β2β′2a</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf52"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>f</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊸</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RLM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref></td></tr><tr><td align="left" valign="bottom">MBON-β2β′2a → PPL1-γ2α’1<sub>1</sub></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf53"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">→</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">RLM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib53">Li et al., 2020</xref></td></tr><tr><td align="left" valign="bottom">PPL1-γ2α’1<sub>1</sub> ⊸ MBON-γ2α’1</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf54"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>f</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊸</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">MAM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref></td></tr><tr><td align="left" valign="bottom">PAM-β2β′2a ⊸ MBON-γ5β′2a</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf55"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi>f</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mpadded><mml:mo rspace="5.8pt">⊸</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">MAM</td><td align="left" valign="bottom">A</td><td align="char" char="." valign="bottom"><xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref></td></tr></tbody></table></table-wrap><p>As presented in <xref ref-type="fig" rid="fig3">Figure 3</xref>, for each motivation (attraction or avoidance), the IC has three types of MBON — susceptible, restrained, and LTM — and three types of DAN — discharging, charging, and forgetting. More specifically, working from the outer edges of the model, we have ‘discharging’ DANs that respond to punishment (left side) or reward (right side) and influence the ‘susceptible’ MBONs, which by default respond to all KC inputs (not shown). These in turn inhibit the responses of the ‘restrained’ MBONs of opposite valence. When the discharging DANs depress the response of the susceptible MBONs of opposite valence, they release the restrained MBONs of the same valence, and also decrease the inhibitory feedback to the discharging DANs from the susceptible MBONs. The restrained MBONs activate their respective ‘charging’ DANs, which start to potentiate the LTM MBONs of the same valence, while also depressing the response (to KC input) of the restrained MBON of opposite valence. Similarly, the LTM MBONs enhance the activity of the charging DANs, increasing the momentum of LTM, while simultaneously activating their respective ‘forgetting’ DANs, to decrease the momentum of the opposite valence LTM. The forgetting DANs also depress the restrained MBONs, which makes space for the acquisition of new memories while preserving old ones.</p><p>In the following sections, we show in detail how each simulated neuron of this circuit responds during acquisition and forgetting in the aversive olfactory conditioning paradigm shown in <xref ref-type="fig" rid="fig4">Figure 4</xref> and compare this to observed responses in the corresponding identified neurons in the fly from calcium imaging under the same paradigm. We then describe the behaviour of simulated flies under the control of this circuit and learning rule in a naturalistic setting with two odour gradients, paired singly or jointly with punishment or reward. By using more abstracted behavioural modelling, following the approach of <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref>, we are also able to create closely matching results for 92 different olfactory conditioning intervention experiments, that is, the observed effects on fly learning of silencing or activating specific neurons (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, <inline-formula><mml:math id="inf56"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula> of the model and experiments are correlated with correlation coefficient <inline-formula><mml:math id="inf57"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.76</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2.2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Description of the experimental setup and the aversive olfactory conditioning paradigms.</title><p>(<bold>A</bold>) Setup for visualising neural activity via Ca<sup>2+</sup> imaging during aversive olfactory memory acquisition and reversal. Flies are head-fixed and cuticle dissected for ratiometric imaging of Ca<sup>2+</sup>-sensitive GCaMP6f and Ca<sup>2+</sup>-insensitive tdTomato. (<bold>B</bold>) The aversive olfactory conditioning experimental paradigm. 5 s presentations of odours A (3-octanol [OCT]; coloured pink) and B (4-methylcyclohexanol [MCH]; coloured yellow) continuously alternate, separated by fresh air, while the shock input (100 ms of 120 V) forms the different phases: one repeat of pre-training, where no shock is delivered; five repeats of acquisition, where shock (thin red line) is delivered in the last second of odour B; two repeats of reversal where shock is paired with odour A. (<bold>C</bold>) Abstract representation of the computational model as an electronic chip. The model receives the conditional (odour) and unconditional stimuli (electric shock) and produces the dopaminergic neuron (DAN) and mushroom body output neuron (MBON) responses using the incentive circuit and the dopaminergic plasticity rule. (<bold>D</bold>) The aversive olfactory conditioning experimental paradigm modified for testing the model. Odours A (coloured pink) and B (coloured yellow) are presented for two time-steps each, in alternation, separated by one time-step fresh air, while the shock input forms the different phases and forgetting conditions: one repeat of pre-training, where no shock is delivered; five repeats of acquisition, where shock is delivered in the second time-step of odour B; five repeats of forgetting that can be either extinction (lightest shade of odour colour) where shock is not presented, unpaired (mid shade of odour colour) where shock (thin red line) is paired with the fresh air ‘break’, or reversal (dark shade of odour colour) where shock is paired with odour A.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Imaging data of all the recorded neurons in the <italic>Drosophila melanogaster</italic> mushroom body.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-75611-fig4-data1-v1.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>The responses from all the recorded neurons in the <italic>Drosophila melanogaster</italic> mushroom body during the experiment described in <xref ref-type="fig" rid="fig4">Figure 4B</xref>.</title><p>In each row, we present the driver of the recorded neurons and a schematic representation of where they innervate the mushroom body; the median responses of the neuron for each odour (coloured as pink for odour A or yellow for odour B) over a number of flies, denoted as <inline-formula><mml:math id="inf58"><mml:mi>n</mml:mi></mml:math></inline-formula>, and the 25% and 75% quantiles marked by the coloured region.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig4-figsupp1-v1.tif"/></fig></fig-group></sec><sec id="s2-3"><title>Microcircuits of the mushroom body</title><sec id="s2-3-1"><title>Susceptible and restrained memories</title><p><xref ref-type="bibr" rid="bib70">Pavlowsky et al., 2018</xref> identified a microcircuit in the MB, where a punishment-encoding DAN (PPL1-γ1pedc) depresses the KC synapses onto an attraction-driving MBON (MBON-γ1pedc&gt;α/β), which in turn inhibits the same DAN. They argue that this is a memory consolidation mechanism as the drop in the MBON response will reduce its inhibition of the DAN, enhancing the formation of the memory if the same odour-punishment pairing is continued. <xref ref-type="bibr" rid="bib34">Felsenberg et al., 2018</xref> further showed that the same MBON directly inhibits an avoidance-driving MBON (MBON-γ5β′2a), such that its activity increases (driving avoidance) after punishment as the inhibition is released. <xref ref-type="fig" rid="fig5">Figure 5A</xref> shows these neurons in the MB and <xref ref-type="fig" rid="fig5">Figure 5B</xref> a schematic representation of their interconnections. Note that the MBON⊣MBON inhibition is not reciprocal, rather we assume (see <xref ref-type="fig" rid="fig3">Figure 3</xref> and below) that there is a different microcircuit in which an avoidance-driving MBON inhibits an attraction-driving MBON. <xref ref-type="fig" rid="fig5">Figure 5C–E</xref> shows the responses of these neurons from experimental data (left) and from our model (right) during aversive conditioning (the paradigm shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>), which follow a similar pattern.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>The susceptible and restrained microcircuits of the mushroom body.</title><p>(<bold>A</bold>) Image of the attraction-driving susceptible and avoidance-driving restrained memory microcircuits made of the PPL1-γ1pedc, MBON-γ1pedc, and MBON-γ5β′2a neurons – created using the Virtual Fly Brain software (<xref ref-type="bibr" rid="bib66">Milyaev et al., 2012</xref>). (<bold>B</bold>) Schematic representation of the susceptible and restrained memories microcircuits connected via the susceptible mushroom body output neuron (MBON). The responses of (<bold>C</bold>) the punishment-encoding discharging dopaminergic neuron (DAN), <inline-formula><mml:math id="inf59"><mml:msub><mml:mi>d</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>D</bold>) the attraction-driving susceptible MBON, <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>E</bold>) the avoidance-driving restrained MBON, <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>The avoidance-driving susceptible memory, attraction-driving restrained memory, and their responses.</title><p>The susceptible and restrained microcircuits of the mushroom body. (<bold>A</bold>) Image of the avoidance-driving susceptible and attraction-driving restrained memory microcircuits made of the PAM-γ4γ1γ2 and MBON-γ2α′1 neurons – created using the Virtual Fly Brain software (<xref ref-type="bibr" rid="bib66">Milyaev et al., 2012</xref>). (<bold>B</bold>) Schematic representation of the susceptible and restrained memories microcircuits connected via the susceptible mushroom body output neuron (MBON). The responses of (<bold>C</bold>) the reward-encoding discharging dopaminergic neuron (DAN), <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>d</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>D</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>E</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig5-figsupp1-v1.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>The responses of the neurons of the incentive circuit using the connections introduced so far of the susceptible memory (SM) and restrained memory (RM) microcircuits.</title><p>The responses of (<bold>A</bold>) the punishment-encoding discharging dopaminergic neuron (DAN), <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>d</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>B</bold>) the attraction-driving susceptible mushroom body output neuron (MBON), <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>C</bold>) the avoidance-driving restrained MBON, <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>D</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>E</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf69"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>F</bold>) the reward-encoding discharging DAN, <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>d</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. The first row of responses (coloured pink) corresponds to responses associated with odour A, and the second (coloured yellow) to those associated with odour B. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig5-figsupp2-v1.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>The KC→MBON synaptic weights of the neurons of the incentive circuit using the connections introduced so far of the susceptible memory (SM) and restrained memory (RM) microcircuits.</title><p>The synaptic weights of (<bold>A</bold>) the attraction-driving susceptible mushroom body output neuron (MBON), <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>B</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf72"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>C</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf73"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>D</bold>) the avoidance-driving restrained MBON, <inline-formula><mml:math id="inf74"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. The first row of weights (coloured pink) corresponds to Kenyon cells (KCs) associated with odour A, the second (coloured yellow) to KCs associated with odour B, and the third (coloured orange) to KCs associated with both odours. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig5-figsupp3-v1.tif"/></fig></fig-group><p>Learning in this circuit is shown by the sharp drop (in both experimental data and model) of the response of MBON-γ1pedc&gt;α/β (<xref ref-type="fig" rid="fig5">Figure 5D</xref>) to odour B already from the second trial of the acquisition phase. There is a similar drop in the response to odour A in the reversal phase. This rapid decrease is due to the depressing effect of the DAN on the KC→MBON synaptic weight. Note that we name this a ‘discharging’ DAN as the target synaptic strengths are high or ‘charged’ by default. However, due to our plasticity rule, if the unconditional stimuli (US) subsequently occurs without the CS (see unpaired phase in the model, for which we do not have experimental data), the MBON synaptic weights reset due to the recovery effect (see <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3A</xref>, odour B). This is consistent with the high learning rate and low retention time observed in <xref ref-type="bibr" rid="bib7">Aso and Rubin, 2016</xref>, and it results in a memory that is easily created and erased: a ‘susceptible memory’ (SM). The response of MBON-γ5β′2a (<xref ref-type="fig" rid="fig5">Figure 5E</xref>) can be observed to have the opposite pattern, that is, it starts to respond to odour B from the second trial of acquisition as it is no longer ‘restrained’. Note, however, that the response it expresses, when the restraint is removed, also depends on its own synaptic weights for KC input, which, as we will see, may be affected by other elements in the IC. In <xref ref-type="fig" rid="fig5">Figure 5C</xref>, the experimental data shows a slight drop in the shock response (first paired with odour B, then with odour A) of the DAN, PPL1-γ1pedc, during the whole experiment, although it remains active throughout. We assume that this drop may reflect a sensory adaptation to shock but have not included it in our model. Consequently, the model data shows a positive feedback effect: the DAN causes depression of the MBON response to odour, reducing inhibition of the DAN, which increases its response, causing even further depression in the MBON. Note that this is opposite to the expected effects of reward prediction error.</p><p>Similar microcircuits in the MB can be extracted from the connectome described in <xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref> and <xref ref-type="bibr" rid="bib53">Li et al., 2020</xref> (also identified in larvae; <xref ref-type="bibr" rid="bib30">Eichler et al., 2017</xref>). This leads us to the assumption that there are exactly corresponding susceptible and restrained memory microcircuits with opposite valence, that is, a reward-encoding DAN that discharges the response to odour of an avoidance-driving MBON, which in turn releases its restraint on an attraction-driving MBON (see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B</xref> and right side of the IC in <xref ref-type="fig" rid="fig3">Figure 3</xref>, which mirrors the left side, with opposite valence). We further suggest specific identities for the neurons forming this circuit: PAM-γ4&lt;γ1γ2 as the reward-encoding discharging DAN; MBON-γ4&gt;γ1γ2 as the avoidance-driving susceptible MBON; and MBON-γ2α’1 as the attraction-driving restrained MBON (see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref>). The latter identification is based on the possibility of inhibiting connections from MBONs in the γ4 compartment to the ones in the γ2 compartment suggested by <xref ref-type="bibr" rid="bib8">Aso et al., 2019</xref> and <xref ref-type="bibr" rid="bib23">Cohn et al., 2015</xref>. Although MBON-γ4&gt;γ1γ2 is characterised by the glutamate neurotransmitter, it is possible that it can inhibit MBON-γ2α′1 through glutamate-gated chloride channels (<xref ref-type="bibr" rid="bib22">Cleland, 1996</xref>; <xref ref-type="bibr" rid="bib57">Liu and Wilson, 2013</xref>; <xref ref-type="bibr" rid="bib62">McCarthy et al., 2011</xref>).</p></sec><sec id="s2-3-2"><title>Reciprocal short-term memories</title><p><xref ref-type="bibr" rid="bib63">McCurdy et al., 2021</xref> suggest that the attraction-driving restrained MBON in the previous circuit (MBON-γ2α′1) indirectly decreases the synaptic weights from KCs to the avoidance-driving restrained MBON (MBON-γ5β′2a) via an attraction-encoding DAN (PAM-β′2a). This microcircuit is also supported by <xref ref-type="bibr" rid="bib34">Felsenberg et al., 2018</xref> and <xref ref-type="bibr" rid="bib14">Berry et al., 2018</xref>. <xref ref-type="bibr" rid="bib23">Cohn et al., 2015</xref> and <xref ref-type="bibr" rid="bib53">Li et al., 2020</xref> suggest that the corresponding avoidance-driving restrained MBON (MBON-γ5β′2a) excites an avoidance-encoding DAN (PPL1-γ2α′1), which closes the loop by affecting the KC connections to the attraction-driving restrained MBON, forming what we call the ‘reciprocal short-term memories’ microcircuit as shown in <xref ref-type="fig" rid="fig6">Figure 6A</xref> (actual neurons in the MBs) and <xref ref-type="fig" rid="fig6">Figure 6B</xref> (schematic representation of the described connections).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>The reciprocal short-term memories microcircuit of the mushroom body.</title><p>(<bold>A</bold>) Image of the reciprocal short-term memories microcircuit made of the MBON-γ5β′2a, PAM-β′2a, PPL1-γ2α′1, and MBON-γ2α′1 neurons – created using the Virtual Fly Brain software (<xref ref-type="bibr" rid="bib66">Milyaev et al., 2012</xref>). (<bold>B</bold>) Schematic representation of the reciprocal short-term memories microcircuit (coloured) connected to the susceptible memories via the restrained mushroom body output neurons (MBONs). The responses of (<bold>C</bold>) the punishment-encoding charging dopaminergic neuron (DAN), <inline-formula><mml:math id="inf75"><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, the (<bold>D</bold>) attraction-driving restrained MBON, <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>E</bold>) the reward-encoding charging DAN, <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>The responses of the neurons of the incentive circuit using the connections introduced so far of the susceptible memory (SM), restrained memory (RM), and reciprocal short-term memory (RSM) microcircuits.</title><p>The responses of (<bold>A</bold>) the punishment-encoding discharging dopaminergic neuron (DAN), <inline-formula><mml:math id="inf78"><mml:msub><mml:mi>d</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>B</bold>) the attraction-driving susceptible mushroom body output neuron (MBON), <inline-formula><mml:math id="inf79"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>C</bold>) the avoidance-driving restrained MBON, <inline-formula><mml:math id="inf80"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>D</bold>) the reward-encoding charging DAN, <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>E</bold>) the reward-encoding discharging DAN, <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>d</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>F</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf83"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>G</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>H</bold>) the punishment-encoding charging DAN, <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. The first row of responses (coloured pink) corresponds to responses associated with odour A, and the second (coloured yellow) to those associated with odour B. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig6-figsupp1-v1.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>The KC→MBON synaptic weights of the neurons of the incentive circuit using the connections introduced so far of the susceptible memory (SM), restrained memory (RM), and reciprocal short-term memory (RSM) microcircuits.</title><p>The synaptic weights of (<bold>A</bold>) the attraction-driving susceptible mushroom body output neuron (MBON), <inline-formula><mml:math id="inf86"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>B</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf87"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>C</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf88"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>D</bold>) the avoidance-driving restrained MBON, <inline-formula><mml:math id="inf89"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. The first row of weights (coloured pink) corresponds to Kenyon cells (KCs) associated with odour A, the second (coloured yellow) to KCs associated with odour B, and the third (coloured orange) to KCs associated with both odours. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig6-figsupp2-v1.tif"/></fig></fig-group><p>The ‘charging’ DANs, PAM-β′2a and PPL1-γ2α′1 (named after their long-term memory charging property, i.e., potentiation effect on another KC→MBON synapse, as we describe in the long-term memory microcircuit section), should be activated directly by reinforcement as well as the restrained MBONs. This allows for memories to be affected directly by the reinforcement, but also by the expression of the opposite valence memories. The latter feature keeps the balance between the memories by automatically erasing a memory when a memory of the opposite valence starts building up and results in the balanced learning rate and retention time as observed in <xref ref-type="bibr" rid="bib7">Aso and Rubin, 2016</xref>. Because the memories in this pair of restrained MBONs are very fragile, we predict that these MBONs store short-term memories.</p><p>The effects of this circuit, as shown in <xref ref-type="fig" rid="fig6">Figure 6C–E</xref>, are relatively subtle. During acquisition, the shock activates the punishment-encoding charging DAN (see <xref ref-type="fig" rid="fig6">Figure 6C</xref>), which decreases the synaptic weights of the KC onto the attraction-driving restrained MBON (see <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2C</xref>), but this cannot be seen in <xref ref-type="fig" rid="fig6">Figure 6D</xref> because this MBON is already strongly inhibited (i.e., by the avoidance-driving susceptible MBON). This low response means that the opposing reward-encoding charging DAN <xref ref-type="fig" rid="fig6">Figure 6E</xref> is largely unaffected for this conditioning paradigm. In our model, the non-zero activity level of this DAN is a consequence of input from the LTM microcircuit which we describe next and the activation is similar for both odours because our network starts in a balanced state (no preference for either odour). The different response to the two odours seen in the experimental data might therefore represent an unbalanced starting state of its LTM for these odours due to previous experiences of the fly.</p></sec><sec id="s2-3-3"><title>Long-term memory</title><p><xref ref-type="bibr" rid="bib44">Ichinose et al., 2015</xref> describe a microcircuit where a reward-encoding DAN (PAM-α1) potentiates the KC→MBON synapses of MBON-α1, and MBON-α1 in turn excites PAM-α1. Using data from <xref ref-type="bibr" rid="bib53">Li et al., 2020</xref>, we find numerous similar microcircuits, and in particular, MBONs that appear to have this recurrent arrangement of connectivity to the ‘charging’ DANs we have introduced to the circuit in the previous section. Specifically, we assume that the reward-encoding charging DAN (PAM-β′2a) can potentiate the response of the attraction-driving MBON-β2β′2a; and similarly the punishment-encoding charging DAN (PPL1-γ2α′1) potentiates the avoidance-driving MBON-α′1 (see <xref ref-type="fig" rid="fig7">Figure 7A and B</xref>; <xref ref-type="fig" rid="fig7">Figure 7C</xref> shows these connections schematically, with the KCs omitted for convenience). Crucially, these connections form positive feedback circuits — the DAN potentiates the response of the MBON to the odour, which increases its excitation of the DAN. As a consequence, even when the reinforcement ceases, the learning momentum can continue — this is the saturation effect of the learning rule (see <xref ref-type="fig" rid="fig2">Figure 2D</xref>) and results in long-term memory consolidation and enhancement.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>The long-term memory microcircuits of the mushroom body.</title><p>(<bold>A</bold>) Image of the avoidance-encoding long-term memory microcircuit made of the MBON-α′1 and PPL1-γ2α′1 – created using the Virtual Fly Brain software (<xref ref-type="bibr" rid="bib66">Milyaev et al., 2012</xref>). (<bold>B</bold>) Schematic representation of the long-term memory microcircuits (coloured) connected to the reciprocal short-term memory (RSM) via the charging dopaminergic neurons (DANs). (<bold>C</bold>) Image of the attraction-encoding long-term memory microcircuit made of the MBON-β2β′2a and PAM-β2a – created using the Virtual Fly Brain software (<xref ref-type="bibr" rid="bib66">Milyaev et al., 2012</xref>). The responses of the (<bold>D</bold>) avoidance-driving long-term memory mushroom body output neuron (MBON), <inline-formula><mml:math id="inf90"><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>E</bold>) the attraction-driving long-term memory MBON, <inline-formula><mml:math id="inf91"><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>The responses of the neurons of the incentive circuit using the connections introduced so far of the susceptible memory (SM), restrained memory (RM), reciprocal short-term memory (RSM), and long-term memory (LTM) microcircuits.</title><p>The responses of (<bold>A</bold>) the punishment-encoding discharging dopaminergic neuron (DAN), <inline-formula><mml:math id="inf92"><mml:msub><mml:mi>d</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>B</bold>) the attraction-driving susceptible mushroom body output neuron (MBON), <inline-formula><mml:math id="inf93"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>C</bold>) the avoidance-driving restrained MBON, <inline-formula><mml:math id="inf94"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>D</bold>) the reward-encoding charging DAN, <inline-formula><mml:math id="inf95"><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>E</bold>) the attraction-driving LTM MBON, <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>F</bold>) the reward-encoding discharging DAN, <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>d</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>G</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf98"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>H</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf99"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>I</bold>) the punishment-encoding charging DAN, <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>J</bold>) the avoidance-driving LTM MBON, <inline-formula><mml:math id="inf101"><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. The first row of responses (coloured pink) corresponds to responses associated with odour A, and the second (coloured yellow) to those associated with odour B. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig7-figsupp1-v1.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>The KC→MBON synaptic weights of the neurons of the incentive circuit using the connections introduced so far of the susceptible memory (SM), restrained memory (RM), reciprocal short-term memory (RSM), and long-term memory (LTM) microcircuits.</title><p>The synaptic weights of (<bold>A</bold>) the attraction-driving susceptible mushroom body output neuron (MBON), <inline-formula><mml:math id="inf102"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>B</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf103"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>C</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf104"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>D</bold>) the avoidance-driving restrained MBON, <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>E</bold>) the attraction-driving LTM MBON, <inline-formula><mml:math id="inf106"><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>F</bold>) the avoidance-driving LTM MBON, <inline-formula><mml:math id="inf107"><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. The first row of weights (coloured pink) corresponds to Kenyon cells (KCs) associated with odour A, the second (coloured yellow) to KCs associated with odour B, and the third (coloured orange) to KCs associated with both odours. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig7-figsupp2-v1.tif"/></fig></fig-group><p><xref ref-type="fig" rid="fig7">Figure 7D</xref> (right) demonstrates the charging of the avoidance-driving LTM MBON during the acquisition (for odour B) and its continued increase during the forgetting phases. However, these trends are not evident in the experimental data as illustrated in <xref ref-type="fig" rid="fig7">Figure 7D</xref> (left). We suggest this is because responses of LTM neurons depend on the overall experience of the animal and are thus hard to predict during one experiment. For example, it could be the case that the animal has already built some long-term avoidance memory for odour A, such that its presentation without reinforcement in our experiment continues its learning momentum, leading to the observed increasing response. Note that the decreasing response to odour A during acquisition in the model, as well as the observed effects in <xref ref-type="fig" rid="fig7">Figure 7E</xref> for the attraction-driving LTM MBON, is due to influence from additional microcircuits to be described in the next section. <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref> shows the responses of these neurons using only the microcircuits that have been introduced so far. In this case, the responses of both LTM MBONs saturate instantly, which shows that another mechanism must exist and regulate them in order for them to become useful for the behaviour of the animal.</p></sec><sec id="s2-3-4"><title>Reciprocal long-term memories</title><p>As described so far, once the LTM microcircuit begins to charge, it will have a self-sustaining increase in the weights during odour delivery, preventing any subsequent adaptation to altered reward contingencies. To allow these weights to decrease, specifically, to decrease in response to charging of the LTM of opposite valence, we connect the two LTM MBONs via respective ‘forgetting’ DANs (see <xref ref-type="fig" rid="fig8">Figure 8B</xref>). Note that these forgetting DANs do not receive any direct reinforcement signals. Instead, as long as an LTM MBON is active, its respective forgetting DAN is also active and causes synaptic depression for the opposite LTM MBON (forgetting the learnt memory; see <xref ref-type="fig" rid="fig8">Figure 8C and D</xref>). This counteracts any potentiation effect due to the LTM MBON’s respective charging DAN (see <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1E and F</xref>). As a consequence, sustained reinforcement of one valence can gradually overcome the positive feedback of the LTM circuit of opposite valence, causing the charging momentum to drop and eventually negate. The LTMs are thus in long-term competition.</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>The reciprocal long-term memories microcircuit of the mushroom body.</title><p>(<bold>A</bold>) Image of the reciprocal long-term memory microcircuit in the mushroom body made of the MBON-α′1, PAM-β2β′2a, MBON-β2β′2a, and PPL1-γ2α′1 – created using the Virtual Fly Brain software (<xref ref-type="bibr" rid="bib66">Milyaev et al., 2012</xref>). (<bold>B</bold>) Schematic representation of the reciprocal long-term memories microcircuit (coloured). The responses of (<bold>C</bold>) the punishment-encoding forgetting dopaminergic neuron (DAN), <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>f</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, the (<bold>D</bold>) reward-encoding forgetting DAN, <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>f</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig8-v1.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>The responses of the neurons of the incentive circuit using the connections introduced so far of the susceptible memory (SM), restrained memory (RM), reciprocal short-term memory (RSM), long-term memory (LTM), and reciprocal long-term memory (RLM) microcircuits.</title><p>The responses of (<bold>A</bold>) the punishment-encoding discharging dopaminergic neuron (DAN), <inline-formula><mml:math id="inf110"><mml:msub><mml:mi>d</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>B</bold>) the attraction-driving susceptible mushroom body output neuron (MBON), <inline-formula><mml:math id="inf111"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>C</bold>) the avoidance-driving restrained MBON, <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>D</bold>) the reward-encoding charging DAN, <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>E</bold>) the attraction-driving LTM MBON, <inline-formula><mml:math id="inf114"><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>F</bold>) the avoidance-driving forgetting DAN, <inline-formula><mml:math id="inf115"><mml:msub><mml:mi>f</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>G</bold>) the reward-encoding discharging DAN, <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>d</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>H</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf117"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>I</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>J</bold>) the punishment-encoding charging DAN, <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>K</bold>) the avoidance-driving LTM MBON, <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>L</bold>) the attraction-driving forgetting DAN, <inline-formula><mml:math id="inf121"><mml:msub><mml:mi>f</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. The first row of responses (coloured pink) corresponds to responses associated with odour A, and the second (coloured yellow) to those associated with odour B. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig8-figsupp1-v1.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>The KC→MBON synaptic weights of the neurons of the incentive circuit using the connections introduced so far of the susceptible memory (SM), restrained memory (RM), reciprocal short-term memory (RSM), long-term memory (LTM), and reciprocal long-term memory (RLM) microcircuits.</title><p>The synaptic weights of (<bold>A</bold>) the attraction-driving susceptible mushroom body output neuron (MBON), <italic>s</italic><sub>at</sub>, (<bold>B</bold>) the avoidance-driving susceptible MBON, <italic>s</italic><sub>av</sub>, (<bold>C</bold>) the attraction-driving restrained MBON, <italic>r</italic><sub>at</sub>, (<bold>D</bold>) the avoidance-driving restrained MBON, <italic>s</italic><sub>av</sub>, (<bold>E</bold>) the attraction-driving LTM MBON, <italic>m</italic><sub>at</sub>, and (<bold>F</bold>) the avoidance-driving LTM MBON, <italic>m</italic><sub>av</sub>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. The first row of weights (coloured pink) corresponds to Kenyon cells (KCs) associated with odour A, the second (coloured yellow) to KCs associated with odour B, and the third (coloured orange) to KCs associated with both odours. For each trial, we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the on-shock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase); otherwise, a second off-shock time-step (i.e., all the other phases).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig8-figsupp2-v1.tif"/></fig></fig-group><p>We have identified the reciprocal LTMs microcircuit of <xref ref-type="fig" rid="fig8">Figure 8B</xref> in the descriptions of <xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref> and <xref ref-type="bibr" rid="bib53">Li et al., 2020</xref>, where MBON-α′1 is the avoidance-driving LTM MBON, MBON-β2β′2a is the attraction-driving LTM MBON, PAM-β2β′2a is the avoidance-driving forgetting DAN, and PPL1-γ2α′1 is the attraction-driving forgetting DAN, as shown in <xref ref-type="fig" rid="fig8">Figure 8A</xref>. One problem with this identification is that there is only one PPL1-γ2α′1 per hemisphere, and we have already suggested that it should be identified as the punishment-encoding charging DAN in our model. However, there are multiple axon terminals of this neuron in the MB (e.g., MB296B<sub>1</sub> and MB296B<sub>2</sub>) and each one of them seems to communicate a different response (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, row 5, columns 6 and 7). Interestingly, the responses communicated by the MB296B<sub>1</sub> terminal are close to the ones produced by the punishment-encoding charging DAN (see <xref ref-type="fig" rid="fig6">Figure 6C</xref>), and the ones of the MB296B<sub>2</sub> are close to the ones produced by the attraction-driving forgetting DAN (see <xref ref-type="fig" rid="fig8">Figure 8D</xref>). This implies that different axons of the same DA neuron might create responses that depend on where the axon terminates and actually work as separate processing units. <xref ref-type="fig" rid="fig8">Figure 8C and D</xref> shows that the reconstructed responses of these neurons from our model are surprisingly similar to the ones observed in the data.</p></sec><sec id="s2-3-5"><title>Memory assimilation mechanism</title><p>The forgetting DANs allow the developing LTM of one valence to induce forgetting of the LTM of the opposite valence. However, the forgetting DANs can also be used for another critical function to maintain flexibility for future learning, which is to erase the memory of the same valence from their respective restrained MBONs. We thus predict that the forgetting DANs also suppress the KC synaptic weights of their respective restrained MBONs, forming the ‘memory assimilation mechanism’ (MAM) microcircuit (see <xref ref-type="fig" rid="fig9">Figure 9C</xref>). This effectively allows memory transfer between the restrained and the LTM MBONs, enhancing both the adaptability and the capacity of the circuit. This effect can be observed in the difference of the responses of the same neurons in <xref ref-type="fig" rid="fig7">Figures 7</xref> and <xref ref-type="fig" rid="fig8">8</xref> and <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>, where the restrained memory becomes weaker as the LTM becomes stronger, driven by the respective forgetting and charging DANs.</p><fig-group><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>The memory assimilation mechanism (MAM) microcircuit of the mushroom body.</title><p>(<bold>A</bold>) Image of the avoidance-specific MAM microcircuit in the mushroom body made of the MBON-γ5β′2a, PPL1-γ2α′1, MBON-α′1, and PAM-β2β′2a – created using the Virtual Fly Brain software (<xref ref-type="bibr" rid="bib66">Milyaev et al., 2012</xref>). (<bold>B</bold>) Image of the attraction-specific MAM microcircuit in the mushroom body made of the MBON-γ2α’1, PAM-β’2a, MBON-β2β′2a, and PPL1-γ2α’1 – created using the Virtual Fly Brain software (<xref ref-type="bibr" rid="bib66">Milyaev et al., 2012</xref>). (<bold>B</bold>) Schematic representation of the MAM microcircuits (coloured). The forgetting dopaminergic neurons (DANs) connect to the restrained mushroom body output neurons (MBONs) of the same valence, hence increasing long-term memory (LTM) strength reduces (assimilates) the restrained memory, constituting the MAM microcircuits.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig9-v1.tif"/></fig><fig id="fig9s1" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 1.</label><caption><title>The KC→MBON synaptic weights of the neurons of the incentive circuit using all its connections.</title><p>The synaptic weights of (<bold>A</bold>) the attraction-driving susceptible mushroom body output neuron (MBON), <inline-formula><mml:math id="inf122"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>B</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf123"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>C</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>D</bold>) the avoidance-driving restrained MBON, <inline-formula><mml:math id="inf125"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>E</bold>) the attraction-driving long-term memory MBON, <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>F</bold>) the avoidance-driving long-term memory MBON, <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. The first row of weights (coloured pink) corresponds to Kenyon cells (KCs) associated with odour A, the second (coloured yellow) to KCs associated with odour B, and the third (coloured orange) to KCs associated with both odours.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig9-figsupp1-v1.tif"/></fig><fig id="fig9s2" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 2.</label><caption><title>The reconstructed responses of the neurons of the incentive circuit using the reward prediction error (RPE) learning rule.</title><p>The reconstructed responses of (<bold>A</bold>) the punishment-encoding discharging dopaminergic neuron (DAN), <inline-formula><mml:math id="inf128"><mml:msub><mml:mi>d</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>B</bold>) the attraction-driving susceptible MBON, <inline-formula><mml:math id="inf129"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>C</bold>) the avoidance-driving restrained mushroom body output neuron (MBON), <inline-formula><mml:math id="inf130"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>D</bold>) the reward-encoding charging DAN, <inline-formula><mml:math id="inf131"><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>E</bold>) the attraction-driving long-term memory MBON, <inline-formula><mml:math id="inf132"><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>F</bold>) the punishment-encoding forgetting DAN, <inline-formula><mml:math id="inf133"><mml:msub><mml:mi>f</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>G</bold>) the reward-encoding discharging DAN, <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>d</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>H</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf135"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>I</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf136"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>J</bold>) the punishment-encoding charging DAN, <inline-formula><mml:math id="inf137"><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>K</bold>) the avoidance-driving long-term memory MBON, <inline-formula><mml:math id="inf138"><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>L</bold>) the reward-encoding forgetting DAN, <inline-formula><mml:math id="inf139"><mml:msub><mml:mi>f</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig9-figsupp2-v1.tif"/></fig><fig id="fig9s3" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 3.</label><caption><title>The KC→MBON synaptic weights of the neurons of the incentive circuit using the reward prediction error (RPE) learning rule.</title><p>The synaptic weights of (<bold>A</bold>) the attraction-driving susceptible mushroom body output neuron (MBON), <inline-formula><mml:math id="inf140"><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>B</bold>) the avoidance-driving susceptible MBON, <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>C</bold>) the attraction-driving restrained MBON, <inline-formula><mml:math id="inf142"><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>D</bold>) the avoidance-driving restrained MBON, <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, (<bold>E</bold>) the attraction-driving long-term memory MBON, <inline-formula><mml:math id="inf144"><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub></mml:math></inline-formula>, and (<bold>F</bold>) the avoidance-driving long-term memory MBON, <inline-formula><mml:math id="inf145"><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub></mml:math></inline-formula>, generated by experimental data (left) and the model (right) during the olfactory conditioning paradigms of <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Lightest shades denote the extinction, mid shades the unpaired, and dark shades the reversal phase. The first row of weights (coloured pink) corresponds to Kenyon cells (KCs) associated with odour A, the second (coloured yellow) to KCs associated with odour B, and the third (coloured orange) to KCs associated with both odours.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig9-figsupp3-v1.tif"/></fig></fig-group><p>The depression effect of the forgetting DANs on the KC→restrained MBON synapses of the same valence is supported by <xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>. More specifically, the avoidance-driving forgetting DAN we have identified as PAM-β2β′2a modulates the KC→MBON-γ5β′2a synapses, while for the attraction-driving forgetting DAN, PPL1-γ2α′1, modulates the KC→MBON-γ2α′1 synapses, as show in <xref ref-type="fig" rid="fig9">Figure 9A and B</xref>, respectively.</p></sec></sec><sec id="s2-4"><title>Modelling the behaviour</title><p>In the IC, three MBON types drive attraction and three avoidance. This results in six driving forces, for each available odour (see <xref ref-type="fig" rid="fig10">Figure 10</xref>). A simple ‘behavioural’ readout (used in many previous models) would be to take the sum of all attractive and aversive forces at some time point as a measure of the probability of animals ‘choosing’ odour A or B, and compare this to the standard two-arm maze choice assay used in many <italic>Drosophila</italic> studies. Following this approach and using the summarised data collected by <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref>, we have tested the performance of our model in 92 olfactory classical conditioning intervention experiments from 14 studies (<xref ref-type="bibr" rid="bib33">Felsenberg et al., 2017</xref>; <xref ref-type="bibr" rid="bib72">Perisse et al., 2016</xref>; <xref ref-type="bibr" rid="bib7">Aso and Rubin, 2016</xref>; <xref ref-type="bibr" rid="bib97">Yamagata et al., 2016</xref>; <xref ref-type="bibr" rid="bib44">Ichinose et al., 2015</xref>; <xref ref-type="bibr" rid="bib43">Huetteroth et al., 2015</xref>; <xref ref-type="bibr" rid="bib68">Owald et al., 2015</xref>; <xref ref-type="bibr" rid="bib6">Aso et al., 2014b</xref>; <xref ref-type="bibr" rid="bib54">Lin et al., 2014</xref>; <xref ref-type="bibr" rid="bib73">Plaçais et al., 2013</xref>; <xref ref-type="bibr" rid="bib17">Burke et al., 2012</xref>; <xref ref-type="bibr" rid="bib56">Liu et al., 2012</xref>; <xref ref-type="bibr" rid="bib4">Aso et al., 2010</xref>; <xref ref-type="bibr" rid="bib21">Claridge-Chang et al., 2009</xref>), that is, the observed effects on fly learning of silencing or activating specific neurons, including positive and negative reinforcements. The <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula> predicted from the IC correlated with the ones reported from the actual experiments with correlation coefficient <inline-formula><mml:math id="inf147"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.76</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf148"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2.2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>The activity of the six mushroom body output neurons (MBONs) is translated into forces that drive a simulated fly towards or away from odour sources.</title><p>For naive flies, the forces are balanced. When electric shock is paired with an odour, the balance changes towards the avoidance-driving MBONs, which drives the fly directly away from that odour. When sugar is paired with an odour, the balance changes to attraction, driving the fly towards that odour. Combining all attractive and repulsive forces for each odour source currently experienced by the fly produces an overall driving force, <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, which determines the fly’s behaviour.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig10-v1.tif"/></fig><p>However, classical conditioning does not allow us to explore the full dynamics of the circuit as animals simultaneously explore, learn, express learning, and forget, while moving through a world with odours. Therefore, we further simulate the behaviour produced by the IC with simulated flies placed in a virtual arena, where they are exposed to two odour gradients, of different strengths, and variously paired with reinforcements. As we have full access to the neural responses, the synaptic weights, and the position of the simulated flies for every time-step, this allows us to identify different aspects of the produced behaviour and motivation, including the effect of the LTM on the behaviour and whether ‘choice’ occurs because the animal is attracted by one odour or repulsed by the other. We can then derive a behavioural preference index (PI) based on the time the simulated flies spent exposed in each odour during relevant time periods. <xref ref-type="fig" rid="fig11">Figure 11</xref> summarises our experimental set-up and results, while details about how we generate the presented behaviours are given in the methods section ‘Modelling the behaviour’.</p><fig-group><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>The behaviour of the animal controlled by its neurons during the freely moving flies simulation.</title><p>The <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> simulated flies are exposed to a mixture of two odours, whose relative intensity depends on the position of the simulated flies in space. (<bold>A</bold>) Each experiment lasts for <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>100</mml:mn><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> where: the flies are placed at the centre of the arena in time-step <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>20</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. During the first <inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>20</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (pre-training phase, <inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>), the flies explore the arena without any reinforcement (blue tracks). In the next <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>30</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (training phase, <inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>30</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>), they conditionally receive reinforcement under one of the six training cases shown on the right: using sugar (green) or shock (red); and reinforcing around odour A (shock + odour A), odour B (shock + odour B), or both odours (shock + odour A/B). During the last <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>50</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (post-training phase <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>30</mml:mn><mml:mo>,</mml:mo><mml:mn>80</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>), they continue being exposed to the odours without receiving a reinforcement (black tracks). We repeat this experiment (including all its phases) 10 times in order to show the effects of the long-term memory in the behaviour. (<bold>B</bold>) Behavioural summary of a subset of simulated flies that visited both odours at any time during the 10 repeats. Columns show the different conditions and the population that was recorded visiting both odours. Top row: the normalised cumulative time spent exposed in odour A (pink lines) or odour B (yellow lines; note that this line is reversed). For each repeat, we present three values (average over all the pre-training, training, and post-training time-steps, respectively) where the values associated with the training phase are marked with red or green dots when punishment or reward has been delivered to that odour, respectively. Thin lines show three representative samples of individual flies. Thick lines show the median over the simulated flies that visited both odours. Bottom row: the preference index (PI) to each odour extracted by the above cumulative times.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig11-v1.tif"/></fig><fig id="fig11s1" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 1.</label><caption><title>The mean KC→MBON synaptic weights over the simulated flies that visited both odours and for each neuron, phase, and repeat of the experiment.</title><p>Different rows correspond to KC→MBON weights associated with a different type of MBON, from top to bottom: attraction- and avoidance-driving susceptible, restrained and long-term memory MBONs. Pink and yellow lines show synaptic weights associated with odours A and B, respectively, dashed lines show weights associated with both odours. Thin lines show three representative examples of synaptic weights in single simulated flies. Thick lines show the median of the synaptic weight over all the simulated flies that visited both odours. KC: Kenyon cells; MBON: mushroom body output neuron.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig11-figsupp1-v1.tif"/></fig><fig id="fig11s2" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 2.</label><caption><title>Behavioural summary of simulated flies grouped by the areas that they visited.</title><p>(<bold>A</bold>) At least one of the two odours, (<bold>B</bold>) odour A, (<bold>C</bold>) odour B, (<bold>D</bold>) only odour A, and (<bold>E</bold>) only odour B. In each panel, columns show the different conditions and the population for each group. Top row: the normalised cumulative time spent exposed in odour A (pink lines) or odour B (yellow lines; note that this line is reversed). For each repeat, we present three values (average over all the pre-training, training, and post-training time-steps, respectively) where the values associated with the training phase are marked with red or green dots when punishment or reward has been delivered to that odour, respectively. Thin lines show three representative samples of individual flies. Thick lines show the median over the simulated flies that visited both odours. Bottom row: the preference index (PI) to each odour extracted by the above cumulative times.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig11-figsupp2-v1.tif"/></fig><fig id="fig11s3" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 3.</label><caption><title>Behavioural summary of simulated flies when controlled by the different types of mushroom body output neurons (MBONs).</title><p>Behavioural summary of simulated flies when controlled by (<bold>A</bold>) the susceptible, (<bold>B</bold>) restrained, or (<bold>C</bold>) long-term memory (LTM) MBONs separately. In each panel, columns show the different conditions and the population for each group. Top row: the normalised cumulative time spent exposed in odour A (pink lines) or odour B (yellow lines; note that this line is reversed). For each repeat, we present three values (average over all the pre-training, training, and post-training time-steps, respectively) where the values associated with the training phase are marked with red or green dots when punishment or reward has been delivered to that odour, respectively. Thin lines show three representative samples of individual flies. Thick lines show the median over the simulated flies that visited both odours. Bottom row: the preference index (PI) to each odour extracted by the above cumulative times.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig11-figsupp3-v1.tif"/></fig><fig id="fig11s4" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 4.</label><caption><title>Paths of 100 simulated flies when using the dopaminergic plasticity rule and during all 10 repeats of the experiment.</title><p>Blue segments show the paths of the flies during the pre-training, red and green segments show the paths during the training phase for punishment and reward conditions, respectively, and black segments show the paths during the post-training phase. Rows are for the different repeats and columns for the different conditions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig11-figsupp4-v1.tif"/></fig><fig id="fig11s5" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 5.</label><caption><title>Behavioural summary of a subset of simulated flies that visited both odours at any time during the 10 repeats, and the plasticity rule of their neurons was replaced by the reward prediction error plasticity rule.</title><p>Columns show the different conditions and the population that was recorded visiting both odours. Top row: the normalised cumulative time spent exposed in odour A (pink lines) or odour B (yellow lines; note that this line is reversed). For each repeat, we present three values (average over all the pre-training, training, and post-training time-steps, respectively) where the values associated with the training phase are marked with red or green dots when punishment or reward has been delivered to that odour, respectively. Thin lines show three representative samples of individual flies. Thick lines show the median over the simulated flies that visited both odours. Bottom row: the preference index (PI) to each odour extracted by the above cumulative times.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig11-figsupp5-v1.tif"/></fig><fig id="fig11s6" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 6.</label><caption><title>Paths of 100 simulated flies when using the reward prediction error (RPE) plasticity rule and during all 10 repeats of the experiment.</title><p>Blue segments show the paths of the flies during the pre-training, red and green segments show the paths during the training phase for punishment and reward conditions, respectively, and black segments show the paths during the post-training phase. Rows are for the different repeats and columns for the different conditions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig11-figsupp6-v1.tif"/></fig><fig id="fig11s7" position="float" specific-use="child-fig"><label>Figure 11—figure supplement 7.</label><caption><title>The mean KC→MBON synaptic weights when using the reward prediction error (RPE) plasticity rule over the simulated flies that visited both odours and for each neuron, phase, and repeat of the experiment.</title><p>Different rows correspond to KC→MBON weights associated with a different type of MBON, from top to bottom: attraction- and avoidance-driving susceptible, restrained and long-term memory MBONs. Pink and yellow lines show synaptic weights associated with odours A and B, respectively, dashed lines show weights associated with both odours. Thin lines show three representative examples of synaptic weights in single simulated flies. Thick lines show the median of the synaptic weight over all the simulated flies that visited both odours. KC: Kenyon cell; MBON: mushroom body output neuron.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig11-figsupp7-v1.tif"/></fig></fig-group><p>In <xref ref-type="fig" rid="fig11s4">Figure 11—figure supplement 4</xref>, we can see that most simulated flies do not visit any of the regions that an odour can be detected in the first repeats, and therefore, in <xref ref-type="fig" rid="fig11">Figure 11B</xref>, we start seeing an effect in the averaged statistics after the second repeat of the experiment. However, in the first couple of repeats, the individual paths already show a small tendency to the expected behaviour of the flies: avoid the punished region and approach the rewarded one. Due to the unpredictable behaviour of the individual flies, in <xref ref-type="fig" rid="fig11">Figure 11B</xref> we summarise only times from simulated flies that have visited both odours for at least 1 s. In later repeats of the experiment, the PI shows that (on average) flies prefer the non-punished and rewarded odours. When both of them are punished or rewarded, they equally prefer none or both, respectively. Note that the above result does not mean that each fly spends equal time in both odours, but that most probably some flies choose to spend more time with the one and some with the other (as shown from the individual cumulative durations in <xref ref-type="fig" rid="fig11">Figure 11B</xref>), but their population is equal. It is interesting that almost in every repeat the flies are neutral about the odours during pre-training (time-step before the reinforced one – marked with red or green), showing a relatively small effect during training and a bigger effect during post-training. This might be because in every repeat of the experiment they are initialised in the centre, so they spend some time randomly exploring before they detect an odour.</p><p>By looking at the PIs of <xref ref-type="fig" rid="fig11">Figure 11B</xref>, we see a strong effect when electric shock is paired with odour A or B, but not very strong otherwise. We also see a smaller PI for flies experiencing sugar than the ones that experience electric shock, which is in line with experimental data (<xref ref-type="bibr" rid="bib51">Krashes and Waddell, 2011</xref>). When shock is paired with both odours, we expect that the simulated flies will try to minimise the time spent exposed to any of them, which is precisely what we see in the coloured lines. In contrast, simulated flies seem to increase the time spent in both odours when paired with sugar with a slight preference towards the reinforced odour. In general, our results show that (in time) the simulated flies seem to develop some prior knowledge about both odours when experiencing at least one of them with reinforcement (see <xref ref-type="fig" rid="fig11">Figure 11B</xref> and <xref ref-type="fig" rid="fig11s2">Figure 11—figure supplement 2A</xref>), which we suggest is because of their overlapping KCs associated with both odours. We believe that this leads to self-reinforcement, which means that when the animal experiences the non-reinforced odour it will automatically associate the reinforcement associated with the overlapping KCs to all the KCs associated with this odour, which is effectively a form of second-order conditioning.</p><p>From the summarised synaptic weights shown in <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1</xref>, we can see that the susceptible MBONs immediately block the simulated flies from approaching the punishing odours, while they allow them to approach the rewarding ones, which results in the smaller PI shown in sugar-related experiments compared to the shock-related ones, as discussed before. This is partially because of the lack of reciprocal connections between the opposing susceptible MBONs, and it can be verified through the appetitive conditioning, where the synaptic weights seem to change as the simulated flies now prefer the reinforced odour site. Susceptible MBONs convulsively break the balance between attraction and avoidance created by the restrained and LTM MBONs, also affecting their responses, and allowing STM and as a result LTM formation even without the presence of reinforcement. <xref ref-type="fig" rid="fig11s1">Figure 11—figure supplement 1</xref> also shows that the restrained MBONs seem to play an important role during the first repeats (up to five), but then they seem to reduce their influence giving up the control to the LTM MBONs, which seem to increase their influence with time. This is partially an effect of the MAM microcircuit, which verifies its function and the role of the restrained MBONs as storing STMs. <xref ref-type="fig" rid="fig11s3">Figure 11—figure supplement 3</xref> shows that the different types of MBONs alone are also capable of controlling the behaviour. However, they seem to better work when combined as they complement one another in different stages, for example, during early or late repeats and crucial times.</p></sec><sec id="s2-5"><title>Dopaminergic plasticity rule vs. reward prediction error</title><p>We have already shown that our novel dopaminergic plasticity rule and the connectome of the incentive circuit build a powerful model for memory dynamics and behavioural control. In order to verify the importance of our DPR in the model, we run the same experiments by replacing it with the reward prediction error plasticity rule (<xref ref-type="bibr" rid="bib76">Rescorla and Wagner, 1972</xref>).</p><p>The idea behind RPE is that the fly learns to predict how rewarding or punishing a stimulus is by altering its prediction when this does not match the actual reward or punishment experienced (<xref ref-type="bibr" rid="bib101">Zhao et al., 2021</xref>). This can be adapted to the mushroom body circuit by assuming for a given stimulus represented by KC activation, the MBON output is the prediction, and the KC→MBON synaptic weights should be altered (for the active KC) proportionally to the difference between the MBON output and the actual reinforcement signalled by the DAN. In <xref ref-type="disp-formula" rid="equ30">Equation 30</xref>, we show how our DPR can be replaced with the RPE (as described above) in our model. Note that this rule allows updates to happen only when the involved KC is active, implying synaptic plasticity even without DAN activation but not without KC activation, which is in contrast with our DPR and recent findings (<xref ref-type="bibr" rid="bib14">Berry et al., 2018</xref>; <xref ref-type="bibr" rid="bib41">Hige et al., 2015</xref>) (also in larva; <xref ref-type="bibr" rid="bib80">Schleyer et al., 2018</xref>; <xref ref-type="bibr" rid="bib81">Schleyer et al., 2020</xref>).</p><p>This effect, that is, learning when the KC is active even without DAN activation, is visible in <xref ref-type="fig" rid="fig9s2">Figure 9—figure supplement 2</xref> and <xref ref-type="fig" rid="fig9s3">Figure 9—figure supplement 3</xref>, where we can see that, for the susceptible MBONs, the synaptic weights recover every time before the shock delivery, when the odour is presented alone, resulting in no meaningful learning and cancelling their susceptible property. Restrained MBONs look less affected (at least in this experimental set-up), while the LTM MBONs lose their charging momentum obtained by the saturation effect, resulting in more fragile memories. Furthermore, due to the KC (instead of dopamine) gating of this plasticity rule, the responses during the unpaired and extinction conditions look identical in all neurons, while the reversal makes a difference only on the responses to odour A. In general, the responses reproduced using the RPE plasticity rule have none of the properties of our model that have been shown earlier and also they cannot explain the dynamics of the responses recorded from animals.</p><p>In contrast to the responses, the behaviour of the simulated flies (as shown in <xref ref-type="fig" rid="fig11s5">Figure 11—figure supplement 5</xref> and <xref ref-type="fig" rid="fig11s6">Figure 11—figure supplement 6</xref>) is less affected by the plasticity rule: we still see a preference to the non-punished or rewarded odours. However, there are some details in the behaviour that are different and some properties of the model that need to be mentioned. First, we see that the simulated flies now spend more time in the punished odours (compared to the non-punished ones), which might look like adaptation (in PI level), but it is actually forgetting about the odour. <xref ref-type="fig" rid="fig11s7">Figure 11—figure supplement 7</xref> shows that synaptic weights targeting the restrained and LTM MBONs are dramatically depressed during the first three repeats and are unable to recover whatsoever, which means that this part of the circuit is knocked out by then. Hence, the behaviour is controlled solely by the susceptible MBONs, which now look more like LTM MBONs that are not reciprocally connected. Furthermore, the synaptic weights associating the odours to both motivations seem to constantly decrease, which makes us believe that both susceptible MBONs will have the same future as the restrained and LTM ones, but it will just take longer. Therefore, we see that although the RPE predicts a reasonable behaviour for inexperienced (or minor experienced) simulated flies, it could gradually result in a meaningless behaviour for experienced flies.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have shown that the combination of our novel dopaminergic plasticity rule (DPR) with the incentive circuit (IC) of the mushroom body is able to generate similar neural responses and behaviours to flies in associative learning and forgetting paradigms. Regarding our model, we provide evidence for the existence of all hypothesised connections and suggest that at least three types of MB output (susceptible, restrained, and LTM) and three types of DA neurons (discharging, charging, and forgetting) exist in the fruit fly brain, discriminated by their functionality. As we show, this forms a unified system for rapid memory acquisition and transfer from STM to LTM, which could underlie the ability to make exploration/exploitation trade-offs. <xref ref-type="box" rid="box1">Box 1</xref> summarises a number of prediction yielded by this computational modelling study.</p><boxed-text id="box1"><label>Box 1.</label><caption><title>Summary of predictions.</title></caption><p>The model yields predictions that can be tested using established experimental protocols:</p><list list-type="order"><list-item><p>MBON-γ2α’1 and MBON-γ5β′2a should exhibit short-term memories (STMs), while MBON-α′1 and MBON-β2β′2a long-term memories (LTMs). MBON-γ1pedc&gt;α/β and MBON-γ4&gt;γ1γ2 should exhibit susceptible memories. Restrained and susceptible mushroom body output neurons (MBONs) should show more consistent responses across flies. LTM MBONs should have more variable responses because they encode all previous experiences of the animal.</p></list-item><list-item><p>Activating MBON-γ2α′1 or MBON-β2β′2a should increase the responses rate of PAM-β′2a, and similarly activating MBON-γ2β′2a or MBON-α′1 should excite PPL1-γ2α′1. This would verify the excitatory STM reciprocal and LTM feedback connections of the circuit. By activating the LTM MBONs (e.g., MBON-α′1 and MBON-β2β′2a) should also excite the forgetting dopaminergic neurons (DANs) (e.g., PAM-β2β′2a and PPL1-γ2α′1, respectively). This would verify the excitatory LTM reciprocal connections of the circuit.</p></list-item><list-item><p>By consistently activating one of the LTM MBONs while delivering a specific odour, the LTM MBON should show an increased response to that odour even without the use of a reinforcement. This would verify the saturation effect of the DPR and the charging momentum hypothesis. On the other hand, if we observe a reduced response rate, this would show that MBON-DAN feedback connection is inhibitory and that RPE is implemented by the circuit.</p></list-item><list-item><p>Blocking the output of charging DANs (i.e., PPL1-γ2α′1 and PAM-β′2a) could reduce the acquisition rate of LTM MBONs, while blocking the output of LTM MBONs would prevent memory consolidation. Blocking the reciprocal connections of the circuit should prevent generalising amongst opposing motivations (unable to make short- or long-term alteration of responses to odours once memories have formed). Blocking the output of forgetting DANs would additionally lead to hypersaturation of LTMs, which could cause inflexible behaviour.</p></list-item><list-item><p>Activation of the forgetting DANs should depress the Kenyon cell (KC)-MBON synaptic weights of the restrained and LTM MBONs of the same and opposite valence, respectively, and as a result suppress their response to KC activation. Activation of the same DANs should cause increased activity of these MBONs for silenced KCs at the time.</p></list-item><list-item><p>Unpaired conditioning should involve the LTM circuit (or at least some microcircuit within the MB where the MBON excites a DAN). Second-order conditioning should involve the LTM circuit and might not require the susceptible and restrained memory circuits. Backward conditioning might not occur in all compartments as in our model it is required that the target MBON inhibits its respective DAN (susceptible memory microcircuit) and to date has only been demonstrated for microcircuits with this property.</p></list-item><list-item><p>DANs that innervate more than one compartment may have different functional roles in each compartment.</p></list-item></list></boxed-text><sec id="s3-1"><title>Advantages of the dopaminergic plasticity rule</title><p>The proposed DPR, while remaining very simple, allows the animal to express a variety of behaviours depending on their experience. The rule remains local to the synapse, that is, it depends only on information that is plausibly available in the presynaptic area of the KC axon (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>): the activity of the KC, the level of DA, and the deviation of the current ‘weight’ from a set-point ‘resting weight’. We note that it was not possible to obtain good results without this third component to the rule, although the underlying biophysical mechanism is unknown; we speculate that it could involve synapsin as it has a direct role in regulating the balance of reserve and release vesicle pools, and is required in the MB for associative learning (<xref ref-type="bibr" rid="bib65">Michels et al., 2011</xref>). The rule also introduces a bidirectional ‘dopaminergic factor’ based on the results of <xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>, who showed the combination of DopR1 and DopR2 receptor activity can result in depression or potentiation of the synapse. In our plasticity rule, a positive or negative dopaminergic factor combined with active or inactive KCs leads to four possible effects on the synapse: depression, potentiation, recovery, and saturation. This allows substantial flexibility in the dynamics of learning in different MB compartments.</p><p>In particular, the saturation allows LTM MBONs to consolidate their memories and makes it very hard to forget. This only occurs for consistently experienced associations, which then become strongly embedded. Only a persistent change in the valence of reinforcement experienced with a given stimuli can reset the activity of LTM MBONs through the reciprocal LTMs microcircuit, which equips the circuit with flexibility even in the LTMs. Further, the fact that the DPR allows STMs (restrained) and LTMs to interact through the memory assimilation mechanism (MAM) increases the capacity of the circuit. Whatever the restrained MBONs learn is eventually assimilated by the LTM MBONs, opening up space for the formation of new memories in the restrained MBONs. When combined with sparse coding of odours in a large number of KCs, the LTM MBONs can store multiple memories for different odours. Short-term experience might occasionally affect the behaviour when the susceptible and restrained MBONs learn something new, and hence mask the LTM output, but eventually this will be smoothly integrated with the previous experience in the LTM MBONs. The DPR plays an important role in this mechanism, as we saw earlier, and the connectivity alone is not enough for it to work properly.</p><p>By contrast, the RPE plasticity rule lacks this flexibility and fails to maintain useful LTMs when applied to the same circuit architecture. A literal interpretation of RPE for the MB would require that the difference (error) between the postsynaptic MBON activity and the DA level is somehow calculated in the presynaptic KC axon. This seems inconsistent with the observation that learning is generally unaffected by silencing the MBONs during acquisition (<xref ref-type="bibr" rid="bib41">Hige et al., 2015</xref>; <xref ref-type="bibr" rid="bib49">Krashes et al., 2007</xref>; <xref ref-type="bibr" rid="bib28">Dubnau et al., 2001</xref>; <xref ref-type="bibr" rid="bib64">McGuire et al., 2001</xref>). Alternatively (and not directly requiring MBON activity in the KC plasticity rule) the RPE could be implemented by circuits (<xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref>; <xref ref-type="bibr" rid="bib86">Springer and Nawrot, 2021</xref>; <xref ref-type="bibr" rid="bib31">Eschbach et al., 2020</xref>) in which DANs transmit an error signal computed by their input reinforcement plus the opposing feedback from MBONs (i.e., MBONs inhibit DANs that increase the KC→MBON synaptic weights, or they excite those that suppress the synaptic weights). However, although the evidence for MBON-DAN feedback connections is well-grounded, it is less clear that they are consistently opposing. For example, in the microcircuits we have described, based on neurophysiological evidence, some DANs that depress synaptic weights receive inhibitory feedback from MBONs (<xref ref-type="bibr" rid="bib70">Pavlowsky et al., 2018</xref>) and some DANs that potentiate synaptic weights receive excitatory feedback from DANs (<xref ref-type="bibr" rid="bib44">Ichinose et al., 2015</xref>). As we have shown, the DPR is able to operate with this variety of MBON-DAN connections. Note that, by using the appropriate circuit, that is, positive MBON-DAN feedback to depressing DANs, our DPR could also have an RPE effect. Although the proposed IC does not include such connections, it is still possible that they exist.</p></sec><sec id="s3-2"><title>The conditioning effects of the model</title><p>During the past decades, a variety of learning effects have been investigated in flies, including forward and backward (relief) conditioning, first- and second-order conditioning and blocking, which we could potentially use to challenge our model. In the methods section ‘Derivation of the dopaminergic plasticity rule’, we demonstrate that our model supports the backward (or relief) conditioning results presented in <xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>. Backward conditioning is when the reinforcement is delivered just before the odour presentation and it is based on the time dependency between the two stimuli. <xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref> suggest that the backward conditioning is a mechanism driven by ER-Ca<sup>2+</sup> and cAMP in a KC→MBON synapse, when a single DAN releases DA on it. In our model, we assume that different time courses in the response of DopR1 and DopR2 receptors cause the different patterns of ER-Ca<sup>2+</sup> and cAMP, resulting in the formation of opposite associations for forward and backward conditioning. We note however that in our model the effect also requires that the target MBON inhibits the respective DAN (as in our susceptible memory microcircuits) altering the time course of neurotransmitter release. This may suggest that backward conditioning does not occur in all MB compartments. We believe that this mechanism for backward conditioning is better supported than the hypothesised mechanism of post-inhibitory rebound in opposing valence DANs presented in <xref ref-type="bibr" rid="bib1">Adel and Griffith, 2021</xref>, although some role for both mechanisms is possible.</p><p>Backward conditioning can be distinguished from the unpaired conditioning effect; the latter involves the presentation of reinforcement and a specific odour in alternation with less temporal proximity. It has been observed (<xref ref-type="bibr" rid="bib46">Jacob and Waddell, 2020</xref>; <xref ref-type="bibr" rid="bib80">Schleyer et al., 2018</xref>) that this procedure will produce a change in response to the odour that is opposite in valence to the reinforcement, for example, approach to an odour that is ‘unpaired’ with shock. Note that this effect can be observed both in standard two-odour CS+/CS- training paradigms (where an altered response to CS-, in the opposite direction to CS+, is often observed) but also in single-odour unpaired paradigms. Surprisingly, our model also produces unpaired conditioning, notably through a different mechanism than backward conditioning. When DANs are activated by a reinforcement without KC activation, the weights of all KCs are potentially altered, for example, restored towards their resting weight or slightly potentiated. This alteration means that subsequent presentation of odour alone can be accompanied by MBON-driven activation of DANs, resulting in specific alteration of the weights for the presented odour. In the example of <xref ref-type="fig" rid="fig12">Figure 12</xref>, odour A starts to self-reinforce its attractive LTM when presented in alternation with shock and will be preferred to an alternative odour B in subsequent testing. However, repeated presentation of other odours during testing, without further shock, might lead to generalisation (equal preference to all experienced odours).</p><fig id="fig12" position="float"><label>Figure 12.</label><caption><title>The preference index (PI) of the agent during the classic unpaired conditioning paradigm.</title><p>During the training phase, we deliver electric shock or odour A alternately. During the test phase, we deliver odours A and B alternately. The PI is calculated by using the mushroom body output neuron (MBON) responses for each odour.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig12-v1.tif"/></fig><p>The self-reinforcing property of the positive feedback in the LTM microcircuit can also account for second-order conditioning. If a motivation has been associated to an odour, MBONs related to that motivation will have increased activity when the odour is delivered, even in the absence of reinforcement. In the LTM microcircuit, the positive MBON-DAN connection will consequently activate the charging DAN, so any additional cue (or KC activity) presented alongside the learned odour will also experience an increase in the respective KC→MBON weights, creating a similar charging momentum and resulting in a second-order association. Perhaps surprisingly, this predicts that second-order conditioning might happen directly in the LTM microcircuit without being filtered by the susceptible and restrained memories first. This would be consistent with the observation that second-order conditioning in flies requires strong induction of the first-order memory and that first-order memory does not appear to be extinguished by the absence of reinforcement during second-order training (<xref ref-type="bibr" rid="bib88">Tabone and de Belle, 2011</xref>).</p><p>Finally, although we have not tested it explicitly here, it is clear that our plasticity rule (unlike RPE) would not produce blocking. The blocking effect, as described by <xref ref-type="bibr" rid="bib48">Kamin, 1967</xref>, is when the conditioning to one stimulus subsequently blocks any conditioning to other elements of a mixture including that stimulus. Under RPE learning, this is explained by the first stimulus already correctly predicting the reinforcer, so there is no error to drive a change in the weights. Using the DPR, the updates are local to the synapse and do not depend on a calculation of errors summarised across different odour identities, so blocking does not happen, which is consistent with the observed behaviour of fruit flies (<xref ref-type="bibr" rid="bib98">Young et al., 2011</xref>; <xref ref-type="bibr" rid="bib16">Brembs and Heisenberg, 2001</xref>). Although the presentation of a learned odour along with a novel odour might, through feedback from the MBONs, alter the DAN responses to the reinforcement, in our circuit this is not generally an opponent feedback so will not cancel the reinforcing effects for the novel odour. This also highlights the difference between our susceptible, restrained, and long-term memory microcircuits from the RPE circuits described in <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref>, <xref ref-type="bibr" rid="bib86">Springer and Nawrot, 2021</xref>, <xref ref-type="bibr" rid="bib31">Eschbach et al., 2020</xref>, and <xref ref-type="bibr" rid="bib101">Zhao et al., 2021</xref>. Nevertheless, as <xref ref-type="bibr" rid="bib93">Wessnitzer et al., 2012</xref> and later <xref ref-type="bibr" rid="bib13">Bennett et al., 2021</xref> suggest, the fact that blocking has not been observed in fruit flies could also be explained by the way that the mixture of odours is represented by the KCs, that is, that it might not be simply the superposition of the activity patterns of the individual odours.</p></sec><sec id="s3-3"><title>Additional mushroom body connections</title><p>Our model suggests that only KC→MBON, MBON⊣DAN, MBON→DAN, and DAN⊸MBON connections are essential for successful learning in the MBs. However, there are a number of additional known connections in the MBs, such as KC→APL, APL⊣KC, DAN→MBON, axoaxonic KC→KC and KC→DAN connections that have been neglected in this model, and need further consideration.</p><p>In the larval brain, there are two anterior paired lateral (APL) neurons, one for each MB. They extend their dendrites to the lobes of the MBs and terminate their axons in the calyxes releasing the inhibitory GABA neurotransmitter (<xref ref-type="bibr" rid="bib90">Tanaka et al., 2008</xref>). Although there are still two of them, in the adult brain both their dendrites and axons are innervating the calyx and the lobes (<xref ref-type="bibr" rid="bib96">Wu et al., 2013</xref>), suggesting that they function as both global and local inhibitory circuits. Moreover, DAN⊣APL (<xref ref-type="bibr" rid="bib55">Liu and Davis, 2009</xref>) and APL⊣DAN (<xref ref-type="bibr" rid="bib95">Wu et al., 2012</xref>) connections have been proposed, but there is no clear description of what their function is. Several previous models (<xref ref-type="bibr" rid="bib71">Peng and Chittka, 2017</xref>; <xref ref-type="bibr" rid="bib27">Delahunt et al., 2018</xref>) have demonstrated that a potential function for this global/local inhibition network is gain control such that the total number of KCs firing to different stimuli remains similar, and indeed that the same effect can be implemented using a flexible threshold for KC firing (<xref ref-type="bibr" rid="bib78">Saumweber et al., 2018</xref>; <xref ref-type="bibr" rid="bib103">Zhu et al., 2020</xref>; <xref ref-type="bibr" rid="bib100">Zhao et al., 2020</xref>). In our model, we have simplified the KC input, representing just two odours as different patterns across a small number of KCs with a fixed number of them being active at all times, so the hypothesised gain control function of the APL is not useful here. However, it remains an interesting question whether there is learning between the KC and APL in the lobes (<xref ref-type="bibr" rid="bib102">Zhou et al., 2019</xref>), or between the APL and KC in the calyx, and what role this might play in the overall dynamics of memory acquisition.</p><p>In addition, <xref ref-type="bibr" rid="bib30">Eichler et al., 2017</xref> suggest that most of the KCs input, that is, 60%, is from other KCs. We suggest that these connections (together with the ones from the APL) might create local winner-takes-all (WTA) networks that force a limited number of KCs per compartment to be active at one time. This predicts that it is possible for the same KC axon to be active in one compartment but inactive in another (consistent with recent data from <xref ref-type="bibr" rid="bib15">Bilz et al., 2020</xref>), and that an almost fixed number of KCs might be active at all times, even when no odour is delivered (e.g., fresh air only) enabling the acquisition and forgetting at all times. <xref ref-type="bibr" rid="bib45">Ito et al., 2008</xref> show that KCs can be active even in the absence of odours but with no consistent spiking, which is a characteristic of WTA networks when the underlying distribution of spikes across the neurons is almost uniform.</p><p><xref ref-type="bibr" rid="bib30">Eichler et al., 2017</xref> also observed (from electron microscopy reconstruction in larva) that within a compartment, in a ‘canonical microcircuit’, KCs make direct synapses to the axons of DANs, and that DAN pre-synapses often simultaneously contact KCs and MBONs. The same connections have been observed in adult <italic>Drosophila</italic> by <xref ref-type="bibr" rid="bib89">Takemura et al., 2017</xref>. The extent to which KCs (and thus odour inputs) might be directly exciting DANs remains unclear. <xref ref-type="bibr" rid="bib20">Cervantes-Sandoval et al., 2017</xref> show that stimulating KCs results in increased DAN responses and that DANs are activated through the ACh neurotransmitter. However, we note that in our model such an effect could be explained without assuming a direct connection. For example, in the LTM microcircuit, activating the KCs results in increased activity of the LTM MBON, which excites the respective charging DAN. The DAN that <xref ref-type="bibr" rid="bib20">Cervantes-Sandoval et al., 2017</xref> provide evidence from is PPL1-α2α′2, which gets excited by MBON-α2α′2 neurons as it is characterised by the ACh neurotransmitter (<xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>). In our terms, this could be an LTM MBON that excites its respective charging DAN, PPL1-α2α′2 (<xref ref-type="bibr" rid="bib53">Li et al., 2020</xref>), and provide the source of ACh detected on it. More generally, the altered activity of DANs in response to odours that have been observed during learning can be also observed in our model, without requiring direct KC→DAN connections or their modification. Nevertheless, such connections may possibly play a role in enhancing the specificity of dopamine-induced changes in KC→MBON connectivity. Interestingly, the depression of KC→DAN synapses, in parallel with KC→MBON synapses, could provide an alternative mechanism for implementing RPE learning (<xref ref-type="bibr" rid="bib89">Takemura et al., 2017</xref>).</p><p><xref ref-type="bibr" rid="bib89">Takemura et al., 2017</xref> demonstrate that the direct synapses observed from DANs to MBONs are functional in altering the MBON postsynaptic current to DAN activation, independently of KCs. This could be a mechanism by which learnt responses to reinforcements are coordinated with the current presence or absence of the reinforcement (<xref ref-type="bibr" rid="bib81">Schleyer et al., 2020</xref>; <xref ref-type="bibr" rid="bib79">Schleyer et al., 2011</xref>; <xref ref-type="bibr" rid="bib36">Gerber and Hendel, 2006</xref>). Another possibility is that postsynaptic as well as presynaptic changes might be involved in learning at the KC→MBON synapse (<xref ref-type="bibr" rid="bib75">Pribbenow et al., 2021</xref>).</p></sec><sec id="s3-4"><title>Beyond attraction and aversion</title><p>The IC consists of six MBONs and six DANs that link a pair of antagonistic motivations, attraction, and avoidance. However, there are ∼34 MBONs and ∼130 DANs in the MB of the adult fruit fly brain, within which the IC is an identifiable motif. We suggest the possibility that this motif could be repeated, representing additional opposing motivations, with some neurons having multiple roles depending on the motivational context as proposed by <xref ref-type="bibr" rid="bib23">Cohn et al., 2015</xref>, working either as restrained MBONs and discharging DANs, or as LTM MBONs and forgetting DANs depending on the reinforcer identity. We have illustrated this concept of a unified system of motivations as the ‘incentive wheel’ (see <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). This could explain how PAM-β2β′2a (i.e., MB301B; <xref ref-type="bibr" rid="bib61">May et al., 2020</xref>) is a sugar-encoding discharging DAN in the appetitive olfactory conditioning context, but it also is an avoidance-driving forgetting DAN in a different context (e.g., aversive olfactory conditioning). In addition, two MBONs of the IC do not interact with the α′/β′ KCs of the MB. MBON-γ4&gt;γ1γ2 and MBON-γ1pedc&gt;α/β are part of two autonomous microcircuits, that is, the SMs, and are working under the context provided by the ∼675 γ-KCs relative to the task. This makes it possible that the KCs from the γ lobe connect to all the SMs of the flies for the approximately eight available motivations illustrated in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>.</p><p>From a functional point of view, the MBs seem to be involved in the motivation and behaviour of the animal, especially when it comes to behaviours essential for survival. In the mammalian brain, this function is subserved by the limbic system, which is composed of a set of complicated structures, such as the thalamus, hypothalamus, hippocampus, and amygdala (<xref ref-type="bibr" rid="bib25">Dalgleish, 2004</xref>; <xref ref-type="bibr" rid="bib77">Roxo et al., 2011</xref>). According to <xref ref-type="bibr" rid="bib69">Papez, 1937</xref>, sensory (and mostly olfactory) input comes in the limbic system through the thalamus, which connects to both the cingulate cortex (through the sensory cortex) and the hypothalamus (<xref ref-type="bibr" rid="bib77">Roxo et al., 2011</xref>; <xref ref-type="bibr" rid="bib25">Dalgleish, 2004</xref>). Responses in the cingulate cortex are guiding the emotions, while the ones in the hypothalamus are guiding the behaviour (bodily responses). Finally, the hypothalamus connects with the cingulate cortex through the anterior thalamus (forward) and the hippocampus (backward stream). <xref ref-type="bibr" rid="bib59">Maclean, 1949</xref> augmented this model by adding the amygdala and PFC structures that encode primitive emotions (e.g., anger and fear) and connect to the hypothalamus (<xref ref-type="bibr" rid="bib77">Roxo et al., 2011</xref>; <xref ref-type="bibr" rid="bib25">Dalgleish, 2004</xref>). We suggest that some of the functions we have identified in the MB IC could be mapped to limbic system structures (see <xref ref-type="fig" rid="fig13">Figure 13</xref>).</p><fig id="fig13" position="float"><label>Figure 13.</label><caption><title>The mammalian limbic system as described by <xref ref-type="bibr" rid="bib69">Papez, 1937</xref> and <xref ref-type="bibr" rid="bib59">Maclean, 1949</xref> and the suggested parallels in the proposed incentive circuit.</title><p>On the left, we show the mushroom body microcircuits that correspond to the different structures in the mammalian limbic system. In the centre, we have the connections among the different structures of the limbic system. On the right, we show the groups of mushroom body neurons we suggest that have a similar function to the ones in the limbic system.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig13-v1.tif"/></fig><p>More specifically, the α′/β′-KCs could have a similar role to the neurons in the thalamus, α/β-KCs represent a higher abstraction of the input stimuli and have a similar role to the ones in the sensory cortex, while the γ-KCs represent relatively unprocessed stimuli. This would make the susceptible MBONs parallel to neurons in the amygdala, creating responses related to primitive motivations and connecting to (inhibiting) the restrained MBONs, which we would compare to the hypothalamus as providing the main control of behaviour. As we suggest that the same MBONs could fulfil a role as LTM or restrained in different circuits (see <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>), the LTM would also correspond to hypothalamus, with input from the α′/β′-KCs, and thus the RSM, RLM, LTM, and MAM microcircuits are assumed to correspond to hypothalamus functions. Following this analogy, we predict that the function of the cingulate cortex then is represented by the α/β MBONs, encoding the ‘emotions’ of the animal towards reinforced stimuli, potentially controlling more sophisticated decision-making. This mapping would suggest the connections amongst the restrained/LTM (α′/β′) MBONs and the ‘emotional’ (α/β) MBONs are similar to the hippocampus and anterior thalamus pathways.</p><p>While it might seem startling to suggest that a compact circuit of single identified neurons in the insect MB mimics in miniature these far larger and more complex structures in the mammalian brain, the justification comes from the similarity in the behavioural demands common to all animals: surviving and adapting in a changing world.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Implementation of the incentive circuit</title><p>We represent the connections between neurons by using synaptic weight matrices and non-linearly transform the information passing from one neuron to another by using an activation function. Next, we define these parameters and some properties of our computational model, which are not a result of unconstrained optimisation and are consistent throughout all our experiments.</p><sec id="s4-1-1"><title>Parameters of the model</title><p>We assume that the odour identity passes through the projection neurons (PNs) into the mushroom body and its Kenyon cells (KCs). It is not in the scope of this work to create a realistic encoding of the odour in the PNs, so we assume that the odour signal is represented by <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> PNs, one for each odour, and that these project to form distinct activations in a set of <inline-formula><mml:math id="inf160"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>k</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> KCs in the MB, that is, a subset of KCs that respond to the specific odours used in the experiments. Therefore, the vector <inline-formula><mml:math id="inf161"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mtext>A</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> represents the activity of the PNs when odour A is detected, <inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mtext>B</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> when odour B, <inline-formula><mml:math id="inf163"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mtext>AB</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> when both odours, and <inline-formula><mml:math id="inf164"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="normal">∅</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> when none of them is detected. The responses of the KCs are calculated by<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi mathvariant="bold">k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:msub><mml:mi mathvariant="normal">T</mml:mi><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi mathvariant="bold">k</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>η</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.001</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is some Gaussian noise, <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the weights matrix that allows the transformation of the two-dimensional odour signal into the ten-dimensional KC responses, and <italic>t</italic> is the current time-step. The WTA<sub>0.5</sub> [<italic>x</italic>] is an activation function that keeps the top 50% of KCs active, based on the strength of their activity. Note that the number of neurons we are using for PNs and KCs is not very important, and we could use any combination of PN and KC populations. However, the bigger the KC population the smaller percentage of them should be active. The PN→KC synaptic weights used are shown as<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>p2k</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.8</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The odours are represented by different firing patterns across 10 KCs: 4 fire only for A, and 3 fire only for B, while the remaining 3 fire to either odour. This is to show the effects of the DPR when we have overlap in the KCs that respond to the two odours used in the conditioning paradigm. This assumption also created the best fit with the data, suggesting that there might be overlapping KCs encoding the real odours tested in the fly experiments.</p><p>We transform the reinforcement (US), <inline-formula><mml:math id="inf167"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, delivery into an input for the DANs by using the weights matrix <inline-formula><mml:math id="inf168"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>u2d</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℝ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>d</mml:mtext></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. We represent the activity of the DANs, <inline-formula><mml:math id="inf169"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, with a six-dimensional vector, where each dimension represents a different neuron in our model. Specifically,<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>at</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>av</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>at</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>av</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>at</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>av</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The US is represented by a two-dimensional vector where the first dimension denotes rewarding signal and the second dimension denotes punishment: <inline-formula><mml:math id="inf170"><mml:mrow><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>sugar</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf171"><mml:mrow><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mtext>shock</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; and the contribution of this vector to the responses of the DANs is given by<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>u2d</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In line with the DANs vector representation, we have a similar vector for MBONs, <inline-formula><mml:math id="inf172"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, where each dimension represents the response of a specific neuron in time <inline-formula><mml:math id="inf173"><mml:mi>t</mml:mi></mml:math></inline-formula> as is shown in the following equation:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mtext>at</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mtext>av</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mtext>at</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mtext>av</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>at</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>av</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The weight matrix that encodes the contribution of KCs to the MBON responses, <inline-formula><mml:math id="inf174"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, is initialised as<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>k</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which effectively is a <inline-formula><mml:math id="inf175"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> matrix of ones. In other words, all KCs connect to all MBONs, and their initial weight is positive and the same for all connections. As these are plastic weights, their value depends on the time-step, and therefore we provide time, <inline-formula><mml:math id="inf176"><mml:mi>t</mml:mi></mml:math></inline-formula>, as a parameter. Note that also <inline-formula><mml:math id="inf177"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mtext>rest</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, which initially results in the absence of memory, <inline-formula><mml:math id="inf178"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mtext>rest</mml:mtext></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Thus, any deviation of the synaptic weights from their resting value represents a stored memory with strength <inline-formula><mml:math id="inf179"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>mem</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true">||</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mtext>rest</mml:mtext></mml:msub></mml:mrow><mml:mo fence="true">||</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>There are also MBON→DAN, <inline-formula><mml:math id="inf180"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>m2d</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mn>6</mml:mn><mml:mo>×</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and MBON→MBON connections, <inline-formula><mml:math id="inf181"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>m2m</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mn>6</mml:mn><mml:mo>×</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, which are given by<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>m2d</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.5</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.5</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.3</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.5</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.3</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.5</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>m2m</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The above matrices summarise the excitatory (positive) and inhibitory (negative) connections between MBONs and DANs or other MBONs as defined in the IC (<xref ref-type="fig" rid="fig3">Figure 3</xref>, see also <xref ref-type="fig" rid="fig14">Figure 14</xref>). The sign of the weights was fixed but the magnitude of the weights was hand-tuned in order to get the desired result, given the constraint that equivalent types of connections should be the same weight (e.g., in the reciprocal microcircuits). The magnitude of the synaptic weights specifies the effective strength of each of the described microcircuits in the overall circuit. We also add some bias to the responses of DANs, <inline-formula><mml:math id="inf182"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mtext>d</mml:mtext></mml:msub></mml:math></inline-formula>, and MBONs, <inline-formula><mml:math id="inf183"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:math></inline-formula>, which is fixed as<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mtext>d</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><fig-group><fig id="fig14" position="float"><label>Figure 14.</label><caption><title>The synaptic weights and connections among the neurons of the incentive circuit (IC).</title><p>Each panel corresponds to a different synaptic weights matrix of the circuit. The size of the circles when the presynaptic axon crosses the postsynaptic dendrite shows how strong a connection is, and the colour shows the sign (blue for inhibition, red for excitation). Light-green stars show where the synaptic plasticity takes place and how the dopaminergic neurons (DANs) modulate the synaptic weights between Kenyon cells (KCs) and mushroom body output neurons (MBONs).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig14-v1.tif"/></fig><fig id="fig14s1" position="float" specific-use="child-fig"><label>Figure 14—figure supplement 1.</label><caption><title>The responses of the dopaminergic neurons (DANs) and mushroom body output neuron (MBONs) of the circuit when altering the presynaptic strengths of MBONs during the reversal condition.</title><p>Each column corresponds to the responses of a different neuron. Odd and even rows show the responses of the neurons to odours A and B, respectively. Pairs of rows (consecutive odours A and B) show the responses of the neurons for the different values of the target parameter (indicated in the first column). Black dashed line shows the responses of the neurons for the chosen (*) parameter. The different colour codes show the responses of the neurons for the different (absolute) values of the target parameter as indicated in the colour bar on the bottom left.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig14-figsupp1-v1.tif"/></fig><fig id="fig14s2" position="float" specific-use="child-fig"><label>Figure 14—figure supplement 2.</label><caption><title>The responses of the dopaminergic neurons (DANs) and mushroom body output neurons (MBONs) of the circuit when altering the DA modulation strengths during the reversal condition.</title><p>Each column corresponds to the responses of a different neuron. Odd and even rows show the responses of the neurons to odours A and B, respectively. Pairs of rows (consecutive odours A and B) show the responses of the neurons for the different values of the target parameter (indicated in the first column). Black dashed line shows the responses of the neurons for the chosen (*) parameter. The different colour codes show the responses of the neurons for the different values of the target parameter as indicated in the colour bar on the bottom left.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig14-figsupp2-v1.tif"/></fig><fig id="fig14s3" position="float" specific-use="child-fig"><label>Figure 14—figure supplement 3.</label><caption><title>The responses of the dopaminergic neurons (DANs) and mushroom body output neurons (MBONs) of the circuit when altering the DAN and MBON biases during the reversal condition.</title><p>Each column corresponds to the responses of a different neuron. Odd and even rows show the responses of the neurons to odours A and B, respectively. Pairs of rows (consecutive odours A and B) show the responses of the neurons for the different values of the target parameter (indicated in the first column). Black dashed line shows the responses of the neurons for the chosen (*) parameter. The different colour codes show the responses of the neurons for the different values of the target parameter as indicated in the colour bar on the bottom left.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig14-figsupp3-v1.tif"/></fig></fig-group><p>This bias can be interpreted as the resting value of the neurons or some external input from other neurons that are not included in our model.</p><p>Finally, we define the DAN function matrix, <inline-formula><mml:math id="inf184"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>d2km</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>d</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, which transforms the responses of the DANs into the dopamine factor that modulates the <inline-formula><mml:math id="inf185"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> synaptic weights, and it is given as<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>d2km</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.3</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0.3</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>All the parameters described above are illustrated in <xref ref-type="fig" rid="fig14">Figure 14</xref>. <xref ref-type="fig" rid="fig14s1">Figure 14—figure supplement 1</xref>, <xref ref-type="fig" rid="fig14s2">Figure 14—figure supplement 2</xref>, and <xref ref-type="fig" rid="fig14s3">Figure 14—figure supplement 3</xref> show how each of these parameters affects the responses of the neurons in the IC. The last thing left to describe is the activation function, which is used in order to generate the DAN and MBON responses. This is<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mi>ϱ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">x</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>x</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">x</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>which is the <italic>rectified linear unit</italic> (ReLU) function, bounded in <inline-formula><mml:math id="inf186"><mml:mrow><mml:mrow><mml:mi>ϱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The reason why we bound the activity is to avoid having extremely high values that explode during the charging of the LTM.</p></sec><sec id="s4-1-2"><title>Forward propagation</title><p>For each time-step, <inline-formula><mml:math id="inf187"><mml:mi>t</mml:mi></mml:math></inline-formula>, we read the environment and propagate the information through the model in order to update the responses of the neurons and the synaptic weights. This process is called <italic>forward propagation,</italic> and we repeat it as long as the experiment runs.</p><p>First, we read the CS, <inline-formula><mml:math id="inf188"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and US, <inline-formula><mml:math id="inf189"><mml:mrow><mml:mi mathvariant="bold">u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, from the environment and calculate the KC responses by using <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>. In order to calculate the DANs and MBONs update, we define the differential equations as follows:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mtext>u2d</mml:mtext></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mtext>m2d</mml:mtext></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>d</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mtext>m2m</mml:mtext></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf190"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> is a time-constant that is defined by the number of time-steps associated in each trial, <inline-formula><mml:math id="inf191"><mml:mi>T</mml:mi></mml:math></inline-formula> denotes the transpose operation of the matrix or vector, and <inline-formula><mml:math id="inf192"><mml:mrow><mml:mi mathvariant="bold">m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">m</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf193"><mml:mrow><mml:mi mathvariant="bold">d</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are functions of time. Using the above differential equations, we calculate the updated responses (i.e., responses in the next time-step, <inline-formula><mml:math id="inf194"><mml:mi>t</mml:mi></mml:math></inline-formula>) as<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>ϱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>τ</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>ϱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>τ</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Finally, we calculate the dopaminergic factor, <inline-formula><mml:math id="inf195"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, and update the KC→MBON synaptic weights as<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mtext>d2km</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>*</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mtext>rest</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where ‘*’ denotes the element-wise multiplication, <inline-formula><mml:math id="inf196"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mtext>rest</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is the resting value of the weights, and <inline-formula><mml:math id="inf197"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is a function of time. Note that element-wise multiplication means that each element of the <inline-formula><mml:math id="inf198"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> vector will be multiplied with each column of the <inline-formula><mml:math id="inf199"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> matrix. Also, the element-wise addition of the transposed vector, <inline-formula><mml:math id="inf200"><mml:mrow><mml:msup><mml:mi mathvariant="bold">k</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, to the <inline-formula><mml:math id="inf201"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> matrix, means that we add each element of <inline-formula><mml:math id="inf202"><mml:mrow><mml:mi mathvariant="bold">k</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to the corresponding row of <inline-formula><mml:math id="inf203"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mtext>k2m</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We repeat the above procedure as many times as it is required in order to complete the running experimental paradigm routine.</p></sec><sec id="s4-1-3"><title>Modelling the neural responses</title><p>To emulate the acquisition and forgetting paradigms used for flies, we run the simulated circuit in an experiment that consists of <inline-formula><mml:math id="inf204"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>73</mml:mn></mml:mrow></mml:math></inline-formula> time-steps. Each time-step actually comprises four repeats of the forward propagation update described above to smooth out any bias due to the order of computations (value vs. weights update). After the initialisation time-step at <inline-formula><mml:math id="inf205"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, there are 24 <italic>trials</italic> where each trial consists of 3 <italic>in-trial time-steps</italic>.</p><p>Within each trial, the first time-step has no odour, and in the second and third time-steps, odour is presented: odour A on even trials and odour B on odd trials. A trial can have no shock (<xref ref-type="fig" rid="fig15">Figure 15A</xref>), unpaired shock presented in the first time-step (<xref ref-type="fig" rid="fig15">Figure 15B</xref>), or paired shock presented in the third time-step (<xref ref-type="fig" rid="fig15">Figure 15C</xref>). The first two trials compose the ‘pre-training phase’, where we expose the model to the two odours alternately (i.e., odour A in trial 1 and odour B in trial 2) without shock delivery. Then we have the acquisition phase, where we deliver shock paired with odour B for 10 trials (five trials per odour; <xref ref-type="fig" rid="fig15">Figure 15D</xref>). Before we proceed to the forgetting phases, we leave two empty trials (one per odour), which we call the <italic>resting trials</italic>. The forgetting phases last for another 10 trials (five trials per odour; <xref ref-type="fig" rid="fig15">Figure 15E–G</xref>). During the extinction phase, no shock is delivered while we continue alternating the odours (see <xref ref-type="fig" rid="fig15">Figure 15E</xref>); during the unpaired phase, shock is delivered unpaired from odour A (see <xref ref-type="fig" rid="fig15">Figure 15F</xref>); while at the reversal phase shock is paired with odour A (<xref ref-type="fig" rid="fig15">Figure 15G</xref>).</p><fig id="fig15" position="float"><label>Figure 15.</label><caption><title>Description of the simulation process from our experiments.</title><p>A single trial is composed of three in-trial time-steps and each time-step by four repeats. Odour is provided only during the second and third in-trial time-steps, while shock delivery is optional. (<bold>A</bold>) In an extinction trial, only odour (CS) is delivered. (<bold>B</bold>) During an unpaired trial, shock is delivered during in-trail time-step 1. (<bold>C</bold>) During a paired trial, shock is delivered along with odour delivery and during in-trial time-step 3. (<bold>D</bold>) The acquisition phase has five odour A-only trials and five paired odour B trials alternating. (<bold>E</bold>) The extinction phase has five odour A-only trials and five odour B-only trials alternating. (<bold>F</bold>) The unpaired phase has five odour A unpaired trials and five odour B-only trials alternating. (<bold>G</bold>) The reversal phase has five odour A paired trials and five odour B-only trials alternating. The colours used in this figure match the ones in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig15-v1.tif"/></fig><sec id="s4-1-3-1"><title>The classic unpaired conditioning paradigm</title><p>In this case, during the acquisition phase we deliver only electric shock in odd trials (omission of odour B), followed by an extinction phase as described above.</p></sec></sec></sec><sec id="s4-2"><title>Modelling the behaviour</title><p>The experiments last for <inline-formula><mml:math id="inf206"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>100</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> each, and they are split into three phases as shown in <xref ref-type="fig" rid="fig11">Figure 11A</xref>. In <italic>pre-training</italic>, the flies are placed in the centre of arena and explore freely for <inline-formula><mml:math id="inf207"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>20</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. In <italic>training</italic>, either shock or sugar is associated with the region <inline-formula><mml:math id="inf208"><mml:mrow><mml:mn>30</mml:mn><mml:mtext/><mml:mi class="ltx_unit">cm</mml:mi></mml:mrow></mml:math></inline-formula> around odour A, odour B, or around both sources for <inline-formula><mml:math id="inf209"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>30</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. In <italic>post-training</italic>, we remove the reinforcement and let the flies express their learnt behaviour for another <inline-formula><mml:math id="inf210"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>50</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, creating an extinction forgetting condition. <xref ref-type="fig" rid="fig11">Figure 11B</xref> shows the normalised cumulative time spent experiencing each odour and the odour preference of the flies during the different phases for each of the six training conditions, and for 10 repeats of the experiment, when their behaviour is controlled by a combination of the attractive and repulsive forces on the two odours. The actual paths of the flies for all the 10 repeats are illustrated in <xref ref-type="fig" rid="fig11s4">Figure 11—figure supplement 4</xref>.</p><p>In practice, in order to create the experiences of <inline-formula><mml:math id="inf211"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>fly</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> flies, we have created another routine that embeds the simulation of their motion and environment. We represent the position of each fly, <inline-formula><mml:math id="inf212"><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:mi>ℂ</mml:mi></mml:mrow></mml:math></inline-formula>, and the sources of the odours in the arena, <inline-formula><mml:math id="inf213"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>ℂ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf214"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>ℂ</mml:mi></mml:mrow></mml:math></inline-formula> for odours A and B, respectively, in the 2D space as complex numbers in the form <inline-formula><mml:math id="inf215"><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Therefore, the flies are initialised in <inline-formula><mml:math id="inf216"><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and the sources of the odours are placed in <inline-formula><mml:math id="inf217"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf218"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math></inline-formula>. The standard deviation of the odour distributions is <inline-formula><mml:math id="inf219"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>We get the odour intensity in each time-step by using the Gaussian density functions of the two odours and the position of the fly in the arena<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>∅</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf220"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf221"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf222"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf223"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="normal">∅</mml:mi></mml:msub></mml:math></inline-formula> are the identities of odours A, B, ‘A and B’, and none of them, respectively, in the PNs as described in the ‘Parameters of the model’, and <inline-formula><mml:math id="inf224"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mtext>CS</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula> is the detection threshold for the odour. Note that PN responses depend only on the fact that an odour has been detected or not and it is not proportional to the detected intensity. The reinforcement is applied to the simulated fly when the position of the agent is inside a predefined area around the odour, that is, <inline-formula><mml:math id="inf225"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mtext>US</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf226"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mtext>US</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> is the radius of the reinforced area. Note that the radius of the area where the odour is detectable is roughly <inline-formula><mml:math id="inf227"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mtext>CS</mml:mtext></mml:msub><mml:mo>≃</mml:mo><mml:mn>0.58</mml:mn></mml:mrow></mml:math></inline-formula>, which is larger than the reinforced area. Then we run a forward propagation using the above inputs.</p><p>From the updated responses of the MBONs, we calculate the <italic>attraction force</italic>, <inline-formula><mml:math id="inf228"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, for the mixture of odours which modulates the velocity of the fly. This force is calculated by taking the difference between the responses of the MBONs that drive the behaviour:<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>at</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext>CS</mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mtext>at</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mtext>at</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mtext>at</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">B</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>av</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext>CS</mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mtext>av</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mtext>av</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mtext>av</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">B</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ24">.<label>(24)</label><mml:math id="m24"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>at</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext>CS</mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>av</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext>CS</mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf229"><mml:msub><mml:mi>μ</mml:mi><mml:mtext>CS</mml:mtext></mml:msub></mml:math></inline-formula> is the position of the odour source and <inline-formula><mml:math id="inf230"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>CS</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of being closer to the specific CS source calculated using the Gaussian distribution function and the Bayesian theorem. For example, given that the prior probability of being closer to odours A and B is equal at any time, that is, <inline-formula><mml:math id="inf231"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, the probability of being closer to odour A is given by<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>A</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>A</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mtext>A</mml:mtext></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>A</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mtext>A</mml:mtext></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>B</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mtext>B</mml:mtext></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The velocity of the simulated fly is updated as follows<disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:msub><mml:mi>ε</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ27"><label>(27)</label><mml:math id="m27"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo fence="true">||</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo fence="true">||</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We normalise the velocity so that we keep the direction but replace the step size with <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.05</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The noise added to the velocity is introduced in order to enable the flies to move in two dimensions and not just between the two odour sources. Also, when the attraction force is <inline-formula><mml:math id="inf233"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, then the noise along with the previous velocity is the one that drives the flies.</p><p>We repeat the above process for <inline-formula><mml:math id="inf234"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> time-steps with <inline-formula><mml:math id="inf235"><mml:mrow><mml:mn>1</mml:mn><mml:mtext/><mml:mi class="ltx_unit">Hz</mml:mi></mml:mrow></mml:math></inline-formula> (one time-step per second), and we provide shock or sugar (when appropriate) between time-steps 20 and 50, otherwise we use a zero-vector as US input to the DANs.</p></sec><sec id="s4-3"><title>Calculating the normalised cumulative exposure and the preference Index</title><p>In <xref ref-type="fig" rid="fig11">Figure 11B</xref>, for each phase (i.e., pre-training, training, and post-training), we report the normalised cumulative exposure of the flies in each odour and their PI between them. The normalised cumulative exposure is calculated by<disp-formula id="equ28"><label>(28)</label><mml:math id="m28"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mtext>CS, phase</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mtext>CS, phase</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>phase</mml:mtext></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf236"><mml:mi>R</mml:mi></mml:math></inline-formula> is the repeat of the experiment, <italic>i</italic> is the iterative repeat, <inline-formula><mml:math id="inf237"><mml:msub><mml:mi>T</mml:mi><mml:mtext>phase</mml:mtext></mml:msub></mml:math></inline-formula> is the number of time-steps for the specific phase, and <inline-formula><mml:math id="inf238"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mtext>CS,phase</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of time-steps spent exposed in the specific CS <inline-formula><mml:math id="inf239"><mml:mrow><mml:mi/><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mtext>A</mml:mtext><mml:mo>,</mml:mo><mml:mtext>B</mml:mtext><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, phase, and repeat.</p><p>The preferences index for every repeat is calculated using the above quantities<disp-formula id="equ29"><label>(29)</label><mml:math id="m29"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mtext>PI</mml:mtext><mml:mtext>phase</mml:mtext><mml:mi>R</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mtext>A, phase</mml:mtext><mml:mi>R</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mtext>B, phase</mml:mtext><mml:mi>R</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mtext>A, phase</mml:mtext><mml:mi>R</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mtext>B, phase</mml:mtext><mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-4"><title>The reward prediction error plasticity rule</title><p>In <xref ref-type="fig" rid="fig9s2">Figure 9—figure supplement 2</xref>, <xref ref-type="fig" rid="fig9s3">Figure 9—figure supplement 3</xref>, <xref ref-type="fig" rid="fig11s5">Figure 11—figure supplement 5</xref>, and <xref ref-type="fig" rid="fig11s6">Figure 11—figure supplement 6</xref>, we present the responses and synaptic weights of the IC neurons, and the behaviour of the simulated flies using the RPE plasticity rule. This was done by replacing our plasticity rule in <xref ref-type="disp-formula" rid="equ19">Equation 19</xref> with the one below:<disp-formula id="equ30"><label>(30)</label><mml:math id="m30"><mml:mrow><mml:mi>τ</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mtext>k2m</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∗</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-5"><title>Derivation of the dopaminergic plasticity rule</title><p><xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref> suggest that ER-Ca<sup>2+</sup> and cAMP play a decisive role in the dynamics of forward and backward conditioning. More specifically, they suggest that the KC→MBON synaptic change, <inline-formula><mml:math id="inf240"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, is proportional to the combined ER-Ca<sup>2+</sup> and cAMP levels, which can be written formally as<disp-formula id="equ31"><label>(31)</label><mml:math id="m31"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>ER-Ca</mml:mtext><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>cAMP</mml:mtext><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We assume that ER-Ca<sup>2+</sup> and cAMP levels are determined by information available in the local area of the target KC axon (presynaptic terminal): the dopamine (DA) level emitted by the DANs to the KC synapses of the respective (<italic>j</italic><sup>th</sup>) MBON, <inline-formula><mml:math id="inf241"><mml:mrow><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>; the activity of the (<italic>i</italic><sup>th</sup>) presynaptic KC, <inline-formula><mml:math id="inf242"><mml:mrow><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>; the respective KC→MBON synaptic weight; <inline-formula><mml:math id="inf243"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (assumed always positive, exciting the MBON), and the resting synaptic weights, <inline-formula><mml:math id="inf244"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mtext>rest</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:mi>ℝ</mml:mi></mml:mrow></mml:math></inline-formula>, which we assume are a constant parameter of the synapse. Tuning the above quantities in order to reproduce the ER-Ca<sup>2+</sup> and cAMP levels, we postulate a mathematical formulation of the latter as a function of the available information<disp-formula id="equ32"><label>(32)</label><mml:math id="m32"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>ER-Ca</mml:mtext><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>∝</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mo>△</mml:mo><mml:mi>j</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mtext>rest</mml:mtext></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mo>△</mml:mo><mml:mi>j</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mi>▽</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ33"><label>(33)</label><mml:math id="m33"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>cAMP</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi/><mml:mo>∝</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi mathvariant="normal">▽</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mtext>rest</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf245"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi mathvariant="normal">▽</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf246"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi mathvariant="normal">△</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the depression and potentiation components of the DA, respectively (assumed to correspond to DopR1 and DopR2 receptors [<xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>] or potentially to involve co-transmitters released by the DAN such as nitric oxide [<xref ref-type="bibr" rid="bib8">Aso et al., 2019</xref>]). We assume two types of DAN terminals: the depressing and potentiating terminals. In depressing terminals (arrow down), <inline-formula><mml:math id="inf247"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi mathvariant="normal">▽</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> makes a higher peak in its activity followed by a faster diffusion than <inline-formula><mml:math id="inf248"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi mathvariant="normal">△</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which seems to be the key for the backward conditioning. The opposite happens in potentiating DAN terminals. <xref ref-type="fig" rid="fig16">Figure 16</xref> shows the ER-Ca<sup>2+</sup> and cAMP levels during forward and backward conditioning for a depressing DAN [see <xref ref-type="fig" rid="fig16s1">Figure 16—figure supplement 1</xref> for the responses of all the terms used including <inline-formula><mml:math id="inf249"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi mathvariant="normal">▽</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf250"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi mathvariant="normal">△</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>], which are comparable to the data shown in <xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref> (also <xref ref-type="fig" rid="fig16">Figure 16</xref>, shown in grey). Note that here we are more interested in the overall effects of learning shown in <xref ref-type="fig" rid="fig16">Figure 16A</xref> rather than the detailed responses of <xref ref-type="fig" rid="fig16">Figure 16B</xref>.</p><fig-group><fig id="fig16" position="float"><label>Figure 16.</label><caption><title>The effect of the ER-Ca<sup>2+</sup> and cAMP based on the order of the conditional stimuli (CS) and unconditional stimuli (US).</title><p>(<bold>A</bold>) Normalised mean change of the synaptic weight plotted as a function of the <inline-formula><mml:math id="inf251"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> (US start – CS start), similar to <xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>, <xref ref-type="fig" rid="fig5">Figure 5F</xref> (blue line). For ease of comparison, the predicted mean values are drawn on the top of the data (mean ± SEM) from the original paper (<xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>); grey lines and error bars. (<bold>B</bold>) Detailed ER-Ca<sup>2+</sup> and cAMP responses reproduced for the different <inline-formula><mml:math id="inf252"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>, and their result synaptic weight change. Black arrowhead marks the time of the CS (duration <inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.5</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>); red arrowhead marks the time of the US (duration <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.6</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), similar to <xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>, <xref ref-type="fig" rid="fig5">Figure 5D</xref>. For ease of comparison, the predicted responses are drawn on the top of the data from the original paper (<xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>); grey lines.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig16-v1.tif"/></fig><fig id="fig16s1" position="float" specific-use="child-fig"><label>Figure 16—figure supplement 1.</label><caption><title>All the chemical levels and neural activities calculated based on the order of the conditional stimuli (CS) and unconditional stimuli (US).</title><p>Black arrowhead marks the time of the CS (duration <inline-formula><mml:math id="inf255"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.5</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>); red arrowhead marks the time of the US (duration <inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.6</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), similar to <xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>, Figure 5D. Predicted ER-Ca<sup>2+</sup>, cAMP, and the plasticity effect responses are drawn on top of the data from the original paper (<xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>), grey lines.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig16-figsupp1-v1.tif"/></fig><fig id="fig16s2" position="float" specific-use="child-fig"><label>Figure 16—figure supplement 2.</label><caption><title>Parameter exploration of the <inline-formula><mml:math id="inf257"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>short</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf258"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>long</mml:mtext></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ36">Equation 35</xref> and <xref ref-type="disp-formula" rid="equ37">Equation 36</xref>.</title><p>For the combinations of <inline-formula><mml:math id="inf259"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>short</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>150</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf260"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>long</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>150</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we calculate the Pearson correlation coefficient between the predicted normalised mean change of the synaptic weight and the one extracted from the data of <xref ref-type="bibr" rid="bib38">Handler et al., 2019</xref>, and we report the r and p values. With ‘x’ we mark the pair of parameters with the highest correlation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-fig16-figsupp2-v1.tif"/></fig></fig-group><p>By replacing <xref ref-type="disp-formula" rid="equ32">Equation 32</xref> and <xref ref-type="disp-formula" rid="equ33">Equation 33</xref> in <xref ref-type="disp-formula" rid="equ31">Equation 31</xref>, we can rewrite the update rule as a function of known quantities, forming our DPR of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, which we rewrite for convenience<disp-formula id="equ34"><mml:math id="m34"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mo>△</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>▽</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The <italic>dopaminergic factor</italic>, <inline-formula><mml:math id="inf261"><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is the difference between the <inline-formula><mml:math id="inf262"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi mathvariant="normal">▽</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf263"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi mathvariant="normal">△</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> levels, and it can be positive [<inline-formula><mml:math id="inf264"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mo>△</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>▽</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>] or negative [<inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>▽</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mo>△</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>]. Combined with the state of the KC activity results in the four different weight modulation effects: <italic>depression</italic>, <italic>potentiation</italic>, <italic>recovery,</italic> and <italic>saturation</italic>.</p><p>In <xref ref-type="fig" rid="fig16">Figure 16B</xref> (where we assume a depressing DAN terminal), all four effects occur in four out of the six cases, creating complicated dynamics that allow forward and backward learning. Similarly, a potentiating terminal might trigger all the effects in a row but in different order and duration. Note that in the simulations run for the results of this paper, we simplify the dopaminergic factor to have a net positive or negative value for the time-step in which it influences the synaptic weight change as the time-steps used are long enough (e.g., around <inline-formula><mml:math id="inf266"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>; see ‘Implementation of the incentive circuit’ section), and we assume less complicated interchange among the effects.</p><p>In <xref ref-type="fig" rid="fig16">Figure 16A</xref>, we report the normalised mean change of the synaptic weight calculated using the computed ER-Ca<sup>2+</sup> and cAMP levels and the following formula:<disp-formula id="equ35"><label>(34)</label><mml:math id="m35"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>ER-Ca</mml:mtext><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>cAMP</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><sec id="s4-5-1"><title>Decomposing the dopaminergic factor</title><p>In <xref ref-type="disp-formula" rid="equ18">Equation 18</xref>, the dopaminergic factor, <inline-formula><mml:math id="inf267"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is derived from the matrix <xref ref-type="disp-formula" rid="equ12">Equation 12</xref> which captures in abstracted and time-independent form the effects of dopamine release. To model these more explicitly, as described in the ‘Derivation of the dopaminergic plasticity rule’, the dopaminergic factor can be decomposed as <inline-formula><mml:math id="inf268"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="normal">△</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="normal">▽</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where each component has a time-dependent form given by the differential equations<disp-formula id="equ36"><label>(35)</label><mml:math id="m36"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>▽</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>long</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>short</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>short</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>long</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>▽</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ37"><label>(36)</label><mml:math id="m37"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mo>△</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>short</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>long</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>short</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>long</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mo>△</mml:mo></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf269"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf270"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> represent the positive-only (potentiation/saturation) and negative-only (depression/recovery) dopaminergic effects; <inline-formula><mml:math id="inf271"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is a vector of the responses of all DANs as a function of time, <italic>t</italic>; <inline-formula><mml:math id="inf272"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>▽</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi>▽</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> nd <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="normal">△</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="normal">△</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are the depression and potentiation components of the DA as functions of time, <italic>t;</italic> and <inline-formula><mml:math id="inf274"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>short</mml:mtext></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf275"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are the exponential decay time-constants that define the short (main) and long (secondary) durations of the dopamine effect. The longer the time constant, the slower the diffusion but also the lower the peak of the effect. Note that the two time constants must satisfy the constraint <inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>short</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>long</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mo>≤</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> in order for the above differential equations to work properly.</p><p>In <xref ref-type="fig" rid="fig16">Figure 16</xref>, where we are interested in more detailed dynamics of the plasticity rule, and the sampling frequency is high, that is, <inline-formula><mml:math id="inf277"><mml:mrow><mml:mn>100</mml:mn><mml:mtext/><mml:mi class="ltx_unit">Hz</mml:mi></mml:mrow></mml:math></inline-formula>, we use <inline-formula><mml:math id="inf278"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>short</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf279"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>long</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>104</mml:mn></mml:mrow></mml:math></inline-formula>, which we choose after a parameter exploration available in <xref ref-type="fig" rid="fig16s2">Figure 16—figure supplement 2</xref>. This essentially means that <inline-formula><mml:math id="inf280"><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="normal">▽</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf281"><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="normal">△</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are expressed as time-varying functions following DAN spike activity. Note that for the specific (susceptible) type of MBON examined there, the DAN causes depression of the synapse, so there is no positive dopaminergic effect, that is, <inline-formula><mml:math id="inf282"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. By setting <inline-formula><mml:math id="inf283"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ36">Equation 35</xref> and <xref ref-type="disp-formula" rid="equ37">Equation 36</xref>, we have the fast update with the high peak for <inline-formula><mml:math id="inf284"><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="normal">▽</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf285"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.5</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for a full update) and a slower update with lower peak for <inline-formula><mml:math id="inf286"><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="normal">△</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf287"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for a full update), as described in the ‘Derivation of the dopaminergic plasticity rule’ section.</p><p>For the experiments in <xref ref-type="fig" rid="fig4">Figures 4</xref> and <xref ref-type="fig" rid="fig11">11</xref>, we use <inline-formula><mml:math id="inf288"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>short</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf289"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>long</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, which removes the dynamics induced by the relation between <inline-formula><mml:math id="inf290"><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="normal">▽</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf291"><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="normal">△</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <xref ref-type="disp-formula" rid="equ18">Equation 18</xref> emerges from:<disp-formula id="equ38"><label>(37)</label><mml:math id="m38"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>△</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mi>▽</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mi>τ</mml:mi><mml:mtext>short</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mi>τ</mml:mi><mml:mtext>long</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>This essentially means that each update represents a time-step that is longer than the effective period of backward conditioning for the responses of the ‘Microcircuits of the mushroom body’ and ‘Modelling the behaviour’ sections (where sampling frequency is low, i.e., ≤<inline-formula><mml:math id="inf292"><mml:mrow><mml:mn>0.5</mml:mn><mml:mtext/><mml:mi class="ltx_unit">Hz</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf293"><mml:mrow><mml:mn>1</mml:mn><mml:mtext/><mml:mi class="ltx_unit">Hz</mml:mi></mml:mrow></mml:math></inline-formula>, respectively), and therefore, we use the same time constants that result in the simplified <xref ref-type="disp-formula" rid="equ18">Equation 18</xref>.</p></sec></sec><sec id="s4-6"><title>Data collection</title><p>In order to verify the plausibility of the IC, we recorded the neural activity in genetically targeted neurons during aversive olfactory conditioning which is described in more detail in <xref ref-type="bibr" rid="bib63">McCurdy et al., 2021</xref>. We simultaneously expressed the green GCaMP<sub>6</sub>f Ca<sup>2+</sup> indicator and red Ca<sup>2+</sup>-insensitive tdTomato in neurons of interest to visualise the Ca<sup>2+</sup> changes which reflect the neural activity. We collected data from 357 five-to-eight-day-old female flies (2–14 per neuron; eight flies on average) and for 43 neurons, which can be found in <xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref> (also illustrated in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><p>Each fly was head-fixed for simultaneous delivery of odours and electric shock while recording the neural activity. Their proboscis was also glued, while their body and legs were free to move (see <xref ref-type="fig" rid="fig4">Figure 4A</xref>). The flies were allowed to recover from the gluing process for <inline-formula><mml:math id="inf294"><mml:mrow><mml:mn>15</mml:mn><mml:mtext/><mml:mi>min</mml:mi></mml:mrow></mml:math></inline-formula> before placing them under the microscope. We used green (<inline-formula><mml:math id="inf295"><mml:mrow><mml:mn>555</mml:mn><mml:mtext/><mml:mi class="ltx_unit">nm</mml:mi></mml:mrow></mml:math></inline-formula>) and blue (<inline-formula><mml:math id="inf296"><mml:mrow><mml:mn>470</mml:mn><mml:mtext/><mml:mi class="ltx_unit">nm</mml:mi></mml:mrow></mml:math></inline-formula>) lights to record GCaMP and Tomato signals. We also used 0.1% 3-octanol (OCT) and 0.1% 4-methylcyclohexanol (MCH) for odours A and B, respectively, and the flow rate was kept constant at 500 mL/min for each odour. The flies were allowed to acclimate to the airflow for at least 1 min before starting of the experiment.</p><p>During the experiments, we alternate trials where <inline-formula><mml:math id="inf297"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of each odour is presented <inline-formula><mml:math id="inf298"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> after the (green or red) light is on. We start with two pre-training trials (one per odour) followed by five acquisition trials per odour. During acquisition, flies receive alternating <inline-formula><mml:math id="inf299"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> pulses of OCT (odour A) and MCH (odour B) paired with electric shock, repeated for five trials. During reversal, OCT is presented with shock and MCH without, repeated for two trials. On trials where electric shock was delivered, it was presented <inline-formula><mml:math id="inf300"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>4</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> after odour onset for <inline-formula><mml:math id="inf301"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>100</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> at <inline-formula><mml:math id="inf302"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>120</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-7"><title>Calculating off- and on-shock values</title><p>From the data collection process described above, we get trials of 100 time-steps and at <inline-formula><mml:math id="inf303"><mml:mrow><mml:mn>5</mml:mn><mml:mtext/><mml:mi class="ltx_unit">Hz</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>20</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> each). Odour is delivered between time-steps 25 and 50 (between <inline-formula><mml:math id="inf305"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf306"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>10</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), and shock is delivered during time-step 45 (at <inline-formula><mml:math id="inf307"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>9</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). In this work, we report two values for each trial: the <italic>off-shock</italic> and <italic>on-shock</italic> values, which represent the average response to the odour before and during the period in which shock delivery could have occurred (even if shock is not delivered).</p><p>For the off-shock value, from each datastream of activity from the target neuron, we collect the values from time-steps between 28 (<inline-formula><mml:math id="inf308"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>5.6</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) and 42 (<inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>8.4</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). This gives us a matrix of <inline-formula><mml:math id="inf310"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>fly</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula> values, whose average and standard deviation are the reported off-shock values. Similarly, for the on-shock values, we collect the values in time-steps between 44 (<inline-formula><mml:math id="inf311"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>8.6</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) and 48 (<inline-formula><mml:math id="inf312"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>9.6</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), which gives a matrix of <inline-formula><mml:math id="inf313"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>fly</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> values, whose average and standard deviation are the on-shock values. We define ‘on-shock’ as the time window from <inline-formula><mml:math id="inf314"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>8.6</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf315"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>9.6</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where shock onset occurs at <inline-formula><mml:math id="inf316"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Funding acquisition, Investigation, Methodology, Project administration, Software, Validation, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Investigation, Project administration, Validation, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Funding acquisition, Project administration, Resources, Supervision, Validation, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Funding acquisition, Methodology, Project administration, Resources, Supervision, Validation, Visualization, Writing – original draft, Writing – review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-75611-transrepform1-v1.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting files. Figure 3—source data 1 contains the numerical data used to generate Figure 3—figure supplement 1, Figure 4—source data 1 contains the numerical data used to generate Figure 4—figure supplement 1 and parts of Figures 5–8. The scripts for producing the data and generating Figures 5 (C, D &amp; E), 6 (C, D &amp; E), 7 (D &amp; E), 8 (C &amp; D), 11B, 12, 16 and all figure supplements are located at <ext-link ext-link-type="uri" xlink:href="https://github.com/InsectRobotics/IncentiveCircuit">https://github.com/InsectRobotics/IncentiveCircuit</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:14169a09189481b91c4649235755f0e9c6a2d8f9;origin=https://github.com/InsectRobotics/IncentiveCircuit;visit=swh:1:snp:c417125a450e976aef1eebc1a239b0e531ecbf79;anchor=swh:1:rev:98a8f85745a1426e8e5b787ceedd3f680a2b66c6">swh:1:rev:98a8f85745a1426e8e5b787ceedd3f680a2b66c6</ext-link>). Figures 5A, 6A, 7A, 7C, 8A, 9A, 9B and Figure 5—figure supplement 1A were generated using the Fly Brain software. All figures were edited using the Inkscape software.</p></sec><ack id="ack"><title>Acknowledgements</title><p>We are grateful to Bertram Gerber for his useful comments on the earlier drafts of the manuscript. We also thank James Bennett for discussion on their data and experiments and Vanessa Ruta for kindly providing their data for validating the dopaminergic plasticity rule. We also thank the Insect Robotics group for helpful critique on the figures and the reviewers on earlier revisions for their fruitful comments.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adel</surname><given-names>M</given-names></name><name><surname>Griffith</surname><given-names>LC</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The Role of Dopamine in Associative Learning in <italic>Drosophila</italic>: An Updated Unified Model</article-title><source>Neuroscience Bulletin</source><volume>37</volume><fpage>831</fpage><lpage>852</lpage><pub-id pub-id-type="doi">10.1007/s12264-021-00665-0</pub-id><pub-id pub-id-type="pmid">33779893</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ardin</surname><given-names>P</given-names></name><name><surname>Peng</surname><given-names>F</given-names></name><name><surname>Mangan</surname><given-names>M</given-names></name><name><surname>Lagogiannis</surname><given-names>K</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Using an Insect Mushroom Body Circuit to Encode Route Memory in Complex Natural Environments</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004683</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004683</pub-id><pub-id pub-id-type="pmid">26866692</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arena</surname><given-names>P</given-names></name><name><surname>Patané</surname><given-names>L</given-names></name><name><surname>Stornanti</surname><given-names>V</given-names></name><name><surname>Termini</surname><given-names>PS</given-names></name><name><surname>Zäpf</surname><given-names>B</given-names></name><name><surname>Strauss</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Modeling the insect mushroom bodies: Application to a delayed match-to-sample task</article-title><source>Neural Networks</source><volume>41</volume><fpage>202</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2012.11.013</pub-id><pub-id pub-id-type="pmid">23246431</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Siwanowicz</surname><given-names>I</given-names></name><name><surname>Bräcker</surname><given-names>L</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name><name><surname>Kitamoto</surname><given-names>T</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Specific Dopaminergic Neurons for the Formation of Labile Aversive Memory</article-title><source>Current Biology</source><volume>20</volume><fpage>1445</fpage><lpage>1451</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2010.06.048</pub-id><pub-id pub-id-type="pmid">20637624</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Hattori</surname><given-names>D</given-names></name><name><surname>Yu</surname><given-names>Y</given-names></name><name><surname>Johnston</surname><given-names>RM</given-names></name><name><surname>Iyer</surname><given-names>NA</given-names></name><name><surname>Ngo</surname><given-names>TTB</given-names></name><name><surname>Dionne</surname><given-names>H</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Axel</surname><given-names>R</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2014">2014a</year><article-title>The neuronal architecture of the mushroom body provides a logic for associative learning</article-title><source>eLife</source><volume>3</volume><elocation-id>e04577</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.04577</pub-id><pub-id pub-id-type="pmid">25535793</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Sitaraman</surname><given-names>D</given-names></name><name><surname>Ichinose</surname><given-names>T</given-names></name><name><surname>Kaun</surname><given-names>KR</given-names></name><name><surname>Vogt</surname><given-names>K</given-names></name><name><surname>Belliart-Guérin</surname><given-names>G</given-names></name><name><surname>Plaçais</surname><given-names>PY</given-names></name><name><surname>Robie</surname><given-names>AA</given-names></name><name><surname>Yamagata</surname><given-names>N</given-names></name><name><surname>Schnaitmann</surname><given-names>C</given-names></name><name><surname>Rowell</surname><given-names>WJ</given-names></name><name><surname>Johnston</surname><given-names>RM</given-names></name><name><surname>Ngo</surname><given-names>TTB</given-names></name><name><surname>Chen</surname><given-names>N</given-names></name><name><surname>Korff</surname><given-names>W</given-names></name><name><surname>Nitabach</surname><given-names>MN</given-names></name><name><surname>Heberlein</surname><given-names>U</given-names></name><name><surname>Preat</surname><given-names>T</given-names></name><name><surname>Branson</surname><given-names>KM</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2014">2014b</year><article-title>Mushroom body output neurons encode valence and guide memory-based action selection in <italic>Drosophila</italic></article-title><source>eLife</source><volume>3</volume><elocation-id>e04580</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.04580</pub-id><pub-id pub-id-type="pmid">25535794</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Dopaminergic neurons write and update memories with cell-type-specific rules</article-title><source>eLife</source><volume>5</volume><elocation-id>e16135</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.16135</pub-id><pub-id pub-id-type="pmid">27441388</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Ray</surname><given-names>RP</given-names></name><name><surname>Long</surname><given-names>X</given-names></name><name><surname>Bushey</surname><given-names>D</given-names></name><name><surname>Cichewicz</surname><given-names>K</given-names></name><name><surname>Ngo</surname><given-names>TT</given-names></name><name><surname>Sharp</surname><given-names>B</given-names></name><name><surname>Christoforou</surname><given-names>C</given-names></name><name><surname>Hu</surname><given-names>A</given-names></name><name><surname>Lemire</surname><given-names>AL</given-names></name><name><surname>Tillberg</surname><given-names>P</given-names></name><name><surname>Hirsh</surname><given-names>J</given-names></name><name><surname>Litwin-Kumar</surname><given-names>A</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Nitric oxide acts as a cotransmitter in a subset of dopaminergic neurons to diversify memory dynamics</article-title><source>eLife</source><volume>8</volume><elocation-id>e49257</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.49257</pub-id><pub-id pub-id-type="pmid">31724947</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baddeley</surname><given-names>B</given-names></name><name><surname>Graham</surname><given-names>P</given-names></name><name><surname>Husbands</surname><given-names>P</given-names></name><name><surname>Philippides</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A Model of Ant Route Navigation Driven by Scene Familiarity</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002336</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002336</pub-id><pub-id pub-id-type="pmid">22241975</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Balkenius</surname><given-names>A</given-names></name><name><surname>Kelber</surname><given-names>A</given-names></name><name><surname>Balkenius</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>From Animals to Animats 9, 9th International Conference on Simulation of Adaptive Behavior, SAB 2006</article-title><conf-name>Proceedings. Lecture Notes in Computer Science</conf-name><fpage>422</fpage><lpage>433</lpage></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bazhenov</surname><given-names>M</given-names></name><name><surname>Huerta</surname><given-names>R</given-names></name><name><surname>Smith</surname><given-names>BH</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A Computational Framework for Understanding Decision Making through Integration of Basic Learning Rules</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>5686</fpage><lpage>5697</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4145-12.2013</pub-id><pub-id pub-id-type="pmid">23536082</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname><given-names>AJ</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>An Information-Maximization Approach to Blind Separation and Blind Deconvolution</article-title><source>Neural Computation</source><volume>7</volume><fpage>1129</fpage><lpage>1159</lpage><pub-id pub-id-type="doi">10.1162/neco.1995.7.6.1129</pub-id><pub-id pub-id-type="pmid">7584893</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bennett</surname><given-names>JEM</given-names></name><name><surname>Philippides</surname><given-names>A</given-names></name><name><surname>Nowotny</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Learning with reinforcement prediction errors in a model of the <italic>Drosophila</italic> mushroom body</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>2569</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-22592-4</pub-id><pub-id pub-id-type="pmid">33963189</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berry</surname><given-names>JA</given-names></name><name><surname>Phan</surname><given-names>A</given-names></name><name><surname>Davis</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dopamine Neurons Mediate Learning and Forgetting through Bidirectional Modulation of a Memory Trace</article-title><source>Cell Reports</source><volume>25</volume><fpage>651</fpage><lpage>662</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2018.09.051</pub-id><pub-id pub-id-type="pmid">30332645</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bilz</surname><given-names>F</given-names></name><name><surname>Geurten</surname><given-names>BRH</given-names></name><name><surname>Hancock</surname><given-names>CE</given-names></name><name><surname>Widmann</surname><given-names>A</given-names></name><name><surname>Fiala</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Visualization of a Distributed Synaptic Memory Code in the <italic>Drosophila</italic> Brain</article-title><source>Neuron</source><volume>106</volume><fpage>963</fpage><lpage>976</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2020.03.010</pub-id><pub-id pub-id-type="pmid">32268119</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brembs</surname><given-names>B</given-names></name><name><surname>Heisenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Conditioning with compound stimuli in <italic>Drosophila melanogaster</italic> in the flight simulator</article-title><source>The Journal of Experimental Biology</source><volume>204</volume><fpage>2849</fpage><lpage>2859</lpage><pub-id pub-id-type="doi">10.1242/jeb.204.16.2849</pub-id><pub-id pub-id-type="pmid">11683440</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burke</surname><given-names>CJ</given-names></name><name><surname>Huetteroth</surname><given-names>W</given-names></name><name><surname>Owald</surname><given-names>D</given-names></name><name><surname>Perisse</surname><given-names>E</given-names></name><name><surname>Krashes</surname><given-names>MJ</given-names></name><name><surname>Das</surname><given-names>G</given-names></name><name><surname>Gohl</surname><given-names>D</given-names></name><name><surname>Silies</surname><given-names>M</given-names></name><name><surname>Certel</surname><given-names>S</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Layered reward signalling through octopamine and dopamine in <italic>Drosophila</italic></article-title><source>Nature</source><volume>492</volume><fpage>433</fpage><lpage>437</lpage><pub-id pub-id-type="doi">10.1038/nature11614</pub-id><pub-id pub-id-type="pmid">23103875</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Busto</surname><given-names>GU</given-names></name><name><surname>Cervantes-Sandoval</surname><given-names>I</given-names></name><name><surname>Davis</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Olfactory Learning in <italic>Drosophila</italic></article-title><source>Physiology (Bethesda, Md.)</source><volume>25</volume><fpage>338</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1152/physiol.00026.2010</pub-id><pub-id pub-id-type="pmid">21186278</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Campbell</surname><given-names>RAA</given-names></name><name><surname>Honegger</surname><given-names>KS</given-names></name><name><surname>Qin</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Demir</surname><given-names>E</given-names></name><name><surname>Turner</surname><given-names>GC</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Imaging a Population Code for Odor Identity in the <italic>Drosophila</italic> Mushroom Body</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>10568</fpage><lpage>10581</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0682-12.2013</pub-id><pub-id pub-id-type="pmid">23785169</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cervantes-Sandoval</surname><given-names>I</given-names></name><name><surname>Phan</surname><given-names>A</given-names></name><name><surname>Chakraborty</surname><given-names>M</given-names></name><name><surname>Davis</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Reciprocal synapses between mushroom body and dopamine neurons form a positive feedback loop required for learning</article-title><source>eLife</source><volume>6</volume><elocation-id>e23789</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.23789</pub-id><pub-id pub-id-type="pmid">28489528</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Claridge-Chang</surname><given-names>A</given-names></name><name><surname>Roorda</surname><given-names>RD</given-names></name><name><surname>Vrontou</surname><given-names>E</given-names></name><name><surname>Sjulson</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Hirsh</surname><given-names>J</given-names></name><name><surname>Miesenböck</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Writing Memories with Light-Addressable Reinforcement Circuitry</article-title><source>Cell</source><volume>139</volume><fpage>405</fpage><lpage>415</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2009.08.034</pub-id><pub-id pub-id-type="pmid">19837039</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cleland</surname><given-names>TA</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Inhibitory glutamate receptor channels</article-title><source>Molecular Neurobiology</source><volume>13</volume><fpage>97</fpage><lpage>136</lpage><pub-id pub-id-type="doi">10.1007/BF02740637</pub-id><pub-id pub-id-type="pmid">8938647</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohn</surname><given-names>R</given-names></name><name><surname>Morantte</surname><given-names>I</given-names></name><name><surname>Ruta</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Coordinated and Compartmentalized Neuromodulation Shapes Sensory Processing in <italic>Drosophila</italic></article-title><source>Cell</source><volume>163</volume><fpage>1742</fpage><lpage>1755</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.11.019</pub-id><pub-id pub-id-type="pmid">26687359</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colomb</surname><given-names>J</given-names></name><name><surname>Kaiser</surname><given-names>L</given-names></name><name><surname>Chabaud</surname><given-names>MA</given-names></name><name><surname>Preat</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Parametric and genetic analysis of <italic>Drosophila</italic> appetitive long‐term memory and sugar motivation</article-title><source>Genes, Brain, and Behavior</source><volume>8</volume><fpage>407</fpage><lpage>415</lpage><pub-id pub-id-type="doi">10.1111/j.1601-183X.2009.00482.x</pub-id><pub-id pub-id-type="pmid">19220480</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dalgleish</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The emotional brain</article-title><source>Nature Reviews. Neuroscience</source><volume>5</volume><fpage>583</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1038/nrn1432</pub-id><pub-id pub-id-type="pmid">15208700</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Mushroom bodies and <italic>Drosophila</italic> learning</article-title><source>Neuron</source><volume>11</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1016/0896-6273(93)90266-t</pub-id><pub-id pub-id-type="pmid">8338661</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delahunt</surname><given-names>CB</given-names></name><name><surname>Riffell</surname><given-names>JA</given-names></name><name><surname>Kutz</surname><given-names>JN</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Biological Mechanisms for Learning: A Computational Model of Olfactory Learning in the Manduca sexta Moth</article-title><source>Frontiers in Computational Neuroscience</source><volume>12</volume><elocation-id>102</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2018.00102</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dubnau</surname><given-names>J</given-names></name><name><surname>Grady</surname><given-names>L</given-names></name><name><surname>Kitamoto</surname><given-names>T</given-names></name><name><surname>Tully</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Disruption of neurotransmission in <italic>Drosophila</italic> mushroom body blocks retrieval but not acquisition of memory</article-title><source>Nature</source><volume>411</volume><fpage>476</fpage><lpage>480</lpage><pub-id pub-id-type="doi">10.1038/35078077</pub-id><pub-id pub-id-type="pmid">11373680</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dylla</surname><given-names>KV</given-names></name><name><surname>Raiser</surname><given-names>G</given-names></name><name><surname>Galizia</surname><given-names>CG</given-names></name><name><surname>Szyszka</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Trace Conditioning in <italic>Drosophila</italic> Induces Associative Plasticity in Mushroom Body Kenyon Cells and Dopaminergic Neurons</article-title><source>Frontiers in Neural Circuits</source><volume>11</volume><elocation-id>42</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2017.00042</pub-id><pub-id pub-id-type="pmid">28676744</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eichler</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>F</given-names></name><name><surname>Litwin-Kumar</surname><given-names>A</given-names></name><name><surname>Park</surname><given-names>Y</given-names></name><name><surname>Andrade</surname><given-names>I</given-names></name><name><surname>Schneider-Mizell</surname><given-names>CM</given-names></name><name><surname>Saumweber</surname><given-names>T</given-names></name><name><surname>Huser</surname><given-names>A</given-names></name><name><surname>Eschbach</surname><given-names>C</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name><name><surname>Fetter</surname><given-names>RD</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Priebe</surname><given-names>CE</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Thum</surname><given-names>AS</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The complete connectome of a learning and memory centre in an insect brain</article-title><source>Nature</source><volume>548</volume><fpage>175</fpage><lpage>182</lpage><pub-id pub-id-type="doi">10.1038/nature23455</pub-id><pub-id pub-id-type="pmid">28796202</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eschbach</surname><given-names>C</given-names></name><name><surname>Fushiki</surname><given-names>A</given-names></name><name><surname>Winding</surname><given-names>M</given-names></name><name><surname>Schneider-Mizell</surname><given-names>CM</given-names></name><name><surname>Shao</surname><given-names>M</given-names></name><name><surname>Arruda</surname><given-names>R</given-names></name><name><surname>Eichler</surname><given-names>K</given-names></name><name><surname>Valdes-Aleman</surname><given-names>J</given-names></name><name><surname>Ohyama</surname><given-names>T</given-names></name><name><surname>Thum</surname><given-names>AS</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name><name><surname>Fetter</surname><given-names>RD</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Litwin-Kumar</surname><given-names>A</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Recurrent architecture for adaptive regulation of learning in the insect brain</article-title><source>Nature Neuroscience</source><volume>23</volume><fpage>544</fpage><lpage>555</lpage><pub-id pub-id-type="doi">10.1038/s41593-020-0607-9</pub-id><pub-id pub-id-type="pmid">32203499</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faghihi</surname><given-names>F</given-names></name><name><surname>Moustafa</surname><given-names>AA</given-names></name><name><surname>Heinrich</surname><given-names>R</given-names></name><name><surname>Wörgötter</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A computational model of conditioning inspired by <italic>Drosophila</italic> olfactory system</article-title><source>Neural Networks</source><volume>87</volume><fpage>96</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2016.11.002</pub-id><pub-id pub-id-type="pmid">28107672</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenberg</surname><given-names>J</given-names></name><name><surname>Barnstedt</surname><given-names>O</given-names></name><name><surname>Cognigni</surname><given-names>P</given-names></name><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Re-evaluation of learned information in <italic>Drosophila</italic></article-title><source>Nature</source><volume>544</volume><fpage>240</fpage><lpage>244</lpage><pub-id pub-id-type="doi">10.1038/nature21716</pub-id><pub-id pub-id-type="pmid">28379939</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenberg</surname><given-names>J</given-names></name><name><surname>Jacob</surname><given-names>PF</given-names></name><name><surname>Walker</surname><given-names>T</given-names></name><name><surname>Barnstedt</surname><given-names>O</given-names></name><name><surname>Edmondson-Stait</surname><given-names>AJ</given-names></name><name><surname>Pleijzier</surname><given-names>MW</given-names></name><name><surname>Otto</surname><given-names>N</given-names></name><name><surname>Schlegel</surname><given-names>P</given-names></name><name><surname>Sharifi</surname><given-names>N</given-names></name><name><surname>Perisse</surname><given-names>E</given-names></name><name><surname>Smith</surname><given-names>CS</given-names></name><name><surname>Lauritzen</surname><given-names>JS</given-names></name><name><surname>Costa</surname><given-names>M</given-names></name><name><surname>Jefferis</surname><given-names>GSXE</given-names></name><name><surname>Bock</surname><given-names>DD</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integration of Parallel Opposing Memories Underlies Memory Extinction</article-title><source>Cell</source><volume>175</volume><fpage>709</fpage><lpage>722</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.08.021</pub-id><pub-id pub-id-type="pmid">30245010</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finelli</surname><given-names>LA</given-names></name><name><surname>Haney</surname><given-names>S</given-names></name><name><surname>Bazhenov</surname><given-names>M</given-names></name><name><surname>Stopfer</surname><given-names>M</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Synaptic Learning Rules and Sparse Coding in a Model Sensory System</article-title><source>PLOS Computational Biology</source><volume>4</volume><elocation-id>e1000062</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000062</pub-id><pub-id pub-id-type="pmid">18421373</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerber</surname><given-names>B</given-names></name><name><surname>Hendel</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Outcome expectations drive learned behaviour in larval <italic>Drosophila</italic></article-title><source>Proceedings. Biological Sciences</source><volume>273</volume><fpage>2965</fpage><lpage>2968</lpage><pub-id pub-id-type="doi">10.1098/rspb.2006.3673</pub-id><pub-id pub-id-type="pmid">17015355</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerber</surname><given-names>B</given-names></name><name><surname>Stocker</surname><given-names>RF</given-names></name><name><surname>Tanimura</surname><given-names>T</given-names></name><name><surname>Thum</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Smelling, Tasting, Learning: <italic>Drosophila</italic> as a Study Case</article-title><source>Results and Problems in Cell Differentiation</source><volume>47</volume><fpage>139</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1007/400_2008_9</pub-id><pub-id pub-id-type="pmid">19145411</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handler</surname><given-names>A</given-names></name><name><surname>Graham</surname><given-names>TGW</given-names></name><name><surname>Cohn</surname><given-names>R</given-names></name><name><surname>Morantte</surname><given-names>I</given-names></name><name><surname>Siliciano</surname><given-names>AF</given-names></name><name><surname>Zeng</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Ruta</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Distinct Dopamine Receptor Pathways Underlie the Temporal Sensitivity of Associative Learning</article-title><source>Cell</source><volume>178</volume><fpage>60</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.05.040</pub-id><pub-id pub-id-type="pmid">31230716</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hebb</surname><given-names>DO</given-names></name></person-group><year iso-8601-date="2005">2005</year><source>The Organization of Behavior</source><publisher-name>Psychology Press</publisher-name><pub-id pub-id-type="doi">10.4324/9781410612403</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heisenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Mushroom body memoir: from maps to models</article-title><source>Nature Reviews. Neuroscience</source><volume>4</volume><fpage>266</fpage><lpage>275</lpage><pub-id pub-id-type="doi">10.1038/nrn1074</pub-id><pub-id pub-id-type="pmid">12671643</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hige</surname><given-names>T</given-names></name><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Modi</surname><given-names>MN</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Turner</surname><given-names>GC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Heterosynaptic Plasticity Underlies Aversive Olfactory Learning in <italic>Drosophila</italic></article-title><source>Neuron</source><volume>88</volume><fpage>985</fpage><lpage>998</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.11.003</pub-id><pub-id pub-id-type="pmid">26637800</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta</surname><given-names>R</given-names></name><name><surname>Nowotny</surname><given-names>T</given-names></name><name><surname>García-Sanchez</surname><given-names>M</given-names></name><name><surname>Abarbanel</surname><given-names>HDI</given-names></name><name><surname>Rabinovich</surname><given-names>MI</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Learning Classification in the Olfactory System of Insects</article-title><source>Neural Computation</source><volume>16</volume><fpage>1601</fpage><lpage>1640</lpage><pub-id pub-id-type="doi">10.1162/089976604774201613</pub-id><pub-id pub-id-type="pmid">15228747</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huetteroth</surname><given-names>W</given-names></name><name><surname>Perisse</surname><given-names>E</given-names></name><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Klappenbach</surname><given-names>M</given-names></name><name><surname>Burke</surname><given-names>C</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sweet Taste and Nutrient Value Subdivide Rewarding Dopaminergic Neurons in <italic>Drosophila</italic></article-title><source>Current Biology</source><volume>25</volume><fpage>751</fpage><lpage>758</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2015.01.036</pub-id><pub-id pub-id-type="pmid">25728694</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ichinose</surname><given-names>T</given-names></name><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Yamagata</surname><given-names>N</given-names></name><name><surname>Abe</surname><given-names>A</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Reward signal in a recurrent circuit drives appetitive long-term memory formation</article-title><source>eLife</source><volume>4</volume><elocation-id>e10719</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.10719</pub-id><pub-id pub-id-type="pmid">26573957</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ito</surname><given-names>I</given-names></name><name><surname>Ong</surname><given-names>RC-Y</given-names></name><name><surname>Raman</surname><given-names>B</given-names></name><name><surname>Stopfer</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Sparse odor representation and olfactory learning</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>1177</fpage><lpage>1184</lpage><pub-id pub-id-type="doi">10.1038/nn.2192</pub-id><pub-id pub-id-type="pmid">18794840</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacob</surname><given-names>PF</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Spaced Training Forms Complementary Long-Term Memories of Opposite Valence in <italic>Drosophila</italic></article-title><source>Neuron</source><volume>106</volume><fpage>977</fpage><lpage>991</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2020.03.013</pub-id><pub-id pub-id-type="pmid">32289250</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kallman</surname><given-names>BR</given-names></name><name><surname>Kim</surname><given-names>H</given-names></name><name><surname>Scott</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Excitation and inhibition onto central courtship neurons biases <italic>Drosophila</italic> mate choice</article-title><source>eLife</source><volume>4</volume><elocation-id>e11188</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.11188</pub-id><pub-id pub-id-type="pmid">26568316</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kamin</surname><given-names>LJ</given-names></name></person-group><year iso-8601-date="1967">1967</year><chapter-title>Predictability, surprise, attention and conditioning</chapter-title><person-group person-group-type="editor"><name><surname>Campbell</surname><given-names>BA</given-names></name><name><surname>Church</surname><given-names>RM</given-names></name></person-group><source>Punishment Aversive Behavior</source><publisher-name>Appleton- Century-Crofts</publisher-name><fpage>279</fpage><lpage>296</lpage></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krashes</surname><given-names>MJ</given-names></name><name><surname>Keene</surname><given-names>AC</given-names></name><name><surname>Leung</surname><given-names>B</given-names></name><name><surname>Armstrong</surname><given-names>JD</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Sequential Use of Mushroom Body Neuron Subsets during <italic>Drosophila</italic> Odor Memory Processing</article-title><source>Neuron</source><volume>53</volume><fpage>103</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.11.021</pub-id><pub-id pub-id-type="pmid">17196534</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krashes</surname><given-names>MJ</given-names></name><name><surname>DasGupta</surname><given-names>S</given-names></name><name><surname>Vreede</surname><given-names>A</given-names></name><name><surname>White</surname><given-names>B</given-names></name><name><surname>Armstrong</surname><given-names>JD</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A Neural Circuit Mechanism Integrating Motivational State with Memory Expression in <italic>Drosophila</italic></article-title><source>Cell</source><volume>139</volume><fpage>416</fpage><lpage>427</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2009.08.035</pub-id><pub-id pub-id-type="pmid">19837040</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krashes</surname><given-names>MJ</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title><italic>Drosophila</italic> Appetitive Olfactory Conditioning</article-title><source>Cold Spring Harbor Protocols</source><volume>2011</volume><elocation-id>pdb.prot5609</elocation-id><pub-id pub-id-type="doi">10.1101/pdb.prot5609</pub-id><pub-id pub-id-type="pmid">21536767</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>TW</given-names></name><name><surname>Girolami</surname><given-names>M</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Independent Component Analysis Using an Extended Infomax Algorithm for Mixed Subgaussian and Supergaussian Sources</article-title><source>Neural Computation</source><volume>11</volume><fpage>417</fpage><lpage>441</lpage><pub-id pub-id-type="doi">10.1162/089976699300016719</pub-id><pub-id pub-id-type="pmid">9950738</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>F</given-names></name><name><surname>Lindsey</surname><given-names>JW</given-names></name><name><surname>Marin</surname><given-names>EC</given-names></name><name><surname>Otto</surname><given-names>N</given-names></name><name><surname>Dreher</surname><given-names>M</given-names></name><name><surname>Dempsey</surname><given-names>G</given-names></name><name><surname>Stark</surname><given-names>I</given-names></name><name><surname>Bates</surname><given-names>AS</given-names></name><name><surname>Pleijzier</surname><given-names>MW</given-names></name><name><surname>Schlegel</surname><given-names>P</given-names></name><name><surname>Nern</surname><given-names>A</given-names></name><name><surname>Takemura</surname><given-names>SY</given-names></name><name><surname>Eckstein</surname><given-names>N</given-names></name><name><surname>Yang</surname><given-names>T</given-names></name><name><surname>Francis</surname><given-names>A</given-names></name><name><surname>Braun</surname><given-names>A</given-names></name><name><surname>Parekh</surname><given-names>R</given-names></name><name><surname>Costa</surname><given-names>M</given-names></name><name><surname>Scheffer</surname><given-names>LK</given-names></name><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Jefferis</surname><given-names>GS</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Litwin-Kumar</surname><given-names>A</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The connectome of the adult <italic>Drosophila</italic> mushroom body provides insights into function</article-title><source>eLife</source><volume>9</volume><elocation-id>e62576</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.62576</pub-id><pub-id pub-id-type="pmid">33315010</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Owald</surname><given-names>D</given-names></name><name><surname>Chandra</surname><given-names>V</given-names></name><name><surname>Talbot</surname><given-names>C</given-names></name><name><surname>Huetteroth</surname><given-names>W</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Neural correlates of water reward in thirsty <italic>Drosophila</italic></article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1536</fpage><lpage>1542</lpage><pub-id pub-id-type="doi">10.1038/nn.3827</pub-id><pub-id pub-id-type="pmid">25262493</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Davis</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The GABAergic anterior paired lateral neuron suppresses and is suppressed by olfactory learning</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>53</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1038/nn.2235</pub-id><pub-id pub-id-type="pmid">19043409</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Plaçais</surname><given-names>PY</given-names></name><name><surname>Yamagata</surname><given-names>N</given-names></name><name><surname>Pfeiffer</surname><given-names>BD</given-names></name><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Friedrich</surname><given-names>AB</given-names></name><name><surname>Siwanowicz</surname><given-names>I</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Preat</surname><given-names>T</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A subset of dopamine neurons signals reward for odour memory in <italic>Drosophila</italic></article-title><source>Nature</source><volume>488</volume><fpage>512</fpage><lpage>516</lpage><pub-id pub-id-type="doi">10.1038/nature11304</pub-id><pub-id pub-id-type="pmid">22810589</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>WW</given-names></name><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Glutamate is an inhibitory neurotransmitter in the <italic>Drosophila</italic> olfactory system</article-title><source>PNAS</source><volume>110</volume><fpage>10294</fpage><lpage>10299</lpage><pub-id pub-id-type="doi">10.1073/pnas.1220560110</pub-id><pub-id pub-id-type="pmid">23729809</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lulham</surname><given-names>A</given-names></name><name><surname>Bogacz</surname><given-names>R</given-names></name><name><surname>Vogt</surname><given-names>S</given-names></name><name><surname>Brown</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>An Infomax Algorithm Can Perform Both Familiarity Discrimination and Feature Extraction in a Single Network</article-title><source>Neural Computation</source><volume>23</volume><fpage>909</fpage><lpage>926</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00097</pub-id><pub-id pub-id-type="pmid">21222523</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maclean</surname><given-names>PD</given-names></name></person-group><year iso-8601-date="1949">1949</year><article-title>Psychosomatic Disease and the &quot;Visceral Brain</article-title><source>Psychosomatic Medicine</source><volume>11</volume><fpage>338</fpage><lpage>353</lpage><pub-id pub-id-type="doi">10.1097/00006842-194911000-00003</pub-id><pub-id pub-id-type="pmid">15410445</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mao</surname><given-names>Z</given-names></name><name><surname>Davis</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Eight Different Types of Dopaminergic Neurons Innervate the <italic>Drosophila</italic> Mushroom Body Neuropil: Anatomical and Physiological Heterogeneity</article-title><source>Frontiers in Neural Circuits</source><volume>3</volume><elocation-id>5</elocation-id><pub-id pub-id-type="doi">10.3389/neuro.04.005.2009</pub-id><pub-id pub-id-type="pmid">19597562</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>May</surname><given-names>CE</given-names></name><name><surname>Rosander</surname><given-names>J</given-names></name><name><surname>Gottfried</surname><given-names>J</given-names></name><name><surname>Dennis</surname><given-names>E</given-names></name><name><surname>Dus</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Dietary sugar inhibits satiation by decreasing the central processing of sweet taste</article-title><source>eLife</source><volume>9</volume><elocation-id>e54530</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.54530</pub-id><pub-id pub-id-type="pmid">32539934</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCarthy</surname><given-names>EV</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Decarvalho</surname><given-names>T</given-names></name><name><surname>Brandt</surname><given-names>C</given-names></name><name><surname>Cao</surname><given-names>G</given-names></name><name><surname>Nitabach</surname><given-names>MN</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Synchronized Bilateral Synaptic Inputs to <italic>Drosophila melanogaster</italic> Neuropeptidergic Rest/Arousal Neurons</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>8181</fpage><lpage>8193</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2017-10.2011</pub-id><pub-id pub-id-type="pmid">21632940</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCurdy</surname><given-names>LY</given-names></name><name><surname>Sareen</surname><given-names>P</given-names></name><name><surname>Davoudian</surname><given-names>PA</given-names></name><name><surname>Nitabach</surname><given-names>MN</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Dopaminergic mechanism underlying reward-encoding of punishment omission during reversal learning in <italic>Drosophila</italic></article-title><source>Nature Communications</source><volume>12</volume><elocation-id>1115</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-21388-w</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGuire</surname><given-names>SE</given-names></name><name><surname>Le</surname><given-names>PT</given-names></name><name><surname>Davis</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>The Role of <italic>Drosophila</italic> Mushroom Body Signaling in Olfactory Memory</article-title><source>Science (New York, N.Y.)</source><volume>293</volume><fpage>1330</fpage><lpage>1333</lpage><pub-id pub-id-type="doi">10.1126/science.1062622</pub-id><pub-id pub-id-type="pmid">11397912</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michels</surname><given-names>B</given-names></name><name><surname>Chen</surname><given-names>Y-C</given-names></name><name><surname>Saumweber</surname><given-names>T</given-names></name><name><surname>Mishra</surname><given-names>D</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name><name><surname>Schmid</surname><given-names>B</given-names></name><name><surname>Engmann</surname><given-names>O</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cellular site and molecular mode of synapsin action in associative learning</article-title><source>Learning &amp; Memory (Cold Spring Harbor, N.Y.)</source><volume>18</volume><fpage>332</fpage><lpage>344</lpage><pub-id pub-id-type="doi">10.1101/lm.2101411</pub-id><pub-id pub-id-type="pmid">21518740</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milyaev</surname><given-names>N</given-names></name><name><surname>Osumi-Sutherland</surname><given-names>D</given-names></name><name><surname>Reeve</surname><given-names>S</given-names></name><name><surname>Burton</surname><given-names>N</given-names></name><name><surname>Baldock</surname><given-names>RA</given-names></name><name><surname>Armstrong</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The Virtual Fly Brain browser and query interface</article-title><source>Bioinformatics (Oxford, England)</source><volume>28</volume><fpage>411</fpage><lpage>415</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr677</pub-id><pub-id pub-id-type="pmid">22180411</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niv</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Reinforcement learning in the brain</article-title><source>Journal of Mathematical Psychology</source><volume>53</volume><fpage>139</fpage><lpage>154</lpage><pub-id pub-id-type="doi">10.1016/j.jmp.2008.12.005</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Owald</surname><given-names>D</given-names></name><name><surname>Felsenberg</surname><given-names>J</given-names></name><name><surname>Talbot</surname><given-names>CB</given-names></name><name><surname>Das</surname><given-names>G</given-names></name><name><surname>Perisse</surname><given-names>E</given-names></name><name><surname>Huetteroth</surname><given-names>W</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Activity of Defined Mushroom Body Output Neurons Underlies Learned Olfactory Behavior in <italic>Drosophila</italic></article-title><source>Neuron</source><volume>86</volume><fpage>417</fpage><lpage>427</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.025</pub-id><pub-id pub-id-type="pmid">25864636</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papez</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="1937">1937</year><article-title>A proposed mechanism of emotion</article-title><source>Archives of Neurology And Psychiatry</source><volume>38</volume><elocation-id>725</elocation-id><pub-id pub-id-type="doi">10.1001/archneurpsyc.1937.02260220069003</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavlowsky</surname><given-names>A</given-names></name><name><surname>Schor</surname><given-names>J</given-names></name><name><surname>Plaçais</surname><given-names>PY</given-names></name><name><surname>Preat</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A GABAergic Feedback Shapes Dopaminergic Input on the <italic>Drosophila</italic> Mushroom Body to Promote Appetitive Long-Term Memory</article-title><source>Current Biology</source><volume>28</volume><fpage>1783</fpage><lpage>1793</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.04.040</pub-id><pub-id pub-id-type="pmid">29779874</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>F</given-names></name><name><surname>Chittka</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A Simple Computational Model of the Bee Mushroom Body Can Explain Seemingly Complex Forms of Olfactory Learning and Memory</article-title><source>Current Biology</source><volume>27</volume><elocation-id>1706</elocation-id><pub-id pub-id-type="doi">10.1016/j.cub.2017.05.037</pub-id><pub-id pub-id-type="pmid">28586659</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perisse</surname><given-names>E</given-names></name><name><surname>Owald</surname><given-names>D</given-names></name><name><surname>Barnstedt</surname><given-names>O</given-names></name><name><surname>Talbot</surname><given-names>CB</given-names></name><name><surname>Huetteroth</surname><given-names>W</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Aversive Learning and Appetitive Motivation Toggle Feed-Forward Inhibition in the <italic>Drosophila</italic> Mushroom Body</article-title><source>Neuron</source><volume>90</volume><fpage>1086</fpage><lpage>1099</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.04.034</pub-id><pub-id pub-id-type="pmid">27210550</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plaçais</surname><given-names>P-Y</given-names></name><name><surname>Trannoy</surname><given-names>S</given-names></name><name><surname>Friedrich</surname><given-names>AB</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name><name><surname>Preat</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Two Pairs of Mushroom Body Efferent Neurons Are Required for Appetitive Long-Term Memory Retrieval in <italic>Drosophila</italic></article-title><source>Cell Reports</source><volume>5</volume><fpage>769</fpage><lpage>780</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2013.09.032</pub-id><pub-id pub-id-type="pmid">24209748</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plutchik</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>The Nature of Emotions</article-title><source>American Scientist</source><volume>89</volume><elocation-id>344</elocation-id><pub-id pub-id-type="doi">10.1511/2001.4.344</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pribbenow</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Heim</surname><given-names>M-M</given-names></name><name><surname>Laber</surname><given-names>D</given-names></name><name><surname>Reubold</surname><given-names>S</given-names></name><name><surname>Reynolds</surname><given-names>E</given-names></name><name><surname>Balles</surname><given-names>I</given-names></name><name><surname>Grimalt</surname><given-names>RS</given-names></name><name><surname>Rauch</surname><given-names>C</given-names></name><name><surname>Rösner</surname><given-names>J</given-names></name><name><surname>Alquicira</surname><given-names>TFV</given-names></name><name><surname>Owald</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Postsynaptic Plasticity of Cholinergic Synapses Underlies the Induction and Expression of Appetitive Memories in <italic>Drosophila</italic></article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.07.01.450776</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rescorla</surname><given-names>RA</given-names></name><name><surname>Wagner</surname><given-names>AR</given-names></name></person-group><year iso-8601-date="1972">1972</year><chapter-title>A theory of Pavlovian conditioning: Variations in the effectiveness of reinforcement and nonreinforcement</chapter-title><person-group person-group-type="editor"><name><surname>Black</surname><given-names>AH</given-names></name></person-group><source>In Classical Conditioning II: Current Research and Theory</source><publisher-loc>New York</publisher-loc><publisher-name>Appleton-Century-Crofts</publisher-name><fpage>1</fpage><lpage>497</lpage></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roxo</surname><given-names>MR</given-names></name><name><surname>Franceschini</surname><given-names>PR</given-names></name><name><surname>Zubaran</surname><given-names>C</given-names></name><name><surname>Kleber</surname><given-names>FD</given-names></name><name><surname>Sander</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The Limbic System Conception and Its Historical Evolution</article-title><source>TheScientificWorldJournal</source><volume>11</volume><fpage>2428</fpage><lpage>2441</lpage><pub-id pub-id-type="doi">10.1100/2011/157150</pub-id><pub-id pub-id-type="pmid">22194673</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saumweber</surname><given-names>T</given-names></name><name><surname>Rohwedder</surname><given-names>A</given-names></name><name><surname>Schleyer</surname><given-names>M</given-names></name><name><surname>Eichler</surname><given-names>K</given-names></name><name><surname>Chen</surname><given-names>Y-C</given-names></name><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Eschbach</surname><given-names>C</given-names></name><name><surname>Kobler</surname><given-names>O</given-names></name><name><surname>Voigt</surname><given-names>A</given-names></name><name><surname>Durairaja</surname><given-names>A</given-names></name><name><surname>Mancini</surname><given-names>N</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Thum</surname><given-names>AS</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Functional architecture of reward learning in mushroom body extrinsic neurons of larval <italic>Drosophila</italic></article-title><source>Nature Communications</source><volume>9</volume><elocation-id>1104</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-03130-1</pub-id><pub-id pub-id-type="pmid">29549237</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schleyer</surname><given-names>M</given-names></name><name><surname>Saumweber</surname><given-names>T</given-names></name><name><surname>Nahrendorf</surname><given-names>W</given-names></name><name><surname>Fischer</surname><given-names>B</given-names></name><name><surname>von Alpen</surname><given-names>D</given-names></name><name><surname>Pauls</surname><given-names>D</given-names></name><name><surname>Thum</surname><given-names>A</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A behavior-based circuit model of how outcome expectations organize learned behavior in larval <italic>Drosophila</italic></article-title><source>Learning &amp; Memory (Cold Spring Harbor, N.Y.)</source><volume>18</volume><fpage>639</fpage><lpage>653</lpage><pub-id pub-id-type="doi">10.1101/lm.2163411</pub-id><pub-id pub-id-type="pmid">21946956</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schleyer</surname><given-names>M</given-names></name><name><surname>Fendt</surname><given-names>M</given-names></name><name><surname>Schuller</surname><given-names>S</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Associative Learning of Stimuli Paired and Unpaired With Reinforcement: Evaluating Evidence From Maggots, Flies, Bees, and Rats</article-title><source>Frontiers in Psychology</source><volume>9</volume><elocation-id>1494</elocation-id><pub-id pub-id-type="doi">10.3389/fpsyg.2018.01494</pub-id><pub-id pub-id-type="pmid">30197613</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schleyer</surname><given-names>M</given-names></name><name><surname>Weiglein</surname><given-names>A</given-names></name><name><surname>Thoener</surname><given-names>J</given-names></name><name><surname>Strauch</surname><given-names>M</given-names></name><name><surname>Hartenstein</surname><given-names>V</given-names></name><name><surname>Kantar Weigelt</surname><given-names>M</given-names></name><name><surname>Schuller</surname><given-names>S</given-names></name><name><surname>Saumweber</surname><given-names>T</given-names></name><name><surname>Eichler</surname><given-names>K</given-names></name><name><surname>Rohwedder</surname><given-names>A</given-names></name><name><surname>Merhof</surname><given-names>D</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name><name><surname>Thum</surname><given-names>AS</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Identification of dopaminergic neurons that can both establish associative memory and acutely terminate its behavioral expression</article-title><source>The Journal of Neuroscience</source><volume>40</volume><fpage>5990</fpage><lpage>6006</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0290-20.2020</pub-id><pub-id pub-id-type="pmid">32586949</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schroll</surname><given-names>C</given-names></name><name><surname>Riemensperger</surname><given-names>T</given-names></name><name><surname>Bucher</surname><given-names>D</given-names></name><name><surname>Ehmer</surname><given-names>J</given-names></name><name><surname>Völler</surname><given-names>T</given-names></name><name><surname>Erbguth</surname><given-names>K</given-names></name><name><surname>Gerber</surname><given-names>B</given-names></name><name><surname>Hendel</surname><given-names>T</given-names></name><name><surname>Nagel</surname><given-names>G</given-names></name><name><surname>Buchner</surname><given-names>E</given-names></name><name><surname>Fiala</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Light-Induced Activation of Distinct Modulatory Neurons Triggers Appetitive or Aversive Learning in <italic>Drosophila Larvae</italic></article-title><source>Current Biology</source><volume>16</volume><fpage>1741</fpage><lpage>1747</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2006.07.023</pub-id><pub-id pub-id-type="pmid">16950113</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwaerzel</surname><given-names>M</given-names></name><name><surname>Monastirioti</surname><given-names>M</given-names></name><name><surname>Scholz</surname><given-names>H</given-names></name><name><surname>Friggi-Grelin</surname><given-names>F</given-names></name><name><surname>Birman</surname><given-names>S</given-names></name><name><surname>Heisenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Dopamine and Octopamine Differentiate between Aversive and Appetitive Olfactory Memories in <italic>Drosophila</italic></article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>10495</fpage><lpage>10502</lpage><pub-id pub-id-type="pmid">14627633</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Senapati</surname><given-names>B</given-names></name><name><surname>Tsao</surname><given-names>CH</given-names></name><name><surname>Juan</surname><given-names>YA</given-names></name><name><surname>Chiu</surname><given-names>TH</given-names></name><name><surname>Wu</surname><given-names>CL</given-names></name><name><surname>Waddell</surname><given-names>S</given-names></name><name><surname>Lin</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A neural mechanism for deprivation state-specific expression of relevant memories in <italic>Drosophila</italic></article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>2029</fpage><lpage>2039</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0515-z</pub-id><pub-id pub-id-type="pmid">31659341</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>D</given-names></name><name><surname>Wessnitzer</surname><given-names>J</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A model of associative learning in the mushroom body</article-title><source>Biological Cybernetics</source><volume>99</volume><fpage>89</fpage><lpage>103</lpage><pub-id pub-id-type="doi">10.1007/s00422-008-0241-1</pub-id><pub-id pub-id-type="pmid">18607623</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Springer</surname><given-names>M</given-names></name><name><surname>Nawrot</surname><given-names>MP</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A mechanistic model for reward prediction and extinction learning in the fruit fly</article-title><source>ENeuro</source><volume>8</volume><elocation-id>ENEURO.0549-20.2021</elocation-id><pub-id pub-id-type="doi">10.1523/ENEURO.0549-20.2021</pub-id><pub-id pub-id-type="pmid">33785523</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sten</surname><given-names>TH</given-names></name><name><surname>Li</surname><given-names>R</given-names></name><name><surname>Otopalik</surname><given-names>A</given-names></name><name><surname>Ruta</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>An arousal-gated visual circuit controls pursuit during <italic>Drosophila</italic> courtship</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.08.31.275883</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tabone</surname><given-names>CJ</given-names></name><name><surname>de Belle</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Second-order conditioning in <italic>Drosophila</italic></article-title><source>Learning &amp; Memory (Cold Spring Harbor, N.Y.)</source><volume>18</volume><fpage>250</fpage><lpage>253</lpage><pub-id pub-id-type="doi">10.1101/lm.2035411</pub-id><pub-id pub-id-type="pmid">21441302</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takemura</surname><given-names>S-Y</given-names></name><name><surname>Aso</surname><given-names>Y</given-names></name><name><surname>Hige</surname><given-names>T</given-names></name><name><surname>Wong</surname><given-names>A</given-names></name><name><surname>Lu</surname><given-names>Z</given-names></name><name><surname>Xu</surname><given-names>CS</given-names></name><name><surname>Rivlin</surname><given-names>PK</given-names></name><name><surname>Hess</surname><given-names>H</given-names></name><name><surname>Zhao</surname><given-names>T</given-names></name><name><surname>Parag</surname><given-names>T</given-names></name><name><surname>Berg</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>G</given-names></name><name><surname>Katz</surname><given-names>W</given-names></name><name><surname>Olbris</surname><given-names>DJ</given-names></name><name><surname>Plaza</surname><given-names>S</given-names></name><name><surname>Umayam</surname><given-names>L</given-names></name><name><surname>Aniceto</surname><given-names>R</given-names></name><name><surname>Chang</surname><given-names>L-A</given-names></name><name><surname>Lauchie</surname><given-names>S</given-names></name><name><surname>Ogundeyi</surname><given-names>O</given-names></name><name><surname>Ordish</surname><given-names>C</given-names></name><name><surname>Shinomiya</surname><given-names>A</given-names></name><name><surname>Sigmund</surname><given-names>C</given-names></name><name><surname>Takemura</surname><given-names>S</given-names></name><name><surname>Tran</surname><given-names>J</given-names></name><name><surname>Turner</surname><given-names>GC</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Scheffer</surname><given-names>LK</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A connectome of a learning and memory center in the adult <italic>Drosophila</italic> brain</article-title><source>eLife</source><volume>6</volume><elocation-id>e26975</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.26975</pub-id><pub-id pub-id-type="pmid">28718765</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanaka</surname><given-names>NK</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neuronal assemblies of the <italic>Drosophila</italic> mushroom body</article-title><source>The Journal of Comparative Neurology</source><volume>508</volume><fpage>711</fpage><lpage>755</lpage><pub-id pub-id-type="doi">10.1002/cne.21692</pub-id><pub-id pub-id-type="pmid">18395827</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname><given-names>GC</given-names></name><name><surname>Bazhenov</surname><given-names>M</given-names></name><name><surname>Laurent</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Olfactory Representations by <italic>Drosophila</italic> Mushroom Body Neurons</article-title><source>Journal of Neurophysiology</source><volume>99</volume><fpage>734</fpage><lpage>746</lpage><pub-id pub-id-type="doi">10.1152/jn.01283.2007</pub-id><pub-id pub-id-type="pmid">18094099</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waddell</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Dopamine reveals neural circuit mechanisms of fly memory</article-title><source>Trends in Neurosciences</source><volume>33</volume><fpage>457</fpage><lpage>464</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2010.07.001</pub-id><pub-id pub-id-type="pmid">20701984</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wessnitzer</surname><given-names>J</given-names></name><name><surname>Young</surname><given-names>JM</given-names></name><name><surname>Armstrong</surname><given-names>JD</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A model of non-elemental olfactory learning in <italic>Drosophila</italic></article-title><source>Journal of Computational Neuroscience</source><volume>32</volume><fpage>197</fpage><lpage>212</lpage><pub-id pub-id-type="doi">10.1007/s10827-011-0348-6</pub-id><pub-id pub-id-type="pmid">21698405</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Guo</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A model study on the circuit mechanism underlying decision-making in <italic>Drosophila</italic></article-title><source>Neural Networks</source><volume>24</volume><fpage>333</fpage><lpage>344</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2011.01.002</pub-id><pub-id pub-id-type="pmid">21310589</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Ren</surname><given-names>Q</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Guo</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The GABAergic anterior paired lateral neurons facilitate olfactory reversal learning in <italic>Drosophila</italic></article-title><source>Learning &amp; Memory (Cold Spring Harbor, N.Y.)</source><volume>19</volume><fpage>478</fpage><lpage>486</lpage><pub-id pub-id-type="doi">10.1101/lm.025726.112</pub-id><pub-id pub-id-type="pmid">22988290</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>C-L</given-names></name><name><surname>Shih</surname><given-names>M-FM</given-names></name><name><surname>Lee</surname><given-names>P-T</given-names></name><name><surname>Chiang</surname><given-names>A-S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>An Octopamine-Mushroom Body Circuit Modulates the Formation of Anesthesia-Resistant Memory in <italic>Drosophila</italic></article-title><source>Current Biology</source><volume>23</volume><fpage>2346</fpage><lpage>2354</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.09.056</pub-id><pub-id pub-id-type="pmid">24239122</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamagata</surname><given-names>N</given-names></name><name><surname>Hiroi</surname><given-names>M</given-names></name><name><surname>Kondo</surname><given-names>S</given-names></name><name><surname>Abe</surname><given-names>A</given-names></name><name><surname>Tanimoto</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Suppression of Dopamine Neurons Mediates Reward</article-title><source>PLOS Biology</source><volume>14</volume><elocation-id>e1002586</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002586</pub-id><pub-id pub-id-type="pmid">27997541</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>JM</given-names></name><name><surname>Wessnitzer</surname><given-names>J</given-names></name><name><surname>Armstrong</surname><given-names>JD</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Elemental and non-elemental olfactory learning in <italic>Drosophila</italic></article-title><source>Neurobiology of Learning and Memory</source><volume>96</volume><fpage>339</fpage><lpage>352</lpage><pub-id pub-id-type="doi">10.1016/j.nlm.2011.06.009</pub-id><pub-id pub-id-type="pmid">21742045</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>YV</given-names></name><name><surname>Ni</surname><given-names>J</given-names></name><name><surname>Montell</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The Molecular Basis for Attractive Salt-Taste Coding in <italic>Drosophila</italic></article-title><source>Science (New York, N.Y.)</source><volume>340</volume><fpage>1334</fpage><lpage>1338</lpage><pub-id pub-id-type="doi">10.1126/science.1234133</pub-id><pub-id pub-id-type="pmid">23766326</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>F</given-names></name><name><surname>Zeng</surname><given-names>Y</given-names></name><name><surname>Guo</surname><given-names>A</given-names></name><name><surname>Su</surname><given-names>H</given-names></name><name><surname>Xu</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A neural algorithm for <italic>Drosophila</italic> linear and nonlinear decision-making</article-title><source>Scientific Reports</source><volume>10</volume><elocation-id>18660</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-020-75628-y</pub-id><pub-id pub-id-type="pmid">33122701</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>C</given-names></name><name><surname>Widmer</surname><given-names>YF</given-names></name><name><surname>Diegelmann</surname><given-names>S</given-names></name><name><surname>Petrovici</surname><given-names>MA</given-names></name><name><surname>Sprecher</surname><given-names>SG</given-names></name><name><surname>Senn</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Predictive olfactory learning in <italic>Drosophila</italic></article-title><source>Scientific Reports</source><volume>11</volume><elocation-id>6795</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-021-85841-y</pub-id><pub-id pub-id-type="pmid">33762640</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>N</given-names></name><name><surname>Tian</surname><given-names>J</given-names></name><name><surname>Zeng</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Guo</surname><given-names>J</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Guo</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Suppression of GABAergic neurons through D2-like receptor secures efficient conditioning in <italic>Drosophila</italic> aversive olfactory learning</article-title><source>PNAS</source><volume>116</volume><fpage>5118</fpage><lpage>5125</lpage><pub-id pub-id-type="doi">10.1073/pnas.1812342116</pub-id><pub-id pub-id-type="pmid">30796183</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>L</given-names></name><name><surname>Mangan</surname><given-names>M</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Biomimetic and Biohybrid Systems, 9th International Conference, Living Machines</article-title><conf-name>Proceedings. Lecture Notes in Computer Science</conf-name><fpage>415</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1007/978-3-030-64313-3</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s8" sec-type="appendix"><title>The incentive wheel</title><p>We have shown that the incentive circuit is able to explain classical conditioning experiments that have been done with adult fruit flies, and its neurons can replicate the responses of the mushroom bodies in the flies’ brain. We have also seen that three types of memories are stored in this model (i.e., susceptible, restrained, and long-term) for each of the two represented motivations of the animal (i.e., attraction or avoidance) guided by reinforcements (i.e., reward or punishment). Although this model is sufficient to explain the behaviour of the animals in the laboratory, where the animal is exposed to controlled portions of chemicals and the results are translated into a simple attraction to or avoidance from a source, in the wild there are more than two motivations that modulate the behaviour of the animal either synergistically or opponently.</p><p>Real-life experiences are complicated and rich in information. This could produce a whole spectrum of reinforcements and motivations that guide the behaviour of animals. Data show that animals respond differently in different reinforcements, which cannot be represented just by the magnitude of a single variable, for example, more/less rewarding/punishing. For example, different concentrations of salt (<xref ref-type="bibr" rid="bib99">Zhang et al., 2013</xref>) or sugar (<xref ref-type="bibr" rid="bib24">Colomb et al., 2009</xref>) might be combined with the sated state of the animal, activate different subsets of DANs, and trigger different behaviours, such as feeding or escaping. When the male fruit fly is exposed to female pheromones, courtship behaviour is triggered through P1 neurons (<xref ref-type="bibr" rid="bib47">Kallman et al., 2015</xref>; <xref ref-type="bibr" rid="bib87">Sten et al., 2020</xref>), which can be translated to attraction, but has nothing to do with the appetite of the animal. On the other hand, other male pheromones trigger avoidance which suggests a similarity to the IC could explain this behaviour. The MB has been proved to contribute to many behaviours other than olfactory classical conditioning, including visual navigation, and its output neurons encode richer information that is very close to humans’ decision-making (<xref ref-type="bibr" rid="bib40">Heisenberg, 2003</xref>).</p><p>It is reasonable to think that the <inline-formula><mml:math id="inf317"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>34</mml:mn></mml:mrow></mml:math></inline-formula> output and <inline-formula><mml:math id="inf318"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>130</mml:mn></mml:mrow></mml:math></inline-formula> dopaminergic neurons interacting with the MBs in the brain of fruit flies are not all used in order to discriminate odours and assign a positive or negative reinforcement to them driving attraction and avoidance. For this reason, we believe that the different MBONs do not represent different odours like it has been proposed before (<xref ref-type="bibr" rid="bib42">Huerta et al., 2004</xref>) neither are split into two groups (e.g., attraction or avoidance; <xref ref-type="bibr" rid="bib83">Schwaerzel et al., 2003</xref>; <xref ref-type="bibr" rid="bib82">Schroll et al., 2006</xref>; <xref ref-type="bibr" rid="bib92">Waddell, 2010</xref>), but rather represent different motivations of the animal that altogether guide its overall behaviour (<xref ref-type="bibr" rid="bib40">Heisenberg, 2003</xref>; <xref ref-type="bibr" rid="bib50">Krashes et al., 2009</xref>). These motivations are associated to different contexts, which are represented by the responses of the KCs as it has been proposed by <xref ref-type="bibr" rid="bib23">Cohn et al., 2015</xref>, who showed that the same output neurons in the γ compartment respond differently when a different context is given. This context enables or disables different microcircuits of the MB — similar to the ones described in the ‘Microcircuits of the mushroom body’ section, which result in the activation of a subset of MBONs that represent different motivations, while the overlapping microcircuits result in what we sometimes call “noisy” or “insignificant” changes in the behaviour.</p><p><xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref> illustrates such a model, which we call the ‘incentive wheel’ (IW). In this model, we use four identical incentive memories (C0/4, C1/5, C2/6, and C3/7), where the reciprocal STMs microcircuit of the one is the reciprocal LTMs microcircuit of another. As the structure of the RLM microcircuit is identical to the RSM one, we assume that the RLM of circuit C0/4 is the RSM of circuit C1/5, and the RLM of circuit C1/5 is the RSM of circuit C2/6, and so on. This way, we weave the different circuits into an incentive wheel with opposing motivations. The reinforcements that trigger the DANs in this model are drawn from a spectrum, and the output of the MBONs of the model triggers different motivations. The LTMs and restrained memories can both exist in the same neurons of the core of the model, representing different motivations in different contexts. This might cause changes in the behaviour of the circuits that are irrelevant to the associated reinforcement, but relevant to a neighbouring reinforcement of the spectrum.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>The ‘incentives wheel’ model.</title><p>This model supports that reinforcement is not binary but it draws its values from a spectrum. Different types of reinforcements trigger different dopaminergic neurons (DANs) that enable learning in different parts of the mushroom body. Colours show the variety of motivations that the model can encode associated with humans’ ‘wheel of emotions’ (<xref ref-type="bibr" rid="bib74">Plutchik, 2001</xref>); e.g., light green: trust; green: fear; light blue: surprise; blue: sadness; pink: disgust; red: anger; orange: anticipation; yellow: joy. Neurons of more than one colours are part of multiple circuits that contribute to different motivations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-75611-app1-fig1-v1.tif"/></fig><p>The incentive wheel is an example of how the IC can be a part of a bigger circuit that can provide a variety of motivations to the animal. An extension of it could have susceptible MBONs, <italic>s</italic><sub><italic>i</italic></sub>, connecting to other susceptible MBONs from a parallel IW model with higher-order motivations. In <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>, we have associated the different motivations with the primary human emotions from the ‘wheel of emotions’ (<xref ref-type="bibr" rid="bib74">Plutchik, 2001</xref>). Higher-order motivations could exist by combining primary motivations as if they were emotions and result in more complicated behaviours for the animal.</p></sec></app><app id="appendix-2"><title>Appendix 2</title><table-wrap id="app2table1" position="float"><label>Appendix 2—table 1.</label><caption><title>Additional information on the mushroom body neurons used for the incentive circuit, sorted by their short name.</title><p>Information about the neurons has been collected from <xref ref-type="bibr" rid="bib63">McCurdy et al., 2021</xref> and <xref ref-type="bibr" rid="bib5">Aso et al., 2014a</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Driver</th><th align="left" valign="bottom">Cluster</th><th align="left" valign="bottom">Neuron name</th><th align="left" valign="bottom"># cells</th><th align="left" valign="bottom">Short name</th><th align="left" valign="bottom">Alternative names</th></tr></thead><tbody><tr><td align="left" valign="bottom">MB011B</td><td align="left" valign="bottom">M4/M6</td><td align="left" valign="bottom">MBON-γ5β’2a</td><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">MBON-01</td><td align="left" valign="bottom">MB-M6</td></tr><tr><td align="left" valign="bottom">MB399B</td><td align="left" valign="bottom">M4/M6</td><td align="left" valign="bottom">MBON-β2β′2a</td><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">MBON-02</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">MB298B</td><td align="left" valign="bottom">MV2</td><td align="left" valign="bottom">MBON-γ4&gt;γ1γ2</td><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">MBON-05</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">MB112C</td><td align="left" valign="bottom"/><td align="left" valign="bottom">MBON-γ1pedc&gt;α/β</td><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">MBON-11</td><td align="left" valign="bottom">MB-MVP2</td></tr><tr><td align="left" valign="bottom">MB077B</td><td align="left" valign="bottom">V3/V4</td><td align="left" valign="bottom">MBON-γ2α’1</td><td align="char" char="." valign="bottom">2</td><td align="left" valign="bottom">MBON-12</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">MB050B</td><td align="left" valign="bottom">V2</td><td align="left" valign="bottom">MBON-α’1</td><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom">MBON-15</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">MB109B</td><td align="left" valign="bottom">PAM</td><td align="left" valign="bottom">PAM-β’2a</td><td align="char" char="ndash" valign="bottom">6–9</td><td align="left" valign="bottom">PAM-02</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">MB301B</td><td align="left" valign="bottom">PAM</td><td align="left" valign="bottom">PAM-β2β′2a</td><td align="char" char="." valign="bottom">&gt; 3</td><td align="left" valign="bottom">PAM-04</td><td align="left" valign="bottom">Subset of MB-M8</td></tr><tr><td align="left" valign="bottom">MB312B</td><td align="left" valign="bottom">PAM</td><td align="left" valign="bottom">PAM-γ4&lt;γ1γ2</td><td align="char" char="ndash" valign="bottom">13–17</td><td align="left" valign="bottom">PAM-07</td><td align="left" valign="bottom">Subset of MB-AIM?</td></tr><tr><td align="left" valign="bottom">MB320C</td><td align="left" valign="bottom">PPL1</td><td align="left" valign="bottom">PPL1-γ1ped</td><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">PPL1-01</td><td align="left" valign="bottom">MB-MP1, MP</td></tr><tr><td align="left" valign="bottom">MB296B<sub>1</sub></td><td align="left" valign="bottom">PPL1</td><td align="left" valign="bottom">PPL1-γ2α′1<sub>1</sub></td><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">PPL1-03</td><td align="left" valign="bottom">MB-MV1</td></tr><tr><td align="left" valign="bottom">MB296B<sub>2</sub></td><td align="left" valign="bottom">PPL1</td><td align="left" valign="bottom">PPL1-γ2α′1<sub>2</sub></td><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">PPL1-03</td><td align="left" valign="bottom">MB-MV1</td></tr></tbody></table></table-wrap></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.75611.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bhalla</surname><given-names>Upinder Singh</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03ht1xw27</institution-id><institution>Tata Institute of Fundamental Research</institution></institution-wrap><country>India</country></aff></contrib></contrib-group></front-stub><body><p>This ambitious study goes from signalling mechanisms to fly behavior through a model of a memory circuit in the fly brain. The authors call this the incentive circuit. The model draws extensively from anatomical and physiological measurements. The study makes a wide range of predictions about how this circuit mediates behaviour and learning through attractive and repulsive cues.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.75611.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bhalla</surname><given-names>Upinder Singh</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03ht1xw27</institution-id><institution>Tata Institute of Fundamental Research</institution></institution-wrap><country>India</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Ramaswami</surname><given-names>Mani</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02tyrky19</institution-id><institution>Trinity College Dublin</institution></institution-wrap><country>Ireland</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-boxX1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>[Editors’ note: the authors resubmitted a revised version of the paper for consideration. What follows is the authors’ response to the first round of review.]</p><p>Thank you for submitting the paper &quot;The incentive circuit: memory dynamics in the mushroom body of <italic>Drosophila melanogaster</italic>&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by a Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Mani Ramaswami (Reviewer #3).</p><p>We are sorry to say that, after consultation with the reviewers, we have decided that this work will not be considered further for publication by <italic>eLife</italic>.</p><p>While all the reviewers appreciate the ambition and value in integrating diverse sources of data to developing a model of learning, they had some substantial concerns. These are elaborated in their detailed comments, and I provide a distillation of the discussion that the reviewers and I had about the paper. Since it will take considerable further work to address these points, the reviewers and I felt that the paper should be rejected. If the authors wish to resubmit after completely addressing the concerns this would be fine.</p><p>1. The reviewers found the paper a difficult read. Could the authors rewrite to make it accessible to a wide range of readership?</p><p>2. The formulation of the DLR seems to be a variant of RPE (Reward Prediction Error) learning rules, and hence the conclusions need to be re-evaluated.</p><p>Can the authors re-think the basic formulation of DLR starting with Equations (2) and (3)? There should be some experimental tests if the DLR is indeed determined to be different from regular RPE.</p><p>3. The microcircuits should be better based on experimental data. From our understanding, the data shown in Figures 4H/G, 5B/C/E/F and 6B/C seems to have been obtained by simulations. Would Ca recordings for these figures be feasible? Can there be stronger justification for the connectivity of the proposed incentive circuit?</p><p>3b. The proposed circuit connectivity of the 'incentive circuit' needs to be defined for each MBON because most contemporary work shows that different kinds of memory involved plasticity in different subsets of MBONs. Can the model make specific testable predictions for each subset of MBON?</p><p>4. Further experimental predictions should be made, based on well-parameterized models of the underlying neurons. Can the authors provide considerably more clarity on which sets of behavioral or physiological data are selected by the authors as targets or tests for specific parts of their model?</p><p>5. Can the model account for existing data showing overlapping conflicting engrams? Additional experiments and simulations may be needed to ascertain this.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>This ambitious study builds a model of a proposed key circuit motif in fly behaviour and learning, the Incentive Circuit. The authors examine its implications for a variety of behaviours, and perform a thorough circuit-level mapping of model neuronal activity to recordings. The model uses abstracted model neurons and synaptic signaling, but with careful attention to experimental data at many steps. The mapping to experiments is good, and the model makes far-reaching predictions for animal behaviour.</p><p>The development of the model is generally well presented. The learning rule is derived from earlier work (Handler et al) and then the authors transform the terms for ER-ca<sup>2+</sup> and for cAMP to terms emerging from DA inputs. The model development is especially systematic, building up to the final version step by step with reference to experiments. Importantly, these are mapped to specific sets of experimental observations on the circut level.</p><p>I have mostly comments to clarify or strengthen the presentation.</p><p>1. I had a little trouble to envision the two components of D2 and D1. Are they time-varying? Seems to be, see Equation 4, where they are presented as D1(t) and D2(t). In other words, do they express D2 and D1 as distinct α functions following spike activity in the DAN?</p><p>However, in the text and figures it is frequently presented in terms such as D2 &gt; D1 (eg., Figure 3), which looks like a static effect. This was confusing.</p><p>Also in Figure 2A, are we seeing the peak values of ER-Ca or area under curve?</p><p>Around line 128 it is a hint that it is area under curve, but I am not sure.</p><p>2. I would have liked to have seen some more mapping to functional experiments in the figures up to Figure 7, where the components of the model are being built up. The authors mention several in the text. Even a qualitative look at the experimental responses would help to strengthen the motivation of the model design.</p><p>3. The authors then utilize this circuit in an aversive olfactory conditioning paradigm, for which they provide experimental data corresponding to the various neuron types. They then simulate this. This is an outstanding way to validate/test their model. It would be helpful to have the experimental and simulated responses interleaved on the same figure so as to better compare.</p><p>4. I appreciate that it is quite challenging for a simulation to simultaneously replicate properties of several intermediate stages of circuit activity, even more so when the stimulus is not one that the model has been trained on. Could the authors confirm that this is indeed the case, i.e. that the model outcome for figure 9 was obtained only from the parameter tuning earlier in the paper up to Figure 7?</p><p>5. It would be useful to perform a statistical evaluation of the fidelity of the model as compared to experiment.</p><p>6. The authors then place their model flies in a virtual arena and explore a number of behaviours. Here they contrast their model behaviour with the predictions from a different learning, reward prediction error. I would have liked to have seen in figure 11 an illustration of the correspondence to experimental observations from the literature.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The manuscript in its current form is built around two main threads. In the first thread, the authors review several results in the literature on associative learning in the mushroom body of the adult fruit fly, and construct an Incentive Circuit (IC) consisting of 6 dopaminergic and 6 mushroom body neurons with specific memory dynamics. They provide a coherent functional view of some of the disparate recent results in associative learning of the mushroom body.</p><p>The second thread incorporates a Dopaminergic Learning Rule (DLR) into the IC computational model, providing a computational system for evaluating the learning mechanisms involved.</p><p>A weakness here is that the acquisition, forgetting and assimilation of memories qualitatively described in the first thread are not strongly linked with the quantitative IC model described in the second thread.</p><p>Conversely, the validation of the IC model circuit, given the noisy data that the authors provide, is only possible in terms of trends, i.e., simple visual inspection. Interpreting the data then is difficult as it does not provide enough constraints for the computational model.</p><p>Given the limitations inherent in the validation of the IC from their recorded data, the authors proceed to explore the DLR using behavioral experiments purely based on simulations. This is an effective methodology widely employed in, e.g., robotics. The authors extensively compare the 'learning/navigation' performance of DLR with a variant of reward prediction error (RPE) learning rule and demonstrate a better learning performance. While the comparison may be compelling, we found that underlying the DLR, is the computation of a prediction error, i.e., DLR is a variant of RPE. This calls for a re-evaluation, positioning and clarification of some of the key conclusions regarding why the DLR is effective in associative learning tasks.</p><p>l.128 The section 'Mushroom Body Microcircuits' makes good first reading. However, most of the key statements could further benefit from more extensive quantitative backing as hinted at in Figures 4, 5 and 6 (see also my comment below). Since these microcircuits are simpler than the IC, my expectation is that they could provide better intuition regarding their function.</p><p>Figures 4F and 4G are rather difficult to understand/parse. More caption details, choice of different colors, would help.</p><p>Same comment regarding Figures 5B, 5C, 5E and 5F, and 6B, 6C.</p><p>While Figure 8 is to be commended, the data is rather noisy and, in my view, despite the best intentions, rather difficult to understand/evaluate. As the authors argue in l.312, 'we computationally modelled the incentive circuit in order to demonstrate all the properties we described before and compare the reconstructed activities to the ones of Figure 8C'. However, a comparison by simple visual inspection is rather unconvincing. The need for introducing a distance measure is in order.</p><p>I found 'modeling behavior', as presented in the current version of the manuscript, to be quite effective. However, I'd like to note that in the process, the authors changed the underlying PN activity model. This requires, given that the rest of the paper is based on a binary odor model of the PN activity (see the discussion preceding Equation (6)), some careful/detailed assessment of its implications. Finally, the authors propose to compare their DLR with a variant of RPE. Here a major conceptual problem arises.</p><p>The authors argue that DLR is a fundamentally different learning rule from RPE. They state in l.462 that 'The idea behind RPE is that the fly learns to predict how rewarding or punishing a stimulus is by altering its prediction when this does not match the actual reward or punishment experience'.</p><p>This can be adapted to the mushroom body circuit by assuming that the MBON output provides a prediction of DAN activity. But this is exactly what Equation (18) states. The differential equation (18) describing the gradient of the DAN activity is equal to sum of the weighted shock delivery ('transform' in l.750) and the weighted MBON activity (l.755).</p><p>The sum is just the prediction error between the two terms. Consequently, since the DLR is, in view of this reviewer, a variant of RPE, a comparison with another RPE is of little interest. A substantial re-write of the paper starting with the section on the Incentive Circuit (l. 257) is in order.</p><p>l.765: &quot;The above matrices summarise the excitatory (positive) and inhibitory (negative) connections between MBONs and DANs or other MBONs. The magnitude of the weights was hand-tuned in order to get the desired result.&quot; This 'hand-tuning&quot; appears, to me, to be a 'construction' of the prediction error on the right hand side of Equation (18). Some details might help clarify to what extent the hand-tuning is based on the assumptions of the binary model of the 2 odors at the PN level. I presume that the generality of the model alluded to in l.743 stating that 'that the number of neurons we are using for PNs and KCs is not very important and we could use any combination of PN and KC populations' breaks down and the hand-tuning needs to be repeated every time the number of neurons is changed.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The authors propose an original dopaminergic learning rule, which, when implemented in simple neural circuit motifs shown to exist within the <italic>Drosophila</italic> mushroom body (MB) , can potentially account for a very large number of independent, poorly integrated physiological and behavioural phenomena associated with the mushroom body. It considers multiple behavioural roles of MB output neurons beyond attraction and aversion and offers new insight to the how the MB functions in acquisition, consolidation and forgetting of memories. The manuscript further attempts to show how similar principles could potentially be useful in the mammalian brain. An ambitious and integrative analysis of this sort is sorely needed in the field.</p><p>The paper has obviously involved very broad and deep consideration of the MB connectome as well as genetic, physiological and behavioural studies of the roles of the different classes of Kenyon cells, MBONs and DANs that innervate the mushroom body. It is original and ambitious and potentially very valuable to the field.</p><p>My major reservation is that the manuscript is very difficult to read and evaluate by anyone who is not a <italic>Drosophila</italic> mushroom body aficionado. I consider myself an interested reader and one who keeps broad track of the field, but found the need to read and evaluate far too many papers cited by the authors to decide how well phenomena the authors attempt to model have been demonstrated and how well assumptions made by the authors are justified by data. E.g. I was stymied even at figure 1, where mutual inhibition between MBONs is indicated and it took me considerable (and eventually futile) effort to look into where and how well this has been established.</p><p>To make the work more accessible at least to this moderately educated reviewer, I fear that a major re-rewrite will be required. I would suggest that for each section – exactly has been shown be clearly enumerated, with enough detail provided for the reader to judge the strength of these data. The justification and support for three types of MBONs and their incentive should also be particularly clearly indicated.</p><p>Moreover, while the authors are correct to point out the limitations of current models based on dopamine prediction-error, I do wonder if there is room for prediction error to also contribute meaningfully within the framework proposed in this paper.</p><p>I apologise for the not having a list of specific issues for the authors to address, because I found the basis to be so difficult to explore but here is some general feedback.</p><p>1. It is nice that and the dynamics of neural responses obtained with the model correspond closely with ones reported in previous studies (although there are exceptions, some nicely highlighted by the authors).</p><p>2. There should be deeper engagement with signalling mechanisms that differentiate the two types of dopamine receptors. I found the assumptions regarding their differences to be useful for the modelling of different effects of reinforcement before or after sensory experience (Ruta Cell 2019), but quite superficial in terms of providing hypothesis for how the receptors may differ in terms of mechanism of action.</p><p>3. ON the same note, specific experimental predictions of the model could also be clearly indicated at the end of each section.</p><p>4. While the authors admittedly designed informative and clear figures, and their Table 1 points the reader to papers that report relevant neural connections and neuronal functions, this is not enough. Data in support of each assumption should be clearly and specifically mentioned and hypotheses connections also clearly stated. After considerable effort, I still could find no evidence for lthe existence of inhibitory connections between MBONγ4 and MBONγ2 (which is not to say that none exist – but surely it is the authors job to clarify this).</p><p>5. The authors should also try to account for the discovery of parallel, independent memory traces (like appetitive LTM formation towards the CS- in classic LTM aversive training paradigms).</p><p>6. Does the dopaminergic learning rule explain the differences in dynamics and memory strength between appetitive and aversive memories? These two types of memory involved different molecular components and display different learning rules (stronger short-term aversive memories and longer-lasting appetitive memories requiring less training)? This should perhaps be clarified, particularly since KC output appears dispensable for aversive learning (aquisition) but potentially necessary for the acquisition of appetitive memories (Pribbenow et al., 2021).</p><p>7. I found the easy assumption that forgetting involves erasure to be troubling. Perhaps this happens sometimes. But many apparently &quot;forgotten&quot; memories are never erased, simply not reactivated for multiple reasons. Intellectually this point needs to be acknowledged.</p><p>[Editors’ note: what follows is the authors’ response to the second round of review.]</p><p>Thank you for resubmitting your work entitled &quot;The incentive circuit: memory dynamics in the mushroom body of <italic>Drosophila melanogaster</italic>&quot; for further consideration by <italic>eLife</italic>. Your revised article has been evaluated by Ronald Calabrese (Senior Editor) and a Reviewing Editor.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below:</p><p>1. Could the authors compare their simulated/predicted behavior with some quantitative or semi-quantitative measures of experimental behavior?</p><p>2. Can the authors elaborate on their mapping of ER-CA and cAMP in the model with the cited data? This relates to point 4 from Reviewer 1.</p><p>3. Can the authors do some parameter sensitivity analysis as suggested by the reviewers?</p><p>In addition, the reviewers had a few points for the authors to expand upon in the revision, and a number of useful suggestions to improve clarity.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>This is an ambitious but also highly complicated odelling study that seeks to account for a wide range of fly learning behaviour in terms of underlying learning rules and circuitry.</p><p>The strengths of the study are its ambition, detail and substantial attention to experimental inputs. In principle it builds up a large and testable conceptual framework for understanding many aspects of learning. Its weaknesses, which are readily fixed, are 1. That the study misses opportunities to better compare model to experiments. And 2, that the study doesn’t do a systematic parameter and model exploration to see how robust are the properties.</p><p>With these additions the study would be strong and of value to the field in laying out a template for further investigation. The authors posit that this framework could also apply to other organisms.</p><p>1. This is an ambitious but also highly complicated odelling study that seeks to account for a wide range of fly learning behaviour in terms of underlying learning rules and circuitry. The authors have made substantial improvements to the clarity of the presentation, particularly with regards to comparison of experimental and simulated data.</p><p>I would have liked to see similar comparison for two more features: the behaviour, and the crucial learning rule section, as I comment below. I note that a similar request was made in an earlier review.</p><p>2. The other big thing I would have liked to see is an exploration of parameter sensitivity. This is needed both because of model complexity and because of the not-perfect match between model and input data. No model is perfect, but the confidence in a model is much improved if one can see that it still ‘works’ even when the numbers (and other assumptions) shift around a bit.</p><p>3. Behaviour: The authors have made the interesting and potentially powerful step of linking their model to measurable behaviour. But they miss the opportunity to put the outcomes (experiment and model) side by side. Even a semi-quantitative distillation to some common metric for displaying and comparing the experimental and model properties would have been valuable.</p><p>4. Figure 16: Details of ER-CA and cAMP in the model don’t match data. The form of the pairing for ER Ca is inconsistent with the data of Handler et al., particularly when CS precedes US by a large interval. Handler et al. show no response for forward pairing even several seconds after the last stimulus. Also, the time-course of ER response for the backward pairing case is inconsistent. In the Handler data (Figure 6) the ER signal remains low (i.e, very different from baseline) well past 5 seconds, whereas in Figure 16 the signal returns to baseline within 5s. I am also concerned that there doesn't seem to be experimental support for the reduced cAMP signal at very small overlap intervals. Indeed, the Handler data suggests that there is a large signal at the 0.5s and -1.2s points. Figure 16 shows that the model assumes a low and brief signal at -1.2s.</p><p>I would have appreciated having the experimental data from Handler and others illustrated here in the same figure, just to see how well the model forms behave. It would save the reader the step of going to look up another paper and tracking down appropriate figure panels.</p><p>5. As one example of a useful parameter sensitivity analysis: The form of the deltaWij seems rather crucial to the model, so I'm homing in on this. It is a difference of two values which are themselves clearly the difference of opposing signals. It would therefore be valuable to show that relaxation of these tight timing requirements does not upset the learning rule and subsequent behaviour.</p><p>It would be useful to see similar sensitivity analyses for other key parts of the model.</p><p>Clarifications:</p><p>6. pg 28: 3 lines from bottom.</p><p>Do the authors mean &quot;activity of the ith presynaptic KC? 'Target' sounds like it is postsynaptic.</p><p>7. Equation 30 onward.</p><p>w_rest: Is this a global parameter for all synapses?</p><p>w_rest: The way it is used in the equation looks more like a_rest, the resting activity of the synapse. Sorry to be pedantic, but the units of weight and rate don't match.</p><p>This gets further mixed in the equation between lines 853 and 854 where the authors add ki and Wij. Maybe ki is scaled somehow to weights?</p><p>8. Figure 5 and later: The responses, both experimental and model, are shown as an up-down oscillation. I assume that the up states are measurements during the training, and down is measurement half a day later. But this is hard to see from the text or legends, and I had to go down to the last section in the methods to see that this seems to be described as on-shock and off-shock values. It is confusing and should be mentioned in the figure legends and accompanying text.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The authors propose an original dopaminergic learning rule, which, when implemented in simple neural circuit motifs shown to exist within the <italic>Drosophila</italic> mushroom body (MB), can potentially account for a very large number of independent, poorly integrated physiological and behavioural phenomena associated with the mushroom body. It considers multiple behavioural roles of MB output neurons beyond attraction and aversion and offers new insight to the how the MB functions in acquisition, consolidation and forgetting of short and long-term memories. They discuss how the motifs and computations discussed would be relevant to other MB functions and altered by known connections, not yet included the simplified model. The manuscript further attempts to show how similar principles could potentially be useful in the mammalian brain. An ambitious and integrative analysis of this sort is sorely needed in the field.</p><p>I thank the authors for a very constructive, clear and insightful response to the prior criticism and queries, The manuscript is now hugely improved and can be accepted with no further changes. I think it represents a major contribution to the field. This is a wonderful piece of work that I, at any rate, would recommend to anyone interested in the mushroom body.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>First, I'd like to thank the authors for responding to my concerns/suggestions. At this point, it reads, in my assessment, much better as a result of the many changes. In particular, the newer figures are of high quality and their stated goals much easier to grasp. Also, shifting most of the discussion of the &quot;formal&quot; model in the (old) Results section to the (new) Methods section makes reading flow more intuitively.</p><p>Second, the disagreement we had, appears now to be more in terms of naming/labelling of Equation (18) and (30), thus clarifying the rational for the naming of the 2 learning rules (DPR) and (RPE). However, the &quot;RPE&quot; naming for (30) is, in my view, a bit of a stretch, but I am not raising an objection. Just a friendly note to the authors.</p><p>I'd like to make a final suggestion that future readers might benefit from. Reviewer 1 raised this issue already and the authors addressed the question. However, in my view, the presentation starting with &quot;we postulate a mathematical formulation …&quot; just above Equation (32), seems a bit circular. While the authors answered the question, in terms of intuitive modeling (Equation (34)), the presentation thread I am referring to is rather formal. The D's in Equations (32), (33) are not explicitly defined; the equations, when added up are consistent with the Equation above line 854. While Equation (34) provides the intuition of the decomposition of the weights into 2 terms, this decomposition is by no means unique. Having said that, we are then confronted with Equations (35) and (36). There is little justification given for the rational of choosing/postulating these two diff. Equations. I presume that the solution for these Equations are the D's. A careful reading seems to suggest that these are delayed differential equations. In math terms, a single delayed diff. Equation is infinite dimensional, and essentially intractable. The following Equations (37)-(39), while consistent with the discussion above, do not help clarify the matter. Which brings one back to Equations (32), (33). Finally, the Methods section has a sizable number of matrices that have seemingly arbitrary entries.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.75611.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the authors resubmitted a revised version of the paper for consideration. What follows is the authors’ response to the first round of review.]</p><disp-quote content-type="editor-comment"><p>While all the reviewers appreciate the ambition and value in integrating diverse sources of data to developing a model of learning, they had some substantial concerns. These are elaborated in their detailed comments, and I provide a distillation of the discussion that the reviewers and I had about the paper. Since it will take considerable further work to address these points, the reviewers and I felt that the paper should be rejected. If the authors wish to resubmit after completely addressing the concerns this would be fine.</p></disp-quote><p>We are grateful to the editor and all three reviewers for their enthusiasm for our model, and appreciate the detailed suggestions for how to improve this manuscript. We have taken seriously these comments and have performed substantial revisions of this manuscript to address all concerns raised.</p><disp-quote content-type="editor-comment"><p>1. The reviewers found the paper a difficult read. Could the authors rewrite to make it accessible to a wide range of readership?</p></disp-quote><p>We recognize this as a serious issue and have thoroughly rewritten this manuscript. For example, we have moved the derivation of the dopaminergic plasticity rule to the Methods section, and instead now provide a more intuitive description of the model in the Results section. We also updated the text to concurrently name the mushroom body neurons we believe form the incentive circuit as we describe the specific components of the incentive circuit for ease of comparison. We have updated the behavioural results and methods in order to improve clarity. Several excerpts of this major rewrite are presented below in our responses to each reviewer.</p><p>To further improve the accessibility of our manuscript, we have also edited the figures to provide experimental data side-by-side with simulated data to make it easier to compare. Finally, we have changed the way that we illustrate the behaviour of the simulated flies to better show the effects of the plasticity rule and the long-term memory.</p><disp-quote content-type="editor-comment"><p>2. The formulation of the DLR seems to be a variant of RPE (Reward Prediction Error) learning rules, and hence the conclusions need to be re-evaluated.</p><p>Can the authors re-think the basic formulation of DLR starting with Equations (2) and (3)? There should be some experimental tests if the DLR is indeed determined to be different from regular RPE.</p></disp-quote><p>We politely disagree that the DLR (now DPR) is a variant of RPE, and have made our explanation of this more clear in the text. For example, “Instead of calculating the error between the reinforcement and its prediction, DPR uses the reinforcement as a driving force to maximise the diversity in the synaptic weights of reinforced experience while reducing it for experiences irrelevant to the reinforcement, which is functionally closer to the information maximisation theory (Bell and Sejnowski, 1995; Lee et al., 1999; Lulham et al., 2011) than the RPE principle.” - lines 103-107.</p><p>“Note that this rule [i.e., RPE] allows updates to happen only when the involved KC is active, implying synaptic plasticity even without DAN activation but not without KC activation, which is in contrast with our DPR and recent findings (Berry et al., 2018; Hige et al., 2015) [also in larva (Schleyer et al., 2018, 2020)].” - lines 400-403.</p><p>However, we do not exclude the possibility that RPE could be implemented via other mushroom body neurons or connection which are featured in our incentive circuit model.</p><p>“… by using the appropriate circuit, i.e., positive MBON-DAN feedback to depressing DANs, our DPR could also have an RPE effect. Although the proposed incentive circuit does not include such connections, it is still possible that they exist.” - lines 484-486.</p><p>Finally, we provide a list of testable predictions in Box 1 that includes an experiment to distinguish RPE from DLR, suggested by the combination of the DPR with the incentive circuit.</p><p>“By consistently activating one of the LTM MBONs while delivering a specific odour, the LTM MBON should show increased response to that odour even without the use of a reinforcement. This would verify the saturation effect of the DPR and the charging momentum hypothesis. On the other hand, if we observe reduced response rate, this would show that MBON-DAN feedback connection is inhibitory and that RPE is implemented by the circuit.” - lines 644-649.</p><disp-quote content-type="editor-comment"><p>3. The microcircuits should be better based on experimental data. From our understanding, the data shown in Figures 4H/G, 5B/C/E/F and 6B/C seems to have been obtained by simulations. Would Ca recordings for these figures be feasible? Can there be stronger justification for the connectivity of the proposed incentive circuit?</p></disp-quote><p>Those data shown were indeed generated by simulations that highlighted the effects of the different microcircuits combined with the plasticity rule, and Ca recordings for a subset of these experiments already exists and is reproduced in this manuscript. In order to avoid further confusion, experimental and simulated data are now plotted next to each other in the same figure, and we explicitly state in the figure legends whether each subfigure is simulated or experimental data.</p><p>We agree that it is critical that our proposed circuit is strongly grounded in experimental data. Our model was designed through close inspection of a comprehensive dataset of DAN and MBON activity during reversal learning in McCurdy et al. (2021), and an examination of the literature regarding anatomical connections between proposed neurons. Hence there is a strong functional and anatomical basis for our circuit. Additionally, our model allows us to make concrete predictions about how neurons would respond in other learning tasks, such as extinction learning and unpaired shock presentation. We found other papers [e.g., Felsenberg et al. (2018), Berry et al. (2018), Ichinoise et al. (2015)] which provide experimental data for some neurons during some of these tasks, which largely aligns with our model predictions. We believe that the few remaining ‘gaps’ in experimental data can be performed by other labs in the future.</p><disp-quote content-type="editor-comment"><p>3b. The proposed circuit connectivity of the 'incentive circuit' needs to be defined for each MBON because most contemporary work shows that different kinds of memory involved plasticity in different subsets of MBONs. Can the model make specific testable predictions for each subset of MBON?</p></disp-quote><p>We include in Table 1 a complete list of known neurons that we propose comprise our circuit connectivity (e.g., MBON-γ1pedc&gt;α/β), how we define it in terms of our model (e.g., s<sub>at</sub>), and the microcircuit in the incentive circuit we propose it is in (e.g., SM). We now also include more discussion of similarities between the proposed properties of our neurons and known properties of memory and plasticity derived from experimental data. For example, we identify MBON-γ1pedc&gt;α/β as an MBON that encodes susceptible memories, which is consistent with how its corresponding DAN, PPL1-γ1pedc, induces a relatively high learning rate and low retention time (Aso and Rubin, 2016).</p><p>“Figure 5C-E show the responses of these neurons from experimental data (left) and from our model (right) during aversive conditioning […], which follow a similar pattern. Learning in this circuit is shown by the sharp drop (in both experimental data and model) of the response of MBON-γ1pedc&gt;α/β (Figure 5D) to odour B already from the second trial of the acquisition phase. […] due to our plasticity rule, if the US subsequently occurs without the CS […], the MBON synaptic weights reset due to the recovery effect […]. This is consistent with the high learning rate and low retention time observed in Aso and Rubin. (2016), and it results in a memory that is easily created and erased: a ‘susceptible memory’.” - lines 186-197.</p><p>On the other hand, PPL1-γ2α’1 and PAM-β'2a keep the balance between the attraction and avoidance STM, which is also consistent with the more balanced learning rate and retention time in PPL1-γ2α’1 found by Aso and Rubin (2016).</p><p>“The ‘charging’ DANs, PAM-β'2a and PPL1-γ2α'1, should be activated directly by reinforcement as well as by the restrained MBONs. This allows for memories to be affected directly by the reinforcement, but also by the expression of the opposite valence memories. The latter feature keeps the balance between the memories by automatically erasing a memory when a memory of the opposite valence starts building up and results in the balanced learning rate and retention time as observed in Aso and Rubin (2016).” - lines 233-238.</p><p>We have also provided general predictions regarding specific neurons of the incentive circuit in Box 1.</p><p>“MBON-γ2α'1 and MBON-γ5β'2a should exhibit short-term memories, while MBON-α'1 and MBON-β2β'2a long-term memories. MBON-γ1pedc&gt;α/β and MBON-γ4&gt;γ1γ2 should exhibit susceptible memories. Restrained and susceptible MBONs should show more consistent responses across flies. LTM MBONs should have more variable responses because they encode all previous experiences of the animal.” - lines 633-637.</p><p>“Blocking the output of charging DANs (i.e., PPL1-γ2α'1 and PAM-β'2a) could reduce the acquisition rate of LTM MBONs, while blocking the output of LTM MBONs would prevent memory consolidation. Blocking the reciprocal connections of the circuit should prevent generalising amongst opposing motivations (unable to make short- or long-term alteration of responses to odours once memories have formed). Blocking the output of forgetting DANs would additionally lead to hyper-saturation of LTMs, which could cause inflexible behaviour.” - lines 650-656.</p><p>“Activation of the forgetting DANs should depress the KC-MBON synaptic weights of the restrained and LTM MBONs of the same and opposite valence respectively, and as a result suppress their response to KC activation. Activation of the same DANs should cause increased activity of these MBONs for silenced KCs at the time..” - lines 657-660.</p><disp-quote content-type="editor-comment"><p>4. Further experimental predictions should be made, based on well-parameterized models of the underlying neurons. Can the authors provide considerably more clarity on which sets of behavioral or physiological data are selected by the authors as targets or tests for specific parts of their model?</p></disp-quote><p>We have increased the clarity of the predictions resulting from our model by adding a floating box in the discussion (see Box 1), where we summarise a number of specific predictions (some of them mentioned in the previous comment). We also add a column in Table 1 clarifying whether physiological/anatomical (i.e., using light or electron microscopy) or behavioural/functional (i.e., looking at the responses of postsynaptic neurons while manipulating the pre-synaptic ones) data were used in order to validate the connections of the model.</p><disp-quote content-type="editor-comment"><p>5. Can the model account for existing data showing overlapping conflicting engrams? Additional experiments and simulations may be needed to ascertain this.</p></disp-quote><p>This is an interesting example of sophisticated memory mechanisms in the brain, and both experimental data and our model support this phenomenon. Very recent work (Felsenberg et al., 2018; McCurdy et al., 2021) found that conflicting memories can coexist in the fly brain. For example, MBON-γ1pedc&gt;α/β stores the original aversive memory (odour A = avoidance), and does not change its response to odour A despite multiple subsequent presentations of odour A in the absence of shock. Other MBONs, e.g., MBON-γ5β’2a and MBON-γ2α’1 do in fact change their responses to odour A during extinction/reversal. This phenomenon in part formed the basis for our model, thus our model accounts for these phenomena. While we do not have a complete dataset of all relevant neurons and all learning tasks, our model provides predictions of how these neurons would respond, and this can be verified by experimental labs in the future. We now include this in our results:</p><p>“From the summarised synaptic weights shown in Figure 11 —figure supplement 1 [equivalent to engrams], we can see that the susceptible MBONs immediately block the simulated flies from approaching the punishing odours [i.e., original aversive memory], while they allow them to approach the rewarding ones, […]. Susceptible MBONs [i.e., MBON-γ1pedc&gt;α/β and MBON-γ4&gt;γ1γ2] convulsively break the balance between attraction and avoidance created by the restrained and LTM MBONs, also affecting their responses, and allowing STM and as a result LTM formation even without the presence of reinforcement. Figure 11 —figure supplement 1 also show that the restrained MBONs [i.e., MBON-γ5β’2a and MBONγ2α’1] seem to play an important role during the first repeats (up to 5), but then they seem to reduce their influence giving up the control to the LTM MBONs [i.e., MBON-α’1 and MBON-β2β’2a], which seem to increase their influence with time. […] [the different types of MBONs / conflicting engrams] seem to better work when combined, as they complement one another in different stages, e.g., during early or late repeats [of the experiment] and crucial times.” - lines 371-387.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>This ambitious study builds a model of a proposed key circuit motif in fly behaviour and learning, the Incentive Circuit. The authors examine its implications for a variety of behaviours, and perform a thorough circuit-level mapping of model neuronal activity to recordings. The model uses abstracted model neurons and synaptic signaling, but with careful attention to experimental data at many steps. The mapping to experiments is good, and the model makes far-reaching predictions for animal behaviour.</p><p>The development of the model is generally well presented. The learning rule is derived from earlier work (Handler et al) and then the authors transform the terms for ER-ca<sup>2+</sup> and for cAMP to terms emerging from DA inputs. The model development is especially systematic, building up to the final version step by step with reference to experiments. Importantly, these are mapped to specific sets of experimental observations on the circuit level.</p><p>I have mostly comments to clarify or strengthen the presentation.</p><p>1. I had a little trouble to envision the two components of D2 and D1. Are they time-varying? Seems to be, see equation 4, where they are presented as D1(t) and D2(t). In other words, do they express D2 and D1 as distinct α functions following spike activity in the DAN? However, in the text and figures it is frequently presented in terms such as D2 &gt; D1 (eg., Figure 3), which looks like a static effect. This was confusing.</p></disp-quote><p>We thank the reviewer for this opportunity to clarify our model. D1 (now D<sub>▽</sub>) and D2 (now D<sub>△</sub>) are indeed time-varying, i.e., work as a function with time as a parameter, and we do express them as distinct α functions. We agree with the reviewer that there was potential for confusion, because in the main modelling results for the incentive circuit we use a low time resolution such that these effects can be abstracted to be ‘static’ properties of the influence of specific DANs, even though this is ultimately based on the evidence for two components to the response to DA. The influence (positive or negative ‘dopaminergic factor’) on a particular KC-MBON synapse can still be time-varying as it depends on the activity of all DANs targeting this synapse. We have moved the explanation of the two-component DA response to the methods and now focus on the abstracted concept in the main text. We also updated our description that now makes clear the two terms are time-varying.</p><p>“This essentially means that D<sub>▽</sub>(t) and D<sub>△</sub>(t) are expressed as time-varying functions following DAN spike activity. […] we have the fast update with the high peak for D<sub>▽</sub>(t) (0.5 sec for a full update) and a slower update with lower peak for D<sub>△</sub>(t) (1 sec for a full update), …” - lines 873-878.</p><disp-quote content-type="editor-comment"><p>2. Also in Figure 2A, are we seeing the peak values of ER-Ca or area under curve? Around line 128 it is a hint that it is area under curve, but I am not sure.</p></disp-quote><p>It is an approximation of the normalized area under the curve; we refer to it as “the normalised mean change of the synaptic weight” in the manuscript. We have added the paragraph below in order to clarify this now.</p><p>“In Figure 16A, we report the normalised mean change of the synaptic weight calculated using the computed ER-ca<sup>2+</sup> and cAMP levels and the formula below</p><p><inline-formula><mml:math id="sa2m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext>ij</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mtext>Ca</mml:mtext><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mtext>ij</mml:mtext></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mi>A</mml:mi><mml:mi>M</mml:mi><mml:mi>P</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>” - lines 864-865 and Equation 34.</p><disp-quote content-type="editor-comment"><p>3. I would have liked to have seen some more mapping to functional experiments in the figures up to Figure 7, where the components of the model are being built up. The authors mention several in the text. Even a qualitative look at the experimental responses would help to strengthen the motivation of the model design.</p></disp-quote><p>We agree, and have addressed this point by plotting known experimental data side by side of simulated data for ease of comparison in Figures 5, 6, 7, and 8. We also explicitly state in the text the results of experimental studies and how that data corresponds with what is predicted by our model. E.g.,</p><p>“Learning in this circuit is shown by the sharp drop (in both experimental data and model) of the response of MBON-γ1pedc&gt;α/β (Figure 5D) to odour B already from the second trial of the acquisition phase. […] due to our plasticity rule, if the US subsequently occurs without the CS […], the MBON synaptic weights reset due to the recovery effect […]. This is consistent with the high learning rate and low retention time observed in Aso and Rubin. (2016), and it results in a memory that is easily created and erased: a ‘susceptible memory’.” - lines 189-197.</p><p>“the experimental data shows a slight drop in the shock response (first paired with odour B, then with odour A) of the DAN, PPL1-γ1pedc, during the whole experiment, although it remains active throughout. We assume this drop may reflect a sensory adaptation to shock but have not included it in our model.” - lines 201-204.</p><p>“Interestingly, the [neural] responses communicated by the MB296B<sub>1</sub> terminal are close to the ones produced by the punishment-encoding charging DAN (see Figure 6C) and the ones of the MB296B<sub>2</sub> are close to the ones produced by the attraction-driving forgetting DAN (see Figure 8D).” - lines 300-303.</p><disp-quote content-type="editor-comment"><p>4. The authors then utilize this circuit in an aversive olfactory conditioning paradigm, for which they provide experimental data corresponding to the various neuron types. They then simulate this. This is an outstanding way to validate/test their model. It would be helpful to have the experimental and simulated responses interleaved on the same figure so as to better compare.</p></disp-quote><p>We agree and we now plot the experimental and simulated responses side-by-side on the same figure for ease of comparison.</p><disp-quote content-type="editor-comment"><p>5. I appreciate that it is quite challenging for a simulation to simultaneously replicate properties of several intermediate stages of circuit activity, even more so when the stimulus is not one that the model has been trained on. Could the authors confirm that this is indeed the case, i.e. that the model outcome for figure 9 was obtained only from the parameter tuning earlier in the paper up to Figure 7?</p></disp-quote><p>That is correct: the parameters of the model are the same for the whole manuscript. The only parameter that was different was the LTM changing synaptic weight (c-&gt;m) in the microcircuits description, and this was just to exaggerate the long-term memory effect and make it more obvious to the reader. As these figures are omitted in our new version of the manuscript, now the parameters are the same for all the results, and we explicitly confirm this in the Methods.</p><disp-quote content-type="editor-comment"><p>6. It would be useful to perform a statistical evaluation of the fidelity of the model as compared to experiment.</p></disp-quote><p>That’s an excellent idea that we now address with Figure 3 —figure supplement 1. We plotted the correlation between behavioural data predicted by our model and experimentally-derived behavioral data from 92 experiments extracted from different studies by Bennett et al. (2021), and found a very strong positive correlation, r = 0.76, p = 2.2 x 10<sup>-18</sup> (selected neurons) and r = 0.77, p = 2.2 x 10<sup>-19</sup> (best-fit neurons).</p><disp-quote content-type="editor-comment"><p>7. The authors then place their model flies in a virtual arena and explore a number of behaviours. Here they contrast their model behaviour with the predictions from a different learning, reward prediction error. I would have liked to have seen in figure 11 an illustration of the correspondence to experimental observations from the literature.</p></disp-quote><p>This comment inspired us to perform the additional analysis summarized in Figure 3 —figure supplement 1. In this figure, we compare the correlation between our model and experimental data with the correlation between RPE and experimental data, and found that our model performs better than other models. Pearson’s correlations and p values for DPR, RPE and model presented in Bennett et al., 2021, respectively: r<sub>DPR</sub> = 0.77, p<sub>DPR</sub> = 1.65 x 10<sup>-19</sup>; r<sub>RPE</sub> = 0.58, p<sub>RPE</sub> = 2.32 x 10<sup>-9</sup>; and r<sub>Bennett</sub> = 0.68, p<sub>Bennett</sub> &lt; 10<sup>-4</sup>.</p><p>In addition, we provide qualitative evidence of correspondence between our simulated behavior and experimentally-derived behavioural data. For example,</p><p>“By looking at the PIs of Figure 11B, we see a strong effect when electric shock is paired with odour A or B, but not very strong otherwise. We also see a smaller π for flies experiencing sugar than the ones that experience electric shock, which is inline with experimental data (Krashes and Waddell, 2011a, b).” - lines 357-360.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>The manuscript in its current form is built around two main threads. In the first thread, the authors review several results in the literature on associative learning in the mushroom body of the adult fruit fly, and construct an Incentive Circuit (IC) consisting of 6 dopaminergic and 6 mushroom body neurons with specific memory dynamics. They provide a coherent functional view of some of the disparate recent results in associative learning of the mushroom body.</p><p>The second thread incorporates a Dopaminergic Learning Rule (DLR) into the IC computational model, providing a computational system for evaluating the learning mechanisms involved.</p><p>A weakness here is that the acquisition, forgetting and assimilation of memories qualitatively described in the first thread are not strongly linked with the quantitative IC model described in the second thread.</p><p>Conversely, the validation of the IC model circuit, given the noisy data that the authors provide, is only possible in terms of trends, i.e., simple visual inspection. Interpreting the data then is difficult as it does not provide enough constraints for the computational model.</p><p>Given the limitations inherent in the validation of the IC from their recorded data, the authors proceed to explore the DLR using behavioral experiments purely based on simulations. This is an effective methodology widely employed in, e.g., robotics. The authors extensively compare the 'learning/navigation' performance of DLR with a variant of reward prediction error (RPE) learning rule and demonstrate a better learning performance. While the comparison may be compelling, we found that underlying the DLR, is the computation of a prediction error, i.e., DLR is a variant of RPE. This calls for a re-evaluation, positioning and clarification of some of the key conclusions regarding why the DLR is effective in associative learning tasks.</p><p>Substantive concerns</p><p>1. l.128 The section 'Mushroom Body Microcircuits' makes good first reading. However, most of the key statements could further benefit from more extensive quantitative backing as hinted at in Figures 4, 5 and 6 (see also my comment below). Since these microcircuits are simpler than the IC, my expectation is that they could provide better intuition regarding their function.</p></disp-quote><p>This is an excellent point. We now plot the quantitative experimental data side-by-side with the simulated data for ease of comparison. We also include the corresponding neuron name with the model neuron’s name, for better intuition, as the reviewer suggested.</p><p>“Learning in this circuit is shown by the sharp drop (in both experimental data and model) of the response of MBON-γ1pedc&gt;α/β (Figure 5D) to odour B already from the second trial of the acquisition phase. […] due to our plasticity rule, if the US subsequently occurs without the CS […], the MBON synaptic weights reset due to the recovery effect […]. This is consistent with the high learning rate and low retention time observed in Aso and Rubin. (2016), and it results in a memory that is easily created and erased: a ‘susceptible memory’.” - lines 189-197.</p><p>“the experimental data shows a slight drop in the shock response (first paired with odour B, then with odour A) of the DAN, PPL1-γ1pedc, during the whole experiment, although it remains active throughout. We assume this drop may reflect a sensory adaptation to shock but have not included it in our model.” - lines 201-204.</p><p>“Interestingly, the [neural] responses communicated by the MB296B<sub>1</sub> terminal are close to the ones produced by the punishment-encoding charging DAN (see Figure 6C) and the ones of the MB296B<sub>2</sub> are close to the ones produced by the attraction-driving forgetting DAN (see Figure 8D).” - lines 300-303.</p><disp-quote content-type="editor-comment"><p>2. Figures 4F and 4G are rather difficult to understand/parse. More caption details, choice of different colors, would help.</p><p>Same comment regarding Figures 5B, 5C, 5E and 5F, and 6B, 6C.</p></disp-quote><p>Based on this comment and similar sentiments expressed by other reviewers, we have now removed these figures. Instead, we made new figures (i.e., Figures 5, 6, 7, and 8) which plot known experimental data side by side of simulated data for ease of comparison.</p><disp-quote content-type="editor-comment"><p>3. While Figure 8 is to be commended, the data is rather noisy and, in my view, despite the best intentions, rather difficult to understand/evaluate. As the authors argue in l.312, 'we computationally modelled the incentive circuit in order to demonstrate all the properties we described before and compare the reconstructed activities to the ones of Figure 8C'. However, a comparison by simple visual inspection is rather unconvincing. The need for introducing a distance measure is in order.</p></disp-quote><p>Although we do not incorporate a distance measure, we have made two major changes to address this issue: First, we plot the experimental data next to the simulated data so that readers can perform visual inspection more easily. Second, we now provide explicit descriptions of the level of similarity between recorded and simulated data for each neuron. Overall, there is a large degree of overlap for the majority of neurons e.g., PPL1-γ1pedc, both PPL1-γ2α’1, PAM-β’2, MBON-γ1&gt;α/β, MBON-γ5β’2a, MBON-γ2α΄1 and MBON-β2β’2. However, it is interesting that some neurons, e.g., the MBON-α’1, do not have as good of a fit. We discuss this in the text and provide possible reasons for why these neurons in particular do not fit as well.</p><p>“Figure 5C-E show the responses of these neurons from experimental data (left) and from our model (right) during aversive conditioning (the paradigm shown in Figure 4), which seem to follow similar patterns.” - lines 186-188.</p><p>“However, these trends are not evident in the experimental data as illustrated in Figure 7D (left). We suggest this is because responses of long-term memory neurons depend on the overall experience of the animal and are thus hard to predict during one experiment. For example, it could be the case that the animal has already built some long-term avoidance memory for odour A, such that its presentation without reinforcement in our experiment continues its learning momentum leading to the observed increasing response.” - lines 266-272.</p><disp-quote content-type="editor-comment"><p>4. I found 'modeling behavior', as presented in the current version of the manuscript, to be quite effective. However, I'd like to note that in the process, the authors changed the underlying PN activity model. This requires, given that the rest of the paper is based on a binary odor model of the PN activity (see the discussion preceding Equation (6)), some careful/detailed assessment of its implications.</p></disp-quote><p>This is a valid point. For consistency we reran our simulations in Figure 11 using the same PN activity parameters (binary, using a threshold on odour intensity) as those used in the earlier figures. These new results are comparable to the previous version, and still support our conclusions. We have now included the specifics of this model here:</p><p>“Note that PN responses depend only on the fact that an odour has been detected or not and it is not proportional to the detected intensity.” - lines 812-813.</p><disp-quote content-type="editor-comment"><p>5. Finally, the authors propose to compare their DLR with a variant of RPE. Here a major conceptual problem arises. The authors argue that DLR is a fundamentally different learning rule from RPE. They state in l.462 that 'The idea behind RPE is that the fly learns to predict how rewarding or punishing a stimulus is by altering its prediction when this does not match the actual reward or punishment experience'. This can be adapted to the mushroom body circuit by assuming that the MBON output provides a prediction of DAN activity. But this is exactly what Equation (18) states. The differential equation (18) describing the gradient of the DAN activity is equal to sum of the weighted shock delivery ('transform' in l.750) and the weighted MBON activity (l.755). The sum is just the prediction error between the two terms. Consequently, since the DLR is, in view of this reviewer, a variant of RPE, a comparison with another RPE is of little interest. A substantial re-write of the paper starting with the section on the Incentive Circuit (l. 257) is in order.</p></disp-quote><p>We believe we all agree that our DPR (with the simplest circuit implementation as shown in Figure 2) is definitely not a variant of the RPE.</p><p>“Instead of calculating the error between the reinforcement and its prediction, DPR uses the reinforcement as a driving force to maximise the diversity in the synaptic weights of reinforced experience while reducing it for experiences irrelevant to the reinforcement, which is functionally closer to the information maximisation theory (Bell et al., 1995; Lee et al., 1999; Lulham et al., 2011) than the RPE principle.” - lines 103-107.</p><p>The reviewer is right that (in the incentive circuit) DAN responses are indeed calculated based on the weighted US plus the weighted MBON activity. However, as the DAN and US responses are always positive numbers, and the synaptic weights are also positive, this is not (in general) the calculation of an error. An exception is the s-&gt;d connection, which is inhibiting. However, even for this case, although this term could be interpreted as error calculation, only the positive part of the DAN activity is used in the learning rule (see Equation 22) which means that the MBON activity (indirectly passed through the DAN activity) only controls the magnitude and not the ‘direction’ of change for the synaptic weight. It is thus clearly different to RPE methods that control both the magnitude and direction of change based on the error computed between the reinforcement and its ‘prediction’.</p><p>“Consequently, the model data shows a positive feedback effect: the DAN causes depression of the MBON response to odour, reducing inhibition of the DAN, which increases its response, causing even further depression in the MBON. Note this is opposite to the expected effects of reward prediction error.” - lines 205-208.</p><p>That said, we mention in our Discussion the possibility that RPE could be implemented by other neurons or connections of the mushroom body (not included in the incentive circuit):</p><p>“However, although the evidence for MBON-DAN feedback connections is well-grounded, it is less clear that they are consistently opposing. For example, in the microcircuits we have described, based on neurophysiological evidence, some DANs that depress synaptic weights receive inhibitory feedback from MBONs (Pavlowsky et al., 2018) and some DANs that potentiate synaptic weights receive excitatory feedback from DANs (Ichinose et al., 2015). As we have shown, the DPR is able to operate with this variety of MBON-DAN connections. Note that, by using the appropriate circuit, i.e., positive MBON-DAN feedback to depressing DANs, our DPR could also have an RPE effect. Although the proposed incentive circuit does not include such connections, it is still possible that they exist.” - lines 478-486.</p><disp-quote content-type="editor-comment"><p>6. l.765: &quot;The above matrices summarise the excitatory (positive) and inhibitory (negative) connections between MBONs and DANs or other MBONs. The magnitude of the weights was hand-tuned in order to get the desired result.&quot; This 'hand-tuning&quot; appears, to me, to be a 'construction' of the prediction error on the right hand side of Equation (18). Some details might help clarify to what extent the hand-tuning is based on the assumptions of the binary model of the 2 odors at the PN level. I presume that the generality of the model alluded to in l.743 stating that 'that the number of neurons we are using for PNs and KCs is not very important and we could use any combination of PN and KC populations' breaks down and the hand-tuning needs to be repeated every time the number of neurons is changed.</p></disp-quote><p>We have now made clearer in the methods that the ‘hand-tuning’ of weight magnitude does not permit alteration of the sign of the weights, and it does not result in effective construction of prediction error, as detailed in our previous answer. The tuning is used to create a better matching between the recorded and reconstructed responses in Figures 5-9, and so as to keep the balance of memories in the circuit, e.g., the MAM forgetting should be equally weighted to the LTM charging so that we erase from the STM the same amount as we store in the LTM, and it is independent to the PN activity pattern. The weights are not further changed for the remainder of the results. Finally, by hand-tuning we want to emphasise that we haven’t used any automatic, unconstrained method to calculate the weights in order to fit the data better. We have now edited the text to reflect this:</p><p>“… we define these parameters and some properties of our computational model, which are not a result of unconstrained optimisation and are consistent throughout all our experiments.” - lines 705-706.</p><p>“The sign of the weights was fixed but the magnitude of the weights was hand-tuned in order to get the desired result, given the constraint that equivalent types of connections should be same weight (e.g., in the reciprocal microcircuits). The magnitude of the synaptic weights specify the effective strength of each of the described microcircuits in the overall circuit.” - lines 743-746.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>The authors propose an original dopaminergic learning rule, which, when implemented in simple neural circuit motifs shown to exist within the <italic>Drosophila</italic> mushroom body (MB) , can potentially account for a very large number of independent, poorly integrated physiological and behavioural phenomena associated with the mushroom body. It considers multiple behavioural roles of MB output neurons beyond attraction and aversion and offers new insight to the how the MB functions in acquisition, consolidation and forgetting of memories. The manuscript further attempts to show how similar principles could potentially be useful in the mammalian brain. An ambitious and integrative analysis of this sort is sorely needed in the field.</p><p>The paper has obviously involved very broad and deep consideration of the MB connectome as well as genetic, physiological and behavioural studies of the roles of the different classes of Kenyon cells, MBONs and DANs that innervate the mushroom body. It is original and ambitious and potentially very valuable to the field.</p><p>My major reservation is that the manuscript is very difficult to read and evaluate by anyone who is not a <italic>Drosophila</italic> mushroom body aficionado. I consider myself an interested reader and one who keeps broad track of the field, but found the need to read and evaluate far too many papers cited by the authors to decide how well phenomena the authors attempt to model have been demonstrated and how well assumptions made by the authors are justified by data.</p><p>1. E.g. I was stymied even at figure 1, where mutual inhibition between MBONs is indicated and it took me considerable (and eventually futile) effort to look into where and how well this has been established.</p></disp-quote><p>In Figure 1 we meant to demonstrate that MBON-to-MBON connections exist in the mushroom bodies, and it was not our intention to suggest mutual inhibitory connections. We have changed the lines of these connections to dashed, so that they look different from the rest of the connection. We have also updated the caption of Figure 1 to make this clear.</p><p>“These circuits include some direct (but not mutual) MBON-MBON connections (dashed inhibitory connections).” – Figure 1.</p><disp-quote content-type="editor-comment"><p>2. To make the work more accessible at least to this moderately educated reviewer, I fear that a major re-rewrite will be required. I would suggest that for each section – exactly has been shown be clearly enumerated, with enough detail provided for the reader to judge the strength of these data. The justification and support for three types of MBONs and their incentive should also be particularly clearly indicated.</p></disp-quote><p>We have undertaken a major rewriting and we hope the manuscript is now easier to process, including for those less familiar with the <italic>Drosophila</italic> mushroom body. This includes more explicit connection of each part of the circuit construction to the relevant data.</p><disp-quote content-type="editor-comment"><p>3. Moreover, while the authors are correct to point out the limitations of current models based on dopamine prediction-error, I do wonder if there is room for prediction error to also contribute meaningfully within the framework proposed in this paper.</p></disp-quote><p>Indeed, we believe that there is still room for RPE in the fly brain, that could also be implemented by our DPR given specific circuitry as we discuss in our text:</p><p>“… this rule [i.e., DPR], in combination with some specific types of circuits, can result in prediction of reinforcements, …” - lines 107-108.</p><p>“… by using the appropriate circuit, i.e., positive MBON-DAN feedback to depressing DANs, our DPR could also have an RPE effect. Although the proposed incentive circuit does not include such connections, it is still possible that they exist.” - lines 484-486.</p><p>However, we also believe it is not a general (or necessary) property of plasticity in the mushroom body, as we illustrate in our incentive circuit.</p><disp-quote content-type="editor-comment"><p>I apologise for the not having a list of specific issues for the authors to address, because I found the basis to be so difficult to explore but here is some general feedback.</p><p>4. It is nice that and the dynamics of neural responses obtained with the model correspond closely with ones reported in previous studies (although there are exceptions, some nicely highlighted by the authors).</p></disp-quote><p>We thank the reviewer and we are happy that they see the value of our work.</p><disp-quote content-type="editor-comment"><p>5. There should be deeper engagement with signalling mechanisms that differentiate the two types of dopamine receptors. I found the assumptions regarding their differences to be useful for the modelling of different effects of reinforcement before or after sensory experience (Ruta Cell 2019), but quite superficial in terms of providing hypothesis for how the receptors may differ in terms of mechanism of action.</p></disp-quote><p>D<sub>1</sub> and D<sub>2</sub> (now D<sub>▽</sub> and D<sub>△</sub>, respectively) are not necessarily meant to be DopR1 and DopR2 responses.</p><p>These are 2 abstract terms/components of the dopaminergic signal that interact in the synapse and might be related to DopR1 and DopR2, but they are not the same. We hope that this is clearer now in our text:</p><p>“… where D<sup>j</sup><sub>▽</sub>(t) and D<sup>j</sup><sub>△</sub>(t) are the depression and potentiation components of the DA respectively [assumed to correspond to DopR1 and DopR2 receptors (Handler et al., 2019), or potentially to involve cotransmitters released by the DAN such as Nitric Oxide (Aso et al., 2019)].” - lines 845-847.</p><disp-quote content-type="editor-comment"><p>6. ON the same note, specific experimental predictions of the model could also be clearly indicated at the end of each section.</p></disp-quote><p>We have now added a floating box (Box 1) with specific experimental predictions of the model. Some examples of these predictions include: (a) the roles of the different DANs and MBONs in the memory dynamics of fruit flies, (b) how the activity of specific neurons would be affected when manipulating the activity of specific neurons in the mushroom body and (c) what are the effects of manipulating the neurons in different conditioning types (e.g., first-order, second-order and unpaired).</p><disp-quote content-type="editor-comment"><p>7. While the authors admittedly designed informative and clear figures, and their Table 1 points the reader to papers that report relevant neural connections and neuronal functions, this is not enough. Data in support of each assumption should be clearly and specifically mentioned and hypotheses connections also clearly stated. After considerable effort, I still could find no evidence for the existence of inhibitory connections between MBONγ4 and MBONγ2 (which is not to say that none exist – but surely it is the authors job to clarify this).</p></disp-quote><p>We have updated Table 1 to make more clear what information about neural connections is known versus hypothesized. For each connection, we denote whether its anatomical connection (using light microscopy or electron microscopy) or functional connection (i.e. whether activating the presynaptic neuron leads to an excitatory or inhibitory response in the postsynaptic neuron, and/or the neurotransmitter released by the presynaptic neuron) is known.</p><p>Regarding the inhibitory connection between MBON-4 and MBON-2, we assume that the reviewer refers to the depressing dopaminergic effect of PAM-04 (i.e., PAM-β2β’2a, f<sub>av</sub>) to the KC-MBON synapses of MBON-02 (i.e., MBON-β2β’2a, m<sub>at</sub>) in the reciprocal LTM microcircuit. We based our assumption that this effect exists on Aso et al. (2014) and Li et al. (2020), who support that specific MBONs that extend their dendrites in compartments where specific DANs terminate their axons are affected by dopamine emitted by them. However, in most cases it is unclear whether the effect of this dopamine is potentiating or depressing, which we try to infer by using the data from McCurdy et al. (2021). Exceptions are the microcircuits described by Pavlowsky et al. (2018), Felsenberg et al. (2018), McCurdy et al. (2021) and Ichinose et al. (2015), who experimentally show the sign of dopamine effect onto the target synapses of the specific MBONs, which we take into account and use them as is in the model. The rest of the effects are postulated either by the symmetry of the circuit or from logic of what the desired function is.</p><disp-quote content-type="editor-comment"><p>8. The authors should also try to account for the discovery of parallel, independent memory traces (like appetitive LTM formation towards the CS- in classic LTM aversive training paradigms).</p></disp-quote><p>We agree with the reviewer that this is an important phenomenon and it should be addressed. There are multiple ways that parallel memories are built in our model. First, referring to memories of the same odour (transmitted by the same KC population), and second, to individual odours (transmitted by different KC populations). We think that it is now clear in our manuscript that independent memory traces are formed in the susceptible MBONs (as the activity of the one does not depend on the other – not connected in any way), while STM and LTM MBONs store dependent memories (as they are connected reciprocally and build dependencies). We mention this here:</p><p>“The restrained MBONs activate their respective ‘charging’ DANs, which start to potentiate the ‘LTM’ MBONs of same valence, while also depressing the response (to KC input) of the restrained MBON of opposite valence.” - lines 159-161.</p><p>“… the susceptible MBONs immediately block the simulated flies from approaching the punishing odours, while they allow them approach the rewarding ones, […]. This is partially because of the lack of reciprocal connections between the opposing susceptible MBONs, and it can be verified through the appetitive conditioning, […]. Susceptible MBONs convulsively break the balance between attraction and avoidance created by the restrained and LTM MBONs, …” - lines 372-378.</p><p>On the other hand, memories associated to different odour identities are formed in parallel through the different populations of KCs (i.e., their connections to MBONs). Although these memories are in principle independent, they can be dependent if the populations of two odours are overlapping.</p><p>“… our results show that (in time) the simulated flies seem to develop some prior knowledge about both odours when experienced at least one of them with reinforcement (see Figure 11B and Figure 11 —figure supplement 2A), which we suggest is because of their overlapping KCs associated with both odours.” - lines 363-366.</p><disp-quote content-type="editor-comment"><p>9. Does the dopaminergic learning rule explain the differences in dynamics and memory strength between appetitive and aversive memories? These two types of memory involved different molecular components and display different learning rules (stronger short-term aversive memories and longer-lasting appetitive memories requiring less training)? This should perhaps be clarified, particularly since KC output appears dispensable for aversive learning (acquisition) but potentially necessary for the acquisition of appetitive memories (Pribbenow et al., 2021).</p></disp-quote><p>That’s an excellent question! Indeed, the DPR produced similar findings in our simulations of behavioural experiments, in terms of dynamics and memory strength between appetitive and aversive memories. Our (simulated) behavioural experiments show that this difference in dynamics and memory strength between appetitive and aversive memories is a result of the behaviour itself and has nothing to do with the plasticity rule or the circuit. Specifically, although the DPR and IC are characterized by complete symmetry, the fact that flies attracted by an odour tend to spend more time experiencing this odour, while flies avoiding an odour tend to spend less time experiencing it, actually produces this difference in the learning outcome. So we predict that the mechanism that handles both cases is exactly the same, but a more naturalistic condition is needed in order to see this effect. This is now highlighted in our manuscript:</p><p>“We […] see a smaller π for flies experiencing sugar than the ones that experience electric shock, which is inline with experimental data (Krashes and Waddell, 2011a,b). When shock is paired with both odours we expect that the simulated flies will try to minimise the time spent exposed to any of them […]. In contrast, simulated flies seem to increase the time spend in both odours when paired with sugar with a slight preference towards the reinforced odour.” - lines 358-363.</p><disp-quote content-type="editor-comment"><p>10. I found the easy assumption that forgetting involves erasure to be troubling. Perhaps this happens sometimes. But many apparently &quot;forgotten&quot; memories are never erased, simply not reactivated for multiple reasons. Intellectually this point needs to be acknowledged.</p></disp-quote><p>We thank the reviewer for the opportunity to refine our wording. As the reviewer points out, there are multiple neural mechanisms that could lead to the behavioral manifestation of a “forgotten” memory, e.g., that the fly no longer avoids an odour previously paired with aversive stimuli. In some instances, the original aversive memory undergoes decay over time (e.g., susceptible MBONs during extinction and unpaired learning).</p><p>“… due to our plasticity rule, if the US subsequently occurs without the CS (see unpaired phase in the model, for which we do not have fly data), the MBON synaptic weights reset due to the recovery effect…” - lines 193-195.</p><p>In some cases (e.g., restrained and LTM MBONs), it remains intact but competes with a new parallel memory formed when the odour is presented without electric shock, as in extinction or reversal learning.</p><p>“The response of MBON-γ5β'2a (Figure 5E) can be observed to have the opposite pattern [to the MBONγ1pedc&gt;α/β], i.e., it starts to respond to odour B from the second trial of acquisition as it is no longer ‘restrained’. Note however that the response it expresses, when the restraint is removed, also depends on its own synaptic weights for KC input, which as we will see, may be affected by other elements in the incentive circuit.” - lines 197-201.</p><p>In our model, although memories in the susceptible and restrained MBONs are constantly updated, LTM MBONs integrate these memories and save them for a long time through saturation.</p><p>“Figure 7D (right) demonstrates the charging of the avoidance-driving LTM MBON during the acquisition (for odour B) and its continued increase during the forgetting phases.” - lines 265-266.</p><p>However, even when the memories in the LTM MBONs are weakened (e.g., due to the reciprocal LTM connections), we suggest that they are further assimilated by higher level LTMs in the vertical lobes of the MB, but this is not part of our circuit and needs further investigation.</p><p>“… we predict that the function of the cingulate cortex is represented by the α/β MBONs, encoding the ‘emotions’ of the animal towards reinforced stimuli, potentially controlling more sophisticated decision making.” - lines 691-694.</p><p>[Editors’ note: what follows is the authors’ response to the second round of review.]</p><disp-quote content-type="editor-comment"><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below:</p><p>1. Could the authors compare their simulated/predicted behavior with some quantitative or semi-quantitative measures of experimental behavior?</p></disp-quote><p>We recognise the need for quantitative comparison between our results and the literature. For this reason, in our behavioural Results section, we highlight more clearly the results reported in our Figure 3 —figure supplement 1, showing (using distillation to a common metric) a high correlation between the behaviour produced by our model and data from 92 classical conditioning experiments.</p><p>“Following this approach and using the summarised data collected by Bennett et al. (2021), we have tested the performance of our model in 92 olfactory classical conditioning intervention experiments from 14 studies (Felsenberg et al., 2017; Perisse et al., 2016; Aso and Rubin, 2016; Yamagata et al., 2016; Ichinose et al., 2015; Huetteroth et al., 2015; Owald et al., 2015; Aso et al., 2014b; Lin et al., 2014; Plaçais et al., 2013; Burke et al., 2012; Liu et al., 2012; Aso et al., 2010; Claridge-Chang et al., 2009), i.e., the observed effects on fly learning of silencing or activating specific neurons, including positive and negative reinforcements. The Δf predicted from the incentive circuit correlated with the one reported from the actual experiments with correlation coefficient r=0.76, p=2.2 x 10<sup>-18</sup> (Figure 3 —figure supplement 1).” – lines 333-342.</p><disp-quote content-type="editor-comment"><p>2. Can the authors elaborate on their mapping of ER-CA and cAMP in the model with the cited data? This relates to point 4 from Reviewer 1.</p></disp-quote><p>We also noticed that the individual traces of ER-Ca and cAMP (Figure 16B) do not match exactly the data from Handler et al. (2019). However, Figure 16A (and B – ΔW, i.e., black line) shows that their effect (combination of the two) is very similar to the one presented by the original paper (Pearson correlation: r=0.98, p=3.9 10<sup>-4</sup>). To allow direct comparison, we now plot the modelled ER-Ca and cAMP on the top of the data from Handler et al. (2019) in Figures 16A and B (grey lines). Note that we do not claim to model the exact ER-Ca and cAMP levels and we hope that this is now clear in the text.</p><p>“Figure 16 shows the ER-Ca<sup>2+</sup> and cAMP levels during forward and backward conditioning for a depressing DAN […], which are comparable to the data shown in Handler et al., (2019) (also Figure 16 – shown in grey). Note that here we are more interested in the overall effects of learning shown in Figure 16A rather than the detailed responses of Figure 16B.” – lines 869-873.</p><disp-quote content-type="editor-comment"><p>3. Can the authors do some parameter sensitivity analysis as suggested by the reviewers?</p></disp-quote><p>We added an extensive search/analysis on the timing parameters (i.e., τ<sub>short</sub> and τ<sub>long</sub>) of the plasticity rule where we compare the correlation between the data and the effect of our equation (i.e., Figure 16A). We have now added Figure 16 —figure supplement 2 showing the results of this analysis.</p><p>“In Figure 16, where we are interested in more detailed dynamics of the plasticity rule, and the sampling frequency is high, i.e., 100 Hz, we use τ<sub>short</sub> = 60 and τ<sub>long</sub> = 104, which we choose after a parameter exploration available in Figure 16 —figure supplement 2” – lines 893-895.</p><p>Regarding the circuit, the synaptic strengths are hand tuned in order to make the plots in Figures 5-8 (at least visually) match. A parameter analysis (in the same way that we did it for the plasticity rule, i.e., comparing the reproduced responses to the data using a standard measure, e.g., Pearson correlation coefficient) is less effective and harder to make for these parameters, as each connection affects the responses of many neurons in the circuit. Instead, we have created Figure 14 —figure supplements 1, 2 and 3, which show how the responses of the neurons in the circuit alter by changing one parameter at a time.</p><p>“Figure 14 —figure supplement 1, Figure 14 —figure supplement 2 and Figure 14 —figure supplement 3 show how each of these parameters affect the responses of the neurons in the incentive circuit.” – lines 769-771.</p><disp-quote content-type="editor-comment"><p>In addition, the reviewers had a few points for the authors to expand upon in the revision, and a number of useful suggestions to improve clarity.</p><p>Reviewer #1 (Recommendations for the authors):</p><p>This is an ambitious but also highly complicated modeling study that seeks to account for a wide range of fly learning behaviour in terms of underlying learning rules and circuitry.</p><p>The strengths of the study are its ambition, detail and substantial attention to experimental inputs. In principle it builds up a large and testable conceptual framework for understanding many aspects of learning. Its weaknesses, which are readily fixed, are 1. that the study misses opportunities to better compare model to experiments. and 2, that the study doesn't do a systematic parameter and model exploration to see how robust are the properties.</p><p>With these additions the study would be strong and of value to the field in laying out a template for further investigation. The authors posit that this framework could also apply to other organisms.</p><p>General points:</p><p>1. This is an ambitious but also highly complicated modeling study that seeks to account for a wide range of fly learning behaviour in terms of underlying learning rules and circuitry. The authors have made substantial improvements to the clarity of the presentation, particularly with regards to comparison of experimental and simulated data.</p><p>I would have liked to see similar comparison for two more features: the behaviour, and the crucial learning rule section, as I comment below. I note that a similar request was made in an earlier review.</p></disp-quote><p>The reviewer has expanded on this issue in points 3 and 4 and we respond there.</p><disp-quote content-type="editor-comment"><p>2. The other big thing I would have liked to see is an exploration of parameter sensitivity. This is needed both because of model complexity and because of the not-perfect match between model and input data. No model is perfect, but the confidence in a model is much improved if one can see that it still 'works' even when the numbers (and other assumptions) shift around a bit.</p></disp-quote><p>The reviewer has expanded on this issue in point 5 and we respond there.</p><disp-quote content-type="editor-comment"><p>3. Behaviour: The authors have made the interesting and potentially powerful step of linking their model to measurable behaviour. But they miss the opportunity to put the outcomes (experiment and model) side by side. Even a semi-quantitative distillation to some common metric for displaying and comparing the experimental and model properties would have been valuable.</p></disp-quote><p>We recognise the need for quantitative comparison between our results and the literature. For this reason, in our behavioural Results section, we highlight more clearly the results reported in our Figure 3 —figure supplement 1, which shows (using distillation to a common metric) a high correlation between the behaviour produced by our model and data from 92 classical conditioning experiments.</p><p>“Following this approach and using the summarised data collected by Bennett et al. (2021), we have tested the performance of our model in 92 olfactory classical conditioning intervention experiments from 14 studies (Felsenberg et al., 2017; Perisse et al., 2016; Aso and Rubin, 2016; Yamagata et al., 2016; Ichinose et al., 2015; Huetteroth et al., 2015; Owald et al., 2015; Aso et al., 2014b; Lin et al., 2014; Plaçais et al., 2013; Burke et al., 2012; Liu et al., 2012; Aso et al., 2010; Claridge-Chang et al., 2009), i.e., the observed effects on fly learning of silencing or activating specific neurons, including positive and negative reinforcements. The Δf predicted from the incentive circuit correlated with the one reported from the actual experiments with correlation coefficient r=0.76, p=2.2 x 10<sup>-18</sup> (Figure 3 —figure supplement 1).” – lines 333-342.</p><disp-quote content-type="editor-comment"><p>4. Figure 16: Details of ER-CA and cAMP in the model don't match data. The form of the pairing for ER Ca is inconsistent with the data of Handler et al., particularly when CS precedes US by a large interval. Handler et al. show no response for forward pairing even several seconds after the last stimulus. Also, the time-course of ER response for the backward pairing case is inconsistent. In the Handler data (Figure 6) the ER signal remains low (i.e, very different from baseline) well past 5 seconds, whereas in Figure 16 the signal returns to baseline within 5s. I am also concerned that there doesn't seem to be experimental support for the reduced cAMP signal at very small overlap intervals. Indeed, the Handler data suggests that there is a large signal at the 0.5s and -1.2s points. Figure 16 shows that the model assumes a low and brief signal at -1.2s. I would have appreciated having the experimental data from Handler and others illustrated here in the same figure, just to see how well the model forms behave. It would save the reader the step of going to look up another paper and tracking down appropriate figure panels.</p></disp-quote><p>We agree with the reviewer that the individual traces of ER-Ca and cAMP do not match exactly the data from Handler et al. (2019). On the other hand, Figure 16A (and B – ΔW, i.e., black line) shows that their effect (combination of the two) is very similar to the one presented by the original paper (r=0.98, p=3.9 10<sup>-4</sup>). The authors of Handler et al. (2019) have kindly provided the data from their figures, which allows us to report the Pearson correlation coefficient and also explore the timing parameters (requested in a different point). Thus, we now plot the modeled ER-Ca and cAMP on the top of the data from Handler et al. (2019) in Figures 16A and B (grey lines) as the reviewer suggested. Note that we do not claim to model the exact ER-Ca and cAMP levels and we hope that this is now clear in the text.</p><p>“Figure 16 shows the ER-Ca<sup>2+</sup> and cAMP levels during forward and backward conditioning for a depressing DAN […], which are comparable to the data shown in Handler et al., (2019) (also Figure 16 – shown in grey). Note that here we are more interested in the overall effects of learning shown in Figure 16A rather than the detailed responses of Figure 16B.” – lines 869-873.</p><disp-quote content-type="editor-comment"><p>5. As one example of a useful parameter sensitivity analysis: The form of the deltaWij seems rather crucial to the model, so I'm homing in on this. It is a difference of two values which are themselves clearly the difference of opposing signals. It would therefore be valuable to show that relaxation of these tight timing requirements does not upset the learning rule and subsequent behaviour. It would be useful to see similar sensitivity analyses for other key parts of the model.</p></disp-quote><p>We agree with the reviewer that it would be very interesting to explore all the parameters of the model. This way we could show how sensitive the predictions of the model are in the selection of its parameters. Given that we now have the Handler et al. (2019) data, we added an extensive search/analysis on the timing parameters (i.e., τ<sub>short</sub> and τ<sub>long</sub>) of the plasticity rule where we compare the correlation between the data and the effect of our equation (i.e., Figure 16A). We have now added Figure 16 —figure supplement 2 showing the results of this analysis.</p><p>“In Figure 16, where we are interested in more detailed dynamics of the plasticity rule, and the sampling frequency is high, i.e., 100 Hz, we use τ<sub>short</sub> = 60 and τ<sub>long</sub> = 104, which we choose after a parameter exploration available in Figure 16 —figure supplement 2” – lines 893-895.</p><p>Regarding the circuit, an extensive parameter search is much harder to make. The parameters of the circuit include the strength of a connection between MBONs and post-synaptic targets (e.g., other MBONs or DANs), the modulatory strength of the different types of DANs onto target KC&gt;MBON synapses and the biases (i.e., resting activity) of the neurons. In our approach, the synaptic strengths are hand tuned in order to make the plots in Figures 5-8 (at least visually) match. A parameter analysis (in the same way that we did it for the plasticity rule, i.e., comparing the reproduced responses to the data using a standard measure, e.g., Pearson correlation coefficient) is less effective and harder to make for these parameters, as each connection affects the responses of many neurons in the circuit. Instead, we have created Figure 14 —figure supplements 1, 2 and 3, which show how the responses of the neurons in the circuit alter by changing one parameter at a time.</p><p>“Figure 14 —figure supplement 1, Figure 14 —figure supplement 2 and Figure 14 —figure supplement 3 show how each of these parameters affect the responses of the neurons in the incentive circuit.” – lines 769-771.</p><disp-quote content-type="editor-comment"><p>Clarifications:</p><p>6. pg 28: 3 lines from bottom.</p><p>Do the authors mean &quot;activity of the ith presynaptic KC? 'Target' sounds like it is postsynaptic.</p></disp-quote><p>The reviewer is right and we have changed this as suggested.</p><p>“the activity of the (i<sup>th</sup>) pre-synaptic KC” – page 29, 3 lines from bottom.</p><disp-quote content-type="editor-comment"><p>7. Equation 30 onward.</p><p>w_rest: Is this a global parameter for all synapses?</p><p>w_rest: The way it is used in the equation looks more like a_rest, the resting activity of the synapse. Sorry to be pedantic, but the units of weight and rate don't match.</p><p>This gets further mixed in the equation between lines 853 and 854 where the authors add ki and Wij. Maybe ki is scaled somehow to weights?</p></disp-quote><p><italic>w</italic><sub><italic>rest</italic></sub> is a global parameter that corresponds to the default weight of a variable synapse and the weight to which it tends to return. It could in principle differ for different synapses but for simplicity we here assume that all the KC&gt;MBON synapses (the only variable synapses in our model) should have the same resting weight. We appreciate the issue that ‘synapse weight’ and ‘neuron activity (firing rate)’ are not intrinsically the same units but have indeed implicitly scaled the latter (<italic>k</italic><sup><italic>i</italic></sup>) to allow it to be compared to the current weight in the relevant weight-change equation. In general, it is common to all neural plasticity rules to assume there is some direct conversion from activity levels to weight changes.</p><disp-quote content-type="editor-comment"><p>8. Figure 5 and later: The responses, both experimental and model, are shown as an up-down oscillation. I assume that the up states are measurements during the training, and down is measurement half a day later. But this is hard to see from the text or legends, and I had to go down to the last section in the methods to see that this seems to be described as on-shock and off-shock values. It is confusing and should be mentioned in the figure legends and accompanying text.</p></disp-quote><p>We thank the reviewer for noticing this. The oscillations in the responses are due to the on- and off-shock values, not of different days but of consecutive time-windows (expose the animal to the odour only – i.e., off-shock – before introducing shock along with the odour – i.e., on-shock). We have now updated the captions of Figures 5-8 (and figure supplements) to clarify that.</p><p>“For each trial we report two consecutive time-steps: the off-shock (i.e., odour only) followed by the onshock (i.e., paired odour and shock) when available (i.e., odour B in acquisition and odour A in reversal phase) otherwise a second off-shock time-step (i.e., all the other phases).” – Figure 5-9 and the respective Figure supplements.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>First, I'd like to thank the authors for responding to my concerns/suggestions. At this point, it reads, in my assessment, much better as a result of the many changes. In particular, the newer figures are of high quality and their stated goals much easier to grasp. Also, shifting most of the discussion of the &quot;formal&quot; model in the (old) Results section to the (new) Methods section makes reading flow more intuitively.</p><p>Second, the disagreement we had, appears now to be more in terms of naming/labeling.of Equation (18) and (30), thus clarifying the rational for the naming of the 2 learning rules (DPR) and (RPE). However, the &quot;RPE&quot; naming for (30) is, in my view, a bit of a stretch, but I am not raising an objection. Just a friendly note to the authors.</p><p>I'd like to make a final suggestion that future readers might benefit from. Reviewer 1 raised this issue already and the authors addressed the question. However, in my view, the presentation starting with &quot;we postulate a mathematical formulation …&quot; just above Equation (32), seems a bit circular. While the authors answered the question, in terms of intuitive modeling (Equation (34)), the presentation thread I am referring to is rather formal. The D's in Equations (32), (33) are not explicitly defined; the equations, when added up are consistent with the Equation above line 854.</p></disp-quote><p>We do define D’s as the depression and potentiation components of the DA, assumed to correspond to DopR1 and DopR2 receptors or potentially to involve co-transmitters released by the DAN such as Nitric Oxide.</p><p>“where D<sup>j</sup><sub>▽</sub> (t) and D<sup>j</sup><sub>△</sub>(t) are the depression and potentiation components of the DA respectively [assumed to correspond to DopR1 and DopR2 receptors (Handler et al., 2019), or potentially to involve cotransmitters released by the DAN such as Nitric Oxide (Aso et al., 2019)].” – lines 863-865.</p><disp-quote content-type="editor-comment"><p>While Equation (34) provides the intuition of the decomposition of the weights into 2 terms, this decomposition is by no means unique. Having said that, we are then confronted with Equations (35) and (36). There is little justification given for the rational of choosing/postulating these two diff. Equations. I presume that the solution for these Equations are the D's. A careful reading seems to suggest that these are delayed differential equations. In math terms, a single delayed diff. Equation is infinite dimensional, and essentially intractable. The following Equations (37)-(39), while consistent with the discussion above, do not help clarify the matter. Which brings one back to Equations (32), (33).</p></disp-quote><p>We are grateful that the reviewer had such a close look to our equations which lead us to have a closer look as well. We came up with Equations (35) and (36) as a simple model of the shape of rise and decay responses to DA release. However, thanks to the reviewer’s comments, we realised that there is a mistake in the differential equations and the τ<sub>short</sub> and τ<sub>long</sub> parameters in our equation. The correct values are τ<sub>short</sub> = 1 and τ<sub>long</sub> = +∞<sub>.</sub> Equations 35 and 36 have been amended accordingly.</p><p>Note that now we remove the time as a parameter in these equations so that it becomes less confusing and closer to standard notation. The above differential equations and parameters can be used to generate the plasticity rule as in Equations (37)-(39):<disp-formula id="sa2equ1"><mml:math id="sa2m2"><mml:mrow><mml:mfrac><mml:msub><mml:mtext>dD</mml:mtext><mml:mrow><mml:mi mathvariant="normal">∇</mml:mi></mml:mrow></mml:msub><mml:mtext>dt</mml:mtext></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="normal">∇</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>∙</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mspace linebreak="newline"/><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="normal">∇</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∙</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="sa2equ2"><mml:math id="sa2m3"><mml:mrow><mml:mfrac><mml:msub><mml:mtext>dD</mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mtext>dt</mml:mtext></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>∙</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mspace linebreak="newline"/><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∙</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>Which results in<disp-formula id="sa2equ3"><mml:math id="sa2m4"><mml:mrow><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="normal">∇</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∙</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∙</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∙</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>We have now corrected the differential equations and selected parameters in our methods as well – Equations (35) and (36).</p><disp-quote content-type="editor-comment"><p>Finally, the Methods section has a sizable number of matrices that have seemingly arbitrary entries.</p></disp-quote><p>The entries are not arbitrary as the non-zero entries and the sign of the entries are determined by connectivity considerations but it is true that the magnitudes of the non-zero values are somewhat arbitrary, having been chosen through hand tuning in order to (at least visually) match the recorded responses. After another reviewer #1 suggestion (point 5), we now provide Figure 14 —figure supplement 1, 2 and 3, which show how the reconstructed responses are affected by modifying these parameters.</p></body></sub-article></article>