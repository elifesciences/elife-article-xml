<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">80063</article-id><article-id pub-id-type="doi">10.7554/eLife.80063</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Genetics and Genomics</subject></subj-group></article-categories><title-group><article-title>Sparse dimensionality reduction approaches in Mendelian randomisation with highly correlated exposures</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-278994"><name><surname>Karageorgiou</surname><given-names>Vasileios</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7173-9967</contrib-id><email>vk282@exeter.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-207082"><name><surname>Gill</surname><given-names>Dipender</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-185465"><name><surname>Bowden</surname><given-names>Jack</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf3"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-243031"><name><surname>Zuber</surname><given-names>Verena</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/041kmwe10</institution-id><institution>Department of Epidemiology and Biostatistics, School of Public Health, Faculty of Medicine, Imperial College London</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03yghzc09</institution-id><institution>University of Exeter</institution></institution-wrap><addr-line><named-content content-type="city">Exeter</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04cw6st05</institution-id><institution>Department of Clinical Pharmacology and Therapeutics, Institute for Infection and Immunity, St George’s, University of London</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff4"><label>4</label><institution>Genetics Department, Novo Nordisk Research Centre Oxford</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Zhao</surname><given-names>Siming</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/049s0rh22</institution-id><institution>Dartmouth College</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Pollak</surname><given-names>Martin R</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vek6s52</institution-id><institution>Harvard Medical School</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>19</day><month>04</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e80063</elocation-id><history><date date-type="received" iso-8601-date="2022-05-06"><day>06</day><month>05</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-04-18"><day>18</day><month>04</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-06-16"><day>16</day><month>06</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.06.15.22276455"/></event></pub-history><permissions><copyright-statement>© 2023, Karageorgiou et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Karageorgiou et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-80063-v2.pdf"/><abstract><p>Multivariable Mendelian randomisation (MVMR) is an instrumental variable technique that generalises the MR framework for multiple exposures. Framed as a regression problem, it is subject to the pitfall of multicollinearity. The bias and efficiency of MVMR estimates thus depends heavily on the correlation of exposures. Dimensionality reduction techniques such as principal component analysis (PCA) provide transformations of all the included variables that are effectively uncorrelated. We propose the use of sparse PCA (sPCA) algorithms that create principal components of subsets of the exposures with the aim of providing more interpretable and reliable MR estimates. The approach consists of three steps. We first apply a sparse dimension reduction method and transform the variant-exposure summary statistics to principal components. We then choose a subset of the principal components based on data-driven cutoffs, and estimate their strength as instruments with an adjusted <italic>F</italic>-statistic. Finally, we perform MR with these transformed exposures. This pipeline is demonstrated in a simulation study of highly correlated exposures and an applied example using summary data from a genome-wide association study of 97 highly correlated lipid metabolites. As a positive control, we tested the causal associations of the transformed exposures on coronary heart disease (CHD). Compared to the conventional inverse-variance weighted MVMR method and a weak instrument robust MVMR method (MR GRAPPLE), sparse component analysis achieved a superior balance of sparsity and biologically insightful grouping of the lipid traits.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>Mendelian randomisation</kwd><kwd>principal component analysis</kwd><kwd>causal inference</kwd><kwd>coronary heart disease</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Multivariable Mendelian Randomization</kwd><kwd>Dimensionality Reduction</kwd><kwd>Sparsity</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003447</institution-id><institution>State Scholarships Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Karageorgiou</surname><given-names>Vasileios</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution>Expanding Excellence in England</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Karageorgiou</surname><given-names>Vasileios</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Applied and computational results show how dimensionality reduction approaches can help in grouping correlated genetic variant-exposure associations and improve causal inference in the Mendelian randomisation framework.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Mendelian randomisation (MR) is an epidemiological study design that uses genetic variants as instrumental variables (IVs) to investigate the causal effect of a genetically predicted exposure on an outcome of interest (<xref ref-type="bibr" rid="bib31">Smith and Ebrahim, 2003</xref>). In a randomised controlled trial (RCT) the act of randomly allocating patients to different treatment groups precludes the existence of systematic confounding between the treatment and outcome and therefore provides a strong basis for causal inference. Likewise, the alleles that determine a small proportion of variation of the exposure in MR are inherited randomly. We can therefore view the various genetically proxied levels of a lifelong modifiable exposure as a ‘natural’ RCT, avoiding the confounding that hinder traditional observational associations. Genetically predicted levels of an exposure are also less likely to be affected by reverse causation, as genetic variants are allocated before the onset of the outcomes of interest.</p><p>When evidence suggests that multiple correlated phenotypes may contribute to a health outcome, multivariable MR (MVMR), an extension of the basic univariable approach can disentangle more complex causal mechanisms and shed light on mediating pathways. Following the analogy with RCTs, the MVMR design is equivalent to a factorial trial, in which patients are simultaneously randomised to different combinations of treatments (<xref ref-type="bibr" rid="bib3">Burgess and Thompson, 2015</xref>). An example of this would be investigation into the effect of various lipid traits on coronary heart disease (CHD) risk (<xref ref-type="bibr" rid="bib5">Burgess and Harshfield, 2016</xref>). While MVMR can model correlated exposures, it performs suboptimally when there are many highly correlated exposures due to multicollinearity in their genetically proxied values. This can be equivalently understood as a problem of conditionally weak instruments (<xref ref-type="bibr" rid="bib29">Sanderson et al., 2019</xref>) that is only avoided if the genetic instruments are strongly associated with each exposure conditionally on all the other included exposures. An assessment of the extent to which this assumption is satisfied can be made using the conditional <italic>F</italic>-statistic, with a value of 10 for all exposures being considered sufficiently strong (<xref ref-type="bibr" rid="bib29">Sanderson et al., 2019</xref>). In settings when multiple highly correlated exposures are analysed, a set of genetic instruments are much more likely to be conditionally weak instruments. In this event, causal estimates can be subject to extreme bias and are therefore unreliable. Estimation bias can be addressed to a degree by fitting weak instrument robust MVMR methods (<xref ref-type="bibr" rid="bib30">Sanderson et al., 2020</xref>; <xref ref-type="bibr" rid="bib36">Wang et al., 2021</xref>), but at the cost of a further reduction in precision. Furthermore, MVMR models investigate causal effects for each individual exposure, under the assumption that it is possible to intervene and change each one whilst holding the others fixed. In the high-dimensional, highly correlated exposure setting, this is potentially an unachievable intervention in practice.</p><p>Our aim in this paper is instead to use dimensionality reduction approaches to concisely summarise a set of highly correlated genetically predicted exposures into a smaller set of independent principal components (PCs). We then perform MR directly on the PCs, thereby estimating their effect on health outcomes of interest. We additionally suggest employing sparsity methods to reduce the number of exposures that contribute to each PC, in order to improve their interpretability in the resulting factors.</p><p>Using summary genetic data for multiple highly correlated lipid fractions and CHD (<xref ref-type="bibr" rid="bib23">Kettunen et al., 2016</xref>; <xref ref-type="bibr" rid="bib26">Nelson et al., 2017</xref>), we first illustrate the pitfalls encountered by the standard MVMR approach. We then apply a range of sparse principal component analysis (sPCA) methods within an MVMR framework to the data. Finally, we examine the comparative performance of the sPCA approaches in a detailed simulation study, in a bid to understand which ones perform best in this setting.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Workflow overview</title><p>Our proposed analysis strategy is presented in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Using summary statistics for the single-nucleotide polymorphism (SNP)-exposure (<inline-formula><mml:math id="inf1"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>) and SNP-outcome (<inline-formula><mml:math id="inf2"><mml:mover accent="true"><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>) association estimates, where <inline-formula><mml:math id="inf3"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> (dimensionality 148 SNPs× 97 exposures) exhibits strong correlation, we initially perform a PCA on <inline-formula><mml:math id="inf4"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. Additionally, we perform multiple sPCA modalities that aim to provide sparse loadings that are more interpretable (block 3, <xref ref-type="fig" rid="fig1">Figure 1</xref>). The choice of the number of PCs is guided by permutation testing or an eigenvalue threshold. Finally, the PCs are used in place of <inline-formula><mml:math id="inf5"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> in an IVW MVMR meta-analysis to obtain an estimate of the causal effect of the PC on the outcome. Similar to PC regression and in line with unsupervised methods, the outcome (SNP-outcome associations (<inline-formula><mml:math id="inf6"><mml:mover accent="true"><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>) and corresponding standard error (<inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mover accent="true"><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:msub></mml:mrow></mml:math></inline-formula>)) is not transformed by PCA and is used in the second-step MVMR in the original scale. In the real data application and in the simulation study, the best balance of sparsity and statistical power was observed for the method of sparse component analysis (SCA) (<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>). This favoured method and the related steps are coded in an <italic>R</italic> function and are available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/vaskarageorg/SCA_MR/">https://github.com/vaskarageorg/SCA_MR/</ext-link>, copy archived at <xref ref-type="bibr" rid="bib21">Karageorgiou, 2023</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Proposed workflow.</title><p>Step 1: MVMR on a set of highly correlated exposures. Each genetic variant contributes to each exposure. The high correlation is visualised in the similarity of the single-nucleotide polymorphism (SNP)-exposure associations in the correlation heatmap (top right). Steps 2 and 3: PCA and sparse PCA on <inline-formula><mml:math id="inf8"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. Step 4. MVMR analysis on a low dimensional set of principal components (PCs). X: exposures; Y: outcome; k: number of exposures; PCA: principal component analysis; MVMR: multivariable Mendelian randomisation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-fig1-v2.tif"/></fig></sec><sec id="s2-2"><title>UVMR and MVMR</title><p>A total of 66 traits were associated with CHD at or below the Bonferroni-corrected level (<inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>97</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="table" rid="table1">Table 1</xref>). Two genetically predicted lipid exposures (M.HDL.C, M.HDL.CE) were negatively associated with CHD and 64 were positively associated (Table 3). In an MVMR model including only the 66 Bonferroni-significant traits, fitted with the purpose of illustrating the instability of IVW-MVMR in conditions of severe collinearity, conditional <italic>F</italic>-statistic (CFS) (Materials and methods) was lower than 2.2 for all exposures (with a mean of 0.81), highlighting the severe weak instrument problem. In <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>, the MVMR estimates are plotted against the corresponding univariable MR (UVMR) estimates. We interpret the reduction in identified effects as a result of the drop in precision in the MVMR model (variance inflation). Only the independent causal estimate for ApoB reached our pre-defined significance threshold and was less precise (OR<sub><italic>MVMR</italic></sub> (95% CI): <inline-formula><mml:math id="inf10"><mml:mrow><mml:mn>1.031</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1.012</mml:mn><mml:mo>,</mml:mo><mml:mn>1.37</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi>U</mml:mi><mml:mi>V</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (95% CI): <inline-formula><mml:math id="inf12"><mml:mrow><mml:mn>1.013</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1.01</mml:mn><mml:mo>,</mml:mo><mml:mn>1.016</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>). We note that, for M.LDL.PL, the UVMR estimate (<inline-formula><mml:math id="inf13"><mml:mrow><mml:mn>1.52</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1.35</mml:mn><mml:mo>,</mml:mo><mml:mn>1.71</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, p &lt; 10<sup>-10</sup>)) had an opposite sign to the MVMR estimate (<inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.905</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>0.818</mml:mn><mml:mo>,</mml:mo><mml:mn>1.001</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p><p>To see if the application of a weak instrument robust MVMR method could improve the analysis, we applied MR GRAPPLE (<xref ref-type="bibr" rid="bib36">Wang et al., 2021</xref>). As the GRAPPLE pipeline suggests, the same three-sample MR design described above is employed. In the external selection GWAS study (GLGC), a total of 148 SNPs surpass the genome-wide significance level for the 97 exposures and were used as instruments. Although the method did not identify any of the exposures as significant at nominal or Bonferroni-adjusted significance level, the strongest association among all exposures is ApoB.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Univariable Mendelian randomisation (MR) results for the Kettunen dataset with coronary heart disease (CHD) as the outcome.</title><p>Positive: positive causal effect on CHD risk; Negative: negative causal effect on CHD risk.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom">Positive</th><th align="left" valign="bottom">Negative</th></tr></thead><tbody><tr><td align="left" valign="bottom">VLDL</td><td align="left" valign="bottom">AM.VLDL.C, M.VLDL.CE, M.VLDL.FC, M.VLDL.L,M.VLDL.P, M.VLDL.PL, M.VLDL.TG, XL.VLDL.L,XL.VLDL.PL, XL.VLDL.TG, XS.VLDL.L, XS.VLDL.P, XS.VLDL.PL,XS.VLDL.TG, XXL.VLDL.L, XXL.VLDL.PL,L.VLDL.C, L.VLDL.CE, L.VLDL.FC, L.VLDL.L, L.VLDL.P,L.VLDL.PL, L.VLDL.TG, SVLDL.C, S.VLDL.FC,S.VLDL.L, S.VLDL.P, S.VLDL.PL, S.VLDL.TG</td><td align="left" valign="bottom">None</td></tr><tr><td align="left" valign="bottom">LDL</td><td align="left" valign="bottom">ALDL.C, L.LDL.C, L.LDL.CE, L.LDL.FC, L.LDL.L, L.LDL.P, L.LDL.PL,M.LDL.C, M.LDL.CE, M.LDL.L, M.LDL.P,M.LDL.PL, S.LDL.C, S.LDL.L, S.LDL.P</td><td align="left" valign="bottom">None</td></tr><tr><td align="left" valign="bottom">HDL</td><td align="left" valign="bottom">S.HDL.TG, XL.HDL.TG</td><td align="left" valign="bottom">M.HDL.C, M.HDL.CE</td></tr></tbody></table></table-wrap></sec><sec id="s2-3"><title>PCA</title><p>Standard PCA with no sparsity constraints was used as a benchmark. PCA estimates a square loadings matrix of coefficients with dimension equal to the number of genetically proxied exposures <inline-formula><mml:math id="inf15"><mml:mi>K</mml:mi></mml:math></inline-formula>. The coefficients in the first column define the linear combination of exposures with the largest variability (PC1). Column 2 defines PC2, the linear combination of exposures with the largest variability that is also independent of PC1, and so on. This way, the resulting factors seek to reduce redundant information and project highly correlated SNP-exposure associations to the same PC. In PC1, very low-density lipoprotein (VLDL)- and low-density lipoprotein (LDL)-related traits were the major contributors (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). ApoB received the 8th largest loading (0.1371, maximum was 0.1403 for cholesterol content in small VLDL) and LDL.C received the 48th largest (0.1147). In PC2, high-density lipoprotein (HDL)-related traits were predominant. The first 18 largest positive loadings are HDL-related and 12 describe either large or extra-large HDL traits. PC3 received its scores mainly from VLDL traits. Six components were deemed significant through the permutation-based approach (<xref ref-type="fig" rid="fig1">Figure 1</xref>, Materials and methods).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Heatmaps for the loadings matrices in the Kettunen dataset for all methods (one with no sparsity constraints [<bold>a</bold>], four with sparsity constraints under different assumptions [<bold>b–e</bold>]).</title><p>The number of the exposures plotted on the vertical axis is smaller than <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>97</mml:mn></mml:mrow></mml:math></inline-formula> as the exposures that do not contribute to any of the sparse principal components (PCs) have been left out. Blue: positive loading; red: negative loading; yellow: zero.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-fig2-v2.tif"/></fig><p>In the second-step IVW regression (step 4 in <xref ref-type="fig" rid="fig1">Figure 1</xref>), MVMR results are presented. A modest yet precise (OR = <inline-formula><mml:math id="inf17"><mml:mrow><mml:mn>1.002</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1.0015</mml:mn><mml:mo>,</mml:mo><mml:mn>1.0024</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) association of PC1 with CHD was observed. Conversely, PC3 was marginally significant for CHD at the 5% level (OR = 0.998 (0.998, 0.999), p=0.049). Since <inline-formula><mml:math id="inf19"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> has been transformed with linear coefficients (visualised in loadings matrix, <xref ref-type="fig" rid="fig2">Figure 2</xref>), the underlying causal effects are also transformed and interpreting the magnitude of an effect estimate is not straightforward, since it reflects the effect of changing the PC by one unit on the outcome; however, significance and orientation of effects can be interpreted. When positive loadings are applied to exposures that are positively associated with the outcome, the MR estimate is positive; conversely, if negative loadings are applied, the MR estimate is negative.</p><sec id="s2-3-1"><title>sPCA methods</title><p>We next employed multiple sPCA methods (<xref ref-type="table" rid="table2">Table 2</xref>) that each shrink a proportion of loadings to zero. The way this is achieved differs in each method. Their underlying assumptions and details on differences in optimisation are presented in <xref ref-type="table" rid="table2">Table 2</xref> and further described in Materials and methods.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Overview of sparse principal component analysis (sPCA) methods used.</title><p>KSS: Karlis-Saporta-Spinaki criterion. Package: <italic>R</italic> package implementation; Features: short description of the method; Choice: method of selection of the number of informative components in real data; PCs: number of informative PCs.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Method</th><th align="left" valign="bottom">Package</th><th align="left" valign="bottom">Authors</th><th align="left" valign="bottom">Features</th><th align="left" valign="bottom">Choice</th><th align="left" valign="bottom">PCs</th></tr></thead><tbody><tr><td align="left" valign="bottom">RSPCA</td><td align="left" valign="bottom"><italic>pcaPP</italic></td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib10">Croux et al., 2013</xref></td><td align="left" valign="bottom">Robust sPCA (RSPCA), different measure of dispersion (<inline-formula><mml:math id="inf20"><mml:msub><mml:mi mathsize="90%">Q</mml:mi><mml:mi mathsize="90%">n</mml:mi></mml:msub></mml:math></inline-formula>)</td><td align="left" valign="bottom">Permutation KSS</td><td align="char" char="." valign="bottom">6</td></tr><tr><td align="left" valign="bottom">SFPCA</td><td align="left" valign="bottom">Code in publication, Supplementary Material</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib18">Guo et al., 2010</xref></td><td align="left" valign="bottom">Fused penalties for block correlation</td><td align="left" valign="bottom">KSS</td><td align="char" char="." valign="bottom">6</td></tr><tr><td align="left" valign="bottom">sPCA</td><td align="left" valign="bottom"><italic>elasticnet</italic></td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref></td><td align="left" valign="bottom">Formulation of sPCA as a regression problem</td><td align="left" valign="bottom">KSS</td><td align="char" char="." valign="bottom">6</td></tr><tr><td align="left" valign="bottom">SCA</td><td align="left" valign="bottom"><italic>SCA</italic></td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref></td><td align="left" valign="bottom">Rotation of eigen vectors for approximate sparsity</td><td align="left" valign="bottom">Permutation KSS</td><td align="char" char="." valign="bottom">6</td></tr></tbody></table></table-wrap></sec><sec id="s2-3-2"><title>RSPCA (<xref ref-type="bibr" rid="bib10">Croux et al., 2013</xref>)</title><p>Optimisation and the KSS criterion pick six PCs to be informative (<xref ref-type="bibr" rid="bib22">Karlis et al., 2003</xref>). The loadings in <xref ref-type="fig" rid="fig2">Figure 2</xref> show a VLDL-, LDL-dominant PC1, with some small and medium HDL-related traits. LDL.C and ApoB received the 5th and 40th largest positive loadings. PCs 1 and 6 are positively associated with CHD and PCs 3 and 5 negatively so (<xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>).</p></sec><sec id="s2-3-3"><title>SFPCA (<xref ref-type="bibr" rid="bib18">Guo et al., 2010</xref>)</title><p>The KSS criterion retains six PCs. The loadings matrix (<xref ref-type="fig" rid="fig2">Figure 2</xref>) shows the ‘fused’ loadings with the identical colouring. In the two first PCs, all groups are represented. Both ApoB and LDL.C received the seventh and tenth largest loadings, together with other metabolites (<xref ref-type="fig" rid="fig2">Figure 2</xref>). PC1 (all groups represented) was positively associated with CHD and PC4 (negative loadings from large HDL traits) negatively so (<xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>).</p></sec><sec id="s2-3-4"><title>sPCA (<xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>)</title><p>The number of non-zero metabolites per PC was set at <inline-formula><mml:math id="inf21"><mml:mrow><mml:mfrac><mml:mn>148</mml:mn><mml:mn>97</mml:mn></mml:mfrac><mml:mo>∼</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>). Under this level of sparsity, the permutation-based approach suggested that six sPCs should be retained. Seventy exposures received a zero loading across all components. PC1 is constructed predominantly from LDL traits and is positively associated with CHD, but this does not retain statistical significance at the nominal level in MVMR analysis (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Only PC4 that is comprised of small and medium HDL traits (<xref ref-type="fig" rid="fig2">Figure 2b</xref>) appears to exert a negative causal effect on CHD (OR (95% CI): <inline-formula><mml:math id="inf22"><mml:mrow><mml:mn>0.9975</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.9955</mml:mn><mml:mo>,</mml:mo><mml:mn>0.9995</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>). The other PCs were not associated with CHD (all <inline-formula><mml:math id="inf23"><mml:mi>p</mml:mi></mml:math></inline-formula> values &gt; 0.05, <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Comparison of univariable Mendelian randomisation (UVMR) and multivariable MR (MVMR) estimates and presentation of the major group represented in each principal component (PC) per method.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-fig3-v2.tif"/></fig></sec><sec id="s2-3-5"><title>SCA (<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>)</title><p>Six components were retained after a permutation test. In the final model, five metabolites were regularised to zero in all PCs (CH2.DB.ratio, CH2.in.FA, FAw6, S.VLDL.C, S.VLDL.FC, <xref ref-type="fig" rid="fig2">Figure 2</xref>). Little overlap is noted among the metabolites. PC1 receives loadings from LDL and IDL, and PC2 from VLDL. The contribution of HDL to PCs is split in two, with large and extra-large HDL traits contributing to PC3 and small and medium ones to PC4. PC1 and PC2 were positively associated with CHD (<xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>, <xref ref-type="fig" rid="fig3">Figure 3</xref>). PC4 was negatively associated with CHD.</p></sec><sec id="s2-3-6"><title>Comparison with UVMR</title><p>In principle, all PC methods derive independent components. This is strictly the case in standard PCA, where subsequent PCs are perfectly orthogonal, but is only approximately true in sparse implementations. We hypothesised that UVMR and MVMR could provide similar causal estimates of the associations of metabolite PCs with CHD. The results are presented in <xref ref-type="fig" rid="fig3">Figure 3</xref> and concordance between UVMR and MVMR is quantified with the <inline-formula><mml:math id="inf24"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> from a linear regression. The largest agreement of the causal estimates is observed in PCA. In the sparse methods, SCA (<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>) and sPCA (<xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>) provide similarly consistent estimates, whereas some disagreement is observed in the estimate of PC6 for RSPCA (<xref ref-type="bibr" rid="bib10">Croux et al., 2013</xref>) on CHD.</p><p>A previous study implicated LDL.c and ApoB as causal for CHD (<xref ref-type="bibr" rid="bib43">Zuber et al., 2020b</xref>). In <xref ref-type="fig" rid="app1fig7">Appendix 1—figure 7</xref>, we present the loadings for these two exposures across the PCs for the various methods. Ideally, we would like to see metabolites contributing to a small number of components for the sparse methods. Using a visualisation technique proposed by <xref ref-type="bibr" rid="bib24">Kim and Kim, 2012</xref>, this is indeed observed (see <xref ref-type="fig" rid="app1fig7">Appendix 1—figure 7</xref>). In PCA, LDL.c and ApoB contribute to multiple PCs, whereas the sPCA methods limit this to one PC. Only in RSPCA do these exposures contribute to two PCs. In the second-step IVW meta-analysis, it appears that the PCs comprising of predominantly VLDL/LDL and HDL traits robustly associate with CHD, with differences among methods (<xref ref-type="table" rid="table3">Table 3</xref>).</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Results for principal component analysis (PCA) approaches.</title><p>Overlap: Percentage of metabolites receiving non-zero loadings in ≥1 component. Overlap in PC1, PC2: overlap as above but exclusively for the first two components which by definition explain the largest proportion of variance. Very low-density lipoprotein (VLDL), low-density lipoprotein (LDL), and high-density lipoprotein (HDL) significance: results of the IVW regression model with CHD as the outcome for the respective sPCs (the sPCs that mostly received loadings from these groups). The terms VLDL and LDL refer to the respective transformed blocks of correlated exposures; for instance, VLDL refers to the weighted sum of the correlated VLDL-related <inline-formula><mml:math id="inf25"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> associations, such as VLDL phospholipid content and VLDL triglyceride content. †: RSPCA projected VLDL- and LDL-related traits to the same PC (sPC1). ‡: SCA discriminated HDL molecules in two sPCs, one for traits of small- and medium-sized molecules and one for large- and extra-large-sized.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom">PCA</th><th align="left" valign="bottom">RSPCA</th><th align="left" valign="bottom">SFPCA</th><th align="left" valign="bottom">sPCA</th><th align="left" valign="bottom">SCA</th></tr></thead><tbody><tr><td align="left" valign="bottom">Overlap</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0.938</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0.187</td><td align="char" char="." valign="bottom">0.196</td></tr><tr><td align="left" valign="bottom">Overlap in PC1,PC2</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0.433</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0.010</td><td align="char" char="." valign="bottom">0</td></tr><tr><td align="left" valign="bottom">Sparse %</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0.474</td><td align="char" char="." valign="bottom">0.082</td><td align="char" char="." valign="bottom">0.835</td><td align="char" char="." valign="bottom">0.796</td></tr><tr><td align="left" valign="bottom">VLDL significance in MR†</td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">No</td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">No</td><td align="left" valign="bottom">Yes</td></tr><tr><td align="left" valign="bottom">LDL significance in MR</td><td align="left" valign="bottom">No</td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">No</td><td align="left" valign="bottom">No</td><td align="left" valign="bottom">Yes</td></tr><tr><td align="left" valign="bottom">HDL significance in MR‡</td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">No</td><td align="left" valign="bottom">No</td></tr><tr><td align="left" valign="bottom">Small, medium HDL significance in MR</td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">No</td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">Yes</td></tr></tbody></table></table-wrap></sec><sec id="s2-3-7"><title>Instrument strength</title><p>Instrument strength for the chosen PCs was assessed via an <inline-formula><mml:math id="inf26"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistic, calculated using a bespoke formula that accounts for the PC process (see Materials and methods and Appendix). The <inline-formula><mml:math id="inf27"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistics for all transformed exposures cross the cutoff of 10. There was a trend for the first components being more strongly instrumented in all methods (see <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>), which is to be expected. In the MVMR analyses, the CFS for all exposures was less than three. Thus the move to PC-based analysis significantly improved instrument strength and mitigated against weak instrument bias.</p></sec><sec id="s2-3-8"><title>Simulation studies</title><p>We consider the case of a data generating mechanism that reflects common scenarios found in real-world applications. Specifically, we consider a set of exposures <inline-formula><mml:math id="inf28"><mml:mi>X</mml:mi></mml:math></inline-formula>, which can be partitioned into blocks based on shared genetics. Certain groups of variants contribute exclusively to specific blocks of exposures, while having no effect on other blocks. This in turn leads to substantial correlation among the exposure blocks and a much reduced correlation of between exposure blocks, due only to shared confounding. This is visualised in <xref ref-type="fig" rid="fig4">Figure 4a</xref>. This data structure acts to reduce the instruments’ strength in jointly predicting all exposures. The dataset consists of <inline-formula><mml:math id="inf29"><mml:mi>n</mml:mi></mml:math></inline-formula> participants, <inline-formula><mml:math id="inf30"><mml:mi>k</mml:mi></mml:math></inline-formula> exposures, <inline-formula><mml:math id="inf31"><mml:mi>p</mml:mi></mml:math></inline-formula> SNPs (with both <inline-formula><mml:math id="inf32"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf33"><mml:mi>p</mml:mi></mml:math></inline-formula> consisting of <inline-formula><mml:math id="inf34"><mml:mi>b</mml:mi></mml:math></inline-formula> discrete, equally sized blocks) and a continuous outcome, <inline-formula><mml:math id="inf35"><mml:mi>Y</mml:mi></mml:math></inline-formula>. We split the simulation results into one illustrative example (for didactic purposes) and one high-dimensional example.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Simulation Study Outline.</title><p>(<bold>a</bold>) Data generating mechanism for the simulation study, illustrative scenario with six exposures and two blocks. In red boxes, the exposures that are correlated due to a shared genetic component are highlighted. (<bold>b</bold>) Simulation results for six exposures and three methods (sparse component analysis [SCA] [<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>], principal component analysis [PCA], multivariable Mendelian randomisation [MVMR]). The exposures that contribute to <inline-formula><mml:math id="inf36"><mml:mi>Y</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf37"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) are presented in shades of green colour and those that do not in shades of red (<inline-formula><mml:math id="inf38"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>). In the third panel, each exposure is a line. In the first and second panels, the PCs that correspond to these exposures are presented <italic>as single lines</italic> in green and red. Monte Carlo SEs are visualised as error bars. Rejection rate: proportion of simulations where the null is rejected.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-fig4-v2.tif"/></fig></sec><sec id="s2-3-9"><title>Simple illustrative example</title><p>We generate data under the mechanism presented in <xref ref-type="fig" rid="fig4">Figure 4a</xref>. That is, with six individual exposures <inline-formula><mml:math id="inf39"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> split into two distinct blocks (<inline-formula><mml:math id="inf40"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf41"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>). A continuous outcome <inline-formula><mml:math id="inf42"><mml:mi>Y</mml:mi></mml:math></inline-formula> is generated that is only causally affected by the exposures in block 1 (<inline-formula><mml:math id="inf43"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>). A range of sample sizes were used in the simulation in order to give a range of CFS values from approximately 2–80. We apply (a) MVMR with the six individual exposures separately, and (b) PCA and SCA. The aim of approach (b) is to demonstrate the impact of reducing the six-dimensional exposure into two PCs, so that the first PC has high loadings for block 1 (<inline-formula><mml:math id="inf44"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) and the second PC has high loadings for block 2 (<inline-formula><mml:math id="inf45"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>). Although two PCs were chosen by both PCA methods using a KSS criterion in a large majority of cases, to simplify the simulation interpretation we fixed a priori the number of PCs at two across all simulations.</p><p>Our primary focus was to assess the rejection rates of MVMR versus PCA rather than estimation, as the two approaches are not comparable in this regard. To do this we treat each method as a test, which obtains true positive (TP), true negative (TN), false positive (FP), and false negative (FN) results. In MVMR, a TP is an exposure that is causal in the underlying model <italic>and</italic> whose causal estimate is deemed statistically significant. In the PCA and sPCA methods, this classification is determined with respect to (a) which exposure(s) determine each PC and (b) if the causal estimate of this PC is statistically significant. Exposures are considered to be <italic>major contributors</italic> to a PC if (and only if) their individual PC loading is larger than the average loading. If the causal effect estimate of a PC in the analysis deemed statistically significant, major contributors that are causal and non-causal are counted as TPs and FPs, respectively. TNs and FNs are defined similarly. Type I error therefore corresponds to the FP rate and power corresponds to the TP rate. All statistical tests were conducted at the <inline-formula><mml:math id="inf46"><mml:mrow><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> = <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> = 0.025 level.</p><p>SCA, PCA, and MVMR type I error and power are shown in the three panels (left to right) in <xref ref-type="fig" rid="fig4">Figure 4b</xref>, respectively. These results suggest an improved power in identifying true causal associations both with PCA and SCA compared with MVMR when the CFS is weak, albeit at the cost of an inflated type I error rate. As sample size and CFS increase, MVMR performs better. For the PC of the second block’s null exposures, PCA seems to have a suboptimal type I error control (red in <xref ref-type="fig" rid="fig4">Figure 4b</xref>). In this low-dimensional setting, the benefit of PCA therefore appears to be limited.</p></sec><sec id="s2-3-10"><title>Complex high-dimensional example</title><p>The aim of the high-dimensional simulation is to estimate the comparative performance of the methods in a wider setting that more closely resembles real data applications. We simulate genetic data and individual level exposure and outcome data for between <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>30</mml:mn><mml:mo>-</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> exposures, arranged in <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> blocks. The underlying data generating mechanism and the process of evaluating method performance is identical to the illustrative example, but the number of variants, exposures, and the blocks is increased. We amalgamate rejection rate results across all simulations, by calculating sensitivity (SNS) and specificity (SPC) as:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mi>S</mml:mi><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and then compare all methods by their area under the estimated receiver-operating characteristic (ROC) curve (AUC) using the meta-analytical approach of <xref ref-type="bibr" rid="bib27">Reitsma et al., 2005</xref>. Briefly, the Reitsma method performs a bivariate meta-analysis of multiple studies that report both sensitivity and specificity of a diagnostic test, in order to provide a summary ROC curve. A bivariate model is required because sensitivity and specificity estimates are correlated. In our setting the ‘studies’ represent the results of different simulation settings with distinct numbers of exposures and blocks. Youden’s index <inline-formula><mml:math id="inf50"><mml:mi>J</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>) was also calculated, with high values being indicative of good performance.</p><p>Two sPCA methods (SCA [<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>], sPCA [<xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>]) consistently achieve the highest AUC (<xref ref-type="fig" rid="fig5">Figure 5</xref>). This advantage is mainly driven by an increase in sensitivity for both these methods compared with MVMR. A closer look at the individual simulation results corroborates the discriminatory ability of these two methods, as they consistently achieve high sensitivities (<xref ref-type="fig" rid="app1fig10">Appendix 1—figure 10</xref>). Both standard and Bonferroni-corrected MVMR performed poorly in terms of AUC (AUC 0.712 and 0.660, respectively), due to poor sensitivity. PCA performed poorly, with almost equal TP and FP results (AUC 0.560). PCA and RSPCA did not accurately identify negative results (PCA and RSPCA median specificity 0 and 0.192, respectively). This extreme result can be understood by looking at the individual simulation results in <xref ref-type="fig" rid="app1fig10">Appendix 1—figure 10</xref>; both PCA and RSPCA cluster to the upper right end of the plot, suggesting a consistently low performance in identifying TN exposures. Specifically, the estimates with both these methods were very precise across simulations and this resulted in many FP results and low specificity. We note a differing performance among the top ranking methods (SCA, sPCA); while both methods are on average similar, the results of SCA are more variable in both sensitivity and specificity (<xref ref-type="table" rid="table4">Table 4</xref>). The Youden’s indexes for these methods are also the highest (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). Varying the sample sizes (mean instrument strength in <inline-formula><mml:math id="inf52"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> from <inline-formula><mml:math id="inf53"><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>221</mml:mn></mml:mrow></mml:math></inline-formula> to 1109 and mean conditional <italic>F</italic>-statistic <inline-formula><mml:math id="inf54"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.34</mml:mn><mml:mo>-</mml:mo><mml:mn>12.81</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>) (<xref ref-type="fig" rid="app1fig9">Appendix 1—figure 9</xref>) suggests a similar benefit for sparse methods.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Extrapolated receiver-operating characteristic (ROC) curves for all methods.</title><p>SCA: sparse component analysis (<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>) sPCA: sparse PCA (<xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>) RSPCA: robust sparse PCA (<xref ref-type="bibr" rid="bib10">Croux et al., 2013</xref>); PCA: principal component analysis; MVMR: multivariable Mendelian randomisation; MVMR_B: MVMR with Bonferroni correction.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-fig5-v2.tif"/></fig><p>Even with large sample sizes (<inline-formula><mml:math id="inf55"><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1109.78</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf56"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>12.82</mml:mn></mml:mrow></mml:math></inline-formula>), MVMR can still not discriminate between positive and negative exposures as robustly as the sPCA methods. A major determinant of the accuracy of these methods appears to be the number of truly causal exposures, as in a repeat simulation with only four of the exposures being causal, there was a drop in sensitivity and specificity across all methods. sPCA methods still outperformed other methods in this case, however (<xref ref-type="table" rid="app1table2">Appendix 1—table 2</xref>).</p><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title>Sensitivity and specificity presented as median and interquartile range across all simulations.</title><p>Presented as median sensitivity/specificity and interquartile range across all simulations; AUC: area under the receiver-operating characteristic (ROC) curve.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom">PCA</th><th align="left" valign="bottom">SCA</th><th align="left" valign="bottom">sPCA</th><th align="left" valign="bottom">RSPCA</th><th align="left" valign="bottom">MVMR_B</th><th align="left" valign="bottom">MVMR</th></tr></thead><tbody><tr><td align="left" valign="bottom">AUC</td><td align="char" char="." valign="bottom">0.56</td><td align="char" char="." valign="bottom">0.919</td><td align="char" char="." valign="bottom">0.941</td><td align="char" char="." valign="bottom">0.644</td><td align="char" char="." valign="bottom">0.660</td><td align="char" char="." valign="bottom">0.712</td></tr><tr><td align="left" valign="bottom">Sensitivity</td><td align="char" char="." valign="bottom">1,0.1</td><td align="char" char="." valign="bottom">1,0.21</td><td align="char" char="." valign="bottom">1, 0.047</td><td align="char" char="." valign="bottom">0.667, 0.251</td><td align="char" char="." valign="bottom">0.222, 0.2</td><td align="char" char="." valign="bottom">0, 0.076</td></tr><tr><td align="left" valign="bottom">Specificity</td><td align="char" char="." valign="bottom">0,0.02</td><td align="char" char="." valign="bottom">0.925,0.772</td><td align="char" char="." valign="bottom">0.936, 0.097</td><td align="char" char="." valign="bottom">0.192, 0.104</td><td align="char" char="." valign="bottom">0.960, 0.048</td><td align="char" char="." valign="bottom">1,0</td></tr><tr><td align="left" valign="bottom">Youden’s J</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0.584</td><td align="char" char="." valign="bottom">0.778</td><td align="char" char="." valign="bottom">–0.061</td><td align="char" char="." valign="bottom">0.192</td><td align="char" char="." valign="bottom">0.044</td></tr></tbody></table></table-wrap></sec><sec id="s2-3-11"><title>What determines PCA performance?</title><p>In the hypothetical example of <xref ref-type="fig" rid="fig4">Figure 4</xref> and indeed any other example, if two PCs are constructed, PCA cannot differentiate between causal and non-causal exposures. The only information used in this stage of the workflow (Steps 2 and 3 in <xref ref-type="fig" rid="fig1">Figure 1</xref>) is the SNP-<inline-formula><mml:math id="inf57"><mml:mi>X</mml:mi></mml:math></inline-formula> association matrix. Thus, the determinant of projection to common PCs is genetic correlation and correlation due to confounding, rather than how these blocks affect <inline-formula><mml:math id="inf58"><mml:mi>Y</mml:mi></mml:math></inline-formula>. Then, if only a few of the exposures truly influence <inline-formula><mml:math id="inf59"><mml:mi>Y</mml:mi></mml:math></inline-formula>, it is likely that, PCA will falsely identify the entire block as truly causal. This means the proportion of non-causal exposures within blocks of exposures that truly influence <inline-formula><mml:math id="inf60"><mml:mi>Y</mml:mi></mml:math></inline-formula> is a key determinant of specificity. To test this, we varied the proportion of non-causal exposures by varying the sparsity of the causal effect vector <inline-formula><mml:math id="inf61"><mml:mi>β</mml:mi></mml:math></inline-formula> vector and repeated the simulations, keeping the other simulation parameters fixed. As fewer exposures within blocks are truly causal, the performance in identifying TN results drops for SCA (<xref ref-type="fig" rid="app1fig12">Appendix 1—figure 12</xref>). However, our simulation still provides a means of making comparisons across methods for a given family of simulated data.</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We propose the use of sPCA methods in MVMR in order to reduce high-dimensional exposure data to a lower number of PCs and infer the latter’s causal contribution. As the dimensionality of available datasets for MR investigations increases (e.g. in NMR experiments [<xref ref-type="bibr" rid="bib1">Biobank, 2018</xref>] and imaging studies), such approaches are becoming ever more useful. Our results support the notion that sPCA methods retain the information of the initial exposures. Although there is no single optimal method that correctly factorises the SNP-exposure matrix, the goal is to find some grouping of the multiple, correlated exposures such that it may resemble a latent biological variable that generates the data. The SCA (<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>) and sPCA (<xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>) methods performed best in simulation studies and the SCA approach performed best in the positive control example of lipids and CHD. While conventional MR approaches did not identify any protective exposures for CHD, SCA identified a cluster of small and medium HDL exposures that appeared to independently reduce the risk of CHD. This particular subset of HDL particles has previously been implicated in coronary calcification (<xref ref-type="bibr" rid="bib13">Ditah et al., 2016</xref>) and shown to be associated with coronary plaque stability (<xref ref-type="bibr" rid="bib35">Wang et al., 2019</xref>).</p><p>By employing sPCA methods in a real dataset (<xref ref-type="bibr" rid="bib23">Kettunen et al., 2016</xref>), we show that the resulting PCs group VLDL, LDL, and HDL traits together, whilst metabolites acting via alternative pathways receive zero loadings. This is a desirable property and indicates that the second-step MR enacted on the PCs obtains causal estimates for intervening on biologically meaningful pathways (<xref ref-type="bibr" rid="bib8">Chipman and Gu, 2005</xref>). This is in contrast with unconstrained PCA, in which all metabolites contribute to all PCs. Previously, <xref ref-type="bibr" rid="bib32">Sulc et al., 2020</xref> used PCA in MR to summarise highly correlated anthropometric variables. To our knowledge, this is the first investigation of different sPCA modalities in the context of MR. Our simulation studies revealed that sPCA methods exhibited superior performance compared to standard PCA, which had high FP rates, and MVMR, which had high FN rates. We additionally provide a number of ways to choose the number of components in a data-driven manner. Our proposed approach of an sPCA method naturally reduces overlap across components; for instance, in a paper by <xref ref-type="bibr" rid="bib32">Sulc et al., 2020</xref>, the authors use PCA and identify four independent axes of variation of body morphology. There are PCs that are driven in common by trunk, arm, and leg lean mass, basal metabolic rate, and BMI; a hypothetical benefit with sparse methods would be reduction of this overlap. This is an important topic for further research. When using PCA without any sparsity constraints, our simulation studies revealed numerous FP results, at the opposite end of the nature of poor performance seen in MVMR; estimates were often misleadingly precise (FN). Although appropriate transformations of the exposures were achieved, we highly recommend exploring additional forms of T1E control to improve the performance of PCA. Nonetheless, sparse methods exhibited superior performance compared to both PCA and MVMR.</p><p>A previous work on sparse methods in genetics proposed their usefulness in multi-tissue transcriptome-wide association studies (<xref ref-type="bibr" rid="bib15">Feng et al., 2021</xref>). A finding of the study is that leveraging correlated gene expressions across tissues with sparse canonical correlation analysis improves power to detect gene-trait pairs. Our approach that combines MR with sPCA also showed an improvement in power to detect causal effects of exposures on outcomes.</p><p>Our approach is conceptually different from the robust methods that have been developed for standard MVMR in the presence of weak instruments, such as MR GRAPPLE, which attempts to directly adjust point estimates for weak instrument bias, but are not a panacea, especially in the high-dimensional setting discussed here (<xref ref-type="bibr" rid="bib36">Wang et al., 2021</xref>). Furthermore, it reduces the need for a pre-selection of which exposures to include in an MVMR model. We present a complementary workflow through which we can include all available exposures with no prior selection, collate them in uncorrelated and interpretable components, and then investigate the causal contribution of these groups of exposures. It avoids the risk of generating spurious results in such an extreme setting of high collinearity compared with MVMR IVW and MR GRAPPLE formulations. For example, a 2019 three-sample MR study that assessed 82 lipoprotein subfraction risk factors’ effects on CHD used an UVMR and a robust extension of MVMR. A positive effect of VLDL- and LDL-related subfractions on CHD was reported, consistent in magnitude across the sizes of the subfractions (<xref ref-type="bibr" rid="bib39">Zhao et al., 2021</xref>). Results were less definitive on the effect of HDL subfractions of varying size on CHD, with both positive and negative effect estimates observed. In our study, the HDL subfractions were uniformly projected to similar subspaces, yielding a single component that was mainly HDL populated in all models, except for the SCA model 15 which projected the small/ medium and large/extra-large HDL traits in two different components. In all cases, the association of the sPCs with CHD was very low in magnitude. Nevertheless, the direction of effects was in line with the established knowledge on the relationship between lipid classes and CHD.</p><p>Within the sPCA methods, there were differences in the results. The sPCA method (<xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>) favoured a sparser model in which less than 10 metabolites per PC were used. This observation is also made by <xref ref-type="bibr" rid="bib18">Guo et al., 2010</xref>. The SCA method (<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>) achieved good separation of the traits and very little overlap was observed. A separation of HDL-related traits according to size, not captured by the other methods, was noted. Clinical relevance of a more high-resolution HDL profiling, with larger HDL molecules mainly associated with worse outcomes, has been previously reported (<xref ref-type="bibr" rid="bib25">Kontush, 2015</xref>).</p><sec id="s3-1"><title>Limitations</title><p>In the present study, many tuning parameters needed to be set in order to calibrate the PCA methods. We therefore caution against extending our conclusions on the best method outside the confines of our simulation and our specific real data example. Not all available sparse dimensionality reduction approaches were assessed in our investigation and other techniques could have provided better results.</p><p>The use of sparsity may raise the concern of neglecting horizontal pleiotropy if a variant influences multiple components, but its weight in a given component is shrunk to zero. This would not occur for standard PCA where no such shrinkage occurs. Currently, our approach is not robust to pleiotropy operating via exposures not included in the model. Our plan is to address this as future work by incorporating median-based MVMR models into the second stage, as done by <xref ref-type="bibr" rid="bib17">Grant and Burgess, 2021</xref>.</p><sec id="s3-1-1"><title>Interpretability</title><p>The sPCA approach outlined in this paper enables the user to perform an MVMR analysis with a large number of highly correlated exposures, but one potential downside is that the effect sizes are not as interpretable. Interpreting the causal effects of PCA components (sparse or otherwise) poses a significant challenge. This is because intervening and lowering a specific PC could be actioned by targeting any of the exposures that have a non-zero loading within it. This is in contrast to the causal effect of a single exposure, where the mode of intervention is clear. However, the same ambiguity is often a feature of a real-world intervention, such as a pharmaceutical drug. That is, even if a drug targets a specific lipid fraction, it may exert multiple effects on other lipid fractions that are not pre-planned and are a result of interlinked physiological cascades, overlapping genetics, and interdependent relationships. Identifying such underlying biological mechanisms and pathways is a key step in deciding on the relevance of a PCA derived effect estimate compared to a standard MVMR estimate. We therefore suggest that this approach is best suited for initially testing how large groups of risk factors independently affect health outcomes, before a more focused MVMR within the PCA-identified exposures.</p><p>Another limitation of our work is that the instrument selection could have been more precise since we used an external study that investigated total lipid fractions rather than specific size and composition profile characteristics. Future more specific GWAS could improve this, leading to better separation in the genetic predictions of all lipid fractions.</p></sec></sec><sec id="s3-2"><title>Conclusion</title><p>In the present study, we underline the utility of sparse dimensionality reduction approaches for highly correlated exposures in MR. We present a comprehensive review of methods available to perform dimensionality reduction and describe their performance in a real data application and a simulation.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Approximate relationship to a one-sample analysis</title><p>Our approach works directly with summary statistics gleaned from genome-wide association studies that are used to furnish a two-sample analysis, but it can also be motivated from the starting point of a one-sample individual level data. Specifically, assume the data generating model is <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and so that the second-stage model of a two-stage least squares procedure is <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. PCA on <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is approximately equivalent to PCA on <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> since <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> if <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is normalised so that <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> represents standardised effects. In the appendix we provide further simulation results that show that the loadings matrix derived from a PCA on <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are asymptotically equivalent.</p></sec><sec id="s4-2"><title>Data</title><p>The risk factor dataset reports the associations of 148 genetic variants (SNPs) with 118 NMR-measured metabolites ((<xref ref-type="table" rid="table5">Table 5</xref>) , <xref ref-type="bibr" rid="bib23">Kettunen et al., 2016</xref>). This study reports a high-resolution profiling of mainly lipid subfractions. To focus on lipid-related traits, we exclude amino acids and retain 97 exposures for further analyses. Fourteen size/density classes of lipoprotein particles (ranging from extra small [XS] HDL to extra-extra-large [XXL] VLDL) were available and, for each class, the traits of total cholesterol, triglycerides, phospholipids, and cholesterol esters content, and the average diameter of the particles were additionally provided. Through the same procedure, estimates from NMR on genetic associations of amino acids, apolipoproteins, fatty and fluid acids, ketone bodies, and glycerides were also included. Instrument selection for this dataset has been previously described (<xref ref-type="bibr" rid="bib42">Zuber et al., 2020a</xref>). Namely, 185 variants were selected, based on association with either one of: LDL-cholesterol, HDL-cholesterol, or triglycerides in the external sample of the Global Lipid Genetics Consortium at the genome-wide level (<inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib14">Do et al., 2013</xref>). Then, this set was pruned to avoid inclusion of SNPs in linkage disequilibrium (LD) (threshold: <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) and filtered (variants in distance less than 1 megabase pairs were excluded) resulting in the final set. This pre-processing strategy was performed with a view to study CHD risk.</p><p>Positive control outcome assessment is recommended in MR as an approach of investigating a risk factor that has an established causal effect on the outcome of interest (<xref ref-type="bibr" rid="bib6">Burgess et al., 2020</xref>). We used CHD as a positive control outcome, given that lipid fractions are known to modulate its risk, with VLDL- and LDL-related traits being positively associated with CHD and HDL-related traits negatively (<xref ref-type="bibr" rid="bib6">Burgess et al., 2020</xref>). Summary estimates from the CARDIoGRAMplusC4D Consortium and UK Biobank meta-analysis (<xref ref-type="bibr" rid="bib26">Nelson et al., 2017</xref>; <xref ref-type="bibr" rid="bib12">Deloukas et al., 2013</xref>) were used. For both datasets, a predominantly European population was included, as otherwise spurious results could have arisen due to population-specific, as opposed to CHD-specific, differences (<xref ref-type="bibr" rid="bib34">Vilhjálmsson and Nordborg, 2013</xref>).</p><table-wrap id="table5" position="float"><label>Table 5.</label><caption><title>Two-sample Mendelian randomisation (MR).</title><p>Study characteristics.</p></caption> <table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom">First author</th><th align="left" valign="bottom">Year</th><th align="left" valign="bottom">PMID</th><th align="left" valign="bottom"><italic>N</italic></th><th align="left" valign="bottom">Cases</th><th align="left" valign="bottom">Controls</th><th align="left" valign="bottom">Study name (population)</th></tr></thead><tbody><tr><td align="left" valign="bottom">Metabolites</td><td align="left" valign="bottom">Kettunen</td><td align="char" char="." valign="bottom">2016</td><td align="char" char="." valign="bottom">27005778</td><td align="char" char="." valign="bottom">24,925</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">NMR GWAS (European)</td></tr><tr><td align="left" valign="bottom">CHD</td><td align="left" valign="bottom">Nelson</td><td align="char" char="." valign="bottom">2017</td><td align="char" char="." valign="bottom">28714975</td><td align="char" char="." valign="bottom">453,595</td><td align="char" char="." valign="bottom">113,937</td><td align="char" char="." valign="bottom">339,658</td><td align="left" valign="bottom">CARDIoGRAMplusC4D (European)</td></tr></tbody></table></table-wrap></sec><sec id="s4-3"><title>MR assumptions</title><p>The first assumption (IV1) states that IVs should be associated with the exposure. The second assumption (IV2) states that the IVs should be independent of all confounders of the risk factor-outcome association (IV2) and, finally, independent of the outcome conditional on the exposure and the confounders (IV3). The validity of the final two assumptions cannot be directly verified with the available data. For the inferences to be valid, it is necessary that the three IV assumptions apply (<xref ref-type="bibr" rid="bib11">Davies et al., 2018</xref>). These assumptions are illustrated for the case of two exposures in <xref ref-type="fig" rid="fig6">Figure 6a</xref>. In situations when IV3 is not deemed likely, additional risk factors that are possible mediators can be introduced in an MVMR model (<xref ref-type="bibr" rid="bib5">Burgess and Harshfield, 2016</xref>). Additional assumptions should hold for MVMR results to be valid. Particularly, (a) all included exposures have to be associated with at least one of the IVs, and (b) there should be no evidence of multicollinearity. If there is significant overlap, for example if <italic>G</italic><sub>1</sub> and <italic>G</italic><sub>2</sub> are associated with both exposures <italic>X</italic><sub>1</sub> and <italic>X</italic><sub>2</sub>, but only with <italic>X</italic><sub>2</sub> through <italic>X</italic><sub>1</sub> as in <xref ref-type="fig" rid="fig6">Figure 6b</xref>, this may result in conditionally weak instruments (<xref ref-type="bibr" rid="bib30">Sanderson et al., 2020</xref>). The latter assumption and the way it limits eligibility of high-dimensional, correlated exposures is a key motivation for the present work.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Directed acyclic graph (DAG) for the multivariable Mendelian randomisation (MVMR) assumptions.</title><p>IV2, IV3: instrumental variable assumptions 2 and 3.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-fig6-v2.tif"/></fig></sec><sec id="s4-4"><title>UVMR and MVMR</title><p>To examine how each of the metabolites is causally associated with CHD, a UVMR approach was first undertaken under the two-sample summary data framework. This uses SNP-exposure and SNP-outcome GWAS summary statistics (<inline-formula><mml:math id="inf74"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf75"><mml:mover accent="true"><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>, respectively), obtained by regressing the exposure or outcome trait on each SNP individually. Usually, an additional adjustment has been made for variables such as age, gender, and genetic PCs. An UVMR analysis is the most straightforward way to obtain an estimate for the causal effect of the exposure, but is only reliable if all SNPs are valid instruments. However, in the Kettunen dataset, where the exposure set comprises 97 highly correlated lipid fractions, one variant may influence multiple exposures. This will generally invalidate an UVMR analysis and an MVMR approach is more appropriate.</p><p>Estimating <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> provides a general means for representing the mechanics of an UVMR or MVMR analysis:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>where </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mn>2</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf76"><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the association of SNP <inline-formula><mml:math id="inf77"><mml:mi>j</mml:mi></mml:math></inline-formula> with exposure <inline-formula><mml:math id="inf78"><mml:mi>k</mml:mi></mml:math></inline-formula>, with variance <inline-formula><mml:math id="inf79"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>;</p></list-item><list-item><p><inline-formula><mml:math id="inf80"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> represents the association of SNP <inline-formula><mml:math id="inf81"><mml:mi>j</mml:mi></mml:math></inline-formula> with the outcome, with variance <inline-formula><mml:math id="inf82"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>;</p></list-item><list-item><p><inline-formula><mml:math id="inf83"><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> represents the causal effect of exposure <inline-formula><mml:math id="inf84"><mml:mi>k</mml:mi></mml:math></inline-formula> on the outcome to be estimated.</p></list-item><list-item><p><inline-formula><mml:math id="inf85"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents Cov(<inline-formula><mml:math id="inf86"><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>,<inline-formula><mml:math id="inf87"><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). If individual-level data is not available to obtain this quantity, it can be estimated using the intercept from LD score regression (<xref ref-type="bibr" rid="bib2">Bulik-Sullivan et al., 2015</xref>).</p></list-item></list><p>In an UVMR analysis there is only one exposure, so that  <inline-formula><mml:math id="inf88"><mml:mi>K</mml:mi></mml:math></inline-formula>=1, whereas in an MVMR analysis <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (or in the case of the Kettunen data, <inline-formula><mml:math id="inf90"><mml:mi>K</mml:mi></mml:math></inline-formula>=97). In an IVW UVMR or MVMR analysis, the causal effect parameters estimated are obtained by finding the values <inline-formula><mml:math id="inf91"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> that minimise <inline-formula><mml:math id="inf92"><mml:msub><mml:mi>Q</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>, under the simplifying assumption that <inline-formula><mml:math id="inf93"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> = <inline-formula><mml:math id="inf94"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. This is justified if all causal effects are zero, or if the uncertainty in the SNP-exposure associations is negligible (the no measurement error [NOME] assumption). In the general MVMR context, the NOME assumption is approximately satisfied if the CFS for each exposure are large, but if it is not, then IVW MVMR estimates will suffer from weak instrument bias. For exposure <inline-formula><mml:math id="inf95"><mml:mi>k</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> takes the form<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:mi>F</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where:<disp-formula id="equ4"><label>(3)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mover><mml:mi>δ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>where </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mover><mml:mi>δ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mover><mml:mi>δ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>δ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf97"><mml:mover accent="true"><mml:mi>δ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is estimated by regressing an exposure <inline-formula><mml:math id="inf98"><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> on all other exposures <inline-formula><mml:math id="inf99"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> by OLS. If an exposure <inline-formula><mml:math id="inf100"><mml:mi>k</mml:mi></mml:math></inline-formula> can be accurately predicted conditionally on other exposures, then there won’t be sufficient variation or ‘good heterogeneity’ (<xref ref-type="bibr" rid="bib29">Sanderson et al., 2019</xref>) in <inline-formula><mml:math id="inf101"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and CFS will generally be small. This will be the case whenever there is a high degree of correlation between the SNP-exposure association estimates, for example as in an MVMR analysis of all 118 lipid fractions in the Kettunen data. One option to address this would be to use weak instrument robust MVMR, such as MR-GRAPPLE (<xref ref-type="bibr" rid="bib36">Wang et al., 2021</xref>). This method performs estimation using the full definition of <inline-formula><mml:math id="inf102"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> and using a robust loss function that additionally penalises larger outliers in the data. It can work well for MVMR analyses of relatively small numbers of exposures (e.g. up to 10) and relatively weak instruments (CFS as low as 3), but the dimension and high correlation of the Kettunen data is arguably too challenging. This motivates the use of dimension reduction techniques, such as PCA.</p></sec><sec id="s4-5"><title>Dimension reduction via PCA</title><p>PCA is a singular value decomposition a given matrix of the <inline-formula><mml:math id="inf103"><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> matrix of SNP-exposure associations <inline-formula><mml:math id="inf104"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> as:<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf105"><mml:mi>U</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf106"><mml:mi>V</mml:mi></mml:math></inline-formula> are orthogonal matrices and <inline-formula><mml:math id="inf107"><mml:mi>D</mml:mi></mml:math></inline-formula> is a square matrix whose diagonal values are the variances explained by each component and all off-diagonal values are 0. <italic>V</italic> is the loadings matrix and serves as an indicator of the contribution of each metabolite to the transformed space of the PCs. The matrix <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> (PCs/scores matrix) is used in the second-step IVW regression in place of <inline-formula><mml:math id="inf109"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. As <inline-formula><mml:math id="inf110"><mml:mi>V</mml:mi></mml:math></inline-formula> estimation does not aim for sparsity, all exposures will contribute to some degree to all components, making the interpretation more complicated. Therefore, we assessed multiple sPCA methods that intentionally limit this.</p><sec id="s4-5-1"><title>sPCA (Zou et al.)</title><p>sPCA by <xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>, estimates the loadings matrix through an iterative procedure that progressively penalises exposures so that they do not contribute to certain PCs. In principle, this leads to a more clear picture for the consistency of each PC. This is performed as follows:</p><list list-type="order"><list-item><p>Setting a fixed matrix, the following elastic net problem is solved <inline-formula><mml:math id="inf111"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>ξ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>ξ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>ξ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∥</mml:mo><mml:mi>ξ</mml:mi><mml:mo>∥</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mi>ξ</mml:mi><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf112"><mml:mi>j</mml:mi></mml:math></inline-formula> is the PC.</p></list-item><list-item><p>For a fixed <inline-formula><mml:math id="inf113"><mml:mi mathvariant="normal">Ξ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf114"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:msup><mml:mi>γ</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Ξ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is estimated and update <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>Repeat steps 1 and 2 until convergence.</p></list-item></list><p>Here, <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> is an <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> sparsity parameter that induces sparsity, <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> is an <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> parameter that offers numerical stability, and <inline-formula><mml:math id="inf120"><mml:mi mathvariant="normal">Ξ</mml:mi></mml:math></inline-formula> is a matrix with sparsity constraints for each exposure (<xref ref-type="bibr" rid="bib41">Zou and Xue, 2018</xref>). As a result of the additional <inline-formula><mml:math id="inf121"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∥</mml:mo><mml:mi>ξ</mml:mi><mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> norm, there is sparsity in the loadings matrix and only some of the SNP-exposure associations <inline-formula><mml:math id="inf122"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> contribute to each PC, specifically a particular subset of highly correlated exposures in <inline-formula><mml:math id="inf123"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>.</p></sec><sec id="s4-5-2"><title>RSPCA</title><p>This approach differs in that it employs a robust measure of dispersion that is not unduly influenced by large single values of <inline-formula><mml:math id="inf124"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> that contribute a large amount to the total variance (<xref ref-type="bibr" rid="bib28">Rousseeuw and Croux, 1993</xref>; <xref ref-type="bibr" rid="bib19">Heckert, 2003</xref>). As above, an <italic>L</italic><sub>1</sub> norm is used to induce sparsity. For optimisation, the tradeoff product optimisation is maximised. It does not impose a single <inline-formula><mml:math id="inf125"><mml:mi>λ</mml:mi></mml:math></inline-formula> value on all PCs, thus allowing different degrees of sparsity.</p></sec><sec id="s4-5-3"><title>SFPCA (<xref ref-type="bibr" rid="bib18">Guo et al., 2010</xref>)</title><p>A method that can in theory exploit distinct correlation structures. Its goal is to derive a loadings matrix in which highly positively correlated variables are similar in sign and highly negative ones are opposite. Similar magnitudes also tend to be obtained for those variables that are in the same blocks in the correlation matrix. Like the sPCA optimisation in <xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>, sparse fused PCA (SFPCA) works by assigning highly correlated variables the exact same loadings as opposed to numerically similar ones (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). This is achieved with two norms in the objective function: <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> which regulates the <italic>L</italic><sub>1</sub> norm that induces sparsity and <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> for the <inline-formula><mml:math id="inf128"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> regularisation (squared magnitude of <inline-formula><mml:math id="inf129"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>) to guard against singular solutions. A grid search is used to identify appropriate parameters for <inline-formula><mml:math id="inf130"><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf131"><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>. The following criterion is used:<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Ξ</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">Ξ</mml:mi><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mi>ξ</mml:mi><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>such that <inline-formula><mml:math id="inf132"><mml:mrow><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The ‘fused’ penalty (last term) purposely penalises discordant loadings for variables that are highly correlated. The choice of the sparsity parameters is based on a Bayesian information criterion (BIC).</p></sec><sec id="s4-5-4"><title>SCA</title><p>SCA (<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>) is motivated by the relative inadequacy of the classic approaches in promoting significant sparsity. It addresses this by rotating the eigenvectors to achieve approximate sparsity whilst keeping the proportion of variance explained the same. Simulation studies show the technique works especially well in high-dimensional settings such as gene expression data, among other examples (<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>).</p></sec></sec><sec id="s4-6"><title>Choice of components</title><p>In all dimensionality reduction approaches applied to correlated variables, there is no upper limit to how many transformed factors can be estimated. However, only a proportion of them are likely to be informative in the sense of collectively explaining a meaningful amount of total variance in the original dataset. To guide this choice, a permutation-based approach was implemented (<xref ref-type="bibr" rid="bib9">Coombes and Wang, 2019</xref>) as follows: Firstly, the <inline-formula><mml:math id="inf133"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> matrix was randomly permuted and the sPCA method of interest was applied on the permuted set. The computed eigenvalues are assumed to come from a null distribution consistent with a non-informative component. This process is repeated multiple times (e.g. <inline-formula><mml:math id="inf134"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>) and the mean eigenvalues for all components stored. Finally, the sPCA method is performed in the original <inline-formula><mml:math id="inf135"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> matrix and whichever component has an eigenvalue larger than the mean of the permuted sets is considered informative and kept. Due to the computational complexity of the permutation method, particularly for SFPCA, an alternate method - the KSS criterion (<xref ref-type="bibr" rid="bib22">Karlis et al., 2003</xref>) - was also used. This is based on a simple correction on the minimum non-trivial eigenvalue (<inline-formula><mml:math id="inf136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula>). The authors show that the method is robust to non-normal distributions (<xref ref-type="bibr" rid="bib22">Karlis et al., 2003</xref>). Although KSS was not compared with the above-described permutation approach, it performed better than simpler approaches, such as choosing those PCs whose eigenvalue is larger than 1 (Kaiser criterion), the broken stick method (<xref ref-type="bibr" rid="bib20">Jolliffe, 2002</xref>) and the Velicer method (<xref ref-type="bibr" rid="bib33">Velicer, 1976</xref>).</p></sec><sec id="s4-7"><title>Instrument strength of PCs</title><p>In MVMR, the <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> assumption requires a set of genetic variants that robustly associate with at least one of the exposures <inline-formula><mml:math id="inf138"><mml:mi>X</mml:mi></mml:math></inline-formula> (<italic>MR assumptions</italic>). This is quantified by CFS in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> (<xref ref-type="bibr" rid="bib30">Sanderson et al., 2020</xref>). With summary statistics of the SNP-<inline-formula><mml:math id="inf139"><mml:mi>X</mml:mi></mml:math></inline-formula> associations <inline-formula><mml:math id="inf140"><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf141"><mml:mi>p</mml:mi></mml:math></inline-formula>: SNP, <inline-formula><mml:math id="inf142"><mml:mi>k</mml:mi></mml:math></inline-formula>: exposure), the mean <italic>F</italic>- statistic for exposure <inline-formula><mml:math id="inf143"><mml:mi>k</mml:mi></mml:math></inline-formula> used in a standard UVMR analysis is the far simpler expression<disp-formula id="equ7"><label>(4)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mi>p</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We provide a dedicated formula for estimating instrument strength measures for the <inline-formula><mml:math id="inf144"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistic for the PCs that is closely related to <xref ref-type="disp-formula" rid="equ4">Equation 3</xref> rather than <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>. This simplification is due to the fact that an MVMR analysis of a set of PCs is essentially equivalent to an UMVR analysis of each exposure separately. The full derivation is reported in the section ‘Instrument strength’ of the Appendix.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>is a part-time employee of Novo Nordisk</p></fn><fn fn-type="COI-statement" id="conf3"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Software, Formal analysis, Investigation, Methodology, Writing - original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Supervision, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Software, Formal analysis, Supervision, Investigation, Visualization, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Data curation, Software, Formal analysis, Supervision, Investigation, Visualization, Methodology, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-80063-mdarchecklist1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The GWAS summary statistics for the metabolites (<ext-link ext-link-type="uri" xlink:href="http://www.computationalmedicine.fi/data/NMR_GWAS/">http://www.computationalmedicine.fi/data/NMR_GWAS/</ext-link>) and CHD (<ext-link ext-link-type="uri" xlink:href="http://www.cardiogramplusc4d.org/">http://www.cardiogramplusc4d.org/</ext-link>) are publicly available. We provide code for the SCA function, the simulation study and related documentation on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/vaskarageorg/SCA_MR/">https://github.com/vaskarageorg/SCA_MR/</ext-link>, copy archived at <xref ref-type="bibr" rid="bib21">Karageorgiou, 2023</xref>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>We would like to thank Dr. Stephen Burgess and two anonymous reviewers that provided constructive comments on the extension of the approach to individual-level data, on improving and clarifying the applied analyses, and on updating and communicating the simulation results.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Biobank</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Nightingale Health and UK Biobank announces major initiative to analyse half a million blood samples to facilitate global medical research</article-title><ext-link ext-link-type="uri" xlink:href="https://www.ukbiobank.ac.uk/learn-more-about-uk-biobank/news/nightingale-health-and-uk-biobank-announces-major-initiative-to-analyse-half-a-million-blood-samples-to-facilitate-global-medical-research">https://www.ukbiobank.ac.uk/learn-more-about-uk-biobank/news/nightingale-health-and-uk-biobank-announces-major-initiative-to-analyse-half-a-million-blood-samples-to-facilitate-global-medical-research</ext-link><date-in-citation iso-8601-date="2021-07-19">July 19, 2021</date-in-citation></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bulik-Sullivan</surname><given-names>BK</given-names></name><name><surname>Loh</surname><given-names>P-R</given-names></name><name><surname>Finucane</surname><given-names>HK</given-names></name><name><surname>Ripke</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><collab>Schizophrenia Working Group of the Psychiatric Genomics Consortium</collab><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Neale</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>LD score regression distinguishes confounding from Polygenicity in genome-wide Association studies</article-title><source>Nature Genetics</source><volume>47</volume><fpage>291</fpage><lpage>295</lpage><pub-id pub-id-type="doi">10.1038/ng.3211</pub-id><pub-id pub-id-type="pmid">25642630</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgess</surname><given-names>S</given-names></name><name><surname>Thompson</surname><given-names>SG</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Multivariable Mendelian randomization: The use of pleiotropic genetic variants to estimate causal effects</article-title><source>American Journal of Epidemiology</source><volume>181</volume><fpage>251</fpage><lpage>260</lpage><pub-id pub-id-type="doi">10.1093/aje/kwu283</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgess</surname><given-names>S</given-names></name><name><surname>Davies</surname><given-names>NM</given-names></name><name><surname>Thompson</surname><given-names>SG</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Bias due to participant overlap in two-sample Mendelian randomization</article-title><source>Genetic Epidemiology</source><volume>40</volume><fpage>597</fpage><lpage>608</lpage><pub-id pub-id-type="doi">10.1002/gepi.21998</pub-id><pub-id pub-id-type="pmid">27625185</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgess</surname><given-names>S</given-names></name><name><surname>Harshfield</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Mendelian randomization to assess causal effects of blood lipids on coronary heart disease</article-title><source>Current Opinion in Endocrinology, Diabetes &amp; Obesity</source><volume>23</volume><fpage>124</fpage><lpage>130</lpage><pub-id pub-id-type="doi">10.1097/MED.0000000000000230</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgess</surname><given-names>S</given-names></name><name><surname>Davey Smith</surname><given-names>G</given-names></name><name><surname>Davies</surname><given-names>NM</given-names></name><name><surname>Dudbridge</surname><given-names>F</given-names></name><name><surname>Gill</surname><given-names>D</given-names></name><name><surname>Glymour</surname><given-names>MM</given-names></name><name><surname>Hartwig</surname><given-names>FP</given-names></name><name><surname>Holmes</surname><given-names>MV</given-names></name><name><surname>Minelli</surname><given-names>C</given-names></name><name><surname>Relton</surname><given-names>CL</given-names></name><name><surname>Theodoratou</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Guidelines for performing Mendelian randomization investigations</article-title><source>Wellcome Open Research</source><volume>4</volume><elocation-id>186</elocation-id><pub-id pub-id-type="doi">10.12688/wellcomeopenres.15555.2</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>F</given-names></name><name><surname>Rohe</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A New Basis for Sparse Principal Component Analysis</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2007.00596">https://arxiv.org/abs/2007.00596</ext-link></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chipman</surname><given-names>HA</given-names></name><name><surname>Gu</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Interpretable dimension reduction</article-title><source>Journal of Applied Statistics</source><volume>32</volume><fpage>969</fpage><lpage>987</lpage><pub-id pub-id-type="doi">10.1080/02664760500168648</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Coombes</surname><given-names>KR</given-names></name><name><surname>Wang</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>PCDimension: Finding the Number of Significant Principal Components</article-title><ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=PCDimension">https://CRAN.R-project.org/package=PCDimension</ext-link><date-in-citation iso-8601-date="2021-07-19">July 19, 2021</date-in-citation></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croux</surname><given-names>C</given-names></name><name><surname>Filzmoser</surname><given-names>P</given-names></name><name><surname>Fritz</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Robust sparse principal component analysis</article-title><source>Technometrics</source><volume>55</volume><fpage>202</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1080/00401706.2012.727746</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davies</surname><given-names>NM</given-names></name><name><surname>Holmes</surname><given-names>MV</given-names></name><name><surname>Davey Smith</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Reading Mendelian Randomisation studies: A guide, glossary, and checklist for Clinicians</article-title><source>BMJ</source><volume>362</volume><elocation-id>k601</elocation-id><pub-id pub-id-type="doi">10.1136/bmj.k601</pub-id><pub-id pub-id-type="pmid">30002074</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deloukas</surname><given-names>P</given-names></name><name><surname>Kanoni</surname><given-names>S</given-names></name><name><surname>Willenborg</surname><given-names>C</given-names></name><name><surname>Farrall</surname><given-names>M</given-names></name><name><surname>Assimes</surname><given-names>TL</given-names></name><name><surname>Thompson</surname><given-names>JR</given-names></name><name><surname>Ingelsson</surname><given-names>E</given-names></name><name><surname>Saleheen</surname><given-names>D</given-names></name><name><surname>Erdmann</surname><given-names>J</given-names></name><name><surname>Goldstein</surname><given-names>BA</given-names></name><name><surname>Stirrups</surname><given-names>K</given-names></name><name><surname>König</surname><given-names>IR</given-names></name><name><surname>Cazier</surname><given-names>J-B</given-names></name><name><surname>Johansson</surname><given-names>A</given-names></name><name><surname>Hall</surname><given-names>AS</given-names></name><name><surname>Lee</surname><given-names>J-Y</given-names></name><name><surname>Willer</surname><given-names>CJ</given-names></name><name><surname>Chambers</surname><given-names>JC</given-names></name><name><surname>Esko</surname><given-names>T</given-names></name><name><surname>Folkersen</surname><given-names>L</given-names></name><name><surname>Goel</surname><given-names>A</given-names></name><name><surname>Grundberg</surname><given-names>E</given-names></name><name><surname>Havulinna</surname><given-names>AS</given-names></name><name><surname>Ho</surname><given-names>WK</given-names></name><name><surname>Hopewell</surname><given-names>JC</given-names></name><name><surname>Eriksson</surname><given-names>N</given-names></name><name><surname>Kleber</surname><given-names>ME</given-names></name><name><surname>Kristiansson</surname><given-names>K</given-names></name><name><surname>Lundmark</surname><given-names>P</given-names></name><name><surname>Lyytikäinen</surname><given-names>L-P</given-names></name><name><surname>Rafelt</surname><given-names>S</given-names></name><name><surname>Shungin</surname><given-names>D</given-names></name><name><surname>Strawbridge</surname><given-names>RJ</given-names></name><name><surname>Thorleifsson</surname><given-names>G</given-names></name><name><surname>Tikkanen</surname><given-names>E</given-names></name><name><surname>Van Zuydam</surname><given-names>N</given-names></name><name><surname>Voight</surname><given-names>BF</given-names></name><name><surname>Waite</surname><given-names>LL</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Ziegler</surname><given-names>A</given-names></name><name><surname>Absher</surname><given-names>D</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Balmforth</surname><given-names>AJ</given-names></name><name><surname>Barroso</surname><given-names>I</given-names></name><name><surname>Braund</surname><given-names>PS</given-names></name><name><surname>Burgdorf</surname><given-names>C</given-names></name><name><surname>Claudi-Boehm</surname><given-names>S</given-names></name><name><surname>Cox</surname><given-names>D</given-names></name><name><surname>Dimitriou</surname><given-names>M</given-names></name><name><surname>Do</surname><given-names>R</given-names></name><name><surname>Doney</surname><given-names>ASF</given-names></name><name><surname>El Mokhtari</surname><given-names>N</given-names></name><name><surname>Eriksson</surname><given-names>P</given-names></name><name><surname>Fischer</surname><given-names>K</given-names></name><name><surname>Fontanillas</surname><given-names>P</given-names></name><name><surname>Franco-Cereceda</surname><given-names>A</given-names></name><name><surname>Gigante</surname><given-names>B</given-names></name><name><surname>Groop</surname><given-names>L</given-names></name><name><surname>Gustafsson</surname><given-names>S</given-names></name><name><surname>Hager</surname><given-names>J</given-names></name><name><surname>Hallmans</surname><given-names>G</given-names></name><name><surname>Han</surname><given-names>B-G</given-names></name><name><surname>Hunt</surname><given-names>SE</given-names></name><name><surname>Kang</surname><given-names>HM</given-names></name><name><surname>Illig</surname><given-names>T</given-names></name><name><surname>Kessler</surname><given-names>T</given-names></name><name><surname>Knowles</surname><given-names>JW</given-names></name><name><surname>Kolovou</surname><given-names>G</given-names></name><name><surname>Kuusisto</surname><given-names>J</given-names></name><name><surname>Langenberg</surname><given-names>C</given-names></name><name><surname>Langford</surname><given-names>C</given-names></name><name><surname>Leander</surname><given-names>K</given-names></name><name><surname>Lokki</surname><given-names>M-L</given-names></name><name><surname>Lundmark</surname><given-names>A</given-names></name><name><surname>McCarthy</surname><given-names>MI</given-names></name><name><surname>Meisinger</surname><given-names>C</given-names></name><name><surname>Melander</surname><given-names>O</given-names></name><name><surname>Mihailov</surname><given-names>E</given-names></name><name><surname>Maouche</surname><given-names>S</given-names></name><name><surname>Morris</surname><given-names>AD</given-names></name><name><surname>Müller-Nurasyid</surname><given-names>M</given-names></name><name><surname>Nikus</surname><given-names>K</given-names></name><name><surname>Peden</surname><given-names>JF</given-names></name><name><surname>Rayner</surname><given-names>NW</given-names></name><name><surname>Rasheed</surname><given-names>A</given-names></name><name><surname>Rosinger</surname><given-names>S</given-names></name><name><surname>Rubin</surname><given-names>D</given-names></name><name><surname>Rumpf</surname><given-names>MP</given-names></name><name><surname>Schäfer</surname><given-names>A</given-names></name><name><surname>Sivananthan</surname><given-names>M</given-names></name><name><surname>Song</surname><given-names>C</given-names></name><name><surname>Stewart</surname><given-names>AFR</given-names></name><name><surname>Tan</surname><given-names>S-T</given-names></name><name><surname>Thorgeirsson</surname><given-names>G</given-names></name><name><surname>van der Schoot</surname><given-names>CE</given-names></name><name><surname>Wagner</surname><given-names>PJ</given-names></name><name><surname>Wells</surname><given-names>GA</given-names></name><name><surname>Wild</surname><given-names>PS</given-names></name><name><surname>Yang</surname><given-names>T-P</given-names></name><name><surname>Amouyel</surname><given-names>P</given-names></name><name><surname>Arveiler</surname><given-names>D</given-names></name><name><surname>Basart</surname><given-names>H</given-names></name><name><surname>Boehnke</surname><given-names>M</given-names></name><name><surname>Boerwinkle</surname><given-names>E</given-names></name><name><surname>Brambilla</surname><given-names>P</given-names></name><name><surname>Cambien</surname><given-names>F</given-names></name><name><surname>Cupples</surname><given-names>AL</given-names></name><name><surname>de Faire</surname><given-names>U</given-names></name><name><surname>Dehghan</surname><given-names>A</given-names></name><name><surname>Diemert</surname><given-names>P</given-names></name><name><surname>Epstein</surname><given-names>SE</given-names></name><name><surname>Evans</surname><given-names>A</given-names></name><name><surname>Ferrario</surname><given-names>MM</given-names></name><name><surname>Ferrières</surname><given-names>J</given-names></name><name><surname>Gauguier</surname><given-names>D</given-names></name><name><surname>Go</surname><given-names>AS</given-names></name><name><surname>Goodall</surname><given-names>AH</given-names></name><name><surname>Gudnason</surname><given-names>V</given-names></name><name><surname>Hazen</surname><given-names>SL</given-names></name><name><surname>Holm</surname><given-names>H</given-names></name><name><surname>Iribarren</surname><given-names>C</given-names></name><name><surname>Jang</surname><given-names>Y</given-names></name><name><surname>Kähönen</surname><given-names>M</given-names></name><name><surname>Kee</surname><given-names>F</given-names></name><name><surname>Kim</surname><given-names>H-S</given-names></name><name><surname>Klopp</surname><given-names>N</given-names></name><name><surname>Koenig</surname><given-names>W</given-names></name><name><surname>Kratzer</surname><given-names>W</given-names></name><name><surname>Kuulasmaa</surname><given-names>K</given-names></name><name><surname>Laakso</surname><given-names>M</given-names></name><name><surname>Laaksonen</surname><given-names>R</given-names></name><name><surname>Lee</surname><given-names>J-Y</given-names></name><name><surname>Lind</surname><given-names>L</given-names></name><name><surname>Ouwehand</surname><given-names>WH</given-names></name><name><surname>Parish</surname><given-names>S</given-names></name><name><surname>Park</surname><given-names>JE</given-names></name><name><surname>Pedersen</surname><given-names>NL</given-names></name><name><surname>Peters</surname><given-names>A</given-names></name><name><surname>Quertermous</surname><given-names>T</given-names></name><name><surname>Rader</surname><given-names>DJ</given-names></name><name><surname>Salomaa</surname><given-names>V</given-names></name><name><surname>Schadt</surname><given-names>E</given-names></name><name><surname>Shah</surname><given-names>SH</given-names></name><name><surname>Sinisalo</surname><given-names>J</given-names></name><name><surname>Stark</surname><given-names>K</given-names></name><name><surname>Stefansson</surname><given-names>K</given-names></name><name><surname>Trégouët</surname><given-names>D-A</given-names></name><name><surname>Virtamo</surname><given-names>J</given-names></name><name><surname>Wallentin</surname><given-names>L</given-names></name><name><surname>Wareham</surname><given-names>N</given-names></name><name><surname>Zimmermann</surname><given-names>ME</given-names></name><name><surname>Nieminen</surname><given-names>MS</given-names></name><name><surname>Hengstenberg</surname><given-names>C</given-names></name><name><surname>Sandhu</surname><given-names>MS</given-names></name><name><surname>Pastinen</surname><given-names>T</given-names></name><name><surname>Syvänen</surname><given-names>A-C</given-names></name><name><surname>Hovingh</surname><given-names>GK</given-names></name><name><surname>Dedoussis</surname><given-names>G</given-names></name><name><surname>Franks</surname><given-names>PW</given-names></name><name><surname>Lehtimäki</surname><given-names>T</given-names></name><name><surname>Metspalu</surname><given-names>A</given-names></name><name><surname>Zalloua</surname><given-names>PA</given-names></name><name><surname>Siegbahn</surname><given-names>A</given-names></name><name><surname>Schreiber</surname><given-names>S</given-names></name><name><surname>Ripatti</surname><given-names>S</given-names></name><name><surname>Blankenberg</surname><given-names>SS</given-names></name><name><surname>Perola</surname><given-names>M</given-names></name><name><surname>Clarke</surname><given-names>R</given-names></name><name><surname>Boehm</surname><given-names>BO</given-names></name><name><surname>O’Donnell</surname><given-names>C</given-names></name><name><surname>Reilly</surname><given-names>MP</given-names></name><name><surname>März</surname><given-names>W</given-names></name><name><surname>Collins</surname><given-names>R</given-names></name><name><surname>Kathiresan</surname><given-names>S</given-names></name><name><surname>Hamsten</surname><given-names>A</given-names></name><name><surname>Kooner</surname><given-names>JS</given-names></name><name><surname>Thorsteinsdottir</surname><given-names>U</given-names></name><name><surname>Danesh</surname><given-names>J</given-names></name><name><surname>Palmer</surname><given-names>CNA</given-names></name><name><surname>Roberts</surname><given-names>R</given-names></name><name><surname>Watkins</surname><given-names>H</given-names></name><name><surname>Schunkert</surname><given-names>H</given-names></name><name><surname>Samani</surname><given-names>NJ</given-names></name><collab>CARDIoGRAMplusC4D Consortium</collab><collab>DIAGRAM Consortium</collab><collab>CARDIOGENICS Consortium</collab><collab>MuTHER Consortium</collab><collab>Wellcome Trust Case Control Consortium</collab></person-group><year iso-8601-date="2013">2013</year><article-title>Large-scale Association analysis identifies new risk Loci for coronary artery disease</article-title><source>Nature Genetics</source><volume>45</volume><fpage>25</fpage><lpage>33</lpage><pub-id pub-id-type="doi">10.1038/ng.2480</pub-id><pub-id pub-id-type="pmid">23202125</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ditah</surname><given-names>C</given-names></name><name><surname>Otvos</surname><given-names>J</given-names></name><name><surname>Nassar</surname><given-names>H</given-names></name><name><surname>Shaham</surname><given-names>D</given-names></name><name><surname>Sinnreich</surname><given-names>R</given-names></name><name><surname>Kark</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Small and medium sized HDL particles are protectively associated with coronary calcification in a cross-sectional population-based sample</article-title><source>Atherosclerosis</source><volume>251</volume><fpage>124</fpage><lpage>131</lpage><pub-id pub-id-type="doi">10.1016/j.atherosclerosis.2016.06.010</pub-id><pub-id pub-id-type="pmid">27318832</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Do</surname><given-names>R</given-names></name><name><surname>Willer</surname><given-names>CJ</given-names></name><name><surname>Schmidt</surname><given-names>EM</given-names></name><name><surname>Sengupta</surname><given-names>S</given-names></name><name><surname>Gao</surname><given-names>C</given-names></name><name><surname>Peloso</surname><given-names>GM</given-names></name><name><surname>Gustafsson</surname><given-names>S</given-names></name><name><surname>Kanoni</surname><given-names>S</given-names></name><name><surname>Ganna</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Buchkovich</surname><given-names>ML</given-names></name><name><surname>Mora</surname><given-names>S</given-names></name><name><surname>Beckmann</surname><given-names>JS</given-names></name><name><surname>Bragg-Gresham</surname><given-names>JL</given-names></name><name><surname>Chang</surname><given-names>H-Y</given-names></name><name><surname>Demirkan</surname><given-names>A</given-names></name><name><surname>Den Hertog</surname><given-names>HM</given-names></name><name><surname>Donnelly</surname><given-names>LA</given-names></name><name><surname>Ehret</surname><given-names>GB</given-names></name><name><surname>Esko</surname><given-names>T</given-names></name><name><surname>Feitosa</surname><given-names>MF</given-names></name><name><surname>Ferreira</surname><given-names>T</given-names></name><name><surname>Fischer</surname><given-names>K</given-names></name><name><surname>Fontanillas</surname><given-names>P</given-names></name><name><surname>Fraser</surname><given-names>RM</given-names></name><name><surname>Freitag</surname><given-names>DF</given-names></name><name><surname>Gurdasani</surname><given-names>D</given-names></name><name><surname>Heikkilä</surname><given-names>K</given-names></name><name><surname>Hyppönen</surname><given-names>E</given-names></name><name><surname>Isaacs</surname><given-names>A</given-names></name><name><surname>Jackson</surname><given-names>AU</given-names></name><name><surname>Johansson</surname><given-names>Å</given-names></name><name><surname>Johnson</surname><given-names>T</given-names></name><name><surname>Kaakinen</surname><given-names>M</given-names></name><name><surname>Kettunen</surname><given-names>J</given-names></name><name><surname>Kleber</surname><given-names>ME</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Luan</surname><given-names>J</given-names></name><name><surname>Lyytikäinen</surname><given-names>L-P</given-names></name><name><surname>Magnusson</surname><given-names>PKE</given-names></name><name><surname>Mangino</surname><given-names>M</given-names></name><name><surname>Mihailov</surname><given-names>E</given-names></name><name><surname>Montasser</surname><given-names>ME</given-names></name><name><surname>Müller-Nurasyid</surname><given-names>M</given-names></name><name><surname>Nolte</surname><given-names>IM</given-names></name><name><surname>O’Connell</surname><given-names>JR</given-names></name><name><surname>Palmer</surname><given-names>CD</given-names></name><name><surname>Perola</surname><given-names>M</given-names></name><name><surname>Petersen</surname><given-names>A-K</given-names></name><name><surname>Sanna</surname><given-names>S</given-names></name><name><surname>Saxena</surname><given-names>R</given-names></name><name><surname>Service</surname><given-names>SK</given-names></name><name><surname>Shah</surname><given-names>S</given-names></name><name><surname>Shungin</surname><given-names>D</given-names></name><name><surname>Sidore</surname><given-names>C</given-names></name><name><surname>Song</surname><given-names>C</given-names></name><name><surname>Strawbridge</surname><given-names>RJ</given-names></name><name><surname>Surakka</surname><given-names>I</given-names></name><name><surname>Tanaka</surname><given-names>T</given-names></name><name><surname>Teslovich</surname><given-names>TM</given-names></name><name><surname>Thorleifsson</surname><given-names>G</given-names></name><name><surname>Van den Herik</surname><given-names>EG</given-names></name><name><surname>Voight</surname><given-names>BF</given-names></name><name><surname>Volcik</surname><given-names>KA</given-names></name><name><surname>Waite</surname><given-names>LL</given-names></name><name><surname>Wong</surname><given-names>A</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Absher</surname><given-names>D</given-names></name><name><surname>Asiki</surname><given-names>G</given-names></name><name><surname>Barroso</surname><given-names>I</given-names></name><name><surname>Been</surname><given-names>LF</given-names></name><name><surname>Bolton</surname><given-names>JL</given-names></name><name><surname>Bonnycastle</surname><given-names>LL</given-names></name><name><surname>Brambilla</surname><given-names>P</given-names></name><name><surname>Burnett</surname><given-names>MS</given-names></name><name><surname>Cesana</surname><given-names>G</given-names></name><name><surname>Dimitriou</surname><given-names>M</given-names></name><name><surname>Doney</surname><given-names>ASF</given-names></name><name><surname>Döring</surname><given-names>A</given-names></name><name><surname>Elliott</surname><given-names>P</given-names></name><name><surname>Epstein</surname><given-names>SE</given-names></name><name><surname>Eyjolfsson</surname><given-names>GI</given-names></name><name><surname>Gigante</surname><given-names>B</given-names></name><name><surname>Goodarzi</surname><given-names>MO</given-names></name><name><surname>Grallert</surname><given-names>H</given-names></name><name><surname>Gravito</surname><given-names>ML</given-names></name><name><surname>Groves</surname><given-names>CJ</given-names></name><name><surname>Hallmans</surname><given-names>G</given-names></name><name><surname>Hartikainen</surname><given-names>A-L</given-names></name><name><surname>Hayward</surname><given-names>C</given-names></name><name><surname>Hernandez</surname><given-names>D</given-names></name><name><surname>Hicks</surname><given-names>AA</given-names></name><name><surname>Holm</surname><given-names>H</given-names></name><name><surname>Hung</surname><given-names>Y-J</given-names></name><name><surname>Illig</surname><given-names>T</given-names></name><name><surname>Jones</surname><given-names>MR</given-names></name><name><surname>Kaleebu</surname><given-names>P</given-names></name><name><surname>Kastelein</surname><given-names>JJP</given-names></name><name><surname>Khaw</surname><given-names>K-T</given-names></name><name><surname>Kim</surname><given-names>E</given-names></name><name><surname>Klopp</surname><given-names>N</given-names></name><name><surname>Komulainen</surname><given-names>P</given-names></name><name><surname>Kumari</surname><given-names>M</given-names></name><name><surname>Langenberg</surname><given-names>C</given-names></name><name><surname>Lehtimäki</surname><given-names>T</given-names></name><name><surname>Lin</surname><given-names>S-Y</given-names></name><name><surname>Lindström</surname><given-names>J</given-names></name><name><surname>Loos</surname><given-names>RJF</given-names></name><name><surname>Mach</surname><given-names>F</given-names></name><name><surname>McArdle</surname><given-names>WL</given-names></name><name><surname>Meisinger</surname><given-names>C</given-names></name><name><surname>Mitchell</surname><given-names>BD</given-names></name><name><surname>Müller</surname><given-names>G</given-names></name><name><surname>Nagaraja</surname><given-names>R</given-names></name><name><surname>Narisu</surname><given-names>N</given-names></name><name><surname>Nieminen</surname><given-names>TVM</given-names></name><name><surname>Nsubuga</surname><given-names>RN</given-names></name><name><surname>Olafsson</surname><given-names>I</given-names></name><name><surname>Ong</surname><given-names>KK</given-names></name><name><surname>Palotie</surname><given-names>A</given-names></name><name><surname>Papamarkou</surname><given-names>T</given-names></name><name><surname>Pomilla</surname><given-names>C</given-names></name><name><surname>Pouta</surname><given-names>A</given-names></name><name><surname>Rader</surname><given-names>DJ</given-names></name><name><surname>Reilly</surname><given-names>MP</given-names></name><name><surname>Ridker</surname><given-names>PM</given-names></name><name><surname>Rivadeneira</surname><given-names>F</given-names></name><name><surname>Rudan</surname><given-names>I</given-names></name><name><surname>Ruokonen</surname><given-names>A</given-names></name><name><surname>Samani</surname><given-names>N</given-names></name><name><surname>Scharnagl</surname><given-names>H</given-names></name><name><surname>Seeley</surname><given-names>J</given-names></name><name><surname>Silander</surname><given-names>K</given-names></name><name><surname>Stančáková</surname><given-names>A</given-names></name><name><surname>Stirrups</surname><given-names>K</given-names></name><name><surname>Swift</surname><given-names>AJ</given-names></name><name><surname>Tiret</surname><given-names>L</given-names></name><name><surname>Uitterlinden</surname><given-names>AG</given-names></name><name><surname>van Pelt</surname><given-names>LJ</given-names></name><name><surname>Vedantam</surname><given-names>S</given-names></name><name><surname>Wainwright</surname><given-names>N</given-names></name><name><surname>Wijmenga</surname><given-names>C</given-names></name><name><surname>Wild</surname><given-names>SH</given-names></name><name><surname>Willemsen</surname><given-names>G</given-names></name><name><surname>Wilsgaard</surname><given-names>T</given-names></name><name><surname>Wilson</surname><given-names>JF</given-names></name><name><surname>Young</surname><given-names>EH</given-names></name><name><surname>Zhao</surname><given-names>JH</given-names></name><name><surname>Adair</surname><given-names>LS</given-names></name><name><surname>Arveiler</surname><given-names>D</given-names></name><name><surname>Assimes</surname><given-names>TL</given-names></name><name><surname>Bandinelli</surname><given-names>S</given-names></name><name><surname>Bennett</surname><given-names>F</given-names></name><name><surname>Bochud</surname><given-names>M</given-names></name><name><surname>Boehm</surname><given-names>BO</given-names></name><name><surname>Boomsma</surname><given-names>DI</given-names></name><name><surname>Borecki</surname><given-names>IB</given-names></name><name><surname>Bornstein</surname><given-names>SR</given-names></name><name><surname>Bovet</surname><given-names>P</given-names></name><name><surname>Burnier</surname><given-names>M</given-names></name><name><surname>Campbell</surname><given-names>H</given-names></name><name><surname>Chakravarti</surname><given-names>A</given-names></name><name><surname>Chambers</surname><given-names>JC</given-names></name><name><surname>Chen</surname><given-names>Y-DI</given-names></name><name><surname>Collins</surname><given-names>FS</given-names></name><name><surname>Cooper</surname><given-names>RS</given-names></name><name><surname>Danesh</surname><given-names>J</given-names></name><name><surname>Dedoussis</surname><given-names>G</given-names></name><name><surname>de Faire</surname><given-names>U</given-names></name><name><surname>Feranil</surname><given-names>AB</given-names></name><name><surname>Ferrières</surname><given-names>J</given-names></name><name><surname>Ferrucci</surname><given-names>L</given-names></name><name><surname>Freimer</surname><given-names>NB</given-names></name><name><surname>Gieger</surname><given-names>C</given-names></name><name><surname>Groop</surname><given-names>LC</given-names></name><name><surname>Gudnason</surname><given-names>V</given-names></name><name><surname>Gyllensten</surname><given-names>U</given-names></name><name><surname>Hamsten</surname><given-names>A</given-names></name><name><surname>Harris</surname><given-names>TB</given-names></name><name><surname>Hingorani</surname><given-names>A</given-names></name><name><surname>Hirschhorn</surname><given-names>JN</given-names></name><name><surname>Hofman</surname><given-names>A</given-names></name><name><surname>Hovingh</surname><given-names>GK</given-names></name><name><surname>Hsiung</surname><given-names>CA</given-names></name><name><surname>Humphries</surname><given-names>SE</given-names></name><name><surname>Hunt</surname><given-names>SC</given-names></name><name><surname>Hveem</surname><given-names>K</given-names></name><name><surname>Iribarren</surname><given-names>C</given-names></name><name><surname>Järvelin</surname><given-names>M-R</given-names></name><name><surname>Jula</surname><given-names>A</given-names></name><name><surname>Kähönen</surname><given-names>M</given-names></name><name><surname>Kaprio</surname><given-names>J</given-names></name><name><surname>Kesäniemi</surname><given-names>A</given-names></name><name><surname>Kivimaki</surname><given-names>M</given-names></name><name><surname>Kooner</surname><given-names>JS</given-names></name><name><surname>Koudstaal</surname><given-names>PJ</given-names></name><name><surname>Krauss</surname><given-names>RM</given-names></name><name><surname>Kuh</surname><given-names>D</given-names></name><name><surname>Kuusisto</surname><given-names>J</given-names></name><name><surname>Kyvik</surname><given-names>KO</given-names></name><name><surname>Laakso</surname><given-names>M</given-names></name><name><surname>Lakka</surname><given-names>TA</given-names></name><name><surname>Lind</surname><given-names>L</given-names></name><name><surname>Lindgren</surname><given-names>CM</given-names></name><name><surname>Martin</surname><given-names>NG</given-names></name><name><surname>März</surname><given-names>W</given-names></name><name><surname>McCarthy</surname><given-names>MI</given-names></name><name><surname>McKenzie</surname><given-names>CA</given-names></name><name><surname>Meneton</surname><given-names>P</given-names></name><name><surname>Metspalu</surname><given-names>A</given-names></name><name><surname>Moilanen</surname><given-names>L</given-names></name><name><surname>Morris</surname><given-names>AD</given-names></name><name><surname>Munroe</surname><given-names>PB</given-names></name><name><surname>Njølstad</surname><given-names>I</given-names></name><name><surname>Pedersen</surname><given-names>NL</given-names></name><name><surname>Power</surname><given-names>C</given-names></name><name><surname>Pramstaller</surname><given-names>PP</given-names></name><name><surname>Price</surname><given-names>JF</given-names></name><name><surname>Psaty</surname><given-names>BM</given-names></name><name><surname>Quertermous</surname><given-names>T</given-names></name><name><surname>Rauramaa</surname><given-names>R</given-names></name><name><surname>Saleheen</surname><given-names>D</given-names></name><name><surname>Salomaa</surname><given-names>V</given-names></name><name><surname>Sanghera</surname><given-names>DK</given-names></name><name><surname>Saramies</surname><given-names>J</given-names></name><name><surname>Schwarz</surname><given-names>PEH</given-names></name><name><surname>Sheu</surname><given-names>WH-H</given-names></name><name><surname>Shuldiner</surname><given-names>AR</given-names></name><name><surname>Siegbahn</surname><given-names>A</given-names></name><name><surname>Spector</surname><given-names>TD</given-names></name><name><surname>Stefansson</surname><given-names>K</given-names></name><name><surname>Strachan</surname><given-names>DP</given-names></name><name><surname>Tayo</surname><given-names>BO</given-names></name><name><surname>Tremoli</surname><given-names>E</given-names></name><name><surname>Tuomilehto</surname><given-names>J</given-names></name><name><surname>Uusitupa</surname><given-names>M</given-names></name><name><surname>van Duijn</surname><given-names>CM</given-names></name><name><surname>Vollenweider</surname><given-names>P</given-names></name><name><surname>Wallentin</surname><given-names>L</given-names></name><name><surname>Wareham</surname><given-names>NJ</given-names></name><name><surname>Whitfield</surname><given-names>JB</given-names></name><name><surname>Wolffenbuttel</surname><given-names>BHR</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Ordovas</surname><given-names>JM</given-names></name><name><surname>Boerwinkle</surname><given-names>E</given-names></name><name><surname>Palmer</surname><given-names>CNA</given-names></name><name><surname>Thorsteinsdottir</surname><given-names>U</given-names></name><name><surname>Chasman</surname><given-names>DI</given-names></name><name><surname>Rotter</surname><given-names>JI</given-names></name><name><surname>Franks</surname><given-names>PW</given-names></name><name><surname>Ripatti</surname><given-names>S</given-names></name><name><surname>Cupples</surname><given-names>LA</given-names></name><name><surname>Sandhu</surname><given-names>MS</given-names></name><name><surname>Rich</surname><given-names>SS</given-names></name><name><surname>Boehnke</surname><given-names>M</given-names></name><name><surname>Deloukas</surname><given-names>P</given-names></name><name><surname>Mohlke</surname><given-names>KL</given-names></name><name><surname>Ingelsson</surname><given-names>E</given-names></name><name><surname>Abecasis</surname><given-names>GR</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Neale</surname><given-names>BM</given-names></name><name><surname>Kathiresan</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Common variants associated with plasma triglycerides and risk for coronary artery disease</article-title><source>Nature Genetics</source><volume>45</volume><fpage>1345</fpage><lpage>1352</lpage><pub-id pub-id-type="doi">10.1038/ng.2795</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>H</given-names></name><name><surname>Mancuso</surname><given-names>N</given-names></name><name><surname>Gusev</surname><given-names>A</given-names></name><name><surname>Majumdar</surname><given-names>A</given-names></name><name><surname>Major</surname><given-names>M</given-names></name><name><surname>Pasaniuc</surname><given-names>B</given-names></name><name><surname>Kraft</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Leveraging expression from multiple tissues using sparse Canonical correlation analysis and aggregate tests improves the power of Transcriptome-wide Association studies</article-title><source>PLOS Genetics</source><volume>17</volume><elocation-id>e1008973</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1008973</pub-id><pub-id pub-id-type="pmid">33831007</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giambartolomei</surname><given-names>C</given-names></name><name><surname>Vukcevic</surname><given-names>D</given-names></name><name><surname>Schadt</surname><given-names>EE</given-names></name><name><surname>Franke</surname><given-names>L</given-names></name><name><surname>Hingorani</surname><given-names>AD</given-names></name><name><surname>Wallace</surname><given-names>C</given-names></name><name><surname>Plagnol</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Bayesian test for Colocalisation between pairs of genetic Association studies using summary Statistics</article-title><source>PLOS Genetics</source><volume>10</volume><elocation-id>e1004383</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004383</pub-id><pub-id pub-id-type="pmid">24830394</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname><given-names>AJ</given-names></name><name><surname>Burgess</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Pleiotropy robust methods for multivariable Mendelian randomization</article-title><source>Statistics in Medicine</source><volume>40</volume><fpage>5813</fpage><lpage>5830</lpage><pub-id pub-id-type="doi">10.1002/sim.9156</pub-id><pub-id pub-id-type="pmid">34342032</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>J</given-names></name><name><surname>James</surname><given-names>G</given-names></name><name><surname>Levina</surname><given-names>E</given-names></name><name><surname>Michailidis</surname><given-names>G</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Principal component analysis with sparse fused loadings</article-title><source>Journal of Computational and Graphical Statistics</source><volume>19</volume><fpage>930</fpage><lpage>946</lpage><pub-id pub-id-type="doi">10.1198/jcgs.2010.08127</pub-id><pub-id pub-id-type="pmid">25878487</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Heckert</surname><given-names>AQ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Qn scale</article-title><ext-link ext-link-type="uri" xlink:href="https://www.itl.nist.gov/div898/software/dataplot/refman2/auxillar/qn_scale.htm">https://www.itl.nist.gov/div898/software/dataplot/refman2/auxillar/qn_scale.htm</ext-link><date-in-citation iso-8601-date="2021-07-19">July 19, 2021</date-in-citation></element-citation></ref><ref id="bib20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jolliffe</surname><given-names>IT</given-names></name></person-group><year iso-8601-date="2002">2002</year><source>Principal Component Analysis</source><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib21"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Karageorgiou</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Sca_Mr</data-title><version designator="swh:1:rev:33a6b14e3083b370e7f0a209b18b45a26c5529f1">swh:1:rev:33a6b14e3083b370e7f0a209b18b45a26c5529f1</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:0ff23f2946d14b074e76b505c65eb735179a817c;origin=https://github.com/vaskarageorg/SCA_MR;visit=swh:1:snp:bffe46b97280ba65b8108e19823d5e5031318b56;anchor=swh:1:rev:33a6b14e3083b370e7f0a209b18b45a26c5529f1">https://archive.softwareheritage.org/swh:1:dir:0ff23f2946d14b074e76b505c65eb735179a817c;origin=https://github.com/vaskarageorg/SCA_MR;visit=swh:1:snp:bffe46b97280ba65b8108e19823d5e5031318b56;anchor=swh:1:rev:33a6b14e3083b370e7f0a209b18b45a26c5529f1</ext-link></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karlis</surname><given-names>D</given-names></name><name><surname>Saporta</surname><given-names>G</given-names></name><name><surname>Spinakis</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>A simple rule for the selection of principal components</article-title><source>Communications in Statistics - Theory and Methods</source><volume>32</volume><fpage>643</fpage><lpage>666</lpage><pub-id pub-id-type="doi">10.1081/STA-120018556</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kettunen</surname><given-names>J</given-names></name><name><surname>Demirkan</surname><given-names>A</given-names></name><name><surname>Würtz</surname><given-names>P</given-names></name><name><surname>Draisma</surname><given-names>HHM</given-names></name><name><surname>Haller</surname><given-names>T</given-names></name><name><surname>Rawal</surname><given-names>R</given-names></name><name><surname>Vaarhorst</surname><given-names>A</given-names></name><name><surname>Kangas</surname><given-names>AJ</given-names></name><name><surname>Lyytikäinen</surname><given-names>L-P</given-names></name><name><surname>Pirinen</surname><given-names>M</given-names></name><name><surname>Pool</surname><given-names>R</given-names></name><name><surname>Sarin</surname><given-names>A-P</given-names></name><name><surname>Soininen</surname><given-names>P</given-names></name><name><surname>Tukiainen</surname><given-names>T</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Tiainen</surname><given-names>M</given-names></name><name><surname>Tynkkynen</surname><given-names>T</given-names></name><name><surname>Amin</surname><given-names>N</given-names></name><name><surname>Zeller</surname><given-names>T</given-names></name><name><surname>Beekman</surname><given-names>M</given-names></name><name><surname>Deelen</surname><given-names>J</given-names></name><name><surname>van Dijk</surname><given-names>KW</given-names></name><name><surname>Esko</surname><given-names>T</given-names></name><name><surname>Hottenga</surname><given-names>J-J</given-names></name><name><surname>van Leeuwen</surname><given-names>EM</given-names></name><name><surname>Lehtimäki</surname><given-names>T</given-names></name><name><surname>Mihailov</surname><given-names>E</given-names></name><name><surname>Rose</surname><given-names>RJ</given-names></name><name><surname>de Craen</surname><given-names>AJM</given-names></name><name><surname>Gieger</surname><given-names>C</given-names></name><name><surname>Kähönen</surname><given-names>M</given-names></name><name><surname>Perola</surname><given-names>M</given-names></name><name><surname>Blankenberg</surname><given-names>S</given-names></name><name><surname>Savolainen</surname><given-names>MJ</given-names></name><name><surname>Verhoeven</surname><given-names>A</given-names></name><name><surname>Viikari</surname><given-names>J</given-names></name><name><surname>Willemsen</surname><given-names>G</given-names></name><name><surname>Boomsma</surname><given-names>DI</given-names></name><name><surname>van Duijn</surname><given-names>CM</given-names></name><name><surname>Eriksson</surname><given-names>J</given-names></name><name><surname>Jula</surname><given-names>A</given-names></name><name><surname>Järvelin</surname><given-names>M-R</given-names></name><name><surname>Kaprio</surname><given-names>J</given-names></name><name><surname>Metspalu</surname><given-names>A</given-names></name><name><surname>Raitakari</surname><given-names>O</given-names></name><name><surname>Salomaa</surname><given-names>V</given-names></name><name><surname>Slagboom</surname><given-names>PE</given-names></name><name><surname>Waldenberger</surname><given-names>M</given-names></name><name><surname>Ripatti</surname><given-names>S</given-names></name><name><surname>Ala-Korpela</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Genome-wide study for circulating metabolites identifies 62 Loci and reveals novel systemic effects of LPA</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>11122</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms11122</pub-id><pub-id pub-id-type="pmid">27005778</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D</given-names></name><name><surname>Kim</surname><given-names>SK</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Comparing patterns of component loadings: Principal component analysis (PCA) versus independent component analysis (ICA) in analyzing multivariate non-normal data</article-title><source>Behavior Research Methods</source><volume>44</volume><fpage>1239</fpage><lpage>1243</lpage><pub-id pub-id-type="doi">10.3758/s13428-012-0193-1</pub-id><pub-id pub-id-type="pmid">22351614</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kontush</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>HDL particle number and size as predictors of cardiovascular disease</article-title><source>Frontiers in Pharmacology</source><volume>6</volume><elocation-id>218</elocation-id><pub-id pub-id-type="doi">10.3389/fphar.2015.00218</pub-id><pub-id pub-id-type="pmid">26500551</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>CP</given-names></name><name><surname>Goel</surname><given-names>A</given-names></name><name><surname>Butterworth</surname><given-names>AS</given-names></name><name><surname>Kanoni</surname><given-names>S</given-names></name><name><surname>Webb</surname><given-names>TR</given-names></name><name><surname>Marouli</surname><given-names>E</given-names></name><name><surname>Zeng</surname><given-names>L</given-names></name><name><surname>Ntalla</surname><given-names>I</given-names></name><name><surname>Lai</surname><given-names>FY</given-names></name><name><surname>Hopewell</surname><given-names>JC</given-names></name><name><surname>Giannakopoulou</surname><given-names>O</given-names></name><name><surname>Jiang</surname><given-names>T</given-names></name><name><surname>Hamby</surname><given-names>SE</given-names></name><name><surname>Di Angelantonio</surname><given-names>E</given-names></name><name><surname>Assimes</surname><given-names>TL</given-names></name><name><surname>Bottinger</surname><given-names>EP</given-names></name><name><surname>Chambers</surname><given-names>JC</given-names></name><name><surname>Clarke</surname><given-names>R</given-names></name><name><surname>Palmer</surname><given-names>CNA</given-names></name><name><surname>Cubbon</surname><given-names>RM</given-names></name><name><surname>Ellinor</surname><given-names>P</given-names></name><name><surname>Ermel</surname><given-names>R</given-names></name><name><surname>Evangelou</surname><given-names>E</given-names></name><name><surname>Franks</surname><given-names>PW</given-names></name><name><surname>Grace</surname><given-names>C</given-names></name><name><surname>Gu</surname><given-names>D</given-names></name><name><surname>Hingorani</surname><given-names>AD</given-names></name><name><surname>Howson</surname><given-names>JMM</given-names></name><name><surname>Ingelsson</surname><given-names>E</given-names></name><name><surname>Kastrati</surname><given-names>A</given-names></name><name><surname>Kessler</surname><given-names>T</given-names></name><name><surname>Kyriakou</surname><given-names>T</given-names></name><name><surname>Lehtimäki</surname><given-names>T</given-names></name><name><surname>Lu</surname><given-names>X</given-names></name><name><surname>Lu</surname><given-names>Y</given-names></name><name><surname>März</surname><given-names>W</given-names></name><name><surname>McPherson</surname><given-names>R</given-names></name><name><surname>Metspalu</surname><given-names>A</given-names></name><name><surname>Pujades-Rodriguez</surname><given-names>M</given-names></name><name><surname>Ruusalepp</surname><given-names>A</given-names></name><name><surname>Schadt</surname><given-names>EE</given-names></name><name><surname>Schmidt</surname><given-names>AF</given-names></name><name><surname>Sweeting</surname><given-names>MJ</given-names></name><name><surname>Zalloua</surname><given-names>PA</given-names></name><name><surname>AlGhalayini</surname><given-names>K</given-names></name><name><surname>Keavney</surname><given-names>BD</given-names></name><name><surname>Kooner</surname><given-names>JS</given-names></name><name><surname>Loos</surname><given-names>RJF</given-names></name><name><surname>Patel</surname><given-names>RS</given-names></name><name><surname>Rutter</surname><given-names>MK</given-names></name><name><surname>Tomaszewski</surname><given-names>M</given-names></name><name><surname>Tzoulaki</surname><given-names>I</given-names></name><name><surname>Zeggini</surname><given-names>E</given-names></name><name><surname>Erdmann</surname><given-names>J</given-names></name><name><surname>Dedoussis</surname><given-names>G</given-names></name><name><surname>Björkegren</surname><given-names>JLM</given-names></name><name><surname>Schunkert</surname><given-names>H</given-names></name><name><surname>Farrall</surname><given-names>M</given-names></name><name><surname>Danesh</surname><given-names>J</given-names></name><name><surname>Samani</surname><given-names>NJ</given-names></name><name><surname>Watkins</surname><given-names>H</given-names></name><name><surname>Deloukas</surname><given-names>P</given-names></name><collab>EPIC-CVD Consortium</collab><collab>CARDIoGRAMplusC4D</collab><collab>UK Biobank CardioMetabolic Consortium CHD working group</collab></person-group><year iso-8601-date="2017">2017</year><article-title>Association analyses based on false discovery rate implicate new Loci for coronary artery disease</article-title><source>Nature Genetics</source><volume>49</volume><fpage>1385</fpage><lpage>1391</lpage><pub-id pub-id-type="doi">10.1038/ng.3913</pub-id><pub-id pub-id-type="pmid">28714975</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reitsma</surname><given-names>JB</given-names></name><name><surname>Glas</surname><given-names>AS</given-names></name><name><surname>Rutjes</surname><given-names>AWS</given-names></name><name><surname>Scholten</surname><given-names>RJPM</given-names></name><name><surname>Bossuyt</surname><given-names>PM</given-names></name><name><surname>Zwinderman</surname><given-names>AH</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Bivariate analysis of sensitivity and specificity produces informative summary measures in diagnostic reviews</article-title><source>Journal of Clinical Epidemiology</source><volume>58</volume><fpage>982</fpage><lpage>990</lpage><pub-id pub-id-type="doi">10.1016/j.jclinepi.2005.02.022</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rousseeuw</surname><given-names>PJ</given-names></name><name><surname>Croux</surname><given-names>C</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Alternatives to the median absolute deviation</article-title><source>Journal of the American Statistical Association</source><volume>88</volume><fpage>1273</fpage><lpage>1283</lpage><pub-id pub-id-type="doi">10.1080/01621459.1993.10476408</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>E</given-names></name><name><surname>Davey Smith</surname><given-names>G</given-names></name><name><surname>Windmeijer</surname><given-names>F</given-names></name><name><surname>Bowden</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>An examination of multivariable Mendelian randomization in the single-sample and two-sample summary data settings</article-title><source>International Journal of Epidemiology</source><volume>48</volume><fpage>713</fpage><lpage>727</lpage><pub-id pub-id-type="doi">10.1093/ije/dyy262</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>E</given-names></name><name><surname>Spiller</surname><given-names>W</given-names></name><name><surname>Bowden</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Testing and Correcting for Weak and Pleiotropic Instruments in Two-Sample Multivariable Mendelian Randomisation</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.04.02.021980</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>GD</given-names></name><name><surname>Ebrahim</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Mendelian randomization: Can genetic epidemiology contribute to understanding environmental determinants of disease</article-title><source>International Journal of Epidemiology</source><volume>32</volume><fpage>1</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1093/ije/dyg070</pub-id><pub-id pub-id-type="pmid">12689998</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sulc</surname><given-names>J</given-names></name><name><surname>Sonrel</surname><given-names>A</given-names></name><name><surname>Mounier</surname><given-names>N</given-names></name><name><surname>Auwerx</surname><given-names>C</given-names></name><name><surname>Marouli</surname><given-names>E</given-names></name><name><surname>Darrous</surname><given-names>L</given-names></name><name><surname>Draganski</surname><given-names>B</given-names></name><name><surname>Kilpeläinen</surname><given-names>TO</given-names></name><name><surname>Joshi</surname><given-names>P</given-names></name><name><surname>Loos</surname><given-names>RJF</given-names></name><name><surname>Kutalik</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Composite Trait Mendelian Randomization Reveals Distinct Metabolic and Lifestyle Consequences of Differences in Body Shape</article-title><source>medRxiv</source><pub-id pub-id-type="doi">10.1101/2020.09.03.20187567</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Velicer</surname><given-names>WF</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Determining the number of components from the matrix of partial correlations</article-title><source>Psychometrika</source><volume>41</volume><fpage>321</fpage><lpage>327</lpage><pub-id pub-id-type="doi">10.1007/BF02293557</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vilhjálmsson</surname><given-names>BJ</given-names></name><name><surname>Nordborg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The nature of confounding in genome-wide Association studies</article-title><source>Nature Reviews. Genetics</source><volume>14</volume><fpage>1</fpage><lpage>2</lpage><pub-id pub-id-type="doi">10.1038/nrg3382</pub-id><pub-id pub-id-type="pmid">23165185</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Xie</surname><given-names>Z</given-names></name><name><surname>Tian</surname><given-names>J</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Hou</surname><given-names>J</given-names></name><name><surname>Yu</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Small HDL Subclass is associated with coronary plaque stability: An optical coherence tomography study in patients with coronary artery disease</article-title><source>Journal of Clinical Lipidology</source><volume>13</volume><fpage>326</fpage><lpage>334</lpage><pub-id pub-id-type="doi">10.1016/j.jacl.2018.12.002</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Zhao</surname><given-names>Q</given-names></name><name><surname>Bowden</surname><given-names>J</given-names></name><name><surname>Hemani</surname><given-names>G</given-names></name><name><surname>Davey Smith</surname><given-names>G</given-names></name><name><surname>Small</surname><given-names>DS</given-names></name><name><surname>Zhang</surname><given-names>NR</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Causal inference for Heritable Phenotypic risk factors using heterogeneous genetic instruments</article-title><source>PLOS Genetics</source><volume>17</volume><elocation-id>e1009575</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1009575</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Witten</surname><given-names>D</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>PMA: Penalized multivariate analysis</data-title><version designator="1.2.1">1.2.1</version><source>R Package</source></element-citation></ref><ref id="bib38"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Yavorska</surname><given-names>O</given-names></name><name><surname>Staley</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Mendelianrandomization: Mendelian randomization package</data-title><version designator="0.5.0">0.5.0</version><source>R Package</source></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Miao</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>NR</given-names></name><name><surname>Hennessy</surname><given-names>S</given-names></name><name><surname>Small</surname><given-names>DS</given-names></name><name><surname>Rader</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A Mendelian randomization study of the role of lipoprotein Subfractions in coronary artery disease</article-title><source>eLife</source><volume>10</volume><elocation-id>e58361</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.58361</pub-id><pub-id pub-id-type="pmid">33899735</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>H</given-names></name><name><surname>Hastie</surname><given-names>T</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Sparse principal component analysis</article-title><source>Journal of Computational and Graphical Statistics</source><volume>15</volume><fpage>265</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1198/106186006X113430</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>H</given-names></name><name><surname>Xue</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A selective overview of sparse principal component analysis</article-title><source>Proceedings of the IEEE</source><volume>106</volume><fpage>1311</fpage><lpage>1320</lpage><pub-id pub-id-type="doi">10.1109/JPROC.2018.2846588</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zuber</surname><given-names>V</given-names></name><name><surname>Colijn</surname><given-names>JM</given-names></name><name><surname>Klaver</surname><given-names>C</given-names></name><name><surname>Burgess</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020a</year><article-title>Selecting likely causal risk factors from high-throughput experiments using multivariable Mendelian randomization</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>29</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-13870-3</pub-id><pub-id pub-id-type="pmid">31911605</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Zuber</surname><given-names>V</given-names></name><name><surname>Gill</surname><given-names>D</given-names></name><name><surname>Ala-Korpela</surname><given-names>M</given-names></name><name><surname>Langenberg</surname><given-names>C</given-names></name><name><surname>Butterworth</surname><given-names>A</given-names></name><name><surname>Bottolo</surname><given-names>L</given-names></name><name><surname>Burgess</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020b</year><article-title>High-Throughput Multivariable Mendelian Randomization Analysis Prioritizes Apolipoprotein B as Key Lipid Risk Factor for Coronary Artery Disease</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.02.10.20021691</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Instrument strength</title><p>Since we transform <inline-formula><mml:math id="inf145"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and obtain a matrix of lower dimensionality, formula (<xref ref-type="disp-formula" rid="equ7">Equation 4</xref>) can’t be used as there is no longer a one-to-one correspondence of the <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> with the PCs. Likewise, a conditional <italic>F</italic>-statistic for the PCs also cannot be computed for this reason. We aim to arrive at a modified formula that bypasses this issue. For this purpose, we take advantage of two concepts, first an expression of the <italic>F</italic>-statistic for an exposure <inline-formula><mml:math id="inf147"><mml:mi>k</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf148"><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>) in matrix notation and, second, the use of this expression to estimate <italic>F</italic>-statistics for the PCs (<inline-formula><mml:math id="inf149"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) from <inline-formula><mml:math id="inf150"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> decomposition.</p><p>We make the assumption that the uncertainty in the <inline-formula><mml:math id="inf151"><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> estimates is similar in all <inline-formula><mml:math id="inf152"><mml:mi>K</mml:mi></mml:math></inline-formula> exposures, that is <inline-formula><mml:math id="inf153"><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> uncertainty estimates do not substantially differ among exposures. This is not implausible as the uncertainty is predominantly driven by sample size and minor allele frequency (<xref ref-type="bibr" rid="bib16">Giambartolomei et al., 2014</xref>). Specifically, the authors of <xref ref-type="bibr" rid="bib16">Giambartolomei et al., 2014</xref>, show that<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where MAF is the minor allele frequency, <italic>n</italic><sub><italic>k</italic></sub> is the sample size in exposure <inline-formula><mml:math id="inf154"><mml:mi>k</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf155"><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the phenotypic variance. What this means is that, in experiments such as <xref ref-type="bibr" rid="bib23">Kettunen et al., 2016</xref>, where <italic>n</italic><sub><italic>k</italic></sub> is the same across all exposures and <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be standardised to 1, the main driver of differences in <inline-formula><mml:math id="inf157"><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>X</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is differences in MAF. As MAF is the same for each SNP across all exposures, the collation of SEs across exposures per SNP is well motivated.</p><p>We can then define a matrix <inline-formula><mml:math id="inf158"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> as follows.<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mover><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mover><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="thickmathspace"/><mml:mrow><mml:mover><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mi>K</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The elements in the diagonal represent the mean variance of <inline-formula><mml:math id="inf159"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> for each SNP and all off-diagonal elements are zero. What is achieved through this is a summary of the uncertainty in the SNP-<inline-formula><mml:math id="inf160"><mml:mi>X</mml:mi></mml:math></inline-formula> associations that is not sensitive on the dimensions of the exposures. Instead of <xref ref-type="disp-formula" rid="equ7">Equation 4</xref>, we can then express the vector of the mean <inline-formula><mml:math id="inf161"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistics for each exposure <inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as<disp-formula id="equ10"><label>(5)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac><mml:mo>×</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:munder><mml:msup><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:munder><mml:mo>×</mml:mo><mml:munder><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:munder><mml:mo>×</mml:mo><mml:munder><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf163"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is the <italic>matrix</italic> of the SNP-exposure associations. In a simulation study, we generate data under the mechanism in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1a</xref>. The strength of association is different in the three exposures. It is observed that the estimates with both methods (<xref ref-type="disp-formula" rid="equ10">Equation 5</xref> and <xref ref-type="disp-formula" rid="equ7">Equation 4</xref>) align well (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1b</xref>), supporting the equivalence of the two formulae.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Simplified F-statistic Estimation.</title><p>(<bold>a</bold>) Data generating mechanism. Three exposures with different degrees of strength of association with <inline-formula><mml:math id="inf164"><mml:mi>G</mml:mi></mml:math></inline-formula> are generated <inline-formula><mml:math id="inf165"><mml:mrow><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>b</bold>) <inline-formula><mml:math id="inf166"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistic for the three exposures <inline-formula><mml:math id="inf167"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> as estimated by the formulae in <xref ref-type="disp-formula" rid="equ10">Equation 5</xref> (horizontal axis) and <xref ref-type="disp-formula" rid="equ7">Equation 4</xref> (vertical axis).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig1-v2.tif"/></fig><p>Our second aim is to use this matrix notation formula for the <italic>F</italic>-statistic to quantify the instrument strength of each PC with the respective <italic>F</italic>-statistic (<inline-formula><mml:math id="inf168"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). As presented above, we are not limited by the dimensions of point estimates and uncertainty matching exactly and we can use the formula in <xref ref-type="disp-formula" rid="equ10">Equation 5</xref> and substitute <inline-formula><mml:math id="inf169"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> with the PCs. For the PCA approach, where we decompose <inline-formula><mml:math id="inf170"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> as <inline-formula><mml:math id="inf171"><mml:mrow><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and carry forward <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>&lt;&lt;</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> non-trivial PCs, we use the matrix <inline-formula><mml:math id="inf173"><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> in place of <inline-formula><mml:math id="inf174"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. Then, the mean <inline-formula><mml:math id="inf175"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be estimated as follows.<disp-formula id="equ11"><label>(6)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac><mml:mo>×</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:munder><mml:mrow><mml:mi>U</mml:mi><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:munder><mml:mo>×</mml:mo><mml:munder><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:munder><mml:mo>×</mml:mo><mml:munder><mml:mrow><mml:mi>U</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The vector <inline-formula><mml:math id="inf176"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> contains the <inline-formula><mml:math id="inf177"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> statistics for the <inline-formula><mml:math id="inf178"><mml:mi>M</mml:mi></mml:math></inline-formula> PCs. In a similar manner, we estimate <inline-formula><mml:math id="inf179"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for the sPCA methods but, instead of the scores matrix <inline-formula><mml:math id="inf180"><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula>, we use the scores of the sparse methods. We illustrate the performance of this approach in a simulation study with an identical configuration for exposure generation as the one presented in <xref ref-type="fig" rid="fig5">Figure 5</xref>. In a configuration with <inline-formula><mml:math id="inf181"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> blocks of <inline-formula><mml:math id="inf182"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> genetically correlated exposures (<xref ref-type="fig" rid="fig4">Figure 4</xref>), we vary the strength of association <inline-formula><mml:math id="inf183"><mml:mi>γ</mml:mi></mml:math></inline-formula> per block. This way, the first block has the highest strength of association and the last block the lowest, quantified by a lower mean <italic>F</italic>-statistic in the exposures of this block (red, <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>). The instrument strength of the PCs and the sPCs follow closely the corresponding <italic>F</italic>-statistics of the individual exposures; in other words, in a PC of five exposures, <inline-formula><mml:math id="inf184"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf185"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf186"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> align well (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>).</p><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Distributions of the <italic>F</italic>-statistics in principal component analysis (PCA) methods and individual (not transformed) exposures.</title><p>Exposure data in different blocks are simulated with a decreasing strength of association and the correlated blocks map to principal components (PCs). Each distribution represents the <italic>F</italic>-statistics for each PC. In the case of the individual exposures (red), the distributions represent the <italic>F</italic>-statistics for the corresponding exposures. Individual: individual exposures without any transformation; PCA: <italic>F</italic>-statistics for PCA; SCA: sparse component analysis (<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>) sPCA: sparse PCA as described by <xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig2-v2.tif"/></fig></sec><sec sec-type="appendix" id="s9"><title>MVMR and UVMR</title><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Multivariable Mendelian randomisation (MVMR) and univariable MR (UVMR) estimates.</title><p>Only ApoB is strongly associated with coronary heart disease (CHD). All SEs are larger in the MVMR model (range of <inline-formula><mml:math id="inf187"><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mn>2.7</mml:mn><mml:mo>-</mml:mo><mml:mn>225.96</mml:mn></mml:mrow></mml:math></inline-formula>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig3-v2.tif"/></fig></sec><sec sec-type="appendix" id="s10"><title>MVMR with PC scores</title><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title>Estimated causal effects of principal components (PCs) on coronary heart disease (CHD) risk.</title><p>PCA: principal component analysis; SCA: sparse component analysis; sPCA: sparse PCA (<xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>); RSPCA: robust sparse PCA.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">PC</th><th align="left" valign="bottom">Method</th><th align="left" valign="bottom">OR</th><th align="left" valign="bottom">LCI</th><th align="left" valign="bottom">UCI</th></tr></thead><tbody><tr><td align="left" valign="bottom">PC1</td><td align="left" valign="bottom">PCA</td><td align="char" char="." valign="bottom">1.002</td><td align="char" char="." valign="bottom">1.0015</td><td align="char" char="." valign="bottom">1.0024</td></tr><tr><td align="left" valign="bottom">PC2</td><td align="left" valign="bottom">PCA</td><td align="char" char="." valign="bottom">1.0002</td><td align="char" char="." valign="bottom">0.9995</td><td align="char" char="." valign="bottom">1.001</td></tr><tr><td align="left" valign="bottom">PC3</td><td align="left" valign="bottom">PCA</td><td align="char" char="." valign="bottom">1.0013</td><td align="char" char="." valign="bottom">1.0001</td><td align="char" char="." valign="bottom">1.0024</td></tr><tr><td align="left" valign="bottom">PC4</td><td align="left" valign="bottom">PCA</td><td align="char" char="." valign="bottom">0.9985</td><td align="char" char="." valign="bottom">0.997</td><td align="char" char="." valign="bottom">0.9999</td></tr><tr><td align="left" valign="bottom">PC5</td><td align="left" valign="bottom">PCA</td><td align="char" char="." valign="bottom">0.9999</td><td align="char" char="." valign="bottom">0.9978</td><td align="char" char="." valign="bottom">1.002</td></tr><tr><td align="left" valign="bottom">PC6</td><td align="left" valign="bottom">PCA</td><td align="char" char="." valign="bottom">0.9993</td><td align="char" char="." valign="bottom">0.9976</td><td align="char" char="." valign="bottom">1.0009</td></tr><tr><td align="left" valign="bottom">PC1</td><td align="left" valign="bottom">SCA</td><td align="char" char="." valign="bottom">1.0027</td><td align="char" char="." valign="bottom">1.0005</td><td align="char" char="." valign="bottom">1.0049</td></tr><tr><td align="left" valign="bottom">PC2</td><td align="left" valign="bottom">SCA</td><td align="char" char="." valign="bottom">1.0027</td><td align="char" char="." valign="bottom">1.0004</td><td align="char" char="." valign="bottom">1.005</td></tr><tr><td align="left" valign="bottom">PC3</td><td align="left" valign="bottom">SCA</td><td align="char" char="." valign="bottom">0.9997</td><td align="char" char="." valign="bottom">0.9976</td><td align="char" char="." valign="bottom">1.0019</td></tr><tr><td align="left" valign="bottom">PC4</td><td align="left" valign="bottom">SCA</td><td align="char" char="." valign="bottom">0.9965</td><td align="char" char="." valign="bottom">0.9941</td><td align="char" char="." valign="bottom">0.9989</td></tr><tr><td align="left" valign="bottom">PC5</td><td align="left" valign="bottom">SCA</td><td align="char" char="." valign="bottom">1.0002</td><td align="char" char="." valign="bottom">0.998</td><td align="char" char="." valign="bottom">1.0024</td></tr><tr><td align="left" valign="bottom">PC6</td><td align="left" valign="bottom">SCA</td><td align="char" char="." valign="bottom">1.0034</td><td align="char" char="." valign="bottom">0.9989</td><td align="char" char="." valign="bottom">1.0078</td></tr><tr><td align="left" valign="bottom">PC1</td><td align="left" valign="bottom">sPCA</td><td align="char" char="." valign="bottom">1.0019</td><td align="char" char="." valign="bottom">0.9999</td><td align="char" char="." valign="bottom">1.0039</td></tr><tr><td align="left" valign="bottom">PC2</td><td align="left" valign="bottom">sPCA</td><td align="char" char="." valign="bottom">1.0003</td><td align="char" char="." valign="bottom">0.9986</td><td align="char" char="." valign="bottom">1.002</td></tr><tr><td align="left" valign="bottom">PC3</td><td align="left" valign="bottom">sPCA</td><td align="char" char="." valign="bottom">0.9988</td><td align="char" char="." valign="bottom">0.997</td><td align="char" char="." valign="bottom">1.0005</td></tr><tr><td align="left" valign="bottom">PC4</td><td align="left" valign="bottom">sPCA</td><td align="char" char="." valign="bottom">0.9975</td><td align="char" char="." valign="bottom">0.9955</td><td align="char" char="." valign="bottom">0.9995</td></tr><tr><td align="left" valign="bottom">PC5</td><td align="left" valign="bottom">sPCA</td><td align="char" char="." valign="bottom">0.998</td><td align="char" char="." valign="bottom">0.9954</td><td align="char" char="." valign="bottom">1.0006</td></tr><tr><td align="left" valign="bottom">PC6</td><td align="left" valign="bottom">sPCA</td><td align="char" char="." valign="bottom">0.9998</td><td align="char" char="." valign="bottom">0.9982</td><td align="char" char="." valign="bottom">1.0014</td></tr><tr><td align="left" valign="bottom">PC1</td><td align="left" valign="bottom">RSPCA</td><td align="char" char="." valign="bottom">1.0017</td><td align="char" char="." valign="bottom">1.0006</td><td align="char" char="." valign="bottom">1.0027</td></tr><tr><td align="left" valign="bottom">PC2</td><td align="left" valign="bottom">RSPCA</td><td align="char" char="." valign="bottom">0.9998</td><td align="char" char="." valign="bottom">0.9983</td><td align="char" char="." valign="bottom">1.0013</td></tr><tr><td align="left" valign="bottom">PC3</td><td align="left" valign="bottom">RSPCA</td><td align="char" char="." valign="bottom">0.9954</td><td align="char" char="." valign="bottom">0.9918</td><td align="char" char="." valign="bottom">0.999</td></tr><tr><td align="left" valign="bottom">PC4</td><td align="left" valign="bottom">RSPCA</td><td align="char" char="." valign="bottom">0.9989</td><td align="char" char="." valign="bottom">0.9969</td><td align="char" char="." valign="bottom">1.0008</td></tr><tr><td align="left" valign="bottom">PC5</td><td align="left" valign="bottom">RSPCA</td><td align="char" char="." valign="bottom">0.9944</td><td align="char" char="." valign="bottom">0.9903</td><td align="char" char="." valign="bottom">0.9986</td></tr><tr><td align="left" valign="bottom">PC6</td><td align="left" valign="bottom">RSPCA</td><td align="char" char="." valign="bottom">1.01</td><td align="char" char="." valign="bottom">1.0013</td><td align="char" char="." valign="bottom">1.0188</td></tr><tr><td align="left" valign="bottom">PC1</td><td align="left" valign="bottom">SFPCA</td><td align="char" char="." valign="bottom">1.002</td><td align="char" char="." valign="bottom">1.0015</td><td align="char" char="." valign="bottom">1.0025</td></tr><tr><td align="left" valign="bottom">PC2</td><td align="left" valign="bottom">SFPCA</td><td align="char" char="." valign="bottom">0.9991</td><td align="char" char="." valign="bottom">0.9979</td><td align="char" char="." valign="bottom">1.0004</td></tr><tr><td align="left" valign="bottom">PC3</td><td align="left" valign="bottom">SFPCA</td><td align="char" char="." valign="bottom">0.9998</td><td align="char" char="." valign="bottom">0.9991</td><td align="char" char="." valign="bottom">1.0006</td></tr><tr><td align="left" valign="bottom">PC4</td><td align="left" valign="bottom">SFPCA</td><td align="char" char="." valign="bottom">0.9982</td><td align="char" char="." valign="bottom">0.9967</td><td align="char" char="." valign="bottom">0.9997</td></tr><tr><td align="left" valign="bottom">PC5</td><td align="left" valign="bottom">SFPCA</td><td align="char" char="." valign="bottom">1.0001</td><td align="char" char="." valign="bottom">0.9977</td><td align="char" char="." valign="bottom">1.0025</td></tr><tr><td align="left" valign="bottom">PC6</td><td align="left" valign="bottom">SFPCA</td><td align="char" char="." valign="bottom">1.0009</td><td align="char" char="." valign="bottom">0.9985</td><td align="char" char="." valign="bottom">1.0033</td></tr></tbody></table></table-wrap></sec><sec sec-type="appendix" id="s11"><title>MVMR with IVW and GRAPPLE</title><p>A small negative effect for M.LDL.PL is noted as nominally significant in <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>. This is not concordant with the UVMR direction of effect. In GRAPPLE, no traits surpass the nominal significance threshold.</p><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Multivariable Mendelian randomisation (MVMR) with IVW (left) and MVMR with GRAPPLE (<xref ref-type="bibr" rid="bib39">Zhao et al., 2021</xref>) (right).</title><p>Only the 66 exposures. that are significant in univariable MR (UVMR) are put forward in these models. In IVW (left), ApoB shows nominal significance. In MR GRAPPLE (right), apolipoprotein B has the lowest p-value but no trait reaches nominal significance.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig4-v2.tif"/></fig><fig id="app1fig5" position="float"><label>Appendix 1—figure 5.</label><caption><title><inline-formula><mml:math id="inf188"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistics for principal components (PCs) and sparse PCs.</title><p>The formula derived in <xref ref-type="disp-formula" rid="equ10">Equation 5</xref> is used. Black: principal component analysis (PCA) (no sparsity constraints); yellow: sparse component analysis (SCA); red: sparse PCA (Zou); blue: sparse robust PCA; green: sparse fused PCA. The dashed line represents the cutoff of 10 that is considered the minimum desired <inline-formula><mml:math id="inf189"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistic for an exposure to be considered well instrumented. The green line diverges from the pattern of decreasing instrument strength but, when referring to the loadings heatmap (<xref ref-type="fig" rid="fig2">Figure 2</xref>), it can be observed that the 4th sparse PC in the fused sPCA receives negative loadings from multiple very low-density lipoprotein (VLDL)- and low-density lipoprotein (LDL)-related traits. This may in turn cause the large <inline-formula><mml:math id="inf190"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistic.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig5-v2.tif"/></fig><fig id="app1fig6" position="float"><label>Appendix 1—figure 6.</label><caption><title>Bayesian information criterion (BIC) for different numbers of metabolites regularized to 0.</title><p>The lowest value is achieved for one non-zero exposure per component. However, six non-zero exposures per component also achieved a similar low BIC and this was selected.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig6-v2.tif"/></fig><fig id="app1fig7" position="float"><label>Appendix 1—figure 7.</label><caption><title>Trajectories for the loadings of total cholesterol in low-density lipoprotein (LDL) and ApoB in all methods.</title><p>Principal component analysis (PCA) loadings imply a contribution of LDL.c and ApoB to all principal components (PCs). In the sparse methods, this is limited to one PC (two for RSPCA).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig7-v2.tif"/></fig></sec><sec sec-type="appendix" id="s12"><title>Simulation study design</title><p>We generate a minor allele frequency <inline-formula><mml:math id="inf191"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and an unmeasured confounder <inline-formula><mml:math id="inf192"><mml:mrow><mml:mi>U</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Conditionally on the MAF, we generate the genes <inline-formula><mml:math id="inf193"><mml:mrow><mml:mi>G</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. We define <inline-formula><mml:math id="inf194"><mml:mi>Q</mml:mi></mml:math></inline-formula> blocks and divide the <inline-formula><mml:math id="inf195"><mml:mi>P</mml:mi></mml:math></inline-formula> genes of <inline-formula><mml:math id="inf196"><mml:mi>G</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf197"><mml:mi>q</mml:mi></mml:math></inline-formula> blocks, each containing <inline-formula><mml:math id="inf198"><mml:mrow><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> genes. This approach aims to model the biological phenomenon of multiple traits being influenced by a common set of variants. For instance, the traits of LDL cholesterol content and LDL phospholipid content appear to be associated with the variants in a largely similar manner (<xref ref-type="bibr" rid="bib23">Kettunen et al., 2016</xref>).</p><p>For each block <inline-formula><mml:math id="inf199"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, we define a matrix <inline-formula><mml:math id="inf200"><mml:msub><mml:mi>γ</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula> whose elements <inline-formula><mml:math id="inf201"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are non-zero and <inline-formula><mml:math id="inf202"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. This matrix is what will direct only certain variants to influence certain exposures, leading to multicollinearity. We then generate the <inline-formula><mml:math id="inf203"><mml:mi>K</mml:mi></mml:math></inline-formula> exposures sequentially per block, following the parametric equation <inline-formula><mml:math id="inf204"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi>U</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This way, specific genetic variants generate blocks of exposures as shown in <xref ref-type="fig" rid="fig4">Figure 4</xref> and the exposures <inline-formula><mml:math id="inf205"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>/</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are highly correlated. We derive the SNP-exposure associations from this dataset as <inline-formula><mml:math id="inf206"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. We set  <inline-formula><mml:math id="inf207"><mml:mi>K</mml:mi></mml:math></inline-formula>=50–100 and <inline-formula><mml:math id="inf208"><mml:mi>P</mml:mi></mml:math></inline-formula>=100–150 and the blocks 5–8. We let these values vary across simulations in order to generate more varying values in diagnostic accuracy. For a given sample size, <inline-formula><mml:math id="inf209"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> simulation studies were performed.</p><p>To retain the workflow of a two-sample MR, we generate a second exposure set identically as above but on an independent sample. This step is important as it guarantees the no sample overlap assumption of two-sample MR (<xref ref-type="bibr" rid="bib4">Burgess et al., 2016</xref>). Based on this second <inline-formula><mml:math id="inf210"><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> matrix, we generate the outcome <inline-formula><mml:math id="inf211"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mi>U</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>Y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The vector of causal estimates <inline-formula><mml:math id="inf212"><mml:mi>β</mml:mi></mml:math></inline-formula> is generated based on any number of exposures being causal in the two blocks. This includes the null. We obtain the SNP-outcome associations as <inline-formula><mml:math id="inf213"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The effect of the data generating mechanism in a single dataset is visualised in <xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8</xref>.</p><fig id="app1fig8" position="float"><label>Appendix 1—figure 8.</label><caption><title>Example for the block correlation in <inline-formula><mml:math id="inf214"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> (<inline-formula><mml:math id="inf215"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5000</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf216"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>77</mml:mn></mml:mrow></mml:math></inline-formula>) induced by the data generating mechanism in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title><p>In this example, the mean <inline-formula><mml:math id="inf217"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistic is 231.2 and the mean <inline-formula><mml:math id="inf218"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> is 3.21.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig8-v2.tif"/></fig><p>The methods employed are:</p><list list-type="bullet"><list-item><p>MVMR IVW with <inline-formula><mml:math id="inf219"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf220"><mml:mover accent="true"><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib38">Yavorska and Staley, 2020</xref>).</p></list-item><list-item><p>MVMR IVW with Bonferroni correction.</p></list-item><list-item><p>PCA with the scores from <inline-formula><mml:math id="inf221"><mml:mrow><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>sPCA as implemented in the <italic>elasticnet</italic> package (<xref ref-type="bibr" rid="bib40">Zou et al., 2006</xref>).</p></list-item><list-item><p>RSPCA (<xref ref-type="bibr" rid="bib10">Croux et al., 2013</xref>).</p></list-item><list-item><p>SCA (<xref ref-type="bibr" rid="bib7">Chen and Rohe, 2021</xref>).</p></list-item></list><p>Due to computational complexity, sPCA in the <italic>elasticnet</italic> package (spca_en in <xref ref-type="fig" rid="fig5">Figure 5</xref>) was implemented with a simplification regarding the sparsity parameter. Specifically, it was assumed that the number of non-zero exposures per component was <inline-formula><mml:math id="inf222"><mml:mrow><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula>. For SCA, we use the cross-validation method in <italic>PMA R</italic> package (<xref ref-type="bibr" rid="bib37">Witten and Tibshirani, 2020</xref>).</p><p>To generate the summary ROC curves presented in <xref ref-type="fig" rid="fig5">Figure 5</xref>, we treated simulation results as individual studies and meta-analysed them with the bivariate method of <xref ref-type="bibr" rid="bib27">Reitsma et al., 2005</xref>, in the <italic>R</italic> package. The logit sensitivity and specificity (which are correlated) are jointly meta-analysed by modelling them as a bivariate normal distribution and employing a random-effects model for accomodating this correlation and framing it as heterogeneity.</p><p>The results for a set of simulations in <inline-formula><mml:math id="inf223"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>3000</mml:mn></mml:mrow></mml:math></inline-formula> individuals are presented in <xref ref-type="fig" rid="app1fig10">Appendix 1—figure 10</xref>. We observe that MVMR and MVMR with Bonferroni correction estimates cluster to the bottom left of the plot, suggesting a low sensitivity. The estimates from SCA and sPCA_EN are spread in the upper left half of the plot and often achieve a sensitivity of 1.00. The PCA and RSPCA mainly provide highly sensitive estimates but perform relatively worse in specificity. The performance in increasing sample sizes is consistent with a benefit for sparse methods (<xref ref-type="fig" rid="app1fig9">Appendix 1—figure 9</xref>).</p><fig id="app1fig9" position="float"><label>Appendix 1—figure 9.</label><caption><title>AUC performance of multivariable Mendelian randomisation (MVMR) and dimensionality reduction methods for increasing sample sizes.</title><p>Two sparse methods (sparse component analysis [SCA], sparse principal component analysis [sPCA]) perform better compared with PCA and MVMR, with improving performance as the sample size increases. CFS: conditional <italic>F</italic>-statistic.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig9-v2.tif"/></fig><fig id="app1fig10" position="float"><label>Appendix 1—figure 10.</label><caption><title>Individual results from <inline-formula><mml:math id="inf224"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> simulations.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig10-v2.tif"/></fig><table-wrap id="app1table2" position="float"><label>Appendix 1—table 2.</label><caption><title>Simulation study on only four exposures (out of the total <inline-formula><mml:math id="inf225"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula>) contributing to the outcome <inline-formula><mml:math id="inf226"><mml:mi>Y</mml:mi></mml:math></inline-formula>.</title><p>A drop in sensitivity and specificity is observed for sparse component analysis (SCA) and sparse principal component analysis (sPCA) compared with the simulation configuration in <xref ref-type="table" rid="table4">Table 4</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom">PCA</th><th align="left" valign="bottom">SCA</th><th align="left" valign="bottom">sPCA</th><th align="left" valign="bottom">RSPCA</th><th align="left" valign="bottom">MVMR</th><th align="left" valign="bottom">MVMR_B</th></tr></thead><tbody><tr><td align="left" valign="bottom">AUC</td><td align="left" valign="bottom">0.799</td><td align="char" char="." valign="bottom">0.714</td><td align="left" valign="bottom">0.859</td><td align="left" valign="bottom">0.492</td><td align="char" char="." valign="bottom">0.511</td><td align="left" valign="bottom">0.675</td></tr><tr><td align="left" valign="bottom">SNS</td><td align="left" valign="bottom">1,0.03</td><td align="char" char="." valign="bottom">0.75,0.25</td><td align="left" valign="bottom">1,0.17</td><td align="left" valign="bottom">0.5,0.25</td><td align="char" char="." valign="bottom">0.25,0.25</td><td align="left" valign="bottom">0,0</td></tr><tr><td align="left" valign="bottom">SPC</td><td align="left" valign="bottom">0,0.2</td><td align="char" char="." valign="bottom">0.76,0.46</td><td align="left" valign="bottom">0.66,0.18</td><td align="left" valign="bottom">0.37,0.15</td><td align="char" char="." valign="bottom">0.94,0.07</td><td align="left" valign="bottom">1,0</td></tr><tr><td align="left" valign="bottom">Youden’s J</td><td align="left" valign="bottom">0</td><td align="char" char="." valign="bottom">0.428</td><td align="left" valign="bottom">0.625</td><td align="left" valign="bottom">–0.029</td><td align="char" char="." valign="bottom">0.105</td><td align="left" valign="bottom">0.032</td></tr></tbody></table></table-wrap></sec><sec sec-type="appendix" id="s13"><title>Comparison of PCA in 1SMR and 2SMR</title><p>We fix the number of blocks of exposures to <inline-formula><mml:math id="inf227"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and the number of exposures to <inline-formula><mml:math id="inf228"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>. In both 1SMR and 2SMR, the loadings matrices of <inline-formula><mml:math id="inf229"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf230"><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are of dimensionality <inline-formula><mml:math id="inf231"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<italic>p</italic> being the number of SNPs) and can be therefore compared for similarity. We use two similarity measures: a the sum of squared differences between the one-sample and two-sample loadings matrices <inline-formula><mml:math id="inf232"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and the <inline-formula><mml:math id="inf233"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> from a linear regression of the one-sample PC loadings on the two-sample PC loadings. <inline-formula><mml:math id="inf234"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> increases and <inline-formula><mml:math id="inf235"><mml:mi>S</mml:mi></mml:math></inline-formula> decreases with increasing sample size, as expected.</p><fig id="app1fig11" position="float"><label>Appendix 1—figure 11.</label><caption><title>Top panel: <inline-formula><mml:math id="inf236"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>; bottom panel: similarity of loadings (<inline-formula><mml:math id="inf237"><mml:mi>S</mml:mi></mml:math></inline-formula>) between one-sample Mendelian randomisation (MR) and two-sample MR (<inline-formula><mml:math id="inf238"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>).</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig11-v2.tif"/></fig></sec><sec sec-type="appendix" id="s14"><title>Proportion of non-causal exposures as a predictor of performance</title><p>For a given sample size <inline-formula><mml:math id="inf239"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>, we vary the proportion of non-causal SNPs (<inline-formula><mml:math id="inf240"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) to examine the performance. The total number of total exposures is picked from the <inline-formula><mml:math id="inf241"><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>160</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> range, the number of SNPs from the <inline-formula><mml:math id="inf242"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the number of blocks of exposures from <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>B</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Since the applied pipeline does not discriminate between strength of association of <inline-formula><mml:math id="inf244"><mml:mi>X</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf245"><mml:mi>Y</mml:mi></mml:math></inline-formula> in the dimensionality reduction stage, an increase in <inline-formula><mml:math id="inf246"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was expected to induce FP. Then, in the increasingly sparser subvector <inline-formula><mml:math id="inf247"><mml:msub><mml:mi>β</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> of the causal effects of <inline-formula><mml:math id="inf248"><mml:msub><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> on <inline-formula><mml:math id="inf249"><mml:mi>Y</mml:mi></mml:math></inline-formula>, all <inline-formula><mml:math id="inf250"><mml:msub><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula> exposures would be projected to the same PC. This PC is likely to still be associated with <inline-formula><mml:math id="inf251"><mml:mi>Y</mml:mi></mml:math></inline-formula>; however, specificity may drop. This is what was observed in the simulation study, where specificity gradually drops as <inline-formula><mml:math id="inf252"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> increases from 20% to 80%.</p><fig id="app1fig12" position="float"><label>Appendix 1—figure 12.</label><caption><title>Specificity (ability to accurately identify true negative exposures) of sparse component analysis (SCA) as a different proportion of exposures in each block are causal for <inline-formula><mml:math id="inf253"><mml:mi>Y</mml:mi></mml:math></inline-formula>.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-app1-fig12-v2.tif"/></fig></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.80063.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhao</surname><given-names>Siming</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/049s0rh22</institution-id><institution>Dartmouth College</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.06.15.22276455" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.06.15.22276455"/></front-stub><body><p>This paper investigated the identification of causal risk factors on health outcomes. It applies sparse dimension reduction methods on highly correlated traits in the Mendelian randomization framework. The implementation of this method helps to identify risk factors when given high dimensional traits data.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.80063.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Zhao</surname><given-names>Siming</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/049s0rh22</institution-id><institution>Dartmouth College</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Burgess</surname><given-names>Stephen</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.06.15.22276455">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.medrxiv.org/content/10.1101/2022.06.15.22276455v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Sparse Dimensionality Reduction Approaches in Mendelian Randomization with highly correlated exposures&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Martin Pollak as the Senior Editor. The following individual involved in the review of your submission has agreed to reveal their identity: Stephen Burgess (Reviewer #1).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Clarification of the method details. All three reviewers have clarification comments.</p><p>2) Interpretation of results. See comments from reviewer 3.</p><p>3) Demonstration of benefits in real data analysis. See comments from reviewers 1 and 3.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>I'm not the best person to judge, but I'm not sure how accessible this work would be to someone who doesn't understand multivariable Mendelian randomization. Figure 1 is a great overview, but I'd appreciate the viewpoint of someone who is less familiar with these methods.</p><p>The description of the different sparse PCA methods was a helpful summary.</p><p>I'm not sure that the foray into instrument strength is valuable – it is over 2 pages and 2 figures, and I'm not sure how much this adds – maintaining high conditional F statistics is important, but their calculation is not a major part of the analysis report. The whole section is a bit distracting and disproportionate.</p><p>All MR estimates seem to be on quite odd scales – the estimates are all close to 1 – 1.001 or 0.999. Could the PCs be standardized, so that the estimates are per 1 SD increase in the PC? This would improve communication of the results. Currently, there is no sense of scale – what is the corresponding change in lipids on a meaningful scale?</p><p>While I understand that the main thrust of the manuscript is methodological, I didn't get a strong sense of what the conclusion from the applied analysis is. If the authors could communicate a strong finding, this would help to justify the use of the method. Eg what are the estimates for the HDL clusters in the SCA method? This isn't clear.</p><p>Figure 6 would be key to this – currently, it's not clear what the various PCs represent. Maybe a radar chart would help? Also, the caption for Figure 6 is incorrect – the caption from Figure 8 has inadvertently been duplicated here.</p><p>While I wouldn't want to insist that the authors change their paper, the obvious application of this work appears to be imaging studies – this is currently under-explored.</p><p>Figure 5 is a really helpful summary of the performance of the different methods in this investigation.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>This is a nice paper, with convincing and very useful results. I have mainly some clarification questions and suggestions.</p><p>1. The main idea is to treat the matrix of SNP-exposures associations <inline-formula><mml:math id="sa1m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as explanatory variables in the regression <inline-formula><mml:math id="sa1m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, although this is clearly not a standard regression model, just that a WLS or GLS estimator for <italic>β</italic> is equivalent to the 2sls estimator on single-sample data. I think it would therefore be instructive to link to the construction of PCs in a single-sample individual-level data sets. There the model is <inline-formula><mml:math id="sa1m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and one could do a PCA on <bold>X</bold>. Alternatively, as the 2sls estimator is least-squares in <inline-formula><mml:math id="sa1m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="sa1m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, one could perhaps consider PCA on <inline-formula><mml:math id="sa1m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. As <inline-formula><mml:math id="sa1m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> this is getting close to the PCA on <inline-formula><mml:math id="sa1m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> if <inline-formula><mml:math id="sa1m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is normalized, for example <inline-formula><mml:math id="sa1m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = <bold>I</bold><sub>p</sub>. If it is not normalized, then it is hard to make a connection. It may therefore be worthwhile considering PCA on the weighted <inline-formula><mml:math id="sa1m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as per the (extended) IVW estimator in (1) on page 4. With such a link in place, it seems easier to motivate the proposed method.2. Are the covariances <inline-formula><mml:math id="sa1m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>lkj</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> reported in the GWAS? I assume the estimators are simply IVW throughout, as implied at the top of page 5?3. It is unclear to me why ∆ is estimated by OLS in (2).</p><p>4. Notation. It would be easier to follow the notation if matrices are upper case and vectors lower case. That would change for example the current vector <bold>γ</bold> to a lower case letter and the current matrix <bold>γ</bold> to an upper case letter.</p><p>5. It is not straightforward to follow the steps for Sparse PCA on page 56, as not all symbols are clear. It is not clear in 1. what &quot;Setting a fixed matrix,&quot; means and what the α<sub>j</sub> are. Also, define <bold>Xi</bold>. In 2 you simply do an svd? Should there be &quot;hats&quot; on <bold>γ</bold>? UDV<sup>T</sup> in step 2. are not the same values as in the svd for <inline-formula><mml:math id="sa1m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>Here are some detailed comments.</p><p>1. Usually a good idea to number figures in the order they appear in the text (Figure 12 out of order).</p><p>2. UVMR is referred to as UMVR three times and as UMVMR once</p><p>3. At the beginning of the Methods section, it would be good to specify the dimension of \γ. It is also important to specify how the variants used are selected.</p><p>4. Figure 1 is a bit chaotic and inconsistent with the text. Figure 1 top, the graph indicates that there are 118 exposures. I assume this was chosen because it is the number of lipid exposures in the data application but it doesn't look like the lipid data is used in this figure. Figure 1 top right, the dimension of the matrix is given as L x 118. The variable L does not appear elsewhere in the paper. What is printed appears to be a 60x60 square matrix. Is this matrix meant to represent <inline-formula><mml:math id="sa1m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="normal">⊤</mml:mi></mml:mrow></mml:msup><mml:mi>γ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>? The statement &quot;MR estimates affected by multi-colinearity&quot; printed next to this matrix doesn't appear to relate to the figure because the figure doesn't indicate anything about the MR estimates.5. Figure 5. It looks like none of the matrices shown have all 118 rows. The sparse PCA matrix has many fewer exposures than the other methods. It would be good to clarify this in the caption.</p><p>6. Figure 6 is labeled as &quot;Extrapolated ROX curves&quot; but appears to be a comparison of UVMR and MVMR results. For the top right plot, I would have expected UVMR and MVMR results to be identical since the PCs are exactly orthogonal. Why is this not the case?</p><p>7. Page 12 describes Figure 5 as &quot;The loadings for all methods (Figures 5a-e) are presented for LDL.c, a previously prioritised trait.&quot; I am confused about what &quot;for LDL.c&quot; means here. It appears that LDL.c is one of the traits in Figure 5 but these appear to be loadings across some large subset of traits?</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Sparse Dimensionality Reduction Approaches in Mendelian Randomization with highly correlated exposures&quot; for further consideration by <italic>eLife</italic>. Your revised article has been evaluated by Martin Pollak (Senior Editor) and a Reviewing Editor.</p><p>The manuscript has been improved and all reviewers agree this study will be useful for the field. However, there are remaining issues and we would like to invite you to further revise this manuscript.</p><p>Revision outline:</p><p>1. Adding a deeper more nuanced discussion of what is meant by causality and how to interpret the components. The major advancement of this study comes from method development and it is important to not overstate the significance of results. See comment 1 from reviewer 3 and comment 4 from reviewer 1.</p><p>2. The choice of method. Discussing scenarios that will work or fail for the method will be helpful for the readers to better utilize this tool. See comment 4 from reviewer 1 and comment 2 from reviewer 3.</p><p>3. Adding details of simulation. Other clarification issues raised by reviewers.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>1. While I appreciate the simulation study, and believe this is worthwhile, it strikes me that the primary reason for choosing one or other of these sparse methods is not performance in a simulation study, but rather how the methods define the PCs, and how the analyst could interpret the results. As there's no point running an analysis if you can't interpret the results. This will depend on the specific characteristics of the investigation, so I am not expecting a single method recommendation. But I'd appreciate a bit more acknowledgement of this in the choice of methods – what characteristics to these methods tend to result in? Interesting (and reassuring) to see that clusters from the SCA and sPCA methods look similar in Figure 2 (although then odd that in Table 3, the significance differs for the VLDL and LDL components…).</p><p>Overall, I appreciate the authors' manuscript in that it proposes sparse dimension reduction as a method and explores the properties of MVMR estimates from this approach. My sense is that it is difficult to say anything more authoritative/general than &quot;hey, look – we tried this and it sort of worked!&quot;, but the authors do this in a way that is mostly clear (see comments above) and should be helpful to future researchers.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>I am happy with this revision. The authors have responded well to my previous comments and suggestions, or clarified their preferred choices.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The resubmission has corrected some of the issues I raised previously. However, I have some remaining concerns, primarily about the interpretation of the proposed causal effects and the simulation results.</p><p>1. My largest issue is still in the causal interpretation of genetically determined PCs are sparse components. To me, I don't think there is a way to turn the components into well-defined exposures that admit a counterfactual or interventional definition of a causal effect. This approach seems closer to &quot;causality adjacent&quot; methods like TWAS. There was a paper a few years ago using sparse CCA in combination with TWAS (https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1008973) and this seems similar to that to me. I think one option for this paper would be to add a deeper discussion of what it means to test for a causal effect of a component that may or may not represent a latent biological variable. On one end of interpretation you have &quot;association with genetically predicted exposure component&quot; and then I think you could add as a bonus that if you have successfully identified a biological component, this could be interpretable as a causal effect.</p><p>2. Using the components introduces an issue of horizontal pleiotropy if a single variant is allowed to affect multiple components. This suggests that the component-based MVMR results would be more appropriate than component-based UVMR results, though for PCA this is not an issue due to orthogonality and approximate equivalence of UVMR and MVMR.</p><p>Some questions about the simulations:</p><p>3. In Figure 4, it seems like the MVMR plot should have 6 lines and not two. How were the 6 traits combined into two lines here? It seems unfair to average the rejection rate for the X_1-3 into the black line since, if MVMR performed perfectly, it would never reject X_3 and always reject X_1 and X_2.</p><p>4. Why is there an interval around only the black line in the MVMR plot and not the other plots?</p><p>5. The sentence in the caption presumably describing the color scheme is cutoff. &quot;The results are split according to group n black…&quot;</p><p>6. Is the appropriate number of components known a-priori in the simulations?</p><p>7. The description of Figure 4 suggests that PCA and SCA are out-performing MVMR. However, PCA has exactly the same rejection rate for the causal and non-causal block of traits which seems like bad performance to me. SCA has a Type 1 error rate between 20 and 30% at a nominal level of 0.05 which also seems quite bad to me. I would not view improving power at the cost of uncontrolled type 1 error as a good outcome.</p><p>8. The description of the Figure 5 at the top of page 9 does not align with the image in Figure 5. &quot;Both standard and Bonferroni-corrected MVMR performed poorly in terms of AUC (AUC 0.660 and 0.885 respectively), due to poor sensitivity. While there was a modest improvement with PCA (AUC 0.755), it appears that PCA and RSPCA do not accurately identify negative results (median specificity 0 and 0.28 respectively).&quot; Reading these numbers, it sounds like MVMR is the worst followed by PCA, followed by MVMR_B. However, in the figure, PCA and RSPCA both have lower AUC than MVMR and MVMR_B. These numbers are also inconsistent with Table 4.</p><p>9. I think I may be a little confused about how the ROC curves are constructed.</p><p>9a. In my experience, an ROC curve is usually constructed by varying a threshold (e.g. α). However, it seems here like α was fixed and we are averaging over the single point obtained for each simulation setting according to the Reitsma et al. method. This method makes sense when the data are real observations, however, in the case of simulations, why not use the traditional method of varying to threshold and then averaging the full curves across simulations?</p><p>9b. I think this method of displaying results also obscures the issue of calibration. If there is a nominal significance threshold, we would like to see that type 1 error is controlled below that threshold.</p><p>9c. Visually, Figure 15 looks inconsistent with Figure 5 to me. There are no blue points in the upper right of Figure 15 -- does it make sense to extrapolate this part of the curve? Figure 5 suggests that the red methods at least have the potential to do very well in differentiating true and false positives but this doesn't seem born out by Figure 15 where most of the red points cluster in the upper right.</p><p>10. On the selection of instruments -- is it correct that you are assuming that all variants affecting any of the component metabolites also affect LDL/HDL or Triglycerdies as measured in the GLGC study? Does this assumption limit your ability to identify components that separate LDL or HDL sub-components? For example, variants that affect only a small number of components will be less likely to be selected using the GLGC reference.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.80063.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>I'm not the best person to judge, but I'm not sure how accessible this work would be to someone who doesn't understand multivariable Mendelian randomization. Figure 1 is a great overview, but I'd appreciate the viewpoint of someone who is less familiar with these methods.</p></disp-quote><p>We have expanded the Introduction (first and second paragraphs), stressing the link of MR with RCTs that are more widely known. The goal of confounding adjustment is very similar in the two approaches and we believe this can motivate the presented methods for a wider audience.</p><disp-quote content-type="editor-comment"><p>The description of the different sparse PCA methods was a helpful summary.</p><p>I'm not sure that the foray into instrument strength is valuable – it is over 2 pages and 2 figures, and I'm not sure how much this adds – maintaining high conditional F statistics is important, but their calculation is not a major part of the analysis report. The whole section is a bit distracting and disproportionate.</p><p>All MR estimates seem to be on quite odd scales – the estimates are all close to 1 – 1.001 or 0.999. Could the PCs be standardized, so that the estimates are per 1 SD increase in the PC? This would improve communication of the results. Currently, there is no sense of scale – what is the corresponding change in lipids on a meaningful scale?</p></disp-quote><p>Thank you for your suggestion, indeed the OR estimates are on a narrow scale close to 1. We relate this to the lack of definition of the estimated causal effects. For this reason, we limit the scope of the proposed method to hypothesis testing as opposed to estimation. It is encouraging that, in the positive control example of how lipids associate with CHD, we observe that, when positive loadings are used to transform the exposures, the sign is biologically meaningful (LDL and VLDL increase risk, HDL appears to be protective). We acknowledge this and further stress its implications in the Discussion/Limitations section.</p><disp-quote content-type="editor-comment"><p>While I understand that the main thrust of the manuscript is methodological, I didn't get a strong sense of what the conclusion from the applied analysis is. If the authors could communicate a strong finding, this would help to justify the use of the method. Eg what are the estimates for the HDL clusters in the SCA method? This isn't clear.</p></disp-quote><p>Thank you for your suggestion, indeed there is an interesting point not originally highlighted regarding the HDL cluster. In the MVMR with those exposures that were significant in UVMR, only ApoB is positively associated with CHD. No exposures were protective. However, in SCA, there is a grouping of HDL traits in two independent PCs, corresponding to small/medium and larger HDL traits. The former PC appears to be protective for CHD. This finding is supported from other observational studies (smaller HDL traits are associated with favourable cardiovascular risk profiles) that we now report in the Discussion. Thus, if the analysis was restricted to MVMR, these findings would be masked due to imprecision (additions in Discussion/First Paragraph, updated Table 4).</p><disp-quote content-type="editor-comment"><p>Figure 6 would be key to this – currently, it's not clear what the various PCs represent. Maybe a radar chart would help? Also, the caption for Figure 6 is incorrect – the caption from Figure 8 has inadvertently been duplicated here.</p></disp-quote><p>Thank you for your observation, we have fixed the caption. The figure has also slightly changed following the comments of Reviewer 3 on an update in the exposures that are eligible with the SNPs that we use for the instrument. What Figure 6 reports is the comparison of the univariable and multivariable estimates of the causal effect of each PC on CHD. We would expect PCA to provide orthogonal components and therefore to have identical estimates in UVMR and MVMR. In the sparse methods, where strict orthogonality is traded with interpretability of the PCs, we expected some deviation and we wanted to visually communicate this. We also included the UVMR and MVMR estimates for SFPCA which were not in the original draft.</p><disp-quote content-type="editor-comment"><p>While I wouldn't want to insist that the authors change their paper, the obvious application of this work appears to be imaging studies – this is currently under-explored.</p></disp-quote><p>Thank you for your observation, we agree that imaging data would be a very good candidate for this approach. We highlight this in the Discussion.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>This is a nice paper, with convincing and very useful results. I have mainly some clarification questions and suggestions.</p><p>1. The main idea is to treat the matrix of SNP-exposures associations <inline-formula><mml:math id="sa2m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as explanatory variables in the regression <inline-formula><mml:math id="sa2m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, although this is clearly not a standard regression model, just that a WLS or GLS estimator for β is equivalent to the 2sls estimator on single-sample data. I think it would therefore be instructive to link to the construction of PCs in a single-sample individual-level data sets. There the model is <inline-formula><mml:math id="sa2m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and one could do a PCA on <bold>X</bold>. Alternatively, as the 2sls estimator is least-squares in <inline-formula><mml:math id="sa2m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="sa2m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, one could perhaps consider PCA on <inline-formula><mml:math id="sa2m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. As <inline-formula><mml:math id="sa2m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> this is getting close to the PCA on <inline-formula><mml:math id="sa2m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> if <inline-formula><mml:math id="sa2m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is normalized, for example <inline-formula><mml:math id="sa2m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = <bold>I</bold><sub>p</sub>. If it is not normalized, then it is hard to make a connection. It may therefore be worthwhile considering PCA on the weighted <inline-formula><mml:math id="sa2m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as per the (extended) IVW estimator in (1) on page 4. With such a link in place, it seems easier to motivate the proposed method.</p></disp-quote><p>Thank you for your suggestion. We now include a simulation study on one-sample data where we perform PCA (<italic>PCA</italic><sub>1<italic>SMR</italic></sub>) and one sparse implementation (SCA) on <inline-formula><mml:math id="sa2m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. To accomodate the larger computational time (matrix of <italic>n</italic> × <italic>K</italic> instead of <italic>p</italic> × <italic>n</italic>), we reduced sample size and accordingly increased the <italic>γ</italic> parameter, keeping the <italic>F</italic>−statistics and conditional <italic>F</italic>−statistics in the same range. We compare a two-stage least squares MVMR estimator for <italic>K</italic> exposures with the following procedure. We obtain PC scores from <italic>X</italic>ˆ = <italic>UDV <sup>T</sup></italic> and then regress <italic>UD</italic> on <italic>Y</italic>. Figure XYZ shows a similar performance with individual-level data as the one reported in the original draft. Both MVMR and MVMR with a multiplicity correction suffer from imprecise results (low sensitivity in Figure). SCA performs better in identifying true causal exposures, whereas PCA provides a lot of false positive results. Therefore, we conclude that such an approach with two-stage least squares is feasible and performs better than PCA in the simulation study.</p><p>We then examine how similar <italic>PCA</italic><sub>1<italic>SMR</italic></sub> and <italic>PCA</italic><sub>2<italic>SMR</italic></sub> are. As suggested, the aim is to establish how much information is lost by opting for a PCA/SCA on summary data only. If the exposures are grouped together in <italic>PCA</italic><sub>1<italic>SMR</italic></sub> and <italic>PCA</italic><sub>2<italic>SMR</italic></sub> in a similar fashion, then this would indicate a similar performance in individual level data and summary statistics. To quantify this, we keep the simulation setup described in the <italic>Simulation Study</italic> Section and we apply the two methods.</p><p>As you suggested, the loadings matrices for both is of dimensionality <italic>K</italic> × <italic>K</italic>. We then use two measures to quantify the similarity for increasing sample sizes: a similarity measure to compare the loadings matrices<disp-formula id="sa2equ1"><mml:math id="sa2m27"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mtext>load</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <italic>V</italic><sub>1<italic>SMR</italic></sub> are the loadings assigned in one-sample MR and <italic>V</italic><sub>2<italic>SMR</italic></sub> those of two-sample MR, and (b) the <italic>R</italic><sup>2</sup> of the regression of <inline-formula><mml:math id="sa2m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> on <inline-formula><mml:math id="sa2m29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<inline-formula><mml:math id="sa2m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mtext>VV</mml:mtext></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>ϵ</mml:mi><mml:mi>V</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <italic>ϵ<sub>V V</sub></italic> are the residuals of the regression of <italic>V</italic><sub>1<italic>SMR</italic></sub> on <italic>V</italic><sub>2<italic>SMR</italic></sub>). We vary the sample size and track the performance of PCA and SCA.</p><p>The results are presented in Figure 1. For SCA, <italic>PCA</italic><sub>1<italic>SMR</italic></sub> and <italic>PCA</italic><sub>1<italic>SMR</italic></sub> load the matrix in a more similar manner as sample size increases, however not converging to zero. A similar picture is drawn by the <italic>R</italic><sup>2</sup>, with all PCs showing a closer alignment of 1SMR and 2SMR as sample size increases. A closer examination of the results in individual simulations suggests that the blocks of exposures are correctly projected to PCs (exposures 1 to 3 in one PC and 4 to 6 in another, Figure), more so in larger sample sizes We note that the loadings for each block are not identical in 1SMR and 2SMR.</p><p>As suggested, in the applied analysis we have replaced the PCA on <italic>γ</italic> approach with the one proposed. We thus standardise γ as.<inline-formula><mml:math id="sa2m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mtext>γGX</mml:mtext><mml:msub><mml:mtext>SE</mml:mtext><mml:mrow><mml:mtext>γGX</mml:mtext></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> There are no differences in precision of the causal estimates.</p><disp-quote content-type="editor-comment"><p>2. Are the covariances <inline-formula><mml:math id="sa2m32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>lkj</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> reported in the GWAS? I assume the estimators are simply IVW throughout, as implied at the top of page 5?</p></disp-quote><p>We have used the intercept of the LD score regression as a proxy for the phenotypic correlations <italic>σ<sub>lkj</sub></italic>.</p><p>We clarify that, if individual-level data is not available, this is a sensible approach. Yes, IVW is used throughout the analyses.</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><caption><title>Top Panel: <italic>R</italic><sup>2</sup>; Bottom Panel: Similarity of loadings (<italic>S<sub>load</sub></italic>) between one-sample MR and two-sample MR (<italic>N<sub>sim</sub></italic> = 10<italic>,</italic>000).</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80063-sa2-fig1-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>3. It is unclear to me why ∆ is estimated by OLS in (2).</p></disp-quote><p>Thank you for your comment, <inline-formula><mml:math id="sa2m33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is estimated by regressing an exposure <italic>X<sub>k</sub></italic> on the other exposures <italic>X</italic><sub>−<italic>k</italic></sub> by OLS. If an exposure <italic>k</italic> can be accurately predicted conditionally on other exposures, then there won’t be sufficient variation in <italic>Q<sub>Xk</sub></italic> (low conditional instrument strength). We have clarified this in the manuscript.</p><disp-quote content-type="editor-comment"><p>4. Notation. It would be easier to follow the notation if matrices are upper case and vectors lower case. That would change for example the current vector γ to a lower case letter and the current matrix γ to an upper case letter.</p></disp-quote><p>Thank you for your comment, we prefer to refer to the SNP-<italic>X</italic> associations as <italic>γ</italic> and to the SNP-<italic>Y</italic> associations as Γ as this is common practice.</p><disp-quote content-type="editor-comment"><p>5. It is not straightforward to follow the steps for Sparse PCA on page 56, as not all symbols are clear. It is not clear in 1. what &quot;Setting a fixed matrix,&quot; means and what the α<sub>j</sub> are. Also, define Xi. In 2 you simply do an svd? Should there be &quot;hats&quot; on γ? UDV<sup>T</sup> in step 2. are not the same values as in the svd for <inline-formula><mml:math id="sa2m34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></disp-quote><p>Thank you for your comment, we have updated the explanation on sparse PCA in page 5. We are rephrasing the page 272 of the Zou et al., 2006 paper that introduces the ideas of framing PCA as a ridge regression problem (<italic>L</italic>2 norm is similar to variance maximisation) and then additionally using an <italic>L</italic>1 norm to induce sparsity.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>Here are some detailed comments.</p><p>1. Usually a good idea to number figures in the order they appear in the text (Figure 12 out of order).</p></disp-quote><p>Thank you for spotting this, we have reordered the Figures.</p><disp-quote content-type="editor-comment"><p>2. UVMR is referred to as UMVR three times and as UMVMR once</p></disp-quote><p>Thank you for spotting this, we have corrected this.</p><disp-quote content-type="editor-comment"><p>3. At the beginning of the Methods section, it would be good to specify the dimension of γ. It is also important to specify how the variants used are selected.</p></disp-quote><p>Thank you for your suggestion, we have added the dimensions of γ (148x118). The instrument selection procedure is described in the first paragraph of the Methods/Data section.</p><disp-quote content-type="editor-comment"><p>4. Figure 1 is a bit chaotic and inconsistent with the text. Figure 1 top, the graph indicates that there are 118 exposures. I assume this was chosen because it is the number of lipid exposures in the data application but it doesn't look like the lipid data is used in this figure. Figure 1 top right, the dimension of the matrix is given as L x 118. The variable L does not appear elsewhere in the paper. What is printed appears to be a 60x60 square matrix. Is this matrix meant to represent \γ^\top \γ? The statement &quot;MR estimates affected by multi-colinearity&quot; printed next to this matrix doesn't appear to relate to the figure because the figure doesn't indicate anything about the MR estimates.</p></disp-quote><p>Thank you for looking into this Figure, we indeed do not use the lipid data in this. Instead, we use simulated data. To improve the Figure, we have switched to the updated exposures γ<italic><sup>T</sup>γ</italic> matrix (147 × 99). We changed the notation to <italic>K</italic>, which is how we refer to the number of exposures throughout the text. We have moved the ’MR Estimates affected by multi-collinearity’ sentence to the legend.</p><disp-quote content-type="editor-comment"><p>5. Figure 5. It looks like none of the matrices shown have all 118 rows. The sparse PCA matrix has many fewer exposures than the other methods. It would be good to clarify this in the caption.</p></disp-quote><p>Thank you for your suggestion, we now clarify this in the caption.</p><disp-quote content-type="editor-comment"><p>6. Figure 6 is labeled as &quot;Extrapolated ROX curves&quot; but appears to be a comparison of UVMR and MVMR results. For the top right plot, I would have expected UVMR and MVMR results to be identical since the PCs are exactly orthogonal. Why is this not the case?</p></disp-quote><p>Thank you, we have corrected the caption. This is correct, we are comparing UVMR and MVMR estimates for the PCA methods. We agree and also hypothesised that the estimates would be identical for PCA where the PCs are strictly orthogonal and similar in the sparse implementations. In the updated analysis where aminoacids are excluded and six (instead of seven) PCs are constructed, this is also observed. The agreement of the causal estimates from PCA is the highest (<italic>R</italic><sup>2</sup> = 0<italic>.</italic>93). The sparse methods provide estimates that are not as concordant as in PCA but are still highly correlated. Regarding the poor performance of robust sparse PCA on this assessment, we have increased the number of sparsity parameters per component and this appeared to improve (<italic>R</italic><sup>2</sup> = 0<italic>.</italic>79).</p><disp-quote content-type="editor-comment"><p>7. Page 12 describes Figure 5 as &quot;The loadings for all methods (Figures 5a-e) are presented for LDL.c, a previously prioritised trait.&quot; I am confused about what &quot;for LDL.c&quot; means here. It appears that LDL.c is one of the traits in Figure 5 but these appear to be loadings across some large subset of traits?</p></disp-quote><p>Thank you, we were presenting separately the loadings that corresponded to LDL.c and urea across all methods in Figure 12. Figure 5 was a reference to the methods but this referencing was confusing so we dropped it. In the updated Figure, we present visually how the different methods project LDL.c and ApoB to different components; PCA loadings suggest that LDL.c contributes to some degree to all PCs whereas the sparse methods reduce this to a single PC.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>The manuscript has been improved and all reviewers agree this study will be useful for the field. However, there are remaining issues and we would like to invite you to further revise this manuscript.</p></disp-quote><p>Thank you for your positive assessment of our manuscript. We have updated the manuscript according to the reviewers’ comments and have included our responses point-by-point in the present document.</p><p>We also like to point out a change in the senior authorship, with Prof. Jack Bowden and Dr. Verena Zuber now both being joint senior authors, as Prof. Jack Bowden contributed to the manuscript to a degree that qualifies him for this. All authors agreed to this author order.</p><disp-quote content-type="editor-comment"><p>Revision outline:</p><p>1. Adding a deeper more nuanced discussion of what is meant by causality and how to interpret the components. The major advancement of this study comes from method development and it is important to not overstate the significance of results. See comment 1 from reviewer 3 and comment 4 from reviewer 1.</p></disp-quote><p>Thank you for your suggestion. We have updated the interpretation of the findings in line with these two comments. We stress more on how the methodological improvements are the major focus.</p><disp-quote content-type="editor-comment"><p>2. The choice of method. Discussing scenarios that will work or fail for the method will be helpful for the readers to better utilize this tool. See comment 4 from reviewer 1 and comment 2 from reviewer 3.</p></disp-quote><p>Thank you for your point. We have expanded the Discussion section to describe the types of datasets that the proposed methods are applicable for. We believe this makes things clearer for practitioners.</p><disp-quote content-type="editor-comment"><p>2. Adding details of simulation. Other clarification issues raised by reviewers.</p></disp-quote><p>Thank you for your suggestion. We have substantially rephrased and reorganised the simulation section, with changes highlighted in blue. We have added the required details and split the simulation results in subsections to improve clarity.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>1. While I appreciate the simulation study, and believe this is worthwhile, it strikes me that the primary reason for choosing one or other of these sparse methods is not performance in a simulation study, but rather how the methods define the PCs, and how the analyst could interpret the results. As there's no point running an analysis if you can't interpret the results. This will depend on the specific characteristics of the investigation, so I am not expecting a single method recommendation. But I'd appreciate a bit more acknowledgement of this in the choice of methods – what characteristics to these methods tend to result in? Interesting (and reassuring) to see that clusters from the SCA and sPCA methods look similar in Figure 2 (although then odd that in Table 3, the significance differs for the VLDL and LDL components…).</p></disp-quote><p>Thank you for your comment. We agree that, given the study design, final recommendations on using only one method could be missing out on subtle differences; for instance, datasets with outliers might benefit more from robust approaches but this approach didn’t seem to outperform others in our simulation study nor in the applied example. We show a substantial improvement in performance for the particular realistic simulation design that we describe, and the performance measure is based on hypothesis testing rather than how the methods define the PCs. The simulation study is now reorganised with three distinct sections and we believe it is clearer how we do measure the results of how the PCs affect the outcome (power and Type I Error).</p><p>Regarding the Table 3 results, we agree that the sPCA results are not perfectly accordant with the expectation of a LDL/VLDL positive association with CHD. We used this example as a positive control outcome and we therefore interpret this as a suboptimal performance of sPCA in this particular context. It is of course possible to imagine different scenarios regarding this difference with the simulations where sPCA performed well, the main of whom would be some form of pleiotropy. We discuss this possibility in the discussion.</p><disp-quote content-type="editor-comment"><p>Overall, I appreciate the authors' manuscript in that it proposes sparse dimension reduction as a method and explores the properties of MVMR estimates from this approach. My sense is that it is difficult to say anything more authoritative/general than &quot;hey, look – we tried this and it sort of worked!&quot;, but the authors do this in a way that is mostly clear (see comments above) and should be helpful to future researchers.</p></disp-quote><p>Thank you for your positive assessment of our manuscript.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>The resubmission has corrected some of the issues I raised previously. However, I have some remaining concerns, primarily about the interpretation of the proposed causal effects and the simulation results.</p></disp-quote><p>Thank you for your positive assessment of our manuscript.</p><disp-quote content-type="editor-comment"><p>1. My largest issue is still in the causal interpretation of genetically determined PCs are sparse components. To me, I don't think there is a way to turn the components into well-defined exposures that admit a counterfactual or interventional definition of a causal effect. This approach seems closer to &quot;causality adjacent&quot; methods like TWAS. There was a paper a few years ago using sparse CCA in combination with TWAS (https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1008973) and this seems similar to that to me. I think one option for this paper would be to add a deeper discussion of what it means to test for a causal effect of a component that may or may not represent a latent biological variable. On one end of interpretation you have &quot;association with genetically predicted exposure component&quot; and then I think you could add as a bonus that if you have successfully identified a biological component, this could be interpretable as a causal effect.</p></disp-quote><p>Thank you for the article suggestion, we have read the particular application of sparse methods in TWAS and cite it in the discussion. This also helps contextualising the benefits of sparse methods in general, namely improving power.</p><p>We have supplemented our previous discussion of this difficulty in interpreting the components as actionable exposures with counterfactuals in the draft, in the Discussion/ Limitations section, bringing it forward in the new updated paragraph. We acknowledge that a strict causal interpretation is not readily available with our suggested approach; at the same time, we believe it’s highly unlikely that a pragmatic causal effect will act in a way such that only one particular exposure of the many, highly correlated ones will be the sole driver of an effective medical intervention.</p><disp-quote content-type="editor-comment"><p>2. Using the components introduces an issue of horizontal pleiotropy if a single variant is allowed to affect multiple components. This suggests that the component-based MVMR results would be more appropriate than component-based UVMR results, though for PCA this is not an issue due to orthogonality and approximate equivalence of UVMR and MVMR.</p></disp-quote><p>Thank you for your comment. We agree that MVMR results are better suited for this purpose and this is why we present MVMR and not UVMR in the positive control example with real data. We highlight this in the applied Results section and mention the pleiotropy concern in the limitations.</p><disp-quote content-type="editor-comment"><p>Some questions about the simulations:</p><p>3. In Figure 4, it seems like the MVMR plot should have 6 lines and not two. How were the 6 traits combined into two lines here? It seems unfair to average the rejection rate for the X_1-3 into the black line since, if MVMR performed perfectly, it would never reject X_3 and always reject X_1 and X_2.</p></disp-quote><p>Thank you for your comment. We have substantially revised the simulation study results, splitting it in three sections to improve clarity (Illustrative example, high-dimensional example, determinant of performance). The changes are highlighted in blue. We have also corrected the data generating mechanism in Figure 4a, to visualise the exact mechanism that was used in the simulations in Figure 4b (six exposures forming two blocks, one block / three exposures are causal for Y).</p><p>In the first scenario (Figure 4), we have compared the rejection rates of MVMR with the two informative PCs and MVMR with the six individual exposures. Therefore, the first two panels in Figure 4b include two lines (with corresponding Monte Carlo SEs), one for each PC, and the rightmost panel includes six lines, one for each exposure. We have updated the colour coding and the DAG to better present this.</p><p>In the proposed workflow, we have used only the informative components in order to efficiently reduce the dimensions. We achieved this with permutations in the real data and with the Karlis-Saporta-Spinakis criterion, a simpler method for a different eigenvalue cutoff. In the simulations, we have used the two first PCs, each of which reflected three exposures.</p><disp-quote content-type="editor-comment"><p>4. Why is there an interval around only the black line in the MVMR plot and not the other plots?</p></disp-quote><p>We have now modified the presentation of the Figure. What we are presenting in this plot is the rejection rates for the two components (three exposures each) of PCA and SCA. In MVMR, there are six exposures and six rejection rates. The colour-coding is green for the true causal exposures (and components) and red for those that do not affect the outcome. To make this clearer, we now show different shades of red and green for the individual exposures and red and green for the transformed components. For PCA, the causal and the non-causal <italic>groups</italic> are presented as two separate lines. It was observed that PCA and SCA performed well in mapping the correlated exposures to two components, hence the equivalence visualised by the common colour coding (see also comments 3, 6). Apologies for the confusing presentation, the lines that were interpreted as intervals are in reality lines that show the rejection rates of MVMR for each exposure. We have added a table in the figure to clarify this, and updated the figure legend.</p><p>Therefore, an ideal performance would be a nominal type I error rate for the component that reflects the negative exposures (colour-coded red) and a high value of power approaching 1 (colour coded black). To improve presentation, we have also added Monte Carlo SEs following Tim Morris et al. (Table 6 in DOI: 10.1002/sim.8086). In this updated simulation, there seems to be an appropriate performance for SCA, with T1E converging at 5%. The problematic performance of MVMR is highlighted in the lower than nominal Type 1 Error throughout and, importantly, in the low power in the low instrument strength simulation (CFS ~ 3, first result/ leftmost part of the three panels).</p><disp-quote content-type="editor-comment"><p>5. The sentence in the caption presumably describing the color scheme is cutoff. &quot;The results are split according to group n black,….&quot;</p></disp-quote><p>Thank you for your comment, we have now rephrased the Figure 4 caption.</p><disp-quote content-type="editor-comment"><p>6. Is the appropriate number of components known a-priori in the simulations?</p></disp-quote><p>This is correct. The two ways of determining the number of components (KSS criterion, permutation) performed well in the simulated data and we chose to present results with an a priori known number of components. We have added this in the simulation results/ Simple Illustrative Example section for transparency.</p><disp-quote content-type="editor-comment"><p>7. The description of Figure 4 suggests that PCA and SCA are out-performing MVMR. However, PCA has exactly the same rejection rate for the causal and non-causal block of traits which seems like bad performance to me. SCA has a Type 1 error rate between 20 and 30% at a nominal level of 0.05 which also seems quite bad to me. I would not view improving power at the cost of uncontrolled type 1 error as a good outcome.</p></disp-quote><p>Thank you for your suggestions, we have given the simulation results a more careful consideration. We agree that PCA performs suboptimally, albeit in a different manner than MVMR. MVMR seems to lack in power and PCA provides many false positive results. What seems to perform better is SCA. We also agree that a T1E of 20% is concerning. However, observing that the T1E curve didn’t seem to have fully converged for the instrument strength that we were previously reporting, we repeated the same simulation study with one modification. We further increase the sample sizes to achieve higher instrument strength. In the updated Figure 4, SCA indeed outperforms PCA and MVMR, with a well-controlled T1E for larger samples. It may be unlikely that such a high instrument strength will be observed, especially in the context of correlated exposures, however we believe this convergence to 5% is quite reassuring.</p><p>Regarding your observations on the performance of PCA, we agree and we are more critical of PCA in the Results section as we agree that false positives are a major issue. It seems that MVMR and PCA in the formulations we investigated perform poorly at the two extremes of poor performance (highly imprecise, misleadingly precise); meanwhile, sensible transformations of the exposures are achieved and we have added in the discussion the possibility of some form of T1E control to salvage PCA performance to guide further research. To clarify this, we added a segment in the discussion (Paragraph 2 ‘When using PCA without any sparsity constraints, our simulation studies revealed numerous false positive results, at the opposite end of the nature of poor performance seen in MVMR; estimates were often misleadingly precise (false negative). Although appropriate transformations of the exposures were achieved, we highly recommend exploring additional forms of T1E control to improve the performance of PCA. Nonetheless, sparse methods exhibited superior performance compared to both PCA and MVMR.6’)</p><disp-quote content-type="editor-comment"><p>8. The description of the Figure 5 at the top of page 9 does not align with the image in Figure 5. &quot;Both standard and Bonferroni-corrected MVMR performed poorly in terms of AUC (AUC 0.660 and 0.885 respectively), due to poor sensitivity. While there was a modest improvement with PCA (AUC 0.755), it appears that PCA and RSPCA do not accurately identify negative results (median specificity 0 and 0.28 respectively).&quot; Reading these numbers, it sounds like MVMR is the worst followed by PCA, followed by MVMR_B. However, in the figure, PCA and RSPCA both have lower AUC than MVMR and MVMR_B. These numbers are also inconsistent with Table 4.</p></disp-quote><p>Thank you for your comments, the purpose of direct AUC comparisons is to visualise in one figure the performances of the methods. We agree that, seen in isolation, it may be misleading to miss the differences with respect to sensitivity and specificity across methods: MVMR consistently provides imprecise results and fails to identify positive associations, whereas PCA provides very precise results that yield many false positives. We were acknowledging this previously and have further highlighted in the discussion. The comparison of PCA and MVMR solely on AUC is therefore not a reliable way to measure their efficacy. Thank you for spotting the inconsistency in Table 4, the columns are now correctly labelled.</p><p>At the same time we present the results, we’re discussing what is not directly identified. Results are driven by very different behaviour on different ends of AUC curve. We acknowledge that the results are inherently dependent on the data generating model and the specific simulation settings used in our study. If the data were generated differently, the results would differ as well.</p><disp-quote content-type="editor-comment"><p>9. I think I may be a little confused about how the ROC curves are constructed.</p><p>9a. In my experience, an ROC curve is usually constructed by varying a threshold (e.g. α). However, it seems here like α was fixed and we are averaging over the single point obtained for each simulation setting according to the Reitsma et al. method. This method makes sense when the data are real observations, however, in the case of simulations, why not use the traditional method of varying to threshold and then averaging the full curves across simulations?</p></disp-quote><p>Thank you for bringing up this question. We have substantially updated the simulation section and we hope the workflow is now clearer. We first present the data generating mechanism, and we provide more details on the ROC curve construction in the paragraph Simulation Studies/ Complex High-Dimensional Example.</p><p>We fix the α threshold to present the results across many individual simulations in a more concise manner. Varying the threshold and averaging the full curves across simulations would have been a valid approach for single simulation studies as well, but any summary across simulation studies would have made the presentation of results more complex and difficult to interpret.</p><p>Therefore, we use the Reitsma et al. method, a well-established approach for summarizing ROC curves in simulation studies, as it provides a comprehensive and concise summary of the results. This method jointly meta-analyses sensitivity and specificity with a bivariate mode. We further explain our rationale in the Simulation Studies/ Complex High-Dimensional Example paragraph.</p><disp-quote content-type="editor-comment"><p>9b. I think this method of displaying results also obscures the issue of calibration. If there is a nominal significance threshold, we would like to see that type 1 error is controlled below that threshold.</p></disp-quote><p>Thank you for your comment. We have shown that SCA achieves appropriate T1E for larger samples in the updated analysis (Simulation Results/Simple illustrative example/Figure 4).</p><disp-quote content-type="editor-comment"><p>9c. Visually, Figure 15 looks inconsistent with Figure 5 to me. There are no blue points in the upper right of Figure 15 -- does it make sense to extrapolate this part of the curve? Figure 5 suggests that the red methods at least have the potential to do very well in differentiating true and false positives but this doesn't seem born out by Figure 15 where most of the red points cluster in the upper right.</p></disp-quote><p>Thank you for your observation. The curve is directly derived from the bivariate meta-analysis method and the unobserved values are extrapolated from the form of the observed ones. The true performance, as observed directly from individual simulation studies, is reported in Figure 15, where many of the results for the two superior sparse PCA methods cluster in the top right corner. Additionally, there is a clear benefit in the red methods, as evidenced by a substantial scoring in the top of the y-axis (in the sensitivity = 1 area of the plot). This benefit is not observed for PCA or MVMR. When the results are meta-analysed, these latter simulation studies in the middle region are extrapolated and indicative of good performance. This is why we choose to meta-analyse, as all these factors are taken into account, but at the same time present the individual results for visual comparison.</p><p>We have to disagree with your interpretation regarding how these two results are in disagreement, as we believe Figure 15 is a transparent and complementary way of presenting the total performance in Figure 5. In Figure 15, even though there is some apparent clustering in the top right corner, there is still much more dispersion compared to PCA and especially in the middle regions (say sensitivity and specificity ~ 0.2 -0.8). These individual results give rise to the curves in the meta-analysed plot.</p><disp-quote content-type="editor-comment"><p>10. On the selection of instruments -- is it correct that you are assuming that all variants affecting any of the component metabolites also affect LDL/HDL or Triglycerdies as measured in the GLGC study? Does this assumption limit your ability to identify components that separate LDL or HDL sub-components? For example, variants that affect only a small number of components will be less likely to be selected using the GLGC reference.</p></disp-quote><p>This is true, ideally we would have an external study that investigates sub-components as separate phenotypes rather than serum measurements of total fractions. We are acknowledging this as another limitation in the discussion.</p></body></sub-article></article>